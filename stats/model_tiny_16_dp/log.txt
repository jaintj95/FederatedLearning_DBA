current path: saved_models/model_tiny_Jun.12_15.08.59
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 13/373 (3.4853%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.4310, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 380/1657 (22.9330%)
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 465/1657 (28.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5132, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 315/1340 (23.5075%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 592/1340 (44.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5650, Accuracy: 54/10000 (0.5400%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 389/1750 (22.2286%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 660/1750 (37.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.8929, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 248/1402 (17.6890%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 368/1402 (26.2482%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.1659, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 48/426 (11.2676%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 175/426 (41.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5743, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0803, Accuracy: 58/515 (11.2621%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0546, Accuracy: 123/515 (23.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.7520, Accuracy: 53/10000 (0.5300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 295/690 (42.7536%)
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1926, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 384/1036 (37.0656%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 652/1036 (62.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 9.1634, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 488/1715 (28.4548%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 730/1715 (42.5656%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.4978, Accuracy: 97/10000 (0.9700%)
time spent on training: 124.00823307037354
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3036, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3842, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.4024565219879 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 301/1340 (22.4627%)
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 534/1340 (39.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5748, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 296/1154 (25.6499%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 453/1154 (39.2548%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 10.5703, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0550, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.3127, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0571, Accuracy: 384/1581 (24.2884%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 575/1581 (36.3694%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8305, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 399/1440 (27.7083%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 649/1440 (45.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7446, Accuracy: 82/10000 (0.8200%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1202, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3098, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0669, Accuracy: 186/773 (24.0621%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0301, Accuracy: 410/773 (53.0401%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9910, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0593, Accuracy: 372/1427 (26.0687%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 577/1427 (40.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9747, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 496/1513 (32.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5157, Accuracy: 95/10000 (0.9500%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0548, Accuracy: 415/1988 (20.8753%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 676/1988 (34.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8173, Accuracy: 81/10000 (0.8100%)
time spent on training: 130.6057894229889
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3043, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3788, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.05953788757324 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0631, Accuracy: 293/896 (32.7009%)
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 443/896 (49.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4994, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 359/1418 (25.3173%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 657/1418 (46.3329%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8435, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0488, Accuracy: 361/1275 (28.3137%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 703/1275 (55.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 9.4007, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 167/773 (21.6041%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 425/773 (54.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.1658, Accuracy: 70/10000 (0.7000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 421/1129 (37.2896%)
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 758/1129 (67.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3017, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0528, Accuracy: 381/1574 (24.2058%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 650/1574 (41.2961%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.2681, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0656, Accuracy: 318/901 (35.2941%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 354/901 (39.2897%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.9487, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 56/500 (11.2000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 191/500 (38.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.7475, Accuracy: 45/10000 (0.4500%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 59/486 (12.1399%)
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.3311, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0590, Accuracy: 306/1645 (18.6018%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 595/1645 (36.1702%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8364, Accuracy: 102/10000 (1.0200%)
time spent on training: 135.16198134422302
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3145, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.5388, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.4766137599945 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0785, Accuracy: 24/312 (7.6923%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0424, Accuracy: 164/312 (52.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.5836, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0561, Accuracy: 296/1340 (22.0896%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 544/1340 (40.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.9907, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0628, Accuracy: 236/1131 (20.8665%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 486/1131 (42.9708%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.1737, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 299/896 (33.3705%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 457/896 (51.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.5812, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0589, Accuracy: 257/1513 (16.9861%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 503/1513 (33.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.5602, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 414/1581 (26.1860%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 603/1581 (38.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8423, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 97/631 (15.3724%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 220/631 (34.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1222, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0703, Accuracy: 121/568 (21.3028%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0419, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.0034, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 262/708 (37.0056%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0402, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.0600, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0838, Accuracy: 54/466 (11.5880%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.8134, Accuracy: 50/10000 (0.5000%)
time spent on training: 110.64054346084595
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3483, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.6040, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.0997383594513 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0665, Accuracy: 177/938 (18.8699%)
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 317/938 (33.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.2235, Accuracy: 51/10000 (0.5100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 144/440 (32.7273%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7918, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0644, Accuracy: 244/1402 (17.4037%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 347/1402 (24.7504%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.4470, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0643, Accuracy: 210/605 (34.7107%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.1215, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 134/568 (23.5915%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.0748, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0793, Accuracy: 19/312 (6.0897%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.6437, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0816, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 56/186 (30.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3793, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0599, Accuracy: 280/690 (40.5797%)
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.4817, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0619, Accuracy: 170/861 (19.7445%)
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 453/861 (52.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.6282, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0560, Accuracy: 343/1213 (28.2770%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 465/1213 (38.3347%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.8765, Accuracy: 92/10000 (0.9200%)
time spent on training: 138.51314973831177
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.4534, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.9298, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.8221628665924 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0607, Accuracy: 147/809 (18.1706%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0268, Accuracy: 362/809 (44.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7616, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0657, Accuracy: 187/773 (24.1915%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 374/773 (48.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5799, Accuracy: 60/10000 (0.6000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0807, Accuracy: 45/486 (9.2593%)
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.8058, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0537, Accuracy: 386/1129 (34.1895%)
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 729/1129 (64.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6711, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 39/426 (9.1549%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0405, Accuracy: 171/426 (40.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.1996, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0591, Accuracy: 347/1657 (20.9415%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 487/1657 (29.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7449, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0605, Accuracy: 221/888 (24.8874%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0272, Accuracy: 409/888 (46.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.5313, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0563, Accuracy: 286/1013 (28.2330%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 500/1013 (49.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0698, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0621, Accuracy: 225/636 (35.3774%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0325, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2470, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 397/1750 (22.6857%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0364, Accuracy: 625/1750 (35.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5163, Accuracy: 116/10000 (1.1600%)
time spent on training: 163.71943712234497
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.7672, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 6.7150, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.6875207424164 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0654, Accuracy: 208/1402 (14.8359%)
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 373/1402 (26.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5286, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0632, Accuracy: 236/1241 (19.0169%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7411, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0554, Accuracy: 277/1013 (27.3445%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 449/1013 (44.3238%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.2251, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 409/1581 (25.8697%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0346, Accuracy: 581/1581 (36.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7497, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 42/500 (8.4000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 189/500 (37.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1900, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0609, Accuracy: 211/888 (23.7613%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 444/888 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 9.1031, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 426/1742 (24.4546%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 725/1742 (41.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3817, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0840, Accuracy: 5/373 (1.3405%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9847, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0839, Accuracy: 20/338 (5.9172%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 136/338 (40.2367%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.0339, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0627, Accuracy: 183/861 (21.2544%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 417/861 (48.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3553, Accuracy: 92/10000 (0.9200%)
time spent on training: 132.04470539093018
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1817, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 6.6190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 355.83729100227356 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 285/1340 (21.2687%)
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 532/1340 (39.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.4565, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0548, Accuracy: 397/1581 (25.1107%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 587/1581 (37.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.9834, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0657, Accuracy: 233/708 (32.9096%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0435, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.3013, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0604, Accuracy: 265/928 (28.5560%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 576/928 (62.0690%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0652, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 333/1418 (23.4838%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 611/1418 (43.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.2430, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 361/1427 (25.2978%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 617/1427 (43.2376%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.5068, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 335/1130 (29.6460%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 504/1130 (44.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1493, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 399/1949 (20.4720%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 623/1949 (31.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.5867, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0667, Accuracy: 194/1013 (19.1510%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0366, Accuracy: 342/1013 (33.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.9631, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0683, Accuracy: 190/776 (24.4845%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0302, Accuracy: 367/776 (47.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7556, Accuracy: 68/10000 (0.6800%)
time spent on training: 129.63960194587708
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.5535, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 7.3146, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.83033871650696 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0695, Accuracy: 172/669 (25.7100%)
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0419, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.1682, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0652, Accuracy: 190/773 (24.5796%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0294, Accuracy: 374/773 (48.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.8614, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0652, Accuracy: 230/1241 (18.5334%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 406/1241 (32.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.6832, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0654, Accuracy: 228/708 (32.2034%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0404, Accuracy: 429/708 (60.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.5473, Accuracy: 76/10000 (0.7600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0416, Accuracy: 507/1552 (32.6675%)
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 754/1552 (48.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 11.4416, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1298, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.6540, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0627, Accuracy: 164/568 (28.8732%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 262/568 (46.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.6481, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0587, Accuracy: 265/677 (39.1433%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5565, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0666, Accuracy: 240/946 (25.3700%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 382/946 (40.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.5571, Accuracy: 63/10000 (0.6300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0523, Accuracy: 337/690 (48.8406%)
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0274, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.0192, Accuracy: 62/10000 (0.6200%)
time spent on training: 149.2185001373291
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5276, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 8.8088, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.2670624256134 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0644, Accuracy: 267/1190 (22.4370%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 448/1190 (37.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.6721, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0801, Accuracy: 96/530 (18.1132%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.3317, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0798, Accuracy: 19/426 (4.4601%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 179/426 (42.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.5208, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0624, Accuracy: 212/636 (33.3333%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.8435, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 292/599 (48.7479%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.7816, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0993, Accuracy: 8/408 (1.9608%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0615, Accuracy: 150/408 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.0756, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0682, Accuracy: 309/1163 (26.5692%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0387, Accuracy: 427/1163 (36.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.1400, Accuracy: 58/10000 (0.5800%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0845, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0505, Accuracy: 155/440 (35.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.2440, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.8914, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0552, Accuracy: 313/891 (35.1291%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 472/891 (52.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.8063, Accuracy: 71/10000 (0.7100%)
time spent on training: 144.31288766860962
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.3544, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 9.9379, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.7726216316223 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0526, Accuracy: 402/1440 (27.9167%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 694/1440 (48.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.5242, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0547, Accuracy: 403/1715 (23.4985%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 698/1715 (40.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.2603, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0939, Accuracy: 2/271 (0.7380%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0613, Accuracy: 87/271 (32.1033%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.1716, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0545, Accuracy: 306/891 (34.3434%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 426/891 (47.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9844, Accuracy: 64/10000 (0.6400%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0524, Accuracy: 335/690 (48.5507%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.1854, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0682, Accuracy: 188/1013 (18.5587%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 351/1013 (34.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.6223, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0407, Accuracy: 514/1552 (33.1186%)
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0215, Accuracy: 765/1552 (49.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 11.4011, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0598, Accuracy: 283/1645 (17.2036%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 587/1645 (35.6839%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.4438, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 223/735 (30.3401%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 377/735 (51.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.7727, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0544, Accuracy: 336/1574 (21.3469%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 646/1574 (41.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.6778, Accuracy: 114/10000 (1.1400%)
time spent on training: 153.6918430328369
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.8137, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 11.5458, Accuracy: 0/9950 (0.0000%)
saving model
Done in 377.9946093559265 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0679, Accuracy: 237/946 (25.0529%)
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0382, Accuracy: 331/946 (34.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.7247, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0567, Accuracy: 294/1662 (17.6895%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 604/1662 (36.3418%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.3686, Accuracy: 107/10000 (1.0700%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0834, Accuracy: 36/486 (7.4074%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.5913, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 222/1131 (19.6286%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0292, Accuracy: 514/1131 (45.4465%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9099, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0578, Accuracy: 309/1573 (19.6440%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 575/1573 (36.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.0550, Accuracy: 88/10000 (0.8800%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0605, Accuracy: 240/807 (29.7398%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 421/807 (52.1685%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.4210, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0655, Accuracy: 193/776 (24.8711%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0285, Accuracy: 394/776 (50.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.8412, Accuracy: 87/10000 (0.8700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 4/85 (4.7059%)
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1193, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.1331, Accuracy: 34/10000 (0.3400%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0573, Accuracy: 328/1446 (22.6833%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 480/1446 (33.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7015, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0545, Accuracy: 367/1574 (23.3164%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 671/1574 (42.6302%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.8982, Accuracy: 100/10000 (1.0000%)
time spent on training: 162.206214427948
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 10.8432, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 11.5313, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.728102684021 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0540, Accuracy: 280/1372 (20.4082%)
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0320, Accuracy: 501/1372 (36.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3954, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0674, Accuracy: 256/896 (28.5714%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0355, Accuracy: 463/896 (51.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.2135, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0591, Accuracy: 336/1953 (17.2043%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 693/1953 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1283, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0787, Accuracy: 84/530 (15.8491%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1808, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0799, Accuracy: 20/426 (4.6948%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0425, Accuracy: 177/426 (41.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.0227, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0618, Accuracy: 212/1513 (14.0119%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 481/1513 (31.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0873, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0549, Accuracy: 405/1949 (20.7799%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 622/1949 (31.9138%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3329, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0512, Accuracy: 572/2227 (25.6848%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0290, Accuracy: 996/2227 (44.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4668, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 51/186 (27.4194%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.3625, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0537, Accuracy: 361/1581 (22.8336%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 570/1581 (36.0531%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4506, Accuracy: 93/10000 (0.9300%)
time spent on training: 139.26983833312988
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 11.3724, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 12.0325, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.382883310318 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0749, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 203/500 (40.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1373, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0523, Accuracy: 295/1340 (22.0149%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 534/1340 (39.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.3074, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0874, Accuracy: 39/416 (9.3750%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0495, Accuracy: 172/416 (41.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1263, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0705, Accuracy: 154/938 (16.4179%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0343, Accuracy: 323/938 (34.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1296, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0579, Accuracy: 292/1573 (18.5633%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 534/1573 (33.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0503, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0588, Accuracy: 353/1953 (18.0748%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 698/1953 (35.7399%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1606, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0565, Accuracy: 309/1213 (25.4740%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/1213 (40.3957%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.6625, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0666, Accuracy: 212/1241 (17.0830%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0375, Accuracy: 419/1241 (33.7631%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0355, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0930, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0546, Accuracy: 137/373 (36.7292%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.8991, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1278, Accuracy: 4/85 (4.7059%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.6274, Accuracy: 50/10000 (0.5000%)
time spent on training: 141.61147117614746
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 11.8329, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 14.3426, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.7004020214081 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0742, Accuracy: 75/500 (15.0000%)
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 190/500 (38.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.0928, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 223/776 (28.7371%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 410/776 (52.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.1969, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0937, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0543, Accuracy: 120/373 (32.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.0711, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0558, Accuracy: 376/1715 (21.9242%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0318, Accuracy: 660/1715 (38.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.4196, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0849, Accuracy: 42/460 (9.1304%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 176/460 (38.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.6694, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0620, Accuracy: 120/809 (14.8331%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0286, Accuracy: 323/809 (39.9258%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.9632, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0469, Accuracy: 493/1470 (33.5374%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 815/1470 (55.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8283, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0858, Accuracy: 39/416 (9.3750%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0510, Accuracy: 173/416 (41.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.0033, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0558, Accuracy: 380/1904 (19.9580%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 726/1904 (38.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.0190, Accuracy: 125/10000 (1.2500%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0540, Accuracy: 380/1129 (33.6581%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 711/1129 (62.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.7588, Accuracy: 113/10000 (1.1300%)
time spent on training: 140.20430850982666
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 11.1401, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 13.3381, Accuracy: 0/9950 (0.0000%)
saving model
Done in 369.0872039794922 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0528, Accuracy: 385/1581 (24.3517%)
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 599/1581 (37.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.0811, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0575, Accuracy: 310/1446 (21.4385%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 481/1446 (33.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9101, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0595, Accuracy: 327/1953 (16.7435%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 719/1953 (36.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.2229, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0823, Accuracy: 50/416 (12.0192%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0482, Accuracy: 191/416 (45.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.1075, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0566, Accuracy: 366/1742 (21.0103%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 671/1742 (38.5189%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.4157, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0561, Accuracy: 282/891 (31.6498%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.4040, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0914, Accuracy: 6/466 (1.2876%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0506, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.9617, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0638, Accuracy: 357/1750 (20.4000%)
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 657/1750 (37.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8955, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0579, Accuracy: 323/1418 (22.7786%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 617/1418 (43.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.4961, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0592, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0268, Accuracy: 491/1013 (48.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.6570, Accuracy: 75/10000 (0.7500%)
time spent on training: 153.89544034004211
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 13.9939, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 16.3992, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.89448595046997 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0542, Accuracy: 285/1372 (20.7726%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0322, Accuracy: 488/1372 (35.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.8692, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 337/1427 (23.6160%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0341, Accuracy: 575/1427 (40.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9281, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0815, Accuracy: 58/515 (11.2621%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0532, Accuracy: 130/515 (25.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.1091, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0584, Accuracy: 277/1662 (16.6667%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0349, Accuracy: 554/1662 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.4242, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0659, Accuracy: 221/1402 (15.7632%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 368/1402 (26.2482%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7513, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 220/776 (28.3505%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 383/776 (49.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.3043, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0579, Accuracy: 232/1013 (22.9023%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 522/1013 (51.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.1205, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0620, Accuracy: 369/1587 (23.2514%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0348, Accuracy: 623/1587 (39.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7575, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0533, Accuracy: 394/1956 (20.1431%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 615/1956 (31.4417%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.7527, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0676, Accuracy: 180/1049 (17.1592%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 462/1049 (44.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.5036, Accuracy: 101/10000 (1.0100%)
time spent on training: 152.04355788230896
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 13.7998, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 16.9861, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.9814622402191 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0639, Accuracy: 250/677 (36.9276%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0255, Accuracy: 439/677 (64.8449%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.6606, Accuracy: 59/10000 (0.5900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0556, Accuracy: 336/1628 (20.6388%)
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 765/1628 (46.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.3453, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0859, Accuracy: 58/781 (7.4264%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0394, Accuracy: 211/781 (27.0166%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1480, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1581 (22.0746%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 585/1581 (37.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.4226, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0655, Accuracy: 166/605 (27.4380%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0407, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.2269, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0560, Accuracy: 353/1275 (27.6863%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 663/1275 (52.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.6972, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0577, Accuracy: 398/1715 (23.2070%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0319, Accuracy: 649/1715 (37.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.2564, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0524, Accuracy: 511/2227 (22.9457%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0293, Accuracy: 1024/2227 (45.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.5455, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 311/1003 (31.0070%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 411/1003 (40.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.3818, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 357/1427 (25.0175%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 605/1427 (42.3966%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1137, Accuracy: 73/10000 (0.7300%)
time spent on training: 158.3121452331543
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 12.8577, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 18.6875, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.1186556816101 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0629, Accuracy: 199/1513 (13.1527%)
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 477/1513 (31.5268%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.4223, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0639, Accuracy: 234/807 (28.9963%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0338, Accuracy: 403/807 (49.9380%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.6911, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 275/1372 (20.0437%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 572/1372 (41.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.2381, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0581, Accuracy: 380/1949 (19.4972%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0340, Accuracy: 617/1949 (31.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3738, Accuracy: 99/10000 (0.9900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0551, Accuracy: 353/1628 (21.6830%)
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0262, Accuracy: 813/1628 (49.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.2064, Accuracy: 146/10000 (1.4600%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0545, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 452/690 (65.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3845, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0853, Accuracy: 10/312 (3.2051%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0469, Accuracy: 155/312 (49.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.3325, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0676, Accuracy: 113/818 (13.8142%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0329, Accuracy: 307/818 (37.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.5135, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0599, Accuracy: 281/1645 (17.0821%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 596/1645 (36.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.7862, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0823, Accuracy: 75/530 (14.1509%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3231, Accuracy: 55/10000 (0.5500%)
time spent on training: 175.14600706100464
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 12.8901, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 16.8374, Accuracy: 0/9950 (0.0000%)
saving model
Done in 394.07107973098755 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0719, Accuracy: 242/896 (27.0089%)
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0368, Accuracy: 439/896 (48.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.2969, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0564, Accuracy: 297/1574 (18.8691%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 605/1574 (38.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.0938, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0641, Accuracy: 231/1402 (16.4765%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 385/1402 (27.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5458, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0635, Accuracy: 183/1513 (12.0952%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0382, Accuracy: 401/1513 (26.5036%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.9953, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0917, Accuracy: 4/466 (0.8584%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0519, Accuracy: 182/466 (39.0558%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0283, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0577, Accuracy: 272/1089 (24.9770%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 406/1089 (37.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 12.5104, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0597, Accuracy: 343/1953 (17.5627%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 743/1953 (38.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2854, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0677, Accuracy: 96/568 (16.9014%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.7826, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0600, Accuracy: 296/1418 (20.8745%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 600/1418 (42.3131%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.7182, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 13/338 (3.8462%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 132/338 (39.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.4542, Accuracy: 50/10000 (0.5000%)
time spent on training: 146.32031774520874
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 14.4704, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 18.2368, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.94926261901855 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0621, Accuracy: 316/1657 (19.0706%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0359, Accuracy: 493/1657 (29.7526%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0323, Accuracy: 592/1657 (35.7272%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0314, Accuracy: 618/1657 (37.2963%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0312, Accuracy: 622/1657 (37.5377%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0309, Accuracy: 647/1657 (39.0465%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0298, Accuracy: 669/1657 (40.3742%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0293, Accuracy: 687/1657 (41.4605%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0291, Accuracy: 695/1657 (41.9433%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0290, Accuracy: 701/1657 (42.3054%), train_poison_data_count: 520
Global model norm: 187.3880499124744.
Norm before scaling: 187.3356050147702. Distance: 1.335369859530746
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.1931, Accuracy: 65/10000 (0.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.9400, Accuracy: 8412/9950 (84.5427%)
Scaling by  100
Scaled Norm after poisoning: 225.39503516049328, distance: 133.5369798969559
Total norm for 3 adversaries is: 225.39503516049328. distance: 133.5369798969559
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0587, Accuracy: 392/1949 (20.1129%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 591/1949 (30.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3773, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0838, Accuracy: 36/460 (7.8261%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 182/460 (39.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.1668, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 52/186 (27.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7411, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0656, Accuracy: 248/677 (36.6322%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0280, Accuracy: 454/677 (67.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.8160, Accuracy: 58/10000 (0.5800%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0620, Accuracy: 341/1475 (23.1186%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0335, Accuracy: 590/1475 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.4349, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0668, Accuracy: 256/1131 (22.6348%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0337, Accuracy: 385/1131 (34.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.7133, Accuracy: 55/10000 (0.5500%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0533, Accuracy: 388/1129 (34.3667%)
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0261, Accuracy: 706/1129 (62.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.9040, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 277/1340 (20.6716%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 541/1340 (40.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.3001, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0603, Accuracy: 282/1446 (19.5021%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0360, Accuracy: 509/1446 (35.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9794, Accuracy: 66/10000 (0.6600%)
time spent on training: 247.30658602714539
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7342, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 2.1711, Accuracy: 0/9950 (0.0000%)
saving model
Done in 474.41849160194397 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0709, Accuracy: 223/1645 (13.5562%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 595/1645 (36.1702%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.7265, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0779, Accuracy: 196/1446 (13.5546%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0375, Accuracy: 512/1446 (35.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.9327, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0858, Accuracy: 171/803 (21.2951%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0421, Accuracy: 425/803 (52.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2714, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0566, Accuracy: 419/1470 (28.5034%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0245, Accuracy: 842/1470 (57.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.3588, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.1044, Accuracy: 9/603 (1.4925%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0477, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.0129, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0972, Accuracy: 54/605 (8.9256%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0516, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.9836, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0770, Accuracy: 268/1475 (18.1695%)
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 600/1475 (40.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.5378, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0705, Accuracy: 257/1275 (20.1569%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0215, Accuracy: 594/1275 (46.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 12.0827, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0664, Accuracy: 125/677 (18.4638%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0252, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.5788, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0812, Accuracy: 95/953 (9.9685%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0401, Accuracy: 335/953 (35.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.6842, Accuracy: 69/10000 (0.6900%)
time spent on training: 153.33050322532654
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.5877, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 2.3853, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.6344950199127 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0668, Accuracy: 228/807 (28.2528%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0371, Accuracy: 310/807 (38.4139%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0309, Accuracy: 314/807 (38.9095%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0281, Accuracy: 373/807 (46.2206%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0281, Accuracy: 358/807 (44.3618%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0261, Accuracy: 405/807 (50.1859%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0276, Accuracy: 378/807 (46.8401%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0263, Accuracy: 411/807 (50.9294%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0254, Accuracy: 421/807 (52.1685%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0257, Accuracy: 408/807 (50.5576%), train_poison_data_count: 260
Global model norm: 193.26723120138604.
Norm before scaling: 193.2417931633838. Distance: 0.8760201093551614
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.2631, Accuracy: 67/10000 (0.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.7133, Accuracy: 8652/9950 (86.9548%)
Scaling by  100
Scaled Norm after poisoning: 209.68209754590399, distance: 87.6020108484246
Total norm for 3 adversaries is: 209.68209754590399. distance: 87.6020108484246
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0777, Accuracy: 151/712 (21.2079%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0320, Accuracy: 444/712 (62.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.6250, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0770, Accuracy: 114/888 (12.8378%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0274, Accuracy: 444/888 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.6556, Accuracy: 77/10000 (0.7700%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0761, Accuracy: 267/1750 (15.2571%)
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 597/1750 (34.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8268, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0933, Accuracy: 51/605 (8.4298%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0478, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.6007, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0544, Accuracy: 375/1552 (24.1624%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0215, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.5099, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0749, Accuracy: 212/1446 (14.6611%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 530/1446 (36.6528%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7882, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0883, Accuracy: 184/896 (20.5357%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0408, Accuracy: 427/896 (47.6562%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6997, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.1068, Accuracy: 6/781 (0.7682%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0403, Accuracy: 228/781 (29.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.1750, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0653, Accuracy: 338/1956 (17.2802%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 695/1956 (35.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.6547, Accuracy: 105/10000 (1.0500%)
time spent on training: 233.64242506027222
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.1268, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 1.1421, Accuracy: 5314/9950 (53.4070%)
saving model
Done in 454.41231870651245 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0898, Accuracy: 116/776 (14.9485%)
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0334, Accuracy: 391/776 (50.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.0965, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.1161, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0710, Accuracy: 52/311 (16.7203%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.2692, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0802, Accuracy: 96/773 (12.4191%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0337, Accuracy: 441/773 (57.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.7841, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0678, Accuracy: 260/1213 (21.4345%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 544/1213 (44.8475%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.8578, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0669, Accuracy: 240/1574 (15.2478%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 651/1574 (41.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.2276, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0931, Accuracy: 24/682 (3.5191%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 263/682 (38.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.9243, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.1029, Accuracy: 21/781 (2.6889%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0381, Accuracy: 237/781 (30.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8505, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0678, Accuracy: 255/1645 (15.5015%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 610/1645 (37.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8768, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0577, Accuracy: 527/2227 (23.6641%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1018/2227 (45.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8247, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0680, Accuracy: 331/1953 (16.9483%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 725/1953 (37.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3927, Accuracy: 109/10000 (1.0900%)
time spent on training: 160.53286147117615
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 15.6808, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 0.9466, Accuracy: 5798/9950 (58.2714%)
saving model
Done in 380.4405493736267 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0501, Accuracy: 442/1552 (28.4794%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0239, Accuracy: 646/1552 (41.6237%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0217, Accuracy: 755/1552 (48.6469%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0211, Accuracy: 815/1552 (52.5129%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0205, Accuracy: 844/1552 (54.3814%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0197, Accuracy: 863/1552 (55.6057%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0186, Accuracy: 891/1552 (57.4098%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0193, Accuracy: 904/1552 (58.2474%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0189, Accuracy: 911/1552 (58.6985%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0189, Accuracy: 900/1552 (57.9897%), train_poison_data_count: 496
Global model norm: 199.00273828203973.
Norm before scaling: 198.94859378429896. Distance: 1.2950913906620378
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 10.2795, Accuracy: 76/10000 (0.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.5701, Accuracy: 8552/9950 (85.9497%)
Scaling by  100
Scaled Norm after poisoning: 232.49256540532645, distance: 129.50913939757302
Total norm for 3 adversaries is: 232.49256540532645. distance: 129.50913939757302
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0989, Accuracy: 11/530 (2.0755%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0442, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.8757, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0936, Accuracy: 3/500 (0.6000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0523, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.8127, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0610, Accuracy: 166/813 (20.4182%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 472/813 (58.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.4001, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0704, Accuracy: 124/735 (16.8707%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0239, Accuracy: 352/735 (47.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.7493, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0744, Accuracy: 109/953 (11.4376%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 305/953 (32.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.0769, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0777, Accuracy: 139/599 (23.2053%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0368, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 14.5922, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0676, Accuracy: 253/1036 (24.4208%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 719/1036 (69.4015%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.5560, Accuracy: 78/10000 (0.7800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0721, Accuracy: 270/1750 (15.4286%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 656/1750 (37.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8450, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0801, Accuracy: 142/1131 (12.5553%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 483/1131 (42.7056%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.8321, Accuracy: 100/10000 (1.0000%)
time spent on training: 237.57930326461792
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9612, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 2.3869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 465.9736490249634 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0898, Accuracy: 184/1036 (17.7606%)
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0265, Accuracy: 666/1036 (64.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 15.2810, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.1341, Accuracy: 3/781 (0.3841%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0420, Accuracy: 226/781 (28.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.1189, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.1584, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.1026, Accuracy: 6/311 (1.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.3260, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.1024, Accuracy: 141/803 (17.5592%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0465, Accuracy: 408/803 (50.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.0184, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0856, Accuracy: 202/1662 (12.1540%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0346, Accuracy: 568/1662 (34.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.9245, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.1033, Accuracy: 184/1163 (15.8212%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0400, Accuracy: 409/1163 (35.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.0808, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.1034, Accuracy: 147/1131 (12.9973%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0346, Accuracy: 372/1131 (32.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.1487, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.1353, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0536, Accuracy: 268/603 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.5342, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0939, Accuracy: 172/1130 (15.2212%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 470/1130 (41.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 11.0688, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0956, Accuracy: 154/1402 (10.9843%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0404, Accuracy: 402/1402 (28.6733%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1334, Accuracy: 73/10000 (0.7300%)
time spent on training: 144.36845326423645
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.6485, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 2.4115, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.0046908855438 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0849, Accuracy: 140/599 (23.3723%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0325, Accuracy: 328/599 (54.7579%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0270, Accuracy: 367/599 (61.2688%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0273, Accuracy: 368/599 (61.4357%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0252, Accuracy: 381/599 (63.6060%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0249, Accuracy: 392/599 (65.4424%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0253, Accuracy: 390/599 (65.1085%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0247, Accuracy: 398/599 (66.4441%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0230, Accuracy: 418/599 (69.7830%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0237, Accuracy: 382/599 (63.7730%), train_poison_data_count: 200
Global model norm: 204.55927281291846.
Norm before scaling: 204.5385813239155. Distance: 0.8333569920678248
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.1781, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.3562, Accuracy: 8481/9950 (85.2362%)
Scaling by  100
Scaled Norm after poisoning: 218.80043168661712, distance: 83.33570276579391
Total norm for 3 adversaries is: 218.80043168661712. distance: 83.33570276579391
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0928, Accuracy: 111/1049 (10.5815%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 510/1049 (48.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.2495, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0794, Accuracy: 271/1742 (15.5568%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 698/1742 (40.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6985, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0754, Accuracy: 250/1275 (19.6078%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 704/1275 (55.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.1110, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0656, Accuracy: 494/2227 (22.1823%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0289, Accuracy: 1022/2227 (45.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.0078, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.1064, Accuracy: 50/773 (6.4683%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0379, Accuracy: 383/773 (49.5472%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.4779, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.1217, Accuracy: 43/460 (9.3478%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0465, Accuracy: 154/460 (33.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.0366, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0764, Accuracy: 256/1574 (16.2643%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 684/1574 (43.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.4605, Accuracy: 118/10000 (1.1800%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.1361, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0668, Accuracy: 44/440 (10.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.0364, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0769, Accuracy: 280/1475 (18.9831%)
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 660/1475 (44.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.4326, Accuracy: 100/10000 (1.0000%)
time spent on training: 242.7561662197113
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.9203, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.2678, Accuracy: 9116/9950 (91.6181%)
saving model
Done in 461.7335205078125 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0890, Accuracy: 126/1049 (12.0114%)
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 517/1049 (49.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.7658, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0796, Accuracy: 244/1036 (23.5521%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 670/1036 (64.6718%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 12.7483, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0845, Accuracy: 178/1402 (12.6961%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0406, Accuracy: 388/1402 (27.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2006, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.1506, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0677, Accuracy: 47/312 (15.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7529, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0909, Accuracy: 134/690 (19.4203%)
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0327, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.7630, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.1108, Accuracy: 21/682 (3.0792%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 261/682 (38.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.6947, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0897, Accuracy: 181/803 (22.5405%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0387, Accuracy: 421/803 (52.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.1063, Accuracy: 55/10000 (0.5500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0872, Accuracy: 199/1154 (17.2444%)
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 443/1154 (38.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.1558, Accuracy: 73/10000 (0.7300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0623, Accuracy: 298/1657 (17.9843%)
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0336, Accuracy: 534/1657 (32.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.2718, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0813, Accuracy: 139/677 (20.5318%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 459/677 (67.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 12.6327, Accuracy: 59/10000 (0.5900%)
time spent on training: 177.9767234325409
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5902, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 1.6797, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.9128658771515 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Average loss: 0.0553, Accuracy: 450/1628 (27.6413%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Average loss: 0.0279, Accuracy: 717/1628 (44.0418%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Average loss: 0.0235, Accuracy: 863/1628 (53.0098%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Average loss: 0.0225, Accuracy: 912/1628 (56.0197%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Average loss: 0.0221, Accuracy: 932/1628 (57.2482%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Average loss: 0.0215, Accuracy: 965/1628 (59.2752%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Average loss: 0.0217, Accuracy: 958/1628 (58.8452%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Average loss: 0.0202, Accuracy: 1005/1628 (61.7322%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Average loss: 0.0200, Accuracy: 997/1628 (61.2408%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Average loss: 0.0203, Accuracy: 995/1628 (61.1179%), train_poison_data_count: 520
Global model norm: 209.9969772847933.
Norm before scaling: 209.93619752498614. Distance: 1.3567214585861203
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.5897, Accuracy: 130/10000 (1.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.5691, Accuracy: 8821/9950 (88.6533%)
Scaling by  100
Scaled Norm after poisoning: 244.47795145984023, distance: 135.67214762295538
Total norm for 3 adversaries is: 244.47795145984023. distance: 135.67214762295538
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0763, Accuracy: 173/1513 (11.4342%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 483/1513 (31.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2906, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.1341, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0622, Accuracy: 74/373 (19.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.1563, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0836, Accuracy: 128/1013 (12.6357%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 355/1013 (35.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.7945, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0774, Accuracy: 270/1418 (19.0409%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 605/1418 (42.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.6559, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0853, Accuracy: 116/953 (12.1721%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0407, Accuracy: 315/953 (33.0535%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.9761, Accuracy: 76/10000 (0.7600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0396, Accuracy: 499/1552 (32.1521%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 814/1552 (52.4485%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.4298, Accuracy: 91/10000 (0.9100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.1193, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0541, Accuracy: 94/440 (21.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.7087, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0887, Accuracy: 138/776 (17.7835%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0375, Accuracy: 369/776 (47.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.1429, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1221, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0516, Accuracy: 143/416 (34.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.5045, Accuracy: 75/10000 (0.7500%)
time spent on training: 247.5410189628601
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.8285, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.5862, Accuracy: 8520/9950 (85.6281%)
saving model
Done in 471.0803897380829 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0871, Accuracy: 155/1241 (12.4899%)
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0383, Accuracy: 414/1241 (33.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.4231, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0933, Accuracy: 87/590 (14.7458%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0367, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 13.9639, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.1207, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0602, Accuracy: 144/500 (28.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.3727, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0901, Accuracy: 153/803 (19.0535%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0416, Accuracy: 420/803 (52.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.1776, Accuracy: 63/10000 (0.6300%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0859, Accuracy: 167/1154 (14.4714%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 516/1154 (44.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.8269, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1971, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.1589, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.7091, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.1037, Accuracy: 58/636 (9.1195%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0396, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.7047, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0708, Accuracy: 279/1581 (17.6471%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 597/1581 (37.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5063, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0733, Accuracy: 270/928 (29.0948%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0276, Accuracy: 542/928 (58.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.8043, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0701, Accuracy: 259/1574 (16.4549%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 670/1574 (42.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.2952, Accuracy: 110/10000 (1.1000%)
time spent on training: 165.92865633964539
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.3322, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 1.2306, Accuracy: 5380/9950 (54.0704%)
saving model
Done in 384.10286498069763 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Average loss: 0.0703, Accuracy: 205/861 (23.8095%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Average loss: 0.0280, Accuracy: 348/861 (40.4181%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Average loss: 0.0219, Accuracy: 430/861 (49.9419%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Average loss: 0.0209, Accuracy: 458/861 (53.1940%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Average loss: 0.0196, Accuracy: 493/861 (57.2590%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Average loss: 0.0193, Accuracy: 522/861 (60.6272%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Average loss: 0.0196, Accuracy: 499/861 (57.9559%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Average loss: 0.0187, Accuracy: 516/861 (59.9303%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Average loss: 0.0185, Accuracy: 501/861 (58.1882%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Average loss: 0.0186, Accuracy: 513/861 (59.5819%), train_poison_data_count: 280
Global model norm: 215.2492378035286.
Norm before scaling: 215.21888385722568. Distance: 1.1116706306943511
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.4732, Accuracy: 102/10000 (1.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.7237, Accuracy: 7996/9950 (80.3618%)
Scaling by  100
Scaled Norm after poisoning: 239.2907162323687, distance: 111.16704684701982
Total norm for 4 adversaries is: 239.2907162323687. distance: 111.16704684701982
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1825, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.1500, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.6529, Accuracy: 101/10000 (1.0100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0263, Accuracy: 733/1628 (45.0246%)
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0204, Accuracy: 976/1628 (59.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.0626, Accuracy: 159/10000 (1.5900%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0705, Accuracy: 312/1988 (15.6942%)
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0366, Accuracy: 643/1988 (32.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.2864, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.1114, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0583, Accuracy: 159/500 (31.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.5927, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.1425, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0866, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5422, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0867, Accuracy: 133/1131 (11.7595%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 487/1131 (43.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.0926, Accuracy: 105/10000 (1.0500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0751, Accuracy: 268/1750 (15.3143%)
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0368, Accuracy: 644/1750 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.9549, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0689, Accuracy: 276/928 (29.7414%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0263, Accuracy: 531/928 (57.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.2875, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0824, Accuracy: 155/1241 (12.4899%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0385, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.5130, Accuracy: 64/10000 (0.6400%)
time spent on training: 256.50700640678406
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 14.4360, Accuracy: 75/10000 (0.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 1.4703, Accuracy: 3945/9950 (39.6482%)
saving model
Done in 485.8498203754425 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0882, Accuracy: 149/1241 (12.0064%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0388, Accuracy: 385/1241 (31.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.6856, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0827, Accuracy: 190/1446 (13.1397%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0366, Accuracy: 501/1446 (34.6473%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.0446, Accuracy: 70/10000 (0.7000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.2359, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.2151, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.7189, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.1102, Accuracy: 12/682 (1.7595%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0422, Accuracy: 258/682 (37.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.0102, Accuracy: 56/10000 (0.5600%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.1306, Accuracy: 4/440 (0.9091%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0636, Accuracy: 60/440 (13.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4179, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.1613, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0802, Accuracy: 40/408 (9.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.6009, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0761, Accuracy: 100/735 (13.6054%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0268, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 13.2222, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0810, Accuracy: 203/1130 (17.9646%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0314, Accuracy: 461/1130 (40.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.1215, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.1169, Accuracy: 80/715 (11.1888%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0520, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8806, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0749, Accuracy: 306/1988 (15.3924%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 630/1988 (31.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2693, Accuracy: 86/10000 (0.8600%)
time spent on training: 178.08072662353516
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4961, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 2.2864, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.75543332099915 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0744, Accuracy: 321/1154 (27.8163%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0308, Accuracy: 486/1154 (42.1144%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0236, Accuracy: 617/1154 (53.4662%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0235, Accuracy: 613/1154 (53.1196%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0237, Accuracy: 607/1154 (52.5997%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0225, Accuracy: 632/1154 (54.7660%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0227, Accuracy: 646/1154 (55.9792%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0217, Accuracy: 643/1154 (55.7192%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0221, Accuracy: 669/1154 (57.9723%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0220, Accuracy: 667/1154 (57.7990%), train_poison_data_count: 362
Global model norm: 220.41468374974477.
Norm before scaling: 220.3691505179434. Distance: 1.3775748506346042
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.6930, Accuracy: 71/10000 (0.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.8910, Accuracy: 7157/9950 (71.9296%)
Scaling by  100
Scaled Norm after poisoning: 255.661794417938, distance: 137.7574932739595
Total norm for 2 adversaries is: 255.661794417938. distance: 137.7574932739595
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0975, Accuracy: 58/773 (7.5032%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0358, Accuracy: 391/773 (50.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.1033, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0894, Accuracy: 100/712 (14.0449%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0327, Accuracy: 440/712 (61.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.5073, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0701, Accuracy: 117/735 (15.9184%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0283, Accuracy: 324/735 (44.0816%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 12.9334, Accuracy: 60/10000 (0.6000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0214, Accuracy: 482/861 (55.9814%)
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0166, Accuracy: 578/861 (67.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.6629, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0733, Accuracy: 269/1662 (16.1853%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0346, Accuracy: 573/1662 (34.4765%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.5218, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0832, Accuracy: 234/1418 (16.5021%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0330, Accuracy: 636/1418 (44.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.6070, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0860, Accuracy: 147/803 (18.3064%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0391, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.8764, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.1086, Accuracy: 63/708 (8.8983%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0428, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.8553, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0728, Accuracy: 282/1742 (16.1883%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 707/1742 (40.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.6478, Accuracy: 92/10000 (0.9200%)
time spent on training: 249.89577293395996
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.4152, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 2.4145, Accuracy: 0/9950 (0.0000%)
saving model
Done in 472.3817310333252 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1189, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0594, Accuracy: 139/500 (27.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.7865, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0917, Accuracy: 146/1154 (12.6516%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 442/1154 (38.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 12.7794, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0757, Accuracy: 243/1030 (23.5922%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0281, Accuracy: 554/1030 (53.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.8072, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.1385, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0623, Accuracy: 79/426 (18.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.5460, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0969, Accuracy: 123/946 (13.0021%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0408, Accuracy: 374/946 (39.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.8588, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0834, Accuracy: 177/1213 (14.5919%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0294, Accuracy: 516/1213 (42.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.2836, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0834, Accuracy: 180/1130 (15.9292%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/1130 (43.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.6146, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.1039, Accuracy: 32/818 (3.9120%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0352, Accuracy: 332/818 (40.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.8975, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0830, Accuracy: 232/1402 (16.5478%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0400, Accuracy: 378/1402 (26.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.3646, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0964, Accuracy: 81/1013 (7.9961%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0371, Accuracy: 354/1013 (34.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.2425, Accuracy: 73/10000 (0.7300%)
time spent on training: 154.60564041137695
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 14.5517, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 2.0021, Accuracy: 3252/9950 (32.6834%)
saving model
Done in 380.9033031463623 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Average loss: 0.0700, Accuracy: 165/690 (23.9130%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Average loss: 0.0316, Accuracy: 354/690 (51.3043%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Average loss: 0.0235, Accuracy: 356/690 (51.5942%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Average loss: 0.0222, Accuracy: 397/690 (57.5362%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Average loss: 0.0200, Accuracy: 437/690 (63.3333%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Average loss: 0.0201, Accuracy: 429/690 (62.1739%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Average loss: 0.0195, Accuracy: 430/690 (62.3188%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Average loss: 0.0193, Accuracy: 433/690 (62.7536%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Average loss: 0.0191, Accuracy: 439/690 (63.6232%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Average loss: 0.0185, Accuracy: 447/690 (64.7826%), train_poison_data_count: 220
Global model norm: 225.41251247712492.
Norm before scaling: 225.3882327646011. Distance: 0.8850757989912627
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.8570, Accuracy: 65/10000 (0.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.5789, Accuracy: 7722/9950 (77.6080%)
Scaling by  100
Scaled Norm after poisoning: 239.73391010920838, distance: 88.50758044865422
Total norm for 1 adversaries is: 239.73391010920838. distance: 88.50758044865422
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0765, Accuracy: 185/1089 (16.9881%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 512/1089 (47.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 12.4041, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0926, Accuracy: 168/1190 (14.1176%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 445/1190 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.5217, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0712, Accuracy: 232/1574 (14.7395%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 652/1574 (41.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.8814, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0740, Accuracy: 267/1440 (18.5417%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0286, Accuracy: 703/1440 (48.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.9741, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0871, Accuracy: 168/803 (20.9215%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0404, Accuracy: 440/803 (54.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.2299, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.1509, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0786, Accuracy: 39/408 (9.5588%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3957, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0771, Accuracy: 142/677 (20.9749%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0259, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 12.2820, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0591, Accuracy: 81/426 (19.0141%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0795, Accuracy: 241/1418 (16.9958%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0334, Accuracy: 606/1418 (42.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.9369, Accuracy: 90/10000 (0.9000%)
time spent on training: 219.40706062316895
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 19.5562, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 1.2484, Accuracy: 4909/9950 (49.3367%)
saving model
Done in 439.8565173149109 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0793, Accuracy: 122/1013 (12.0434%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0369, Accuracy: 372/1013 (36.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.8711, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.1053, Accuracy: 28/605 (4.6281%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0469, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4268, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1820, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.1402, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1927, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0817, Accuracy: 177/803 (22.0423%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4107, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0913, Accuracy: 188/1190 (15.7983%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0338, Accuracy: 440/1190 (36.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.6155, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0689, Accuracy: 266/1573 (16.9104%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0355, Accuracy: 578/1573 (36.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4019, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.1036, Accuracy: 87/708 (12.2881%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0396, Accuracy: 424/708 (59.8870%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.2877, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0996, Accuracy: 33/809 (4.0791%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0302, Accuracy: 306/809 (37.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.0872, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0772, Accuracy: 171/1513 (11.3020%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0378, Accuracy: 447/1513 (29.5440%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.5345, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0809, Accuracy: 162/1241 (13.0540%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0396, Accuracy: 397/1241 (31.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.1836, Accuracy: 67/10000 (0.6700%)
time spent on training: 165.2431778907776
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.0150, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 0.8096, Accuracy: 6196/9950 (62.2714%)
saving model
Done in 387.139182806015 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Average loss: 0.0916, Accuracy: 116/486 (23.8683%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Average loss: 0.0504, Accuracy: 158/486 (32.5103%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Average loss: 0.0375, Accuracy: 165/486 (33.9506%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Average loss: 0.0334, Accuracy: 198/486 (40.7407%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Average loss: 0.0340, Accuracy: 215/486 (44.2387%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Average loss: 0.0320, Accuracy: 221/486 (45.4733%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Average loss: 0.0317, Accuracy: 235/486 (48.3539%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Average loss: 0.0298, Accuracy: 236/486 (48.5597%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Average loss: 0.0298, Accuracy: 242/486 (49.7942%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Average loss: 0.0287, Accuracy: 238/486 (48.9712%), train_poison_data_count: 160
Global model norm: 230.3195131225316.
Norm before scaling: 230.30308664616285. Distance: 0.7755756301598441
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.4199, Accuracy: 38/10000 (0.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.5375, Accuracy: 8657/9950 (87.0050%)
Scaling by  100
Scaled Norm after poisoning: 241.34067272737101, distance: 77.55756115923676
Total norm for 2 adversaries is: 241.34067272737101. distance: 77.55756115923676
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0863, Accuracy: 94/636 (14.7799%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0333, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.7405, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0696, Accuracy: 161/677 (23.7814%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 454/677 (67.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 12.0528, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0846, Accuracy: 103/1049 (9.8189%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 500/1049 (47.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.3824, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0919, Accuracy: 42/568 (7.3944%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0468, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.9517, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0663, Accuracy: 265/1573 (16.8468%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0356, Accuracy: 558/1573 (35.4736%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.4513, Accuracy: 83/10000 (0.8300%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0502, Accuracy: 295/1154 (25.5633%)
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0266, Accuracy: 541/1154 (46.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.8388, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0660, Accuracy: 320/1953 (16.3850%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0345, Accuracy: 756/1953 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1202, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0737, Accuracy: 250/1645 (15.1976%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 596/1645 (36.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.0756, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0698, Accuracy: 162/1013 (15.9921%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0276, Accuracy: 484/1013 (47.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.6532, Accuracy: 72/10000 (0.7200%)
time spent on training: 237.8681333065033
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1340, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.7376, Accuracy: 7510/9950 (75.4774%)
saving model
Done in 465.81118297576904 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0722, Accuracy: 265/1418 (18.6883%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0344, Accuracy: 607/1418 (42.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.6212, Accuracy: 88/10000 (0.8800%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0751, Accuracy: 235/1129 (20.8149%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0271, Accuracy: 665/1129 (58.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.4806, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0821, Accuracy: 66/568 (11.6197%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0455, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.6194, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0663, Accuracy: 300/1440 (20.8333%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0286, Accuracy: 691/1440 (47.9861%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.1031, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0657, Accuracy: 241/1030 (23.3981%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 590/1030 (57.2816%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.3820, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.1056, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0407, Accuracy: 164/460 (35.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.1070, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.1180, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0946, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.6271, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0697, Accuracy: 196/928 (21.1207%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 595/928 (64.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.8202, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0605, Accuracy: 101/373 (27.0777%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0404, Accuracy: 157/373 (42.0912%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.4850, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0738, Accuracy: 244/901 (27.0810%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0350, Accuracy: 421/901 (46.7259%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.7596, Accuracy: 58/10000 (0.5800%)
time spent on training: 159.05869030952454
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.3684, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 0.8212, Accuracy: 7002/9950 (70.3719%)
saving model
Done in 381.22907280921936 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Average loss: 0.0632, Accuracy: 315/1129 (27.9008%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Average loss: 0.0290, Accuracy: 530/1129 (46.9442%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Average loss: 0.0242, Accuracy: 601/1129 (53.2329%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Average loss: 0.0234, Accuracy: 620/1129 (54.9159%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Average loss: 0.0217, Accuracy: 648/1129 (57.3959%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Average loss: 0.0210, Accuracy: 664/1129 (58.8131%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Average loss: 0.0214, Accuracy: 657/1129 (58.1931%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Average loss: 0.0208, Accuracy: 697/1129 (61.7360%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Average loss: 0.0197, Accuracy: 695/1129 (61.5589%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Average loss: 0.0207, Accuracy: 668/1129 (59.1674%), train_poison_data_count: 360
Global model norm: 235.16041732187838.
Norm before scaling: 235.11567963983177. Distance: 1.1504748172747679
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.4833, Accuracy: 93/10000 (0.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.5412, Accuracy: 8175/9950 (82.1608%)
Scaling by  100
Scaled Norm after poisoning: 257.4895628952754, distance: 115.04748934543291
Total norm for 2 adversaries is: 257.4895628952754. distance: 115.04748934543291
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0645, Accuracy: 350/1904 (18.3824%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 716/1904 (37.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2963, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0852, Accuracy: 50/809 (6.1805%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0295, Accuracy: 329/809 (40.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.2673, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0713, Accuracy: 256/1418 (18.0536%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0330, Accuracy: 614/1418 (43.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.6666, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0809, Accuracy: 214/1003 (21.3360%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0393, Accuracy: 369/1003 (36.7896%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.0467, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0623, Accuracy: 291/1573 (18.4997%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 585/1573 (37.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.1255, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0474, Accuracy: 405/1552 (26.0954%)
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 734/1552 (47.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.9710, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0688, Accuracy: 165/1049 (15.7293%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 497/1049 (47.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.6957, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0598, Accuracy: 287/1275 (22.5098%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0209, Accuracy: 616/1275 (48.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.0288, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0649, Accuracy: 307/1949 (15.7517%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0350, Accuracy: 574/1949 (29.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.7285, Accuracy: 86/10000 (0.8600%)
time spent on training: 274.12887263298035
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.7550, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 1.7746, Accuracy: 0/9950 (0.0000%)
saving model
Done in 496.1314742565155 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0723, Accuracy: 94/735 (12.7891%)
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0274, Accuracy: 363/735 (49.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 12.4254, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0784, Accuracy: 248/1418 (17.4894%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0341, Accuracy: 595/1418 (41.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8187, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0927, Accuracy: 75/636 (11.7925%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0349, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 10.8641, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0875, Accuracy: 140/1131 (12.3784%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0327, Accuracy: 504/1131 (44.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.2165, Accuracy: 107/10000 (1.0700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0659, Accuracy: 231/1154 (20.0173%)
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0269, Accuracy: 512/1154 (44.3674%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.9495, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0550, Accuracy: 125/416 (30.0481%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.2389, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0671, Accuracy: 361/1953 (18.4844%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 776/1953 (39.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.6200, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0836, Accuracy: 222/1190 (18.6555%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 451/1190 (37.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.1843, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.1348, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0639, Accuracy: 43/338 (12.7219%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.2361, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0724, Accuracy: 296/1715 (17.2595%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0319, Accuracy: 687/1715 (40.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.7951, Accuracy: 89/10000 (0.8900%)
time spent on training: 183.57137966156006
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 13.1386, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 0.2697, Accuracy: 8905/9950 (89.4975%)
saving model
Saving model on epoch 40
Done in 413.9871962070465 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Average loss: 0.0645, Accuracy: 515/1750 (29.4286%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Average loss: 0.0352, Accuracy: 738/1750 (42.1714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Average loss: 0.0296, Accuracy: 854/1750 (48.8000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Average loss: 0.0289, Accuracy: 868/1750 (49.6000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Average loss: 0.0282, Accuracy: 899/1750 (51.3714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Average loss: 0.0277, Accuracy: 912/1750 (52.1143%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Average loss: 0.0270, Accuracy: 941/1750 (53.7714%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Average loss: 0.0269, Accuracy: 922/1750 (52.6857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Average loss: 0.0266, Accuracy: 930/1750 (53.1429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Average loss: 0.0263, Accuracy: 946/1750 (54.0571%), train_poison_data_count: 560
Global model norm: 239.84909806740987.
Norm before scaling: 239.7717094576631. Distance: 1.4449408800907384
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5790, Accuracy: 105/10000 (1.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.5276, Accuracy: 9018/9950 (90.6332%)
Scaling by  100
Scaled Norm after poisoning: 272.92043254399255, distance: 144.49407967975714
Total norm for 1 adversaries is: 272.92043254399255. distance: 144.49407967975714
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.1312, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0819, Accuracy: 29/311 (9.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.3272, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0791, Accuracy: 221/1402 (15.7632%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0403, Accuracy: 367/1402 (26.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.3168, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0977, Accuracy: 49/605 (8.0992%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0475, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.4900, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.1130, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0537, Accuracy: 155/466 (33.2618%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9080, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.1114, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0540, Accuracy: 74/373 (19.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9433, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0877, Accuracy: 94/636 (14.7799%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0361, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.8933, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0692, Accuracy: 263/1340 (19.6269%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0296, Accuracy: 560/1340 (41.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.5233, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0922, Accuracy: 80/773 (10.3493%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0342, Accuracy: 355/773 (45.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 11.0469, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0699, Accuracy: 309/1440 (21.4583%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 717/1440 (49.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.2857, Accuracy: 81/10000 (0.8100%)
time spent on training: 233.65368151664734
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.3999, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.7094, Accuracy: 8123/9950 (81.6382%)
saving model
Saving model on epoch 41
Done in 458.1155002117157 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0576, Accuracy: 311/1628 (19.1032%)
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0247, Accuracy: 862/1628 (52.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.4637, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0975, Accuracy: 46/669 (6.8759%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0451, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.7072, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0670, Accuracy: 115/603 (19.0713%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0476, Accuracy: 252/603 (41.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.3388, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0693, Accuracy: 141/813 (17.3432%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0203, Accuracy: 448/813 (55.1046%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 13.7922, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.1366, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0799, Accuracy: 25/312 (8.0128%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.1559, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0640, Accuracy: 452/2227 (20.2964%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 954/2227 (42.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.8895, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0729, Accuracy: 215/1036 (20.7529%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0280, Accuracy: 612/1036 (59.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 13.6671, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0887, Accuracy: 208/901 (23.0855%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0383, Accuracy: 386/901 (42.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.4661, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0806, Accuracy: 108/1049 (10.2955%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/1049 (46.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.5542, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1656, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.1362, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.3091, Accuracy: 106/10000 (1.0600%)
time spent on training: 187.38079166412354
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1288, Accuracy: 75/10000 (0.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 1.2879, Accuracy: 5089/9950 (51.1457%)
saving model
Saving model on epoch 42
Done in 411.42685890197754 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Average loss: 0.0812, Accuracy: 84/440 (19.0909%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Average loss: 0.0560, Accuracy: 141/440 (32.0455%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Average loss: 0.0396, Accuracy: 185/440 (42.0455%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Average loss: 0.0370, Accuracy: 210/440 (47.7273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Average loss: 0.0358, Accuracy: 205/440 (46.5909%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Average loss: 0.0364, Accuracy: 201/440 (45.6818%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Average loss: 0.0338, Accuracy: 205/440 (46.5909%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Average loss: 0.0333, Accuracy: 208/440 (47.2727%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Average loss: 0.0309, Accuracy: 221/440 (50.2273%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Average loss: 0.0311, Accuracy: 211/440 (47.9545%), train_poison_data_count: 140
Global model norm: 244.43914599292398.
Norm before scaling: 244.42488301623467. Distance: 0.6740660316541008
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.1353, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.3793, Accuracy: 9174/9950 (92.2010%)
Scaling by  100
Scaled Norm after poisoning: 252.09446859014975, distance: 67.4066049480687
Total norm for 3 adversaries is: 252.09446859014975. distance: 67.4066049480687
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0911, Accuracy: 47/818 (5.7457%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 351/818 (42.9095%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.6001, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0838, Accuracy: 117/1131 (10.3448%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0327, Accuracy: 466/1131 (41.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.9558, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0635, Accuracy: 158/813 (19.4342%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 463/813 (56.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 13.9915, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0975, Accuracy: 1/486 (0.2058%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0434, Accuracy: 200/486 (41.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.3768, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.1074, Accuracy: 15/530 (2.8302%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0476, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.1485, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0948, Accuracy: 55/669 (8.2212%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0456, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.7520, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0666, Accuracy: 246/1573 (15.6389%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0359, Accuracy: 561/1573 (35.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1860, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.1217, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0779, Accuracy: 40/271 (14.7601%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.8415, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0572, Accuracy: 296/1628 (18.1818%)
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 807/1628 (49.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.3695, Accuracy: 123/10000 (1.2300%)
time spent on training: 242.90581917762756
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.6815, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.4425, Accuracy: 8927/9950 (89.7186%)
saving model
Done in 474.7281653881073 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0701, Accuracy: 205/1030 (19.9029%)
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0275, Accuracy: 583/1030 (56.6019%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.5898, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.1153, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0787, Accuracy: 43/271 (15.8672%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.2946, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0752, Accuracy: 210/896 (23.4375%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0381, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.3058, Accuracy: 62/10000 (0.6200%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0559, Accuracy: 351/1129 (31.0895%)
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0230, Accuracy: 737/1129 (65.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.9983, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0801, Accuracy: 231/901 (25.6382%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0376, Accuracy: 364/901 (40.3996%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.3182, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0714, Accuracy: 115/861 (13.3566%)
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 453/861 (52.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 11.6165, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1398, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1297, Accuracy: 5/134 (3.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.7835, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.1225, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0652, Accuracy: 65/408 (15.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.3346, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 44/312 (14.1026%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0530, Accuracy: 153/312 (49.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2113, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1740, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1585, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.0988, Accuracy: 64/10000 (0.6400%)
time spent on training: 169.74164462089539
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5423, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.2186, Accuracy: 9598/9950 (96.4623%)
saving model
Done in 395.2166063785553 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Average loss: 0.0618, Accuracy: 306/1071 (28.5714%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Average loss: 0.0303, Accuracy: 441/1071 (41.1765%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Average loss: 0.0262, Accuracy: 493/1071 (46.0317%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Average loss: 0.0243, Accuracy: 588/1071 (54.9020%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Average loss: 0.0236, Accuracy: 580/1071 (54.1550%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Average loss: 0.0234, Accuracy: 608/1071 (56.7694%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Average loss: 0.0228, Accuracy: 610/1071 (56.9561%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Average loss: 0.0222, Accuracy: 613/1071 (57.2362%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Average loss: 0.0222, Accuracy: 609/1071 (56.8627%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Average loss: 0.0226, Accuracy: 581/1071 (54.2484%), train_poison_data_count: 340
Global model norm: 248.98590415674138.
Norm before scaling: 248.9418857886314. Distance: 1.0949226088152253
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.6861, Accuracy: 77/10000 (0.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.3776, Accuracy: 8939/9950 (89.8392%)
Scaling by  100
Scaled Norm after poisoning: 267.7129409460813, distance: 109.49225411387556
Total norm for 2 adversaries is: 267.7129409460813. distance: 109.49225411387556
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0712, Accuracy: 137/568 (24.1197%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0452, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.2101, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0928, Accuracy: 3/486 (0.6173%)
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0453, Accuracy: 208/486 (42.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.9750, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0766, Accuracy: 232/901 (25.7492%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/901 (47.3918%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.5642, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0972, Accuracy: 31/530 (5.8491%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0485, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.0854, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0765, Accuracy: 141/1131 (12.4668%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0328, Accuracy: 474/1131 (41.9098%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.8698, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0954, Accuracy: 7/466 (1.5021%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0513, Accuracy: 176/466 (37.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.7318, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0766, Accuracy: 139/590 (23.5593%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0368, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 12.8477, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0713, Accuracy: 189/1372 (13.7755%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0340, Accuracy: 494/1372 (36.0058%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.3193, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0730, Accuracy: 259/1163 (22.2700%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 468/1163 (40.2408%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8710, Accuracy: 45/10000 (0.4500%)
time spent on training: 235.94913578033447
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 12.6442, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.3865, Accuracy: 8680/9950 (87.2362%)
saving model
Done in 460.2050926685333 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0843, Accuracy: 245/1427 (17.1689%)
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0362, Accuracy: 557/1427 (39.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.1284, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0815, Accuracy: 208/1662 (12.5150%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0359, Accuracy: 544/1662 (32.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.7775, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0807, Accuracy: 89/735 (12.1088%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0267, Accuracy: 374/735 (50.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 12.3892, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.1109, Accuracy: 16/605 (2.6446%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0498, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.0665, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.1187, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0475, Accuracy: 176/486 (36.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.6368, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.1375, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0647, Accuracy: 108/426 (25.3521%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.2503, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0751, Accuracy: 239/1574 (15.1842%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0295, Accuracy: 621/1574 (39.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.4245, Accuracy: 96/10000 (0.9600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.2134, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1949, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.4104, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0901, Accuracy: 129/938 (13.7527%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0388, Accuracy: 313/938 (33.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.1870, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0914, Accuracy: 178/896 (19.8661%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0397, Accuracy: 454/896 (50.6696%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0874, Accuracy: 62/10000 (0.6200%)
time spent on training: 195.8879418373108
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 14.7918, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.7649, Accuracy: 7410/9950 (74.4724%)
saving model
Done in 416.7853317260742 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Average loss: 0.0949, Accuracy: 11/85 (12.9412%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Average loss: 0.0905, Accuracy: 19/85 (22.3529%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Average loss: 0.0833, Accuracy: 32/85 (37.6471%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Average loss: 0.0824, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Average loss: 0.0768, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Average loss: 0.0777, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Average loss: 0.0780, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Average loss: 0.0780, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Average loss: 0.0741, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Average loss: 0.0754, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Global model norm: 253.44556090756453.
Norm before scaling: 253.44314112094256. Distance: 0.16232959886653442
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.9167, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0786, Accuracy: 9919/9950 (99.6884%)
Scaling by  100
Scaled Norm after poisoning: 253.71769344834823, distance: 16.232960379596413
Total norm for 4 adversaries is: 253.71769344834823. distance: 16.232960379596413
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0934, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0459, Accuracy: 105/440 (23.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.2333, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0978, Accuracy: 50/953 (5.2466%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0428, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.4087, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0697, Accuracy: 254/1036 (24.5174%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 660/1036 (63.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 13.5523, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0885, Accuracy: 56/603 (9.2869%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0503, Accuracy: 291/603 (48.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.5381, Accuracy: 60/10000 (0.6000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0568, Accuracy: 373/1750 (21.3143%)
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0336, Accuracy: 697/1750 (39.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.5102, Accuracy: 110/10000 (1.1000%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0620, Accuracy: 279/1628 (17.1376%)
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 781/1628 (47.9730%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 10.2791, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0744, Accuracy: 282/1904 (14.8109%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 700/1904 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.3099, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0889, Accuracy: 166/1089 (15.2433%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 464/1089 (42.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 10.9533, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0885, Accuracy: 95/1013 (9.3781%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0373, Accuracy: 374/1013 (36.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.2921, Accuracy: 73/10000 (0.7300%)
time spent on training: 266.5327217578888
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.8012, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0373, Accuracy: 9943/9950 (99.9296%)
saving model
Done in 497.99008345603943 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0708, Accuracy: 259/1949 (13.2889%)
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0354, Accuracy: 566/1949 (29.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.8431, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0924, Accuracy: 43/416 (10.3365%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0505, Accuracy: 164/416 (39.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0467, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0764, Accuracy: 152/677 (22.4520%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0251, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 12.3862, Accuracy: 60/10000 (0.6000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0661, Accuracy: 333/1988 (16.7505%)
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0370, Accuracy: 616/1988 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.4035, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0827, Accuracy: 184/1190 (15.4622%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 472/1190 (39.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.4507, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0816, Accuracy: 128/1131 (11.3174%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0321, Accuracy: 475/1131 (41.9982%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.0783, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0824, Accuracy: 75/603 (12.4378%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0477, Accuracy: 275/603 (45.6053%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2706, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.1283, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0493, Accuracy: 122/460 (26.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.5205, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0731, Accuracy: 223/1213 (18.3842%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 481/1213 (39.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.1635, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0792, Accuracy: 171/1402 (12.1969%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 389/1402 (27.7461%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2316, Accuracy: 76/10000 (0.7600%)
time spent on training: 193.14543914794922
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.5785, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 1.7228, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 412.94185614585876 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Average loss: 0.0610, Accuracy: 484/1475 (32.8136%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Average loss: 0.0312, Accuracy: 636/1475 (43.1186%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Average loss: 0.0269, Accuracy: 727/1475 (49.2881%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Average loss: 0.0261, Accuracy: 759/1475 (51.4576%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Average loss: 0.0260, Accuracy: 754/1475 (51.1186%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Average loss: 0.0247, Accuracy: 779/1475 (52.8136%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Average loss: 0.0247, Accuracy: 767/1475 (52.0000%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Average loss: 0.0245, Accuracy: 812/1475 (55.0508%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Average loss: 0.0232, Accuracy: 806/1475 (54.6441%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Average loss: 0.0237, Accuracy: 822/1475 (55.7288%), train_poison_data_count: 463
Global model norm: 257.8526256653207.
Norm before scaling: 257.7836726307545. Distance: 1.309794544022445
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3279, Accuracy: 68/10000 (0.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.6141, Accuracy: 8591/9950 (86.3417%)
Scaling by  100
Scaled Norm after poisoning: 282.6964333653681, distance: 130.97945330279862
Total norm for 2 adversaries is: 282.6964333653681. distance: 130.97945330279862
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0969, Accuracy: 98/708 (13.8418%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0387, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3318, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0739, Accuracy: 80/809 (9.8888%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0298, Accuracy: 345/809 (42.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.8117, Accuracy: 94/10000 (0.9400%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0573, Accuracy: 326/1628 (20.0246%)
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 738/1628 (45.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.8093, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0691, Accuracy: 235/1213 (19.3735%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 548/1213 (45.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.1484, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0783, Accuracy: 212/901 (23.5294%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0374, Accuracy: 422/901 (46.8368%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.7654, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0702, Accuracy: 253/1645 (15.3799%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 630/1645 (38.2979%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2186, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0858, Accuracy: 131/715 (18.3217%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0450, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.8498, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0796, Accuracy: 221/1003 (22.0339%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0389, Accuracy: 365/1003 (36.3908%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3387, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0709, Accuracy: 157/1241 (12.6511%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 404/1241 (32.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3740, Accuracy: 60/10000 (0.6000%)
time spent on training: 285.0446619987488
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8939, Accuracy: 80/10000 (0.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 1.0574, Accuracy: 6359/9950 (63.9095%)
saving model
Done in 508.9210855960846 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0647, Accuracy: 294/1750 (16.8000%)
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0340, Accuracy: 680/1750 (38.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.5710, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0756, Accuracy: 296/1904 (15.5462%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 703/1904 (36.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4345, Accuracy: 132/10000 (1.3200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0694, Accuracy: 326/1988 (16.3984%)
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 651/1988 (32.7465%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.5139, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1091, Accuracy: 15/605 (2.4793%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0509, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.0983, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.1312, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0687, Accuracy: 88/408 (21.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0784, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.1136, Accuracy: 1/631 (0.1585%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0512, Accuracy: 211/631 (33.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4913, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.1190, Accuracy: 1/373 (0.2681%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0623, Accuracy: 60/373 (16.0858%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.9922, Accuracy: 52/10000 (0.5200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0684, Accuracy: 194/1071 (18.1139%)
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0276, Accuracy: 553/1071 (51.6340%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.3308, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0662, Accuracy: 368/1470 (25.0340%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 839/1470 (57.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.1825, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0945, Accuracy: 66/774 (8.5271%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0415, Accuracy: 351/774 (45.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.5819, Accuracy: 72/10000 (0.7200%)
time spent on training: 222.86157250404358
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.6404, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 1.2017, Accuracy: 5364/9950 (53.9095%)
saving model
Saving model on epoch 50
Done in 446.338463306427 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Average loss: 0.0594, Accuracy: 542/1988 (27.2636%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Average loss: 0.0351, Accuracy: 747/1988 (37.5755%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Average loss: 0.0309, Accuracy: 845/1988 (42.5050%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Average loss: 0.0297, Accuracy: 862/1988 (43.3602%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Average loss: 0.0295, Accuracy: 905/1988 (45.5231%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Average loss: 0.0290, Accuracy: 912/1988 (45.8753%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Average loss: 0.0284, Accuracy: 934/1988 (46.9819%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Average loss: 0.0290, Accuracy: 947/1988 (47.6358%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Average loss: 0.0283, Accuracy: 934/1988 (46.9819%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Average loss: 0.0280, Accuracy: 958/1988 (48.1891%), train_poison_data_count: 624
Global model norm: 262.08395601409865.
Norm before scaling: 261.985731362416. Distance: 1.4924142874893416
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3082, Accuracy: 72/10000 (0.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.7388, Accuracy: 8008/9950 (80.4824%)
Scaling by  100
Scaled Norm after poisoning: 292.5559641974506, distance: 149.24143479401087
Total norm for 1 adversaries is: 292.5559641974506. distance: 149.24143479401087
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0709, Accuracy: 283/1645 (17.2036%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0339, Accuracy: 642/1645 (39.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.7123, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0754, Accuracy: 214/1446 (14.7994%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0386, Accuracy: 505/1446 (34.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1013, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1843, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1593, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8854, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0792, Accuracy: 198/803 (24.6575%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0403, Accuracy: 384/803 (47.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8297, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.1202, Accuracy: 1/311 (0.3215%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0766, Accuracy: 34/311 (10.9325%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.9127, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0961, Accuracy: 31/568 (5.4577%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0485, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2138, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.1039, Accuracy: 9/466 (1.9313%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0526, Accuracy: 160/466 (34.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8003, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0828, Accuracy: 199/891 (22.3345%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0328, Accuracy: 399/891 (44.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.3956, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0767, Accuracy: 136/1241 (10.9589%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 398/1241 (32.0709%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.7819, Accuracy: 68/10000 (0.6800%)
time spent on training: 253.35213923454285
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.0866, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 1.3051, Accuracy: 5358/9950 (53.8492%)
saving model
Done in 474.1988067626953 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0690, Accuracy: 212/1275 (16.6275%)
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 677/1275 (53.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 11.9952, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1877, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1674, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3393, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0741, Accuracy: 294/1953 (15.0538%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 745/1953 (38.1464%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.2033, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0834, Accuracy: 153/803 (19.0535%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0414, Accuracy: 432/803 (53.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4253, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0936, Accuracy: 38/809 (4.6972%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0325, Accuracy: 310/809 (38.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.2462, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0795, Accuracy: 268/1956 (13.7014%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 678/1956 (34.6626%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.2192, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0910, Accuracy: 214/1163 (18.4007%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0430, Accuracy: 439/1163 (37.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9552, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0747, Accuracy: 233/1446 (16.1134%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0384, Accuracy: 513/1446 (35.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0894, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0755, Accuracy: 237/1573 (15.0668%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0366, Accuracy: 583/1573 (37.0629%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4816, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0899, Accuracy: 72/818 (8.8020%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0348, Accuracy: 337/818 (41.1980%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.0478, Accuracy: 78/10000 (0.7800%)
time spent on training: 197.39868783950806
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.4789, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 3.6032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.4515733718872 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0897, Accuracy: 44/809 (5.4388%)
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 353/809 (43.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 10.9106, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0915, Accuracy: 87/1013 (8.5884%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0386, Accuracy: 361/1013 (35.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.1581, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0859, Accuracy: 182/1190 (15.2941%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 447/1190 (37.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.0632, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0846, Accuracy: 152/1513 (10.0463%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0387, Accuracy: 458/1513 (30.2710%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.7183, Accuracy: 99/10000 (0.9900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0787, Accuracy: 140/690 (20.2899%)
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0329, Accuracy: 463/690 (67.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.1776, Accuracy: 66/10000 (0.6600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0639, Accuracy: 278/1628 (17.0762%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0269, Accuracy: 723/1628 (44.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.7954, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0733, Accuracy: 231/1573 (14.6853%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0363, Accuracy: 572/1573 (36.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2660, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.1177, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0645, Accuracy: 63/373 (16.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9962, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0826, Accuracy: 115/1241 (9.2667%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 414/1241 (33.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.5135, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0930, Accuracy: 75/590 (12.7119%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0415, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 14.6073, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.9617063999176
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.0641, Accuracy: 66/10000 (0.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.3044, Accuracy: 5281/9950 (53.0754%)
saving model
Done in 445.8185636997223 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0811, Accuracy: 117/1241 (9.4279%)
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0398, Accuracy: 401/1241 (32.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.7779, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0653, Accuracy: 357/1470 (24.2857%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0266, Accuracy: 830/1470 (56.4626%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.9003, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0865, Accuracy: 55/809 (6.7985%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0310, Accuracy: 324/809 (40.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.9306, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0901, Accuracy: 151/928 (16.2716%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0284, Accuracy: 525/928 (56.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.7296, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0861, Accuracy: 124/1131 (10.9637%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 527/1131 (46.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.8795, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0676, Accuracy: 92/408 (22.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.1556, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0854, Accuracy: 97/636 (15.2516%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0383, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.7366, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 157/735 (21.3605%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0247, Accuracy: 330/735 (44.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.6730, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0827, Accuracy: 120/938 (12.7932%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0387, Accuracy: 319/938 (34.0085%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.3468, Accuracy: 65/10000 (0.6500%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0370, Accuracy: 632/1988 (31.7907%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0330, Accuracy: 725/1988 (36.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.0957, Accuracy: 90/10000 (0.9000%)
time spent on training: 195.45399713516235
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.3278, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 1.1104, Accuracy: 6063/9950 (60.9347%)
saving model
Done in 422.1360981464386 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.1153, Accuracy: 5/515 (0.9709%)
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0654, Accuracy: 106/515 (20.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6460, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0774, Accuracy: 168/803 (20.9215%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0384, Accuracy: 428/803 (53.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.3517, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1769, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1570, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9421, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0602, Accuracy: 273/1275 (21.4118%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 668/1275 (52.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.5357, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0730, Accuracy: 224/1036 (21.6216%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 647/1036 (62.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 14.2210, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0676, Accuracy: 302/1446 (20.8852%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0374, Accuracy: 531/1446 (36.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9783, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.1035, Accuracy: 36/669 (5.3812%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0499, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.4205, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0850, Accuracy: 92/774 (11.8863%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0396, Accuracy: 331/774 (42.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.2169, Accuracy: 71/10000 (0.7100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.1044, Accuracy: 65/599 (10.8514%)
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0342, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 15.6510, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.1296, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.1091, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.7558, Accuracy: 52/10000 (0.5200%)
time spent on training: 171.30655646324158
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.0215, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 1.1277, Accuracy: 6177/9950 (62.0804%)
saving model
Done in 388.69147062301636 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.1040, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0579, Accuracy: 77/373 (20.6434%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.3506, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0596, Accuracy: 266/1275 (20.8627%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 656/1275 (51.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.9975, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0805, Accuracy: 156/1513 (10.3106%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0387, Accuracy: 490/1513 (32.3860%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.5203, Accuracy: 100/10000 (1.0000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0691, Accuracy: 169/690 (24.4928%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0308, Accuracy: 462/690 (66.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.6609, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0910, Accuracy: 63/953 (6.6107%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0428, Accuracy: 347/953 (36.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.6749, Accuracy: 66/10000 (0.6600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0513, Accuracy: 426/1552 (27.4485%)
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 743/1552 (47.8737%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.1268, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0809, Accuracy: 133/677 (19.6455%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0267, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.6904, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0708, Accuracy: 237/1036 (22.8764%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 647/1036 (62.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 14.2784, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0824, Accuracy: 155/1402 (11.0556%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0414, Accuracy: 369/1402 (26.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.2704, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0732, Accuracy: 292/1715 (17.0262%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0326, Accuracy: 686/1715 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.0336, Accuracy: 100/10000 (1.0000%)
time spent on training: 232.42853045463562
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.4623, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 1.4393, Accuracy: 5024/9950 (50.4925%)
saving model
Done in 453.42569398880005 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0927, Accuracy: 103/708 (14.5480%)
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0451, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.0364, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0752, Accuracy: 130/1241 (10.4754%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0392, Accuracy: 410/1241 (33.0379%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.7142, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0823, Accuracy: 100/1013 (9.8717%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0373, Accuracy: 372/1013 (36.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.4588, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0587, Accuracy: 152/735 (20.6803%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0241, Accuracy: 336/735 (45.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 11.8411, Accuracy: 58/10000 (0.5800%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0639, Accuracy: 202/1071 (18.8609%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0282, Accuracy: 507/1071 (47.3389%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.2096, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.1004, Accuracy: 5/631 (0.7924%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0503, Accuracy: 240/631 (38.0349%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.9465, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0998, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0541, Accuracy: 93/373 (24.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.4209, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.1035, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9097, Accuracy: 56/10000 (0.5600%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0384, Accuracy: 595/1988 (29.9296%)
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0333, Accuracy: 725/1988 (36.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8412, Accuracy: 73/10000 (0.7300%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0923, Accuracy: 100/599 (16.6945%)
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0340, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 15.8390, Accuracy: 50/10000 (0.5000%)
time spent on training: 204.52891302108765
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 13.5658, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 1.2161, Accuracy: 5857/9950 (58.8643%)
saving model
Done in 432.77961683273315 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0770, Accuracy: 204/1190 (17.1429%)
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 488/1190 (41.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.6566, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0606, Accuracy: 167/813 (20.5412%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0222, Accuracy: 443/813 (54.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 13.4182, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0803, Accuracy: 132/1131 (11.6711%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 477/1131 (42.1751%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1006, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.1185, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0460, Accuracy: 142/460 (30.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.6628, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0799, Accuracy: 147/1513 (9.7158%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0386, Accuracy: 482/1513 (31.8572%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.5195, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1649, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1405, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.4849, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.1109, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0557, Accuracy: 111/426 (26.0563%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.7285, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0853, Accuracy: 185/901 (20.5327%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0374, Accuracy: 371/901 (41.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5168, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0753, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0340, Accuracy: 414/1131 (36.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0406, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0835, Accuracy: 64/603 (10.6136%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 279/603 (46.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.9837, Accuracy: 52/10000 (0.5200%)
time spent on training: 177.3699929714203
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 13.4973, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 1.3619, Accuracy: 5316/9950 (53.4271%)
saving model
Done in 400.58005475997925 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.1023, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0576, Accuracy: 140/500 (28.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.6679, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0496, Accuracy: 440/1552 (28.3505%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 736/1552 (47.4227%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.2584, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0835, Accuracy: 117/712 (16.4326%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 432/712 (60.6742%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.4581, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0827, Accuracy: 149/719 (20.7232%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0403, Accuracy: 462/719 (64.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.8322, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0675, Accuracy: 270/1573 (17.1647%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0359, Accuracy: 564/1573 (35.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.2373, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.1080, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0614, Accuracy: 116/408 (28.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.2477, Accuracy: 49/10000 (0.4900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0866, Accuracy: 113/599 (18.8648%)
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0364, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 16.2186, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0723, Accuracy: 208/1131 (18.3908%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 413/1131 (36.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.1694, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0876, Accuracy: 117/715 (16.3636%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0432, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.8164, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0562, Accuracy: 173/735 (23.5374%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 375/735 (51.0204%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.2698, Accuracy: 66/10000 (0.6600%)
time spent on training: 205.86357736587524
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 14.5660, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 1.4048, Accuracy: 5381/9950 (54.0804%)
saving model
Done in 431.71038722991943 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0596, Accuracy: 335/1581 (21.1891%)
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0351, Accuracy: 566/1581 (35.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.6611, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0680, Accuracy: 175/1013 (17.2754%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0286, Accuracy: 471/1013 (46.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.3810, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0722, Accuracy: 300/1587 (18.9036%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0366, Accuracy: 567/1587 (35.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.3069, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0772, Accuracy: 102/774 (13.1783%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0386, Accuracy: 361/774 (46.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.9822, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0638, Accuracy: 251/1213 (20.6925%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 520/1213 (42.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.0645, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0774, Accuracy: 209/891 (23.4568%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0330, Accuracy: 405/891 (45.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.2315, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1581, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1387, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1343, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0934, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0532, Accuracy: 112/312 (35.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6840, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0816, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0457, Accuracy: 130/440 (29.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1971, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0843, Accuracy: 56/603 (9.2869%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0490, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.8406, Accuracy: 54/10000 (0.5400%)
time spent on training: 185.74353694915771
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 13.7176, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 1.8936, Accuracy: 3981/9950 (40.0101%)
saving model
Saving model on epoch 60
Done in 409.48552083969116 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0734, Accuracy: 127/888 (14.3018%)
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0281, Accuracy: 417/888 (46.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 11.4255, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0632, Accuracy: 239/1213 (19.7032%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 517/1213 (42.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.3646, Accuracy: 91/10000 (0.9100%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1473, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1370, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.4409, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0637, Accuracy: 436/2227 (19.5779%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0302, Accuracy: 964/2227 (43.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.8954, Accuracy: 108/10000 (1.0800%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0596, Accuracy: 210/1071 (19.6078%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 493/1071 (46.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.3324, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0720, Accuracy: 213/1131 (18.8329%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0347, Accuracy: 401/1131 (35.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.1251, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0776, Accuracy: 69/809 (8.5290%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0318, Accuracy: 318/809 (39.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.1424, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0742, Accuracy: 156/1241 (12.5705%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0402, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.6782, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0807, Accuracy: 76/1013 (7.5025%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0380, Accuracy: 362/1013 (35.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.2432, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0834, Accuracy: 67/953 (7.0304%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0414, Accuracy: 350/953 (36.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.6851, Accuracy: 70/10000 (0.7000%)
time spent on training: 224.2128632068634
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 14.0324, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 3.1533, Accuracy: 1642/9950 (16.5025%)
saving model
Done in 445.2365219593048 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0978, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0559, Accuracy: 149/500 (29.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.7970, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0679, Accuracy: 250/1645 (15.1976%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0351, Accuracy: 613/1645 (37.2644%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.8821, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0847, Accuracy: 3/373 (0.8043%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0487, Accuracy: 125/373 (33.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.7696, Accuracy: 51/10000 (0.5100%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0413, Accuracy: 533/1988 (26.8109%)
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0346, Accuracy: 712/1988 (35.8149%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.8265, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0639, Accuracy: 429/2227 (19.2636%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 924/2227 (41.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.0361, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0663, Accuracy: 317/1440 (22.0139%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0290, Accuracy: 696/1440 (48.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.9505, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0940, Accuracy: 49/669 (7.3244%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0491, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.1217, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0726, Accuracy: 231/891 (25.9259%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0330, Accuracy: 404/891 (45.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.2570, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0796, Accuracy: 157/1402 (11.1983%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0418, Accuracy: 340/1402 (24.2511%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.6232, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0705, Accuracy: 129/888 (14.5270%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0280, Accuracy: 441/888 (49.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.7134, Accuracy: 64/10000 (0.6400%)
time spent on training: 233.7311201095581
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.2021, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 3.7962, Accuracy: 0/9950 (0.0000%)
saving model
Done in 459.97776532173157 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0791, Accuracy: 101/1013 (9.9704%)
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0375, Accuracy: 361/1013 (35.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.3257, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0770, Accuracy: 110/774 (14.2119%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0388, Accuracy: 332/774 (42.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.3208, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0601, Accuracy: 254/1213 (20.9398%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 514/1213 (42.3743%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.0486, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0600, Accuracy: 237/1030 (23.0097%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0287, Accuracy: 594/1030 (57.6699%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.0164, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0578, Accuracy: 315/1581 (19.9241%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0347, Accuracy: 557/1581 (35.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.7529, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0759, Accuracy: 205/1662 (12.3345%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0369, Accuracy: 554/1662 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.9747, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0787, Accuracy: 201/901 (22.3085%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0417, Accuracy: 420/901 (46.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8102, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1266, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0841, Accuracy: 23/271 (8.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5476, Accuracy: 57/10000 (0.5700%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0619, Accuracy: 210/690 (30.4348%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0305, Accuracy: 449/690 (65.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.4277, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0679, Accuracy: 167/1013 (16.4857%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0288, Accuracy: 469/1013 (46.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.1037, Accuracy: 64/10000 (0.6400%)
time spent on training: 205.36834168434143
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.1245, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 4.4701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.1028780937195 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0760, Accuracy: 126/774 (16.2791%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0386, Accuracy: 347/774 (44.8320%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.8121, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0718, Accuracy: 119/818 (14.5477%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0348, Accuracy: 317/818 (38.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.6003, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0597, Accuracy: 379/1470 (25.7823%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 803/1470 (54.6259%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.1847, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0994, Accuracy: 3/466 (0.6438%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0526, Accuracy: 162/466 (34.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.4148, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0923, Accuracy: 52/669 (7.7728%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0463, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.9575, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 39/486 (8.0247%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.5714, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0776, Accuracy: 172/1402 (12.2682%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0418, Accuracy: 361/1402 (25.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.5037, Accuracy: 72/10000 (0.7200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0569, Accuracy: 339/1628 (20.8231%)
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0277, Accuracy: 734/1628 (45.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.7483, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0678, Accuracy: 155/590 (26.2712%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0350, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 13.1837, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0726, Accuracy: 232/1418 (16.3611%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0354, Accuracy: 604/1418 (42.5952%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2149, Accuracy: 102/10000 (1.0200%)
time spent on training: 216.8545093536377
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.0967, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 4.7759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 437.71320509910583 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0956, Accuracy: 4/416 (0.9615%)
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0543, Accuracy: 148/416 (35.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.3103, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0791, Accuracy: 183/896 (20.4241%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0392, Accuracy: 476/896 (53.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3555, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0672, Accuracy: 187/677 (27.6219%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 456/677 (67.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 12.4013, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0795, Accuracy: 142/708 (20.0565%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0474, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.1227, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0692, Accuracy: 252/1163 (21.6681%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0396, Accuracy: 435/1163 (37.4033%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.1532, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0981, Accuracy: 7/466 (1.5021%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0529, Accuracy: 164/466 (35.1931%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.5239, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0748, Accuracy: 206/1154 (17.8510%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0328, Accuracy: 450/1154 (38.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.5689, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0678, Accuracy: 308/1587 (19.4077%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0372, Accuracy: 548/1587 (34.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.5940, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0670, Accuracy: 327/1953 (16.7435%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 719/1953 (36.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3869, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0694, Accuracy: 203/719 (28.2337%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 456/719 (63.4214%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.5578, Accuracy: 55/10000 (0.5500%)
time spent on training: 215.33706903457642
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 15.5045, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 4.7420, Accuracy: 507/9950 (5.0955%)
saving model
Done in 442.5272727012634 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0788, Accuracy: 137/1131 (12.1132%)
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0330, Accuracy: 439/1131 (38.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.1800, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0831, Accuracy: 65/603 (10.7794%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0485, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.0542, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.1023, Accuracy: 23/515 (4.4660%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0640, Accuracy: 113/515 (21.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.8442, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0802, Accuracy: 140/946 (14.7992%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0398, Accuracy: 347/946 (36.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3164, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0773, Accuracy: 116/1013 (11.4511%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0388, Accuracy: 368/1013 (36.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.4012, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0929, Accuracy: 15/530 (2.8302%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 286/530 (53.9623%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.3651, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0839, Accuracy: 6/373 (1.6086%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0500, Accuracy: 131/373 (35.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.7799, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0849, Accuracy: 39/271 (14.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.8091, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0938, Accuracy: 4/416 (0.9615%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0537, Accuracy: 163/416 (39.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9408, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0637, Accuracy: 276/1003 (27.5174%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0376, Accuracy: 390/1003 (38.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3801, Accuracy: 53/10000 (0.5300%)
time spent on training: 163.69545030593872
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 14.3881, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 3.5524, Accuracy: 1355/9950 (13.6181%)
saving model
Done in 384.98664474487305 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0757, Accuracy: 217/1662 (13.0566%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0376, Accuracy: 552/1662 (33.2130%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.9603, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0675, Accuracy: 258/1645 (15.6839%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0352, Accuracy: 602/1645 (36.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.8313, Accuracy: 107/10000 (1.0700%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0700, Accuracy: 169/599 (28.2137%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0305, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 14.3807, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0700, Accuracy: 149/938 (15.8849%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0361, Accuracy: 330/938 (35.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.7318, Accuracy: 74/10000 (0.7400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0768, Accuracy: 50/486 (10.2881%)
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 223/486 (45.8848%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.6872, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0605, Accuracy: 357/1470 (24.2857%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0266, Accuracy: 803/1470 (54.6259%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.5491, Accuracy: 100/10000 (1.0000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0614, Accuracy: 208/690 (30.1449%)
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0298, Accuracy: 464/690 (67.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.4352, Accuracy: 70/10000 (0.7000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0714, Accuracy: 109/861 (12.6597%)
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0235, Accuracy: 416/861 (48.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 11.6070, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 288/1003 (28.7139%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0367, Accuracy: 392/1003 (39.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.3965, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0759, Accuracy: 117/1513 (7.7330%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 440/1513 (29.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.7132, Accuracy: 93/10000 (0.9300%)
time spent on training: 266.2118036746979
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 13.0157, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 2.8586, Accuracy: 2306/9950 (23.1759%)
saving model
Done in 484.08592104911804 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0671, Accuracy: 323/1953 (16.5387%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0362, Accuracy: 746/1953 (38.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2493, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0686, Accuracy: 143/636 (22.4843%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0334, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.8433, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0579, Accuracy: 258/1213 (21.2696%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 539/1213 (44.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.0435, Accuracy: 82/10000 (0.8200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0567, Accuracy: 368/1750 (21.0286%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 679/1750 (38.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4212, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.1008, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0519, Accuracy: 124/426 (29.1080%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3934, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0674, Accuracy: 236/891 (26.4871%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.4830, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0660, Accuracy: 234/1131 (20.6897%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0343, Accuracy: 371/1131 (32.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.2644, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0959, Accuracy: 15/466 (3.2189%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0508, Accuracy: 178/466 (38.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4746, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0639, Accuracy: 337/1904 (17.6996%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0328, Accuracy: 684/1904 (35.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6770, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0611, Accuracy: 288/1574 (18.2973%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0303, Accuracy: 616/1574 (39.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.5350, Accuracy: 104/10000 (1.0400%)
time spent on training: 245.32986998558044
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 14.2607, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 3.9823, Accuracy: 1693/9950 (17.0151%)
saving model
Done in 471.3401908874512 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0611, Accuracy: 198/677 (29.2467%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 12.7646, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0947, Accuracy: 2/312 (0.6410%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0534, Accuracy: 111/312 (35.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.4199, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0600, Accuracy: 296/1581 (18.7223%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0361, Accuracy: 509/1581 (32.1948%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.6861, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0709, Accuracy: 251/1418 (17.7010%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0351, Accuracy: 554/1418 (39.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.8124, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0660, Accuracy: 161/636 (25.3145%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0325, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.3229, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0567, Accuracy: 252/1213 (20.7749%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 525/1213 (43.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.2539, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0747, Accuracy: 149/712 (20.9270%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 442/712 (62.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 11.1637, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0635, Accuracy: 317/1949 (16.2648%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 607/1949 (31.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.9716, Accuracy: 81/10000 (0.8100%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0748, Accuracy: 162/807 (20.0743%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0367, Accuracy: 428/807 (53.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.9917, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0703, Accuracy: 100/568 (17.6056%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0431, Accuracy: 269/568 (47.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.9829, Accuracy: 58/10000 (0.5800%)
time spent on training: 208.24536180496216
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.1078, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 5.1911, Accuracy: 0/9950 (0.0000%)
saving model
Done in 429.7326910495758 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0662, Accuracy: 247/776 (31.8299%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0306, Accuracy: 410/776 (52.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0808, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0932, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0528, Accuracy: 118/312 (37.8205%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.1218, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0922, Accuracy: 12/408 (2.9412%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0580, Accuracy: 142/408 (34.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4512, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0634, Accuracy: 175/636 (27.5157%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 428/636 (67.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.5431, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0687, Accuracy: 183/599 (30.5509%)
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0313, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 14.9216, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0912, Accuracy: 18/500 (3.6000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0568, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1871, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0601, Accuracy: 334/1742 (19.1734%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0334, Accuracy: 614/1742 (35.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.8469, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0573, Accuracy: 272/1213 (22.4237%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 520/1213 (42.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.2958, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0732, Accuracy: 265/1956 (13.5481%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0336, Accuracy: 618/1956 (31.5951%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0241, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0759, Accuracy: 117/774 (15.1163%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0400, Accuracy: 355/774 (45.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.1061, Accuracy: 70/10000 (0.7000%)
time spent on training: 207.5046625137329
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.1419, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 5.4266, Accuracy: 0/9950 (0.0000%)
saving model
Done in 430.0237352848053 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0823, Accuracy: 75/603 (12.4378%)
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 280/603 (46.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.8754, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0710, Accuracy: 138/1513 (9.1210%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0411, Accuracy: 401/1513 (26.5036%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.4908, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0667, Accuracy: 235/1131 (20.7781%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0341, Accuracy: 415/1131 (36.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.3019, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0775, Accuracy: 222/896 (24.7768%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0386, Accuracy: 475/896 (53.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.4717, Accuracy: 61/10000 (0.6100%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0606, Accuracy: 329/1475 (22.3051%)
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 616/1475 (41.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.8480, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0655, Accuracy: 270/1036 (26.0618%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 637/1036 (61.4865%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 12.9405, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0735, Accuracy: 155/712 (21.7697%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0309, Accuracy: 441/712 (61.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.8300, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0755, Accuracy: 163/715 (22.7972%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0433, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7193, Accuracy: 58/10000 (0.5800%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0770, Accuracy: 15/440 (3.4091%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0449, Accuracy: 139/440 (31.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2637, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0757, Accuracy: 198/1154 (17.1577%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0298, Accuracy: 443/1154 (38.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.5468, Accuracy: 64/10000 (0.6400%)
time spent on training: 235.52078318595886
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.1241, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 5.4735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 460.21718978881836 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0822, Accuracy: 21/416 (5.0481%)
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 174/416 (41.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.2946, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0708, Accuracy: 196/803 (24.4085%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0359, Accuracy: 431/803 (53.6737%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.8413, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0701, Accuracy: 228/891 (25.5892%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0309, Accuracy: 416/891 (46.6891%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.2181, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0664, Accuracy: 236/1131 (20.8665%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 422/1131 (37.3121%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.3513, Accuracy: 71/10000 (0.7100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0567, Accuracy: 323/1628 (19.8403%)
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0285, Accuracy: 694/1628 (42.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.4017, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0821, Accuracy: 29/311 (9.3248%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0591, Accuracy: 127/311 (40.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2671, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0580, Accuracy: 328/1581 (20.7464%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0356, Accuracy: 522/1581 (33.0171%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.0969, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0603, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0287, Accuracy: 476/1013 (46.9891%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.0839, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0618, Accuracy: 199/1030 (19.3204%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0288, Accuracy: 556/1030 (53.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 11.3253, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0591, Accuracy: 390/1470 (26.5306%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0267, Accuracy: 814/1470 (55.3741%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.3149, Accuracy: 101/10000 (1.0100%)
time spent on training: 218.2963891029358
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.1617, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 6.1718, Accuracy: 0/9950 (0.0000%)
saving model
Done in 443.0383286476135 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0794, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 140/373 (37.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.9203, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0922, Accuracy: 9/408 (2.2059%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0555, Accuracy: 145/408 (35.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.2724, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0639, Accuracy: 321/1949 (16.4700%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0360, Accuracy: 556/1949 (28.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.3518, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0940, Accuracy: 22/466 (4.7210%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0533, Accuracy: 164/466 (35.1931%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.4344, Accuracy: 56/10000 (0.5600%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0726, Accuracy: 115/861 (13.3566%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0232, Accuracy: 421/861 (48.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 11.8509, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0618, Accuracy: 264/1573 (16.7832%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 537/1573 (34.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.1955, Accuracy: 76/10000 (0.7600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1398, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1346, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.1249, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0750, Accuracy: 238/901 (26.4151%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0385, Accuracy: 397/901 (44.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.2428, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0674, Accuracy: 228/776 (29.3814%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0338, Accuracy: 365/776 (47.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.2023, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0658, Accuracy: 274/1446 (18.9488%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0399, Accuracy: 488/1446 (33.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.2603, Accuracy: 70/10000 (0.7000%)
time spent on training: 226.38978266716003
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.2262, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 6.0212, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.9443209171295 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0727, Accuracy: 214/715 (29.9301%)
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0414, Accuracy: 434/715 (60.6993%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.2452, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0572, Accuracy: 158/735 (21.4966%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 374/735 (50.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 11.8647, Accuracy: 57/10000 (0.5700%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0606, Accuracy: 326/1475 (22.1017%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 612/1475 (41.4915%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.5268, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0620, Accuracy: 288/1573 (18.3090%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 565/1573 (35.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1691, Accuracy: 81/10000 (0.8100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 327/1750 (18.6857%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 619/1750 (35.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.2884, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0751, Accuracy: 227/901 (25.1942%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0359, Accuracy: 444/901 (49.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.8058, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0703, Accuracy: 247/1190 (20.7563%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 413/1190 (34.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.0113, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0726, Accuracy: 220/1662 (13.2371%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0368, Accuracy: 558/1662 (33.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.3489, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0730, Accuracy: 120/1013 (11.8460%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0383, Accuracy: 357/1013 (35.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.2178, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0708, Accuracy: 251/1418 (17.7010%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 589/1418 (41.5374%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.5908, Accuracy: 90/10000 (0.9000%)
time spent on training: 291.14851093292236
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.2040, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 5.3947, Accuracy: 0/9950 (0.0000%)
saving model
Done in 515.8833830356598 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0455, Accuracy: 437/1552 (28.1572%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0237, Accuracy: 662/1552 (42.6546%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 11.6543, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0731, Accuracy: 149/712 (20.9270%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 424/712 (59.5506%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 11.4196, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0786, Accuracy: 114/669 (17.0404%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0442, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.1630, Accuracy: 58/10000 (0.5800%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0595, Accuracy: 340/1475 (23.0508%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0333, Accuracy: 629/1475 (42.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.8627, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0613, Accuracy: 251/776 (32.3454%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0321, Accuracy: 369/776 (47.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.8851, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0720, Accuracy: 270/1089 (24.7934%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0329, Accuracy: 426/1089 (39.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.2991, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0596, Accuracy: 192/636 (30.1887%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.6451, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0777, Accuracy: 228/928 (24.5690%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0272, Accuracy: 507/928 (54.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.4841, Accuracy: 98/10000 (0.9800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0598, Accuracy: 254/1154 (22.0104%)
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 452/1154 (39.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.4548, Accuracy: 65/10000 (0.6500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0626, Accuracy: 218/690 (31.5942%)
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/690 (65.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.3525, Accuracy: 56/10000 (0.5600%)
time spent on training: 253.2135078907013
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.1453, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 5.8199, Accuracy: 0/9950 (0.0000%)
saving model
Done in 478.0523817539215 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0757, Accuracy: 154/888 (17.3423%)
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0308, Accuracy: 402/888 (45.2703%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.0983, Accuracy: 64/10000 (0.6400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0441, Accuracy: 480/1552 (30.9278%)
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0233, Accuracy: 710/1552 (45.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.5912, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0606, Accuracy: 263/1340 (19.6269%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0283, Accuracy: 561/1340 (41.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.7668, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0645, Accuracy: 241/1131 (21.3086%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0344, Accuracy: 377/1131 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.3392, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0648, Accuracy: 182/773 (23.5446%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0342, Accuracy: 409/773 (52.9107%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.9244, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0775, Accuracy: 226/901 (25.0832%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 415/901 (46.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.8969, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0783, Accuracy: 194/1402 (13.8374%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0431, Accuracy: 341/1402 (24.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.4472, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0723, Accuracy: 228/1662 (13.7184%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0372, Accuracy: 540/1662 (32.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.8810, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0712, Accuracy: 126/1013 (12.4383%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0386, Accuracy: 355/1013 (35.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1937, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0859, Accuracy: 3/312 (0.9615%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0467, Accuracy: 130/312 (41.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.9147, Accuracy: 51/10000 (0.5100%)
time spent on training: 230.89216470718384
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.1148, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 5.8406, Accuracy: 0/9950 (0.0000%)
saving model
Done in 452.579936504364 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0914, Accuracy: 15/466 (3.2189%)
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0520, Accuracy: 159/466 (34.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.2770, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0722, Accuracy: 281/1956 (14.3661%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0349, Accuracy: 560/1956 (28.6299%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8622, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0680, Accuracy: 245/1190 (20.5882%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0345, Accuracy: 417/1190 (35.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.2010, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 26/338 (7.6923%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0525, Accuracy: 137/338 (40.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.1981, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0764, Accuracy: 193/1402 (13.7660%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0422, Accuracy: 314/1402 (22.3966%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.5300, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0553, Accuracy: 267/1213 (22.0115%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 529/1213 (43.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.0937, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0612, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0331, Accuracy: 651/1904 (34.1912%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.3372, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0634, Accuracy: 327/1949 (16.7778%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0352, Accuracy: 563/1949 (28.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8131, Accuracy: 79/10000 (0.7900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0439, Accuracy: 461/1552 (29.7036%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0233, Accuracy: 705/1552 (45.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 12.2029, Accuracy: 91/10000 (0.9100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0609, Accuracy: 259/1154 (22.4437%)
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 421/1154 (36.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.2677, Accuracy: 65/10000 (0.6500%)
time spent on training: 308.3554673194885
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 16.1550, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 3.1778, Accuracy: 2853/9950 (28.6734%)
saving model
Done in 528.0959222316742 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0687, Accuracy: 200/719 (27.8164%)
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0359, Accuracy: 463/719 (64.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.7637, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0669, Accuracy: 191/1241 (15.3908%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0394, Accuracy: 380/1241 (30.6205%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.5724, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0637, Accuracy: 303/1949 (15.5464%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0353, Accuracy: 554/1949 (28.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.9072, Accuracy: 66/10000 (0.6600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1461, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1363, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.1685, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0914, Accuracy: 12/408 (2.9412%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 147/408 (36.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9157, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0674, Accuracy: 285/1089 (26.1708%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0329, Accuracy: 467/1089 (42.8834%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.9468, Accuracy: 90/10000 (0.9000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0750, Accuracy: 160/599 (26.7112%)
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 15.4080, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0699, Accuracy: 313/1953 (16.0266%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0374, Accuracy: 692/1953 (35.4327%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.5263, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0732, Accuracy: 114/818 (13.9364%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0331, Accuracy: 313/818 (38.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.5090, Accuracy: 88/10000 (0.8800%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0775, Accuracy: 45/486 (9.2593%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.7224, Accuracy: 53/10000 (0.5300%)
time spent on training: 249.19223880767822
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 18.5155, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 5.0511, Accuracy: 1592/9950 (16.0000%)
saving model
Done in 471.4383292198181 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0905, Accuracy: 28/515 (5.4369%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0567, Accuracy: 148/515 (28.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0375, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0795, Accuracy: 204/928 (21.9828%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0271, Accuracy: 520/928 (56.0345%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.2172, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0949, Accuracy: 13/466 (2.7897%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0510, Accuracy: 166/466 (35.6223%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5143, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0721, Accuracy: 232/1154 (20.1040%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0328, Accuracy: 449/1154 (38.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 11.0574, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0816, Accuracy: 201/896 (22.4330%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0408, Accuracy: 451/896 (50.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5888, Accuracy: 63/10000 (0.6300%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 249/1071 (23.2493%)
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0308, Accuracy: 493/1071 (46.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.6310, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0802, Accuracy: 137/1372 (9.9854%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0342, Accuracy: 482/1372 (35.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.8271, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0999, Accuracy: 3/460 (0.6522%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0455, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.9313, Accuracy: 51/10000 (0.5100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0753, Accuracy: 163/599 (27.2120%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0328, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 15.4326, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0569, Accuracy: 377/1470 (25.6463%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 811/1470 (55.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0584, Accuracy: 89/10000 (0.8900%)
time spent on training: 229.48414754867554
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 13.1465, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 3.0388, Accuracy: 2291/9950 (23.0251%)
saving model
Done in 452.4923906326294 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0589, Accuracy: 270/1154 (23.3969%)
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 438/1154 (37.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.8610, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0854, Accuracy: 32/500 (6.4000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0541, Accuracy: 168/500 (33.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.7308, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0618, Accuracy: 266/1573 (16.9104%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0375, Accuracy: 535/1573 (34.0114%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3406, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0802, Accuracy: 56/530 (10.5660%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0405, Accuracy: 274/530 (51.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.4314, Accuracy: 71/10000 (0.7100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0609, Accuracy: 344/1750 (19.6571%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0375, Accuracy: 645/1750 (36.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.4591, Accuracy: 106/10000 (1.0600%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0660, Accuracy: 270/1129 (23.9150%)
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0272, Accuracy: 652/1129 (57.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.4601, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0688, Accuracy: 303/1440 (21.0417%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0300, Accuracy: 639/1440 (44.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.0379, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0749, Accuracy: 148/888 (16.6667%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0298, Accuracy: 413/888 (46.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.3743, Accuracy: 70/10000 (0.7000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0697, Accuracy: 293/1657 (17.6826%)
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0379, Accuracy: 467/1657 (28.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.9546, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0558, Accuracy: 399/1470 (27.1429%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 805/1470 (54.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.3246, Accuracy: 104/10000 (1.0400%)
time spent on training: 303.30504274368286
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 13.5482, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 2.1191, Accuracy: 3986/9950 (40.0603%)
saving model
Done in 524.4733860492706 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0734, Accuracy: 84/568 (14.7887%)
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0430, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.3717, Accuracy: 53/10000 (0.5300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0550, Accuracy: 314/1628 (19.2875%)
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0290, Accuracy: 685/1628 (42.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.8040, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.1035, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0858, Accuracy: 6/186 (3.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.7142, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0603, Accuracy: 474/2227 (21.2842%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0311, Accuracy: 947/2227 (42.5236%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.2021, Accuracy: 109/10000 (1.0900%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0765, Accuracy: 100/861 (11.6144%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 431/861 (50.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 12.7975, Accuracy: 86/10000 (0.8600%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0734, Accuracy: 166/807 (20.5700%)
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0381, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.6441, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0628, Accuracy: 217/677 (32.0532%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 445/677 (65.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 12.5641, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0647, Accuracy: 236/1131 (20.8665%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0344, Accuracy: 380/1131 (33.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.4955, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0664, Accuracy: 223/1241 (17.9694%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0397, Accuracy: 372/1241 (29.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4511, Accuracy: 54/10000 (0.5400%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0727, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0432, Accuracy: 160/440 (36.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4413, Accuracy: 63/10000 (0.6300%)
time spent on training: 281.67098808288574
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 13.5910, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 3.8835, Accuracy: 1492/9950 (14.9950%)
saving model
Done in 500.1696288585663 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0788, Accuracy: 208/896 (23.2143%)
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0407, Accuracy: 458/896 (51.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.6357, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0730, Accuracy: 128/818 (15.6479%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0325, Accuracy: 311/818 (38.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.1390, Accuracy: 70/10000 (0.7000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0615, Accuracy: 261/1154 (22.6170%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0333, Accuracy: 391/1154 (33.8821%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 11.2994, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0535, Accuracy: 402/1470 (27.3469%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0259, Accuracy: 806/1470 (54.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.1250, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 360/1581 (22.7704%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0356, Accuracy: 527/1581 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.1222, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0681, Accuracy: 239/1089 (21.9467%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0351, Accuracy: 464/1089 (42.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.8886, Accuracy: 78/10000 (0.7800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0600, Accuracy: 309/1750 (17.6571%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0381, Accuracy: 592/1750 (33.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4973, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0658, Accuracy: 204/1241 (16.4384%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 414/1241 (33.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.8243, Accuracy: 64/10000 (0.6400%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0543, Accuracy: 327/1628 (20.0860%)
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0283, Accuracy: 682/1628 (41.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.4878, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0790, Accuracy: 88/953 (9.2340%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0435, Accuracy: 330/953 (34.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7595, Accuracy: 65/10000 (0.6500%)
time spent on training: 287.54748344421387
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 12.7246, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 3.5598, Accuracy: 1867/9950 (18.7638%)
saving model
Done in 510.444052696228 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 345/1750 (19.7143%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0375, Accuracy: 628/1750 (35.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3264, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0833, Accuracy: 42/530 (7.9245%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0426, Accuracy: 280/530 (52.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.8403, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0682, Accuracy: 259/1418 (18.2652%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0349, Accuracy: 540/1418 (38.0818%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.9565, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0546, Accuracy: 296/1213 (24.4023%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0294, Accuracy: 526/1213 (43.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.1334, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0742, Accuracy: 159/946 (16.8076%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 358/946 (37.8436%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2892, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0629, Accuracy: 298/1742 (17.1068%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0327, Accuracy: 662/1742 (38.0023%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.7416, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0635, Accuracy: 215/1241 (17.3247%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0397, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.4555, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0828, Accuracy: 9/312 (2.8846%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0453, Accuracy: 140/312 (44.8718%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.5027, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0989, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0812, Accuracy: 7/186 (3.7634%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9536, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0716, Accuracy: 243/1662 (14.6209%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0379, Accuracy: 538/1662 (32.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.2147, Accuracy: 91/10000 (0.9100%)
time spent on training: 243.00473141670227
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 12.0719, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 3.3434, Accuracy: 2031/9950 (20.4121%)
saving model
Done in 465.9606132507324 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0712, Accuracy: 175/708 (24.7175%)
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.3593, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0968, Accuracy: 8/408 (1.9608%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0577, Accuracy: 131/408 (32.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.9865, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0803, Accuracy: 115/1049 (10.9628%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0337, Accuracy: 448/1049 (42.7073%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.1409, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0599, Accuracy: 279/1340 (20.8209%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 568/1340 (42.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.3762, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 218/1013 (21.5202%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0286, Accuracy: 471/1013 (46.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.5181, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0897, Accuracy: 90/605 (14.8760%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0521, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7074, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0812, Accuracy: 145/1372 (10.5685%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0362, Accuracy: 481/1372 (35.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.0228, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0691, Accuracy: 270/1163 (23.2158%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0413, Accuracy: 467/1163 (40.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0900, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0547, Accuracy: 227/813 (27.9213%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 474/813 (58.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 12.9156, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0766, Accuracy: 107/603 (17.7446%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0477, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.5669, Accuracy: 48/10000 (0.4800%)
time spent on training: 232.79676246643066
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 11.4767, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 3.1791, Accuracy: 2321/9950 (23.3266%)
saving model
Done in 452.78551745414734 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0757, Accuracy: 51/486 (10.4938%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 201/486 (41.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.9991, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0633, Accuracy: 338/1715 (19.7085%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0331, Accuracy: 667/1715 (38.8921%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.0339, Accuracy: 92/10000 (0.9200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0575, Accuracy: 255/1071 (23.8095%)
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0311, Accuracy: 500/1071 (46.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.8667, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0978, Accuracy: 8/460 (1.7391%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0461, Accuracy: 162/460 (35.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 11.1344, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0760, Accuracy: 104/953 (10.9129%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0427, Accuracy: 315/953 (33.0535%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0658, Accuracy: 205/1241 (16.5189%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0405, Accuracy: 372/1241 (29.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4596, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.1004, Accuracy: 2/426 (0.4695%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0507, Accuracy: 147/426 (34.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5404, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0640, Accuracy: 328/1427 (22.9853%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0349, Accuracy: 584/1427 (40.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.7237, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0760, Accuracy: 125/669 (18.6846%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0443, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.1096, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0533, Accuracy: 220/813 (27.0603%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 492/813 (60.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 12.9494, Accuracy: 61/10000 (0.6100%)
time spent on training: 243.2976667881012
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 11.2898, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 3.3392, Accuracy: 1954/9950 (19.6382%)
saving model
Done in 467.68442845344543 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0899, Accuracy: 81/605 (13.3884%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0514, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.6600, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0844, Accuracy: 55/530 (10.3774%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 288/530 (54.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.4624, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 301/1213 (24.8145%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 515/1213 (42.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.2027, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0871, Accuracy: 40/781 (5.1216%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0396, Accuracy: 236/781 (30.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.6074, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0683, Accuracy: 168/773 (21.7335%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0344, Accuracy: 408/773 (52.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.9453, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0558, Accuracy: 382/1470 (25.9864%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0265, Accuracy: 766/1470 (52.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.2520, Accuracy: 96/10000 (0.9600%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 361/1750 (20.6286%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0372, Accuracy: 657/1750 (37.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.4940, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0554, Accuracy: 291/1275 (22.8235%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0209, Accuracy: 645/1275 (50.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 11.6907, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0453, Accuracy: 407/1552 (26.2242%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0234, Accuracy: 704/1552 (45.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 12.1313, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0632, Accuracy: 319/1715 (18.6006%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0324, Accuracy: 677/1715 (39.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.4162, Accuracy: 88/10000 (0.8800%)
time spent on training: 266.09691882133484
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.7410, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 4.8822, Accuracy: 561/9950 (5.6382%)
saving model
Done in 486.74529695510864 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0653, Accuracy: 366/1587 (23.0624%)
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0383, Accuracy: 565/1587 (35.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.1045, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0733, Accuracy: 149/590 (25.2542%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0354, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 13.4029, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0697, Accuracy: 290/1163 (24.9355%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0406, Accuracy: 470/1163 (40.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.0376, Accuracy: 62/10000 (0.6200%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1514, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1432, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.9752, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0752, Accuracy: 131/818 (16.0147%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0333, Accuracy: 325/818 (39.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.9199, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0741, Accuracy: 194/715 (27.1329%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0448, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.7818, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0659, Accuracy: 207/719 (28.7900%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0347, Accuracy: 461/719 (64.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.0345, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0841, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0518, Accuracy: 140/373 (37.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5621, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0691, Accuracy: 266/1662 (16.0048%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0371, Accuracy: 538/1662 (32.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.1806, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0603, Accuracy: 204/636 (32.0755%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.4742, Accuracy: 52/10000 (0.5200%)
time spent on training: 227.7320168018341
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.7830, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 4.7168, Accuracy: 989/9950 (9.9397%)
saving model
Done in 449.3670620918274 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0940, Accuracy: 41/631 (6.4976%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0514, Accuracy: 224/631 (35.4992%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8079, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0683, Accuracy: 242/1418 (17.0663%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0349, Accuracy: 537/1418 (37.8702%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.9302, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0644, Accuracy: 169/773 (21.8629%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 405/773 (52.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.2053, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0621, Accuracy: 344/1427 (24.1065%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0356, Accuracy: 543/1427 (38.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.7237, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0766, Accuracy: 123/953 (12.9066%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0439, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.2290, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0777, Accuracy: 100/774 (12.9199%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0435, Accuracy: 323/774 (41.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.4807, Accuracy: 63/10000 (0.6300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0691, Accuracy: 282/1657 (17.0187%)
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/1657 (26.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.7279, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0529, Accuracy: 241/813 (29.6433%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 446/813 (54.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 13.5232, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0947, Accuracy: 13/460 (2.8261%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0448, Accuracy: 171/460 (37.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.2097, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.1004, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0849, Accuracy: 6/186 (3.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.2811, Accuracy: 48/10000 (0.4800%)
time spent on training: 246.58331203460693
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.8792, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 5.4113, Accuracy: 432/9950 (4.3417%)
saving model
Done in 473.85458064079285 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0589, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0289, Accuracy: 472/1013 (46.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.6070, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0697, Accuracy: 269/1163 (23.1298%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0413, Accuracy: 425/1163 (36.5434%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2996, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0695, Accuracy: 171/938 (18.2303%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0368, Accuracy: 319/938 (34.0085%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.6035, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0838, Accuracy: 8/311 (2.5723%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0559, Accuracy: 107/311 (34.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.7796, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0866, Accuracy: 7/373 (1.8767%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0519, Accuracy: 131/373 (35.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6830, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0541, Accuracy: 377/1470 (25.6463%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0257, Accuracy: 765/1470 (52.0408%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.9482, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0578, Accuracy: 293/776 (37.7577%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0318, Accuracy: 364/776 (46.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.4024, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1276, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.1042, Accuracy: 2/197 (1.0152%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2416, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0624, Accuracy: 349/1427 (24.4569%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0352, Accuracy: 543/1427 (38.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.4136, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0746, Accuracy: 155/946 (16.3848%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0400, Accuracy: 377/946 (39.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.1072, Accuracy: 60/10000 (0.6000%)
time spent on training: 209.0405569076538
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.7237, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 5.4953, Accuracy: 485/9950 (4.8744%)
saving model
Done in 432.264821767807 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0709, Accuracy: 266/1657 (16.0531%)
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0372, Accuracy: 428/1657 (25.8298%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.6415, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0838, Accuracy: 6/311 (1.9293%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0563, Accuracy: 109/311 (35.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.3295, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0636, Accuracy: 317/1715 (18.4840%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0338, Accuracy: 654/1715 (38.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.1626, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0791, Accuracy: 149/1049 (14.2040%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0336, Accuracy: 477/1049 (45.4719%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.0566, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0736, Accuracy: 227/1154 (19.6707%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0326, Accuracy: 395/1154 (34.2288%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.6909, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0634, Accuracy: 123/735 (16.7347%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0243, Accuracy: 384/735 (52.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.9350, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0739, Accuracy: 254/1956 (12.9857%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 555/1956 (28.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.1505, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0511, Accuracy: 217/813 (26.6913%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 467/813 (57.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 12.9982, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1187, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0967, Accuracy: 10/197 (5.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.3323, Accuracy: 45/10000 (0.4500%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0650, Accuracy: 276/1129 (24.4464%)
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0274, Accuracy: 641/1129 (56.7759%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.1551, Accuracy: 93/10000 (0.9300%)
time spent on training: 266.96630859375
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.2806, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 6.7936, Accuracy: 266/9950 (2.6734%)
saving model
Done in 492.31492733955383 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0649, Accuracy: 353/1587 (22.2432%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0394, Accuracy: 543/1587 (34.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.3916, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0636, Accuracy: 311/1904 (16.3340%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0335, Accuracy: 660/1904 (34.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.9475, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0637, Accuracy: 282/1036 (27.2201%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 641/1036 (61.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 13.4989, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0707, Accuracy: 276/1440 (19.1667%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0311, Accuracy: 650/1440 (45.1389%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.7778, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0913, Accuracy: 41/631 (6.4976%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0494, Accuracy: 231/631 (36.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4919, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1337, Accuracy: 3/134 (2.2388%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1102, Accuracy: 3/134 (2.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.5964, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0655, Accuracy: 277/1573 (17.6097%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0380, Accuracy: 555/1573 (35.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4463, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0824, Accuracy: 159/896 (17.7455%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0414, Accuracy: 450/896 (50.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.1966, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0633, Accuracy: 318/1427 (22.2845%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 541/1427 (37.9117%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4295, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0700, Accuracy: 345/1953 (17.6651%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0379, Accuracy: 667/1953 (34.1526%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4159, Accuracy: 84/10000 (0.8400%)
time spent on training: 297.07366967201233
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 10.4901, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 6.5124, Accuracy: 145/9950 (1.4573%)
saving model
Done in 515.3900113105774 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0567, Accuracy: 294/1275 (23.0588%)
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0209, Accuracy: 627/1275 (49.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 11.7835, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0775, Accuracy: 135/888 (15.2027%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0297, Accuracy: 405/888 (45.6081%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.9317, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0831, Accuracy: 132/1372 (9.6210%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0360, Accuracy: 458/1372 (33.3819%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.0947, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0630, Accuracy: 302/1573 (19.1990%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0379, Accuracy: 539/1573 (34.2657%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2886, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0706, Accuracy: 323/1953 (16.5387%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0385, Accuracy: 651/1953 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2455, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0702, Accuracy: 218/1645 (13.2523%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0369, Accuracy: 536/1645 (32.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.1505, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0755, Accuracy: 201/1190 (16.8908%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0353, Accuracy: 416/1190 (34.9580%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.7027, Accuracy: 61/10000 (0.6100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 315/1628 (19.3489%)
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0295, Accuracy: 634/1628 (38.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.5732, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0576, Accuracy: 314/776 (40.4639%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0321, Accuracy: 345/776 (44.4588%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.3226, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0840, Accuracy: 39/781 (4.9936%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0391, Accuracy: 232/781 (29.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.6145, Accuracy: 65/10000 (0.6500%)
time spent on training: 300.486590385437
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.0379, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 4.8559, Accuracy: 474/9950 (4.7638%)
saving model
Done in 527.2450687885284 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0702, Accuracy: 225/1089 (20.6612%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0304, Accuracy: 489/1089 (44.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.6341, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0596, Accuracy: 331/1581 (20.9361%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0369, Accuracy: 520/1581 (32.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.9387, Accuracy: 94/10000 (0.9400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0748, Accuracy: 106/861 (12.3113%)
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0241, Accuracy: 426/861 (49.4774%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 12.1887, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0730, Accuracy: 151/599 (25.2087%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0318, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 15.2722, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0801, Accuracy: 164/896 (18.3036%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0399, Accuracy: 467/896 (52.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.8862, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0741, Accuracy: 219/928 (23.5991%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0271, Accuracy: 531/928 (57.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.7657, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0739, Accuracy: 143/590 (24.2373%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0359, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.0231, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0796, Accuracy: 96/809 (11.8665%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0324, Accuracy: 331/809 (40.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.1718, Accuracy: 82/10000 (0.8200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0762, Accuracy: 42/486 (8.6420%)
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 221/486 (45.4733%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.9224, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0611, Accuracy: 242/1574 (15.3748%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0314, Accuracy: 546/1574 (34.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.6179, Accuracy: 84/10000 (0.8400%)
time spent on training: 256.6362478733063
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.1438, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 5.4470, Accuracy: 173/9950 (1.7387%)
saving model
Done in 477.8825943470001 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0635, Accuracy: 327/1427 (22.9152%)
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0358, Accuracy: 562/1427 (39.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.6223, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0869, Accuracy: 20/271 (7.3801%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.2657, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0786, Accuracy: 100/603 (16.5837%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0515, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.6894, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0704, Accuracy: 167/1513 (11.0377%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0398, Accuracy: 437/1513 (28.8830%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.0285, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0671, Accuracy: 192/719 (26.7038%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0353, Accuracy: 459/719 (63.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.9473, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0894, Accuracy: 67/605 (11.0744%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0513, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.3754, Accuracy: 49/10000 (0.4900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0612, Accuracy: 221/690 (32.0290%)
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.6872, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0845, Accuracy: 35/530 (6.6038%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0436, Accuracy: 272/530 (51.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.5700, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0626, Accuracy: 261/1130 (23.0973%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0311, Accuracy: 468/1130 (41.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.0673, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1216, Accuracy: 1/197 (0.5076%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.1038, Accuracy: 11/197 (5.5838%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.2547, Accuracy: 54/10000 (0.5400%)
time spent on training: 247.32351446151733
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.2843, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 4.6713, Accuracy: 398/9950 (4.0000%)
saving model
Done in 466.1369800567627 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0757, Accuracy: 168/1402 (11.9829%)
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0433, Accuracy: 314/1402 (22.3966%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4105, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0604, Accuracy: 295/1003 (29.4118%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0367, Accuracy: 389/1003 (38.7836%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5299, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0757, Accuracy: 117/953 (12.2770%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0417, Accuracy: 348/953 (36.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5349, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0641, Accuracy: 393/1587 (24.7637%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0388, Accuracy: 529/1587 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4793, Accuracy: 67/10000 (0.6700%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0671, Accuracy: 280/1129 (24.8007%)
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0281, Accuracy: 619/1129 (54.8273%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.7099, Accuracy: 91/10000 (0.9100%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 232/1071 (21.6620%)
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 493/1071 (46.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.8839, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0930, Accuracy: 27/515 (5.2427%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0603, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.8543, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0770, Accuracy: 81/568 (14.2606%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0473, Accuracy: 261/568 (45.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4966, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0688, Accuracy: 231/1154 (20.0173%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0328, Accuracy: 379/1154 (32.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 11.1169, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0606, Accuracy: 310/1581 (19.6078%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0366, Accuracy: 524/1581 (33.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.8517, Accuracy: 92/10000 (0.9200%)
time spent on training: 277.5876352787018
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.7525, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 5.8529, Accuracy: 53/9950 (0.5327%)
saving model
Done in 504.70597672462463 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0752, Accuracy: 265/1956 (13.5481%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0343, Accuracy: 577/1956 (29.4990%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.2275, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0851, Accuracy: 43/781 (5.5058%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0420, Accuracy: 228/781 (29.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.8879, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0639, Accuracy: 320/1715 (18.6589%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0343, Accuracy: 654/1715 (38.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.0938, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0759, Accuracy: 189/901 (20.9767%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0372, Accuracy: 416/901 (46.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.1882, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0740, Accuracy: 207/928 (22.3060%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0270, Accuracy: 534/928 (57.5431%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.7712, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0891, Accuracy: 34/338 (10.0592%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0501, Accuracy: 128/338 (37.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.6145, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0879, Accuracy: 47/631 (7.4485%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0504, Accuracy: 243/631 (38.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7282, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0913, Accuracy: 68/605 (11.2397%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0545, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.9653, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0775, Accuracy: 138/590 (23.3898%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0355, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 13.2375, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0697, Accuracy: 221/1645 (13.4347%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0366, Accuracy: 561/1645 (34.1033%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.1589, Accuracy: 101/10000 (1.0100%)
time spent on training: 237.12228512763977
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.2939, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 6.4650, Accuracy: 36/9950 (0.3618%)
saving model
Done in 457.32037115097046 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0634, Accuracy: 301/1427 (21.0932%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0352, Accuracy: 534/1427 (37.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.5920, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 241/677 (35.5982%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 12.7172, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0848, Accuracy: 107/712 (15.0281%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 455/712 (63.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 11.8811, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0908, Accuracy: 61/605 (10.0826%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0543, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.3153, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.1291, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0875, Accuracy: 20/271 (7.3801%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.1423, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0790, Accuracy: 83/809 (10.2596%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0333, Accuracy: 333/809 (41.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.6504, Accuracy: 76/10000 (0.7600%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0583, Accuracy: 376/1988 (18.9135%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0379, Accuracy: 627/1988 (31.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9418, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0629, Accuracy: 222/1241 (17.8888%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0400, Accuracy: 387/1241 (31.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.8898, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0846, Accuracy: 35/781 (4.4814%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0406, Accuracy: 219/781 (28.0410%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.7094, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0843, Accuracy: 37/530 (6.9811%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0395, Accuracy: 273/530 (51.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.3963, Accuracy: 62/10000 (0.6200%)
time spent on training: 259.557740688324
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.3336, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 7.1892, Accuracy: 14/9950 (0.1407%)
saving model
Done in 480.23346614837646 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0690, Accuracy: 216/891 (24.2424%)
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0304, Accuracy: 445/891 (49.9439%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9006, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0730, Accuracy: 140/669 (20.9268%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0438, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.8485, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0797, Accuracy: 157/1372 (11.4431%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0353, Accuracy: 464/1372 (33.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.8165, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0544, Accuracy: 271/1213 (22.3413%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0303, Accuracy: 527/1213 (43.4460%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.1316, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0644, Accuracy: 255/1131 (22.5464%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0348, Accuracy: 355/1131 (31.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.2469, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0957, Accuracy: 2/373 (0.5362%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0566, Accuracy: 108/373 (28.9544%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.0943, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0574, Accuracy: 288/1275 (22.5882%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 674/1275 (52.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 11.8624, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0628, Accuracy: 146/735 (19.8639%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0246, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 12.0469, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0893, Accuracy: 35/631 (5.5468%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0496, Accuracy: 234/631 (37.0840%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.7812, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0963, Accuracy: 6/460 (1.3043%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0471, Accuracy: 176/460 (38.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9164, Accuracy: 53/10000 (0.5300%)
time spent on training: 223.99295020103455
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.1120, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 7.2191, Accuracy: 22/9950 (0.2211%)
saving model
Done in 442.05118060112 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0776, Accuracy: 97/953 (10.1784%)
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0439, Accuracy: 305/953 (32.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.7822, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0923, Accuracy: 10/500 (2.0000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0550, Accuracy: 182/500 (36.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.6128, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0971, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0513, Accuracy: 147/426 (34.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.4171, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0719, Accuracy: 167/938 (17.8038%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0380, Accuracy: 311/938 (33.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.6249, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0728, Accuracy: 155/599 (25.8765%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 15.6331, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0773, Accuracy: 190/1190 (15.9664%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0353, Accuracy: 414/1190 (34.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.0241, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0654, Accuracy: 273/1036 (26.3514%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 636/1036 (61.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 13.7184, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0691, Accuracy: 274/1440 (19.0278%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0325, Accuracy: 620/1440 (43.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.7265, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0587, Accuracy: 217/1013 (21.4215%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0287, Accuracy: 460/1013 (45.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.4665, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0684, Accuracy: 218/1446 (15.0761%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0392, Accuracy: 478/1446 (33.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4564, Accuracy: 71/10000 (0.7100%)
time spent on training: 242.7550618648529
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.7304, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.8590, Accuracy: 159/9950 (1.5980%)
saving model
Done in 467.8665761947632 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0726, Accuracy: 299/1163 (25.7094%)
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0408, Accuracy: 446/1163 (38.3491%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2316, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0616, Accuracy: 312/1581 (19.7343%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0375, Accuracy: 516/1581 (32.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.1859, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0743, Accuracy: 190/803 (23.6613%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0410, Accuracy: 422/803 (52.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.0966, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0659, Accuracy: 198/719 (27.5382%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0330, Accuracy: 464/719 (64.5341%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.9182, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0895, Accuracy: 10/416 (2.4038%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0509, Accuracy: 164/416 (39.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.9944, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0691, Accuracy: 293/1440 (20.3472%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0316, Accuracy: 649/1440 (45.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.6036, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0731, Accuracy: 231/1662 (13.8989%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0379, Accuracy: 551/1662 (33.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.1158, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0693, Accuracy: 158/669 (23.6173%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0439, Accuracy: 351/669 (52.4664%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.0757, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0729, Accuracy: 158/938 (16.8443%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0382, Accuracy: 292/938 (31.1301%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.1456, Accuracy: 61/10000 (0.6100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0693, Accuracy: 244/1154 (21.1438%)
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0348, Accuracy: 375/1154 (32.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.9672, Accuracy: 67/10000 (0.6700%)
time spent on training: 292.65721440315247
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.7726, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 5.6088, Accuracy: 165/9950 (1.6583%)
saving model
Done in 512.0488364696503 sec.
Saving all the graphs.
This run has a label: Jun.12_15.08.59. Visdom environment: tiny
