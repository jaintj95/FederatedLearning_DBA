current path: saved_models/model_tiny_Jun.29_07.30.30
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 419/1953 (21.4542%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 750/1953 (38.4025%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.4207, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 463/1988 (23.2897%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0398, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.3097, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5991, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5910, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 473/1071 (44.1643%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5417, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 634/1587 (39.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1283, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 438/1715 (25.5394%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 713/1715 (41.5743%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9394, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 315/1154 (27.2964%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 384/1154 (33.2756%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7610, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 172/416 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5500, Accuracy: 50/10000 (0.5000%)
time spent on training: 86.84783506393433
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 85, 64, 95, 54, 55, 27, 92, 15, 78], weight: tensor([0.1554, 0.1582, 0.0758, 0.0477, 0.0899, 0.0852, 0.1263, 0.1365, 0.0918,
        0.0331])
[rfa agg] iter:  0, prev_obj_val: 62.07011032104492, obj_val: 65.47191619873047, abs dis: 3.401805877685547
[rfa agg] iter: 0, weight: tensor([0.0801, 0.0742, 0.0648, 0.0224, 0.1487, 0.1079, 0.1592, 0.1165, 0.2140,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 65.47191619873047, obj_val: 70.65213775634766, abs dis: 5.1802215576171875
[rfa agg] iter: 1, weight: tensor([0.0418, 0.0393, 0.0601, 0.0171, 0.2231, 0.1271, 0.0674, 0.0549, 0.3604,
        0.0089])
[rfa agg] iter:  2, prev_obj_val: 70.65213775634766, obj_val: 72.98973846435547, abs dis: 2.3376007080078125
[rfa agg] iter: 2, weight: tensor([0.0349, 0.0331, 0.0871, 0.0192, 0.2926, 0.2590, 0.0508, 0.0435, 0.1702,
        0.0095])
[rfa agg] iter:  3, prev_obj_val: 72.98973846435547, obj_val: 70.57650756835938, abs dis: 2.4132308959960938
[rfa agg] iter: 3, weight: tensor([0.0337, 0.0320, 0.1067, 0.0206, 0.2230, 0.3573, 0.0476, 0.0413, 0.1278,
        0.0100])
[rfa agg] iter:  4, prev_obj_val: 70.57650756835938, obj_val: 72.97516632080078, abs dis: 2.3986587524414062
[rfa agg] iter: 4, weight: tensor([0.0331, 0.0314, 0.0833, 0.0182, 0.2758, 0.3100, 0.0481, 0.0412, 0.1499,
        0.0090])
[rfa agg] iter:  5, prev_obj_val: 72.97516632080078, obj_val: 72.95951080322266, abs dis: 0.015655517578125
[rfa agg] iter: 5, weight: tensor([0.0329, 0.0313, 0.1042, 0.0201, 0.2152, 0.3753, 0.0465, 0.0404, 0.1243,
        0.0098])
[rfa agg] iter:  6, prev_obj_val: 72.95951080322266, obj_val: 75.71290588378906, abs dis: 2.7533950805664062
[rfa agg] iter: 6, weight: tensor([0.0316, 0.0300, 0.1005, 0.0193, 0.1997, 0.4073, 0.0447, 0.0388, 0.1187,
        0.0094])
[rfa agg] iter:  7, prev_obj_val: 75.71290588378906, obj_val: 72.96196746826172, abs dis: 2.7509384155273438
[rfa agg] iter: 7, weight: tensor([0.0352, 0.0336, 0.1465, 0.0240, 0.1728, 0.3721, 0.0486, 0.0427, 0.1132,
        0.0114])
[rfa agg] iter:  8, prev_obj_val: 72.96196746826172, obj_val: 72.95693969726562, abs dis: 0.00502777099609375
[rfa agg] iter: 8, weight: tensor([0.0315, 0.0299, 0.1008, 0.0193, 0.1954, 0.4125, 0.0445, 0.0387, 0.1180,
        0.0093])
[rfa agg] iter:  9, prev_obj_val: 72.95693969726562, obj_val: 78.6929702758789, abs dis: 5.736030578613281
[rfa agg] iter: 9, weight: tensor([0.0309, 0.0293, 0.0980, 0.0189, 0.1923, 0.4243, 0.0437, 0.0379, 0.1156,
        0.0092])
			Update norm = 152.35697058019696 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 183.3535075187683 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 160/953 (16.7891%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4336, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1146, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 323/946 (34.1438%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.0616, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0608, Accuracy: 315/715 (44.0559%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7141, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3754, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9930, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 375/1581 (23.7192%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 594/1581 (37.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6107, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 380/1956 (19.4274%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 635/1956 (32.4642%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1407, Accuracy: 97/10000 (0.9700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 377/1574 (23.9517%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 655/1574 (41.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9101, Accuracy: 100/10000 (1.0000%)
time spent on training: 118.19252395629883
[rfa agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.05053164166837888
[rfa agg] init. name: [64, 47, 43, 23, 24, 98, 84, 28, 6, 17], weight: tensor([0.0979, 0.0138, 0.0972, 0.0735, 0.0321, 0.0383, 0.1223, 0.1624, 0.2009,
        0.1617])
[rfa agg] iter:  0, prev_obj_val: 63.5418586730957, obj_val: 64.53245544433594, abs dis: 0.9905967712402344
[rfa agg] iter: 0, weight: tensor([0.1100, 0.0035, 0.1086, 0.0451, 0.0095, 0.0123, 0.4477, 0.0996, 0.0645,
        0.0993])
[rfa agg] iter:  1, prev_obj_val: 64.53245544433594, obj_val: 67.15467071533203, abs dis: 2.6222152709960938
[rfa agg] iter: 1, weight: tensor([0.1274, 0.0037, 0.1254, 0.0491, 0.0099, 0.0129, 0.4233, 0.0932, 0.0624,
        0.0928])
[rfa agg] iter:  2, prev_obj_val: 67.15467071533203, obj_val: 69.87885284423828, abs dis: 2.72418212890625
[rfa agg] iter: 2, weight: tensor([0.2023, 0.0043, 0.1974, 0.0646, 0.0118, 0.0154, 0.2604, 0.0901, 0.0639,
        0.0897])
[rfa agg] iter:  3, prev_obj_val: 69.87885284423828, obj_val: 71.3486328125, abs dis: 1.4697799682617188
[rfa agg] iter: 3, weight: tensor([0.2971, 0.0038, 0.2819, 0.0662, 0.0106, 0.0140, 0.1449, 0.0662, 0.0493,
        0.0659])
[rfa agg] iter:  4, prev_obj_val: 71.3486328125, obj_val: 75.69303894042969, abs dis: 4.3444061279296875
[rfa agg] iter: 4, weight: tensor([0.3611, 0.0031, 0.3283, 0.0581, 0.0086, 0.0114, 0.0959, 0.0485, 0.0368,
        0.0483])
[rfa agg] iter:  5, prev_obj_val: 75.69303894042969, obj_val: 73.18379211425781, abs dis: 2.509246826171875
[rfa agg] iter: 5, weight: tensor([0.3700, 0.0032, 0.3345, 0.0774, 0.0092, 0.0124, 0.0738, 0.0429, 0.0339,
        0.0428])
[rfa agg] iter:  6, prev_obj_val: 73.18379211425781, obj_val: 78.5757064819336, abs dis: 5.391914367675781
[rfa agg] iter: 6, weight: tensor([0.4143, 0.0025, 0.3459, 0.0531, 0.0071, 0.0095, 0.0665, 0.0364, 0.0282,
        0.0363])
[rfa agg] iter:  7, prev_obj_val: 78.5757064819336, obj_val: 78.55902099609375, abs dis: 0.01668548583984375
[rfa agg] iter: 7, weight: tensor([0.3146, 0.0044, 0.2964, 0.1209, 0.0126, 0.0170, 0.0860, 0.0530, 0.0425,
        0.0527])
			Update norm = 135.3225458164677 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.2894365787506 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0630, Accuracy: 234/776 (30.1546%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8737, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 346/891 (38.8328%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 474/891 (53.1987%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9050, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0637, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 432/1190 (36.3025%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1049, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 331/1662 (19.9158%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 575/1662 (34.5969%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8689, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0588, Accuracy: 298/1645 (18.1155%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 615/1645 (37.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9420, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0763, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6637, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 276/590 (46.7797%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8949, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 714/1742 (40.9874%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7309, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6686, Accuracy: 50/10000 (0.5000%)
time spent on training: 124.20608186721802
[rfa agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 58, 7, 84, 94, 13, 3, 69, 93, 10], weight: tensor([0.0709, 0.0734, 0.0814, 0.1088, 0.1519, 0.1504, 0.0714, 0.0539, 0.1592,
        0.0787])
[rfa agg] iter:  0, prev_obj_val: 58.1087532043457, obj_val: 60.05179214477539, abs dis: 1.9430389404296875
[rfa agg] iter: 0, weight: tensor([0.0835, 0.0865, 0.1254, 0.2327, 0.0804, 0.0795, 0.0841, 0.0367, 0.0691,
        0.1220])
[rfa agg] iter:  1, prev_obj_val: 60.05179214477539, obj_val: 67.22007751464844, abs dis: 7.168285369873047
[rfa agg] iter: 1, weight: tensor([0.1049, 0.1086, 0.1856, 0.1165, 0.0555, 0.0549, 0.1054, 0.0374, 0.0490,
        0.1822])
[rfa agg] iter:  2, prev_obj_val: 67.22007751464844, obj_val: 70.39897155761719, abs dis: 3.17889404296875
[rfa agg] iter: 2, weight: tensor([0.2012, 0.2060, 0.1306, 0.0354, 0.0230, 0.0228, 0.1970, 0.0344, 0.0209,
        0.1287])
[rfa agg] iter:  3, prev_obj_val: 70.39897155761719, obj_val: 70.39816284179688, abs dis: 0.0008087158203125
[rfa agg] iter: 3, weight: tensor([0.2049, 0.2103, 0.1127, 0.0383, 0.0260, 0.0257, 0.2006, 0.0481, 0.0238,
        0.1096])
			Update norm = 122.7860101838764 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.9874403476715 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 430/807 (53.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4882, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0655, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3557, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0827, Accuracy: 53/460 (11.5217%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0302, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.1886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0560, Accuracy: 395/1956 (20.1943%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 601/1956 (30.7260%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.3842, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7436, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 333/1573 (21.1697%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 602/1573 (38.2708%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4294, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 216/1049 (20.5910%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 489/1049 (46.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5685, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0886, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 128/338 (37.8698%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 407/888 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2058, Accuracy: 50/10000 (0.5000%)
time spent on training: 123.4740195274353
[rfa agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 64, 31, 75, 6, 23, 40, 51, 12, 63], weight: tensor([0.0848, 0.1002, 0.0483, 0.0816, 0.2056, 0.0751, 0.1653, 0.1102, 0.0355,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 59.56221008300781, obj_val: 61.09065246582031, abs dis: 1.5284423828125
[rfa agg] iter: 0, weight: tensor([0.0753, 0.1885, 0.0181, 0.0729, 0.0453, 0.0524, 0.0619, 0.3608, 0.0107,
        0.1141])
[rfa agg] iter:  1, prev_obj_val: 61.09065246582031, obj_val: 73.33052062988281, abs dis: 12.2398681640625
[rfa agg] iter: 1, weight: tensor([0.1465, 0.1859, 0.0181, 0.1450, 0.0275, 0.0781, 0.0341, 0.0822, 0.0100,
        0.2725])
[rfa agg] iter:  2, prev_obj_val: 73.33052062988281, obj_val: 66.92523193359375, abs dis: 6.4052886962890625
[rfa agg] iter: 2, weight: tensor([0.1651, 0.0930, 0.0443, 0.1622, 0.0348, 0.2537, 0.0404, 0.0656, 0.0207,
        0.1202])
[rfa agg] iter:  3, prev_obj_val: 66.92523193359375, obj_val: 76.8259506225586, abs dis: 9.900718688964844
[rfa agg] iter: 3, weight: tensor([0.2140, 0.0894, 0.0245, 0.2129, 0.0258, 0.2043, 0.0306, 0.0559, 0.0125,
        0.1301])
[rfa agg] iter:  4, prev_obj_val: 76.8259506225586, obj_val: 73.27369689941406, abs dis: 3.5522537231445312
[rfa agg] iter: 4, weight: tensor([0.1556, 0.0962, 0.0605, 0.1506, 0.0401, 0.2347, 0.0460, 0.0711, 0.0268,
        0.1183])
[rfa agg] iter:  5, prev_obj_val: 73.27369689941406, obj_val: 69.92024230957031, abs dis: 3.35345458984375
[rfa agg] iter: 5, weight: tensor([0.1610, 0.0898, 0.0431, 0.1564, 0.0337, 0.2784, 0.0391, 0.0635, 0.0202,
        0.1149])
[rfa agg] iter:  6, prev_obj_val: 69.92024230957031, obj_val: 73.2715072631836, abs dis: 3.3512649536132812
[rfa agg] iter: 6, weight: tensor([0.1745, 0.0846, 0.0309, 0.1703, 0.0282, 0.2924, 0.0331, 0.0567, 0.0151,
        0.1143])
[rfa agg] iter:  7, prev_obj_val: 73.2715072631836, obj_val: 69.92009735107422, abs dis: 3.351409912109375
[rfa agg] iter: 7, weight: tensor([0.1593, 0.0888, 0.0425, 0.1543, 0.0334, 0.2869, 0.0387, 0.0627, 0.0199,
        0.1135])
[rfa agg] iter:  8, prev_obj_val: 69.92009735107422, obj_val: 73.2715072631836, abs dis: 3.351409912109375
[rfa agg] iter: 8, weight: tensor([0.1737, 0.0844, 0.0308, 0.1695, 0.0281, 0.2951, 0.0330, 0.0565, 0.0151,
        0.1139])
[rfa agg] iter:  9, prev_obj_val: 73.2715072631836, obj_val: 69.92010498046875, abs dis: 3.3514022827148438
[rfa agg] iter: 9, weight: tensor([0.1591, 0.0887, 0.0425, 0.1542, 0.0333, 0.2874, 0.0387, 0.0627, 0.0199,
        0.1134])
			Update norm = 118.44715494947525 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.52252912521362 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1182, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3044, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 41/311 (13.1833%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 330/1130 (29.2035%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 509/1130 (45.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.3996, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0579, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 522/928 (56.2500%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5201, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 530/1049 (50.5243%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4903, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 436/807 (54.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.7857, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0561, Accuracy: 368/1904 (19.3277%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 676/1904 (35.5042%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5467, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7719, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 309/677 (45.6425%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.8844, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6658, Accuracy: 50/10000 (0.5000%)
time spent on training: 122.9741940498352
[rfa agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 96, 54, 1, 51, 20, 46, 92, 90, 82], weight: tensor([0.0093, 0.0342, 0.1241, 0.1019, 0.1152, 0.0886, 0.2091, 0.1883, 0.0743,
        0.0549])
[rfa agg] iter:  0, prev_obj_val: 62.10844421386719, obj_val: 65.58911895751953, abs dis: 3.4806747436523438
[rfa agg] iter: 0, weight: tensor([0.0017, 0.0080, 0.3387, 0.1133, 0.3220, 0.0574, 0.0494, 0.0585, 0.0337,
        0.0171])
[rfa agg] iter:  1, prev_obj_val: 65.58911895751953, obj_val: 70.79937744140625, abs dis: 5.210258483886719
[rfa agg] iter: 1, weight: tensor([0.0022, 0.0106, 0.1574, 0.3120, 0.2273, 0.1108, 0.0477, 0.0541, 0.0539,
        0.0241])
[rfa agg] iter:  2, prev_obj_val: 70.79937744140625, obj_val: 75.28956604003906, abs dis: 4.4901885986328125
[rfa agg] iter: 2, weight: tensor([0.0026, 0.0131, 0.1063, 0.2932, 0.1307, 0.2409, 0.0460, 0.0509, 0.0845,
        0.0318])
[rfa agg] iter:  3, prev_obj_val: 75.28956604003906, obj_val: 77.88194274902344, abs dis: 2.592376708984375
[rfa agg] iter: 3, weight: tensor([0.0027, 0.0137, 0.0800, 0.1576, 0.0923, 0.4191, 0.0403, 0.0441, 0.1147,
        0.0355])
[rfa agg] iter:  4, prev_obj_val: 77.88194274902344, obj_val: 80.74060821533203, abs dis: 2.8586654663085938
[rfa agg] iter: 4, weight: tensor([0.0028, 0.0150, 0.0749, 0.1298, 0.0844, 0.4176, 0.0402, 0.0437, 0.1511,
        0.0404])
[rfa agg] iter:  5, prev_obj_val: 80.74060821533203, obj_val: 83.66265869140625, abs dis: 2.9220504760742188
[rfa agg] iter: 5, weight: tensor([0.0034, 0.0183, 0.0787, 0.1255, 0.0873, 0.3048, 0.0448, 0.0484, 0.2371,
        0.0517])
[rfa agg] iter:  6, prev_obj_val: 83.66265869140625, obj_val: 80.7369155883789, abs dis: 2.9257431030273438
[rfa agg] iter: 6, weight: tensor([0.0035, 0.0193, 0.0717, 0.1072, 0.0784, 0.2080, 0.0429, 0.0461, 0.3651,
        0.0579])
[rfa agg] iter:  7, prev_obj_val: 80.7369155883789, obj_val: 83.656494140625, abs dis: 2.9195785522460938
[rfa agg] iter: 7, weight: tensor([0.0034, 0.0184, 0.0790, 0.1258, 0.0875, 0.2807, 0.0449, 0.0485, 0.2598,
        0.0521])
[rfa agg] iter:  8, prev_obj_val: 83.656494140625, obj_val: 80.7378158569336, abs dis: 2.9186782836914062
[rfa agg] iter: 8, weight: tensor([0.0035, 0.0192, 0.0712, 0.1065, 0.0779, 0.2056, 0.0426, 0.0458, 0.3702,
        0.0575])
[rfa agg] iter:  9, prev_obj_val: 80.7378158569336, obj_val: 83.65640258789062, abs dis: 2.9185867309570312
[rfa agg] iter: 9, weight: tensor([0.0034, 0.0184, 0.0790, 0.1258, 0.0875, 0.2803, 0.0449, 0.0485, 0.2602,
        0.0521])
			Update norm = 114.29147821332744 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 218.76798057556152 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0606, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0300, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1795, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 473/1190 (39.7479%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.0292, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 712/1742 (40.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5873, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 305/1662 (18.3514%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 583/1662 (35.0782%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6697, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0569, Accuracy: 230/1071 (21.4753%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0796, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 416/1988 (20.9256%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 649/1988 (32.6459%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0132, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0574, Accuracy: 270/636 (42.4528%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0617, Accuracy: 194/735 (26.3946%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 332/735 (45.1701%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6732, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 296/946 (31.2896%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9853, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6999, Accuracy: 50/10000 (0.5000%)
time spent on training: 132.36479568481445
[rfa agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 84, 93, 94, 55, 85, 52, 32, 43, 95], weight: tensor([0.0637, 0.1054, 0.1543, 0.1472, 0.0949, 0.1761, 0.0563, 0.0651, 0.0838,
        0.0531])
[rfa agg] iter:  0, prev_obj_val: 65.1795654296875, obj_val: 68.1850814819336, abs dis: 3.0055160522460938
[rfa agg] iter: 0, weight: tensor([0.0384, 0.3757, 0.0821, 0.1018, 0.1632, 0.0639, 0.0269, 0.0393, 0.0832,
        0.0253])
[rfa agg] iter:  1, prev_obj_val: 68.1850814819336, obj_val: 70.87244415283203, abs dis: 2.6873626708984375
[rfa agg] iter: 1, weight: tensor([0.0454, 0.1772, 0.0507, 0.0589, 0.3867, 0.0425, 0.0289, 0.0465, 0.1358,
        0.0273])
[rfa agg] iter:  2, prev_obj_val: 70.87244415283203, obj_val: 78.60598754882812, abs dis: 7.733543395996094
[rfa agg] iter: 2, weight: tensor([0.0592, 0.1255, 0.0487, 0.0556, 0.3077, 0.0417, 0.0353, 0.0605, 0.2324,
        0.0333])
[rfa agg] iter:  3, prev_obj_val: 78.60598754882812, obj_val: 78.56234741210938, abs dis: 0.04364013671875
[rfa agg] iter: 3, weight: tensor([0.1247, 0.0872, 0.0466, 0.0519, 0.1308, 0.0414, 0.0582, 0.1278, 0.2760,
        0.0553])
			Update norm = 135.20063938689418 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.3023874759674 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 459/1130 (40.6195%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7273, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 541/2227 (24.2928%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1015/2227 (45.5770%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1202, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 207/735 (28.1633%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3969, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0601, Accuracy: 309/715 (43.2168%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 281/590 (47.6271%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.7839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0571, Accuracy: 273/636 (42.9245%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0989, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0841, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3248, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 384/1953 (19.6621%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 739/1953 (37.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7538, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 336/1275 (26.3529%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0200, Accuracy: 690/1275 (54.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.8839, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9556, Accuracy: 55/10000 (0.5500%)
time spent on training: 139.26917958259583
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 60, 32, 23, 69, 52, 79, 83, 9, 90], weight: tensor([0.1115, 0.2197, 0.0725, 0.0705, 0.0582, 0.0628, 0.0194, 0.1927, 0.1258,
        0.0668])
[rfa agg] iter:  0, prev_obj_val: 81.25520324707031, obj_val: 83.46605682373047, abs dis: 2.2108535766601562
[rfa agg] iter: 0, weight: tensor([0.1994, 0.0583, 0.0360, 0.0350, 0.0231, 0.0249, 0.0048, 0.0696, 0.5193,
        0.0295])
[rfa agg] iter:  1, prev_obj_val: 83.46605682373047, obj_val: 88.3714370727539, abs dis: 4.9053802490234375
[rfa agg] iter: 1, weight: tensor([0.4375, 0.0546, 0.0567, 0.0550, 0.0335, 0.0361, 0.0062, 0.0619, 0.2141,
        0.0444])
[rfa agg] iter:  2, prev_obj_val: 88.3714370727539, obj_val: 89.6645278930664, abs dis: 1.2930908203125
[rfa agg] iter: 2, weight: tensor([0.2516, 0.0654, 0.1169, 0.1137, 0.0608, 0.0653, 0.0096, 0.0721, 0.1592,
        0.0851])
[rfa agg] iter:  3, prev_obj_val: 89.6645278930664, obj_val: 89.66212463378906, abs dis: 0.00240325927734375
[rfa agg] iter: 3, weight: tensor([0.2086, 0.0638, 0.1365, 0.1325, 0.0670, 0.0719, 0.0101, 0.0699, 0.1438,
        0.0959])
			Update norm = 143.39584090028552 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.2949779033661 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 287/953 (30.1154%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3550, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0618, Accuracy: 311/715 (43.4965%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0383, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6991, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4398, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 368/1657 (22.2088%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 499/1657 (30.1147%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5429, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 341/803 (42.4658%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0352, Accuracy: 363/803 (45.2055%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9203, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 404/1581 (25.5534%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7833, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0691, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7039, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 278/708 (39.2655%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8316, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0288, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 134/568 (23.5915%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6796, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.19242978096008
[rfa agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 23, 12, 0, 58, 28, 45, 16, 11, 62], weight: tensor([0.1095, 0.0821, 0.0388, 0.1904, 0.0923, 0.1816, 0.0769, 0.0813, 0.0818,
        0.0653])
[rfa agg] iter:  0, prev_obj_val: 53.24724578857422, obj_val: 57.53126907348633, abs dis: 4.284023284912109
[rfa agg] iter: 0, weight: tensor([0.2426, 0.1098, 0.0136, 0.0450, 0.2163, 0.0468, 0.0712, 0.1083, 0.1097,
        0.0367])
[rfa agg] iter:  1, prev_obj_val: 57.53126907348633, obj_val: 66.79655456542969, abs dis: 9.26528549194336
[rfa agg] iter: 1, weight: tensor([0.0585, 0.1738, 0.0131, 0.0250, 0.1091, 0.0256, 0.1777, 0.1831, 0.1862,
        0.0479])
[rfa agg] iter:  2, prev_obj_val: 66.79655456542969, obj_val: 70.29229736328125, abs dis: 3.4957427978515625
[rfa agg] iter: 2, weight: tensor([0.0667, 0.1204, 0.0287, 0.0367, 0.0928, 0.0373, 0.2064, 0.1200, 0.1211,
        0.1699])
[rfa agg] iter:  3, prev_obj_val: 70.29229736328125, obj_val: 70.28267669677734, abs dis: 0.00962066650390625
[rfa agg] iter: 3, weight: tensor([0.0634, 0.1020, 0.0340, 0.0371, 0.0834, 0.0377, 0.1561, 0.1013, 0.1021,
        0.2831])
[rfa agg] iter:  4, prev_obj_val: 70.28267669677734, obj_val: 70.2824935913086, abs dis: 0.00018310546875
[rfa agg] iter: 4, weight: tensor([0.0620, 0.0997, 0.0334, 0.0363, 0.0816, 0.0369, 0.1522, 0.0991, 0.0998,
        0.2991])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.63204097747803 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 392/1129 (34.7210%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0255, Accuracy: 710/1129 (62.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7681, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 303/1190 (25.4622%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0692, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 516/2227 (23.1702%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1021/2227 (45.8464%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1304, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6172, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0826, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4408, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 233/1049 (22.2116%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 478/1049 (45.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3644, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6391, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0879, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4998, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 699/1715 (40.7580%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4730, Accuracy: 94/10000 (0.9400%)
time spent on training: 143.8262598514557
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 84, 60, 12, 87, 98, 51, 76, 36, 92], weight: tensor([0.1126, 0.1187, 0.2221, 0.0337, 0.1128, 0.0372, 0.1046, 0.0465, 0.0407,
        0.1711])
[rfa agg] iter:  0, prev_obj_val: 67.80769348144531, obj_val: 68.16256713867188, abs dis: 0.3548736572265625
[rfa agg] iter: 0, weight: tensor([0.1991, 0.3200, 0.0453, 0.0079, 0.2008, 0.0087, 0.1237, 0.0128, 0.0103,
        0.0714])
[rfa agg] iter:  1, prev_obj_val: 68.16256713867188, obj_val: 71.5975112915039, abs dis: 3.4349441528320312
[rfa agg] iter: 1, weight: tensor([0.2782, 0.1987, 0.0282, 0.0060, 0.2634, 0.0066, 0.1603, 0.0100, 0.0079,
        0.0407])
[rfa agg] iter:  2, prev_obj_val: 71.5975112915039, obj_val: 71.53665161132812, abs dis: 0.06085968017578125
[rfa agg] iter: 2, weight: tensor([0.2274, 0.1382, 0.0319, 0.0079, 0.2249, 0.0087, 0.2934, 0.0133, 0.0105,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 71.53665161132812, obj_val: 74.024658203125, abs dis: 2.488006591796875
[rfa agg] iter: 3, weight: tensor([0.2085, 0.1291, 0.0304, 0.0075, 0.2145, 0.0083, 0.3372, 0.0127, 0.0100,
        0.0418])
[rfa agg] iter:  4, prev_obj_val: 74.024658203125, obj_val: 74.02279663085938, abs dis: 0.001861572265625
[rfa agg] iter: 4, weight: tensor([0.1900, 0.1288, 0.0355, 0.0094, 0.1947, 0.0104, 0.3547, 0.0161, 0.0126,
        0.0478])
[rfa agg] iter:  5, prev_obj_val: 74.02279663085938, obj_val: 76.8001708984375, abs dis: 2.777374267578125
[rfa agg] iter: 5, weight: tensor([0.1879, 0.1281, 0.0353, 0.0094, 0.1929, 0.0103, 0.3601, 0.0160, 0.0125,
        0.0476])
[rfa agg] iter:  6, prev_obj_val: 76.8001708984375, obj_val: 74.02571105957031, abs dis: 2.7744598388671875
[rfa agg] iter: 6, weight: tensor([0.1885, 0.1373, 0.0431, 0.0123, 0.1918, 0.0136, 0.3184, 0.0213, 0.0166,
        0.0570])
[rfa agg] iter:  7, prev_obj_val: 74.02571105957031, obj_val: 76.79936218261719, abs dis: 2.773651123046875
[rfa agg] iter: 7, weight: tensor([0.1906, 0.1299, 0.0357, 0.0095, 0.1950, 0.0105, 0.3519, 0.0162, 0.0127,
        0.0481])
[rfa agg] iter:  8, prev_obj_val: 76.79936218261719, obj_val: 74.02581024169922, abs dis: 2.7735519409179688
[rfa agg] iter: 8, weight: tensor([0.1889, 0.1375, 0.0432, 0.0123, 0.1921, 0.0136, 0.3174, 0.0213, 0.0166,
        0.0571])
[rfa agg] iter:  9, prev_obj_val: 74.02581024169922, obj_val: 76.7993392944336, abs dis: 2.773529052734375
[rfa agg] iter: 9, weight: tensor([0.1907, 0.1300, 0.0357, 0.0095, 0.1950, 0.0105, 0.3517, 0.0162, 0.0127,
        0.0481])
			Update norm = 150.6908180887276 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.25012111663818 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 142/818 (17.3594%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0765, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 213/1013 (21.0267%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 343/1013 (33.8598%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7611, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 239/1071 (22.3156%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 495/1071 (46.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0092, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 364/946 (38.4778%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0015, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9183, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0818, Accuracy: 71/486 (14.6091%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7868, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3152, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0827, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 348/1628 (21.3759%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 814/1628 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3923, Accuracy: 135/10000 (1.3500%)
time spent on training: 132.411967754364
[rfa agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 14, 55, 43, 88, 30, 56, 96, 98, 5], weight: tensor([0.1100, 0.1362, 0.1440, 0.1272, 0.0811, 0.0654, 0.0250, 0.0418, 0.0502,
        0.2190])
[rfa agg] iter:  0, prev_obj_val: 51.54811096191406, obj_val: 55.14527893066406, abs dis: 3.59716796875
[rfa agg] iter: 0, weight: tensor([0.4077, 0.1241, 0.1000, 0.1673, 0.0749, 0.0367, 0.0069, 0.0146, 0.0201,
        0.0477])
[rfa agg] iter:  1, prev_obj_val: 55.14527893066406, obj_val: 59.33654022216797, abs dis: 4.191261291503906
[rfa agg] iter: 1, weight: tensor([0.3427, 0.1160, 0.0987, 0.1425, 0.1321, 0.0556, 0.0093, 0.0203, 0.0285,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 59.33654022216797, obj_val: 59.30238342285156, abs dis: 0.03415679931640625
[rfa agg] iter: 2, weight: tensor([0.2062, 0.1045, 0.0924, 0.1212, 0.2613, 0.0819, 0.0116, 0.0262, 0.0381,
        0.0566])
[rfa agg] iter:  3, prev_obj_val: 59.30238342285156, obj_val: 59.30223083496094, abs dis: 0.000152587890625
[rfa agg] iter: 3, weight: tensor([0.1995, 0.1030, 0.0910, 0.1194, 0.2748, 0.0814, 0.0115, 0.0260, 0.0377,
        0.0558])
			Update norm = 107.94516294454792 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.639634847641 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0423, Accuracy: 156/312 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3915, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 40/416 (9.6154%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.6006, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 412/1440 (28.6111%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 666/1440 (46.2500%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8619, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0523, Accuracy: 390/1628 (23.9558%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 775/1628 (47.6044%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3568, Accuracy: 139/10000 (1.3900%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 454/1715 (26.4723%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 680/1715 (39.6501%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5837, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 399/712 (56.0393%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.5347, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 402/1131 (35.5438%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9473, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 209/861 (24.2741%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 435/861 (50.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7466, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 510/1446 (35.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2463, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 288/1645 (17.5076%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 614/1645 (37.3252%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9102, Accuracy: 126/10000 (1.2600%)
time spent on training: 146.68665099143982
[rfa agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 78, 29, 5, 92, 11, 87, 10, 26, 13], weight: tensor([0.0276, 0.0368, 0.1274, 0.1440, 0.1517, 0.0630, 0.1000, 0.0762, 0.1279,
        0.1455])
[rfa agg] iter:  0, prev_obj_val: 54.85847091674805, obj_val: 58.65773010253906, abs dis: 3.7992591857910156
[rfa agg] iter: 0, weight: tensor([0.0088, 0.0137, 0.1389, 0.0918, 0.0845, 0.0402, 0.3236, 0.0675, 0.1389,
        0.0921])
[rfa agg] iter:  1, prev_obj_val: 58.65773010253906, obj_val: 58.586246490478516, abs dis: 0.07148361206054688
[rfa agg] iter: 1, weight: tensor([0.0077, 0.0121, 0.0911, 0.0651, 0.0609, 0.0378, 0.5013, 0.0675, 0.0911,
        0.0654])
[rfa agg] iter:  2, prev_obj_val: 58.586246490478516, obj_val: 66.1267318725586, abs dis: 7.540485382080078
[rfa agg] iter: 2, weight: tensor([0.0065, 0.0102, 0.0769, 0.0550, 0.0515, 0.0319, 0.5791, 0.0570, 0.0767,
        0.0552])
[rfa agg] iter:  3, prev_obj_val: 66.1267318725586, obj_val: 60.972496032714844, abs dis: 5.15423583984375
[rfa agg] iter: 3, weight: tensor([0.0121, 0.0197, 0.0990, 0.0772, 0.0735, 0.0699, 0.3274, 0.1445, 0.0990,
        0.0776])
[rfa agg] iter:  4, prev_obj_val: 60.972496032714844, obj_val: 58.597259521484375, abs dis: 2.3752365112304688
[rfa agg] iter: 4, weight: tensor([0.0088, 0.0140, 0.0919, 0.0679, 0.0639, 0.0456, 0.4625, 0.0853, 0.0918,
        0.0682])
[rfa agg] iter:  5, prev_obj_val: 58.597259521484375, obj_val: 66.11831665039062, abs dis: 7.52105712890625
[rfa agg] iter: 5, weight: tensor([0.0068, 0.0107, 0.0801, 0.0573, 0.0536, 0.0333, 0.5612, 0.0595, 0.0799,
        0.0576])
[rfa agg] iter:  6, prev_obj_val: 66.11831665039062, obj_val: 60.972808837890625, abs dis: 5.1455078125
[rfa agg] iter: 6, weight: tensor([0.0122, 0.0197, 0.0992, 0.0773, 0.0736, 0.0700, 0.3265, 0.1448, 0.0991,
        0.0777])
[rfa agg] iter:  7, prev_obj_val: 60.972808837890625, obj_val: 58.597328186035156, abs dis: 2.3754806518554688
[rfa agg] iter: 7, weight: tensor([0.0088, 0.0141, 0.0919, 0.0679, 0.0639, 0.0457, 0.4623, 0.0853, 0.0919,
        0.0682])
[rfa agg] iter:  8, prev_obj_val: 58.597328186035156, obj_val: 66.11827087402344, abs dis: 7.520942687988281
[rfa agg] iter: 8, weight: tensor([0.0068, 0.0107, 0.0801, 0.0573, 0.0537, 0.0333, 0.5611, 0.0595, 0.0799,
        0.0576])
[rfa agg] iter:  9, prev_obj_val: 66.11827087402344, obj_val: 60.972816467285156, abs dis: 5.145454406738281
[rfa agg] iter: 9, weight: tensor([0.0122, 0.0197, 0.0992, 0.0773, 0.0736, 0.0700, 0.3265, 0.1448, 0.0991,
        0.0777])
			Update norm = 163.54230029070462 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.3090763092041 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0891, Accuracy: 64/408 (15.6863%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4912, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 133/682 (19.5015%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5897, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 397/1742 (22.7899%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8223, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0411, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7731, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0515, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.6826, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 354/1003 (35.2941%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0354, Accuracy: 354/1003 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 142/568 (25.0000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0404, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7272, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0492, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4647, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 423/1949 (21.7034%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1624, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 326/1645 (19.8176%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 614/1645 (37.3252%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8698, Accuracy: 104/10000 (1.0400%)
time spent on training: 139.6116440296173
[rfa agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 80, 93, 31, 33, 86, 62, 98, 21, 13], weight: tensor([0.0437, 0.0730, 0.1864, 0.0492, 0.0551, 0.1073, 0.0608, 0.0399, 0.2086,
        0.1760])
[rfa agg] iter:  0, prev_obj_val: 82.97247314453125, obj_val: 85.07093811035156, abs dis: 2.0984649658203125
[rfa agg] iter: 0, weight: tensor([0.0284, 0.0745, 0.1333, 0.0352, 0.0438, 0.3409, 0.0484, 0.0238, 0.1148,
        0.1568])
[rfa agg] iter:  1, prev_obj_val: 85.07093811035156, obj_val: 88.72283935546875, abs dis: 3.6519012451171875
[rfa agg] iter: 1, weight: tensor([0.0220, 0.0633, 0.0777, 0.0277, 0.0351, 0.5598, 0.0388, 0.0181, 0.0689,
        0.0886])
[rfa agg] iter:  2, prev_obj_val: 88.72283935546875, obj_val: 90.27244567871094, abs dis: 1.5496063232421875
[rfa agg] iter: 2, weight: tensor([0.0281, 0.0928, 0.0742, 0.0362, 0.0472, 0.4966, 0.0520, 0.0228, 0.0675,
        0.0827])
[rfa agg] iter:  3, prev_obj_val: 90.27244567871094, obj_val: 91.83165740966797, abs dis: 1.5592117309570312
[rfa agg] iter: 3, weight: tensor([0.0344, 0.1217, 0.0822, 0.0448, 0.0591, 0.3986, 0.0652, 0.0277, 0.0752,
        0.0909])
[rfa agg] iter:  4, prev_obj_val: 91.83165740966797, obj_val: 93.40547180175781, abs dis: 1.5738143920898438
[rfa agg] iter: 4, weight: tensor([0.0394, 0.1514, 0.0847, 0.0518, 0.0695, 0.3237, 0.0767, 0.0315, 0.0781,
        0.0932])
[rfa agg] iter:  5, prev_obj_val: 93.40547180175781, obj_val: 94.99039459228516, abs dis: 1.5849227905273438
[rfa agg] iter: 5, weight: tensor([0.0431, 0.1837, 0.0831, 0.0573, 0.0784, 0.2658, 0.0865, 0.0341, 0.0770,
        0.0909])
[rfa agg] iter:  6, prev_obj_val: 94.99039459228516, obj_val: 98.20472717285156, abs dis: 3.2143325805664062
[rfa agg] iter: 6, weight: tensor([0.0455, 0.2220, 0.0784, 0.0615, 0.0859, 0.2178, 0.0949, 0.0356, 0.0731,
        0.0853])
[rfa agg] iter:  7, prev_obj_val: 98.20472717285156, obj_val: 99.83185577392578, abs dis: 1.6271286010742188
[rfa agg] iter: 7, weight: tensor([0.0450, 0.3387, 0.0608, 0.0632, 0.0940, 0.1371, 0.1039, 0.0343, 0.0573,
        0.0656])
[rfa agg] iter:  8, prev_obj_val: 99.83185577392578, obj_val: 103.70295715332031, abs dis: 3.8711013793945312
[rfa agg] iter: 8, weight: tensor([0.0390, 0.4564, 0.0461, 0.0562, 0.0876, 0.0952, 0.0971, 0.0292, 0.0436,
        0.0495])
[rfa agg] iter:  9, prev_obj_val: 103.70295715332031, obj_val: 101.58639526367188, abs dis: 2.1165618896484375
[rfa agg] iter: 9, weight: tensor([0.0428, 0.4254, 0.0375, 0.0664, 0.1200, 0.0676, 0.1342, 0.0305, 0.0358,
        0.0399])
			Update norm = 107.71416711312862 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.556791305542 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0558, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3739, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 429/776 (55.2835%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9992, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 650/1418 (45.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8649, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0631, Accuracy: 219/1013 (21.6190%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 307/1013 (30.3060%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4809, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 241/1071 (22.5023%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 502/1071 (46.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7519, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 631/1956 (32.2597%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1750, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0660, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0345, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9582, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 145/809 (17.9234%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 341/809 (42.1508%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.2175, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 425/1904 (22.3214%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0320, Accuracy: 632/1904 (33.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6957, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0611, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7381, Accuracy: 50/10000 (0.5000%)
time spent on training: 143.4763708114624
[rfa agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 75, 70, 14, 55, 6, 16, 50, 46, 23], weight: tensor([0.0255, 0.0729, 0.1333, 0.0952, 0.1006, 0.1838, 0.0665, 0.0760, 0.1789,
        0.0672])
[rfa agg] iter:  0, prev_obj_val: 66.7765121459961, obj_val: 68.92457580566406, abs dis: 2.1480636596679688
[rfa agg] iter: 0, weight: tensor([0.0093, 0.0651, 0.1425, 0.1810, 0.2836, 0.0727, 0.0503, 0.0678, 0.0769,
        0.0509])
[rfa agg] iter:  1, prev_obj_val: 68.92457580566406, obj_val: 71.92750549316406, abs dis: 3.0029296875
[rfa agg] iter: 1, weight: tensor([0.0065, 0.0668, 0.0536, 0.4068, 0.2326, 0.0348, 0.0463, 0.0694, 0.0363,
        0.0469])
[rfa agg] iter:  2, prev_obj_val: 71.92750549316406, obj_val: 75.43124389648438, abs dis: 3.5037384033203125
[rfa agg] iter: 2, weight: tensor([0.0088, 0.1173, 0.0575, 0.2998, 0.1638, 0.0400, 0.0742, 0.1219, 0.0415,
        0.0753])
[rfa agg] iter:  3, prev_obj_val: 75.43124389648438, obj_val: 77.29711151123047, abs dis: 1.8658676147460938
[rfa agg] iter: 3, weight: tensor([0.0093, 0.1953, 0.0493, 0.1542, 0.1085, 0.0362, 0.1031, 0.2014, 0.0375,
        0.1051])
[rfa agg] iter:  4, prev_obj_val: 77.29711151123047, obj_val: 85.5408935546875, abs dis: 8.243782043457031
[rfa agg] iter: 4, weight: tensor([0.0082, 0.2445, 0.0388, 0.1025, 0.0775, 0.0292, 0.1095, 0.2477, 0.0302,
        0.1119])
[rfa agg] iter:  5, prev_obj_val: 85.5408935546875, obj_val: 89.23101806640625, abs dis: 3.69012451171875
[rfa agg] iter: 5, weight: tensor([0.0093, 0.1630, 0.0317, 0.0617, 0.0521, 0.0254, 0.2248, 0.1675, 0.0262,
        0.2382])
[rfa agg] iter:  6, prev_obj_val: 89.23101806640625, obj_val: 89.22933959960938, abs dis: 0.001678466796875
[rfa agg] iter: 6, weight: tensor([0.0118, 0.1371, 0.0357, 0.0646, 0.0558, 0.0291, 0.2413, 0.1414, 0.0299,
        0.2534])
			Update norm = 112.58719277325686 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.86493563652039 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 281/590 (47.6271%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0293, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.7377, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 152/953 (15.9496%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.3055, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 615/1475 (41.6949%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8297, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1269, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1172, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3067, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8580, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 349/1418 (24.6121%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 601/1418 (42.3836%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8520, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0773, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6687, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 567/2227 (25.4603%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1041/2227 (46.7445%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3605, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 412/1953 (21.0958%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3906, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0826, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4437, Accuracy: 50/10000 (0.5000%)
time spent on training: 143.2584354877472
[rfa agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 64, 65, 61, 33, 70, 82, 60, 83, 98], weight: tensor([0.0585, 0.0945, 0.1462, 0.0084, 0.0510, 0.1405, 0.0496, 0.2207, 0.1936,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 79.1344985961914, obj_val: 78.98664093017578, abs dis: 0.147857666015625
[rfa agg] iter: 0, weight: tensor([0.0259, 0.0738, 0.2746, 0.0022, 0.0208, 0.3848, 0.0187, 0.0834, 0.1036,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 78.98664093017578, obj_val: 78.98597717285156, abs dis: 0.00066375732421875
[rfa agg] iter: 1, weight: tensor([0.0249, 0.0709, 0.2681, 0.0021, 0.0200, 0.4046, 0.0180, 0.0801, 0.0995,
        0.0117])
			Update norm = 198.21367298006967 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.91985487937927 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0296, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 146/568 (25.7042%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7759, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 785/1953 (40.1946%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9717, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 36/416 (8.6538%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.4925, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0592, Accuracy: 330/719 (45.8971%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5503, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.9887, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 412/1475 (27.9322%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 647/1475 (43.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8571, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 243/1131 (21.4854%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 449/1131 (39.6994%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4579, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 355/1662 (21.3598%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 602/1662 (36.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8071, Accuracy: 109/10000 (1.0900%)
time spent on training: 146.50607228279114
[rfa agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 62, 83, 78, 25, 41, 18, 65, 38, 94], weight: tensor([0.0606, 0.0584, 0.2006, 0.0427, 0.0709, 0.0739, 0.0544, 0.1515, 0.1162,
        0.1707])
[rfa agg] iter:  0, prev_obj_val: 71.9514389038086, obj_val: 75.31632232666016, abs dis: 3.3648834228515625
[rfa agg] iter: 0, weight: tensor([0.0363, 0.0308, 0.0669, 0.0183, 0.0489, 0.0597, 0.0288, 0.1036, 0.5166,
        0.0900])
[rfa agg] iter:  1, prev_obj_val: 75.31632232666016, obj_val: 77.76129150390625, abs dis: 2.4449691772460938
[rfa agg] iter: 1, weight: tensor([0.0595, 0.0492, 0.0793, 0.0280, 0.0834, 0.1063, 0.0459, 0.1114, 0.3361,
        0.1010])
[rfa agg] iter:  2, prev_obj_val: 77.76129150390625, obj_val: 77.75223541259766, abs dis: 0.00905609130859375
[rfa agg] iter: 2, weight: tensor([0.0752, 0.0605, 0.0784, 0.0332, 0.1096, 0.1476, 0.0564, 0.1047, 0.2374,
        0.0969])
			Update norm = 141.79948430794803 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.33723855018616 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0584, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.8409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 392/1949 (20.1129%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 636/1949 (32.6321%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.7148, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 349/1418 (24.6121%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 606/1418 (42.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9800, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 385/1475 (26.1017%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 721/1475 (48.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0150, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0843, Accuracy: 55/197 (27.9188%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 350/1628 (21.4988%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 805/1628 (49.4472%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9450, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 394/888 (44.3694%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1775, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0529, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6260, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9700, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 185/735 (25.1701%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 328/735 (44.6259%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0932, Accuracy: 53/10000 (0.5300%)
time spent on training: 151.3672432899475
[rfa agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 21, 70, 65, 79, 5, 63, 95, 58, 32], weight: tensor([0.0687, 0.1873, 0.1363, 0.1417, 0.0189, 0.1564, 0.0853, 0.0576, 0.0772,
        0.0706])
[rfa agg] iter:  0, prev_obj_val: 65.603515625, obj_val: 66.65856170654297, abs dis: 1.0550460815429688
[rfa agg] iter: 0, weight: tensor([0.0626, 0.1000, 0.2138, 0.1778, 0.0080, 0.1420, 0.1084, 0.0409, 0.0821,
        0.0644])
[rfa agg] iter:  1, prev_obj_val: 66.65856170654297, obj_val: 68.81684875488281, abs dis: 2.1582870483398438
[rfa agg] iter: 1, weight: tensor([0.0687, 0.0978, 0.1954, 0.1658, 0.0085, 0.1353, 0.1225, 0.0442, 0.0912,
        0.0706])
[rfa agg] iter:  2, prev_obj_val: 68.81684875488281, obj_val: 72.10967254638672, abs dis: 3.2928237915039062
[rfa agg] iter: 2, weight: tensor([0.0807, 0.0904, 0.1603, 0.1406, 0.0090, 0.1194, 0.1558, 0.0499, 0.1108,
        0.0831])
[rfa agg] iter:  3, prev_obj_val: 72.10967254638672, obj_val: 73.2202377319336, abs dis: 1.110565185546875
[rfa agg] iter: 3, weight: tensor([0.0959, 0.0710, 0.1102, 0.1000, 0.0088, 0.0887, 0.2290, 0.0542, 0.1433,
        0.0988])
[rfa agg] iter:  4, prev_obj_val: 73.2202377319336, obj_val: 74.36395263671875, abs dis: 1.1437149047851562
[rfa agg] iter: 4, weight: tensor([0.0986, 0.0620, 0.0928, 0.0849, 0.0083, 0.0762, 0.2684, 0.0533, 0.1541,
        0.1015])
[rfa agg] iter:  5, prev_obj_val: 74.36395263671875, obj_val: 75.56432342529297, abs dis: 1.2003707885742188
[rfa agg] iter: 5, weight: tensor([0.0982, 0.0517, 0.0749, 0.0691, 0.0075, 0.0626, 0.3213, 0.0504, 0.1633,
        0.1011])
[rfa agg] iter:  6, prev_obj_val: 75.56432342529297, obj_val: 78.69496154785156, abs dis: 3.1306381225585938
[rfa agg] iter: 6, weight: tensor([0.0930, 0.0400, 0.0563, 0.0523, 0.0062, 0.0478, 0.3958, 0.0446, 0.1682,
        0.0957])
[rfa agg] iter:  7, prev_obj_val: 78.69496154785156, obj_val: 89.42731475830078, abs dis: 10.732353210449219
[rfa agg] iter: 7, weight: tensor([0.1114, 0.0292, 0.0390, 0.0366, 0.0053, 0.0341, 0.3248, 0.0439, 0.2612,
        0.1145])
[rfa agg] iter:  8, prev_obj_val: 89.42731475830078, obj_val: 92.96180725097656, abs dis: 3.5344924926757812
[rfa agg] iter: 8, weight: tensor([0.2432, 0.0300, 0.0370, 0.0353, 0.0076, 0.0337, 0.1040, 0.1074, 0.1513,
        0.2504])
[rfa agg] iter:  9, prev_obj_val: 92.96180725097656, obj_val: 89.32847595214844, abs dis: 3.633331298828125
[rfa agg] iter: 9, weight: tensor([0.2125, 0.0336, 0.0407, 0.0390, 0.0093, 0.0374, 0.0989, 0.1748, 0.1332,
        0.2205])
			Update norm = 112.48787261022852 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.01211500167847 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0867, Accuracy: 31/271 (11.4391%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0565, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3696, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0571, Accuracy: 373/1581 (23.5927%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 585/1581 (37.0019%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8127, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 455/1587 (28.6704%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 596/1587 (37.5551%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2947, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 141/682 (20.6745%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 273/682 (40.0293%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 452/1130 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0671, Accuracy: 149/568 (26.2324%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7855, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 191/735 (25.9864%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7292, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 492/1470 (33.4694%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 837/1470 (56.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0970, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0607, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9806, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 340/1372 (24.7813%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 487/1372 (35.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0804, Accuracy: 70/10000 (0.7000%)
time spent on training: 156.2315697669983
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 28, 27, 80, 54, 62, 32, 22, 4, 42], weight: tensor([0.0263, 0.1535, 0.1541, 0.0662, 0.1097, 0.0552, 0.0714, 0.1428, 0.0875,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 55.998817443847656, obj_val: 59.69081115722656, abs dis: 3.6919937133789062
[rfa agg] iter: 0, weight: tensor([0.0100, 0.0720, 0.0724, 0.0556, 0.2125, 0.0332, 0.0744, 0.0858, 0.2910,
        0.0931])
[rfa agg] iter:  1, prev_obj_val: 59.69081115722656, obj_val: 64.35746002197266, abs dis: 4.666648864746094
[rfa agg] iter: 1, weight: tensor([0.0089, 0.0523, 0.0526, 0.0558, 0.1211, 0.0312, 0.0790, 0.0607, 0.4739,
        0.0646])
[rfa agg] iter:  2, prev_obj_val: 64.35746002197266, obj_val: 61.916133880615234, abs dis: 2.441326141357422
[rfa agg] iter: 2, weight: tensor([0.0122, 0.0591, 0.0595, 0.0912, 0.1138, 0.0464, 0.1414, 0.0671, 0.3389,
        0.0704])
[rfa agg] iter:  3, prev_obj_val: 61.916133880615234, obj_val: 66.84927368164062, abs dis: 4.933139801025391
[rfa agg] iter: 3, weight: tensor([0.0102, 0.0542, 0.0545, 0.0693, 0.1132, 0.0371, 0.1025, 0.0622, 0.4311,
        0.0657])
[rfa agg] iter:  4, prev_obj_val: 66.84927368164062, obj_val: 64.34574890136719, abs dis: 2.5035247802734375
[rfa agg] iter: 4, weight: tensor([0.0138, 0.0605, 0.0609, 0.1158, 0.1088, 0.0550, 0.1936, 0.0681, 0.2526,
        0.0709])
[rfa agg] iter:  5, prev_obj_val: 64.34574890136719, obj_val: 59.6711540222168, abs dis: 4.674594879150391
[rfa agg] iter: 5, weight: tensor([0.0125, 0.0604, 0.0607, 0.0938, 0.1165, 0.0475, 0.1478, 0.0686, 0.3203,
        0.0719])
[rfa agg] iter:  6, prev_obj_val: 59.6711540222168, obj_val: 64.36161041259766, abs dis: 4.690456390380859
[rfa agg] iter: 6, weight: tensor([0.0086, 0.0503, 0.0506, 0.0539, 0.1156, 0.0301, 0.0765, 0.0584, 0.4938,
        0.0622])
[rfa agg] iter:  7, prev_obj_val: 64.36161041259766, obj_val: 61.91587829589844, abs dis: 2.4457321166992188
[rfa agg] iter: 7, weight: tensor([0.0122, 0.0590, 0.0594, 0.0910, 0.1135, 0.0463, 0.1410, 0.0670, 0.3405,
        0.0702])
[rfa agg] iter:  8, prev_obj_val: 61.91587829589844, obj_val: 66.84934997558594, abs dis: 4.9334716796875
[rfa agg] iter: 8, weight: tensor([0.0102, 0.0542, 0.0545, 0.0692, 0.1132, 0.0370, 0.1025, 0.0622, 0.4314,
        0.0656])
[rfa agg] iter:  9, prev_obj_val: 66.84934997558594, obj_val: 64.34574890136719, abs dis: 2.50360107421875
[rfa agg] iter: 9, weight: tensor([0.0138, 0.0605, 0.0609, 0.1158, 0.1088, 0.0550, 0.1935, 0.0681, 0.2526,
        0.0709])
			Update norm = 133.44819921977216 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.3509, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.09470129013062 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0870, Accuracy: 33/466 (7.0815%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6746, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.2134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8871, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0376, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 555/928 (59.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5475, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 426/891 (47.8114%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0479, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6021, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 139/809 (17.1817%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1208, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 244/1241 (19.6616%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 415/1241 (33.4408%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5111, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 386/1581 (24.4149%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 566/1581 (35.8001%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5448, Accuracy: 96/10000 (0.9600%)
time spent on training: 146.34100937843323
[rfa agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 89, 2, 23, 1, 7, 78, 50, 72, 28], weight: tensor([0.0545, 0.1048, 0.0708, 0.0836, 0.1086, 0.1042, 0.0487, 0.0946, 0.1452,
        0.1850])
[rfa agg] iter:  0, prev_obj_val: 42.35330581665039, obj_val: 48.83518600463867, abs dis: 6.481880187988281
[rfa agg] iter: 0, weight: tensor([0.0223, 0.1684, 0.0474, 0.1368, 0.1023, 0.1559, 0.0166, 0.2756, 0.0427,
        0.0319])
[rfa agg] iter:  1, prev_obj_val: 48.83518600463867, obj_val: 51.576358795166016, abs dis: 2.7411727905273438
[rfa agg] iter: 1, weight: tensor([0.0420, 0.1117, 0.1166, 0.2592, 0.0832, 0.1091, 0.0293, 0.1637, 0.0472,
        0.0379])
[rfa agg] iter:  2, prev_obj_val: 51.576358795166016, obj_val: 57.53839111328125, abs dis: 5.962032318115234
[rfa agg] iter: 2, weight: tensor([0.0538, 0.1038, 0.1776, 0.2179, 0.0812, 0.1017, 0.0364, 0.1380, 0.0493,
        0.0404])
[rfa agg] iter:  3, prev_obj_val: 57.53839111328125, obj_val: 60.81645202636719, abs dis: 3.2780609130859375
[rfa agg] iter: 3, weight: tensor([0.0793, 0.0803, 0.3421, 0.1241, 0.0667, 0.0792, 0.0485, 0.0962, 0.0452,
        0.0384])
[rfa agg] iter:  4, prev_obj_val: 60.81645202636719, obj_val: 64.30209350585938, abs dis: 3.4856414794921875
[rfa agg] iter: 4, weight: tensor([0.1090, 0.0759, 0.3345, 0.1063, 0.0646, 0.0752, 0.0612, 0.0880, 0.0457,
        0.0395])
[rfa agg] iter:  5, prev_obj_val: 64.30209350585938, obj_val: 57.50758743286133, abs dis: 6.794506072998047
[rfa agg] iter: 5, weight: tensor([0.1698, 0.0779, 0.2401, 0.1018, 0.0674, 0.0771, 0.0849, 0.0878, 0.0496,
        0.0435])
[rfa agg] iter:  6, prev_obj_val: 57.50758743286133, obj_val: 60.816673278808594, abs dis: 3.3090858459472656
[rfa agg] iter: 6, weight: tensor([0.0761, 0.0750, 0.3837, 0.1144, 0.0625, 0.0741, 0.0460, 0.0898, 0.0423,
        0.0360])
[rfa agg] iter:  7, prev_obj_val: 60.816673278808594, obj_val: 64.30276489257812, abs dis: 3.4860916137695312
[rfa agg] iter: 7, weight: tensor([0.1079, 0.0751, 0.3418, 0.1050, 0.0639, 0.0744, 0.0606, 0.0870, 0.0452,
        0.0391])
[rfa agg] iter:  8, prev_obj_val: 64.30276489257812, obj_val: 57.50751495361328, abs dis: 6.795249938964844
[rfa agg] iter: 8, weight: tensor([0.1698, 0.0778, 0.2405, 0.1018, 0.0674, 0.0771, 0.0848, 0.0878, 0.0496,
        0.0435])
[rfa agg] iter:  9, prev_obj_val: 57.50751495361328, obj_val: 60.81668472290039, abs dis: 3.3091697692871094
[rfa agg] iter: 9, weight: tensor([0.0761, 0.0750, 0.3838, 0.1144, 0.0625, 0.0741, 0.0460, 0.0898, 0.0423,
        0.0360])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.0327663421631 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 637/1956 (32.5665%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2157, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0637, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 365/1003 (36.3908%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5912, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0564, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3919, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0638, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8305, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2852, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0526, Accuracy: 431/1715 (25.1312%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4823, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0578, Accuracy: 334/807 (41.3879%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.7320, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 446/1089 (40.9550%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1255, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 220/861 (25.5517%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 438/861 (50.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9784, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 321/1013 (31.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5281, Accuracy: 62/10000 (0.6200%)
time spent on training: 157.76525783538818
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 86, 35, 16, 89, 92, 20, 59, 10, 14], weight: tensor([0.1896, 0.0972, 0.0263, 0.0686, 0.0868, 0.1662, 0.0782, 0.1055, 0.0834,
        0.0982])
[rfa agg] iter:  0, prev_obj_val: 56.20771789550781, obj_val: 59.589054107666016, abs dis: 3.381336212158203
[rfa agg] iter: 0, weight: tensor([0.0442, 0.1846, 0.0066, 0.0390, 0.0762, 0.0550, 0.0539, 0.2829, 0.0734,
        0.1842])
[rfa agg] iter:  1, prev_obj_val: 59.589054107666016, obj_val: 70.10328674316406, abs dis: 10.514232635498047
[rfa agg] iter: 1, weight: tensor([0.0275, 0.1417, 0.0065, 0.0624, 0.2109, 0.0317, 0.1066, 0.0701, 0.2007,
        0.1420])
[rfa agg] iter:  2, prev_obj_val: 70.10328674316406, obj_val: 77.6058578491211, abs dis: 7.502571105957031
[rfa agg] iter: 2, weight: tensor([0.0285, 0.0760, 0.0096, 0.2070, 0.1471, 0.0319, 0.2289, 0.0524, 0.1419,
        0.0767])
[rfa agg] iter:  3, prev_obj_val: 77.6058578491211, obj_val: 63.83460998535156, abs dis: 13.771247863769531
[rfa agg] iter: 3, weight: tensor([0.0346, 0.0760, 0.0140, 0.3011, 0.1183, 0.0381, 0.1695, 0.0570, 0.1147,
        0.0767])
[rfa agg] iter:  4, prev_obj_val: 63.83460998535156, obj_val: 73.71804809570312, abs dis: 9.883438110351562
[rfa agg] iter: 4, weight: tensor([0.0245, 0.0844, 0.0069, 0.0971, 0.2082, 0.0278, 0.2016, 0.0515, 0.2131,
        0.0850])
[rfa agg] iter:  5, prev_obj_val: 73.71804809570312, obj_val: 73.6596450805664, abs dis: 0.05840301513671875
[rfa agg] iter: 5, weight: tensor([0.0305, 0.0731, 0.0112, 0.2834, 0.1252, 0.0338, 0.1944, 0.0528, 0.1217,
        0.0738])
[rfa agg] iter:  6, prev_obj_val: 73.6596450805664, obj_val: 70.04257202148438, abs dis: 3.6170730590820312
[rfa agg] iter: 6, weight: tensor([0.0282, 0.0677, 0.0104, 0.3377, 0.1143, 0.0313, 0.1816, 0.0490, 0.1113,
        0.0683])
[rfa agg] iter:  7, prev_obj_val: 70.04257202148438, obj_val: 73.66621398925781, abs dis: 3.6236419677734375
[rfa agg] iter: 7, weight: tensor([0.0267, 0.0709, 0.0090, 0.2455, 0.1328, 0.0299, 0.2344, 0.0491, 0.1303,
        0.0715])
[rfa agg] iter:  8, prev_obj_val: 73.66621398925781, obj_val: 73.65618133544922, abs dis: 0.01003265380859375
[rfa agg] iter: 8, weight: tensor([0.0287, 0.0688, 0.0106, 0.3245, 0.1161, 0.0318, 0.1873, 0.0497, 0.1132,
        0.0694])
[rfa agg] iter:  9, prev_obj_val: 73.65618133544922, obj_val: 70.0456771850586, abs dis: 3.610504150390625
[rfa agg] iter: 9, weight: tensor([0.0277, 0.0664, 0.0102, 0.3516, 0.1119, 0.0307, 0.1775, 0.0480, 0.1089,
        0.0670])
			Update norm = 119.36793990902666 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.1388442516327 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0307, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0074, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 303/1645 (18.4195%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 613/1645 (37.2644%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7485, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0563, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0307, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 642/1956 (32.8221%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.2532, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4815, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0491, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.5113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0575, Accuracy: 323/1418 (22.7786%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 553/1418 (38.9986%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7555, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0308, Accuracy: 500/1049 (47.6644%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7265, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1895, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 358/1275 (28.0784%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 720/1275 (56.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.5329, Accuracy: 78/10000 (0.7800%)
time spent on training: 164.95178127288818
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 13, 54, 6, 63, 49, 70, 51, 58, 9], weight: tensor([0.0682, 0.1446, 0.0993, 0.1719, 0.0780, 0.0387, 0.1246, 0.0922, 0.0706,
        0.1120])
[rfa agg] iter:  0, prev_obj_val: 53.23019027709961, obj_val: 57.5698127746582, abs dis: 4.339622497558594
[rfa agg] iter: 0, weight: tensor([0.0412, 0.0548, 0.3053, 0.0403, 0.0585, 0.0107, 0.0749, 0.2123, 0.0426,
        0.1593])
[rfa agg] iter:  1, prev_obj_val: 57.5698127746582, obj_val: 61.696529388427734, abs dis: 4.126716613769531
[rfa agg] iter: 1, weight: tensor([0.0631, 0.0500, 0.1945, 0.0391, 0.0977, 0.0134, 0.0627, 0.3107, 0.0653,
        0.1036])
[rfa agg] iter:  2, prev_obj_val: 61.696529388427734, obj_val: 66.14315032958984, abs dis: 4.446620941162109
[rfa agg] iter: 2, weight: tensor([0.0998, 0.0522, 0.1424, 0.0422, 0.1748, 0.0172, 0.0628, 0.2119, 0.1030,
        0.0936])
[rfa agg] iter:  3, prev_obj_val: 66.14315032958984, obj_val: 66.11053466796875, abs dis: 0.03261566162109375
[rfa agg] iter: 3, weight: tensor([0.1384, 0.0419, 0.0920, 0.0349, 0.2987, 0.0171, 0.0488, 0.1178, 0.1427,
        0.0677])
[rfa agg] iter:  4, prev_obj_val: 66.11053466796875, obj_val: 68.54727172851562, abs dis: 2.436737060546875
[rfa agg] iter: 4, weight: tensor([0.1348, 0.0405, 0.0887, 0.0337, 0.3212, 0.0166, 0.0472, 0.1125, 0.1393,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 68.54727172851562, obj_val: 71.3345947265625, abs dis: 2.787322998046875
[rfa agg] iter: 5, weight: tensor([0.1569, 0.0332, 0.0669, 0.0280, 0.3670, 0.0151, 0.0381, 0.0815, 0.1620,
        0.0513])
[rfa agg] iter:  6, prev_obj_val: 71.3345947265625, obj_val: 78.13639068603516, abs dis: 6.801795959472656
[rfa agg] iter: 6, weight: tensor([0.2184, 0.0306, 0.0574, 0.0261, 0.2780, 0.0156, 0.0347, 0.0677, 0.2258,
        0.0455])
[rfa agg] iter:  7, prev_obj_val: 78.13639068603516, obj_val: 74.43096923828125, abs dis: 3.7054214477539062
[rfa agg] iter: 7, weight: tensor([0.2774, 0.0334, 0.0557, 0.0290, 0.1496, 0.0216, 0.0370, 0.0627, 0.2871,
        0.0465])
[rfa agg] iter:  8, prev_obj_val: 74.43096923828125, obj_val: 74.42606353759766, abs dis: 0.00490570068359375
[rfa agg] iter: 8, weight: tensor([0.3101, 0.0257, 0.0454, 0.0221, 0.1437, 0.0148, 0.0288, 0.0520, 0.3203,
        0.0370])
[rfa agg] iter:  9, prev_obj_val: 74.42606353759766, obj_val: 78.11225891113281, abs dis: 3.6861953735351562
[rfa agg] iter: 9, weight: tensor([0.3156, 0.0250, 0.0440, 0.0215, 0.1379, 0.0143, 0.0279, 0.0503, 0.3276,
        0.0358])
			Update norm = 119.56035184949482 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.85827708244324 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0661, Accuracy: 271/708 (38.2768%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0341, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.8572, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0584, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.5629, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 646/1904 (33.9286%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0889, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 43/466 (9.2275%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.7383, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0668, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 312/938 (33.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0007, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 694/1742 (39.8393%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6218, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 160/953 (16.7891%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.4081, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 392/1949 (20.1129%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1896, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0581, Accuracy: 199/861 (23.1127%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1768, Accuracy: 52/10000 (0.5200%)
time spent on training: 161.220849275589
[rfa agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 25, 46, 76, 98, 73, 93, 64, 21, 10], weight: tensor([0.0669, 0.0652, 0.1799, 0.0440, 0.0352, 0.0886, 0.1646, 0.0900, 0.1841,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 78.47268676757812, obj_val: 79.59503173828125, abs dis: 1.122344970703125
[rfa agg] iter: 0, weight: tensor([0.0708, 0.0606, 0.1216, 0.0298, 0.0201, 0.1624, 0.1357, 0.1648, 0.1141,
        0.1200])
[rfa agg] iter:  1, prev_obj_val: 79.59503173828125, obj_val: 83.05597686767578, abs dis: 3.4609451293945312
[rfa agg] iter: 1, weight: tensor([0.0715, 0.0585, 0.0748, 0.0264, 0.0173, 0.2271, 0.0808, 0.2298, 0.0711,
        0.1427])
[rfa agg] iter:  2, prev_obj_val: 83.05597686767578, obj_val: 87.24610900878906, abs dis: 4.190132141113281
[rfa agg] iter: 2, weight: tensor([0.0634, 0.0458, 0.0290, 0.0168, 0.0103, 0.2740, 0.0304, 0.2722, 0.0278,
        0.2304])
[rfa agg] iter:  3, prev_obj_val: 87.24610900878906, obj_val: 87.21454620361328, abs dis: 0.03156280517578125
[rfa agg] iter: 3, weight: tensor([0.1227, 0.0798, 0.0345, 0.0251, 0.0147, 0.1734, 0.0359, 0.1750, 0.0333,
        0.3055])
[rfa agg] iter:  4, prev_obj_val: 87.21454620361328, obj_val: 89.7148666381836, abs dis: 2.5003204345703125
[rfa agg] iter: 4, weight: tensor([0.1218, 0.0784, 0.0337, 0.0245, 0.0144, 0.1659, 0.0351, 0.1673, 0.0325,
        0.3265])
[rfa agg] iter:  5, prev_obj_val: 89.7148666381836, obj_val: 89.7048568725586, abs dis: 0.010009765625
[rfa agg] iter: 5, weight: tensor([0.1837, 0.1099, 0.0373, 0.0307, 0.0175, 0.1475, 0.0386, 0.1491, 0.0360,
        0.2496])
			Update norm = 123.58560734871193 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.8830735683441 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 399/1949 (20.4720%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 609/1949 (31.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.3901, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9523, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0775, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0061, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 476/1552 (30.6701%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 766/1552 (49.3557%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.4395, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 280/928 (30.1724%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4323, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0683, Accuracy: 174/773 (22.5097%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 381/773 (49.2885%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1155, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 469/891 (52.6375%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.9959, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3643, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 265/1513 (17.5149%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 482/1513 (31.8572%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3037, Accuracy: 98/10000 (0.9800%)
time spent on training: 159.88717341423035
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 48, 18, 74, 1, 99, 7, 76, 53, 8], weight: tensor([0.1940, 0.0628, 0.0528, 0.1545, 0.0924, 0.0769, 0.0887, 0.0464, 0.0809,
        0.1506])
[rfa agg] iter:  0, prev_obj_val: 66.49598693847656, obj_val: 67.176513671875, abs dis: 0.6805267333984375
[rfa agg] iter: 0, weight: tensor([0.0837, 0.0486, 0.0361, 0.1193, 0.2033, 0.0986, 0.1444, 0.0284, 0.1037,
        0.1339])
[rfa agg] iter:  1, prev_obj_val: 67.176513671875, obj_val: 74.87923431396484, abs dis: 7.702720642089844
[rfa agg] iter: 1, weight: tensor([0.0361, 0.0369, 0.0260, 0.0458, 0.3524, 0.1076, 0.2121, 0.0196, 0.1140,
        0.0496])
[rfa agg] iter:  2, prev_obj_val: 74.87923431396484, obj_val: 80.52909088134766, abs dis: 5.6498565673828125
[rfa agg] iter: 2, weight: tensor([0.0300, 0.0676, 0.0420, 0.0353, 0.1023, 0.2354, 0.1525, 0.0290, 0.2685,
        0.0374])
[rfa agg] iter:  3, prev_obj_val: 80.52909088134766, obj_val: 80.51544189453125, abs dis: 0.01364898681640625
[rfa agg] iter: 3, weight: tensor([0.0381, 0.1401, 0.0772, 0.0438, 0.0980, 0.1813, 0.1312, 0.0497, 0.1945,
        0.0461])
[rfa agg] iter:  4, prev_obj_val: 80.51544189453125, obj_val: 83.52308654785156, abs dis: 3.0076446533203125
[rfa agg] iter: 4, weight: tensor([0.0381, 0.1436, 0.0777, 0.0438, 0.0981, 0.1804, 0.1305, 0.0498, 0.1920,
        0.0461])
[rfa agg] iter:  5, prev_obj_val: 83.52308654785156, obj_val: 80.52131652832031, abs dis: 3.00177001953125
[rfa agg] iter: 5, weight: tensor([0.0389, 0.2021, 0.0995, 0.0442, 0.0906, 0.1469, 0.1153, 0.0604, 0.1556,
        0.0464])
[rfa agg] iter:  6, prev_obj_val: 80.52131652832031, obj_val: 83.52264404296875, abs dis: 3.0013275146484375
[rfa agg] iter: 6, weight: tensor([0.0381, 0.1463, 0.0780, 0.0438, 0.0981, 0.1794, 0.1300, 0.0499, 0.1904,
        0.0461])
[rfa agg] iter:  7, prev_obj_val: 83.52264404296875, obj_val: 80.52135467529297, abs dis: 3.0012893676757812
[rfa agg] iter: 7, weight: tensor([0.0389, 0.2023, 0.0995, 0.0442, 0.0905, 0.1469, 0.1153, 0.0604, 0.1556,
        0.0464])
[rfa agg] iter:  8, prev_obj_val: 80.52135467529297, obj_val: 83.52263641357422, abs dis: 3.00128173828125
[rfa agg] iter: 8, weight: tensor([0.0381, 0.1463, 0.0780, 0.0438, 0.0981, 0.1794, 0.1300, 0.0499, 0.1903,
        0.0461])
[rfa agg] iter:  9, prev_obj_val: 83.52263641357422, obj_val: 80.52135467529297, abs dis: 3.00128173828125
[rfa agg] iter: 9, weight: tensor([0.0389, 0.2023, 0.0995, 0.0442, 0.0905, 0.1469, 0.1153, 0.0604, 0.1556,
        0.0464])
			Update norm = 110.78525645082472 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.402517080307 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 272/636 (42.7673%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 315/1662 (18.9531%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 606/1662 (36.4621%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6325, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 281/928 (30.2802%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 549/928 (59.1595%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7223, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 350/1003 (34.8953%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 372/1003 (37.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6642, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0543, Accuracy: 398/1949 (20.4207%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 617/1949 (31.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2892, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0639, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.9610, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0612, Accuracy: 245/605 (40.4959%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8716, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0337, Accuracy: 404/901 (44.8391%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2985, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0677, Accuracy: 141/568 (24.8239%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7712, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0715, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0344, Accuracy: 311/774 (40.1809%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.3331, Accuracy: 68/10000 (0.6800%)
time spent on training: 158.95218706130981
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 94, 1, 86, 21, 75, 2, 4, 62, 81], weight: tensor([0.0649, 0.1696, 0.0947, 0.1023, 0.1988, 0.0792, 0.0617, 0.0919, 0.0579,
        0.0790])
[rfa agg] iter:  0, prev_obj_val: 61.45467758178711, obj_val: 67.37380981445312, abs dis: 5.919132232666016
[rfa agg] iter: 0, weight: tensor([0.0355, 0.0723, 0.1661, 0.2976, 0.0546, 0.0747, 0.0338, 0.1634, 0.0278,
        0.0744])
[rfa agg] iter:  1, prev_obj_val: 67.37380981445312, obj_val: 72.585693359375, abs dis: 5.211883544921875
[rfa agg] iter: 1, weight: tensor([0.0706, 0.0360, 0.1031, 0.0827, 0.0308, 0.2337, 0.0674, 0.1015, 0.0467,
        0.2274])
[rfa agg] iter:  2, prev_obj_val: 72.585693359375, obj_val: 72.56900787353516, abs dis: 0.01668548583984375
[rfa agg] iter: 2, weight: tensor([0.1330, 0.0404, 0.0907, 0.0773, 0.0352, 0.1655, 0.1271, 0.0887, 0.0777,
        0.1644])
			Update norm = 110.78354193679898 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.3398094177246 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9162, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6995, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 313/1645 (19.0274%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 607/1645 (36.8997%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2862, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0786, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6313, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0611, Accuracy: 241/605 (39.8347%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0377, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.9117, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0582, Accuracy: 203/861 (23.5772%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 455/861 (52.8455%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1679, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 146/809 (18.0470%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 361/809 (44.6230%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3030, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 353/1418 (24.8942%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5969, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0633, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 304/1013 (30.0099%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5437, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9680, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.02451944351196
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 82, 13, 67, 2, 10, 50, 70, 14, 69], weight: tensor([0.1314, 0.0552, 0.1816, 0.0470, 0.0668, 0.0951, 0.0893, 0.1566, 0.1118,
        0.0651])
[rfa agg] iter:  0, prev_obj_val: 51.75828552246094, obj_val: 57.8232421875, abs dis: 6.0649566650390625
[rfa agg] iter: 0, weight: tensor([0.0869, 0.0256, 0.0479, 0.0189, 0.0446, 0.3144, 0.1613, 0.0557, 0.2011,
        0.0435])
[rfa agg] iter:  1, prev_obj_val: 57.8232421875, obj_val: 60.057708740234375, abs dis: 2.234466552734375
[rfa agg] iter: 1, weight: tensor([0.0629, 0.0380, 0.0423, 0.0265, 0.0811, 0.1866, 0.3384, 0.0468, 0.0985,
        0.0788])
[rfa agg] iter:  2, prev_obj_val: 60.057708740234375, obj_val: 60.051631927490234, abs dis: 0.006076812744140625
[rfa agg] iter: 2, weight: tensor([0.0657, 0.0478, 0.0458, 0.0327, 0.1124, 0.1601, 0.2800, 0.0501, 0.0970,
        0.1084])
			Update norm = 115.03094862090376 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.5666968822479 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0600, Accuracy: 384/1750 (21.9429%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 676/1750 (38.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6870, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 494/1446 (34.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.0875, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 259/813 (31.8573%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.8361, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 383/1131 (33.8638%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8697, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 321/1154 (27.8163%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0304, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 334/1662 (20.0963%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 576/1662 (34.6570%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1674, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0605, Accuracy: 250/605 (41.3223%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.9561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 239/774 (30.8786%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0369, Accuracy: 309/774 (39.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2443, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 224/631 (35.4992%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.9061, Accuracy: 50/10000 (0.5000%)
time spent on training: 162.94021272659302
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 26, 53, 87, 15, 94, 31, 2, 81, 48], weight: tensor([0.1678, 0.1387, 0.0780, 0.1085, 0.1107, 0.1594, 0.0441, 0.0580, 0.0742,
        0.0605])
[rfa agg] iter:  0, prev_obj_val: 55.48855972290039, obj_val: 58.4644660949707, abs dis: 2.9759063720703125
[rfa agg] iter: 0, weight: tensor([0.0538, 0.0842, 0.0578, 0.4015, 0.2162, 0.0630, 0.0156, 0.0260, 0.0549,
        0.0271])
[rfa agg] iter:  1, prev_obj_val: 58.4644660949707, obj_val: 61.71904373168945, abs dis: 3.25457763671875
[rfa agg] iter: 1, weight: tensor([0.0636, 0.0924, 0.0952, 0.2990, 0.1853, 0.0729, 0.0226, 0.0387, 0.0899,
        0.0404])
[rfa agg] iter:  2, prev_obj_val: 61.71904373168945, obj_val: 63.36396408081055, abs dis: 1.6449203491210938
[rfa agg] iter: 2, weight: tensor([0.0652, 0.0894, 0.1462, 0.2054, 0.1504, 0.0736, 0.0284, 0.0508, 0.1375,
        0.0531])
[rfa agg] iter:  3, prev_obj_val: 63.36396408081055, obj_val: 65.03739929199219, abs dis: 1.6734352111816406
[rfa agg] iter: 3, weight: tensor([0.0617, 0.0826, 0.1781, 0.1689, 0.1300, 0.0692, 0.0300, 0.0550, 0.1671,
        0.0574])
[rfa agg] iter:  4, prev_obj_val: 65.03739929199219, obj_val: 65.03376770019531, abs dis: 0.003631591796875
[rfa agg] iter: 4, weight: tensor([0.0556, 0.0728, 0.2165, 0.1361, 0.1085, 0.0619, 0.0302, 0.0570, 0.2016,
        0.0596])
			Update norm = 136.33833145891143 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.2999, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.42648243904114 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 129/682 (18.9150%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0387, Accuracy: 239/682 (35.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3584, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3191, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0667, Accuracy: 155/938 (16.5245%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 331/938 (35.2878%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7714, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 757/1552 (48.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.4871, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0681, Accuracy: 194/669 (28.9985%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0396, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8355, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 338/1130 (29.9115%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2792, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 506/1372 (36.8805%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9938, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0897, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3279, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.0610, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 129/809 (15.9456%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 350/809 (43.2633%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6253, Accuracy: 81/10000 (0.8100%)
time spent on training: 153.6110017299652
[rfa agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 56, 73, 74, 45, 54, 42, 79, 7, 50], weight: tensor([0.0809, 0.0221, 0.1113, 0.1842, 0.0794, 0.1341, 0.1628, 0.0234, 0.1057,
        0.0960])
[rfa agg] iter:  0, prev_obj_val: 45.714881896972656, obj_val: 48.139671325683594, abs dis: 2.4247894287109375
[rfa agg] iter: 0, weight: tensor([0.0559, 0.0046, 0.2927, 0.0431, 0.0550, 0.0916, 0.0532, 0.0054, 0.2574,
        0.1411])
[rfa agg] iter:  1, prev_obj_val: 48.139671325683594, obj_val: 54.87995910644531, abs dis: 6.740287780761719
[rfa agg] iter: 1, weight: tensor([0.0720, 0.0048, 0.1598, 0.0372, 0.0707, 0.0682, 0.0444, 0.0056, 0.2859,
        0.2514])
[rfa agg] iter:  2, prev_obj_val: 54.87995910644531, obj_val: 57.4991340637207, abs dis: 2.6191749572753906
[rfa agg] iter: 2, weight: tensor([0.1835, 0.0067, 0.1019, 0.0400, 0.1794, 0.0625, 0.0458, 0.0080, 0.1417,
        0.2304])
[rfa agg] iter:  3, prev_obj_val: 57.4991340637207, obj_val: 67.94496154785156, abs dis: 10.44582748413086
[rfa agg] iter: 3, weight: tensor([0.2674, 0.0064, 0.0790, 0.0347, 0.2595, 0.0520, 0.0393, 0.0077, 0.1020,
        0.1519])
[rfa agg] iter:  4, prev_obj_val: 67.94496154785156, obj_val: 57.473838806152344, abs dis: 10.471122741699219
[rfa agg] iter: 4, weight: tensor([0.2662, 0.0111, 0.0811, 0.0452, 0.2603, 0.0614, 0.0499, 0.0138, 0.0952,
        0.1156])
[rfa agg] iter:  5, prev_obj_val: 57.473838806152344, obj_val: 64.04554748535156, abs dis: 6.571708679199219
[rfa agg] iter: 5, weight: tensor([0.2771, 0.0062, 0.0757, 0.0333, 0.2726, 0.0499, 0.0378, 0.0074, 0.0970,
        0.1429])
[rfa agg] iter:  6, prev_obj_val: 64.04554748535156, obj_val: 67.94673156738281, abs dis: 3.90118408203125
[rfa agg] iter: 6, weight: tensor([0.3110, 0.0077, 0.0663, 0.0345, 0.3034, 0.0483, 0.0384, 0.0095, 0.0796,
        0.1013])
[rfa agg] iter:  7, prev_obj_val: 67.94673156738281, obj_val: 60.45489501953125, abs dis: 7.4918365478515625
[rfa agg] iter: 7, weight: tensor([0.2679, 0.0110, 0.0805, 0.0449, 0.2626, 0.0610, 0.0496, 0.0137, 0.0943,
        0.1144])
[rfa agg] iter:  8, prev_obj_val: 60.45489501953125, obj_val: 64.04167938232422, abs dis: 3.5867843627929688
[rfa agg] iter: 8, weight: tensor([0.3345, 0.0056, 0.0574, 0.0277, 0.3301, 0.0400, 0.0311, 0.0068, 0.0710,
        0.0959])
[rfa agg] iter:  9, prev_obj_val: 64.04167938232422, obj_val: 67.94767761230469, abs dis: 3.9059982299804688
[rfa agg] iter: 9, weight: tensor([0.3159, 0.0075, 0.0645, 0.0337, 0.3092, 0.0470, 0.0375, 0.0092, 0.0773,
        0.0983])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3014, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.3266, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.5595109462738 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 431/1574 (27.3825%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0248, Accuracy: 800/1574 (50.8259%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0206, Accuracy: 936/1574 (59.4663%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0196, Accuracy: 964/1574 (61.2452%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0192, Accuracy: 979/1574 (62.1982%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0191, Accuracy: 980/1574 (62.2618%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0184, Accuracy: 995/1574 (63.2147%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0182, Accuracy: 1010/1574 (64.1677%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0176, Accuracy: 1020/1574 (64.8030%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0178, Accuracy: 1003/1574 (63.7230%), train_poison_data_count: 500
Global model norm: 112.05354119236928.
Norm before scaling: 112.0297986307661. Distance: 1.2332727363666642
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9706, Accuracy: 91/10000 (0.9100%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.1369, Accuracy: 9896/9950 (99.4573%)
Scaling by  100
Scaled Norm after poisoning: 164.564440503181, distance: 123.32727673754903
Total norm for 1 adversaries is: 164.564440503181. distance: 123.32727673754903
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 422/1190 (35.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1394, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0622, Accuracy: 133/809 (16.4400%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 333/809 (41.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3334, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3569, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 315/1645 (19.1489%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1645 (37.3252%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8129, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 325/599 (54.2571%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8542, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.5152, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 381/1372 (27.7697%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 497/1372 (36.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9363, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9226, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/1130 (30.0000%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8805, Accuracy: 51/10000 (0.5100%)
time spent on training: 291.4179193973541
[rfa agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.04668517463933181
[rfa agg] init. name: [17, 84, 50, 25, 13, 95, 98, 42, 15, 54], weight: tensor([0.1494, 0.1129, 0.0768, 0.0655, 0.1561, 0.0569, 0.0354, 0.1302, 0.1095,
        0.1073])
[rfa agg] iter:  0, prev_obj_val: 28378.564453125, obj_val: 19014.005859375, abs dis: 9364.55859375
[rfa agg] iter: 0, weight: tensor([0.0299, 0.1289, 0.0873, 0.0744, 0.1788, 0.0646, 0.0401, 0.1488, 0.1250,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 19014.005859375, obj_val: 17093.4296875, abs dis: 1920.576171875
[rfa agg] iter: 1, weight: tensor([0.0053, 0.1323, 0.0885, 0.0751, 0.1864, 0.0650, 0.0401, 0.1538, 0.1283,
        0.1253])
[rfa agg] iter:  2, prev_obj_val: 17093.4296875, obj_val: 16751.89453125, abs dis: 341.53515625
[rfa agg] iter: 2, weight: tensor([0.0009, 0.1331, 0.0827, 0.0686, 0.2068, 0.0587, 0.0346, 0.1611, 0.1291,
        0.1245])
[rfa agg] iter:  3, prev_obj_val: 16751.89453125, obj_val: 16724.59375, abs dis: 27.30078125
[rfa agg] iter: 3, weight: tensor([8.5401e-05, 8.8822e-02, 3.6442e-02, 2.7442e-02, 4.9792e-01, 2.2500e-02,
        1.1454e-02, 1.5293e-01, 8.6232e-02, 7.6174e-02])
[rfa agg] iter:  4, prev_obj_val: 16724.59375, obj_val: 16726.19140625, abs dis: 1.59765625
[rfa agg] iter: 4, weight: tensor([4.2473e-05, 2.0732e-01, 3.5970e-02, 2.4355e-02, 1.0021e-01, 1.9134e-02,
        8.6317e-03, 2.5841e-01, 2.0633e-01, 1.3959e-01])
[rfa agg] iter:  5, prev_obj_val: 16726.19140625, obj_val: 16732.1953125, abs dis: 6.00390625
[rfa agg] iter: 5, weight: tensor([3.3261e-05, 2.1945e-01, 4.1958e-02, 2.5842e-02, 5.3802e-02, 1.9648e-02,
        8.1611e-03, 8.8627e-02, 2.1968e-01, 3.2280e-01])
[rfa agg] iter:  6, prev_obj_val: 16732.1953125, obj_val: 16734.466796875, abs dis: 2.271484375
[rfa agg] iter: 6, weight: tensor([5.1646e-05, 1.8032e-01, 9.1587e-02, 5.0867e-02, 7.0456e-02, 3.7452e-02,
        1.4461e-02, 1.0049e-01, 1.7727e-01, 2.7704e-01])
			Update norm = 148.4182026930154 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3014, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.3266, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.94277477264404 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0582, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1247, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 478/1715 (27.8717%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 705/1715 (41.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6394, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0797, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.6429, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 98/631 (15.5309%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.8961, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 337/1030 (32.7184%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 631/1030 (61.2621%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4147, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 446/1988 (22.4346%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 642/1988 (32.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8208, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0852, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1956 (31.5951%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2400, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 409/1953 (20.9421%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 748/1953 (38.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8451, Accuracy: 83/10000 (0.8300%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 379/1574 (24.0788%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0984, Accuracy: 86/10000 (0.8600%)
time spent on training: 188.715229511261
[rfa agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.039205722939582334
[rfa agg] init. name: [20, 92, 67, 48, 91, 85, 76, 6, 83, 17], weight: tensor([0.0643, 0.1367, 0.0340, 0.0503, 0.0821, 0.1585, 0.0371, 0.1559, 0.1557,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 70.8585433959961, obj_val: 66.80977630615234, abs dis: 4.04876708984375
[rfa agg] iter: 0, weight: tensor([0.0422, 0.1840, 0.0137, 0.0251, 0.0916, 0.1037, 0.0160, 0.1140, 0.1138,
        0.2959])
[rfa agg] iter:  1, prev_obj_val: 66.80977630615234, obj_val: 66.80288696289062, abs dis: 0.00688934326171875
[rfa agg] iter: 1, weight: tensor([0.0307, 0.1871, 0.0103, 0.0187, 0.0626, 0.0929, 0.0120, 0.1035, 0.1033,
        0.3789])
[rfa agg] iter:  2, prev_obj_val: 66.80288696289062, obj_val: 64.8395767211914, abs dis: 1.9633102416992188
[rfa agg] iter: 2, weight: tensor([0.0305, 0.1857, 0.0103, 0.0186, 0.0621, 0.0922, 0.0119, 0.1027, 0.1026,
        0.3834])
[rfa agg] iter:  3, prev_obj_val: 64.8395767211914, obj_val: 66.80607604980469, abs dis: 1.9664993286132812
[rfa agg] iter: 3, weight: tensor([0.0246, 0.1800, 0.0084, 0.0151, 0.0488, 0.0826, 0.0098, 0.0928, 0.0927,
        0.4451])
[rfa agg] iter:  4, prev_obj_val: 66.80607604980469, obj_val: 66.80287170410156, abs dis: 0.003204345703125
[rfa agg] iter: 4, weight: tensor([0.0303, 0.1844, 0.0102, 0.0185, 0.0618, 0.0917, 0.0119, 0.1021, 0.1020,
        0.3872])
[rfa agg] iter:  5, prev_obj_val: 66.80287170410156, obj_val: 64.83951568603516, abs dis: 1.9633560180664062
[rfa agg] iter: 5, weight: tensor([0.0305, 0.1855, 0.0102, 0.0185, 0.0621, 0.0921, 0.0119, 0.1026, 0.1025,
        0.3840])
[rfa agg] iter:  6, prev_obj_val: 64.83951568603516, obj_val: 66.80607604980469, abs dis: 1.9665603637695312
[rfa agg] iter: 6, weight: tensor([0.0246, 0.1800, 0.0084, 0.0151, 0.0488, 0.0826, 0.0098, 0.0928, 0.0927,
        0.4452])
[rfa agg] iter:  7, prev_obj_val: 66.80607604980469, obj_val: 66.80287170410156, abs dis: 0.003204345703125
[rfa agg] iter: 7, weight: tensor([0.0303, 0.1844, 0.0102, 0.0185, 0.0618, 0.0917, 0.0119, 0.1021, 0.1020,
        0.3872])
[rfa agg] iter:  8, prev_obj_val: 66.80287170410156, obj_val: 64.83951568603516, abs dis: 1.9633560180664062
[rfa agg] iter: 8, weight: tensor([0.0305, 0.1855, 0.0102, 0.0185, 0.0621, 0.0921, 0.0119, 0.1026, 0.1025,
        0.3840])
[rfa agg] iter:  9, prev_obj_val: 64.83951568603516, obj_val: 66.80607604980469, abs dis: 1.9665603637695312
[rfa agg] iter: 9, weight: tensor([0.0246, 0.1800, 0.0084, 0.0151, 0.0488, 0.0826, 0.0098, 0.0928, 0.0927,
        0.4452])
			Update norm = 213.93276177925625 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3014, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.3266, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.2901632785797 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 343/712 (48.1742%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 443/712 (62.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.8674, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0560, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 407/803 (50.6849%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.1632, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0506, Accuracy: 279/813 (34.3173%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 469/813 (57.6876%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1357, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 417/1131 (36.8700%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6997, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.4322, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.8228, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0556, Accuracy: 386/1475 (26.1695%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0324, Accuracy: 676/1475 (45.8305%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1724, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 588/2227 (26.4032%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1018/2227 (45.7117%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5767, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0276, Accuracy: 456/1154 (39.5147%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9317, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0330, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6283, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.0777337551117
[rfa agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 58, 53, 87, 95, 62, 65, 60, 57, 69], weight: tensor([0.0707, 0.0797, 0.0807, 0.1123, 0.0595, 0.0564, 0.1464, 0.2211, 0.1146,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 68.45484924316406, obj_val: 69.75415802001953, abs dis: 1.2993087768554688
[rfa agg] iter: 0, weight: tensor([0.0338, 0.0443, 0.0449, 0.2840, 0.0221, 0.0189, 0.0966, 0.0464, 0.3873,
        0.0218])
[rfa agg] iter:  1, prev_obj_val: 69.75415802001953, obj_val: 73.07284545898438, abs dis: 3.3186874389648438
[rfa agg] iter: 1, weight: tensor([0.0681, 0.0972, 0.0990, 0.2920, 0.0399, 0.0329, 0.0852, 0.0525, 0.1939,
        0.0393])
[rfa agg] iter:  2, prev_obj_val: 73.07284545898438, obj_val: 74.9333724975586, abs dis: 1.8605270385742188
[rfa agg] iter: 2, weight: tensor([0.1122, 0.1962, 0.2028, 0.1299, 0.0537, 0.0419, 0.0632, 0.0444, 0.1028,
        0.0528])
[rfa agg] iter:  3, prev_obj_val: 74.9333724975586, obj_val: 86.06515502929688, abs dis: 11.131782531738281
[rfa agg] iter: 3, weight: tensor([0.1180, 0.2726, 0.2985, 0.0666, 0.0452, 0.0337, 0.0376, 0.0279, 0.0555,
        0.0445])
[rfa agg] iter:  4, prev_obj_val: 86.06515502929688, obj_val: 85.97761535644531, abs dis: 0.0875396728515625
[rfa agg] iter: 4, weight: tensor([0.1918, 0.1240, 0.1268, 0.0513, 0.1557, 0.0865, 0.0362, 0.0297, 0.0457,
        0.1523])
[rfa agg] iter:  5, prev_obj_val: 85.97761535644531, obj_val: 85.97740173339844, abs dis: 0.000213623046875
[rfa agg] iter: 5, weight: tensor([0.1955, 0.1177, 0.1209, 0.0497, 0.1630, 0.0852, 0.0351, 0.0288, 0.0444,
        0.1598])
			Update norm = 105.19131566163149 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3014, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.3266, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.98494577407837 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0713, Accuracy: 102/631 (16.1648%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0418, Accuracy: 204/631 (32.3296%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8858, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0539, Accuracy: 328/1030 (31.8447%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 610/1030 (59.2233%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2372, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 254/1402 (18.1170%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 353/1402 (25.1783%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0704, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 320/946 (33.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.0319, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0585, Accuracy: 331/715 (46.2937%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0400, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8249, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 522/1657 (31.5027%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0704, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 301/1645 (18.2979%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 590/1645 (35.8663%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1625, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3293, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0655, Accuracy: 184/773 (23.8034%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0318, Accuracy: 385/773 (49.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4592, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0568, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4652, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.06134557724
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 91, 66, 43, 23, 0, 13, 89, 99, 69], weight: tensor([0.0614, 0.1001, 0.1363, 0.0920, 0.0695, 0.1611, 0.1599, 0.0871, 0.0752,
        0.0574])
[rfa agg] iter:  0, prev_obj_val: 51.31758117675781, obj_val: 57.295013427734375, abs dis: 5.9774322509765625
[rfa agg] iter: 0, weight: tensor([0.0340, 0.2293, 0.0753, 0.2482, 0.0568, 0.0538, 0.0534, 0.1366, 0.0809,
        0.0318])
[rfa agg] iter:  1, prev_obj_val: 57.295013427734375, obj_val: 68.1167221069336, abs dis: 10.821708679199219
[rfa agg] iter: 1, weight: tensor([0.0453, 0.0737, 0.0424, 0.1516, 0.1037, 0.0342, 0.0339, 0.2705, 0.2025,
        0.0423])
[rfa agg] iter:  2, prev_obj_val: 68.1167221069336, obj_val: 71.38919067382812, abs dis: 3.2724685668945312
[rfa agg] iter: 2, weight: tensor([0.1217, 0.0601, 0.0435, 0.0870, 0.2327, 0.0373, 0.0370, 0.1143, 0.1522,
        0.1142])
[rfa agg] iter:  3, prev_obj_val: 71.38919067382812, obj_val: 74.8365707397461, abs dis: 3.4473800659179688
[rfa agg] iter: 3, weight: tensor([0.1705, 0.0568, 0.0427, 0.0783, 0.1937, 0.0371, 0.0368, 0.0980, 0.1225,
        0.1634])
[rfa agg] iter:  4, prev_obj_val: 74.8365707397461, obj_val: 78.49882507324219, abs dis: 3.6622543334960938
[rfa agg] iter: 4, weight: tensor([0.2365, 0.0498, 0.0387, 0.0661, 0.1348, 0.0340, 0.0338, 0.0800, 0.0946,
        0.2316])
[rfa agg] iter:  5, prev_obj_val: 78.49882507324219, obj_val: 82.57727813720703, abs dis: 4.078453063964844
[rfa agg] iter: 5, weight: tensor([0.2925, 0.0415, 0.0332, 0.0534, 0.0939, 0.0295, 0.0293, 0.0630, 0.0713,
        0.2922])
[rfa agg] iter:  6, prev_obj_val: 82.57727813720703, obj_val: 82.57665252685547, abs dis: 0.0006256103515625
[rfa agg] iter: 6, weight: tensor([0.2843, 0.0461, 0.0379, 0.0578, 0.0912, 0.0340, 0.0338, 0.0667, 0.0731,
        0.2751])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3032, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.3306, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.30900263786316 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 424/1440 (29.4444%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 674/1440 (46.8056%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8716, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0384, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8607, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 332/1662 (19.9759%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 588/1662 (35.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9202, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 382/1657 (23.0537%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 500/1657 (30.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3840, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 569/2227 (25.5501%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1022/2227 (45.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3505, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 398/1949 (20.4207%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 615/1949 (31.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4439, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0826, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5982, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0429, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7051, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 65/486 (13.3745%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0422, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.9188, Accuracy: 58/10000 (0.5800%)
time spent on training: 170.39354705810547
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 31, 94, 0, 60, 21, 98, 67, 96, 30], weight: tensor([0.1310, 0.0419, 0.1512, 0.1508, 0.2026, 0.1773, 0.0339, 0.0388, 0.0283,
        0.0442])
[rfa agg] iter:  0, prev_obj_val: 75.90348052978516, obj_val: 73.14767456054688, abs dis: 2.7558059692382812
[rfa agg] iter: 0, weight: tensor([0.4501, 0.0136, 0.1678, 0.1653, 0.0708, 0.0891, 0.0096, 0.0117, 0.0076,
        0.0144])
[rfa agg] iter:  1, prev_obj_val: 73.14767456054688, obj_val: 70.72742462158203, abs dis: 2.4202499389648438
[rfa agg] iter: 1, weight: tensor([0.5697, 0.0094, 0.1365, 0.1340, 0.0527, 0.0676, 0.0067, 0.0082, 0.0053,
        0.0099])
[rfa agg] iter:  2, prev_obj_val: 70.72742462158203, obj_val: 73.12483978271484, abs dis: 2.3974151611328125
[rfa agg] iter: 2, weight: tensor([0.6718, 0.0063, 0.1083, 0.1057, 0.0380, 0.0497, 0.0045, 0.0055, 0.0035,
        0.0067])
[rfa agg] iter:  3, prev_obj_val: 73.12483978271484, obj_val: 70.7066421508789, abs dis: 2.4181976318359375
[rfa agg] iter: 3, weight: tensor([0.6240, 0.0083, 0.1190, 0.1165, 0.0464, 0.0594, 0.0059, 0.0072, 0.0046,
        0.0088])
[rfa agg] iter:  4, prev_obj_val: 70.7066421508789, obj_val: 73.13047790527344, abs dis: 2.4238357543945312
[rfa agg] iter: 4, weight: tensor([0.7015, 0.0057, 0.0984, 0.0959, 0.0347, 0.0453, 0.0041, 0.0050, 0.0032,
        0.0061])
[rfa agg] iter:  5, prev_obj_val: 73.13047790527344, obj_val: 70.70431518554688, abs dis: 2.4261627197265625
[rfa agg] iter: 5, weight: tensor([0.6308, 0.0081, 0.1168, 0.1143, 0.0456, 0.0584, 0.0058, 0.0071, 0.0046,
        0.0086])
[rfa agg] iter:  6, prev_obj_val: 70.70431518554688, obj_val: 73.13140869140625, abs dis: 2.427093505859375
[rfa agg] iter: 6, weight: tensor([0.7054, 0.0057, 0.0971, 0.0947, 0.0342, 0.0447, 0.0041, 0.0049, 0.0032,
        0.0060])
[rfa agg] iter:  7, prev_obj_val: 73.13140869140625, obj_val: 70.70401000976562, abs dis: 2.427398681640625
[rfa agg] iter: 7, weight: tensor([0.6317, 0.0081, 0.1165, 0.1140, 0.0455, 0.0583, 0.0058, 0.0070, 0.0045,
        0.0086])
[rfa agg] iter:  8, prev_obj_val: 70.70401000976562, obj_val: 73.13153076171875, abs dis: 2.427520751953125
[rfa agg] iter: 8, weight: tensor([0.7059, 0.0057, 0.0970, 0.0945, 0.0342, 0.0446, 0.0041, 0.0049, 0.0032,
        0.0060])
[rfa agg] iter:  9, prev_obj_val: 73.13153076171875, obj_val: 70.7039794921875, abs dis: 2.42755126953125
[rfa agg] iter: 9, weight: tensor([0.6318, 0.0081, 0.1164, 0.1140, 0.0454, 0.0583, 0.0058, 0.0070, 0.0045,
        0.0086])
			Update norm = 208.8817043358513 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3032, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3306, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.2419013977051 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0556, Accuracy: 319/1446 (22.0609%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 483/1446 (33.4025%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2500, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0655, Accuracy: 219/669 (32.7354%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0395, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8606, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0473, Accuracy: 383/1036 (36.9691%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 638/1036 (61.5830%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.4330, Accuracy: 59/10000 (0.5900%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 410/1574 (26.0483%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 680/1574 (43.2020%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2017, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 312/1190 (26.2185%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 424/1190 (35.6303%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2331, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 266/1513 (17.5810%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 458/1513 (30.2710%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3970, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 436/677 (64.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6209, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0682, Accuracy: 158/682 (23.1672%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 250/682 (36.6569%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.4936, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.1961, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0686, Accuracy: 107/631 (16.9572%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.9629, Accuracy: 50/10000 (0.5000%)
time spent on training: 177.23958325386047
[rfa agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[rfa agg] considering poison per batch poison_fraction: 0.04812396047353487
[rfa agg] init. name: [26, 45, 19, 17, 84, 8, 90, 80, 58, 48], weight: tensor([0.1415, 0.0655, 0.1014, 0.1540, 0.1164, 0.1480, 0.0662, 0.0667, 0.0786,
        0.0617])
[rfa agg] iter:  0, prev_obj_val: 49.80677795410156, obj_val: 53.77098083496094, abs dis: 3.964202880859375
[rfa agg] iter: 0, weight: tensor([0.0814, 0.0447, 0.3568, 0.0682, 0.1649, 0.0743, 0.0453, 0.0456, 0.0830,
        0.0357])
[rfa agg] iter:  1, prev_obj_val: 53.77098083496094, obj_val: 56.643775939941406, abs dis: 2.8727951049804688
[rfa agg] iter: 1, weight: tensor([0.0785, 0.0721, 0.2150, 0.0687, 0.1271, 0.0734, 0.0733, 0.0736, 0.1636,
        0.0546])
[rfa agg] iter:  2, prev_obj_val: 56.643775939941406, obj_val: 66.2565689086914, abs dis: 9.61279296875
[rfa agg] iter: 2, weight: tensor([0.0638, 0.0871, 0.1333, 0.0571, 0.0936, 0.0603, 0.0885, 0.0890, 0.2651,
        0.0621])
[rfa agg] iter:  3, prev_obj_val: 66.2565689086914, obj_val: 72.2711410522461, abs dis: 6.0145721435546875
[rfa agg] iter: 3, weight: tensor([0.0304, 0.1980, 0.0451, 0.0282, 0.0382, 0.0293, 0.2085, 0.2089, 0.1211,
        0.0923])
[rfa agg] iter:  4, prev_obj_val: 72.2711410522461, obj_val: 72.26383972167969, abs dis: 0.00730133056640625
[rfa agg] iter: 4, weight: tensor([0.0256, 0.2027, 0.0350, 0.0240, 0.0309, 0.0248, 0.2066, 0.2172, 0.0688,
        0.1643])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3053, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3402, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.58649158477783 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 153/338 (45.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5981, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1012, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0884, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3442, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0531, Accuracy: 303/590 (51.3559%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3363, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1235, Accuracy: 6/134 (4.4776%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1113, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 330/1340 (24.6269%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 541/1340 (40.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8005, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 522/1071 (48.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9803, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0884, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5725, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 70/500 (14.0000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.9454, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0635, Accuracy: 223/669 (33.3333%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.9803, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 289/1089 (26.5381%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 453/1089 (41.5978%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4628, Accuracy: 67/10000 (0.6700%)
time spent on training: 140.2658085823059
[rfa agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 79, 69, 47, 77, 55, 36, 82, 45, 59], weight: tensor([0.0533, 0.0311, 0.0931, 0.0211, 0.2115, 0.1690, 0.0644, 0.0789, 0.1056,
        0.1719])
[rfa agg] iter:  0, prev_obj_val: 50.34956741333008, obj_val: 52.19031524658203, abs dis: 1.8407478332519531
[rfa agg] iter: 0, weight: tensor([0.0315, 0.0134, 0.1887, 0.0080, 0.0728, 0.0998, 0.0465, 0.0731, 0.3805,
        0.0856])
[rfa agg] iter:  1, prev_obj_val: 52.19031524658203, obj_val: 55.727691650390625, abs dis: 3.5373764038085938
[rfa agg] iter: 1, weight: tensor([0.0284, 0.0114, 0.3060, 0.0067, 0.0486, 0.0626, 0.0439, 0.0745, 0.3632,
        0.0548])
[rfa agg] iter:  2, prev_obj_val: 55.727691650390625, obj_val: 57.88318634033203, abs dis: 2.1554946899414062
[rfa agg] iter: 2, weight: tensor([0.0413, 0.0153, 0.3766, 0.0088, 0.0507, 0.0620, 0.0693, 0.1358, 0.1847,
        0.0554])
[rfa agg] iter:  3, prev_obj_val: 57.88318634033203, obj_val: 57.871856689453125, abs dis: 0.01132965087890625
[rfa agg] iter: 3, weight: tensor([0.0538, 0.0188, 0.2691, 0.0106, 0.0544, 0.0651, 0.0961, 0.2182, 0.1555,
        0.0586])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3072, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3533, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.36470341682434 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 454/1130 (40.1770%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.5389, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0524, Accuracy: 352/712 (49.4382%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.1556, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6448, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0654, Accuracy: 156/818 (19.0709%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 339/818 (41.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3807, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 346/1645 (21.0334%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 631/1645 (38.3587%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2129, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0780, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0429, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.5180, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0679, Accuracy: 114/631 (18.0666%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0400, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.0820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0793, Accuracy: 77/486 (15.8436%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.1179, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0871, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0471, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8344, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 245/1071 (22.8758%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 470/1071 (43.8842%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3374, Accuracy: 70/10000 (0.7000%)
time spent on training: 153.3757348060608
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 11, 49, 71, 13, 24, 48, 30, 76, 55], weight: tensor([0.1465, 0.0923, 0.0571, 0.1061, 0.2133, 0.0405, 0.0818, 0.0630, 0.0604,
        0.1389])
[rfa agg] iter:  0, prev_obj_val: 52.068782806396484, obj_val: 56.937870025634766, abs dis: 4.869087219238281
[rfa agg] iter: 0, weight: tensor([0.0775, 0.2073, 0.0253, 0.4040, 0.0439, 0.0135, 0.0720, 0.0336, 0.0321,
        0.0907])
[rfa agg] iter:  1, prev_obj_val: 56.937870025634766, obj_val: 60.582603454589844, abs dis: 3.644733428955078
[rfa agg] iter: 1, weight: tensor([0.0650, 0.2492, 0.0439, 0.1619, 0.0444, 0.0208, 0.2177, 0.0644, 0.0612,
        0.0716])
[rfa agg] iter:  2, prev_obj_val: 60.582603454589844, obj_val: 65.33565521240234, abs dis: 4.7530517578125
[rfa agg] iter: 2, weight: tensor([0.0458, 0.1126, 0.0469, 0.0869, 0.0334, 0.0201, 0.4557, 0.0766, 0.0726,
        0.0494])
[rfa agg] iter:  3, prev_obj_val: 65.33565521240234, obj_val: 70.65620422363281, abs dis: 5.320549011230469
[rfa agg] iter: 3, weight: tensor([0.0496, 0.0923, 0.0843, 0.0798, 0.0383, 0.0303, 0.2404, 0.1720, 0.1604,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 70.65620422363281, obj_val: 70.59941864013672, abs dis: 0.05678558349609375
[rfa agg] iter: 4, weight: tensor([0.0315, 0.0492, 0.1109, 0.0452, 0.0255, 0.0282, 0.0865, 0.3252, 0.2647,
        0.0331])
[rfa agg] iter:  5, prev_obj_val: 70.59941864013672, obj_val: 77.60771942138672, abs dis: 7.00830078125
[rfa agg] iter: 5, weight: tensor([0.0274, 0.0428, 0.0986, 0.0394, 0.0222, 0.0247, 0.0747, 0.3646, 0.2767,
        0.0288])
[rfa agg] iter:  6, prev_obj_val: 77.60771942138672, obj_val: 73.94403076171875, abs dis: 3.6636886596679688
[rfa agg] iter: 6, weight: tensor([0.0361, 0.0497, 0.3576, 0.0476, 0.0304, 0.0521, 0.0731, 0.1637, 0.1522,
        0.0375])
[rfa agg] iter:  7, prev_obj_val: 73.94403076171875, obj_val: 73.93535614013672, abs dis: 0.00867462158203125
[rfa agg] iter: 7, weight: tensor([0.0337, 0.0491, 0.2335, 0.0462, 0.0279, 0.0380, 0.0778, 0.2416, 0.2170,
        0.0352])
[rfa agg] iter:  8, prev_obj_val: 73.93535614013672, obj_val: 73.9352798461914, abs dis: 7.62939453125e-05
[rfa agg] iter: 8, weight: tensor([0.0336, 0.0490, 0.2211, 0.0461, 0.0278, 0.0378, 0.0777, 0.2488, 0.2229,
        0.0351])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.6217589378357 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 396/803 (49.3151%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.2145, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0533, Accuracy: 359/712 (50.4213%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.0130, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8005, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 260/1402 (18.5449%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.4801, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0678, Accuracy: 113/631 (17.9081%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0397, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.0923, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0655, Accuracy: 173/818 (21.1491%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 355/818 (43.3985%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3845, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 69/515 (13.3981%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0498, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.0040, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 28/338 (8.2840%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.6011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0324, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.4323, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 378/1956 (19.3252%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 613/1956 (31.3395%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2498, Accuracy: 119/10000 (1.1900%)
time spent on training: 164.59318256378174
[rfa agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 11, 1, 66, 48, 71, 33, 12, 41, 6], weight: tensor([0.0910, 0.0807, 0.1052, 0.1589, 0.0715, 0.0927, 0.0584, 0.0383, 0.0815,
        0.2217])
[rfa agg] iter:  0, prev_obj_val: 60.04352951049805, obj_val: 63.00977325439453, abs dis: 2.9662437438964844
[rfa agg] iter: 0, weight: tensor([0.1321, 0.0801, 0.3775, 0.0689, 0.0434, 0.1329, 0.0295, 0.0130, 0.0804,
        0.0423])
[rfa agg] iter:  1, prev_obj_val: 63.00977325439453, obj_val: 68.00006866455078, abs dis: 4.99029541015625
[rfa agg] iter: 1, weight: tensor([0.1540, 0.2351, 0.0700, 0.0321, 0.0689, 0.1531, 0.0383, 0.0128, 0.2120,
        0.0236])
[rfa agg] iter:  2, prev_obj_val: 68.00006866455078, obj_val: 67.98841857910156, abs dis: 0.01165008544921875
[rfa agg] iter: 2, weight: tensor([0.1165, 0.1914, 0.0689, 0.0385, 0.1629, 0.1174, 0.0740, 0.0203, 0.1806,
        0.0296])
			Update norm = 101.66592330243945 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.9307897090912 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 393/712 (55.1966%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9028, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 579/2227 (25.9991%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3333, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 346/946 (36.5751%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.1338, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0471, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9007, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 366/1372 (26.6764%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 542/1372 (39.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2118, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 231/1049 (22.0210%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 496/1049 (47.2831%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8010, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0784, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0534, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9057, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 633/1030 (61.4563%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8472, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 351/1418 (24.7532%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 674/1418 (47.5317%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9160, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 427/861 (49.5935%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3693, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.19564056396484
[rfa agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 60, 43, 76, 42, 51, 33, 91, 70, 10], weight: tensor([0.0672, 0.2102, 0.0893, 0.0440, 0.1295, 0.0990, 0.0486, 0.0972, 0.1338,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 62.258697509765625, obj_val: 66.4271011352539, abs dis: 4.168403625488281
[rfa agg] iter: 0, weight: tensor([0.0396, 0.0440, 0.1024, 0.0156, 0.1125, 0.2558, 0.0192, 0.2461, 0.0940,
        0.0708])
[rfa agg] iter:  1, prev_obj_val: 66.4271011352539, obj_val: 70.1924819946289, abs dis: 3.765380859375
[rfa agg] iter: 1, weight: tensor([0.0566, 0.0326, 0.2690, 0.0176, 0.0597, 0.1770, 0.0225, 0.1715, 0.0535,
        0.1400])
[rfa agg] iter:  2, prev_obj_val: 70.1924819946289, obj_val: 72.57330322265625, abs dis: 2.3808212280273438
[rfa agg] iter: 2, weight: tensor([0.0739, 0.0293, 0.3030, 0.0192, 0.0490, 0.1069, 0.0251, 0.1043, 0.0448,
        0.2445])
[rfa agg] iter:  3, prev_obj_val: 72.57330322265625, obj_val: 72.5522689819336, abs dis: 0.02103424072265625
[rfa agg] iter: 3, weight: tensor([0.0926, 0.0291, 0.2212, 0.0212, 0.0469, 0.0916, 0.0280, 0.0893, 0.0431,
        0.3370])
[rfa agg] iter:  4, prev_obj_val: 72.5522689819336, obj_val: 81.2723159790039, abs dis: 8.720046997070312
[rfa agg] iter: 4, weight: tensor([0.0887, 0.0279, 0.2047, 0.0203, 0.0449, 0.0876, 0.0268, 0.0853, 0.0413,
        0.3725])
[rfa agg] iter:  5, prev_obj_val: 81.2723159790039, obj_val: 81.2145004272461, abs dis: 0.0578155517578125
[rfa agg] iter: 5, weight: tensor([0.2961, 0.0353, 0.1298, 0.0364, 0.0513, 0.0813, 0.0513, 0.0794, 0.0480,
        0.1912])
[rfa agg] iter:  6, prev_obj_val: 81.2145004272461, obj_val: 81.21322631835938, abs dis: 0.00127410888671875
[rfa agg] iter: 6, weight: tensor([0.3349, 0.0337, 0.1237, 0.0348, 0.0489, 0.0776, 0.0491, 0.0759, 0.0458,
        0.1758])
			Update norm = 114.83567573657152 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.576003074646 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0609, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4379, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2282, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 579/1662 (34.8375%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0082, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 523/1049 (49.8570%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4138, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.5284, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 340/1340 (25.3731%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 599/1340 (44.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6016, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0582, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.8311, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 404/1904 (21.2185%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 657/1904 (34.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2489, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0576, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0116, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 447/1953 (22.8879%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 767/1953 (39.2729%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.4853, Accuracy: 84/10000 (0.8400%)
time spent on training: 189.40787839889526
[rfa agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 58, 94, 51, 24, 77, 25, 46, 0, 83], weight: tensor([0.0607, 0.0663, 0.1373, 0.0867, 0.0258, 0.1107, 0.0570, 0.1573, 0.1369,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 62.386009216308594, obj_val: 67.09901428222656, abs dis: 4.713005065917969
[rfa agg] iter: 0, weight: tensor([0.0278, 0.0342, 0.1115, 0.0870, 0.0067, 0.4597, 0.0235, 0.0718, 0.1115,
        0.0664])
[rfa agg] iter:  1, prev_obj_val: 67.09901428222656, obj_val: 68.874755859375, abs dis: 1.7757415771484375
[rfa agg] iter: 1, weight: tensor([0.0408, 0.0514, 0.1055, 0.1621, 0.0090, 0.3458, 0.0338, 0.0755, 0.1054,
        0.0707])
[rfa agg] iter:  2, prev_obj_val: 68.874755859375, obj_val: 68.86849975585938, abs dis: 0.006256103515625
[rfa agg] iter: 2, weight: tensor([0.0464, 0.0590, 0.1042, 0.2111, 0.0099, 0.2790, 0.0381, 0.0764, 0.1041,
        0.0719])
			Update norm = 172.1032291515037 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.9970498085022 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7604, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8305, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 527/1131 (46.5959%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4343, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0585, Accuracy: 325/719 (45.2017%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8153, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.1676, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 249/1241 (20.0645%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 433/1241 (34.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.2554, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0792, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0496, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.9530, Accuracy: 44/10000 (0.4400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 388/1574 (24.6506%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 688/1574 (43.7103%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2667, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 434/1131 (38.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 364/1372 (26.5306%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 527/1372 (38.4111%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2849, Accuracy: 100/10000 (1.0000%)
time spent on training: 193.8850507736206
[rfa agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.04637267841991138
[rfa agg] init. name: [77, 3, 38, 41, 58, 72, 33, 17, 87, 42], weight: tensor([0.1263, 0.0736, 0.1066, 0.0678, 0.0757, 0.1170, 0.0486, 0.1484, 0.1066,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 46.9669189453125, obj_val: 46.94115447998047, abs dis: 0.02576446533203125
[rfa agg] iter: 0, weight: tensor([0.0848, 0.1399, 0.1393, 0.0883, 0.1468, 0.0937, 0.0327, 0.0602, 0.1399,
        0.0745])
[rfa agg] iter:  1, prev_obj_val: 46.94115447998047, obj_val: 49.04302978515625, abs dis: 2.1018753051757812
[rfa agg] iter: 1, weight: tensor([0.0844, 0.1409, 0.1393, 0.0882, 0.1476, 0.0933, 0.0326, 0.0599, 0.1397,
        0.0741])
[rfa agg] iter:  2, prev_obj_val: 49.04302978515625, obj_val: 51.184165954589844, abs dis: 2.1411361694335938
[rfa agg] iter: 2, weight: tensor([0.0749, 0.1731, 0.1156, 0.1000, 0.1836, 0.0816, 0.0341, 0.0547, 0.1159,
        0.0665])
[rfa agg] iter:  3, prev_obj_val: 51.184165954589844, obj_val: 53.41543197631836, abs dis: 2.2312660217285156
[rfa agg] iter: 3, weight: tensor([0.0623, 0.2130, 0.0909, 0.1089, 0.2310, 0.0670, 0.0335, 0.0467, 0.0910,
        0.0557])
[rfa agg] iter:  4, prev_obj_val: 53.41543197631836, obj_val: 62.53425216674805, abs dis: 9.118820190429688
[rfa agg] iter: 4, weight: tensor([0.0470, 0.2575, 0.0655, 0.1113, 0.2946, 0.0501, 0.0300, 0.0361, 0.0655,
        0.0424])
[rfa agg] iter:  5, prev_obj_val: 62.53425216674805, obj_val: 62.49506759643555, abs dis: 0.0391845703125
[rfa agg] iter: 5, weight: tensor([0.0441, 0.2002, 0.0556, 0.2572, 0.2148, 0.0459, 0.0500, 0.0360, 0.0556,
        0.0406])
[rfa agg] iter:  6, prev_obj_val: 62.49506759643555, obj_val: 70.15105438232422, abs dis: 7.655986785888672
[rfa agg] iter: 6, weight: tensor([0.0423, 0.1882, 0.0533, 0.2985, 0.1989, 0.0440, 0.0480, 0.0345, 0.0533,
        0.0390])
[rfa agg] iter:  7, prev_obj_val: 70.15105438232422, obj_val: 59.04894256591797, abs dis: 11.10211181640625
[rfa agg] iter: 7, weight: tensor([0.0549, 0.1527, 0.0659, 0.2480, 0.1582, 0.0564, 0.1008, 0.0461, 0.0660,
        0.0510])
[rfa agg] iter:  8, prev_obj_val: 59.04894256591797, obj_val: 66.25382232666016, abs dis: 7.2048797607421875
[rfa agg] iter: 8, weight: tensor([0.0397, 0.2362, 0.0514, 0.2149, 0.2599, 0.0416, 0.0367, 0.0318, 0.0515,
        0.0363])
[rfa agg] iter:  9, prev_obj_val: 66.25382232666016, obj_val: 55.997413635253906, abs dis: 10.25640869140625
[rfa agg] iter: 9, weight: tensor([0.0489, 0.1681, 0.0601, 0.2817, 0.1755, 0.0505, 0.0695, 0.0405, 0.0601,
        0.0453])
			Update norm = 119.1973358880663 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.7945580482483 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 365/891 (40.9652%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 473/891 (53.0864%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4615, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0589, Accuracy: 291/708 (41.1017%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9904, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 344/1446 (23.7898%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 486/1446 (33.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3697, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 362/803 (45.0809%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 381/803 (47.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0914, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 297/946 (31.3953%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.1393, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.1315, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0525, Accuracy: 349/1030 (33.8835%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 616/1030 (59.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.6522, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 401/1475 (27.1864%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 619/1475 (41.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0883, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 357/1418 (25.1763%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 641/1418 (45.2045%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8954, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 163/818 (19.9267%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3941, Accuracy: 69/10000 (0.6900%)
time spent on training: 181.11666631698608
[rfa agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 16, 26, 58, 43, 31, 91, 65, 70, 71], weight: tensor([0.0891, 0.0708, 0.1447, 0.0803, 0.0946, 0.0460, 0.1031, 0.1476, 0.1419,
        0.0818])
[rfa agg] iter:  0, prev_obj_val: 43.580162048339844, obj_val: 46.666812896728516, abs dis: 3.086650848388672
[rfa agg] iter: 0, weight: tensor([0.1399, 0.0547, 0.0529, 0.0855, 0.3044, 0.0169, 0.1594, 0.0476, 0.0519,
        0.0868])
[rfa agg] iter:  1, prev_obj_val: 46.666812896728516, obj_val: 60.8087043762207, abs dis: 14.141891479492188
[rfa agg] iter: 1, weight: tensor([0.2356, 0.0761, 0.0365, 0.1488, 0.1889, 0.0174, 0.0750, 0.0335, 0.0358,
        0.1523])
[rfa agg] iter:  2, prev_obj_val: 60.8087043762207, obj_val: 57.03202819824219, abs dis: 3.7766761779785156
[rfa agg] iter: 2, weight: tensor([0.1102, 0.2669, 0.0405, 0.1576, 0.0859, 0.0417, 0.0595, 0.0380, 0.0397,
        0.1602])
[rfa agg] iter:  3, prev_obj_val: 57.03202819824219, obj_val: 60.760921478271484, abs dis: 3.728893280029297
[rfa agg] iter: 3, weight: tensor([0.1013, 0.3169, 0.0324, 0.1652, 0.0760, 0.0281, 0.0499, 0.0303, 0.0317,
        0.1683])
[rfa agg] iter:  4, prev_obj_val: 60.760921478271484, obj_val: 68.65193176269531, abs dis: 7.891010284423828
[rfa agg] iter: 4, weight: tensor([0.1035, 0.3027, 0.0385, 0.1503, 0.0816, 0.0397, 0.0566, 0.0361, 0.0378,
        0.1532])
[rfa agg] iter:  5, prev_obj_val: 68.65193176269531, obj_val: 57.044105529785156, abs dis: 11.607826232910156
[rfa agg] iter: 5, weight: tensor([0.1124, 0.2027, 0.0525, 0.1411, 0.0946, 0.0810, 0.0712, 0.0495, 0.0514,
        0.1437])
[rfa agg] iter:  6, prev_obj_val: 57.044105529785156, obj_val: 60.76082229614258, abs dis: 3.716716766357422
[rfa agg] iter: 6, weight: tensor([0.1038, 0.3004, 0.0331, 0.1694, 0.0779, 0.0287, 0.0511, 0.0310, 0.0325,
        0.1721])
[rfa agg] iter:  7, prev_obj_val: 60.76082229614258, obj_val: 68.65165710449219, abs dis: 7.890834808349609
[rfa agg] iter: 7, weight: tensor([0.1039, 0.3000, 0.0387, 0.1510, 0.0819, 0.0399, 0.0568, 0.0363, 0.0379,
        0.1538])
[rfa agg] iter:  8, prev_obj_val: 68.65165710449219, obj_val: 57.04411697387695, abs dis: 11.607540130615234
[rfa agg] iter: 8, weight: tensor([0.1125, 0.2026, 0.0525, 0.1411, 0.0946, 0.0810, 0.0712, 0.0495, 0.0514,
        0.1437])
[rfa agg] iter:  9, prev_obj_val: 57.04411697387695, obj_val: 60.76081848144531, abs dis: 3.7167015075683594
[rfa agg] iter: 9, weight: tensor([0.1038, 0.3003, 0.0331, 0.1694, 0.0779, 0.0287, 0.0511, 0.0310, 0.0325,
        0.1721])
			Update norm = 106.21621705570671 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.55754232406616 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 613/1030 (59.5146%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.5384, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 668/1275 (52.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.8335, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.7808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0659, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 326/774 (42.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4893, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 448/1130 (39.6460%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8742, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 559/928 (60.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3491, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 268/888 (30.1802%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 457/888 (51.4640%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.7787, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0552, Accuracy: 389/1953 (19.9181%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 760/1953 (38.9145%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8875, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 328/946 (34.6723%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.1175, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 183/953 (19.2025%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 320/953 (33.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5726, Accuracy: 76/10000 (0.7600%)
time spent on training: 178.93601369857788
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 9, 78, 81, 54, 1, 63, 83, 43, 64], weight: tensor([0.1001, 0.1239, 0.0404, 0.0752, 0.1098, 0.0902, 0.0863, 0.1897, 0.0919,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 45.264739990234375, obj_val: 52.605960845947266, abs dis: 7.341220855712891
[rfa agg] iter: 0, weight: tensor([0.0790, 0.0434, 0.0090, 0.0633, 0.0629, 0.2001, 0.1182, 0.0211, 0.2096,
        0.1934])
[rfa agg] iter:  1, prev_obj_val: 52.605960845947266, obj_val: 59.708065032958984, abs dis: 7.102104187011719
[rfa agg] iter: 1, weight: tensor([0.0637, 0.0438, 0.0144, 0.2011, 0.0558, 0.1257, 0.2112, 0.0252, 0.1300,
        0.1292])
[rfa agg] iter:  2, prev_obj_val: 59.708065032958984, obj_val: 52.56278610229492, abs dis: 7.1452789306640625
[rfa agg] iter: 2, weight: tensor([0.0661, 0.0500, 0.0222, 0.2905, 0.0603, 0.1051, 0.1586, 0.0313, 0.1076,
        0.1083])
[rfa agg] iter:  3, prev_obj_val: 52.56278610229492, obj_val: 63.64173889160156, abs dis: 11.07895278930664
[rfa agg] iter: 3, weight: tensor([0.0613, 0.0422, 0.0139, 0.2301, 0.0537, 0.1189, 0.2105, 0.0243, 0.1223,
        0.1227])
[rfa agg] iter:  4, prev_obj_val: 63.64173889160156, obj_val: 52.56034469604492, abs dis: 11.08139419555664
[rfa agg] iter: 4, weight: tensor([0.0738, 0.0580, 0.0302, 0.2442, 0.0684, 0.1097, 0.1532, 0.0376, 0.1121,
        0.1128])
[rfa agg] iter:  5, prev_obj_val: 52.56034469604492, obj_val: 63.64207077026367, abs dis: 11.08172607421875
[rfa agg] iter: 5, weight: tensor([0.0617, 0.0425, 0.0139, 0.2243, 0.0541, 0.1200, 0.2123, 0.0244, 0.1233,
        0.1235])
[rfa agg] iter:  6, prev_obj_val: 63.64207077026367, obj_val: 52.5603141784668, abs dis: 11.081756591796875
[rfa agg] iter: 6, weight: tensor([0.0738, 0.0580, 0.0302, 0.2439, 0.0684, 0.1097, 0.1533, 0.0376, 0.1122,
        0.1129])
[rfa agg] iter:  7, prev_obj_val: 52.5603141784668, obj_val: 63.64207458496094, abs dis: 11.08176040649414
[rfa agg] iter: 7, weight: tensor([0.0617, 0.0425, 0.0139, 0.2243, 0.0541, 0.1200, 0.2124, 0.0244, 0.1233,
        0.1235])
[rfa agg] iter:  8, prev_obj_val: 63.64207458496094, obj_val: 52.56031036376953, abs dis: 11.081764221191406
[rfa agg] iter: 8, weight: tensor([0.0738, 0.0580, 0.0302, 0.2439, 0.0684, 0.1097, 0.1533, 0.0376, 0.1122,
        0.1129])
[rfa agg] iter:  9, prev_obj_val: 52.56031036376953, obj_val: 63.64207458496094, abs dis: 11.081764221191406
[rfa agg] iter: 9, weight: tensor([0.0617, 0.0425, 0.0139, 0.2243, 0.0541, 0.1200, 0.2124, 0.0244, 0.1233,
        0.1235])
			Update norm = 110.58132524159538 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 273.8191673755646 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1626, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.5305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0596, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5595, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 429/1129 (37.9982%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0483, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 465/1552 (29.9613%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 780/1552 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.0553, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 398/1750 (22.7429%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 661/1750 (37.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5808, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 429/807 (53.1599%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.8847, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0611, Accuracy: 178/809 (22.0025%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 327/809 (40.4203%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5106, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 382/1154 (33.1023%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9729, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0213, Accuracy: 74/10000 (0.7400%)
time spent on training: 181.83578205108643
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 24, 89, 37, 74, 44, 20, 50, 15, 3], weight: tensor([0.1146, 0.0301, 0.0863, 0.1088, 0.1495, 0.1686, 0.0777, 0.0779, 0.1112,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 47.35908126831055, obj_val: 51.22378158569336, abs dis: 3.8647003173828125
[rfa agg] iter: 0, weight: tensor([0.1728, 0.0083, 0.0924, 0.2577, 0.0618, 0.0509, 0.0631, 0.0637, 0.1677,
        0.0617])
[rfa agg] iter:  1, prev_obj_val: 51.22378158569336, obj_val: 55.8720817565918, abs dis: 4.6483001708984375
[rfa agg] iter: 1, weight: tensor([0.1162, 0.0104, 0.1829, 0.1510, 0.0573, 0.0493, 0.1066, 0.1083, 0.1126,
        0.1054])
[rfa agg] iter:  2, prev_obj_val: 55.8720817565918, obj_val: 57.95795822143555, abs dis: 2.08587646484375
[rfa agg] iter: 2, weight: tensor([0.0564, 0.0083, 0.2933, 0.0663, 0.0339, 0.0301, 0.1457, 0.1559, 0.0548,
        0.1552])
[rfa agg] iter:  3, prev_obj_val: 57.95795822143555, obj_val: 64.07386016845703, abs dis: 6.115901947021484
[rfa agg] iter: 3, weight: tensor([0.0444, 0.0076, 0.2346, 0.0511, 0.0281, 0.0252, 0.1683, 0.1970, 0.0432,
        0.2004])
[rfa agg] iter:  4, prev_obj_val: 64.07386016845703, obj_val: 64.05645751953125, abs dis: 0.01740264892578125
[rfa agg] iter: 4, weight: tensor([0.0433, 0.0099, 0.1305, 0.0483, 0.0296, 0.0270, 0.1967, 0.2338, 0.0421,
        0.2389])
[rfa agg] iter:  5, prev_obj_val: 64.05645751953125, obj_val: 64.05638885498047, abs dis: 6.866455078125e-05
[rfa agg] iter: 5, weight: tensor([0.0426, 0.0097, 0.1254, 0.0475, 0.0292, 0.0266, 0.1992, 0.2356, 0.0414,
        0.2428])
			Update norm = 114.88586387693657 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 274.98227763175964 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 348/1372 (25.3644%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9256, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 279/1402 (19.9001%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 409/1402 (29.1726%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4854, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0597, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0268, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3257, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.0524, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0602, Accuracy: 396/1750 (22.6286%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 667/1750 (38.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7418, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 420/1742 (24.1102%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 709/1742 (40.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4657, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0202, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0530, Accuracy: 409/1129 (36.2267%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9969, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0805, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0539, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8574, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 420/1440 (29.1667%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8480, Accuracy: 84/10000 (0.8400%)
time spent on training: 205.3969361782074
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 66, 59, 31, 44, 93, 14, 37, 33, 29], weight: tensor([0.1152, 0.1177, 0.0914, 0.0386, 0.1469, 0.1462, 0.0850, 0.0948, 0.0432,
        0.1209])
[rfa agg] iter:  0, prev_obj_val: 45.72837829589844, obj_val: 48.68293380737305, abs dis: 2.9545555114746094
[rfa agg] iter: 0, weight: tensor([0.1505, 0.1511, 0.1747, 0.0116, 0.0593, 0.0592, 0.0820, 0.1818, 0.0142,
        0.1157])
[rfa agg] iter:  1, prev_obj_val: 48.68293380737305, obj_val: 50.53274917602539, abs dis: 1.8498153686523438
[rfa agg] iter: 1, weight: tensor([0.0948, 0.0961, 0.2555, 0.0109, 0.0454, 0.0453, 0.0958, 0.2648, 0.0134,
        0.0779])
[rfa agg] iter:  2, prev_obj_val: 50.53274917602539, obj_val: 52.892032623291016, abs dis: 2.359283447265625
[rfa agg] iter: 2, weight: tensor([0.0749, 0.0761, 0.2819, 0.0103, 0.0389, 0.0389, 0.1053, 0.2976, 0.0128,
        0.0634])
[rfa agg] iter:  3, prev_obj_val: 52.892032623291016, obj_val: 52.88970947265625, abs dis: 0.002323150634765625
[rfa agg] iter: 3, weight: tensor([0.0715, 0.0727, 0.2645, 0.0116, 0.0397, 0.0396, 0.1424, 0.2817, 0.0145,
        0.0618])
			Update norm = 158.87183440001252 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.3701, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 301.2920706272125 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0325, Accuracy: 473/896 (52.7902%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.4111, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 329/1340 (24.5522%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 542/1340 (40.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7815, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.5202, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 398/776 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1792, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 346/1662 (20.8183%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 627/1662 (37.7256%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8430, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0745, Accuracy: 111/781 (14.2125%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8888, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 426/677 (62.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6755, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 322/1013 (31.7868%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1631, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0777, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.0985, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 348/807 (43.1227%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8499, Accuracy: 50/10000 (0.5000%)
time spent on training: 177.70755410194397
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 77, 29, 75, 94, 3, 90, 39, 30, 20], weight: tensor([0.0907, 0.1357, 0.1458, 0.0786, 0.1683, 0.0791, 0.0685, 0.1026, 0.0492,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 46.27986526489258, obj_val: 51.344482421875, abs dis: 5.064617156982422
[rfa agg] iter: 0, weight: tensor([0.1575, 0.0706, 0.0560, 0.0885, 0.0463, 0.0882, 0.0438, 0.3405, 0.0189,
        0.0898])
[rfa agg] iter:  1, prev_obj_val: 51.344482421875, obj_val: 56.98478698730469, abs dis: 5.6403045654296875
[rfa agg] iter: 1, weight: tensor([0.1402, 0.0319, 0.0275, 0.2388, 0.0245, 0.2103, 0.0621, 0.0638, 0.0185,
        0.1824])
[rfa agg] iter:  2, prev_obj_val: 56.98478698730469, obj_val: 60.300376892089844, abs dis: 3.3155899047851562
[rfa agg] iter: 2, weight: tensor([0.1118, 0.0392, 0.0346, 0.1812, 0.0314, 0.1785, 0.1548, 0.0660, 0.0319,
        0.1707])
[rfa agg] iter:  3, prev_obj_val: 60.300376892089844, obj_val: 67.58601379394531, abs dis: 7.285636901855469
[rfa agg] iter: 3, weight: tensor([0.0992, 0.0405, 0.0360, 0.1396, 0.0330, 0.1396, 0.2697, 0.0641, 0.0395,
        0.1388])
[rfa agg] iter:  4, prev_obj_val: 67.58601379394531, obj_val: 67.58077239990234, abs dis: 0.00524139404296875
[rfa agg] iter: 4, weight: tensor([0.0866, 0.0440, 0.0397, 0.1045, 0.0370, 0.1049, 0.3480, 0.0631, 0.0655,
        0.1067])
[rfa agg] iter:  5, prev_obj_val: 67.58077239990234, obj_val: 71.53173828125, abs dis: 3.9509658813476562
[rfa agg] iter: 5, weight: tensor([0.0851, 0.0432, 0.0390, 0.1025, 0.0364, 0.1028, 0.3600, 0.0621, 0.0645,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 71.53173828125, obj_val: 63.784610748291016, abs dis: 7.747127532958984
[rfa agg] iter: 6, weight: tensor([0.0934, 0.0515, 0.0469, 0.1076, 0.0440, 0.1080, 0.2677, 0.0711, 0.0993,
        0.1103])
[rfa agg] iter:  7, prev_obj_val: 63.784610748291016, obj_val: 67.58206176757812, abs dis: 3.7974510192871094
[rfa agg] iter: 7, weight: tensor([0.0794, 0.0365, 0.0328, 0.1018, 0.0303, 0.1019, 0.4159, 0.0549, 0.0437,
        0.1028])
[rfa agg] iter:  8, prev_obj_val: 67.58206176757812, obj_val: 67.58071899414062, abs dis: 0.0013427734375
[rfa agg] iter: 8, weight: tensor([0.0838, 0.0426, 0.0385, 0.1010, 0.0359, 0.1014, 0.3691, 0.0612, 0.0635,
        0.1030])
[rfa agg] iter:  9, prev_obj_val: 67.58071899414062, obj_val: 71.5319595336914, abs dis: 3.9512405395507812
[rfa agg] iter: 9, weight: tensor([0.0847, 0.0430, 0.0389, 0.1020, 0.0362, 0.1023, 0.3629, 0.0618, 0.0642,
        0.1040])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3109, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.13581442832947 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 30/373 (8.0429%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.6323, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 536/1049 (51.0963%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6390, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 445/1742 (25.5454%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 727/1742 (41.7336%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.6223, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0728, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 241/781 (30.8579%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.1438, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 302/1013 (29.8124%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8734, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.1340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7396, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0552, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.7976, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4854, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0815, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0659, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3439, Accuracy: 50/10000 (0.5000%)
time spent on training: 162.51030659675598
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 51, 93, 3, 14, 31, 63, 57, 35, 56], weight: tensor([0.0471, 0.1325, 0.2200, 0.0986, 0.1280, 0.0581, 0.1122, 0.1458, 0.0342,
        0.0235])
[rfa agg] iter:  0, prev_obj_val: 51.44524002075195, obj_val: 55.81639862060547, abs dis: 4.371158599853516
[rfa agg] iter: 0, weight: tensor([0.0144, 0.1646, 0.0466, 0.1259, 0.2690, 0.0228, 0.2449, 0.0971, 0.0094,
        0.0054])
[rfa agg] iter:  1, prev_obj_val: 55.81639862060547, obj_val: 57.984580993652344, abs dis: 2.168182373046875
[rfa agg] iter: 1, weight: tensor([0.0162, 0.0948, 0.0392, 0.2665, 0.1275, 0.0271, 0.3454, 0.0672, 0.0104,
        0.0057])
[rfa agg] iter:  2, prev_obj_val: 57.984580993652344, obj_val: 60.586402893066406, abs dis: 2.6018218994140625
[rfa agg] iter: 2, weight: tensor([0.0176, 0.0846, 0.0385, 0.3844, 0.1078, 0.0303, 0.2566, 0.0628, 0.0112,
        0.0061])
[rfa agg] iter:  3, prev_obj_val: 60.586402893066406, obj_val: 63.439552307128906, abs dis: 2.8531494140625
[rfa agg] iter: 3, weight: tensor([0.0220, 0.0878, 0.0433, 0.4016, 0.1082, 0.0390, 0.2093, 0.0675, 0.0139,
        0.0075])
[rfa agg] iter:  4, prev_obj_val: 63.439552307128906, obj_val: 66.35800170898438, abs dis: 2.9184494018554688
[rfa agg] iter: 4, weight: tensor([0.0299, 0.0996, 0.0526, 0.3330, 0.1196, 0.0549, 0.2030, 0.0788, 0.0186,
        0.0099])
[rfa agg] iter:  5, prev_obj_val: 66.35800170898438, obj_val: 57.98173141479492, abs dis: 8.376270294189453
[rfa agg] iter: 5, weight: tensor([0.0383, 0.1071, 0.0601, 0.2762, 0.1261, 0.0738, 0.1955, 0.0868, 0.0236,
        0.0123])
[rfa agg] iter:  6, prev_obj_val: 57.98173141479492, obj_val: 60.5850830078125, abs dis: 2.603351593017578
[rfa agg] iter: 6, weight: tensor([0.0175, 0.0842, 0.0383, 0.4008, 0.1072, 0.0302, 0.2422, 0.0625, 0.0111,
        0.0061])
[rfa agg] iter:  7, prev_obj_val: 60.5850830078125, obj_val: 63.44004821777344, abs dis: 2.8549652099609375
[rfa agg] iter: 7, weight: tensor([0.0219, 0.0873, 0.0430, 0.4057, 0.1076, 0.0388, 0.2074, 0.0671, 0.0138,
        0.0074])
[rfa agg] iter:  8, prev_obj_val: 63.44004821777344, obj_val: 66.3580322265625, abs dis: 2.9179840087890625
[rfa agg] iter: 8, weight: tensor([0.0298, 0.0996, 0.0526, 0.3334, 0.1196, 0.0549, 0.2029, 0.0788, 0.0186,
        0.0099])
[rfa agg] iter:  9, prev_obj_val: 66.3580322265625, obj_val: 57.98172378540039, abs dis: 8.37630844116211
[rfa agg] iter: 9, weight: tensor([0.0383, 0.1071, 0.0601, 0.2762, 0.1261, 0.0738, 0.1955, 0.0868, 0.0236,
        0.0123])
			Update norm = 118.65209780067102 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3109, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.55696034431458 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0555, Accuracy: 414/1581 (26.1860%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8481, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0672, Accuracy: 155/682 (22.7273%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 239/682 (35.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6829, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 336/1446 (23.2365%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 488/1446 (33.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4322, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 525/928 (56.5733%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9998, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 420/1742 (24.1102%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 712/1742 (40.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.0539, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 273/1071 (25.4902%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 513/1071 (47.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1236, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 620/1645 (37.6900%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2733, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 31/373 (8.3110%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.6145, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3236, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 259/776 (33.3763%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0313, Accuracy: 384/776 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4927, Accuracy: 51/10000 (0.5100%)
time spent on training: 194.17230129241943
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 80, 26, 1, 93, 55, 13, 98, 61, 75], weight: tensor([0.1531, 0.0660, 0.1400, 0.0898, 0.1687, 0.1037, 0.1593, 0.0361, 0.0082,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 57.82624816894531, obj_val: 61.50263977050781, abs dis: 3.6763916015625
[rfa agg] iter: 0, weight: tensor([0.1142, 0.0429, 0.1500, 0.1222, 0.0865, 0.2982, 0.1031, 0.0141, 0.0024,
        0.0663])
[rfa agg] iter:  1, prev_obj_val: 61.50263977050781, obj_val: 67.33345794677734, abs dis: 5.830818176269531
[rfa agg] iter: 1, weight: tensor([0.0604, 0.0347, 0.0736, 0.1324, 0.0486, 0.5234, 0.0559, 0.0104, 0.0017,
        0.0588])
[rfa agg] iter:  2, prev_obj_val: 67.33345794677734, obj_val: 69.45489501953125, abs dis: 2.1214370727539062
[rfa agg] iter: 2, weight: tensor([0.0598, 0.0539, 0.0692, 0.3390, 0.0502, 0.2484, 0.0563, 0.0141, 0.0023,
        0.1069])
[rfa agg] iter:  3, prev_obj_val: 69.45489501953125, obj_val: 69.41741180419922, abs dis: 0.03748321533203125
[rfa agg] iter: 3, weight: tensor([0.0487, 0.0519, 0.0556, 0.4719, 0.0413, 0.1566, 0.0461, 0.0128, 0.0020,
        0.1131])
[rfa agg] iter:  4, prev_obj_val: 69.41741180419922, obj_val: 69.4098892211914, abs dis: 0.0075225830078125
[rfa agg] iter: 4, weight: tensor([0.0433, 0.0462, 0.0495, 0.5329, 0.0368, 0.1369, 0.0410, 0.0114, 0.0018,
        0.1002])
[rfa agg] iter:  5, prev_obj_val: 69.4098892211914, obj_val: 74.79593658447266, abs dis: 5.38604736328125
[rfa agg] iter: 5, weight: tensor([0.0406, 0.0432, 0.0463, 0.5642, 0.0344, 0.1273, 0.0384, 0.0106, 0.0017,
        0.0933])
[rfa agg] iter:  6, prev_obj_val: 74.79593658447266, obj_val: 77.56578826904297, abs dis: 2.7698516845703125
[rfa agg] iter: 6, weight: tensor([0.0540, 0.0829, 0.0603, 0.3257, 0.0468, 0.1295, 0.0515, 0.0175, 0.0026,
        0.2291])
[rfa agg] iter:  7, prev_obj_val: 77.56578826904297, obj_val: 74.74104309082031, abs dis: 2.8247451782226562
[rfa agg] iter: 7, weight: tensor([0.0505, 0.0971, 0.0559, 0.2113, 0.0442, 0.1101, 0.0484, 0.0182, 0.0027,
        0.3617])
[rfa agg] iter:  8, prev_obj_val: 74.74104309082031, obj_val: 77.55431365966797, abs dis: 2.8132705688476562
[rfa agg] iter: 8, weight: tensor([0.0544, 0.0845, 0.0608, 0.2852, 0.0471, 0.1309, 0.0519, 0.0176, 0.0027,
        0.2650])
[rfa agg] iter:  9, prev_obj_val: 77.55431365966797, obj_val: 74.74260711669922, abs dis: 2.81170654296875
[rfa agg] iter: 9, weight: tensor([0.0499, 0.0961, 0.0553, 0.2070, 0.0437, 0.1089, 0.0478, 0.0180, 0.0027,
        0.3705])
			Update norm = 127.5213523787291 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3109, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.34207344055176 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.4378, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 277/813 (34.0713%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 451/813 (55.4736%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.0025, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0581, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0289, Accuracy: 449/1154 (38.9081%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0009, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 500/1552 (32.2165%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 782/1552 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.3310, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0547, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4486, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 439/896 (48.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.4750, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 472/1131 (41.7330%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5583, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0783, Accuracy: 41/440 (9.3182%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0465, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 354/712 (49.7191%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 409/712 (57.4438%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.8991, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0599, Accuracy: 278/708 (39.2655%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.9475, Accuracy: 58/10000 (0.5800%)
time spent on training: 173.04327034950256
[rfa agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 53, 15, 74, 95, 89, 38, 49, 11, 16], weight: tensor([0.0374, 0.0978, 0.1388, 0.1866, 0.0720, 0.1077, 0.1360, 0.0529, 0.0856,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 43.87720489501953, obj_val: 48.28009796142578, abs dis: 4.40289306640625
[rfa agg] iter: 0, weight: tensor([0.0106, 0.1984, 0.0700, 0.0435, 0.0455, 0.3197, 0.0854, 0.0193, 0.1043,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 48.28009796142578, obj_val: 56.41743469238281, abs dis: 8.137336730957031
[rfa agg] iter: 1, weight: tensor([0.0112, 0.1701, 0.0414, 0.0302, 0.0709, 0.1084, 0.0472, 0.0221, 0.2496,
        0.2488])
[rfa agg] iter:  2, prev_obj_val: 56.41743469238281, obj_val: 62.93357467651367, abs dis: 6.516139984130859
[rfa agg] iter: 2, weight: tensor([0.0207, 0.1160, 0.0500, 0.0396, 0.2504, 0.0922, 0.0555, 0.0459, 0.1654,
        0.1644])
[rfa agg] iter:  3, prev_obj_val: 62.93357467651367, obj_val: 59.50621795654297, abs dis: 3.427356719970703
[rfa agg] iter: 3, weight: tensor([0.0289, 0.0967, 0.0514, 0.0426, 0.3325, 0.0834, 0.0564, 0.0729, 0.1179,
        0.1175])
[rfa agg] iter:  4, prev_obj_val: 59.50621795654297, obj_val: 62.92613983154297, abs dis: 3.419921875
[rfa agg] iter: 4, weight: tensor([0.0211, 0.0905, 0.0440, 0.0357, 0.4016, 0.0756, 0.0485, 0.0497, 0.1167,
        0.1166])
[rfa agg] iter:  5, prev_obj_val: 62.92613983154297, obj_val: 62.9243278503418, abs dis: 0.001811981201171875
[rfa agg] iter: 5, weight: tensor([0.0277, 0.0927, 0.0494, 0.0409, 0.3600, 0.0801, 0.0542, 0.0700, 0.1125,
        0.1124])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.30850863456726 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 410/1475 (27.7966%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 692/1475 (46.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.9683, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0839, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.1147, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 388/1574 (24.6506%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2490, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 145/818 (17.7262%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 304/818 (37.1638%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.6495, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 75/460 (16.3043%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.1430, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 515/1552 (33.1830%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 794/1552 (51.1598%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.6663, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 311/690 (45.0725%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.7781, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.9168, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 450/1130 (39.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0465, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 31/338 (9.1716%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6995, Accuracy: 50/10000 (0.5000%)
time spent on training: 198.00169014930725
[rfa agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[rfa agg] considering poison per batch poison_fraction: 0.054634566255692546
[rfa agg] init. name: [65, 76, 17, 71, 31, 74, 25, 82, 54, 12], weight: tensor([0.1638, 0.0518, 0.1748, 0.0909, 0.0511, 0.1724, 0.0766, 0.0555, 0.1255,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 65.45941925048828, obj_val: 69.21588134765625, abs dis: 3.7564620971679688
[rfa agg] iter: 0, weight: tensor([0.0999, 0.0406, 0.0962, 0.2355, 0.0402, 0.0948, 0.1045, 0.0436, 0.2216,
        0.0230])
[rfa agg] iter:  1, prev_obj_val: 69.21588134765625, obj_val: 76.50105285644531, abs dis: 7.2851715087890625
[rfa agg] iter: 1, weight: tensor([0.0618, 0.0372, 0.0604, 0.4561, 0.0368, 0.0595, 0.1189, 0.0400, 0.1095,
        0.0199])
[rfa agg] iter:  2, prev_obj_val: 76.50105285644531, obj_val: 81.16715240478516, abs dis: 4.666099548339844
[rfa agg] iter: 2, weight: tensor([0.0486, 0.0541, 0.0481, 0.2173, 0.0535, 0.0474, 0.3765, 0.0582, 0.0712,
        0.0252])
[rfa agg] iter:  3, prev_obj_val: 81.16715240478516, obj_val: 76.44361114501953, abs dis: 4.723541259765625
[rfa agg] iter: 3, weight: tensor([0.0432, 0.0719, 0.0430, 0.1268, 0.0712, 0.0424, 0.4348, 0.0776, 0.0594,
        0.0295])
[rfa agg] iter:  4, prev_obj_val: 76.44361114501953, obj_val: 81.16399383544922, abs dis: 4.7203826904296875
[rfa agg] iter: 4, weight: tensor([0.0448, 0.0500, 0.0443, 0.1915, 0.0495, 0.0437, 0.4334, 0.0539, 0.0656,
        0.0233])
[rfa agg] iter:  5, prev_obj_val: 81.16399383544922, obj_val: 76.44366455078125, abs dis: 4.720329284667969
[rfa agg] iter: 5, weight: tensor([0.0426, 0.0708, 0.0424, 0.1247, 0.0701, 0.0418, 0.4433, 0.0764, 0.0586,
        0.0291])
[rfa agg] iter:  6, prev_obj_val: 76.44366455078125, obj_val: 81.16395568847656, abs dis: 4.7202911376953125
[rfa agg] iter: 6, weight: tensor([0.0447, 0.0499, 0.0443, 0.1911, 0.0494, 0.0436, 0.4346, 0.0537, 0.0655,
        0.0232])
[rfa agg] iter:  7, prev_obj_val: 81.16395568847656, obj_val: 76.44365692138672, abs dis: 4.720298767089844
[rfa agg] iter: 7, weight: tensor([0.0426, 0.0708, 0.0424, 0.1247, 0.0701, 0.0418, 0.4435, 0.0764, 0.0585,
        0.0291])
[rfa agg] iter:  8, prev_obj_val: 76.44365692138672, obj_val: 81.16397094726562, abs dis: 4.720314025878906
[rfa agg] iter: 8, weight: tensor([0.0447, 0.0499, 0.0443, 0.1910, 0.0494, 0.0436, 0.4346, 0.0537, 0.0655,
        0.0232])
[rfa agg] iter:  9, prev_obj_val: 81.16397094726562, obj_val: 76.44365692138672, abs dis: 4.720314025878906
[rfa agg] iter: 9, weight: tensor([0.0426, 0.0708, 0.0424, 0.1247, 0.0701, 0.0418, 0.4435, 0.0764, 0.0585,
        0.0291])
			Update norm = 104.9877085439648 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.3570747375488 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0587, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0324, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.6894, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 347/896 (38.7277%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 457/896 (51.0045%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.4576, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9574, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0733, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0479, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 222/861 (25.7840%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 451/861 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2395, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0481, Accuracy: 392/1036 (37.8378%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 636/1036 (61.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.9960, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0607, Accuracy: 257/1241 (20.7091%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 403/1241 (32.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4155, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 594/2227 (26.6727%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.4095, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0512, Accuracy: 359/599 (59.9332%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3945, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 489/1131 (43.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4718, Accuracy: 77/10000 (0.7700%)
time spent on training: 196.2935254573822
[rfa agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 89, 82, 3, 10, 19, 72, 60, 95, 38], weight: tensor([0.0720, 0.0897, 0.0500, 0.0782, 0.0862, 0.1037, 0.1242, 0.2229, 0.0600,
        0.1132])
[rfa agg] iter:  0, prev_obj_val: 60.2879753112793, obj_val: 62.05408477783203, abs dis: 1.7661094665527344
[rfa agg] iter: 0, weight: tensor([0.0381, 0.0781, 0.0149, 0.0519, 0.0743, 0.3465, 0.1068, 0.0333, 0.0229,
        0.2331])
[rfa agg] iter:  1, prev_obj_val: 62.05408477783203, obj_val: 70.37914276123047, abs dis: 8.325057983398438
[rfa agg] iter: 1, weight: tensor([0.0681, 0.2139, 0.0211, 0.1093, 0.1914, 0.1471, 0.0725, 0.0330, 0.0352,
        0.1083])
[rfa agg] iter:  2, prev_obj_val: 70.37914276123047, obj_val: 76.451416015625, abs dis: 6.072273254394531
[rfa agg] iter: 2, weight: tensor([0.1945, 0.1452, 0.0288, 0.2533, 0.1352, 0.0596, 0.0431, 0.0259, 0.0611,
        0.0532])
[rfa agg] iter:  3, prev_obj_val: 76.451416015625, obj_val: 73.23738861083984, abs dis: 3.2140274047851562
[rfa agg] iter: 3, weight: tensor([0.2649, 0.1120, 0.0454, 0.1580, 0.1064, 0.0602, 0.0469, 0.0306, 0.1201,
        0.0556])
[rfa agg] iter:  4, prev_obj_val: 73.23738861083984, obj_val: 79.81818389892578, abs dis: 6.5807952880859375
[rfa agg] iter: 4, weight: tensor([0.3038, 0.1164, 0.0338, 0.1817, 0.1096, 0.0560, 0.0422, 0.0265, 0.0790,
        0.0510])
[rfa agg] iter:  5, prev_obj_val: 79.81818389892578, obj_val: 79.80536651611328, abs dis: 0.0128173828125
[rfa agg] iter: 5, weight: tensor([0.2189, 0.1043, 0.0584, 0.1335, 0.0993, 0.0612, 0.0491, 0.0332, 0.1848,
        0.0573])
			Update norm = 100.70588267170642 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.46881222724915 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 416/1574 (26.4295%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 696/1574 (44.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.1408, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9629, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0771, Accuracy: 87/486 (17.9012%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0394, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.3248, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 359/1573 (22.8226%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 554/1573 (35.2193%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6280, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 725/1953 (37.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1994, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 496/1213 (40.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2962, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0783, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.7517, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 366/1163 (31.4703%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 443/1163 (38.0911%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8932, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0582, Accuracy: 214/861 (24.8548%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 452/861 (52.4971%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1962, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0530, Accuracy: 409/1949 (20.9851%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 607/1949 (31.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4663, Accuracy: 88/10000 (0.8800%)
time spent on training: 224.92131996154785
[rfa agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.040218724448078495
[rfa agg] init. name: [17, 1, 30, 40, 83, 97, 18, 68, 10, 21], weight: tensor([0.1287, 0.0759, 0.0397, 0.1286, 0.1597, 0.0992, 0.0433, 0.0951, 0.0704,
        0.1594])
[rfa agg] iter:  0, prev_obj_val: 62.25653076171875, obj_val: 69.68785095214844, abs dis: 7.4313201904296875
[rfa agg] iter: 0, weight: tensor([0.0749, 0.0538, 0.0112, 0.0749, 0.0448, 0.3294, 0.0133, 0.3119, 0.0411,
        0.0447])
[rfa agg] iter:  1, prev_obj_val: 69.68785095214844, obj_val: 69.67721557617188, abs dis: 0.0106353759765625
[rfa agg] iter: 1, weight: tensor([0.0730, 0.1226, 0.0179, 0.0730, 0.0505, 0.2594, 0.0218, 0.2472, 0.0843,
        0.0504])
			Update norm = 158.11240068381733 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.67938208580017 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 312/1013 (30.7996%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 486/1013 (47.9763%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7584, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0676, Accuracy: 120/631 (19.0174%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0402, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.1977, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0696, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0343, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.5910, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 238/1049 (22.6883%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 523/1049 (49.8570%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8492, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 420/888 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.7900, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 405/1628 (24.8771%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 782/1628 (48.0344%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.2597, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 557/2227 (25.0112%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1278, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 361/891 (40.5163%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 428/891 (48.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4638, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 350/1418 (24.6827%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 667/1418 (47.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7240, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0609, Accuracy: 332/719 (46.1752%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0305, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.7782, Accuracy: 55/10000 (0.5500%)
time spent on training: 205.92737936973572
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 48, 81, 51, 63, 5, 60, 7, 70, 41], weight: tensor([0.0901, 0.0561, 0.0689, 0.0933, 0.0790, 0.1449, 0.1982, 0.0793, 0.1262,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 65.83128356933594, obj_val: 65.98368835449219, abs dis: 0.15240478515625
[rfa agg] iter: 0, weight: tensor([0.1640, 0.0315, 0.0594, 0.2522, 0.0830, 0.0917, 0.0574, 0.0826, 0.1315,
        0.0468])
[rfa agg] iter:  1, prev_obj_val: 65.98368835449219, obj_val: 70.75166320800781, abs dis: 4.767974853515625
[rfa agg] iter: 1, weight: tensor([0.2886, 0.0246, 0.0550, 0.2904, 0.0871, 0.0434, 0.0306, 0.0851, 0.0550,
        0.0401])
[rfa agg] iter:  2, prev_obj_val: 70.75166320800781, obj_val: 84.27904510498047, abs dis: 13.527381896972656
[rfa agg] iter: 2, weight: tensor([0.1491, 0.0331, 0.1092, 0.0965, 0.2500, 0.0338, 0.0260, 0.1970, 0.0397,
        0.0657])
[rfa agg] iter:  3, prev_obj_val: 84.27904510498047, obj_val: 84.20252990722656, abs dis: 0.07651519775390625
[rfa agg] iter: 3, weight: tensor([0.0711, 0.0846, 0.1807, 0.0588, 0.1218, 0.0331, 0.0276, 0.1177, 0.0366,
        0.2681])
[rfa agg] iter:  4, prev_obj_val: 84.20252990722656, obj_val: 84.19900512695312, abs dis: 0.0035247802734375
[rfa agg] iter: 4, weight: tensor([0.0656, 0.0787, 0.1731, 0.0544, 0.1111, 0.0306, 0.0255, 0.1076, 0.0339,
        0.3197])
[rfa agg] iter:  5, prev_obj_val: 84.19900512695312, obj_val: 84.19861602783203, abs dis: 0.00038909912109375
[rfa agg] iter: 5, weight: tensor([0.0641, 0.0768, 0.1683, 0.0532, 0.1085, 0.0299, 0.0250, 0.1049, 0.0331,
        0.3363])
			Update norm = 109.43345759238808 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 303.19331884384155 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0598, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0355, Accuracy: 372/901 (41.2875%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0815, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0658, Accuracy: 76/186 (40.8602%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3470, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 434/1949 (22.2678%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 647/1949 (33.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2404, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0819, Accuracy: 69/515 (13.3981%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0505, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.0037, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0579, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 383/1089 (35.1699%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.0087, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.7753, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 360/712 (50.5618%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0249, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9698, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 175/818 (21.3936%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 369/818 (45.1100%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.6652, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 407/1956 (20.8078%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8252, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 452/1715 (26.3557%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9059, Accuracy: 84/10000 (0.8400%)
time spent on training: 195.96614909172058
[rfa agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 56, 21, 33, 59, 41, 11, 71, 6, 92], weight: tensor([0.0853, 0.0176, 0.1846, 0.0488, 0.1031, 0.0681, 0.0674, 0.0775, 0.1852,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 75.28309631347656, obj_val: 76.69415283203125, abs dis: 1.4110565185546875
[rfa agg] iter: 0, weight: tensor([0.1157, 0.0066, 0.0993, 0.0288, 0.3316, 0.0560, 0.0555, 0.0734, 0.0996,
        0.1334])
[rfa agg] iter:  1, prev_obj_val: 76.69415283203125, obj_val: 79.88799285888672, abs dis: 3.1938400268554688
[rfa agg] iter: 1, weight: tensor([0.1178, 0.0050, 0.0611, 0.0233, 0.4917, 0.0485, 0.0481, 0.0659, 0.0613,
        0.0774])
[rfa agg] iter:  2, prev_obj_val: 79.88799285888672, obj_val: 85.57561492919922, abs dis: 5.6876220703125
[rfa agg] iter: 2, weight: tensor([0.2265, 0.0062, 0.0607, 0.0309, 0.2987, 0.0706, 0.0701, 0.1020, 0.0609,
        0.0735])
[rfa agg] iter:  3, prev_obj_val: 85.57561492919922, obj_val: 89.46527862548828, abs dis: 3.8896636962890625
[rfa agg] iter: 3, weight: tensor([0.3516, 0.0058, 0.0423, 0.0333, 0.1077, 0.0980, 0.0976, 0.1721, 0.0425,
        0.0491])
[rfa agg] iter:  4, prev_obj_val: 89.46527862548828, obj_val: 91.62358093261719, abs dis: 2.1583023071289062
[rfa agg] iter: 4, weight: tensor([0.1822, 0.0057, 0.0362, 0.0369, 0.0760, 0.1403, 0.1398, 0.3053, 0.0363,
        0.0412])
[rfa agg] iter:  5, prev_obj_val: 91.62358093261719, obj_val: 97.16961669921875, abs dis: 5.5460357666015625
[rfa agg] iter: 5, weight: tensor([0.1122, 0.0049, 0.0287, 0.0339, 0.0561, 0.1583, 0.1587, 0.3859, 0.0288,
        0.0325])
[rfa agg] iter:  6, prev_obj_val: 97.16961669921875, obj_val: 104.26614379882812, abs dis: 7.096527099609375
[rfa agg] iter: 6, weight: tensor([0.0745, 0.0053, 0.0264, 0.0433, 0.0457, 0.2755, 0.2844, 0.1891, 0.0264,
        0.0293])
[rfa agg] iter:  7, prev_obj_val: 104.26614379882812, obj_val: 97.11321258544922, abs dis: 7.152931213378906
[rfa agg] iter: 7, weight: tensor([0.0853, 0.0089, 0.0376, 0.0954, 0.0591, 0.2416, 0.2424, 0.1506, 0.0378,
        0.0414])
[rfa agg] iter:  8, prev_obj_val: 97.11321258544922, obj_val: 97.1018295288086, abs dis: 0.011383056640625
[rfa agg] iter: 8, weight: tensor([0.0699, 0.0049, 0.0247, 0.0407, 0.0428, 0.2939, 0.3064, 0.1645, 0.0248,
        0.0275])
[rfa agg] iter:  9, prev_obj_val: 97.1018295288086, obj_val: 97.10166931152344, abs dis: 0.00016021728515625
[rfa agg] iter: 9, weight: tensor([0.0674, 0.0048, 0.0239, 0.0392, 0.0413, 0.2995, 0.3150, 0.1585, 0.0239,
        0.0266])
			Update norm = 109.4244129453638 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.69434094429016 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0596, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0326, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.5507, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0524, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0590, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 408/1953 (20.8909%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 755/1953 (38.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4973, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 568/2227 (25.5052%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1007/2227 (45.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3125, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0552, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0245, Accuracy: 558/1154 (48.3536%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4932, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0775, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0371, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6087, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0612, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.7355, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 338/1657 (20.3983%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9801, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 75/460 (16.3043%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.1729, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0766, Accuracy: 84/486 (17.2840%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0390, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.1438, Accuracy: 43/10000 (0.4300%)
time spent on training: 198.40871930122375
[rfa agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 33, 83, 60, 57, 18, 41, 0, 31, 30], weight: tensor([0.0846, 0.0486, 0.1843, 0.2102, 0.1089, 0.0500, 0.0678, 0.1564, 0.0434,
        0.0459])
[rfa agg] iter:  0, prev_obj_val: 85.17594909667969, obj_val: 87.46554565429688, abs dis: 2.2895965576171875
[rfa agg] iter: 0, weight: tensor([0.0808, 0.0255, 0.0967, 0.0810, 0.4499, 0.0263, 0.0489, 0.1479, 0.0209,
        0.0221])
[rfa agg] iter:  1, prev_obj_val: 87.46554565429688, obj_val: 90.1877212524414, abs dis: 2.7221755981445312
[rfa agg] iter: 1, weight: tensor([0.0787, 0.0218, 0.0629, 0.0544, 0.5912, 0.0224, 0.0443, 0.0880, 0.0176,
        0.0186])
[rfa agg] iter:  2, prev_obj_val: 90.1877212524414, obj_val: 94.42578887939453, abs dis: 4.238067626953125
[rfa agg] iter: 2, weight: tensor([0.1369, 0.0336, 0.0802, 0.0706, 0.4102, 0.0345, 0.0716, 0.1071, 0.0268,
        0.0284])
[rfa agg] iter:  3, prev_obj_val: 94.42578887939453, obj_val: 97.3012924194336, abs dis: 2.8755035400390625
[rfa agg] iter: 3, weight: tensor([0.2508, 0.0446, 0.0791, 0.0713, 0.2292, 0.0459, 0.1071, 0.1002, 0.0349,
        0.0369])
[rfa agg] iter:  4, prev_obj_val: 97.3012924194336, obj_val: 100.45320129394531, abs dis: 3.1519088745117188
[rfa agg] iter: 4, weight: tensor([0.3794, 0.0440, 0.0627, 0.0573, 0.1454, 0.0452, 0.1196, 0.0771, 0.0337,
        0.0356])
[rfa agg] iter:  5, prev_obj_val: 100.45320129394531, obj_val: 106.8621826171875, abs dis: 6.4089813232421875
[rfa agg] iter: 5, weight: tensor([0.5549, 0.0354, 0.0398, 0.0367, 0.0786, 0.0364, 0.1162, 0.0476, 0.0264,
        0.0279])
[rfa agg] iter:  6, prev_obj_val: 106.8621826171875, obj_val: 111.69695281982422, abs dis: 4.834770202636719
[rfa agg] iter: 6, weight: tensor([0.2496, 0.0623, 0.0455, 0.0427, 0.0757, 0.0641, 0.3173, 0.0528, 0.0437,
        0.0462])
[rfa agg] iter:  7, prev_obj_val: 111.69695281982422, obj_val: 111.6836166381836, abs dis: 0.013336181640625
[rfa agg] iter: 7, weight: tensor([0.1430, 0.0827, 0.0414, 0.0392, 0.0631, 0.0850, 0.3882, 0.0471, 0.0536,
        0.0567])
[rfa agg] iter:  8, prev_obj_val: 111.6836166381836, obj_val: 114.42166900634766, abs dis: 2.7380523681640625
[rfa agg] iter: 8, weight: tensor([0.1372, 0.0803, 0.0401, 0.0380, 0.0611, 0.0825, 0.4082, 0.0457, 0.0519,
        0.0550])
[rfa agg] iter:  9, prev_obj_val: 114.42166900634766, obj_val: 109.1056137084961, abs dis: 5.3160552978515625
[rfa agg] iter: 9, weight: tensor([0.1320, 0.1125, 0.0446, 0.0424, 0.0654, 0.1155, 0.2960, 0.0503, 0.0686,
        0.0727])
			Update norm = 109.35692261323697 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.5025715827942 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 311/946 (32.8753%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 363/946 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.2927, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 352/1446 (24.3430%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 527/1446 (36.4454%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3468, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1241, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3271, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 681/1574 (43.2656%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0946, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0545, Accuracy: 437/1587 (27.5362%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0344, Accuracy: 584/1587 (36.7990%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4799, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0679, Accuracy: 113/631 (17.9081%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0393, Accuracy: 236/631 (37.4010%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.0836, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9967, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0250, Accuracy: 468/891 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4213, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6479, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 423/1949 (21.7034%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 632/1949 (32.4269%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3039, Accuracy: 88/10000 (0.8800%)
time spent on training: 216.3633167743683
[rfa agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.043621408300815886
[rfa agg] init. name: [43, 26, 61, 17, 27, 48, 39, 7, 15, 21], weight: tensor([0.0839, 0.1282, 0.0075, 0.1396, 0.1407, 0.0560, 0.0898, 0.0790, 0.1023,
        0.1728])
[rfa agg] iter:  0, prev_obj_val: 54.24387741088867, obj_val: 56.944862365722656, abs dis: 2.7009849548339844
[rfa agg] iter: 0, weight: tensor([0.0764, 0.1166, 0.0016, 0.0856, 0.0863, 0.0230, 0.1078, 0.0579, 0.3913,
        0.0534])
[rfa agg] iter:  1, prev_obj_val: 56.944862365722656, obj_val: 58.556339263916016, abs dis: 1.6114768981933594
[rfa agg] iter: 1, weight: tensor([0.1035, 0.0974, 0.0018, 0.0763, 0.0769, 0.0269, 0.1608, 0.0745, 0.3309,
        0.0511])
[rfa agg] iter:  2, prev_obj_val: 58.556339263916016, obj_val: 61.97772979736328, abs dis: 3.4213905334472656
[rfa agg] iter: 2, weight: tensor([0.1272, 0.0921, 0.0019, 0.0740, 0.0746, 0.0297, 0.2144, 0.0879, 0.2470,
        0.0511])
[rfa agg] iter:  3, prev_obj_val: 61.97772979736328, obj_val: 68.85911560058594, abs dis: 6.881385803222656
[rfa agg] iter: 3, weight: tensor([0.1658, 0.0659, 0.0017, 0.0551, 0.0555, 0.0288, 0.3542, 0.1013, 0.1316,
        0.0401])
[rfa agg] iter:  4, prev_obj_val: 68.85911560058594, obj_val: 68.77896118164062, abs dis: 0.0801544189453125
[rfa agg] iter: 4, weight: tensor([0.3147, 0.0473, 0.0017, 0.0413, 0.0417, 0.0328, 0.2319, 0.1825, 0.0741,
        0.0320])
[rfa agg] iter:  5, prev_obj_val: 68.77896118164062, obj_val: 75.06612396240234, abs dis: 6.287162780761719
[rfa agg] iter: 5, weight: tensor([0.3727, 0.0438, 0.0016, 0.0382, 0.0385, 0.0303, 0.2002, 0.1769, 0.0682,
        0.0296])
[rfa agg] iter:  6, prev_obj_val: 75.06612396240234, obj_val: 68.8155517578125, abs dis: 6.250572204589844
[rfa agg] iter: 6, weight: tensor([0.2364, 0.0458, 0.0020, 0.0409, 0.0412, 0.0442, 0.1356, 0.3562, 0.0649,
        0.0328])
[rfa agg] iter:  7, prev_obj_val: 68.8155517578125, obj_val: 75.05833435058594, abs dis: 6.2427825927734375
[rfa agg] iter: 7, weight: tensor([0.3541, 0.0447, 0.0016, 0.0390, 0.0394, 0.0310, 0.1965, 0.1937, 0.0697,
        0.0303])
[rfa agg] iter:  8, prev_obj_val: 75.05833435058594, obj_val: 66.24788665771484, abs dis: 8.810447692871094
[rfa agg] iter: 8, weight: tensor([0.2335, 0.0455, 0.0020, 0.0406, 0.0409, 0.0440, 0.1348, 0.3616, 0.0645,
        0.0326])
[rfa agg] iter:  9, prev_obj_val: 66.24788665771484, obj_val: 66.17637634277344, abs dis: 0.07151031494140625
[rfa agg] iter: 9, weight: tensor([0.2951, 0.0498, 0.0016, 0.0429, 0.0433, 0.0295, 0.2775, 0.1451, 0.0825,
        0.0326])
			Update norm = 140.4670362798689 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.88696122169495 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 384/1129 (34.0124%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 737/1129 (65.2790%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0131, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0377, Accuracy: 403/1163 (34.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.8390, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0592, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 406/1154 (35.1820%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6611, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.2145, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 416/1904 (21.8487%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 693/1904 (36.3971%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8586, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 417/1953 (21.3518%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 759/1953 (38.8633%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2015, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0523, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 450/891 (50.5051%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3839, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 655/1956 (33.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5710, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 457/1715 (26.6472%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 701/1715 (40.8746%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0540, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0480, Accuracy: 292/813 (35.9164%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.5016, Accuracy: 54/10000 (0.5400%)
time spent on training: 225.81648683547974
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 68, 15, 88, 46, 83, 7, 6, 92, 53], weight: tensor([0.0850, 0.0876, 0.0869, 0.0454, 0.1434, 0.1471, 0.0671, 0.1473, 0.1291,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 63.41306686401367, obj_val: 66.44638061523438, abs dis: 3.033313751220703
[rfa agg] iter: 0, weight: tensor([0.1306, 0.1840, 0.1780, 0.0220, 0.0939, 0.0862, 0.0497, 0.0864, 0.1291,
        0.0401])
[rfa agg] iter:  1, prev_obj_val: 66.44638061523438, obj_val: 74.07716369628906, abs dis: 7.6307830810546875
[rfa agg] iter: 1, weight: tensor([0.1585, 0.3038, 0.2616, 0.0160, 0.0456, 0.0427, 0.0404, 0.0428, 0.0572,
        0.0314])
[rfa agg] iter:  2, prev_obj_val: 74.07716369628906, obj_val: 76.71772766113281, abs dis: 2.64056396484375
[rfa agg] iter: 2, weight: tensor([0.2846, 0.2011, 0.1901, 0.0231, 0.0438, 0.0416, 0.0710, 0.0417, 0.0517,
        0.0512])
[rfa agg] iter:  3, prev_obj_val: 76.71772766113281, obj_val: 79.51786804199219, abs dis: 2.800140380859375
[rfa agg] iter: 3, weight: tensor([0.2808, 0.1737, 0.1671, 0.0278, 0.0474, 0.0452, 0.0927, 0.0453, 0.0553,
        0.0647])
[rfa agg] iter:  4, prev_obj_val: 79.51786804199219, obj_val: 71.54930877685547, abs dis: 7.968559265136719
[rfa agg] iter: 4, weight: tensor([0.2395, 0.1595, 0.1548, 0.0334, 0.0511, 0.0488, 0.1228, 0.0489, 0.0590,
        0.0823])
[rfa agg] iter:  5, prev_obj_val: 71.54930877685547, obj_val: 71.52635955810547, abs dis: 0.02294921875
[rfa agg] iter: 5, weight: tensor([0.3217, 0.2139, 0.1949, 0.0184, 0.0387, 0.0366, 0.0534, 0.0367, 0.0463,
        0.0393])
[rfa agg] iter:  6, prev_obj_val: 71.52635955810547, obj_val: 74.01504516601562, abs dis: 2.4886856079101562
[rfa agg] iter: 6, weight: tensor([0.3330, 0.2110, 0.1930, 0.0179, 0.0378, 0.0358, 0.0520, 0.0359, 0.0452,
        0.0383])
[rfa agg] iter:  7, prev_obj_val: 74.01504516601562, obj_val: 76.71837615966797, abs dis: 2.7033309936523438
[rfa agg] iter: 7, weight: tensor([0.3303, 0.1851, 0.1749, 0.0220, 0.0418, 0.0397, 0.0680, 0.0398, 0.0494,
        0.0489])
[rfa agg] iter:  8, prev_obj_val: 76.71837615966797, obj_val: 79.51830291748047, abs dis: 2.7999267578125
[rfa agg] iter: 8, weight: tensor([0.2870, 0.1717, 0.1651, 0.0276, 0.0472, 0.0449, 0.0922, 0.0450, 0.0550,
        0.0643])
[rfa agg] iter:  9, prev_obj_val: 79.51830291748047, obj_val: 71.54926300048828, abs dis: 7.9690399169921875
[rfa agg] iter: 9, weight: tensor([0.2399, 0.1593, 0.1546, 0.0334, 0.0511, 0.0488, 0.1228, 0.0489, 0.0590,
        0.0822])
			Update norm = 162.58352420755924 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.4832422733307 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9894, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0837, Accuracy: 55/466 (11.8026%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9244, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 429/1154 (37.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4130, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 344/1130 (30.4425%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 537/1130 (47.5221%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8433, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.6814, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 580/2227 (26.0440%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1035/2227 (46.4751%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3809, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0513, Accuracy: 364/712 (51.1236%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 450/712 (63.2022%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0707, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 358/1446 (24.7580%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 512/1446 (35.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.4525, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 352/1213 (29.0190%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 497/1213 (40.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4313, Accuracy: 87/10000 (0.8700%)
time spent on training: 199.41152119636536
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 76, 15, 54, 78, 12, 60, 11, 26, 97], weight: tensor([0.1105, 0.0455, 0.1128, 0.1104, 0.0407, 0.0330, 0.2176, 0.0696, 0.1413,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 59.34527587890625, obj_val: 68.6780014038086, abs dis: 9.332725524902344
[rfa agg] iter: 0, weight: tensor([0.2753, 0.0089, 0.1578, 0.2651, 0.0072, 0.0054, 0.0250, 0.0225, 0.0542,
        0.1786])
[rfa agg] iter:  1, prev_obj_val: 68.6780014038086, obj_val: 68.6700210571289, abs dis: 0.0079803466796875
[rfa agg] iter: 1, weight: tensor([0.2189, 0.0235, 0.1491, 0.2167, 0.0187, 0.0136, 0.0474, 0.0710, 0.0828,
        0.1583])
			Update norm = 144.82908164669485 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.21718430519104 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 346/1573 (21.9962%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 588/1573 (37.3808%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3077, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0551, Accuracy: 392/1953 (20.0717%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 725/1953 (37.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1941, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0552, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 647/1904 (33.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6564, Accuracy: 84/10000 (0.8400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 411/1574 (26.1118%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 689/1574 (43.7738%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4629, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 137/603 (22.7197%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.1769, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 144/818 (17.6039%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 380/818 (46.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5860, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7467, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 76/460 (16.5217%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.1549, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 309/690 (44.7826%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0291, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.7676, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 662/1956 (33.8446%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3493, Accuracy: 120/10000 (1.2000%)
time spent on training: 248.65180277824402
[rfa agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.037035991265717945
[rfa agg] init. name: [40, 83, 46, 17, 88, 71, 44, 31, 25, 6], weight: tensor([0.1184, 0.1471, 0.1434, 0.1185, 0.0454, 0.0616, 0.1318, 0.0346, 0.0520,
        0.1473])
[rfa agg] iter:  0, prev_obj_val: 64.67930603027344, obj_val: 59.39274597167969, abs dis: 5.28656005859375
[rfa agg] iter: 0, weight: tensor([0.2440, 0.0941, 0.1037, 0.2428, 0.0198, 0.0353, 0.1284, 0.0131, 0.0247,
        0.0941])
[rfa agg] iter:  1, prev_obj_val: 59.39274597167969, obj_val: 59.38788604736328, abs dis: 0.00485992431640625
[rfa agg] iter: 1, weight: tensor([0.2867, 0.0798, 0.0893, 0.2841, 0.0138, 0.0240, 0.1165, 0.0092, 0.0170,
        0.0797])
			Update norm = 211.45892036043313 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.39053606987 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 323/1013 (31.8855%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 490/1013 (48.3712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7414, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 269/1071 (25.1167%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 521/1071 (48.6461%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3087, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0736, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.0939, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.0963, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 173/938 (18.4435%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 320/938 (34.1151%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4317, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 512/1552 (32.9897%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 792/1552 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.4839, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0529, Accuracy: 329/590 (55.7627%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0288, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1094, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 419/1131 (37.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0583, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 241/1513 (15.9286%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 483/1513 (31.9233%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0890, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 377/1427 (26.4191%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 553/1427 (38.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.0483, Accuracy: 57/10000 (0.5700%)
time spent on training: 207.5602741241455
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 55, 3, 31, 73, 74, 69, 87, 8, 34], weight: tensor([0.0967, 0.1022, 0.0746, 0.0439, 0.0895, 0.1481, 0.0563, 0.1080, 0.1444,
        0.1362])
[rfa agg] iter:  0, prev_obj_val: 44.34259033203125, obj_val: 48.263038635253906, abs dis: 3.9204483032226562
[rfa agg] iter: 0, weight: tensor([0.2717, 0.2008, 0.0600, 0.0136, 0.1734, 0.0407, 0.0232, 0.1242, 0.0445,
        0.0479])
[rfa agg] iter:  1, prev_obj_val: 48.263038635253906, obj_val: 50.775421142578125, abs dis: 2.5123825073242188
[rfa agg] iter: 1, weight: tensor([0.2076, 0.1271, 0.0916, 0.0165, 0.3106, 0.0389, 0.0295, 0.0917, 0.0420,
        0.0446])
[rfa agg] iter:  2, prev_obj_val: 50.775421142578125, obj_val: 50.77143478393555, abs dis: 0.003986358642578125
[rfa agg] iter: 2, weight: tensor([0.1651, 0.1128, 0.1274, 0.0194, 0.3226, 0.0406, 0.0358, 0.0867, 0.0436,
        0.0460])
			Update norm = 131.56801502692437 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3131, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.19906425476074 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0554, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.1112, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0774, Accuracy: 80/486 (16.4609%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0390, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.4941, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 135/603 (22.3881%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.4606, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3896, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 170/938 (18.1237%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 355/938 (37.8465%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4790, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 409/1036 (39.4788%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 688/1036 (66.4093%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.8047, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 507/1446 (35.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2336, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0582, Accuracy: 335/715 (46.8531%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9345, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0606, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 374/735 (50.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.6839, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 526/1470 (35.7823%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 826/1470 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3600, Accuracy: 85/10000 (0.8500%)
time spent on training: 196.7516884803772
[rfa agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 30, 88, 34, 73, 19, 26, 23, 32, 22], weight: tensor([0.0550, 0.0519, 0.0643, 0.1523, 0.1001, 0.1106, 0.1543, 0.0763, 0.0784,
        0.1569])
[rfa agg] iter:  0, prev_obj_val: 49.73270797729492, obj_val: 59.37389373779297, abs dis: 9.641185760498047
[rfa agg] iter: 0, weight: tensor([0.0297, 0.0241, 0.0417, 0.0617, 0.3887, 0.1659, 0.0626, 0.0797, 0.0825,
        0.0635])
[rfa agg] iter:  1, prev_obj_val: 59.37389373779297, obj_val: 70.44107818603516, abs dis: 11.067184448242188
[rfa agg] iter: 1, weight: tensor([0.0524, 0.0377, 0.0893, 0.0407, 0.0969, 0.0645, 0.0412, 0.2366, 0.2988,
        0.0419])
[rfa agg] iter:  2, prev_obj_val: 70.44107818603516, obj_val: 77.32757568359375, abs dis: 6.886497497558594
[rfa agg] iter: 2, weight: tensor([0.1443, 0.0796, 0.3169, 0.0372, 0.0628, 0.0499, 0.0377, 0.1137, 0.1197,
        0.0382])
[rfa agg] iter:  3, prev_obj_val: 77.32757568359375, obj_val: 81.14143371582031, abs dis: 3.8138580322265625
[rfa agg] iter: 3, weight: tensor([0.2896, 0.1516, 0.1905, 0.0353, 0.0537, 0.0447, 0.0358, 0.0798, 0.0828,
        0.0363])
[rfa agg] iter:  4, prev_obj_val: 81.14143371582031, obj_val: 81.13655090332031, abs dis: 0.0048828125
[rfa agg] iter: 4, weight: tensor([0.2609, 0.2569, 0.1355, 0.0352, 0.0513, 0.0434, 0.0357, 0.0711, 0.0738,
        0.0362])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3153, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3763, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.51922369003296 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0634, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 466/1163 (40.0688%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.0318, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 75/500 (15.0000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.0604, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 409/1628 (25.1229%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 799/1628 (49.0786%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2663, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 323/1013 (31.8855%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 529/1013 (52.2211%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0003, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0574, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.1401, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 541/1470 (36.8027%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 839/1470 (57.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.7113, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4674, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 503/1552 (32.4098%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 806/1552 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.3504, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0573, Accuracy: 280/636 (44.0252%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.6737, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0791, Accuracy: 46/373 (12.3324%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7270, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.98268747329712
[rfa agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 82, 5, 39, 20, 22, 96, 74, 52, 98], weight: tensor([0.1230, 0.0529, 0.1722, 0.1072, 0.0854, 0.1555, 0.0329, 0.1642, 0.0673,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 58.05402374267578, obj_val: 60.87759017944336, abs dis: 2.823566436767578
[rfa agg] iter: 0, weight: tensor([0.1732, 0.0232, 0.0673, 0.4243, 0.0885, 0.0885, 0.0107, 0.0718, 0.0385,
        0.0140])
[rfa agg] iter:  1, prev_obj_val: 60.87759017944336, obj_val: 64.75941467285156, abs dis: 3.881824493408203
[rfa agg] iter: 1, weight: tensor([0.1151, 0.0236, 0.0549, 0.5051, 0.1089, 0.0692, 0.0105, 0.0579, 0.0408,
        0.0139])
[rfa agg] iter:  2, prev_obj_val: 64.75941467285156, obj_val: 66.72293853759766, abs dis: 1.9635238647460938
[rfa agg] iter: 2, weight: tensor([0.1193, 0.0360, 0.0663, 0.3059, 0.2208, 0.0808, 0.0153, 0.0693, 0.0656,
        0.0206])
[rfa agg] iter:  3, prev_obj_val: 66.72293853759766, obj_val: 64.73135375976562, abs dis: 1.9915847778320312
[rfa agg] iter: 3, weight: tensor([0.1077, 0.0389, 0.0635, 0.2280, 0.3081, 0.0763, 0.0162, 0.0660, 0.0735,
        0.0218])
[rfa agg] iter:  4, prev_obj_val: 64.73135375976562, obj_val: 64.72481536865234, abs dis: 0.00653839111328125
[rfa agg] iter: 4, weight: tensor([0.1197, 0.0361, 0.0665, 0.2911, 0.2340, 0.0811, 0.0154, 0.0695, 0.0659,
        0.0207])
[rfa agg] iter:  5, prev_obj_val: 64.72481536865234, obj_val: 66.72105407714844, abs dis: 1.9962387084960938
[rfa agg] iter: 5, weight: tensor([0.1197, 0.0361, 0.0665, 0.2952, 0.2299, 0.0811, 0.0154, 0.0695, 0.0659,
        0.0206])
[rfa agg] iter:  6, prev_obj_val: 66.72105407714844, obj_val: 64.73149108886719, abs dis: 1.98956298828125
[rfa agg] iter: 6, weight: tensor([0.1075, 0.0389, 0.0634, 0.2275, 0.3091, 0.0762, 0.0161, 0.0660, 0.0735,
        0.0218])
[rfa agg] iter:  7, prev_obj_val: 64.73149108886719, obj_val: 64.72481536865234, abs dis: 0.00667572021484375
[rfa agg] iter: 7, weight: tensor([0.1197, 0.0361, 0.0665, 0.2911, 0.2341, 0.0811, 0.0154, 0.0695, 0.0659,
        0.0207])
[rfa agg] iter:  8, prev_obj_val: 64.72481536865234, obj_val: 66.72105407714844, abs dis: 1.9962387084960938
[rfa agg] iter: 8, weight: tensor([0.1197, 0.0361, 0.0665, 0.2952, 0.2299, 0.0811, 0.0154, 0.0695, 0.0659,
        0.0206])
[rfa agg] iter:  9, prev_obj_val: 66.72105407714844, obj_val: 64.73149108886719, abs dis: 1.98956298828125
[rfa agg] iter: 9, weight: tensor([0.1075, 0.0389, 0.0634, 0.2275, 0.3091, 0.0762, 0.0161, 0.0660, 0.0735,
        0.0218])
			Update norm = 131.20951012359964 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3153, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3763, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.59914112091064 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0616, Accuracy: 164/809 (20.2719%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 368/809 (45.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7958, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 503/1213 (41.4674%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.9634, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 287/636 (45.1258%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0320, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8668, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0600, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7532, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 556/2227 (24.9663%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1061/2227 (47.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0897, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0532, Accuracy: 362/712 (50.8427%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.0371, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 301/813 (37.0234%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 466/813 (57.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.4612, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0521, Accuracy: 329/590 (55.7627%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.1166, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0586, Accuracy: 207/861 (24.0418%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.6085, Accuracy: 51/10000 (0.5100%)
time spent on training: 198.01878452301025
[rfa agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [50, 97, 52, 73, 41, 60, 11, 53, 69, 10], weight: tensor([0.0850, 0.1274, 0.0668, 0.0986, 0.0755, 0.2340, 0.0748, 0.0854, 0.0620,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 63.41167068481445, obj_val: 63.834686279296875, abs dis: 0.4230155944824219
[rfa agg] iter: 0, weight: tensor([0.0972, 0.1460, 0.0391, 0.2595, 0.0652, 0.0435, 0.0651, 0.0979, 0.0363,
        0.1500])
[rfa agg] iter:  1, prev_obj_val: 63.834686279296875, obj_val: 78.7572250366211, abs dis: 14.922538757324219
[rfa agg] iter: 1, weight: tensor([0.1854, 0.0370, 0.0486, 0.0721, 0.1436, 0.0197, 0.1576, 0.1850, 0.0457,
        0.1054])
[rfa agg] iter:  2, prev_obj_val: 78.7572250366211, obj_val: 82.68962860107422, abs dis: 3.932403564453125
[rfa agg] iter: 2, weight: tensor([0.0720, 0.0367, 0.2342, 0.0505, 0.0917, 0.0243, 0.0924, 0.0726, 0.2675,
        0.0580])
[rfa agg] iter:  3, prev_obj_val: 82.68962860107422, obj_val: 87.00609588623047, abs dis: 4.31646728515625
[rfa agg] iter: 3, weight: tensor([0.0683, 0.0385, 0.2549, 0.0510, 0.0831, 0.0264, 0.0830, 0.0691, 0.2686,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 87.00609588623047, obj_val: 75.06910705566406, abs dis: 11.936988830566406
[rfa agg] iter: 4, weight: tensor([0.0796, 0.0486, 0.2239, 0.0621, 0.0930, 0.0344, 0.0927, 0.0805, 0.2168,
        0.0683])
[rfa agg] iter:  5, prev_obj_val: 75.06910705566406, obj_val: 78.63343811035156, abs dis: 3.5643310546875
[rfa agg] iter: 5, weight: tensor([0.0803, 0.0369, 0.2171, 0.0531, 0.1101, 0.0236, 0.1117, 0.0817, 0.2230,
        0.0625])
[rfa agg] iter:  6, prev_obj_val: 78.63343811035156, obj_val: 82.69002532958984, abs dis: 4.056587219238281
[rfa agg] iter: 6, weight: tensor([0.0624, 0.0321, 0.2605, 0.0441, 0.0801, 0.0213, 0.0805, 0.0633, 0.3052,
        0.0505])
[rfa agg] iter:  7, prev_obj_val: 82.69002532958984, obj_val: 87.00643157958984, abs dis: 4.31640625
[rfa agg] iter: 7, weight: tensor([0.0675, 0.0382, 0.2575, 0.0504, 0.0821, 0.0262, 0.0821, 0.0684, 0.2712,
        0.0565])
[rfa agg] iter:  8, prev_obj_val: 87.00643157958984, obj_val: 75.06910705566406, abs dis: 11.937324523925781
[rfa agg] iter: 8, weight: tensor([0.0796, 0.0486, 0.2240, 0.0621, 0.0930, 0.0344, 0.0927, 0.0805, 0.2169,
        0.0683])
[rfa agg] iter:  9, prev_obj_val: 75.06910705566406, obj_val: 78.63343048095703, abs dis: 3.5643234252929688
[rfa agg] iter: 9, weight: tensor([0.0803, 0.0369, 0.2171, 0.0531, 0.1101, 0.0236, 0.1117, 0.0817, 0.2230,
        0.0625])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3178, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3652, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 294.12080907821655 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 803/1953 (41.1162%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9540, Accuracy: 110/10000 (1.1000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 373/1574 (23.6976%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 706/1574 (44.8539%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0803, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0615, Accuracy: 160/809 (19.7775%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8423, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.6778, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 377/1129 (33.3924%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 743/1129 (65.8105%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9829, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 782/1628 (48.0344%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8734, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/1130 (43.3628%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.4623, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0544, Accuracy: 295/636 (46.3836%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.9798, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 368/712 (51.6854%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 416/712 (58.4270%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8542, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 372/1163 (31.9862%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 403/1163 (34.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8713, Accuracy: 73/10000 (0.7300%)
time spent on training: 231.26499915122986
[rfa agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.04452969400688032
[rfa agg] init. name: [83, 17, 50, 24, 37, 5, 54, 52, 11, 68], weight: tensor([0.1768, 0.1425, 0.0732, 0.0282, 0.1022, 0.1474, 0.1023, 0.0576, 0.0645,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 56.38962936401367, obj_val: 63.414466857910156, abs dis: 7.024837493896484
[rfa agg] iter: 0, weight: tensor([0.0379, 0.0585, 0.0355, 0.0056, 0.2582, 0.0525, 0.2639, 0.0182, 0.0265,
        0.2431])
[rfa agg] iter:  1, prev_obj_val: 63.414466857910156, obj_val: 61.112159729003906, abs dis: 2.30230712890625
[rfa agg] iter: 1, weight: tensor([0.0486, 0.0666, 0.0816, 0.0098, 0.2400, 0.0617, 0.2412, 0.0352, 0.0564,
        0.1589])
[rfa agg] iter:  2, prev_obj_val: 61.112159729003906, obj_val: 65.77481079101562, abs dis: 4.662651062011719
[rfa agg] iter: 2, weight: tensor([0.0426, 0.0599, 0.0610, 0.0080, 0.2693, 0.0552, 0.2726, 0.0277, 0.0432,
        0.1605])
[rfa agg] iter:  3, prev_obj_val: 65.77481079101562, obj_val: 68.17451477050781, abs dis: 2.3997039794921875
[rfa agg] iter: 3, weight: tensor([0.0528, 0.0708, 0.1063, 0.0115, 0.2138, 0.0660, 0.2148, 0.0428, 0.0711,
        0.1501])
[rfa agg] iter:  4, prev_obj_val: 68.17451477050781, obj_val: 65.76849365234375, abs dis: 2.4060211181640625
[rfa agg] iter: 4, weight: tensor([0.0551, 0.0723, 0.1365, 0.0130, 0.1882, 0.0678, 0.1890, 0.0503, 0.0873,
        0.1405])
[rfa agg] iter:  5, prev_obj_val: 65.76849365234375, obj_val: 68.17436981201172, abs dis: 2.4058761596679688
[rfa agg] iter: 5, weight: tensor([0.0530, 0.0710, 0.1074, 0.0116, 0.2122, 0.0662, 0.2137, 0.0429, 0.0716,
        0.1505])
[rfa agg] iter:  6, prev_obj_val: 68.17436981201172, obj_val: 65.76849365234375, abs dis: 2.4058761596679688
[rfa agg] iter: 6, weight: tensor([0.0551, 0.0723, 0.1365, 0.0130, 0.1881, 0.0678, 0.1890, 0.0503, 0.0874,
        0.1405])
[rfa agg] iter:  7, prev_obj_val: 65.76849365234375, obj_val: 68.17436981201172, abs dis: 2.4058761596679688
[rfa agg] iter: 7, weight: tensor([0.0530, 0.0710, 0.1074, 0.0116, 0.2122, 0.0662, 0.2137, 0.0429, 0.0716,
        0.1505])
[rfa agg] iter:  8, prev_obj_val: 68.17436981201172, obj_val: 65.76849365234375, abs dis: 2.4058761596679688
[rfa agg] iter: 8, weight: tensor([0.0551, 0.0723, 0.1365, 0.0130, 0.1881, 0.0678, 0.1890, 0.0503, 0.0874,
        0.1405])
[rfa agg] iter:  9, prev_obj_val: 65.76849365234375, obj_val: 68.17436981201172, abs dis: 2.4058761596679688
[rfa agg] iter: 9, weight: tensor([0.0530, 0.0710, 0.1074, 0.0116, 0.2122, 0.0662, 0.2137, 0.0429, 0.0716,
        0.1505])
			Update norm = 139.90724466365208 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3178, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3652, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.64415287971497 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0748, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.1461, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 336/1340 (25.0746%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9118, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0593, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9444, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0664, Accuracy: 171/682 (25.0733%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0371, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0138, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 116/781 (14.8528%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0600, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 410/1440 (28.4722%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 637/1440 (44.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.4401, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0526, Accuracy: 436/1715 (25.4227%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 730/1715 (42.5656%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7418, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 326/735 (44.3537%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.9030, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 416/1163 (35.7696%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0107, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 305/1089 (28.0073%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/1089 (44.9954%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1309, Accuracy: 67/10000 (0.6700%)
time spent on training: 222.925799369812
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 77, 23, 80, 3, 29, 92, 32, 68, 59], weight: tensor([0.0492, 0.1319, 0.0704, 0.0671, 0.0769, 0.1417, 0.1688, 0.0723, 0.1145,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 52.293052673339844, obj_val: 55.19258117675781, abs dis: 2.8995285034179688
[rfa agg] iter: 0, weight: tensor([0.0299, 0.1081, 0.0897, 0.0675, 0.1342, 0.0858, 0.0669, 0.0927, 0.1449,
        0.1804])
[rfa agg] iter:  1, prev_obj_val: 55.19258117675781, obj_val: 58.2684211730957, abs dis: 3.0758399963378906
[rfa agg] iter: 1, weight: tensor([0.0325, 0.0866, 0.1162, 0.0813, 0.1979, 0.0715, 0.0580, 0.1207, 0.1079,
        0.1274])
[rfa agg] iter:  2, prev_obj_val: 58.2684211730957, obj_val: 64.607421875, abs dis: 6.339000701904297
[rfa agg] iter: 2, weight: tensor([0.0295, 0.0578, 0.1404, 0.0863, 0.3028, 0.0492, 0.0413, 0.1474, 0.0682,
        0.0770])
[rfa agg] iter:  3, prev_obj_val: 64.607421875, obj_val: 71.01374053955078, abs dis: 6.406318664550781
[rfa agg] iter: 3, weight: tensor([0.0287, 0.0344, 0.2379, 0.1340, 0.1568, 0.0303, 0.0265, 0.2714, 0.0383,
        0.0415])
[rfa agg] iter:  4, prev_obj_val: 71.01374053955078, obj_val: 70.97183990478516, abs dis: 0.041900634765625
[rfa agg] iter: 4, weight: tensor([0.0450, 0.0366, 0.1681, 0.3267, 0.1010, 0.0329, 0.0294, 0.1784, 0.0397,
        0.0422])
[rfa agg] iter:  5, prev_obj_val: 70.97183990478516, obj_val: 74.74211883544922, abs dis: 3.7702789306640625
[rfa agg] iter: 5, weight: tensor([0.0412, 0.0335, 0.1514, 0.3909, 0.0917, 0.0301, 0.0269, 0.1593, 0.0363,
        0.0386])
[rfa agg] iter:  6, prev_obj_val: 74.74211883544922, obj_val: 74.74022674560547, abs dis: 0.00189208984375
[rfa agg] iter: 6, weight: tensor([0.0634, 0.0413, 0.1419, 0.3472, 0.0969, 0.0373, 0.0337, 0.1475, 0.0442,
        0.0466])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.7317488193512 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0768, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0406, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.0825, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0554, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.8552, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 417/1129 (36.9353%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 721/1129 (63.8618%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9719, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 413/1742 (23.7084%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 678/1742 (38.9208%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2274, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/1130 (43.3628%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7774, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0590, Accuracy: 352/896 (39.2857%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 425/896 (47.4330%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5920, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 489/1154 (42.3744%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.3791, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 380/803 (47.3225%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.4550, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 410/1475 (27.7966%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 625/1475 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6260, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0313, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.3139, Accuracy: 56/10000 (0.5600%)
time spent on training: 231.68772220611572
[rfa agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 63, 37, 93, 54, 89, 57, 58, 65, 75], weight: tensor([0.0504, 0.0844, 0.1073, 0.1655, 0.1074, 0.0851, 0.1097, 0.0763, 0.1402,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 46.93679428100586, obj_val: 53.53416061401367, abs dis: 6.5973663330078125
[rfa agg] iter: 0, weight: tensor([0.0252, 0.1611, 0.1311, 0.0432, 0.1336, 0.1635, 0.0996, 0.0962, 0.0535,
        0.0930])
[rfa agg] iter:  1, prev_obj_val: 53.53416061401367, obj_val: 63.60382843017578, abs dis: 10.06966781616211
[rfa agg] iter: 1, weight: tensor([0.0234, 0.2030, 0.0492, 0.0240, 0.0496, 0.1985, 0.0416, 0.1937, 0.0280,
        0.1890])
[rfa agg] iter:  2, prev_obj_val: 63.60382843017578, obj_val: 67.50299835205078, abs dis: 3.899169921875
[rfa agg] iter: 2, weight: tensor([0.0551, 0.1337, 0.0590, 0.0346, 0.0593, 0.1345, 0.0520, 0.2191, 0.0389,
        0.2138])
[rfa agg] iter:  3, prev_obj_val: 67.50299835205078, obj_val: 56.32748794555664, abs dis: 11.17551040649414
[rfa agg] iter: 3, weight: tensor([0.0795, 0.1313, 0.0661, 0.0406, 0.0664, 0.1323, 0.0588, 0.1929, 0.0452,
        0.1869])
[rfa agg] iter:  4, prev_obj_val: 56.32748794555664, obj_val: 67.5107192993164, abs dis: 11.183231353759766
[rfa agg] iter: 4, weight: tensor([0.0253, 0.1380, 0.0426, 0.0223, 0.0429, 0.1382, 0.0366, 0.2662, 0.0257,
        0.2623])
[rfa agg] iter:  5, prev_obj_val: 67.5107192993164, obj_val: 56.32723617553711, abs dis: 11.183483123779297
[rfa agg] iter: 5, weight: tensor([0.0792, 0.1310, 0.0659, 0.0405, 0.0663, 0.1320, 0.0587, 0.1935, 0.0452,
        0.1877])
[rfa agg] iter:  6, prev_obj_val: 56.32723617553711, obj_val: 67.5107421875, abs dis: 11.18350601196289
[rfa agg] iter: 6, weight: tensor([0.0252, 0.1379, 0.0426, 0.0223, 0.0429, 0.1381, 0.0366, 0.2663, 0.0257,
        0.2624])
[rfa agg] iter:  7, prev_obj_val: 67.5107421875, obj_val: 56.327232360839844, abs dis: 11.183509826660156
[rfa agg] iter: 7, weight: tensor([0.0792, 0.1310, 0.0659, 0.0405, 0.0663, 0.1320, 0.0587, 0.1935, 0.0452,
        0.1877])
[rfa agg] iter:  8, prev_obj_val: 56.327232360839844, obj_val: 67.5107421875, abs dis: 11.183509826660156
[rfa agg] iter: 8, weight: tensor([0.0252, 0.1379, 0.0426, 0.0223, 0.0429, 0.1381, 0.0366, 0.2663, 0.0257,
        0.2624])
[rfa agg] iter:  9, prev_obj_val: 67.5107421875, obj_val: 56.327232360839844, abs dis: 11.183509826660156
[rfa agg] iter: 9, weight: tensor([0.0792, 0.1310, 0.0659, 0.0405, 0.0663, 0.1320, 0.0587, 0.1935, 0.0452,
        0.1877])
			Update norm = 117.46170419811301 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.2312889099121 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0839, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2214, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8214, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0817, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0662, Accuracy: 79/186 (42.4731%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0552, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 414/888 (46.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.2278, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1213, Accuracy: 4/134 (2.9851%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1043, Accuracy: 33/134 (24.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3497, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 545/1470 (37.0748%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 888/1470 (60.4082%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2865, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 368/1418 (25.9520%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 674/1418 (47.5317%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8554, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 393/1427 (27.5403%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 565/1427 (39.5936%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1255, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 74/460 (16.0870%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.3469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 517/1552 (33.3119%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.7579, Accuracy: 89/10000 (0.8900%)
time spent on training: 212.03935170173645
[rfa agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 12, 56, 63, 47, 22, 70, 34, 31, 74], weight: tensor([0.0559, 0.0405, 0.0223, 0.1065, 0.0161, 0.1763, 0.1700, 0.1711, 0.0552,
        0.1861])
[rfa agg] iter:  0, prev_obj_val: 64.01746368408203, obj_val: 62.19952392578125, abs dis: 1.8179397583007812
[rfa agg] iter: 0, weight: tensor([0.0407, 0.0239, 0.0102, 0.2529, 0.0074, 0.1667, 0.1607, 0.1620, 0.0402,
        0.1352])
[rfa agg] iter:  1, prev_obj_val: 62.19952392578125, obj_val: 58.61006546020508, abs dis: 3.589458465576172
[rfa agg] iter: 1, weight: tensor([0.0383, 0.0227, 0.0098, 0.2145, 0.0071, 0.1795, 0.1730, 0.1745, 0.0378,
        0.1428])
[rfa agg] iter:  2, prev_obj_val: 58.61006546020508, obj_val: 56.824607849121094, abs dis: 1.7854576110839844
[rfa agg] iter: 2, weight: tensor([0.0325, 0.0197, 0.0087, 0.1531, 0.0062, 0.2023, 0.1950, 0.1968, 0.0321,
        0.1536])
[rfa agg] iter:  3, prev_obj_val: 56.824607849121094, obj_val: 56.824039459228516, abs dis: 0.000568389892578125
[rfa agg] iter: 3, weight: tensor([0.0294, 0.0179, 0.0079, 0.1292, 0.0057, 0.2126, 0.2047, 0.2069, 0.0290,
        0.1567])
			Update norm = 166.3661542069931 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.24688506126404 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 419/1587 (26.4020%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0893, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0849, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0521, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8091, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 377/712 (52.9494%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.1099, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 339/1013 (33.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0575, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 431/1953 (22.0686%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 758/1953 (38.8121%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3162, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 394/1440 (27.3611%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 656/1440 (45.5556%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6588, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0548, Accuracy: 400/1475 (27.1186%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 667/1475 (45.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.6139, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 276/1241 (22.2401%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 403/1241 (32.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7803, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0639, Accuracy: 179/682 (26.2463%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0363, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7935, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 220/861 (25.5517%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 416/861 (48.3159%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7433, Accuracy: 52/10000 (0.5200%)
time spent on training: 250.29805946350098
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 36, 11, 14, 83, 29, 65, 72, 80, 10], weight: tensor([0.1396, 0.0359, 0.0626, 0.0891, 0.1717, 0.1266, 0.1297, 0.1091, 0.0600,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 57.382591247558594, obj_val: 60.46387481689453, abs dis: 3.0812835693359375
[rfa agg] iter: 0, weight: tensor([0.0964, 0.0141, 0.0434, 0.1547, 0.0621, 0.1251, 0.1053, 0.2877, 0.0361,
        0.0751])
[rfa agg] iter:  1, prev_obj_val: 60.46387481689453, obj_val: 63.71346664428711, abs dis: 3.249591827392578
[rfa agg] iter: 1, weight: tensor([0.0861, 0.0159, 0.0526, 0.2512, 0.0591, 0.1060, 0.0919, 0.1966, 0.0427,
        0.0981])
[rfa agg] iter:  2, prev_obj_val: 63.71346664428711, obj_val: 65.48388671875, abs dis: 1.7704200744628906
[rfa agg] iter: 2, weight: tensor([0.0615, 0.0142, 0.0517, 0.4267, 0.0445, 0.0727, 0.0646, 0.1148, 0.0407,
        0.1086])
[rfa agg] iter:  3, prev_obj_val: 65.48388671875, obj_val: 67.65894317626953, abs dis: 2.1750564575195312
[rfa agg] iter: 3, weight: tensor([0.0445, 0.0115, 0.0445, 0.5556, 0.0330, 0.0518, 0.0465, 0.0772, 0.0343,
        0.1012])
[rfa agg] iter:  4, prev_obj_val: 67.65894317626953, obj_val: 67.650390625, abs dis: 0.00855255126953125
[rfa agg] iter: 4, weight: tensor([0.0480, 0.0138, 0.0574, 0.4749, 0.0363, 0.0550, 0.0497, 0.0781, 0.0432,
        0.1436])
[rfa agg] iter:  5, prev_obj_val: 67.650390625, obj_val: 70.01143646240234, abs dis: 2.3610458374023438
[rfa agg] iter: 5, weight: tensor([0.0494, 0.0142, 0.0592, 0.4570, 0.0374, 0.0566, 0.0512, 0.0804, 0.0444,
        0.1503])
[rfa agg] iter:  6, prev_obj_val: 70.01143646240234, obj_val: 72.41938018798828, abs dis: 2.4079437255859375
[rfa agg] iter: 6, weight: tensor([0.0542, 0.0174, 0.0791, 0.3177, 0.0418, 0.0613, 0.0558, 0.0839, 0.0575,
        0.2312])
[rfa agg] iter:  7, prev_obj_val: 72.41938018798828, obj_val: 74.96293640136719, abs dis: 2.5435562133789062
[rfa agg] iter: 7, weight: tensor([0.0506, 0.0182, 0.0923, 0.2124, 0.0397, 0.0566, 0.0519, 0.0749, 0.0642,
        0.3392])
[rfa agg] iter:  8, prev_obj_val: 74.96293640136719, obj_val: 72.40272521972656, abs dis: 2.560211181640625
[rfa agg] iter: 8, weight: tensor([0.0429, 0.0173, 0.1005, 0.1432, 0.0342, 0.0475, 0.0438, 0.0610, 0.0661,
        0.4434])
[rfa agg] iter:  9, prev_obj_val: 72.40272521972656, obj_val: 72.39739227294922, abs dis: 0.00533294677734375
[rfa agg] iter: 9, weight: tensor([0.0473, 0.0171, 0.0863, 0.1896, 0.0372, 0.0530, 0.0486, 0.0700, 0.0601,
        0.3908])
			Update norm = 130.7922897072874 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 345.80146741867065 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 149/603 (24.7098%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3220, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 2/85 (2.3529%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3347, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 450/1742 (25.8324%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 709/1742 (40.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1092, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0776, Accuracy: 129/530 (24.3396%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.8585, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0648, Accuracy: 167/682 (24.4868%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0364, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.9384, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 448/1715 (26.1224%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 708/1715 (41.2828%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1498, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0517, Accuracy: 356/677 (52.5849%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 425/677 (62.7770%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1083, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0603, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5576, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 383/1956 (19.5808%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 656/1956 (33.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2864, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 355/1418 (25.0353%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 625/1418 (44.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9984, Accuracy: 103/10000 (1.0300%)
time spent on training: 245.88745045661926
[rfa agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 61, 93, 18, 80, 92, 90, 72, 6, 70], weight: tensor([0.0566, 0.0080, 0.1636, 0.0498, 0.0640, 0.1610, 0.0636, 0.1165, 0.1837,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 64.80146789550781, obj_val: 68.10713195800781, abs dis: 3.3056640625
[rfa agg] iter: 0, weight: tensor([0.0219, 0.0018, 0.0882, 0.0176, 0.0274, 0.0995, 0.0272, 0.4411, 0.0710,
        0.2043])
[rfa agg] iter:  1, prev_obj_val: 68.10713195800781, obj_val: 70.25796508789062, abs dis: 2.1508331298828125
[rfa agg] iter: 1, weight: tensor([0.0225, 0.0017, 0.0723, 0.0179, 0.0284, 0.0802, 0.0282, 0.5490, 0.0602,
        0.1394])
[rfa agg] iter:  2, prev_obj_val: 70.25796508789062, obj_val: 72.48381042480469, abs dis: 2.2258453369140625
[rfa agg] iter: 2, weight: tensor([0.0289, 0.0022, 0.0830, 0.0228, 0.0367, 0.0915, 0.0364, 0.4800, 0.0702,
        0.1484])
[rfa agg] iter:  3, prev_obj_val: 72.48381042480469, obj_val: 66.19097900390625, abs dis: 6.2928314208984375
[rfa agg] iter: 3, weight: tensor([0.0366, 0.0027, 0.0944, 0.0288, 0.0469, 0.1034, 0.0466, 0.4006, 0.0808,
        0.1594])
[rfa agg] iter:  4, prev_obj_val: 66.19097900390625, obj_val: 68.07769775390625, abs dis: 1.88671875
[rfa agg] iter: 4, weight: tensor([0.0185, 0.0014, 0.0664, 0.0148, 0.0232, 0.0742, 0.0231, 0.5851, 0.0545,
        0.1387])
[rfa agg] iter:  5, prev_obj_val: 68.07769775390625, obj_val: 72.5103759765625, abs dis: 4.43267822265625
[rfa agg] iter: 5, weight: tensor([0.0205, 0.0016, 0.0658, 0.0163, 0.0259, 0.0730, 0.0257, 0.5905, 0.0549,
        0.1258])
[rfa agg] iter:  6, prev_obj_val: 72.5103759765625, obj_val: 68.11199188232422, abs dis: 4.398384094238281
[rfa agg] iter: 6, weight: tensor([0.0363, 0.0026, 0.0935, 0.0285, 0.0464, 0.1024, 0.0461, 0.4067, 0.0800,
        0.1575])
[rfa agg] iter:  7, prev_obj_val: 68.11199188232422, obj_val: 70.25740814208984, abs dis: 2.145416259765625
[rfa agg] iter: 7, weight: tensor([0.0227, 0.0017, 0.0730, 0.0181, 0.0287, 0.0810, 0.0285, 0.5453, 0.0608,
        0.1403])
[rfa agg] iter:  8, prev_obj_val: 70.25740814208984, obj_val: 72.48374938964844, abs dis: 2.2263412475585938
[rfa agg] iter: 8, weight: tensor([0.0289, 0.0022, 0.0831, 0.0229, 0.0367, 0.0915, 0.0365, 0.4796, 0.0702,
        0.1485])
[rfa agg] iter:  9, prev_obj_val: 72.48374938964844, obj_val: 66.19100189208984, abs dis: 6.292747497558594
[rfa agg] iter: 9, weight: tensor([0.0366, 0.0027, 0.0944, 0.0288, 0.0469, 0.1034, 0.0466, 0.4005, 0.0808,
        0.1594])
			Update norm = 179.71362310110217 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.04050397872925 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 371/946 (39.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.3067, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.2385, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0496, Accuracy: 361/599 (60.2671%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0309, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.0869, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 265/1071 (24.7432%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 488/1071 (45.5649%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5047, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0519, Accuracy: 367/1628 (22.5430%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 800/1628 (49.1400%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9411, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 176/938 (18.7633%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 357/938 (38.0597%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1090, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0552, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.2447, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 259/1131 (22.9001%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 489/1131 (43.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0592, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 341/1645 (20.7295%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 623/1645 (37.8723%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2291, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0837, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0448, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.9692, Accuracy: 50/10000 (0.5000%)
time spent on training: 230.92749285697937
[rfa agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 82, 95, 55, 5, 73, 63, 38, 13, 76], weight: tensor([0.0964, 0.0510, 0.0610, 0.1092, 0.1659, 0.0956, 0.0905, 0.1153, 0.1677,
        0.0475])
[rfa agg] iter:  0, prev_obj_val: 49.60145950317383, obj_val: 58.915889739990234, abs dis: 9.314430236816406
[rfa agg] iter: 0, weight: tensor([0.2287, 0.0158, 0.0263, 0.1098, 0.0327, 0.3026, 0.1552, 0.0811, 0.0331,
        0.0147])
[rfa agg] iter:  1, prev_obj_val: 58.915889739990234, obj_val: 61.828853607177734, abs dis: 2.9129638671875
[rfa agg] iter: 1, weight: tensor([0.1618, 0.0366, 0.0716, 0.0965, 0.0460, 0.1659, 0.2589, 0.0822, 0.0465,
        0.0341])
[rfa agg] iter:  2, prev_obj_val: 61.828853607177734, obj_val: 61.82777404785156, abs dis: 0.001079559326171875
[rfa agg] iter: 2, weight: tensor([0.1499, 0.0462, 0.0969, 0.0980, 0.0503, 0.1517, 0.2279, 0.0853, 0.0509,
        0.0430])
			Update norm = 113.04660180512947 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.3183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.7920181751251 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.8669, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0580, Accuracy: 341/715 (47.6923%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0374, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.9778, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 384/803 (47.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.3040, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 332/946 (35.0951%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.3049, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2474, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 267/1513 (17.6471%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 490/1513 (32.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7523, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0620, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.5312, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 400/1003 (39.8804%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0592, Accuracy: 241/1049 (22.9743%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/1049 (46.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6885, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2862, Accuracy: 51/10000 (0.5100%)
time spent on training: 225.51325058937073
[rfa agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 23, 58, 43, 82, 8, 16, 86, 51, 62], weight: tensor([0.0937, 0.0830, 0.0932, 0.1098, 0.0581, 0.1757, 0.0822, 0.1165, 0.1218,
        0.0660])
[rfa agg] iter:  0, prev_obj_val: 36.738059997558594, obj_val: 47.76202392578125, abs dis: 11.023963928222656
[rfa agg] iter: 0, weight: tensor([0.1762, 0.1760, 0.2043, 0.0795, 0.0240, 0.0285, 0.1659, 0.0607, 0.0500,
        0.0349])
[rfa agg] iter:  1, prev_obj_val: 47.76202392578125, obj_val: 47.75002670288086, abs dis: 0.011997222900390625
[rfa agg] iter: 1, weight: tensor([0.1143, 0.1615, 0.1158, 0.0772, 0.0727, 0.0415, 0.1581, 0.0669, 0.0595,
        0.1324])
[rfa agg] iter:  2, prev_obj_val: 47.75002670288086, obj_val: 51.03978729248047, abs dis: 3.2897605895996094
[rfa agg] iter: 2, weight: tensor([0.1135, 0.1612, 0.1153, 0.0771, 0.0728, 0.0414, 0.1587, 0.0668, 0.0593,
        0.1339])
[rfa agg] iter:  3, prev_obj_val: 51.03978729248047, obj_val: 47.75307083129883, abs dis: 3.2867164611816406
[rfa agg] iter: 3, weight: tensor([0.1012, 0.1323, 0.1022, 0.0733, 0.0948, 0.0421, 0.1306, 0.0647, 0.0581,
        0.2006])
[rfa agg] iter:  4, prev_obj_val: 47.75307083129883, obj_val: 51.039676666259766, abs dis: 3.2866058349609375
[rfa agg] iter: 4, weight: tensor([0.1134, 0.1603, 0.1153, 0.0771, 0.0729, 0.0414, 0.1582, 0.0669, 0.0594,
        0.1350])
[rfa agg] iter:  5, prev_obj_val: 51.039676666259766, obj_val: 47.753074645996094, abs dis: 3.286602020263672
[rfa agg] iter: 5, weight: tensor([0.1012, 0.1323, 0.1022, 0.0733, 0.0948, 0.0421, 0.1306, 0.0647, 0.0581,
        0.2007])
[rfa agg] iter:  6, prev_obj_val: 47.753074645996094, obj_val: 51.039676666259766, abs dis: 3.286602020263672
[rfa agg] iter: 6, weight: tensor([0.1134, 0.1603, 0.1153, 0.0771, 0.0729, 0.0414, 0.1582, 0.0669, 0.0594,
        0.1350])
[rfa agg] iter:  7, prev_obj_val: 51.039676666259766, obj_val: 47.753074645996094, abs dis: 3.286602020263672
[rfa agg] iter: 7, weight: tensor([0.1012, 0.1323, 0.1022, 0.0733, 0.0948, 0.0421, 0.1306, 0.0647, 0.0581,
        0.2007])
[rfa agg] iter:  8, prev_obj_val: 47.753074645996094, obj_val: 51.039676666259766, abs dis: 3.286602020263672
[rfa agg] iter: 8, weight: tensor([0.1134, 0.1603, 0.1153, 0.0771, 0.0729, 0.0414, 0.1582, 0.0669, 0.0594,
        0.1350])
[rfa agg] iter:  9, prev_obj_val: 51.039676666259766, obj_val: 47.753074645996094, abs dis: 3.286602020263672
[rfa agg] iter: 9, weight: tensor([0.1012, 0.1323, 0.1022, 0.0733, 0.0948, 0.0421, 0.1306, 0.0647, 0.0581,
        0.2007])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3231, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.3275, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.90903973579407 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 356/807 (44.1140%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 415/807 (51.4250%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.8626, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0742, Accuracy: 98/486 (20.1646%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0394, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5825, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 311/946 (32.8753%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 324/946 (34.2495%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.4112, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0726, Accuracy: 151/603 (25.0415%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.4206, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0499, Accuracy: 341/590 (57.7966%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0293, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6119, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1007, Accuracy: 21/197 (10.6599%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0813, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.4017, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0741, Accuracy: 84/500 (16.8000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.1251, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 391/901 (43.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7784, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0624, Accuracy: 376/1163 (32.3302%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 438/1163 (37.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0142, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 744/1552 (47.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.4074, Accuracy: 89/10000 (0.8900%)
time spent on training: 210.47502899169922
[rfa agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 30, 43, 88, 69, 79, 82, 4, 68, 74], weight: tensor([0.1042, 0.0628, 0.1221, 0.0779, 0.0762, 0.0254, 0.0646, 0.1163, 0.1502,
        0.2004])
[rfa agg] iter:  0, prev_obj_val: 45.90741729736328, obj_val: 51.50722885131836, abs dis: 5.599811553955078
[rfa agg] iter: 0, weight: tensor([0.3047, 0.0307, 0.1997, 0.0593, 0.0582, 0.0072, 0.0316, 0.1885, 0.0730,
        0.0470])
[rfa agg] iter:  1, prev_obj_val: 51.50722885131836, obj_val: 55.01823425292969, abs dis: 3.511005401611328
[rfa agg] iter: 1, weight: tensor([0.2139, 0.0587, 0.1138, 0.1596, 0.1588, 0.0112, 0.0604, 0.1084, 0.0660,
        0.0491])
[rfa agg] iter:  2, prev_obj_val: 55.01823425292969, obj_val: 62.82262420654297, abs dis: 7.804389953613281
[rfa agg] iter: 2, weight: tensor([0.1006, 0.0613, 0.0669, 0.2720, 0.2845, 0.0097, 0.0631, 0.0637, 0.0438,
        0.0344])
[rfa agg] iter:  3, prev_obj_val: 62.82262420654297, obj_val: 65.93902587890625, abs dis: 3.1164016723632812
[rfa agg] iter: 3, weight: tensor([0.0721, 0.1589, 0.0569, 0.2014, 0.2011, 0.0142, 0.1642, 0.0541, 0.0421,
        0.0352])
[rfa agg] iter:  4, prev_obj_val: 65.93902587890625, obj_val: 69.2822494506836, abs dis: 3.3432235717773438
[rfa agg] iter: 4, weight: tensor([0.0593, 0.2485, 0.0486, 0.1292, 0.1278, 0.0145, 0.2574, 0.0462, 0.0370,
        0.0315])
[rfa agg] iter:  5, prev_obj_val: 69.2822494506836, obj_val: 69.27011108398438, abs dis: 0.01213836669921875
[rfa agg] iter: 5, weight: tensor([0.0414, 0.3309, 0.0349, 0.0761, 0.0750, 0.0126, 0.3448, 0.0332, 0.0274,
        0.0237])
[rfa agg] iter:  6, prev_obj_val: 69.27011108398438, obj_val: 77.37916564941406, abs dis: 8.109054565429688
[rfa agg] iter: 6, weight: tensor([0.0390, 0.3393, 0.0329, 0.0715, 0.0704, 0.0119, 0.3556, 0.0313, 0.0258,
        0.0223])
[rfa agg] iter:  7, prev_obj_val: 77.37916564941406, obj_val: 69.28706359863281, abs dis: 8.09210205078125
[rfa agg] iter: 7, weight: tensor([0.0689, 0.2372, 0.0609, 0.1024, 0.1005, 0.0331, 0.2447, 0.0579, 0.0499,
        0.0445])
[rfa agg] iter:  8, prev_obj_val: 69.28706359863281, obj_val: 65.93521118164062, abs dis: 3.3518524169921875
[rfa agg] iter: 8, weight: tensor([0.0420, 0.3319, 0.0354, 0.0770, 0.0760, 0.0128, 0.3395, 0.0337, 0.0277,
        0.0240])
[rfa agg] iter:  9, prev_obj_val: 65.93521118164062, obj_val: 65.92864227294922, abs dis: 0.00656890869140625
[rfa agg] iter: 9, weight: tensor([0.0573, 0.2586, 0.0470, 0.1233, 0.1222, 0.0141, 0.2667, 0.0446, 0.0358,
        0.0305])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.3331, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.3479051589966 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 640/1956 (32.7198%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3217, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 174/938 (18.5501%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 343/938 (36.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.7921, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0312, Accuracy: 398/776 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2907, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0648, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 408/773 (52.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8801, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 343/1154 (29.7227%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 458/1154 (39.6880%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7939, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0586, Accuracy: 253/1513 (16.7217%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 501/1513 (33.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2006, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 403/1036 (38.8996%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 676/1036 (65.2510%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0575, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 39/311 (12.5402%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.5656, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1245, Accuracy: 6/134 (4.4776%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1013, Accuracy: 33/134 (24.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3588, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 381/1475 (25.8305%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0298, Accuracy: 718/1475 (48.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2063, Accuracy: 90/10000 (0.9000%)
time spent on training: 245.2068498134613
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 73, 75, 99, 15, 8, 19, 96, 47, 65], weight: tensor([0.1943, 0.0932, 0.0771, 0.0768, 0.1146, 0.1503, 0.1029, 0.0309, 0.0133,
        0.1465])
[rfa agg] iter:  0, prev_obj_val: 55.039466857910156, obj_val: 57.43421173095703, abs dis: 2.394744873046875
[rfa agg] iter: 0, weight: tensor([0.0566, 0.0799, 0.0446, 0.0445, 0.3953, 0.1036, 0.1643, 0.0077, 0.0029,
        0.1005])
[rfa agg] iter:  1, prev_obj_val: 57.43421173095703, obj_val: 61.876251220703125, abs dis: 4.442039489746094
[rfa agg] iter: 1, weight: tensor([0.0481, 0.1176, 0.0563, 0.0560, 0.2318, 0.0765, 0.3280, 0.0083, 0.0031,
        0.0743])
[rfa agg] iter:  2, prev_obj_val: 61.876251220703125, obj_val: 63.74089813232422, abs dis: 1.8646469116210938
[rfa agg] iter: 2, weight: tensor([0.0434, 0.2469, 0.0832, 0.0827, 0.1228, 0.0626, 0.2847, 0.0094, 0.0034,
        0.0609])
[rfa agg] iter:  3, prev_obj_val: 63.74089813232422, obj_val: 68.27005767822266, abs dis: 4.5291595458984375
[rfa agg] iter: 3, weight: tensor([0.0394, 0.3592, 0.0926, 0.0917, 0.0988, 0.0553, 0.1968, 0.0092, 0.0033,
        0.0537])
[rfa agg] iter:  4, prev_obj_val: 68.27005767822266, obj_val: 68.25860595703125, abs dis: 0.01145172119140625
[rfa agg] iter: 4, weight: tensor([0.0359, 0.3840, 0.1396, 0.1362, 0.0757, 0.0480, 0.1204, 0.0099, 0.0035,
        0.0467])
			Update norm = 130.46656809552783 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.3331, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.67796635627747 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0681, Accuracy: 123/631 (19.4929%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.6721, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 378/1628 (23.2187%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 822/1628 (50.4914%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1097, Accuracy: 148/10000 (1.4800%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0636, Accuracy: 191/938 (20.3625%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7982, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 344/896 (38.3929%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.8970, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 263/774 (33.9793%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.9427, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0576, Accuracy: 345/715 (48.2517%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.9745, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0586, Accuracy: 209/735 (28.4354%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 336/735 (45.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.8473, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 349/1340 (26.0448%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 549/1340 (40.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6279, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0766, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.0102, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 457/1953 (23.3999%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 761/1953 (38.9657%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7883, Accuracy: 109/10000 (1.0900%)
time spent on training: 253.389484167099
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 5, 73, 89, 81, 23, 32, 77, 18, 83], weight: tensor([0.0622, 0.1606, 0.0925, 0.0884, 0.0763, 0.0705, 0.0725, 0.1321, 0.0523,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 63.07518005371094, obj_val: 67.72299194335938, abs dis: 4.6478118896484375
[rfa agg] iter: 0, weight: tensor([0.0418, 0.0649, 0.2987, 0.1639, 0.1003, 0.0703, 0.0724, 0.1056, 0.0302,
        0.0520])
[rfa agg] iter:  1, prev_obj_val: 67.72299194335938, obj_val: 75.16508483886719, abs dis: 7.4420928955078125
[rfa agg] iter: 1, weight: tensor([0.0481, 0.0295, 0.1064, 0.1663, 0.2784, 0.1335, 0.1417, 0.0393, 0.0310,
        0.0256])
[rfa agg] iter:  2, prev_obj_val: 75.16508483886719, obj_val: 81.84443664550781, abs dis: 6.679351806640625
[rfa agg] iter: 2, weight: tensor([0.0994, 0.0298, 0.0699, 0.0915, 0.1306, 0.2186, 0.2413, 0.0374, 0.0549,
        0.0266])
[rfa agg] iter:  3, prev_obj_val: 81.84443664550781, obj_val: 85.38821411132812, abs dis: 3.5437774658203125
[rfa agg] iter: 3, weight: tensor([0.2392, 0.0345, 0.0677, 0.0820, 0.0991, 0.1448, 0.1508, 0.0418, 0.1088,
        0.0313])
[rfa agg] iter:  4, prev_obj_val: 85.38821411132812, obj_val: 89.203369140625, abs dis: 3.815155029296875
[rfa agg] iter: 4, weight: tensor([0.3341, 0.0317, 0.0580, 0.0684, 0.0788, 0.1061, 0.1094, 0.0379, 0.1465,
        0.0290])
[rfa agg] iter:  5, prev_obj_val: 89.203369140625, obj_val: 89.19775390625, abs dis: 0.005615234375
[rfa agg] iter: 5, weight: tensor([0.2877, 0.0321, 0.0551, 0.0637, 0.0708, 0.0899, 0.0925, 0.0379, 0.2407,
        0.0296])
[rfa agg] iter:  6, prev_obj_val: 89.19775390625, obj_val: 89.19760131835938, abs dis: 0.000152587890625
[rfa agg] iter: 6, weight: tensor([0.2772, 0.0319, 0.0548, 0.0634, 0.0704, 0.0894, 0.0919, 0.0377, 0.2539,
        0.0294])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3277, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.2871, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.43087339401245 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0720, Accuracy: 116/486 (23.8683%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0394, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.6024, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.3968, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0556, Accuracy: 261/888 (29.3919%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.1299, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0531, Accuracy: 352/677 (51.9941%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0214, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2338, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0793, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0528, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.0984, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0778, Accuracy: 59/373 (15.8177%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0713, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.5186, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0673, Accuracy: 161/568 (28.3451%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.1754, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 402/1949 (20.6260%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 641/1949 (32.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2961, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 438/1036 (42.2780%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 673/1036 (64.9614%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.4693, Accuracy: 59/10000 (0.5900%)
time spent on training: 221.91210889816284
[rfa agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 16, 63, 90, 33, 98, 3, 62, 21, 19], weight: tensor([0.0609, 0.0887, 0.1113, 0.0848, 0.0645, 0.0467, 0.0979, 0.0712, 0.2442,
        0.1298])
[rfa agg] iter:  0, prev_obj_val: 60.136192321777344, obj_val: 61.78614807128906, abs dis: 1.6499557495117188
[rfa agg] iter: 0, weight: tensor([0.0272, 0.0988, 0.3591, 0.0696, 0.0340, 0.0160, 0.1704, 0.0376, 0.0431,
        0.1442])
[rfa agg] iter:  1, prev_obj_val: 61.78614807128906, obj_val: 69.91545867919922, abs dis: 8.129310607910156
[rfa agg] iter: 1, weight: tensor([0.0409, 0.2333, 0.1038, 0.2483, 0.0595, 0.0201, 0.1431, 0.0660, 0.0296,
        0.0555])
[rfa agg] iter:  2, prev_obj_val: 69.91545867919922, obj_val: 79.1729965209961, abs dis: 9.257537841796875
[rfa agg] iter: 2, weight: tensor([0.0950, 0.0846, 0.0600, 0.1323, 0.2106, 0.0325, 0.0674, 0.2475, 0.0278,
        0.0422])
[rfa agg] iter:  3, prev_obj_val: 79.1729965209961, obj_val: 83.01873016357422, abs dis: 3.845733642578125
[rfa agg] iter: 3, weight: tensor([0.3645, 0.0532, 0.0449, 0.0679, 0.1436, 0.0557, 0.0472, 0.1622, 0.0258,
        0.0350])
[rfa agg] iter:  4, prev_obj_val: 83.01873016357422, obj_val: 79.13465881347656, abs dis: 3.8840713500976562
[rfa agg] iter: 4, weight: tensor([0.3267, 0.0598, 0.0523, 0.0736, 0.1260, 0.0929, 0.0543, 0.1406, 0.0319,
        0.0419])
[rfa agg] iter:  5, prev_obj_val: 79.13465881347656, obj_val: 75.6372299194336, abs dis: 3.4974288940429688
[rfa agg] iter: 5, weight: tensor([0.4462, 0.0467, 0.0394, 0.0595, 0.1241, 0.0491, 0.0415, 0.1402, 0.0227,
        0.0307])
[rfa agg] iter:  6, prev_obj_val: 75.6372299194336, obj_val: 79.14774322509766, abs dis: 3.5105133056640625
[rfa agg] iter: 6, weight: tensor([0.2417, 0.0547, 0.0443, 0.0731, 0.2029, 0.0408, 0.0475, 0.2375, 0.0239,
        0.0336])
[rfa agg] iter:  7, prev_obj_val: 79.14774322509766, obj_val: 79.12889099121094, abs dis: 0.01885223388671875
[rfa agg] iter: 7, weight: tensor([0.4065, 0.0496, 0.0419, 0.0633, 0.1342, 0.0522, 0.0441, 0.1515, 0.0241,
        0.0327])
[rfa agg] iter:  8, prev_obj_val: 79.12889099121094, obj_val: 79.12605285644531, abs dis: 0.002838134765625
[rfa agg] iter: 8, weight: tensor([0.4732, 0.0444, 0.0375, 0.0566, 0.1181, 0.0467, 0.0395, 0.1333, 0.0216,
        0.0292])
[rfa agg] iter:  9, prev_obj_val: 79.12605285644531, obj_val: 87.03601837158203, abs dis: 7.909965515136719
[rfa agg] iter: 9, weight: tensor([0.5037, 0.0419, 0.0354, 0.0534, 0.1110, 0.0441, 0.0373, 0.1252, 0.0204,
        0.0276])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3306, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.2946, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.5648374557495 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 372/1446 (25.7261%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 526/1446 (36.3762%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4893, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 198/773 (25.6145%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0298, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1049, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0793, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.2770, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0488, Accuracy: 353/599 (58.9316%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0712, Accuracy: 131/781 (16.7734%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4217, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 168/818 (20.5379%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 360/818 (44.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.9970, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0642, Accuracy: 188/682 (27.5660%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1506, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0521, Accuracy: 359/712 (50.4213%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0247, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3925, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 429/803 (53.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.2726, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 403/1131 (35.6322%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5762, Accuracy: 53/10000 (0.5300%)
time spent on training: 221.00044345855713
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 99, 33, 95, 3, 71, 80, 11, 58, 87], weight: tensor([0.1751, 0.0936, 0.0623, 0.0725, 0.0946, 0.0990, 0.0826, 0.0862, 0.0972,
        0.1369])
[rfa agg] iter:  0, prev_obj_val: 31.643014907836914, obj_val: 40.976043701171875, abs dis: 9.333028793334961
[rfa agg] iter: 0, weight: tensor([0.0236, 0.1496, 0.0248, 0.0399, 0.1682, 0.1642, 0.0723, 0.1500, 0.1725,
        0.0349])
[rfa agg] iter:  1, prev_obj_val: 40.976043701171875, obj_val: 47.962684631347656, abs dis: 6.986640930175781
[rfa agg] iter: 1, weight: tensor([0.0296, 0.0763, 0.0802, 0.1994, 0.0782, 0.0814, 0.2231, 0.1130, 0.0804,
        0.0384])
[rfa agg] iter:  2, prev_obj_val: 47.962684631347656, obj_val: 56.152584075927734, abs dis: 8.189899444580078
[rfa agg] iter: 2, weight: tensor([0.0320, 0.0647, 0.1931, 0.2561, 0.0659, 0.0687, 0.1291, 0.0829, 0.0678,
        0.0396])
[rfa agg] iter:  3, prev_obj_val: 56.152584075927734, obj_val: 56.14347839355469, abs dis: 0.009105682373046875
[rfa agg] iter: 3, weight: tensor([0.0404, 0.0687, 0.2835, 0.1554, 0.0698, 0.0729, 0.1079, 0.0814, 0.0718,
        0.0481])
[rfa agg] iter:  4, prev_obj_val: 56.14347839355469, obj_val: 56.14336395263672, abs dis: 0.00011444091796875
[rfa agg] iter: 4, weight: tensor([0.0398, 0.0677, 0.2963, 0.1512, 0.0687, 0.0718, 0.1061, 0.0802, 0.0707,
        0.0474])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3340, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.3092, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.8446033000946 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0583, Accuracy: 262/1513 (17.3166%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 471/1513 (31.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8871, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 417/1129 (36.9353%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 746/1129 (66.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5111, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0650, Accuracy: 195/773 (25.2264%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.4355, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0658, Accuracy: 166/568 (29.2254%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0393, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.3074, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0768, Accuracy: 56/440 (12.7273%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0460, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.1197, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 337/946 (35.6237%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.4188, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 344/1657 (20.7604%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 533/1657 (32.1666%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0137, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0514, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0270, Accuracy: 617/1030 (59.9029%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3657, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0529, Accuracy: 432/1715 (25.1895%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9862, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0547, Accuracy: 299/636 (47.0126%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6496, Accuracy: 50/10000 (0.5000%)
time spent on training: 243.61799883842468
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 37, 99, 62, 49, 43, 0, 91, 92, 52], weight: tensor([0.1454, 0.1085, 0.0743, 0.0546, 0.0423, 0.0909, 0.1592, 0.0990, 0.1648,
        0.0611])
[rfa agg] iter:  0, prev_obj_val: 57.66710662841797, obj_val: 60.95606231689453, abs dis: 3.2889556884765625
[rfa agg] iter: 0, weight: tensor([0.0627, 0.1733, 0.0835, 0.0270, 0.0163, 0.2526, 0.0550, 0.2427, 0.0518,
        0.0351])
[rfa agg] iter:  1, prev_obj_val: 60.95606231689453, obj_val: 67.74186706542969, abs dis: 6.785804748535156
[rfa agg] iter: 1, weight: tensor([0.0500, 0.1086, 0.1092, 0.0281, 0.0164, 0.4213, 0.0448, 0.1414, 0.0426,
        0.0376])
[rfa agg] iter:  2, prev_obj_val: 67.74186706542969, obj_val: 67.69029998779297, abs dis: 0.05156707763671875
[rfa agg] iter: 2, weight: tensor([0.0505, 0.0867, 0.3305, 0.0440, 0.0238, 0.2114, 0.0465, 0.0996, 0.0446,
        0.0623])
[rfa agg] iter:  3, prev_obj_val: 67.69029998779297, obj_val: 70.22575378417969, abs dis: 2.5354537963867188
[rfa agg] iter: 3, weight: tensor([0.0480, 0.0824, 0.3692, 0.0418, 0.0226, 0.1954, 0.0442, 0.0947, 0.0424,
        0.0593])
[rfa agg] iter:  4, prev_obj_val: 70.22575378417969, obj_val: 79.13086700439453, abs dis: 8.905113220214844
[rfa agg] iter: 4, weight: tensor([0.0403, 0.0655, 0.4913, 0.0413, 0.0215, 0.1330, 0.0374, 0.0735, 0.0360,
        0.0603])
[rfa agg] iter:  5, prev_obj_val: 79.13086700439453, obj_val: 79.08512878417969, abs dis: 0.04573822021484375
[rfa agg] iter: 5, weight: tensor([0.0560, 0.0799, 0.2323, 0.1017, 0.0450, 0.1233, 0.0529, 0.0855, 0.0513,
        0.1721])
[rfa agg] iter:  6, prev_obj_val: 79.08512878417969, obj_val: 82.14635467529297, abs dis: 3.0612258911132812
[rfa agg] iter: 6, weight: tensor([0.0561, 0.0800, 0.2235, 0.1029, 0.0452, 0.1233, 0.0530, 0.0856, 0.0513,
        0.1792])
[rfa agg] iter:  7, prev_obj_val: 82.14635467529297, obj_val: 79.08943939208984, abs dis: 3.056915283203125
[rfa agg] iter: 7, weight: tensor([0.0534, 0.0736, 0.1706, 0.1255, 0.0502, 0.1072, 0.0507, 0.0779, 0.0492,
        0.2418])
[rfa agg] iter:  8, prev_obj_val: 79.08943939208984, obj_val: 82.14595031738281, abs dis: 3.0565109252929688
[rfa agg] iter: 8, weight: tensor([0.0561, 0.0800, 0.2205, 0.1031, 0.0452, 0.1232, 0.0530, 0.0856, 0.0513,
        0.1822])
[rfa agg] iter:  9, prev_obj_val: 82.14595031738281, obj_val: 79.08946228027344, abs dis: 3.056488037109375
[rfa agg] iter: 9, weight: tensor([0.0533, 0.0736, 0.1705, 0.1255, 0.0502, 0.1072, 0.0507, 0.0779, 0.0492,
        0.2421])
			Update norm = 103.39775010396744 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3340, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.3092, Accuracy: 0/9950 (0.0000%)
saving model
Done in 338.1416370868683 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0568, Accuracy: 309/1131 (27.3210%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 441/1131 (38.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.1051, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9509, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0644, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 327/938 (34.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2937, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2154, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0702, Accuracy: 129/781 (16.5173%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.3794, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 509/1130 (45.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.8292, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0637, Accuracy: 180/682 (26.3930%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0369, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.1014, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0521, Accuracy: 368/712 (51.6854%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 413/712 (58.0056%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6133, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 354/807 (43.8662%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0155, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0555, Accuracy: 261/888 (29.3919%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3932, Accuracy: 55/10000 (0.5500%)
time spent on training: 220.95601105690002
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 64, 73, 84, 3, 54, 80, 11, 20, 63], weight: tensor([0.1228, 0.1035, 0.1018, 0.1292, 0.0848, 0.1227, 0.0740, 0.0773, 0.0876,
        0.0964])
[rfa agg] iter:  0, prev_obj_val: 26.45100212097168, obj_val: 39.37689971923828, abs dis: 12.925897598266602
[rfa agg] iter: 0, weight: tensor([0.0416, 0.0841, 0.0809, 0.0361, 0.2255, 0.0413, 0.0610, 0.1097, 0.1834,
        0.1365])
[rfa agg] iter:  1, prev_obj_val: 39.37689971923828, obj_val: 43.48797607421875, abs dis: 4.111076354980469
[rfa agg] iter: 1, weight: tensor([0.0421, 0.0617, 0.0603, 0.0386, 0.0992, 0.0420, 0.3224, 0.1580, 0.0998,
        0.0759])
[rfa agg] iter:  2, prev_obj_val: 43.48797607421875, obj_val: 43.487483978271484, abs dis: 0.000492095947265625
[rfa agg] iter: 2, weight: tensor([0.0463, 0.0646, 0.0632, 0.0427, 0.0937, 0.0461, 0.3346, 0.1374, 0.0948,
        0.0767])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3375, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.2730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.099107503891 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 343/901 (38.0688%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 391/901 (43.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1041, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 169/818 (20.6601%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 325/818 (39.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8462, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 380/1275 (29.8039%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 714/1275 (56.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.4909, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 467/1130 (41.3274%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5035, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0734, Accuracy: 84/500 (16.8000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0470, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.4037, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 261/1131 (23.0769%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 504/1131 (44.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1893, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 295/708 (41.6667%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0359, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.3099, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 376/1131 (33.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8780, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0517, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 636/1030 (61.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2447, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 390/1427 (27.3301%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.4633, Accuracy: 81/10000 (0.8100%)
time spent on training: 263.2261459827423
[rfa agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 71, 9, 54, 82, 38, 16, 87, 91, 34], weight: tensor([0.0896, 0.0814, 0.1269, 0.1124, 0.0497, 0.1125, 0.0704, 0.1125, 0.1025,
        0.1420])
[rfa agg] iter:  0, prev_obj_val: 32.606998443603516, obj_val: 34.5914421081543, abs dis: 1.9844436645507812
[rfa agg] iter: 0, weight: tensor([0.2430, 0.0822, 0.0725, 0.1104, 0.0173, 0.1112, 0.0516, 0.1129, 0.1498,
        0.0491])
[rfa agg] iter:  1, prev_obj_val: 34.5914421081543, obj_val: 36.916351318359375, abs dis: 2.324909210205078
[rfa agg] iter: 1, weight: tensor([0.3211, 0.0984, 0.0639, 0.0915, 0.0181, 0.0920, 0.0584, 0.0930, 0.1185,
        0.0451])
[rfa agg] iter:  2, prev_obj_val: 36.916351318359375, obj_val: 36.914100646972656, abs dis: 0.00225067138671875
[rfa agg] iter: 2, weight: tensor([0.3030, 0.1350, 0.0623, 0.0847, 0.0208, 0.0851, 0.0740, 0.0858, 0.1041,
        0.0454])
[rfa agg] iter:  3, prev_obj_val: 36.914100646972656, obj_val: 39.46070098876953, abs dis: 2.546600341796875
[rfa agg] iter: 3, weight: tensor([0.2999, 0.1365, 0.0624, 0.0849, 0.0209, 0.0853, 0.0744, 0.0860, 0.1043,
        0.0455])
[rfa agg] iter:  4, prev_obj_val: 39.46070098876953, obj_val: 44.96263885498047, abs dis: 5.5019378662109375
[rfa agg] iter: 4, weight: tensor([0.2232, 0.2032, 0.0622, 0.0813, 0.0245, 0.0816, 0.0989, 0.0821, 0.0963,
        0.0466])
[rfa agg] iter:  5, prev_obj_val: 44.96263885498047, obj_val: 48.106658935546875, abs dis: 3.1440200805664062
[rfa agg] iter: 5, weight: tensor([0.1123, 0.3749, 0.0479, 0.0589, 0.0263, 0.0590, 0.1574, 0.0593, 0.0663,
        0.0377])
[rfa agg] iter:  6, prev_obj_val: 48.106658935546875, obj_val: 59.273841857910156, abs dis: 11.167182922363281
[rfa agg] iter: 6, weight: tensor([0.0914, 0.3300, 0.0452, 0.0541, 0.0295, 0.0542, 0.2452, 0.0545, 0.0597,
        0.0362])
[rfa agg] iter:  7, prev_obj_val: 59.273841857910156, obj_val: 48.11273193359375, abs dis: 11.161109924316406
[rfa agg] iter: 7, weight: tensor([0.0949, 0.1719, 0.0608, 0.0690, 0.0705, 0.0691, 0.2704, 0.0693, 0.0730,
        0.0511])
[rfa agg] iter:  8, prev_obj_val: 48.11273193359375, obj_val: 55.34461212158203, abs dis: 7.231880187988281
[rfa agg] iter: 8, weight: tensor([0.0931, 0.2948, 0.0460, 0.0552, 0.0301, 0.0553, 0.2721, 0.0556, 0.0610,
        0.0369])
[rfa agg] iter:  9, prev_obj_val: 55.34461212158203, obj_val: 48.11107635498047, abs dis: 7.2335357666015625
[rfa agg] iter: 9, weight: tensor([0.0868, 0.1801, 0.0518, 0.0597, 0.0489, 0.0598, 0.3459, 0.0600, 0.0640,
        0.0429])
			Update norm = 112.21106559598968 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3375, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.2730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.36769366264343 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 583/2227 (26.1787%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1025/2227 (46.0260%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6455, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0590, Accuracy: 300/708 (42.3729%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.5018, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0758, Accuracy: 75/373 (20.1072%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0458, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0677, Accuracy: 138/486 (28.3951%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.7139, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0762, Accuracy: 64/440 (14.5455%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0460, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.1618, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0716, Accuracy: 157/603 (26.0365%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.8880, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 341/1418 (24.0480%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 604/1418 (42.5952%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4738, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0534, Accuracy: 311/1089 (28.5583%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 458/1089 (42.0569%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6122, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 391/1742 (22.4455%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2411, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1587 (26.5911%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 599/1587 (37.7442%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7646, Accuracy: 55/10000 (0.5500%)
time spent on training: 257.6020030975342
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 16, 98, 30, 49, 88, 70, 59, 93, 27], weight: tensor([0.2087, 0.0663, 0.0349, 0.0455, 0.0412, 0.0565, 0.1329, 0.1020, 0.1632,
        0.1487])
[rfa agg] iter:  0, prev_obj_val: 74.87971496582031, obj_val: 76.203369140625, abs dis: 1.3236541748046875
[rfa agg] iter: 0, weight: tensor([0.0806, 0.0437, 0.0135, 0.0204, 0.0171, 0.0302, 0.2795, 0.2114, 0.1214,
        0.1821])
[rfa agg] iter:  1, prev_obj_val: 76.203369140625, obj_val: 76.19904327392578, abs dis: 0.00432586669921875
[rfa agg] iter: 1, weight: tensor([0.0790, 0.0470, 0.0142, 0.0216, 0.0180, 0.0321, 0.2434, 0.2622, 0.1155,
        0.1670])
			Update norm = 179.17489927791226 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3375, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.2730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.40887808799744 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0567, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0350, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.8585, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1189, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1058, Accuracy: 37/134 (27.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3746, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5243, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 351/1213 (28.9365%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 520/1213 (42.8689%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4529, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0878, Accuracy: 29/271 (10.7011%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0565, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6615, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0574, Accuracy: 315/690 (45.6522%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.4464, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0711, Accuracy: 155/603 (25.7048%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.9993, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0748, Accuracy: 127/530 (23.9623%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0370, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.1767, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0539, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 647/1030 (62.8155%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9262, Accuracy: 106/10000 (1.0600%)
time spent on training: 207.17362236976624
[rfa agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 63, 47, 75, 97, 35, 25, 88, 18, 91], weight: tensor([0.2127, 0.1140, 0.0172, 0.0996, 0.1557, 0.0348, 0.0886, 0.0774, 0.0680,
        0.1322])
[rfa agg] iter:  0, prev_obj_val: 48.311180114746094, obj_val: 53.544532775878906, abs dis: 5.2333526611328125
[rfa agg] iter: 0, weight: tensor([0.0457, 0.3842, 0.0040, 0.2088, 0.0795, 0.0100, 0.0748, 0.0494, 0.0349,
        0.1087])
[rfa agg] iter:  1, prev_obj_val: 53.544532775878906, obj_val: 55.39729309082031, abs dis: 1.8527603149414062
[rfa agg] iter: 1, weight: tensor([0.0441, 0.1602, 0.0055, 0.2407, 0.0643, 0.0144, 0.2232, 0.1072, 0.0649,
        0.0755])
[rfa agg] iter:  2, prev_obj_val: 55.39729309082031, obj_val: 55.382545471191406, abs dis: 0.01474761962890625
[rfa agg] iter: 2, weight: tensor([0.0388, 0.1164, 0.0054, 0.1644, 0.0547, 0.0142, 0.3441, 0.1287, 0.0706,
        0.0627])
[rfa agg] iter:  3, prev_obj_val: 55.382545471191406, obj_val: 57.471046447753906, abs dis: 2.0885009765625
[rfa agg] iter: 3, weight: tensor([0.0378, 0.1131, 0.0052, 0.1582, 0.0533, 0.0138, 0.3627, 0.1259, 0.0688,
        0.0611])
[rfa agg] iter:  4, prev_obj_val: 57.471046447753906, obj_val: 62.89618682861328, abs dis: 5.425140380859375
[rfa agg] iter: 4, weight: tensor([0.0291, 0.0760, 0.0044, 0.0978, 0.0399, 0.0119, 0.4875, 0.1410, 0.0677,
        0.0447])
[rfa agg] iter:  5, prev_obj_val: 62.89618682861328, obj_val: 66.04013061523438, abs dis: 3.1439437866210938
[rfa agg] iter: 5, weight: tensor([0.0324, 0.0684, 0.0060, 0.0791, 0.0421, 0.0169, 0.2075, 0.3569, 0.1451,
        0.0456])
[rfa agg] iter:  6, prev_obj_val: 66.04013061523438, obj_val: 69.51012420654297, abs dis: 3.4699935913085938
[rfa agg] iter: 6, weight: tensor([0.0334, 0.0647, 0.0068, 0.0725, 0.0423, 0.0199, 0.1463, 0.3180, 0.2508,
        0.0453])
[rfa agg] iter:  7, prev_obj_val: 69.51012420654297, obj_val: 73.29275512695312, abs dis: 3.7826309204101562
[rfa agg] iter: 7, weight: tensor([0.0332, 0.0600, 0.0076, 0.0654, 0.0413, 0.0230, 0.1143, 0.1904, 0.4212,
        0.0436])
[rfa agg] iter:  8, prev_obj_val: 73.29275512695312, obj_val: 73.29171752929688, abs dis: 0.00103759765625
[rfa agg] iter: 8, weight: tensor([0.0411, 0.0695, 0.0105, 0.0740, 0.0500, 0.0333, 0.1172, 0.1655, 0.3867,
        0.0522])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3390, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.2898, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.7650604248047 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0495, Accuracy: 352/590 (59.6610%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0302, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1647, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0770, Accuracy: 77/515 (14.9515%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0501, Accuracy: 135/515 (26.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.4196, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 310/1013 (30.6022%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4003, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0484, Accuracy: 371/599 (61.9366%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 352/1662 (21.1793%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0263, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.0783, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0416, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.9759, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0553, Accuracy: 296/636 (46.5409%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0554, Accuracy: 426/1988 (21.4286%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 668/1988 (33.6016%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2125, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0702, Accuracy: 149/530 (28.1132%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0359, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.2949, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0588, Accuracy: 241/1049 (22.9743%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 508/1049 (48.4271%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9776, Accuracy: 93/10000 (0.9300%)
time spent on training: 227.73257660865784
[rfa agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 33, 14, 95, 94, 24, 52, 85, 18, 51], weight: tensor([0.0663, 0.0579, 0.1139, 0.0673, 0.1869, 0.0351, 0.0715, 0.2235, 0.0596,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 72.9017105102539, obj_val: 75.98094177246094, abs dis: 3.0792312622070312
[rfa agg] iter: 0, weight: tensor([0.0344, 0.0265, 0.2620, 0.0349, 0.0855, 0.0109, 0.0371, 0.0601, 0.0273,
        0.4213])
[rfa agg] iter:  1, prev_obj_val: 75.98094177246094, obj_val: 79.67770385742188, abs dis: 3.6967620849609375
[rfa agg] iter: 1, weight: tensor([0.0685, 0.0490, 0.3202, 0.0694, 0.0762, 0.0173, 0.0737, 0.0600, 0.0506,
        0.2151])
[rfa agg] iter:  2, prev_obj_val: 79.67770385742188, obj_val: 80.93596649169922, abs dis: 1.2582626342773438
[rfa agg] iter: 2, weight: tensor([0.1127, 0.0742, 0.1936, 0.1141, 0.0745, 0.0227, 0.1206, 0.0610, 0.0766,
        0.1498])
[rfa agg] iter:  3, prev_obj_val: 80.93596649169922, obj_val: 83.53131866455078, abs dis: 2.5953521728515625
[rfa agg] iter: 3, weight: tensor([0.1293, 0.0813, 0.1594, 0.1308, 0.0688, 0.0233, 0.1381, 0.0570, 0.0839,
        0.1280])
[rfa agg] iter:  4, prev_obj_val: 83.53131866455078, obj_val: 88.19061279296875, abs dis: 4.659294128417969
[rfa agg] iter: 4, weight: tensor([0.1679, 0.0906, 0.1005, 0.1689, 0.0516, 0.0216, 0.1765, 0.0437, 0.0938,
        0.0849])
[rfa agg] iter:  5, prev_obj_val: 88.19061279296875, obj_val: 90.81475067138672, abs dis: 2.6241378784179688
[rfa agg] iter: 5, weight: tensor([0.2501, 0.0913, 0.0340, 0.2326, 0.0211, 0.0126, 0.2130, 0.0183, 0.0967,
        0.0301])
[rfa agg] iter:  6, prev_obj_val: 90.81475067138672, obj_val: 97.80233001708984, abs dis: 6.987579345703125
[rfa agg] iter: 6, weight: tensor([0.1967, 0.1504, 0.0338, 0.1896, 0.0220, 0.0151, 0.1764, 0.0193, 0.1665,
        0.0303])
[rfa agg] iter:  7, prev_obj_val: 97.80233001708984, obj_val: 94.00811004638672, abs dis: 3.794219970703125
[rfa agg] iter: 7, weight: tensor([0.1182, 0.2254, 0.0422, 0.1191, 0.0298, 0.0278, 0.1231, 0.0265, 0.2493,
        0.0385])
[rfa agg] iter:  8, prev_obj_val: 94.00811004638672, obj_val: 94.0057601928711, abs dis: 0.002349853515625
[rfa agg] iter: 8, weight: tensor([0.1156, 0.2427, 0.0316, 0.1160, 0.0214, 0.0171, 0.1179, 0.0190, 0.2902,
        0.0286])
[rfa agg] iter:  9, prev_obj_val: 94.0057601928711, obj_val: 97.7907943725586, abs dis: 3.7850341796875
[rfa agg] iter: 9, weight: tensor([0.1134, 0.2422, 0.0310, 0.1139, 0.0211, 0.0168, 0.1154, 0.0186, 0.2996,
        0.0281])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3420, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.3066, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.63782477378845 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 346/896 (38.6161%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0326, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8248, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 402/1904 (21.1134%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 687/1904 (36.0819%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2321, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0611, Accuracy: 152/809 (18.7886%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 349/809 (43.1397%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.4134, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0536, Accuracy: 343/677 (50.6647%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0212, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4579, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 365/1003 (36.3908%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0838, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.5626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0638, Accuracy: 185/938 (19.7228%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 343/938 (36.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2584, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 609/2227 (27.3462%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1021/2227 (45.8464%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6991, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0798, Accuracy: 38/311 (12.2186%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 254/776 (32.7320%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5250, Accuracy: 60/10000 (0.6000%)
time spent on training: 247.69044661521912
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 46, 50, 90, 86, 76, 73, 60, 96, 75], weight: tensor([0.0895, 0.1903, 0.0808, 0.0677, 0.1002, 0.0466, 0.0937, 0.2225, 0.0311,
        0.0775])
[rfa agg] iter:  0, prev_obj_val: 82.86592102050781, obj_val: 78.85405731201172, abs dis: 4.011863708496094
[rfa agg] iter: 0, weight: tensor([0.1218, 0.1186, 0.0921, 0.0581, 0.2231, 0.0291, 0.1582, 0.0956, 0.0153,
        0.0883])
[rfa agg] iter:  1, prev_obj_val: 78.85405731201172, obj_val: 81.21686553955078, abs dis: 2.3628082275390625
[rfa agg] iter: 1, weight: tensor([0.1105, 0.0352, 0.0682, 0.0350, 0.4327, 0.0151, 0.2004, 0.0304, 0.0073,
        0.0653])
[rfa agg] iter:  2, prev_obj_val: 81.21686553955078, obj_val: 87.5011215209961, abs dis: 6.2842559814453125
[rfa agg] iter: 2, weight: tensor([0.3105, 0.0266, 0.1437, 0.0496, 0.1096, 0.0173, 0.1734, 0.0237, 0.0077,
        0.1379])
[rfa agg] iter:  3, prev_obj_val: 87.5011215209961, obj_val: 90.42063903808594, abs dis: 2.9195175170898438
[rfa agg] iter: 3, weight: tensor([0.1469, 0.0282, 0.2509, 0.1102, 0.0731, 0.0267, 0.0944, 0.0257, 0.0107,
        0.2332])
[rfa agg] iter:  4, prev_obj_val: 90.42063903808594, obj_val: 90.41693878173828, abs dis: 0.00370025634765625
[rfa agg] iter: 4, weight: tensor([0.1282, 0.0318, 0.2122, 0.1843, 0.0744, 0.0348, 0.0918, 0.0292, 0.0134,
        0.2000])
			Update norm = 107.64306432313695 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3420, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.3066, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.68203926086426 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0593, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0293, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.5200, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0526, Accuracy: 338/1030 (32.8155%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 651/1030 (63.2039%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.0019, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0679, Accuracy: 163/530 (30.7547%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2256, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 344/715 (48.1119%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.2495, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0769, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0463, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.0834, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0476, Accuracy: 374/599 (62.4374%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.3280, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 602/2227 (27.0319%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1026/2227 (46.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3489, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 349/896 (38.9509%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.6020, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 295/813 (36.2854%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 444/813 (54.6125%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.7516, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 335/1013 (33.0701%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8171, Accuracy: 85/10000 (0.8500%)
time spent on training: 234.5297429561615
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 91, 18, 23, 49, 95, 60, 89, 53, 14], weight: tensor([0.1164, 0.1101, 0.0567, 0.0765, 0.0470, 0.0641, 0.2381, 0.0958, 0.0869,
        0.1083])
[rfa agg] iter:  0, prev_obj_val: 63.47247314453125, obj_val: 65.4716567993164, abs dis: 1.9991836547851562
[rfa agg] iter: 0, weight: tensor([0.1458, 0.2521, 0.0198, 0.0439, 0.0130, 0.0258, 0.0338, 0.0954, 0.0636,
        0.3066])
[rfa agg] iter:  1, prev_obj_val: 65.4716567993164, obj_val: 70.26776885986328, abs dis: 4.796112060546875
[rfa agg] iter: 1, weight: tensor([0.0739, 0.0948, 0.0303, 0.0946, 0.0181, 0.0425, 0.0305, 0.2939, 0.1817,
        0.1398])
[rfa agg] iter:  2, prev_obj_val: 70.26776885986328, obj_val: 78.10753631591797, abs dis: 7.8397674560546875
[rfa agg] iter: 2, weight: tensor([0.0537, 0.0626, 0.0421, 0.2073, 0.0225, 0.0659, 0.0278, 0.1562, 0.2818,
        0.0800])
[rfa agg] iter:  3, prev_obj_val: 78.10753631591797, obj_val: 81.02655792236328, abs dis: 2.9190216064453125
[rfa agg] iter: 3, weight: tensor([0.0551, 0.0612, 0.0925, 0.2087, 0.0396, 0.1895, 0.0336, 0.1055, 0.1417,
        0.0727])
[rfa agg] iter:  4, prev_obj_val: 81.02655792236328, obj_val: 84.0937728881836, abs dis: 3.0672149658203125
[rfa agg] iter: 4, weight: tensor([0.0495, 0.0544, 0.1163, 0.1501, 0.0435, 0.2942, 0.0316, 0.0874, 0.1094,
        0.0636])
[rfa agg] iter:  5, prev_obj_val: 84.0937728881836, obj_val: 87.4760513305664, abs dis: 3.3822784423828125
[rfa agg] iter: 5, weight: tensor([0.0397, 0.0432, 0.1407, 0.0993, 0.0432, 0.4133, 0.0264, 0.0657, 0.0786,
        0.0498])
[rfa agg] iter:  6, prev_obj_val: 87.4760513305664, obj_val: 91.07112121582031, abs dis: 3.5950698852539062
[rfa agg] iter: 6, weight: tensor([0.0406, 0.0438, 0.2414, 0.0876, 0.0561, 0.3156, 0.0281, 0.0635, 0.0735,
        0.0499])
[rfa agg] iter:  7, prev_obj_val: 91.07112121582031, obj_val: 94.92865753173828, abs dis: 3.8575363159179688
[rfa agg] iter: 7, weight: tensor([0.0388, 0.0415, 0.3962, 0.0749, 0.0704, 0.1805, 0.0278, 0.0578, 0.0652,
        0.0468])
[rfa agg] iter:  8, prev_obj_val: 94.92865753173828, obj_val: 94.92720031738281, abs dis: 0.00145721435546875
[rfa agg] iter: 8, weight: tensor([0.0447, 0.0474, 0.3464, 0.0786, 0.1125, 0.1498, 0.0332, 0.0638, 0.0705,
        0.0531])
[rfa agg] iter:  9, prev_obj_val: 94.92720031738281, obj_val: 91.05321502685547, abs dis: 3.8739852905273438
[rfa agg] iter: 9, weight: tensor([0.0450, 0.0478, 0.3414, 0.0793, 0.1136, 0.1506, 0.0334, 0.0643, 0.0711,
        0.0535])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3440, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.3090, Accuracy: 0/9950 (0.0000%)
saving model
Done in 329.62299847602844 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0584, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 367/803 (45.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.6000, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0734, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4218, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.0836, Accuracy: 67/408 (16.4216%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0506, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.0583, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1045, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0850, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3937, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 605/2227 (27.1666%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1040/2227 (46.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4343, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0551, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0314, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4388, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 394/1904 (20.6933%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 660/1904 (34.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.0220, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0616, Accuracy: 207/682 (30.3519%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0360, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2171, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.0869, Accuracy: 34/338 (10.0592%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 160/338 (47.3373%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.1032, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0680, Accuracy: 144/486 (29.6296%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0377, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.0613, Accuracy: 56/10000 (0.5600%)
time spent on training: 228.69821763038635
[rfa agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 82, 36, 79, 60, 20, 46, 80, 12, 30], weight: tensor([0.0961, 0.0599, 0.0489, 0.0236, 0.2666, 0.0966, 0.2280, 0.0817, 0.0405,
        0.0582])
[rfa agg] iter:  0, prev_obj_val: 101.70928955078125, obj_val: 101.53589630126953, abs dis: 0.17339324951171875
[rfa agg] iter: 0, weight: tensor([0.1802, 0.0566, 0.0420, 0.0160, 0.1484, 0.1802, 0.1796, 0.1101, 0.0319,
        0.0550])
[rfa agg] iter:  1, prev_obj_val: 101.53589630126953, obj_val: 103.43040466308594, abs dis: 1.8945083618164062
[rfa agg] iter: 1, weight: tensor([0.2707, 0.0506, 0.0361, 0.0127, 0.0789, 0.2655, 0.0899, 0.1198, 0.0266,
        0.0491])
[rfa agg] iter:  2, prev_obj_val: 103.43040466308594, obj_val: 104.91604614257812, abs dis: 1.4856414794921875
[rfa agg] iter: 2, weight: tensor([0.3490, 0.0375, 0.0251, 0.0079, 0.0336, 0.3118, 0.0369, 0.1443, 0.0176,
        0.0364])
[rfa agg] iter:  3, prev_obj_val: 104.91604614257812, obj_val: 108.39120483398438, abs dis: 3.47515869140625
[rfa agg] iter: 3, weight: tensor([0.2729, 0.0484, 0.0317, 0.0096, 0.0378, 0.2588, 0.0413, 0.2306, 0.0219,
        0.0470])
[rfa agg] iter:  4, prev_obj_val: 108.39120483398438, obj_val: 112.87454223632812, abs dis: 4.48333740234375
[rfa agg] iter: 4, weight: tensor([0.1363, 0.0583, 0.0358, 0.0099, 0.0328, 0.1344, 0.0354, 0.4768, 0.0238,
        0.0564])
[rfa agg] iter:  5, prev_obj_val: 112.87454223632812, obj_val: 117.66101837158203, abs dis: 4.786476135253906
[rfa agg] iter: 5, weight: tensor([0.1255, 0.1167, 0.0645, 0.0157, 0.0428, 0.1247, 0.0457, 0.3115, 0.0403,
        0.1126])
[rfa agg] iter:  6, prev_obj_val: 117.66101837158203, obj_val: 117.64378356933594, abs dis: 0.01723480224609375
[rfa agg] iter: 6, weight: tensor([0.0920, 0.2137, 0.0923, 0.0182, 0.0397, 0.0918, 0.0420, 0.1549, 0.0518,
        0.2035])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3471, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.3055, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.9586296081543 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0539, Accuracy: 334/1372 (24.3440%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 501/1372 (36.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3345, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0783, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0581, Accuracy: 214/735 (29.1156%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.8853, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0589, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 537/928 (57.8664%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8342, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0887, Accuracy: 21/271 (7.7491%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 116/271 (42.8044%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.8155, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3950, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0586, Accuracy: 381/1750 (21.7714%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 669/1750 (38.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8289, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 503/1552 (32.4098%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.7638, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 430/1742 (24.6843%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 724/1742 (41.5614%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6855, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0822, Accuracy: 62/416 (14.9038%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.3937, Accuracy: 52/10000 (0.5200%)
time spent on training: 265.534095287323
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 64, 32, 1, 35, 56, 44, 74, 93, 78], weight: tensor([0.1385, 0.0962, 0.0742, 0.0937, 0.0274, 0.0188, 0.1767, 0.1567, 0.1759,
        0.0420])
[rfa agg] iter:  0, prev_obj_val: 65.78236389160156, obj_val: 67.09224700927734, abs dis: 1.3098831176757812
[rfa agg] iter: 0, weight: tensor([0.1962, 0.1825, 0.0716, 0.1738, 0.0123, 0.0073, 0.1027, 0.1294, 0.1021,
        0.0222])
[rfa agg] iter:  1, prev_obj_val: 67.09224700927734, obj_val: 68.43452453613281, abs dis: 1.3422775268554688
[rfa agg] iter: 1, weight: tensor([0.1697, 0.2098, 0.0752, 0.1990, 0.0123, 0.0073, 0.0942, 0.1164, 0.0937,
        0.0224])
[rfa agg] iter:  2, prev_obj_val: 68.43452453613281, obj_val: 69.80013275146484, abs dis: 1.3656082153320312
[rfa agg] iter: 2, weight: tensor([0.1432, 0.2418, 0.0772, 0.2270, 0.0120, 0.0070, 0.0841, 0.1021, 0.0837,
        0.0220])
[rfa agg] iter:  3, prev_obj_val: 69.80013275146484, obj_val: 69.79766845703125, abs dis: 0.00246429443359375
[rfa agg] iter: 3, weight: tensor([0.1167, 0.2803, 0.0766, 0.2583, 0.0112, 0.0065, 0.0720, 0.0860, 0.0716,
        0.0207])
[rfa agg] iter:  4, prev_obj_val: 69.79766845703125, obj_val: 71.21113586425781, abs dis: 1.4134674072265625
[rfa agg] iter: 4, weight: tensor([0.1162, 0.2805, 0.0764, 0.2597, 0.0111, 0.0065, 0.0718, 0.0858, 0.0714,
        0.0207])
[rfa agg] iter:  5, prev_obj_val: 71.21113586425781, obj_val: 74.60970306396484, abs dis: 3.3985671997070312
[rfa agg] iter: 5, weight: tensor([0.0899, 0.3287, 0.0721, 0.2916, 0.0098, 0.0057, 0.0579, 0.0682, 0.0576,
        0.0184])
[rfa agg] iter:  6, prev_obj_val: 74.60970306396484, obj_val: 79.8804931640625, abs dis: 5.270790100097656
[rfa agg] iter: 6, weight: tensor([0.0500, 0.4378, 0.0615, 0.3174, 0.0070, 0.0040, 0.0346, 0.0398, 0.0345,
        0.0134])
[rfa agg] iter:  7, prev_obj_val: 79.8804931640625, obj_val: 79.87081146240234, abs dis: 0.00968170166015625
[rfa agg] iter: 7, weight: tensor([0.0654, 0.3264, 0.1327, 0.2851, 0.0116, 0.0065, 0.0480, 0.0540, 0.0477,
        0.0228])
			Update norm = 125.41604201117974 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3471, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.3055, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.55422282218933 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0497, Accuracy: 397/1213 (32.7288%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0267, Accuracy: 552/1213 (45.5070%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.0994, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4785, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0472, Accuracy: 321/813 (39.4834%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 462/813 (56.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.9318, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 632/2227 (28.3790%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0274, Accuracy: 1055/2227 (47.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2005, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 264/1071 (24.6499%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 508/1071 (47.4323%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1003, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 367/1581 (23.2132%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 577/1581 (36.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1346, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 447/1129 (39.5926%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 749/1129 (66.3419%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1244, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 381/1750 (21.7714%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 676/1750 (38.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0236, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0578, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3847, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 353/1013 (34.8470%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.2645, Accuracy: 72/10000 (0.7200%)
time spent on training: 285.6099088191986
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 25, 53, 60, 55, 28, 37, 44, 1, 14], weight: tensor([0.0977, 0.0556, 0.0655, 0.1794, 0.0863, 0.1273, 0.0909, 0.1410, 0.0747,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 60.22425079345703, obj_val: 65.25909423828125, abs dis: 5.034843444824219
[rfa agg] iter: 0, weight: tensor([0.3271, 0.0231, 0.0355, 0.0410, 0.1164, 0.0809, 0.1790, 0.0586, 0.0579,
        0.0805])
[rfa agg] iter:  1, prev_obj_val: 65.25909423828125, obj_val: 69.70665740966797, abs dis: 4.447563171386719
[rfa agg] iter: 1, weight: tensor([0.1025, 0.0274, 0.0499, 0.0264, 0.2397, 0.0406, 0.1402, 0.0333, 0.1168,
        0.2233])
[rfa agg] iter:  2, prev_obj_val: 69.70665740966797, obj_val: 82.22368621826172, abs dis: 12.51702880859375
[rfa agg] iter: 2, weight: tensor([0.0752, 0.0341, 0.0702, 0.0257, 0.1458, 0.0372, 0.0949, 0.0314, 0.2192,
        0.2663])
[rfa agg] iter:  3, prev_obj_val: 82.22368621826172, obj_val: 75.57247924804688, abs dis: 6.651206970214844
[rfa agg] iter: 3, weight: tensor([0.0667, 0.0818, 0.2813, 0.0318, 0.0918, 0.0421, 0.0753, 0.0370, 0.1716,
        0.1205])
[rfa agg] iter:  4, prev_obj_val: 75.57247924804688, obj_val: 72.46026611328125, abs dis: 3.112213134765625
[rfa agg] iter: 4, weight: tensor([0.0713, 0.0525, 0.1376, 0.0293, 0.1106, 0.0405, 0.0838, 0.0350, 0.2777,
        0.1617])
[rfa agg] iter:  5, prev_obj_val: 72.46026611328125, obj_val: 85.76429748535156, abs dis: 13.304031372070312
[rfa agg] iter: 5, weight: tensor([0.0678, 0.0392, 0.0887, 0.0256, 0.1146, 0.0362, 0.0823, 0.0309, 0.3280,
        0.1866])
[rfa agg] iter:  6, prev_obj_val: 85.76429748535156, obj_val: 75.59834289550781, abs dis: 10.16595458984375
[rfa agg] iter: 6, weight: tensor([0.0614, 0.1004, 0.3438, 0.0311, 0.0809, 0.0404, 0.0682, 0.0359, 0.1368,
        0.1010])
[rfa agg] iter:  7, prev_obj_val: 75.59834289550781, obj_val: 72.46138000488281, abs dis: 3.136962890625
[rfa agg] iter: 7, weight: tensor([0.0720, 0.0530, 0.1404, 0.0296, 0.1116, 0.0409, 0.0845, 0.0353, 0.2706,
        0.1622])
[rfa agg] iter:  8, prev_obj_val: 72.46138000488281, obj_val: 85.76358032226562, abs dis: 13.302200317382812
[rfa agg] iter: 8, weight: tensor([0.0680, 0.0393, 0.0890, 0.0257, 0.1150, 0.0363, 0.0825, 0.0310, 0.3258,
        0.1873])
[rfa agg] iter:  9, prev_obj_val: 85.76358032226562, obj_val: 75.59843444824219, abs dis: 10.165145874023438
[rfa agg] iter: 9, weight: tensor([0.0614, 0.1003, 0.3440, 0.0311, 0.0808, 0.0404, 0.0682, 0.0359, 0.1367,
        0.1010])
			Update norm = 129.86557051909486 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3471, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.3055, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.06951570510864 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0721, Accuracy: 95/500 (19.0000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0471, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4036, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0647, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0374, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6696, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2685, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0652, Accuracy: 182/530 (34.3396%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0355, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4033, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0449, Accuracy: 382/599 (63.7730%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.8149, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0522, Accuracy: 371/891 (41.6386%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 406/891 (45.5668%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 290/1131 (25.6410%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 379/1131 (33.5102%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3248, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0821, Accuracy: 52/416 (12.5000%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4247, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 505/1470 (34.3537%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 847/1470 (57.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.4219, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0554, Accuracy: 296/1154 (25.6499%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.4309, Accuracy: 74/10000 (0.7400%)
time spent on training: 222.56337904930115
[rfa agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 2, 84, 18, 95, 7, 87, 78, 22, 57], weight: tensor([0.0589, 0.0713, 0.1402, 0.0625, 0.0706, 0.1050, 0.1333, 0.0490, 0.1732,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 49.14387512207031, obj_val: 52.404541015625, abs dis: 3.2606658935546875
[rfa agg] iter: 0, weight: tensor([0.0453, 0.0898, 0.0893, 0.0598, 0.0891, 0.3400, 0.1019, 0.0315, 0.0667,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 52.404541015625, obj_val: 57.58517074584961, abs dis: 5.180629730224609
[rfa agg] iter: 1, weight: tensor([0.0607, 0.1415, 0.0824, 0.0851, 0.1407, 0.2123, 0.0916, 0.0405, 0.0651,
        0.0799])
[rfa agg] iter:  2, prev_obj_val: 57.58517074584961, obj_val: 65.20609283447266, abs dis: 7.620922088623047
[rfa agg] iter: 2, weight: tensor([0.0636, 0.2639, 0.0450, 0.1089, 0.2694, 0.0813, 0.0485, 0.0380, 0.0379,
        0.0436])
[rfa agg] iter:  3, prev_obj_val: 65.20609283447266, obj_val: 62.19380569458008, abs dis: 3.012287139892578
[rfa agg] iter: 3, weight: tensor([0.1254, 0.1525, 0.0325, 0.3385, 0.1526, 0.0485, 0.0344, 0.0554, 0.0288,
        0.0315])
[rfa agg] iter:  4, prev_obj_val: 62.19380569458008, obj_val: 65.1773910522461, abs dis: 2.9835853576660156
[rfa agg] iter: 4, weight: tensor([0.0845, 0.2261, 0.0327, 0.2372, 0.2304, 0.0513, 0.0347, 0.0429, 0.0285,
        0.0317])
[rfa agg] iter:  5, prev_obj_val: 65.1773910522461, obj_val: 72.127685546875, abs dis: 6.950294494628906
[rfa agg] iter: 5, weight: tensor([0.1189, 0.1429, 0.0306, 0.3779, 0.1429, 0.0456, 0.0323, 0.0522, 0.0271,
        0.0297])
[rfa agg] iter:  6, prev_obj_val: 72.127685546875, obj_val: 72.0753402709961, abs dis: 0.05234527587890625
[rfa agg] iter: 6, weight: tensor([0.3777, 0.0895, 0.0328, 0.1553, 0.0888, 0.0449, 0.0344, 0.1150, 0.0298,
        0.0318])
[rfa agg] iter:  7, prev_obj_val: 72.0753402709961, obj_val: 68.5374755859375, abs dis: 3.5378646850585938
[rfa agg] iter: 7, weight: tensor([0.4761, 0.0752, 0.0278, 0.1273, 0.0750, 0.0381, 0.0291, 0.0992, 0.0252,
        0.0270])
[rfa agg] iter:  8, prev_obj_val: 68.5374755859375, obj_val: 65.17630004882812, abs dis: 3.361175537109375
[rfa agg] iter: 8, weight: tensor([0.2716, 0.1124, 0.0337, 0.2437, 0.1128, 0.0479, 0.0354, 0.0797, 0.0302,
        0.0326])
[rfa agg] iter:  9, prev_obj_val: 65.17630004882812, obj_val: 68.52688598632812, abs dis: 3.3505859375
[rfa agg] iter: 9, weight: tensor([0.1213, 0.1365, 0.0302, 0.3897, 0.1376, 0.0450, 0.0319, 0.0518, 0.0267,
        0.0293])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.3306396007538 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3943, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0745, Accuracy: 82/373 (21.9839%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0365, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 496/1089 (45.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.3167, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 391/1036 (37.7413%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0235, Accuracy: 657/1036 (63.4170%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.1647, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 391/1427 (27.4001%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 591/1427 (41.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5222, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 409/1953 (20.9421%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 790/1953 (40.4506%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9534, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0608, Accuracy: 211/682 (30.9384%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0362, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.4560, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0603, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0353, Accuracy: 362/946 (38.2664%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8537, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 358/1573 (22.7591%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 556/1573 (35.3465%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8585, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.7644, Accuracy: 61/10000 (0.6100%)
time spent on training: 253.36961936950684
[rfa agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 98, 59, 19, 34, 83, 80, 43, 40, 58], weight: tensor([0.0185, 0.0370, 0.1082, 0.1029, 0.1417, 0.1940, 0.0677, 0.0940, 0.1562,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 57.96474075317383, obj_val: 62.7230224609375, abs dis: 4.758281707763672
[rfa agg] iter: 0, weight: tensor([0.0039, 0.0099, 0.3492, 0.2490, 0.0897, 0.0477, 0.0309, 0.0977, 0.0712,
        0.0507])
[rfa agg] iter:  1, prev_obj_val: 62.7230224609375, obj_val: 64.47401428222656, abs dis: 1.7509918212890625
[rfa agg] iter: 1, weight: tensor([0.0047, 0.0123, 0.1688, 0.2668, 0.0669, 0.0429, 0.0447, 0.2495, 0.0575,
        0.0858])
[rfa agg] iter:  2, prev_obj_val: 64.47401428222656, obj_val: 66.45613861083984, abs dis: 1.9821243286132812
[rfa agg] iter: 2, weight: tensor([0.0046, 0.0122, 0.1267, 0.1931, 0.0587, 0.0390, 0.0466, 0.3718, 0.0512,
        0.0961])
[rfa agg] iter:  3, prev_obj_val: 66.45613861083984, obj_val: 68.8359375, abs dis: 2.3797988891601562
[rfa agg] iter: 3, weight: tensor([0.0041, 0.0110, 0.0918, 0.1279, 0.0471, 0.0324, 0.0448, 0.4987, 0.0417,
        0.1006])
[rfa agg] iter:  4, prev_obj_val: 68.8359375, obj_val: 68.8310775756836, abs dis: 0.00485992431640625
[rfa agg] iter: 4, weight: tensor([0.0048, 0.0131, 0.0896, 0.1172, 0.0501, 0.0354, 0.0574, 0.4436, 0.0448,
        0.1440])
[rfa agg] iter:  5, prev_obj_val: 68.8310775756836, obj_val: 68.83092498779297, abs dis: 0.000152587890625
[rfa agg] iter: 5, weight: tensor([0.0049, 0.0133, 0.0911, 0.1193, 0.0509, 0.0360, 0.0585, 0.4321, 0.0455,
        0.1483])
			Update norm = 129.88433105315283 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.4353218078613 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0643, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 445/1190 (37.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1181, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 628/1581 (39.7217%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9521, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0474, Accuracy: 314/813 (38.6224%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 487/813 (59.9016%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.3414, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0604, Accuracy: 379/1163 (32.5881%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 448/1163 (38.5211%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5246, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0550, Accuracy: 423/1988 (21.2777%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 708/1988 (35.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9964, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 382/1750 (21.8286%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.7543, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0586, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4614, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 684/1904 (35.9244%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0103, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0578, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0219, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.4852, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.4001, Accuracy: 50/10000 (0.5000%)
time spent on training: 292.8399500846863
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 28, 53, 68, 85, 44, 25, 46, 32, 56], weight: tensor([0.0992, 0.1318, 0.0677, 0.0969, 0.1657, 0.1458, 0.0575, 0.1587, 0.0613,
        0.0155])
[rfa agg] iter:  0, prev_obj_val: 64.65716552734375, obj_val: 67.80549621582031, abs dis: 3.1483306884765625
[rfa agg] iter: 0, weight: tensor([0.2285, 0.1646, 0.0432, 0.2236, 0.0767, 0.1053, 0.0293, 0.0896, 0.0347,
        0.0044])
[rfa agg] iter:  1, prev_obj_val: 67.80549621582031, obj_val: 73.68525695800781, abs dis: 5.8797607421875
[rfa agg] iter: 1, weight: tensor([0.3449, 0.0794, 0.0347, 0.3363, 0.0443, 0.0570, 0.0226, 0.0504, 0.0273,
        0.0031])
[rfa agg] iter:  2, prev_obj_val: 73.68525695800781, obj_val: 73.68375396728516, abs dis: 0.00150299072265625
[rfa agg] iter: 2, weight: tensor([0.3221, 0.0748, 0.0537, 0.3135, 0.0473, 0.0581, 0.0328, 0.0528, 0.0407,
        0.0041])
			Update norm = 161.17289217444414 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 385.342068195343 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1278, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1203, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3603, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 232/774 (29.9742%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.1953, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 453/1953 (23.1951%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 734/1953 (37.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0942, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0619, Accuracy: 212/530 (40.0000%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0345, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5329, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0668, Accuracy: 162/568 (28.5211%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0401, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.3682, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0609, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/1402 (31.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.6130, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1581 (26.6920%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 622/1581 (39.3422%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7899, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0818, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0491, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2840, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0552, Accuracy: 418/1988 (21.0262%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 687/1988 (34.5573%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.1136, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0819, Accuracy: 64/416 (15.3846%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.4292, Accuracy: 50/10000 (0.5000%)
time spent on training: 256.2146635055542
[rfa agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 81, 83, 18, 62, 66, 28, 36, 85, 78], weight: tensor([0.0088, 0.0798, 0.2012, 0.0546, 0.0585, 0.1445, 0.1629, 0.0420, 0.2048,
        0.0429])
[rfa agg] iter:  0, prev_obj_val: 76.0616455078125, obj_val: 75.89788818359375, abs dis: 0.16375732421875
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0471, 0.0951, 0.0216, 0.0231, 0.5054, 0.1886, 0.0142, 0.0881,
        0.0145])
[rfa agg] iter:  1, prev_obj_val: 75.89788818359375, obj_val: 74.13618469238281, abs dis: 1.7617034912109375
[rfa agg] iter: 1, weight: tensor([0.0020, 0.0430, 0.0868, 0.0197, 0.0211, 0.5490, 0.1717, 0.0130, 0.0804,
        0.0133])
[rfa agg] iter:  2, prev_obj_val: 74.13618469238281, obj_val: 75.90494537353516, abs dis: 1.7687606811523438
[rfa agg] iter: 2, weight: tensor([0.0014, 0.0298, 0.0671, 0.0139, 0.0149, 0.6497, 0.1426, 0.0092, 0.0618,
        0.0094])
[rfa agg] iter:  3, prev_obj_val: 75.90494537353516, obj_val: 75.89519500732422, abs dis: 0.0097503662109375
[rfa agg] iter: 3, weight: tensor([0.0019, 0.0416, 0.0840, 0.0191, 0.0205, 0.5647, 0.1650, 0.0126, 0.0777,
        0.0128])
[rfa agg] iter:  4, prev_obj_val: 75.89519500732422, obj_val: 74.13382720947266, abs dis: 1.7613677978515625
[rfa agg] iter: 4, weight: tensor([0.0020, 0.0424, 0.0856, 0.0194, 0.0208, 0.5560, 0.1687, 0.0128, 0.0792,
        0.0131])
[rfa agg] iter:  5, prev_obj_val: 74.13382720947266, obj_val: 75.90536499023438, abs dis: 1.7715377807617188
[rfa agg] iter: 5, weight: tensor([0.0014, 0.0296, 0.0668, 0.0138, 0.0148, 0.6516, 0.1418, 0.0092, 0.0615,
        0.0094])
[rfa agg] iter:  6, prev_obj_val: 75.90536499023438, obj_val: 75.89519500732422, abs dis: 0.01016998291015625
[rfa agg] iter: 6, weight: tensor([0.0019, 0.0416, 0.0840, 0.0191, 0.0204, 0.5649, 0.1649, 0.0126, 0.0777,
        0.0128])
[rfa agg] iter:  7, prev_obj_val: 75.89519500732422, obj_val: 74.13381958007812, abs dis: 1.7613754272460938
[rfa agg] iter: 7, weight: tensor([0.0020, 0.0424, 0.0856, 0.0194, 0.0208, 0.5560, 0.1687, 0.0128, 0.0792,
        0.0131])
[rfa agg] iter:  8, prev_obj_val: 74.13381958007812, obj_val: 75.90536499023438, abs dis: 1.77154541015625
[rfa agg] iter: 8, weight: tensor([0.0014, 0.0296, 0.0668, 0.0138, 0.0148, 0.6516, 0.1418, 0.0092, 0.0615,
        0.0094])
[rfa agg] iter:  9, prev_obj_val: 75.90536499023438, obj_val: 75.89519500732422, abs dis: 0.01016998291015625
[rfa agg] iter: 9, weight: tensor([0.0019, 0.0416, 0.0840, 0.0191, 0.0204, 0.5649, 0.1649, 0.0126, 0.0777,
        0.0128])
			Update norm = 187.9985039834094 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.65052008628845 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 355/1372 (25.8746%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 503/1372 (36.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3764, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1188, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1137, Accuracy: 30/134 (22.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3822, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5399, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0597, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 394/1750 (22.5143%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 673/1750 (38.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8153, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0380, Accuracy: 420/1402 (29.9572%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3646, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 650/1662 (39.1095%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1325, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 539/1470 (36.6667%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 838/1470 (57.0068%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1514, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 487/1131 (43.0592%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9277, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0558, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 430/1154 (37.2617%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.2044, Accuracy: 62/10000 (0.6200%)
time spent on training: 304.7524404525757
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 47, 26, 4, 44, 66, 94, 22, 38, 15], weight: tensor([0.1104, 0.0108, 0.1164, 0.0725, 0.1409, 0.1129, 0.1338, 0.1183, 0.0910,
        0.0929])
[rfa agg] iter:  0, prev_obj_val: 38.50896453857422, obj_val: 40.79108810424805, abs dis: 2.282123565673828
[rfa agg] iter: 0, weight: tensor([0.1238, 0.0019, 0.0958, 0.0473, 0.0490, 0.1258, 0.0608, 0.0972, 0.1534,
        0.2449])
[rfa agg] iter:  1, prev_obj_val: 40.79108810424805, obj_val: 46.48701858520508, abs dis: 5.695930480957031
[rfa agg] iter: 1, weight: tensor([0.0977, 0.0019, 0.0785, 0.0492, 0.0431, 0.0996, 0.0526, 0.0796, 0.1898,
        0.3081])
[rfa agg] iter:  2, prev_obj_val: 46.48701858520508, obj_val: 43.45532989501953, abs dis: 3.031688690185547
[rfa agg] iter: 2, weight: tensor([0.0799, 0.0021, 0.0680, 0.0692, 0.0417, 0.0816, 0.0494, 0.0689, 0.3194,
        0.2197])
[rfa agg] iter:  3, prev_obj_val: 43.45532989501953, obj_val: 46.44770431518555, abs dis: 2.9923744201660156
[rfa agg] iter: 3, weight: tensor([0.0834, 0.0019, 0.0694, 0.0554, 0.0405, 0.0852, 0.0487, 0.0704, 0.2906,
        0.2545])
[rfa agg] iter:  4, prev_obj_val: 46.44770431518555, obj_val: 46.43474197387695, abs dis: 0.01296234130859375
[rfa agg] iter: 4, weight: tensor([0.0767, 0.0021, 0.0653, 0.0665, 0.0400, 0.0783, 0.0475, 0.0662, 0.3529,
        0.2045])
[rfa agg] iter:  5, prev_obj_val: 46.43474197387695, obj_val: 49.76904296875, abs dis: 3.334300994873047
[rfa agg] iter: 5, weight: tensor([0.0743, 0.0020, 0.0633, 0.0646, 0.0388, 0.0759, 0.0461, 0.0642, 0.3787,
        0.1923])
[rfa agg] iter:  6, prev_obj_val: 49.76904296875, obj_val: 46.43549728393555, abs dis: 3.333545684814453
[rfa agg] iter: 6, weight: tensor([0.0766, 0.0024, 0.0665, 0.0879, 0.0427, 0.0782, 0.0500, 0.0676, 0.3588,
        0.1694])
[rfa agg] iter:  7, prev_obj_val: 46.43549728393555, obj_val: 49.76908493041992, abs dis: 3.333587646484375
[rfa agg] iter: 7, weight: tensor([0.0740, 0.0020, 0.0630, 0.0645, 0.0387, 0.0756, 0.0459, 0.0640, 0.3842,
        0.1881])
[rfa agg] iter:  8, prev_obj_val: 49.76908493041992, obj_val: 46.43541717529297, abs dis: 3.333667755126953
[rfa agg] iter: 8, weight: tensor([0.0764, 0.0024, 0.0664, 0.0877, 0.0426, 0.0781, 0.0499, 0.0674, 0.3602,
        0.1688])
[rfa agg] iter:  9, prev_obj_val: 46.43541717529297, obj_val: 49.76911544799805, abs dis: 3.333698272705078
[rfa agg] iter: 9, weight: tensor([0.0740, 0.0020, 0.0630, 0.0644, 0.0387, 0.0756, 0.0459, 0.0640, 0.3848,
        0.1878])
			Update norm = 156.69313412287724 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.855265378952 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0783, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0413, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.1035, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0562, Accuracy: 368/1573 (23.3948%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 574/1573 (36.4908%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8743, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 470/1131 (41.5561%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8017, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 309/1013 (30.5035%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 501/1013 (49.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4055, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0762, Accuracy: 86/515 (16.6990%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0532, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.6838, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0650, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7338, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 385/1581 (24.3517%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 608/1581 (38.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9143, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 662/1418 (46.6855%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3268, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0517, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0246, Accuracy: 448/891 (50.2806%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2410, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0544, Accuracy: 294/636 (46.2264%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0300, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7821, Accuracy: 50/10000 (0.5000%)
time spent on training: 266.28227853775024
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 40, 38, 39, 33, 75, 28, 70, 7, 52], weight: tensor([0.0317, 0.1598, 0.1149, 0.1029, 0.0523, 0.0788, 0.1606, 0.1440, 0.0905,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 50.75684356689453, obj_val: 58.37263488769531, abs dis: 7.615791320800781
[rfa agg] iter: 0, weight: tensor([0.0086, 0.0587, 0.2148, 0.3624, 0.0218, 0.0691, 0.0591, 0.0689, 0.1056,
        0.0311])
[rfa agg] iter:  1, prev_obj_val: 58.37263488769531, obj_val: 58.219200134277344, abs dis: 0.15343475341796875
[rfa agg] iter: 1, weight: tensor([0.0115, 0.0475, 0.0929, 0.1630, 0.0340, 0.2024, 0.0478, 0.0522, 0.2963,
        0.0523])
[rfa agg] iter:  2, prev_obj_val: 58.219200134277344, obj_val: 60.43516540527344, abs dis: 2.2159652709960938
[rfa agg] iter: 2, weight: tensor([0.0105, 0.0431, 0.0839, 0.1432, 0.0309, 0.1936, 0.0433, 0.0473, 0.3568,
        0.0475])
[rfa agg] iter:  3, prev_obj_val: 60.43516540527344, obj_val: 62.948673248291016, abs dis: 2.513507843017578
[rfa agg] iter: 3, weight: tensor([0.0110, 0.0410, 0.0745, 0.1162, 0.0341, 0.2683, 0.0413, 0.0447, 0.3150,
        0.0538])
[rfa agg] iter:  4, prev_obj_val: 62.948673248291016, obj_val: 62.92034912109375, abs dis: 0.028324127197265625
[rfa agg] iter: 4, weight: tensor([0.0120, 0.0402, 0.0687, 0.1004, 0.0391, 0.3708, 0.0404, 0.0434, 0.2212,
        0.0637])
[rfa agg] iter:  5, prev_obj_val: 62.92034912109375, obj_val: 68.79601287841797, abs dis: 5.875663757324219
[rfa agg] iter: 5, weight: tensor([0.0113, 0.0378, 0.0646, 0.0945, 0.0368, 0.4183, 0.0381, 0.0409, 0.1978,
        0.0599])
[rfa agg] iter:  6, prev_obj_val: 68.79601287841797, obj_val: 65.76631927490234, abs dis: 3.029693603515625
[rfa agg] iter: 6, weight: tensor([0.0183, 0.0498, 0.0771, 0.1025, 0.0692, 0.2873, 0.0501, 0.0530, 0.1687,
        0.1239])
[rfa agg] iter:  7, prev_obj_val: 65.76631927490234, obj_val: 62.922203063964844, abs dis: 2.8441162109375
[rfa agg] iter: 7, weight: tensor([0.0147, 0.0444, 0.0721, 0.1002, 0.0513, 0.3553, 0.0447, 0.0476, 0.1821,
        0.0875])
[rfa agg] iter:  8, prev_obj_val: 62.922203063964844, obj_val: 68.79588317871094, abs dis: 5.873680114746094
[rfa agg] iter: 8, weight: tensor([0.0113, 0.0380, 0.0650, 0.0950, 0.0370, 0.4186, 0.0382, 0.0410, 0.1956,
        0.0603])
[rfa agg] iter:  9, prev_obj_val: 68.79588317871094, obj_val: 65.76631164550781, abs dis: 3.029571533203125
[rfa agg] iter: 9, weight: tensor([0.0183, 0.0498, 0.0771, 0.1025, 0.0692, 0.2874, 0.0501, 0.0530, 0.1687,
        0.1240])
			Update norm = 112.00908079119077 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3506, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.3155, Accuracy: 0/9950 (0.0000%)
saving model
Done in 362.53562331199646 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0886, Accuracy: 17/271 (6.2731%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0575, Accuracy: 120/271 (44.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8303, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0758, Accuracy: 79/515 (15.3398%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0504, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.5161, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 371/1418 (26.1636%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1640, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0546, Accuracy: 225/861 (26.1324%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 463/861 (53.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.1861, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 161/818 (19.6822%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 319/818 (38.9976%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5052, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0588, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 429/896 (47.8795%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.7668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0669, Accuracy: 166/568 (29.2254%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 267/568 (47.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.4017, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 239/605 (39.5041%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.5554, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0760, Accuracy: 55/440 (12.5000%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0453, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.3339, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0617, Accuracy: 338/715 (47.2727%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0370, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.0665, Accuracy: 50/10000 (0.5000%)
time spent on training: 221.83831644058228
[rfa agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 33, 70, 10, 71, 89, 62, 2, 49, 23], weight: tensor([0.0381, 0.0725, 0.1995, 0.1211, 0.1151, 0.1261, 0.0799, 0.0851, 0.0619,
        0.1006])
[rfa agg] iter:  0, prev_obj_val: 39.55365753173828, obj_val: 50.32210159301758, abs dis: 10.768444061279297
[rfa agg] iter: 0, weight: tensor([0.0158, 0.0869, 0.0413, 0.0983, 0.1366, 0.1017, 0.0962, 0.1871, 0.0382,
        0.1978])
[rfa agg] iter:  1, prev_obj_val: 50.32210159301758, obj_val: 53.72236633300781, abs dis: 3.4002647399902344
[rfa agg] iter: 1, weight: tensor([0.0250, 0.2314, 0.0318, 0.0507, 0.0587, 0.0526, 0.2675, 0.1256, 0.0914,
        0.0653])
[rfa agg] iter:  2, prev_obj_val: 53.72236633300781, obj_val: 57.26519012451172, abs dis: 3.5428237915039062
[rfa agg] iter: 2, weight: tensor([0.0354, 0.1888, 0.0373, 0.0564, 0.0642, 0.0587, 0.2115, 0.1164, 0.1619,
        0.0694])
[rfa agg] iter:  3, prev_obj_val: 57.26519012451172, obj_val: 60.91741943359375, abs dis: 3.6522293090820312
[rfa agg] iter: 3, weight: tensor([0.0443, 0.1367, 0.0378, 0.0545, 0.0611, 0.0567, 0.1518, 0.0983, 0.2940,
        0.0648])
[rfa agg] iter:  4, prev_obj_val: 60.91741943359375, obj_val: 60.89677047729492, abs dis: 0.020648956298828125
[rfa agg] iter: 4, weight: tensor([0.0458, 0.0865, 0.0304, 0.0422, 0.0467, 0.0438, 0.0958, 0.0686, 0.4914,
        0.0487])
[rfa agg] iter:  5, prev_obj_val: 60.89677047729492, obj_val: 60.89238739013672, abs dis: 0.004383087158203125
[rfa agg] iter: 5, weight: tensor([0.0385, 0.0725, 0.0256, 0.0354, 0.0392, 0.0368, 0.0802, 0.0575, 0.5734,
        0.0409])
[rfa agg] iter:  6, prev_obj_val: 60.89238739013672, obj_val: 69.01392364501953, abs dis: 8.121536254882812
[rfa agg] iter: 6, weight: tensor([0.0347, 0.0652, 0.0231, 0.0319, 0.0353, 0.0332, 0.0722, 0.0518, 0.6159,
        0.0368])
[rfa agg] iter:  7, prev_obj_val: 69.01392364501953, obj_val: 64.89911651611328, abs dis: 4.11480712890625
[rfa agg] iter: 7, weight: tensor([0.1457, 0.0980, 0.0481, 0.0620, 0.0673, 0.0645, 0.1082, 0.0867, 0.2511,
        0.0683])
[rfa agg] iter:  8, prev_obj_val: 64.89911651611328, obj_val: 68.9897689819336, abs dis: 4.0906524658203125
[rfa agg] iter: 8, weight: tensor([0.0843, 0.0970, 0.0411, 0.0548, 0.0600, 0.0570, 0.1073, 0.0820, 0.3549,
        0.0617])
[rfa agg] iter:  9, prev_obj_val: 68.9897689819336, obj_val: 64.89935302734375, abs dis: 4.090415954589844
[rfa agg] iter: 9, weight: tensor([0.1477, 0.0985, 0.0483, 0.0623, 0.0676, 0.0648, 0.1089, 0.0872, 0.2461,
        0.0686])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 319.956191778183 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0529, Accuracy: 343/677 (50.6647%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.1582, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0716, Accuracy: 160/603 (26.5340%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.7656, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0633, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 389/776 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9844, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 333/1657 (20.0966%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 509/1657 (30.7182%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4805, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0578, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 475/1154 (41.1612%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.5120, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 331/719 (46.0362%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5403, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 413/1742 (23.7084%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 719/1742 (41.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4945, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 328/1645 (19.9392%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 632/1645 (38.4195%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0288, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0329, Accuracy: 639/1581 (40.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8537, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 710/1440 (49.3056%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3252, Accuracy: 79/10000 (0.7900%)
time spent on training: 313.66802644729614
[rfa agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 75, 0, 57, 41, 93, 13, 28, 29], weight: tensor([0.0564, 0.0503, 0.0647, 0.1382, 0.0962, 0.0599, 0.1452, 0.1372, 0.1318,
        0.1201])
[rfa agg] iter:  0, prev_obj_val: 53.554691314697266, obj_val: 56.9311637878418, abs dis: 3.3764724731445312
[rfa agg] iter: 0, weight: tensor([0.0282, 0.0226, 0.0414, 0.1024, 0.2999, 0.0336, 0.0811, 0.1016, 0.1163,
        0.1727])
[rfa agg] iter:  1, prev_obj_val: 56.9311637878418, obj_val: 61.22610092163086, abs dis: 4.2949371337890625
[rfa agg] iter: 1, weight: tensor([0.0275, 0.0218, 0.0418, 0.0763, 0.4616, 0.0332, 0.0626, 0.0758, 0.0846,
        0.1147])
[rfa agg] iter:  2, prev_obj_val: 61.22610092163086, obj_val: 61.218929290771484, abs dis: 0.007171630859375
[rfa agg] iter: 2, weight: tensor([0.0383, 0.0299, 0.0609, 0.0817, 0.3905, 0.0471, 0.0689, 0.0812, 0.0888,
        0.1127])
[rfa agg] iter:  3, prev_obj_val: 61.218929290771484, obj_val: 61.21882247924805, abs dis: 0.0001068115234375
[rfa agg] iter: 3, weight: tensor([0.0389, 0.0303, 0.0618, 0.0829, 0.3816, 0.0478, 0.0699, 0.0823, 0.0901,
        0.1143])
			Update norm = 161.14844791565633 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.79300022125244 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 465/1552 (29.9613%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 782/1552 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.6700, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 641/1956 (32.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6942, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0569, Accuracy: 394/1427 (27.6104%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 599/1427 (41.9762%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6588, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 596/928 (64.2241%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8432, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0527, Accuracy: 440/1715 (25.6560%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 743/1715 (43.3236%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0202, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 324/1013 (31.9842%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8771, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0638, Accuracy: 222/669 (33.1839%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0387, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.4229, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0610, Accuracy: 249/1402 (17.7603%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0377, Accuracy: 431/1402 (30.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5779, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 439/1130 (38.8496%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.7003, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0601, Accuracy: 269/1241 (21.6761%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0358, Accuracy: 431/1241 (34.7301%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6953, Accuracy: 77/10000 (0.7700%)
time spent on training: 324.2627339363098
[rfa agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [74, 6, 34, 1, 92, 14, 45, 66, 54, 72], weight: tensor([0.1191, 0.1501, 0.1095, 0.0712, 0.1316, 0.0777, 0.0513, 0.1076, 0.0867,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 45.184417724609375, obj_val: 49.75856399536133, abs dis: 4.574146270751953
[rfa agg] iter: 0, weight: tensor([0.0784, 0.0432, 0.1202, 0.0388, 0.0608, 0.0517, 0.0164, 0.1843, 0.0998,
        0.3065])
[rfa agg] iter:  1, prev_obj_val: 49.75856399536133, obj_val: 58.819068908691406, abs dis: 9.060504913330078
[rfa agg] iter: 1, weight: tensor([0.0641, 0.0409, 0.0862, 0.0570, 0.0535, 0.0820, 0.0210, 0.1129, 0.2192,
        0.2633])
[rfa agg] iter:  2, prev_obj_val: 58.819068908691406, obj_val: 61.4919548034668, abs dis: 2.6728858947753906
[rfa agg] iter: 2, weight: tensor([0.0526, 0.0381, 0.0637, 0.1160, 0.0466, 0.2165, 0.0302, 0.0754, 0.2504,
        0.1104])
[rfa agg] iter:  3, prev_obj_val: 61.4919548034668, obj_val: 61.47367858886719, abs dis: 0.018276214599609375
[rfa agg] iter: 3, weight: tensor([0.0471, 0.0350, 0.0561, 0.1415, 0.0423, 0.3135, 0.0314, 0.0654, 0.1777,
        0.0899])
[rfa agg] iter:  4, prev_obj_val: 61.47367858886719, obj_val: 61.47310256958008, abs dis: 0.000576019287109375
[rfa agg] iter: 4, weight: tensor([0.0459, 0.0341, 0.0546, 0.1388, 0.0411, 0.3348, 0.0306, 0.0636, 0.1691,
        0.0874])
			Update norm = 147.72334784995905 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 419.33267164230347 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0475, Accuracy: 297/813 (36.5314%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 470/813 (57.8106%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.8348, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 511/1470 (34.7619%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 864/1470 (58.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.8553, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 354/1662 (21.2996%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0324, Accuracy: 646/1662 (38.8688%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3460, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0499, Accuracy: 371/1213 (30.5853%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.4665, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0544, Accuracy: 420/1587 (26.4650%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 599/1587 (37.7442%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9395, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0590, Accuracy: 254/1049 (24.2135%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 517/1049 (49.2850%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2780, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1264, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1074, Accuracy: 21/134 (15.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3823, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 343/715 (47.9720%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0383, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.0849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 340/901 (37.7358%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3984, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.7300, Accuracy: 70/10000 (0.7000%)
time spent on training: 294.30461263656616
[rfa agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 22, 94, 97, 27, 51, 47, 23, 4, 2], weight: tensor([0.0801, 0.1448, 0.1638, 0.1195, 0.1564, 0.1034, 0.0132, 0.0705, 0.0888,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 48.76101303100586, obj_val: 51.571598052978516, abs dis: 2.8105850219726562
[rfa agg] iter: 0, weight: tensor([0.0641, 0.0776, 0.0588, 0.1788, 0.0631, 0.3477, 0.0031, 0.0452, 0.1343,
        0.0275])
[rfa agg] iter:  1, prev_obj_val: 51.571598052978516, obj_val: 57.374656677246094, abs dis: 5.803058624267578
[rfa agg] iter: 1, weight: tensor([0.0864, 0.0685, 0.0544, 0.1285, 0.0577, 0.2810, 0.0034, 0.0577, 0.2296,
        0.0329])
[rfa agg] iter:  2, prev_obj_val: 57.374656677246094, obj_val: 57.313636779785156, abs dis: 0.0610198974609375
[rfa agg] iter: 2, weight: tensor([0.1584, 0.0559, 0.0468, 0.0862, 0.0489, 0.1300, 0.0038, 0.0891, 0.3377,
        0.0431])
[rfa agg] iter:  3, prev_obj_val: 57.313636779785156, obj_val: 55.104129791259766, abs dis: 2.2095069885253906
[rfa agg] iter: 3, weight: tensor([0.1541, 0.0533, 0.0446, 0.0821, 0.0466, 0.1211, 0.0036, 0.0852, 0.3681,
        0.0412])
[rfa agg] iter:  4, prev_obj_val: 55.104129791259766, obj_val: 57.318321228027344, abs dis: 2.214191436767578
[rfa agg] iter: 4, weight: tensor([0.1054, 0.0499, 0.0411, 0.0810, 0.0431, 0.1282, 0.0030, 0.0633, 0.4524,
        0.0327])
[rfa agg] iter:  5, prev_obj_val: 57.318321228027344, obj_val: 62.259185791015625, abs dis: 4.940864562988281
[rfa agg] iter: 5, weight: tensor([0.1466, 0.0516, 0.0432, 0.0794, 0.0452, 0.1168, 0.0035, 0.0822, 0.3916,
        0.0398])
[rfa agg] iter:  6, prev_obj_val: 62.259185791015625, obj_val: 59.71720886230469, abs dis: 2.5419769287109375
[rfa agg] iter: 6, weight: tensor([0.3152, 0.0501, 0.0431, 0.0708, 0.0447, 0.0936, 0.0041, 0.1393, 0.1843,
        0.0550])
[rfa agg] iter:  7, prev_obj_val: 59.71720886230469, obj_val: 59.70907211303711, abs dis: 0.008136749267578125
[rfa agg] iter: 7, weight: tensor([0.2439, 0.0546, 0.0463, 0.0804, 0.0482, 0.1112, 0.0041, 0.1137, 0.2474,
        0.0502])
[rfa agg] iter:  8, prev_obj_val: 59.70907211303711, obj_val: 59.70900344848633, abs dis: 6.866455078125e-05
[rfa agg] iter: 8, weight: tensor([0.2374, 0.0546, 0.0463, 0.0803, 0.0482, 0.1114, 0.0041, 0.1134, 0.2540,
        0.0501])
			Update norm = 125.35456744022135 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.62134528160095 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0815, Accuracy: 66/416 (15.8654%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0449, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4131, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0693, Accuracy: 126/781 (16.1332%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0338, Accuracy: 251/781 (32.1383%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6135, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 346/1657 (20.8811%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 504/1657 (30.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7712, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 367/1275 (28.7843%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 743/1275 (58.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.5809, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0559, Accuracy: 348/1573 (22.1233%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 577/1573 (36.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8881, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 582/928 (62.7155%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.1386, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0263, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0200, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0543, Accuracy: 229/861 (26.5970%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 460/861 (53.4262%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6254, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 601/1581 (38.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7444, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 54/466 (11.5880%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.9766, Accuracy: 50/10000 (0.5000%)
time spent on training: 311.2342290878296
[rfa agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 3, 0, 9, 40, 1, 57, 10, 28, 76], weight: tensor([0.0389, 0.0730, 0.1550, 0.1192, 0.1471, 0.0868, 0.1079, 0.0805, 0.1479,
        0.0436])
[rfa agg] iter:  0, prev_obj_val: 51.3109130859375, obj_val: 52.79154968261719, abs dis: 1.4806365966796875
[rfa agg] iter: 0, weight: tensor([0.0153, 0.0662, 0.0748, 0.1864, 0.0802, 0.1363, 0.2487, 0.0926, 0.0807,
        0.0189])
[rfa agg] iter:  1, prev_obj_val: 52.79154968261719, obj_val: 55.97597122192383, abs dis: 3.1844215393066406
[rfa agg] iter: 1, weight: tensor([0.0165, 0.0763, 0.0727, 0.1632, 0.0774, 0.1722, 0.2124, 0.1108, 0.0779,
        0.0205])
[rfa agg] iter:  2, prev_obj_val: 55.97597122192383, obj_val: 55.95735168457031, abs dis: 0.018619537353515625
[rfa agg] iter: 2, weight: tensor([0.0170, 0.0934, 0.0608, 0.1153, 0.0640, 0.2771, 0.1367, 0.1498, 0.0644,
        0.0214])
[rfa agg] iter:  3, prev_obj_val: 55.95735168457031, obj_val: 55.95726013183594, abs dis: 9.1552734375e-05
[rfa agg] iter: 3, weight: tensor([0.0168, 0.0922, 0.0600, 0.1135, 0.0632, 0.2870, 0.1340, 0.1486, 0.0635,
        0.0212])
			Update norm = 143.243728047688 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 407.73904252052307 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.2781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0577, Accuracy: 272/1513 (17.9775%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 512/1513 (33.8401%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8526, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 289/928 (31.1422%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8975, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 430/1440 (29.8611%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 684/1440 (47.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1338, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 332/719 (46.1752%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0312, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8616, Accuracy: 63/10000 (0.6300%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 407/1574 (25.8577%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 652/1574 (41.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5108, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 593/2227 (26.6278%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1056/2227 (47.4181%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1474, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0616, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6064, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 330/1013 (32.5765%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4134, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 376/1628 (23.0958%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 827/1628 (50.7985%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.6619, Accuracy: 89/10000 (0.8900%)
time spent on training: 335.2828998565674
[rfa agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.040607198877239334
[rfa agg] init. name: [76, 8, 1, 29, 41, 17, 60, 2, 14, 5], weight: tensor([0.0385, 0.1249, 0.0766, 0.1189, 0.0594, 0.1299, 0.1839, 0.0499, 0.0836,
        0.1344])
[rfa agg] iter:  0, prev_obj_val: 66.92955017089844, obj_val: 68.60855102539062, abs dis: 1.6790008544921875
[rfa agg] iter: 0, weight: tensor([0.0194, 0.1581, 0.0975, 0.1902, 0.0458, 0.1360, 0.0688, 0.0305, 0.1347,
        0.1190])
[rfa agg] iter:  1, prev_obj_val: 68.60855102539062, obj_val: 70.31770324707031, abs dis: 1.7091522216796875
[rfa agg] iter: 1, weight: tensor([0.0207, 0.1457, 0.1115, 0.1721, 0.0500, 0.1273, 0.0679, 0.0328, 0.1593,
        0.1128])
[rfa agg] iter:  2, prev_obj_val: 70.31770324707031, obj_val: 70.3165054321289, abs dis: 0.00119781494140625
[rfa agg] iter: 2, weight: tensor([0.0217, 0.1326, 0.1267, 0.1534, 0.0537, 0.1175, 0.0658, 0.0347, 0.1886,
        0.1053])
			Update norm = 165.58771986095468 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.36815190315247 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0537, Accuracy: 368/1129 (32.5952%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 712/1129 (63.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5580, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0874, Accuracy: 26/271 (9.5941%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 114/271 (42.0664%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.8723, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0715, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0470, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.6724, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0644, Accuracy: 178/938 (18.9765%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 354/938 (37.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7559, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 444/1953 (22.7343%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 788/1953 (40.3482%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9316, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0510, Accuracy: 345/891 (38.7205%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9911, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 487/1446 (33.6791%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6110, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0559, Accuracy: 367/1573 (23.3312%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 571/1573 (36.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9963, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 309/690 (44.7826%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8072, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 289/813 (35.5474%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 438/813 (53.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.8427, Accuracy: 52/10000 (0.5200%)
time spent on training: 287.6890699863434
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 35, 82, 73, 83, 7, 26, 40, 25, 53], weight: tensor([0.1106, 0.0266, 0.0490, 0.0919, 0.1914, 0.0873, 0.1417, 0.1542, 0.0676,
        0.0797])
[rfa agg] iter:  0, prev_obj_val: 61.84438705444336, obj_val: 63.48207473754883, abs dis: 1.6376876831054688
[rfa agg] iter: 0, weight: tensor([0.3142, 0.0092, 0.0225, 0.1788, 0.0566, 0.1149, 0.0970, 0.0793, 0.0464,
        0.0811])
[rfa agg] iter:  1, prev_obj_val: 63.48207473754883, obj_val: 65.61441040039062, abs dis: 2.132335662841797
[rfa agg] iter: 1, weight: tensor([0.1950, 0.0092, 0.0232, 0.2851, 0.0483, 0.1502, 0.0762, 0.0646, 0.0509,
        0.0973])
[rfa agg] iter:  2, prev_obj_val: 65.61441040039062, obj_val: 67.16310119628906, abs dis: 1.5486907958984375
[rfa agg] iter: 2, weight: tensor([0.0959, 0.0072, 0.0190, 0.4291, 0.0325, 0.1801, 0.0480, 0.0418, 0.0455,
        0.1010])
[rfa agg] iter:  3, prev_obj_val: 67.16310119628906, obj_val: 73.94236755371094, abs dis: 6.779266357421875
[rfa agg] iter: 3, weight: tensor([0.0806, 0.0075, 0.0201, 0.3617, 0.0309, 0.2410, 0.0442, 0.0390, 0.0506,
        0.1244])
[rfa agg] iter:  4, prev_obj_val: 73.94236755371094, obj_val: 69.09227752685547, abs dis: 4.850090026855469
[rfa agg] iter: 4, weight: tensor([0.0680, 0.0104, 0.0307, 0.1400, 0.0334, 0.2186, 0.0444, 0.0402, 0.1009,
        0.3133])
[rfa agg] iter:  5, prev_obj_val: 69.09227752685547, obj_val: 76.77738952636719, abs dis: 7.685111999511719
[rfa agg] iter: 5, weight: tensor([0.0754, 0.0083, 0.0230, 0.2125, 0.0317, 0.3108, 0.0443, 0.0394, 0.0623,
        0.1923])
[rfa agg] iter:  6, prev_obj_val: 76.77738952636719, obj_val: 71.31578826904297, abs dis: 5.461601257324219
[rfa agg] iter: 6, weight: tensor([0.0683, 0.0122, 0.0374, 0.1232, 0.0357, 0.1830, 0.0465, 0.0425, 0.1428,
        0.3084])
[rfa agg] iter:  7, prev_obj_val: 71.31578826904297, obj_val: 79.82490539550781, abs dis: 8.509117126464844
[rfa agg] iter: 7, weight: tensor([0.0685, 0.0089, 0.0254, 0.1587, 0.0313, 0.2599, 0.0426, 0.0382, 0.0753,
        0.2912])
[rfa agg] iter:  8, prev_obj_val: 79.82490539550781, obj_val: 76.7406005859375, abs dis: 3.0843048095703125
[rfa agg] iter: 8, weight: tensor([0.0690, 0.0144, 0.0461, 0.1135, 0.0382, 0.1553, 0.0488, 0.0449, 0.2148,
        0.2549])
[rfa agg] iter:  9, prev_obj_val: 76.7406005859375, obj_val: 73.85049438476562, abs dis: 2.890106201171875
[rfa agg] iter: 9, weight: tensor([0.0667, 0.0119, 0.0365, 0.1195, 0.0348, 0.1717, 0.0454, 0.0414, 0.1427,
        0.3294])
			Update norm = 116.4282487602343 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3531, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.93130373954773 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0497, Accuracy: 356/590 (60.3390%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0284, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 248/1071 (23.1559%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 523/1071 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.7637, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3610, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0709, Accuracy: 160/603 (26.5340%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0443, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7548, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 183/818 (22.3716%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 354/818 (43.2763%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6181, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 351/1154 (30.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.4989, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.0510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0585, Accuracy: 211/735 (28.7075%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2536, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 610/1949 (31.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4524, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3987, Accuracy: 50/10000 (0.5000%)
time spent on training: 246.63978028297424
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 55, 61, 88, 71, 15, 24, 32, 21, 56], weight: tensor([0.0786, 0.1427, 0.0113, 0.0804, 0.1090, 0.1538, 0.0416, 0.0980, 0.2598,
        0.0248])
[rfa agg] iter:  0, prev_obj_val: 64.82026672363281, obj_val: 65.72974395751953, abs dis: 0.9094772338867188
[rfa agg] iter: 0, weight: tensor([0.0572, 0.3388, 0.0034, 0.0585, 0.1698, 0.1702, 0.0159, 0.1108, 0.0674,
        0.0080])
[rfa agg] iter:  1, prev_obj_val: 65.72974395751953, obj_val: 67.67938232421875, abs dis: 1.9496383666992188
[rfa agg] iter: 1, weight: tensor([0.0687, 0.2202, 0.0036, 0.0703, 0.2655, 0.1328, 0.0174, 0.1505, 0.0625,
        0.0086])
[rfa agg] iter:  2, prev_obj_val: 67.67938232421875, obj_val: 70.61236572265625, abs dis: 2.9329833984375
[rfa agg] iter: 2, weight: tensor([0.0608, 0.0833, 0.0024, 0.0623, 0.4799, 0.0600, 0.0123, 0.1987, 0.0342,
        0.0059])
[rfa agg] iter:  3, prev_obj_val: 70.61236572265625, obj_val: 74.9546127319336, abs dis: 4.342247009277344
[rfa agg] iter: 3, weight: tensor([0.0891, 0.0673, 0.0027, 0.0919, 0.2448, 0.0519, 0.0142, 0.3989, 0.0326,
        0.0066])
[rfa agg] iter:  4, prev_obj_val: 74.9546127319336, obj_val: 77.3591079711914, abs dis: 2.4044952392578125
[rfa agg] iter: 4, weight: tensor([0.1932, 0.0682, 0.0036, 0.1992, 0.1523, 0.0552, 0.0200, 0.2619, 0.0375,
        0.0090])
[rfa agg] iter:  5, prev_obj_val: 77.3591079711914, obj_val: 83.39702606201172, abs dis: 6.0379180908203125
[rfa agg] iter: 5, weight: tensor([0.2764, 0.0563, 0.0034, 0.2867, 0.1098, 0.0464, 0.0195, 0.1603, 0.0327,
        0.0085])
[rfa agg] iter:  6, prev_obj_val: 83.39702606201172, obj_val: 80.05236053466797, abs dis: 3.34466552734375
[rfa agg] iter: 6, weight: tensor([0.3121, 0.0527, 0.0042, 0.3246, 0.0854, 0.0448, 0.0256, 0.1064, 0.0336,
        0.0106])
[rfa agg] iter:  7, prev_obj_val: 80.05236053466797, obj_val: 83.39464569091797, abs dis: 3.34228515625
[rfa agg] iter: 7, weight: tensor([0.3405, 0.0416, 0.0029, 0.3610, 0.0731, 0.0349, 0.0170, 0.0963, 0.0254,
        0.0073])
[rfa agg] iter:  8, prev_obj_val: 83.39464569091797, obj_val: 80.05193328857422, abs dis: 3.34271240234375
[rfa agg] iter: 8, weight: tensor([0.3146, 0.0517, 0.0041, 0.3290, 0.0838, 0.0440, 0.0252, 0.1041, 0.0330,
        0.0104])
[rfa agg] iter:  9, prev_obj_val: 80.05193328857422, obj_val: 83.39468383789062, abs dis: 3.3427505493164062
[rfa agg] iter: 9, weight: tensor([0.3402, 0.0415, 0.0029, 0.3620, 0.0729, 0.0348, 0.0170, 0.0961, 0.0253,
        0.0073])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3554, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.2903, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.8559091091156 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0589, Accuracy: 337/715 (47.1329%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1904, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0681, Accuracy: 122/631 (19.3344%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0399, Accuracy: 230/631 (36.4501%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.6740, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 391/1427 (27.4001%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 593/1427 (41.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1748, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 685/1475 (46.4407%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8834, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.0667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0600, Accuracy: 219/682 (32.1114%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0361, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4266, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 447/1129 (39.5926%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.7135, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1200, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3683, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0535, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0243, Accuracy: 635/1030 (61.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1720, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.7746, Accuracy: 92/10000 (0.9200%)
time spent on training: 262.4720778465271
[rfa agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 48, 34, 65, 24, 80, 37, 61, 91, 77], weight: tensor([0.0810, 0.0715, 0.1617, 0.1671, 0.0354, 0.0773, 0.1279, 0.0096, 0.1167,
        0.1518])
[rfa agg] iter:  0, prev_obj_val: 49.9755859375, obj_val: 49.9122428894043, abs dis: 0.06334304809570312
[rfa agg] iter: 0, weight: tensor([0.0955, 0.0543, 0.0905, 0.0826, 0.0142, 0.0719, 0.2018, 0.0030, 0.2711,
        0.1151])
[rfa agg] iter:  1, prev_obj_val: 49.9122428894043, obj_val: 49.91205596923828, abs dis: 0.000186920166015625
[rfa agg] iter: 1, weight: tensor([0.0941, 0.0533, 0.0888, 0.0810, 0.0140, 0.0705, 0.2003, 0.0030, 0.2822,
        0.1129])
			Update norm = 138.78135203216246 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3554, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.2903, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.69019532203674 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 418/1904 (21.9538%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 693/1904 (36.3971%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1740, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4864, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8760, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0575, Accuracy: 339/715 (47.4126%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.1016, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 270/1131 (23.8727%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2531, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0598, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1712, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0571, Accuracy: 347/1657 (20.9415%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 552/1657 (33.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9230, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0551, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0298, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.6449, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 350/1003 (34.8953%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 375/1003 (37.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.1878, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0557, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 493/1154 (42.7210%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 15.2511, Accuracy: 51/10000 (0.5100%)
time spent on training: 312.2809672355652
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 64, 84, 23, 38, 4, 0, 52, 86, 57], weight: tensor([0.1693, 0.0848, 0.1058, 0.0636, 0.1006, 0.0801, 0.1474, 0.0566, 0.0892,
        0.1026])
[rfa agg] iter:  0, prev_obj_val: 46.74694061279297, obj_val: 52.104469299316406, abs dis: 5.3575286865234375
[rfa agg] iter: 0, weight: tensor([0.0355, 0.0850, 0.1515, 0.0301, 0.2678, 0.0800, 0.0453, 0.0197, 0.1356,
        0.1495])
[rfa agg] iter:  1, prev_obj_val: 52.104469299316406, obj_val: 60.16114807128906, abs dis: 8.056678771972656
[rfa agg] iter: 1, weight: tensor([0.0283, 0.2179, 0.0707, 0.0431, 0.0940, 0.1993, 0.0340, 0.0248, 0.2190,
        0.0688])
[rfa agg] iter:  2, prev_obj_val: 60.16114807128906, obj_val: 60.15067672729492, abs dis: 0.010471343994140625
[rfa agg] iter: 2, weight: tensor([0.0342, 0.2271, 0.0669, 0.0958, 0.0794, 0.2116, 0.0396, 0.0449, 0.1354,
        0.0651])
			Update norm = 125.34137759534957 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3554, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.2903, Accuracy: 0/9950 (0.0000%)
saving model
Done in 413.9423761367798 sec.
Saving all the graphs.
This run has a label: Jun.29_07.30.30. Visdom environment: tiny
