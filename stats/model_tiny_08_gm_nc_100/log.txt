current path: saved_models/model_tiny_Jun.29_22.04.19
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 10, 30, 44, 55]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [89, 91, 69, 74, 59, 60, 29, 99, 17, 84].
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 326/896 (36.3839%)
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1580, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 328/1030 (31.8447%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 615/1030 (59.7087%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.6470, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0510, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 505/1552 (32.5387%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 762/1552 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.3872, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   1, Avg loss: 0.0538, Accuracy: 296/1089 (27.1809%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 486/1089 (44.6281%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4775, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 542/2227 (24.3377%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1002/2227 (44.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.8585, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   1, Avg loss: 0.0482, Accuracy: 449/1440 (31.1806%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 663/1440 (46.0417%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2860, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   1, Avg loss: 0.0669, Accuracy: 166/773 (21.4748%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   2, Avg loss: 0.0329, Accuracy: 373/773 (48.2536%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0904, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 377/1574 (23.9517%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 666/1574 (42.3126%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2803, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2362, Accuracy: 52/10000 (0.5200%)
time spent on training: 107.0609450340271
[rfa agg] training data poison_ratio: 0.1255561847746946  data num: [896, 1030, 590, 1552, 1089, 2227, 1440, 773, 1574, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.039236307742092066
[rfa agg] init. name: [89, 91, 69, 74, 59, 60, 29, 99, 17, 84], weight: tensor([0.0725, 0.0833, 0.0477, 0.1256, 0.0881, 0.1802, 0.1165, 0.0625, 0.1273,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 56.63448715209961, obj_val: 62.587928771972656, abs dis: 5.953441619873047
[rfa agg] iter: 0, weight: tensor([0.0467, 0.1026, 0.0186, 0.0963, 0.1526, 0.0468, 0.1433, 0.0347, 0.0977,
        0.2606])
[rfa agg] iter:  1, prev_obj_val: 62.587928771972656, obj_val: 67.14701080322266, abs dis: 4.55908203125
[rfa agg] iter: 1, weight: tensor([0.0643, 0.2261, 0.0202, 0.0531, 0.2593, 0.0329, 0.0666, 0.0438, 0.0539,
        0.1798])
[rfa agg] iter:  2, prev_obj_val: 67.14701080322266, obj_val: 72.52571868896484, abs dis: 5.3787078857421875
[rfa agg] iter: 2, weight: tensor([0.0998, 0.2847, 0.0266, 0.0535, 0.1859, 0.0355, 0.0645, 0.0635, 0.0543,
        0.1317])
[rfa agg] iter:  3, prev_obj_val: 72.52571868896484, obj_val: 69.77436828613281, abs dis: 2.7513504028320312
[rfa agg] iter: 3, weight: tensor([0.1796, 0.2075, 0.0368, 0.0563, 0.1413, 0.0395, 0.0659, 0.1023, 0.0572,
        0.1135])
[rfa agg] iter:  4, prev_obj_val: 69.77436828613281, obj_val: 72.51508331298828, abs dis: 2.7407150268554688
[rfa agg] iter: 4, weight: tensor([0.1369, 0.2479, 0.0319, 0.0561, 0.1604, 0.0383, 0.0665, 0.0819, 0.0569,
        0.1233])
[rfa agg] iter:  5, prev_obj_val: 72.51508331298828, obj_val: 72.51061248779297, abs dis: 0.0044708251953125
[rfa agg] iter: 5, weight: tensor([0.1818, 0.2054, 0.0368, 0.0563, 0.1410, 0.0395, 0.0659, 0.1026, 0.0572,
        0.1135])
			Update norm = 148.0172406026575 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.6511106491089 sec.
Server Epoch:2 choose agents : [69, 51, 47, 25, 26, 30, 90, 31, 7, 55].
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   1, Avg loss: 0.0575, Accuracy: 273/590 (46.2712%)
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4855, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 228/1049 (21.7350%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 524/1049 (49.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3943, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1215, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1105, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0581, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.3600, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 319/1446 (22.0609%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 454/1446 (31.3970%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3625, Accuracy: 65/10000 (0.6500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   1, Avg loss: 0.0817, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   2, Avg loss: 0.0420, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7181, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 305/677 (45.0517%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9174, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7318, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0542, Accuracy: 342/891 (38.3838%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 449/891 (50.3928%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1069, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   1, Avg loss: 0.0573, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6901, Accuracy: 75/10000 (0.7500%)
time spent on training: 137.72958993911743
[rfa agg] training data poison_ratio: 0.2077662129703763  data num: [590, 1049, 134, 690, 1446, 486, 677, 460, 891, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06492694155324259
[rfa agg] init. name: [69, 51, 47, 25, 26, 30, 90, 31, 7, 55], weight: tensor([0.0787, 0.1400, 0.0179, 0.0921, 0.1930, 0.0649, 0.0903, 0.0614, 0.1189,
        0.1429])
[rfa agg] iter:  0, prev_obj_val: 43.747283935546875, obj_val: 50.62209701538086, abs dis: 6.874813079833984
[rfa agg] iter: 0, weight: tensor([0.1057, 0.0781, 0.0054, 0.2231, 0.0495, 0.0451, 0.2171, 0.0425, 0.1535,
        0.0798])
[rfa agg] iter:  1, prev_obj_val: 50.62209701538086, obj_val: 53.46384811401367, abs dis: 2.8417510986328125
[rfa agg] iter: 1, weight: tensor([0.2942, 0.0455, 0.0055, 0.1892, 0.0340, 0.0703, 0.1829, 0.0653, 0.0667,
        0.0465])
[rfa agg] iter:  2, prev_obj_val: 53.46384811401367, obj_val: 56.59195327758789, abs dis: 3.1281051635742188
[rfa agg] iter: 2, weight: tensor([0.3015, 0.0475, 0.0066, 0.1493, 0.0366, 0.1032, 0.1452, 0.0956, 0.0662,
        0.0485])
[rfa agg] iter:  3, prev_obj_val: 56.59195327758789, obj_val: 63.30757522583008, abs dis: 6.7156219482421875
[rfa agg] iter: 3, weight: tensor([0.2112, 0.0505, 0.0080, 0.1295, 0.0400, 0.1646, 0.1264, 0.1502, 0.0679,
        0.0516])
[rfa agg] iter:  4, prev_obj_val: 63.30757522583008, obj_val: 63.23920440673828, abs dis: 0.06837081909179688
[rfa agg] iter: 4, weight: tensor([0.0972, 0.0391, 0.0081, 0.0764, 0.0325, 0.3219, 0.0748, 0.2605, 0.0495,
        0.0399])
[rfa agg] iter:  5, prev_obj_val: 63.23920440673828, obj_val: 63.23371124267578, abs dis: 0.0054931640625
[rfa agg] iter: 5, weight: tensor([0.0817, 0.0331, 0.0069, 0.0644, 0.0275, 0.3700, 0.0631, 0.2777, 0.0418,
        0.0338])
[rfa agg] iter:  6, prev_obj_val: 63.23371124267578, obj_val: 59.82164764404297, abs dis: 3.4120635986328125
[rfa agg] iter: 6, weight: tensor([0.0776, 0.0314, 0.0066, 0.0611, 0.0261, 0.3873, 0.0599, 0.2782, 0.0397,
        0.0321])
[rfa agg] iter:  7, prev_obj_val: 59.82164764404297, obj_val: 63.250267028808594, abs dis: 3.428619384765625
[rfa agg] iter: 7, weight: tensor([0.1267, 0.0418, 0.0077, 0.0913, 0.0340, 0.2774, 0.0893, 0.2348, 0.0543,
        0.0427])
[rfa agg] iter:  8, prev_obj_val: 63.250267028808594, obj_val: 63.23460388183594, abs dis: 0.01566314697265625
[rfa agg] iter: 8, weight: tensor([0.0859, 0.0347, 0.0073, 0.0676, 0.0288, 0.3556, 0.0662, 0.2746, 0.0438,
        0.0354])
[rfa agg] iter:  9, prev_obj_val: 63.23460388183594, obj_val: 59.82048797607422, abs dis: 3.4141159057617188
[rfa agg] iter: 9, weight: tensor([0.0787, 0.0319, 0.0067, 0.0620, 0.0265, 0.3819, 0.0607, 0.2787, 0.0402,
        0.0325])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3005, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.92164301872253 sec.
Server Epoch:3 choose agents : [81, 63, 8, 90, 20, 15, 4, 75, 0, 12].
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 235/774 (30.3618%)
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 286/774 (36.9509%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.2387, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 250/888 (28.1532%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 458/888 (51.5766%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1968, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0601, Accuracy: 220/1513 (14.5406%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 439/1513 (29.0152%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3847, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9786, Accuracy: 55/10000 (0.5500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0587, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0608, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 396/901 (43.9512%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2145, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7686, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 356/1657 (21.4846%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 518/1657 (31.2613%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6030, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   1, Avg loss: 0.0885, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.4641, Accuracy: 49/10000 (0.4900%)
time spent on training: 148.70842170715332
[rfa agg] training data poison_ratio: 0.25977859778597784  data num: [774, 888, 1513, 677, 807, 1154, 901, 776, 1657, 338]
[rfa agg] considering poison per batch poison_fraction: 0.08118081180811808
[rfa agg] init. name: [81, 63, 8, 90, 20, 15, 4, 75, 0, 12], weight: tensor([0.0816, 0.0936, 0.1595, 0.0714, 0.0851, 0.1217, 0.0950, 0.0818, 0.1747,
        0.0356])
[rfa agg] iter:  0, prev_obj_val: 46.642337799072266, obj_val: 51.01092529296875, abs dis: 4.368587493896484
[rfa agg] iter: 0, weight: tensor([0.0908, 0.1659, 0.0549, 0.0462, 0.0946, 0.0984, 0.2966, 0.0927, 0.0487,
        0.0109])
[rfa agg] iter:  1, prev_obj_val: 51.01092529296875, obj_val: 60.07315444946289, abs dis: 9.06222915649414
[rfa agg] iter: 1, weight: tensor([0.1808, 0.1503, 0.0281, 0.0660, 0.1863, 0.0389, 0.0883, 0.2255, 0.0260,
        0.0097])
[rfa agg] iter:  2, prev_obj_val: 60.07315444946289, obj_val: 67.51776885986328, abs dis: 7.444614410400391
[rfa agg] iter: 2, weight: tensor([0.1365, 0.1014, 0.0358, 0.2698, 0.1427, 0.0452, 0.0744, 0.1426, 0.0338,
        0.0178])
[rfa agg] iter:  3, prev_obj_val: 67.51776885986328, obj_val: 67.51233673095703, abs dis: 0.00543212890625
[rfa agg] iter: 3, weight: tensor([0.1056, 0.0886, 0.0399, 0.3658, 0.1105, 0.0481, 0.0703, 0.1073, 0.0381,
        0.0259])
[rfa agg] iter:  4, prev_obj_val: 67.51233673095703, obj_val: 67.51224517822266, abs dis: 9.1552734375e-05
[rfa agg] iter: 4, weight: tensor([0.1033, 0.0869, 0.0392, 0.3784, 0.1083, 0.0472, 0.0689, 0.1050, 0.0373,
        0.0255])
			Update norm = 104.47887794908596 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3005, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.9654493331909 sec.
Server Epoch:4 choose agents : [22, 69, 34, 81, 7, 25, 43, 56, 14, 68].
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 540/1470 (36.7347%)
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 820/1470 (55.7823%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9091, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   1, Avg loss: 0.0597, Accuracy: 281/590 (47.6271%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8315, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 373/1427 (26.1388%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 595/1427 (41.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8953, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   2, Avg loss: 0.0352, Accuracy: 274/774 (35.4005%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2869, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0521, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0055, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3138, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 333/946 (35.2008%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0161, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3154, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 317/1013 (31.2932%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6459, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   1, Avg loss: 0.0634, Accuracy: 357/1163 (30.6965%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7131, Accuracy: 54/10000 (0.5400%)
time spent on training: 125.97548913955688
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 590, 1427, 774, 891, 690, 946, 186, 1013, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 69, 34, 81, 7, 25, 43, 56, 14, 68], weight: tensor([0.1607, 0.0645, 0.1560, 0.0846, 0.0974, 0.0754, 0.1034, 0.0203, 0.1107,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 40.29385757446289, obj_val: 44.96076202392578, abs dis: 4.666904449462891
[rfa agg] iter: 0, weight: tensor([0.0470, 0.0301, 0.0458, 0.0942, 0.1633, 0.0438, 0.3020, 0.0039, 0.1970,
        0.0729])
[rfa agg] iter:  1, prev_obj_val: 44.96076202392578, obj_val: 52.831214904785156, abs dis: 7.870452880859375
[rfa agg] iter: 1, weight: tensor([0.0423, 0.0454, 0.0413, 0.2355, 0.2336, 0.0729, 0.1598, 0.0047, 0.1071,
        0.0573])
[rfa agg] iter:  2, prev_obj_val: 52.831214904785156, obj_val: 52.80125427246094, abs dis: 0.02996063232421875
[rfa agg] iter: 2, weight: tensor([0.0458, 0.0953, 0.0446, 0.2267, 0.1420, 0.1915, 0.1051, 0.0068, 0.0855,
        0.0567])
[rfa agg] iter:  3, prev_obj_val: 52.80125427246094, obj_val: 52.801177978515625, abs dis: 7.62939453125e-05
[rfa agg] iter: 3, weight: tensor([0.0453, 0.0953, 0.0441, 0.2265, 0.1381, 0.1995, 0.1039, 0.0068, 0.0845,
        0.0560])
			Update norm = 116.87324112981337 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3005, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.944020986557 sec.
Server Epoch:5 choose agents : [66, 95, 59, 2, 56, 22, 50, 99, 97, 88].
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 262/1402 (18.6876%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 396/1402 (28.2454%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0318, Accuracy: 77/10000 (0.7700%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 324/599 (54.0902%)
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4633, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   1, Avg loss: 0.0541, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6926, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 500/1470 (34.0136%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1080, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 134/809 (16.5637%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 345/809 (42.6452%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2013, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0682, Accuracy: 161/773 (20.8279%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0308, Accuracy: 368/773 (47.6067%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9884, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 361/1213 (29.7609%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 478/1213 (39.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7472, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 130/603 (21.5589%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8504, Accuracy: 54/10000 (0.5400%)
time spent on training: 145.31558871269226
[rfa agg] training data poison_ratio: 0.06846496742484856  data num: [1402, 599, 1089, 605, 186, 1470, 809, 773, 1213, 603]
[rfa agg] considering poison per batch poison_fraction: 0.021395302320265173
[rfa agg] init. name: [66, 95, 59, 2, 56, 22, 50, 99, 97, 88], weight: tensor([0.1602, 0.0685, 0.1245, 0.0692, 0.0213, 0.1680, 0.0925, 0.0884, 0.1386,
        0.0689])
[rfa agg] iter:  0, prev_obj_val: 46.10334396362305, obj_val: 47.79804611206055, abs dis: 1.6947021484375
[rfa agg] iter: 0, weight: tensor([0.0933, 0.0558, 0.1581, 0.0563, 0.0071, 0.0860, 0.1784, 0.1694, 0.1393,
        0.0563])
[rfa agg] iter:  1, prev_obj_val: 47.79804611206055, obj_val: 52.01504898071289, abs dis: 4.217002868652344
[rfa agg] iter: 1, weight: tensor([0.0669, 0.0566, 0.1007, 0.0572, 0.0063, 0.0626, 0.2591, 0.2410, 0.0921,
        0.0573])
[rfa agg] iter:  2, prev_obj_val: 52.01504898071289, obj_val: 56.67140197753906, abs dis: 4.656352996826172
[rfa agg] iter: 2, weight: tensor([0.0439, 0.0684, 0.0578, 0.0691, 0.0057, 0.0418, 0.3075, 0.2806, 0.0554,
        0.0698])
[rfa agg] iter:  3, prev_obj_val: 56.67140197753906, obj_val: 59.0975456237793, abs dis: 2.4261436462402344
[rfa agg] iter: 3, weight: tensor([0.0498, 0.1329, 0.0616, 0.1342, 0.0079, 0.0478, 0.1886, 0.1787, 0.0602,
        0.1383])
[rfa agg] iter:  4, prev_obj_val: 59.0975456237793, obj_val: 64.63375854492188, abs dis: 5.536212921142578
[rfa agg] iter: 4, weight: tensor([0.0445, 0.1742, 0.0536, 0.1755, 0.0078, 0.0428, 0.1345, 0.1284, 0.0529,
        0.1858])
[rfa agg] iter:  5, prev_obj_val: 64.63375854492188, obj_val: 68.27619171142578, abs dis: 3.6424331665039062
[rfa agg] iter: 5, weight: tensor([0.0277, 0.2296, 0.0319, 0.2285, 0.0060, 0.0268, 0.0623, 0.0596, 0.0319,
        0.2957])
[rfa agg] iter:  6, prev_obj_val: 68.27619171142578, obj_val: 68.27558135986328, abs dis: 0.0006103515625
[rfa agg] iter: 6, weight: tensor([0.0320, 0.2300, 0.0362, 0.2276, 0.0077, 0.0311, 0.0645, 0.0618, 0.0364,
        0.2725])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.2998, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.3164, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.00971388816833 sec.
Server Epoch:6 choose agents : [45, 90, 0, 20, 60, 91, 57, 35, 47, 74].
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 193/669 (28.8490%)
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.8245, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   1, Avg loss: 0.0589, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 429/677 (63.3678%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1675, Accuracy: 59/10000 (0.5900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 349/1657 (21.0622%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 513/1657 (30.9596%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7290, Accuracy: 74/10000 (0.7400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 429/807 (53.1599%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 577/2227 (25.9093%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1054/2227 (47.3282%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3348, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 634/1030 (61.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1886, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   1, Avg loss: 0.0566, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 444/1154 (38.4749%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.1048, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3852, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   2, Avg loss: 0.1093, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3170, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 481/1552 (30.9923%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.7920, Accuracy: 88/10000 (0.8800%)
time spent on training: 166.72750616073608
[rfa agg] training data poison_ratio: 0.39457653763018274  data num: [669, 677, 1657, 807, 2227, 1030, 1154, 271, 134, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.12330516800943211
[rfa agg] init. name: [45, 90, 0, 20, 60, 91, 57, 35, 47, 74], weight: tensor([0.0657, 0.0665, 0.1628, 0.0793, 0.2188, 0.1012, 0.1134, 0.0266, 0.0132,
        0.1525])
[rfa agg] iter:  0, prev_obj_val: 70.47168731689453, obj_val: 72.95577239990234, abs dis: 2.4840850830078125
[rfa agg] iter: 0, weight: tensor([0.0356, 0.0360, 0.1504, 0.0542, 0.0777, 0.1431, 0.3199, 0.0088, 0.0038,
        0.1704])
[rfa agg] iter:  1, prev_obj_val: 72.95577239990234, obj_val: 75.60218048095703, abs dis: 2.6464080810546875
[rfa agg] iter: 1, weight: tensor([0.0326, 0.0330, 0.0804, 0.0532, 0.0494, 0.2098, 0.4444, 0.0073, 0.0031,
        0.0867])
[rfa agg] iter:  2, prev_obj_val: 75.60218048095703, obj_val: 81.03902435302734, abs dis: 5.4368438720703125
[rfa agg] iter: 2, weight: tensor([0.0394, 0.0399, 0.0746, 0.0679, 0.0491, 0.3663, 0.2719, 0.0083, 0.0035,
        0.0791])
[rfa agg] iter:  3, prev_obj_val: 81.03902435302734, obj_val: 81.02252960205078, abs dis: 0.0164947509765625
[rfa agg] iter: 3, weight: tensor([0.0598, 0.0605, 0.0746, 0.1169, 0.0530, 0.3751, 0.1671, 0.0110, 0.0046,
        0.0775])
			Update norm = 149.33966632311726 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.2998, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3164, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.4821767807007 sec.
Server Epoch:7 choose agents : [59, 65, 35, 25, 75, 57, 85, 89, 11, 97].
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 310/1089 (28.4665%)
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 449/1089 (41.2305%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.2653, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 409/1475 (27.7288%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 653/1475 (44.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0346, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0863, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0575, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0285, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3969, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   2, Avg loss: 0.0327, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8083, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   1, Avg loss: 0.0567, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 414/1154 (35.8752%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.6152, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 462/1988 (23.2394%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 661/1988 (33.2495%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4503, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 327/896 (36.4955%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   1, Avg loss: 0.0557, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 406/712 (57.0225%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.4371, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 364/1213 (30.0082%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8412, Accuracy: 65/10000 (0.6500%)
time spent on training: 133.0162959098816
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1475, 271, 690, 776, 1154, 1988, 896, 712, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 65, 35, 25, 75, 57, 85, 89, 11, 97], weight: tensor([0.1061, 0.1437, 0.0264, 0.0672, 0.0756, 0.1124, 0.1937, 0.0873, 0.0694,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 55.872650146484375, obj_val: 60.22650909423828, abs dis: 4.353858947753906
[rfa agg] iter: 0, weight: tensor([0.2614, 0.0710, 0.0076, 0.0390, 0.0650, 0.1748, 0.0451, 0.0983, 0.0481,
        0.1897])
[rfa agg] iter:  1, prev_obj_val: 60.22650909423828, obj_val: 61.76697540283203, abs dis: 1.54046630859375
[rfa agg] iter: 1, weight: tensor([0.1614, 0.0672, 0.0100, 0.0592, 0.1159, 0.1241, 0.0470, 0.2053, 0.0780,
        0.1320])
[rfa agg] iter:  2, prev_obj_val: 61.76697540283203, obj_val: 65.23351287841797, abs dis: 3.4665374755859375
[rfa agg] iter: 2, weight: tensor([0.1268, 0.0595, 0.0098, 0.0622, 0.1339, 0.1024, 0.0427, 0.2692, 0.0850,
        0.1086])
[rfa agg] iter:  3, prev_obj_val: 65.23351287841797, obj_val: 72.72227478027344, abs dis: 7.488761901855469
[rfa agg] iter: 3, weight: tensor([0.0729, 0.0404, 0.0082, 0.0618, 0.1760, 0.0623, 0.0304, 0.3884, 0.0936,
        0.0659])
[rfa agg] iter:  4, prev_obj_val: 72.72227478027344, obj_val: 82.92438507080078, abs dis: 10.202110290527344
[rfa agg] iter: 4, weight: tensor([0.0542, 0.0355, 0.0099, 0.1158, 0.2565, 0.0488, 0.0284, 0.1569, 0.2426,
        0.0515])
[rfa agg] iter:  5, prev_obj_val: 82.92438507080078, obj_val: 86.8626708984375, abs dis: 3.9382858276367188
[rfa agg] iter: 5, weight: tensor([0.0498, 0.0366, 0.0142, 0.3512, 0.1211, 0.0463, 0.0306, 0.0939, 0.2076,
        0.0488])
[rfa agg] iter:  6, prev_obj_val: 86.8626708984375, obj_val: 79.1752700805664, abs dis: 7.687400817871094
[rfa agg] iter: 6, weight: tensor([0.0534, 0.0405, 0.0177, 0.3802, 0.1113, 0.0500, 0.0343, 0.0928, 0.1670,
        0.0527])
[rfa agg] iter:  7, prev_obj_val: 79.1752700805664, obj_val: 82.86795043945312, abs dis: 3.6926803588867188
[rfa agg] iter: 7, weight: tensor([0.0465, 0.0330, 0.0115, 0.2942, 0.1319, 0.0428, 0.0272, 0.0960, 0.2716,
        0.0452])
[rfa agg] iter:  8, prev_obj_val: 82.86795043945312, obj_val: 82.85151672363281, abs dis: 0.0164337158203125
[rfa agg] iter: 8, weight: tensor([0.0453, 0.0333, 0.0129, 0.4101, 0.1086, 0.0421, 0.0279, 0.0851, 0.1903,
        0.0444])
[rfa agg] iter:  9, prev_obj_val: 82.85151672363281, obj_val: 79.18608856201172, abs dis: 3.6654281616210938
[rfa agg] iter: 9, weight: tensor([0.0420, 0.0309, 0.0120, 0.4583, 0.1001, 0.0390, 0.0258, 0.0788, 0.1718,
        0.0412])
			Update norm = 110.90648774277139 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.2998, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.3164, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.6154043674469 sec.
Server Epoch:8 choose agents : [69, 25, 14, 1, 63, 31, 49, 18, 13, 67].
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   1, Avg loss: 0.0542, Accuracy: 287/590 (48.6441%)
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4792, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3679, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 327/1013 (32.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.7277, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 554/928 (59.6983%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6092, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0554, Accuracy: 250/888 (28.1532%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 386/888 (43.4685%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9248, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   1, Avg loss: 0.0793, Accuracy: 74/460 (16.0870%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   1, Avg loss: 0.0814, Accuracy: 13/440 (2.9545%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   2, Avg loss: 0.0493, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.5466, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2348, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 296/1645 (17.9939%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 606/1645 (36.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2542, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   2, Avg loss: 0.0432, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.5968, Accuracy: 50/10000 (0.5000%)
time spent on training: 126.0815258026123
[rfa agg] training data poison_ratio: 0.0  data num: [590, 690, 1013, 928, 888, 460, 440, 530, 1645, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 25, 14, 1, 63, 31, 49, 18, 13, 67], weight: tensor([0.0775, 0.0907, 0.1331, 0.1219, 0.1167, 0.0604, 0.0578, 0.0696, 0.2162,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 49.323516845703125, obj_val: 54.38140869140625, abs dis: 5.057891845703125
[rfa agg] iter: 0, weight: tensor([0.1170, 0.2415, 0.1035, 0.1247, 0.1735, 0.0474, 0.0363, 0.0721, 0.0490,
        0.0351])
[rfa agg] iter:  1, prev_obj_val: 54.38140869140625, obj_val: 64.63188934326172, abs dis: 10.250480651855469
[rfa agg] iter: 1, weight: tensor([0.2996, 0.1916, 0.0526, 0.0577, 0.0688, 0.0687, 0.0447, 0.1409, 0.0323,
        0.0431])
[rfa agg] iter:  2, prev_obj_val: 64.63188934326172, obj_val: 71.59638977050781, abs dis: 6.964500427246094
[rfa agg] iter: 2, weight: tensor([0.0950, 0.0745, 0.0415, 0.0434, 0.0484, 0.2779, 0.1210, 0.1544, 0.0301,
        0.1140])
[rfa agg] iter:  3, prev_obj_val: 71.59638977050781, obj_val: 67.89167022705078, abs dis: 3.7047195434570312
[rfa agg] iter: 3, weight: tensor([0.0638, 0.0560, 0.0368, 0.0379, 0.0415, 0.1420, 0.2732, 0.0851, 0.0285,
        0.2351])
[rfa agg] iter:  4, prev_obj_val: 67.89167022705078, obj_val: 71.5552978515625, abs dis: 3.6636276245117188
[rfa agg] iter: 4, weight: tensor([0.0717, 0.0603, 0.0369, 0.0383, 0.0422, 0.2165, 0.2115, 0.1040, 0.0277,
        0.1910])
[rfa agg] iter:  5, prev_obj_val: 71.5552978515625, obj_val: 64.5870132446289, abs dis: 6.968284606933594
[rfa agg] iter: 5, weight: tensor([0.0590, 0.0519, 0.0341, 0.0352, 0.0384, 0.1307, 0.2955, 0.0785, 0.0264,
        0.2503])
[rfa agg] iter:  6, prev_obj_val: 64.5870132446289, obj_val: 67.8949966430664, abs dis: 3.3079833984375
[rfa agg] iter: 6, weight: tensor([0.0856, 0.0678, 0.0380, 0.0398, 0.0443, 0.3146, 0.1240, 0.1414, 0.0276,
        0.1170])
[rfa agg] iter:  7, prev_obj_val: 67.8949966430664, obj_val: 71.56156158447266, abs dis: 3.66656494140625
[rfa agg] iter: 7, weight: tensor([0.0734, 0.0616, 0.0377, 0.0391, 0.0431, 0.2397, 0.1938, 0.1074, 0.0283,
        0.1761])
[rfa agg] iter:  8, prev_obj_val: 71.56156158447266, obj_val: 64.58428192138672, abs dis: 6.9772796630859375
[rfa agg] iter: 8, weight: tensor([0.0599, 0.0527, 0.0346, 0.0357, 0.0390, 0.1331, 0.2909, 0.0797, 0.0268,
        0.2477])
[rfa agg] iter:  9, prev_obj_val: 64.58428192138672, obj_val: 67.89507293701172, abs dis: 3.310791015625
[rfa agg] iter: 9, weight: tensor([0.0855, 0.0677, 0.0380, 0.0397, 0.0442, 0.3154, 0.1237, 0.1414, 0.0276,
        0.1167])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3010, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.19230484962463 sec.
Server Epoch:9 choose agents : [40, 90, 65, 14, 93, 30, 56, 82, 39, 99].
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 384/1573 (24.4120%)
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 571/1573 (36.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7799, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 381/1475 (25.8305%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 643/1475 (43.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9941, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 326/1013 (32.1816%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6012, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0564, Accuracy: 433/1742 (24.8565%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 684/1742 (39.2652%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8330, Accuracy: 86/10000 (0.8600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   1, Avg loss: 0.0770, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8481, Accuracy: 38/10000 (0.3800%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3225, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 63/500 (12.6000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.7665, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   1, Avg loss: 0.0546, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 452/1013 (44.6199%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4322, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0676, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 393/773 (50.8409%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2284, Accuracy: 49/10000 (0.4900%)
time spent on training: 150.29583740234375
[rfa agg] training data poison_ratio: 0.05149396058486968  data num: [1573, 677, 1475, 1013, 1742, 486, 186, 500, 1013, 773]
[rfa agg] considering poison per batch poison_fraction: 0.016091862682771775
[rfa agg] init. name: [40, 90, 65, 14, 93, 30, 56, 82, 39, 99], weight: tensor([0.1667, 0.0717, 0.1563, 0.1073, 0.1846, 0.0515, 0.0197, 0.0530, 0.1073,
        0.0819])
[rfa agg] iter:  0, prev_obj_val: 60.34356689453125, obj_val: 66.27017974853516, abs dis: 5.926612854003906
[rfa agg] iter: 0, weight: tensor([0.0760, 0.0436, 0.0809, 0.3039, 0.0613, 0.0209, 0.0051, 0.0215, 0.3129,
        0.0740])
[rfa agg] iter:  1, prev_obj_val: 66.27017974853516, obj_val: 72.46471405029297, abs dis: 6.1945343017578125
[rfa agg] iter: 1, weight: tensor([0.0598, 0.0762, 0.0618, 0.2477, 0.0515, 0.0297, 0.0064, 0.0305, 0.2507,
        0.1857])
[rfa agg] iter:  2, prev_obj_val: 72.46471405029297, obj_val: 74.87831115722656, abs dis: 2.4135971069335938
[rfa agg] iter: 2, weight: tensor([0.0464, 0.1151, 0.0473, 0.1166, 0.0411, 0.0341, 0.0064, 0.0350, 0.1173,
        0.4406])
[rfa agg] iter:  3, prev_obj_val: 74.87831115722656, obj_val: 72.36386108398438, abs dis: 2.5144500732421875
[rfa agg] iter: 3, weight: tensor([0.0450, 0.1516, 0.0457, 0.1008, 0.0402, 0.0382, 0.0068, 0.0392, 0.1016,
        0.4308])
[rfa agg] iter:  4, prev_obj_val: 72.36386108398438, obj_val: 77.58345794677734, abs dis: 5.219596862792969
[rfa agg] iter: 4, weight: tensor([0.0377, 0.0942, 0.0384, 0.0934, 0.0334, 0.0277, 0.0052, 0.0285, 0.0945,
        0.5469])
[rfa agg] iter:  5, prev_obj_val: 77.58345794677734, obj_val: 77.54351806640625, abs dis: 0.03993988037109375
[rfa agg] iter: 5, weight: tensor([0.0498, 0.2396, 0.0504, 0.1019, 0.0448, 0.0492, 0.0083, 0.0504, 0.1026,
        0.3030])
[rfa agg] iter:  6, prev_obj_val: 77.54351806640625, obj_val: 77.54330444335938, abs dis: 0.000213623046875
[rfa agg] iter: 6, weight: tensor([0.0499, 0.2543, 0.0506, 0.1024, 0.0449, 0.0495, 0.0083, 0.0508, 0.1030,
        0.2863])
			Update norm = 113.96395571901232 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3010, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.35390043258667 sec.
Server Epoch:10 choose agents : [77, 16, 60, 47, 94, 33, 61, 95, 30, 6].
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   1, Avg loss: 0.0546, Accuracy: 335/1340 (25.0000%)
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 518/1340 (38.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5672, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8968, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 588/2227 (26.4032%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1019/2227 (45.7566%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2393, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   2, Avg loss: 0.1085, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3196, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 333/1662 (20.0361%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 614/1662 (36.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8357, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8256, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0268, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9244, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0778, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9312, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 423/1956 (21.6258%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 638/1956 (32.6176%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.5378, Accuracy: 104/10000 (1.0400%)
time spent on training: 156.21711325645447
[rfa agg] training data poison_ratio: 0.1117174629324547  data num: [1340, 708, 2227, 134, 1662, 515, 85, 599, 486, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034911707166392095
[rfa agg] init. name: [77, 16, 60, 47, 94, 33, 61, 95, 30, 6], weight: tensor([0.1380, 0.0729, 0.2293, 0.0138, 0.1711, 0.0530, 0.0088, 0.0617, 0.0500,
        0.2014])
[rfa agg] iter:  0, prev_obj_val: 81.8565673828125, obj_val: 84.5347671508789, abs dis: 2.6781997680664062
[rfa agg] iter: 0, weight: tensor([0.5557, 0.0349, 0.0773, 0.0034, 0.1698, 0.0193, 0.0020, 0.0244, 0.0169,
        0.0962])
[rfa agg] iter:  1, prev_obj_val: 84.5347671508789, obj_val: 86.5455551147461, abs dis: 2.0107879638671875
[rfa agg] iter: 1, weight: tensor([0.6767, 0.0308, 0.0569, 0.0028, 0.1103, 0.0166, 0.0017, 0.0211, 0.0144,
        0.0687])
[rfa agg] iter:  2, prev_obj_val: 86.5455551147461, obj_val: 84.5145034790039, abs dis: 2.0310516357421875
[rfa agg] iter: 2, weight: tensor([0.5972, 0.0419, 0.0707, 0.0037, 0.1298, 0.0223, 0.0022, 0.0285, 0.0193,
        0.0843])
[rfa agg] iter:  3, prev_obj_val: 84.5145034790039, obj_val: 86.5486068725586, abs dis: 2.0341033935546875
[rfa agg] iter: 3, weight: tensor([0.6899, 0.0295, 0.0546, 0.0027, 0.1056, 0.0159, 0.0016, 0.0203, 0.0138,
        0.0659])
[rfa agg] iter:  4, prev_obj_val: 86.5486068725586, obj_val: 84.51405334472656, abs dis: 2.0345535278320312
[rfa agg] iter: 4, weight: tensor([0.5985, 0.0418, 0.0705, 0.0037, 0.1294, 0.0222, 0.0022, 0.0284, 0.0192,
        0.0840])
[rfa agg] iter:  5, prev_obj_val: 84.51405334472656, obj_val: 86.54869079589844, abs dis: 2.034637451171875
[rfa agg] iter: 5, weight: tensor([0.6903, 0.0295, 0.0545, 0.0027, 0.1055, 0.0159, 0.0016, 0.0203, 0.0138,
        0.0659])
[rfa agg] iter:  6, prev_obj_val: 86.54869079589844, obj_val: 84.51404571533203, abs dis: 2.0346450805664062
[rfa agg] iter: 6, weight: tensor([0.5986, 0.0418, 0.0705, 0.0037, 0.1294, 0.0222, 0.0022, 0.0284, 0.0192,
        0.0840])
[rfa agg] iter:  7, prev_obj_val: 84.51404571533203, obj_val: 86.54869079589844, abs dis: 2.0346450805664062
[rfa agg] iter: 7, weight: tensor([0.6903, 0.0295, 0.0545, 0.0027, 0.1055, 0.0159, 0.0016, 0.0203, 0.0138,
        0.0659])
[rfa agg] iter:  8, prev_obj_val: 86.54869079589844, obj_val: 84.51404571533203, abs dis: 2.0346450805664062
[rfa agg] iter: 8, weight: tensor([0.5986, 0.0418, 0.0705, 0.0037, 0.1294, 0.0222, 0.0022, 0.0284, 0.0192,
        0.0840])
[rfa agg] iter:  9, prev_obj_val: 84.51404571533203, obj_val: 86.54869079589844, abs dis: 2.0346450805664062
[rfa agg] iter: 9, weight: tensor([0.6903, 0.0295, 0.0545, 0.0027, 0.1055, 0.0159, 0.0016, 0.0203, 0.0138,
        0.0659])
			Update norm = 183.50316116146337 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3010, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.6360967159271 sec.
Server Epoch:11 choose agents : [26, 84, 32, 6, 99, 13, 93, 12, 28, 15].
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2028, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4509, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0616, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 365/735 (49.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9701, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 623/1956 (31.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1966, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 183/773 (23.6740%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5180, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 314/1645 (19.0881%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 611/1645 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.2486, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0558, Accuracy: 413/1742 (23.7084%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 683/1742 (39.2078%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8260, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0878, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4819, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 566/1581 (35.8001%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7265, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 323/1154 (27.9896%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0442, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.1895272731781
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 1190, 735, 1956, 773, 1645, 1742, 338, 1581, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 84, 32, 6, 99, 13, 93, 12, 28, 15], weight: tensor([0.1151, 0.0947, 0.0585, 0.1557, 0.0615, 0.1310, 0.1387, 0.0269, 0.1259,
        0.0919])
[rfa agg] iter:  0, prev_obj_val: 53.6529541015625, obj_val: 56.95127868652344, abs dis: 3.2983245849609375
[rfa agg] iter: 0, weight: tensor([0.1741, 0.2067, 0.0277, 0.0598, 0.0330, 0.0948, 0.0742, 0.0075, 0.1111,
        0.2111])
[rfa agg] iter:  1, prev_obj_val: 56.95127868652344, obj_val: 67.35205841064453, abs dis: 10.400779724121094
[rfa agg] iter: 1, weight: tensor([0.1041, 0.2829, 0.0254, 0.0441, 0.0307, 0.0651, 0.0530, 0.0065, 0.0738,
        0.3144])
[rfa agg] iter:  2, prev_obj_val: 67.35205841064453, obj_val: 64.3505630493164, abs dis: 3.001495361328125
[rfa agg] iter: 2, weight: tensor([0.0967, 0.2555, 0.0495, 0.0541, 0.0629, 0.0718, 0.0618, 0.0109, 0.0782,
        0.2588])
[rfa agg] iter:  3, prev_obj_val: 64.3505630493164, obj_val: 61.4897575378418, abs dis: 2.8608055114746094
[rfa agg] iter: 3, weight: tensor([0.0905, 0.2816, 0.0388, 0.0479, 0.0486, 0.0650, 0.0553, 0.0089, 0.0714,
        0.2920])
[rfa agg] iter:  4, prev_obj_val: 61.4897575378418, obj_val: 67.35712432861328, abs dis: 5.867366790771484
[rfa agg] iter: 4, weight: tensor([0.0815, 0.3056, 0.0292, 0.0406, 0.0361, 0.0564, 0.0474, 0.0070, 0.0625,
        0.3337])
[rfa agg] iter:  5, prev_obj_val: 67.35712432861328, obj_val: 64.35042572021484, abs dis: 3.0066986083984375
[rfa agg] iter: 5, weight: tensor([0.0964, 0.2567, 0.0493, 0.0539, 0.0627, 0.0716, 0.0616, 0.0109, 0.0780,
        0.2589])
[rfa agg] iter:  6, prev_obj_val: 64.35042572021484, obj_val: 61.48975372314453, abs dis: 2.8606719970703125
[rfa agg] iter: 6, weight: tensor([0.0904, 0.2818, 0.0388, 0.0479, 0.0486, 0.0650, 0.0553, 0.0089, 0.0714,
        0.2919])
[rfa agg] iter:  7, prev_obj_val: 61.48975372314453, obj_val: 67.35712432861328, abs dis: 5.86737060546875
[rfa agg] iter: 7, weight: tensor([0.0815, 0.3057, 0.0292, 0.0406, 0.0361, 0.0564, 0.0474, 0.0070, 0.0625,
        0.3337])
[rfa agg] iter:  8, prev_obj_val: 67.35712432861328, obj_val: 64.35042572021484, abs dis: 3.0066986083984375
[rfa agg] iter: 8, weight: tensor([0.0964, 0.2567, 0.0493, 0.0539, 0.0627, 0.0716, 0.0616, 0.0109, 0.0780,
        0.2589])
[rfa agg] iter:  9, prev_obj_val: 64.35042572021484, obj_val: 61.4897575378418, abs dis: 2.860668182373047
[rfa agg] iter: 9, weight: tensor([0.0904, 0.2818, 0.0388, 0.0479, 0.0486, 0.0650, 0.0553, 0.0089, 0.0714,
        0.2919])
			Update norm = 170.32092295685518 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3010, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.50988841056824 sec.
Server Epoch:12 choose agents : [39, 86, 0, 34, 36, 92, 67, 30, 23, 15].
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 509/1013 (50.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5767, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0640, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6287, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 365/1657 (22.0278%)
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1657 (30.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6824, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 383/1427 (26.8395%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 595/1427 (41.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7469, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0553, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.5379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 457/1715 (26.6472%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 686/1715 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7935, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   1, Avg loss: 0.0783, Accuracy: 55/426 (12.9108%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.6441, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0779, Accuracy: 71/486 (14.6091%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9732, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   2, Avg loss: 0.0306, Accuracy: 383/1154 (33.1889%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6789, Accuracy: 51/10000 (0.5100%)
time spent on training: 161.96048069000244
[rfa agg] training data poison_ratio: 0.21421431427429027  data num: [1013, 1003, 1657, 1427, 408, 1715, 426, 486, 715, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06694197321071571
[rfa agg] init. name: [39, 86, 0, 34, 36, 92, 67, 30, 23, 15], weight: tensor([0.1013, 0.1003, 0.1656, 0.1426, 0.0408, 0.1714, 0.0426, 0.0486, 0.0715,
        0.1154])
[rfa agg] iter:  0, prev_obj_val: 55.85730743408203, obj_val: 58.252193450927734, abs dis: 2.394886016845703
[rfa agg] iter: 0, weight: tensor([0.2629, 0.2639, 0.0621, 0.0794, 0.0138, 0.0579, 0.0144, 0.0182, 0.0479,
        0.1795])
[rfa agg] iter:  1, prev_obj_val: 58.252193450927734, obj_val: 58.21194076538086, abs dis: 0.040252685546875
[rfa agg] iter: 1, weight: tensor([0.3469, 0.3551, 0.0402, 0.0492, 0.0110, 0.0379, 0.0115, 0.0148, 0.0429,
        0.0906])
[rfa agg] iter:  2, prev_obj_val: 58.21194076538086, obj_val: 65.19607543945312, abs dis: 6.984134674072266
[rfa agg] iter: 2, weight: tensor([0.3569, 0.3630, 0.0379, 0.0463, 0.0104, 0.0357, 0.0108, 0.0139, 0.0404,
        0.0846])
[rfa agg] iter:  3, prev_obj_val: 65.19607543945312, obj_val: 62.64844512939453, abs dis: 2.5476303100585938
[rfa agg] iter: 3, weight: tensor([0.2594, 0.2578, 0.0600, 0.0696, 0.0225, 0.0572, 0.0235, 0.0310, 0.1140,
        0.1050])
[rfa agg] iter:  4, prev_obj_val: 62.64844512939453, obj_val: 67.7713394165039, abs dis: 5.122894287109375
[rfa agg] iter: 4, weight: tensor([0.2968, 0.2928, 0.0533, 0.0628, 0.0180, 0.0506, 0.0188, 0.0245, 0.0824,
        0.1000])
[rfa agg] iter:  5, prev_obj_val: 67.7713394165039, obj_val: 62.65802001953125, abs dis: 5.113319396972656
[rfa agg] iter: 5, weight: tensor([0.2243, 0.2219, 0.0642, 0.0734, 0.0269, 0.0614, 0.0281, 0.0374, 0.1564,
        0.1060])
[rfa agg] iter:  6, prev_obj_val: 62.65802001953125, obj_val: 67.7710189819336, abs dis: 5.112998962402344
[rfa agg] iter: 6, weight: tensor([0.2962, 0.2907, 0.0536, 0.0631, 0.0181, 0.0509, 0.0189, 0.0247, 0.0831,
        0.1006])
[rfa agg] iter:  7, prev_obj_val: 67.7710189819336, obj_val: 62.65802764892578, abs dis: 5.1129913330078125
[rfa agg] iter: 7, weight: tensor([0.2243, 0.2219, 0.0642, 0.0734, 0.0269, 0.0614, 0.0281, 0.0374, 0.1564,
        0.1060])
[rfa agg] iter:  8, prev_obj_val: 62.65802764892578, obj_val: 67.7710189819336, abs dis: 5.1129913330078125
[rfa agg] iter: 8, weight: tensor([0.2962, 0.2907, 0.0536, 0.0631, 0.0181, 0.0509, 0.0189, 0.0247, 0.0831,
        0.1006])
[rfa agg] iter:  9, prev_obj_val: 67.7710189819336, obj_val: 62.65802764892578, abs dis: 5.1129913330078125
[rfa agg] iter: 9, weight: tensor([0.2243, 0.2219, 0.0642, 0.0734, 0.0269, 0.0614, 0.0281, 0.0374, 0.1564,
        0.1060])
			Update norm = 139.77089233366868 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3010, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 329.18855452537537 sec.
Server Epoch:13 choose agents : [38, 81, 76, 16, 60, 7, 18, 54, 50, 25].
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4447, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   1, Avg loss: 0.0673, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 291/774 (37.5969%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1824, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 43/466 (9.2275%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7488, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0648, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9528, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0503, Accuracy: 548/2227 (24.6071%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1028/2227 (46.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1689, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 355/891 (39.8429%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 448/891 (50.2806%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1580, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 112/530 (21.1321%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1947, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7766, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 156/809 (19.2831%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1608, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4949, Accuracy: 55/10000 (0.5500%)
time spent on training: 145.36349034309387
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 774, 466, 708, 2227, 891, 530, 1130, 809, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 81, 76, 16, 60, 7, 18, 54, 50, 25], weight: tensor([0.1209, 0.0827, 0.0498, 0.0757, 0.2380, 0.0952, 0.0566, 0.1208, 0.0865,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 65.2672348022461, obj_val: 64.71302032470703, abs dis: 0.5542144775390625
[rfa agg] iter: 0, weight: tensor([0.2519, 0.0834, 0.0210, 0.0595, 0.0463, 0.1292, 0.0271, 0.2465, 0.0872,
        0.0480])
[rfa agg] iter:  1, prev_obj_val: 64.71302032470703, obj_val: 73.09896087646484, abs dis: 8.385940551757812
[rfa agg] iter: 1, weight: tensor([0.0981, 0.1424, 0.0220, 0.0829, 0.0336, 0.2827, 0.0296, 0.0977, 0.1511,
        0.0599])
[rfa agg] iter:  2, prev_obj_val: 73.09896087646484, obj_val: 82.56216430664062, abs dis: 9.463203430175781
[rfa agg] iter: 2, weight: tensor([0.0473, 0.1290, 0.0356, 0.2027, 0.0259, 0.0943, 0.0557, 0.0472, 0.1362,
        0.2261])
[rfa agg] iter:  3, prev_obj_val: 82.56216430664062, obj_val: 86.06157684326172, abs dis: 3.4994125366210938
[rfa agg] iter: 3, weight: tensor([0.0517, 0.0929, 0.0806, 0.1240, 0.0327, 0.0800, 0.1628, 0.0516, 0.0970,
        0.2267])
[rfa agg] iter:  4, prev_obj_val: 86.06157684326172, obj_val: 82.55291748046875, abs dis: 3.5086593627929688
[rfa agg] iter: 4, weight: tensor([0.0493, 0.0810, 0.1060, 0.1016, 0.0325, 0.0723, 0.2608, 0.0492, 0.0845,
        0.1629])
[rfa agg] iter:  5, prev_obj_val: 82.55291748046875, obj_val: 82.54521179199219, abs dis: 0.0077056884765625
[rfa agg] iter: 5, weight: tensor([0.0512, 0.0919, 0.0812, 0.1215, 0.0324, 0.0792, 0.1734, 0.0511, 0.0957,
        0.2223])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3027, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.3374, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.7060513496399 sec.
Server Epoch:14 choose agents : [75, 69, 70, 66, 36, 76, 88, 65, 89, 30].
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1578, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 298/590 (50.5085%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0944, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/1418 (24.3300%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 675/1418 (47.6023%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6767, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 265/1402 (18.9016%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 402/1402 (28.6733%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2680, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0563, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6317, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8548, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   1, Avg loss: 0.0732, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2748, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 386/1475 (26.1695%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 676/1475 (45.8305%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8532, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 331/896 (36.9420%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 447/896 (49.8884%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.3730, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   1, Avg loss: 0.0768, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.0034, Accuracy: 37/10000 (0.3700%)
time spent on training: 149.52211380004883
[rfa agg] training data poison_ratio: 0.05704225352112676  data num: [776, 590, 1418, 1402, 408, 466, 603, 1475, 896, 486]
[rfa agg] considering poison per batch poison_fraction: 0.017825704225352113
[rfa agg] init. name: [75, 69, 70, 66, 36, 76, 88, 65, 89, 30], weight: tensor([0.0911, 0.0692, 0.1664, 0.1646, 0.0479, 0.0547, 0.0708, 0.1731, 0.1052,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 56.831573486328125, obj_val: 60.074100494384766, abs dis: 3.2425270080566406
[rfa agg] iter: 0, weight: tensor([0.2316, 0.0543, 0.0585, 0.0650, 0.0216, 0.0288, 0.0556, 0.0548, 0.3997,
        0.0301])
[rfa agg] iter:  1, prev_obj_val: 60.074100494384766, obj_val: 65.32049560546875, abs dis: 5.246395111083984
[rfa agg] iter: 1, weight: tensor([0.3477, 0.0871, 0.0512, 0.0559, 0.0280, 0.0389, 0.0884, 0.0486, 0.2135,
        0.0407])
[rfa agg] iter:  2, prev_obj_val: 65.32049560546875, obj_val: 67.13533782958984, abs dis: 1.8148422241210938
[rfa agg] iter: 2, weight: tensor([0.1537, 0.2040, 0.0484, 0.0522, 0.0411, 0.0620, 0.2079, 0.0464, 0.1192,
        0.0651])
[rfa agg] iter:  3, prev_obj_val: 67.13533782958984, obj_val: 78.0207290649414, abs dis: 10.885391235351562
[rfa agg] iter: 3, weight: tensor([0.0979, 0.2714, 0.0371, 0.0398, 0.0376, 0.0593, 0.2771, 0.0357, 0.0819,
        0.0623])
[rfa agg] iter:  4, prev_obj_val: 78.0207290649414, obj_val: 81.2373275756836, abs dis: 3.2165985107421875
[rfa agg] iter: 4, weight: tensor([0.0585, 0.1293, 0.0336, 0.0356, 0.0865, 0.2038, 0.1322, 0.0327, 0.0555,
        0.2324])
[rfa agg] iter:  5, prev_obj_val: 81.2373275756836, obj_val: 77.96556854248047, abs dis: 3.271759033203125
[rfa agg] iter: 5, weight: tensor([0.0400, 0.0745, 0.0246, 0.0261, 0.0953, 0.2633, 0.0761, 0.0240, 0.0385,
        0.3376])
[rfa agg] iter:  6, prev_obj_val: 77.96556854248047, obj_val: 77.95664978027344, abs dis: 0.00891876220703125
[rfa agg] iter: 6, weight: tensor([0.0533, 0.1159, 0.0307, 0.0326, 0.0820, 0.2271, 0.1184, 0.0298, 0.0506,
        0.2596])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3045, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.3426, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.3172402381897 sec.
Server Epoch:15 choose agents : [75, 67, 89, 84, 27, 45, 19, 70, 41, 20].
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0635, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8861, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 56/426 (13.1455%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7817, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   1, Avg loss: 0.0623, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3659, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 437/1587 (27.5362%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 598/1587 (37.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5237, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   1, Avg loss: 0.0682, Accuracy: 202/669 (30.1943%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.8485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 368/1036 (35.5212%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 617/1036 (59.5560%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.4357, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 378/1418 (26.6573%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9501, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0574, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0325, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5858, Accuracy: 55/10000 (0.5500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 430/807 (53.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8231, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.0333013534546
[rfa agg] training data poison_ratio: 0.08473330533389332  data num: [776, 426, 896, 1190, 1587, 669, 1036, 1418, 719, 807]
[rfa agg] considering poison per batch poison_fraction: 0.026479157916841665
[rfa agg] init. name: [75, 67, 89, 84, 27, 45, 19, 70, 41, 20], weight: tensor([0.0815, 0.0447, 0.0941, 0.1249, 0.1666, 0.0702, 0.1088, 0.1489, 0.0755,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 45.204498291015625, obj_val: 53.903568267822266, abs dis: 8.69906997680664
[rfa agg] iter: 0, weight: tensor([0.1418, 0.0168, 0.2766, 0.0770, 0.0449, 0.0557, 0.1159, 0.0493, 0.0820,
        0.1400])
[rfa agg] iter:  1, prev_obj_val: 53.903568267822266, obj_val: 56.97357177734375, abs dis: 3.0700035095214844
[rfa agg] iter: 1, weight: tensor([0.1688, 0.0212, 0.1077, 0.0424, 0.0307, 0.1381, 0.0514, 0.0323, 0.2470,
        0.1604])
[rfa agg] iter:  2, prev_obj_val: 56.97357177734375, obj_val: 60.45289993286133, abs dis: 3.479328155517578
[rfa agg] iter: 2, weight: tensor([0.1270, 0.0246, 0.0901, 0.0414, 0.0309, 0.2199, 0.0489, 0.0323, 0.2557,
        0.1290])
[rfa agg] iter:  3, prev_obj_val: 60.45289993286133, obj_val: 64.23179626464844, abs dis: 3.7788963317871094
[rfa agg] iter: 3, weight: tensor([0.1057, 0.0299, 0.0823, 0.0420, 0.0322, 0.3368, 0.0486, 0.0335, 0.1805,
        0.1085])
[rfa agg] iter:  4, prev_obj_val: 64.23179626464844, obj_val: 68.18743133544922, abs dis: 3.9556350708007812
[rfa agg] iter: 4, weight: tensor([0.1034, 0.0410, 0.0858, 0.0477, 0.0375, 0.3321, 0.0542, 0.0388, 0.1531,
        0.1064])
[rfa agg] iter:  5, prev_obj_val: 68.18743133544922, obj_val: 60.44577407836914, abs dis: 7.741657257080078
[rfa agg] iter: 5, weight: tensor([0.1095, 0.0597, 0.0951, 0.0568, 0.0457, 0.2609, 0.0635, 0.0470, 0.1487,
        0.1130])
[rfa agg] iter:  6, prev_obj_val: 60.44577407836914, obj_val: 64.2317886352539, abs dis: 3.7860145568847656
[rfa agg] iter: 6, weight: tensor([0.1043, 0.0295, 0.0813, 0.0415, 0.0318, 0.3525, 0.0480, 0.0331, 0.1717,
        0.1064])
[rfa agg] iter:  7, prev_obj_val: 64.2317886352539, obj_val: 68.1876220703125, abs dis: 3.9558334350585938
[rfa agg] iter: 7, weight: tensor([0.1030, 0.0408, 0.0855, 0.0476, 0.0374, 0.3347, 0.0541, 0.0387, 0.1523,
        0.1060])
[rfa agg] iter:  8, prev_obj_val: 68.1876220703125, obj_val: 60.44574737548828, abs dis: 7.741874694824219
[rfa agg] iter: 8, weight: tensor([0.1095, 0.0597, 0.0951, 0.0568, 0.0457, 0.2611, 0.0635, 0.0470, 0.1486,
        0.1130])
[rfa agg] iter:  9, prev_obj_val: 60.44574737548828, obj_val: 64.23179626464844, abs dis: 3.7860488891601562
[rfa agg] iter: 9, weight: tensor([0.1043, 0.0295, 0.0813, 0.0415, 0.0318, 0.3525, 0.0480, 0.0331, 0.1717,
        0.1064])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3065, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.3569, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.02951312065125 sec.
Server Epoch:16 choose agents : [25, 23, 76, 70, 85, 6, 68, 74, 63, 35].
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 315/690 (45.6522%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0265, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.5316, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0624, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.8598, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0497, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.8011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 360/1418 (25.3879%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9363, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 429/1988 (21.5795%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 681/1988 (34.2555%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1772, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 646/1956 (33.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.7879, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 366/1163 (31.4703%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   2, Avg loss: 0.0378, Accuracy: 412/1163 (35.4256%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.8550, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 508/1552 (32.7320%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 775/1552 (49.9356%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.7716, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 426/888 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3356, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0549, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.4396, Accuracy: 40/10000 (0.4000%)
time spent on training: 156.48732542991638
[rfa agg] training data poison_ratio: 0.13973170072926983  data num: [690, 715, 466, 1418, 1988, 1956, 1163, 1552, 888, 271]
[rfa agg] considering poison per batch poison_fraction: 0.04366615647789682
[rfa agg] init. name: [25, 23, 76, 70, 85, 6, 68, 74, 63, 35], weight: tensor([0.0621, 0.0644, 0.0420, 0.1277, 0.1790, 0.1761, 0.1047, 0.1397, 0.0799,
        0.0244])
[rfa agg] iter:  0, prev_obj_val: 70.94417572021484, obj_val: 72.12754821777344, abs dis: 1.1833724975585938
[rfa agg] iter: 0, weight: tensor([0.0319, 0.0374, 0.0159, 0.1524, 0.0625, 0.0669, 0.4531, 0.1095, 0.0630,
        0.0073])
[rfa agg] iter:  1, prev_obj_val: 72.12754821777344, obj_val: 77.78935241699219, abs dis: 5.66180419921875
[rfa agg] iter: 1, weight: tensor([0.0249, 0.0294, 0.0123, 0.0991, 0.0442, 0.0471, 0.6128, 0.0739, 0.0508,
        0.0056])
[rfa agg] iter:  2, prev_obj_val: 77.78935241699219, obj_val: 73.86810302734375, abs dis: 3.9212493896484375
[rfa agg] iter: 2, weight: tensor([0.0517, 0.0628, 0.0240, 0.1235, 0.0670, 0.0709, 0.3686, 0.1004, 0.1204,
        0.0106])
[rfa agg] iter:  3, prev_obj_val: 73.86810302734375, obj_val: 75.77241516113281, abs dis: 1.9043121337890625
[rfa agg] iter: 3, weight: tensor([0.0331, 0.0394, 0.0160, 0.1105, 0.0530, 0.0564, 0.5288, 0.0852, 0.0703,
        0.0072])
[rfa agg] iter:  4, prev_obj_val: 75.77241516113281, obj_val: 77.74803161621094, abs dis: 1.975616455078125
[rfa agg] iter: 4, weight: tensor([0.0419, 0.0503, 0.0198, 0.1179, 0.0604, 0.0641, 0.4504, 0.0936, 0.0927,
        0.0089])
[rfa agg] iter:  5, prev_obj_val: 77.74803161621094, obj_val: 75.77153778076172, abs dis: 1.9764938354492188
[rfa agg] iter: 5, weight: tensor([0.0523, 0.0635, 0.0242, 0.1250, 0.0677, 0.0715, 0.3613, 0.1015, 0.1223,
        0.0107])
[rfa agg] iter:  6, prev_obj_val: 75.77153778076172, obj_val: 77.74596405029297, abs dis: 1.97442626953125
[rfa agg] iter: 6, weight: tensor([0.0431, 0.0519, 0.0204, 0.1217, 0.0622, 0.0659, 0.4335, 0.0964, 0.0958,
        0.0091])
[rfa agg] iter:  7, prev_obj_val: 77.74596405029297, obj_val: 75.77164459228516, abs dis: 1.9743194580078125
[rfa agg] iter: 7, weight: tensor([0.0523, 0.0636, 0.0242, 0.1252, 0.0677, 0.0716, 0.3604, 0.1016, 0.1225,
        0.0107])
[rfa agg] iter:  8, prev_obj_val: 75.77164459228516, obj_val: 77.74595642089844, abs dis: 1.9743118286132812
[rfa agg] iter: 8, weight: tensor([0.0431, 0.0519, 0.0204, 0.1217, 0.0622, 0.0659, 0.4334, 0.0964, 0.0958,
        0.0091])
[rfa agg] iter:  9, prev_obj_val: 77.74595642089844, obj_val: 75.77165222167969, abs dis: 1.97430419921875
[rfa agg] iter: 9, weight: tensor([0.0523, 0.0636, 0.0242, 0.1252, 0.0677, 0.0716, 0.3604, 0.1016, 0.1225,
        0.0107])
			Update norm = 163.76118759492434 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3065, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.3569, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.74948620796204 sec.
Server Epoch:17 choose agents : [38, 31, 29, 86, 59, 67, 35, 24, 5, 46].
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 495/1131 (43.7666%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4395, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   1, Avg loss: 0.0756, Accuracy: 91/460 (19.7826%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0012, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 443/1440 (30.7639%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 672/1440 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.6763, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 354/1003 (35.2941%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.7881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   1, Avg loss: 0.0601, Accuracy: 320/1089 (29.3848%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 470/1089 (43.1589%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.5650, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.8005, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.4582, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   2, Avg loss: 0.0416, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.5223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 363/1628 (22.2973%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 796/1628 (48.8943%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.6137, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 422/1904 (22.1639%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 690/1904 (36.2395%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7530, Accuracy: 85/10000 (0.8500%)
time spent on training: 146.3702654838562
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 460, 1440, 1003, 1089, 426, 271, 312, 1628, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 31, 29, 86, 59, 67, 35, 24, 5, 46], weight: tensor([0.1170, 0.0476, 0.1490, 0.1038, 0.1127, 0.0441, 0.0280, 0.0323, 0.1685,
        0.1970])
[rfa agg] iter:  0, prev_obj_val: 59.9979133605957, obj_val: 63.09746551513672, abs dis: 3.0995521545410156
[rfa agg] iter: 0, weight: tensor([0.3482, 0.0139, 0.0857, 0.1402, 0.2781, 0.0117, 0.0063, 0.0072, 0.0611,
        0.0478])
[rfa agg] iter:  1, prev_obj_val: 63.09746551513672, obj_val: 65.19017791748047, abs dis: 2.09271240234375
[rfa agg] iter: 1, weight: tensor([0.2872, 0.0164, 0.0764, 0.2382, 0.2477, 0.0137, 0.0072, 0.0083, 0.0579,
        0.0470])
[rfa agg] iter:  2, prev_obj_val: 65.19017791748047, obj_val: 67.50025177001953, abs dis: 2.3100738525390625
[rfa agg] iter: 2, weight: tensor([0.2196, 0.0180, 0.0732, 0.3540, 0.1997, 0.0149, 0.0078, 0.0090, 0.0569,
        0.0469])
[rfa agg] iter:  3, prev_obj_val: 67.50025177001953, obj_val: 70.17842102050781, abs dis: 2.6781692504882812
[rfa agg] iter: 3, weight: tensor([0.1628, 0.0181, 0.0646, 0.4772, 0.1513, 0.0149, 0.0078, 0.0089, 0.0513,
        0.0430])
[rfa agg] iter:  4, prev_obj_val: 70.17842102050781, obj_val: 67.45481872558594, abs dis: 2.723602294921875
[rfa agg] iter: 4, weight: tensor([0.1481, 0.0215, 0.0672, 0.4865, 0.1390, 0.0176, 0.0090, 0.0104, 0.0544,
        0.0462])
[rfa agg] iter:  5, prev_obj_val: 67.45481872558594, obj_val: 67.44717407226562, abs dis: 0.0076446533203125
[rfa agg] iter: 5, weight: tensor([0.1402, 0.0159, 0.0567, 0.5468, 0.1300, 0.0131, 0.0068, 0.0078, 0.0450,
        0.0377])
[rfa agg] iter:  6, prev_obj_val: 67.44717407226562, obj_val: 67.44490051269531, abs dis: 0.0022735595703125
[rfa agg] iter: 6, weight: tensor([0.1312, 0.0150, 0.0533, 0.5747, 0.1217, 0.0123, 0.0064, 0.0074, 0.0424,
        0.0355])
[rfa agg] iter:  7, prev_obj_val: 67.44490051269531, obj_val: 67.44410705566406, abs dis: 0.00079345703125
[rfa agg] iter: 7, weight: tensor([0.1261, 0.0144, 0.0514, 0.5908, 0.1169, 0.0119, 0.0062, 0.0071, 0.0409,
        0.0343])
[rfa agg] iter:  8, prev_obj_val: 67.44410705566406, obj_val: 65.20426940917969, abs dis: 2.239837646484375
[rfa agg] iter: 8, weight: tensor([0.1230, 0.0141, 0.0503, 0.6005, 0.1141, 0.0116, 0.0060, 0.0070, 0.0400,
        0.0335])
[rfa agg] iter:  9, prev_obj_val: 65.20426940917969, obj_val: 70.18122100830078, abs dis: 4.976951599121094
[rfa agg] iter: 9, weight: tensor([0.1793, 0.0158, 0.0642, 0.4584, 0.1633, 0.0131, 0.0069, 0.0079, 0.0499,
        0.0412])
			Update norm = 141.86147374948212 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3065, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.3569, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.6041262149811 sec.
Server Epoch:18 choose agents : [82, 96, 3, 25, 2, 8, 84, 54, 78, 31].
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9224, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.4194, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0738, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.8745, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   1, Avg loss: 0.0544, Accuracy: 321/690 (46.5217%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.6661, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.0649, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 251/1513 (16.5896%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 501/1513 (33.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4837, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 471/1190 (39.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3547, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 506/1130 (44.7788%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.3192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0844, Accuracy: 40/416 (9.6154%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0480, Accuracy: 184/416 (44.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7609, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   1, Avg loss: 0.0770, Accuracy: 71/460 (15.4348%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9799, Accuracy: 50/10000 (0.5000%)
time spent on training: 133.69746494293213
[rfa agg] training data poison_ratio: 0.0  data num: [500, 311, 781, 690, 605, 1513, 1190, 1130, 416, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 96, 3, 25, 2, 8, 84, 54, 78, 31], weight: tensor([0.0658, 0.0409, 0.1028, 0.0908, 0.0796, 0.1992, 0.1567, 0.1488, 0.0548,
        0.0606])
[rfa agg] iter:  0, prev_obj_val: 52.691123962402344, obj_val: 58.41515350341797, abs dis: 5.724029541015625
[rfa agg] iter: 0, weight: tensor([0.0528, 0.0188, 0.2745, 0.2432, 0.1205, 0.0539, 0.0723, 0.0798, 0.0353,
        0.0487])
[rfa agg] iter:  1, prev_obj_val: 58.41515350341797, obj_val: 65.57062530517578, abs dis: 7.1554718017578125
[rfa agg] iter: 1, weight: tensor([0.0867, 0.0222, 0.0935, 0.2215, 0.3077, 0.0393, 0.0480, 0.0512, 0.0494,
        0.0805])
[rfa agg] iter:  2, prev_obj_val: 65.57062530517578, obj_val: 71.59026336669922, abs dis: 6.0196380615234375
[rfa agg] iter: 2, weight: tensor([0.2387, 0.0309, 0.0617, 0.0970, 0.1368, 0.0351, 0.0406, 0.0426, 0.0919,
        0.2246])
[rfa agg] iter:  3, prev_obj_val: 71.59026336669922, obj_val: 71.57496643066406, abs dis: 0.01529693603515625
[rfa agg] iter: 3, weight: tensor([0.2502, 0.0390, 0.0464, 0.0639, 0.0772, 0.0302, 0.0340, 0.0353, 0.1894,
        0.2346])
[rfa agg] iter:  4, prev_obj_val: 71.57496643066406, obj_val: 75.23330688476562, abs dis: 3.6583404541015625
[rfa agg] iter: 4, weight: tensor([0.2493, 0.0383, 0.0453, 0.0623, 0.0750, 0.0295, 0.0332, 0.0345, 0.1991,
        0.2335])
[rfa agg] iter:  5, prev_obj_val: 75.23330688476562, obj_val: 75.21817779541016, abs dis: 0.01512908935546875
[rfa agg] iter: 5, weight: tensor([0.1679, 0.0526, 0.0468, 0.0617, 0.0712, 0.0322, 0.0358, 0.0371, 0.3392,
        0.1555])
[rfa agg] iter:  6, prev_obj_val: 75.21817779541016, obj_val: 71.59374237060547, abs dis: 3.6244354248046875
[rfa agg] iter: 6, weight: tensor([0.1551, 0.0495, 0.0439, 0.0579, 0.0667, 0.0302, 0.0336, 0.0348, 0.3844,
        0.1440])
[rfa agg] iter:  7, prev_obj_val: 71.59374237060547, obj_val: 71.57513427734375, abs dis: 0.01860809326171875
[rfa agg] iter: 7, weight: tensor([0.2372, 0.0384, 0.0453, 0.0624, 0.0748, 0.0295, 0.0332, 0.0345, 0.2213,
        0.2234])
[rfa agg] iter:  8, prev_obj_val: 71.57513427734375, obj_val: 75.23280334472656, abs dis: 3.6576690673828125
[rfa agg] iter: 8, weight: tensor([0.2476, 0.0382, 0.0452, 0.0623, 0.0749, 0.0294, 0.0332, 0.0344, 0.2024,
        0.2323])
[rfa agg] iter:  9, prev_obj_val: 75.23280334472656, obj_val: 75.21813201904297, abs dis: 0.01467132568359375
[rfa agg] iter: 9, weight: tensor([0.1676, 0.0525, 0.0468, 0.0616, 0.0711, 0.0322, 0.0358, 0.0370, 0.3401,
        0.1552])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3083, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.3703, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.94453144073486 sec.
Server Epoch:19 choose agents : [7, 92, 38, 18, 96, 99, 22, 64, 12, 16].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 428/891 (48.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5848, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 473/1715 (27.5802%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 739/1715 (43.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6482, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 243/1131 (21.4854%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 479/1131 (42.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6214, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 131/530 (24.7170%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5424, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4158, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   1, Avg loss: 0.0657, Accuracy: 170/773 (21.9922%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   2, Avg loss: 0.0308, Accuracy: 403/773 (52.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3004, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 513/1470 (34.8980%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2069, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 157/953 (16.4743%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 345/953 (36.2015%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.7184, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   1, Avg loss: 0.0883, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.5889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 278/708 (39.2655%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.9605, Accuracy: 66/10000 (0.6600%)
time spent on training: 142.5257363319397
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1715, 1131, 530, 311, 773, 1470, 953, 338, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 92, 38, 18, 96, 99, 22, 64, 12, 16], weight: tensor([0.1010, 0.1944, 0.1282, 0.0601, 0.0353, 0.0876, 0.1667, 0.1080, 0.0383,
        0.0803])
[rfa agg] iter:  0, prev_obj_val: 51.902374267578125, obj_val: 57.055442810058594, abs dis: 5.153068542480469
[rfa agg] iter: 0, weight: tensor([0.1886, 0.0426, 0.1077, 0.0262, 0.0092, 0.1096, 0.0545, 0.3819, 0.0112,
        0.0685])
[rfa agg] iter:  1, prev_obj_val: 57.055442810058594, obj_val: 64.82954406738281, abs dis: 7.774101257324219
[rfa agg] iter: 1, weight: tensor([0.1861, 0.0347, 0.0631, 0.0371, 0.0109, 0.3213, 0.0416, 0.1305, 0.0136,
        0.1611])
[rfa agg] iter:  2, prev_obj_val: 64.82954406738281, obj_val: 64.79065704345703, abs dis: 0.03888702392578125
[rfa agg] iter: 2, weight: tensor([0.1256, 0.0412, 0.0642, 0.0766, 0.0176, 0.1826, 0.0475, 0.0992, 0.0227,
        0.3227])
[rfa agg] iter:  3, prev_obj_val: 64.79065704345703, obj_val: 61.81184005737305, abs dis: 2.9788169860839844
[rfa agg] iter: 3, weight: tensor([0.1195, 0.0395, 0.0616, 0.0737, 0.0169, 0.1716, 0.0455, 0.0950, 0.0218,
        0.3548])
[rfa agg] iter:  4, prev_obj_val: 61.81184005737305, obj_val: 71.18624877929688, abs dis: 9.374408721923828
[rfa agg] iter: 4, weight: tensor([0.1140, 0.0323, 0.0526, 0.0489, 0.0124, 0.1873, 0.0376, 0.0867, 0.0158,
        0.4124])
[rfa agg] iter:  5, prev_obj_val: 71.18624877929688, obj_val: 67.94924926757812, abs dis: 3.23699951171875
[rfa agg] iter: 5, weight: tensor([0.1210, 0.0511, 0.0736, 0.1596, 0.0274, 0.1480, 0.0577, 0.1026, 0.0364,
        0.2228])
[rfa agg] iter:  6, prev_obj_val: 67.94924926757812, obj_val: 61.8280029296875, abs dis: 6.121246337890625
[rfa agg] iter: 6, weight: tensor([0.1253, 0.0473, 0.0707, 0.1130, 0.0226, 0.1637, 0.0539, 0.1033, 0.0295,
        0.2707])
[rfa agg] iter:  7, prev_obj_val: 61.8280029296875, obj_val: 67.95613098144531, abs dis: 6.1281280517578125
[rfa agg] iter: 7, weight: tensor([0.1195, 0.0337, 0.0550, 0.0513, 0.0130, 0.1967, 0.0393, 0.0909, 0.0165,
        0.3840])
[rfa agg] iter:  8, prev_obj_val: 67.95613098144531, obj_val: 64.7945785522461, abs dis: 3.1615524291992188
[rfa agg] iter: 8, weight: tensor([0.1238, 0.0468, 0.0699, 0.1103, 0.0223, 0.1619, 0.0533, 0.1020, 0.0292,
        0.2804])
[rfa agg] iter:  9, prev_obj_val: 64.7945785522461, obj_val: 61.81258010864258, abs dis: 2.9819984436035156
[rfa agg] iter: 9, weight: tensor([0.1207, 0.0399, 0.0622, 0.0746, 0.0171, 0.1732, 0.0460, 0.0960, 0.0220,
        0.3484])
			Update norm = 110.5665806200047 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3083, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.3703, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.34741258621216 sec.
Server Epoch:20 choose agents : [81, 15, 59, 7, 68, 53, 76, 56, 63, 11].
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 244/774 (31.5245%)
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 331/774 (42.7649%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5676, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 509/1154 (44.1075%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3485, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8239, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0524, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 427/891 (47.9237%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2972, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   1, Avg loss: 0.0621, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 441/1163 (37.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9313, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.6713, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0845, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0472, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.9503, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3370, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5041, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0571, Accuracy: 343/712 (48.1742%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7804, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.73151326179504
[rfa agg] training data poison_ratio: 0.0  data num: [774, 1154, 1089, 891, 1163, 813, 466, 186, 888, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [81, 15, 59, 7, 68, 53, 76, 56, 63, 11], weight: tensor([0.0951, 0.1418, 0.1338, 0.1095, 0.1429, 0.0999, 0.0573, 0.0229, 0.1091,
        0.0875])
[rfa agg] iter:  0, prev_obj_val: 30.957122802734375, obj_val: 39.39087677001953, abs dis: 8.433753967285156
[rfa agg] iter: 0, weight: tensor([0.2124, 0.0391, 0.0438, 0.1348, 0.0395, 0.2412, 0.0190, 0.0038, 0.1485,
        0.1180])
[rfa agg] iter:  1, prev_obj_val: 39.39087677001953, obj_val: 42.914222717285156, abs dis: 3.523345947265625
[rfa agg] iter: 1, weight: tensor([0.1516, 0.0491, 0.0531, 0.1079, 0.0496, 0.1639, 0.0422, 0.0069, 0.1107,
        0.2649])
[rfa agg] iter:  2, prev_obj_val: 42.914222717285156, obj_val: 39.357635498046875, abs dis: 3.5565872192382812
[rfa agg] iter: 2, weight: tensor([0.1426, 0.0560, 0.0601, 0.1108, 0.0565, 0.1521, 0.0594, 0.0089, 0.1129,
        0.2406])
[rfa agg] iter:  3, prev_obj_val: 39.357635498046875, obj_val: 46.56090545654297, abs dis: 7.203269958496094
[rfa agg] iter: 3, weight: tensor([0.1464, 0.0480, 0.0519, 0.1050, 0.0484, 0.1577, 0.0412, 0.0068, 0.1078,
        0.2866])
[rfa agg] iter:  4, prev_obj_val: 46.56090545654297, obj_val: 39.36377716064453, abs dis: 7.1971282958984375
[rfa agg] iter: 4, weight: tensor([0.1370, 0.0621, 0.0661, 0.1131, 0.0626, 0.1454, 0.0831, 0.0112, 0.1147,
        0.2046])
[rfa agg] iter:  5, prev_obj_val: 39.36377716064453, obj_val: 46.560302734375, abs dis: 7.196525573730469
[rfa agg] iter: 5, weight: tensor([0.1475, 0.0484, 0.0523, 0.1059, 0.0488, 0.1588, 0.0415, 0.0068, 0.1086,
        0.2813])
[rfa agg] iter:  6, prev_obj_val: 46.560302734375, obj_val: 39.36380386352539, abs dis: 7.196498870849609
[rfa agg] iter: 6, weight: tensor([0.1371, 0.0621, 0.0661, 0.1132, 0.0627, 0.1455, 0.0831, 0.0112, 0.1147,
        0.2044])
[rfa agg] iter:  7, prev_obj_val: 39.36380386352539, obj_val: 46.560298919677734, abs dis: 7.196495056152344
[rfa agg] iter: 7, weight: tensor([0.1475, 0.0484, 0.0523, 0.1059, 0.0488, 0.1588, 0.0416, 0.0068, 0.1087,
        0.2812])
[rfa agg] iter:  8, prev_obj_val: 46.560298919677734, obj_val: 39.36380386352539, abs dis: 7.196495056152344
[rfa agg] iter: 8, weight: tensor([0.1371, 0.0621, 0.0661, 0.1132, 0.0627, 0.1455, 0.0831, 0.0112, 0.1147,
        0.2044])
[rfa agg] iter:  9, prev_obj_val: 39.36380386352539, obj_val: 46.560298919677734, abs dis: 7.196495056152344
[rfa agg] iter: 9, weight: tensor([0.1475, 0.0484, 0.0523, 0.1059, 0.0488, 0.1588, 0.0416, 0.0068, 0.1087,
        0.2812])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3103, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.3811, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.0046532154083 sec.
Server Epoch:21 choose agents : [0, 18, 27, 50, 82, 44, 79, 20, 69, 23].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0571, Accuracy: 384/1657 (23.1744%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 599/1657 (36.1497%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0303, Accuracy: 661/1657 (39.8914%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0296, Accuracy: 708/1657 (42.7278%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0291, Accuracy: 735/1657 (44.3573%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0278, Accuracy: 791/1657 (47.7369%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0271, Accuracy: 796/1657 (48.0386%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0266, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0257, Accuracy: 852/1657 (51.4182%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0263, Accuracy: 834/1657 (50.3319%), train_poison_data_count: 520
Global model norm: 112.04974568383679.
Norm before scaling: 112.02353529922853. Distance: 1.234804633977664
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5835, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.7204, Accuracy: 9781/9950 (98.3015%)
Scaling by  100
Scaled Norm after poisoning: 164.50839406774963, distance: 123.48046325102405
Total norm for 3 adversaries is: 164.50839406774963. distance: 123.48046325102405
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   1, Avg loss: 0.0737, Accuracy: 121/530 (22.8302%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.4919, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 428/1587 (26.9691%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 598/1587 (37.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4811, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 162/809 (20.0247%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 339/809 (41.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7353, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   2, Avg loss: 0.0472, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.9734, Accuracy: 51/10000 (0.5100%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 391/1750 (22.3429%)
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6978, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   1, Avg loss: 0.1009, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   2, Avg loss: 0.0856, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3586, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 407/807 (50.4337%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.8134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   1, Avg loss: 0.0531, Accuracy: 303/590 (51.3559%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.9509, Accuracy: 50/10000 (0.5000%)
time spent on training: 293.390958070755
[rfa agg] training data poison_ratio: 0.4609494640122512  data num: [1657, 530, 1587, 809, 500, 1750, 197, 807, 590, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1440467075038285
[rfa agg] init. name: [0, 18, 27, 50, 82, 44, 79, 20, 69, 23], weight: tensor([0.1813, 0.0580, 0.1736, 0.0885, 0.0547, 0.1914, 0.0215, 0.0883, 0.0645,
        0.0782])
[rfa agg] iter:  0, prev_obj_val: 34458.56640625, obj_val: 24497.44921875, abs dis: 9961.1171875
[rfa agg] iter: 0, weight: tensor([0.0467, 0.0672, 0.2027, 0.1028, 0.0634, 0.2239, 0.0249, 0.1026, 0.0749,
        0.0908])
[rfa agg] iter:  1, prev_obj_val: 24497.44921875, obj_val: 21831.087890625, abs dis: 2666.361328125
[rfa agg] iter: 1, weight: tensor([0.0107, 0.0690, 0.2122, 0.1061, 0.0650, 0.2352, 0.0254, 0.1058, 0.0770,
        0.0936])
[rfa agg] iter:  2, prev_obj_val: 21831.087890625, obj_val: 21215.181640625, abs dis: 615.90625
[rfa agg] iter: 2, weight: tensor([0.0023, 0.0661, 0.2224, 0.1038, 0.0619, 0.2511, 0.0238, 0.1035, 0.0741,
        0.0911])
[rfa agg] iter:  3, prev_obj_val: 21215.181640625, obj_val: 21104.4765625, abs dis: 110.705078125
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0495, 0.2586, 0.0846, 0.0455, 0.3313, 0.0162, 0.0844, 0.0567,
        0.0726])
[rfa agg] iter:  4, prev_obj_val: 21104.4765625, obj_val: 21105.96875, abs dis: 1.4921875
[rfa agg] iter: 4, weight: tensor([7.6749e-05, 2.1943e-02, 5.6584e-01, 4.6137e-02, 1.9363e-02, 2.3102e-01,
        6.0604e-03, 4.6064e-02, 2.6227e-02, 3.7259e-02])
[rfa agg] iter:  5, prev_obj_val: 21105.96875, obj_val: 21107.18359375, abs dis: 1.21484375
[rfa agg] iter: 5, weight: tensor([1.1380e-04, 3.7712e-02, 4.0080e-01, 8.4197e-02, 3.2935e-02, 2.3786e-01,
        1.0007e-02, 8.4096e-02, 4.5589e-02, 6.6698e-02])
[rfa agg] iter:  6, prev_obj_val: 21107.18359375, obj_val: 21108.421875, abs dis: 1.23828125
[rfa agg] iter: 6, weight: tensor([1.2622e-04, 4.7536e-02, 3.1151e-01, 1.1326e-01, 4.1101e-02, 2.1521e-01,
        1.2140e-02, 1.1317e-01, 5.8153e-02, 8.7784e-02])
[rfa agg] iter:  7, prev_obj_val: 21108.421875, obj_val: 21110.123046875, abs dis: 1.701171875
[rfa agg] iter: 7, weight: tensor([1.2614e-04, 5.4994e-02, 2.3991e-01, 1.4360e-01, 4.6934e-02, 1.8140e-01,
        1.3384e-02, 1.4357e-01, 6.8342e-02, 1.0774e-01])
[rfa agg] iter:  8, prev_obj_val: 21110.123046875, obj_val: 21111.9375, abs dis: 1.814453125
[rfa agg] iter: 8, weight: tensor([1.0815e-04, 5.9666e-02, 1.5758e-01, 1.9091e-01, 4.9669e-02, 1.2863e-01,
        1.3302e-02, 1.9124e-01, 7.6492e-02, 1.3241e-01])
[rfa agg] iter:  9, prev_obj_val: 21111.9375, obj_val: 21117.751953125, abs dis: 5.814453125
[rfa agg] iter: 9, weight: tensor([6.9033e-05, 5.1805e-02, 8.1501e-02, 2.6252e-01, 4.1386e-02, 6.9985e-02,
        1.0096e-02, 2.6498e-01, 7.0204e-02, 1.4746e-01])
			Update norm = 109.98409863759852 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3103, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.3811, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.5487160682678 sec.
Server Epoch:22 choose agents : [12, 23, 52, 19, 80, 2, 44, 8, 82, 58].
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0887, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0506, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6457, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8157, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   1, Avg loss: 0.0459, Accuracy: 396/1036 (38.2239%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 656/1036 (63.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.5448, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5816, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 247/605 (40.8264%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0720, Accuracy: 53/10000 (0.5300%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 397/1750 (22.6857%)
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 645/1750 (36.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5958, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0591, Accuracy: 268/1513 (17.7132%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 489/1513 (32.3199%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.7480, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   1, Avg loss: 0.0741, Accuracy: 82/500 (16.4000%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9612, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.1844, Accuracy: 53/10000 (0.5300%)
time spent on training: 159.67285990715027
[rfa agg] training data poison_ratio: 0.20401025880158546  data num: [338, 715, 636, 1036, 682, 605, 1750, 1513, 500, 803]
[rfa agg] considering poison per batch poison_fraction: 0.06375320587549546
[rfa agg] init. name: [12, 23, 52, 19, 80, 2, 44, 8, 82, 58], weight: tensor([0.0394, 0.0834, 0.0741, 0.1208, 0.0795, 0.0705, 0.2040, 0.1764, 0.0583,
        0.0936])
[rfa agg] iter:  0, prev_obj_val: 60.7484130859375, obj_val: 62.022361755371094, abs dis: 1.2739486694335938
[rfa agg] iter: 0, weight: tensor([0.0196, 0.1207, 0.0659, 0.2492, 0.0879, 0.0628, 0.0703, 0.0875, 0.0372,
        0.1989])
[rfa agg] iter:  1, prev_obj_val: 62.022361755371094, obj_val: 68.39628601074219, abs dis: 6.373924255371094
[rfa agg] iter: 1, weight: tensor([0.0155, 0.2285, 0.0733, 0.0682, 0.1238, 0.0705, 0.0338, 0.0393, 0.0330,
        0.3141])
[rfa agg] iter:  2, prev_obj_val: 68.39628601074219, obj_val: 74.024658203125, abs dis: 5.6283721923828125
[rfa agg] iter: 2, weight: tensor([0.0198, 0.1157, 0.2010, 0.0422, 0.2218, 0.2072, 0.0267, 0.0298, 0.0520,
        0.0838])
[rfa agg] iter:  3, prev_obj_val: 74.024658203125, obj_val: 81.02264404296875, abs dis: 6.99798583984375
[rfa agg] iter: 3, weight: tensor([0.0284, 0.0820, 0.2482, 0.0409, 0.1270, 0.2526, 0.0282, 0.0311, 0.0944,
        0.0672])
[rfa agg] iter:  4, prev_obj_val: 81.02264404296875, obj_val: 84.68008422851562, abs dis: 3.657440185546875
[rfa agg] iter: 4, weight: tensor([0.0507, 0.0771, 0.1541, 0.0468, 0.1021, 0.1486, 0.0346, 0.0376, 0.2804,
        0.0681])
[rfa agg] iter:  5, prev_obj_val: 84.68008422851562, obj_val: 84.66067504882812, abs dis: 0.0194091796875
[rfa agg] iter: 5, weight: tensor([0.0551, 0.0595, 0.1033, 0.0388, 0.0754, 0.0993, 0.0296, 0.0320, 0.4532,
        0.0539])
[rfa agg] iter:  6, prev_obj_val: 84.66067504882812, obj_val: 84.65705871582031, abs dis: 0.0036163330078125
[rfa agg] iter: 6, weight: tensor([0.0481, 0.0518, 0.0895, 0.0338, 0.0656, 0.0863, 0.0258, 0.0279, 0.5243,
        0.0469])
[rfa agg] iter:  7, prev_obj_val: 84.65705871582031, obj_val: 84.6561050415039, abs dis: 0.00095367431640625
[rfa agg] iter: 7, weight: tensor([0.0446, 0.0480, 0.0829, 0.0314, 0.0608, 0.0799, 0.0239, 0.0258, 0.5592,
        0.0435])
[rfa agg] iter:  8, prev_obj_val: 84.6561050415039, obj_val: 81.03044128417969, abs dis: 3.6256637573242188
[rfa agg] iter: 8, weight: tensor([0.0428, 0.0460, 0.0793, 0.0300, 0.0582, 0.0765, 0.0229, 0.0247, 0.5780,
        0.0416])
[rfa agg] iter:  9, prev_obj_val: 81.03044128417969, obj_val: 84.67296600341797, abs dis: 3.6425247192382812
[rfa agg] iter: 9, weight: tensor([0.0478, 0.0721, 0.1406, 0.0439, 0.0954, 0.1369, 0.0324, 0.0352, 0.3321,
        0.0636])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3127, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3950, Accuracy: 0/9950 (0.0000%)
saving model
Done in 319.28582525253296 sec.
Server Epoch:23 choose agents : [20, 9, 57, 74, 2, 92, 23, 81, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0606, Accuracy: 225/807 (27.8810%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0344, Accuracy: 372/807 (46.0967%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0291, Accuracy: 419/807 (51.9207%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0286, Accuracy: 405/807 (50.1859%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0280, Accuracy: 416/807 (51.5489%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0261, Accuracy: 446/807 (55.2664%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0261, Accuracy: 442/807 (54.7708%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0248, Accuracy: 450/807 (55.7621%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0248, Accuracy: 456/807 (56.5056%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0244, Accuracy: 464/807 (57.4969%), train_poison_data_count: 260
Global model norm: 112.04894386076336.
Norm before scaling: 112.03809253859824. Distance: 0.8540664396952361
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3968, Accuracy: 75/10000 (0.7500%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.8999, Accuracy: 8851/9950 (88.9548%)
Scaling by  100
Scaled Norm after poisoning: 139.76153658777153, distance: 85.40664734173944
Total norm for 2 adversaries is: 139.76153658777153. distance: 85.40664734173944
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 342/1275 (26.8235%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 715/1275 (56.0784%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.0410, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 307/1154 (26.6031%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.1360, Accuracy: 67/10000 (0.6700%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 481/1552 (30.9923%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.5385, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0602, Accuracy: 255/605 (42.1488%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2429, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 479/1715 (27.9300%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 690/1715 (40.2332%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.4249, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 332/715 (46.4336%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0661, Accuracy: 250/774 (32.2997%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5755, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 111/781 (14.2125%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.9006, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 396/1628 (24.3243%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 843/1628 (51.7813%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8967, Accuracy: 154/10000 (1.5400%)
time spent on training: 269.17941975593567
[rfa agg] training data poison_ratio: 0.21433763401780848  data num: [807, 1275, 1154, 1552, 605, 1715, 715, 774, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.06698051063056515
[rfa agg] init. name: [20, 9, 57, 74, 2, 92, 23, 81, 3, 5], weight: tensor([0.0733, 0.1158, 0.1049, 0.1410, 0.0550, 0.1558, 0.0650, 0.0703, 0.0710,
        0.1479])
[rfa agg] iter:  0, prev_obj_val: 7862.4775390625, obj_val: 4539.388671875, abs dis: 3323.0888671875
[rfa agg] iter: 0, weight: tensor([0.0062, 0.1241, 0.1121, 0.1526, 0.0577, 0.1694, 0.0684, 0.0742, 0.0749,
        0.1605])
[rfa agg] iter:  1, prev_obj_val: 4539.388671875, obj_val: 4297.4345703125, abs dis: 241.9541015625
[rfa agg] iter: 1, weight: tensor([0.0004, 0.1202, 0.1060, 0.1684, 0.0452, 0.1981, 0.0557, 0.0616, 0.0622,
        0.1822])
[rfa agg] iter:  2, prev_obj_val: 4297.4345703125, obj_val: 4300.85888671875, abs dis: 3.42431640625
[rfa agg] iter: 2, weight: tensor([4.8750e-05, 2.8293e-01, 1.7034e-01, 1.6745e-01, 2.0551e-02, 1.2002e-01,
        2.9368e-02, 3.5443e-02, 3.5811e-02, 1.3803e-01])
[rfa agg] iter:  3, prev_obj_val: 4300.85888671875, obj_val: 4308.5888671875, abs dis: 7.72998046875
[rfa agg] iter: 3, weight: tensor([3.5521e-05, 2.8858e-01, 3.9102e-01, 7.2924e-02, 1.9113e-02, 6.0606e-02,
        2.8964e-02, 3.6384e-02, 3.6799e-02, 6.5570e-02])
[rfa agg] iter:  4, prev_obj_val: 4308.5888671875, obj_val: 4310.6650390625, abs dis: 2.076171875
[rfa agg] iter: 4, weight: tensor([5.9016e-05, 1.9496e-01, 2.6068e-01, 9.1245e-02, 4.0712e-02, 8.0802e-02,
        6.6891e-02, 8.9157e-02, 9.0440e-02, 8.5057e-02])
[rfa agg] iter:  5, prev_obj_val: 4310.6650390625, obj_val: 4312.77978515625, abs dis: 2.11474609375
[rfa agg] iter: 5, weight: tensor([6.2428e-05, 1.7793e-01, 2.2215e-01, 9.1023e-02, 4.6394e-02, 8.1494e-02,
        7.8615e-02, 1.0762e-01, 1.0933e-01, 8.5388e-02])
[rfa agg] iter:  6, prev_obj_val: 4312.77978515625, obj_val: 4308.56982421875, abs dis: 4.2099609375
[rfa agg] iter: 6, weight: tensor([6.3802e-05, 1.6010e-01, 1.9104e-01, 8.7939e-02, 5.1327e-02, 7.9551e-02,
        9.0129e-02, 1.2730e-01, 1.2959e-01, 8.2975e-02])
[rfa agg] iter:  7, prev_obj_val: 4308.56982421875, obj_val: 4310.6640625, abs dis: 2.09423828125
[rfa agg] iter: 7, weight: tensor([5.9355e-05, 1.9526e-01, 2.5522e-01, 9.1877e-02, 4.1017e-02, 8.1295e-02,
        6.7515e-02, 9.0436e-02, 9.1709e-02, 8.5620e-02])
[rfa agg] iter:  8, prev_obj_val: 4310.6640625, obj_val: 4312.77978515625, abs dis: 2.11572265625
[rfa agg] iter: 8, weight: tensor([6.2432e-05, 1.7796e-01, 2.2203e-01, 9.1030e-02, 4.6398e-02, 8.1500e-02,
        7.8623e-02, 1.0765e-01, 1.0935e-01, 8.5395e-02])
[rfa agg] iter:  9, prev_obj_val: 4312.77978515625, obj_val: 4308.56982421875, abs dis: 4.2099609375
[rfa agg] iter: 9, weight: tensor([6.3802e-05, 1.6010e-01, 1.9104e-01, 8.7939e-02, 5.1327e-02, 7.9551e-02,
        9.0129e-02, 1.2730e-01, 1.2959e-01, 8.2975e-02])
			Update norm = 153.7211863244621 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3127, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3950, Accuracy: 0/9950 (0.0000%)
saving model
Done in 427.56997871398926 sec.
Server Epoch:24 choose agents : [67, 87, 90, 88, 15, 72, 3, 12, 54, 76].
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0767, Accuracy: 57/426 (13.3803%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0406, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.9813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 390/1131 (34.4828%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 318/677 (46.9719%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8210, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   1, Avg loss: 0.0722, Accuracy: 153/603 (25.3731%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.3090, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 373/1154 (32.3224%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.3631, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 246/1241 (19.8227%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 397/1241 (31.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.2872, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0742, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9273, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.7078, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 448/1130 (39.6460%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0969, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0835, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.2951, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.9462010860443
[rfa agg] training data poison_ratio: 0.0  data num: [426, 1131, 677, 603, 1154, 1241, 781, 338, 1130, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [67, 87, 90, 88, 15, 72, 3, 12, 54, 76], weight: tensor([0.0536, 0.1423, 0.0852, 0.0759, 0.1452, 0.1562, 0.0983, 0.0425, 0.1422,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 44.36153030395508, obj_val: 51.69580841064453, abs dis: 7.334278106689453
[rfa agg] iter: 0, weight: tensor([0.0296, 0.0785, 0.1626, 0.0908, 0.0677, 0.0635, 0.3696, 0.0199, 0.0785,
        0.0394])
[rfa agg] iter:  1, prev_obj_val: 51.69580841064453, obj_val: 63.22951126098633, abs dis: 11.533702850341797
[rfa agg] iter: 1, weight: tensor([0.0398, 0.0497, 0.3141, 0.2729, 0.0447, 0.0432, 0.1020, 0.0246, 0.0497,
        0.0594])
[rfa agg] iter:  2, prev_obj_val: 63.22951126098633, obj_val: 69.89845275878906, abs dis: 6.668941497802734
[rfa agg] iter: 2, weight: tensor([0.1186, 0.0529, 0.1194, 0.1732, 0.0488, 0.0480, 0.0767, 0.0582, 0.0529,
        0.2514])
[rfa agg] iter:  3, prev_obj_val: 69.89845275878906, obj_val: 69.88336181640625, abs dis: 0.0150909423828125
[rfa agg] iter: 3, weight: tensor([0.2505, 0.0436, 0.0777, 0.0962, 0.0406, 0.0402, 0.0572, 0.0853, 0.0435,
        0.2652])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.46155548095703 sec.
Server Epoch:25 choose agents : [74, 16, 75, 48, 28, 58, 93, 17, 20, 34].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0482, Accuracy: 414/1552 (26.6753%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 691/1552 (44.5232%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0203, Accuracy: 829/1552 (53.4149%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0192, Accuracy: 887/1552 (57.1521%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0184, Accuracy: 943/1552 (60.7603%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0177, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0177, Accuracy: 967/1552 (62.3067%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0170, Accuracy: 998/1552 (64.3041%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0171, Accuracy: 986/1552 (63.5309%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0166, Accuracy: 984/1552 (63.4021%), train_poison_data_count: 496
Global model norm: 112.04826840752605.
Norm before scaling: 112.02502161905616. Distance: 1.272331037939205
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.9383, Accuracy: 87/10000 (0.8700%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.6304, Accuracy: 8776/9950 (88.2010%)
Scaling by  100
Scaled Norm after poisoning: 167.51262778892223, distance: 127.23310377143403
Total norm for 2 adversaries is: 167.51262778892223. distance: 127.23310377143403
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.9864, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   1, Avg loss: 0.0615, Accuracy: 261/776 (33.6340%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1857, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 108/631 (17.1157%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.1410, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 566/1581 (35.8001%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9215, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   1, Avg loss: 0.0580, Accuracy: 359/803 (44.7073%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 373/803 (46.4508%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2153, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 430/1742 (24.6843%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 754/1742 (43.2836%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8657, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 406/1574 (25.7942%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 687/1574 (43.6468%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9640, Accuracy: 93/10000 (0.9300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.8408, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 403/1427 (28.2411%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.3620, Accuracy: 77/10000 (0.7700%)
time spent on training: 295.57302236557007
[rfa agg] training data poison_ratio: 0.20334453926385657  data num: [1552, 708, 776, 631, 1581, 803, 1742, 1574, 807, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.06354516851995518
[rfa agg] init. name: [74, 16, 75, 48, 28, 58, 93, 17, 20, 34], weight: tensor([0.1338, 0.0610, 0.0669, 0.0544, 0.1363, 0.0692, 0.1502, 0.1357, 0.0696,
        0.1230])
[rfa agg] iter:  0, prev_obj_val: 25856.267578125, obj_val: 16823.34375, abs dis: 9032.923828125
[rfa agg] iter: 0, weight: tensor([0.0232, 0.0685, 0.0751, 0.0609, 0.1541, 0.0777, 0.1701, 0.1534, 0.0781,
        0.1389])
[rfa agg] iter:  1, prev_obj_val: 16823.34375, obj_val: 15214.7177734375, abs dis: 1608.6259765625
[rfa agg] iter: 1, weight: tensor([0.0036, 0.0681, 0.0749, 0.0603, 0.1591, 0.0776, 0.1772, 0.1584, 0.0779,
        0.1426])
[rfa agg] iter:  2, prev_obj_val: 15214.7177734375, obj_val: 14975.9541015625, abs dis: 238.763671875
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0574, 0.0641, 0.0492, 0.1718, 0.0664, 0.2055, 0.1711, 0.0667,
        0.1473])
[rfa agg] iter:  3, prev_obj_val: 14975.9541015625, obj_val: 14979.8349609375, abs dis: 3.880859375
[rfa agg] iter: 3, weight: tensor([2.6171e-05, 1.1893e-02, 1.4164e-02, 9.1437e-03, 3.3015e-01, 1.4664e-02,
        1.0151e-01, 3.3853e-01, 1.4722e-02, 1.6519e-01])
[rfa agg] iter:  4, prev_obj_val: 14979.8349609375, obj_val: 14985.8251953125, abs dis: 5.990234375
[rfa agg] iter: 4, weight: tensor([4.6422e-05, 2.6319e-02, 3.2024e-02, 1.9577e-02, 1.9106e-01, 3.3159e-02,
        1.0674e-01, 1.9059e-01, 3.3287e-02, 3.6720e-01])
[rfa agg] iter:  5, prev_obj_val: 14985.8251953125, obj_val: 14988.958984375, abs dis: 3.1337890625
[rfa agg] iter: 5, weight: tensor([6.9582e-05, 4.9216e-02, 6.1556e-02, 3.5184e-02, 1.7420e-01, 6.3740e-02,
        1.2083e-01, 1.7349e-01, 6.3889e-02, 2.5782e-01])
			Update norm = 171.25234943643838 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 456.0279974937439 sec.
Server Epoch:26 choose agents : [17, 3, 87, 52, 86, 61, 79, 80, 49, 59].
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 395/1574 (25.0953%)
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 653/1574 (41.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.7506, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 226/781 (28.9373%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.0666, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 299/1131 (26.4368%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.0609, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   1, Avg loss: 0.0553, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 370/1003 (36.8893%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7537, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   1, Avg loss: 0.1276, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   2, Avg loss: 0.1197, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3271, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1002, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0809, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3712, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0686, Accuracy: 157/682 (23.0205%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 237/682 (34.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6552, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0789, Accuracy: 40/440 (9.0909%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7289, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 322/1089 (29.5684%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 484/1089 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3705, Accuracy: 68/10000 (0.6800%)
time spent on training: 144.00380110740662
[rfa agg] training data poison_ratio: 0.0  data num: [1574, 781, 1131, 636, 1003, 85, 197, 682, 440, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [17, 3, 87, 52, 86, 61, 79, 80, 49, 59], weight: tensor([0.2066, 0.1025, 0.1485, 0.0835, 0.1317, 0.0112, 0.0259, 0.0895, 0.0578,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 47.41324996948242, obj_val: 48.5807991027832, abs dis: 1.1675491333007812
[rfa agg] iter: 0, weight: tensor([0.0637, 0.2794, 0.1241, 0.0698, 0.2055, 0.0031, 0.0088, 0.0994, 0.0280,
        0.1183])
[rfa agg] iter:  1, prev_obj_val: 48.5807991027832, obj_val: 51.77262878417969, abs dis: 3.1918296813964844
[rfa agg] iter: 1, weight: tensor([0.0540, 0.3900, 0.0980, 0.0702, 0.1515, 0.0029, 0.0082, 0.1048, 0.0267,
        0.0936])
[rfa agg] iter:  2, prev_obj_val: 51.77262878417969, obj_val: 55.93201446533203, abs dis: 4.159385681152344
[rfa agg] iter: 2, weight: tensor([0.0472, 0.4086, 0.0765, 0.0910, 0.1046, 0.0030, 0.0086, 0.1574, 0.0299,
        0.0731])
[rfa agg] iter:  3, prev_obj_val: 55.93201446533203, obj_val: 58.146324157714844, abs dis: 2.2143096923828125
[rfa agg] iter: 3, weight: tensor([0.0456, 0.1939, 0.0677, 0.1473, 0.0857, 0.0035, 0.0102, 0.3432, 0.0380,
        0.0649])
[rfa agg] iter:  4, prev_obj_val: 58.146324157714844, obj_val: 67.25727844238281, abs dis: 9.110954284667969
[rfa agg] iter: 4, weight: tensor([0.0346, 0.1142, 0.0496, 0.1622, 0.0610, 0.0029, 0.0086, 0.4857, 0.0337,
        0.0476])
[rfa agg] iter:  5, prev_obj_val: 67.25727844238281, obj_val: 58.196372985839844, abs dis: 9.060905456542969
[rfa agg] iter: 5, weight: tensor([0.0471, 0.1013, 0.0616, 0.3524, 0.0709, 0.0052, 0.0164, 0.2062, 0.0798,
        0.0591])
[rfa agg] iter:  6, prev_obj_val: 58.196372985839844, obj_val: 63.90011215209961, abs dis: 5.703739166259766
[rfa agg] iter: 6, weight: tensor([0.0375, 0.1215, 0.0537, 0.1902, 0.0660, 0.0031, 0.0093, 0.4308, 0.0365,
        0.0515])
[rfa agg] iter:  7, prev_obj_val: 63.90011215209961, obj_val: 63.83868408203125, abs dis: 0.061428070068359375
[rfa agg] iter: 7, weight: tensor([0.0402, 0.0968, 0.0540, 0.3770, 0.0633, 0.0040, 0.0124, 0.2451, 0.0553,
        0.0518])
[rfa agg] iter:  8, prev_obj_val: 63.83868408203125, obj_val: 67.192626953125, abs dis: 3.35394287109375
[rfa agg] iter: 8, weight: tensor([0.0361, 0.0868, 0.0485, 0.4509, 0.0570, 0.0036, 0.0112, 0.2094, 0.0498,
        0.0466])
[rfa agg] iter:  9, prev_obj_val: 67.192626953125, obj_val: 58.222862243652344, abs dis: 8.969764709472656
[rfa agg] iter: 9, weight: tensor([0.0433, 0.0927, 0.0566, 0.4125, 0.0652, 0.0048, 0.0151, 0.1822, 0.0734,
        0.0543])
			Update norm = 100.27508063758911 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.00886034965515 sec.
Server Epoch:27 choose agents : [95, 46, 85, 8, 54, 90, 27, 15, 74, 44].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0643, Accuracy: 207/599 (34.5576%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0254, Accuracy: 317/599 (52.9215%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0258, Accuracy: 359/599 (59.9332%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0258, Accuracy: 370/599 (61.7696%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0223, Accuracy: 405/599 (67.6127%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0213, Accuracy: 420/599 (70.1169%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0223, Accuracy: 428/599 (71.4524%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0205, Accuracy: 448/599 (74.7913%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0215, Accuracy: 430/599 (71.7863%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0209, Accuracy: 453/599 (75.6260%), train_poison_data_count: 200
Global model norm: 112.04826840752605.
Norm before scaling: 112.0407553498949. Distance: 0.7952599708582029
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5170, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6084, Accuracy: 7113/9950 (71.4874%)
Scaling by  100
Scaled Norm after poisoning: 136.55604961882867, distance: 79.52599749354766
Total norm for 3 adversaries is: 136.55604961882867. distance: 79.52599749354766
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 390/1904 (20.4832%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 661/1904 (34.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7560, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 422/1988 (21.2274%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 716/1988 (36.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7241, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0584, Accuracy: 281/1513 (18.5724%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 499/1513 (32.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5756, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0526, Accuracy: 358/1130 (31.6814%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   1, Avg loss: 0.0559, Accuracy: 329/677 (48.5968%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8784, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 421/1587 (26.5280%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 617/1587 (38.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3112, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 336/1154 (29.1161%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1445, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 497/1552 (32.0232%)
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 767/1552 (49.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.7155, Accuracy: 85/10000 (0.8500%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 379/1750 (21.6571%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 661/1750 (37.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4713, Accuracy: 114/10000 (1.1400%)
time spent on training: 301.554847240448
[rfa agg] training data poison_ratio: 0.2815793272701025  data num: [599, 1904, 1988, 1513, 1130, 677, 1587, 1154, 1552, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.08799353977190702
[rfa agg] init. name: [95, 46, 85, 8, 54, 90, 27, 15, 74, 44], weight: tensor([0.0432, 0.1374, 0.1435, 0.1092, 0.0816, 0.0489, 0.1146, 0.0833, 0.1120,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 3671.556396484375, obj_val: 1987.589599609375, abs dis: 1683.966796875
[rfa agg] iter: 0, weight: tensor([0.0020, 0.1465, 0.1545, 0.1132, 0.0822, 0.0478, 0.1193, 0.0844, 0.1167,
        0.1334])
[rfa agg] iter:  1, prev_obj_val: 1987.589599609375, obj_val: 1964.738525390625, abs dis: 22.85107421875
[rfa agg] iter: 1, weight: tensor([3.4093e-05, 1.9989e-01, 4.7181e-01, 4.9983e-02, 2.2006e-02, 8.9067e-03,
        5.9278e-02, 2.4119e-02, 5.7840e-02, 1.0613e-01])
[rfa agg] iter:  2, prev_obj_val: 1964.738525390625, obj_val: 1967.020751953125, abs dis: 2.2822265625
[rfa agg] iter: 2, weight: tensor([2.6434e-05, 1.0196e-01, 7.2446e-02, 1.4542e-01, 3.0771e-02, 9.9042e-03,
        2.3109e-01, 3.5736e-02, 2.0913e-01, 1.6352e-01])
[rfa agg] iter:  3, prev_obj_val: 1967.020751953125, obj_val: 1971.2137451171875, abs dis: 4.1929931640625
[rfa agg] iter: 3, weight: tensor([2.2223e-05, 5.7806e-02, 4.5486e-02, 3.0668e-01, 3.4421e-02, 9.6121e-03,
        2.2223e-01, 4.1732e-02, 2.0387e-01, 7.8140e-02])
[rfa agg] iter:  4, prev_obj_val: 1971.2137451171875, obj_val: 1973.611572265625, abs dis: 2.3978271484375
[rfa agg] iter: 4, weight: tensor([2.9935e-05, 6.6928e-02, 5.4551e-02, 3.0119e-01, 5.5315e-02, 1.4024e-02,
        1.8020e-01, 6.9296e-02, 1.7358e-01, 8.4887e-02])
[rfa agg] iter:  5, prev_obj_val: 1973.611572265625, obj_val: 1973.6083984375, abs dis: 0.003173828125
[rfa agg] iter: 5, weight: tensor([3.4684e-05, 7.2522e-02, 5.9954e-02, 2.6057e-01, 7.1016e-02, 1.6956e-02,
        1.7173e-01, 9.1076e-02, 1.6623e-01, 8.9914e-02])
			Update norm = 202.36266562165068 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 463.41686844825745 sec.
Server Epoch:28 choose agents : [46, 17, 59, 22, 99, 72, 52, 98, 91, 82].
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 431/1904 (22.6366%)
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 703/1904 (36.9223%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8217, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 423/1574 (26.8742%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 676/1574 (42.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4715, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   1, Avg loss: 0.0523, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 467/1089 (42.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1044, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 506/1470 (34.4218%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 824/1470 (56.0544%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.3885, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   1, Avg loss: 0.0659, Accuracy: 180/773 (23.2859%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5418, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 262/1241 (21.1120%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 383/1241 (30.8622%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5747, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 293/636 (46.0692%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0141, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0792, Accuracy: 44/373 (11.7962%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7089, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 339/1030 (32.9126%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0253, Accuracy: 619/1030 (60.0971%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5674, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0721, Accuracy: 98/500 (19.6000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.0377, Accuracy: 40/10000 (0.4000%)
time spent on training: 163.93445539474487
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 1574, 1089, 1470, 773, 1241, 636, 373, 1030, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 17, 59, 22, 99, 72, 52, 98, 91, 82], weight: tensor([0.1798, 0.1486, 0.1028, 0.1388, 0.0730, 0.1172, 0.0601, 0.0352, 0.0973,
        0.0472])
[rfa agg] iter:  0, prev_obj_val: 56.611907958984375, obj_val: 60.386837005615234, abs dis: 3.7749290466308594
[rfa agg] iter: 0, weight: tensor([0.0456, 0.0624, 0.3002, 0.0791, 0.0508, 0.1401, 0.0253, 0.0097, 0.2711,
        0.0158])
[rfa agg] iter:  1, prev_obj_val: 60.386837005615234, obj_val: 65.13986206054688, abs dis: 4.753025054931641
[rfa agg] iter: 1, weight: tensor([0.0475, 0.0620, 0.2156, 0.0756, 0.0724, 0.1159, 0.0328, 0.0120, 0.3465,
        0.0198])
[rfa agg] iter:  2, prev_obj_val: 65.13986206054688, obj_val: 65.12866973876953, abs dis: 0.01119232177734375
[rfa agg] iter: 2, weight: tensor([0.0571, 0.0717, 0.1781, 0.0847, 0.1277, 0.1178, 0.0499, 0.0171, 0.2670,
        0.0289])
			Update norm = 140.19519038201702 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.30142736434937 sec.
Server Epoch:29 choose agents : [10, 7, 89, 13, 63, 58, 93, 74, 67, 70].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0621, Accuracy: 172/861 (19.9768%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0279, Accuracy: 310/861 (36.0046%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0233, Accuracy: 403/861 (46.8060%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0225, Accuracy: 402/861 (46.6899%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0220, Accuracy: 399/861 (46.3415%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0223, Accuracy: 412/861 (47.8513%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0216, Accuracy: 415/861 (48.1998%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0210, Accuracy: 452/861 (52.4971%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0205, Accuracy: 454/861 (52.7294%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0208, Accuracy: 441/861 (51.2195%), train_poison_data_count: 280
Global model norm: 112.04826840752605.
Norm before scaling: 112.03834095411267. Distance: 1.0378710003003577
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.3634, Accuracy: 88/10000 (0.8800%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.9295, Accuracy: 8595/9950 (86.3819%)
Scaling by  100
Scaled Norm after poisoning: 151.64636210811324, distance: 103.7870933314326
Total norm for 2 adversaries is: 151.64636210811324. distance: 103.7870933314326
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0507, Accuracy: 371/891 (41.6386%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 470/891 (52.7497%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6889, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0347, Accuracy: 408/896 (45.5357%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5139, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 609/1645 (37.0213%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1235, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 399/888 (44.9324%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.4853, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2861, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 418/1742 (23.9954%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 726/1742 (41.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2143, Accuracy: 85/10000 (0.8500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 461/1552 (29.7036%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 786/1552 (50.6443%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.7462, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   1, Avg loss: 0.0745, Accuracy: 65/426 (15.2582%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   2, Avg loss: 0.0400, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.9368, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1418 (24.1185%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 644/1418 (45.4161%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7477, Accuracy: 99/10000 (0.9900%)
time spent on training: 293.68808245658875
[rfa agg] training data poison_ratio: 0.21695738176586946  data num: [861, 891, 896, 1645, 888, 803, 1742, 1552, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06779918180183421
[rfa agg] init. name: [10, 7, 89, 13, 63, 58, 93, 74, 67, 70], weight: tensor([0.0774, 0.0801, 0.0806, 0.1479, 0.0798, 0.0722, 0.1566, 0.1395, 0.0383,
        0.1275])
[rfa agg] iter:  0, prev_obj_val: 8899.0830078125, obj_val: 5184.97021484375, abs dis: 3714.11279296875
[rfa agg] iter: 0, weight: tensor([0.0069, 0.0851, 0.0856, 0.1607, 0.0848, 0.0766, 0.1708, 0.1514, 0.0402,
        0.1378])
[rfa agg] iter:  1, prev_obj_val: 5184.97021484375, obj_val: 4879.93017578125, abs dis: 305.0400390625
[rfa agg] iter: 1, weight: tensor([0.0005, 0.0742, 0.0746, 0.1771, 0.0740, 0.0657, 0.1971, 0.1631, 0.0313,
        0.1423])
[rfa agg] iter:  2, prev_obj_val: 4879.93017578125, obj_val: 4883.74560546875, abs dis: 3.8154296875
[rfa agg] iter: 2, weight: tensor([3.3217e-05, 2.3892e-02, 2.4046e-02, 2.0319e-01, 2.3817e-02, 1.9609e-02,
        1.1523e-01, 3.2481e-01, 6.7398e-03, 2.5863e-01])
[rfa agg] iter:  3, prev_obj_val: 4883.74560546875, obj_val: 4886.2568359375, abs dis: 2.51123046875
[rfa agg] iter: 3, weight: tensor([5.2810e-05, 5.0423e-02, 5.0786e-02, 1.5341e-01, 5.0255e-02, 4.0241e-02,
        1.1369e-01, 1.8650e-01, 1.2559e-02, 3.4209e-01])
[rfa agg] iter:  4, prev_obj_val: 4886.2568359375, obj_val: 4891.50390625, abs dis: 5.2470703125
[rfa agg] iter: 4, weight: tensor([6.3294e-05, 6.9611e-02, 7.0062e-02, 1.5122e-01, 6.9337e-02, 5.4582e-02,
        1.1840e-01, 1.7429e-01, 1.6166e-02, 2.7627e-01])
[rfa agg] iter:  5, prev_obj_val: 4891.50390625, obj_val: 4891.4892578125, abs dis: 0.0146484375
[rfa agg] iter: 5, weight: tensor([7.2074e-05, 1.1340e-01, 1.1430e-01, 1.2728e-01, 1.1295e-01, 8.4404e-02,
        1.0680e-01, 1.3860e-01, 2.1605e-02, 1.8058e-01])
			Update norm = 166.82329489238006 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3148, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.4084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 456.0051655769348 sec.
Server Epoch:30 choose agents : [65, 62, 75, 52, 98, 71, 47, 25, 1, 15].
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   1, Avg loss: 0.0573, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 693/1475 (46.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.9396, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   1, Avg loss: 0.0701, Accuracy: 142/568 (25.0000%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.1058, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.2864, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 294/636 (46.2264%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   1, Avg loss: 0.0793, Accuracy: 44/373 (11.7962%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.7189, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   1, Avg loss: 0.0644, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 344/818 (42.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7675, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   1, Avg loss: 0.1210, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   2, Avg loss: 0.1060, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3446, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   1, Avg loss: 0.0539, Accuracy: 337/690 (48.8406%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0540, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 588/928 (63.3621%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1620, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/1154 (42.4610%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4067, Accuracy: 58/10000 (0.5800%)
time spent on training: 152.14569640159607
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 568, 776, 636, 373, 818, 134, 690, 928, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 62, 75, 52, 98, 71, 47, 25, 1, 15], weight: tensor([0.1953, 0.0752, 0.1028, 0.0842, 0.0494, 0.1083, 0.0177, 0.0914, 0.1229,
        0.1528])
[rfa agg] iter:  0, prev_obj_val: 43.630699157714844, obj_val: 48.472145080566406, abs dis: 4.8414459228515625
[rfa agg] iter: 0, weight: tensor([0.0368, 0.0461, 0.2744, 0.0708, 0.0164, 0.2752, 0.0040, 0.1230, 0.1024,
        0.0507])
[rfa agg] iter:  1, prev_obj_val: 48.472145080566406, obj_val: 50.65473937988281, abs dis: 2.1825942993164062
[rfa agg] iter: 1, weight: tensor([0.0334, 0.0809, 0.1109, 0.1559, 0.0219, 0.1166, 0.0049, 0.3657, 0.0674,
        0.0424])
[rfa agg] iter:  2, prev_obj_val: 50.65473937988281, obj_val: 59.50749206542969, abs dis: 8.852752685546875
[rfa agg] iter: 2, weight: tensor([0.0320, 0.1054, 0.0885, 0.2348, 0.0242, 0.0931, 0.0052, 0.3174, 0.0598,
        0.0397])
[rfa agg] iter:  3, prev_obj_val: 59.50749206542969, obj_val: 66.88616180419922, abs dis: 7.378669738769531
[rfa agg] iter: 3, weight: tensor([0.0334, 0.3876, 0.0653, 0.1894, 0.0417, 0.0688, 0.0075, 0.1149, 0.0523,
        0.0392])
[rfa agg] iter:  4, prev_obj_val: 66.88616180419922, obj_val: 50.68259811401367, abs dis: 16.203563690185547
[rfa agg] iter: 4, weight: tensor([0.0479, 0.2799, 0.0801, 0.1593, 0.0939, 0.0844, 0.0137, 0.1178, 0.0686,
        0.0544])
[rfa agg] iter:  5, prev_obj_val: 50.68259811401367, obj_val: 56.215553283691406, abs dis: 5.532955169677734
[rfa agg] iter: 5, weight: tensor([0.0329, 0.1109, 0.0909, 0.2532, 0.0249, 0.0956, 0.0054, 0.2839, 0.0615,
        0.0408])
[rfa agg] iter:  6, prev_obj_val: 56.215553283691406, obj_val: 63.09678268432617, abs dis: 6.881229400634766
[rfa agg] iter: 6, weight: tensor([0.0330, 0.2622, 0.0709, 0.2815, 0.0343, 0.0747, 0.0066, 0.1431, 0.0544,
        0.0393])
[rfa agg] iter:  7, prev_obj_val: 63.09678268432617, obj_val: 66.88372802734375, abs dis: 3.786945343017578
[rfa agg] iter: 7, weight: tensor([0.0394, 0.3609, 0.0709, 0.1671, 0.0606, 0.0747, 0.0099, 0.1121, 0.0589,
        0.0455])
[rfa agg] iter:  8, prev_obj_val: 66.88372802734375, obj_val: 50.682491302490234, abs dis: 16.201236724853516
[rfa agg] iter: 8, weight: tensor([0.0479, 0.2792, 0.0802, 0.1593, 0.0940, 0.0845, 0.0137, 0.1180, 0.0687,
        0.0545])
[rfa agg] iter:  9, prev_obj_val: 50.682491302490234, obj_val: 56.215553283691406, abs dis: 5.533061981201172
[rfa agg] iter: 9, weight: tensor([0.0329, 0.1109, 0.0909, 0.2532, 0.0249, 0.0956, 0.0054, 0.2839, 0.0615,
        0.0408])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.5750663280487 sec.
Server Epoch:31 choose agents : [30, 71, 96, 55, 75, 32, 34, 20, 1, 65].
poison local model 30 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0786, Accuracy: 54/486 (11.1111%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 170/486 (34.9794%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   3, Avg loss: 0.0350, Accuracy: 178/486 (36.6255%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   4, Avg loss: 0.0357, Accuracy: 184/486 (37.8601%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   5, Avg loss: 0.0326, Accuracy: 184/486 (37.8601%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   6, Avg loss: 0.0321, Accuracy: 195/486 (40.1235%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   7, Avg loss: 0.0321, Accuracy: 200/486 (41.1523%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   8, Avg loss: 0.0313, Accuracy: 214/486 (44.0329%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   9, Avg loss: 0.0315, Accuracy: 209/486 (43.0041%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch  10, Avg loss: 0.0317, Accuracy: 199/486 (40.9465%), train_poison_data_count: 160
Global model norm: 112.04741428018319.
Norm before scaling: 112.04222836725447. Distance: 0.6986558022581043
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.4400, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.9698, Accuracy: 7458/9950 (74.9548%)
Scaling by  100
Scaled Norm after poisoning: 131.41893889390525, distance: 69.86557964226733
Total norm for 3 adversaries is: 131.41893889390525. distance: 69.86557964226733
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   1, Avg loss: 0.0633, Accuracy: 177/818 (21.6381%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 358/818 (43.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7863, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5164, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9684, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 263/776 (33.8918%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.4288, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0614, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6634, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 397/1427 (27.8206%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 583/1427 (40.8549%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3651, Accuracy: 78/10000 (0.7800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 354/807 (43.8662%)
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.0075, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0554, Accuracy: 301/928 (32.4353%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.1331, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 386/1475 (26.1695%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 703/1475 (47.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6786, Accuracy: 91/10000 (0.9100%)
time spent on training: 274.30617356300354
[rfa agg] training data poison_ratio: 0.26760244509848313  data num: [486, 818, 311, 1071, 776, 735, 1427, 807, 928, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.08362576409327598
[rfa agg] init. name: [30, 71, 96, 55, 75, 32, 34, 20, 1, 65], weight: tensor([0.0550, 0.0926, 0.0352, 0.1212, 0.0878, 0.0832, 0.1615, 0.0914, 0.1050,
        0.1670])
[rfa agg] iter:  0, prev_obj_val: 3697.4775390625, obj_val: 2055.361572265625, abs dis: 1642.115966796875
[rfa agg] iter: 0, weight: tensor([0.0033, 0.0958, 0.0352, 0.1278, 0.0909, 0.0857, 0.1751, 0.0946, 0.1097,
        0.1818])
[rfa agg] iter:  1, prev_obj_val: 2055.361572265625, obj_val: 2006.410888671875, abs dis: 48.95068359375
[rfa agg] iter: 1, weight: tensor([1.2937e-04, 5.5737e-02, 1.3985e-02, 9.8140e-02, 5.2895e-02, 4.7050e-02,
        2.6943e-01, 5.4951e-02, 7.2519e-02, 3.3516e-01])
[rfa agg] iter:  2, prev_obj_val: 2006.410888671875, obj_val: 2003.1357421875, abs dis: 3.275146484375
[rfa agg] iter: 2, weight: tensor([6.5215e-05, 7.2117e-02, 1.1854e-02, 2.5784e-01, 6.8614e-02, 5.5690e-02,
        1.8662e-01, 7.0890e-02, 1.2085e-01, 1.5546e-01])
[rfa agg] iter:  3, prev_obj_val: 2003.1357421875, obj_val: 2007.94677734375, abs dis: 4.81103515625
[rfa agg] iter: 3, weight: tensor([3.6022e-05, 1.1247e-01, 9.1648e-03, 1.4920e-01, 1.0836e-01, 7.0178e-02,
        5.2415e-02, 1.0820e-01, 3.4185e-01, 4.8117e-02])
[rfa agg] iter:  4, prev_obj_val: 2007.94677734375, obj_val: 2013.7100830078125, abs dis: 5.7633056640625
[rfa agg] iter: 4, weight: tensor([2.5684e-05, 2.3354e-01, 8.1594e-03, 5.5529e-02, 2.2919e-01, 1.2502e-01,
        2.9934e-02, 1.9645e-01, 9.4035e-02, 2.8114e-02])
[rfa agg] iter:  5, prev_obj_val: 2013.7100830078125, obj_val: 2017.414306640625, abs dis: 3.7042236328125
[rfa agg] iter: 5, weight: tensor([3.1234e-05, 1.8005e-01, 1.1332e-02, 5.4234e-02, 1.7127e-01, 2.7765e-01,
        3.3144e-02, 1.6435e-01, 7.6563e-02, 3.1367e-02])
[rfa agg] iter:  6, prev_obj_val: 2017.414306640625, obj_val: 2017.412109375, abs dis: 0.002197265625
[rfa agg] iter: 6, weight: tensor([3.8355e-05, 1.5828e-01, 1.4977e-02, 6.0730e-02, 1.5006e-01, 3.0892e-01,
        3.8947e-02, 1.4974e-01, 8.1310e-02, 3.6998e-02])
			Update norm = 104.47774695778523 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 434.3500394821167 sec.
Server Epoch:32 choose agents : [65, 23, 30, 72, 95, 33, 28, 49, 21, 55].
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   1, Avg loss: 0.0556, Accuracy: 404/1475 (27.3898%)
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 665/1475 (45.0847%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3482, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8663, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   1, Avg loss: 0.0743, Accuracy: 101/486 (20.7819%)
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   2, Avg loss: 0.0389, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.5157, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0619, Accuracy: 265/1241 (21.3537%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 384/1241 (30.9428%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5308, Accuracy: 65/10000 (0.6500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0504, Accuracy: 345/599 (57.5960%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.0763, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   2, Avg loss: 0.0491, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2213, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 382/1581 (24.1619%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7736, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8885, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 418/1949 (21.4469%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 615/1949 (31.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.7445, Accuracy: 81/10000 (0.8100%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 498/1071 (46.4986%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.5527, Accuracy: 66/10000 (0.6600%)
time spent on training: 203.99886536598206
[rfa agg] training data poison_ratio: 0.21405877680698968  data num: [1475, 715, 486, 1241, 599, 515, 1581, 440, 1949, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06689336775218427
[rfa agg] init. name: [65, 23, 30, 72, 95, 33, 28, 49, 21, 55], weight: tensor([0.1464, 0.0710, 0.0483, 0.1232, 0.0595, 0.0511, 0.1570, 0.0437, 0.1935,
        0.1063])
[rfa agg] iter:  0, prev_obj_val: 67.60063171386719, obj_val: 70.98321533203125, abs dis: 3.3825836181640625
[rfa agg] iter: 0, weight: tensor([0.0818, 0.0555, 0.0211, 0.1553, 0.0334, 0.0251, 0.0770, 0.0172, 0.0544,
        0.4791])
[rfa agg] iter:  1, prev_obj_val: 70.98321533203125, obj_val: 76.9566879272461, abs dis: 5.973472595214844
[rfa agg] iter: 1, weight: tensor([0.0830, 0.0799, 0.0275, 0.1376, 0.0449, 0.0332, 0.0793, 0.0222, 0.0589,
        0.4336])
[rfa agg] iter:  2, prev_obj_val: 76.9566879272461, obj_val: 76.93173217773438, abs dis: 0.02495574951171875
[rfa agg] iter: 2, weight: tensor([0.0910, 0.1624, 0.0439, 0.1314, 0.0773, 0.0547, 0.0884, 0.0345, 0.0695,
        0.2470])
			Update norm = 131.00559834173117 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 366.0944330692291 sec.
Server Epoch:33 choose agents : [44, 90, 9, 28, 97, 86, 63, 52, 14, 85].
poison local model 44 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 425/1750 (24.2857%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0336, Accuracy: 716/1750 (40.9143%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   3, Avg loss: 0.0290, Accuracy: 809/1750 (46.2286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   4, Avg loss: 0.0276, Accuracy: 915/1750 (52.2857%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   5, Avg loss: 0.0265, Accuracy: 948/1750 (54.1714%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   6, Avg loss: 0.0258, Accuracy: 972/1750 (55.5429%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   7, Avg loss: 0.0258, Accuracy: 971/1750 (55.4857%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   8, Avg loss: 0.0253, Accuracy: 986/1750 (56.3429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   9, Avg loss: 0.0248, Accuracy: 1000/1750 (57.1429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch  10, Avg loss: 0.0249, Accuracy: 997/1750 (56.9714%), train_poison_data_count: 560
Global model norm: 112.04741428018319.
Norm before scaling: 112.0187972507293. Distance: 1.266736378550014
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3439, Accuracy: 107/10000 (1.0700%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.3916, Accuracy: 9799/9950 (98.4824%)
Scaling by  100
Scaled Norm after poisoning: 166.73138717335138, distance: 126.6736471829283
Total norm for 1 adversaries is: 166.73138717335138. distance: 126.6736471829283
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   1, Avg loss: 0.0556, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9364, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 359/1275 (28.1569%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 685/1275 (53.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.9134, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 568/1581 (35.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8275, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 499/1213 (41.1377%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2924, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   1, Avg loss: 0.0641, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 383/1003 (38.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.6617, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   2, Avg loss: 0.0251, Accuracy: 455/888 (51.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4646, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   1, Avg loss: 0.0533, Accuracy: 311/636 (48.8994%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.9207, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 325/1013 (32.0829%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5257, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 429/1988 (21.5795%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 660/1988 (33.1992%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4340, Accuracy: 88/10000 (0.8800%)
time spent on training: 302.15944361686707
[rfa agg] training data poison_ratio: 0.145542248835662  data num: [1750, 677, 1275, 1581, 1213, 1003, 888, 636, 1013, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.045481952761144376
[rfa agg] init. name: [44, 90, 9, 28, 97, 86, 63, 52, 14, 85], weight: tensor([0.1455, 0.0563, 0.1060, 0.1315, 0.1009, 0.0834, 0.0739, 0.0529, 0.0842,
        0.1653])
[rfa agg] iter:  0, prev_obj_val: 31090.947265625, obj_val: 20687.3125, abs dis: 10403.634765625
[rfa agg] iter: 0, weight: tensor([0.0282, 0.0637, 0.1206, 0.1499, 0.1147, 0.0947, 0.0837, 0.0599, 0.0956,
        0.1891])
[rfa agg] iter:  1, prev_obj_val: 20687.3125, obj_val: 18619.9453125, abs dis: 2067.3671875
[rfa agg] iter: 1, weight: tensor([0.0049, 0.0640, 0.1233, 0.1549, 0.1170, 0.0960, 0.0846, 0.0600, 0.0970,
        0.1983])
[rfa agg] iter:  2, prev_obj_val: 18619.9453125, obj_val: 18268.138671875, abs dis: 351.806640625
[rfa agg] iter: 2, weight: tensor([0.0008, 0.0569, 0.1217, 0.1631, 0.1140, 0.0903, 0.0777, 0.0528, 0.0912,
        0.2315])
[rfa agg] iter:  3, prev_obj_val: 18268.138671875, obj_val: 18253.5703125, abs dis: 14.568359375
[rfa agg] iter: 3, weight: tensor([7.4063e-05, 2.1054e-02, 7.5118e-02, 1.8305e-01, 6.4969e-02, 4.2285e-02,
        3.2781e-02, 1.8787e-02, 4.2706e-02, 5.1917e-01])
[rfa agg] iter:  4, prev_obj_val: 18253.5703125, obj_val: 18247.82421875, abs dis: 5.74609375
[rfa agg] iter: 4, weight: tensor([5.4168e-05, 2.0157e-02, 9.8619e-02, 5.2779e-01, 7.9527e-02, 4.5401e-02,
        3.3288e-02, 1.7713e-02, 4.5859e-02, 1.3159e-01])
[rfa agg] iter:  5, prev_obj_val: 18247.82421875, obj_val: 18247.658203125, abs dis: 0.166015625
[rfa agg] iter: 5, weight: tensor([5.2473e-05, 2.6945e-02, 2.9648e-01, 1.8676e-01, 1.8739e-01, 7.5291e-02,
        4.9294e-02, 2.3115e-02, 7.5928e-02, 7.8741e-02])
[rfa agg] iter:  6, prev_obj_val: 18247.658203125, obj_val: 18252.591796875, abs dis: 4.93359375
[rfa agg] iter: 6, weight: tensor([3.1917e-05, 2.1498e-02, 2.6841e-01, 6.6310e-02, 3.7761e-01, 8.1889e-02,
        4.4780e-02, 1.7950e-02, 8.2710e-02, 3.8817e-02])
[rfa agg] iter:  7, prev_obj_val: 18252.591796875, obj_val: 18258.138671875, abs dis: 5.546875
[rfa agg] iter: 7, weight: tensor([3.7668e-05, 3.3705e-02, 1.2428e-01, 5.8890e-02, 1.7445e-01, 2.2526e-01,
        8.6035e-02, 2.7150e-02, 2.3044e-01, 3.9741e-02])
[rfa agg] iter:  8, prev_obj_val: 18258.138671875, obj_val: 18263.607421875, abs dis: 5.46875
[rfa agg] iter: 8, weight: tensor([3.0886e-05, 3.6734e-02, 6.8693e-02, 4.0807e-02, 8.3398e-02, 2.8783e-01,
        1.3115e-01, 2.8261e-02, 2.9344e-01, 2.9651e-02])
[rfa agg] iter:  9, prev_obj_val: 18263.607421875, obj_val: 18263.5625, abs dis: 0.044921875
[rfa agg] iter: 9, weight: tensor([3.7560e-05, 5.7022e-02, 6.8612e-02, 4.4946e-02, 7.9352e-02, 1.8458e-01,
        3.0336e-01, 4.1800e-02, 1.8628e-01, 3.4009e-02])
			Update norm = 131.07097165038107 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 463.7340281009674 sec.
Server Epoch:34 choose agents : [75, 51, 83, 60, 39, 88, 49, 64, 59, 13].
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   1, Avg loss: 0.0633, Accuracy: 270/776 (34.7938%)
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 417/776 (53.7371%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.6000, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 509/1049 (48.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0803, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 436/1953 (22.3246%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 773/1953 (39.5801%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1867, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 621/2227 (27.8850%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1015/2227 (45.5770%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0507, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 464/1013 (45.8045%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8484, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   1, Avg loss: 0.0713, Accuracy: 151/603 (25.0415%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.5035, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0789, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8399, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 172/953 (18.0483%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 296/953 (31.0598%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.8240, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 320/1089 (29.3848%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 497/1089 (45.6382%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2488, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9306, Accuracy: 97/10000 (0.9700%)
time spent on training: 190.14747500419617
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1049, 1953, 2227, 1013, 603, 440, 953, 1089, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 51, 83, 60, 39, 88, 49, 64, 59, 13], weight: tensor([0.0661, 0.0893, 0.1662, 0.1896, 0.0862, 0.0513, 0.0375, 0.0811, 0.0927,
        0.1400])
[rfa agg] iter:  0, prev_obj_val: 73.82835388183594, obj_val: 74.05645751953125, abs dis: 0.2281036376953125
[rfa agg] iter: 0, weight: tensor([0.0531, 0.1410, 0.1069, 0.0873, 0.1102, 0.0301, 0.0173, 0.0866, 0.1903,
        0.1772])
[rfa agg] iter:  1, prev_obj_val: 74.05645751953125, obj_val: 77.48635864257812, abs dis: 3.429901123046875
[rfa agg] iter: 1, weight: tensor([0.0449, 0.1961, 0.0501, 0.0433, 0.1248, 0.0227, 0.0123, 0.0853, 0.3506,
        0.0699])
[rfa agg] iter:  2, prev_obj_val: 77.48635864257812, obj_val: 79.12018585205078, abs dis: 1.6338272094726562
[rfa agg] iter: 2, weight: tensor([0.0521, 0.2579, 0.0324, 0.0290, 0.2612, 0.0222, 0.0111, 0.1339, 0.1587,
        0.0415])
[rfa agg] iter:  3, prev_obj_val: 79.12018585205078, obj_val: 86.51295471191406, abs dis: 7.392768859863281
[rfa agg] iter: 3, weight: tensor([0.0555, 0.1879, 0.0289, 0.0261, 0.3546, 0.0222, 0.0109, 0.1672, 0.1102,
        0.0364])
[rfa agg] iter:  4, prev_obj_val: 86.51295471191406, obj_val: 86.44973754882812, abs dis: 0.0632171630859375
[rfa agg] iter: 4, weight: tensor([0.1329, 0.1173, 0.0347, 0.0319, 0.1865, 0.0388, 0.0172, 0.3108, 0.0881,
        0.0419])
[rfa agg] iter:  5, prev_obj_val: 86.44973754882812, obj_val: 83.66446685791016, abs dis: 2.7852706909179688
[rfa agg] iter: 5, weight: tensor([0.1306, 0.1109, 0.0332, 0.0304, 0.1719, 0.0371, 0.0164, 0.3452, 0.0843,
        0.0400])
[rfa agg] iter:  6, prev_obj_val: 83.66446685791016, obj_val: 92.5592269897461, abs dis: 8.894760131835938
[rfa agg] iter: 6, weight: tensor([0.0855, 0.1121, 0.0286, 0.0261, 0.1932, 0.0280, 0.0129, 0.3978, 0.0811,
        0.0349])
[rfa agg] iter:  7, prev_obj_val: 92.5592269897461, obj_val: 86.48294830322266, abs dis: 6.0762786865234375
[rfa agg] iter: 7, weight: tensor([0.2848, 0.0988, 0.0380, 0.0353, 0.1329, 0.0574, 0.0230, 0.2045, 0.0806,
        0.0447])
[rfa agg] iter:  8, prev_obj_val: 86.48294830322266, obj_val: 86.44879150390625, abs dis: 0.03415679931640625
[rfa agg] iter: 8, weight: tensor([0.1389, 0.1136, 0.0340, 0.0313, 0.1738, 0.0382, 0.0169, 0.3256, 0.0866,
        0.0410])
[rfa agg] iter:  9, prev_obj_val: 86.44879150390625, obj_val: 83.66415405273438, abs dis: 2.784637451171875
[rfa agg] iter: 9, weight: tensor([0.1302, 0.1104, 0.0330, 0.0303, 0.1706, 0.0370, 0.0163, 0.3485, 0.0839,
        0.0398])
			Update norm = 135.47438353338242 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.47300577163696 sec.
Server Epoch:35 choose agents : [55, 53, 77, 15, 26, 52, 33, 82, 60, 63].
poison local model 55 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   1, Avg loss: 0.0591, Accuracy: 224/1071 (20.9150%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   2, Avg loss: 0.0315, Accuracy: 380/1071 (35.4809%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   3, Avg loss: 0.0275, Accuracy: 431/1071 (40.2428%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   4, Avg loss: 0.0266, Accuracy: 484/1071 (45.1914%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   5, Avg loss: 0.0259, Accuracy: 492/1071 (45.9384%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   6, Avg loss: 0.0253, Accuracy: 507/1071 (47.3389%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   7, Avg loss: 0.0256, Accuracy: 519/1071 (48.4594%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   8, Avg loss: 0.0253, Accuracy: 514/1071 (47.9925%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   9, Avg loss: 0.0236, Accuracy: 564/1071 (52.6611%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch  10, Avg loss: 0.0240, Accuracy: 538/1071 (50.2334%), train_poison_data_count: 340
Global model norm: 112.04741428018319.
Norm before scaling: 112.03220449384186. Distance: 1.0302762144512339
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4448, Accuracy: 81/10000 (0.8100%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.9020, Accuracy: 9228/9950 (92.7437%)
Scaling by  100
Scaled Norm after poisoning: 150.7399263321599, distance: 103.02761974192892
Total norm for 1 adversaries is: 150.7399263321599. distance: 103.02761974192892
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   1, Avg loss: 0.0469, Accuracy: 303/813 (37.2694%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 467/813 (57.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.5216, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   1, Avg loss: 0.0521, Accuracy: 335/1340 (25.0000%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 540/1340 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1715, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   1, Avg loss: 0.0557, Accuracy: 332/1154 (28.7695%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   2, Avg loss: 0.0303, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3064, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 476/1446 (32.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6027, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   1, Avg loss: 0.0540, Accuracy: 311/636 (48.8994%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   2, Avg loss: 0.0297, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.6975, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 116/515 (22.5243%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9755, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   1, Avg loss: 0.0720, Accuracy: 89/500 (17.8000%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.0199, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 543/2227 (24.3826%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1024/2227 (45.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4001, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 268/888 (30.1802%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 406/888 (45.7207%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6494, Accuracy: 53/10000 (0.5300%)
time spent on training: 286.2966961860657
[rfa agg] training data poison_ratio: 0.10113314447592069  data num: [1071, 813, 1340, 1154, 1446, 636, 515, 500, 2227, 888]
[rfa agg] considering poison per batch poison_fraction: 0.03160410764872521
[rfa agg] init. name: [55, 53, 77, 15, 26, 52, 33, 82, 60, 63], weight: tensor([0.1011, 0.0768, 0.1265, 0.1090, 0.1365, 0.0601, 0.0486, 0.0472, 0.2103,
        0.0839])
[rfa agg] iter:  0, prev_obj_val: 13776.779296875, obj_val: 8405.31640625, abs dis: 5371.462890625
[rfa agg] iter: 0, weight: tensor([0.0125, 0.0836, 0.1390, 0.1194, 0.1504, 0.0651, 0.0527, 0.0511, 0.2349,
        0.0914])
[rfa agg] iter:  1, prev_obj_val: 8405.31640625, obj_val: 7760.4150390625, abs dis: 644.9013671875
[rfa agg] iter: 1, weight: tensor([0.0014, 0.0785, 0.1395, 0.1179, 0.1536, 0.0598, 0.0480, 0.0462, 0.2685,
        0.0866])
[rfa agg] iter:  2, prev_obj_val: 7760.4150390625, obj_val: 7740.41796875, abs dis: 19.9970703125
[rfa agg] iter: 2, weight: tensor([1.1252e-04, 4.0162e-02, 1.1867e-01, 8.5318e-02, 1.5983e-01, 2.6936e-02,
        2.0821e-02, 1.9338e-02, 4.8237e-01, 4.6439e-02])
[rfa agg] iter:  3, prev_obj_val: 7740.41796875, obj_val: 7732.73046875, abs dis: 7.6875
[rfa agg] iter: 3, weight: tensor([7.7094e-05, 4.1240e-02, 1.9678e-01, 1.1554e-01, 3.9826e-01, 2.5834e-02,
        1.9614e-02, 1.7926e-02, 1.3563e-01, 4.9094e-02])
[rfa agg] iter:  4, prev_obj_val: 7732.73046875, obj_val: 7735.1865234375, abs dis: 2.4560546875
[rfa agg] iter: 4, weight: tensor([3.9960e-05, 3.2001e-02, 4.5067e-01, 1.6503e-01, 2.1828e-01, 1.8245e-02,
        1.3554e-02, 1.2150e-02, 5.0190e-02, 3.9842e-02])
[rfa agg] iter:  5, prev_obj_val: 7735.1865234375, obj_val: 7739.34375, abs dis: 4.1572265625
[rfa agg] iter: 5, weight: tensor([4.4106e-05, 4.6866e-02, 2.2349e-01, 4.3845e-01, 1.2328e-01, 2.4576e-02,
        1.7939e-02, 1.5845e-02, 4.8481e-02, 6.1039e-02])
[rfa agg] iter:  6, prev_obj_val: 7739.34375, obj_val: 7739.33154296875, abs dis: 0.01220703125
[rfa agg] iter: 6, weight: tensor([6.0249e-05, 8.4817e-02, 1.7705e-01, 3.4213e-01, 1.2364e-01, 4.0216e-02,
        2.8791e-02, 2.5052e-02, 6.0594e-02, 1.1765e-01])
[rfa agg] iter:  7, prev_obj_val: 7739.33154296875, obj_val: 7740.93310546875, abs dis: 1.6015625
[rfa agg] iter: 7, weight: tensor([6.0572e-05, 8.5519e-02, 1.7780e-01, 3.3769e-01, 1.2444e-01, 4.0472e-02,
        2.8961e-02, 2.5197e-02, 6.0934e-02, 1.1892e-01])
[rfa agg] iter:  8, prev_obj_val: 7740.93310546875, obj_val: 7742.54833984375, abs dis: 1.615234375
[rfa agg] iter: 8, weight: tensor([6.5321e-05, 1.0339e-01, 1.6907e-01, 2.8328e-01, 1.2330e-01, 4.6728e-02,
        3.3169e-02, 2.8675e-02, 6.3898e-02, 1.4842e-01])
[rfa agg] iter:  9, prev_obj_val: 7742.54833984375, obj_val: 7740.9326171875, abs dis: 1.61572265625
[rfa agg] iter: 9, weight: tensor([6.7527e-05, 1.2175e-01, 1.5619e-01, 2.3741e-01, 1.1789e-01, 5.1999e-02,
        3.6565e-02, 3.1385e-02, 6.4287e-02, 1.8245e-01])
			Update norm = 153.22193997801034 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3174, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.4121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.07534980773926 sec.
Server Epoch:36 choose agents : [13, 2, 71, 52, 77, 36, 14, 45, 7, 65].
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 324/1645 (19.6960%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 595/1645 (36.1702%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5816, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0599, Accuracy: 248/605 (40.9917%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.2039, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 174/818 (21.2714%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.6194, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0548, Accuracy: 309/636 (48.5849%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0298, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.6707, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0525, Accuracy: 340/1340 (25.3731%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 592/1340 (44.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0249, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   2, Avg loss: 0.0523, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.7509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 365/1013 (36.0316%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2227, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   1, Avg loss: 0.0654, Accuracy: 215/669 (32.1375%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   2, Avg loss: 0.0396, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9981, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0512, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 439/891 (49.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7475, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 376/1475 (25.4915%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 687/1475 (46.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2751, Accuracy: 92/10000 (0.9200%)
time spent on training: 173.79649257659912
[rfa agg] training data poison_ratio: 0.0  data num: [1645, 605, 818, 636, 1340, 408, 1013, 669, 891, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [13, 2, 71, 52, 77, 36, 14, 45, 7, 65], weight: tensor([0.1732, 0.0637, 0.0861, 0.0669, 0.1411, 0.0429, 0.1066, 0.0704, 0.0938,
        0.1553])
[rfa agg] iter:  0, prev_obj_val: 52.22040939331055, obj_val: 57.60631561279297, abs dis: 5.385906219482422
[rfa agg] iter: 0, weight: tensor([0.0525, 0.0368, 0.1053, 0.0386, 0.0809, 0.0161, 0.3915, 0.0496, 0.1707,
        0.0580])
[rfa agg] iter:  1, prev_obj_val: 57.60631561279297, obj_val: 59.45195388793945, abs dis: 1.8456382751464844
[rfa agg] iter: 1, weight: tensor([0.0386, 0.0603, 0.3161, 0.0629, 0.0509, 0.0207, 0.1021, 0.0972, 0.2105,
        0.0408])
[rfa agg] iter:  2, prev_obj_val: 59.45195388793945, obj_val: 66.4753646850586, abs dis: 7.023410797119141
[rfa agg] iter: 2, weight: tensor([0.0374, 0.0722, 0.3277, 0.0757, 0.0482, 0.0227, 0.0873, 0.1273, 0.1620,
        0.0393])
[rfa agg] iter:  3, prev_obj_val: 66.4753646850586, obj_val: 72.4098129272461, abs dis: 5.9344482421875
[rfa agg] iter: 3, weight: tensor([0.0311, 0.1457, 0.1122, 0.1513, 0.0380, 0.0288, 0.0571, 0.3222, 0.0815,
        0.0322])
[rfa agg] iter:  4, prev_obj_val: 72.4098129272461, obj_val: 76.05451965332031, abs dis: 3.6447067260742188
[rfa agg] iter: 4, weight: tensor([0.0261, 0.2757, 0.0676, 0.2840, 0.0309, 0.0341, 0.0427, 0.1566, 0.0555,
        0.0268])
[rfa agg] iter:  5, prev_obj_val: 76.05451965332031, obj_val: 80.01033020019531, abs dis: 3.955810546875
[rfa agg] iter: 5, weight: tensor([0.0303, 0.2707, 0.0696, 0.2804, 0.0354, 0.0487, 0.0472, 0.1277, 0.0592,
        0.0309])
[rfa agg] iter:  6, prev_obj_val: 80.01033020019531, obj_val: 76.05758666992188, abs dis: 3.9527435302734375
[rfa agg] iter: 6, weight: tensor([0.0391, 0.2226, 0.0814, 0.2322, 0.0451, 0.0801, 0.0583, 0.1305, 0.0710,
        0.0397])
[rfa agg] iter:  7, prev_obj_val: 76.05758666992188, obj_val: 80.0098876953125, abs dis: 3.952301025390625
[rfa agg] iter: 7, weight: tensor([0.0308, 0.2692, 0.0708, 0.2748, 0.0359, 0.0496, 0.0479, 0.1296, 0.0601,
        0.0314])
[rfa agg] iter:  8, prev_obj_val: 80.0098876953125, obj_val: 76.05760955810547, abs dis: 3.9522781372070312
[rfa agg] iter: 8, weight: tensor([0.0391, 0.2226, 0.0815, 0.2320, 0.0451, 0.0801, 0.0583, 0.1305, 0.0711,
        0.0397])
[rfa agg] iter:  9, prev_obj_val: 76.05760955810547, obj_val: 80.0098876953125, abs dis: 3.9522781372070312
[rfa agg] iter: 9, weight: tensor([0.0308, 0.2692, 0.0708, 0.2748, 0.0359, 0.0496, 0.0479, 0.1296, 0.0601,
        0.0314])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3205, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.4192, Accuracy: 0/9950 (0.0000%)
saving model
Done in 338.81443977355957 sec.
Server Epoch:37 choose agents : [47, 82, 46, 56, 36, 98, 76, 12, 35, 63].
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1186, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1058, Accuracy: 29/134 (21.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3548, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   1, Avg loss: 0.0724, Accuracy: 93/500 (18.6000%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.1556, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0557, Accuracy: 414/1904 (21.7437%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 661/1904 (34.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7947, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3566, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   1, Avg loss: 0.0853, Accuracy: 84/408 (20.5882%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.8827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   1, Avg loss: 0.0787, Accuracy: 45/373 (12.0643%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.8096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   1, Avg loss: 0.0819, Accuracy: 66/466 (14.1631%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   2, Avg loss: 0.0466, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2136, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 129/338 (38.1657%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.5805, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   1, Avg loss: 0.0532, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   2, Avg loss: 0.0250, Accuracy: 464/888 (52.2523%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.9928, Accuracy: 69/10000 (0.6900%)
time spent on training: 145.86310744285583
[rfa agg] training data poison_ratio: 0.0  data num: [134, 500, 1904, 186, 408, 373, 466, 338, 271, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 82, 46, 56, 36, 98, 76, 12, 35, 63], weight: tensor([0.0245, 0.0914, 0.3482, 0.0340, 0.0746, 0.0682, 0.0852, 0.0618, 0.0496,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 83.86790466308594, obj_val: 83.98385620117188, abs dis: 0.1159515380859375
[rfa agg] iter: 0, weight: tensor([0.0084, 0.0596, 0.0760, 0.0116, 0.0412, 0.0327, 0.0555, 0.0296, 0.0210,
        0.6643])
[rfa agg] iter:  1, prev_obj_val: 83.98385620117188, obj_val: 84.62820434570312, abs dis: 0.64434814453125
[rfa agg] iter: 1, weight: tensor([0.0160, 0.1573, 0.0966, 0.0223, 0.0972, 0.0714, 0.1467, 0.0647, 0.0432,
        0.2847])
[rfa agg] iter:  2, prev_obj_val: 84.62820434570312, obj_val: 90.40069580078125, abs dis: 5.772491455078125
[rfa agg] iter: 2, weight: tensor([0.0103, 0.3139, 0.0377, 0.0143, 0.1111, 0.0626, 0.2925, 0.0567, 0.0326,
        0.0684])
[rfa agg] iter:  3, prev_obj_val: 90.40069580078125, obj_val: 96.1267318725586, abs dis: 5.726036071777344
[rfa agg] iter: 3, weight: tensor([0.0131, 0.1137, 0.0284, 0.0183, 0.2275, 0.2036, 0.1057, 0.1877, 0.0605,
        0.0414])
[rfa agg] iter:  4, prev_obj_val: 96.1267318725586, obj_val: 99.67508697509766, abs dis: 3.5483551025390625
[rfa agg] iter: 4, weight: tensor([0.0197, 0.0748, 0.0295, 0.0275, 0.1018, 0.2463, 0.0697, 0.2273, 0.1638,
        0.0396])
[rfa agg] iter:  5, prev_obj_val: 99.67508697509766, obj_val: 99.65875244140625, abs dis: 0.01633453369140625
[rfa agg] iter: 5, weight: tensor([0.0272, 0.0699, 0.0323, 0.0381, 0.0857, 0.1534, 0.0652, 0.1397, 0.3467,
        0.0418])
[rfa agg] iter:  6, prev_obj_val: 99.65875244140625, obj_val: 99.65699768066406, abs dis: 0.0017547607421875
[rfa agg] iter: 6, weight: tensor([0.0249, 0.0635, 0.0294, 0.0348, 0.0778, 0.1378, 0.0593, 0.1261, 0.4083,
        0.0380])
[rfa agg] iter:  7, prev_obj_val: 99.65699768066406, obj_val: 103.50249481201172, abs dis: 3.8454971313476562
[rfa agg] iter: 7, weight: tensor([0.0239, 0.0609, 0.0282, 0.0334, 0.0747, 0.1318, 0.0569, 0.1208, 0.4329,
        0.0365])
[rfa agg] iter:  8, prev_obj_val: 103.50249481201172, obj_val: 99.66138458251953, abs dis: 3.8411102294921875
[rfa agg] iter: 8, weight: tensor([0.0475, 0.0801, 0.0423, 0.0666, 0.0917, 0.1378, 0.0747, 0.1256, 0.2808,
        0.0528])
[rfa agg] iter:  9, prev_obj_val: 99.66138458251953, obj_val: 103.50064086914062, abs dis: 3.8392562866210938
[rfa agg] iter: 9, weight: tensor([0.0255, 0.0651, 0.0301, 0.0356, 0.0797, 0.1411, 0.0607, 0.1291, 0.3941,
        0.0389])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.8406801223755 sec.
Server Epoch:38 choose agents : [20, 56, 26, 83, 27, 50, 1, 89, 4, 41].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0581, Accuracy: 340/807 (42.1314%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0976, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0684, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3623, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 354/1446 (24.4813%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6166, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 452/1953 (23.1439%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 766/1953 (39.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2583, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 570/1587 (35.9168%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7273, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 167/809 (20.6428%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 380/809 (46.9716%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7625, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 575/928 (61.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2786, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.5227, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0590, Accuracy: 342/901 (37.9578%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0349, Accuracy: 385/901 (42.7303%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3765, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0574, Accuracy: 341/719 (47.4270%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0460, Accuracy: 70/10000 (0.7000%)
time spent on training: 190.55267786979675
[rfa agg] training data poison_ratio: 0.07887021110242377  data num: [807, 186, 1446, 1953, 1587, 809, 928, 896, 901, 719]
[rfa agg] considering poison per batch poison_fraction: 0.02464694096950743
[rfa agg] init. name: [20, 56, 26, 83, 27, 50, 1, 89, 4, 41], weight: tensor([0.0789, 0.0182, 0.1413, 0.1909, 0.1551, 0.0791, 0.0907, 0.0876, 0.0881,
        0.0703])
[rfa agg] iter:  0, prev_obj_val: 60.0511360168457, obj_val: 60.24077606201172, abs dis: 0.18964004516601562
[rfa agg] iter: 0, weight: tensor([0.0863, 0.0063, 0.1266, 0.0706, 0.1028, 0.0865, 0.1718, 0.1210, 0.1652,
        0.0631])
[rfa agg] iter:  1, prev_obj_val: 60.24077606201172, obj_val: 61.91020584106445, abs dis: 1.6694297790527344
[rfa agg] iter: 1, weight: tensor([0.0819, 0.0040, 0.0510, 0.0335, 0.0443, 0.0822, 0.2687, 0.1369, 0.2445,
        0.0530])
[rfa agg] iter:  2, prev_obj_val: 61.91020584106445, obj_val: 68.30583190917969, abs dis: 6.395626068115234
[rfa agg] iter: 2, weight: tensor([0.1021, 0.0035, 0.0368, 0.0257, 0.0328, 0.1034, 0.2334, 0.1918, 0.2120,
        0.0585])
[rfa agg] iter:  3, prev_obj_val: 68.30583190917969, obj_val: 78.90794372558594, abs dis: 10.60211181640625
[rfa agg] iter: 3, weight: tensor([0.2170, 0.0042, 0.0323, 0.0243, 0.0296, 0.2292, 0.0977, 0.1546, 0.0938,
        0.1173])
[rfa agg] iter:  4, prev_obj_val: 78.90794372558594, obj_val: 71.34833526611328, abs dis: 7.559608459472656
[rfa agg] iter: 4, weight: tensor([0.1667, 0.0074, 0.0427, 0.0341, 0.0400, 0.1679, 0.0877, 0.1149, 0.0849,
        0.2538])
[rfa agg] iter:  5, prev_obj_val: 71.34833526611328, obj_val: 74.95275115966797, abs dis: 3.6044158935546875
[rfa agg] iter: 5, weight: tensor([0.2203, 0.0046, 0.0320, 0.0246, 0.0296, 0.2142, 0.0818, 0.1181, 0.0788,
        0.1959])
[rfa agg] iter:  6, prev_obj_val: 74.95275115966797, obj_val: 74.94429779052734, abs dis: 0.008453369140625
[rfa agg] iter: 6, weight: tensor([0.1836, 0.0056, 0.0357, 0.0280, 0.0332, 0.1819, 0.0808, 0.1103, 0.0781,
        0.2629])
[rfa agg] iter:  7, prev_obj_val: 74.94429779052734, obj_val: 74.94369506835938, abs dis: 0.00060272216796875
[rfa agg] iter: 7, weight: tensor([0.1786, 0.0055, 0.0350, 0.0275, 0.0326, 0.1758, 0.0793, 0.1082, 0.0766,
        0.2808])
			Update norm = 108.43061487507806 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.4157545566559 sec.
Server Epoch:39 choose agents : [45, 63, 78, 36, 55, 93, 46, 8, 18, 28].
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   1, Avg loss: 0.0646, Accuracy: 217/669 (32.4365%)
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   2, Avg loss: 0.0384, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.1316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0528, Accuracy: 271/888 (30.5180%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 455/888 (51.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7492, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   1, Avg loss: 0.0793, Accuracy: 59/416 (14.1827%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   2, Avg loss: 0.0453, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0437, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 82/408 (20.0980%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   2, Avg loss: 0.0522, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.7969, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 271/1071 (25.3035%)
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2916, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 728/1742 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7691, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0552, Accuracy: 394/1904 (20.6933%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 658/1904 (34.5588%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8369, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0580, Accuracy: 282/1513 (18.6385%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 487/1513 (32.1877%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5771, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   1, Avg loss: 0.0733, Accuracy: 133/530 (25.0943%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   2, Avg loss: 0.0424, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9701, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 379/1581 (23.9722%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 630/1581 (39.8482%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6232, Accuracy: 92/10000 (0.9200%)
time spent on training: 205.0200319290161
[rfa agg] training data poison_ratio: 0.09988808058198097  data num: [669, 888, 416, 408, 1071, 1742, 1904, 1513, 530, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.03121502518186905
[rfa agg] init. name: [45, 63, 78, 36, 55, 93, 46, 8, 18, 28], weight: tensor([0.0624, 0.0828, 0.0388, 0.0381, 0.0999, 0.1625, 0.1776, 0.1411, 0.0494,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 67.9877700805664, obj_val: 70.31454467773438, abs dis: 2.3267745971679688
[rfa agg] iter: 0, weight: tensor([0.0463, 0.0975, 0.0193, 0.0189, 0.2755, 0.1071, 0.0960, 0.1650, 0.0294,
        0.1450])
[rfa agg] iter:  1, prev_obj_val: 70.31454467773438, obj_val: 72.93580627441406, abs dis: 2.6212615966796875
[rfa agg] iter: 1, weight: tensor([0.0444, 0.1018, 0.0176, 0.0173, 0.4155, 0.0810, 0.0739, 0.1162, 0.0275,
        0.1047])
[rfa agg] iter:  2, prev_obj_val: 72.93580627441406, obj_val: 76.70075225830078, abs dis: 3.7649459838867188
[rfa agg] iter: 2, weight: tensor([0.0339, 0.0875, 0.0127, 0.0125, 0.6149, 0.0482, 0.0447, 0.0654, 0.0202,
        0.0601])
[rfa agg] iter:  3, prev_obj_val: 76.70075225830078, obj_val: 78.7005615234375, abs dis: 1.9998092651367188
[rfa agg] iter: 3, weight: tensor([0.0560, 0.1726, 0.0195, 0.0192, 0.4289, 0.0612, 0.0574, 0.0793, 0.0319,
        0.0740])
[rfa agg] iter:  4, prev_obj_val: 78.7005615234375, obj_val: 82.86209106445312, abs dis: 4.161529541015625
[rfa agg] iter: 4, weight: tensor([0.0685, 0.2476, 0.0228, 0.0223, 0.3155, 0.0648, 0.0611, 0.0823, 0.0379,
        0.0773])
[rfa agg] iter:  5, prev_obj_val: 82.86209106445312, obj_val: 82.81622314453125, abs dis: 0.045867919921875
[rfa agg] iter: 5, weight: tensor([0.0768, 0.4402, 0.0226, 0.0222, 0.1702, 0.0526, 0.0501, 0.0647, 0.0392,
        0.0614])
[rfa agg] iter:  6, prev_obj_val: 82.81622314453125, obj_val: 87.61157989501953, abs dis: 4.795356750488281
[rfa agg] iter: 6, weight: tensor([0.0708, 0.4858, 0.0209, 0.0205, 0.1547, 0.0486, 0.0463, 0.0597, 0.0362,
        0.0566])
[rfa agg] iter:  7, prev_obj_val: 87.61157989501953, obj_val: 87.60945892333984, abs dis: 0.0021209716796875
[rfa agg] iter: 7, weight: tensor([0.0971, 0.5044, 0.0240, 0.0235, 0.1126, 0.0452, 0.0434, 0.0540, 0.0440,
        0.0517])
			Update norm = 121.82246463860842 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.1537163257599 sec.
Server Epoch:40 choose agents : [63, 47, 34, 98, 70, 76, 77, 11, 84, 87].
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0531, Accuracy: 273/888 (30.7432%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.7874, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1180, Accuracy: 8/134 (5.9701%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1034, Accuracy: 29/134 (21.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3619, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 373/1427 (26.1388%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 613/1427 (42.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2845, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   1, Avg loss: 0.0775, Accuracy: 53/373 (14.2091%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   2, Avg loss: 0.0451, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.8552, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 341/1418 (24.0480%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 631/1418 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6565, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   1, Avg loss: 0.0804, Accuracy: 71/466 (15.2361%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5545, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   1, Avg loss: 0.0520, Accuracy: 340/1340 (25.3731%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 574/1340 (42.8358%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1227, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   1, Avg loss: 0.0558, Accuracy: 357/712 (50.1404%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 391/712 (54.9157%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.0064, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0605, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 486/1190 (40.8403%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.4515, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 308/1131 (27.2325%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9911, Accuracy: 51/10000 (0.5100%)
time spent on training: 169.58819222450256
[rfa agg] training data poison_ratio: 0.0  data num: [888, 134, 1427, 373, 1418, 466, 1340, 712, 1190, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 47, 34, 98, 70, 76, 77, 11, 84, 87], weight: tensor([0.0978, 0.0148, 0.1572, 0.0411, 0.1562, 0.0513, 0.1476, 0.0784, 0.1311,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 48.281394958496094, obj_val: 52.206756591796875, abs dis: 3.9253616333007812
[rfa agg] iter: 0, weight: tensor([0.2397, 0.0048, 0.0852, 0.0177, 0.0846, 0.0279, 0.1086, 0.0895, 0.1478,
        0.1942])
[rfa agg] iter:  1, prev_obj_val: 52.206756591796875, obj_val: 56.89530563354492, abs dis: 4.688549041748047
[rfa agg] iter: 1, weight: tensor([0.4235, 0.0044, 0.0637, 0.0167, 0.0633, 0.0272, 0.0780, 0.1038, 0.0987,
        0.1207])
[rfa agg] iter:  2, prev_obj_val: 56.89530563354492, obj_val: 59.66250991821289, abs dis: 2.7672042846679688
[rfa agg] iter: 2, weight: tensor([0.4630, 0.0045, 0.0534, 0.0177, 0.0531, 0.0301, 0.0634, 0.1501, 0.0761,
        0.0885])
[rfa agg] iter:  3, prev_obj_val: 59.66250991821289, obj_val: 59.644989013671875, abs dis: 0.017520904541015625
[rfa agg] iter: 3, weight: tensor([0.3381, 0.0055, 0.0590, 0.0221, 0.0586, 0.0384, 0.0691, 0.2351, 0.0812,
        0.0927])
[rfa agg] iter:  4, prev_obj_val: 59.644989013671875, obj_val: 59.64474868774414, abs dis: 0.000240325927734375
[rfa agg] iter: 4, weight: tensor([0.3250, 0.0056, 0.0592, 0.0221, 0.0588, 0.0386, 0.0694, 0.2468, 0.0815,
        0.0930])
			Update norm = 117.35073214913275 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 327.69914507865906 sec.
Server Epoch:41 choose agents : [59, 2, 68, 89, 47, 69, 90, 26, 96, 40].
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   1, Avg loss: 0.0592, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 457/1089 (41.9651%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.2640, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0593, Accuracy: 267/605 (44.1322%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.1767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   1, Avg loss: 0.0617, Accuracy: 381/1163 (32.7601%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   2, Avg loss: 0.0379, Accuracy: 424/1163 (36.4574%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.8817, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0615, Accuracy: 340/896 (37.9464%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 413/896 (46.0938%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5055, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   1, Avg loss: 0.1192, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   2, Avg loss: 0.1052, Accuracy: 30/134 (22.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3566, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   1, Avg loss: 0.0522, Accuracy: 309/590 (52.3729%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1448, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 427/677 (63.0724%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9061, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 350/1446 (24.2047%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 515/1446 (35.6155%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5187, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.5164, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 366/1573 (23.2676%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 590/1573 (37.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9060, Accuracy: 85/10000 (0.8500%)
time spent on training: 179.06288194656372
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 605, 1163, 896, 134, 590, 677, 1446, 311, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 2, 68, 89, 47, 69, 90, 26, 96, 40], weight: tensor([0.1284, 0.0713, 0.1371, 0.1056, 0.0158, 0.0695, 0.0798, 0.1704, 0.0367,
        0.1854])
[rfa agg] iter:  0, prev_obj_val: 53.09388732910156, obj_val: 55.51299285888672, abs dis: 2.4191055297851562
[rfa agg] iter: 0, weight: tensor([0.1609, 0.0571, 0.1349, 0.3322, 0.0053, 0.0557, 0.0793, 0.0855, 0.0147,
        0.0744])
[rfa agg] iter:  1, prev_obj_val: 55.51299285888672, obj_val: 57.18828201293945, abs dis: 1.6752891540527344
[rfa agg] iter: 1, weight: tensor([0.0911, 0.0519, 0.0793, 0.5296, 0.0042, 0.0506, 0.0765, 0.0555, 0.0120,
        0.0494])
[rfa agg] iter:  2, prev_obj_val: 57.18828201293945, obj_val: 57.187408447265625, abs dis: 0.000873565673828125
[rfa agg] iter: 2, weight: tensor([0.0842, 0.0612, 0.0748, 0.5048, 0.0046, 0.0597, 0.0942, 0.0545, 0.0131,
        0.0490])
			Update norm = 121.77546817170321 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 335.5128529071808 sec.
Server Epoch:42 choose agents : [80, 48, 22, 54, 17, 4, 46, 71, 64, 34].
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 225/682 (32.9912%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.8726, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   1, Avg loss: 0.0721, Accuracy: 101/631 (16.0063%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.2140, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 524/1470 (35.6463%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 870/1470 (59.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4417, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   1, Avg loss: 0.0537, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 494/1130 (43.7168%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3307, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 372/1574 (23.6341%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 643/1574 (40.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3653, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0613, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0318, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6375, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 427/1904 (22.4265%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 694/1904 (36.4496%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0897, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 364/818 (44.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2072, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 328/953 (34.4176%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7848, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 588/1427 (41.2053%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4061, Accuracy: 72/10000 (0.7200%)
time spent on training: 192.11104440689087
[rfa agg] training data poison_ratio: 0.0  data num: [682, 631, 1470, 1130, 1574, 901, 1904, 818, 953, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 48, 22, 54, 17, 4, 46, 71, 64, 34], weight: tensor([0.0594, 0.0549, 0.1279, 0.0983, 0.1370, 0.0784, 0.1657, 0.0712, 0.0829,
        0.1242])
[rfa agg] iter:  0, prev_obj_val: 55.174137115478516, obj_val: 60.740272521972656, abs dis: 5.566135406494141
[rfa agg] iter: 0, weight: tensor([0.0342, 0.0274, 0.0864, 0.3612, 0.0681, 0.1125, 0.0497, 0.0587, 0.1183,
        0.0836])
[rfa agg] iter:  1, prev_obj_val: 60.740272521972656, obj_val: 62.442100524902344, abs dis: 1.7018280029296875
[rfa agg] iter: 1, weight: tensor([0.0407, 0.0309, 0.0529, 0.1195, 0.0449, 0.2690, 0.0356, 0.0862, 0.2690,
        0.0512])
[rfa agg] iter:  2, prev_obj_val: 62.442100524902344, obj_val: 73.25611877441406, abs dis: 10.814018249511719
[rfa agg] iter: 2, weight: tensor([0.0366, 0.0271, 0.0397, 0.0788, 0.0341, 0.3183, 0.0275, 0.0845, 0.3151,
        0.0384])
[rfa agg] iter:  3, prev_obj_val: 73.25611877441406, obj_val: 76.38973236083984, abs dis: 3.1336135864257812
[rfa agg] iter: 3, weight: tensor([0.0958, 0.0600, 0.0434, 0.0660, 0.0388, 0.1282, 0.0331, 0.3577, 0.1349,
        0.0421])
[rfa agg] iter:  4, prev_obj_val: 76.38973236083984, obj_val: 79.79071044921875, abs dis: 3.4009780883789062
[rfa agg] iter: 4, weight: tensor([0.1278, 0.0731, 0.0424, 0.0618, 0.0382, 0.1055, 0.0330, 0.3660, 0.1110,
        0.0411])
[rfa agg] iter:  5, prev_obj_val: 79.79071044921875, obj_val: 67.46562194824219, abs dis: 12.325088500976562
[rfa agg] iter: 5, weight: tensor([0.2017, 0.1013, 0.0460, 0.0644, 0.0417, 0.1008, 0.0365, 0.2568, 0.1062,
        0.0446])
[rfa agg] iter:  6, prev_obj_val: 67.46562194824219, obj_val: 67.43158721923828, abs dis: 0.03403472900390625
[rfa agg] iter: 6, weight: tensor([0.0651, 0.0451, 0.0472, 0.0803, 0.0414, 0.2121, 0.0345, 0.2090, 0.2196,
        0.0458])
[rfa agg] iter:  7, prev_obj_val: 67.43158721923828, obj_val: 67.4315185546875, abs dis: 6.866455078125e-05
[rfa agg] iter: 7, weight: tensor([0.0638, 0.0443, 0.0466, 0.0793, 0.0409, 0.2170, 0.0340, 0.2037, 0.2253,
        0.0451])
			Update norm = 126.21640951655216 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3228, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.4318, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 352.98137974739075 sec.
Server Epoch:43 choose agents : [48, 64, 0, 16, 40, 36, 32, 96, 83, 81].
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   1, Avg loss: 0.0717, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   2, Avg loss: 0.0418, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8251, Accuracy: 67/10000 (0.6700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 377/1657 (22.7520%)
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0868, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   1, Avg loss: 0.0664, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   2, Avg loss: 0.0338, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.1466, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 370/1573 (23.5219%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 587/1573 (37.3172%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2393, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   1, Avg loss: 0.0852, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   2, Avg loss: 0.0527, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 329/735 (44.7619%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9541, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   1, Avg loss: 0.0799, Accuracy: 38/311 (12.2186%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.5141, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 414/1953 (21.1982%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 746/1953 (38.1976%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0704, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   1, Avg loss: 0.0664, Accuracy: 250/774 (32.2997%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   2, Avg loss: 0.0352, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8078, Accuracy: 75/10000 (0.7500%)
time spent on training: 197.40941834449768
[rfa agg] training data poison_ratio: 0.17077192620838916  data num: [631, 953, 1657, 708, 1573, 408, 735, 311, 1953, 774]
[rfa agg] considering poison per batch poison_fraction: 0.05336622694012161
[rfa agg] init. name: [48, 64, 0, 16, 40, 36, 32, 96, 83, 81], weight: tensor([0.0650, 0.0982, 0.1708, 0.0730, 0.1621, 0.0420, 0.0757, 0.0321, 0.2013,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 73.23356628417969, obj_val: 74.22702026367188, abs dis: 0.9934539794921875
[rfa agg] iter: 0, weight: tensor([0.0563, 0.2457, 0.1301, 0.0855, 0.1398, 0.0260, 0.0890, 0.0167, 0.0969,
        0.1140])
[rfa agg] iter:  1, prev_obj_val: 74.22702026367188, obj_val: 75.18843841552734, abs dis: 0.9614181518554688
[rfa agg] iter: 1, weight: tensor([0.0505, 0.3951, 0.0796, 0.0838, 0.0839, 0.0218, 0.0875, 0.0136, 0.0627,
        0.1214])
[rfa agg] iter:  2, prev_obj_val: 75.18843841552734, obj_val: 78.74021911621094, abs dis: 3.5517807006835938
[rfa agg] iter: 2, weight: tensor([0.0362, 0.5758, 0.0434, 0.0659, 0.0453, 0.0147, 0.0692, 0.0090, 0.0352,
        0.1055])
[rfa agg] iter:  3, prev_obj_val: 78.74021911621094, obj_val: 80.03016662597656, abs dis: 1.289947509765625
[rfa agg] iter: 3, weight: tensor([0.0596, 0.2093, 0.0446, 0.1377, 0.0460, 0.0211, 0.1492, 0.0123, 0.0376,
        0.2824])
[rfa agg] iter:  4, prev_obj_val: 80.03016662597656, obj_val: 86.88400268554688, abs dis: 6.8538360595703125
[rfa agg] iter: 4, weight: tensor([0.0548, 0.1203, 0.0337, 0.1524, 0.0347, 0.0180, 0.1688, 0.0103, 0.0288,
        0.3784])
[rfa agg] iter:  5, prev_obj_val: 86.88400268554688, obj_val: 93.12442779541016, abs dis: 6.240425109863281
[rfa agg] iter: 5, weight: tensor([0.1153, 0.0785, 0.0336, 0.2393, 0.0343, 0.0266, 0.2836, 0.0140, 0.0295,
        0.1454])
[rfa agg] iter:  6, prev_obj_val: 93.12442779541016, obj_val: 89.91529083251953, abs dis: 3.209136962890625
[rfa agg] iter: 6, weight: tensor([0.3016, 0.0770, 0.0393, 0.1611, 0.0399, 0.0425, 0.1721, 0.0207, 0.0351,
        0.1106])
[rfa agg] iter:  7, prev_obj_val: 89.91529083251953, obj_val: 89.90680694580078, abs dis: 0.00848388671875
[rfa agg] iter: 7, weight: tensor([0.2001, 0.0814, 0.0383, 0.2029, 0.0389, 0.0352, 0.2228, 0.0179, 0.0339,
        0.1284])
[rfa agg] iter:  8, prev_obj_val: 89.90680694580078, obj_val: 93.104248046875, abs dis: 3.1974411010742188
[rfa agg] iter: 8, weight: tensor([0.1940, 0.0812, 0.0382, 0.2065, 0.0389, 0.0351, 0.2263, 0.0179, 0.0338,
        0.1281])
[rfa agg] iter:  9, prev_obj_val: 93.104248046875, obj_val: 89.91716003417969, abs dis: 3.1870880126953125
[rfa agg] iter: 9, weight: tensor([0.3151, 0.0758, 0.0387, 0.1575, 0.0392, 0.0419, 0.1681, 0.0204, 0.0345,
        0.1089])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3252, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.5602197647095 sec.
Server Epoch:44 choose agents : [20, 4, 97, 32, 42, 33, 22, 30, 56, 0].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 348/807 (43.1227%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0632, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 383/901 (42.5083%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6226, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   1, Avg loss: 0.0514, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9248, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0592, Accuracy: 221/735 (30.0680%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 369/735 (50.2041%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.4665, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 348/1372 (25.3644%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 513/1372 (37.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3988, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   2, Avg loss: 0.0518, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.2526, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 539/1470 (36.6667%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 853/1470 (58.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.6791, Accuracy: 103/10000 (1.0300%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   1, Avg loss: 0.0741, Accuracy: 99/486 (20.3704%)
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.6588, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3644, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 367/1657 (22.1485%)
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 495/1657 (29.8733%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0567, Accuracy: 73/10000 (0.7300%)
time spent on training: 228.40888953208923
[rfa agg] training data poison_ratio: 0.3157782059516164  data num: [807, 901, 1213, 735, 1372, 515, 1470, 486, 186, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.09868068935988011
[rfa agg] init. name: [20, 4, 97, 32, 42, 33, 22, 30, 56, 0], weight: tensor([0.0864, 0.0964, 0.1298, 0.0787, 0.1469, 0.0551, 0.1574, 0.0520, 0.0199,
        0.1774])
[rfa agg] iter:  0, prev_obj_val: 54.48516082763672, obj_val: 57.28001403808594, abs dis: 2.7948532104492188
[rfa agg] iter: 0, weight: tensor([0.1223, 0.3700, 0.1353, 0.0830, 0.0843, 0.0317, 0.0782, 0.0260, 0.0060,
        0.0632])
[rfa agg] iter:  1, prev_obj_val: 57.28001403808594, obj_val: 61.07487106323242, abs dis: 3.7948570251464844
[rfa agg] iter: 1, weight: tensor([0.1631, 0.4047, 0.0930, 0.0996, 0.0640, 0.0327, 0.0605, 0.0262, 0.0057,
        0.0506])
[rfa agg] iter:  2, prev_obj_val: 61.07487106323242, obj_val: 65.54914093017578, abs dis: 4.474269866943359
[rfa agg] iter: 2, weight: tensor([0.3006, 0.2083, 0.0806, 0.1637, 0.0596, 0.0419, 0.0571, 0.0326, 0.0066,
        0.0490])
[rfa agg] iter:  3, prev_obj_val: 65.54914093017578, obj_val: 63.11680603027344, abs dis: 2.4323348999023438
[rfa agg] iter: 3, weight: tensor([0.3107, 0.1135, 0.0609, 0.2920, 0.0474, 0.0474, 0.0459, 0.0353, 0.0064,
        0.0404])
[rfa agg] iter:  4, prev_obj_val: 63.11680603027344, obj_val: 65.53761291503906, abs dis: 2.420806884765625
[rfa agg] iter: 4, weight: tensor([0.3777, 0.1341, 0.0648, 0.2070, 0.0492, 0.0411, 0.0474, 0.0313, 0.0060,
        0.0412])
[rfa agg] iter:  5, prev_obj_val: 65.53761291503906, obj_val: 65.52629089355469, abs dis: 0.011322021484375
[rfa agg] iter: 5, weight: tensor([0.3267, 0.1098, 0.0595, 0.2864, 0.0463, 0.0463, 0.0449, 0.0345, 0.0063,
        0.0394])
[rfa agg] iter:  6, prev_obj_val: 65.52629089355469, obj_val: 65.5252456665039, abs dis: 0.00104522705078125
[rfa agg] iter: 6, weight: tensor([0.3076, 0.1091, 0.0593, 0.3071, 0.0461, 0.0462, 0.0447, 0.0344, 0.0063,
        0.0393])
[rfa agg] iter:  7, prev_obj_val: 65.5252456665039, obj_val: 65.52513122558594, abs dis: 0.00011444091796875
[rfa agg] iter: 7, weight: tensor([0.3012, 0.1091, 0.0593, 0.3136, 0.0461, 0.0462, 0.0447, 0.0344, 0.0063,
        0.0393])
			Update norm = 112.67273197739549 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3252, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 385.9731636047363 sec.
Server Epoch:45 choose agents : [4, 16, 34, 68, 62, 38, 61, 31, 86, 28].
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 329/901 (36.5150%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 374/901 (41.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6240, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   1, Avg loss: 0.0618, Accuracy: 293/708 (41.3842%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0508, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 375/1427 (26.2789%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 586/1427 (41.0652%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5063, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 440/1163 (37.8332%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.9449, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 155/568 (27.2887%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.2330, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 262/1131 (23.1653%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 519/1131 (45.8886%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7807, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1300, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1187, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3385, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   1, Avg loss: 0.0751, Accuracy: 94/460 (20.4348%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   2, Avg loss: 0.0347, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.4179, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 350/1003 (34.8953%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 371/1003 (36.9890%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 400/1581 (25.3004%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 600/1581 (37.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8012, Accuracy: 97/10000 (0.9700%)
time spent on training: 180.49887084960938
[rfa agg] training data poison_ratio: 0.0  data num: [901, 708, 1427, 1163, 568, 1131, 85, 460, 1003, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 16, 34, 68, 62, 38, 61, 31, 86, 28], weight: tensor([0.0998, 0.0784, 0.1581, 0.1288, 0.0629, 0.1253, 0.0094, 0.0510, 0.1111,
        0.1751])
[rfa agg] iter:  0, prev_obj_val: 47.325347900390625, obj_val: 49.43467330932617, abs dis: 2.109325408935547
[rfa agg] iter: 0, weight: tensor([0.3446, 0.0715, 0.0555, 0.0888, 0.0295, 0.1140, 0.0020, 0.0205, 0.2241,
        0.0493])
[rfa agg] iter:  1, prev_obj_val: 49.43467330932617, obj_val: 49.43084716796875, abs dis: 0.003826141357421875
[rfa agg] iter: 1, weight: tensor([0.3718, 0.0883, 0.0549, 0.0832, 0.0338, 0.1033, 0.0022, 0.0232, 0.1899,
        0.0493])
[rfa agg] iter:  2, prev_obj_val: 49.43084716796875, obj_val: 51.93218994140625, abs dis: 2.5013427734375
[rfa agg] iter: 2, weight: tensor([0.3806, 0.0876, 0.0543, 0.0823, 0.0334, 0.1021, 0.0022, 0.0229, 0.1857,
        0.0488])
[rfa agg] iter:  3, prev_obj_val: 51.93218994140625, obj_val: 54.511383056640625, abs dis: 2.579193115234375
[rfa agg] iter: 3, weight: tensor([0.3043, 0.1275, 0.0615, 0.0891, 0.0439, 0.1077, 0.0028, 0.0297, 0.1776,
        0.0558])
[rfa agg] iter:  4, prev_obj_val: 54.511383056640625, obj_val: 57.14421844482422, abs dis: 2.6328353881835938
[rfa agg] iter: 4, weight: tensor([0.2397, 0.1817, 0.0648, 0.0904, 0.0542, 0.1071, 0.0032, 0.0361, 0.1634,
        0.0594])
[rfa agg] iter:  5, prev_obj_val: 57.14421844482422, obj_val: 57.13703536987305, abs dis: 0.007183074951171875
[rfa agg] iter: 5, weight: tensor([0.1895, 0.2555, 0.0632, 0.0853, 0.0625, 0.0993, 0.0034, 0.0407, 0.1422,
        0.0585])
			Update norm = 117.14826009698137 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3252, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.23690271377563 sec.
Server Epoch:46 choose agents : [2, 0, 60, 15, 30, 66, 81, 95, 58, 17].
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0599, Accuracy: 268/605 (44.2975%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0378, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.1723, Accuracy: 67/10000 (0.6700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 374/1657 (22.5709%)
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 532/1657 (32.1062%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8800, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 586/2227 (26.3134%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1058/2227 (47.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4975, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0555, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 406/1154 (35.1820%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4832, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0732, Accuracy: 113/486 (23.2510%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0396, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.5458, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 265/1402 (18.9016%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 388/1402 (27.6748%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3462, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 251/774 (32.4289%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   2, Avg loss: 0.0340, Accuracy: 286/774 (36.9509%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.8090, Accuracy: 78/10000 (0.7800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0504, Accuracy: 343/599 (57.2621%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.0307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   1, Avg loss: 0.0580, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.6163, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 400/1574 (25.4130%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 685/1574 (43.5197%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.3183, Accuracy: 94/10000 (0.9400%)
time spent on training: 233.16168880462646
[rfa agg] training data poison_ratio: 0.24306355819519546  data num: [605, 1657, 2227, 1154, 486, 1402, 774, 599, 803, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.07595736193599859
[rfa agg] init. name: [2, 0, 60, 15, 30, 66, 81, 95, 58, 17], weight: tensor([0.0536, 0.1469, 0.1974, 0.1023, 0.0431, 0.1243, 0.0686, 0.0531, 0.0712,
        0.1395])
[rfa agg] iter:  0, prev_obj_val: 69.98198699951172, obj_val: 73.0625991821289, abs dis: 3.0806121826171875
[rfa agg] iter: 0, weight: tensor([0.0245, 0.0855, 0.0508, 0.4454, 0.0161, 0.1633, 0.0468, 0.0243, 0.0486,
        0.0948])
[rfa agg] iter:  1, prev_obj_val: 73.0625991821289, obj_val: 76.7200698852539, abs dis: 3.657470703125
[rfa agg] iter: 1, weight: tensor([0.0313, 0.0851, 0.0543, 0.4140, 0.0202, 0.1419, 0.0635, 0.0310, 0.0661,
        0.0925])
[rfa agg] iter:  2, prev_obj_val: 76.7200698852539, obj_val: 78.55985260009766, abs dis: 1.83978271484375
[rfa agg] iter: 2, weight: tensor([0.0443, 0.0940, 0.0636, 0.2844, 0.0277, 0.1419, 0.0977, 0.0439, 0.1019,
        0.1006])
[rfa agg] iter:  3, prev_obj_val: 78.55985260009766, obj_val: 80.42154693603516, abs dis: 1.8616943359375
[rfa agg] iter: 3, weight: tensor([0.0499, 0.0933, 0.0647, 0.2389, 0.0307, 0.1355, 0.1167, 0.0494, 0.1217,
        0.0992])
[rfa agg] iter:  4, prev_obj_val: 80.42154693603516, obj_val: 80.42044067382812, abs dis: 0.00110626220703125
[rfa agg] iter: 4, weight: tensor([0.0547, 0.0898, 0.0638, 0.2034, 0.0331, 0.1261, 0.1371, 0.0541, 0.1431,
        0.0949])
			Update norm = 143.83382746028488 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3252, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.4283230304718 sec.
Server Epoch:47 choose agents : [80, 74, 96, 95, 41, 53, 13, 18, 70, 82].
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 161/682 (23.6070%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 207/682 (30.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.8752, Accuracy: 57/10000 (0.5700%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 468/1552 (30.1546%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 736/1552 (47.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.2567, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5207, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 345/599 (57.5960%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.0237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   1, Avg loss: 0.0595, Accuracy: 342/719 (47.5661%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   2, Avg loss: 0.0311, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2900, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   1, Avg loss: 0.0472, Accuracy: 292/813 (35.9164%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 476/813 (58.5486%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5568, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 335/1645 (20.3647%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 628/1645 (38.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3591, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 128/530 (24.1509%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.9523, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 685/1418 (48.3075%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9693, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0724, Accuracy: 98/500 (19.6000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.2106, Accuracy: 55/10000 (0.5500%)
time spent on training: 191.6615869998932
[rfa agg] training data poison_ratio: 0.24529592884023263  data num: [682, 1552, 311, 599, 719, 813, 1645, 530, 1418, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0766549777625727
[rfa agg] init. name: [80, 74, 96, 95, 41, 53, 13, 18, 70, 82], weight: tensor([0.0778, 0.1770, 0.0355, 0.0683, 0.0820, 0.0927, 0.1876, 0.0604, 0.1617,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 66.02265930175781, obj_val: 67.49468994140625, abs dis: 1.4720306396484375
[rfa agg] iter: 0, weight: tensor([0.1070, 0.0983, 0.0197, 0.0755, 0.1470, 0.2447, 0.0947, 0.0559, 0.1121,
        0.0453])
[rfa agg] iter:  1, prev_obj_val: 67.49468994140625, obj_val: 69.73765563964844, abs dis: 2.2429656982421875
[rfa agg] iter: 1, weight: tensor([0.1024, 0.0406, 0.0122, 0.0616, 0.1809, 0.4453, 0.0398, 0.0413, 0.0446,
        0.0313])
[rfa agg] iter:  2, prev_obj_val: 69.73765563964844, obj_val: 81.0648422241211, abs dis: 11.327186584472656
[rfa agg] iter: 2, weight: tensor([0.1730, 0.0367, 0.0137, 0.0876, 0.2927, 0.2291, 0.0362, 0.0532, 0.0397,
        0.0382])
[rfa agg] iter:  3, prev_obj_val: 81.0648422241211, obj_val: 87.59833526611328, abs dis: 6.5334930419921875
[rfa agg] iter: 3, weight: tensor([0.1405, 0.0331, 0.0227, 0.2481, 0.0926, 0.0757, 0.0330, 0.2164, 0.0347,
        0.1032])
[rfa agg] iter:  4, prev_obj_val: 87.59833526611328, obj_val: 91.26847839355469, abs dis: 3.6701431274414062
[rfa agg] iter: 4, weight: tensor([0.0905, 0.0318, 0.0297, 0.1289, 0.0679, 0.0604, 0.0318, 0.2656, 0.0331,
        0.2603])
[rfa agg] iter:  5, prev_obj_val: 91.26847839355469, obj_val: 91.24886322021484, abs dis: 0.01961517333984375
[rfa agg] iter: 5, weight: tensor([0.0691, 0.0282, 0.0315, 0.0892, 0.0544, 0.0497, 0.0282, 0.1528, 0.0292,
        0.4677])
[rfa agg] iter:  6, prev_obj_val: 91.24886322021484, obj_val: 87.59703826904297, abs dis: 3.651824951171875
[rfa agg] iter: 6, weight: tensor([0.0593, 0.0242, 0.0271, 0.0764, 0.0467, 0.0427, 0.0242, 0.1295, 0.0251,
        0.5449])
[rfa agg] iter:  7, prev_obj_val: 87.59703826904297, obj_val: 91.2640151977539, abs dis: 3.6669769287109375
[rfa agg] iter: 7, weight: tensor([0.0855, 0.0302, 0.0282, 0.1195, 0.0641, 0.0573, 0.0302, 0.2568, 0.0314,
        0.2970])
[rfa agg] iter:  8, prev_obj_val: 91.2640151977539, obj_val: 91.24807739257812, abs dis: 0.01593780517578125
[rfa agg] iter: 8, weight: tensor([0.0674, 0.0275, 0.0308, 0.0870, 0.0530, 0.0485, 0.0275, 0.1491, 0.0285,
        0.4807])
[rfa agg] iter:  9, prev_obj_val: 91.24807739257812, obj_val: 87.5979995727539, abs dis: 3.6500778198242188
[rfa agg] iter: 9, weight: tensor([0.0585, 0.0239, 0.0267, 0.0754, 0.0460, 0.0421, 0.0239, 0.1277, 0.0247,
        0.5511])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3281, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3627, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.6839201450348 sec.
Server Epoch:48 choose agents : [55, 77, 34, 80, 27, 88, 59, 14, 45, 96].
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 255/1071 (23.8095%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.1725, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   1, Avg loss: 0.0524, Accuracy: 361/1340 (26.9403%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 537/1340 (40.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.4534, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.1418, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   1, Avg loss: 0.0680, Accuracy: 160/682 (23.4604%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9527, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 419/1587 (26.4020%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.6813, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0719, Accuracy: 158/603 (26.2023%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.4582, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   2, Avg loss: 0.0274, Accuracy: 457/1089 (41.9651%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.3938, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   1, Avg loss: 0.0610, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 341/1013 (33.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.1976, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   1, Avg loss: 0.0647, Accuracy: 211/669 (31.5396%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   2, Avg loss: 0.0390, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.1892, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 41/311 (13.1833%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.5376, Accuracy: 50/10000 (0.5000%)
time spent on training: 213.92706441879272
[rfa agg] training data poison_ratio: 0.109375  data num: [1071, 1340, 1427, 682, 1587, 603, 1089, 1013, 669, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0341796875
[rfa agg] init. name: [55, 77, 34, 80, 27, 88, 59, 14, 45, 96], weight: tensor([0.1094, 0.1368, 0.1457, 0.0696, 0.1621, 0.0616, 0.1112, 0.1035, 0.0683,
        0.0318])
[rfa agg] iter:  0, prev_obj_val: 45.57677459716797, obj_val: 49.59165573120117, abs dis: 4.014881134033203
[rfa agg] iter: 0, weight: tensor([0.2137, 0.0719, 0.0550, 0.0368, 0.0478, 0.0272, 0.1240, 0.3801, 0.0359,
        0.0077])
[rfa agg] iter:  1, prev_obj_val: 49.59165573120117, obj_val: 51.883426666259766, abs dis: 2.2917709350585938
[rfa agg] iter: 1, weight: tensor([0.1791, 0.0799, 0.0641, 0.0608, 0.0571, 0.0432, 0.1205, 0.3250, 0.0590,
        0.0112])
[rfa agg] iter:  2, prev_obj_val: 51.883426666259766, obj_val: 51.88031005859375, abs dis: 0.003116607666015625
[rfa agg] iter: 2, weight: tensor([0.1694, 0.0852, 0.0696, 0.0800, 0.0628, 0.0553, 0.1219, 0.2646, 0.0775,
        0.0136])
			Update norm = 130.36607861374446 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3281, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3627, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.3511207103729 sec.
Server Epoch:49 choose agents : [88, 4, 12, 21, 78, 65, 74, 41, 55, 2].
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   1, Avg loss: 0.0715, Accuracy: 163/603 (27.0315%)
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.4292, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0593, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 431/901 (47.8357%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8818, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   2, Avg loss: 0.0487, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8966, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 403/1949 (20.6773%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1949 (31.5033%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6235, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   1, Avg loss: 0.0779, Accuracy: 83/416 (19.9519%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.1255, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0543, Accuracy: 412/1475 (27.9322%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 660/1475 (44.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4205, Accuracy: 90/10000 (0.9000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 491/1552 (31.6366%)
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.8229, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0299, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.1076, Accuracy: 55/10000 (0.5500%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 275/1071 (25.6769%)
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 514/1071 (47.9925%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1918, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0594, Accuracy: 259/605 (42.8099%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0378, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.3714, Accuracy: 69/10000 (0.6900%)
time spent on training: 213.7460904121399
[rfa agg] training data poison_ratio: 0.2724062727178316  data num: [603, 901, 338, 1949, 416, 1475, 1552, 719, 1071, 605]
[rfa agg] considering poison per batch poison_fraction: 0.08512696022432237
[rfa agg] init. name: [88, 4, 12, 21, 78, 65, 74, 41, 55, 2], weight: tensor([0.0626, 0.0936, 0.0351, 0.2024, 0.0432, 0.1532, 0.1612, 0.0747, 0.1112,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 67.35392761230469, obj_val: 69.66033172607422, abs dis: 2.3064041137695312
[rfa agg] iter: 0, weight: tensor([0.0325, 0.1389, 0.0119, 0.0584, 0.0160, 0.0908, 0.0834, 0.0524, 0.4833,
        0.0326])
[rfa agg] iter:  1, prev_obj_val: 69.66033172607422, obj_val: 72.25457763671875, abs dis: 2.5942459106445312
[rfa agg] iter: 1, weight: tensor([0.0379, 0.2692, 0.0128, 0.0492, 0.0175, 0.0693, 0.0651, 0.0667, 0.3741,
        0.0380])
[rfa agg] iter:  2, prev_obj_val: 72.25457763671875, obj_val: 77.80358123779297, abs dis: 5.549003601074219
[rfa agg] iter: 2, weight: tensor([0.0414, 0.4750, 0.0130, 0.0421, 0.0180, 0.0563, 0.0535, 0.0799, 0.1795,
        0.0415])
[rfa agg] iter:  3, prev_obj_val: 77.80358123779297, obj_val: 77.76213836669922, abs dis: 0.04144287109375
[rfa agg] iter: 3, weight: tensor([0.0796, 0.2707, 0.0212, 0.0524, 0.0300, 0.0658, 0.0634, 0.1961, 0.1413,
        0.0796])
[rfa agg] iter:  4, prev_obj_val: 77.76213836669922, obj_val: 79.75707244873047, abs dis: 1.99493408203125
[rfa agg] iter: 4, weight: tensor([0.0800, 0.2609, 0.0212, 0.0524, 0.0301, 0.0658, 0.0635, 0.2044, 0.1416,
        0.0801])
[rfa agg] iter:  5, prev_obj_val: 79.75707244873047, obj_val: 83.99432373046875, abs dis: 4.237251281738281
[rfa agg] iter: 5, weight: tensor([0.0910, 0.1983, 0.0223, 0.0500, 0.0319, 0.0617, 0.0596, 0.2722, 0.1220,
        0.0910])
[rfa agg] iter:  6, prev_obj_val: 83.99432373046875, obj_val: 81.78619384765625, abs dis: 2.2081298828125
[rfa agg] iter: 6, weight: tensor([0.1070, 0.1085, 0.0208, 0.0380, 0.0307, 0.0454, 0.0442, 0.4203, 0.0787,
        0.1065])
[rfa agg] iter:  7, prev_obj_val: 81.78619384765625, obj_val: 83.9605712890625, abs dis: 2.17437744140625
[rfa agg] iter: 7, weight: tensor([0.0918, 0.1346, 0.0204, 0.0413, 0.0295, 0.0501, 0.0486, 0.3999, 0.0921,
        0.0917])
[rfa agg] iter:  8, prev_obj_val: 83.9605712890625, obj_val: 89.0791244506836, abs dis: 5.118553161621094
[rfa agg] iter: 8, weight: tensor([0.0976, 0.0987, 0.0191, 0.0348, 0.0280, 0.0415, 0.0404, 0.4707, 0.0719,
        0.0972])
[rfa agg] iter:  9, prev_obj_val: 89.0791244506836, obj_val: 89.03031158447266, abs dis: 0.0488128662109375
[rfa agg] iter: 9, weight: tensor([0.1982, 0.0867, 0.0264, 0.0383, 0.0404, 0.0444, 0.0435, 0.2575, 0.0696,
        0.1950])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3311, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3536, Accuracy: 0/9950 (0.0000%)
saving model
Done in 374.6439781188965 sec.
Server Epoch:50 choose agents : [33, 43, 89, 10, 19, 73, 12, 23, 42, 52].
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   2, Avg loss: 0.0505, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2987, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   1, Avg loss: 0.0595, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.6112, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4814, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   1, Avg loss: 0.0572, Accuracy: 202/861 (23.4611%)
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 451/861 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.8960, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 405/1036 (39.0927%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 667/1036 (64.3822%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.4194, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 180/938 (19.1898%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 342/938 (36.4606%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5766, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   2, Avg loss: 0.0454, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.9710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   1, Avg loss: 0.0649, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.0389, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 336/1372 (24.4898%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 503/1372 (36.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.7956, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0524, Accuracy: 314/636 (49.3711%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0288, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.0997, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.62206959724426
[rfa agg] training data poison_ratio: 0.10432569974554708  data num: [515, 946, 896, 861, 1036, 938, 338, 715, 1372, 636]
[rfa agg] considering poison per batch poison_fraction: 0.032601781170483464
[rfa agg] init. name: [33, 43, 89, 10, 19, 73, 12, 23, 42, 52], weight: tensor([0.0624, 0.1146, 0.1086, 0.1043, 0.1255, 0.1137, 0.0410, 0.0866, 0.1662,
        0.0771])
[rfa agg] iter:  0, prev_obj_val: 32.69593048095703, obj_val: 39.450767517089844, abs dis: 6.7548370361328125
[rfa agg] iter: 0, weight: tensor([0.0351, 0.1229, 0.1981, 0.1828, 0.0699, 0.1233, 0.0133, 0.1554, 0.0419,
        0.0573])
[rfa agg] iter:  1, prev_obj_val: 39.450767517089844, obj_val: 42.149784088134766, abs dis: 2.699016571044922
[rfa agg] iter: 1, weight: tensor([0.0674, 0.0892, 0.1167, 0.1110, 0.0626, 0.0888, 0.0206, 0.2679, 0.0438,
        0.1320])
[rfa agg] iter:  2, prev_obj_val: 42.149784088134766, obj_val: 48.01447296142578, abs dis: 5.864688873291016
[rfa agg] iter: 2, weight: tensor([0.0876, 0.0829, 0.1033, 0.0987, 0.0609, 0.0825, 0.0240, 0.2168, 0.0443,
        0.1990])
[rfa agg] iter:  3, prev_obj_val: 48.01447296142578, obj_val: 58.878509521484375, abs dis: 10.864036560058594
[rfa agg] iter: 3, weight: tensor([0.1381, 0.0587, 0.0690, 0.0661, 0.0460, 0.0583, 0.0263, 0.1066, 0.0357,
        0.3952])
[rfa agg] iter:  4, prev_obj_val: 58.878509521484375, obj_val: 58.840763092041016, abs dis: 0.037746429443359375
[rfa agg] iter: 4, weight: tensor([0.2999, 0.0644, 0.0720, 0.0690, 0.0540, 0.0640, 0.0591, 0.0892, 0.0452,
        0.1832])
[rfa agg] iter:  5, prev_obj_val: 58.840763092041016, obj_val: 62.86704635620117, abs dis: 4.026283264160156
[rfa agg] iter: 5, weight: tensor([0.3304, 0.0621, 0.0694, 0.0665, 0.0521, 0.0617, 0.0571, 0.0857, 0.0435,
        0.1716])
[rfa agg] iter:  6, prev_obj_val: 62.86704635620117, obj_val: 42.17984390258789, abs dis: 20.68720245361328
[rfa agg] iter: 6, weight: tensor([0.2506, 0.0710, 0.0784, 0.0752, 0.0606, 0.0706, 0.0870, 0.0928, 0.0517,
        0.1622])
[rfa agg] iter:  7, prev_obj_val: 42.17984390258789, obj_val: 48.012229919433594, abs dis: 5.832386016845703
[rfa agg] iter: 7, weight: tensor([0.0905, 0.0839, 0.1047, 0.1000, 0.0617, 0.0836, 0.0243, 0.2045, 0.0449,
        0.2019])
[rfa agg] iter:  8, prev_obj_val: 48.012229919433594, obj_val: 58.878536224365234, abs dis: 10.86630630493164
[rfa agg] iter: 8, weight: tensor([0.1383, 0.0586, 0.0690, 0.0660, 0.0460, 0.0583, 0.0263, 0.1063, 0.0357,
        0.3956])
[rfa agg] iter:  9, prev_obj_val: 58.878536224365234, obj_val: 58.840763092041016, abs dis: 0.03777313232421875
[rfa agg] iter: 9, weight: tensor([0.2999, 0.0644, 0.0720, 0.0690, 0.0540, 0.0640, 0.0591, 0.0892, 0.0452,
        0.1832])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3338, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3401, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 350.5701184272766 sec.
Server Epoch:51 choose agents : [87, 56, 68, 6, 65, 8, 42, 76, 52, 45].
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 314/1131 (27.7630%)
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.5100, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 376/1163 (32.3302%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 408/1163 (35.0817%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0701, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 675/1956 (34.5092%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3589, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   2, Avg loss: 0.0324, Accuracy: 670/1475 (45.4237%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2283, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0584, Accuracy: 260/1513 (17.1844%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 509/1513 (33.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2651, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 328/1372 (23.9067%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 530/1372 (38.6297%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6486, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0816, Accuracy: 66/466 (14.1631%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0471, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.5161, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   1, Avg loss: 0.0518, Accuracy: 334/636 (52.5157%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   2, Avg loss: 0.0282, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0323, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   1, Avg loss: 0.0651, Accuracy: 209/669 (31.2407%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   2, Avg loss: 0.0385, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.1065, Accuracy: 57/10000 (0.5700%)
time spent on training: 206.42948389053345
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 186, 1163, 1956, 1475, 1513, 1372, 466, 636, 669]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 56, 68, 6, 65, 8, 42, 76, 52, 45], weight: tensor([0.1070, 0.0176, 0.1101, 0.1851, 0.1396, 0.1432, 0.1298, 0.0441, 0.0602,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 56.455230712890625, obj_val: 60.68955612182617, abs dis: 4.234325408935547
[rfa agg] iter: 0, weight: tensor([0.3085, 0.0033, 0.3325, 0.0434, 0.0731, 0.0754, 0.1061, 0.0123, 0.0207,
        0.0247])
[rfa agg] iter:  1, prev_obj_val: 60.68955612182617, obj_val: 63.29764175415039, abs dis: 2.6080856323242188
[rfa agg] iter: 1, weight: tensor([0.4103, 0.0041, 0.2261, 0.0459, 0.0708, 0.0730, 0.0951, 0.0155, 0.0268,
        0.0325])
[rfa agg] iter:  2, prev_obj_val: 63.29764175415039, obj_val: 66.0110855102539, abs dis: 2.7134437561035156
[rfa agg] iter: 2, weight: tensor([0.3720, 0.0051, 0.2079, 0.0534, 0.0795, 0.0819, 0.1035, 0.0198, 0.0346,
        0.0424])
[rfa agg] iter:  3, prev_obj_val: 66.0110855102539, obj_val: 63.298160552978516, abs dis: 2.7129249572753906
[rfa agg] iter: 3, weight: tensor([0.3159, 0.0062, 0.2020, 0.0611, 0.0882, 0.0908, 0.1119, 0.0248, 0.0442,
        0.0548])
[rfa agg] iter:  4, prev_obj_val: 63.298160552978516, obj_val: 63.29550552368164, abs dis: 0.002655029296875
[rfa agg] iter: 4, weight: tensor([0.3629, 0.0051, 0.2111, 0.0541, 0.0806, 0.0830, 0.1050, 0.0200, 0.0351,
        0.0430])
[rfa agg] iter:  5, prev_obj_val: 63.29550552368164, obj_val: 66.01068878173828, abs dis: 2.7151832580566406
[rfa agg] iter: 5, weight: tensor([0.3676, 0.0051, 0.2094, 0.0537, 0.0801, 0.0825, 0.1042, 0.0199, 0.0348,
        0.0427])
[rfa agg] iter:  6, prev_obj_val: 66.01068878173828, obj_val: 63.29818344116211, abs dis: 2.712505340576172
[rfa agg] iter: 6, weight: tensor([0.3157, 0.0063, 0.2021, 0.0612, 0.0882, 0.0908, 0.1119, 0.0248, 0.0442,
        0.0548])
[rfa agg] iter:  7, prev_obj_val: 63.29818344116211, obj_val: 63.295501708984375, abs dis: 0.002681732177734375
[rfa agg] iter: 7, weight: tensor([0.3629, 0.0051, 0.2111, 0.0541, 0.0806, 0.0830, 0.1050, 0.0200, 0.0351,
        0.0430])
[rfa agg] iter:  8, prev_obj_val: 63.295501708984375, obj_val: 66.01068878173828, abs dis: 2.7151870727539062
[rfa agg] iter: 8, weight: tensor([0.3675, 0.0051, 0.2094, 0.0537, 0.0801, 0.0825, 0.1042, 0.0199, 0.0348,
        0.0427])
[rfa agg] iter:  9, prev_obj_val: 66.01068878173828, obj_val: 63.29818344116211, abs dis: 2.712505340576172
[rfa agg] iter: 9, weight: tensor([0.3157, 0.0063, 0.2021, 0.0612, 0.0882, 0.0908, 0.1119, 0.0248, 0.0442,
        0.0548])
			Update norm = 152.49232818817475 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3338, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3401, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.7269458770752 sec.
Server Epoch:52 choose agents : [5, 61, 23, 36, 64, 45, 13, 77, 7, 99].
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 394/1628 (24.2015%)
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 838/1628 (51.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.7411, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1284, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1193, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3472, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 316/715 (44.1958%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9744, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   1, Avg loss: 0.0845, Accuracy: 86/408 (21.0784%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   2, Avg loss: 0.0525, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9376, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.9607, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   1, Avg loss: 0.0658, Accuracy: 213/669 (31.8386%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   2, Avg loss: 0.0383, Accuracy: 357/669 (53.3632%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.2095, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/1645 (21.0334%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 644/1645 (39.1489%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9636, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   1, Avg loss: 0.0523, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 508/1340 (37.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.5243, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0511, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 412/891 (46.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.7793, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   1, Avg loss: 0.0632, Accuracy: 197/773 (25.4851%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 404/773 (52.2639%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8306, Accuracy: 69/10000 (0.6900%)
time spent on training: 204.6361904144287
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 85, 715, 408, 953, 669, 1645, 1340, 891, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 61, 23, 36, 64, 45, 13, 77, 7, 99], weight: tensor([0.1788, 0.0093, 0.0785, 0.0448, 0.1046, 0.0735, 0.1806, 0.1471, 0.0978,
        0.0849])
[rfa agg] iter:  0, prev_obj_val: 55.143836975097656, obj_val: 56.68285369873047, abs dis: 1.5390167236328125
[rfa agg] iter: 0, weight: tensor([0.0819, 0.0028, 0.0754, 0.0206, 0.2688, 0.0580, 0.0827, 0.1407, 0.1650,
        0.1041])
[rfa agg] iter:  1, prev_obj_val: 56.68285369873047, obj_val: 61.56602478027344, abs dis: 4.883171081542969
[rfa agg] iter: 1, weight: tensor([0.0376, 0.0018, 0.0736, 0.0145, 0.3126, 0.0501, 0.0380, 0.0546, 0.2912,
        0.1261])
[rfa agg] iter:  2, prev_obj_val: 61.56602478027344, obj_val: 69.82381439208984, abs dis: 8.257789611816406
[rfa agg] iter: 2, weight: tensor([0.0325, 0.0020, 0.1539, 0.0177, 0.1187, 0.0824, 0.0329, 0.0434, 0.2016,
        0.3149])
[rfa agg] iter:  3, prev_obj_val: 69.82381439208984, obj_val: 76.8807373046875, abs dis: 7.056922912597656
[rfa agg] iter: 3, weight: tensor([0.0343, 0.0027, 0.2688, 0.0276, 0.0815, 0.2515, 0.0346, 0.0430, 0.1063,
        0.1497])
[rfa agg] iter:  4, prev_obj_val: 76.8807373046875, obj_val: 66.67366027832031, abs dis: 10.207077026367188
[rfa agg] iter: 4, weight: tensor([0.0398, 0.0038, 0.1718, 0.0437, 0.0792, 0.3648, 0.0402, 0.0483, 0.0949,
        0.1135])
[rfa agg] iter:  5, prev_obj_val: 66.67366027832031, obj_val: 69.74579620361328, abs dis: 3.0721359252929688
[rfa agg] iter: 5, weight: tensor([0.0308, 0.0023, 0.3472, 0.0216, 0.0817, 0.1641, 0.0312, 0.0394, 0.1121,
        0.1698])
[rfa agg] iter:  6, prev_obj_val: 69.74579620361328, obj_val: 73.14385986328125, abs dis: 3.3980636596679688
[rfa agg] iter: 6, weight: tensor([0.0319, 0.0025, 0.3003, 0.0256, 0.0757, 0.2595, 0.0322, 0.0400, 0.0980,
        0.1343])
[rfa agg] iter:  7, prev_obj_val: 73.14385986328125, obj_val: 73.12017059326172, abs dis: 0.02368927001953125
[rfa agg] iter: 7, weight: tensor([0.0318, 0.0028, 0.1899, 0.0297, 0.0686, 0.4135, 0.0321, 0.0392, 0.0850,
        0.1074])
[rfa agg] iter:  8, prev_obj_val: 73.12017059326172, obj_val: 73.11662292480469, abs dis: 0.00354766845703125
[rfa agg] iter: 8, weight: tensor([0.0290, 0.0025, 0.1690, 0.0271, 0.0626, 0.4697, 0.0293, 0.0357, 0.0775,
        0.0976])
[rfa agg] iter:  9, prev_obj_val: 73.11662292480469, obj_val: 76.87840270996094, abs dis: 3.76177978515625
[rfa agg] iter: 9, weight: tensor([0.0277, 0.0024, 0.1603, 0.0258, 0.0597, 0.4953, 0.0280, 0.0341, 0.0738,
        0.0929])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3367, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3459, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.49705624580383 sec.
Server Epoch:53 choose agents : [96, 36, 89, 65, 62, 19, 45, 1, 34, 33].
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 30/311 (9.6463%)
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.6728, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   1, Avg loss: 0.0838, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   2, Avg loss: 0.0522, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.0275, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.5881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   2, Avg loss: 0.0300, Accuracy: 693/1475 (46.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3849, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.3622, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 405/1036 (39.0927%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 644/1036 (62.1622%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.7295, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   1, Avg loss: 0.0623, Accuracy: 236/669 (35.2765%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   2, Avg loss: 0.0379, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.1712, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 572/928 (61.6379%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4534, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 414/1427 (29.0119%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6567, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   2, Avg loss: 0.0511, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.2868, Accuracy: 67/10000 (0.6700%)
time spent on training: 179.03183794021606
[rfa agg] training data poison_ratio: 0.0  data num: [311, 408, 896, 1475, 568, 1036, 669, 928, 1427, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 36, 89, 65, 62, 19, 45, 1, 34, 33], weight: tensor([0.0378, 0.0496, 0.1088, 0.1792, 0.0690, 0.1258, 0.0813, 0.1127, 0.1733,
        0.0626])
[rfa agg] iter:  0, prev_obj_val: 50.000736236572266, obj_val: 54.614646911621094, abs dis: 4.613910675048828
[rfa agg] iter: 0, weight: tensor([0.0114, 0.0192, 0.3767, 0.0486, 0.0373, 0.1102, 0.0716, 0.2390, 0.0522,
        0.0338])
[rfa agg] iter:  1, prev_obj_val: 54.614646911621094, obj_val: 58.21029281616211, abs dis: 3.5956459045410156
[rfa agg] iter: 1, weight: tensor([0.0186, 0.0333, 0.2519, 0.0575, 0.0720, 0.1020, 0.1786, 0.1604, 0.0609,
        0.0649])
[rfa agg] iter:  2, prev_obj_val: 58.21029281616211, obj_val: 60.14876174926758, abs dis: 1.9384689331054688
[rfa agg] iter: 2, weight: tensor([0.0198, 0.0374, 0.1437, 0.0488, 0.0923, 0.0773, 0.3389, 0.1076, 0.0513,
        0.0828])
[rfa agg] iter:  3, prev_obj_val: 60.14876174926758, obj_val: 67.54218292236328, abs dis: 7.393421173095703
[rfa agg] iter: 3, weight: tensor([0.0176, 0.0346, 0.0985, 0.0386, 0.0941, 0.0583, 0.4562, 0.0777, 0.0404,
        0.0840])
[rfa agg] iter:  4, prev_obj_val: 67.54218292236328, obj_val: 73.60089111328125, abs dis: 6.058708190917969
[rfa agg] iter: 4, weight: tensor([0.0245, 0.0570, 0.0697, 0.0361, 0.2836, 0.0489, 0.1535, 0.0595, 0.0376,
        0.2296])
[rfa agg] iter:  5, prev_obj_val: 73.60089111328125, obj_val: 77.19971466064453, abs dis: 3.5988235473632812
[rfa agg] iter: 5, weight: tensor([0.0306, 0.0907, 0.0560, 0.0330, 0.3171, 0.0422, 0.0904, 0.0493, 0.0341,
        0.2567])
[rfa agg] iter:  6, prev_obj_val: 77.19971466064453, obj_val: 77.1948013305664, abs dis: 0.004913330078125
[rfa agg] iter: 6, weight: tensor([0.0449, 0.1647, 0.0649, 0.0404, 0.2351, 0.0503, 0.0957, 0.0578, 0.0417,
        0.2047])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.52440071105957 sec.
Server Epoch:54 choose agents : [47, 28, 66, 55, 29, 52, 42, 8, 17, 23].
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1194, Accuracy: 7/134 (5.2239%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1056, Accuracy: 31/134 (23.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3738, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 408/1581 (25.8065%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 569/1581 (35.9899%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1272, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 400/1402 (28.5307%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0352, Accuracy: 70/10000 (0.7000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   1, Avg loss: 0.0547, Accuracy: 274/1071 (25.5836%)
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6825, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   1, Avg loss: 0.0497, Accuracy: 397/1440 (27.5694%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 642/1440 (44.5833%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.7637, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0512, Accuracy: 328/636 (51.5723%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0291, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.1622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 337/1372 (24.5627%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1847, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0581, Accuracy: 276/1513 (18.2419%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 474/1513 (31.3285%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5983, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   1, Avg loss: 0.0521, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 621/1574 (39.4536%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6399, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.9285, Accuracy: 50/10000 (0.5000%)
time spent on training: 237.36119961738586
[rfa agg] training data poison_ratio: 0.09363525091799266  data num: [134, 1581, 1402, 1071, 1440, 636, 1372, 1513, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.029261015911872704
[rfa agg] init. name: [47, 28, 66, 55, 29, 52, 42, 8, 17, 23], weight: tensor([0.0117, 0.1382, 0.1226, 0.0936, 0.1259, 0.0556, 0.1200, 0.1323, 0.1376,
        0.0625])
[rfa agg] iter:  0, prev_obj_val: 44.302242279052734, obj_val: 44.287437438964844, abs dis: 0.014804840087890625
[rfa agg] iter: 0, weight: tensor([0.0031, 0.0951, 0.1650, 0.1809, 0.1284, 0.0258, 0.1604, 0.1091, 0.0951,
        0.0372])
			Update norm = 170.2156433303796 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.62596702575684 sec.
Server Epoch:55 choose agents : [40, 73, 17, 94, 50, 89, 8, 7, 99, 58].
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 381/1573 (24.2212%)
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 612/1573 (38.9065%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4222, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0643, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2603, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 393/1574 (24.9682%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 687/1574 (43.6468%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4533, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 635/1662 (38.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0578, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 163/809 (20.1483%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 372/809 (45.9827%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1998, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.6322, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   1, Avg loss: 0.0581, Accuracy: 275/1513 (18.1758%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 514/1513 (33.9722%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6801, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   1, Avg loss: 0.0511, Accuracy: 365/891 (40.9652%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   2, Avg loss: 0.0246, Accuracy: 467/891 (52.4130%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8668, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0649, Accuracy: 195/773 (25.2264%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 376/773 (48.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1374, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 341/803 (42.4658%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.5414, Accuracy: 52/10000 (0.5200%)
time spent on training: 220.05485367774963
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 938, 1574, 1662, 809, 896, 1513, 891, 773, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 73, 17, 94, 50, 89, 8, 7, 99, 58], weight: tensor([0.1376, 0.0821, 0.1377, 0.1454, 0.0708, 0.0784, 0.1323, 0.0779, 0.0676,
        0.0702])
[rfa agg] iter:  0, prev_obj_val: 53.42436981201172, obj_val: 53.9282341003418, abs dis: 0.5038642883300781
[rfa agg] iter: 0, weight: tensor([0.0820, 0.1810, 0.0822, 0.0771, 0.0837, 0.1210, 0.0898, 0.1208, 0.0798,
        0.0828])
[rfa agg] iter:  1, prev_obj_val: 53.9282341003418, obj_val: 55.98733139038086, abs dis: 2.0590972900390625
[rfa agg] iter: 1, weight: tensor([0.0693, 0.2107, 0.0694, 0.0655, 0.0855, 0.1294, 0.0752, 0.1291, 0.0815,
        0.0845])
[rfa agg] iter:  2, prev_obj_val: 55.98733139038086, obj_val: 64.26274871826172, abs dis: 8.27541732788086
[rfa agg] iter: 2, weight: tensor([0.0346, 0.2893, 0.0347, 0.0333, 0.0850, 0.1606, 0.0369, 0.1617, 0.0807,
        0.0832])
[rfa agg] iter:  3, prev_obj_val: 64.26274871826172, obj_val: 67.8728256225586, abs dis: 3.610076904296875
[rfa agg] iter: 3, weight: tensor([0.0227, 0.0776, 0.0228, 0.0222, 0.2070, 0.1281, 0.0238, 0.1279, 0.1869,
        0.1812])
[rfa agg] iter:  4, prev_obj_val: 67.8728256225586, obj_val: 64.1252670288086, abs dis: 3.74755859375
[rfa agg] iter: 4, weight: tensor([0.0254, 0.0720, 0.0255, 0.0249, 0.2188, 0.1088, 0.0265, 0.1100, 0.1905,
        0.1976])
[rfa agg] iter:  5, prev_obj_val: 64.1252670288086, obj_val: 61.16581726074219, abs dis: 2.9594497680664062
[rfa agg] iter: 5, weight: tensor([0.0206, 0.0681, 0.0207, 0.0201, 0.2330, 0.1131, 0.0216, 0.1164, 0.1872,
        0.1991])
[rfa agg] iter:  6, prev_obj_val: 61.16581726074219, obj_val: 67.88399505615234, abs dis: 6.718177795410156
[rfa agg] iter: 6, weight: tensor([0.0221, 0.0878, 0.0221, 0.0215, 0.1783, 0.1612, 0.0232, 0.1718, 0.1513,
        0.1607])
[rfa agg] iter:  7, prev_obj_val: 67.88399505615234, obj_val: 64.12527465820312, abs dis: 3.7587203979492188
[rfa agg] iter: 7, weight: tensor([0.0257, 0.0728, 0.0257, 0.0251, 0.2170, 0.1109, 0.0268, 0.1122, 0.1882,
        0.1956])
[rfa agg] iter:  8, prev_obj_val: 64.12527465820312, obj_val: 61.16566848754883, abs dis: 2.959606170654297
[rfa agg] iter: 8, weight: tensor([0.0207, 0.0682, 0.0207, 0.0201, 0.2328, 0.1133, 0.0217, 0.1166, 0.1871,
        0.1988])
[rfa agg] iter:  9, prev_obj_val: 61.16566848754883, obj_val: 67.88401794433594, abs dis: 6.718349456787109
[rfa agg] iter: 9, weight: tensor([0.0221, 0.0878, 0.0221, 0.0215, 0.1782, 0.1612, 0.0232, 0.1719, 0.1513,
        0.1607])
			Update norm = 112.19354527584241 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.57888293266296 sec.
Server Epoch:56 choose agents : [93, 82, 17, 59, 84, 14, 65, 13, 28, 10].
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 452/1742 (25.9472%)
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2575, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0691, Accuracy: 111/500 (22.2000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 190/500 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.6902, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8861, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 313/1089 (28.7420%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 442/1089 (40.5877%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.2455, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 460/1190 (38.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8826, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   2, Avg loss: 0.0346, Accuracy: 367/1013 (36.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4229, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0540, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0301, Accuracy: 718/1475 (48.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2341, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 351/1645 (21.3374%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 631/1645 (38.3587%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0932, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 410/1581 (25.9330%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 560/1581 (35.4206%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8759, Accuracy: 96/10000 (0.9600%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 216/861 (25.0871%)
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 452/861 (52.4971%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.1979, Accuracy: 87/10000 (0.8700%)
time spent on training: 250.87546467781067
[rfa agg] training data poison_ratio: 0.06795580110497237  data num: [1742, 500, 1574, 1089, 1190, 1013, 1475, 1645, 1581, 861]
[rfa agg] considering poison per batch poison_fraction: 0.021236187845303865
[rfa agg] init. name: [93, 82, 17, 59, 84, 14, 65, 13, 28, 10], weight: tensor([0.1375, 0.0395, 0.1242, 0.0860, 0.0939, 0.0800, 0.1164, 0.1298, 0.1248,
        0.0680])
[rfa agg] iter:  0, prev_obj_val: 47.85955047607422, obj_val: 49.30476379394531, abs dis: 1.4452133178710938
[rfa agg] iter: 0, weight: tensor([0.0600, 0.0128, 0.0833, 0.1711, 0.2926, 0.0833, 0.0940, 0.0737, 0.0837,
        0.0457])
[rfa agg] iter:  1, prev_obj_val: 49.30476379394531, obj_val: 53.34816360473633, abs dis: 4.043399810791016
[rfa agg] iter: 1, weight: tensor([0.0491, 0.0116, 0.0662, 0.1935, 0.3537, 0.0832, 0.0736, 0.0594, 0.0665,
        0.0434])
[rfa agg] iter:  2, prev_obj_val: 53.34816360473633, obj_val: 58.391014099121094, abs dis: 5.042850494384766
[rfa agg] iter: 2, weight: tensor([0.0457, 0.0132, 0.0588, 0.2806, 0.2467, 0.1229, 0.0638, 0.0538, 0.0591,
        0.0555])
[rfa agg] iter:  3, prev_obj_val: 58.391014099121094, obj_val: 61.13447952270508, abs dis: 2.7434654235839844
[rfa agg] iter: 3, weight: tensor([0.0462, 0.0163, 0.0573, 0.2387, 0.1582, 0.2307, 0.0610, 0.0532, 0.0576,
        0.0809])
[rfa agg] iter:  4, prev_obj_val: 61.13447952270508, obj_val: 64.05433654785156, abs dis: 2.9198570251464844
[rfa agg] iter: 4, weight: tensor([0.0428, 0.0167, 0.0523, 0.1758, 0.1250, 0.3376, 0.0553, 0.0489, 0.0525,
        0.0931])
[rfa agg] iter:  5, prev_obj_val: 64.05433654785156, obj_val: 61.11994171142578, abs dis: 2.9343948364257812
[rfa agg] iter: 5, weight: tensor([0.0371, 0.0160, 0.0446, 0.1250, 0.0958, 0.4455, 0.0468, 0.0420, 0.0448,
        0.1025])
[rfa agg] iter:  6, prev_obj_val: 61.11994171142578, obj_val: 61.11370849609375, abs dis: 0.00623321533203125
[rfa agg] iter: 6, weight: tensor([0.0401, 0.0156, 0.0490, 0.1574, 0.1156, 0.3884, 0.0517, 0.0458, 0.0492,
        0.0872])
[rfa agg] iter:  7, prev_obj_val: 61.11370849609375, obj_val: 64.04549407958984, abs dis: 2.9317855834960938
[rfa agg] iter: 7, weight: tensor([0.0409, 0.0159, 0.0499, 0.1625, 0.1183, 0.3743, 0.0527, 0.0466, 0.0501,
        0.0888])
[rfa agg] iter:  8, prev_obj_val: 64.04549407958984, obj_val: 61.12201690673828, abs dis: 2.9234771728515625
[rfa agg] iter: 8, weight: tensor([0.0361, 0.0156, 0.0435, 0.1213, 0.0932, 0.4603, 0.0456, 0.0409, 0.0437,
        0.0997])
[rfa agg] iter:  9, prev_obj_val: 61.12201690673828, obj_val: 61.11382293701172, abs dis: 0.0081939697265625
[rfa agg] iter: 9, weight: tensor([0.0399, 0.0156, 0.0487, 0.1564, 0.1150, 0.3917, 0.0515, 0.0456, 0.0490,
        0.0867])
			Update norm = 147.90022502518377 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.9728467464447 sec.
Server Epoch:57 choose agents : [43, 89, 50, 55, 94, 77, 48, 34, 27, 7].
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 296/946 (31.2896%)
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 335/946 (35.4123%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.5650, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.5923, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 162/809 (20.0247%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3197, Accuracy: 84/10000 (0.8400%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 267/1071 (24.9300%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5327, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 344/1662 (20.6980%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 645/1662 (38.8087%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5790, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 337/1340 (25.1493%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 554/1340 (41.3433%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5330, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 113/631 (17.9081%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.6201, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0560, Accuracy: 406/1427 (28.4513%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 577/1427 (40.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0444, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 442/1587 (27.8513%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 588/1587 (37.0510%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5240, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0515, Accuracy: 373/891 (41.8631%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 434/891 (48.7093%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6917, Accuracy: 50/10000 (0.5000%)
time spent on training: 226.95933151245117
[rfa agg] training data poison_ratio: 0.09511545293072825  data num: [946, 896, 809, 1071, 1662, 1340, 631, 1427, 1587, 891]
[rfa agg] considering poison per batch poison_fraction: 0.029723579040852578
[rfa agg] init. name: [43, 89, 50, 55, 94, 77, 48, 34, 27, 7], weight: tensor([0.0840, 0.0796, 0.0718, 0.0951, 0.1476, 0.1190, 0.0560, 0.1267, 0.1409,
        0.0791])
[rfa agg] iter:  0, prev_obj_val: 46.238956451416016, obj_val: 52.86991500854492, abs dis: 6.630958557128906
[rfa agg] iter: 0, weight: tensor([0.1284, 0.0831, 0.0576, 0.3501, 0.0530, 0.0947, 0.0259, 0.0680, 0.0568,
        0.0823])
[rfa agg] iter:  1, prev_obj_val: 52.86991500854492, obj_val: 61.1563606262207, abs dis: 8.286445617675781
[rfa agg] iter: 1, weight: tensor([0.2379, 0.2002, 0.1068, 0.0912, 0.0316, 0.0448, 0.0304, 0.0366, 0.0330,
        0.1875])
[rfa agg] iter:  2, prev_obj_val: 61.1563606262207, obj_val: 68.57704162597656, abs dis: 7.420680999755859
[rfa agg] iter: 2, weight: tensor([0.1075, 0.1720, 0.3075, 0.0624, 0.0304, 0.0397, 0.0492, 0.0339, 0.0314,
        0.1659])
[rfa agg] iter:  3, prev_obj_val: 68.57704162597656, obj_val: 55.05776596069336, abs dis: 13.519275665283203
[rfa agg] iter: 3, weight: tensor([0.1056, 0.1450, 0.2512, 0.0727, 0.0408, 0.0511, 0.1046, 0.0446, 0.0420,
        0.1424])
[rfa agg] iter:  4, prev_obj_val: 55.05776596069336, obj_val: 64.77120971679688, abs dis: 9.713443756103516
[rfa agg] iter: 4, weight: tensor([0.1563, 0.2457, 0.1470, 0.0698, 0.0282, 0.0388, 0.0319, 0.0322, 0.0293,
        0.2207])
[rfa agg] iter:  5, prev_obj_val: 64.77120971679688, obj_val: 64.74407196044922, abs dis: 0.02713775634765625
[rfa agg] iter: 5, weight: tensor([0.1043, 0.1556, 0.2957, 0.0670, 0.0352, 0.0450, 0.0705, 0.0388, 0.0363,
        0.1516])
[rfa agg] iter:  6, prev_obj_val: 64.74407196044922, obj_val: 61.100372314453125, abs dis: 3.6436996459960938
[rfa agg] iter: 6, weight: tensor([0.1009, 0.1487, 0.3220, 0.0648, 0.0341, 0.0436, 0.0684, 0.0376, 0.0351,
        0.1448])
[rfa agg] iter:  7, prev_obj_val: 61.100372314453125, obj_val: 68.58221435546875, abs dis: 7.481842041015625
[rfa agg] iter: 7, weight: tensor([0.0963, 0.1555, 0.3746, 0.0566, 0.0277, 0.0361, 0.0449, 0.0308, 0.0286,
        0.1489])
[rfa agg] iter:  8, prev_obj_val: 68.58221435546875, obj_val: 55.0587158203125, abs dis: 13.52349853515625
[rfa agg] iter: 8, weight: tensor([0.1052, 0.1441, 0.2549, 0.0724, 0.0407, 0.0510, 0.1041, 0.0444, 0.0418,
        0.1414])
[rfa agg] iter:  9, prev_obj_val: 55.0587158203125, obj_val: 64.77113342285156, abs dis: 9.712417602539062
[rfa agg] iter: 9, weight: tensor([0.1564, 0.2455, 0.1472, 0.0699, 0.0282, 0.0388, 0.0319, 0.0322, 0.0293,
        0.2206])
			Update norm = 112.2190241224722 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.78146481513977 sec.
Server Epoch:58 choose agents : [42, 60, 4, 34, 79, 80, 75, 93, 9, 37].
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 326/1372 (23.7609%)
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 531/1372 (38.7026%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3586, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 580/2227 (26.0440%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.4174, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0592, Accuracy: 343/901 (38.0688%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 396/901 (43.9512%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.6190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 590/1427 (41.3455%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3927, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   1, Avg loss: 0.1037, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 64/197 (32.4873%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.4237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   1, Avg loss: 0.0677, Accuracy: 164/682 (24.0469%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2271, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 254/776 (32.7320%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5333, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 421/1742 (24.1676%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 730/1742 (41.9059%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.0336, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 362/1275 (28.3922%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 729/1275 (57.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.0598, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 731/1129 (64.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9242, Accuracy: 107/10000 (1.0700%)
time spent on training: 214.14797401428223
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 2227, 901, 1427, 197, 682, 776, 1742, 1275, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 60, 4, 34, 79, 80, 75, 93, 9, 37], weight: tensor([0.1170, 0.1899, 0.0768, 0.1217, 0.0168, 0.0582, 0.0662, 0.1485, 0.1087,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 57.8305778503418, obj_val: 60.798377990722656, abs dis: 2.9678001403808594
[rfa agg] iter: 0, weight: tensor([0.2735, 0.0432, 0.0405, 0.1737, 0.0032, 0.0185, 0.0263, 0.0672, 0.2572,
        0.0967])
[rfa agg] iter:  1, prev_obj_val: 60.798377990722656, obj_val: 64.06373596191406, abs dis: 3.2653579711914062
[rfa agg] iter: 1, weight: tensor([0.1451, 0.0396, 0.0543, 0.1088, 0.0035, 0.0221, 0.0327, 0.0563, 0.3699,
        0.1677])
[rfa agg] iter:  2, prev_obj_val: 64.06373596191406, obj_val: 65.90470886230469, abs dis: 1.840972900390625
[rfa agg] iter: 2, weight: tensor([0.1157, 0.0411, 0.0763, 0.0943, 0.0041, 0.0277, 0.0426, 0.0557, 0.2372,
        0.3055])
[rfa agg] iter:  3, prev_obj_val: 65.90470886230469, obj_val: 70.44036865234375, abs dis: 4.5356597900390625
[rfa agg] iter: 3, weight: tensor([0.0971, 0.0381, 0.0842, 0.0814, 0.0041, 0.0283, 0.0446, 0.0505, 0.1718,
        0.3998])
[rfa agg] iter:  4, prev_obj_val: 70.44036865234375, obj_val: 70.42898559570312, abs dis: 0.011383056640625
[rfa agg] iter: 4, weight: tensor([0.0945, 0.0434, 0.1451, 0.0823, 0.0053, 0.0396, 0.0668, 0.0554, 0.1429,
        0.3247])
[rfa agg] iter:  5, prev_obj_val: 70.42898559570312, obj_val: 70.42884826660156, abs dis: 0.0001373291015625
[rfa agg] iter: 5, weight: tensor([0.0955, 0.0438, 0.1485, 0.0831, 0.0054, 0.0400, 0.0675, 0.0560, 0.1443,
        0.3159])
			Update norm = 152.3729875789997 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 377.49103355407715 sec.
Server Epoch:59 choose agents : [36, 33, 94, 37, 79, 21, 28, 25, 35, 24].
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0837, Accuracy: 84/408 (20.5882%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0522, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9961, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   1, Avg loss: 0.0766, Accuracy: 90/515 (17.4757%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2190, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   1, Avg loss: 0.0562, Accuracy: 318/1662 (19.1336%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 588/1662 (35.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0259, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 404/1129 (35.7839%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 721/1129 (63.8618%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3838, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   1, Avg loss: 0.0999, Accuracy: 10/197 (5.0761%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   2, Avg loss: 0.0829, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4147, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 375/1949 (19.2406%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3806, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 357/1581 (22.5806%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 590/1581 (37.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0741, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   1, Avg loss: 0.0539, Accuracy: 334/690 (48.4058%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2805, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   1, Avg loss: 0.0840, Accuracy: 28/271 (10.3321%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 113/271 (41.6974%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7115, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   1, Avg loss: 0.0792, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9212, Accuracy: 50/10000 (0.5000%)
time spent on training: 206.27790093421936
[rfa agg] training data poison_ratio: 0.0  data num: [408, 515, 1662, 1129, 197, 1949, 1581, 690, 271, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 33, 94, 37, 79, 21, 28, 25, 35, 24], weight: tensor([0.0468, 0.0591, 0.1907, 0.1296, 0.0226, 0.2237, 0.1814, 0.0792, 0.0311,
        0.0358])
[rfa agg] iter:  0, prev_obj_val: 76.13819885253906, obj_val: 75.82305908203125, abs dis: 0.3151397705078125
[rfa agg] iter: 0, weight: tensor([0.0192, 0.0292, 0.1190, 0.5379, 0.0073, 0.0841, 0.1304, 0.0495, 0.0108,
        0.0125])
[rfa agg] iter:  1, prev_obj_val: 75.82305908203125, obj_val: 76.94075012207031, abs dis: 1.1176910400390625
[rfa agg] iter: 1, weight: tensor([0.0147, 0.0225, 0.0914, 0.6448, 0.0057, 0.0646, 0.1002, 0.0381, 0.0083,
        0.0096])
[rfa agg] iter:  2, prev_obj_val: 76.94075012207031, obj_val: 80.60444641113281, abs dis: 3.6636962890625
[rfa agg] iter: 2, weight: tensor([0.0103, 0.0158, 0.0572, 0.7695, 0.0039, 0.0415, 0.0621, 0.0272, 0.0058,
        0.0067])
[rfa agg] iter:  3, prev_obj_val: 80.60444641113281, obj_val: 78.64945983886719, abs dis: 1.954986572265625
[rfa agg] iter: 3, weight: tensor([0.0215, 0.0338, 0.0967, 0.5776, 0.0080, 0.0733, 0.1035, 0.0601, 0.0119,
        0.0137])
[rfa agg] iter:  4, prev_obj_val: 78.64945983886719, obj_val: 78.63311767578125, abs dis: 0.0163421630859375
[rfa agg] iter: 4, weight: tensor([0.0159, 0.0247, 0.0794, 0.6674, 0.0060, 0.0589, 0.0856, 0.0432, 0.0089,
        0.0102])
[rfa agg] iter:  5, prev_obj_val: 78.63311767578125, obj_val: 82.55638885498047, abs dis: 3.9232711791992188
[rfa agg] iter: 5, weight: tensor([0.0148, 0.0231, 0.0742, 0.6892, 0.0056, 0.0550, 0.0799, 0.0403, 0.0083,
        0.0095])
[rfa agg] iter:  6, prev_obj_val: 82.55638885498047, obj_val: 80.56132507324219, abs dis: 1.9950637817382812
[rfa agg] iter: 6, weight: tensor([0.0280, 0.0446, 0.1138, 0.4803, 0.0103, 0.0877, 0.1209, 0.0812, 0.0154,
        0.0177])
[rfa agg] iter:  7, prev_obj_val: 80.56132507324219, obj_val: 80.55538940429688, abs dis: 0.0059356689453125
[rfa agg] iter: 7, weight: tensor([0.0229, 0.0361, 0.1034, 0.5486, 0.0085, 0.0782, 0.1106, 0.0643, 0.0127,
        0.0146])
[rfa agg] iter:  8, prev_obj_val: 80.55538940429688, obj_val: 78.65593719482422, abs dis: 1.8994522094726562
[rfa agg] iter: 8, weight: tensor([0.0225, 0.0355, 0.1016, 0.5566, 0.0084, 0.0768, 0.1087, 0.0632, 0.0125,
        0.0144])
[rfa agg] iter:  9, prev_obj_val: 78.65593719482422, obj_val: 80.56689453125, abs dis: 1.9109573364257812
[rfa agg] iter: 9, weight: tensor([0.0161, 0.0251, 0.0807, 0.6620, 0.0061, 0.0598, 0.0870, 0.0439, 0.0090,
        0.0104])
			Update norm = 152.47234636566068 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.90866684913635 sec.
Server Epoch:60 choose agents : [73, 88, 6, 42, 22, 24, 95, 80, 57, 30].
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0641, Accuracy: 178/938 (18.9765%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 309/938 (32.9424%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9536, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0708, Accuracy: 161/603 (26.6998%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7899, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 412/1956 (21.0634%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 677/1956 (34.6115%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.6041, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 334/1372 (24.3440%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 518/1372 (37.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5531, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 531/1470 (36.1224%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 814/1470 (55.3741%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8464, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0793, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.9280, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   1, Avg loss: 0.0506, Accuracy: 348/599 (58.0968%)
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.6568, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   1, Avg loss: 0.0681, Accuracy: 165/682 (24.1935%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 231/682 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.3106, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   1, Avg loss: 0.0550, Accuracy: 293/1154 (25.3899%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 524/1154 (45.4073%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.2052, Accuracy: 82/10000 (0.8200%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   1, Avg loss: 0.0726, Accuracy: 117/486 (24.0741%)
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   2, Avg loss: 0.0382, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.8561, Accuracy: 52/10000 (0.5200%)
time spent on training: 236.49129962921143
[rfa agg] training data poison_ratio: 0.11335144170497284  data num: [938, 603, 1956, 1372, 1470, 312, 599, 682, 1154, 486]
[rfa agg] considering poison per batch poison_fraction: 0.035422325532804014
[rfa agg] init. name: [73, 88, 6, 42, 22, 24, 95, 80, 57, 30], weight: tensor([0.0980, 0.0630, 0.2043, 0.1433, 0.1536, 0.0326, 0.0626, 0.0712, 0.1206,
        0.0508])
[rfa agg] iter:  0, prev_obj_val: 63.99828338623047, obj_val: 67.32561492919922, abs dis: 3.32733154296875
[rfa agg] iter: 0, weight: tensor([0.2225, 0.0430, 0.0698, 0.1353, 0.1214, 0.0130, 0.0427, 0.0565, 0.2690,
        0.0270])
[rfa agg] iter:  1, prev_obj_val: 67.32561492919922, obj_val: 72.20198059082031, abs dis: 4.876365661621094
[rfa agg] iter: 1, weight: tensor([0.4779, 0.0432, 0.0500, 0.0831, 0.0773, 0.0118, 0.0429, 0.0594, 0.1286,
        0.0257])
[rfa agg] iter:  2, prev_obj_val: 72.20198059082031, obj_val: 72.1963882446289, abs dis: 0.00559234619140625
[rfa agg] iter: 2, weight: tensor([0.4009, 0.0681, 0.0527, 0.0781, 0.0745, 0.0159, 0.0676, 0.1010, 0.1044,
        0.0370])
[rfa agg] iter:  3, prev_obj_val: 72.1963882446289, obj_val: 74.14055633544922, abs dis: 1.9441680908203125
[rfa agg] iter: 3, weight: tensor([0.3962, 0.0687, 0.0530, 0.0786, 0.0749, 0.0160, 0.0681, 0.1021, 0.1051,
        0.0372])
[rfa agg] iter:  4, prev_obj_val: 74.14055633544922, obj_val: 76.09577941894531, abs dis: 1.9552230834960938
[rfa agg] iter: 4, weight: tensor([0.3064, 0.0866, 0.0570, 0.0820, 0.0786, 0.0187, 0.0858, 0.1340, 0.1060,
        0.0449])
[rfa agg] iter:  5, prev_obj_val: 76.09577941894531, obj_val: 76.09272766113281, abs dis: 0.0030517578125
[rfa agg] iter: 5, weight: tensor([0.2389, 0.1036, 0.0570, 0.0797, 0.0769, 0.0205, 0.1025, 0.1699, 0.1002,
        0.0508])
			Update norm = 116.63089062695826 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 396.2193887233734 sec.
Server Epoch:61 choose agents : [54, 10, 57, 79, 45, 65, 13, 58, 75, 12].
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 452/1130 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2798, Accuracy: 66/10000 (0.6600%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 471/861 (54.7038%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.1137, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   1, Avg loss: 0.0579, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 488/1154 (42.2877%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.9832, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1043, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 65/197 (32.9949%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4064, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   1, Avg loss: 0.0615, Accuracy: 237/669 (35.4260%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   2, Avg loss: 0.0374, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.1061, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 410/1475 (27.7966%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 726/1475 (49.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4669, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   1, Avg loss: 0.0564, Accuracy: 330/1645 (20.0608%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   2, Avg loss: 0.0321, Accuracy: 649/1645 (39.4529%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1369, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   1, Avg loss: 0.0594, Accuracy: 339/803 (42.2167%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 405/803 (50.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.4348, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7215, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0849, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0480, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.0471, Accuracy: 50/10000 (0.5000%)
time spent on training: 215.27872157096863
[rfa agg] training data poison_ratio: 0.09515915119363395  data num: [1130, 861, 1154, 197, 669, 1475, 1645, 803, 776, 338]
[rfa agg] considering poison per batch poison_fraction: 0.02973723474801061
[rfa agg] init. name: [54, 10, 57, 79, 45, 65, 13, 58, 75, 12], weight: tensor([0.1249, 0.0952, 0.1275, 0.0218, 0.0739, 0.1630, 0.1818, 0.0887, 0.0858,
        0.0374])
[rfa agg] iter:  0, prev_obj_val: 50.567996978759766, obj_val: 52.46107482910156, abs dis: 1.8930778503417969
[rfa agg] iter: 0, weight: tensor([0.1801, 0.2130, 0.1328, 0.0071, 0.0612, 0.0720, 0.0651, 0.1286, 0.1252,
        0.0148])
[rfa agg] iter:  1, prev_obj_val: 52.46107482910156, obj_val: 55.29587173461914, abs dis: 2.834796905517578
[rfa agg] iter: 1, weight: tensor([0.1023, 0.3302, 0.0812, 0.0061, 0.0604, 0.0499, 0.0461, 0.1572, 0.1538,
        0.0128])
[rfa agg] iter:  2, prev_obj_val: 55.29587173461914, obj_val: 60.116397857666016, abs dis: 4.820526123046875
[rfa agg] iter: 2, weight: tensor([0.0610, 0.2753, 0.0509, 0.0051, 0.0630, 0.0345, 0.0324, 0.2324, 0.2343,
        0.0111])
[rfa agg] iter:  3, prev_obj_val: 60.116397857666016, obj_val: 63.209835052490234, abs dis: 3.0934371948242188
[rfa agg] iter: 3, weight: tensor([0.0555, 0.1434, 0.0479, 0.0063, 0.1081, 0.0349, 0.0332, 0.2776, 0.2790,
        0.0142])
[rfa agg] iter:  4, prev_obj_val: 63.209835052490234, obj_val: 63.2008056640625, abs dis: 0.009029388427734375
[rfa agg] iter: 4, weight: tensor([0.0622, 0.1336, 0.0544, 0.0082, 0.1785, 0.0408, 0.0391, 0.2346, 0.2299,
        0.0187])
[rfa agg] iter:  5, prev_obj_val: 63.2008056640625, obj_val: 60.098731994628906, abs dis: 3.1020736694335938
[rfa agg] iter: 5, weight: tensor([0.0623, 0.1340, 0.0545, 0.0082, 0.1846, 0.0409, 0.0391, 0.2313, 0.2264,
        0.0187])
[rfa agg] iter:  6, prev_obj_val: 60.098731994628906, obj_val: 66.49031066894531, abs dis: 6.391578674316406
[rfa agg] iter: 6, weight: tensor([0.0550, 0.1381, 0.0475, 0.0063, 0.1101, 0.0346, 0.0329, 0.2815, 0.2802,
        0.0140])
[rfa agg] iter:  7, prev_obj_val: 66.49031066894531, obj_val: 60.1358528137207, abs dis: 6.354457855224609
[rfa agg] iter: 7, weight: tensor([0.0637, 0.1213, 0.0563, 0.0097, 0.2746, 0.0434, 0.0418, 0.1858, 0.1807,
        0.0226])
[rfa agg] iter:  8, prev_obj_val: 60.1358528137207, obj_val: 63.208370208740234, abs dis: 3.0725173950195312
[rfa agg] iter: 8, weight: tensor([0.0564, 0.1414, 0.0486, 0.0064, 0.1150, 0.0354, 0.0337, 0.2753, 0.2735,
        0.0144])
[rfa agg] iter:  9, prev_obj_val: 63.208370208740234, obj_val: 63.20079803466797, abs dis: 0.007572174072265625
[rfa agg] iter: 9, weight: tensor([0.0622, 0.1336, 0.0544, 0.0082, 0.1791, 0.0408, 0.0391, 0.2344, 0.2295,
        0.0187])
			Update norm = 107.72288395026611 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.8706467151642 sec.
Server Epoch:62 choose agents : [89, 55, 54, 26, 40, 6, 59, 57, 13, 73].
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   1, Avg loss: 0.0594, Accuracy: 340/896 (37.9464%)
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.5420, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   1, Avg loss: 0.0544, Accuracy: 266/1071 (24.8366%)
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0337, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   1, Avg loss: 0.0536, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.8670, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 363/1446 (25.1037%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6356, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 366/1573 (23.2676%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 615/1573 (39.0973%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9327, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 400/1956 (20.4499%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 645/1956 (32.9755%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3383, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 438/1089 (40.2204%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.7437, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   1, Avg loss: 0.0560, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.7493, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 335/1645 (20.3647%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0319, Accuracy: 674/1645 (40.9726%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.6119, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   1, Avg loss: 0.0640, Accuracy: 176/938 (18.7633%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 342/938 (36.4606%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1815, Accuracy: 68/10000 (0.6800%)
time spent on training: 251.37244367599487
[rfa agg] training data poison_ratio: 0.08303612963250116  data num: [896, 1071, 1130, 1446, 1573, 1956, 1089, 1154, 1645, 938]
[rfa agg] considering poison per batch poison_fraction: 0.025948790510156614
[rfa agg] init. name: [89, 55, 54, 26, 40, 6, 59, 57, 13, 73], weight: tensor([0.0695, 0.0830, 0.0876, 0.1121, 0.1220, 0.1517, 0.0844, 0.0895, 0.1275,
        0.0727])
[rfa agg] iter:  0, prev_obj_val: 44.59835433959961, obj_val: 47.76702117919922, abs dis: 3.1686668395996094
[rfa agg] iter: 0, weight: tensor([0.0397, 0.0921, 0.1397, 0.1212, 0.0831, 0.0475, 0.1274, 0.2273, 0.0724,
        0.0497])
[rfa agg] iter:  1, prev_obj_val: 47.76702117919922, obj_val: 54.87705612182617, abs dis: 7.110034942626953
[rfa agg] iter: 1, weight: tensor([0.0395, 0.1462, 0.2587, 0.0510, 0.0402, 0.0270, 0.1835, 0.1628, 0.0367,
        0.0544])
[rfa agg] iter:  2, prev_obj_val: 54.87705612182617, obj_val: 57.872108459472656, abs dis: 2.9950523376464844
[rfa agg] iter: 2, weight: tensor([0.0766, 0.2502, 0.1549, 0.0494, 0.0416, 0.0304, 0.1361, 0.0984, 0.0388,
        0.1235])
[rfa agg] iter:  3, prev_obj_val: 57.872108459472656, obj_val: 57.86619186401367, abs dis: 0.005916595458984375
[rfa agg] iter: 3, weight: tensor([0.1016, 0.2145, 0.1295, 0.0500, 0.0427, 0.0319, 0.1182, 0.0901, 0.0401,
        0.1815])
			Update norm = 143.40314811964555 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3392, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3460, Accuracy: 0/9950 (0.0000%)
saving model
Done in 412.3823359012604 sec.
Server Epoch:63 choose agents : [88, 83, 25, 86, 4, 32, 99, 35, 73, 64].
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   1, Avg loss: 0.0711, Accuracy: 160/603 (26.5340%)
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.3918, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 460/1953 (23.5535%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   2, Avg loss: 0.0330, Accuracy: 803/1953 (41.1162%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7601, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0524, Accuracy: 333/690 (48.2609%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0265, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7303, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   1, Avg loss: 0.0647, Accuracy: 348/1003 (34.6959%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0589, Accuracy: 342/901 (37.9578%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 412/901 (45.7270%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 211/735 (28.7075%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.6534, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0645, Accuracy: 204/773 (26.3907%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9725, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 30/271 (11.0701%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0519, Accuracy: 125/271 (46.1255%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.7670, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   1, Avg loss: 0.0639, Accuracy: 182/938 (19.4030%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 305/938 (32.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2555, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0634, Accuracy: 187/953 (19.6222%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.0102, Accuracy: 73/10000 (0.7300%)
time spent on training: 219.80876111984253
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1953, 690, 1003, 901, 735, 773, 271, 938, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 83, 25, 86, 4, 32, 99, 35, 73, 64], weight: tensor([0.0684, 0.2214, 0.0782, 0.1137, 0.1022, 0.0833, 0.0876, 0.0307, 0.1063,
        0.1080])
[rfa agg] iter:  0, prev_obj_val: 48.396278381347656, obj_val: 53.86367416381836, abs dis: 5.467395782470703
[rfa agg] iter: 0, weight: tensor([0.0214, 0.0246, 0.0298, 0.1996, 0.2089, 0.0404, 0.0580, 0.0050, 0.2201,
        0.1921])
[rfa agg] iter:  1, prev_obj_val: 53.86367416381836, obj_val: 61.611106872558594, abs dis: 7.747432708740234
[rfa agg] iter: 1, weight: tensor([0.0617, 0.0278, 0.1102, 0.0740, 0.0925, 0.2175, 0.2135, 0.0095, 0.0967,
        0.0966])
[rfa agg] iter:  2, prev_obj_val: 61.611106872558594, obj_val: 72.50814819335938, abs dis: 10.897041320800781
[rfa agg] iter: 2, weight: tensor([0.1402, 0.0263, 0.3085, 0.0533, 0.0599, 0.1745, 0.0997, 0.0121, 0.0623,
        0.0630])
[rfa agg] iter:  3, prev_obj_val: 72.50814819335938, obj_val: 72.48419952392578, abs dis: 0.02394866943359375
[rfa agg] iter: 3, weight: tensor([0.3271, 0.0349, 0.1697, 0.0588, 0.0624, 0.1100, 0.0832, 0.0230, 0.0651,
        0.0658])
[rfa agg] iter:  4, prev_obj_val: 72.48419952392578, obj_val: 68.51124572753906, abs dis: 3.9729537963867188
[rfa agg] iter: 4, weight: tensor([0.3528, 0.0337, 0.1619, 0.0568, 0.0603, 0.1056, 0.0802, 0.0222, 0.0629,
        0.0636])
[rfa agg] iter:  5, prev_obj_val: 68.51124572753906, obj_val: 72.48696899414062, abs dis: 3.9757232666015625
[rfa agg] iter: 5, weight: tensor([0.4355, 0.0252, 0.1671, 0.0450, 0.0484, 0.0948, 0.0679, 0.0147, 0.0505,
        0.0510])
[rfa agg] iter:  6, prev_obj_val: 72.48696899414062, obj_val: 68.50978088378906, abs dis: 3.9771881103515625
[rfa agg] iter: 6, weight: tensor([0.3669, 0.0330, 0.1585, 0.0556, 0.0590, 0.1031, 0.0785, 0.0218, 0.0615,
        0.0622])
[rfa agg] iter:  7, prev_obj_val: 68.50978088378906, obj_val: 72.48734283447266, abs dis: 3.9775619506835938
[rfa agg] iter: 7, weight: tensor([0.4410, 0.0250, 0.1654, 0.0445, 0.0479, 0.0938, 0.0673, 0.0145, 0.0500,
        0.0505])
[rfa agg] iter:  8, prev_obj_val: 72.48734283447266, obj_val: 68.50971984863281, abs dis: 3.9776229858398438
[rfa agg] iter: 8, weight: tensor([0.3676, 0.0330, 0.1583, 0.0556, 0.0589, 0.1030, 0.0784, 0.0217, 0.0615,
        0.0621])
[rfa agg] iter:  9, prev_obj_val: 68.50971984863281, obj_val: 72.48735809326172, abs dis: 3.9776382446289062
[rfa agg] iter: 9, weight: tensor([0.4413, 0.0250, 0.1653, 0.0445, 0.0479, 0.0938, 0.0672, 0.0145, 0.0500,
        0.0505])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 377.26950240135193 sec.
Server Epoch:64 choose agents : [19, 68, 40, 0, 59, 96, 62, 63, 70, 81].
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   1, Avg loss: 0.0455, Accuracy: 398/1036 (38.4170%)
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 689/1036 (66.5058%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.8040, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 445/1163 (38.2631%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0127, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 359/1573 (22.8226%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 570/1573 (36.2365%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2252, Accuracy: 64/10000 (0.6400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 373/1657 (22.5106%)
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 528/1657 (31.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2463, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1089 (30.0275%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   2, Avg loss: 0.0302, Accuracy: 441/1089 (40.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.9971, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 36/311 (11.5756%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.6697, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 159/568 (27.9930%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.3712, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 263/888 (29.6171%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 395/888 (44.4820%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.5701, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 363/1418 (25.5994%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0298, Accuracy: 672/1418 (47.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0683, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0638, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0368, Accuracy: 301/774 (38.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1706, Accuracy: 68/10000 (0.6800%)
time spent on training: 239.63347625732422
[rfa agg] training data poison_ratio: 0.15815596067576596  data num: [1036, 1163, 1573, 1657, 1089, 311, 568, 888, 1418, 774]
[rfa agg] considering poison per batch poison_fraction: 0.04942373771117686
[rfa agg] init. name: [19, 68, 40, 0, 59, 96, 62, 63, 70, 81], weight: tensor([0.0989, 0.1110, 0.1501, 0.1582, 0.1039, 0.0297, 0.0542, 0.0848, 0.1353,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 47.303836822509766, obj_val: 51.17990493774414, abs dis: 3.876068115234375
[rfa agg] iter: 0, weight: tensor([0.3448, 0.1438, 0.0521, 0.0488, 0.1953, 0.0069, 0.0189, 0.0765, 0.0622,
        0.0507])
[rfa agg] iter:  1, prev_obj_val: 51.17990493774414, obj_val: 55.69139862060547, abs dis: 4.511493682861328
[rfa agg] iter: 1, weight: tensor([0.2892, 0.1229, 0.0570, 0.0539, 0.1588, 0.0092, 0.0265, 0.1353, 0.0657,
        0.0816])
[rfa agg] iter:  2, prev_obj_val: 55.69139862060547, obj_val: 60.573848724365234, abs dis: 4.882450103759766
[rfa agg] iter: 2, weight: tensor([0.1757, 0.1017, 0.0558, 0.0534, 0.1221, 0.0111, 0.0335, 0.2555, 0.0627,
        0.1285])
[rfa agg] iter:  3, prev_obj_val: 60.573848724365234, obj_val: 60.532779693603516, abs dis: 0.04106903076171875
[rfa agg] iter: 3, weight: tensor([0.0969, 0.0664, 0.0412, 0.0397, 0.0760, 0.0100, 0.0326, 0.4125, 0.0453,
        0.1794])
[rfa agg] iter:  4, prev_obj_val: 60.532779693603516, obj_val: 66.63909149169922, abs dis: 6.106311798095703
[rfa agg] iter: 4, weight: tensor([0.0875, 0.0603, 0.0374, 0.0361, 0.0688, 0.0091, 0.0296, 0.4670, 0.0411,
        0.1630])
[rfa agg] iter:  5, prev_obj_val: 66.63909149169922, obj_val: 63.42397689819336, abs dis: 3.2151145935058594
[rfa agg] iter: 5, weight: tensor([0.0834, 0.0632, 0.0430, 0.0418, 0.0699, 0.0128, 0.0462, 0.2662, 0.0464,
        0.3271])
[rfa agg] iter:  6, prev_obj_val: 63.42397689819336, obj_val: 63.41941452026367, abs dis: 0.0045623779296875
[rfa agg] iter: 6, weight: tensor([0.0848, 0.0616, 0.0401, 0.0389, 0.0691, 0.0107, 0.0368, 0.3191, 0.0437,
        0.2951])
[rfa agg] iter:  7, prev_obj_val: 63.41941452026367, obj_val: 63.41896438598633, abs dis: 0.00045013427734375
[rfa agg] iter: 7, weight: tensor([0.0845, 0.0614, 0.0400, 0.0387, 0.0688, 0.0107, 0.0367, 0.3331, 0.0435,
        0.2825])
			Update norm = 121.04336048370229 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.0827536582947 sec.
Server Epoch:65 choose agents : [82, 14, 61, 68, 51, 24, 76, 37, 34, 80].
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0697, Accuracy: 112/500 (22.4000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0465, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.3227, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 341/1013 (33.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3643, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1312, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1199, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3528, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0361, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   1, Avg loss: 0.0582, Accuracy: 245/1049 (23.3556%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 520/1049 (49.5710%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9570, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   1, Avg loss: 0.0795, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   2, Avg loss: 0.0431, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.9943, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0814, Accuracy: 66/466 (14.1631%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7106, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 412/1129 (36.4925%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 752/1129 (66.6076%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3334, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 380/1427 (26.6293%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 566/1427 (39.6636%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.6458, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0670, Accuracy: 178/682 (26.0997%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0369, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0584, Accuracy: 57/10000 (0.5700%)
time spent on training: 186.41334557533264
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1013, 85, 1163, 1049, 312, 466, 1129, 1427, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 14, 61, 68, 51, 24, 76, 37, 34, 80], weight: tensor([0.0639, 0.1294, 0.0109, 0.1486, 0.1340, 0.0399, 0.0595, 0.1443, 0.1823,
        0.0871])
[rfa agg] iter:  0, prev_obj_val: 46.403717041015625, obj_val: 48.46005630493164, abs dis: 2.0563392639160156
[rfa agg] iter: 0, weight: tensor([0.0437, 0.2510, 0.0037, 0.1211, 0.1761, 0.0182, 0.0407, 0.1445, 0.0832,
        0.1177])
[rfa agg] iter:  1, prev_obj_val: 48.46005630493164, obj_val: 50.553733825683594, abs dis: 2.093677520751953
[rfa agg] iter: 1, weight: tensor([0.0510, 0.2216, 0.0042, 0.1181, 0.1641, 0.0207, 0.0476, 0.1383, 0.0844,
        0.1501])
[rfa agg] iter:  2, prev_obj_val: 50.553733825683594, obj_val: 50.55239486694336, abs dis: 0.001338958740234375
[rfa agg] iter: 2, weight: tensor([0.0581, 0.1930, 0.0045, 0.1124, 0.1498, 0.0228, 0.0542, 0.1296, 0.0831,
        0.1925])
			Update norm = 116.59320557364181 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.50426983833313 sec.
Server Epoch:66 choose agents : [29, 39, 13, 16, 89, 32, 70, 78, 86, 12].
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 663/1440 (46.0417%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0245, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 304/1013 (30.0099%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 490/1013 (48.3712%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4460, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   1, Avg loss: 0.0562, Accuracy: 350/1645 (21.2766%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 668/1645 (40.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2662, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   1, Avg loss: 0.0607, Accuracy: 281/708 (39.6893%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   2, Avg loss: 0.0393, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.5239, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0586, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7427, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   1, Avg loss: 0.0574, Accuracy: 214/735 (29.1156%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.9591, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 360/1418 (25.3879%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 657/1418 (46.3329%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.3075, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0786, Accuracy: 82/416 (19.7115%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0434, Accuracy: 179/416 (43.0288%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.4303, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0636, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 374/1003 (37.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.1470, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   1, Avg loss: 0.0846, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   2, Avg loss: 0.0461, Accuracy: 156/338 (46.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0033, Accuracy: 50/10000 (0.5000%)
time spent on training: 210.68508076667786
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 1013, 1645, 708, 896, 735, 1418, 416, 1003, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 39, 13, 16, 89, 32, 70, 78, 86, 12], weight: tensor([0.1498, 0.1054, 0.1711, 0.0737, 0.0932, 0.0765, 0.1475, 0.0433, 0.1043,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 51.78549575805664, obj_val: 57.26985168457031, abs dis: 5.484355926513672
[rfa agg] iter: 0, weight: tensor([0.0528, 0.2404, 0.0440, 0.0678, 0.2090, 0.0705, 0.0519, 0.0153, 0.2371,
        0.0111])
[rfa agg] iter:  1, prev_obj_val: 57.26985168457031, obj_val: 57.22059631347656, abs dis: 0.04925537109375
[rfa agg] iter: 1, weight: tensor([0.0463, 0.1204, 0.0402, 0.1300, 0.3275, 0.1372, 0.0455, 0.0195, 0.1195,
        0.0138])
[rfa agg] iter:  2, prev_obj_val: 57.22059631347656, obj_val: 57.2197380065918, abs dis: 0.000858306884765625
[rfa agg] iter: 2, weight: tensor([0.0444, 0.1144, 0.0386, 0.1265, 0.3532, 0.1333, 0.0437, 0.0188, 0.1138,
        0.0133])
[rfa agg] iter:  3, prev_obj_val: 57.2197380065918, obj_val: 59.60574722290039, abs dis: 2.3860092163085938
[rfa agg] iter: 3, weight: tensor([0.0441, 0.1135, 0.0384, 0.1254, 0.3583, 0.1322, 0.0434, 0.0187, 0.1129,
        0.0132])
[rfa agg] iter:  4, prev_obj_val: 59.60574722290039, obj_val: 59.58897399902344, abs dis: 0.016773223876953125
[rfa agg] iter: 4, weight: tensor([0.0452, 0.1031, 0.0397, 0.1831, 0.2495, 0.1956, 0.0444, 0.0217, 0.1025,
        0.0152])
[rfa agg] iter:  5, prev_obj_val: 59.58897399902344, obj_val: 59.588844299316406, abs dis: 0.00012969970703125
[rfa agg] iter: 5, weight: tensor([0.0451, 0.1031, 0.0397, 0.1883, 0.2396, 0.2006, 0.0444, 0.0217, 0.1024,
        0.0152])
			Update norm = 116.58609010619577 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 380.42121410369873 sec.
Server Epoch:67 choose agents : [94, 66, 0, 19, 86, 99, 97, 78, 7, 76].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 327/1662 (19.6751%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 655/1662 (39.4103%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1619, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 414/1402 (29.5292%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8877, Accuracy: 72/10000 (0.7200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 339/1657 (20.4587%)
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 528/1657 (31.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3026, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0450, Accuracy: 392/1036 (37.8378%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 667/1036 (64.3822%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.7922, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.1408, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   1, Avg loss: 0.0623, Accuracy: 187/773 (24.1915%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   2, Avg loss: 0.0286, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4021, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 353/1213 (29.1014%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 482/1213 (39.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.8160, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0781, Accuracy: 77/416 (18.5096%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0447, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.3776, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   1, Avg loss: 0.0507, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 458/891 (51.4029%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8321, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0819, Accuracy: 68/466 (14.5923%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.5493, Accuracy: 50/10000 (0.5000%)
time spent on training: 250.36792492866516
[rfa agg] training data poison_ratio: 0.1575244795132617  data num: [1662, 1402, 1657, 1036, 1003, 773, 1213, 416, 891, 466]
[rfa agg] considering poison per batch poison_fraction: 0.04922639984789429
[rfa agg] init. name: [94, 66, 0, 19, 86, 99, 97, 78, 7, 76], weight: tensor([0.1580, 0.1333, 0.1575, 0.0985, 0.0954, 0.0735, 0.1153, 0.0395, 0.0847,
        0.0443])
[rfa agg] iter:  0, prev_obj_val: 47.6717529296875, obj_val: 50.46323013305664, abs dis: 2.7914772033691406
[rfa agg] iter: 0, weight: tensor([0.0464, 0.0698, 0.0463, 0.3454, 0.2067, 0.0479, 0.1416, 0.0105, 0.0722,
        0.0131])
[rfa agg] iter:  1, prev_obj_val: 50.46323013305664, obj_val: 54.67167282104492, abs dis: 4.208442687988281
[rfa agg] iter: 1, weight: tensor([0.0402, 0.0562, 0.0401, 0.2171, 0.3661, 0.0604, 0.0948, 0.0112, 0.0996,
        0.0141])
[rfa agg] iter:  2, prev_obj_val: 54.67167282104492, obj_val: 59.57124710083008, abs dis: 4.899574279785156
[rfa agg] iter: 2, weight: tensor([0.0451, 0.0596, 0.0450, 0.1462, 0.2672, 0.1073, 0.0890, 0.0155, 0.2052,
        0.0199])
[rfa agg] iter:  3, prev_obj_val: 59.57124710083008, obj_val: 59.5161247253418, abs dis: 0.05512237548828125
[rfa agg] iter: 3, weight: tensor([0.0397, 0.0500, 0.0395, 0.0962, 0.1382, 0.1763, 0.0687, 0.0170, 0.3521,
        0.0222])
[rfa agg] iter:  4, prev_obj_val: 59.5161247253418, obj_val: 59.511470794677734, abs dis: 0.0046539306640625
[rfa agg] iter: 4, weight: tensor([0.0366, 0.0461, 0.0365, 0.0884, 0.1251, 0.1660, 0.0633, 0.0157, 0.4020,
        0.0205])
[rfa agg] iter:  5, prev_obj_val: 59.511470794677734, obj_val: 69.01473236083984, abs dis: 9.50326156616211
[rfa agg] iter: 5, weight: tensor([0.0355, 0.0447, 0.0354, 0.0856, 0.1208, 0.1593, 0.0613, 0.0152, 0.4223,
        0.0199])
[rfa agg] iter:  6, prev_obj_val: 69.01473236083984, obj_val: 65.51625061035156, abs dis: 3.4984817504882812
[rfa agg] iter: 6, weight: tensor([0.0459, 0.0549, 0.0458, 0.0847, 0.1047, 0.3189, 0.0691, 0.0281, 0.2097,
        0.0383])
[rfa agg] iter:  7, prev_obj_val: 65.51625061035156, obj_val: 65.50889587402344, abs dis: 0.007354736328125
[rfa agg] iter: 7, weight: tensor([0.0374, 0.0455, 0.0373, 0.0745, 0.0954, 0.3921, 0.0587, 0.0202, 0.2116,
        0.0272])
[rfa agg] iter:  8, prev_obj_val: 65.50889587402344, obj_val: 72.56002044677734, abs dis: 7.051124572753906
[rfa agg] iter: 8, weight: tensor([0.0359, 0.0437, 0.0358, 0.0715, 0.0914, 0.4178, 0.0564, 0.0194, 0.2019,
        0.0261])
[rfa agg] iter:  9, prev_obj_val: 72.56002044677734, obj_val: 65.52115631103516, abs dis: 7.0388641357421875
[rfa agg] iter: 9, weight: tensor([0.0514, 0.0605, 0.0512, 0.0886, 0.1069, 0.3001, 0.0746, 0.0358, 0.1809,
        0.0500])
			Update norm = 116.58907203829182 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.8485474586487 sec.
Server Epoch:68 choose agents : [47, 88, 74, 60, 6, 79, 68, 41, 15, 82].
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   1, Avg loss: 0.1154, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   2, Avg loss: 0.0997, Accuracy: 32/134 (23.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3848, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0686, Accuracy: 178/603 (29.5191%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0430, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.6828, Accuracy: 51/10000 (0.5100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 502/1552 (32.3454%)
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 767/1552 (49.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.9823, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 602/2227 (27.0319%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1053/2227 (47.2833%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3221, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 417/1956 (21.3190%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   2, Avg loss: 0.0311, Accuracy: 695/1956 (35.5317%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2051, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   1, Avg loss: 0.1039, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   2, Avg loss: 0.0837, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.4060, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   1, Avg loss: 0.0633, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 458/1163 (39.3809%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.2642, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   1, Avg loss: 0.0573, Accuracy: 343/719 (47.7051%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   2, Avg loss: 0.0296, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9528, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   1, Avg loss: 0.0595, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 458/1154 (39.6880%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.7371, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0690, Accuracy: 112/500 (22.4000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.6563, Accuracy: 47/10000 (0.4700%)
time spent on training: 262.0149173736572
[rfa agg] training data poison_ratio: 0.15208231259186672  data num: [134, 603, 1552, 2227, 1956, 197, 1163, 719, 1154, 500]
[rfa agg] considering poison per batch poison_fraction: 0.047525722684958346
[rfa agg] init. name: [47, 88, 74, 60, 6, 79, 68, 41, 15, 82], weight: tensor([0.0131, 0.0591, 0.1521, 0.2182, 0.1917, 0.0193, 0.1140, 0.0705, 0.1131,
        0.0490])
[rfa agg] iter:  0, prev_obj_val: 76.36483001708984, obj_val: 79.14205932617188, abs dis: 2.7772293090820312
[rfa agg] iter: 0, weight: tensor([0.0039, 0.0284, 0.2330, 0.0891, 0.1110, 0.0061, 0.2355, 0.0409, 0.2321,
        0.0200])
[rfa agg] iter:  1, prev_obj_val: 79.14205932617188, obj_val: 80.28278350830078, abs dis: 1.1407241821289062
[rfa agg] iter: 1, weight: tensor([0.0025, 0.0198, 0.0876, 0.0449, 0.0531, 0.0040, 0.3740, 0.0299, 0.3705,
        0.0136])
[rfa agg] iter:  2, prev_obj_val: 80.28278350830078, obj_val: 82.15689849853516, abs dis: 1.874114990234375
[rfa agg] iter: 2, weight: tensor([0.0021, 0.0168, 0.0641, 0.0348, 0.0407, 0.0033, 0.4062, 0.0256, 0.3949,
        0.0114])
[rfa agg] iter:  3, prev_obj_val: 82.15689849853516, obj_val: 86.88011169433594, abs dis: 4.723213195800781
[rfa agg] iter: 3, weight: tensor([0.0025, 0.0205, 0.0686, 0.0391, 0.0453, 0.0039, 0.3932, 0.0319, 0.3810,
        0.0138])
[rfa agg] iter:  4, prev_obj_val: 86.88011169433594, obj_val: 82.17156219482422, abs dis: 4.708549499511719
[rfa agg] iter: 4, weight: tensor([0.0043, 0.0371, 0.0952, 0.0589, 0.0670, 0.0068, 0.3258, 0.0599, 0.3208,
        0.0244])
[rfa agg] iter:  5, prev_obj_val: 82.17156219482422, obj_val: 86.87899780273438, abs dis: 4.707435607910156
[rfa agg] iter: 5, weight: tensor([0.0026, 0.0211, 0.0707, 0.0403, 0.0467, 0.0041, 0.3911, 0.0328, 0.3764,
        0.0142])
[rfa agg] iter:  6, prev_obj_val: 86.87899780273438, obj_val: 82.17158508300781, abs dis: 4.7074127197265625
[rfa agg] iter: 6, weight: tensor([0.0043, 0.0371, 0.0952, 0.0589, 0.0670, 0.0068, 0.3259, 0.0599, 0.3206,
        0.0244])
[rfa agg] iter:  7, prev_obj_val: 82.17158508300781, obj_val: 86.87899017333984, abs dis: 4.707405090332031
[rfa agg] iter: 7, weight: tensor([0.0026, 0.0212, 0.0707, 0.0403, 0.0467, 0.0041, 0.3912, 0.0328, 0.3763,
        0.0142])
[rfa agg] iter:  8, prev_obj_val: 86.87899017333984, obj_val: 82.17158508300781, abs dis: 4.707405090332031
[rfa agg] iter: 8, weight: tensor([0.0043, 0.0371, 0.0952, 0.0589, 0.0670, 0.0068, 0.3259, 0.0599, 0.3206,
        0.0244])
[rfa agg] iter:  9, prev_obj_val: 82.17158508300781, obj_val: 86.87899780273438, abs dis: 4.7074127197265625
[rfa agg] iter: 9, weight: tensor([0.0026, 0.0212, 0.0707, 0.0403, 0.0467, 0.0041, 0.3912, 0.0328, 0.3763,
        0.0142])
			Update norm = 156.8119208339245 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3412, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.72153520584106 sec.
Server Epoch:69 choose agents : [22, 25, 63, 47, 88, 9, 18, 92, 56, 67].
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 479/1470 (32.5850%)
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 834/1470 (56.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6039, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   1, Avg loss: 0.0510, Accuracy: 342/690 (49.5652%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   2, Avg loss: 0.0258, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4490, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.0327, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   1, Avg loss: 0.1205, Accuracy: 5/134 (3.7313%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   2, Avg loss: 0.1054, Accuracy: 30/134 (22.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3838, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0696, Accuracy: 172/603 (28.5240%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0436, Accuracy: 275/603 (45.6053%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.4836, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 717/1275 (56.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.4682, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   1, Avg loss: 0.0731, Accuracy: 134/530 (25.2830%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   2, Avg loss: 0.0403, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2083, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   1, Avg loss: 0.0529, Accuracy: 423/1715 (24.6647%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 701/1715 (40.8746%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8711, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   1, Avg loss: 0.0837, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   2, Avg loss: 0.0681, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3909, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   1, Avg loss: 0.0743, Accuracy: 67/426 (15.7277%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   2, Avg loss: 0.0395, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.3405, Accuracy: 50/10000 (0.5000%)
time spent on training: 189.57153940200806
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 690, 888, 134, 603, 1275, 530, 1715, 186, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 25, 63, 47, 88, 9, 18, 92, 56, 67], weight: tensor([0.1857, 0.0872, 0.1122, 0.0169, 0.0762, 0.1610, 0.0669, 0.2166, 0.0235,
        0.0538])
[rfa agg] iter:  0, prev_obj_val: 62.998775482177734, obj_val: 64.21929931640625, abs dis: 1.2205238342285156
[rfa agg] iter: 0, weight: tensor([0.1239, 0.0968, 0.3374, 0.0068, 0.0695, 0.1778, 0.0517, 0.0948, 0.0095,
        0.0319])
[rfa agg] iter:  1, prev_obj_val: 64.21929931640625, obj_val: 67.83616638183594, abs dis: 3.6168670654296875
[rfa agg] iter: 1, weight: tensor([0.0770, 0.0870, 0.5311, 0.0052, 0.0596, 0.1030, 0.0430, 0.0614, 0.0072,
        0.0254])
[rfa agg] iter:  2, prev_obj_val: 67.83616638183594, obj_val: 69.37450408935547, abs dis: 1.5383377075195312
[rfa agg] iter: 2, weight: tensor([0.0719, 0.1605, 0.4069, 0.0066, 0.0968, 0.0890, 0.0644, 0.0601, 0.0091,
        0.0347])
[rfa agg] iter:  3, prev_obj_val: 69.37450408935547, obj_val: 70.93946838378906, abs dis: 1.5649642944335938
[rfa agg] iter: 3, weight: tensor([0.0728, 0.2237, 0.2941, 0.0074, 0.1232, 0.0884, 0.0782, 0.0617, 0.0102,
        0.0403])
[rfa agg] iter:  4, prev_obj_val: 70.93946838378906, obj_val: 72.54574584960938, abs dis: 1.6062774658203125
[rfa agg] iter: 4, weight: tensor([0.0654, 0.3019, 0.2096, 0.0073, 0.1441, 0.0780, 0.0857, 0.0562, 0.0102,
        0.0417])
[rfa agg] iter:  5, prev_obj_val: 72.54574584960938, obj_val: 74.2951431274414, abs dis: 1.7493972778320312
[rfa agg] iter: 5, weight: tensor([0.0512, 0.4152, 0.1380, 0.0063, 0.1546, 0.0600, 0.0836, 0.0444, 0.0088,
        0.0378])
[rfa agg] iter:  6, prev_obj_val: 74.2951431274414, obj_val: 79.03266906738281, abs dis: 4.737525939941406
[rfa agg] iter: 6, weight: tensor([0.0345, 0.5442, 0.0814, 0.0047, 0.1556, 0.0399, 0.0728, 0.0303, 0.0066,
        0.0299])
[rfa agg] iter:  7, prev_obj_val: 79.03266906738281, obj_val: 84.97288513183594, abs dis: 5.940216064453125
[rfa agg] iter: 7, weight: tensor([0.0357, 0.2107, 0.0689, 0.0060, 0.4047, 0.0402, 0.1492, 0.0319, 0.0084,
        0.0443])
[rfa agg] iter:  8, prev_obj_val: 84.97288513183594, obj_val: 84.918212890625, abs dis: 0.0546722412109375
[rfa agg] iter: 8, weight: tensor([0.0368, 0.1182, 0.0617, 0.0078, 0.2031, 0.0406, 0.4145, 0.0335, 0.0109,
        0.0729])
[rfa agg] iter:  9, prev_obj_val: 84.918212890625, obj_val: 84.91009521484375, abs dis: 0.00811767578125
[rfa agg] iter: 9, weight: tensor([0.0308, 0.0984, 0.0517, 0.0066, 0.1643, 0.0340, 0.5161, 0.0280, 0.0091,
        0.0611])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3435, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.2866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.58746671676636 sec.
Server Epoch:70 choose agents : [22, 33, 47, 94, 75, 85, 88, 5, 73, 80].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 519/1470 (35.3061%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 887/1470 (60.3401%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4502, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.8802, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1174, Accuracy: 8/134 (5.9701%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1054, Accuracy: 32/134 (23.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3786, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 349/1662 (20.9988%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 626/1662 (37.6655%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1847, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.6176, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   1, Avg loss: 0.0554, Accuracy: 449/1988 (22.5855%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 665/1988 (33.4507%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.0723, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0668, Accuracy: 180/603 (29.8507%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0443, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.8151, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 363/1628 (22.2973%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 827/1628 (50.7985%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.9438, Accuracy: 154/10000 (1.5400%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0640, Accuracy: 171/938 (18.2303%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 323/938 (34.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5394, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   1, Avg loss: 0.0666, Accuracy: 195/682 (28.5924%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   2, Avg loss: 0.0369, Accuracy: 234/682 (34.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.0623, Accuracy: 63/10000 (0.6300%)
time spent on training: 236.02717328071594
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 515, 134, 1662, 776, 1988, 603, 1628, 938, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 33, 47, 94, 75, 85, 88, 5, 73, 80], weight: tensor([0.1414, 0.0495, 0.0129, 0.1599, 0.0746, 0.1912, 0.0580, 0.1566, 0.0902,
        0.0656])
[rfa agg] iter:  0, prev_obj_val: 69.19346618652344, obj_val: 70.49134826660156, abs dis: 1.297882080078125
[rfa agg] iter: 0, weight: tensor([0.2563, 0.0308, 0.0051, 0.1588, 0.0746, 0.0996, 0.0398, 0.1560, 0.1289,
        0.0503])
[rfa agg] iter:  1, prev_obj_val: 70.49134826660156, obj_val: 71.812255859375, abs dis: 1.3209075927734375
[rfa agg] iter: 1, weight: tensor([0.2332, 0.0332, 0.0054, 0.1517, 0.0828, 0.0983, 0.0431, 0.1490, 0.1484,
        0.0548])
[rfa agg] iter:  2, prev_obj_val: 71.812255859375, obj_val: 71.81147766113281, abs dis: 0.0007781982421875
[rfa agg] iter: 2, weight: tensor([0.2106, 0.0354, 0.0056, 0.1436, 0.0914, 0.0959, 0.0463, 0.1410, 0.1710,
        0.0592])
			Update norm = 165.67871180955927 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3435, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.2866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.4284784793854 sec.
Server Epoch:71 choose agents : [7, 79, 81, 44, 17, 9, 21, 95, 51, 70].
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1, Avg loss: 0.0514, Accuracy: 367/891 (41.1897%)
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 453/891 (50.8418%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.9236, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1056, Accuracy: 12/197 (6.0914%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0881, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.4046, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0670, Accuracy: 260/774 (33.5917%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 294/774 (37.9845%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.8974, Accuracy: 68/10000 (0.6800%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 389/1750 (22.2286%)
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 660/1750 (37.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7583, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   1, Avg loss: 0.0521, Accuracy: 392/1574 (24.9047%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 673/1574 (42.7573%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3566, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 369/1275 (28.9412%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 700/1275 (54.9020%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.5033, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 401/1949 (20.5747%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4653, Accuracy: 82/10000 (0.8200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   1, Avg loss: 0.0499, Accuracy: 347/599 (57.9299%)
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.6708, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   1, Avg loss: 0.0586, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   2, Avg loss: 0.0291, Accuracy: 520/1049 (49.5710%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3783, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 352/1418 (24.8237%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 654/1418 (46.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1289, Accuracy: 106/10000 (1.0600%)
time spent on training: 274.14579701423645
[rfa agg] training data poison_ratio: 0.20468804461484838  data num: [891, 197, 774, 1750, 1574, 1275, 1949, 599, 1049, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06396501394214012
[rfa agg] init. name: [7, 79, 81, 44, 17, 9, 21, 95, 51, 70], weight: tensor([0.0776, 0.0172, 0.0674, 0.1525, 0.1372, 0.1111, 0.1698, 0.0522, 0.0914,
        0.1236])
[rfa agg] iter:  0, prev_obj_val: 56.43225860595703, obj_val: 61.04790496826172, abs dis: 4.6156463623046875
[rfa agg] iter: 0, weight: tensor([0.0426, 0.0036, 0.0320, 0.0632, 0.0903, 0.4719, 0.0514, 0.0174, 0.0978,
        0.1299])
[rfa agg] iter:  1, prev_obj_val: 61.04790496826172, obj_val: 64.6004638671875, abs dis: 3.5525588989257812
[rfa agg] iter: 1, weight: tensor([0.0713, 0.0050, 0.0514, 0.0676, 0.0886, 0.2991, 0.0574, 0.0259, 0.2206,
        0.1133])
[rfa agg] iter:  2, prev_obj_val: 64.6004638671875, obj_val: 66.51988220214844, abs dis: 1.9194183349609375
[rfa agg] iter: 2, weight: tensor([0.0837, 0.0050, 0.0578, 0.0566, 0.0711, 0.1686, 0.0491, 0.0271, 0.3948,
        0.0863])
[rfa agg] iter:  3, prev_obj_val: 66.51988220214844, obj_val: 68.80892181396484, abs dis: 2.2890396118164062
[rfa agg] iter: 3, weight: tensor([0.0799, 0.0043, 0.0535, 0.0447, 0.0552, 0.1160, 0.0392, 0.0240, 0.5176,
        0.0656])
[rfa agg] iter:  4, prev_obj_val: 68.80892181396484, obj_val: 71.30012512207031, abs dis: 2.4912033081054688
[rfa agg] iter: 4, weight: tensor([0.1021, 0.0048, 0.0661, 0.0467, 0.0567, 0.1088, 0.0413, 0.0282, 0.4791,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 71.30012512207031, obj_val: 66.53406524658203, abs dis: 4.766059875488281
[rfa agg] iter: 5, weight: tensor([0.1506, 0.0061, 0.0931, 0.0544, 0.0652, 0.1167, 0.0485, 0.0371, 0.3534,
        0.0749])
[rfa agg] iter:  6, prev_obj_val: 66.53406524658203, obj_val: 68.80797576904297, abs dis: 2.2739105224609375
[rfa agg] iter: 6, weight: tensor([0.0827, 0.0044, 0.0551, 0.0459, 0.0567, 0.1189, 0.0402, 0.0247, 0.5041,
        0.0673])
[rfa agg] iter:  7, prev_obj_val: 68.80797576904297, obj_val: 71.29940032958984, abs dis: 2.491424560546875
[rfa agg] iter: 7, weight: tensor([0.1028, 0.0049, 0.0665, 0.0469, 0.0570, 0.1095, 0.0415, 0.0283, 0.4759,
        0.0665])
[rfa agg] iter:  8, prev_obj_val: 71.29940032958984, obj_val: 66.5341796875, abs dis: 4.765220642089844
[rfa agg] iter: 8, weight: tensor([0.1507, 0.0061, 0.0931, 0.0544, 0.0652, 0.1167, 0.0486, 0.0371, 0.3531,
        0.0749])
[rfa agg] iter:  9, prev_obj_val: 66.5341796875, obj_val: 68.80796813964844, abs dis: 2.2737884521484375
[rfa agg] iter: 9, weight: tensor([0.0827, 0.0044, 0.0551, 0.0459, 0.0567, 0.1189, 0.0403, 0.0247, 0.5040,
        0.0674])
			Update norm = 147.8337392245931 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3435, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.2866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 430.13973236083984 sec.
Server Epoch:72 choose agents : [52, 6, 79, 96, 87, 25, 35, 83, 19, 89].
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1, Avg loss: 0.0518, Accuracy: 319/636 (50.1572%)
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2, Avg loss: 0.0291, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.4195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 426/1956 (21.7791%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 645/1956 (32.9755%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7592, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   1, Avg loss: 0.1038, Accuracy: 7/197 (3.5533%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   2, Avg loss: 0.0864, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.4232, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 37/311 (11.8971%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0519, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7064, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0587, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 387/1131 (34.2175%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2317, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   1, Avg loss: 0.0509, Accuracy: 352/690 (51.0145%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   2, Avg loss: 0.0258, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.5256, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   1, Avg loss: 0.0834, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   2, Avg loss: 0.0538, Accuracy: 128/271 (47.2325%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8691, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 409/1953 (20.9421%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 716/1953 (36.6615%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2284, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 396/1036 (38.2239%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 692/1036 (66.7954%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.3637, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   1, Avg loss: 0.0586, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 411/896 (45.8705%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.7276, Accuracy: 53/10000 (0.5300%)
time spent on training: 232.8475468158722
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1956, 197, 311, 1131, 690, 271, 1953, 1036, 896]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 6, 79, 96, 87, 25, 35, 83, 19, 89], weight: tensor([0.0701, 0.2155, 0.0217, 0.0343, 0.1246, 0.0760, 0.0299, 0.2152, 0.1141,
        0.0987])
[rfa agg] iter:  0, prev_obj_val: 76.17208862304688, obj_val: 79.32864379882812, abs dis: 3.15655517578125
[rfa agg] iter: 0, weight: tensor([0.0298, 0.0624, 0.0054, 0.0092, 0.4676, 0.0367, 0.0080, 0.0623, 0.2400,
        0.0786])
[rfa agg] iter:  1, prev_obj_val: 79.32864379882812, obj_val: 82.25609588623047, abs dis: 2.9274520874023438
[rfa agg] iter: 1, weight: tensor([0.0446, 0.0553, 0.0070, 0.0120, 0.2329, 0.0581, 0.0105, 0.0552, 0.3493,
        0.1753])
[rfa agg] iter:  2, prev_obj_val: 82.25609588623047, obj_val: 83.79097747802734, abs dis: 1.534881591796875
[rfa agg] iter: 2, weight: tensor([0.0571, 0.0554, 0.0081, 0.0141, 0.1661, 0.0773, 0.0123, 0.0553, 0.2249,
        0.3296])
[rfa agg] iter:  3, prev_obj_val: 83.79097747802734, obj_val: 85.49504089355469, abs dis: 1.7040634155273438
[rfa agg] iter: 3, weight: tensor([0.0546, 0.0463, 0.0073, 0.0128, 0.1233, 0.0760, 0.0112, 0.0463, 0.1558,
        0.4665])
[rfa agg] iter:  4, prev_obj_val: 85.49504089355469, obj_val: 87.6357192993164, abs dis: 2.1406784057617188
[rfa agg] iter: 4, weight: tensor([0.0467, 0.0343, 0.0059, 0.0103, 0.0826, 0.0671, 0.0090, 0.0343, 0.0996,
        0.6102])
[rfa agg] iter:  5, prev_obj_val: 87.6357192993164, obj_val: 85.46924591064453, abs dis: 2.166473388671875
[rfa agg] iter: 5, weight: tensor([0.0633, 0.0398, 0.0074, 0.0130, 0.0877, 0.0947, 0.0113, 0.0398, 0.1023,
        0.5407])
[rfa agg] iter:  6, prev_obj_val: 85.46924591064453, obj_val: 90.00543212890625, abs dis: 4.536186218261719
[rfa agg] iter: 6, weight: tensor([0.0418, 0.0307, 0.0053, 0.0092, 0.0737, 0.0600, 0.0080, 0.0307, 0.0886,
        0.6519])
[rfa agg] iter:  7, prev_obj_val: 90.00543212890625, obj_val: 87.6416244506836, abs dis: 2.3638076782226562
[rfa agg] iter: 7, weight: tensor([0.0943, 0.0498, 0.0100, 0.0178, 0.1020, 0.1487, 0.0155, 0.0498, 0.1159,
        0.3962])
[rfa agg] iter:  8, prev_obj_val: 87.6416244506836, obj_val: 87.63115692138672, abs dis: 0.010467529296875
[rfa agg] iter: 8, weight: tensor([0.0689, 0.0431, 0.0080, 0.0141, 0.0954, 0.1038, 0.0123, 0.0431, 0.1113,
        0.5000])
[rfa agg] iter:  9, prev_obj_val: 87.63115692138672, obj_val: 87.63072967529297, abs dis: 0.00042724609375
[rfa agg] iter: 9, weight: tensor([0.0662, 0.0415, 0.0077, 0.0136, 0.0916, 0.0993, 0.0118, 0.0414, 0.1068,
        0.5201])
			Update norm = 121.0257026549526 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3435, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.2866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.8352062702179 sec.
Server Epoch:73 choose agents : [33, 18, 68, 97, 36, 30, 4, 67, 23, 21].
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0771, Accuracy: 81/515 (15.7282%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4441, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   1, Avg loss: 0.0668, Accuracy: 172/530 (32.4528%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3657, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   1, Avg loss: 0.0616, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   2, Avg loss: 0.0369, Accuracy: 468/1163 (40.2408%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1841, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1, Avg loss: 0.0503, Accuracy: 364/1213 (30.0082%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 531/1213 (43.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.7465, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0835, Accuracy: 90/408 (22.0588%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0508, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1448, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   1, Avg loss: 0.0724, Accuracy: 108/486 (22.2222%)
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   2, Avg loss: 0.0393, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.9500, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0584, Accuracy: 340/901 (37.7358%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 420/901 (46.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.7111, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   1, Avg loss: 0.0729, Accuracy: 64/426 (15.0235%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   2, Avg loss: 0.0389, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4150, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   1, Avg loss: 0.0614, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1300, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 391/1949 (20.0616%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 633/1949 (32.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.0311, Accuracy: 92/10000 (0.9200%)
time spent on training: 231.01894116401672
[rfa agg] training data poison_ratio: 0.05851191909463039  data num: [515, 530, 1163, 1213, 408, 486, 901, 426, 715, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.018284974717071998
[rfa agg] init. name: [33, 18, 68, 97, 36, 30, 4, 67, 23, 21], weight: tensor([0.0620, 0.0638, 0.1400, 0.1460, 0.0491, 0.0585, 0.1085, 0.0513, 0.0861,
        0.2346])
[rfa agg] iter:  0, prev_obj_val: 64.40591430664062, obj_val: 67.77302551269531, abs dis: 3.3671112060546875
[rfa agg] iter: 0, weight: tensor([0.0352, 0.0363, 0.1450, 0.1504, 0.0214, 0.0289, 0.4157, 0.0223, 0.0889,
        0.0560])
[rfa agg] iter:  1, prev_obj_val: 67.77302551269531, obj_val: 68.91561126708984, abs dis: 1.1425857543945312
[rfa agg] iter: 1, weight: tensor([0.0574, 0.0594, 0.1064, 0.1108, 0.0318, 0.0447, 0.2884, 0.0332, 0.2115,
        0.0565])
[rfa agg] iter:  2, prev_obj_val: 68.91561126708984, obj_val: 71.51693725585938, abs dis: 2.6013259887695312
[rfa agg] iter: 2, weight: tensor([0.0632, 0.0654, 0.0957, 0.0996, 0.0337, 0.0481, 0.2136, 0.0352, 0.2917,
        0.0538])
[rfa agg] iter:  3, prev_obj_val: 71.51693725585938, obj_val: 75.04281616210938, abs dis: 3.52587890625
[rfa agg] iter: 3, weight: tensor([0.0664, 0.0689, 0.0655, 0.0681, 0.0322, 0.0477, 0.1158, 0.0336, 0.4612,
        0.0406])
[rfa agg] iter:  4, prev_obj_val: 75.04281616210938, obj_val: 76.92906951904297, abs dis: 1.8862533569335938
[rfa agg] iter: 4, weight: tensor([0.1145, 0.1194, 0.0680, 0.0708, 0.0475, 0.0747, 0.1036, 0.0497, 0.3059,
        0.0458])
[rfa agg] iter:  5, prev_obj_val: 76.92906951904297, obj_val: 83.14212036132812, abs dis: 6.213050842285156
[rfa agg] iter: 5, weight: tensor([0.1516, 0.1600, 0.0651, 0.0678, 0.0551, 0.0910, 0.0941, 0.0576, 0.2123,
        0.0453])
[rfa agg] iter:  6, prev_obj_val: 83.14212036132812, obj_val: 92.42514038085938, abs dis: 9.28302001953125
[rfa agg] iter: 6, weight: tensor([0.2458, 0.3242, 0.0321, 0.0334, 0.0551, 0.1217, 0.0412, 0.0575, 0.0644,
        0.0245])
[rfa agg] iter:  7, prev_obj_val: 92.42514038085938, obj_val: 96.10596466064453, abs dis: 3.6808242797851562
[rfa agg] iter: 7, weight: tensor([0.1006, 0.1065, 0.0312, 0.0326, 0.1978, 0.2249, 0.0370, 0.1952, 0.0485,
        0.0257])
[rfa agg] iter:  8, prev_obj_val: 96.10596466064453, obj_val: 104.72930145263672, abs dis: 8.623336791992188
[rfa agg] iter: 8, weight: tensor([0.0638, 0.0672, 0.0251, 0.0261, 0.3138, 0.1188, 0.0290, 0.2986, 0.0366,
        0.0210])
[rfa agg] iter:  9, prev_obj_val: 104.72930145263672, obj_val: 92.38386535644531, abs dis: 12.345436096191406
[rfa agg] iter: 9, weight: tensor([0.0906, 0.0944, 0.0482, 0.0502, 0.2106, 0.1286, 0.0538, 0.2180, 0.0637,
        0.0420])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.53372383117676 sec.
Server Epoch:74 choose agents : [28, 44, 36, 74, 4, 77, 86, 13, 63, 93].
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 366/1581 (23.1499%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 575/1581 (36.3694%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9957, Accuracy: 94/10000 (0.9400%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 389/1750 (22.2286%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 668/1750 (38.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6560, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   1, Avg loss: 0.0809, Accuracy: 104/408 (25.4902%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   2, Avg loss: 0.0519, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.0133, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 455/1552 (29.3170%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 783/1552 (50.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.5792, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0559, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0309, Accuracy: 463/901 (51.3873%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1836, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   1, Avg loss: 0.0517, Accuracy: 339/1340 (25.2985%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 561/1340 (41.8657%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.7110, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 356/1003 (35.4935%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 394/1003 (39.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.0890, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 322/1645 (19.5745%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 632/1645 (38.4195%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.7255, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0532, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.2822, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 685/1742 (39.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3725, Accuracy: 87/10000 (0.8700%)
time spent on training: 301.1710674762726
[rfa agg] training data poison_ratio: 0.2577673692427791  data num: [1581, 1750, 408, 1552, 901, 1340, 1003, 1645, 888, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.08055230288836847
[rfa agg] init. name: [28, 44, 36, 74, 4, 77, 86, 13, 63, 93], weight: tensor([0.1234, 0.1366, 0.0319, 0.1212, 0.0703, 0.1046, 0.0783, 0.1284, 0.0693,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 50.48289489746094, obj_val: 52.46458435058594, abs dis: 1.981689453125
[rfa agg] iter: 0, weight: tensor([0.1036, 0.0698, 0.0091, 0.1008, 0.0488, 0.4028, 0.0659, 0.0888, 0.0409,
        0.0694])
[rfa agg] iter:  1, prev_obj_val: 52.46458435058594, obj_val: 56.835411071777344, abs dis: 4.370826721191406
[rfa agg] iter: 1, weight: tensor([0.1009, 0.0706, 0.0102, 0.0986, 0.0578, 0.3764, 0.0794, 0.0880, 0.0478,
        0.0704])
[rfa agg] iter:  2, prev_obj_val: 56.835411071777344, obj_val: 54.63023376464844, abs dis: 2.2051773071289062
[rfa agg] iter: 2, weight: tensor([0.1031, 0.0766, 0.0135, 0.1008, 0.0872, 0.2542, 0.1265, 0.0923, 0.0696,
        0.0763])
[rfa agg] iter:  3, prev_obj_val: 54.63023376464844, obj_val: 52.46894454956055, abs dis: 2.1612892150878906
[rfa agg] iter: 3, weight: tensor([0.1053, 0.0761, 0.0121, 0.1028, 0.0732, 0.2987, 0.1035, 0.0931, 0.0595,
        0.0757])
[rfa agg] iter:  4, prev_obj_val: 52.46894454956055, obj_val: 50.368736267089844, abs dis: 2.100208282470703
[rfa agg] iter: 4, weight: tensor([0.1027, 0.0718, 0.0104, 0.1002, 0.0588, 0.3656, 0.0810, 0.0895, 0.0486,
        0.0715])
[rfa agg] iter:  5, prev_obj_val: 50.368736267089844, obj_val: 52.47044372558594, abs dis: 2.1017074584960938
[rfa agg] iter: 5, weight: tensor([0.0937, 0.0632, 0.0083, 0.0914, 0.0442, 0.4591, 0.0596, 0.0804, 0.0371,
        0.0629])
[rfa agg] iter:  6, prev_obj_val: 52.47044372558594, obj_val: 56.83660888671875, abs dis: 4.3661651611328125
[rfa agg] iter: 6, weight: tensor([0.0999, 0.0700, 0.0101, 0.0976, 0.0572, 0.3821, 0.0786, 0.0872, 0.0473,
        0.0698])
[rfa agg] iter:  7, prev_obj_val: 56.83660888671875, obj_val: 54.63022232055664, abs dis: 2.2063865661621094
[rfa agg] iter: 7, weight: tensor([0.1030, 0.0766, 0.0135, 0.1008, 0.0872, 0.2543, 0.1264, 0.0922, 0.0696,
        0.0763])
[rfa agg] iter:  8, prev_obj_val: 54.63022232055664, obj_val: 52.46894454956055, abs dis: 2.1612777709960938
[rfa agg] iter: 8, weight: tensor([0.1053, 0.0761, 0.0121, 0.1028, 0.0732, 0.2987, 0.1035, 0.0931, 0.0595,
        0.0757])
[rfa agg] iter:  9, prev_obj_val: 52.46894454956055, obj_val: 50.368736267089844, abs dis: 2.100208282470703
[rfa agg] iter: 9, weight: tensor([0.1027, 0.0718, 0.0104, 0.1002, 0.0588, 0.3656, 0.0810, 0.0895, 0.0486,
        0.0715])
			Update norm = 183.5371109442175 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 459.8766508102417 sec.
Server Epoch:75 choose agents : [9, 40, 44, 67, 53, 47, 1, 98, 99, 57].
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 385/1275 (30.1961%)
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2, Avg loss: 0.0186, Accuracy: 788/1275 (61.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.5484, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 382/1573 (24.2848%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 604/1573 (38.3980%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6811, Accuracy: 83/10000 (0.8300%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 411/1750 (23.4857%)
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 668/1750 (38.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5021, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   1, Avg loss: 0.0705, Accuracy: 87/426 (20.4225%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   2, Avg loss: 0.0379, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.5328, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   1, Avg loss: 0.0476, Accuracy: 290/813 (35.6704%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 474/813 (58.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.7787, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   1, Avg loss: 0.1200, Accuracy: 4/134 (2.9851%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   2, Avg loss: 0.1046, Accuracy: 31/134 (23.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3794, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0556, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 579/928 (62.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.5558, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   1, Avg loss: 0.0761, Accuracy: 66/373 (17.6944%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   2, Avg loss: 0.0454, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.0860, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   1, Avg loss: 0.0615, Accuracy: 194/773 (25.0970%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.5757, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 517/1154 (44.8007%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.9348, Accuracy: 64/10000 (0.6400%)
time spent on training: 240.05817437171936
[rfa agg] training data poison_ratio: 0.19023806935536472  data num: [1275, 1573, 1750, 426, 813, 134, 928, 373, 773, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.05944939667355147
[rfa agg] init. name: [9, 40, 44, 67, 53, 47, 1, 98, 99, 57], weight: tensor([0.1386, 0.1710, 0.1902, 0.0463, 0.0884, 0.0146, 0.1009, 0.0405, 0.0840,
        0.1254])
[rfa agg] iter:  0, prev_obj_val: 55.582706451416016, obj_val: 56.65418243408203, abs dis: 1.0714759826660156
[rfa agg] iter: 0, weight: tensor([0.1876, 0.0890, 0.0721, 0.0193, 0.0911, 0.0044, 0.1940, 0.0154, 0.0865,
        0.2407])
[rfa agg] iter:  1, prev_obj_val: 56.65418243408203, obj_val: 59.05024337768555, abs dis: 2.3960609436035156
[rfa agg] iter: 1, weight: tensor([0.1607, 0.0829, 0.0682, 0.0202, 0.1025, 0.0045, 0.2482, 0.0160, 0.0974,
        0.1995])
[rfa agg] iter:  2, prev_obj_val: 59.05024337768555, obj_val: 62.20072937011719, abs dis: 3.1504859924316406
[rfa agg] iter: 2, weight: tensor([0.1042, 0.0614, 0.0520, 0.0186, 0.1165, 0.0040, 0.3978, 0.0146, 0.1108,
        0.1200])
[rfa agg] iter:  3, prev_obj_val: 62.20072937011719, obj_val: 62.194881439208984, abs dis: 0.005847930908203125
[rfa agg] iter: 3, weight: tensor([0.0752, 0.0490, 0.0424, 0.0186, 0.1593, 0.0038, 0.4029, 0.0144, 0.1517,
        0.0826])
[rfa agg] iter:  4, prev_obj_val: 62.194881439208984, obj_val: 64.20318603515625, abs dis: 2.0083045959472656
[rfa agg] iter: 4, weight: tensor([0.0750, 0.0488, 0.0423, 0.0185, 0.1602, 0.0038, 0.4022, 0.0143, 0.1525,
        0.0823])
[rfa agg] iter:  5, prev_obj_val: 64.20318603515625, obj_val: 68.78395080566406, abs dis: 4.5807647705078125
[rfa agg] iter: 5, weight: tensor([0.0720, 0.0487, 0.0426, 0.0207, 0.2264, 0.0042, 0.2761, 0.0159, 0.2157,
        0.0777])
[rfa agg] iter:  6, prev_obj_val: 68.78395080566406, obj_val: 75.14598846435547, abs dis: 6.362037658691406
[rfa agg] iter: 6, weight: tensor([0.0484, 0.0350, 0.0311, 0.0189, 0.3496, 0.0036, 0.1174, 0.0142, 0.3308,
        0.0509])
[rfa agg] iter:  7, prev_obj_val: 75.14598846435547, obj_val: 71.76422882080078, abs dis: 3.3817596435546875
[rfa agg] iter: 7, weight: tensor([0.0656, 0.0499, 0.0451, 0.0350, 0.2993, 0.0061, 0.1230, 0.0256, 0.2826,
        0.0676])
[rfa agg] iter:  8, prev_obj_val: 71.76422882080078, obj_val: 71.76010131835938, abs dis: 0.00412750244140625
[rfa agg] iter: 8, weight: tensor([0.0524, 0.0389, 0.0349, 0.0239, 0.3435, 0.0044, 0.1090, 0.0177, 0.3207,
        0.0545])
[rfa agg] iter:  9, prev_obj_val: 71.76010131835938, obj_val: 68.70173645019531, abs dis: 3.0583648681640625
[rfa agg] iter: 9, weight: tensor([0.0516, 0.0384, 0.0344, 0.0236, 0.3468, 0.0043, 0.1072, 0.0175, 0.3225,
        0.0537])
			Update norm = 116.51391413689612 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 403.12551379203796 sec.
Server Epoch:76 choose agents : [93, 69, 79, 90, 4, 59, 86, 13, 22, 68].
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 428/1742 (24.5695%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 747/1742 (42.8817%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4882, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1, Avg loss: 0.0567, Accuracy: 311/590 (52.7119%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.5692, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   1, Avg loss: 0.1040, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   2, Avg loss: 0.0862, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.4076, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   1, Avg loss: 0.0554, Accuracy: 324/677 (47.8582%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8801, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0587, Accuracy: 340/901 (37.7358%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 408/901 (45.2830%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7289, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 286/1089 (26.2626%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   2, Avg loss: 0.0332, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.9482, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 390/1003 (38.8833%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.1480, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 321/1645 (19.5137%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 658/1645 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3773, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 478/1470 (32.5170%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 859/1470 (58.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8677, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 464/1163 (39.8968%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.3214, Accuracy: 66/10000 (0.6600%)
time spent on training: 230.1194875240326
[rfa agg] training data poison_ratio: 0.0  data num: [1742, 590, 197, 677, 901, 1089, 1003, 1645, 1470, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [93, 69, 79, 90, 4, 59, 86, 13, 22, 68], weight: tensor([0.1663, 0.0563, 0.0188, 0.0646, 0.0860, 0.1039, 0.0957, 0.1570, 0.1403,
        0.1110])
[rfa agg] iter:  0, prev_obj_val: 48.73066711425781, obj_val: 50.683258056640625, abs dis: 1.9525909423828125
[rfa agg] iter: 0, weight: tensor([0.0504, 0.0191, 0.0037, 0.0248, 0.0687, 0.2611, 0.1064, 0.0601, 0.0885,
        0.3171])
[rfa agg] iter:  1, prev_obj_val: 50.683258056640625, obj_val: 55.651763916015625, abs dis: 4.968505859375
[rfa agg] iter: 1, weight: tensor([0.0469, 0.0222, 0.0041, 0.0294, 0.0949, 0.3060, 0.1692, 0.0545, 0.0746,
        0.1981])
[rfa agg] iter:  2, prev_obj_val: 55.651763916015625, obj_val: 60.40257263183594, abs dis: 4.7508087158203125
[rfa agg] iter: 2, weight: tensor([0.0387, 0.0261, 0.0044, 0.0359, 0.1726, 0.1352, 0.3882, 0.0437, 0.0555,
        0.0996])
[rfa agg] iter:  3, prev_obj_val: 60.40257263183594, obj_val: 60.35041046142578, abs dis: 0.05216217041015625
[rfa agg] iter: 3, weight: tensor([0.0401, 0.0352, 0.0054, 0.0503, 0.3110, 0.1037, 0.2699, 0.0447, 0.0547,
        0.0850])
[rfa agg] iter:  4, prev_obj_val: 60.35041046142578, obj_val: 60.3445930480957, abs dis: 0.005817413330078125
[rfa agg] iter: 4, weight: tensor([0.0380, 0.0334, 0.0051, 0.0476, 0.3609, 0.0977, 0.2427, 0.0424, 0.0519,
        0.0805])
[rfa agg] iter:  5, prev_obj_val: 60.3445930480957, obj_val: 60.34368133544922, abs dis: 0.000911712646484375
[rfa agg] iter: 5, weight: tensor([0.0371, 0.0326, 0.0050, 0.0465, 0.3804, 0.0952, 0.2328, 0.0413, 0.0506,
        0.0785])
[rfa agg] iter:  6, prev_obj_val: 60.34368133544922, obj_val: 60.34352111816406, abs dis: 0.00016021728515625
[rfa agg] iter: 6, weight: tensor([0.0367, 0.0322, 0.0049, 0.0460, 0.3885, 0.0941, 0.2288, 0.0409, 0.0501,
        0.0777])
			Update norm = 134.38574084980146 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.2947356700897 sec.
Server Epoch:77 choose agents : [5, 77, 11, 59, 88, 41, 18, 93, 98, 37].
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 390/1628 (23.9558%)
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   2, Avg loss: 0.0247, Accuracy: 870/1628 (53.4398%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7759, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   1, Avg loss: 0.0514, Accuracy: 342/1340 (25.5224%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 539/1340 (40.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.5832, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1, Avg loss: 0.0537, Accuracy: 337/712 (47.3315%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0035, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 491/1089 (45.0872%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6615, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0665, Accuracy: 185/603 (30.6799%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.9636, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   1, Avg loss: 0.0566, Accuracy: 350/719 (48.6787%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.5081, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   1, Avg loss: 0.0666, Accuracy: 171/530 (32.2642%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   2, Avg loss: 0.0347, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4886, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 431/1742 (24.7417%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 669/1742 (38.4041%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.7500, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0757, Accuracy: 72/373 (19.3029%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0449, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.9873, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 386/1129 (34.1895%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 732/1129 (64.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8875, Accuracy: 119/10000 (1.1900%)
time spent on training: 253.66123366355896
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1340, 712, 1089, 603, 719, 530, 1742, 373, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 77, 11, 59, 88, 41, 18, 93, 98, 37], weight: tensor([0.1650, 0.1358, 0.0722, 0.1104, 0.0611, 0.0729, 0.0537, 0.1766, 0.0378,
        0.1144])
[rfa agg] iter:  0, prev_obj_val: 59.790748596191406, obj_val: 65.05415344238281, abs dis: 5.263404846191406
[rfa agg] iter: 0, weight: tensor([0.0759, 0.1235, 0.0822, 0.2308, 0.0467, 0.0827, 0.0353, 0.0678, 0.0174,
        0.2378])
[rfa agg] iter:  1, prev_obj_val: 65.05415344238281, obj_val: 68.67093658447266, abs dis: 3.6167831420898438
[rfa agg] iter: 1, weight: tensor([0.0738, 0.1068, 0.1438, 0.1586, 0.0693, 0.1435, 0.0500, 0.0674, 0.0229,
        0.1640])
[rfa agg] iter:  2, prev_obj_val: 68.67093658447266, obj_val: 70.51626586914062, abs dis: 1.8453292846679688
[rfa agg] iter: 2, weight: tensor([0.0612, 0.0837, 0.2077, 0.1121, 0.0799, 0.2047, 0.0549, 0.0565, 0.0234,
        0.1160])
[rfa agg] iter:  3, prev_obj_val: 70.51626586914062, obj_val: 74.64839172363281, abs dis: 4.1321258544921875
[rfa agg] iter: 3, weight: tensor([0.0509, 0.0678, 0.2546, 0.0873, 0.0802, 0.2468, 0.0532, 0.0472, 0.0217,
        0.0903])
[rfa agg] iter:  4, prev_obj_val: 74.64839172363281, obj_val: 83.49874877929688, abs dis: 8.850357055664062
[rfa agg] iter: 4, weight: tensor([0.0303, 0.0387, 0.3604, 0.0468, 0.0750, 0.3109, 0.0450, 0.0284, 0.0162,
        0.0485])
[rfa agg] iter:  5, prev_obj_val: 83.49874877929688, obj_val: 74.69783782958984, abs dis: 8.800910949707031
[rfa agg] iter: 5, weight: tensor([0.0395, 0.0479, 0.1710, 0.0542, 0.2731, 0.1691, 0.1206, 0.0375, 0.0310,
        0.0562])
[rfa agg] iter:  6, prev_obj_val: 74.69783782958984, obj_val: 83.49372100830078, abs dis: 8.795883178710938
[rfa agg] iter: 6, weight: tensor([0.0320, 0.0408, 0.3528, 0.0494, 0.0806, 0.2986, 0.0476, 0.0300, 0.0171,
        0.0511])
[rfa agg] iter:  7, prev_obj_val: 83.49372100830078, obj_val: 74.69840240478516, abs dis: 8.795318603515625
[rfa agg] iter: 7, weight: tensor([0.0394, 0.0478, 0.1707, 0.0541, 0.2745, 0.1685, 0.1205, 0.0374, 0.0310,
        0.0561])
[rfa agg] iter:  8, prev_obj_val: 74.69840240478516, obj_val: 83.4936752319336, abs dis: 8.795272827148438
[rfa agg] iter: 8, weight: tensor([0.0320, 0.0408, 0.3527, 0.0494, 0.0807, 0.2985, 0.0476, 0.0300, 0.0171,
        0.0512])
[rfa agg] iter:  9, prev_obj_val: 83.4936752319336, obj_val: 74.69841003417969, abs dis: 8.795265197753906
[rfa agg] iter: 9, weight: tensor([0.0394, 0.0478, 0.1707, 0.0541, 0.2745, 0.1685, 0.1205, 0.0374, 0.0310,
        0.0561])
			Update norm = 107.54282849608104 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.885174036026 sec.
Server Epoch:78 choose agents : [65, 18, 30, 33, 53, 94, 76, 64, 0, 29].
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   1, Avg loss: 0.0550, Accuracy: 396/1475 (26.8475%)
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 685/1475 (46.4407%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.4651, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0652, Accuracy: 171/530 (32.2642%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7070, Accuracy: 67/10000 (0.6700%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0713, Accuracy: 118/486 (24.2798%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0381, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.7167, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 83/515 (16.1165%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 142/515 (27.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.5606, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   1, Avg loss: 0.0475, Accuracy: 303/813 (37.2694%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 476/813 (58.5486%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.6115, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1, Avg loss: 0.0563, Accuracy: 324/1662 (19.4946%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 617/1662 (37.1239%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.1476, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/466 (13.7339%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.8994, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 181/953 (18.9927%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 324/953 (33.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.1550, Accuracy: 69/10000 (0.6900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 330/1657 (19.9155%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 559/1657 (33.7357%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4735, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 430/1440 (29.8611%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 660/1440 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5891, Accuracy: 85/10000 (0.8500%)
time spent on training: 256.43375301361084
[rfa agg] training data poison_ratio: 0.21436430929278782  data num: [1475, 530, 486, 515, 813, 1662, 466, 953, 1657, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0669888466539962
[rfa agg] init. name: [65, 18, 30, 33, 53, 94, 76, 64, 0, 29], weight: tensor([0.1475, 0.0530, 0.0486, 0.0515, 0.0813, 0.1662, 0.0466, 0.0953, 0.1657,
        0.1440])
[rfa agg] iter:  0, prev_obj_val: 65.07776641845703, obj_val: 68.6910400390625, abs dis: 3.6132736206054688
[rfa agg] iter: 0, weight: tensor([0.1070, 0.0387, 0.0313, 0.0376, 0.1253, 0.0956, 0.0300, 0.3187, 0.0953,
        0.1205])
[rfa agg] iter:  1, prev_obj_val: 68.6910400390625, obj_val: 72.33055877685547, abs dis: 3.6395187377929688
[rfa agg] iter: 1, weight: tensor([0.0492, 0.0266, 0.0209, 0.0258, 0.1180, 0.0455, 0.0200, 0.5947, 0.0453,
        0.0541])
[rfa agg] iter:  2, prev_obj_val: 72.33055877685547, obj_val: 78.90209197998047, abs dis: 6.571533203125
[rfa agg] iter: 2, weight: tensor([0.0571, 0.0410, 0.0314, 0.0398, 0.2726, 0.0538, 0.0301, 0.3585, 0.0536,
        0.0620])
[rfa agg] iter:  3, prev_obj_val: 78.90209197998047, obj_val: 78.86876678466797, abs dis: 0.0333251953125
[rfa agg] iter: 3, weight: tensor([0.0495, 0.0580, 0.0416, 0.0562, 0.4607, 0.0477, 0.0398, 0.1459, 0.0475,
        0.0530])
[rfa agg] iter:  4, prev_obj_val: 78.86876678466797, obj_val: 81.51382446289062, abs dis: 2.6450576782226562
[rfa agg] iter: 4, weight: tensor([0.0467, 0.0548, 0.0393, 0.0531, 0.4927, 0.0449, 0.0376, 0.1361, 0.0448,
        0.0500])
[rfa agg] iter:  5, prev_obj_val: 81.51382446289062, obj_val: 84.1727066040039, abs dis: 2.6588821411132812
[rfa agg] iter: 5, weight: tensor([0.0568, 0.0806, 0.0559, 0.0780, 0.3598, 0.0550, 0.0535, 0.1449, 0.0548,
        0.0606])
[rfa agg] iter:  6, prev_obj_val: 84.1727066040039, obj_val: 78.88937377929688, abs dis: 5.283332824707031
[rfa agg] iter: 6, weight: tensor([0.0606, 0.1070, 0.0708, 0.1033, 0.2700, 0.0589, 0.0677, 0.1386, 0.0588,
        0.0643])
[rfa agg] iter:  7, prev_obj_val: 78.88937377929688, obj_val: 76.36918640136719, abs dis: 2.5201873779296875
[rfa agg] iter: 7, weight: tensor([0.0493, 0.0579, 0.0414, 0.0561, 0.4647, 0.0474, 0.0397, 0.1436, 0.0472,
        0.0527])
[rfa agg] iter:  8, prev_obj_val: 76.36918640136719, obj_val: 84.21302795410156, abs dis: 7.843841552734375
[rfa agg] iter: 8, weight: tensor([0.0346, 0.0341, 0.0251, 0.0330, 0.6269, 0.0331, 0.0240, 0.1190, 0.0330,
        0.0372])
[rfa agg] iter:  9, prev_obj_val: 84.21302795410156, obj_val: 78.8885269165039, abs dis: 5.324501037597656
[rfa agg] iter: 9, weight: tensor([0.0603, 0.1058, 0.0703, 0.1022, 0.2750, 0.0587, 0.0672, 0.1378, 0.0585,
        0.0641])
			Update norm = 112.0168836674298 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.3110091686249 sec.
Server Epoch:79 choose agents : [1, 68, 51, 81, 10, 38, 27, 94, 19, 98].
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 596/928 (64.2241%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7387, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   1, Avg loss: 0.0612, Accuracy: 379/1163 (32.5881%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   2, Avg loss: 0.0359, Accuracy: 514/1163 (44.1960%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5758, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0592, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 534/1049 (50.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2186, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 240/774 (31.0078%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   2, Avg loss: 0.0345, Accuracy: 310/774 (40.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.3453, Accuracy: 79/10000 (0.7900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   1, Avg loss: 0.0560, Accuracy: 218/861 (25.3194%)
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 419/861 (48.6643%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.2905, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 264/1131 (23.3422%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 502/1131 (44.3855%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1062, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 413/1587 (26.0239%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 607/1587 (38.2483%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0588, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0562, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 623/1662 (37.4850%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7752, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 415/1036 (40.0579%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 692/1036 (66.7954%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.7488, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0757, Accuracy: 66/373 (17.6944%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0460, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0692, Accuracy: 50/10000 (0.5000%)
time spent on training: 283.2110450267792
[rfa agg] training data poison_ratio: 0.0815032184778493  data num: [928, 1163, 1049, 774, 861, 1131, 1587, 1662, 1036, 373]
[rfa agg] considering poison per batch poison_fraction: 0.025469755774327908
[rfa agg] init. name: [1, 68, 51, 81, 10, 38, 27, 94, 19, 98], weight: tensor([0.0878, 0.1101, 0.0993, 0.0733, 0.0815, 0.1071, 0.1502, 0.1573, 0.0981,
        0.0353])
[rfa agg] iter:  0, prev_obj_val: 39.89591598510742, obj_val: 43.44968795776367, abs dis: 3.55377197265625
[rfa agg] iter: 0, weight: tensor([0.1196, 0.0961, 0.2071, 0.0472, 0.0716, 0.1443, 0.0405, 0.0380, 0.2280,
        0.0077])
[rfa agg] iter:  1, prev_obj_val: 43.44968795776367, obj_val: 51.04751968383789, abs dis: 7.597831726074219
[rfa agg] iter: 1, weight: tensor([0.2430, 0.0778, 0.1454, 0.0715, 0.1224, 0.1041, 0.0401, 0.0380, 0.1481,
        0.0095])
[rfa agg] iter:  2, prev_obj_val: 51.04751968383789, obj_val: 57.79308319091797, abs dis: 6.745563507080078
[rfa agg] iter: 2, weight: tensor([0.1916, 0.0565, 0.0824, 0.1547, 0.2833, 0.0683, 0.0355, 0.0341, 0.0822,
        0.0115])
[rfa agg] iter:  3, prev_obj_val: 57.79308319091797, obj_val: 57.75069808959961, abs dis: 0.042385101318359375
[rfa agg] iter: 3, weight: tensor([0.1225, 0.0537, 0.0713, 0.3257, 0.2059, 0.0624, 0.0369, 0.0357, 0.0709,
        0.0149])
[rfa agg] iter:  4, prev_obj_val: 57.75069808959961, obj_val: 57.74605178833008, abs dis: 0.00464630126953125
[rfa agg] iter: 4, weight: tensor([0.1125, 0.0497, 0.0660, 0.3827, 0.1846, 0.0578, 0.0342, 0.0331, 0.0657,
        0.0138])
[rfa agg] iter:  5, prev_obj_val: 57.74605178833008, obj_val: 57.74530792236328, abs dis: 0.000743865966796875
[rfa agg] iter: 5, weight: tensor([0.1086, 0.0481, 0.0638, 0.4051, 0.1764, 0.0560, 0.0331, 0.0320, 0.0635,
        0.0133])
[rfa agg] iter:  6, prev_obj_val: 57.74530792236328, obj_val: 61.607940673828125, abs dis: 3.8626327514648438
[rfa agg] iter: 6, weight: tensor([0.1069, 0.0474, 0.0629, 0.4145, 0.1731, 0.0552, 0.0326, 0.0316, 0.0626,
        0.0132])
[rfa agg] iter:  7, prev_obj_val: 61.607940673828125, obj_val: 51.05140686035156, abs dis: 10.556533813476562
[rfa agg] iter: 7, weight: tensor([0.1122, 0.0561, 0.0720, 0.3628, 0.1638, 0.0643, 0.0401, 0.0389, 0.0716,
        0.0181])
[rfa agg] iter:  8, prev_obj_val: 51.05140686035156, obj_val: 54.22993087768555, abs dis: 3.1785240173339844
[rfa agg] iter: 8, weight: tensor([0.1782, 0.0556, 0.0804, 0.1687, 0.2899, 0.0671, 0.0349, 0.0335, 0.0805,
        0.0113])
[rfa agg] iter:  9, prev_obj_val: 54.22993087768555, obj_val: 54.22344970703125, abs dis: 0.006481170654296875
[rfa agg] iter: 9, weight: tensor([0.1414, 0.0529, 0.0730, 0.2379, 0.2785, 0.0625, 0.0348, 0.0336, 0.0729,
        0.0126])
			Update norm = 120.96675195327434 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 440.4489440917969 sec.
Server Epoch:80 choose agents : [75, 36, 16, 74, 20, 26, 57, 91, 19, 56].
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0657, Accuracy: 257/776 (33.1186%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.2889, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   1, Avg loss: 0.0812, Accuracy: 103/408 (25.2451%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   2, Avg loss: 0.0510, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.2511, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   1, Avg loss: 0.0632, Accuracy: 291/708 (41.1017%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.3383, Accuracy: 54/10000 (0.5400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 515/1552 (33.1830%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 763/1552 (49.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.5406, Accuracy: 88/10000 (0.8800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 322/807 (39.9009%)
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5093, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   1, Avg loss: 0.0554, Accuracy: 340/1446 (23.5131%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5883, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   1, Avg loss: 0.0566, Accuracy: 299/1154 (25.9099%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   2, Avg loss: 0.0245, Accuracy: 515/1154 (44.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.7591, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0506, Accuracy: 348/1030 (33.7864%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 630/1030 (61.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.5340, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 399/1036 (38.5135%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 655/1036 (63.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.9628, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   1, Avg loss: 0.0840, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   2, Avg loss: 0.0683, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3959, Accuracy: 50/10000 (0.5000%)
time spent on training: 263.0247404575348
[rfa agg] training data poison_ratio: 0.2591453367021861  data num: [776, 408, 708, 1552, 807, 1446, 1154, 1030, 1036, 186]
[rfa agg] considering poison per batch poison_fraction: 0.08098291771943315
[rfa agg] init. name: [75, 36, 16, 74, 20, 26, 57, 91, 19, 56], weight: tensor([0.0852, 0.0448, 0.0778, 0.1705, 0.0887, 0.1588, 0.1268, 0.1131, 0.1138,
        0.0204])
[rfa agg] iter:  0, prev_obj_val: 46.6778564453125, obj_val: 48.26005172729492, abs dis: 1.5821952819824219
[rfa agg] iter: 0, weight: tensor([0.1405, 0.0195, 0.0884, 0.0593, 0.1439, 0.0691, 0.1080, 0.1801, 0.1852,
        0.0059])
[rfa agg] iter:  1, prev_obj_val: 48.26005172729492, obj_val: 51.772483825683594, abs dis: 3.512432098388672
[rfa agg] iter: 1, weight: tensor([0.1781, 0.0204, 0.1029, 0.0554, 0.1813, 0.0637, 0.0946, 0.1474, 0.1501,
        0.0061])
[rfa agg] iter:  2, prev_obj_val: 51.772483825683594, obj_val: 59.84831619262695, abs dis: 8.07583236694336
[rfa agg] iter: 2, weight: tensor([0.2764, 0.0181, 0.1246, 0.0388, 0.2669, 0.0438, 0.0598, 0.0826, 0.0838,
        0.0051])
[rfa agg] iter:  3, prev_obj_val: 59.84831619262695, obj_val: 59.796817779541016, abs dis: 0.0514984130859375
[rfa agg] iter: 3, weight: tensor([0.2013, 0.0244, 0.3194, 0.0357, 0.2022, 0.0394, 0.0491, 0.0609, 0.0615,
        0.0062])
[rfa agg] iter:  4, prev_obj_val: 59.796817779541016, obj_val: 67.11382293701172, abs dis: 7.317005157470703
[rfa agg] iter: 4, weight: tensor([0.1817, 0.0225, 0.3822, 0.0329, 0.1808, 0.0363, 0.0452, 0.0560, 0.0567,
        0.0057])
[rfa agg] iter:  5, prev_obj_val: 67.11382293701172, obj_val: 59.80173110961914, abs dis: 7.312091827392578
[rfa agg] iter: 5, weight: tensor([0.1657, 0.0454, 0.2882, 0.0496, 0.1695, 0.0540, 0.0643, 0.0761, 0.0768,
        0.0104])
[rfa agg] iter:  6, prev_obj_val: 59.80173110961914, obj_val: 67.11343383789062, abs dis: 7.311702728271484
[rfa agg] iter: 6, weight: tensor([0.1825, 0.0227, 0.3783, 0.0333, 0.1813, 0.0366, 0.0457, 0.0566, 0.0572,
        0.0058])
[rfa agg] iter:  7, prev_obj_val: 67.11343383789062, obj_val: 59.801761627197266, abs dis: 7.311672210693359
[rfa agg] iter: 7, weight: tensor([0.1657, 0.0454, 0.2880, 0.0496, 0.1696, 0.0540, 0.0643, 0.0761, 0.0769,
        0.0104])
[rfa agg] iter:  8, prev_obj_val: 59.801761627197266, obj_val: 67.1134262084961, abs dis: 7.311664581298828
[rfa agg] iter: 8, weight: tensor([0.1825, 0.0227, 0.3782, 0.0333, 0.1813, 0.0367, 0.0457, 0.0566, 0.0573,
        0.0058])
[rfa agg] iter:  9, prev_obj_val: 67.1134262084961, obj_val: 59.801761627197266, abs dis: 7.311664581298828
[rfa agg] iter: 9, weight: tensor([0.1657, 0.0455, 0.2880, 0.0496, 0.1696, 0.0540, 0.0643, 0.0761, 0.0769,
        0.0104])
			Update norm = 107.550937241674 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 425.7489242553711 sec.
Server Epoch:81 choose agents : [96, 50, 54, 97, 92, 82, 79, 65, 95, 81].
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 41/311 (13.1833%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.7348, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 151/809 (18.6650%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0260, Accuracy: 400/809 (49.4438%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3526, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0535, Accuracy: 363/1130 (32.1239%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7957, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   1, Avg loss: 0.0495, Accuracy: 369/1213 (30.4204%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 512/1213 (42.2094%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.3373, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0527, Accuracy: 479/1715 (27.9300%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8490, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   1, Avg loss: 0.0697, Accuracy: 107/500 (21.4000%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   2, Avg loss: 0.0471, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.6279, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   1, Avg loss: 0.1016, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.4143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   1, Avg loss: 0.0571, Accuracy: 409/1475 (27.7288%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 683/1475 (46.3051%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.4488, Accuracy: 77/10000 (0.7700%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 341/599 (56.9282%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0649, Accuracy: 249/774 (32.1705%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.0364, Accuracy: 74/10000 (0.7400%)
time spent on training: 232.41960310935974
[rfa agg] training data poison_ratio: 0.06866903588215063  data num: [311, 809, 1130, 1213, 1715, 500, 197, 1475, 599, 774]
[rfa agg] considering poison per batch poison_fraction: 0.021459073713172072
[rfa agg] init. name: [96, 50, 54, 97, 92, 82, 79, 65, 95, 81], weight: tensor([0.0357, 0.0927, 0.1295, 0.1391, 0.1966, 0.0573, 0.0226, 0.1691, 0.0687,
        0.0887])
[rfa agg] iter:  0, prev_obj_val: 56.82831573486328, obj_val: 57.94882583618164, abs dis: 1.1205101013183594
[rfa agg] iter: 0, weight: tensor([0.0144, 0.1333, 0.2631, 0.1983, 0.0792, 0.0318, 0.0084, 0.0933, 0.0507,
        0.1277])
[rfa agg] iter:  1, prev_obj_val: 57.94882583618164, obj_val: 57.94636154174805, abs dis: 0.00246429443359375
[rfa agg] iter: 1, weight: tensor([0.0154, 0.1619, 0.2256, 0.1759, 0.0772, 0.0346, 0.0089, 0.0895, 0.0564,
        0.1545])
			Update norm = 138.82478980940328 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3459, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.3036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.4700915813446 sec.
Server Epoch:82 choose agents : [64, 98, 19, 25, 53, 74, 65, 96, 58, 16].
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 331/953 (34.7324%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2369, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   1, Avg loss: 0.0758, Accuracy: 67/373 (17.9625%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   2, Avg loss: 0.0448, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.9562, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 405/1036 (39.0927%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 687/1036 (66.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.5579, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   1, Avg loss: 0.0511, Accuracy: 341/690 (49.4203%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   2, Avg loss: 0.0258, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.5782, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   1, Avg loss: 0.0476, Accuracy: 291/813 (35.7934%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 444/813 (54.6125%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.7407, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 503/1552 (32.4098%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 803/1552 (51.7397%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.3440, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   1, Avg loss: 0.0540, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   2, Avg loss: 0.0302, Accuracy: 737/1475 (49.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9269, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0353, Accuracy: 376/803 (46.8244%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4915, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1, Avg loss: 0.0642, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2, Avg loss: 0.0348, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4677, Accuracy: 68/10000 (0.6800%)
time spent on training: 239.66236424446106
[rfa agg] training data poison_ratio: 0.17810420013770945  data num: [953, 373, 1036, 690, 813, 1552, 1475, 311, 803, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0556575625430342
[rfa agg] init. name: [64, 98, 19, 25, 53, 74, 65, 96, 58, 16], weight: tensor([0.1094, 0.0428, 0.1189, 0.0792, 0.0933, 0.1781, 0.1693, 0.0357, 0.0922,
        0.0812])
[rfa agg] iter:  0, prev_obj_val: 48.41718673706055, obj_val: 51.1208610534668, abs dis: 2.70367431640625
[rfa agg] iter: 0, weight: tensor([0.3203, 0.0135, 0.1211, 0.0597, 0.1518, 0.0454, 0.0476, 0.0101, 0.1462,
        0.0842])
[rfa agg] iter:  1, prev_obj_val: 51.1208610534668, obj_val: 55.23597717285156, abs dis: 4.115116119384766
[rfa agg] iter: 1, weight: tensor([0.1086, 0.0126, 0.0603, 0.0775, 0.2835, 0.0306, 0.0316, 0.0092, 0.2467,
        0.1395])
[rfa agg] iter:  2, prev_obj_val: 55.23597717285156, obj_val: 61.13743209838867, abs dis: 5.901454925537109
[rfa agg] iter: 2, weight: tensor([0.0776, 0.0157, 0.0515, 0.1460, 0.1804, 0.0301, 0.0309, 0.0112, 0.1709,
        0.2858])
[rfa agg] iter:  3, prev_obj_val: 61.13743209838867, obj_val: 64.56720733642578, abs dis: 3.4297752380371094
[rfa agg] iter: 3, weight: tensor([0.0707, 0.0225, 0.0517, 0.3487, 0.1175, 0.0335, 0.0342, 0.0156, 0.1148,
        0.1909])
[rfa agg] iter:  4, prev_obj_val: 64.56720733642578, obj_val: 68.22383880615234, abs dis: 3.6566314697265625
[rfa agg] iter: 4, weight: tensor([0.0743, 0.0294, 0.0562, 0.3649, 0.1116, 0.0380, 0.0388, 0.0201, 0.1100,
        0.1567])
[rfa agg] iter:  5, prev_obj_val: 68.22383880615234, obj_val: 57.990360260009766, abs dis: 10.233478546142578
[rfa agg] iter: 5, weight: tensor([0.0859, 0.0422, 0.0669, 0.2883, 0.1204, 0.0471, 0.0479, 0.0282, 0.1187,
        0.1545])
[rfa agg] iter:  6, prev_obj_val: 57.990360260009766, obj_val: 64.57616424560547, abs dis: 6.585803985595703
[rfa agg] iter: 6, weight: tensor([0.0724, 0.0184, 0.0506, 0.2686, 0.1345, 0.0312, 0.0320, 0.0130, 0.1316,
        0.2476])
[rfa agg] iter:  7, prev_obj_val: 64.57616424560547, obj_val: 71.92874145507812, abs dis: 7.352577209472656
[rfa agg] iter: 7, weight: tensor([0.0757, 0.0299, 0.0573, 0.3506, 0.1141, 0.0388, 0.0395, 0.0205, 0.1122,
        0.1614])
[rfa agg] iter:  8, prev_obj_val: 71.92874145507812, obj_val: 61.10699462890625, abs dis: 10.821746826171875
[rfa agg] iter: 8, weight: tensor([0.0926, 0.0570, 0.0740, 0.2379, 0.1230, 0.0539, 0.0547, 0.0371, 0.1213,
        0.1486])
[rfa agg] iter:  9, prev_obj_val: 61.10699462890625, obj_val: 64.5667495727539, abs dis: 3.4597549438476562
[rfa agg] iter: 9, weight: tensor([0.0679, 0.0215, 0.0495, 0.3833, 0.1119, 0.0321, 0.0328, 0.0150, 0.1096,
        0.1765])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 400.04084610939026 sec.
Server Epoch:83 choose agents : [63, 88, 39, 85, 65, 22, 50, 86, 14, 33].
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 357/888 (40.2027%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.6502, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   1, Avg loss: 0.0671, Accuracy: 196/603 (32.5041%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   2, Avg loss: 0.0438, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.6888, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 306/1013 (30.2073%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 520/1013 (51.3327%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4292, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 427/1988 (21.4789%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1895, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 417/1475 (28.2712%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 700/1475 (47.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6824, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 525/1470 (35.7143%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 873/1470 (59.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.6226, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 171/809 (21.1372%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   2, Avg loss: 0.0266, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.7334, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.2963, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 346/1013 (34.1560%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4019, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 83/515 (16.1165%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.4764, Accuracy: 53/10000 (0.5300%)
time spent on training: 249.8055534362793
[rfa agg] training data poison_ratio: 0.0  data num: [888, 603, 1013, 1988, 1475, 1470, 809, 1003, 1013, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 88, 39, 85, 65, 22, 50, 86, 14, 33], weight: tensor([0.0824, 0.0560, 0.0940, 0.1845, 0.1369, 0.1364, 0.0751, 0.0931, 0.0940,
        0.0478])
[rfa agg] iter:  0, prev_obj_val: 56.34891128540039, obj_val: 59.685909271240234, abs dis: 3.3369979858398438
[rfa agg] iter: 0, weight: tensor([0.0840, 0.0272, 0.2031, 0.0465, 0.0762, 0.0897, 0.0601, 0.1933, 0.1994,
        0.0205])
[rfa agg] iter:  1, prev_obj_val: 59.685909271240234, obj_val: 66.71891784667969, abs dis: 7.033008575439453
[rfa agg] iter: 1, weight: tensor([0.1682, 0.0287, 0.2000, 0.0279, 0.0389, 0.0437, 0.0902, 0.1868, 0.1952,
        0.0204])
[rfa agg] iter:  2, prev_obj_val: 66.71891784667969, obj_val: 72.86019897460938, abs dis: 6.1412811279296875
[rfa agg] iter: 2, weight: tensor([0.2742, 0.0450, 0.1032, 0.0283, 0.0369, 0.0407, 0.2382, 0.1007, 0.1030,
        0.0300])
[rfa agg] iter:  3, prev_obj_val: 72.86019897460938, obj_val: 76.2690200805664, abs dis: 3.4088211059570312
[rfa agg] iter: 3, weight: tensor([0.1746, 0.0748, 0.0898, 0.0323, 0.0405, 0.0442, 0.3200, 0.0880, 0.0898,
        0.0460])
[rfa agg] iter:  4, prev_obj_val: 76.2690200805664, obj_val: 72.85072326660156, abs dis: 3.4182968139648438
[rfa agg] iter: 4, weight: tensor([0.1566, 0.1085, 0.0927, 0.0369, 0.0456, 0.0496, 0.2638, 0.0911, 0.0926,
        0.0626])
[rfa agg] iter:  5, prev_obj_val: 72.85072326660156, obj_val: 76.2695541381836, abs dis: 3.4188308715820312
[rfa agg] iter: 5, weight: tensor([0.1697, 0.0746, 0.0893, 0.0321, 0.0403, 0.0440, 0.3277, 0.0875, 0.0891,
        0.0457])
[rfa agg] iter:  6, prev_obj_val: 76.2695541381836, obj_val: 72.85065460205078, abs dis: 3.4188995361328125
[rfa agg] iter: 6, weight: tensor([0.1564, 0.1085, 0.0927, 0.0369, 0.0456, 0.0496, 0.2644, 0.0910, 0.0926,
        0.0626])
[rfa agg] iter:  7, prev_obj_val: 72.85065460205078, obj_val: 76.26956939697266, abs dis: 3.418914794921875
[rfa agg] iter: 7, weight: tensor([0.1697, 0.0746, 0.0892, 0.0321, 0.0402, 0.0439, 0.3279, 0.0875, 0.0891,
        0.0457])
[rfa agg] iter:  8, prev_obj_val: 76.26956939697266, obj_val: 72.85066223144531, abs dis: 3.4189071655273438
[rfa agg] iter: 8, weight: tensor([0.1564, 0.1085, 0.0927, 0.0369, 0.0456, 0.0496, 0.2644, 0.0910, 0.0926,
        0.0626])
[rfa agg] iter:  9, prev_obj_val: 72.85066223144531, obj_val: 76.26956939697266, abs dis: 3.4189071655273438
[rfa agg] iter: 9, weight: tensor([0.1697, 0.0746, 0.0892, 0.0321, 0.0402, 0.0439, 0.3279, 0.0875, 0.0891,
        0.0457])
			Update norm = 107.54687840512852 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.7614903450012 sec.
Server Epoch:84 choose agents : [46, 69, 35, 2, 38, 61, 48, 80, 0, 84].
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 416/1904 (21.8487%)
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 726/1904 (38.1303%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6171, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   1, Avg loss: 0.0538, Accuracy: 315/590 (53.3898%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.4385, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0845, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 115/271 (42.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8041, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 260/605 (42.9752%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.4126, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0604, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 506/1131 (44.7392%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9442, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1284, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1197, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3599, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 100/631 (15.8479%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.6502, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0663, Accuracy: 190/682 (27.8592%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0364, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.0976, Accuracy: 69/10000 (0.6900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 361/1657 (21.7864%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 537/1657 (32.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0876, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6512, Accuracy: 64/10000 (0.6400%)
time spent on training: 263.40190029144287
[rfa agg] training data poison_ratio: 0.18945803796021038  data num: [1904, 590, 271, 605, 1131, 85, 631, 682, 1657, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.05920563686256575
[rfa agg] init. name: [46, 69, 35, 2, 38, 61, 48, 80, 0, 84], weight: tensor([0.2177, 0.0675, 0.0310, 0.0692, 0.1293, 0.0097, 0.0721, 0.0780, 0.1895,
        0.1361])
[rfa agg] iter:  0, prev_obj_val: 65.58496856689453, obj_val: 71.17768859863281, abs dis: 5.592720031738281
[rfa agg] iter: 0, weight: tensor([0.0590, 0.0305, 0.0084, 0.0312, 0.4615, 0.0021, 0.0326, 0.0406, 0.0753,
        0.2587])
[rfa agg] iter:  1, prev_obj_val: 71.17768859863281, obj_val: 71.1549301147461, abs dis: 0.02275848388671875
[rfa agg] iter: 1, weight: tensor([0.0833, 0.0677, 0.0164, 0.0695, 0.2815, 0.0040, 0.0724, 0.0955, 0.1000,
        0.2098])
[rfa agg] iter:  2, prev_obj_val: 71.1549301147461, obj_val: 69.6560287475586, abs dis: 1.4989013671875
[rfa agg] iter: 2, weight: tensor([0.0835, 0.0680, 0.0164, 0.0698, 0.2790, 0.0040, 0.0727, 0.0960, 0.1002,
        0.2103])
[rfa agg] iter:  3, prev_obj_val: 69.6560287475586, obj_val: 69.65473937988281, abs dis: 0.00128936767578125
[rfa agg] iter: 3, weight: tensor([0.0804, 0.0580, 0.0146, 0.0595, 0.3181, 0.0036, 0.0620, 0.0804, 0.0978,
        0.2256])
			Update norm = 143.27613472330276 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 419.69297218322754 sec.
Server Epoch:85 choose agents : [10, 27, 58, 65, 60, 31, 40, 48, 2, 16].
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   1, Avg loss: 0.0554, Accuracy: 226/861 (26.2485%)
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 451/861 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.2625, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 412/1587 (25.9609%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 608/1587 (38.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2312, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.5714, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1, Avg loss: 0.0546, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2, Avg loss: 0.0294, Accuracy: 709/1475 (48.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6100, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 584/2227 (26.2236%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1031/2227 (46.2955%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.7253, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0767, Accuracy: 85/460 (18.4783%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0348, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8363, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 369/1573 (23.4584%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 588/1573 (37.3808%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5670, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 114/631 (18.0666%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 227/631 (35.9746%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.5197, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0601, Accuracy: 249/605 (41.1570%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0373, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4642, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 294/708 (41.5254%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 422/708 (59.6045%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9638, Accuracy: 71/10000 (0.7100%)
time spent on training: 281.1211805343628
[rfa agg] training data poison_ratio: 0.0787740164684355  data num: [861, 1587, 803, 1475, 2227, 460, 1573, 631, 605, 708]
[rfa agg] considering poison per batch poison_fraction: 0.024616880146386095
[rfa agg] init. name: [10, 27, 58, 65, 60, 31, 40, 48, 2, 16], weight: tensor([0.0788, 0.1452, 0.0735, 0.1349, 0.2038, 0.0421, 0.1439, 0.0577, 0.0554,
        0.0648])
[rfa agg] iter:  0, prev_obj_val: 73.69725036621094, obj_val: 75.92212677001953, abs dis: 2.2248764038085938
[rfa agg] iter: 0, weight: tensor([0.0871, 0.1908, 0.0698, 0.2194, 0.0906, 0.0234, 0.1896, 0.0385, 0.0369,
        0.0539])
[rfa agg] iter:  1, prev_obj_val: 75.92212677001953, obj_val: 77.05056762695312, abs dis: 1.1284408569335938
[rfa agg] iter: 1, weight: tensor([0.1110, 0.1706, 0.0868, 0.1896, 0.0905, 0.0272, 0.1694, 0.0456, 0.0437,
        0.0656])
[rfa agg] iter:  2, prev_obj_val: 77.05056762695312, obj_val: 80.46920013427734, abs dis: 3.4186325073242188
[rfa agg] iter: 2, weight: tensor([0.1248, 0.1599, 0.0959, 0.1751, 0.0891, 0.0289, 0.1588, 0.0489, 0.0469,
        0.0716])
[rfa agg] iter:  3, prev_obj_val: 80.46920013427734, obj_val: 80.4651107788086, abs dis: 0.00408935546875
[rfa agg] iter: 3, weight: tensor([0.1777, 0.1256, 0.1263, 0.1332, 0.0787, 0.0325, 0.1246, 0.0572, 0.0549,
        0.0893])
			Update norm = 152.2105731995974 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 441.83073711395264 sec.
Server Epoch:86 choose agents : [88, 3, 90, 19, 74, 8, 93, 84, 24, 62].
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1, Avg loss: 0.0671, Accuracy: 185/603 (30.6799%)
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2, Avg loss: 0.0432, Accuracy: 270/603 (44.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1577, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0715, Accuracy: 116/781 (14.8528%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 256/781 (32.7785%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9692, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 436/677 (64.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5295, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0455, Accuracy: 439/1036 (42.3745%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0235, Accuracy: 680/1036 (65.6371%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.7785, Accuracy: 73/10000 (0.7300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 521/1552 (33.5696%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 769/1552 (49.5490%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.9321, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   1, Avg loss: 0.0582, Accuracy: 293/1513 (19.3655%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 491/1513 (32.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6143, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 431/1742 (24.7417%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 685/1742 (39.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6476, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2058, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0795, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0418, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.9386, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   1, Avg loss: 0.0676, Accuracy: 162/568 (28.5211%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.6678, Accuracy: 52/10000 (0.5200%)
time spent on training: 312.68667006492615
[rfa agg] training data poison_ratio: 0.15560457188690596  data num: [603, 781, 677, 1036, 1552, 1513, 1742, 1190, 312, 568]
[rfa agg] considering poison per batch poison_fraction: 0.04862642871465811
[rfa agg] init. name: [88, 3, 90, 19, 74, 8, 93, 84, 24, 62], weight: tensor([0.0605, 0.0783, 0.0679, 0.1039, 0.1556, 0.1517, 0.1747, 0.1193, 0.0313,
        0.0569])
[rfa agg] iter:  0, prev_obj_val: 57.775821685791016, obj_val: 63.75433349609375, abs dis: 5.978511810302734
[rfa agg] iter: 0, weight: tensor([0.0287, 0.0613, 0.0372, 0.3892, 0.0736, 0.0825, 0.0592, 0.2354, 0.0089,
        0.0239])
[rfa agg] iter:  1, prev_obj_val: 63.75433349609375, obj_val: 65.53890228271484, abs dis: 1.7845687866210938
[rfa agg] iter: 1, weight: tensor([0.0514, 0.1400, 0.0702, 0.3022, 0.0768, 0.0834, 0.0656, 0.1552, 0.0140,
        0.0411])
[rfa agg] iter:  2, prev_obj_val: 65.53890228271484, obj_val: 69.210205078125, abs dis: 3.6713027954101562
[rfa agg] iter: 2, weight: tensor([0.0594, 0.1819, 0.0830, 0.2441, 0.0767, 0.0829, 0.0663, 0.1434, 0.0155,
        0.0468])
[rfa agg] iter:  3, prev_obj_val: 69.210205078125, obj_val: 69.19302368164062, abs dis: 0.017181396484375
[rfa agg] iter: 3, weight: tensor([0.0694, 0.3001, 0.1030, 0.1565, 0.0655, 0.0701, 0.0578, 0.1088, 0.0161,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 69.19302368164062, obj_val: 67.35772705078125, abs dis: 1.835296630859375
[rfa agg] iter: 4, weight: tensor([0.0685, 0.3117, 0.1016, 0.1530, 0.0645, 0.0690, 0.0569, 0.1071, 0.0159,
        0.0518])
[rfa agg] iter:  5, prev_obj_val: 67.35772705078125, obj_val: 69.19758605957031, abs dis: 1.8398590087890625
[rfa agg] iter: 5, weight: tensor([0.0654, 0.2400, 0.0938, 0.1937, 0.0724, 0.0778, 0.0633, 0.1270, 0.0161,
        0.0505])
[rfa agg] iter:  6, prev_obj_val: 69.19758605957031, obj_val: 69.19294738769531, abs dis: 0.004638671875
[rfa agg] iter: 6, weight: tensor([0.0690, 0.3061, 0.1023, 0.1546, 0.0650, 0.0695, 0.0574, 0.1079, 0.0160,
        0.0522])
[rfa agg] iter:  7, prev_obj_val: 69.19294738769531, obj_val: 67.35777282714844, abs dis: 1.835174560546875
[rfa agg] iter: 7, weight: tensor([0.0685, 0.3121, 0.1015, 0.1528, 0.0644, 0.0690, 0.0569, 0.1070, 0.0159,
        0.0518])
[rfa agg] iter:  8, prev_obj_val: 67.35777282714844, obj_val: 69.19758605957031, abs dis: 1.839813232421875
[rfa agg] iter: 8, weight: tensor([0.0654, 0.2400, 0.0938, 0.1937, 0.0724, 0.0778, 0.0633, 0.1270, 0.0161,
        0.0505])
[rfa agg] iter:  9, prev_obj_val: 69.19758605957031, obj_val: 69.19294738769531, abs dis: 0.004638671875
[rfa agg] iter: 9, weight: tensor([0.0690, 0.3061, 0.1023, 0.1546, 0.0650, 0.0695, 0.0574, 0.1079, 0.0160,
        0.0522])
			Update norm = 125.39469327512428 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 477.4864025115967 sec.
Server Epoch:87 choose agents : [61, 30, 64, 21, 37, 89, 86, 47, 43, 63].
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1287, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1198, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3604, Accuracy: 46/10000 (0.4600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   1, Avg loss: 0.0705, Accuracy: 125/486 (25.7202%)
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   2, Avg loss: 0.0389, Accuracy: 207/486 (42.5926%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4621, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   1, Avg loss: 0.0629, Accuracy: 188/953 (19.7272%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   2, Avg loss: 0.0373, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3164, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 443/1949 (22.7296%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 678/1949 (34.7871%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.7361, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 440/1129 (38.9725%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.8016, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   1, Avg loss: 0.0595, Accuracy: 353/896 (39.3973%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 469/896 (52.3438%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.8738, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0638, Accuracy: 356/1003 (35.4935%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1160, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1036, Accuracy: 35/134 (26.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3850, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0600, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0351, Accuracy: 377/946 (39.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.7981, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   1, Avg loss: 0.0533, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 418/888 (47.0721%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0039, Accuracy: 56/10000 (0.5600%)
time spent on training: 257.51354479789734
[rfa agg] training data poison_ratio: 0.057385759829968117  data num: [85, 486, 953, 1949, 1129, 896, 1003, 134, 946, 888]
[rfa agg] considering poison per batch poison_fraction: 0.017933049946865037
[rfa agg] init. name: [61, 30, 64, 21, 37, 89, 86, 47, 43, 63], weight: tensor([0.0100, 0.0574, 0.1125, 0.2301, 0.1333, 0.1058, 0.1184, 0.0158, 0.1117,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 48.116302490234375, obj_val: 49.765010833740234, abs dis: 1.6487083435058594
[rfa agg] iter: 0, weight: tensor([0.0013, 0.0135, 0.2118, 0.0263, 0.0875, 0.1084, 0.2212, 0.0022, 0.2172,
        0.1105])
[rfa agg] iter:  1, prev_obj_val: 49.765010833740234, obj_val: 54.74703598022461, abs dis: 4.982025146484375
[rfa agg] iter: 1, weight: tensor([0.0013, 0.0142, 0.2076, 0.0225, 0.0588, 0.1717, 0.1153, 0.0022, 0.2167,
        0.1897])
[rfa agg] iter:  2, prev_obj_val: 54.74703598022461, obj_val: 54.71245574951172, abs dis: 0.034580230712890625
[rfa agg] iter: 2, weight: tensor([0.0018, 0.0218, 0.1418, 0.0276, 0.0605, 0.2387, 0.0947, 0.0032, 0.1433,
        0.2666])
[rfa agg] iter:  3, prev_obj_val: 54.71245574951172, obj_val: 58.075950622558594, abs dis: 3.363494873046875
[rfa agg] iter: 3, weight: tensor([0.0018, 0.0212, 0.1350, 0.0268, 0.0587, 0.2484, 0.0916, 0.0031, 0.1370,
        0.2764])
[rfa agg] iter:  4, prev_obj_val: 58.075950622558594, obj_val: 54.71467208862305, abs dis: 3.361278533935547
[rfa agg] iter: 4, weight: tensor([0.0024, 0.0306, 0.1400, 0.0343, 0.0699, 0.2325, 0.1020, 0.0042, 0.1409,
        0.2431])
[rfa agg] iter:  5, prev_obj_val: 54.71467208862305, obj_val: 58.07571029663086, abs dis: 3.3610382080078125
[rfa agg] iter: 5, weight: tensor([0.0018, 0.0213, 0.1359, 0.0269, 0.0591, 0.2487, 0.0922, 0.0031, 0.1378,
        0.2732])
[rfa agg] iter:  6, prev_obj_val: 58.07571029663086, obj_val: 54.71468734741211, abs dis: 3.36102294921875
[rfa agg] iter: 6, weight: tensor([0.0024, 0.0306, 0.1400, 0.0343, 0.0699, 0.2326, 0.1020, 0.0042, 0.1409,
        0.2429])
[rfa agg] iter:  7, prev_obj_val: 54.71468734741211, obj_val: 58.07571029663086, abs dis: 3.36102294921875
[rfa agg] iter: 7, weight: tensor([0.0018, 0.0213, 0.1359, 0.0269, 0.0591, 0.2487, 0.0922, 0.0031, 0.1378,
        0.2732])
[rfa agg] iter:  8, prev_obj_val: 58.07571029663086, obj_val: 54.71468734741211, abs dis: 3.36102294921875
[rfa agg] iter: 8, weight: tensor([0.0024, 0.0306, 0.1400, 0.0343, 0.0699, 0.2326, 0.1020, 0.0042, 0.1409,
        0.2429])
[rfa agg] iter:  9, prev_obj_val: 54.71468734741211, obj_val: 58.07571029663086, abs dis: 3.36102294921875
[rfa agg] iter: 9, weight: tensor([0.0018, 0.0213, 0.1359, 0.0269, 0.0591, 0.2487, 0.0922, 0.0031, 0.1378,
        0.2732])
			Update norm = 116.48398830418711 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3480, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.2786, Accuracy: 0/9950 (0.0000%)
saving model
Done in 419.49176383018494 sec.
Server Epoch:88 choose agents : [90, 31, 58, 73, 91, 48, 27, 50, 35, 61].
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8948, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0770, Accuracy: 100/460 (21.7391%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0356, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.1544, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.5090, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1, Avg loss: 0.0643, Accuracy: 173/938 (18.4435%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 319/938 (34.0085%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9679, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1, Avg loss: 0.0519, Accuracy: 324/1030 (31.4563%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2, Avg loss: 0.0270, Accuracy: 653/1030 (63.3981%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1630, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 102/631 (16.1648%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.6186, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 463/1587 (29.1745%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0734, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 153/809 (18.9122%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4854, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1, Avg loss: 0.0850, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 137/271 (50.5535%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1285, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1201, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3575, Accuracy: 45/10000 (0.4500%)
time spent on training: 204.8066120147705
[rfa agg] training data poison_ratio: 0.0  data num: [677, 460, 803, 938, 1030, 631, 1587, 809, 271, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 31, 58, 73, 91, 48, 27, 50, 35, 61], weight: tensor([0.0929, 0.0631, 0.1101, 0.1287, 0.1413, 0.0865, 0.2177, 0.1110, 0.0372,
        0.0117])
[rfa agg] iter:  0, prev_obj_val: 44.327518463134766, obj_val: 47.70306396484375, abs dis: 3.3755455017089844
[rfa agg] iter: 0, weight: tensor([0.1237, 0.0297, 0.2747, 0.1052, 0.0654, 0.0721, 0.0370, 0.2792, 0.0105,
        0.0024])
[rfa agg] iter:  1, prev_obj_val: 47.70306396484375, obj_val: 52.19053649902344, abs dis: 4.4874725341796875
[rfa agg] iter: 1, weight: tensor([0.3044, 0.0421, 0.1620, 0.0851, 0.0597, 0.1282, 0.0381, 0.1639, 0.0135,
        0.0029])
[rfa agg] iter:  2, prev_obj_val: 52.19053649902344, obj_val: 58.20404052734375, abs dis: 6.0135040283203125
[rfa agg] iter: 2, weight: tensor([0.3215, 0.0547, 0.0947, 0.0625, 0.0476, 0.2724, 0.0332, 0.0954, 0.0149,
        0.0030])
[rfa agg] iter:  3, prev_obj_val: 58.20404052734375, obj_val: 61.59491729736328, abs dis: 3.3908767700195312
[rfa agg] iter: 3, weight: tensor([0.1659, 0.1104, 0.0855, 0.0641, 0.0517, 0.3703, 0.0388, 0.0862, 0.0228,
        0.0043])
[rfa agg] iter:  4, prev_obj_val: 61.59491729736328, obj_val: 54.97132873535156, abs dis: 6.623588562011719
[rfa agg] iter: 4, weight: tensor([0.1493, 0.1896, 0.0898, 0.0704, 0.0579, 0.2714, 0.0449, 0.0904, 0.0306,
        0.0055])
[rfa agg] iter:  5, prev_obj_val: 54.97132873535156, obj_val: 61.606361389160156, abs dis: 6.635032653808594
[rfa agg] iter: 5, weight: tensor([0.1731, 0.0640, 0.0742, 0.0528, 0.0414, 0.4715, 0.0300, 0.0747, 0.0154,
        0.0030])
[rfa agg] iter:  6, prev_obj_val: 61.606361389160156, obj_val: 58.19145965576172, abs dis: 3.4149017333984375
[rfa agg] iter: 6, weight: tensor([0.1489, 0.1874, 0.0896, 0.0703, 0.0579, 0.2748, 0.0449, 0.0903, 0.0305,
        0.0055])
[rfa agg] iter:  7, prev_obj_val: 58.19145965576172, obj_val: 61.595314025878906, abs dis: 3.4038543701171875
[rfa agg] iter: 7, weight: tensor([0.1614, 0.1109, 0.0847, 0.0635, 0.0511, 0.3780, 0.0384, 0.0852, 0.0225,
        0.0043])
[rfa agg] iter:  8, prev_obj_val: 61.595314025878906, obj_val: 54.971275329589844, abs dis: 6.6240386962890625
[rfa agg] iter: 8, weight: tensor([0.1492, 0.1896, 0.0898, 0.0704, 0.0579, 0.2717, 0.0449, 0.0904, 0.0306,
        0.0055])
[rfa agg] iter:  9, prev_obj_val: 54.971275329589844, obj_val: 61.60638427734375, abs dis: 6.635108947753906
[rfa agg] iter: 9, weight: tensor([0.1731, 0.0640, 0.0742, 0.0527, 0.0414, 0.4716, 0.0300, 0.0747, 0.0154,
        0.0030])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3498, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.2647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.55285263061523 sec.
Server Epoch:89 choose agents : [66, 87, 89, 19, 67, 71, 31, 39, 91, 84].
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 266/1402 (18.9729%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 397/1402 (28.3167%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7835, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   2, Avg loss: 0.0310, Accuracy: 424/1131 (37.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7768, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.9760, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 410/1036 (39.5753%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 648/1036 (62.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.5303, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0711, Accuracy: 90/426 (21.1268%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0367, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.4968, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   1, Avg loss: 0.0629, Accuracy: 175/818 (21.3936%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 356/818 (43.5208%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1019, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   1, Avg loss: 0.0754, Accuracy: 98/460 (21.3043%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.7672, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0544, Accuracy: 307/1013 (30.3060%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 522/1013 (51.5301%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.8247, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 339/1030 (32.9126%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 648/1030 (62.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.5729, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0608, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 465/1190 (39.0756%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9732, Accuracy: 65/10000 (0.6500%)
time spent on training: 258.32350730895996
[rfa agg] training data poison_ratio: 0.0  data num: [1402, 1131, 896, 1036, 426, 818, 460, 1013, 1030, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [66, 87, 89, 19, 67, 71, 31, 39, 91, 84], weight: tensor([0.1491, 0.1203, 0.0953, 0.1102, 0.0453, 0.0870, 0.0489, 0.1077, 0.1096,
        0.1266])
[rfa agg] iter:  0, prev_obj_val: 38.69631576538086, obj_val: 44.83322525024414, abs dis: 6.136909484863281
[rfa agg] iter: 0, weight: tensor([0.0435, 0.0656, 0.2846, 0.0757, 0.0173, 0.2568, 0.0220, 0.1035, 0.0747,
        0.0562])
[rfa agg] iter:  1, prev_obj_val: 44.83322525024414, obj_val: 41.50693130493164, abs dis: 3.3262939453125
[rfa agg] iter: 1, weight: tensor([0.0471, 0.0652, 0.1812, 0.0722, 0.0247, 0.3570, 0.0326, 0.0909, 0.0712,
        0.0578])
[rfa agg] iter:  2, prev_obj_val: 41.50693130493164, obj_val: 44.82209014892578, abs dis: 3.3151588439941406
[rfa agg] iter: 2, weight: tensor([0.0379, 0.0545, 0.1887, 0.0615, 0.0172, 0.4297, 0.0223, 0.0801, 0.0605,
        0.0476])
[rfa agg] iter:  3, prev_obj_val: 44.82209014892578, obj_val: 44.81965637207031, abs dis: 0.00243377685546875
[rfa agg] iter: 3, weight: tensor([0.0451, 0.0624, 0.1706, 0.0691, 0.0236, 0.3876, 0.0312, 0.0869, 0.0681,
        0.0553])
[rfa agg] iter:  4, prev_obj_val: 44.81965637207031, obj_val: 44.819610595703125, abs dis: 4.57763671875e-05
[rfa agg] iter: 4, weight: tensor([0.0457, 0.0632, 0.1724, 0.0699, 0.0239, 0.3804, 0.0315, 0.0880, 0.0690,
        0.0560])
			Update norm = 111.99111031266054 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3498, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.2647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.2110843658447 sec.
Server Epoch:90 choose agents : [46, 51, 28, 5, 48, 71, 20, 24, 41, 17].
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 427/1904 (22.4265%)
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 706/1904 (37.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2859, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 246/1049 (23.4509%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0290, Accuracy: 505/1049 (48.1411%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6068, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 395/1581 (24.9842%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 576/1581 (36.4326%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8809, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 357/1628 (21.9287%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 817/1628 (50.1843%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6064, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   1, Avg loss: 0.0671, Accuracy: 123/631 (19.4929%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   2, Avg loss: 0.0399, Accuracy: 231/631 (36.6086%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.6105, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0625, Accuracy: 185/818 (22.6161%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0297, Accuracy: 369/818 (45.1100%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3030, Accuracy: 78/10000 (0.7800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   1, Avg loss: 0.0587, Accuracy: 316/807 (39.1574%)
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   2, Avg loss: 0.0313, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.1168, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0796, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0426, Accuracy: 173/312 (55.4487%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.0694, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0568, Accuracy: 347/719 (48.2615%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0311, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7543, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 388/1574 (24.6506%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 624/1574 (39.6442%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.7514, Accuracy: 100/10000 (1.0000%)
time spent on training: 297.1922986507416
[rfa agg] training data poison_ratio: 0.07321055973872811  data num: [1904, 1049, 1581, 1628, 631, 818, 807, 312, 719, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.022878299918352538
[rfa agg] init. name: [46, 51, 28, 5, 48, 71, 20, 24, 41, 17], weight: tensor([0.1727, 0.0952, 0.1434, 0.1477, 0.0572, 0.0742, 0.0732, 0.0283, 0.0652,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 64.03541564941406, obj_val: 68.31217956542969, abs dis: 4.276763916015625
[rfa agg] iter: 0, weight: tensor([0.0926, 0.2561, 0.1399, 0.1238, 0.0375, 0.0727, 0.0715, 0.0120, 0.0547,
        0.1393])
[rfa agg] iter:  1, prev_obj_val: 68.31217956542969, obj_val: 71.50592041015625, abs dis: 3.1937408447265625
[rfa agg] iter: 1, weight: tensor([0.0522, 0.5088, 0.0702, 0.0643, 0.0321, 0.0721, 0.0706, 0.0093, 0.0506,
        0.0699])
[rfa agg] iter:  2, prev_obj_val: 71.50592041015625, obj_val: 75.0886459350586, abs dis: 3.5827255249023438
[rfa agg] iter: 2, weight: tensor([0.0559, 0.3906, 0.0721, 0.0668, 0.0431, 0.1092, 0.1065, 0.0117, 0.0723,
        0.0717])
[rfa agg] iter:  3, prev_obj_val: 75.0886459350586, obj_val: 75.06187438964844, abs dis: 0.02677154541015625
[rfa agg] iter: 3, weight: tensor([0.0565, 0.2246, 0.0703, 0.0658, 0.0559, 0.1732, 0.1670, 0.0139, 0.1029,
        0.0699])
			Update norm = 134.30423281909248 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3498, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.2647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.9574444293976 sec.
Server Epoch:91 choose agents : [26, 43, 41, 42, 36, 81, 31, 76, 8, 57].
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 362/1446 (25.0346%)
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 495/1446 (34.2324%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9744, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0607, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0352, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.5581, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   1, Avg loss: 0.0573, Accuracy: 341/719 (47.4270%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 436/719 (60.6398%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2596, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 327/1372 (23.8338%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 504/1372 (36.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5228, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0822, Accuracy: 93/408 (22.7941%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0506, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.2829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   1, Avg loss: 0.0663, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   2, Avg loss: 0.0337, Accuracy: 313/774 (40.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.4782, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   1, Avg loss: 0.0761, Accuracy: 94/460 (20.4348%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   2, Avg loss: 0.0341, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.9301, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   1, Avg loss: 0.0806, Accuracy: 69/466 (14.8069%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   1, Avg loss: 0.0576, Accuracy: 296/1513 (19.5638%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 491/1513 (32.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7709, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.5380, Accuracy: 63/10000 (0.6300%)
time spent on training: 299.46461939811707
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 946, 719, 1372, 408, 774, 460, 466, 1513, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 43, 41, 42, 36, 81, 31, 76, 8, 57], weight: tensor([0.1562, 0.1022, 0.0777, 0.1482, 0.0441, 0.0836, 0.0497, 0.0503, 0.1634,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 52.37950897216797, obj_val: 55.393516540527344, abs dis: 3.014007568359375
[rfa agg] iter: 0, weight: tensor([0.0662, 0.4110, 0.0856, 0.0715, 0.0187, 0.1330, 0.0241, 0.0244, 0.0616,
        0.1038])
[rfa agg] iter:  1, prev_obj_val: 55.393516540527344, obj_val: 61.4769287109375, abs dis: 6.083412170410156
[rfa agg] iter: 1, weight: tensor([0.0595, 0.3078, 0.1238, 0.0634, 0.0217, 0.2256, 0.0285, 0.0288, 0.0561,
        0.0847])
[rfa agg] iter:  2, prev_obj_val: 61.4769287109375, obj_val: 61.39601135253906, abs dis: 0.0809173583984375
[rfa agg] iter: 2, weight: tensor([0.0468, 0.1247, 0.2694, 0.0490, 0.0252, 0.3106, 0.0347, 0.0350, 0.0447,
        0.0600])
[rfa agg] iter:  3, prev_obj_val: 61.39601135253906, obj_val: 63.99030303955078, abs dis: 2.5942916870117188
[rfa agg] iter: 3, weight: tensor([0.0436, 0.1136, 0.2905, 0.0457, 0.0235, 0.3206, 0.0323, 0.0326, 0.0417,
        0.0559])
[rfa agg] iter:  4, prev_obj_val: 63.99030303955078, obj_val: 73.09117126464844, abs dis: 9.100868225097656
[rfa agg] iter: 4, weight: tensor([0.0429, 0.0991, 0.3972, 0.0447, 0.0266, 0.2198, 0.0374, 0.0377, 0.0411,
        0.0535])
[rfa agg] iter:  5, prev_obj_val: 73.09117126464844, obj_val: 69.95068359375, abs dis: 3.1404876708984375
[rfa agg] iter: 5, weight: tensor([0.0602, 0.1075, 0.2376, 0.0620, 0.0601, 0.1560, 0.0939, 0.0940, 0.0583,
        0.0704])
[rfa agg] iter:  6, prev_obj_val: 69.95068359375, obj_val: 66.88203430175781, abs dis: 3.0686492919921875
[rfa agg] iter: 6, weight: tensor([0.0566, 0.1092, 0.2899, 0.0586, 0.0478, 0.1722, 0.0715, 0.0719, 0.0547,
        0.0676])
[rfa agg] iter:  7, prev_obj_val: 66.88203430175781, obj_val: 66.87569427490234, abs dis: 0.00634002685546875
[rfa agg] iter: 7, weight: tensor([0.0489, 0.1026, 0.3707, 0.0508, 0.0352, 0.1830, 0.0509, 0.0512, 0.0471,
        0.0597])
[rfa agg] iter:  8, prev_obj_val: 66.87569427490234, obj_val: 63.96788024902344, abs dis: 2.9078140258789062
[rfa agg] iter: 8, weight: tensor([0.0479, 0.1001, 0.3849, 0.0497, 0.0344, 0.1789, 0.0497, 0.0500, 0.0461,
        0.0583])
[rfa agg] iter:  9, prev_obj_val: 63.96788024902344, obj_val: 73.09921264648438, abs dis: 9.131332397460938
[rfa agg] iter: 9, weight: tensor([0.0403, 0.0930, 0.4449, 0.0420, 0.0250, 0.1953, 0.0351, 0.0354, 0.0386,
        0.0503])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3521, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.2660, Accuracy: 0/9950 (0.0000%)
saving model
Done in 455.67943263053894 sec.
Server Epoch:92 choose agents : [38, 36, 76, 12, 77, 96, 67, 3, 53, 25].
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 266/1131 (23.5190%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 504/1131 (44.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3450, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   1, Avg loss: 0.0812, Accuracy: 94/408 (23.0392%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   2, Avg loss: 0.0493, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.1654, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0820, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0458, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.4569, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   1, Avg loss: 0.0856, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   2, Avg loss: 0.0456, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.0448, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0515, Accuracy: 347/1340 (25.8955%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 536/1340 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8915, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.7751, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0709, Accuracy: 86/426 (20.1878%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0387, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.6329, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0723, Accuracy: 120/781 (15.3649%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8169, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   1, Avg loss: 0.0465, Accuracy: 313/813 (38.4994%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.3056, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   1, Avg loss: 0.0485, Accuracy: 370/690 (53.6232%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   2, Avg loss: 0.0250, Accuracy: 451/690 (65.3623%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6013, Accuracy: 65/10000 (0.6500%)
time spent on training: 212.90328574180603
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 466, 338, 1340, 311, 426, 781, 813, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 76, 12, 77, 96, 67, 3, 53, 25], weight: tensor([0.1687, 0.0609, 0.0695, 0.0504, 0.1999, 0.0464, 0.0635, 0.1165, 0.1213,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 43.59963607788086, obj_val: 47.999267578125, abs dis: 4.399631500244141
[rfa agg] iter: 0, weight: tensor([0.0669, 0.0350, 0.0510, 0.0238, 0.0545, 0.0185, 0.0365, 0.1848, 0.1924,
        0.3364])
[rfa agg] iter:  1, prev_obj_val: 47.999267578125, obj_val: 53.624794006347656, abs dis: 5.625526428222656
[rfa agg] iter: 1, weight: tensor([0.0682, 0.0654, 0.1090, 0.0408, 0.0589, 0.0301, 0.0681, 0.1238, 0.1291,
        0.3066])
[rfa agg] iter:  2, prev_obj_val: 53.624794006347656, obj_val: 64.07679748535156, abs dis: 10.452003479003906
[rfa agg] iter: 2, weight: tensor([0.0526, 0.1164, 0.2889, 0.0592, 0.0474, 0.0392, 0.1201, 0.0762, 0.0794,
        0.1206])
[rfa agg] iter:  3, prev_obj_val: 64.07679748535156, obj_val: 60.70362854003906, abs dis: 3.3731689453125
[rfa agg] iter: 3, weight: tensor([0.0336, 0.2276, 0.1029, 0.1833, 0.0316, 0.0689, 0.2166, 0.0409, 0.0426,
        0.0521])
[rfa agg] iter:  4, prev_obj_val: 60.70362854003906, obj_val: 80.07674407958984, abs dis: 19.37311553955078
[rfa agg] iter: 4, weight: tensor([0.0254, 0.3336, 0.1032, 0.0804, 0.0236, 0.0380, 0.2882, 0.0320, 0.0334,
        0.0423])
[rfa agg] iter:  5, prev_obj_val: 80.07674407958984, obj_val: 64.0549545288086, abs dis: 16.02178955078125
[rfa agg] iter: 5, weight: tensor([0.0507, 0.0984, 0.0800, 0.1336, 0.0492, 0.3081, 0.1024, 0.0555, 0.0579,
        0.0641])
[rfa agg] iter:  6, prev_obj_val: 64.0549545288086, obj_val: 60.703887939453125, abs dis: 3.3510665893554688
[rfa agg] iter: 6, weight: tensor([0.0328, 0.2229, 0.0987, 0.1906, 0.0309, 0.0685, 0.2230, 0.0400, 0.0417,
        0.0510])
[rfa agg] iter:  7, prev_obj_val: 60.703887939453125, obj_val: 80.07671356201172, abs dis: 19.372825622558594
[rfa agg] iter: 7, weight: tensor([0.0254, 0.3309, 0.1030, 0.0804, 0.0236, 0.0380, 0.2912, 0.0320, 0.0334,
        0.0422])
[rfa agg] iter:  8, prev_obj_val: 80.07671356201172, obj_val: 64.05496215820312, abs dis: 16.021751403808594
[rfa agg] iter: 8, weight: tensor([0.0507, 0.0984, 0.0800, 0.1336, 0.0492, 0.3081, 0.1024, 0.0555, 0.0579,
        0.0641])
[rfa agg] iter:  9, prev_obj_val: 64.05496215820312, obj_val: 60.703887939453125, abs dis: 3.35107421875
[rfa agg] iter: 9, weight: tensor([0.0328, 0.2229, 0.0987, 0.1906, 0.0309, 0.0685, 0.2230, 0.0400, 0.0417,
        0.0510])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3540, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.2822, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.0485463142395 sec.
Server Epoch:93 choose agents : [97, 94, 81, 1, 62, 45, 0, 15, 31, 32].
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   1, Avg loss: 0.0491, Accuracy: 374/1213 (30.8326%)
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 488/1213 (40.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1784, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0561, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 617/1662 (37.1239%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4825, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   1, Avg loss: 0.0633, Accuracy: 250/774 (32.2997%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   2, Avg loss: 0.0343, Accuracy: 307/774 (39.6641%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0070, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 291/928 (31.3578%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 583/928 (62.8233%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0852, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.5151, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0612, Accuracy: 252/669 (37.6682%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0374, Accuracy: 361/669 (53.9611%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.2623, Accuracy: 80/10000 (0.8000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 374/1657 (22.5709%)
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9354, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 458/1154 (39.6880%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.9988, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   1, Avg loss: 0.0768, Accuracy: 97/460 (21.0870%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   2, Avg loss: 0.0345, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.8645, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   1, Avg loss: 0.0592, Accuracy: 217/735 (29.5238%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 354/735 (48.1633%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.2632, Accuracy: 59/10000 (0.5900%)
time spent on training: 276.5945408344269
[rfa agg] training data poison_ratio: 0.16873727087576373  data num: [1213, 1662, 774, 928, 568, 669, 1657, 1154, 460, 735]
[rfa agg] considering poison per batch poison_fraction: 0.05273039714867617
[rfa agg] init. name: [97, 94, 81, 1, 62, 45, 0, 15, 31, 32], weight: tensor([0.1235, 0.1692, 0.0788, 0.0945, 0.0578, 0.0681, 0.1687, 0.1175, 0.0468,
        0.0748])
[rfa agg] iter:  0, prev_obj_val: 54.03147506713867, obj_val: 57.728206634521484, abs dis: 3.6967315673828125
[rfa agg] iter: 0, weight: tensor([0.1246, 0.0583, 0.1080, 0.3479, 0.0322, 0.0543, 0.0581, 0.1180, 0.0226,
        0.0761])
[rfa agg] iter:  1, prev_obj_val: 57.728206634521484, obj_val: 61.150665283203125, abs dis: 3.4224586486816406
[rfa agg] iter: 1, weight: tensor([0.0833, 0.0481, 0.2024, 0.2773, 0.0393, 0.0757, 0.0480, 0.0791, 0.0266,
        0.1202])
[rfa agg] iter:  2, prev_obj_val: 61.150665283203125, obj_val: 61.10517120361328, abs dis: 0.04549407958984375
[rfa agg] iter: 2, weight: tensor([0.0619, 0.0394, 0.3084, 0.1362, 0.0434, 0.0974, 0.0393, 0.0588, 0.0283,
        0.1869])
[rfa agg] iter:  3, prev_obj_val: 61.10517120361328, obj_val: 68.35929107666016, abs dis: 7.254119873046875
[rfa agg] iter: 3, weight: tensor([0.0586, 0.0374, 0.3438, 0.1262, 0.0412, 0.0919, 0.0373, 0.0557, 0.0268,
        0.1813])
[rfa agg] iter:  4, prev_obj_val: 68.35929107666016, obj_val: 78.02191162109375, abs dis: 9.662620544433594
[rfa agg] iter: 4, weight: tensor([0.0494, 0.0352, 0.1465, 0.0794, 0.0679, 0.2258, 0.0351, 0.0469, 0.0398,
        0.2742])
[rfa agg] iter:  5, prev_obj_val: 78.02191162109375, obj_val: 71.2833480834961, abs dis: 6.738563537597656
[rfa agg] iter: 5, weight: tensor([0.0529, 0.0408, 0.0980, 0.0721, 0.1933, 0.2249, 0.0407, 0.0503, 0.0876,
        0.1393])
[rfa agg] iter:  6, prev_obj_val: 71.2833480834961, obj_val: 78.01424407958984, abs dis: 6.73089599609375
[rfa agg] iter: 6, weight: tensor([0.0455, 0.0334, 0.1074, 0.0686, 0.0833, 0.3551, 0.0333, 0.0433, 0.0457,
        0.1844])
[rfa agg] iter:  7, prev_obj_val: 78.01424407958984, obj_val: 71.28192138671875, abs dis: 6.732322692871094
[rfa agg] iter: 7, weight: tensor([0.0523, 0.0404, 0.0965, 0.0714, 0.1920, 0.2341, 0.0403, 0.0498, 0.0868,
        0.1362])
[rfa agg] iter:  8, prev_obj_val: 71.28192138671875, obj_val: 78.01457977294922, abs dis: 6.732658386230469
[rfa agg] iter: 8, weight: tensor([0.0453, 0.0332, 0.1069, 0.0683, 0.0829, 0.3581, 0.0331, 0.0431, 0.0455,
        0.1834])
[rfa agg] iter:  9, prev_obj_val: 78.01457977294922, obj_val: 71.28189086914062, abs dis: 6.732688903808594
[rfa agg] iter: 9, weight: tensor([0.0523, 0.0404, 0.0965, 0.0714, 0.1919, 0.2343, 0.0403, 0.0498, 0.0868,
        0.1362])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3557, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.2088, Accuracy: 0/9950 (0.0000%)
saving model
Done in 435.9141540527344 sec.
Server Epoch:94 choose agents : [80, 7, 37, 2, 99, 16, 49, 71, 59, 78].
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   1, Avg loss: 0.0667, Accuracy: 180/682 (26.3930%)
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 232/682 (34.0176%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.4999, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   1, Avg loss: 0.0512, Accuracy: 361/891 (40.5163%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   2, Avg loss: 0.0248, Accuracy: 454/891 (50.9540%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.0328, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 432/1129 (38.2640%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 733/1129 (64.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.3697, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0591, Accuracy: 246/605 (40.6612%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.8675, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   1, Avg loss: 0.0624, Accuracy: 204/773 (26.3907%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   2, Avg loss: 0.0273, Accuracy: 408/773 (52.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2021, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1, Avg loss: 0.0621, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9037, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   1, Avg loss: 0.0789, Accuracy: 44/440 (10.0000%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.2681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   1, Avg loss: 0.0631, Accuracy: 186/818 (22.7384%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   2, Avg loss: 0.0297, Accuracy: 393/818 (48.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2596, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   1, Avg loss: 0.0579, Accuracy: 317/1089 (29.1093%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 425/1089 (39.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 12.3182, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   1, Avg loss: 0.0790, Accuracy: 71/416 (17.0673%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   2, Avg loss: 0.0440, Accuracy: 186/416 (44.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.5470, Accuracy: 60/10000 (0.6000%)
time spent on training: 216.81348037719727
[rfa agg] training data poison_ratio: 0.0  data num: [682, 891, 1129, 605, 773, 708, 440, 818, 1089, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 7, 37, 2, 99, 16, 49, 71, 59, 78], weight: tensor([0.0903, 0.1180, 0.1495, 0.0801, 0.1024, 0.0938, 0.0583, 0.1083, 0.1442,
        0.0551])
[rfa agg] iter:  0, prev_obj_val: 34.82815170288086, obj_val: 37.52631759643555, abs dis: 2.6981658935546875
[rfa agg] iter: 0, weight: tensor([0.2499, 0.0735, 0.0443, 0.2079, 0.0879, 0.1288, 0.0369, 0.0935, 0.0425,
        0.0348])
[rfa agg] iter:  1, prev_obj_val: 37.52631759643555, obj_val: 44.00341033935547, abs dis: 6.477092742919922
[rfa agg] iter: 1, weight: tensor([0.1840, 0.0662, 0.0425, 0.3209, 0.0759, 0.1033, 0.0441, 0.0807, 0.0408,
        0.0416])
[rfa agg] iter:  2, prev_obj_val: 44.00341033935547, obj_val: 40.667972564697266, abs dis: 3.335437774658203
[rfa agg] iter: 2, weight: tensor([0.1406, 0.0753, 0.0534, 0.2333, 0.0814, 0.0994, 0.0923, 0.0864, 0.0513,
        0.0866])
[rfa agg] iter:  3, prev_obj_val: 40.667972564697266, obj_val: 47.39651870727539, abs dis: 6.728546142578125
[rfa agg] iter: 3, weight: tensor([0.1539, 0.0706, 0.0478, 0.2977, 0.0783, 0.1002, 0.0631, 0.0832, 0.0459,
        0.0594])
[rfa agg] iter:  4, prev_obj_val: 47.39651870727539, obj_val: 47.386871337890625, abs dis: 0.009647369384765625
[rfa agg] iter: 4, weight: tensor([0.1244, 0.0750, 0.0553, 0.1792, 0.0793, 0.0935, 0.1324, 0.0841, 0.0532,
        0.1236])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3574, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.2181, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.49242091178894 sec.
Server Epoch:95 choose agents : [58, 24, 20, 10, 29, 56, 51, 25, 5, 3].
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 337/803 (41.9676%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 379/803 (47.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.7705, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   1, Avg loss: 0.0796, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   2, Avg loss: 0.0423, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.1396, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1, Avg loss: 0.0583, Accuracy: 316/807 (39.1574%)
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 406/807 (50.3098%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.8849, Accuracy: 79/10000 (0.7900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0557, Accuracy: 213/861 (24.7387%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0209, Accuracy: 465/861 (54.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.7961, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0501, Accuracy: 419/1440 (29.0972%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7545, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.4072, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   1, Avg loss: 0.0588, Accuracy: 285/1049 (27.1687%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 523/1049 (49.8570%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.3386, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   1, Avg loss: 0.0495, Accuracy: 368/690 (53.3333%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   2, Avg loss: 0.0247, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9812, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 372/1628 (22.8501%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 803/1628 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5928, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0713, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 245/781 (31.3700%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1230, Accuracy: 104/10000 (1.0400%)
time spent on training: 298.22970724105835
[rfa agg] training data poison_ratio: 0.19492812901717893  data num: [803, 312, 807, 861, 1440, 186, 1049, 690, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.060915040317868416
[rfa agg] init. name: [58, 24, 20, 10, 29, 56, 51, 25, 5, 3], weight: tensor([0.0938, 0.0365, 0.0943, 0.1006, 0.1683, 0.0217, 0.1226, 0.0806, 0.1903,
        0.0913])
[rfa agg] iter:  0, prev_obj_val: 48.25275421142578, obj_val: 52.947200775146484, abs dis: 4.694446563720703
[rfa agg] iter: 0, weight: tensor([0.1468, 0.0098, 0.1402, 0.2888, 0.0503, 0.0048, 0.1176, 0.0580, 0.0421,
        0.1417])
[rfa agg] iter:  1, prev_obj_val: 52.947200775146484, obj_val: 58.926963806152344, abs dis: 5.979763031005859
[rfa agg] iter: 1, weight: tensor([0.2290, 0.0095, 0.2006, 0.1228, 0.0313, 0.0045, 0.0523, 0.0990, 0.0275,
        0.2234])
[rfa agg] iter:  2, prev_obj_val: 58.926963806152344, obj_val: 69.76152801513672, abs dis: 10.834564208984375
[rfa agg] iter: 2, weight: tensor([0.1537, 0.0147, 0.1487, 0.1018, 0.0383, 0.0067, 0.0576, 0.2952, 0.0343,
        0.1489])
[rfa agg] iter:  3, prev_obj_val: 69.76152801513672, obj_val: 58.902889251708984, abs dis: 10.858638763427734
[rfa agg] iter: 3, weight: tensor([0.1264, 0.0299, 0.1252, 0.1020, 0.0531, 0.0128, 0.0714, 0.3077, 0.0488,
        0.1227])
[rfa agg] iter:  4, prev_obj_val: 58.902889251708984, obj_val: 65.90433502197266, abs dis: 7.001445770263672
[rfa agg] iter: 4, weight: tensor([0.1484, 0.0142, 0.1414, 0.0987, 0.0371, 0.0065, 0.0559, 0.3214, 0.0333,
        0.1432])
[rfa agg] iter:  5, prev_obj_val: 65.90433502197266, obj_val: 69.76300811767578, abs dis: 3.858673095703125
[rfa agg] iter: 5, weight: tensor([0.1152, 0.0208, 0.1134, 0.0888, 0.0423, 0.0091, 0.0588, 0.4013, 0.0386,
        0.1117])
[rfa agg] iter:  6, prev_obj_val: 69.76300811767578, obj_val: 58.902828216552734, abs dis: 10.860179901123047
[rfa agg] iter: 6, weight: tensor([0.1256, 0.0297, 0.1241, 0.1014, 0.0528, 0.0127, 0.0710, 0.3122, 0.0485,
        0.1219])
[rfa agg] iter:  7, prev_obj_val: 58.902828216552734, obj_val: 65.90428924560547, abs dis: 7.001461029052734
[rfa agg] iter: 7, weight: tensor([0.1482, 0.0142, 0.1412, 0.0986, 0.0371, 0.0065, 0.0558, 0.3220, 0.0333,
        0.1430])
[rfa agg] iter:  8, prev_obj_val: 65.90428924560547, obj_val: 69.76300811767578, abs dis: 3.8587188720703125
[rfa agg] iter: 8, weight: tensor([0.1152, 0.0208, 0.1134, 0.0888, 0.0423, 0.0091, 0.0588, 0.4014, 0.0386,
        0.1117])
[rfa agg] iter:  9, prev_obj_val: 69.76300811767578, obj_val: 58.902828216552734, abs dis: 10.860179901123047
[rfa agg] iter: 9, weight: tensor([0.1256, 0.0297, 0.1241, 0.1014, 0.0528, 0.0127, 0.0710, 0.3122, 0.0485,
        0.1219])
			Update norm = 102.96858877073872 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3574, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.2181, Accuracy: 0/9950 (0.0000%)
saving model
Done in 463.3705544471741 sec.
Server Epoch:96 choose agents : [84, 4, 1, 11, 43, 2, 62, 12, 31, 82].
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 445/1190 (37.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.9998, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0619, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 377/901 (41.8424%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1859, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 568/928 (61.2069%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8544, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 334/712 (46.9101%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3956, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 292/946 (30.8668%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   2, Avg loss: 0.0350, Accuracy: 392/946 (41.4376%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.1087, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0601, Accuracy: 258/605 (42.6446%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0366, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.8422, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   1, Avg loss: 0.0668, Accuracy: 163/568 (28.6972%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   2, Avg loss: 0.0395, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6714, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0834, Accuracy: 35/338 (10.3550%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0449, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4455, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   1, Avg loss: 0.0751, Accuracy: 99/460 (21.5217%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   2, Avg loss: 0.0348, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.1107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0699, Accuracy: 116/500 (23.2000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6811, Accuracy: 69/10000 (0.6900%)
time spent on training: 242.2567937374115
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 901, 928, 712, 946, 605, 568, 338, 460, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 4, 1, 11, 43, 2, 62, 12, 31, 82], weight: tensor([0.1665, 0.1260, 0.1298, 0.0996, 0.1323, 0.0846, 0.0795, 0.0473, 0.0644,
        0.0699])
[rfa agg] iter:  0, prev_obj_val: 36.65289306640625, obj_val: 40.14152908325195, abs dis: 3.488636016845703
[rfa agg] iter: 0, weight: tensor([0.0498, 0.0706, 0.0726, 0.1584, 0.0741, 0.2849, 0.1284, 0.0267, 0.0645,
        0.0699])
[rfa agg] iter:  1, prev_obj_val: 40.14152908325195, obj_val: 48.22821044921875, abs dis: 8.086681365966797
[rfa agg] iter: 1, weight: tensor([0.0371, 0.0482, 0.0497, 0.0828, 0.0506, 0.2730, 0.2485, 0.0285, 0.0871,
        0.0945])
[rfa agg] iter:  2, prev_obj_val: 48.22821044921875, obj_val: 48.15274429321289, abs dis: 0.07546615600585938
[rfa agg] iter: 2, weight: tensor([0.0286, 0.0339, 0.0349, 0.0467, 0.0356, 0.0784, 0.1401, 0.0439, 0.2676,
        0.2904])
[rfa agg] iter:  3, prev_obj_val: 48.15274429321289, obj_val: 63.973026275634766, abs dis: 15.820281982421875
[rfa agg] iter: 3, weight: tensor([0.0250, 0.0297, 0.0305, 0.0408, 0.0312, 0.0679, 0.1201, 0.0386, 0.2990,
        0.3171])
[rfa agg] iter:  4, prev_obj_val: 63.973026275634766, obj_val: 59.83274841308594, abs dis: 4.140277862548828
[rfa agg] iter: 4, weight: tensor([0.0410, 0.0448, 0.0461, 0.0530, 0.0470, 0.0673, 0.0840, 0.4045, 0.1018,
        0.1105])
[rfa agg] iter:  5, prev_obj_val: 59.83274841308594, obj_val: 55.821678161621094, abs dis: 4.011070251464844
[rfa agg] iter: 5, weight: tensor([0.0437, 0.0486, 0.0501, 0.0593, 0.0511, 0.0787, 0.1029, 0.2821, 0.1366,
        0.1468])
[rfa agg] iter:  6, prev_obj_val: 55.821678161621094, obj_val: 51.86643600463867, abs dis: 3.955242156982422
[rfa agg] iter: 6, weight: tensor([0.0435, 0.0493, 0.0507, 0.0622, 0.0517, 0.0873, 0.1218, 0.1431, 0.1887,
        0.2016])
[rfa agg] iter:  7, prev_obj_val: 51.86643600463867, obj_val: 51.862369537353516, abs dis: 0.00406646728515625
[rfa agg] iter: 7, weight: tensor([0.0349, 0.0403, 0.0416, 0.0530, 0.0424, 0.0801, 0.1226, 0.0743, 0.2487,
        0.2621])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3595, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.2305, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.0483195781708 sec.
Server Epoch:97 choose agents : [82, 9, 2, 32, 45, 55, 65, 3, 16, 6].
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0683, Accuracy: 121/500 (24.2000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0466, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.6471, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 355/1275 (27.8431%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 739/1275 (57.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.5774, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0585, Accuracy: 261/605 (43.1405%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.8258, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   1, Avg loss: 0.0571, Accuracy: 222/735 (30.2041%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 367/735 (49.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.0932, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   1, Avg loss: 0.0600, Accuracy: 248/669 (37.0703%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   2, Avg loss: 0.0361, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4208, Accuracy: 79/10000 (0.7900%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   1, Avg loss: 0.0537, Accuracy: 302/1071 (28.1979%)
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.9226, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 413/1475 (28.0000%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 641/1475 (43.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3221, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0716, Accuracy: 118/781 (15.1088%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 234/781 (29.9616%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7403, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2, Avg loss: 0.0345, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1489, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 410/1956 (20.9611%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5210, Accuracy: 126/10000 (1.2600%)
time spent on training: 273.98839235305786
[rfa agg] training data poison_ratio: 0.10956521739130434  data num: [500, 1275, 605, 735, 669, 1071, 1475, 781, 708, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034239130434782605
[rfa agg] init. name: [82, 9, 2, 32, 45, 55, 65, 3, 16, 6], weight: tensor([0.0512, 0.1304, 0.0619, 0.0752, 0.0684, 0.1096, 0.1509, 0.0799, 0.0724,
        0.2001])
[rfa agg] iter:  0, prev_obj_val: 60.83452224731445, obj_val: 63.00041198730469, abs dis: 2.1658897399902344
[rfa agg] iter: 0, weight: tensor([0.0228, 0.1381, 0.0360, 0.0627, 0.0469, 0.4203, 0.0758, 0.0851, 0.0601,
        0.0523])
[rfa agg] iter:  1, prev_obj_val: 63.00041198730469, obj_val: 65.58692932128906, abs dis: 2.586517333984375
[rfa agg] iter: 1, weight: tensor([0.0317, 0.1124, 0.0536, 0.1065, 0.0737, 0.2305, 0.0727, 0.1631, 0.1013,
        0.0545])
[rfa agg] iter:  2, prev_obj_val: 65.58692932128906, obj_val: 68.11981201171875, abs dis: 2.5328826904296875
[rfa agg] iter: 2, weight: tensor([0.0289, 0.0624, 0.0547, 0.1459, 0.0833, 0.0960, 0.0448, 0.3140, 0.1342,
        0.0358])
[rfa agg] iter:  3, prev_obj_val: 68.11981201171875, obj_val: 75.39042663574219, abs dis: 7.2706146240234375
[rfa agg] iter: 3, weight: tensor([0.0256, 0.0393, 0.0549, 0.2311, 0.0957, 0.0543, 0.0297, 0.2625, 0.1825,
        0.0245])
[rfa agg] iter:  4, prev_obj_val: 75.39042663574219, obj_val: 78.57211303710938, abs dis: 3.1816864013671875
[rfa agg] iter: 4, weight: tensor([0.0416, 0.0360, 0.1347, 0.1682, 0.2766, 0.0450, 0.0289, 0.0966, 0.1474,
        0.0249])
[rfa agg] iter:  5, prev_obj_val: 78.57211303710938, obj_val: 85.884521484375, abs dis: 7.312408447265625
[rfa agg] iter: 5, weight: tensor([0.0523, 0.0361, 0.2299, 0.1244, 0.2617, 0.0441, 0.0294, 0.0818, 0.1146,
        0.0257])
[rfa agg] iter:  6, prev_obj_val: 85.884521484375, obj_val: 85.87194061279297, abs dis: 0.01258087158203125
[rfa agg] iter: 6, weight: tensor([0.1071, 0.0422, 0.3149, 0.1000, 0.1481, 0.0495, 0.0354, 0.0766, 0.0945,
        0.0317])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3629, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.1780, Accuracy: 0/9950 (0.0000%)
saving model
Done in 439.1193015575409 sec.
Server Epoch:98 choose agents : [40, 38, 88, 79, 89, 8, 28, 43, 27, 58].
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 368/1573 (23.3948%)
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   2, Avg loss: 0.0341, Accuracy: 594/1573 (37.7622%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7648, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 273/1131 (24.1379%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 479/1131 (42.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2647, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0692, Accuracy: 160/603 (26.5340%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0429, Accuracy: 276/603 (45.7711%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1516, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   2, Avg loss: 0.0860, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4404, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0596, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.9074, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   1, Avg loss: 0.0579, Accuracy: 256/1513 (16.9200%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 503/1513 (33.2452%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0087, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   1, Avg loss: 0.0555, Accuracy: 396/1581 (25.0474%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   2, Avg loss: 0.0328, Accuracy: 606/1581 (38.3302%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6555, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 291/946 (30.7611%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0351, Accuracy: 340/946 (35.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.0128, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   1, Avg loss: 0.0546, Accuracy: 394/1587 (24.8267%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 610/1587 (38.4373%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.8052, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 334/803 (41.5940%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.8132, Accuracy: 66/10000 (0.6600%)
time spent on training: 291.24881863594055
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 1131, 603, 197, 896, 1513, 1581, 946, 1587, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 38, 88, 79, 89, 8, 28, 43, 27, 58], weight: tensor([0.1452, 0.1044, 0.0557, 0.0182, 0.0827, 0.1397, 0.1460, 0.0873, 0.1465,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 51.08516311645508, obj_val: 55.44544982910156, abs dis: 4.360286712646484
[rfa agg] iter: 0, weight: tensor([0.0724, 0.4496, 0.0244, 0.0046, 0.0716, 0.0810, 0.0729, 0.0987, 0.0731,
        0.0516])
[rfa agg] iter:  1, prev_obj_val: 55.44544982910156, obj_val: 57.06222915649414, abs dis: 1.6167793273925781
[rfa agg] iter: 1, weight: tensor([0.0684, 0.2663, 0.0343, 0.0059, 0.1279, 0.0743, 0.0688, 0.2021, 0.0689,
        0.0831])
[rfa agg] iter:  2, prev_obj_val: 57.06222915649414, obj_val: 57.05158615112305, abs dis: 0.01064300537109375
[rfa agg] iter: 2, weight: tensor([0.0618, 0.1910, 0.0356, 0.0058, 0.1511, 0.0667, 0.0622, 0.2710, 0.0623,
        0.0924])
[rfa agg] iter:  3, prev_obj_val: 57.05158615112305, obj_val: 57.051517486572266, abs dis: 6.866455078125e-05
[rfa agg] iter: 3, weight: tensor([0.0613, 0.1872, 0.0353, 0.0058, 0.1502, 0.0661, 0.0616, 0.2789, 0.0618,
        0.0918])
			Update norm = 143.19000979904288 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3629, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.1780, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.82251834869385 sec.
Server Epoch:99 choose agents : [75, 60, 66, 94, 77, 17, 26, 35, 23, 61].
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   1, Avg loss: 0.0661, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8100, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 594/2227 (26.6727%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1035/2227 (46.4751%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4291, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0381, Accuracy: 415/1402 (29.6006%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1190, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 338/1662 (20.3369%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1662 (37.1841%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.2177, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0508, Accuracy: 350/1340 (26.1194%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 573/1340 (42.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.4820, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 388/1574 (24.6506%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   2, Avg loss: 0.0270, Accuracy: 700/1574 (44.4727%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0817, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 331/1446 (22.8907%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 542/1446 (37.4827%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7501, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 22/271 (8.1181%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0539, Accuracy: 126/271 (46.4945%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.9162, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0636, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1073, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1303, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3703, Accuracy: 58/10000 (0.5800%)
time spent on training: 288.31920289993286
[rfa agg] training data poison_ratio: 0.0  data num: [776, 2227, 1402, 1662, 1340, 1574, 1446, 271, 715, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 60, 66, 94, 77, 17, 26, 35, 23, 61], weight: tensor([0.0675, 0.1937, 0.1219, 0.1445, 0.1165, 0.1369, 0.1258, 0.0236, 0.0622,
        0.0074])
[rfa agg] iter:  0, prev_obj_val: 55.35509490966797, obj_val: 57.65326690673828, abs dis: 2.2981719970703125
[rfa agg] iter: 0, weight: tensor([0.0230, 0.0379, 0.2393, 0.0780, 0.3495, 0.0919, 0.1564, 0.0040, 0.0189,
        0.0011])
[rfa agg] iter:  1, prev_obj_val: 57.65326690673828, obj_val: 60.44026565551758, abs dis: 2.786998748779297
[rfa agg] iter: 1, weight: tensor([0.0261, 0.0389, 0.2067, 0.0753, 0.4024, 0.0868, 0.1370, 0.0044, 0.0212,
        0.0012])
[rfa agg] iter:  2, prev_obj_val: 60.44026565551758, obj_val: 63.331207275390625, abs dis: 2.890941619873047
[rfa agg] iter: 2, weight: tensor([0.0345, 0.0464, 0.2011, 0.0855, 0.3569, 0.0969, 0.1436, 0.0057, 0.0279,
        0.0015])
[rfa agg] iter:  3, prev_obj_val: 63.331207275390625, obj_val: 63.32832717895508, abs dis: 0.002880096435546875
[rfa agg] iter: 3, weight: tensor([0.0445, 0.0539, 0.1990, 0.0950, 0.3072, 0.1061, 0.1498, 0.0070, 0.0356,
        0.0018])
			Update norm = 174.48471011094352 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3629, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.1780, Accuracy: 0/9950 (0.0000%)
saving model
Done in 449.45044589042664 sec.
Server Epoch:100 choose agents : [25, 52, 37, 70, 26, 86, 40, 66, 98, 83].
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   1, Avg loss: 0.0496, Accuracy: 354/690 (51.3043%)
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   2, Avg loss: 0.0252, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4100, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0521, Accuracy: 307/636 (48.2704%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0294, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.5316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0508, Accuracy: 419/1129 (37.1125%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0238, Accuracy: 760/1129 (67.3162%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2918, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 377/1418 (26.5867%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 675/1418 (47.6023%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2983, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 356/1446 (24.6196%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8561, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0641, Accuracy: 344/1003 (34.2971%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 364/1003 (36.2911%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.5065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 370/1573 (23.5219%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 582/1573 (36.9994%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8083, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1, Avg loss: 0.0610, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 390/1402 (27.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7168, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   1, Avg loss: 0.0758, Accuracy: 58/373 (15.5496%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.2852, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 748/1953 (38.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0458, Accuracy: 112/10000 (1.1200%)
time spent on training: 330.48043870925903
[rfa agg] training data poison_ratio: 0.0  data num: [690, 636, 1129, 1418, 1446, 1003, 1573, 1402, 373, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 52, 37, 70, 26, 86, 40, 66, 98, 83], weight: tensor([0.0594, 0.0547, 0.0971, 0.1220, 0.1244, 0.0863, 0.1353, 0.1206, 0.0321,
        0.1680])
[rfa agg] iter:  0, prev_obj_val: 53.88511657714844, obj_val: 57.25836181640625, abs dis: 3.3732452392578125
[rfa agg] iter: 0, weight: tensor([0.0298, 0.0244, 0.2804, 0.1197, 0.1227, 0.1114, 0.0897, 0.1557, 0.0099,
        0.0563])
[rfa agg] iter:  1, prev_obj_val: 57.25836181640625, obj_val: 61.64933776855469, abs dis: 4.3909759521484375
[rfa agg] iter: 1, weight: tensor([0.0288, 0.0233, 0.4278, 0.0819, 0.0838, 0.1355, 0.0653, 0.1005, 0.0091,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 61.64933776855469, obj_val: 66.64559936523438, abs dis: 4.9962615966796875
[rfa agg] iter: 2, weight: tensor([0.0376, 0.0297, 0.3170, 0.0768, 0.0784, 0.2488, 0.0642, 0.0906, 0.0111,
        0.0458])
[rfa agg] iter:  3, prev_obj_val: 66.64559936523438, obj_val: 69.44638061523438, abs dis: 2.80078125
[rfa agg] iter: 3, weight: tensor([0.0440, 0.0338, 0.1705, 0.0646, 0.0659, 0.4373, 0.0559, 0.0742, 0.0120,
        0.0418])
[rfa agg] iter:  4, prev_obj_val: 69.44638061523438, obj_val: 69.44476318359375, abs dis: 0.001617431640625
[rfa agg] iter: 4, weight: tensor([0.0508, 0.0384, 0.1421, 0.0628, 0.0642, 0.4598, 0.0552, 0.0715, 0.0131,
        0.0421])
			Update norm = 138.74341200575975 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3629, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.1780, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.7411878108978 sec.
Saving all the graphs.
This run has a label: Jun.29_22.04.19. Visdom environment: tiny
