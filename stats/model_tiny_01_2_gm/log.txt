current path: saved_models/model_tiny_Jun.20_19.29.16
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 788/1953 (40.3482%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.6224, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 456/1988 (22.9376%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8285, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 306/953 (32.1091%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.5836, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9654, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 484/1130 (42.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6806, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 230/1071 (21.4753%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5671, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 609/1587 (38.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1688, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 456/1715 (26.5889%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 709/1715 (41.3411%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5013, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 311/1154 (26.9497%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 378/1154 (32.7556%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7692, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5489, Accuracy: 50/10000 (0.5000%)
time spent on training: 92.24516272544861
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 85, 64, 95, 54, 55, 27, 92, 15, 78], weight: tensor([0.1554, 0.1582, 0.0758, 0.0477, 0.0899, 0.0852, 0.1263, 0.1365, 0.0918,
        0.0331])
[rfa agg] iter:  0, prev_obj_val: 62.10165786743164, obj_val: 65.48184967041016, abs dis: 3.3801918029785156
[rfa agg] iter:  0, weight: tensor([0.0799, 0.0739, 0.0646, 0.0223, 0.1475, 0.1071, 0.1590, 0.1161, 0.2173,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 65.48184967041016, obj_val: 70.74098205566406, abs dis: 5.259132385253906
[rfa agg] iter:  1, weight: tensor([0.0404, 0.0380, 0.0580, 0.0165, 0.2118, 0.1211, 0.0652, 0.0530, 0.3874,
        0.0086])
[rfa agg] iter:  2, prev_obj_val: 70.74098205566406, obj_val: 73.08756256103516, abs dis: 2.3465805053710938
[rfa agg] iter:  2, weight: tensor([0.0358, 0.0339, 0.0886, 0.0197, 0.2919, 0.2457, 0.0521, 0.0445, 0.1780,
        0.0098])
[rfa agg] iter:  3, prev_obj_val: 73.08756256103516, obj_val: 70.66352844238281, abs dis: 2.4240341186523438
[rfa agg] iter:  3, weight: tensor([0.0351, 0.0334, 0.1107, 0.0215, 0.2280, 0.3326, 0.0497, 0.0431, 0.1354,
        0.0104])
[rfa agg] iter:  4, prev_obj_val: 70.66352844238281, obj_val: 70.65388488769531, abs dis: 0.0096435546875
[rfa agg] iter:  4, weight: tensor([0.0342, 0.0324, 0.0861, 0.0189, 0.2727, 0.2953, 0.0498, 0.0426, 0.1586,
        0.0093])
[rfa agg] iter:  5, prev_obj_val: 70.65388488769531, obj_val: 70.65296173095703, abs dis: 0.00092315673828125
[rfa agg] iter:  5, weight: tensor([0.0342, 0.0324, 0.0857, 0.0188, 0.2872, 0.2799, 0.0498, 0.0426, 0.1600,
        0.0093])
[rfa agg] iter:  6, prev_obj_val: 70.65296173095703, obj_val: 70.65287017822266, abs dis: 9.1552734375e-05
[rfa agg] iter:  6, weight: tensor([0.0342, 0.0324, 0.0856, 0.0188, 0.2922, 0.2748, 0.0498, 0.0426, 0.1601,
        0.0093])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3068, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3501, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.79264378547668 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 146/953 (15.3200%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0387, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4947, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1232, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1106, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3236, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 294/946 (31.0782%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2512, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 298/715 (41.6783%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7709, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0786, Accuracy: 15/312 (4.8077%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0838, Accuracy: 10/373 (2.6810%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.5209, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 306/1190 (25.7143%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 419/1190 (35.2101%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.4985, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0571, Accuracy: 391/1581 (24.7312%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 577/1581 (36.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5757, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0565, Accuracy: 360/1956 (18.4049%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 653/1956 (33.3845%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1046, Accuracy: 117/10000 (1.1700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 386/1574 (24.5235%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 650/1574 (41.2961%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0194, Accuracy: 85/10000 (0.8500%)
time spent on training: 125.55144572257996
[rfa agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.05053164166837888
[rfa agg] init. name: [64, 47, 43, 23, 24, 98, 84, 28, 6, 17], weight: tensor([0.0979, 0.0138, 0.0972, 0.0735, 0.0321, 0.0383, 0.1223, 0.1624, 0.2009,
        0.1617])
[rfa agg] iter:  0, prev_obj_val: 63.66173553466797, obj_val: 64.59385681152344, abs dis: 0.9321212768554688
[rfa agg] iter:  0, weight: tensor([0.1153, 0.0037, 0.1151, 0.0476, 0.0100, 0.0130, 0.4172, 0.1053, 0.0681,
        0.1047])
[rfa agg] iter:  1, prev_obj_val: 64.59385681152344, obj_val: 68.57087707519531, abs dis: 3.977020263671875
[rfa agg] iter:  1, weight: tensor([0.1296, 0.0038, 0.1296, 0.0502, 0.0102, 0.0132, 0.4090, 0.0955, 0.0640,
        0.0950])
[rfa agg] iter:  2, prev_obj_val: 68.57087707519531, obj_val: 68.48484802246094, abs dis: 0.086029052734375
[rfa agg] iter:  2, weight: tensor([0.2378, 0.0043, 0.2415, 0.0681, 0.0118, 0.0155, 0.2003, 0.0811, 0.0590,
        0.0807])
[rfa agg] iter:  3, prev_obj_val: 68.48484802246094, obj_val: 71.42491912841797, abs dis: 2.9400711059570312
[rfa agg] iter:  3, weight: tensor([0.2455, 0.0042, 0.2483, 0.0672, 0.0116, 0.0152, 0.1907, 0.0798, 0.0581,
        0.0794])
[rfa agg] iter:  4, prev_obj_val: 71.42491912841797, obj_val: 75.74520874023438, abs dis: 4.320289611816406
[rfa agg] iter:  4, weight: tensor([0.3277, 0.0032, 0.3472, 0.0606, 0.0090, 0.0119, 0.1003, 0.0509, 0.0387,
        0.0506])
[rfa agg] iter:  5, prev_obj_val: 75.74520874023438, obj_val: 75.74303436279297, abs dis: 0.00217437744140625
[rfa agg] iter:  5, weight: tensor([0.3374, 0.0034, 0.3588, 0.0789, 0.0096, 0.0128, 0.0758, 0.0443, 0.0350,
        0.0441])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3074, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.2999, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.37495255470276 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0618, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0303, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3447, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0584, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 378/803 (47.0735%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.2578, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0515, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6776, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 314/1190 (26.3866%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 431/1190 (36.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4014, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 349/1662 (20.9988%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0048, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 291/1645 (17.6900%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0338, Accuracy: 588/1645 (35.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8247, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0745, Accuracy: 131/781 (16.7734%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 200/781 (25.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8566, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0594, Accuracy: 251/590 (42.5424%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0332, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1831, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0564, Accuracy: 400/1742 (22.9621%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 701/1742 (40.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0098, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0558, Accuracy: 229/861 (26.5970%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 463/861 (53.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1607, Accuracy: 52/10000 (0.5200%)
time spent on training: 119.0122082233429
[rfa agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 58, 7, 84, 94, 13, 3, 69, 93, 10], weight: tensor([0.0709, 0.0734, 0.0814, 0.1088, 0.1519, 0.1504, 0.0714, 0.0539, 0.1592,
        0.0787])
[rfa agg] iter:  0, prev_obj_val: 58.19357681274414, obj_val: 60.14503479003906, abs dis: 1.9514579772949219
[rfa agg] iter:  0, weight: tensor([0.0838, 0.0868, 0.1267, 0.2291, 0.0810, 0.0801, 0.0840, 0.0369, 0.0696,
        0.1221])
[rfa agg] iter:  1, prev_obj_val: 60.14503479003906, obj_val: 67.41869354248047, abs dis: 7.273658752441406
[rfa agg] iter:  1, weight: tensor([0.1046, 0.1080, 0.1884, 0.1164, 0.0559, 0.0553, 0.1046, 0.0377, 0.0493,
        0.1799])
[rfa agg] iter:  2, prev_obj_val: 67.41869354248047, obj_val: 74.21013641357422, abs dis: 6.79144287109375
[rfa agg] iter:  2, weight: tensor([0.1933, 0.1992, 0.1419, 0.0378, 0.0247, 0.0245, 0.1832, 0.0370, 0.0225,
        0.1359])
[rfa agg] iter:  3, prev_obj_val: 74.21013641357422, obj_val: 78.03050231933594, abs dis: 3.8203659057617188
[rfa agg] iter:  3, weight: tensor([0.1809, 0.1865, 0.1186, 0.0476, 0.0336, 0.0333, 0.1749, 0.0787, 0.0308,
        0.1150])
[rfa agg] iter:  4, prev_obj_val: 78.03050231933594, obj_val: 63.02385330200195, abs dis: 15.006649017333984
[rfa agg] iter:  4, weight: tensor([0.1599, 0.1651, 0.1164, 0.0534, 0.0390, 0.0386, 0.1575, 0.1215, 0.0359,
        0.1128])
[rfa agg] iter:  5, prev_obj_val: 63.02385330200195, obj_val: 70.59856414794922, abs dis: 7.574710845947266
[rfa agg] iter:  5, weight: tensor([0.1256, 0.1292, 0.2337, 0.0460, 0.0274, 0.0271, 0.1219, 0.0289, 0.0246,
        0.2356])
[rfa agg] iter:  6, prev_obj_val: 70.59856414794922, obj_val: 70.56021118164062, abs dis: 0.03835296630859375
[rfa agg] iter:  6, weight: tensor([0.1941, 0.2021, 0.1233, 0.0410, 0.0280, 0.0277, 0.1871, 0.0516, 0.0256,
        0.1196])
[rfa agg] iter:  7, prev_obj_val: 70.56021118164062, obj_val: 70.56001281738281, abs dis: 0.0001983642578125
[rfa agg] iter:  7, weight: tensor([0.2021, 0.2075, 0.1180, 0.0400, 0.0273, 0.0270, 0.1879, 0.0505, 0.0249,
        0.1148])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3264, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3484, Accuracy: 0/9950 (0.0000%)
saving model
Done in 216.84595894813538 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0592, Accuracy: 326/807 (40.3965%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9254, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0605, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7264, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 45/460 (9.7826%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0361, Accuracy: 184/460 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4338, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 396/776 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4822, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0571, Accuracy: 371/1956 (18.9673%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0331, Accuracy: 612/1956 (31.2883%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.4084, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0679, Accuracy: 268/715 (37.4825%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0568, Accuracy: 309/1573 (19.6440%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 543/1573 (34.5200%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8222, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0620, Accuracy: 229/1049 (21.8303%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 455/1049 (43.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7240, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0890, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0482, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 415/888 (46.7342%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.4795, Accuracy: 54/10000 (0.5400%)
time spent on training: 117.61825013160706
[rfa agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 64, 31, 75, 6, 23, 40, 51, 12, 63], weight: tensor([0.0848, 0.1002, 0.0483, 0.0816, 0.2056, 0.0751, 0.1653, 0.1102, 0.0355,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 59.82811737060547, obj_val: 61.39243698120117, abs dis: 1.5643196105957031
[rfa agg] iter:  0, weight: tensor([0.0798, 0.1919, 0.0191, 0.0765, 0.0479, 0.0554, 0.0654, 0.3334, 0.0114,
        0.1193])
[rfa agg] iter:  1, prev_obj_val: 61.39243698120117, obj_val: 73.46490478515625, abs dis: 12.072467803955078
[rfa agg] iter:  1, weight: tensor([0.1537, 0.1819, 0.0192, 0.1457, 0.0291, 0.0817, 0.0361, 0.0860, 0.0106,
        0.2560])
[rfa agg] iter:  2, prev_obj_val: 73.46490478515625, obj_val: 70.06777954101562, abs dis: 3.397125244140625
[rfa agg] iter:  2, weight: tensor([0.1685, 0.0935, 0.0448, 0.1601, 0.0353, 0.2491, 0.0409, 0.0660, 0.0212,
        0.1206])
[rfa agg] iter:  3, prev_obj_val: 70.06777954101562, obj_val: 76.92990112304688, abs dis: 6.86212158203125
[rfa agg] iter:  3, weight: tensor([0.1811, 0.0851, 0.0314, 0.1699, 0.0287, 0.2823, 0.0337, 0.0574, 0.0155,
        0.1148])
[rfa agg] iter:  4, prev_obj_val: 76.92990112304688, obj_val: 73.39826202392578, abs dis: 3.5316390991210938
[rfa agg] iter:  4, weight: tensor([0.1549, 0.0951, 0.0601, 0.1476, 0.0400, 0.2423, 0.0459, 0.0704, 0.0270,
        0.1167])
[rfa agg] iter:  5, prev_obj_val: 73.39826202392578, obj_val: 70.06585693359375, abs dis: 3.3324050903320312
[rfa agg] iter:  5, weight: tensor([0.1630, 0.0894, 0.0433, 0.1547, 0.0339, 0.2782, 0.0394, 0.0634, 0.0204,
        0.1143])
[rfa agg] iter:  6, prev_obj_val: 70.06585693359375, obj_val: 76.9305419921875, abs dis: 6.86468505859375
[rfa agg] iter:  6, weight: tensor([0.1787, 0.0843, 0.0311, 0.1675, 0.0285, 0.2909, 0.0334, 0.0568, 0.0153,
        0.1135])
[rfa agg] iter:  7, prev_obj_val: 76.9305419921875, obj_val: 73.39820861816406, abs dis: 3.5323333740234375
[rfa agg] iter:  7, weight: tensor([0.1548, 0.0950, 0.0601, 0.1474, 0.0399, 0.2430, 0.0458, 0.0704, 0.0270,
        0.1166])
[rfa agg] iter:  8, prev_obj_val: 73.39820861816406, obj_val: 70.06584167480469, abs dis: 3.332366943359375
[rfa agg] iter:  8, weight: tensor([0.1630, 0.0894, 0.0432, 0.1547, 0.0339, 0.2783, 0.0393, 0.0634, 0.0204,
        0.1143])
[rfa agg] iter:  9, prev_obj_val: 70.06584167480469, obj_val: 76.93055725097656, abs dis: 6.864715576171875
[rfa agg] iter:  9, weight: tensor([0.1787, 0.0843, 0.0311, 0.1675, 0.0285, 0.2909, 0.0334, 0.0568, 0.0153,
        0.1135])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3679, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.33241081237793 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1277, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1186, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3792, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0807, Accuracy: 21/311 (6.7524%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0555, Accuracy: 134/311 (43.0868%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6175, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0557, Accuracy: 334/1130 (29.5575%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 448/1130 (39.6460%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1857, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8285, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0614, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 509/1049 (48.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9397, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 404/807 (50.0620%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6705, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0582, Accuracy: 407/1904 (21.3761%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 660/1904 (34.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5787, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0555, Accuracy: 391/1715 (22.7988%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 673/1715 (39.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1409, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0592, Accuracy: 279/677 (41.2112%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3685, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0737, Accuracy: 95/500 (19.0000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0502, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.0473, Accuracy: 56/10000 (0.5600%)
time spent on training: 120.13501858711243
[rfa agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 96, 54, 1, 51, 20, 46, 92, 90, 82], weight: tensor([0.0093, 0.0342, 0.1241, 0.1019, 0.1152, 0.0886, 0.2091, 0.1883, 0.0743,
        0.0549])
[rfa agg] iter:  0, prev_obj_val: 62.49290084838867, obj_val: 65.83348846435547, abs dis: 3.340587615966797
[rfa agg] iter:  0, weight: tensor([0.0019, 0.0087, 0.3528, 0.1218, 0.2823, 0.0616, 0.0533, 0.0630, 0.0362,
        0.0184])
[rfa agg] iter:  1, prev_obj_val: 65.83348846435547, obj_val: 71.01870727539062, abs dis: 5.185218811035156
[rfa agg] iter:  1, weight: tensor([0.0023, 0.0108, 0.1594, 0.3203, 0.2153, 0.1102, 0.0484, 0.0548, 0.0542,
        0.0244])
[rfa agg] iter:  2, prev_obj_val: 71.01870727539062, obj_val: 75.51253509521484, abs dis: 4.493827819824219
[rfa agg] iter:  2, weight: tensor([0.0027, 0.0134, 0.1080, 0.2994, 0.1301, 0.2314, 0.0467, 0.0517, 0.0844,
        0.0323])
[rfa agg] iter:  3, prev_obj_val: 75.51253509521484, obj_val: 75.43570709228516, abs dis: 0.0768280029296875
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0145, 0.0842, 0.1664, 0.0958, 0.3927, 0.0425, 0.0464, 0.1172,
        0.0374])
[rfa agg] iter:  4, prev_obj_val: 75.43570709228516, obj_val: 78.08430480957031, abs dis: 2.6485977172851562
[rfa agg] iter:  4, weight: tensor([0.0025, 0.0130, 0.0751, 0.1445, 0.0850, 0.4614, 0.0379, 0.0414, 0.1058,
        0.0334])
[rfa agg] iter:  5, prev_obj_val: 78.08430480957031, obj_val: 80.93250274658203, abs dis: 2.8481979370117188
[rfa agg] iter:  5, weight: tensor([0.0029, 0.0153, 0.0757, 0.1311, 0.0842, 0.4179, 0.0408, 0.0443, 0.1468,
        0.0409])
[rfa agg] iter:  6, prev_obj_val: 80.93250274658203, obj_val: 86.968017578125, abs dis: 6.035514831542969
[rfa agg] iter:  6, weight: tensor([0.0035, 0.0188, 0.0804, 0.1284, 0.0882, 0.3055, 0.0458, 0.0494, 0.2271,
        0.0529])
[rfa agg] iter:  7, prev_obj_val: 86.968017578125, obj_val: 83.84185791015625, abs dis: 3.12615966796875
[rfa agg] iter:  7, weight: tensor([0.0039, 0.0219, 0.0697, 0.0987, 0.0747, 0.1672, 0.0436, 0.0466, 0.4038,
        0.0698])
[rfa agg] iter:  8, prev_obj_val: 83.84185791015625, obj_val: 80.93588256835938, abs dis: 2.905975341796875
[rfa agg] iter:  8, weight: tensor([0.0036, 0.0194, 0.0714, 0.1063, 0.0773, 0.1978, 0.0427, 0.0459, 0.3778,
        0.0578])
[rfa agg] iter:  9, prev_obj_val: 80.93588256835938, obj_val: 80.91549682617188, abs dis: 0.0203857421875
[rfa agg] iter:  9, weight: tensor([0.0035, 0.0189, 0.0806, 0.1280, 0.0883, 0.2781, 0.0459, 0.0495, 0.2542,
        0.0531])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4595, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.8739, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.56002712249756 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0617, Accuracy: 272/719 (37.8303%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0333, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2871, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0649, Accuracy: 275/1190 (23.1092%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 408/1190 (34.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4091, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0566, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0325, Accuracy: 671/1742 (38.5189%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8024, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1662 (20.8183%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 597/1662 (35.9206%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.5252, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0577, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 517/1071 (48.2726%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3026, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0551, Accuracy: 475/1988 (23.8934%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 625/1988 (31.4386%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4058, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0585, Accuracy: 258/636 (40.5660%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0328, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0587, Accuracy: 180/735 (24.4898%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0217, Accuracy: 371/735 (50.4762%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.6935, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 290/946 (30.6554%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 352/946 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.6532, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0528, Accuracy: 292/599 (48.7479%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.6266, Accuracy: 50/10000 (0.5000%)
time spent on training: 118.21422672271729
[rfa agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 84, 93, 94, 55, 85, 52, 32, 43, 95], weight: tensor([0.0637, 0.1054, 0.1543, 0.1472, 0.0949, 0.1761, 0.0563, 0.0651, 0.0838,
        0.0531])
[rfa agg] iter:  0, prev_obj_val: 65.19012451171875, obj_val: 68.25285339355469, abs dis: 3.0627288818359375
[rfa agg] iter:  0, weight: tensor([0.0372, 0.3974, 0.0796, 0.0985, 0.1558, 0.0620, 0.0260, 0.0381, 0.0810,
        0.0246])
[rfa agg] iter:  1, prev_obj_val: 68.25285339355469, obj_val: 70.91201782226562, abs dis: 2.6591644287109375
[rfa agg] iter:  1, weight: tensor([0.0464, 0.1850, 0.0519, 0.0603, 0.3653, 0.0435, 0.0296, 0.0477, 0.1424,
        0.0280])
[rfa agg] iter:  2, prev_obj_val: 70.91201782226562, obj_val: 76.40723419189453, abs dis: 5.495216369628906
[rfa agg] iter:  2, weight: tensor([0.0583, 0.1265, 0.0484, 0.0553, 0.2959, 0.0415, 0.0350, 0.0602, 0.2457,
        0.0332])
[rfa agg] iter:  3, prev_obj_val: 76.40723419189453, obj_val: 78.6251449584961, abs dis: 2.2179107666015625
[rfa agg] iter:  3, weight: tensor([0.0899, 0.0869, 0.0433, 0.0484, 0.1382, 0.0382, 0.0464, 0.0937, 0.3708,
        0.0442])
[rfa agg] iter:  4, prev_obj_val: 78.6251449584961, obj_val: 78.6191635131836, abs dis: 0.0059814453125
[rfa agg] iter:  4, weight: tensor([0.1186, 0.0850, 0.0453, 0.0503, 0.1245, 0.0402, 0.0562, 0.1240, 0.3023,
        0.0537])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5886, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.4798, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.12931084632874 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 315/1130 (27.8761%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 492/1130 (43.5398%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.0380, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0509, Accuracy: 584/2227 (26.2236%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1020/2227 (45.8015%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4257, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0563, Accuracy: 184/735 (25.0340%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.7668, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0625, Accuracy: 283/715 (39.5804%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0418, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1403, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 239/590 (40.5085%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0316, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.3533, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 247/636 (38.8365%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3734, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1000, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0841, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5159, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 406/1953 (20.7885%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 768/1953 (39.3241%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.6629, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0514, Accuracy: 326/1275 (25.5686%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 677/1275 (53.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.7298, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0601, Accuracy: 273/677 (40.3250%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1101, Accuracy: 56/10000 (0.5600%)
time spent on training: 118.20347738265991
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 60, 32, 23, 69, 52, 79, 83, 9, 90], weight: tensor([0.1115, 0.2197, 0.0725, 0.0705, 0.0582, 0.0628, 0.0194, 0.1927, 0.1258,
        0.0668])
[rfa agg] iter:  0, prev_obj_val: 81.61510467529297, obj_val: 86.01715087890625, abs dis: 4.402046203613281
[rfa agg] iter:  0, weight: tensor([0.2186, 0.0639, 0.0395, 0.0384, 0.0254, 0.0274, 0.0053, 0.0763, 0.4730,
        0.0324])
[rfa agg] iter:  1, prev_obj_val: 86.01715087890625, obj_val: 87.18614196777344, abs dis: 1.1689910888671875
[rfa agg] iter:  1, weight: tensor([0.3361, 0.0638, 0.0846, 0.0824, 0.0476, 0.0513, 0.0082, 0.0713, 0.1901,
        0.0645])
[rfa agg] iter:  2, prev_obj_val: 87.18614196777344, obj_val: 88.50027465820312, abs dis: 1.3141326904296875
[rfa agg] iter:  2, weight: tensor([0.2969, 0.0652, 0.1001, 0.0975, 0.0542, 0.0584, 0.0090, 0.0723, 0.1718,
        0.0747])
[rfa agg] iter:  3, prev_obj_val: 88.50027465820312, obj_val: 91.1786117553711, abs dis: 2.6783370971679688
[rfa agg] iter:  3, weight: tensor([0.2495, 0.0656, 0.1175, 0.1144, 0.0610, 0.0657, 0.0097, 0.0723, 0.1587,
        0.0855])
[rfa agg] iter:  4, prev_obj_val: 91.1786117553711, obj_val: 91.16992950439453, abs dis: 0.0086822509765625
[rfa agg] iter:  4, weight: tensor([0.1755, 0.0603, 0.1556, 0.1514, 0.0717, 0.0772, 0.0103, 0.0657, 0.1267,
        0.1056])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6868, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 4.9317, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.42017078399658 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0604, Accuracy: 194/953 (20.3568%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 270/953 (28.3316%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.1218, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0644, Accuracy: 264/715 (36.9231%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0848, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2225, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0602, Accuracy: 338/1657 (20.3983%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 493/1657 (29.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7596, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 319/803 (39.7260%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 441/803 (54.9191%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5805, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0600, Accuracy: 332/1581 (20.9994%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0346, Accuracy: 543/1581 (34.3454%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9120, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0768, Accuracy: 132/669 (19.7309%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4010, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 259/708 (36.5819%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0424, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4790, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 282/712 (39.6067%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8871, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0707, Accuracy: 128/568 (22.5352%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0425, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4003, Accuracy: 51/10000 (0.5100%)
time spent on training: 115.23808193206787
[rfa agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 23, 12, 0, 58, 28, 45, 16, 11, 62], weight: tensor([0.1095, 0.0821, 0.0388, 0.1904, 0.0923, 0.1816, 0.0769, 0.0813, 0.0818,
        0.0653])
[rfa agg] iter:  0, prev_obj_val: 53.94874572753906, obj_val: 60.928977966308594, abs dis: 6.980232238769531
[rfa agg] iter:  0, weight: tensor([0.2246, 0.1135, 0.0149, 0.0490, 0.1999, 0.0510, 0.0766, 0.1142, 0.1165,
        0.0399])
[rfa agg] iter:  1, prev_obj_val: 60.928977966308594, obj_val: 67.23314666748047, abs dis: 6.304168701171875
[rfa agg] iter:  1, weight: tensor([0.0651, 0.1437, 0.0184, 0.0309, 0.1027, 0.0316, 0.2309, 0.1468, 0.1565,
        0.0734])
[rfa agg] iter:  2, prev_obj_val: 67.23314666748047, obj_val: 74.35120391845703, abs dis: 7.1180572509765625
[rfa agg] iter:  2, weight: tensor([0.0681, 0.1196, 0.0296, 0.0378, 0.0931, 0.0385, 0.2071, 0.1197, 0.1221,
        0.1645])
[rfa agg] iter:  3, prev_obj_val: 74.35120391845703, obj_val: 70.69432067871094, abs dis: 3.6568832397460938
[rfa agg] iter:  3, weight: tensor([0.0632, 0.0924, 0.0424, 0.0394, 0.0789, 0.0399, 0.1288, 0.0920, 0.0931,
        0.3299])
[rfa agg] iter:  4, prev_obj_val: 70.69432067871094, obj_val: 70.69143676757812, abs dis: 0.0028839111328125
[rfa agg] iter:  4, weight: tensor([0.0639, 0.1009, 0.0347, 0.0377, 0.0829, 0.0383, 0.1508, 0.1006, 0.1021,
        0.2882])
[rfa agg] iter:  5, prev_obj_val: 70.69143676757812, obj_val: 70.69136047363281, abs dis: 7.62939453125e-05
[rfa agg] iter:  5, weight: tensor([0.0645, 0.1020, 0.0349, 0.0381, 0.0838, 0.0387, 0.1533, 0.1017, 0.1032,
        0.2798])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9877, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3369, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.40346121788025 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 365/1129 (32.3295%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 715/1129 (63.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.6828, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0676, Accuracy: 262/1190 (22.0168%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 419/1190 (35.2101%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5483, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0510, Accuracy: 582/2227 (26.1338%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5660, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0836, Accuracy: 9/338 (2.6627%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0456, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.5749, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0587, Accuracy: 293/1131 (25.9063%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 373/1131 (32.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2021, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0834, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3833, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0636, Accuracy: 194/1049 (18.4938%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8460, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0874, Accuracy: 20/466 (4.2918%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6399, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0931, Accuracy: 20/408 (4.9020%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0576, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0532, Accuracy: 447/1715 (26.0641%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 695/1715 (40.5248%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8766, Accuracy: 79/10000 (0.7900%)
time spent on training: 121.26368546485901
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 84, 60, 12, 87, 98, 51, 76, 36, 92], weight: tensor([0.1126, 0.1187, 0.2221, 0.0337, 0.1128, 0.0372, 0.1046, 0.0465, 0.0407,
        0.1711])
[rfa agg] iter:  0, prev_obj_val: 68.79656219482422, obj_val: 72.61316680908203, abs dis: 3.8166046142578125
[rfa agg] iter:  0, weight: tensor([0.2077, 0.2607, 0.0517, 0.0090, 0.2169, 0.0099, 0.1365, 0.0146, 0.0117,
        0.0813])
[rfa agg] iter:  1, prev_obj_val: 72.61316680908203, obj_val: 74.87126159667969, abs dis: 2.2580947875976562
[rfa agg] iter:  1, weight: tensor([0.2268, 0.1523, 0.0374, 0.0092, 0.2355, 0.0102, 0.2493, 0.0156, 0.0123,
        0.0515])
[rfa agg] iter:  2, prev_obj_val: 74.87126159667969, obj_val: 74.86068725585938, abs dis: 0.0105743408203125
[rfa agg] iter:  2, weight: tensor([0.2041, 0.1390, 0.0407, 0.0108, 0.2114, 0.0119, 0.2946, 0.0184, 0.0144,
        0.0548])
[rfa agg] iter:  3, prev_obj_val: 74.86068725585938, obj_val: 74.85994720458984, abs dis: 0.00074005126953125
[rfa agg] iter:  3, weight: tensor([0.1989, 0.1365, 0.0402, 0.0106, 0.2068, 0.0117, 0.3086, 0.0182, 0.0142,
        0.0541])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.2864, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 6.0520, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.8065321445465 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0657, Accuracy: 118/818 (14.4254%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 364/818 (44.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.9591, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0604, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 347/1013 (34.2547%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5501, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0607, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 515/1071 (48.0859%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.0808, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0632, Accuracy: 285/946 (30.1268%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6448, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0787, Accuracy: 102/603 (16.9154%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0485, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5890, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0771, Accuracy: 62/486 (12.7572%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0390, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4000, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0756, Accuracy: 7/186 (3.7634%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0601, Accuracy: 81/186 (43.5484%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8206, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0879, Accuracy: 7/311 (2.2508%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0608, Accuracy: 129/311 (41.4791%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.1533, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6175, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0533, Accuracy: 380/1628 (23.3415%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0249, Accuracy: 852/1628 (52.3342%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8751, Accuracy: 140/10000 (1.4000%)
time spent on training: 114.45159244537354
[rfa agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 14, 55, 43, 88, 30, 56, 96, 98, 5], weight: tensor([0.1100, 0.1362, 0.1440, 0.1272, 0.0811, 0.0654, 0.0250, 0.0418, 0.0502,
        0.2190])
[rfa agg] iter:  0, prev_obj_val: 52.22714614868164, obj_val: 55.652503967285156, abs dis: 3.4253578186035156
[rfa agg] iter:  0, weight: tensor([0.3496, 0.1367, 0.1113, 0.1783, 0.0831, 0.0410, 0.0077, 0.0163, 0.0225,
        0.0536])
[rfa agg] iter:  1, prev_obj_val: 55.652503967285156, obj_val: 59.8046760559082, abs dis: 4.152172088623047
[rfa agg] iter:  1, weight: tensor([0.3256, 0.1193, 0.1020, 0.1458, 0.1334, 0.0574, 0.0096, 0.0209, 0.0295,
        0.0564])
[rfa agg] iter:  2, prev_obj_val: 59.8046760559082, obj_val: 59.761085510253906, abs dis: 0.043590545654296875
[rfa agg] iter:  2, weight: tensor([0.2073, 0.1069, 0.0947, 0.1235, 0.2485, 0.0833, 0.0118, 0.0268, 0.0388,
        0.0583])
[rfa agg] iter:  3, prev_obj_val: 59.761085510253906, obj_val: 59.76073455810547, abs dis: 0.0003509521484375
[rfa agg] iter:  3, weight: tensor([0.1990, 0.1051, 0.0932, 0.1213, 0.2645, 0.0829, 0.0117, 0.0265, 0.0384,
        0.0574])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3121, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 7.7033, Accuracy: 0/9950 (0.0000%)
saving model
Done in 207.3621311187744 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0840, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0438, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8285, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0878, Accuracy: 17/416 (4.0865%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0470, Accuracy: 177/416 (42.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8270, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0474, Accuracy: 387/1440 (26.8750%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 659/1440 (45.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.5416, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 388/1628 (23.8329%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0246, Accuracy: 858/1628 (52.7027%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.9517, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0537, Accuracy: 428/1715 (24.9563%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 689/1715 (40.1749%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1629, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0568, Accuracy: 279/712 (39.1854%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 390/712 (54.7753%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1176, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0596, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 374/1131 (33.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.6087, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0614, Accuracy: 183/861 (21.2544%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.6093, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0558, Accuracy: 299/1446 (20.6777%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 527/1446 (36.4454%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4873, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0593, Accuracy: 321/1645 (19.5137%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 623/1645 (37.8723%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.2502, Accuracy: 108/10000 (1.0800%)
time spent on training: 127.23773980140686
[rfa agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 78, 29, 5, 92, 11, 87, 10, 26, 13], weight: tensor([0.0276, 0.0368, 0.1274, 0.1440, 0.1517, 0.0630, 0.1000, 0.0762, 0.1279,
        0.1455])
[rfa agg] iter:  0, prev_obj_val: 55.40892791748047, obj_val: 59.15105056762695, abs dis: 3.7421226501464844
[rfa agg] iter:  0, weight: tensor([0.0089, 0.0138, 0.1367, 0.0913, 0.0849, 0.0405, 0.3259, 0.0676, 0.1377,
        0.0927])
[rfa agg] iter:  1, prev_obj_val: 59.15105056762695, obj_val: 61.40510177612305, abs dis: 2.2540512084960938
[rfa agg] iter:  1, weight: tensor([0.0077, 0.0123, 0.0907, 0.0652, 0.0615, 0.0382, 0.4989, 0.0678, 0.0914,
        0.0662])
[rfa agg] iter:  2, prev_obj_val: 61.40510177612305, obj_val: 59.075645446777344, abs dis: 2.329456329345703
[rfa agg] iter:  2, weight: tensor([0.0081, 0.0130, 0.0837, 0.0622, 0.0590, 0.0420, 0.5071, 0.0775, 0.0843,
        0.0631])
[rfa agg] iter:  3, prev_obj_val: 59.075645446777344, obj_val: 66.55896759033203, abs dis: 7.4833221435546875
[rfa agg] iter:  3, weight: tensor([0.0065, 0.0102, 0.0754, 0.0544, 0.0514, 0.0319, 0.5822, 0.0566, 0.0761,
        0.0552])
[rfa agg] iter:  4, prev_obj_val: 66.55896759033203, obj_val: 63.92340087890625, abs dis: 2.6355667114257812
[rfa agg] iter:  4, weight: tensor([0.0122, 0.0197, 0.0984, 0.0769, 0.0738, 0.0701, 0.3295, 0.1423, 0.0991,
        0.0780])
[rfa agg] iter:  5, prev_obj_val: 63.92340087890625, obj_val: 63.9193115234375, abs dis: 0.00408935546875
[rfa agg] iter:  5, weight: tensor([0.0107, 0.0172, 0.0975, 0.0743, 0.0709, 0.0583, 0.3842, 0.1135, 0.0981,
        0.0753])
[rfa agg] iter:  6, prev_obj_val: 63.9193115234375, obj_val: 61.41857147216797, abs dis: 2.5007400512695312
[rfa agg] iter:  6, weight: tensor([0.0106, 0.0170, 0.0965, 0.0736, 0.0702, 0.0577, 0.3906, 0.1119, 0.0972,
        0.0746])
[rfa agg] iter:  7, prev_obj_val: 61.41857147216797, obj_val: 57.11805725097656, abs dis: 4.300514221191406
[rfa agg] iter:  7, weight: tensor([0.0086, 0.0137, 0.0883, 0.0656, 0.0622, 0.0444, 0.4797, 0.0821, 0.0890,
        0.0665])
[rfa agg] iter:  8, prev_obj_val: 57.11805725097656, obj_val: 61.406883239746094, abs dis: 4.288825988769531
[rfa agg] iter:  8, weight: tensor([0.0074, 0.0116, 0.0982, 0.0684, 0.0642, 0.0349, 0.4867, 0.0600, 0.0991,
        0.0695])
[rfa agg] iter:  9, prev_obj_val: 61.406883239746094, obj_val: 59.076698303222656, abs dis: 2.3301849365234375
[rfa agg] iter:  9, weight: tensor([0.0082, 0.0131, 0.0844, 0.0627, 0.0595, 0.0424, 0.5029, 0.0781, 0.0851,
        0.0636])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4843, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 9.6279, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.65227460861206 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0902, Accuracy: 9/408 (2.2059%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0536, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.0788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0813, Accuracy: 80/682 (11.7302%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 261/682 (38.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0417, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0571, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6377, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0842, Accuracy: 36/460 (7.8261%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0404, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6001, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0848, Accuracy: 22/515 (4.2718%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3871, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0686, Accuracy: 310/1003 (30.9073%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2488, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0669, Accuracy: 127/568 (22.3592%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1309, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7922, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0559, Accuracy: 356/1949 (18.2658%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0342, Accuracy: 583/1949 (29.9128%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.7446, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 342/1645 (20.7903%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 568/1645 (34.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.8479, Accuracy: 99/10000 (0.9900%)
time spent on training: 122.226327419281
[rfa agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 80, 93, 31, 33, 86, 62, 98, 21, 13], weight: tensor([0.0437, 0.0730, 0.1864, 0.0492, 0.0551, 0.1073, 0.0608, 0.0399, 0.2086,
        0.1760])
[rfa agg] iter:  0, prev_obj_val: 83.38860321044922, obj_val: 85.49266052246094, abs dis: 2.1040573120117188
[rfa agg] iter:  0, weight: tensor([0.0286, 0.0748, 0.1338, 0.0355, 0.0441, 0.3379, 0.0487, 0.0239, 0.1157,
        0.1572])
[rfa agg] iter:  1, prev_obj_val: 85.49266052246094, obj_val: 89.13562774658203, abs dis: 3.6429672241210938
[rfa agg] iter:  1, weight: tensor([0.0226, 0.0648, 0.0800, 0.0286, 0.0361, 0.5471, 0.0399, 0.0187, 0.0711,
        0.0912])
[rfa agg] iter:  2, prev_obj_val: 89.13562774658203, obj_val: 90.68273162841797, abs dis: 1.5471038818359375
[rfa agg] iter:  2, weight: tensor([0.0283, 0.0926, 0.0752, 0.0366, 0.0474, 0.4924, 0.0524, 0.0230, 0.0684,
        0.0837])
[rfa agg] iter:  3, prev_obj_val: 90.68273162841797, obj_val: 92.24339294433594, abs dis: 1.5606613159179688
[rfa agg] iter:  3, weight: tensor([0.0345, 0.1203, 0.0828, 0.0450, 0.0591, 0.3975, 0.0653, 0.0278, 0.0759,
        0.0916])
[rfa agg] iter:  4, prev_obj_val: 92.24339294433594, obj_val: 93.82363891601562, abs dis: 1.5802459716796875
[rfa agg] iter:  4, weight: tensor([0.0395, 0.1488, 0.0854, 0.0521, 0.0693, 0.3237, 0.0768, 0.0316, 0.0788,
        0.0939])
[rfa agg] iter:  5, prev_obj_val: 93.82363891601562, obj_val: 97.05067443847656, abs dis: 3.2270355224609375
[rfa agg] iter:  5, weight: tensor([0.0433, 0.1793, 0.0840, 0.0578, 0.0781, 0.2668, 0.0866, 0.0342, 0.0779,
        0.0918])
[rfa agg] iter:  6, prev_obj_val: 97.05067443847656, obj_val: 97.0333480834961, abs dis: 0.01732635498046875
[rfa agg] iter:  6, weight: tensor([0.0473, 0.2550, 0.0730, 0.0653, 0.0919, 0.1809, 0.1024, 0.0365, 0.0686,
        0.0791])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.2970, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 8.3550, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.9801721572876 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0986, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0648, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.3307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0581, Accuracy: 269/776 (34.6649%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1056, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0592, Accuracy: 293/1418 (20.6629%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 620/1418 (43.7236%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.8460, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0595, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 373/1013 (36.8213%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6319, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0614, Accuracy: 214/1071 (19.9813%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.8600, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0608, Accuracy: 345/1956 (17.6380%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 616/1956 (31.4928%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5259, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0731, Accuracy: 214/708 (30.2260%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0336, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1498, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0747, Accuracy: 110/809 (13.5970%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0285, Accuracy: 343/809 (42.3980%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.6275, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0580, Accuracy: 384/1904 (20.1681%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0304, Accuracy: 738/1904 (38.7605%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2642, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0642, Accuracy: 285/715 (39.8601%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0392, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2539, Accuracy: 50/10000 (0.5000%)
time spent on training: 129.52021408081055
[rfa agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 75, 70, 14, 55, 6, 16, 50, 46, 23], weight: tensor([0.0255, 0.0729, 0.1333, 0.0952, 0.1006, 0.1838, 0.0665, 0.0760, 0.1789,
        0.0672])
[rfa agg] iter:  0, prev_obj_val: 67.58186340332031, obj_val: 69.95893096923828, abs dis: 2.3770675659179688
[rfa agg] iter:  0, weight: tensor([0.0096, 0.0673, 0.1445, 0.1765, 0.2715, 0.0756, 0.0520, 0.0703, 0.0800,
        0.0526])
[rfa agg] iter:  1, prev_obj_val: 69.95893096923828, obj_val: 72.82190704345703, abs dis: 2.86297607421875
[rfa agg] iter:  1, weight: tensor([0.0080, 0.0801, 0.0656, 0.3039, 0.2577, 0.0429, 0.0559, 0.0844, 0.0448,
        0.0566])
[rfa agg] iter:  2, prev_obj_val: 72.82190704345703, obj_val: 78.36682891845703, abs dis: 5.544921875
[rfa agg] iter:  2, weight: tensor([0.0094, 0.1198, 0.0618, 0.2650, 0.1719, 0.0433, 0.0776, 0.1274, 0.0450,
        0.0787])
[rfa agg] iter:  3, prev_obj_val: 78.36682891845703, obj_val: 80.55368041992188, abs dis: 2.1868515014648438
[rfa agg] iter:  3, weight: tensor([0.0096, 0.2055, 0.0458, 0.1178, 0.0913, 0.0347, 0.1143, 0.2282, 0.0358,
        0.1170])
[rfa agg] iter:  4, prev_obj_val: 80.55368041992188, obj_val: 86.5595474243164, abs dis: 6.005867004394531
[rfa agg] iter:  4, weight: tensor([0.0089, 0.2316, 0.0378, 0.0851, 0.0695, 0.0293, 0.1248, 0.2530, 0.0301,
        0.1299])
[rfa agg] iter:  5, prev_obj_val: 86.5595474243164, obj_val: 90.13988494873047, abs dis: 3.5803375244140625
[rfa agg] iter:  5, weight: tensor([0.0113, 0.1778, 0.0387, 0.0736, 0.0633, 0.0311, 0.1858, 0.1874, 0.0320,
        0.1989])
[rfa agg] iter:  6, prev_obj_val: 90.13988494873047, obj_val: 83.32868194580078, abs dis: 6.8112030029296875
[rfa agg] iter:  6, weight: tensor([0.0137, 0.1522, 0.0420, 0.0749, 0.0656, 0.0344, 0.2050, 0.1577, 0.0353,
        0.2190])
[rfa agg] iter:  7, prev_obj_val: 83.32868194580078, obj_val: 83.31319427490234, abs dis: 0.0154876708984375
[rfa agg] iter:  7, weight: tensor([0.0097, 0.2017, 0.0370, 0.0758, 0.0639, 0.0292, 0.1680, 0.2051, 0.0301,
        0.1796])
[rfa agg] iter:  8, prev_obj_val: 83.31319427490234, obj_val: 86.5365982055664, abs dis: 3.2234039306640625
[rfa agg] iter:  8, weight: tensor([0.0096, 0.2090, 0.0367, 0.0752, 0.0634, 0.0290, 0.1612, 0.2141, 0.0298,
        0.1719])
[rfa agg] iter:  9, prev_obj_val: 86.5365982055664, obj_val: 90.1385269165039, abs dis: 3.6019287109375
[rfa agg] iter:  9, weight: tensor([0.0111, 0.1746, 0.0382, 0.0727, 0.0626, 0.0308, 0.1915, 0.1804, 0.0316,
        0.2065])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.5039, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 8.2578, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.14144778251648 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0584, Accuracy: 236/590 (40.0000%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.3349, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0627, Accuracy: 160/953 (16.7891%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 310/953 (32.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3350, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0597, Accuracy: 351/1475 (23.7966%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 598/1475 (40.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9759, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1301, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1201, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2575, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0834, Accuracy: 36/515 (6.9903%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0537, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9889, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0591, Accuracy: 328/1418 (23.1312%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 617/1418 (43.5120%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4569, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0740, Accuracy: 82/500 (16.4000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 190/500 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0110, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0504, Accuracy: 588/2227 (26.4032%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 992/2227 (44.5442%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7886, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0562, Accuracy: 390/1953 (19.9693%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 751/1953 (38.4537%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2358, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0793, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3444, Accuracy: 50/10000 (0.5000%)
time spent on training: 126.49436116218567
[rfa agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 64, 65, 61, 33, 70, 82, 60, 83, 98], weight: tensor([0.0585, 0.0945, 0.1462, 0.0084, 0.0510, 0.1405, 0.0496, 0.2207, 0.1936,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 79.87858581542969, obj_val: 79.66102600097656, abs dis: 0.217559814453125
[rfa agg] iter:  0, weight: tensor([0.0273, 0.0773, 0.2680, 0.0023, 0.0219, 0.3739, 0.0197, 0.0878, 0.1090,
        0.0128])
[rfa agg] iter:  1, prev_obj_val: 79.66102600097656, obj_val: 79.65983581542969, abs dis: 0.001190185546875
[rfa agg] iter:  1, weight: tensor([0.0260, 0.0734, 0.2639, 0.0022, 0.0209, 0.3958, 0.0188, 0.0834, 0.1036,
        0.0122])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.2446, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 8.2139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.34988474845886 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0555, Accuracy: 253/590 (42.8814%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.1495, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0666, Accuracy: 131/568 (23.0634%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0395, Accuracy: 260/568 (45.7746%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4142, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0571, Accuracy: 377/1953 (19.3036%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 734/1953 (37.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7976, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0858, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0488, Accuracy: 164/416 (39.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9951, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0632, Accuracy: 246/690 (35.6522%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0311, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4514, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0660, Accuracy: 258/719 (35.8832%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0359, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7992, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0727, Accuracy: 107/530 (20.1887%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9259, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0583, Accuracy: 388/1475 (26.3051%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 604/1475 (40.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4346, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0638, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 436/1131 (38.5500%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1100, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 323/1662 (19.4344%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 567/1662 (34.1155%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4970, Accuracy: 113/10000 (1.1300%)
time spent on training: 127.96502828598022
[rfa agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 62, 83, 78, 25, 41, 18, 65, 38, 94], weight: tensor([0.0606, 0.0584, 0.2006, 0.0427, 0.0709, 0.0739, 0.0544, 0.1515, 0.1162,
        0.1707])
[rfa agg] iter:  0, prev_obj_val: 72.83902740478516, obj_val: 77.17325592041016, abs dis: 4.334228515625
[rfa agg] iter:  0, weight: tensor([0.0425, 0.0361, 0.0784, 0.0214, 0.0571, 0.0697, 0.0336, 0.1194, 0.4365,
        0.1052])
[rfa agg] iter:  1, prev_obj_val: 77.17325592041016, obj_val: 75.92855834960938, abs dis: 1.2446975708007812
[rfa agg] iter:  1, weight: tensor([0.0681, 0.0559, 0.0813, 0.0312, 0.0964, 0.1252, 0.0520, 0.1100, 0.2783,
        0.1017])
[rfa agg] iter:  2, prev_obj_val: 75.92855834960938, obj_val: 78.35799407958984, abs dis: 2.4294357299804688
[rfa agg] iter:  2, weight: tensor([0.0614, 0.0509, 0.0819, 0.0289, 0.0857, 0.1097, 0.0473, 0.1138, 0.3161,
        0.1042])
[rfa agg] iter:  3, prev_obj_val: 78.35799407958984, obj_val: 78.34381866455078, abs dis: 0.0141754150390625
[rfa agg] iter:  3, weight: tensor([0.0756, 0.0612, 0.0795, 0.0335, 0.1094, 0.1466, 0.0568, 0.1052, 0.2341,
        0.0981])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.8993, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 7.0123, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.63434314727783 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 285/715 (39.8601%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3109, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0564, Accuracy: 350/1949 (17.9579%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 628/1949 (32.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4019, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 328/1418 (23.1312%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 627/1418 (44.2172%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4781, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 384/1475 (26.0339%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 622/1475 (42.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9252, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1045, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0823, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9975, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0526, Accuracy: 355/1628 (21.8059%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 788/1628 (48.4029%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.6554, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 215/888 (24.2117%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 403/888 (45.3829%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.8821, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0570, Accuracy: 252/599 (42.0701%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.1439, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0591, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0352, Accuracy: 370/803 (46.0772%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9850, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0561, Accuracy: 183/735 (24.8980%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0208, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.1909, Accuracy: 57/10000 (0.5700%)
time spent on training: 130.3761692047119
[rfa agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 21, 70, 65, 79, 5, 63, 95, 58, 32], weight: tensor([0.0687, 0.1873, 0.1363, 0.1417, 0.0189, 0.1564, 0.0853, 0.0576, 0.0772,
        0.0706])
[rfa agg] iter:  0, prev_obj_val: 66.3970947265625, obj_val: 67.41886901855469, abs dis: 1.0217742919921875
[rfa agg] iter:  0, weight: tensor([0.0630, 0.1012, 0.2103, 0.1773, 0.0081, 0.1424, 0.1085, 0.0414, 0.0828,
        0.0650])
[rfa agg] iter:  1, prev_obj_val: 67.41886901855469, obj_val: 69.55936431884766, abs dis: 2.1404953002929688
[rfa agg] iter:  1, weight: tensor([0.0687, 0.0987, 0.1938, 0.1657, 0.0085, 0.1356, 0.1218, 0.0445, 0.0916,
        0.0710])
[rfa agg] iter:  2, prev_obj_val: 69.55936431884766, obj_val: 71.75306701660156, abs dis: 2.1937026977539062
[rfa agg] iter:  2, weight: tensor([0.0805, 0.0914, 0.1601, 0.1412, 0.0091, 0.1200, 0.1534, 0.0502, 0.1109,
        0.0833])
[rfa agg] iter:  3, prev_obj_val: 71.75306701660156, obj_val: 72.8711929321289, abs dis: 1.1181259155273438
[rfa agg] iter:  3, weight: tensor([0.0912, 0.0799, 0.1279, 0.1154, 0.0092, 0.1011, 0.1943, 0.0542, 0.1321,
        0.0948])
[rfa agg] iter:  4, prev_obj_val: 72.8711929321289, obj_val: 74.02420806884766, abs dis: 1.15301513671875
[rfa agg] iter:  4, weight: tensor([0.0956, 0.0725, 0.1116, 0.1016, 0.0090, 0.0902, 0.2214, 0.0550, 0.1433,
        0.0997])
[rfa agg] iter:  5, prev_obj_val: 74.02420806884766, obj_val: 74.0207290649414, abs dis: 0.00347900390625
[rfa agg] iter:  5, weight: tensor([0.0988, 0.0643, 0.0956, 0.0877, 0.0085, 0.0787, 0.2537, 0.0547, 0.1546,
        0.1034])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.2172, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 6.7313, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.1146457195282 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0994, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0646, Accuracy: 83/271 (30.6273%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4253, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0583, Accuracy: 345/1581 (21.8216%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0348, Accuracy: 534/1581 (33.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.4154, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0550, Accuracy: 373/1587 (23.5035%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 618/1587 (38.9414%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0931, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0857, Accuracy: 55/682 (8.0645%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.4310, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0580, Accuracy: 294/1130 (26.0177%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 456/1130 (40.3540%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.0741, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0641, Accuracy: 150/568 (26.4085%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0388, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.3462, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0541, Accuracy: 171/735 (23.2653%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 387/735 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 10.2852, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0543, Accuracy: 465/1470 (31.6327%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 818/1470 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.3366, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0583, Accuracy: 335/901 (37.1809%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 388/901 (43.0633%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.1573, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0516, Accuracy: 316/1372 (23.0321%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 514/1372 (37.4636%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7970, Accuracy: 75/10000 (0.7500%)
time spent on training: 133.162260055542
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 28, 27, 80, 54, 62, 32, 22, 4, 42], weight: tensor([0.0263, 0.1535, 0.1541, 0.0662, 0.1097, 0.0552, 0.0714, 0.1428, 0.0875,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 57.17958068847656, obj_val: 60.87044143676758, abs dis: 3.6908607482910156
[rfa agg] iter:  0, weight: tensor([0.0108, 0.0781, 0.0783, 0.0597, 0.2132, 0.0360, 0.0795, 0.0917, 0.2530,
        0.0997])
[rfa agg] iter:  1, prev_obj_val: 60.87044143676758, obj_val: 60.83114242553711, abs dis: 0.03929901123046875
[rfa agg] iter:  1, weight: tensor([0.0109, 0.0648, 0.0649, 0.0675, 0.1457, 0.0384, 0.0949, 0.0743, 0.3593,
        0.0793])
[rfa agg] iter:  2, prev_obj_val: 60.83114242553711, obj_val: 60.82666778564453, abs dis: 0.004474639892578125
[rfa agg] iter:  2, weight: tensor([0.0103, 0.0611, 0.0612, 0.0638, 0.1355, 0.0362, 0.0893, 0.0701, 0.3977,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 60.82666778564453, obj_val: 63.026187896728516, abs dis: 2.1995201110839844
[rfa agg] iter:  3, weight: tensor([0.0100, 0.0596, 0.0597, 0.0622, 0.1318, 0.0353, 0.0868, 0.0684, 0.4131,
        0.0730])
[rfa agg] iter:  4, prev_obj_val: 63.026187896728516, obj_val: 60.829227447509766, abs dis: 2.19696044921875
[rfa agg] iter:  4, weight: tensor([0.0112, 0.0603, 0.0604, 0.0743, 0.1223, 0.0407, 0.1070, 0.0684, 0.3828,
        0.0725])
[rfa agg] iter:  5, prev_obj_val: 60.829227447509766, obj_val: 58.87648391723633, abs dis: 1.9527435302734375
[rfa agg] iter:  5, weight: tensor([0.0101, 0.0602, 0.0603, 0.0629, 0.1330, 0.0357, 0.0880, 0.0690, 0.4069,
        0.0738])
[rfa agg] iter:  6, prev_obj_val: 58.87648391723633, obj_val: 60.830467224121094, abs dis: 1.9539833068847656
[rfa agg] iter:  6, weight: tensor([0.0100, 0.0652, 0.0653, 0.0580, 0.1588, 0.0340, 0.0789, 0.0756, 0.3727,
        0.0815])
[rfa agg] iter:  7, prev_obj_val: 60.830467224121094, obj_val: 58.87578582763672, abs dis: 1.954681396484375
[rfa agg] iter:  7, weight: tensor([0.0102, 0.0606, 0.0608, 0.0632, 0.1346, 0.0359, 0.0883, 0.0695, 0.4025,
        0.0743])
[rfa agg] iter:  8, prev_obj_val: 58.87578582763672, obj_val: 60.830650329589844, abs dis: 1.954864501953125
[rfa agg] iter:  8, weight: tensor([0.0100, 0.0653, 0.0654, 0.0581, 0.1592, 0.0341, 0.0790, 0.0757, 0.3714,
        0.0817])
[rfa agg] iter:  9, prev_obj_val: 60.830650329589844, obj_val: 58.87571716308594, abs dis: 1.9549331665039062
[rfa agg] iter:  9, weight: tensor([0.0102, 0.0607, 0.0608, 0.0632, 0.1348, 0.0359, 0.0884, 0.0696, 0.4020,
        0.0743])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 11.6250, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 7.5884, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.55004835128784 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 461/896 (51.4509%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3618, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 176/605 (29.0909%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5422, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0647, Accuracy: 280/715 (39.1608%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0371, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4016, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 559/928 (60.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1171, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0498, Accuracy: 381/891 (42.7609%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 442/891 (49.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.5569, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0894, Accuracy: 13/416 (3.1250%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0477, Accuracy: 183/416 (43.9904%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2812, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0771, Accuracy: 92/809 (11.3721%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0293, Accuracy: 328/809 (40.5439%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0283, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0636, Accuracy: 217/1241 (17.4859%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0374, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1536, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0592, Accuracy: 334/1581 (21.1259%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0351, Accuracy: 545/1581 (34.4719%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2861, Accuracy: 95/10000 (0.9500%)
time spent on training: 126.36352252960205
[rfa agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 89, 2, 23, 1, 7, 78, 50, 72, 28], weight: tensor([0.0545, 0.1048, 0.0708, 0.0836, 0.1086, 0.1042, 0.0487, 0.0946, 0.1452,
        0.1850])
[rfa agg] iter:  0, prev_obj_val: 44.1234016418457, obj_val: 50.14937210083008, abs dis: 6.025970458984375
[rfa agg] iter:  0, weight: tensor([0.0273, 0.1630, 0.0569, 0.1354, 0.1146, 0.1617, 0.0203, 0.2283, 0.0528,
        0.0396])
[rfa agg] iter:  1, prev_obj_val: 50.14937210083008, obj_val: 50.09892272949219, abs dis: 0.050449371337890625
[rfa agg] iter:  1, weight: tensor([0.0460, 0.1193, 0.1168, 0.2088, 0.0905, 0.1186, 0.0324, 0.1713, 0.0533,
        0.0430])
[rfa agg] iter:  2, prev_obj_val: 50.09892272949219, obj_val: 50.09812927246094, abs dis: 0.00079345703125
[rfa agg] iter:  2, weight: tensor([0.0455, 0.1155, 0.1186, 0.2241, 0.0887, 0.1154, 0.0320, 0.1656, 0.0523,
        0.0422])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 11.6817, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 7.7264, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.0938594341278 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0605, Accuracy: 373/1956 (19.0695%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 651/1956 (33.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5363, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0695, Accuracy: 301/1003 (30.0100%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 389/1003 (38.7836%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5649, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0991, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0628, Accuracy: 84/271 (30.9963%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9946, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0649, Accuracy: 238/708 (33.6158%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0353, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1297, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0625, Accuracy: 274/896 (30.5804%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0350, Accuracy: 473/896 (52.7902%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5013, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0558, Accuracy: 425/1715 (24.7813%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 666/1715 (38.8338%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1504, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0594, Accuracy: 317/807 (39.2813%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0333, Accuracy: 396/807 (49.0706%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4561, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0551, Accuracy: 289/1089 (26.5381%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0349, Accuracy: 483/1089 (44.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 10.3310, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0611, Accuracy: 165/861 (19.1638%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 438/861 (50.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 10.4730, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0591, Accuracy: 197/1013 (19.4472%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 374/1013 (36.9200%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2147, Accuracy: 72/10000 (0.7200%)
time spent on training: 134.0031979084015
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 86, 35, 16, 89, 92, 20, 59, 10, 14], weight: tensor([0.1896, 0.0972, 0.0263, 0.0686, 0.0868, 0.1662, 0.0782, 0.1055, 0.0834,
        0.0982])
[rfa agg] iter:  0, prev_obj_val: 58.27687072753906, obj_val: 60.010841369628906, abs dis: 1.7339706420898438
[rfa agg] iter:  0, weight: tensor([0.0541, 0.1813, 0.0080, 0.0473, 0.0908, 0.0667, 0.0647, 0.2045, 0.0863,
        0.1963])
[rfa agg] iter:  1, prev_obj_val: 60.010841369628906, obj_val: 61.399925231933594, abs dis: 1.3890838623046875
[rfa agg] iter:  1, weight: tensor([0.0345, 0.1732, 0.0074, 0.0622, 0.1612, 0.0400, 0.0958, 0.0899, 0.1439,
        0.1918])
[rfa agg] iter:  2, prev_obj_val: 61.399925231933594, obj_val: 75.18022918701172, abs dis: 13.780303955078125
[rfa agg] iter:  2, weight: tensor([0.0320, 0.1376, 0.0075, 0.0701, 0.2009, 0.0368, 0.1145, 0.0741, 0.1764,
        0.1502])
[rfa agg] iter:  3, prev_obj_val: 75.18022918701172, obj_val: 71.61058807373047, abs dis: 3.56964111328125
[rfa agg] iter:  3, weight: tensor([0.0361, 0.0839, 0.0128, 0.2238, 0.1397, 0.0400, 0.1860, 0.0608, 0.1307,
        0.0863])
[rfa agg] iter:  4, prev_obj_val: 71.61058807373047, obj_val: 75.10624694824219, abs dis: 3.4956588745117188
[rfa agg] iter:  4, weight: tensor([0.0322, 0.0815, 0.0105, 0.2053, 0.1469, 0.0359, 0.2098, 0.0571, 0.1365,
        0.0842])
[rfa agg] iter:  5, prev_obj_val: 75.10624694824219, obj_val: 71.61305236816406, abs dis: 3.493194580078125
[rfa agg] iter:  5, weight: tensor([0.0345, 0.0798, 0.0123, 0.2495, 0.1320, 0.0382, 0.1892, 0.0581, 0.1243,
        0.0821])
[rfa agg] iter:  6, prev_obj_val: 71.61305236816406, obj_val: 71.60794067382812, abs dis: 0.0051116943359375
[rfa agg] iter:  6, weight: tensor([0.0321, 0.0811, 0.0105, 0.2096, 0.1459, 0.0358, 0.2090, 0.0568, 0.1355,
        0.0838])
[rfa agg] iter:  7, prev_obj_val: 71.60794067382812, obj_val: 75.10723876953125, abs dis: 3.499298095703125
[rfa agg] iter:  7, weight: tensor([0.0322, 0.0813, 0.0105, 0.2014, 0.1466, 0.0358, 0.2146, 0.0569, 0.1366,
        0.0841])
[rfa agg] iter:  8, prev_obj_val: 75.10723876953125, obj_val: 71.6128158569336, abs dis: 3.4944229125976562
[rfa agg] iter:  8, weight: tensor([0.0346, 0.0799, 0.0123, 0.2483, 0.1321, 0.0383, 0.1900, 0.0581, 0.1244,
        0.0821])
[rfa agg] iter:  9, prev_obj_val: 71.6128158569336, obj_val: 71.60792541503906, abs dis: 0.00489044189453125
[rfa agg] iter:  9, weight: tensor([0.0321, 0.0811, 0.0105, 0.2093, 0.1459, 0.0358, 0.2092, 0.0568, 0.1355,
        0.0838])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.2517, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 9.7833, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.593425989151 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0564, Accuracy: 267/776 (34.4072%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1765, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 569/1645 (34.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8868, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0585, Accuracy: 287/1130 (25.3982%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0302, Accuracy: 435/1130 (38.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.1619, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0617, Accuracy: 351/1956 (17.9448%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 656/1956 (33.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5564, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 241/888 (27.1396%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.3640, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0841, Accuracy: 13/440 (2.9545%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0507, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.8776, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0597, Accuracy: 321/1418 (22.6375%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 630/1418 (44.4288%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.0202, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0663, Accuracy: 173/1049 (16.4919%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 463/1049 (44.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8257, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 312/803 (38.8543%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.4479, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0531, Accuracy: 339/1275 (26.5882%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 683/1275 (53.5686%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 11.8117, Accuracy: 98/10000 (0.9800%)
time spent on training: 139.78012204170227
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 13, 54, 6, 63, 49, 70, 51, 58, 9], weight: tensor([0.0682, 0.1446, 0.0993, 0.1719, 0.0780, 0.0387, 0.1246, 0.0922, 0.0706,
        0.1120])
[rfa agg] iter:  0, prev_obj_val: 54.904937744140625, obj_val: 57.30828857421875, abs dis: 2.403350830078125
[rfa agg] iter:  0, weight: tensor([0.0489, 0.0657, 0.2553, 0.0486, 0.0685, 0.0128, 0.0872, 0.1900, 0.0509,
        0.1721])
[rfa agg] iter:  1, prev_obj_val: 57.30828857421875, obj_val: 60.927371978759766, abs dis: 3.6190834045410156
[rfa agg] iter:  1, weight: tensor([0.0592, 0.0576, 0.2329, 0.0444, 0.0864, 0.0139, 0.0725, 0.2461, 0.0617,
        0.1254])
[rfa agg] iter:  2, prev_obj_val: 60.927371978759766, obj_val: 62.974342346191406, abs dis: 2.0469703674316406
[rfa agg] iter:  2, weight: tensor([0.0841, 0.0574, 0.1700, 0.0458, 0.1311, 0.0169, 0.0693, 0.2305, 0.0881,
        0.1068])
[rfa agg] iter:  3, prev_obj_val: 62.974342346191406, obj_val: 67.46855926513672, abs dis: 4.4942169189453125
[rfa agg] iter:  3, weight: tensor([0.1012, 0.0563, 0.1454, 0.0456, 0.1664, 0.0184, 0.0669, 0.1947, 0.1066,
        0.0986])
[rfa agg] iter:  4, prev_obj_val: 67.46855926513672, obj_val: 69.93423461914062, abs dis: 2.4656753540039062
[rfa agg] iter:  4, weight: tensor([0.1385, 0.0486, 0.1035, 0.0405, 0.2392, 0.0196, 0.0561, 0.1276, 0.1492,
        0.0772])
[rfa agg] iter:  5, prev_obj_val: 69.93423461914062, obj_val: 67.43550872802734, abs dis: 2.4987258911132812
[rfa agg] iter:  5, weight: tensor([0.1610, 0.0429, 0.0843, 0.0362, 0.2633, 0.0193, 0.0489, 0.0999, 0.1789,
        0.0653])
[rfa agg] iter:  6, prev_obj_val: 67.43550872802734, obj_val: 69.93121337890625, abs dis: 2.4957046508789062
[rfa agg] iter:  6, weight: tensor([0.1381, 0.0471, 0.0996, 0.0393, 0.2572, 0.0191, 0.0544, 0.1205, 0.1499,
        0.0747])
[rfa agg] iter:  7, prev_obj_val: 69.93121337890625, obj_val: 67.43557739257812, abs dis: 2.495635986328125
[rfa agg] iter:  7, weight: tensor([0.1598, 0.0427, 0.0837, 0.0360, 0.2681, 0.0192, 0.0486, 0.0992, 0.1778,
        0.0649])
[rfa agg] iter:  8, prev_obj_val: 67.43557739257812, obj_val: 69.93118286132812, abs dis: 2.49560546875
[rfa agg] iter:  8, weight: tensor([0.1379, 0.0471, 0.0995, 0.0392, 0.2583, 0.0191, 0.0543, 0.1204, 0.1496,
        0.0746])
[rfa agg] iter:  9, prev_obj_val: 69.93118286132812, obj_val: 67.43557739257812, abs dis: 2.49560546875
[rfa agg] iter:  9, weight: tensor([0.1597, 0.0427, 0.0837, 0.0360, 0.2684, 0.0192, 0.0486, 0.0992, 0.1777,
        0.0649])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.7034, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 10.6687, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.77496099472046 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0671, Accuracy: 226/708 (31.9209%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0336, Accuracy: 422/708 (59.6045%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6457, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0673, Accuracy: 242/690 (35.0725%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0325, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3034, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0591, Accuracy: 385/1904 (20.2206%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 722/1904 (37.9202%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6604, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0537, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2233, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0872, Accuracy: 4/373 (1.0724%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0506, Accuracy: 131/373 (35.1206%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2812, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0666, Accuracy: 150/938 (15.9915%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 320/938 (34.1151%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9480, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 372/1742 (21.3548%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6324, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 172/953 (18.0483%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5424, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0563, Accuracy: 343/1949 (17.5988%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0340, Accuracy: 617/1949 (31.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6729, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0601, Accuracy: 138/861 (16.0279%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 432/861 (50.1742%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.5034, Accuracy: 94/10000 (0.9400%)
time spent on training: 137.90305495262146
[rfa agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 25, 46, 76, 98, 73, 93, 64, 21, 10], weight: tensor([0.0669, 0.0652, 0.1799, 0.0440, 0.0352, 0.0886, 0.1646, 0.0900, 0.1841,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 79.46580505371094, obj_val: 80.71052551269531, abs dis: 1.244720458984375
[rfa agg] iter:  0, weight: tensor([0.0711, 0.0611, 0.1227, 0.0301, 0.0203, 0.1611, 0.1372, 0.1617, 0.1152,
        0.1195])
[rfa agg] iter:  1, prev_obj_val: 80.71052551269531, obj_val: 84.68833923339844, abs dis: 3.977813720703125
[rfa agg] iter:  1, weight: tensor([0.0733, 0.0605, 0.0781, 0.0275, 0.0179, 0.2226, 0.0845, 0.2191, 0.0741,
        0.1425])
[rfa agg] iter:  2, prev_obj_val: 84.68833923339844, obj_val: 86.52104949951172, abs dis: 1.8327102661132812
[rfa agg] iter:  2, weight: tensor([0.0766, 0.0578, 0.0379, 0.0217, 0.0132, 0.2686, 0.0399, 0.2463, 0.0364,
        0.2016])
[rfa agg] iter:  3, prev_obj_val: 86.52104949951172, obj_val: 88.70079040527344, abs dis: 2.1797409057617188
[rfa agg] iter:  3, weight: tensor([0.0941, 0.0695, 0.0386, 0.0246, 0.0147, 0.2264, 0.0404, 0.2149, 0.0371,
        0.2397])
[rfa agg] iter:  4, prev_obj_val: 88.70079040527344, obj_val: 91.11856842041016, abs dis: 2.4177780151367188
[rfa agg] iter:  4, weight: tensor([0.1225, 0.0883, 0.0407, 0.0291, 0.0170, 0.1866, 0.0424, 0.1821, 0.0392,
        0.2521])
[rfa agg] iter:  5, prev_obj_val: 91.11856842041016, obj_val: 93.70829772949219, abs dis: 2.5897293090820312
[rfa agg] iter:  5, weight: tensor([0.1611, 0.1139, 0.0426, 0.0343, 0.0196, 0.1601, 0.0442, 0.1584, 0.0412,
        0.2246])
[rfa agg] iter:  6, prev_obj_val: 93.70829772949219, obj_val: 91.11707305908203, abs dis: 2.5912246704101562
[rfa agg] iter:  6, weight: tensor([0.2045, 0.1459, 0.0431, 0.0394, 0.0218, 0.1378, 0.0445, 0.1375, 0.0417,
        0.1838])
[rfa agg] iter:  7, prev_obj_val: 91.11707305908203, obj_val: 93.70416259765625, abs dis: 2.5870895385742188
[rfa agg] iter:  7, weight: tensor([0.1731, 0.1159, 0.0426, 0.0345, 0.0197, 0.1580, 0.0442, 0.1566, 0.0412,
        0.2141])
[rfa agg] iter:  8, prev_obj_val: 93.70416259765625, obj_val: 91.1176528930664, abs dis: 2.5865097045898438
[rfa agg] iter:  8, weight: tensor([0.2070, 0.1457, 0.0430, 0.0393, 0.0218, 0.1375, 0.0444, 0.1372, 0.0416,
        0.1824])
[rfa agg] iter:  9, prev_obj_val: 91.1176528930664, obj_val: 93.70408630371094, abs dis: 2.5864334106445312
[rfa agg] iter:  9, weight: tensor([0.1735, 0.1159, 0.0426, 0.0345, 0.0197, 0.1580, 0.0442, 0.1566, 0.0412,
        0.2138])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 12.3211, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 13.6007, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.85075759887695 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0561, Accuracy: 322/1949 (16.5213%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 619/1949 (31.7599%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.8443, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0895, Accuracy: 40/631 (6.3391%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0482, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4659, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0717, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0408, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.9507, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0451, Accuracy: 418/1552 (26.9330%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 722/1552 (46.5206%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 11.8032, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0595, Accuracy: 267/928 (28.7716%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.4551, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0719, Accuracy: 133/773 (17.2057%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0346, Accuracy: 371/773 (47.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.2723, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0469, Accuracy: 422/891 (47.3625%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.6444, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0882, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0551, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1671, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0584, Accuracy: 215/813 (26.4453%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 13.0165, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0622, Accuracy: 210/1513 (13.8797%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 443/1513 (29.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.1068, Accuracy: 104/10000 (1.0400%)
time spent on training: 149.50705671310425
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 48, 18, 74, 1, 99, 7, 76, 53, 8], weight: tensor([0.1940, 0.0628, 0.0528, 0.1545, 0.0924, 0.0769, 0.0887, 0.0464, 0.0809,
        0.1506])
[rfa agg] iter:  0, prev_obj_val: 67.90689086914062, obj_val: 68.75054168701172, abs dis: 0.8436508178710938
[rfa agg] iter:  0, weight: tensor([0.0877, 0.0507, 0.0376, 0.1234, 0.1839, 0.1001, 0.1431, 0.0297, 0.1059,
        0.1379])
[rfa agg] iter:  1, prev_obj_val: 68.75054168701172, obj_val: 72.71968841552734, abs dis: 3.969146728515625
[rfa agg] iter:  1, weight: tensor([0.0558, 0.0500, 0.0356, 0.0719, 0.2401, 0.1200, 0.1924, 0.0272, 0.1289,
        0.0781])
[rfa agg] iter:  2, prev_obj_val: 72.71968841552734, obj_val: 76.76937103271484, abs dis: 4.0496826171875
[rfa agg] iter:  2, weight: tensor([0.0383, 0.0588, 0.0389, 0.0462, 0.1488, 0.1792, 0.2088, 0.0283, 0.2035,
        0.0492])
[rfa agg] iter:  3, prev_obj_val: 76.76937103271484, obj_val: 76.75112915039062, abs dis: 0.01824188232421875
[rfa agg] iter:  3, weight: tensor([0.0378, 0.0818, 0.0509, 0.0443, 0.1098, 0.1998, 0.1612, 0.0356, 0.2318,
        0.0469])
[rfa agg] iter:  4, prev_obj_val: 76.75112915039062, obj_val: 76.7508544921875, abs dis: 0.000274658203125
[rfa agg] iter:  4, weight: tensor([0.0374, 0.0814, 0.0506, 0.0438, 0.1073, 0.2014, 0.1563, 0.0353, 0.2401,
        0.0463])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 14.9045, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 16.7695, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.48236751556396 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0605, Accuracy: 208/636 (32.7044%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.2857, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0566, Accuracy: 301/1662 (18.1107%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 575/1662 (34.5969%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8571, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0608, Accuracy: 261/928 (28.1250%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 594/928 (64.0086%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.6714, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0760, Accuracy: 264/1003 (26.3210%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0377, Accuracy: 359/1003 (35.7926%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6869, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0557, Accuracy: 367/1949 (18.8302%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0338, Accuracy: 604/1949 (30.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3289, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0585, Accuracy: 237/776 (30.5412%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5024, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0640, Accuracy: 168/605 (27.7686%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7769, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0565, Accuracy: 309/901 (34.2952%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 398/901 (44.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8094, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0664, Accuracy: 124/568 (21.8310%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3902, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0726, Accuracy: 193/774 (24.9354%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0409, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7106, Accuracy: 74/10000 (0.7400%)
time spent on training: 140.37245106697083
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 94, 1, 86, 21, 75, 2, 4, 62, 81], weight: tensor([0.0649, 0.1696, 0.0947, 0.1023, 0.1988, 0.0792, 0.0617, 0.0919, 0.0579,
        0.0790])
[rfa agg] iter:  0, prev_obj_val: 63.187591552734375, obj_val: 65.23536682128906, abs dis: 2.0477752685546875
[rfa agg] iter:  0, weight: tensor([0.0402, 0.0824, 0.1612, 0.2588, 0.0625, 0.0840, 0.0384, 0.1577, 0.0318,
        0.0830])
[rfa agg] iter:  1, prev_obj_val: 65.23536682128906, obj_val: 66.83670806884766, abs dis: 1.6013412475585938
[rfa agg] iter:  1, weight: tensor([0.0539, 0.0428, 0.1405, 0.1180, 0.0359, 0.1945, 0.0520, 0.1385, 0.0395,
        0.1844])
[rfa agg] iter:  2, prev_obj_val: 66.83670806884766, obj_val: 66.82201385498047, abs dis: 0.0146942138671875
[rfa agg] iter:  2, weight: tensor([0.0588, 0.0391, 0.1126, 0.0939, 0.0332, 0.2327, 0.0568, 0.1131, 0.0420,
        0.2176])
[rfa agg] iter:  3, prev_obj_val: 66.82201385498047, obj_val: 71.45357513427734, abs dis: 4.631561279296875
[rfa agg] iter:  3, weight: tensor([0.0578, 0.0384, 0.1090, 0.0917, 0.0326, 0.2407, 0.0559, 0.1103, 0.0413,
        0.2221])
[rfa agg] iter:  4, prev_obj_val: 71.45357513427734, obj_val: 74.1040267944336, abs dis: 2.65045166015625
[rfa agg] iter:  4, weight: tensor([0.0925, 0.0425, 0.0979, 0.0853, 0.0368, 0.2012, 0.0907, 0.0973, 0.0635,
        0.1924])
[rfa agg] iter:  5, prev_obj_val: 74.1040267944336, obj_val: 74.09278869628906, abs dis: 0.01123809814453125
[rfa agg] iter:  5, weight: tensor([0.1209, 0.0441, 0.0929, 0.0825, 0.0385, 0.1669, 0.1199, 0.0919, 0.0804,
        0.1619])
[rfa agg] iter:  6, prev_obj_val: 74.09278869628906, obj_val: 74.09271240234375, abs dis: 7.62939453125e-05
[rfa agg] iter:  6, weight: tensor([0.1234, 0.0441, 0.0927, 0.0823, 0.0385, 0.1648, 0.1223, 0.0917, 0.0808,
        0.1594])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.5757, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 12.5333, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.56777048110962 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0698, Accuracy: 246/1190 (20.6723%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4906, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0729, Accuracy: 85/500 (17.0000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8544, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0555, Accuracy: 335/1645 (20.3647%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 626/1645 (38.0547%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6930, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0782, Accuracy: 51/426 (11.9718%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0441, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6509, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 165/605 (27.2727%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 322/605 (53.2231%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0875, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 184/861 (21.3705%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 430/861 (49.9419%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.2085, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0787, Accuracy: 85/809 (10.5068%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0300, Accuracy: 299/809 (36.9592%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.9355, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0623, Accuracy: 277/1418 (19.5346%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 588/1418 (41.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.9215, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0598, Accuracy: 206/1013 (20.3356%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0342, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4338, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0610, Accuracy: 203/590 (34.4068%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 11.8892, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.40161967277527
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 82, 13, 67, 2, 10, 50, 70, 14, 69], weight: tensor([0.1314, 0.0552, 0.1816, 0.0470, 0.0668, 0.0951, 0.0893, 0.1566, 0.1118,
        0.0651])
[rfa agg] iter:  0, prev_obj_val: 53.83176803588867, obj_val: 56.07149887084961, abs dis: 2.2397308349609375
[rfa agg] iter:  0, weight: tensor([0.1048, 0.0315, 0.0592, 0.0231, 0.0538, 0.2233, 0.1709, 0.0689, 0.2116,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 56.07149887084961, obj_val: 59.616844177246094, abs dis: 3.5453453063964844
[rfa agg] iter:  1, weight: tensor([0.0817, 0.0345, 0.0510, 0.0248, 0.0633, 0.2434, 0.2366, 0.0578, 0.1445,
        0.0625])
[rfa agg] iter:  2, prev_obj_val: 59.616844177246094, obj_val: 64.0196304321289, abs dis: 4.4027862548828125
[rfa agg] iter:  2, weight: tensor([0.0743, 0.0443, 0.0504, 0.0308, 0.0895, 0.1827, 0.2694, 0.0558, 0.1141,
        0.0888])
[rfa agg] iter:  3, prev_obj_val: 64.0196304321289, obj_val: 68.93306732177734, abs dis: 4.9134368896484375
[rfa agg] iter:  3, weight: tensor([0.0709, 0.0608, 0.0513, 0.0403, 0.1412, 0.1377, 0.2012, 0.0558, 0.0990,
        0.1418])
[rfa agg] iter:  4, prev_obj_val: 68.93306732177734, obj_val: 66.36979675292969, abs dis: 2.5632705688476562
[rfa agg] iter:  4, weight: tensor([0.0589, 0.0764, 0.0451, 0.0471, 0.2066, 0.0976, 0.1264, 0.0482, 0.0769,
        0.2167])
[rfa agg] iter:  5, prev_obj_val: 66.36979675292969, obj_val: 68.88724517822266, abs dis: 2.5174484252929688
[rfa agg] iter:  5, weight: tensor([0.0638, 0.0683, 0.0476, 0.0436, 0.1853, 0.1124, 0.1506, 0.0514, 0.0860,
        0.1909])
[rfa agg] iter:  6, prev_obj_val: 68.88724517822266, obj_val: 66.37311553955078, abs dis: 2.514129638671875
[rfa agg] iter:  6, weight: tensor([0.0572, 0.0752, 0.0438, 0.0462, 0.2137, 0.0945, 0.1215, 0.0469, 0.0747,
        0.2264])
[rfa agg] iter:  7, prev_obj_val: 66.37311553955078, obj_val: 68.88688659667969, abs dis: 2.5137710571289062
[rfa agg] iter:  7, weight: tensor([0.0637, 0.0683, 0.0475, 0.0436, 0.1860, 0.1121, 0.1500, 0.0513, 0.0858,
        0.1918])
[rfa agg] iter:  8, prev_obj_val: 68.88688659667969, obj_val: 66.3731689453125, abs dis: 2.5137176513671875
[rfa agg] iter:  8, weight: tensor([0.0572, 0.0752, 0.0438, 0.0461, 0.2137, 0.0944, 0.1215, 0.0469, 0.0747,
        0.2265])
[rfa agg] iter:  9, prev_obj_val: 66.3731689453125, obj_val: 68.88687896728516, abs dis: 2.5137100219726562
[rfa agg] iter:  9, weight: tensor([0.0637, 0.0683, 0.0475, 0.0436, 0.1860, 0.1121, 0.1500, 0.0513, 0.0858,
        0.1918])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.2958, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 13.3676, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.3296685218811 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0638, Accuracy: 328/1750 (18.7429%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 652/1750 (37.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1181, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0582, Accuracy: 284/1446 (19.6404%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 507/1446 (35.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8360, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0547, Accuracy: 238/813 (29.2743%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 482/813 (59.2866%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 13.1860, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0602, Accuracy: 247/1131 (21.8391%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0324, Accuracy: 423/1131 (37.4005%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.7920, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0610, Accuracy: 251/1154 (21.7504%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0315, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.0852, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0576, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0347, Accuracy: 550/1662 (33.0927%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.6793, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0870, Accuracy: 18/460 (3.9130%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.7476, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0611, Accuracy: 177/605 (29.2562%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0436, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0784, Accuracy: 203/774 (26.2274%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0420, Accuracy: 300/774 (38.7597%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.4580, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0860, Accuracy: 37/631 (5.8637%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0465, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8052, Accuracy: 67/10000 (0.6700%)
time spent on training: 148.71592140197754
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 26, 53, 87, 15, 94, 31, 2, 81, 48], weight: tensor([0.1678, 0.1387, 0.0780, 0.1085, 0.1107, 0.1594, 0.0441, 0.0580, 0.0742,
        0.0605])
[rfa agg] iter:  0, prev_obj_val: 57.662193298339844, obj_val: 63.36027526855469, abs dis: 5.698081970214844
[rfa agg] iter:  0, weight: tensor([0.0677, 0.1037, 0.0717, 0.3283, 0.1957, 0.0794, 0.0197, 0.0326, 0.0671,
        0.0342])
[rfa agg] iter:  1, prev_obj_val: 63.36027526855469, obj_val: 63.299827575683594, abs dis: 0.06044769287109375
[rfa agg] iter:  1, weight: tensor([0.0684, 0.0931, 0.1411, 0.2072, 0.1462, 0.0775, 0.0296, 0.0523, 0.1295,
        0.0551])
[rfa agg] iter:  2, prev_obj_val: 63.299827575683594, obj_val: 63.29972839355469, abs dis: 9.918212890625e-05
[rfa agg] iter:  2, weight: tensor([0.0683, 0.0929, 0.1447, 0.2025, 0.1442, 0.0773, 0.0296, 0.0525, 0.1326,
        0.0553])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.8626, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 13.2607, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.9880816936493 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0893, Accuracy: 40/682 (5.8651%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0394, Accuracy: 268/682 (39.2962%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.5833, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0877, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0709, Accuracy: 35/186 (18.8172%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.5093, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0668, Accuracy: 147/938 (15.6716%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.9122, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0453, Accuracy: 444/1552 (28.6082%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 787/1552 (50.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.8212, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0859, Accuracy: 88/669 (13.1540%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0447, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4725, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0570, Accuracy: 298/1130 (26.3717%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0303, Accuracy: 456/1130 (40.3540%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.8734, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0586, Accuracy: 246/1372 (17.9300%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0320, Accuracy: 493/1372 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9298, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1065, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0856, Accuracy: 42/197 (21.3198%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8891, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0478, Accuracy: 388/891 (43.5466%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0245, Accuracy: 434/891 (48.7093%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9349, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0738, Accuracy: 83/809 (10.2596%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0285, Accuracy: 331/809 (40.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.1474, Accuracy: 85/10000 (0.8500%)
time spent on training: 137.93028950691223
[rfa agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 56, 73, 74, 45, 54, 42, 79, 7, 50], weight: tensor([0.0809, 0.0221, 0.1113, 0.1842, 0.0794, 0.1341, 0.1628, 0.0234, 0.1057,
        0.0960])
[rfa agg] iter:  0, prev_obj_val: 48.10784149169922, obj_val: 52.32640838623047, abs dis: 4.21856689453125
[rfa agg] iter:  0, weight: tensor([0.0695, 0.0057, 0.2551, 0.0551, 0.0666, 0.1132, 0.0679, 0.0068, 0.2146,
        0.1455])
[rfa agg] iter:  1, prev_obj_val: 52.32640838623047, obj_val: 54.443111419677734, abs dis: 2.1167030334472656
[rfa agg] iter:  1, weight: tensor([0.1072, 0.0064, 0.1540, 0.0479, 0.1007, 0.0818, 0.0563, 0.0077, 0.2062,
        0.2318])
[rfa agg] iter:  2, prev_obj_val: 54.443111419677734, obj_val: 59.66885757446289, abs dis: 5.225746154785156
[rfa agg] iter:  2, weight: tensor([0.1342, 0.0068, 0.1283, 0.0469, 0.1246, 0.0762, 0.0545, 0.0083, 0.1739,
        0.2464])
[rfa agg] iter:  3, prev_obj_val: 59.66885757446289, obj_val: 56.90733337402344, abs dis: 2.761524200439453
[rfa agg] iter:  3, weight: tensor([0.2153, 0.0080, 0.1030, 0.0465, 0.1887, 0.0695, 0.0529, 0.0098, 0.1293,
        0.1768])
[rfa agg] iter:  4, prev_obj_val: 56.90733337402344, obj_val: 54.45043182373047, abs dis: 2.4569015502929688
[rfa agg] iter:  4, weight: tensor([0.1852, 0.0074, 0.1133, 0.0467, 0.1659, 0.0725, 0.0536, 0.0090, 0.1445,
        0.2018])
[rfa agg] iter:  5, prev_obj_val: 54.45043182373047, obj_val: 56.91041946411133, abs dis: 2.4599876403808594
[rfa agg] iter:  5, weight: tensor([0.1406, 0.0069, 0.1276, 0.0470, 0.1302, 0.0762, 0.0547, 0.0083, 0.1684,
        0.2400])
[rfa agg] iter:  6, prev_obj_val: 56.91041946411133, obj_val: 56.89958953857422, abs dis: 0.010829925537109375
[rfa agg] iter:  6, weight: tensor([0.1754, 0.0074, 0.1145, 0.0470, 0.1586, 0.0730, 0.0540, 0.0091, 0.1481,
        0.2131])
[rfa agg] iter:  7, prev_obj_val: 56.89958953857422, obj_val: 56.8994140625, abs dis: 0.00017547607421875
[rfa agg] iter:  7, weight: tensor([0.1799, 0.0074, 0.1138, 0.0468, 0.1621, 0.0727, 0.0538, 0.0090, 0.1463,
        0.2082])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.4865, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 14.2110, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.43999981880188 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0548, Accuracy: 386/1574 (24.5235%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0258, Accuracy: 799/1574 (50.7624%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0204, Accuracy: 914/1574 (58.0686%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0200, Accuracy: 935/1574 (59.4028%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0195, Accuracy: 968/1574 (61.4994%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0195, Accuracy: 961/1574 (61.0546%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0188, Accuracy: 971/1574 (61.6900%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0183, Accuracy: 994/1574 (63.1512%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0181, Accuracy: 996/1574 (63.2783%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0181, Accuracy: 992/1574 (63.0241%), train_poison_data_count: 500
Global model norm: 204.63714075162406.
Norm before scaling: 204.58291221103977. Distance: 1.315641775499978
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3713, Accuracy: 98/10000 (0.9800%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.2010, Accuracy: 9764/9950 (98.1307%)
Scaling by  100
Scaled Norm after poisoning: 238.3120656303411, distance: 131.56417754274906
Total norm for 1 adversaries is: 238.3120656303411. distance: 131.56417754274906
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0685, Accuracy: 266/1190 (22.3529%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 408/1190 (34.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.8641, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0702, Accuracy: 103/809 (12.7318%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 333/809 (41.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.9194, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0651, Accuracy: 228/690 (33.0435%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0302, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5640, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 553/1645 (33.6170%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.6284, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0515, Accuracy: 273/599 (45.5760%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 12.7015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0868, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 133/373 (35.6568%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9662, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0582, Accuracy: 278/1372 (20.2624%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0330, Accuracy: 482/1372 (35.1312%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.1028, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 258/1154 (22.3570%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 507/1154 (43.9341%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.7937, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0562, Accuracy: 295/1130 (26.1062%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0298, Accuracy: 471/1130 (41.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5681, Accuracy: 60/10000 (0.6000%)
time spent on training: 261.8031384944916
[rfa agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.04668517463933181
[rfa agg] init. name: [17, 84, 50, 25, 13, 95, 98, 42, 15, 54], weight: tensor([0.1494, 0.1129, 0.0768, 0.0655, 0.1561, 0.0569, 0.0354, 0.1302, 0.1095,
        0.1073])
[rfa agg] iter:  0, prev_obj_val: 28455.0546875, obj_val: 19065.3125, abs dis: 9389.7421875
[rfa agg] iter:  0, weight: tensor([0.0299, 0.1289, 0.0873, 0.0744, 0.1788, 0.0646, 0.0401, 0.1488, 0.1250,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 19065.3125, obj_val: 17139.66015625, abs dis: 1925.65234375
[rfa agg] iter:  1, weight: tensor([0.0053, 0.1323, 0.0885, 0.0751, 0.1864, 0.0650, 0.0400, 0.1538, 0.1283,
        0.1253])
[rfa agg] iter:  2, prev_obj_val: 17139.66015625, obj_val: 16798.34765625, abs dis: 341.3125
[rfa agg] iter:  2, weight: tensor([0.0009, 0.1331, 0.0827, 0.0686, 0.2067, 0.0587, 0.0346, 0.1611, 0.1291,
        0.1245])
[rfa agg] iter:  3, prev_obj_val: 16798.34765625, obj_val: 16772.64453125, abs dis: 25.703125
[rfa agg] iter:  3, weight: tensor([9.4964e-05, 9.7798e-02, 4.0434e-02, 3.0448e-02, 4.4969e-01, 2.4931e-02,
        1.2654e-02, 1.6572e-01, 9.4277e-02, 8.3962e-02])
[rfa agg] iter:  4, prev_obj_val: 16772.64453125, obj_val: 16772.580078125, abs dis: 0.064453125
[rfa agg] iter:  4, weight: tensor([5.3188e-05, 1.8201e-01, 4.1776e-02, 2.8783e-02, 1.3492e-01, 2.2637e-02,
        1.0329e-02, 2.7845e-01, 1.6449e-01, 1.3654e-01])
[rfa agg] iter:  5, prev_obj_val: 16772.580078125, obj_val: 16776.94921875, abs dis: 4.369140625
[rfa agg] iter:  5, weight: tensor([4.3779e-05, 2.4213e-01, 4.9352e-02, 3.1387e-02, 7.3793e-02, 2.3968e-02,
        1.0151e-02, 1.2628e-01, 1.9979e-01, 2.4310e-01])
[rfa agg] iter:  6, prev_obj_val: 16776.94921875, obj_val: 16778.943359375, abs dis: 1.994140625
[rfa agg] iter:  6, weight: tensor([5.1948e-05, 1.9668e-01, 7.8101e-02, 4.6047e-02, 7.3506e-02, 3.4171e-02,
        1.3608e-02, 1.0715e-01, 1.7477e-01, 2.7591e-01])
[rfa agg] iter:  7, prev_obj_val: 16778.943359375, obj_val: 16781.076171875, abs dis: 2.1328125
[rfa agg] iter:  7, weight: tensor([5.6956e-05, 1.8268e-01, 9.6526e-02, 5.4896e-02, 7.6573e-02, 4.0222e-02,
        1.5604e-02, 1.0779e-01, 1.6669e-01, 2.5897e-01])
[rfa agg] iter:  8, prev_obj_val: 16781.076171875, obj_val: 16778.9453125, abs dis: 2.130859375
[rfa agg] iter:  8, weight: tensor([6.1707e-05, 1.7218e-01, 1.1947e-01, 6.5075e-02, 7.9021e-02, 4.6980e-02,
        1.7708e-02, 1.0791e-01, 1.5952e-01, 2.3208e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.9685, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 13.2877, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.2383830547333 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0622, Accuracy: 282/807 (34.9442%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0337, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7444, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0554, Accuracy: 412/1715 (24.0233%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 743/1715 (43.3236%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4387, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0768, Accuracy: 89/426 (20.8920%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0451, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7355, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0785, Accuracy: 87/631 (13.7876%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0456, Accuracy: 208/631 (32.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1858, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 311/1030 (30.1942%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0269, Accuracy: 615/1030 (59.7087%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 11.1663, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0563, Accuracy: 417/1988 (20.9759%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0368, Accuracy: 607/1988 (30.5332%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.9046, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0880, Accuracy: 54/466 (11.5880%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0536, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4251, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0640, Accuracy: 323/1956 (16.5133%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1956 (31.7485%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4658, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0554, Accuracy: 393/1953 (20.1229%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 738/1953 (37.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3631, Accuracy: 104/10000 (1.0400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0537, Accuracy: 346/1574 (21.9822%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 595/1574 (37.8018%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0753, Accuracy: 97/10000 (0.9700%)
time spent on training: 174.5525665283203
[rfa agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.039205722939582334
[rfa agg] init. name: [20, 92, 67, 48, 91, 85, 76, 6, 83, 17], weight: tensor([0.0643, 0.1367, 0.0340, 0.0503, 0.0821, 0.1585, 0.0371, 0.1559, 0.1557,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 72.9869613647461, obj_val: 67.47189331054688, abs dis: 5.515068054199219
[rfa agg] iter:  0, weight: tensor([0.0452, 0.1862, 0.0146, 0.0269, 0.0921, 0.1097, 0.0172, 0.1210, 0.1208,
        0.2662])
[rfa agg] iter:  1, prev_obj_val: 67.47189331054688, obj_val: 67.4370346069336, abs dis: 0.03485870361328125
[rfa agg] iter:  1, weight: tensor([0.0306, 0.2013, 0.0105, 0.0188, 0.0586, 0.1002, 0.0122, 0.1132, 0.1129,
        0.3417])
[rfa agg] iter:  2, prev_obj_val: 67.4370346069336, obj_val: 71.00366973876953, abs dis: 3.5666351318359375
[rfa agg] iter:  2, weight: tensor([0.0299, 0.1964, 0.0102, 0.0184, 0.0570, 0.0977, 0.0119, 0.1103, 0.1101,
        0.3582])
[rfa agg] iter:  3, prev_obj_val: 71.00366973876953, obj_val: 67.44705200195312, abs dis: 3.5566177368164062
[rfa agg] iter:  3, weight: tensor([0.0389, 0.1875, 0.0129, 0.0235, 0.0773, 0.1040, 0.0150, 0.1156, 0.1155,
        0.3099])
[rfa agg] iter:  4, prev_obj_val: 67.44705200195312, obj_val: 71.00162506103516, abs dis: 3.5545730590820312
[rfa agg] iter:  4, weight: tensor([0.0302, 0.1981, 0.0103, 0.0186, 0.0577, 0.0988, 0.0120, 0.1115, 0.1113,
        0.3516])
[rfa agg] iter:  5, prev_obj_val: 71.00162506103516, obj_val: 67.44732666015625, abs dis: 3.5542984008789062
[rfa agg] iter:  5, weight: tensor([0.0389, 0.1878, 0.0129, 0.0235, 0.0773, 0.1041, 0.0150, 0.1158, 0.1156,
        0.3091])
[rfa agg] iter:  6, prev_obj_val: 67.44732666015625, obj_val: 71.0015640258789, abs dis: 3.5542373657226562
[rfa agg] iter:  6, weight: tensor([0.0302, 0.1981, 0.0103, 0.0186, 0.0577, 0.0988, 0.0120, 0.1115, 0.1113,
        0.3514])
[rfa agg] iter:  7, prev_obj_val: 71.0015640258789, obj_val: 67.44733428955078, abs dis: 3.554229736328125
[rfa agg] iter:  7, weight: tensor([0.0389, 0.1878, 0.0129, 0.0235, 0.0773, 0.1041, 0.0150, 0.1158, 0.1156,
        0.3091])
[rfa agg] iter:  8, prev_obj_val: 67.44733428955078, obj_val: 71.00155639648438, abs dis: 3.5542221069335938
[rfa agg] iter:  8, weight: tensor([0.0302, 0.1981, 0.0103, 0.0186, 0.0577, 0.0988, 0.0120, 0.1115, 0.1113,
        0.3514])
[rfa agg] iter:  9, prev_obj_val: 71.00155639648438, obj_val: 67.44733428955078, abs dis: 3.5542221069335938
[rfa agg] iter:  9, weight: tensor([0.0389, 0.1878, 0.0129, 0.0235, 0.0773, 0.1041, 0.0150, 0.1158, 0.1156,
        0.3091])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6812, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 11.8591, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.05429315567017 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0646, Accuracy: 230/712 (32.3034%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0289, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1740, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0560, Accuracy: 320/803 (39.8506%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 424/803 (52.8020%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9256, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0514, Accuracy: 241/813 (29.6433%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0201, Accuracy: 461/813 (56.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.8817, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0602, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0327, Accuracy: 385/1131 (34.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.0450, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0567, Accuracy: 257/599 (42.9048%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 13.0541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0655, Accuracy: 131/568 (23.0634%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 256/568 (45.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1555, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0585, Accuracy: 400/1475 (27.1186%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0328, Accuracy: 622/1475 (42.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2698, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0538, Accuracy: 523/2227 (23.4845%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 949/2227 (42.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9537, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0597, Accuracy: 240/1154 (20.7972%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0283, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.9374, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 229/590 (38.8136%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0282, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.6076, Accuracy: 50/10000 (0.5000%)
time spent on training: 151.23809719085693
[rfa agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 58, 53, 87, 95, 62, 65, 60, 57, 69], weight: tensor([0.0707, 0.0797, 0.0807, 0.1123, 0.0595, 0.0564, 0.1464, 0.2211, 0.1146,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 71.53617095947266, obj_val: 73.51461791992188, abs dis: 1.9784469604492188
[rfa agg] iter:  0, weight: tensor([0.0489, 0.0644, 0.0646, 0.2912, 0.0323, 0.0277, 0.1347, 0.0681, 0.2361,
        0.0319])
[rfa agg] iter:  1, prev_obj_val: 73.51461791992188, obj_val: 75.13987731933594, abs dis: 1.6252593994140625
[rfa agg] iter:  1, weight: tensor([0.0921, 0.1400, 0.1355, 0.2013, 0.0521, 0.0426, 0.0846, 0.0569, 0.1432,
        0.0516])
[rfa agg] iter:  2, prev_obj_val: 75.13987731933594, obj_val: 80.68309783935547, abs dis: 5.543220520019531
[rfa agg] iter:  2, weight: tensor([0.1110, 0.1912, 0.1792, 0.1363, 0.0574, 0.0456, 0.0688, 0.0491, 0.1044,
        0.0569])
[rfa agg] iter:  3, prev_obj_val: 80.68309783935547, obj_val: 82.84147644042969, abs dis: 2.1583786010742188
[rfa agg] iter:  3, weight: tensor([0.1611, 0.2339, 0.2030, 0.0687, 0.0723, 0.0529, 0.0437, 0.0342, 0.0579,
        0.0723])
[rfa agg] iter:  4, prev_obj_val: 82.84147644042969, obj_val: 82.83450317382812, abs dis: 0.0069732666015625
[rfa agg] iter:  4, weight: tensor([0.1837, 0.1993, 0.1825, 0.0641, 0.0882, 0.0622, 0.0427, 0.0340, 0.0549,
        0.0883])
[rfa agg] iter:  5, prev_obj_val: 82.83450317382812, obj_val: 82.83434295654297, abs dis: 0.00016021728515625
[rfa agg] iter:  5, weight: tensor([0.1893, 0.1952, 0.1804, 0.0640, 0.0887, 0.0623, 0.0426, 0.0340, 0.0548,
        0.0887])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1662, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 13.0805, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.5737292766571 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0812, Accuracy: 69/631 (10.9350%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0449, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7948, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 614/1030 (59.6117%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.5333, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0628, Accuracy: 247/1402 (17.6177%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 386/1402 (27.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2439, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0659, Accuracy: 263/946 (27.8013%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0578, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0648, Accuracy: 257/715 (35.9441%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0423, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6501, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0634, Accuracy: 321/1657 (19.3724%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0370, Accuracy: 500/1657 (30.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2816, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 302/1645 (18.3587%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 560/1645 (34.0426%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.0187, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 308/896 (34.3750%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1639, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0778, Accuracy: 130/773 (16.8176%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0370, Accuracy: 354/773 (45.7956%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.7692, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 243/590 (41.1864%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.2868, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.94010734558105
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 91, 66, 43, 23, 0, 13, 89, 99, 69], weight: tensor([0.0614, 0.1001, 0.1363, 0.0920, 0.0695, 0.1611, 0.1599, 0.0871, 0.0752,
        0.0574])
[rfa agg] iter:  0, prev_obj_val: 54.405757904052734, obj_val: 58.48276901245117, abs dis: 4.0770111083984375
[rfa agg] iter:  0, weight: tensor([0.0424, 0.1695, 0.0929, 0.2169, 0.0684, 0.0676, 0.0670, 0.1432, 0.0924,
        0.0397])
[rfa agg] iter:  1, prev_obj_val: 58.48276901245117, obj_val: 62.428009033203125, abs dis: 3.945240020751953
[rfa agg] iter:  1, weight: tensor([0.0525, 0.0990, 0.0602, 0.2018, 0.0957, 0.0480, 0.0475, 0.2072, 0.1390,
        0.0490])
[rfa agg] iter:  2, prev_obj_val: 62.428009033203125, obj_val: 62.40219497680664, abs dis: 0.025814056396484375
[rfa agg] iter:  2, weight: tensor([0.0694, 0.0809, 0.0550, 0.1432, 0.1330, 0.0454, 0.0450, 0.1876, 0.1760,
        0.0646])
[rfa agg] iter:  3, prev_obj_val: 62.40219497680664, obj_val: 62.40180587768555, abs dis: 0.00038909912109375
[rfa agg] iter:  3, weight: tensor([0.0691, 0.0798, 0.0546, 0.1396, 0.1370, 0.0450, 0.0446, 0.1834, 0.1826,
        0.0644])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.9721, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 12.2144, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.5173854827881 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0548, Accuracy: 393/1440 (27.2917%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0293, Accuracy: 667/1440 (46.3194%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.7827, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9744, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0593, Accuracy: 308/1662 (18.5319%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 587/1662 (35.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6761, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0639, Accuracy: 353/1657 (21.3036%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0369, Accuracy: 474/1657 (28.6059%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6998, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0548, Accuracy: 514/2227 (23.0804%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0295, Accuracy: 965/2227 (43.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.8201, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0559, Accuracy: 333/1949 (17.0857%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0342, Accuracy: 604/1949 (30.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.8943, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 145/373 (38.8740%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2729, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 74/426 (17.3709%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0435, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6271, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.1014, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0705, Accuracy: 88/311 (28.2958%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2214, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0781, Accuracy: 51/486 (10.4938%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0397, Accuracy: 233/486 (47.9424%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.3525, Accuracy: 67/10000 (0.6700%)
time spent on training: 158.75069975852966
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 31, 94, 0, 60, 21, 98, 67, 96, 30], weight: tensor([0.1310, 0.0419, 0.1512, 0.1508, 0.2026, 0.1773, 0.0339, 0.0388, 0.0283,
        0.0442])
[rfa agg] iter:  0, prev_obj_val: 78.63114166259766, obj_val: 73.93635559082031, abs dis: 4.694786071777344
[rfa agg] iter:  0, weight: tensor([0.3563, 0.0167, 0.1899, 0.1903, 0.0863, 0.1076, 0.0118, 0.0144, 0.0092,
        0.0176])
[rfa agg] iter:  1, prev_obj_val: 73.93635559082031, obj_val: 72.11408233642578, abs dis: 1.8222732543945312
[rfa agg] iter:  1, weight: tensor([0.4136, 0.0121, 0.1848, 0.1861, 0.0721, 0.0927, 0.0086, 0.0105, 0.0067,
        0.0128])
[rfa agg] iter:  2, prev_obj_val: 72.11408233642578, obj_val: 72.11034393310547, abs dis: 0.0037384033203125
[rfa agg] iter:  2, weight: tensor([0.3959, 0.0111, 0.1957, 0.1980, 0.0710, 0.0929, 0.0079, 0.0096, 0.0062,
        0.0117])
[rfa agg] iter:  3, prev_obj_val: 72.11034393310547, obj_val: 72.10983276367188, abs dis: 0.00051116943359375
[rfa agg] iter:  3, weight: tensor([0.3876, 0.0112, 0.1989, 0.2011, 0.0717, 0.0938, 0.0080, 0.0097, 0.0063,
        0.0118])
[rfa agg] iter:  4, prev_obj_val: 72.10983276367188, obj_val: 72.10975646972656, abs dis: 7.62939453125e-05
[rfa agg] iter:  4, weight: tensor([0.3844, 0.0112, 0.2001, 0.2023, 0.0720, 0.0941, 0.0080, 0.0097, 0.0063,
        0.0118])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.0017, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 14.4385, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.8153531551361 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0595, Accuracy: 274/1446 (18.9488%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 501/1446 (34.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9231, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0821, Accuracy: 99/669 (14.7982%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0429, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5943, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0575, Accuracy: 329/1036 (31.7568%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 668/1036 (64.4788%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 13.5598, Accuracy: 73/10000 (0.7300%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 397/1574 (25.2224%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 655/1574 (41.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8715, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0709, Accuracy: 232/1190 (19.4958%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.3900, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 198/1513 (13.0866%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0379, Accuracy: 440/1513 (29.0813%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8323, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0660, Accuracy: 203/677 (29.9852%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.8475, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0845, Accuracy: 43/682 (6.3050%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.2057, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0531, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0320, Accuracy: 415/803 (51.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.1805, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0836, Accuracy: 47/631 (7.4485%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0464, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0517, Accuracy: 75/10000 (0.7500%)
time spent on training: 167.60522365570068
[rfa agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[rfa agg] considering poison per batch poison_fraction: 0.04812396047353487
[rfa agg] init. name: [26, 45, 19, 17, 84, 8, 90, 80, 58, 48], weight: tensor([0.1415, 0.0655, 0.1014, 0.1540, 0.1164, 0.1480, 0.0662, 0.0667, 0.0786,
        0.0617])
[rfa agg] iter:  0, prev_obj_val: 52.826019287109375, obj_val: 54.96455001831055, abs dis: 2.138530731201172
[rfa agg] iter:  0, weight: tensor([0.1010, 0.0548, 0.2513, 0.0852, 0.1602, 0.0921, 0.0558, 0.0566, 0.0987,
        0.0443])
[rfa agg] iter:  1, prev_obj_val: 54.96455001831055, obj_val: 57.66299057006836, abs dis: 2.6984405517578125
[rfa agg] iter:  1, weight: tensor([0.0897, 0.0664, 0.2287, 0.0776, 0.1350, 0.0829, 0.0678, 0.0690, 0.1303,
        0.0526])
[rfa agg] iter:  2, prev_obj_val: 57.66299057006836, obj_val: 62.48003387451172, abs dis: 4.817043304443359
[rfa agg] iter:  2, weight: tensor([0.0793, 0.0822, 0.1669, 0.0702, 0.1110, 0.0743, 0.0845, 0.0863, 0.1823,
        0.0629])
[rfa agg] iter:  3, prev_obj_val: 62.48003387451172, obj_val: 66.56526184082031, abs dis: 4.085227966308594
[rfa agg] iter:  3, weight: tensor([0.0583, 0.1070, 0.0977, 0.0530, 0.0750, 0.0554, 0.1131, 0.1165, 0.2474,
        0.0765])
[rfa agg] iter:  4, prev_obj_val: 66.56526184082031, obj_val: 64.35590362548828, abs dis: 2.2093582153320312
[rfa agg] iter:  4, weight: tensor([0.0475, 0.1364, 0.0713, 0.0438, 0.0583, 0.0455, 0.1533, 0.1582, 0.1929,
        0.0929])
[rfa agg] iter:  5, prev_obj_val: 64.35590362548828, obj_val: 66.54017639160156, abs dis: 2.1842727661132812
[rfa agg] iter:  5, weight: tensor([0.0511, 0.1232, 0.0799, 0.0468, 0.0638, 0.0489, 0.1340, 0.1367, 0.2328,
        0.0828])
[rfa agg] iter:  6, prev_obj_val: 66.54017639160156, obj_val: 66.53021240234375, abs dis: 0.0099639892578125
[rfa agg] iter:  6, weight: tensor([0.0469, 0.1381, 0.0703, 0.0433, 0.0575, 0.0450, 0.1558, 0.1598, 0.1907,
        0.0925])
[rfa agg] iter:  7, prev_obj_val: 66.53021240234375, obj_val: 66.53007507324219, abs dis: 0.0001373291015625
[rfa agg] iter:  7, weight: tensor([0.0467, 0.1405, 0.0698, 0.0431, 0.0572, 0.0448, 0.1581, 0.1623, 0.1851,
        0.0926])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 15.0605, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 19.5001, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.0625400543213 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.1023, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0552, Accuracy: 104/338 (30.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8442, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1089, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0902, Accuracy: 35/197 (17.7665%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1627, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0614, Accuracy: 205/590 (34.7458%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0286, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 12.0337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1387, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1218, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1817, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0667, Accuracy: 248/1340 (18.5075%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0289, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.0913, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0649, Accuracy: 173/1071 (16.1531%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 487/1071 (45.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.5649, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0941, Accuracy: 14/408 (3.4314%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0563, Accuracy: 148/408 (36.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6285, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0781, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 208/500 (41.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2695, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0816, Accuracy: 88/669 (13.1540%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0430, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7936, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0620, Accuracy: 288/1089 (26.4463%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 12.6863, Accuracy: 66/10000 (0.6600%)
time spent on training: 132.91540622711182
[rfa agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 79, 69, 47, 77, 55, 36, 82, 45, 59], weight: tensor([0.0533, 0.0311, 0.0931, 0.0211, 0.2115, 0.1690, 0.0644, 0.0789, 0.1056,
        0.1719])
[rfa agg] iter:  0, prev_obj_val: 54.41781234741211, obj_val: 59.56614303588867, abs dis: 5.1483306884765625
[rfa agg] iter:  0, weight: tensor([0.0388, 0.0162, 0.1968, 0.0095, 0.0943, 0.1247, 0.0575, 0.0892, 0.2725,
        0.1005])
[rfa agg] iter:  1, prev_obj_val: 59.56614303588867, obj_val: 61.52163314819336, abs dis: 1.9554901123046875
[rfa agg] iter:  1, weight: tensor([0.0489, 0.0180, 0.2764, 0.0101, 0.0676, 0.0814, 0.0806, 0.1445, 0.2036,
        0.0689])
[rfa agg] iter:  2, prev_obj_val: 61.52163314819336, obj_val: 63.77024841308594, abs dis: 2.248615264892578
[rfa agg] iter:  2, weight: tensor([0.0564, 0.0196, 0.2496, 0.0109, 0.0651, 0.0767, 0.0984, 0.1921, 0.1656,
        0.0656])
[rfa agg] iter:  3, prev_obj_val: 63.77024841308594, obj_val: 63.74344253540039, abs dis: 0.026805877685546875
[rfa agg] iter:  3, weight: tensor([0.0648, 0.0213, 0.1943, 0.0116, 0.0627, 0.0726, 0.1201, 0.2508, 0.1391,
        0.0628])
[rfa agg] iter:  4, prev_obj_val: 63.74344253540039, obj_val: 66.21321105957031, abs dis: 2.469768524169922
[rfa agg] iter:  4, weight: tensor([0.0645, 0.0211, 0.1857, 0.0114, 0.0613, 0.0709, 0.1208, 0.2681, 0.1348,
        0.0613])
[rfa agg] iter:  5, prev_obj_val: 66.21321105957031, obj_val: 66.19499206542969, abs dis: 0.018218994140625
[rfa agg] iter:  5, weight: tensor([0.0729, 0.0224, 0.1478, 0.0119, 0.0579, 0.0659, 0.1448, 0.3043, 0.1146,
        0.0576])
[rfa agg] iter:  6, prev_obj_val: 66.19499206542969, obj_val: 63.75830841064453, abs dis: 2.4366836547851562
[rfa agg] iter:  6, weight: tensor([0.0719, 0.0219, 0.1415, 0.0117, 0.0561, 0.0639, 0.1454, 0.3215, 0.1104,
        0.0557])
[rfa agg] iter:  7, prev_obj_val: 63.75830841064453, obj_val: 66.20606231689453, abs dis: 2.44775390625
[rfa agg] iter:  7, weight: tensor([0.0638, 0.0207, 0.1757, 0.0112, 0.0596, 0.0688, 0.1210, 0.2904, 0.1294,
        0.0595])
[rfa agg] iter:  8, prev_obj_val: 66.20606231689453, obj_val: 66.19441986083984, abs dis: 0.0116424560546875
[rfa agg] iter:  8, weight: tensor([0.0723, 0.0222, 0.1457, 0.0118, 0.0572, 0.0652, 0.1440, 0.3116, 0.1131,
        0.0569])
[rfa agg] iter:  9, prev_obj_val: 66.19441986083984, obj_val: 66.19377136230469, abs dis: 0.00064849853515625
[rfa agg] iter:  9, weight: tensor([0.0717, 0.0218, 0.1409, 0.0116, 0.0559, 0.0636, 0.1450, 0.3240, 0.1099,
        0.0555])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 15.0243, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 20.3221, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.91822481155396 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0574, Accuracy: 268/1130 (23.7168%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 508/1130 (44.9558%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.2239, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0596, Accuracy: 221/712 (31.0393%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0283, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.7819, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0837, Accuracy: 8/440 (1.8182%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0498, Accuracy: 139/440 (31.5909%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1595, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0683, Accuracy: 131/818 (16.0147%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 350/818 (42.7873%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.3145, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 588/1645 (35.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0066, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.1011, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0559, Accuracy: 107/312 (34.2949%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3981, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0797, Accuracy: 49/631 (7.7655%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0444, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2310, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 42/486 (8.6420%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0426, Accuracy: 231/486 (47.5309%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.1816, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0552, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3832, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0631, Accuracy: 208/1071 (19.4211%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0309, Accuracy: 470/1071 (43.8842%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.1135, Accuracy: 73/10000 (0.7300%)
time spent on training: 141.1801300048828
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 11, 49, 71, 13, 24, 48, 30, 76, 55], weight: tensor([0.1465, 0.0923, 0.0571, 0.1061, 0.2133, 0.0405, 0.0818, 0.0630, 0.0604,
        0.1389])
[rfa agg] iter:  0, prev_obj_val: 55.28080749511719, obj_val: 61.571022033691406, abs dis: 6.290214538574219
[rfa agg] iter:  0, weight: tensor([0.1079, 0.1954, 0.0358, 0.2674, 0.0638, 0.0188, 0.0963, 0.0473, 0.0450,
        0.1224])
[rfa agg] iter:  1, prev_obj_val: 61.571022033691406, obj_val: 65.59828186035156, abs dis: 4.027259826660156
[rfa agg] iter:  1, weight: tensor([0.0748, 0.1828, 0.0571, 0.1502, 0.0537, 0.0258, 0.2113, 0.0849, 0.0786,
        0.0807])
[rfa agg] iter:  2, prev_obj_val: 65.59828186035156, obj_val: 67.97550964355469, abs dis: 2.377227783203125
[rfa agg] iter:  2, weight: tensor([0.0648, 0.1258, 0.0744, 0.1078, 0.0493, 0.0301, 0.2477, 0.1213, 0.1100,
        0.0687])
[rfa agg] iter:  3, prev_obj_val: 67.97550964355469, obj_val: 65.5566635131836, abs dis: 2.4188461303710938
[rfa agg] iter:  3, weight: tensor([0.0610, 0.1065, 0.0887, 0.0947, 0.0477, 0.0332, 0.2137, 0.1535, 0.1368,
        0.0643])
[rfa agg] iter:  4, prev_obj_val: 65.5566635131836, obj_val: 65.54457092285156, abs dis: 0.01209259033203125
[rfa agg] iter:  4, weight: tensor([0.0632, 0.1194, 0.0755, 0.1037, 0.0482, 0.0301, 0.2518, 0.1263, 0.1151,
        0.0668])
[rfa agg] iter:  5, prev_obj_val: 65.54457092285156, obj_val: 67.97386932373047, abs dis: 2.4292984008789062
[rfa agg] iter:  5, weight: tensor([0.0630, 0.1196, 0.0743, 0.1035, 0.0480, 0.0297, 0.2600, 0.1230, 0.1123,
        0.0666])
[rfa agg] iter:  6, prev_obj_val: 67.97386932373047, obj_val: 65.55665588378906, abs dis: 2.4172134399414062
[rfa agg] iter:  6, weight: tensor([0.0609, 0.1059, 0.0886, 0.0943, 0.0475, 0.0331, 0.2152, 0.1534, 0.1370,
        0.0640])
[rfa agg] iter:  7, prev_obj_val: 65.55665588378906, obj_val: 65.5445556640625, abs dis: 0.0121002197265625
[rfa agg] iter:  7, weight: tensor([0.0631, 0.1194, 0.0754, 0.1036, 0.0482, 0.0300, 0.2521, 0.1263, 0.1151,
        0.0668])
[rfa agg] iter:  8, prev_obj_val: 65.5445556640625, obj_val: 67.97388458251953, abs dis: 2.4293289184570312
[rfa agg] iter:  8, weight: tensor([0.0630, 0.1196, 0.0743, 0.1035, 0.0480, 0.0297, 0.2601, 0.1229, 0.1123,
        0.0666])
[rfa agg] iter:  9, prev_obj_val: 67.97388458251953, obj_val: 65.55665588378906, abs dis: 2.4172286987304688
[rfa agg] iter:  9, weight: tensor([0.0609, 0.1059, 0.0886, 0.0943, 0.0475, 0.0331, 0.2152, 0.1534, 0.1370,
        0.0640])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 14.6160, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 19.3720, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.43280482292175 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0559, Accuracy: 333/803 (41.4695%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 395/803 (49.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0838, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0598, Accuracy: 216/712 (30.3371%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.6227, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0656, Accuracy: 217/928 (23.3836%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.4062, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0643, Accuracy: 247/1402 (17.6177%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 352/1402 (25.1070%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0972, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0780, Accuracy: 57/631 (9.0333%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0436, Accuracy: 225/631 (35.6577%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7460, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0707, Accuracy: 115/818 (14.0587%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0318, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.0495, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0860, Accuracy: 38/515 (7.3786%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0564, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6034, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.1021, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0569, Accuracy: 102/338 (30.1775%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7981, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0705, Accuracy: 209/719 (29.0682%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0370, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.6386, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0665, Accuracy: 312/1956 (15.9509%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0341, Accuracy: 581/1956 (29.7035%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.1067, Accuracy: 91/10000 (0.9100%)
time spent on training: 150.39747405052185
[rfa agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 11, 1, 66, 48, 71, 33, 12, 41, 6], weight: tensor([0.0910, 0.0807, 0.1052, 0.1589, 0.0715, 0.0927, 0.0584, 0.0383, 0.0815,
        0.2217])
[rfa agg] iter:  0, prev_obj_val: 63.464324951171875, obj_val: 64.01665496826172, abs dis: 0.5523300170898438
[rfa agg] iter:  0, weight: tensor([0.1546, 0.1029, 0.2169, 0.0942, 0.0588, 0.1553, 0.0401, 0.0177, 0.1001,
        0.0594])
[rfa agg] iter:  1, prev_obj_val: 64.01665496826172, obj_val: 66.77339935302734, abs dis: 2.756744384765625
[rfa agg] iter:  1, weight: tensor([0.1994, 0.1378, 0.1236, 0.0542, 0.0668, 0.1959, 0.0414, 0.0163, 0.1260,
        0.0385])
[rfa agg] iter:  2, prev_obj_val: 66.77339935302734, obj_val: 71.33760070800781, abs dis: 4.564201354980469
[rfa agg] iter:  2, weight: tensor([0.1722, 0.1712, 0.0917, 0.0488, 0.0907, 0.1691, 0.0518, 0.0187, 0.1495,
        0.0364])
[rfa agg] iter:  3, prev_obj_val: 71.33760070800781, obj_val: 74.07475280761719, abs dis: 2.737152099609375
[rfa agg] iter:  3, weight: tensor([0.1341, 0.1647, 0.0829, 0.0503, 0.1452, 0.1335, 0.0761, 0.0247, 0.1493,
        0.0391])
[rfa agg] iter:  4, prev_obj_val: 74.07475280761719, obj_val: 71.32461547851562, abs dis: 2.7501373291015625
[rfa agg] iter:  4, weight: tensor([0.1197, 0.1455, 0.0793, 0.0508, 0.1859, 0.1192, 0.0937, 0.0285, 0.1370,
        0.0402])
[rfa agg] iter:  5, prev_obj_val: 71.32461547851562, obj_val: 71.31816101074219, abs dis: 0.0064544677734375
[rfa agg] iter:  5, weight: tensor([0.1328, 0.1599, 0.0820, 0.0500, 0.1555, 0.1303, 0.0777, 0.0247, 0.1482,
        0.0389])
[rfa agg] iter:  6, prev_obj_val: 71.31816101074219, obj_val: 71.31807708740234, abs dis: 8.392333984375e-05
[rfa agg] iter:  6, weight: tensor([0.1330, 0.1620, 0.0822, 0.0501, 0.1517, 0.1309, 0.0770, 0.0247, 0.1494,
        0.0389])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 16.3968, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 17.5572, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.88659238815308 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 234/712 (32.8652%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0298, Accuracy: 444/712 (62.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.4599, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0532, Accuracy: 553/2227 (24.8316%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 955/2227 (42.8828%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8483, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0657, Accuracy: 256/946 (27.0613%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0377, Accuracy: 334/946 (35.3066%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3944, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0879, Accuracy: 42/466 (9.0129%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0548, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5609, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0633, Accuracy: 231/1372 (16.8367%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0342, Accuracy: 459/1372 (33.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0593, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 210/1049 (20.0191%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 512/1049 (48.8084%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.3101, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0868, Accuracy: 46/515 (8.9320%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0553, Accuracy: 135/515 (26.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2868, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0557, Accuracy: 289/1030 (28.0583%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 603/1030 (58.5437%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.7653, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0629, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 647/1418 (45.6276%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6918, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0641, Accuracy: 143/861 (16.6086%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.3051, Accuracy: 92/10000 (0.9200%)
time spent on training: 163.0641791820526
[rfa agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 60, 43, 76, 42, 51, 33, 91, 70, 10], weight: tensor([0.0672, 0.2102, 0.0893, 0.0440, 0.1295, 0.0990, 0.0486, 0.0972, 0.1338,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 66.17076873779297, obj_val: 68.88728332519531, abs dis: 2.7165145874023438
[rfa agg] iter:  0, weight: tensor([0.0508, 0.0581, 0.1207, 0.0204, 0.1351, 0.2105, 0.0248, 0.1751, 0.1172,
        0.0873])
[rfa agg] iter:  1, prev_obj_val: 68.88728332519531, obj_val: 71.9841079711914, abs dis: 3.0968246459960938
[rfa agg] iter:  1, weight: tensor([0.0642, 0.0457, 0.1781, 0.0222, 0.0854, 0.2086, 0.0276, 0.1678, 0.0764,
        0.1240])
[rfa agg] iter:  2, prev_obj_val: 71.9841079711914, obj_val: 73.90058898925781, abs dis: 1.9164810180664062
[rfa agg] iter:  2, weight: tensor([0.0814, 0.0435, 0.2189, 0.0252, 0.0739, 0.1561, 0.0317, 0.1358, 0.0674,
        0.1660])
[rfa agg] iter:  3, prev_obj_val: 73.90058898925781, obj_val: 76.13125610351562, abs dis: 2.2306671142578125
[rfa agg] iter:  3, weight: tensor([0.0935, 0.0423, 0.2251, 0.0269, 0.0691, 0.1321, 0.0343, 0.1188, 0.0634,
        0.1945])
[rfa agg] iter:  4, prev_obj_val: 76.13125610351562, obj_val: 78.62297058105469, abs dis: 2.4917144775390625
[rfa agg] iter:  4, weight: tensor([0.1112, 0.0423, 0.2071, 0.0297, 0.0666, 0.1183, 0.0381, 0.1084, 0.0615,
        0.2167])
[rfa agg] iter:  5, prev_obj_val: 78.62297058105469, obj_val: 78.61846160888672, abs dis: 0.00450897216796875
[rfa agg] iter:  5, weight: tensor([0.1364, 0.0431, 0.1831, 0.0334, 0.0656, 0.1096, 0.0434, 0.1019, 0.0609,
        0.2224])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 21.7646, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 25.3179, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.8464095592499 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0676, Accuracy: 143/735 (19.4558%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0239, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.8904, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 326/803 (40.5978%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4172, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0603, Accuracy: 294/1662 (17.6895%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 573/1662 (34.4765%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.6034, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 216/1049 (20.5910%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 516/1049 (49.1897%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.4937, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.1007, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0561, Accuracy: 108/312 (34.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.8274, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0667, Accuracy: 237/1340 (17.6866%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0283, Accuracy: 583/1340 (43.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.1646, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0636, Accuracy: 229/690 (33.1884%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0304, Accuracy: 451/690 (65.3623%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.6317, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0593, Accuracy: 383/1904 (20.1155%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 668/1904 (35.0840%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1968, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0635, Accuracy: 322/1657 (19.4327%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0368, Accuracy: 471/1657 (28.4249%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7053, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0571, Accuracy: 360/1953 (18.4332%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 736/1953 (37.6856%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.5758, Accuracy: 105/10000 (1.0500%)
time spent on training: 173.17175889015198
[rfa agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 58, 94, 51, 24, 77, 25, 46, 0, 83], weight: tensor([0.0607, 0.0663, 0.1373, 0.0867, 0.0258, 0.1107, 0.0570, 0.1573, 0.1369,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 65.67434692382812, obj_val: 66.77710723876953, abs dis: 1.1027603149414062
[rfa agg] iter:  0, weight: tensor([0.0369, 0.0453, 0.1417, 0.1068, 0.0088, 0.3105, 0.0313, 0.0942, 0.1370,
        0.0876])
[rfa agg] iter:  1, prev_obj_val: 66.77710723876953, obj_val: 69.90354919433594, abs dis: 3.1264419555664062
[rfa agg] iter:  1, weight: tensor([0.0370, 0.0458, 0.1239, 0.1121, 0.0086, 0.3567, 0.0312, 0.0849, 0.1205,
        0.0793])
[rfa agg] iter:  2, prev_obj_val: 69.90354919433594, obj_val: 69.88326263427734, abs dis: 0.02028656005859375
[rfa agg] iter:  2, weight: tensor([0.0453, 0.0570, 0.1159, 0.1518, 0.0100, 0.3055, 0.0377, 0.0841, 0.1134,
        0.0792])
[rfa agg] iter:  3, prev_obj_val: 69.88326263427734, obj_val: 69.88275909423828, abs dis: 0.0005035400390625
[rfa agg] iter:  3, weight: tensor([0.0458, 0.0575, 0.1169, 0.1568, 0.0101, 0.2959, 0.0381, 0.0848, 0.1143,
        0.0798])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 13.3939, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 14.6921, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.6652159690857 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0617, Accuracy: 289/1340 (21.5672%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 551/1340 (41.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9078, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 86/781 (11.0115%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9491, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0671, Accuracy: 207/1131 (18.3024%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 505/1131 (44.6508%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6983, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0703, Accuracy: 209/719 (29.0682%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0336, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.8564, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0555, Accuracy: 326/803 (40.5978%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 441/803 (54.9191%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3025, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0635, Accuracy: 228/1241 (18.3723%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0375, Accuracy: 386/1241 (31.1039%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5197, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0865, Accuracy: 34/515 (6.6019%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3479, Accuracy: 66/10000 (0.6600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 398/1574 (25.2859%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 634/1574 (40.2795%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.8933, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0619, Accuracy: 236/1131 (20.8665%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0328, Accuracy: 409/1131 (36.1627%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4783, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0620, Accuracy: 231/1372 (16.8367%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 488/1372 (35.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4178, Accuracy: 80/10000 (0.8000%)
time spent on training: 175.8712821006775
[rfa agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.04637267841991138
[rfa agg] init. name: [77, 3, 38, 41, 58, 72, 33, 17, 87, 42], weight: tensor([0.1263, 0.0736, 0.1066, 0.0678, 0.0757, 0.1170, 0.0486, 0.1484, 0.1066,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 49.81399154663086, obj_val: 51.82911682128906, abs dis: 2.015125274658203
[rfa agg] iter:  0, weight: tensor([0.0909, 0.1307, 0.1323, 0.0869, 0.1378, 0.0991, 0.0345, 0.0658, 0.1417,
        0.0805])
[rfa agg] iter:  1, prev_obj_val: 51.82911682128906, obj_val: 49.7427978515625, abs dis: 2.0863189697265625
[rfa agg] iter:  1, weight: tensor([0.0823, 0.1541, 0.1173, 0.0971, 0.1657, 0.0890, 0.0364, 0.0612, 0.1234,
        0.0735])
[rfa agg] iter:  2, prev_obj_val: 49.7427978515625, obj_val: 51.82746887207031, abs dis: 2.0846710205078125
[rfa agg] iter:  2, weight: tensor([0.0893, 0.1338, 0.1318, 0.0868, 0.1421, 0.0975, 0.0341, 0.0648, 0.1405,
        0.0791])
[rfa agg] iter:  3, prev_obj_val: 51.82746887207031, obj_val: 49.74290466308594, abs dis: 2.084564208984375
[rfa agg] iter:  3, weight: tensor([0.0822, 0.1544, 0.1172, 0.0970, 0.1661, 0.0889, 0.0364, 0.0612, 0.1232,
        0.0734])
[rfa agg] iter:  4, prev_obj_val: 49.74290466308594, obj_val: 51.82746124267578, abs dis: 2.0845565795898438
[rfa agg] iter:  4, weight: tensor([0.0893, 0.1338, 0.1318, 0.0868, 0.1422, 0.0975, 0.0341, 0.0648, 0.1405,
        0.0791])
[rfa agg] iter:  5, prev_obj_val: 51.82746124267578, obj_val: 49.74290466308594, abs dis: 2.0845565795898438
[rfa agg] iter:  5, weight: tensor([0.0822, 0.1544, 0.1172, 0.0970, 0.1661, 0.0889, 0.0364, 0.0612, 0.1232,
        0.0734])
[rfa agg] iter:  6, prev_obj_val: 49.74290466308594, obj_val: 51.82746124267578, abs dis: 2.0845565795898438
[rfa agg] iter:  6, weight: tensor([0.0893, 0.1338, 0.1318, 0.0868, 0.1422, 0.0975, 0.0341, 0.0648, 0.1405,
        0.0791])
[rfa agg] iter:  7, prev_obj_val: 51.82746124267578, obj_val: 49.74290466308594, abs dis: 2.0845565795898438
[rfa agg] iter:  7, weight: tensor([0.0822, 0.1544, 0.1172, 0.0970, 0.1661, 0.0889, 0.0364, 0.0612, 0.1232,
        0.0734])
[rfa agg] iter:  8, prev_obj_val: 49.74290466308594, obj_val: 51.82746124267578, abs dis: 2.0845565795898438
[rfa agg] iter:  8, weight: tensor([0.0893, 0.1338, 0.1318, 0.0868, 0.1422, 0.0975, 0.0341, 0.0648, 0.1405,
        0.0791])
[rfa agg] iter:  9, prev_obj_val: 51.82746124267578, obj_val: 49.74290466308594, abs dis: 2.0845565795898438
[rfa agg] iter:  9, weight: tensor([0.0822, 0.1544, 0.1172, 0.0970, 0.1661, 0.0889, 0.0364, 0.0612, 0.1232,
        0.0734])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 15.4519, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 19.0129, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.72144317626953 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0490, Accuracy: 334/891 (37.4860%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.9773, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0661, Accuracy: 226/708 (31.9209%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2103, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0614, Accuracy: 289/1446 (19.9862%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8568, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 317/803 (39.4770%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0355, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3255, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0639, Accuracy: 271/946 (28.6469%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 374/946 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6323, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0845, Accuracy: 38/460 (8.2609%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0394, Accuracy: 191/460 (41.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.6147, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0596, Accuracy: 264/1030 (25.6311%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0287, Accuracy: 630/1030 (61.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.3965, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0636, Accuracy: 335/1475 (22.7119%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 625/1475 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2822, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0630, Accuracy: 294/1418 (20.7334%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0324, Accuracy: 604/1418 (42.5952%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.5222, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0699, Accuracy: 121/818 (14.7922%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.8673, Accuracy: 62/10000 (0.6200%)
time spent on training: 162.71268272399902
[rfa agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 16, 26, 58, 43, 31, 91, 65, 70, 71], weight: tensor([0.0891, 0.0708, 0.1447, 0.0803, 0.0946, 0.0460, 0.1031, 0.1476, 0.1419,
        0.0818])
[rfa agg] iter:  0, prev_obj_val: 47.794883728027344, obj_val: 52.79489517211914, abs dis: 5.000011444091797
[rfa agg] iter:  0, weight: tensor([0.1499, 0.0692, 0.0728, 0.1046, 0.1963, 0.0230, 0.1437, 0.0651, 0.0709,
        0.1046])
[rfa agg] iter:  1, prev_obj_val: 52.79489517211914, obj_val: 54.929256439208984, abs dis: 2.1343612670898438
[rfa agg] iter:  1, weight: tensor([0.1775, 0.0999, 0.0500, 0.1646, 0.1448, 0.0264, 0.0830, 0.0459, 0.0489,
        0.1591])
[rfa agg] iter:  2, prev_obj_val: 54.929256439208984, obj_val: 57.59194564819336, abs dis: 2.662689208984375
[rfa agg] iter:  2, weight: tensor([0.1599, 0.1156, 0.0468, 0.1882, 0.1200, 0.0284, 0.0726, 0.0431, 0.0457,
        0.1798])
[rfa agg] iter:  3, prev_obj_val: 57.59194564819336, obj_val: 57.58677291870117, abs dis: 0.0051727294921875
[rfa agg] iter:  3, weight: tensor([0.1415, 0.1367, 0.0467, 0.1919, 0.1081, 0.0326, 0.0695, 0.0432, 0.0457,
        0.1842])
[rfa agg] iter:  4, prev_obj_val: 57.58677291870117, obj_val: 54.91932678222656, abs dis: 2.6674461364746094
[rfa agg] iter:  4, weight: tensor([0.1390, 0.1394, 0.0465, 0.1927, 0.1073, 0.0325, 0.0691, 0.0431, 0.0454,
        0.1850])
[rfa agg] iter:  5, prev_obj_val: 54.91932678222656, obj_val: 54.91561508178711, abs dis: 0.003711700439453125
[rfa agg] iter:  5, weight: tensor([0.1519, 0.1186, 0.0461, 0.1946, 0.1165, 0.0281, 0.0713, 0.0425, 0.0450,
        0.1855])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 16.5209, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 18.6940, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.4261636734009 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0603, Accuracy: 259/1030 (25.1456%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 614/1030 (59.6117%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.4001, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0530, Accuracy: 348/1275 (27.2941%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 681/1275 (53.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 12.0961, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0996, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0544, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3030, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0735, Accuracy: 200/774 (25.8398%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0415, Accuracy: 320/774 (41.3437%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2710, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0606, Accuracy: 265/1130 (23.4513%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 496/1130 (43.8938%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.0146, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0676, Accuracy: 212/928 (22.8448%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.3983, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0532, Accuracy: 224/888 (25.2252%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 441/888 (49.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.2685, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 351/1953 (17.9724%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 759/1953 (38.8633%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4993, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0661, Accuracy: 262/946 (27.6956%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0372, Accuracy: 370/946 (39.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9064, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0708, Accuracy: 131/953 (13.7461%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0394, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6003, Accuracy: 71/10000 (0.7100%)
time spent on training: 165.79668045043945
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 9, 78, 81, 54, 1, 63, 83, 43, 64], weight: tensor([0.1001, 0.1239, 0.0404, 0.0752, 0.1098, 0.0902, 0.0863, 0.1897, 0.0919,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 50.911861419677734, obj_val: 57.09513473510742, abs dis: 6.1832733154296875
[rfa agg] iter:  0, weight: tensor([0.1029, 0.0724, 0.0152, 0.0866, 0.0960, 0.1245, 0.1325, 0.0371, 0.1566,
        0.1763])
[rfa agg] iter:  1, prev_obj_val: 57.09513473510742, obj_val: 60.05198669433594, abs dis: 2.9568519592285156
[rfa agg] iter:  1, weight: tensor([0.0830, 0.0628, 0.0202, 0.1410, 0.0774, 0.1181, 0.1720, 0.0371, 0.1392,
        0.1493])
[rfa agg] iter:  2, prev_obj_val: 60.05198669433594, obj_val: 60.04745864868164, abs dis: 0.004528045654296875
[rfa agg] iter:  2, weight: tensor([0.0806, 0.0632, 0.0234, 0.1678, 0.0761, 0.1134, 0.1720, 0.0389, 0.1294,
        0.1352])
[rfa agg] iter:  3, prev_obj_val: 60.04745864868164, obj_val: 60.04733657836914, abs dis: 0.0001220703125
[rfa agg] iter:  3, weight: tensor([0.0802, 0.0629, 0.0233, 0.1725, 0.0758, 0.1127, 0.1713, 0.0388, 0.1285,
        0.1340])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 20.2115, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 22.4373, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 258.495810508728 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0683, Accuracy: 239/1190 (20.0840%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 420/1190 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0447, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0966, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0538, Accuracy: 113/312 (36.2179%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.6761, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 311/896 (34.7098%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0360, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0534, Accuracy: 344/1129 (30.4694%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 700/1129 (62.0018%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.5463, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0501, Accuracy: 402/1552 (25.9021%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 718/1552 (46.2629%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.0083, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0657, Accuracy: 313/1750 (17.8857%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0376, Accuracy: 631/1750 (36.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8725, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0617, Accuracy: 269/807 (33.3333%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0361, Accuracy: 427/807 (52.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2134, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0772, Accuracy: 84/809 (10.3832%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0288, Accuracy: 305/809 (37.7009%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.5858, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0608, Accuracy: 271/1154 (23.4835%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 408/1154 (35.3553%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.2498, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0738, Accuracy: 60/781 (7.6825%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 252/781 (32.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.7596, Accuracy: 80/10000 (0.8000%)
time spent on training: 167.6683235168457
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 24, 89, 37, 74, 44, 20, 50, 15, 3], weight: tensor([0.1146, 0.0301, 0.0863, 0.1088, 0.1495, 0.1686, 0.0777, 0.0779, 0.1112,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 52.28364944458008, obj_val: 56.92241287231445, abs dis: 4.638763427734375
[rfa agg] iter:  0, weight: tensor([0.1615, 0.0105, 0.1066, 0.2094, 0.0787, 0.0654, 0.0767, 0.0790, 0.1368,
        0.0753])
[rfa agg] iter:  1, prev_obj_val: 56.92241287231445, obj_val: 56.77815628051758, abs dis: 0.144256591796875
[rfa agg] iter:  1, weight: tensor([0.1062, 0.0120, 0.1732, 0.1324, 0.0617, 0.0538, 0.1188, 0.1271, 0.0961,
        0.1187])
[rfa agg] iter:  2, prev_obj_val: 56.77815628051758, obj_val: 58.387611389160156, abs dis: 1.6094551086425781
[rfa agg] iter:  2, weight: tensor([0.1017, 0.0118, 0.1862, 0.1255, 0.0601, 0.0524, 0.1201, 0.1289, 0.0925,
        0.1208])
[rfa agg] iter:  3, prev_obj_val: 58.387611389160156, obj_val: 62.4699821472168, abs dis: 4.082370758056641
[rfa agg] iter:  3, weight: tensor([0.0881, 0.0117, 0.2013, 0.1061, 0.0544, 0.0479, 0.1312, 0.1443, 0.0810,
        0.1340])
[rfa agg] iter:  4, prev_obj_val: 62.4699821472168, obj_val: 65.0643081665039, abs dis: 2.5943260192871094
[rfa agg] iter:  4, weight: tensor([0.0686, 0.0118, 0.1899, 0.0794, 0.0458, 0.0411, 0.1538, 0.1817, 0.0640,
        0.1639])
[rfa agg] iter:  5, prev_obj_val: 65.0643081665039, obj_val: 62.44504928588867, abs dis: 2.6192588806152344
[rfa agg] iter:  5, weight: tensor([0.0632, 0.0124, 0.1670, 0.0719, 0.0437, 0.0396, 0.1639, 0.2007, 0.0592,
        0.1784])
[rfa agg] iter:  6, prev_obj_val: 62.44504928588867, obj_val: 62.4426155090332, abs dis: 0.00243377685546875
[rfa agg] iter:  6, weight: tensor([0.0668, 0.0116, 0.1817, 0.0771, 0.0448, 0.0402, 0.1564, 0.1899, 0.0622,
        0.1692])
[rfa agg] iter:  7, prev_obj_val: 62.4426155090332, obj_val: 62.44254684448242, abs dis: 6.866455078125e-05
[rfa agg] iter:  7, weight: tensor([0.0670, 0.0116, 0.1848, 0.0774, 0.0449, 0.0403, 0.1555, 0.1880, 0.0624,
        0.1680])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 16.8052, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 18.7926, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 260.61777782440186 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0635, Accuracy: 252/1372 (18.3673%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0340, Accuracy: 476/1372 (34.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4473, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0647, Accuracy: 223/1402 (15.9058%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0405, Accuracy: 360/1402 (25.6776%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9951, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0297, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.1465, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 48/460 (10.4348%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0404, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.7141, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0646, Accuracy: 323/1750 (18.4571%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0376, Accuracy: 622/1750 (35.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7818, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0626, Accuracy: 370/1742 (21.2400%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0325, Accuracy: 666/1742 (38.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.6867, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 184/1013 (18.1639%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0365, Accuracy: 356/1013 (35.1431%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8736, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 359/1129 (31.7981%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 710/1129 (62.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.1774, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0834, Accuracy: 32/515 (6.2136%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0584, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.2578, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0535, Accuracy: 368/1440 (25.5556%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0295, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3176, Accuracy: 79/10000 (0.7900%)
time spent on training: 181.37362360954285
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 66, 59, 31, 44, 93, 14, 37, 33, 29], weight: tensor([0.1152, 0.1177, 0.0914, 0.0386, 0.1469, 0.1462, 0.0850, 0.0948, 0.0432,
        0.1209])
[rfa agg] iter:  0, prev_obj_val: 51.414695739746094, obj_val: 52.774776458740234, abs dis: 1.3600807189941406
[rfa agg] iter:  0, weight: tensor([0.1623, 0.1556, 0.1101, 0.0151, 0.0755, 0.0763, 0.0977, 0.1571, 0.0184,
        0.1319])
[rfa agg] iter:  1, prev_obj_val: 52.774776458740234, obj_val: 54.45970153808594, abs dis: 1.6849250793457031
[rfa agg] iter:  1, weight: tensor([0.1470, 0.1432, 0.1177, 0.0158, 0.0712, 0.0722, 0.1107, 0.1826, 0.0193,
        0.1204])
[rfa agg] iter:  2, prev_obj_val: 54.45970153808594, obj_val: 56.36158752441406, abs dis: 1.901885986328125
[rfa agg] iter:  2, weight: tensor([0.1316, 0.1295, 0.1233, 0.0166, 0.0683, 0.0691, 0.1269, 0.2039, 0.0204,
        0.1105])
[rfa agg] iter:  3, prev_obj_val: 56.36158752441406, obj_val: 58.49714660644531, abs dis: 2.13555908203125
[rfa agg] iter:  3, weight: tensor([0.1189, 0.1178, 0.1262, 0.0175, 0.0655, 0.0662, 0.1469, 0.2174, 0.0216,
        0.1019])
[rfa agg] iter:  4, prev_obj_val: 58.49714660644531, obj_val: 60.864742279052734, abs dis: 2.367595672607422
[rfa agg] iter:  4, weight: tensor([0.1092, 0.1088, 0.1268, 0.0186, 0.0634, 0.0640, 0.1729, 0.2181, 0.0230,
        0.0952])
[rfa agg] iter:  5, prev_obj_val: 60.864742279052734, obj_val: 58.49697494506836, abs dis: 2.367767333984375
[rfa agg] iter:  5, weight: tensor([0.1019, 0.1019, 0.1253, 0.0200, 0.0620, 0.0625, 0.2057, 0.2059, 0.0248,
        0.0901])
[rfa agg] iter:  6, prev_obj_val: 58.49697494506836, obj_val: 60.863285064697266, abs dis: 2.3663101196289062
[rfa agg] iter:  6, weight: tensor([0.1084, 0.1079, 0.1258, 0.0185, 0.0632, 0.0637, 0.1789, 0.2160, 0.0229,
        0.0947])
[rfa agg] iter:  7, prev_obj_val: 60.863285064697266, obj_val: 58.49720001220703, abs dis: 2.3660850524902344
[rfa agg] iter:  7, weight: tensor([0.1018, 0.1018, 0.1250, 0.0200, 0.0619, 0.0624, 0.2067, 0.2054, 0.0248,
        0.0901])
[rfa agg] iter:  8, prev_obj_val: 58.49720001220703, obj_val: 60.863258361816406, abs dis: 2.366058349609375
[rfa agg] iter:  8, weight: tensor([0.1084, 0.1079, 0.1257, 0.0185, 0.0632, 0.0637, 0.1790, 0.2160, 0.0229,
        0.0947])
[rfa agg] iter:  9, prev_obj_val: 60.863258361816406, obj_val: 58.49720764160156, abs dis: 2.3660507202148438
[rfa agg] iter:  9, weight: tensor([0.1018, 0.1018, 0.1250, 0.0200, 0.0619, 0.0624, 0.2067, 0.2054, 0.0248,
        0.0901])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 44.2274, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 51.8587, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 275.44953966140747 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0588, Accuracy: 324/896 (36.1607%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0351, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0615, Accuracy: 259/1340 (19.3284%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0283, Accuracy: 562/1340 (41.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.8610, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0538, Accuracy: 412/1440 (28.6111%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0297, Accuracy: 686/1440 (47.6389%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0300, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 224/776 (28.8660%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.7383, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0600, Accuracy: 301/1662 (18.1107%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9441, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0701, Accuracy: 62/781 (7.9385%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.6970, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0652, Accuracy: 210/677 (31.0192%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 13.0879, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0663, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/1013 (44.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.2694, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0839, Accuracy: 34/486 (6.9959%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.9957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0617, Accuracy: 278/807 (34.4486%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0355, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0541, Accuracy: 74/10000 (0.7400%)
time spent on training: 166.97526264190674
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 77, 29, 75, 94, 3, 90, 39, 30, 20], weight: tensor([0.0907, 0.1357, 0.1458, 0.0786, 0.1683, 0.0791, 0.0685, 0.1026, 0.0492,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 50.018394470214844, obj_val: 53.659454345703125, abs dis: 3.6410598754882812
[rfa agg] iter:  0, weight: tensor([0.1599, 0.0905, 0.0743, 0.1021, 0.0624, 0.1054, 0.0565, 0.2205, 0.0251,
        0.1034])
[rfa agg] iter:  1, prev_obj_val: 53.659454345703125, obj_val: 57.78423309326172, abs dis: 4.124778747558594
[rfa agg] iter:  1, weight: tensor([0.1827, 0.0564, 0.0488, 0.1474, 0.0433, 0.1606, 0.0747, 0.1146, 0.0274,
        0.1441])
[rfa agg] iter:  2, prev_obj_val: 57.78423309326172, obj_val: 55.41900634765625, abs dis: 2.3652267456054688
[rfa agg] iter:  2, weight: tensor([0.1449, 0.0512, 0.0452, 0.1607, 0.0410, 0.1753, 0.1043, 0.0877, 0.0334,
        0.1563])
[rfa agg] iter:  3, prev_obj_val: 55.41900634765625, obj_val: 57.77050018310547, abs dis: 2.3514938354492188
[rfa agg] iter:  3, weight: tensor([0.1574, 0.0511, 0.0448, 0.1627, 0.0402, 0.1791, 0.0858, 0.0929, 0.0290,
        0.1569])
[rfa agg] iter:  4, prev_obj_val: 57.77050018310547, obj_val: 57.767635345458984, abs dis: 0.002864837646484375
[rfa agg] iter:  4, weight: tensor([0.1419, 0.0508, 0.0449, 0.1624, 0.0407, 0.1774, 0.1044, 0.0867, 0.0332,
        0.1575])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 14.9011, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 18.5825, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.3405911922455 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0928, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0542, Accuracy: 125/373 (33.5121%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.0319, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0586, Accuracy: 247/1049 (23.5462%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 522/1049 (49.7617%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1675, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0635, Accuracy: 346/1742 (19.8622%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0330, Accuracy: 662/1742 (38.0023%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.0476, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0682, Accuracy: 84/781 (10.7554%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.7620, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 178/1013 (17.5716%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 354/1013 (34.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1548, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 39/460 (8.4783%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0389, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.9497, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0503, Accuracy: 245/888 (27.5901%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 449/888 (50.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.4378, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0642, Accuracy: 206/1154 (17.8510%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 478/1154 (41.4211%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.3568, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0911, Accuracy: 6/271 (2.2140%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0623, Accuracy: 93/271 (34.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.7452, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0880, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0706, Accuracy: 24/186 (12.9032%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.4154, Accuracy: 53/10000 (0.5300%)
time spent on training: 153.6248815059662
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 51, 93, 3, 14, 31, 63, 57, 35, 56], weight: tensor([0.0471, 0.1325, 0.2200, 0.0986, 0.1280, 0.0581, 0.1122, 0.1458, 0.0342,
        0.0235])
[rfa agg] iter:  0, prev_obj_val: 56.96979522705078, obj_val: 60.676300048828125, abs dis: 3.7065048217773438
[rfa agg] iter:  0, weight: tensor([0.0198, 0.1631, 0.0659, 0.1431, 0.2253, 0.0315, 0.2122, 0.1190, 0.0129,
        0.0072])
[rfa agg] iter:  1, prev_obj_val: 60.676300048828125, obj_val: 60.59977722167969, abs dis: 0.0765228271484375
[rfa agg] iter:  1, weight: tensor([0.0231, 0.1238, 0.0588, 0.2091, 0.1670, 0.0388, 0.2630, 0.0936, 0.0147,
        0.0079])
[rfa agg] iter:  2, prev_obj_val: 60.59977722167969, obj_val: 60.597965240478516, abs dis: 0.001811981201171875
[rfa agg] iter:  2, weight: tensor([0.0225, 0.1188, 0.0571, 0.2196, 0.1578, 0.0378, 0.2739, 0.0903, 0.0143,
        0.0077])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 18.8107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 22.5015, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.38603472709656 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0666, Accuracy: 304/1581 (19.2283%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 512/1581 (32.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6280, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0869, Accuracy: 41/682 (6.0117%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 265/682 (38.8563%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.1114, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0608, Accuracy: 284/1446 (19.6404%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0356, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1271, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0666, Accuracy: 212/928 (22.8448%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.8596, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0622, Accuracy: 360/1742 (20.6659%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0336, Accuracy: 634/1742 (36.3949%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.7060, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0659, Accuracy: 186/1071 (17.3669%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0308, Accuracy: 475/1071 (44.3511%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.3147, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0587, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 587/1645 (35.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6351, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0923, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0535, Accuracy: 127/373 (34.0483%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.8710, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1471, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1368, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.2355, Accuracy: 37/10000 (0.3700%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0679, Accuracy: 198/776 (25.5155%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 385/776 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.3987, Accuracy: 69/10000 (0.6900%)
time spent on training: 172.80193877220154
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 80, 26, 1, 93, 55, 13, 98, 61, 75], weight: tensor([0.1531, 0.0660, 0.1400, 0.0898, 0.1687, 0.1037, 0.1593, 0.0361, 0.0082,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 62.14387130737305, obj_val: 63.27806854248047, abs dis: 1.1341972351074219
[rfa agg] iter:  0, weight: tensor([0.1297, 0.0506, 0.1645, 0.1242, 0.1020, 0.2155, 0.1199, 0.0167, 0.0028,
        0.0743])
[rfa agg] iter:  1, prev_obj_val: 63.27806854248047, obj_val: 63.26264953613281, abs dis: 0.01541900634765625
[rfa agg] iter:  1, weight: tensor([0.1164, 0.0519, 0.1460, 0.1344, 0.0931, 0.2531, 0.1083, 0.0167, 0.0027,
        0.0774])
[rfa agg] iter:  2, prev_obj_val: 63.26264953613281, obj_val: 64.63811492919922, abs dis: 1.3754653930664062
[rfa agg] iter:  2, weight: tensor([0.1148, 0.0513, 0.1437, 0.1336, 0.0920, 0.2618, 0.1070, 0.0165, 0.0027,
        0.0766])
[rfa agg] iter:  3, prev_obj_val: 64.63811492919922, obj_val: 64.63160705566406, abs dis: 0.00650787353515625
[rfa agg] iter:  3, weight: tensor([0.1056, 0.0537, 0.1296, 0.1451, 0.0859, 0.2805, 0.0989, 0.0168, 0.0027,
        0.0814])
[rfa agg] iter:  4, prev_obj_val: 64.63160705566406, obj_val: 64.63134765625, abs dis: 0.0002593994140625
[rfa agg] iter:  4, weight: tensor([0.1045, 0.0532, 0.1281, 0.1448, 0.0851, 0.2862, 0.0980, 0.0166, 0.0027,
        0.0808])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7994, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.6094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.1969418525696 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0959, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0648, Accuracy: 84/311 (27.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.3745, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0511, Accuracy: 248/813 (30.5043%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0208, Accuracy: 430/813 (52.8905%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 12.8350, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0626, Accuracy: 251/1154 (21.7504%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0324, Accuracy: 436/1154 (37.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.2900, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0468, Accuracy: 435/1552 (28.0284%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 681/1552 (43.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 12.0938, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0610, Accuracy: 245/599 (40.9015%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0317, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 14.4101, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0584, Accuracy: 323/896 (36.0491%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0321, Accuracy: 473/896 (52.7902%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9794, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0652, Accuracy: 235/1131 (20.7781%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0313, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.9781, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0807, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0495, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2464, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0582, Accuracy: 241/712 (33.8483%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0281, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.8512, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 240/708 (33.8983%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 420/708 (59.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.6574, Accuracy: 66/10000 (0.6600%)
time spent on training: 157.88678908348083
[rfa agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 53, 15, 74, 95, 89, 38, 49, 11, 16], weight: tensor([0.0374, 0.0978, 0.1388, 0.1866, 0.0720, 0.1077, 0.1360, 0.0529, 0.0856,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 49.31791687011719, obj_val: 53.76702880859375, abs dis: 4.4491119384765625
[rfa agg] iter:  0, weight: tensor([0.0149, 0.1869, 0.0908, 0.0631, 0.0612, 0.2287, 0.1092, 0.0274, 0.1101,
        0.1078])
[rfa agg] iter:  1, prev_obj_val: 53.76702880859375, obj_val: 58.236534118652344, abs dis: 4.469505310058594
[rfa agg] iter:  1, weight: tensor([0.0178, 0.2021, 0.0662, 0.0515, 0.0954, 0.1576, 0.0762, 0.0355, 0.1501,
        0.1475])
[rfa agg] iter:  2, prev_obj_val: 58.236534118652344, obj_val: 60.90304946899414, abs dis: 2.666515350341797
[rfa agg] iter:  2, weight: tensor([0.0224, 0.1613, 0.0648, 0.0529, 0.1389, 0.1274, 0.0732, 0.0474, 0.1578,
        0.1539])
[rfa agg] iter:  3, prev_obj_val: 60.90304946899414, obj_val: 60.896766662597656, abs dis: 0.006282806396484375
[rfa agg] iter:  3, weight: tensor([0.0254, 0.1438, 0.0650, 0.0540, 0.1680, 0.1184, 0.0729, 0.0560, 0.1499,
        0.1467])
[rfa agg] iter:  4, prev_obj_val: 60.896766662597656, obj_val: 60.89661407470703, abs dis: 0.000152587890625
[rfa agg] iter:  4, weight: tensor([0.0254, 0.1427, 0.0648, 0.0539, 0.1730, 0.1178, 0.0726, 0.0560, 0.1484,
        0.1454])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7907, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5836, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.19376254081726 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0653, Accuracy: 321/1475 (21.7627%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0344, Accuracy: 639/1475 (43.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2656, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0879, Accuracy: 51/466 (10.9442%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0578, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1548, Accuracy: 58/10000 (0.5800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 342/1574 (21.7281%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0289, Accuracy: 629/1574 (39.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.3229, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0691, Accuracy: 141/818 (17.2372%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0332, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.4941, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0789, Accuracy: 49/460 (10.6522%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 192/460 (41.7391%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8930, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 446/1552 (28.7371%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 740/1552 (47.6804%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.9610, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0609, Accuracy: 224/690 (32.4638%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.2982, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0802, Accuracy: 37/500 (7.4000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0520, Accuracy: 195/500 (39.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.0167, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0622, Accuracy: 252/1130 (22.3009%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0312, Accuracy: 473/1130 (41.8584%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.9987, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0978, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0520, Accuracy: 117/338 (34.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.3104, Accuracy: 50/10000 (0.5000%)
time spent on training: 175.29117465019226
[rfa agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[rfa agg] considering poison per batch poison_fraction: 0.054634566255692546
[rfa agg] init. name: [65, 76, 17, 71, 31, 74, 25, 82, 54, 12], weight: tensor([0.1638, 0.0518, 0.1748, 0.0909, 0.0511, 0.1724, 0.0766, 0.0555, 0.1255,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 68.59070587158203, obj_val: 69.68751525878906, abs dis: 1.0968093872070312
[rfa agg] iter:  0, weight: tensor([0.1069, 0.0436, 0.1049, 0.2074, 0.0429, 0.1021, 0.1075, 0.0466, 0.2136,
        0.0244])
[rfa agg] iter:  1, prev_obj_val: 69.68751525878906, obj_val: 73.97615814208984, abs dis: 4.288642883300781
[rfa agg] iter:  1, weight: tensor([0.0969, 0.0448, 0.0956, 0.2485, 0.0441, 0.0929, 0.1167, 0.0479, 0.1879,
        0.0247])
[rfa agg] iter:  2, prev_obj_val: 73.97615814208984, obj_val: 77.60197448730469, abs dis: 3.6258163452148438
[rfa agg] iter:  2, weight: tensor([0.0744, 0.0499, 0.0739, 0.3252, 0.0490, 0.0721, 0.1549, 0.0532, 0.1217,
        0.0258])
[rfa agg] iter:  3, prev_obj_val: 77.60197448730469, obj_val: 79.66783905029297, abs dis: 2.0658645629882812
[rfa agg] iter:  3, weight: tensor([0.0663, 0.0587, 0.0662, 0.2828, 0.0574, 0.0646, 0.2140, 0.0623, 0.0993,
        0.0286])
[rfa agg] iter:  4, prev_obj_val: 79.66783905029297, obj_val: 75.69279479980469, abs dis: 3.9750442504882812
[rfa agg] iter:  4, weight: tensor([0.0635, 0.0656, 0.0635, 0.2263, 0.0639, 0.0620, 0.2633, 0.0693, 0.0918,
        0.0308])
[rfa agg] iter:  5, prev_obj_val: 75.69279479980469, obj_val: 79.6830825805664, abs dis: 3.9902877807617188
[rfa agg] iter:  5, weight: tensor([0.0690, 0.0538, 0.0688, 0.3012, 0.0526, 0.0671, 0.1961, 0.0572, 0.1071,
        0.0270])
[rfa agg] iter:  6, prev_obj_val: 79.6830825805664, obj_val: 75.68973541259766, abs dis: 3.99334716796875
[rfa agg] iter:  6, weight: tensor([0.0638, 0.0657, 0.0638, 0.2299, 0.0640, 0.0624, 0.2577, 0.0695, 0.0923,
        0.0309])
[rfa agg] iter:  7, prev_obj_val: 75.68973541259766, obj_val: 79.68367004394531, abs dis: 3.9939346313476562
[rfa agg] iter:  7, weight: tensor([0.0690, 0.0538, 0.0688, 0.3022, 0.0526, 0.0671, 0.1953, 0.0571, 0.1071,
        0.0270])
[rfa agg] iter:  8, prev_obj_val: 79.68367004394531, obj_val: 75.68962097167969, abs dis: 3.994049072265625
[rfa agg] iter:  8, weight: tensor([0.0638, 0.0657, 0.0639, 0.2301, 0.0640, 0.0624, 0.2575, 0.0695, 0.0923,
        0.0309])
[rfa agg] iter:  9, prev_obj_val: 75.68962097167969, obj_val: 79.68368530273438, abs dis: 3.9940643310546875
[rfa agg] iter:  9, weight: tensor([0.0690, 0.0538, 0.0688, 0.3023, 0.0526, 0.0671, 0.1953, 0.0571, 0.1071,
        0.0270])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 15.7796, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 20.4407, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.2674162387848 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0636, Accuracy: 252/719 (35.0487%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.7364, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0443, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0794, Accuracy: 54/500 (10.8000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0515, Accuracy: 198/500 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1953, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0682, Accuracy: 93/781 (11.9078%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 274/781 (35.0832%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.3361, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0606, Accuracy: 199/861 (23.1127%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 429/861 (49.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.6320, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0622, Accuracy: 294/1036 (28.3784%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 633/1036 (61.1004%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 13.0678, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0695, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 386/1241 (31.1039%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.5375, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0567, Accuracy: 522/2227 (23.4396%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 948/2227 (42.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8459, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0605, Accuracy: 241/599 (40.2337%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0350, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 14.1788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0662, Accuracy: 223/1131 (19.7171%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 462/1131 (40.8488%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.9558, Accuracy: 96/10000 (0.9600%)
time spent on training: 173.73736238479614
[rfa agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 89, 82, 3, 10, 19, 72, 60, 95, 38], weight: tensor([0.0720, 0.0897, 0.0500, 0.0782, 0.0862, 0.1037, 0.1242, 0.2229, 0.0600,
        0.1132])
[rfa agg] iter:  0, prev_obj_val: 65.62619018554688, obj_val: 70.80547332763672, abs dis: 5.179283142089844
[rfa agg] iter:  0, weight: tensor([0.0575, 0.1059, 0.0236, 0.0757, 0.1066, 0.2190, 0.1485, 0.0534, 0.0359,
        0.1738])
[rfa agg] iter:  1, prev_obj_val: 70.80547332763672, obj_val: 74.85533905029297, abs dis: 4.04986572265625
[rfa agg] iter:  1, weight: tensor([0.1060, 0.1646, 0.0330, 0.1524, 0.1859, 0.1033, 0.0711, 0.0398, 0.0578,
        0.0860])
[rfa agg] iter:  2, prev_obj_val: 74.85533905029297, obj_val: 77.47875213623047, abs dis: 2.6234130859375
[rfa agg] iter:  2, weight: tensor([0.1410, 0.1514, 0.0402, 0.1751, 0.1568, 0.0837, 0.0631, 0.0388, 0.0767,
        0.0732])
[rfa agg] iter:  3, prev_obj_val: 77.47875213623047, obj_val: 83.48876190185547, abs dis: 6.010009765625
[rfa agg] iter:  3, weight: tensor([0.1606, 0.1384, 0.0466, 0.1690, 0.1383, 0.0801, 0.0624, 0.0398, 0.0935,
        0.0713])
[rfa agg] iter:  4, prev_obj_val: 83.48876190185547, obj_val: 77.48760223388672, abs dis: 6.00115966796875
[rfa agg] iter:  4, weight: tensor([0.1628, 0.1196, 0.0654, 0.1410, 0.1172, 0.0767, 0.0629, 0.0430, 0.1411,
        0.0704])
[rfa agg] iter:  5, prev_obj_val: 77.48760223388672, obj_val: 80.36892700195312, abs dis: 2.8813247680664062
[rfa agg] iter:  5, weight: tensor([0.1674, 0.1363, 0.0471, 0.1638, 0.1353, 0.0799, 0.0623, 0.0398, 0.0970,
        0.0711])
[rfa agg] iter:  6, prev_obj_val: 80.36892700195312, obj_val: 80.36567687988281, abs dis: 0.0032501220703125
[rfa agg] iter:  6, weight: tensor([0.1701, 0.1275, 0.0550, 0.1535, 0.1257, 0.0779, 0.0624, 0.0413, 0.1161,
        0.0705])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.8453, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.4283, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.83581376075745 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0521, Accuracy: 347/1574 (22.0457%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 581/1574 (36.9123%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3740, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0704, Accuracy: 199/928 (21.4440%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0260, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.0312, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0908, Accuracy: 18/486 (3.7037%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0444, Accuracy: 221/486 (45.4733%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.9958, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0671, Accuracy: 235/1573 (14.9396%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0366, Accuracy: 527/1573 (33.5029%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5822, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 378/1953 (19.3548%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 756/1953 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6913, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0637, Accuracy: 247/1213 (20.3627%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 531/1213 (43.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.4380, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0733, Accuracy: 138/530 (26.0377%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0419, Accuracy: 279/530 (52.6415%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.3153, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0705, Accuracy: 315/1163 (27.0851%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 424/1163 (36.4574%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0641, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0612, Accuracy: 174/861 (20.2091%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.2078, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0623, Accuracy: 292/1949 (14.9820%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 574/1949 (29.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.0091, Accuracy: 84/10000 (0.8400%)
time spent on training: 212.7078378200531
[rfa agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.040218724448078495
[rfa agg] init. name: [17, 1, 30, 40, 83, 97, 18, 68, 10, 21], weight: tensor([0.1287, 0.0759, 0.0397, 0.1286, 0.1597, 0.0992, 0.0433, 0.0951, 0.0704,
        0.1594])
[rfa agg] iter:  0, prev_obj_val: 67.917724609375, obj_val: 70.6927490234375, abs dis: 2.7750244140625
[rfa agg] iter:  0, weight: tensor([0.1201, 0.0812, 0.0191, 0.1180, 0.0764, 0.2149, 0.0227, 0.2043, 0.0673,
        0.0759])
[rfa agg] iter:  1, prev_obj_val: 70.6927490234375, obj_val: 70.68167114257812, abs dis: 0.011077880859375
[rfa agg] iter:  1, weight: tensor([0.1004, 0.0935, 0.0202, 0.0992, 0.0680, 0.2326, 0.0242, 0.2168, 0.0775,
        0.0676])
[rfa agg] iter:  2, prev_obj_val: 70.68167114257812, obj_val: 72.5018310546875, abs dis: 1.820159912109375
[rfa agg] iter:  2, weight: tensor([0.0993, 0.0932, 0.0200, 0.0982, 0.0675, 0.2362, 0.0240, 0.2174, 0.0771,
        0.0670])
[rfa agg] iter:  3, prev_obj_val: 72.5018310546875, obj_val: 72.49996948242188, abs dis: 0.001861572265625
[rfa agg] iter:  3, weight: tensor([0.0957, 0.1048, 0.0215, 0.0947, 0.0668, 0.2275, 0.0260, 0.2097, 0.0871,
        0.0664])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8441, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.2050, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.5290129184723 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0646, Accuracy: 231/1013 (22.8036%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 470/1013 (46.3968%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.3921, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0750, Accuracy: 46/631 (7.2900%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 232/631 (36.7670%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1794, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0714, Accuracy: 199/774 (25.7106%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0392, Accuracy: 301/774 (38.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4937, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 198/1049 (18.8751%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0321, Accuracy: 484/1049 (46.1392%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.7774, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0474, Accuracy: 272/888 (30.6306%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.2594, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0541, Accuracy: 334/1628 (20.5160%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 700/1628 (42.9975%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.0414, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0569, Accuracy: 546/2227 (24.5173%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 958/2227 (43.0175%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.0830, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 341/891 (38.2716%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 436/891 (48.9338%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.3087, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0657, Accuracy: 295/1418 (20.8039%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0331, Accuracy: 577/1418 (40.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6006, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0627, Accuracy: 256/719 (35.6050%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0355, Accuracy: 450/719 (62.5869%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.9357, Accuracy: 72/10000 (0.7200%)
time spent on training: 186.76156306266785
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 48, 81, 51, 63, 5, 60, 7, 70, 41], weight: tensor([0.0901, 0.0561, 0.0689, 0.0933, 0.0790, 0.1449, 0.1982, 0.0793, 0.1262,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 70.46719360351562, obj_val: 72.05561828613281, abs dis: 1.5884246826171875
[rfa agg] iter:  0, weight: tensor([0.1604, 0.0378, 0.0686, 0.1771, 0.0939, 0.1081, 0.0694, 0.0932, 0.1371,
        0.0544])
[rfa agg] iter:  1, prev_obj_val: 72.05561828613281, obj_val: 75.98554992675781, abs dis: 3.929931640625
[rfa agg] iter:  1, weight: tensor([0.2167, 0.0400, 0.0851, 0.1629, 0.1257, 0.0631, 0.0460, 0.1236, 0.0746,
        0.0622])
[rfa agg] iter:  2, prev_obj_val: 75.98554992675781, obj_val: 82.69011688232422, abs dis: 6.704566955566406
[rfa agg] iter:  2, weight: tensor([0.1656, 0.0481, 0.1155, 0.1132, 0.1689, 0.0512, 0.0396, 0.1608, 0.0579,
        0.0793])
[rfa agg] iter:  3, prev_obj_val: 82.69011688232422, obj_val: 82.64834594726562, abs dis: 0.04177093505859375
[rfa agg] iter:  3, weight: tensor([0.1108, 0.0692, 0.1565, 0.0852, 0.1670, 0.0470, 0.0382, 0.1605, 0.0516,
        0.1140])
[rfa agg] iter:  4, prev_obj_val: 82.64834594726562, obj_val: 82.64781188964844, abs dis: 0.0005340576171875
[rfa agg] iter:  4, weight: tensor([0.1073, 0.0690, 0.1640, 0.0836, 0.1644, 0.0464, 0.0377, 0.1598, 0.0509,
        0.1169])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8359, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.2906, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 281.7580623626709 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0643, Accuracy: 257/901 (28.5239%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0354, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.4042, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0917, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0742, Accuracy: 19/186 (10.2151%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3410, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0625, Accuracy: 280/1949 (14.3663%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0358, Accuracy: 543/1949 (27.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.2786, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0864, Accuracy: 32/515 (6.2136%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0570, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9885, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0547, Accuracy: 276/1089 (25.3444%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0318, Accuracy: 432/1089 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 15.1075, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0644, Accuracy: 254/719 (35.3268%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0331, Accuracy: 451/719 (62.7260%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.4855, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 246/712 (34.5506%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0291, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.7200, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0687, Accuracy: 146/818 (17.8484%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0317, Accuracy: 343/818 (41.9315%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.0587, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0698, Accuracy: 300/1956 (15.3374%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0343, Accuracy: 618/1956 (31.5951%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.1440, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0576, Accuracy: 372/1715 (21.6910%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0324, Accuracy: 659/1715 (38.4257%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6431, Accuracy: 90/10000 (0.9000%)
time spent on training: 183.06478142738342
[rfa agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 56, 21, 33, 59, 41, 11, 71, 6, 92], weight: tensor([0.0853, 0.0176, 0.1846, 0.0488, 0.1031, 0.0681, 0.0674, 0.0775, 0.1852,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 81.58782958984375, obj_val: 83.64227294921875, abs dis: 2.054443359375
[rfa agg] iter:  0, weight: tensor([0.1343, 0.0084, 0.1289, 0.0372, 0.1606, 0.0713, 0.0712, 0.0929, 0.1297,
        0.1656])
[rfa agg] iter:  1, prev_obj_val: 83.64227294921875, obj_val: 86.57093048095703, abs dis: 2.9286575317382812
[rfa agg] iter:  1, weight: tensor([0.1665, 0.0085, 0.1067, 0.0400, 0.1685, 0.0808, 0.0811, 0.1086, 0.1074,
        0.1317])
[rfa agg] iter:  2, prev_obj_val: 86.57093048095703, obj_val: 86.53804016113281, abs dis: 0.03289031982421875
[rfa agg] iter:  2, weight: tensor([0.2062, 0.0085, 0.0871, 0.0428, 0.1476, 0.0928, 0.0939, 0.1301, 0.0876,
        0.1034])
[rfa agg] iter:  3, prev_obj_val: 86.53804016113281, obj_val: 86.5374526977539, abs dis: 0.00058746337890625
[rfa agg] iter:  3, weight: tensor([0.2132, 0.0084, 0.0862, 0.0425, 0.1436, 0.0926, 0.0938, 0.1306, 0.0868,
        0.1023])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.8294, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.7361, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.2532067298889 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0586, Accuracy: 315/896 (35.1562%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0325, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3384, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0887, Accuracy: 33/515 (6.4078%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0563, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.9113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0569, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0358, Accuracy: 694/1953 (35.5351%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3327, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0558, Accuracy: 519/2227 (23.3049%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 929/2227 (41.7153%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.9442, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0652, Accuracy: 201/1154 (17.4177%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0283, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.6811, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 104/530 (19.6226%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0414, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.1704, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0641, Accuracy: 260/719 (36.1613%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0355, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.2080, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0650, Accuracy: 284/1657 (17.1394%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0379, Accuracy: 475/1657 (28.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1825, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0761, Accuracy: 32/460 (6.9565%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 179/460 (38.9130%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.6413, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0916, Accuracy: 13/486 (2.6749%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0447, Accuracy: 233/486 (47.9424%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.5549, Accuracy: 56/10000 (0.5600%)
time spent on training: 184.34052324295044
[rfa agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 33, 83, 60, 57, 18, 41, 0, 31, 30], weight: tensor([0.0846, 0.0486, 0.1843, 0.2102, 0.1089, 0.0500, 0.0678, 0.1564, 0.0434,
        0.0459])
[rfa agg] iter:  0, prev_obj_val: 89.89494323730469, obj_val: 91.30307006835938, abs dis: 1.4081268310546875
[rfa agg] iter:  0, weight: tensor([0.1088, 0.0355, 0.1346, 0.1140, 0.2455, 0.0368, 0.0673, 0.1971, 0.0294,
        0.0310])
[rfa agg] iter:  1, prev_obj_val: 91.30307006835938, obj_val: 93.34414672851562, abs dis: 2.04107666015625
[rfa agg] iter:  1, weight: tensor([0.1202, 0.0367, 0.1173, 0.1013, 0.2875, 0.0381, 0.0720, 0.1647, 0.0303,
        0.0319])
[rfa agg] iter:  2, prev_obj_val: 93.34414672851562, obj_val: 97.1168212890625, abs dis: 3.772674560546875
[rfa agg] iter:  2, weight: tensor([0.1414, 0.0399, 0.1073, 0.0943, 0.2836, 0.0414, 0.0812, 0.1437, 0.0327,
        0.0345])
[rfa agg] iter:  3, prev_obj_val: 97.1168212890625, obj_val: 98.44091033935547, abs dis: 1.3240890502929688
[rfa agg] iter:  3, weight: tensor([0.1936, 0.0469, 0.0965, 0.0867, 0.2239, 0.0488, 0.1030, 0.1225, 0.0381,
        0.0400])
[rfa agg] iter:  4, prev_obj_val: 98.44091033935547, obj_val: 101.40776062011719, abs dis: 2.9668502807617188
[rfa agg] iter:  4, weight: tensor([0.2241, 0.0491, 0.0916, 0.0828, 0.1929, 0.0513, 0.1125, 0.1145, 0.0396,
        0.0417])
[rfa agg] iter:  5, prev_obj_val: 101.40776062011719, obj_val: 102.99066162109375, abs dis: 1.5829010009765625
[rfa agg] iter:  5, weight: tensor([0.2745, 0.0523, 0.0803, 0.0735, 0.1508, 0.0549, 0.1299, 0.0977, 0.0419,
        0.0441])
[rfa agg] iter:  6, prev_obj_val: 102.99066162109375, obj_val: 104.72949981689453, abs dis: 1.7388381958007812
[rfa agg] iter:  6, weight: tensor([0.3069, 0.0531, 0.0733, 0.0675, 0.1291, 0.0560, 0.1394, 0.0880, 0.0423,
        0.0445])
[rfa agg] iter:  7, prev_obj_val: 104.72949981689453, obj_val: 102.97943878173828, abs dis: 1.75006103515625
[rfa agg] iter:  7, weight: tensor([0.3222, 0.0546, 0.0678, 0.0628, 0.1137, 0.0579, 0.1515, 0.0805, 0.0433,
        0.0456])
[rfa agg] iter:  8, prev_obj_val: 102.97943878173828, obj_val: 104.72613525390625, abs dis: 1.7466964721679688
[rfa agg] iter:  8, weight: tensor([0.3246, 0.0518, 0.0713, 0.0657, 0.1235, 0.0547, 0.1381, 0.0856, 0.0412,
        0.0434])
[rfa agg] iter:  9, prev_obj_val: 104.72613525390625, obj_val: 102.97970581054688, abs dis: 1.746429443359375
[rfa agg] iter:  9, weight: tensor([0.3282, 0.0542, 0.0672, 0.0623, 0.1125, 0.0574, 0.1501, 0.0799, 0.0429,
        0.0452])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8191, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3071, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.5907299518585 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0662, Accuracy: 270/946 (28.5412%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6638, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0618, Accuracy: 250/1446 (17.2891%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0363, Accuracy: 457/1446 (31.6044%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2764, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1481, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1336, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 11.2190, Accuracy: 52/10000 (0.5200%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0523, Accuracy: 323/1574 (20.5210%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 598/1574 (37.9924%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.3090, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0587, Accuracy: 334/1587 (21.0460%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0353, Accuracy: 541/1587 (34.0895%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.8842, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0718, Accuracy: 43/631 (6.8146%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0402, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9581, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0627, Accuracy: 237/1013 (23.3959%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0291, Accuracy: 483/1013 (47.6802%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.3780, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 333/891 (37.3737%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0277, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.9054, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0695, Accuracy: 222/1154 (19.2374%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0324, Accuracy: 400/1154 (34.6620%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.1477, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0627, Accuracy: 308/1949 (15.8030%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0345, Accuracy: 602/1949 (30.8876%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.0802, Accuracy: 83/10000 (0.8300%)
time spent on training: 201.68229341506958
[rfa agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.043621408300815886
[rfa agg] init. name: [43, 26, 61, 17, 27, 48, 39, 7, 15, 21], weight: tensor([0.0839, 0.1282, 0.0075, 0.1396, 0.1407, 0.0560, 0.0898, 0.0790, 0.1023,
        0.1728])
[rfa agg] iter:  0, prev_obj_val: 60.13105773925781, obj_val: 62.527793884277344, abs dis: 2.3967361450195312
[rfa agg] iter:  0, weight: tensor([0.1010, 0.1502, 0.0023, 0.1203, 0.1198, 0.0338, 0.1327, 0.0793, 0.1828,
        0.0780])
[rfa agg] iter:  1, prev_obj_val: 62.527793884277344, obj_val: 62.51112365722656, abs dis: 0.01667022705078125
[rfa agg] iter:  1, weight: tensor([0.1212, 0.1240, 0.0023, 0.1019, 0.1021, 0.0367, 0.1650, 0.0919, 0.1848,
        0.0699])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8199, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.1026654243469 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0500, Accuracy: 371/1129 (32.8609%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 684/1129 (60.5846%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.6032, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0697, Accuracy: 302/1163 (25.9673%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0399, Accuracy: 395/1163 (33.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0739, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0689, Accuracy: 206/1154 (17.8510%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 405/1154 (35.0953%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.9041, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0883, Accuracy: 82/603 (13.5987%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0517, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5933, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0609, Accuracy: 360/1904 (18.9076%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0330, Accuracy: 613/1904 (32.1954%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2539, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0352, Accuracy: 704/1953 (36.0471%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3074, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0493, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 461/891 (51.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1992, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0682, Accuracy: 300/1956 (15.3374%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 568/1956 (29.0389%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.9852, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0577, Accuracy: 368/1715 (21.4577%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 632/1715 (36.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6973, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0211, Accuracy: 433/813 (53.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 13.2568, Accuracy: 59/10000 (0.5900%)
time spent on training: 210.94383811950684
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 68, 15, 88, 46, 83, 7, 6, 92, 53], weight: tensor([0.0850, 0.0876, 0.0869, 0.0454, 0.1434, 0.1471, 0.0671, 0.1473, 0.1291,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 68.55492401123047, obj_val: 69.31708526611328, abs dis: 0.7621612548828125
[rfa agg] iter:  0, weight: tensor([0.1311, 0.1604, 0.1337, 0.0259, 0.1071, 0.0993, 0.0567, 0.0996, 0.1396,
        0.0467])
[rfa agg] iter:  1, prev_obj_val: 69.31708526611328, obj_val: 72.64990997314453, abs dis: 3.33282470703125
[rfa agg] iter:  1, weight: tensor([0.1413, 0.1775, 0.1430, 0.0261, 0.0978, 0.0909, 0.0583, 0.0914, 0.1260,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 72.64990997314453, obj_val: 75.75298309326172, abs dis: 3.1030731201171875
[rfa agg] iter:  2, weight: tensor([0.1748, 0.2081, 0.1519, 0.0274, 0.0777, 0.0730, 0.0658, 0.0733, 0.0951,
        0.0528])
[rfa agg] iter:  3, prev_obj_val: 75.75298309326172, obj_val: 74.075439453125, abs dis: 1.6775436401367188
[rfa agg] iter:  3, weight: tensor([0.1991, 0.2078, 0.1481, 0.0294, 0.0689, 0.0651, 0.0750, 0.0654, 0.0819,
        0.0592])
[rfa agg] iter:  4, prev_obj_val: 74.075439453125, obj_val: 75.74687194824219, abs dis: 1.6714324951171875
[rfa agg] iter:  4, weight: tensor([0.1920, 0.2128, 0.1493, 0.0279, 0.0718, 0.0677, 0.0692, 0.0680, 0.0864,
        0.0550])
[rfa agg] iter:  5, prev_obj_val: 75.74687194824219, obj_val: 74.07572174072266, abs dis: 1.6711502075195312
[rfa agg] iter:  5, weight: tensor([0.2017, 0.2080, 0.1470, 0.0293, 0.0686, 0.0649, 0.0748, 0.0651, 0.0815,
        0.0590])
[rfa agg] iter:  6, prev_obj_val: 74.07572174072266, obj_val: 75.74681854248047, abs dis: 1.6710968017578125
[rfa agg] iter:  6, weight: tensor([0.1925, 0.2127, 0.1491, 0.0279, 0.0718, 0.0677, 0.0692, 0.0679, 0.0863,
        0.0549])
[rfa agg] iter:  7, prev_obj_val: 75.74681854248047, obj_val: 74.07573699951172, abs dis: 1.67108154296875
[rfa agg] iter:  7, weight: tensor([0.2018, 0.2080, 0.1470, 0.0293, 0.0686, 0.0649, 0.0748, 0.0651, 0.0815,
        0.0590])
[rfa agg] iter:  8, prev_obj_val: 74.07573699951172, obj_val: 75.74681854248047, abs dis: 1.67108154296875
[rfa agg] iter:  8, weight: tensor([0.1925, 0.2127, 0.1490, 0.0279, 0.0718, 0.0677, 0.0692, 0.0679, 0.0863,
        0.0549])
[rfa agg] iter:  9, prev_obj_val: 75.74681854248047, obj_val: 74.07573699951172, abs dis: 1.67108154296875
[rfa agg] iter:  9, weight: tensor([0.2018, 0.2080, 0.1470, 0.0293, 0.0686, 0.0649, 0.0748, 0.0651, 0.0815,
        0.0590])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8244, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.1957, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.12448143959045 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0668, Accuracy: 205/1131 (18.1256%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.1910, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0944, Accuracy: 19/466 (4.0773%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0528, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8685, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0675, Accuracy: 235/1154 (20.3640%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0299, Accuracy: 451/1154 (39.0815%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.0231, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0617, Accuracy: 251/1130 (22.2124%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0318, Accuracy: 425/1130 (37.6106%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.7200, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.1032, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0570, Accuracy: 154/416 (37.0192%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.5616, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.1011, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0540, Accuracy: 97/338 (28.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0553, Accuracy: 545/2227 (24.4724%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 973/2227 (43.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.0951, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0608, Accuracy: 235/712 (33.0056%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 406/712 (57.0225%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.0347, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0617, Accuracy: 253/1446 (17.4965%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 489/1446 (33.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2974, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0653, Accuracy: 223/1213 (18.3842%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0298, Accuracy: 529/1213 (43.6109%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.2098, Accuracy: 84/10000 (0.8400%)
time spent on training: 185.95900440216064
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 76, 15, 54, 78, 12, 60, 11, 26, 97], weight: tensor([0.1105, 0.0455, 0.1128, 0.1104, 0.0407, 0.0330, 0.2176, 0.0696, 0.1413,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 68.74313354492188, obj_val: 69.3531723022461, abs dis: 0.6100387573242188
[rfa agg] iter:  0, weight: tensor([0.2035, 0.0205, 0.1424, 0.1941, 0.0166, 0.0123, 0.0584, 0.0500, 0.1162,
        0.1862])
[rfa agg] iter:  1, prev_obj_val: 69.3531723022461, obj_val: 70.9100341796875, abs dis: 1.5568618774414062
[rfa agg] iter:  1, weight: tensor([0.2224, 0.0207, 0.1393, 0.2013, 0.0168, 0.0124, 0.0545, 0.0521, 0.1035,
        0.1771])
[rfa agg] iter:  2, prev_obj_val: 70.9100341796875, obj_val: 70.9084243774414, abs dis: 0.00160980224609375
[rfa agg] iter:  2, weight: tensor([0.2224, 0.0228, 0.1371, 0.2013, 0.0184, 0.0136, 0.0557, 0.0593, 0.1009,
        0.1685])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.4221, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 9.7142, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.4269025325775 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0649, Accuracy: 274/1573 (17.4189%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0365, Accuracy: 519/1573 (32.9943%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0259, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 431/1953 (22.0686%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 735/1953 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.5073, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0605, Accuracy: 333/1904 (17.4895%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0326, Accuracy: 632/1904 (33.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3163, Accuracy: 101/10000 (1.0100%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0527, Accuracy: 328/1574 (20.8386%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0308, Accuracy: 537/1574 (34.1169%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.3519, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0891, Accuracy: 83/603 (13.7645%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0548, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7735, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0682, Accuracy: 135/818 (16.5037%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 332/818 (40.5868%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6770, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0670, Accuracy: 300/1750 (17.1429%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0382, Accuracy: 583/1750 (33.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9835, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0769, Accuracy: 31/460 (6.7391%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 197/460 (42.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.1224, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 248/690 (35.9420%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.1859, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0680, Accuracy: 290/1956 (14.8262%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0349, Accuracy: 581/1956 (29.7035%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.9520, Accuracy: 105/10000 (1.0500%)
time spent on training: 225.6427927017212
[rfa agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.037035991265717945
[rfa agg] init. name: [40, 83, 46, 17, 88, 71, 44, 31, 25, 6], weight: tensor([0.1184, 0.1471, 0.1434, 0.1185, 0.0454, 0.0616, 0.1318, 0.0346, 0.0520,
        0.1473])
[rfa agg] iter:  0, prev_obj_val: 70.11825561523438, obj_val: 65.7565689086914, abs dis: 4.361686706542969
[rfa agg] iter:  0, weight: tensor([0.2041, 0.1085, 0.1200, 0.2089, 0.0238, 0.0418, 0.1375, 0.0157, 0.0295,
        0.1102])
[rfa agg] iter:  1, prev_obj_val: 65.7565689086914, obj_val: 63.87749481201172, abs dis: 1.8790740966796875
[rfa agg] iter:  1, weight: tensor([0.2210, 0.1033, 0.1170, 0.2292, 0.0191, 0.0328, 0.1358, 0.0127, 0.0234,
        0.1057])
[rfa agg] iter:  2, prev_obj_val: 63.87749481201172, obj_val: 63.876747131347656, abs dis: 0.0007476806640625
[rfa agg] iter:  2, weight: tensor([0.2252, 0.1021, 0.1170, 0.2356, 0.0172, 0.0293, 0.1363, 0.0115, 0.0211,
        0.1048])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.2249, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 10.1993, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.4504759311676 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0619, Accuracy: 256/1013 (25.2715%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0288, Accuracy: 469/1013 (46.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.2320, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0660, Accuracy: 182/1071 (16.9935%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1438, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0711, Accuracy: 87/781 (11.1396%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.4338, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0785, Accuracy: 28/460 (6.0870%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0343, Accuracy: 194/460 (42.1739%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.4395, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0687, Accuracy: 123/938 (13.1130%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 362/938 (38.5928%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1286, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0484, Accuracy: 418/1552 (26.9330%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0225, Accuracy: 709/1552 (45.6830%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.7660, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0622, Accuracy: 185/590 (31.3559%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 13.0976, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0632, Accuracy: 227/1131 (20.0707%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0327, Accuracy: 398/1131 (35.1901%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4764, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0624, Accuracy: 220/1513 (14.5406%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0380, Accuracy: 457/1513 (30.2049%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5953, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0633, Accuracy: 332/1427 (23.2656%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0356, Accuracy: 577/1427 (40.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2546, Accuracy: 72/10000 (0.7200%)
time spent on training: 191.36021327972412
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 55, 3, 31, 73, 74, 69, 87, 8, 34], weight: tensor([0.0967, 0.1022, 0.0746, 0.0439, 0.0895, 0.1481, 0.0563, 0.1080, 0.1444,
        0.1362])
[rfa agg] iter:  0, prev_obj_val: 50.62432098388672, obj_val: 51.91197967529297, abs dis: 1.28765869140625
[rfa agg] iter:  0, weight: tensor([0.1765, 0.1580, 0.0816, 0.0219, 0.1680, 0.0655, 0.0369, 0.1438, 0.0718,
        0.0759])
[rfa agg] iter:  1, prev_obj_val: 51.91197967529297, obj_val: 56.03242492675781, abs dis: 4.120445251464844
[rfa agg] iter:  1, weight: tensor([0.1861, 0.1519, 0.0877, 0.0225, 0.1896, 0.0598, 0.0386, 0.1299, 0.0653,
        0.0686])
[rfa agg] iter:  2, prev_obj_val: 56.03242492675781, obj_val: 53.815223693847656, abs dis: 2.2172012329101562
[rfa agg] iter:  2, weight: tensor([0.1666, 0.1311, 0.1167, 0.0275, 0.2089, 0.0587, 0.0492, 0.1121, 0.0634,
        0.0659])
[rfa agg] iter:  3, prev_obj_val: 53.815223693847656, obj_val: 56.0151481628418, abs dis: 2.1999244689941406
[rfa agg] iter:  3, weight: tensor([0.1727, 0.1371, 0.1026, 0.0245, 0.2146, 0.0584, 0.0430, 0.1173, 0.0634,
        0.0663])
[rfa agg] iter:  4, prev_obj_val: 56.0151481628418, obj_val: 56.01127624511719, abs dis: 0.003871917724609375
[rfa agg] iter:  4, weight: tensor([0.1633, 0.1293, 0.1179, 0.0273, 0.2155, 0.0583, 0.0490, 0.1109, 0.0630,
        0.0655])
[rfa agg] iter:  5, prev_obj_val: 56.01127624511719, obj_val: 56.0112190246582, abs dis: 5.7220458984375e-05
[rfa agg] iter:  5, weight: tensor([0.1617, 0.1285, 0.1194, 0.0273, 0.2168, 0.0583, 0.0491, 0.1105, 0.0629,
        0.0655])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.0753, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 11.9941, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.9207499027252 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0814, Accuracy: 37/515 (7.1845%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9111, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0947, Accuracy: 29/486 (5.9671%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0465, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.1506, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0903, Accuracy: 76/603 (12.6036%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0538, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5918, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0647, Accuracy: 352/1427 (24.6671%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0368, Accuracy: 531/1427 (37.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2773, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0681, Accuracy: 126/938 (13.4328%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0350, Accuracy: 311/938 (33.1557%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.3007, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0590, Accuracy: 267/1036 (25.7722%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0267, Accuracy: 619/1036 (59.7490%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 14.1855, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0613, Accuracy: 257/1446 (17.7732%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0362, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2992, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0773, Accuracy: 168/715 (23.4965%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0442, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3902, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0691, Accuracy: 131/735 (17.8231%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 358/735 (48.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.8855, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0607, Accuracy: 346/1470 (23.5374%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 784/1470 (53.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.7350, Accuracy: 97/10000 (0.9700%)
time spent on training: 182.16852188110352
[rfa agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 30, 88, 34, 73, 19, 26, 23, 32, 22], weight: tensor([0.0550, 0.0519, 0.0643, 0.1523, 0.1001, 0.1106, 0.1543, 0.0763, 0.0784,
        0.1569])
[rfa agg] iter:  0, prev_obj_val: 55.00983810424805, obj_val: 55.92428207397461, abs dis: 0.9144439697265625
[rfa agg] iter:  0, weight: tensor([0.0409, 0.0346, 0.0592, 0.0904, 0.2143, 0.1780, 0.0909, 0.0967, 0.1047,
        0.0902])
[rfa agg] iter:  1, prev_obj_val: 55.92428207397461, obj_val: 62.3861083984375, abs dis: 6.461826324462891
[rfa agg] iter:  1, weight: tensor([0.0424, 0.0358, 0.0625, 0.0820, 0.2320, 0.1608, 0.0825, 0.1045, 0.1153,
        0.0822])
[rfa agg] iter:  2, prev_obj_val: 62.3861083984375, obj_val: 62.22661209106445, abs dis: 0.15949630737304688
[rfa agg] iter:  2, weight: tensor([0.0590, 0.0493, 0.0980, 0.0679, 0.1518, 0.1065, 0.0685, 0.1503, 0.1803,
        0.0686])
[rfa agg] iter:  3, prev_obj_val: 62.22661209106445, obj_val: 62.22284698486328, abs dis: 0.003765106201171875
[rfa agg] iter:  3, weight: tensor([0.0581, 0.0487, 0.0986, 0.0656, 0.1399, 0.1015, 0.0663, 0.1585, 0.1969,
        0.0661])
[rfa agg] iter:  4, prev_obj_val: 62.22284698486328, obj_val: 62.222740173339844, abs dis: 0.0001068115234375
[rfa agg] iter:  4, weight: tensor([0.0578, 0.0485, 0.0983, 0.0652, 0.1380, 0.1007, 0.0659, 0.1595, 0.2003,
        0.0657])
[rfa agg] iter:  5, prev_obj_val: 62.222740173339844, obj_val: 64.29481506347656, abs dis: 2.0720748901367188
[rfa agg] iter:  5, weight: tensor([0.0578, 0.0484, 0.0983, 0.0652, 0.1377, 0.1006, 0.0659, 0.1596, 0.2009,
        0.0656])
[rfa agg] iter:  6, prev_obj_val: 64.29481506347656, obj_val: 69.18193054199219, abs dis: 4.887115478515625
[rfa agg] iter:  6, weight: tensor([0.0629, 0.0529, 0.1123, 0.0619, 0.1226, 0.0918, 0.0626, 0.1627, 0.2078,
        0.0625])
[rfa agg] iter:  7, prev_obj_val: 69.18193054199219, obj_val: 66.60820770263672, abs dis: 2.5737228393554688
[rfa agg] iter:  7, weight: tensor([0.0781, 0.0674, 0.1558, 0.0584, 0.1021, 0.0805, 0.0591, 0.1524, 0.1872,
        0.0591])
[rfa agg] iter:  8, prev_obj_val: 66.60820770263672, obj_val: 71.96868896484375, abs dis: 5.360481262207031
[rfa agg] iter:  8, weight: tensor([0.0703, 0.0594, 0.1364, 0.0593, 0.1087, 0.0843, 0.0600, 0.1593, 0.2024,
        0.0598])
[rfa agg] iter:  9, prev_obj_val: 71.96868896484375, obj_val: 71.94744110107422, abs dis: 0.02124786376953125
[rfa agg] iter:  9, weight: tensor([0.0876, 0.0780, 0.1834, 0.0572, 0.0946, 0.0764, 0.0579, 0.1404, 0.1665,
        0.0579])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8796, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.4005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.21036434173584 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0701, Accuracy: 297/1163 (25.5374%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0393, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1861, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0864, Accuracy: 44/500 (8.8000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0512, Accuracy: 204/500 (40.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.2145, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0533, Accuracy: 330/1628 (20.2703%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0271, Accuracy: 763/1628 (46.8673%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.9586, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0589, Accuracy: 273/1013 (26.9497%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0275, Accuracy: 496/1013 (48.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.9531, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0728, Accuracy: 204/807 (25.2788%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0367, Accuracy: 427/807 (52.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5491, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0576, Accuracy: 384/1470 (26.1224%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 783/1470 (53.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.1145, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0940, Accuracy: 4/311 (1.2862%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0643, Accuracy: 98/311 (31.5113%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0500, Accuracy: 378/1552 (24.3557%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 692/1552 (44.5876%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.5681, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0745, Accuracy: 160/636 (25.1572%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0363, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.4731, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0995, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0574, Accuracy: 87/373 (23.3244%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9957, Accuracy: 56/10000 (0.5600%)
time spent on training: 183.0728964805603
[rfa agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 82, 5, 39, 20, 22, 96, 74, 52, 98], weight: tensor([0.1230, 0.0529, 0.1722, 0.1072, 0.0854, 0.1555, 0.0329, 0.1642, 0.0673,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 63.77861404418945, obj_val: 63.545650482177734, abs dis: 0.23296356201171875
[rfa agg] iter:  0, weight: tensor([0.1852, 0.0334, 0.0972, 0.2632, 0.1108, 0.1204, 0.0152, 0.1008, 0.0538,
        0.0200])
[rfa agg] iter:  1, prev_obj_val: 63.545650482177734, obj_val: 66.28399658203125, abs dis: 2.7383460998535156
[rfa agg] iter:  1, weight: tensor([0.1827, 0.0316, 0.0918, 0.2953, 0.1058, 0.1136, 0.0144, 0.0948, 0.0511,
        0.0190])
[rfa agg] iter:  2, prev_obj_val: 66.28399658203125, obj_val: 67.92180633544922, abs dis: 1.6378097534179688
[rfa agg] iter:  2, weight: tensor([0.1521, 0.0359, 0.0847, 0.3113, 0.1304, 0.1021, 0.0158, 0.0871, 0.0596,
        0.0210])
[rfa agg] iter:  3, prev_obj_val: 67.92180633544922, obj_val: 67.91606140136719, abs dis: 0.00574493408203125
[rfa agg] iter:  3, weight: tensor([0.1410, 0.0393, 0.0832, 0.2958, 0.1508, 0.0989, 0.0170, 0.0852, 0.0663,
        0.0227])
[rfa agg] iter:  4, prev_obj_val: 67.91606140136719, obj_val: 67.91592407226562, abs dis: 0.0001373291015625
[rfa agg] iter:  4, weight: tensor([0.1409, 0.0394, 0.0833, 0.2920, 0.1536, 0.0990, 0.0170, 0.0853, 0.0666,
        0.0227])
[rfa agg] iter:  5, prev_obj_val: 67.91592407226562, obj_val: 66.27389526367188, abs dis: 1.64202880859375
[rfa agg] iter:  5, weight: tensor([0.1410, 0.0395, 0.0834, 0.2910, 0.1541, 0.0991, 0.0171, 0.0854, 0.0667,
        0.0228])
[rfa agg] iter:  6, prev_obj_val: 66.27389526367188, obj_val: 67.92060852050781, abs dis: 1.6467132568359375
[rfa agg] iter:  6, weight: tensor([0.1494, 0.0359, 0.0844, 0.3115, 0.1341, 0.1015, 0.0158, 0.0866, 0.0597,
        0.0210])
[rfa agg] iter:  7, prev_obj_val: 67.92060852050781, obj_val: 67.91604614257812, abs dis: 0.0045623779296875
[rfa agg] iter:  7, weight: tensor([0.1408, 0.0393, 0.0831, 0.2958, 0.1511, 0.0988, 0.0170, 0.0852, 0.0662,
        0.0227])
[rfa agg] iter:  8, prev_obj_val: 67.91604614257812, obj_val: 67.91592407226562, abs dis: 0.0001220703125
[rfa agg] iter:  8, weight: tensor([0.1409, 0.0394, 0.0833, 0.2920, 0.1537, 0.0990, 0.0170, 0.0853, 0.0666,
        0.0227])
[rfa agg] iter:  9, prev_obj_val: 67.91592407226562, obj_val: 66.27389526367188, abs dis: 1.64202880859375
[rfa agg] iter:  9, weight: tensor([0.1410, 0.0395, 0.0834, 0.2910, 0.1541, 0.0991, 0.0171, 0.0854, 0.0667,
        0.0228])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8767, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.5110, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.628297328949 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0741, Accuracy: 121/809 (14.9567%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0311, Accuracy: 290/809 (35.8467%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.7514, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0667, Accuracy: 215/1213 (17.7246%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0303, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.6127, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0734, Accuracy: 154/636 (24.2138%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0373, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 12.0666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0688, Accuracy: 133/938 (14.1791%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 317/938 (33.7953%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.1980, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0686, Accuracy: 222/719 (30.8762%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0358, Accuracy: 451/719 (62.7260%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.2200, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0572, Accuracy: 460/2227 (20.6556%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 920/2227 (41.3112%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.1805, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0610, Accuracy: 227/712 (31.8820%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.9446, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0560, Accuracy: 223/813 (27.4293%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0212, Accuracy: 440/813 (54.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.2859, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0610, Accuracy: 192/590 (32.5424%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.8730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0616, Accuracy: 162/861 (18.8153%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0225, Accuracy: 442/861 (51.3357%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.3541, Accuracy: 96/10000 (0.9600%)
time spent on training: 186.30580282211304
[rfa agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [50, 97, 52, 73, 41, 60, 11, 53, 69, 10], weight: tensor([0.0850, 0.1274, 0.0668, 0.0986, 0.0755, 0.2340, 0.0748, 0.0854, 0.0620,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 68.94136047363281, obj_val: 75.14775848388672, abs dis: 6.206398010253906
[rfa agg] iter:  0, weight: tensor([0.1050, 0.1499, 0.0485, 0.1999, 0.0775, 0.0571, 0.0739, 0.1056, 0.0457,
        0.1368])
[rfa agg] iter:  1, prev_obj_val: 75.14775848388672, obj_val: 80.6072006225586, abs dis: 5.459442138671875
[rfa agg] iter:  1, weight: tensor([0.1288, 0.0625, 0.0932, 0.0963, 0.1335, 0.0381, 0.1147, 0.1306, 0.0963,
        0.1060])
[rfa agg] iter:  2, prev_obj_val: 80.6072006225586, obj_val: 80.58837127685547, abs dis: 0.018829345703125
[rfa agg] iter:  2, weight: tensor([0.1123, 0.0595, 0.1242, 0.0828, 0.1267, 0.0393, 0.1146, 0.1130, 0.1361,
        0.0915])
[rfa agg] iter:  3, prev_obj_val: 80.58837127685547, obj_val: 80.58811950683594, abs dis: 0.00025177001953125
[rfa agg] iter:  3, weight: tensor([0.1105, 0.0590, 0.1276, 0.0820, 0.1252, 0.0391, 0.1140, 0.1112, 0.1409,
        0.0905])
[rfa agg] iter:  4, prev_obj_val: 80.58811950683594, obj_val: 83.88243865966797, abs dis: 3.2943191528320312
[rfa agg] iter:  4, weight: tensor([0.1103, 0.0590, 0.1281, 0.0819, 0.1249, 0.0390, 0.1138, 0.1111, 0.1415,
        0.0904])
[rfa agg] iter:  5, prev_obj_val: 83.88243865966797, obj_val: 80.59048461914062, abs dis: 3.2919540405273438
[rfa agg] iter:  5, weight: tensor([0.1042, 0.0596, 0.1402, 0.0799, 0.1175, 0.0407, 0.1090, 0.1049, 0.1568,
        0.0872])
[rfa agg] iter:  6, prev_obj_val: 80.59048461914062, obj_val: 83.88182067871094, abs dis: 3.2913360595703125
[rfa agg] iter:  6, weight: tensor([0.1097, 0.0588, 0.1296, 0.0817, 0.1238, 0.0389, 0.1131, 0.1105, 0.1436,
        0.0902])
[rfa agg] iter:  7, prev_obj_val: 83.88182067871094, obj_val: 80.590576171875, abs dis: 3.2912445068359375
[rfa agg] iter:  7, weight: tensor([0.1041, 0.0596, 0.1404, 0.0799, 0.1174, 0.0407, 0.1089, 0.1048, 0.1571,
        0.0872])
[rfa agg] iter:  8, prev_obj_val: 80.590576171875, obj_val: 83.88182067871094, abs dis: 3.2912445068359375
[rfa agg] iter:  8, weight: tensor([0.1097, 0.0588, 0.1297, 0.0817, 0.1238, 0.0389, 0.1131, 0.1105, 0.1436,
        0.0902])
[rfa agg] iter:  9, prev_obj_val: 83.88182067871094, obj_val: 80.590576171875, abs dis: 3.2912445068359375
[rfa agg] iter:  9, weight: tensor([0.1041, 0.0596, 0.1404, 0.0799, 0.1174, 0.0407, 0.1089, 0.1048, 0.1571,
        0.0872])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 21.2731, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 21.6827, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 279.9380156993866 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0565, Accuracy: 372/1953 (19.0476%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 686/1953 (35.1254%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8068, Accuracy: 103/10000 (1.0300%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 357/1574 (22.6811%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 593/1574 (37.6747%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.2123, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0714, Accuracy: 137/809 (16.9345%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0310, Accuracy: 284/809 (35.1051%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.4816, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.1102, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0622, Accuracy: 83/312 (26.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.4260, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0471, Accuracy: 373/1129 (33.0381%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 687/1129 (60.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.6683, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0545, Accuracy: 304/1628 (18.6732%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0270, Accuracy: 732/1628 (44.9631%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.7791, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0608, Accuracy: 248/1130 (21.9469%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0305, Accuracy: 459/1130 (40.6195%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.9107, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0724, Accuracy: 149/636 (23.4277%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0355, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.9988, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0570, Accuracy: 240/712 (33.7079%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.3248, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0669, Accuracy: 297/1163 (25.5374%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0388, Accuracy: 434/1163 (37.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3865, Accuracy: 64/10000 (0.6400%)
time spent on training: 211.76737427711487
[rfa agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.04452969400688032
[rfa agg] init. name: [83, 17, 50, 24, 37, 5, 54, 52, 11, 68], weight: tensor([0.1768, 0.1425, 0.0732, 0.0282, 0.1022, 0.1474, 0.1023, 0.0576, 0.0645,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 63.69761276245117, obj_val: 65.84204864501953, abs dis: 2.1444358825683594
[rfa agg] iter:  0, weight: tensor([0.0715, 0.1050, 0.0641, 0.0105, 0.1892, 0.0967, 0.1858, 0.0337, 0.0479,
        0.1957])
[rfa agg] iter:  1, prev_obj_val: 65.84204864501953, obj_val: 65.83271026611328, abs dis: 0.00933837890625
[rfa agg] iter:  1, weight: tensor([0.0651, 0.0911, 0.0743, 0.0111, 0.1998, 0.0846, 0.1983, 0.0370, 0.0540,
        0.1847])
[rfa agg] iter:  2, prev_obj_val: 65.83271026611328, obj_val: 67.43876647949219, abs dis: 1.6060562133789062
[rfa agg] iter:  2, weight: tensor([0.0648, 0.0906, 0.0742, 0.0111, 0.2020, 0.0842, 0.2012, 0.0369, 0.0539,
        0.1811])
[rfa agg] iter:  3, prev_obj_val: 67.43876647949219, obj_val: 65.83429718017578, abs dis: 1.6044692993164062
[rfa agg] iter:  3, weight: tensor([0.0648, 0.0885, 0.0841, 0.0119, 0.1986, 0.0827, 0.1981, 0.0406, 0.0601,
        0.1706])
[rfa agg] iter:  4, prev_obj_val: 65.83429718017578, obj_val: 67.43843078613281, abs dis: 1.6041336059570312
[rfa agg] iter:  4, weight: tensor([0.0648, 0.0905, 0.0744, 0.0111, 0.2027, 0.0843, 0.2022, 0.0370, 0.0540,
        0.1789])
[rfa agg] iter:  5, prev_obj_val: 67.43843078613281, obj_val: 65.83433532714844, abs dis: 1.604095458984375
[rfa agg] iter:  5, weight: tensor([0.0648, 0.0885, 0.0841, 0.0119, 0.1988, 0.0827, 0.1983, 0.0406, 0.0601,
        0.1703])
[rfa agg] iter:  6, prev_obj_val: 65.83433532714844, obj_val: 67.43843078613281, abs dis: 1.604095458984375
[rfa agg] iter:  6, weight: tensor([0.0648, 0.0905, 0.0744, 0.0111, 0.2027, 0.0842, 0.2023, 0.0370, 0.0540,
        0.1788])
[rfa agg] iter:  7, prev_obj_val: 67.43843078613281, obj_val: 65.83433532714844, abs dis: 1.604095458984375
[rfa agg] iter:  7, weight: tensor([0.0648, 0.0885, 0.0841, 0.0119, 0.1988, 0.0827, 0.1983, 0.0406, 0.0601,
        0.1703])
[rfa agg] iter:  8, prev_obj_val: 65.83433532714844, obj_val: 67.43843078613281, abs dis: 1.604095458984375
[rfa agg] iter:  8, weight: tensor([0.0648, 0.0905, 0.0744, 0.0111, 0.2027, 0.0842, 0.2023, 0.0370, 0.0540,
        0.1788])
[rfa agg] iter:  9, prev_obj_val: 67.43843078613281, obj_val: 65.83433532714844, abs dis: 1.604095458984375
[rfa agg] iter:  9, weight: tensor([0.0648, 0.0885, 0.0841, 0.0119, 0.1988, 0.0827, 0.1983, 0.0406, 0.0601,
        0.1703])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 17.3599, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 16.1080, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.2513816356659 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0867, Accuracy: 32/500 (6.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0506, Accuracy: 202/500 (40.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.5072, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0564, Accuracy: 313/1340 (23.3582%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0296, Accuracy: 519/1340 (38.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.7647, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0774, Accuracy: 171/715 (23.9161%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0428, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.5301, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0910, Accuracy: 43/682 (6.3050%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0426, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.1386, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0692, Accuracy: 96/781 (12.2919%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 265/781 (33.9309%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.7379, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0561, Accuracy: 342/1440 (23.7500%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0308, Accuracy: 654/1440 (45.4167%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6517, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0601, Accuracy: 328/1715 (19.1254%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 645/1715 (37.6093%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1827, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0654, Accuracy: 128/735 (17.4150%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 367/735 (49.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 13.6260, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0659, Accuracy: 308/1163 (26.4832%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 419/1163 (36.0275%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.6974, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0627, Accuracy: 280/1089 (25.7117%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 459/1089 (42.1488%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.6069, Accuracy: 66/10000 (0.6600%)
time spent on training: 195.35382628440857
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 77, 23, 80, 3, 29, 92, 32, 68, 59], weight: tensor([0.0492, 0.1319, 0.0704, 0.0671, 0.0769, 0.1417, 0.1688, 0.0723, 0.1145,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 60.08441162109375, obj_val: 62.65230178833008, abs dis: 2.567890167236328
[rfa agg] iter:  0, weight: tensor([0.0363, 0.1201, 0.0893, 0.0773, 0.1325, 0.1044, 0.0828, 0.1001, 0.1537,
        0.1035])
[rfa agg] iter:  1, prev_obj_val: 62.65230178833008, obj_val: 65.84937286376953, abs dis: 3.197071075439453
[rfa agg] iter:  1, weight: tensor([0.0397, 0.1014, 0.1031, 0.0905, 0.1659, 0.0893, 0.0731, 0.1204, 0.1250,
        0.0917])
[rfa agg] iter:  2, prev_obj_val: 65.84937286376953, obj_val: 67.7173843383789, abs dis: 1.868011474609375
[rfa agg] iter:  2, weight: tensor([0.0430, 0.0838, 0.1155, 0.1061, 0.1938, 0.0749, 0.0633, 0.1433, 0.0986,
        0.0776])
[rfa agg] iter:  3, prev_obj_val: 67.7173843383789, obj_val: 67.71021270751953, abs dis: 0.007171630859375
[rfa agg] iter:  3, weight: tensor([0.0448, 0.0758, 0.1212, 0.1163, 0.2000, 0.0684, 0.0586, 0.1568, 0.0875,
        0.0704])
[rfa agg] iter:  4, prev_obj_val: 67.71021270751953, obj_val: 67.71013641357422, abs dis: 7.62939453125e-05
[rfa agg] iter:  4, weight: tensor([0.0446, 0.0752, 0.1216, 0.1167, 0.2008, 0.0679, 0.0582, 0.1586, 0.0868,
        0.0696])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 15.3603, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 14.0091, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.2835228443146 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0820, Accuracy: 97/530 (18.3019%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0411, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.9733, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0534, Accuracy: 201/888 (22.6351%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0269, Accuracy: 415/888 (46.7342%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.6504, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0464, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0235, Accuracy: 692/1129 (61.2932%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.0148, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0667, Accuracy: 358/1742 (20.5511%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0339, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9091, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0587, Accuracy: 272/1130 (24.0708%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.3062, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 318/896 (35.4911%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0324, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3002, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0650, Accuracy: 206/1154 (17.8510%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.7193, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0589, Accuracy: 291/803 (36.2391%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0375, Accuracy: 373/803 (46.4508%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4298, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0652, Accuracy: 291/1475 (19.7288%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0355, Accuracy: 555/1475 (37.6271%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6442, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0600, Accuracy: 234/776 (30.1546%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0265, Accuracy: 430/776 (55.4124%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.3667, Accuracy: 82/10000 (0.8200%)
time spent on training: 200.77527594566345
[rfa agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 63, 37, 93, 54, 89, 57, 58, 65, 75], weight: tensor([0.0504, 0.0844, 0.1073, 0.1655, 0.1074, 0.0851, 0.1097, 0.0763, 0.1402,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 54.78952407836914, obj_val: 59.1552619934082, abs dis: 4.3657379150390625
[rfa agg] iter:  0, weight: tensor([0.0330, 0.1303, 0.1253, 0.0592, 0.1305, 0.1452, 0.0988, 0.1103, 0.0703,
        0.0972])
[rfa agg] iter:  1, prev_obj_val: 59.1552619934082, obj_val: 63.743865966796875, abs dis: 4.588603973388672
[rfa agg] iter:  1, weight: tensor([0.0380, 0.1504, 0.0909, 0.0487, 0.0940, 0.1709, 0.0743, 0.1535, 0.0557,
        0.1236])
[rfa agg] iter:  2, prev_obj_val: 63.743865966796875, obj_val: 66.57687377929688, abs dis: 2.8330078125
[rfa agg] iter:  2, weight: tensor([0.0457, 0.1434, 0.0777, 0.0460, 0.0799, 0.1607, 0.0656, 0.1884, 0.0515,
        0.1410])
[rfa agg] iter:  3, prev_obj_val: 66.57687377929688, obj_val: 66.57496643066406, abs dis: 0.0019073486328125
[rfa agg] iter:  3, weight: tensor([0.0528, 0.1367, 0.0754, 0.0466, 0.0774, 0.1499, 0.0646, 0.1980, 0.0517,
        0.1469])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 27.6588, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 26.9148, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.01294708251953 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0940, Accuracy: 15/466 (3.2189%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0576, Accuracy: 173/466 (37.1245%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.2389, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.1009, Accuracy: 2/338 (0.5917%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0567, Accuracy: 93/338 (27.5148%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.9840, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0938, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0769, Accuracy: 17/186 (9.1398%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.6590, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0514, Accuracy: 217/888 (24.4369%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0272, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.6785, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1153, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1610, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0519, Accuracy: 429/1470 (29.1837%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 807/1470 (54.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.0470, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0676, Accuracy: 290/1418 (20.4513%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0339, Accuracy: 536/1418 (37.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7296, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0650, Accuracy: 321/1427 (22.4947%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0366, Accuracy: 538/1427 (37.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3617, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0713, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0365, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.0494, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0518, Accuracy: 403/1552 (25.9665%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 707/1552 (45.5541%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.3726, Accuracy: 82/10000 (0.8200%)
time spent on training: 180.4134283065796
[rfa agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 12, 56, 63, 47, 22, 70, 34, 31, 74], weight: tensor([0.0559, 0.0405, 0.0223, 0.1065, 0.0161, 0.1763, 0.1700, 0.1711, 0.0552,
        0.1861])
[rfa agg] iter:  0, prev_obj_val: 69.15916442871094, obj_val: 67.40284729003906, abs dis: 1.756317138671875
[rfa agg] iter:  0, weight: tensor([0.0439, 0.0259, 0.0107, 0.2161, 0.0077, 0.1705, 0.1661, 0.1699, 0.0435,
        0.1458])
[rfa agg] iter:  1, prev_obj_val: 67.40284729003906, obj_val: 65.76657104492188, abs dis: 1.6362762451171875
[rfa agg] iter:  1, weight: tensor([0.0406, 0.0242, 0.0101, 0.1984, 0.0073, 0.1775, 0.1738, 0.1778, 0.0402,
        0.1500])
[rfa agg] iter:  2, prev_obj_val: 65.76657104492188, obj_val: 65.76078796386719, abs dis: 0.0057830810546875
[rfa agg] iter:  2, weight: tensor([0.0379, 0.0228, 0.0096, 0.1733, 0.0069, 0.1863, 0.1825, 0.1875, 0.0375,
        0.1557])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8010, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.8695, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.7988107204437 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0612, Accuracy: 336/1587 (21.1720%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0350, Accuracy: 564/1587 (35.5388%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3145, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.1071, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0659, Accuracy: 127/408 (31.1275%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3221, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 275/712 (38.6236%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.6740, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0647, Accuracy: 162/1013 (15.9921%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5337, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0559, Accuracy: 387/1953 (19.8157%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0344, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6054, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0567, Accuracy: 343/1440 (23.8194%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0303, Accuracy: 683/1440 (47.4306%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.4671, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0636, Accuracy: 313/1475 (21.2203%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0352, Accuracy: 587/1475 (39.7966%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5837, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0685, Accuracy: 190/1241 (15.3102%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0406, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5800, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0884, Accuracy: 40/682 (5.8651%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0399, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.0610, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0628, Accuracy: 161/861 (18.6992%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 436/861 (50.6388%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.7130, Accuracy: 86/10000 (0.8600%)
time spent on training: 211.31933641433716
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 36, 11, 14, 83, 29, 65, 72, 80, 10], weight: tensor([0.1396, 0.0359, 0.0626, 0.0891, 0.1717, 0.1266, 0.1297, 0.1091, 0.0600,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 63.07218933105469, obj_val: 65.80021667480469, abs dis: 2.72802734375
[rfa agg] iter:  0, weight: tensor([0.1144, 0.0174, 0.0511, 0.1417, 0.0766, 0.1389, 0.1155, 0.2164, 0.0440,
        0.0839])
[rfa agg] iter:  1, prev_obj_val: 65.80021667480469, obj_val: 67.41312408447266, abs dis: 1.6129074096679688
[rfa agg] iter:  1, weight: tensor([0.1017, 0.0191, 0.0591, 0.1809, 0.0715, 0.1208, 0.1027, 0.1924, 0.0504,
        0.1014])
[rfa agg] iter:  2, prev_obj_val: 67.41312408447266, obj_val: 67.40438842773438, abs dis: 0.00873565673828125
[rfa agg] iter:  2, weight: tensor([0.0959, 0.0200, 0.0640, 0.2050, 0.0691, 0.1122, 0.0966, 0.1701, 0.0542,
        0.1128])
[rfa agg] iter:  3, prev_obj_val: 67.40438842773438, obj_val: 67.40422821044922, abs dis: 0.00016021728515625
[rfa agg] iter:  3, weight: tensor([0.0955, 0.0200, 0.0638, 0.2094, 0.0689, 0.1116, 0.0961, 0.1676, 0.0541,
        0.1131])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 13.8224, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 9.0825, Accuracy: 5/9950 (0.0503%)
saving model
Done in 305.4155983924866 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0825, Accuracy: 105/603 (17.4129%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9885, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1575, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1446, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4233, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0665, Accuracy: 333/1742 (19.1160%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0343, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0808, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0802, Accuracy: 107/530 (20.1887%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0411, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.7325, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0886, Accuracy: 33/682 (4.8387%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 274/682 (40.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.5301, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0570, Accuracy: 345/1715 (20.1166%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 648/1715 (37.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9562, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0763, Accuracy: 156/677 (23.0428%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0258, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 13.0332, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0689, Accuracy: 186/1241 (14.9879%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0404, Accuracy: 354/1241 (28.5254%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7117, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0671, Accuracy: 262/1956 (13.3947%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0354, Accuracy: 523/1956 (26.7382%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9677, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0661, Accuracy: 272/1418 (19.1819%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 533/1418 (37.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8069, Accuracy: 85/10000 (0.8500%)
time spent on training: 205.55784702301025
[rfa agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 61, 93, 18, 80, 92, 90, 72, 6, 70], weight: tensor([0.0566, 0.0080, 0.1636, 0.0498, 0.0640, 0.1610, 0.0636, 0.1165, 0.1837,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 70.75904083251953, obj_val: 73.46063995361328, abs dis: 2.70159912109375
[rfa agg] iter:  0, weight: tensor([0.0321, 0.0025, 0.1242, 0.0258, 0.0399, 0.1369, 0.0398, 0.2859, 0.1029,
        0.2100])
[rfa agg] iter:  1, prev_obj_val: 73.46063995361328, obj_val: 75.20179748535156, abs dis: 1.7411575317382812
[rfa agg] iter:  1, weight: tensor([0.0348, 0.0026, 0.1091, 0.0276, 0.0435, 0.1195, 0.0435, 0.3438, 0.0927,
        0.1829])
[rfa agg] iter:  2, prev_obj_val: 75.20179748535156, obj_val: 73.42350006103516, abs dis: 1.7782974243164062
[rfa agg] iter:  2, weight: tensor([0.0376, 0.0027, 0.1065, 0.0298, 0.0473, 0.1159, 0.0474, 0.3510, 0.0915,
        0.1703])
[rfa agg] iter:  3, prev_obj_val: 73.42350006103516, obj_val: 77.11747741699219, abs dis: 3.6939773559570312
[rfa agg] iter:  3, weight: tensor([0.0337, 0.0025, 0.1053, 0.0268, 0.0421, 0.1151, 0.0422, 0.3694, 0.0895,
        0.1735])
[rfa agg] iter:  4, prev_obj_val: 77.11747741699219, obj_val: 73.43053436279297, abs dis: 3.6869430541992188
[rfa agg] iter:  4, weight: tensor([0.0419, 0.0029, 0.1072, 0.0330, 0.0530, 0.1162, 0.0531, 0.3342, 0.0931,
        0.1652])
[rfa agg] iter:  5, prev_obj_val: 73.43053436279297, obj_val: 75.20049285888672, abs dis: 1.76995849609375
[rfa agg] iter:  5, weight: tensor([0.0340, 0.0025, 0.1061, 0.0270, 0.0425, 0.1159, 0.0425, 0.3651, 0.0901,
        0.1744])
[rfa agg] iter:  6, prev_obj_val: 75.20049285888672, obj_val: 73.42263793945312, abs dis: 1.7778549194335938
[rfa agg] iter:  6, weight: tensor([0.0373, 0.0027, 0.1056, 0.0295, 0.0469, 0.1149, 0.0470, 0.3572, 0.0907,
        0.1683])
[rfa agg] iter:  7, prev_obj_val: 73.42263793945312, obj_val: 77.1180648803711, abs dis: 3.6954269409179688
[rfa agg] iter:  7, weight: tensor([0.0336, 0.0025, 0.1049, 0.0267, 0.0420, 0.1147, 0.0420, 0.3716, 0.0892,
        0.1728])
[rfa agg] iter:  8, prev_obj_val: 77.1180648803711, obj_val: 73.43042755126953, abs dis: 3.6876373291015625
[rfa agg] iter:  8, weight: tensor([0.0419, 0.0029, 0.1072, 0.0330, 0.0529, 0.1162, 0.0531, 0.3347, 0.0931,
        0.1651])
[rfa agg] iter:  9, prev_obj_val: 73.43042755126953, obj_val: 75.20050811767578, abs dis: 1.77008056640625
[rfa agg] iter:  9, weight: tensor([0.0339, 0.0025, 0.1060, 0.0270, 0.0425, 0.1159, 0.0425, 0.3653, 0.0901,
        0.1743])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7643, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.3595, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.9233033657074 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0675, Accuracy: 235/946 (24.8414%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 340/946 (35.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1327, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0821, Accuracy: 31/500 (6.2000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0513, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1990, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0636, Accuracy: 235/599 (39.2321%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 13.8841, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0665, Accuracy: 194/1071 (18.1139%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0311, Accuracy: 502/1071 (46.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.3606, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0542, Accuracy: 304/1628 (18.6732%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 721/1628 (44.2875%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.5693, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0713, Accuracy: 127/938 (13.5394%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 353/938 (37.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8310, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0531, Accuracy: 232/888 (26.1261%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 445/888 (50.1126%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.9136, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0681, Accuracy: 199/1131 (17.5950%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0327, Accuracy: 462/1131 (40.8488%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.4234, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0603, Accuracy: 302/1645 (18.3587%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0353, Accuracy: 557/1645 (33.8602%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1682, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0936, Accuracy: 10/466 (2.1459%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0538, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2201, Accuracy: 57/10000 (0.5700%)
time spent on training: 197.1490559577942
[rfa agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 82, 95, 55, 5, 73, 63, 38, 13, 76], weight: tensor([0.0964, 0.0510, 0.0610, 0.1092, 0.1659, 0.0956, 0.0905, 0.1153, 0.1677,
        0.0475])
[rfa agg] iter:  0, prev_obj_val: 57.98363494873047, obj_val: 60.64073181152344, abs dis: 2.6570968627929688
[rfa agg] iter:  0, weight: tensor([0.1851, 0.0304, 0.0479, 0.1297, 0.0644, 0.1746, 0.1561, 0.1193, 0.0643,
        0.0281])
[rfa agg] iter:  1, prev_obj_val: 60.64073181152344, obj_val: 60.6243896484375, abs dis: 0.0163421630859375
[rfa agg] iter:  1, weight: tensor([0.1835, 0.0345, 0.0565, 0.1148, 0.0580, 0.1746, 0.1887, 0.0999, 0.0579,
        0.0317])
[rfa agg] iter:  2, prev_obj_val: 60.6243896484375, obj_val: 65.00521850585938, abs dis: 4.380828857421875
[rfa agg] iter:  2, weight: tensor([0.1822, 0.0343, 0.0563, 0.1133, 0.0575, 0.1739, 0.1953, 0.0983, 0.0574,
        0.0316])
[rfa agg] iter:  3, prev_obj_val: 65.00521850585938, obj_val: 64.99650573730469, abs dis: 0.0087127685546875
[rfa agg] iter:  3, weight: tensor([0.1624, 0.0448, 0.0763, 0.1071, 0.0598, 0.1573, 0.1969, 0.0947, 0.0597,
        0.0411])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.7976, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.5407, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.9730942249298 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0680, Accuracy: 213/807 (26.3941%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0336, Accuracy: 407/807 (50.4337%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3660, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0717, Accuracy: 192/715 (26.8531%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0446, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.5189, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0642, Accuracy: 269/803 (33.4994%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0372, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3501, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0655, Accuracy: 232/946 (24.5243%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0380, Accuracy: 349/946 (36.8922%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2084, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0827, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0511, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0043, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0653, Accuracy: 194/1513 (12.8222%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0390, Accuracy: 441/1513 (29.1474%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.8210, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0650, Accuracy: 271/708 (38.2768%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 400/708 (56.4972%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5981, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0752, Accuracy: 251/1003 (25.0249%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0368, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0790, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0685, Accuracy: 151/1049 (14.3947%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 483/1049 (46.0439%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.3963, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0701, Accuracy: 129/568 (22.7113%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0444, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2356, Accuracy: 58/10000 (0.5800%)
time spent on training: 185.6098985671997
[rfa agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 23, 58, 43, 82, 8, 16, 86, 51, 62], weight: tensor([0.0937, 0.0830, 0.0932, 0.1098, 0.0581, 0.1757, 0.0822, 0.1165, 0.1218,
        0.0660])
[rfa agg] iter:  0, prev_obj_val: 45.48494338989258, obj_val: 51.58394241333008, abs dis: 6.0989990234375
[rfa agg] iter:  0, weight: tensor([0.1502, 0.1055, 0.1670, 0.1198, 0.0446, 0.0570, 0.0978, 0.1071, 0.0882,
        0.0627])
[rfa agg] iter:  1, prev_obj_val: 51.58394241333008, obj_val: 54.20159149169922, abs dis: 2.6176490783691406
[rfa agg] iter:  1, weight: tensor([0.1346, 0.1155, 0.1430, 0.1016, 0.0683, 0.0565, 0.1079, 0.0911, 0.0789,
        0.1027])
[rfa agg] iter:  2, prev_obj_val: 54.20159149169922, obj_val: 54.196685791015625, abs dis: 0.00490570068359375
[rfa agg] iter:  2, weight: tensor([0.1242, 0.1146, 0.1302, 0.0963, 0.0810, 0.0567, 0.1076, 0.0872, 0.0767,
        0.1256])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8266, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.6887, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.3704867362976 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0680, Accuracy: 225/807 (27.8810%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0340, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3837, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0950, Accuracy: 9/486 (1.8519%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0463, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.5977, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0659, Accuracy: 236/946 (24.9471%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0372, Accuracy: 358/946 (37.8436%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2150, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0852, Accuracy: 100/603 (16.5837%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0514, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9934, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0575, Accuracy: 207/590 (35.0847%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.6269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1170, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0984, Accuracy: 19/197 (9.6447%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6530, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0803, Accuracy: 28/500 (5.6000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 192/500 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.9852, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0654, Accuracy: 248/901 (27.5250%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 423/901 (46.9478%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.5506, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0682, Accuracy: 264/1163 (22.6999%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1336, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0515, Accuracy: 414/1552 (26.6753%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 706/1552 (45.4897%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.4433, Accuracy: 96/10000 (0.9600%)
time spent on training: 178.30164694786072
[rfa agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 30, 43, 88, 69, 79, 82, 4, 68, 74], weight: tensor([0.1042, 0.0628, 0.1221, 0.0779, 0.0762, 0.0254, 0.0646, 0.1163, 0.1502,
        0.2004])
[rfa agg] iter:  0, prev_obj_val: 53.083099365234375, obj_val: 59.38689422607422, abs dis: 6.303794860839844
[rfa agg] iter:  0, weight: tensor([0.1851, 0.0471, 0.1949, 0.0838, 0.0822, 0.0108, 0.0487, 0.1629, 0.1091,
        0.0754])
[rfa agg] iter:  1, prev_obj_val: 59.38689422607422, obj_val: 59.2172966003418, abs dis: 0.16959762573242188
[rfa agg] iter:  1, weight: tensor([0.1586, 0.0763, 0.1225, 0.1487, 0.1450, 0.0140, 0.0798, 0.1109, 0.0807,
        0.0635])
[rfa agg] iter:  2, prev_obj_val: 59.2172966003418, obj_val: 59.21473693847656, abs dis: 0.002559661865234375
[rfa agg] iter:  2, weight: tensor([0.1537, 0.0758, 0.1165, 0.1602, 0.1552, 0.0138, 0.0795, 0.1057, 0.0781,
        0.0616])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 16.3610, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 14.4175, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.3844747543335 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0665, Accuracy: 289/1956 (14.7751%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0354, Accuracy: 563/1956 (28.7832%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0885, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0702, Accuracy: 124/938 (13.2196%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 330/938 (35.1812%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0097, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0642, Accuracy: 200/776 (25.7732%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0320, Accuracy: 394/776 (50.7732%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0841, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0759, Accuracy: 122/773 (15.7827%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0332, Accuracy: 397/773 (51.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.8831, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0697, Accuracy: 199/1154 (17.2444%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 418/1154 (36.2218%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.8902, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0676, Accuracy: 175/1513 (11.5664%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0398, Accuracy: 421/1513 (27.8255%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.6180, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0593, Accuracy: 302/1036 (29.1506%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0269, Accuracy: 628/1036 (60.6178%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.2463, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0936, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0625, Accuracy: 85/311 (27.3312%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5745, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1490, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1321, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9347, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0663, Accuracy: 320/1475 (21.6949%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0367, Accuracy: 548/1475 (37.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7994, Accuracy: 79/10000 (0.7900%)
time spent on training: 204.2573266029358
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 73, 75, 99, 15, 8, 19, 96, 47, 65], weight: tensor([0.1943, 0.0932, 0.0771, 0.0768, 0.1146, 0.1503, 0.1029, 0.0309, 0.0133,
        0.1465])
[rfa agg] iter:  0, prev_obj_val: 64.81735229492188, obj_val: 68.14007568359375, abs dis: 3.322723388671875
[rfa agg] iter:  0, weight: tensor([0.0932, 0.1106, 0.0701, 0.0670, 0.1811, 0.1522, 0.1709, 0.0126, 0.0047,
        0.1375])
[rfa agg] iter:  1, prev_obj_val: 68.14007568359375, obj_val: 68.04352569580078, abs dis: 0.09654998779296875
[rfa agg] iter:  1, weight: tensor([0.0756, 0.1477, 0.0894, 0.0832, 0.1594, 0.1105, 0.2127, 0.0137, 0.0049,
        0.1029])
[rfa agg] iter:  2, prev_obj_val: 68.04352569580078, obj_val: 69.42211151123047, abs dis: 1.3785858154296875
[rfa agg] iter:  2, weight: tensor([0.0739, 0.1516, 0.0885, 0.0826, 0.1528, 0.1075, 0.2246, 0.0134, 0.0048,
        0.1001])
[rfa agg] iter:  3, prev_obj_val: 69.42211151123047, obj_val: 71.01544189453125, abs dis: 1.5933303833007812
[rfa agg] iter:  3, weight: tensor([0.0712, 0.1648, 0.0961, 0.0887, 0.1421, 0.1009, 0.2230, 0.0139, 0.0050,
        0.0945])
[rfa agg] iter:  4, prev_obj_val: 71.01544189453125, obj_val: 69.4203872680664, abs dis: 1.5950546264648438
[rfa agg] iter:  4, weight: tensor([0.0690, 0.1800, 0.1058, 0.0963, 0.1321, 0.0955, 0.2120, 0.0144, 0.0051,
        0.0898])
[rfa agg] iter:  5, prev_obj_val: 69.4203872680664, obj_val: 69.41607666015625, abs dis: 0.00431060791015625
[rfa agg] iter:  5, weight: tensor([0.0709, 0.1699, 0.0966, 0.0893, 0.1391, 0.1003, 0.2212, 0.0138, 0.0049,
        0.0939])
[rfa agg] iter:  6, prev_obj_val: 69.41607666015625, obj_val: 69.41600036621094, abs dis: 7.62939453125e-05
[rfa agg] iter:  6, weight: tensor([0.0709, 0.1679, 0.0962, 0.0889, 0.1399, 0.1004, 0.2230, 0.0138, 0.0049,
        0.0940])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8443, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.6075, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.67318177223206 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 59/631 (9.3502%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.7035, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0540, Accuracy: 310/1628 (19.0418%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0275, Accuracy: 716/1628 (43.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.5036, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0694, Accuracy: 132/938 (14.0725%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 323/938 (34.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.9536, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0622, Accuracy: 278/896 (31.0268%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2492, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0732, Accuracy: 186/774 (24.0310%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0404, Accuracy: 335/774 (43.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.8429, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0779, Accuracy: 174/715 (24.3357%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0429, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3590, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0679, Accuracy: 127/735 (17.2789%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 13.5583, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0562, Accuracy: 286/1340 (21.3433%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 578/1340 (43.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.6667, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0778, Accuracy: 96/530 (18.1132%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.8193, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0569, Accuracy: 400/1953 (20.4813%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0350, Accuracy: 736/1953 (37.6856%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5894, Accuracy: 110/10000 (1.1000%)
time spent on training: 205.30293893814087
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 5, 73, 89, 81, 23, 32, 77, 18, 83], weight: tensor([0.0622, 0.1606, 0.0925, 0.0884, 0.0763, 0.0705, 0.0725, 0.1321, 0.0523,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 69.38236236572266, obj_val: 72.28357696533203, abs dis: 2.901214599609375
[rfa agg] iter:  0, weight: tensor([0.0557, 0.0886, 0.1973, 0.1460, 0.1029, 0.0791, 0.0887, 0.1304, 0.0395,
        0.0718])
[rfa agg] iter:  1, prev_obj_val: 72.28357696533203, obj_val: 75.37889099121094, abs dis: 3.0953140258789062
[rfa agg] iter:  1, weight: tensor([0.0671, 0.0633, 0.1868, 0.1644, 0.1242, 0.0923, 0.1179, 0.0854, 0.0445,
        0.0540])
[rfa agg] iter:  2, prev_obj_val: 75.37889099121094, obj_val: 77.33995819091797, abs dis: 1.9610671997070312
[rfa agg] iter:  2, weight: tensor([0.0817, 0.0575, 0.1480, 0.1525, 0.1329, 0.1036, 0.1479, 0.0742, 0.0515,
        0.0501])
[rfa agg] iter:  3, prev_obj_val: 77.33995819091797, obj_val: 82.15869140625, abs dis: 4.818733215332031
[rfa agg] iter:  3, weight: tensor([0.0923, 0.0553, 0.1294, 0.1399, 0.1328, 0.1092, 0.1658, 0.0701, 0.0565,
        0.0487])
[rfa agg] iter:  4, prev_obj_val: 82.15869140625, obj_val: 79.60015106201172, abs dis: 2.5585403442382812
[rfa agg] iter:  4, weight: tensor([0.1229, 0.0535, 0.1081, 0.1197, 0.1225, 0.1140, 0.1754, 0.0655, 0.0706,
        0.0479])
[rfa agg] iter:  5, prev_obj_val: 79.60015106201172, obj_val: 79.59782409667969, abs dis: 0.00232696533203125
[rfa agg] iter:  5, weight: tensor([0.1076, 0.0538, 0.1154, 0.1260, 0.1273, 0.1137, 0.1786, 0.0668, 0.0632,
        0.0478])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8909, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.2679, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.7560930252075 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0915, Accuracy: 19/486 (3.9095%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0464, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.0855, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0575, Accuracy: 301/708 (42.5141%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0394, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0367, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 213/888 (23.9865%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.2422, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0769, Accuracy: 151/677 (22.3043%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.2569, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0816, Accuracy: 17/515 (3.3010%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0534, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2518, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0920, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0550, Accuracy: 99/373 (26.5416%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8099, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0662, Accuracy: 123/781 (15.7490%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 266/781 (34.0589%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6844, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0743, Accuracy: 101/568 (17.7817%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0446, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4884, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0667, Accuracy: 258/1949 (13.2376%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0361, Accuracy: 598/1949 (30.6824%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0452, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0564, Accuracy: 329/1036 (31.7568%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0268, Accuracy: 619/1036 (59.7490%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.6836, Accuracy: 78/10000 (0.7800%)
time spent on training: 182.83991837501526
[rfa agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 16, 63, 90, 33, 98, 3, 62, 21, 19], weight: tensor([0.0609, 0.0887, 0.1113, 0.0848, 0.0645, 0.0467, 0.0979, 0.0712, 0.2442,
        0.1298])
[rfa agg] iter:  0, prev_obj_val: 68.44444274902344, obj_val: 70.06351470947266, abs dis: 1.6190719604492188
[rfa agg] iter:  0, weight: tensor([0.0443, 0.1155, 0.2095, 0.1042, 0.0509, 0.0258, 0.1604, 0.0606, 0.0730,
        0.1558])
[rfa agg] iter:  1, prev_obj_val: 70.06351470947266, obj_val: 73.0590591430664, abs dis: 2.99554443359375
[rfa agg] iter:  1, weight: tensor([0.0617, 0.1353, 0.1442, 0.1805, 0.0691, 0.0315, 0.1424, 0.0940, 0.0526,
        0.0887])
[rfa agg] iter:  2, prev_obj_val: 73.0590591430664, obj_val: 73.02462005615234, abs dis: 0.0344390869140625
[rfa agg] iter:  2, weight: tensor([0.0778, 0.1233, 0.1119, 0.2006, 0.0806, 0.0365, 0.1180, 0.1257, 0.0496,
        0.0759])
[rfa agg] iter:  3, prev_obj_val: 73.02462005615234, obj_val: 73.02412414550781, abs dis: 0.00049591064453125
[rfa agg] iter:  3, weight: tensor([0.0784, 0.1204, 0.1092, 0.2065, 0.0808, 0.0365, 0.1157, 0.1286, 0.0490,
        0.0748])
[rfa agg] iter:  4, prev_obj_val: 73.02412414550781, obj_val: 75.05205535888672, abs dis: 2.0279312133789062
[rfa agg] iter:  4, weight: tensor([0.0784, 0.1199, 0.1089, 0.2079, 0.0808, 0.0364, 0.1153, 0.1288, 0.0490,
        0.0747])
[rfa agg] iter:  5, prev_obj_val: 75.05205535888672, obj_val: 77.3487319946289, abs dis: 2.2966766357421875
[rfa agg] iter:  5, weight: tensor([0.0902, 0.1127, 0.1015, 0.1900, 0.0875, 0.0403, 0.1069, 0.1501, 0.0489,
        0.0719])
[rfa agg] iter:  6, prev_obj_val: 77.3487319946289, obj_val: 77.33872985839844, abs dis: 0.01000213623046875
[rfa agg] iter:  6, weight: tensor([0.1050, 0.1046, 0.0946, 0.1661, 0.0937, 0.0449, 0.0990, 0.1742, 0.0488,
        0.0693])
[rfa agg] iter:  7, prev_obj_val: 77.33872985839844, obj_val: 77.33853149414062, abs dis: 0.0001983642578125
[rfa agg] iter:  7, weight: tensor([0.1064, 0.1034, 0.0939, 0.1630, 0.0939, 0.0450, 0.0982, 0.1790, 0.0485,
        0.0688])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8362, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.1624, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.3615002632141 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0606, Accuracy: 309/1446 (21.3693%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0367, Accuracy: 483/1446 (33.4025%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3330, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0775, Accuracy: 122/773 (15.7827%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0334, Accuracy: 391/773 (50.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 11.1553, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0840, Accuracy: 21/515 (4.0777%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0524, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.7806, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0590, Accuracy: 222/599 (37.0618%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 14.3335, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0685, Accuracy: 99/781 (12.6761%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.3417, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0747, Accuracy: 127/818 (15.5257%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0338, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.7997, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0927, Accuracy: 30/682 (4.3988%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0417, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.8040, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0506, Accuracy: 286/712 (40.1685%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.1056, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0644, Accuracy: 242/803 (30.1370%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0363, Accuracy: 429/803 (53.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4045, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0718, Accuracy: 219/1131 (19.3634%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0344, Accuracy: 376/1131 (33.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4159, Accuracy: 61/10000 (0.6100%)
time spent on training: 187.19304537773132
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 99, 33, 95, 3, 71, 80, 11, 58, 87], weight: tensor([0.1751, 0.0936, 0.0623, 0.0725, 0.0946, 0.0990, 0.0826, 0.0862, 0.0972,
        0.1369])
[rfa agg] iter:  0, prev_obj_val: 42.064544677734375, obj_val: 52.18874740600586, abs dis: 10.124202728271484
[rfa agg] iter:  0, weight: tensor([0.0542, 0.1098, 0.0449, 0.0651, 0.1241, 0.1490, 0.1040, 0.1189, 0.1530,
        0.0770])
[rfa agg] iter:  1, prev_obj_val: 52.18874740600586, obj_val: 52.11937713623047, abs dis: 0.06937026977539062
[rfa agg] iter:  1, weight: tensor([0.0541, 0.0949, 0.0777, 0.1083, 0.1017, 0.1139, 0.1479, 0.1189, 0.1144,
        0.0680])
[rfa agg] iter:  2, prev_obj_val: 52.11937713623047, obj_val: 52.11873245239258, abs dis: 0.000644683837890625
[rfa agg] iter:  2, weight: tensor([0.0535, 0.0929, 0.0798, 0.1135, 0.0999, 0.1108, 0.1518, 0.1183, 0.1122,
        0.0672])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.8571, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 3.5437, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.04694390296936 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0674, Accuracy: 187/1513 (12.3596%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0397, Accuracy: 425/1513 (28.0899%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.1395, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0512, Accuracy: 339/1129 (30.0266%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0234, Accuracy: 694/1129 (61.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6891, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0739, Accuracy: 124/773 (16.0414%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0407, Accuracy: 383/773 (49.5472%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.9454, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0757, Accuracy: 85/568 (14.9648%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0442, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9084, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0852, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0520, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7412, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0682, Accuracy: 223/946 (23.5729%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0380, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1673, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0667, Accuracy: 252/1657 (15.2082%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0372, Accuracy: 455/1657 (27.4593%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6846, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0595, Accuracy: 290/1030 (28.1553%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0295, Accuracy: 558/1030 (54.1748%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.9936, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0583, Accuracy: 364/1715 (21.2245%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0335, Accuracy: 620/1715 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.0693, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0711, Accuracy: 160/636 (25.1572%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0358, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.9676, Accuracy: 54/10000 (0.5400%)
time spent on training: 211.04156589508057
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 37, 99, 62, 49, 43, 0, 91, 92, 52], weight: tensor([0.1454, 0.1085, 0.0743, 0.0546, 0.0423, 0.0909, 0.1592, 0.0990, 0.1648,
        0.0611])
[rfa agg] iter:  0, prev_obj_val: 66.28587341308594, obj_val: 69.05834197998047, abs dis: 2.7724685668945312
[rfa agg] iter:  0, weight: tensor([0.0978, 0.1733, 0.0931, 0.0428, 0.0257, 0.1994, 0.0879, 0.1439, 0.0829,
        0.0533])
[rfa agg] iter:  1, prev_obj_val: 69.05834197998047, obj_val: 69.03340911865234, abs dis: 0.024932861328125
[rfa agg] iter:  1, weight: tensor([0.0853, 0.1496, 0.1062, 0.0478, 0.0277, 0.2381, 0.0779, 0.1330, 0.0739,
        0.0606])
[rfa agg] iter:  2, prev_obj_val: 69.03340911865234, obj_val: 70.86993408203125, abs dis: 1.8365249633789062
[rfa agg] iter:  2, weight: tensor([0.0841, 0.1460, 0.1066, 0.0473, 0.0275, 0.2489, 0.0768, 0.1298, 0.0729,
        0.0601])
[rfa agg] iter:  3, prev_obj_val: 70.86993408203125, obj_val: 75.12606048583984, abs dis: 4.256126403808594
[rfa agg] iter:  3, weight: tensor([0.0815, 0.1359, 0.1153, 0.0518, 0.0295, 0.2492, 0.0749, 0.1241, 0.0714,
        0.0662])
[rfa agg] iter:  4, prev_obj_val: 75.12606048583984, obj_val: 75.10956573486328, abs dis: 0.0164947509765625
[rfa agg] iter:  4, weight: tensor([0.0792, 0.1221, 0.1347, 0.0651, 0.0354, 0.2193, 0.0737, 0.1155, 0.0707,
        0.0841])
[rfa agg] iter:  5, prev_obj_val: 75.10956573486328, obj_val: 75.10926055908203, abs dis: 0.00030517578125
[rfa agg] iter:  5, weight: tensor([0.0792, 0.1215, 0.1390, 0.0655, 0.0356, 0.2150, 0.0737, 0.1150, 0.0706,
        0.0850])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.8756, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 3.4552, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.42105317115784 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0712, Accuracy: 233/1131 (20.6012%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0356, Accuracy: 363/1131 (32.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3133, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0698, Accuracy: 110/953 (11.5425%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.5164, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0674, Accuracy: 145/938 (15.4584%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0344, Accuracy: 325/938 (34.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.9459, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0787, Accuracy: 218/1190 (18.3193%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0358, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.0515, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0677, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0388, Accuracy: 215/781 (27.5288%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7191, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0590, Accuracy: 258/1130 (22.8319%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.0829, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0860, Accuracy: 44/682 (6.4516%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0418, Accuracy: 269/682 (39.4428%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.1000, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0552, Accuracy: 279/712 (39.1854%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.2983, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0702, Accuracy: 199/807 (24.6592%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0362, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7386, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0528, Accuracy: 224/888 (25.2252%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 436/888 (49.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.4564, Accuracy: 68/10000 (0.6800%)
time spent on training: 199.14399981498718
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 64, 73, 84, 3, 54, 80, 11, 20, 63], weight: tensor([0.1228, 0.1035, 0.1018, 0.1292, 0.0848, 0.1227, 0.0740, 0.0773, 0.0876,
        0.0964])
[rfa agg] iter:  0, prev_obj_val: 36.392738342285156, obj_val: 40.74029541015625, abs dis: 4.347557067871094
[rfa agg] iter:  0, weight: tensor([0.0776, 0.1253, 0.1034, 0.0652, 0.1177, 0.0771, 0.0881, 0.0986, 0.1251,
        0.1220])
[rfa agg] iter:  1, prev_obj_val: 40.74029541015625, obj_val: 40.7260627746582, abs dis: 0.014232635498046875
[rfa agg] iter:  1, weight: tensor([0.0705, 0.1070, 0.0926, 0.0605, 0.1214, 0.0701, 0.1186, 0.1157, 0.1303,
        0.1133])
[rfa agg] iter:  2, prev_obj_val: 40.7260627746582, obj_val: 40.7259521484375, abs dis: 0.000110626220703125
[rfa agg] iter:  2, weight: tensor([0.0701, 0.1057, 0.0916, 0.0601, 0.1211, 0.0697, 0.1213, 0.1173, 0.1308,
        0.1121])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.8403, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 3.2873, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 288.02611684799194 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0710, Accuracy: 239/901 (26.5261%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 416/901 (46.1709%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4855, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0727, Accuracy: 139/818 (16.9927%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0344, Accuracy: 315/818 (38.5086%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.7882, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0525, Accuracy: 320/1275 (25.0980%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 672/1275 (52.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.3079, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0591, Accuracy: 257/1130 (22.7434%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0315, Accuracy: 433/1130 (38.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.2230, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0836, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 204/500 (40.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0007, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0705, Accuracy: 186/1131 (16.4456%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0329, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4216, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 306/708 (43.2203%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 414/708 (58.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4428, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0712, Accuracy: 233/1131 (20.6012%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0351, Accuracy: 362/1131 (32.0071%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2972, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0571, Accuracy: 319/1030 (30.9709%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0296, Accuracy: 568/1030 (55.1456%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.2320, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0672, Accuracy: 314/1427 (22.0042%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0368, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2764, Accuracy: 76/10000 (0.7600%)
time spent on training: 210.05898070335388
[rfa agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 71, 9, 54, 82, 38, 16, 87, 91, 34], weight: tensor([0.0896, 0.0814, 0.1269, 0.1124, 0.0497, 0.1125, 0.0704, 0.1125, 0.1025,
        0.1420])
[rfa agg] iter:  0, prev_obj_val: 43.77549362182617, obj_val: 49.20904541015625, abs dis: 5.433551788330078
[rfa agg] iter:  0, weight: tensor([0.1219, 0.1031, 0.1059, 0.1293, 0.0279, 0.1214, 0.0664, 0.1367, 0.1090,
        0.0784])
[rfa agg] iter:  1, prev_obj_val: 49.20904541015625, obj_val: 51.487884521484375, abs dis: 2.278839111328125
[rfa agg] iter:  1, weight: tensor([0.1299, 0.1504, 0.0918, 0.1092, 0.0364, 0.1061, 0.0896, 0.1132, 0.1015,
        0.0718])
[rfa agg] iter:  2, prev_obj_val: 51.487884521484375, obj_val: 51.48161697387695, abs dis: 0.006267547607421875
[rfa agg] iter:  2, weight: tensor([0.1266, 0.1715, 0.0875, 0.1025, 0.0400, 0.1000, 0.0998, 0.1055, 0.0970,
        0.0698])
[rfa agg] iter:  3, prev_obj_val: 51.48161697387695, obj_val: 51.48149108886719, abs dis: 0.000125885009765625
[rfa agg] iter:  3, weight: tensor([0.1255, 0.1752, 0.0870, 0.1019, 0.0399, 0.0994, 0.1004, 0.1048, 0.0964,
        0.0694])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8813, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 3.1929, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 306.96359062194824 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0614, Accuracy: 434/2227 (19.4881%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0311, Accuracy: 868/2227 (38.9762%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.3454, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 297/708 (41.9492%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 420/708 (59.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9368, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0912, Accuracy: 4/373 (1.0724%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0535, Accuracy: 118/373 (31.6354%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8032, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0865, Accuracy: 29/486 (5.9671%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0491, Accuracy: 220/486 (45.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 11.0699, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0877, Accuracy: 20/440 (4.5455%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0546, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.7625, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0849, Accuracy: 82/603 (13.5987%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0509, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6699, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0686, Accuracy: 267/1418 (18.8293%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0339, Accuracy: 535/1418 (37.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8206, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0635, Accuracy: 235/1089 (21.5794%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0324, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.9900, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0655, Accuracy: 343/1742 (19.6900%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0355, Accuracy: 646/1742 (37.0838%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9514, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0620, Accuracy: 332/1587 (20.9200%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0354, Accuracy: 541/1587 (34.0895%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3887, Accuracy: 74/10000 (0.7400%)
time spent on training: 218.97728490829468
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 16, 98, 30, 49, 88, 70, 59, 93, 27], weight: tensor([0.2087, 0.0663, 0.0349, 0.0455, 0.0412, 0.0565, 0.1329, 0.1020, 0.1632,
        0.1487])
[rfa agg] iter:  0, prev_obj_val: 84.65107727050781, obj_val: 84.4299545288086, abs dis: 0.22112274169921875
[rfa agg] iter:  0, weight: tensor([0.1090, 0.0567, 0.0182, 0.0278, 0.0232, 0.0407, 0.2433, 0.1144, 0.1545,
        0.2121])
[rfa agg] iter:  1, prev_obj_val: 84.4299545288086, obj_val: 84.42845153808594, abs dis: 0.00150299072265625
[rfa agg] iter:  1, weight: tensor([0.1061, 0.0554, 0.0178, 0.0271, 0.0227, 0.0397, 0.2551, 0.1143, 0.1514,
        0.2103])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8822, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 3.2499, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 315.2936613559723 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0641, Accuracy: 280/1657 (16.8980%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0367, Accuracy: 464/1657 (28.0024%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9789, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0517, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.9558, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1502, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1337, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7553, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0603, Accuracy: 214/776 (27.5773%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0282, Accuracy: 442/776 (56.9588%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3667, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0664, Accuracy: 237/1213 (19.5383%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0299, Accuracy: 542/1213 (44.6826%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.7077, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0930, Accuracy: 9/271 (3.3210%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0617, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4009, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0534, Accuracy: 262/690 (37.9710%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0263, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3026, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0823, Accuracy: 88/603 (14.5937%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0505, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4632, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 103/530 (19.4340%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3535, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0548, Accuracy: 329/1030 (31.9417%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 597/1030 (57.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3461, Accuracy: 95/10000 (0.9500%)
time spent on training: 186.94855451583862
[rfa agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 63, 47, 75, 97, 35, 25, 88, 18, 91], weight: tensor([0.2127, 0.1140, 0.0172, 0.0996, 0.1557, 0.0348, 0.0886, 0.0774, 0.0680,
        0.1322])
[rfa agg] iter:  0, prev_obj_val: 57.620513916015625, obj_val: 60.38108444213867, abs dis: 2.760570526123047
[rfa agg] iter:  0, weight: tensor([0.0850, 0.2087, 0.0068, 0.1679, 0.1310, 0.0175, 0.1097, 0.0822, 0.0591,
        0.1321])
[rfa agg] iter:  1, prev_obj_val: 60.38108444213867, obj_val: 61.886634826660156, abs dis: 1.5055503845214844
[rfa agg] iter:  1, weight: tensor([0.0716, 0.1920, 0.0072, 0.1822, 0.1009, 0.0194, 0.1446, 0.1068, 0.0720,
        0.1034])
[rfa agg] iter:  2, prev_obj_val: 61.886634826660156, obj_val: 63.68547058105469, abs dis: 1.7988357543945312
[rfa agg] iter:  2, weight: tensor([0.0688, 0.1738, 0.0075, 0.1744, 0.0940, 0.0205, 0.1644, 0.1218, 0.0793,
        0.0954])
[rfa agg] iter:  3, prev_obj_val: 63.68547058105469, obj_val: 63.67527770996094, abs dis: 0.01019287109375
[rfa agg] iter:  3, weight: tensor([0.0669, 0.1560, 0.0079, 0.1603, 0.0891, 0.0218, 0.1809, 0.1389, 0.0882,
        0.0900])
[rfa agg] iter:  4, prev_obj_val: 63.67527770996094, obj_val: 61.88438415527344, abs dis: 1.7908935546875
[rfa agg] iter:  4, weight: tensor([0.0666, 0.1544, 0.0079, 0.1573, 0.0887, 0.0218, 0.1846, 0.1408, 0.0885,
        0.0893])
[rfa agg] iter:  5, prev_obj_val: 61.88438415527344, obj_val: 63.6812858581543, abs dis: 1.7969017028808594
[rfa agg] iter:  5, weight: tensor([0.0684, 0.1706, 0.0075, 0.1686, 0.0934, 0.0205, 0.1721, 0.1247, 0.0800,
        0.0942])
[rfa agg] iter:  6, prev_obj_val: 63.6812858581543, obj_val: 61.88300323486328, abs dis: 1.7982826232910156
[rfa agg] iter:  6, weight: tensor([0.0668, 0.1557, 0.0079, 0.1592, 0.0890, 0.0218, 0.1825, 0.1392, 0.0882,
        0.0898])
[rfa agg] iter:  7, prev_obj_val: 61.88300323486328, obj_val: 63.68146514892578, abs dis: 1.7984619140625
[rfa agg] iter:  7, weight: tensor([0.0685, 0.1707, 0.0075, 0.1690, 0.0935, 0.0205, 0.1716, 0.1245, 0.0800,
        0.0942])
[rfa agg] iter:  8, prev_obj_val: 63.68146514892578, obj_val: 61.88296890258789, abs dis: 1.7984962463378906
[rfa agg] iter:  8, weight: tensor([0.0668, 0.1557, 0.0079, 0.1593, 0.0890, 0.0218, 0.1824, 0.1392, 0.0882,
        0.0898])
[rfa agg] iter:  9, prev_obj_val: 61.88296890258789, obj_val: 63.68147277832031, abs dis: 1.7985038757324219
[rfa agg] iter:  9, weight: tensor([0.0685, 0.1707, 0.0075, 0.1690, 0.0935, 0.0205, 0.1716, 0.1245, 0.0800,
        0.0942])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8970, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 3.8543, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.8401165008545 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0598, Accuracy: 200/590 (33.8983%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 12.8799, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0838, Accuracy: 23/515 (4.4660%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0558, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.5318, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 176/1013 (17.3741%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 347/1013 (34.2547%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.2047, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0652, Accuracy: 198/599 (33.0551%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 14.4180, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0621, Accuracy: 284/1662 (17.0878%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0356, Accuracy: 524/1662 (31.5283%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8400, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.1041, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0581, Accuracy: 94/312 (30.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1974, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0698, Accuracy: 167/636 (26.2579%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0345, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.1304, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0690, Accuracy: 348/1988 (17.5050%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0378, Accuracy: 604/1988 (30.3823%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7653, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0781, Accuracy: 90/530 (16.9811%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 281/530 (53.0189%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.9730, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0705, Accuracy: 155/1049 (14.7760%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0335, Accuracy: 450/1049 (42.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4934, Accuracy: 93/10000 (0.9300%)
time spent on training: 200.00413393974304
[rfa agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 33, 14, 95, 94, 24, 52, 85, 18, 51], weight: tensor([0.0663, 0.0579, 0.1139, 0.0673, 0.1869, 0.0351, 0.0715, 0.2235, 0.0596,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 80.63533020019531, obj_val: 81.97285461425781, abs dis: 1.3375244140625
[rfa agg] iter:  0, weight: tensor([0.0567, 0.0428, 0.2445, 0.0580, 0.1426, 0.0184, 0.0601, 0.1025, 0.0456,
        0.2290])
[rfa agg] iter:  1, prev_obj_val: 81.97285461425781, obj_val: 85.15744018554688, abs dis: 3.1845855712890625
[rfa agg] iter:  1, weight: tensor([0.0703, 0.0502, 0.2751, 0.0726, 0.1003, 0.0201, 0.0747, 0.0783, 0.0552,
        0.2032])
[rfa agg] iter:  2, prev_obj_val: 85.15744018554688, obj_val: 89.35555267333984, abs dis: 4.198112487792969
[rfa agg] iter:  2, weight: tensor([0.0938, 0.0634, 0.2185, 0.0978, 0.0924, 0.0241, 0.0993, 0.0751, 0.0724,
        0.1633])
[rfa agg] iter:  3, prev_obj_val: 89.35555267333984, obj_val: 89.27406311035156, abs dis: 0.08148956298828125
[rfa agg] iter:  3, weight: tensor([0.1223, 0.0767, 0.1524, 0.1296, 0.0806, 0.0275, 0.1264, 0.0676, 0.0932,
        0.1239])
[rfa agg] iter:  4, prev_obj_val: 89.27406311035156, obj_val: 89.27349090576172, abs dis: 0.00057220458984375
[rfa agg] iter:  4, weight: tensor([0.1257, 0.0773, 0.1472, 0.1330, 0.0796, 0.0274, 0.1280, 0.0668, 0.0943,
        0.1207])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 19.7849, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 12.5965, Accuracy: 1/9950 (0.0101%)
saving model
Done in 292.9812593460083 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0625, Accuracy: 284/896 (31.6964%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6058, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0611, Accuracy: 353/1904 (18.5399%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0329, Accuracy: 655/1904 (34.4013%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5072, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0786, Accuracy: 105/809 (12.9790%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0331, Accuracy: 268/809 (33.1273%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.3851, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0743, Accuracy: 145/677 (21.4180%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 462/677 (68.2422%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 13.7031, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0780, Accuracy: 251/1003 (25.0249%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0391, Accuracy: 385/1003 (38.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1669, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0985, Accuracy: 11/466 (2.3605%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0554, Accuracy: 171/466 (36.6953%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2825, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0665, Accuracy: 128/938 (13.6461%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0354, Accuracy: 329/938 (35.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.1000, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0605, Accuracy: 493/2227 (22.1374%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 956/2227 (42.9277%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.2802, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0990, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0659, Accuracy: 64/311 (20.5788%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1946, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0611, Accuracy: 209/776 (26.9330%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.8392, Accuracy: 78/10000 (0.7800%)
time spent on training: 213.52467250823975
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 46, 50, 90, 86, 76, 73, 60, 96, 75], weight: tensor([0.0895, 0.1903, 0.0808, 0.0677, 0.1002, 0.0466, 0.0937, 0.2225, 0.0311,
        0.0775])
[rfa agg] iter:  0, prev_obj_val: 87.80691528320312, obj_val: 86.00769805908203, abs dis: 1.7992172241210938
[rfa agg] iter:  0, weight: tensor([0.1216, 0.1289, 0.0955, 0.0624, 0.1919, 0.0318, 0.1541, 0.1054, 0.0166,
        0.0919])
[rfa agg] iter:  1, prev_obj_val: 86.00769805908203, obj_val: 87.93861389160156, abs dis: 1.9309158325195312
[rfa agg] iter:  1, weight: tensor([0.1430, 0.0687, 0.1059, 0.0620, 0.2232, 0.0284, 0.1930, 0.0594, 0.0138,
        0.1025])
[rfa agg] iter:  2, prev_obj_val: 87.93861389160156, obj_val: 90.8265151977539, abs dis: 2.8879013061523438
[rfa agg] iter:  2, weight: tensor([0.1646, 0.0556, 0.1268, 0.0711, 0.1736, 0.0304, 0.1920, 0.0493, 0.0140,
        0.1224])
[rfa agg] iter:  3, prev_obj_val: 90.8265151977539, obj_val: 94.98474884033203, abs dis: 4.158233642578125
[rfa agg] iter:  3, weight: tensor([0.1701, 0.0527, 0.1491, 0.0864, 0.1363, 0.0352, 0.1647, 0.0474, 0.0154,
        0.1427])
[rfa agg] iter:  4, prev_obj_val: 94.98474884033203, obj_val: 90.81462860107422, abs dis: 4.1701202392578125
[rfa agg] iter:  4, weight: tensor([0.1568, 0.0527, 0.1623, 0.1107, 0.1160, 0.0435, 0.1376, 0.0480, 0.0181,
        0.1544])
[rfa agg] iter:  5, prev_obj_val: 90.81462860107422, obj_val: 92.73554229736328, abs dis: 1.9209136962890625
[rfa agg] iter:  5, weight: tensor([0.1674, 0.0526, 0.1554, 0.0885, 0.1319, 0.0354, 0.1581, 0.0473, 0.0155,
        0.1479])
[rfa agg] iter:  6, prev_obj_val: 92.73554229736328, obj_val: 92.7327651977539, abs dis: 0.002777099609375
[rfa agg] iter:  6, weight: tensor([0.1638, 0.0522, 0.1607, 0.0978, 0.1229, 0.0387, 0.1473, 0.0472, 0.0166,
        0.1527])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9408, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.1950, Accuracy: 30/9950 (0.3015%)
saving model
Done in 305.12699723243713 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0635, Accuracy: 224/1089 (20.5693%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 485/1089 (44.5363%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 11.1331, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0589, Accuracy: 322/1030 (31.2621%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0295, Accuracy: 507/1030 (49.2233%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0805, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 85/530 (16.0377%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.4208, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0750, Accuracy: 175/715 (24.4755%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0449, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5925, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0878, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0563, Accuracy: 140/440 (31.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8781, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0659, Accuracy: 197/599 (32.8881%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0327, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 14.7343, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0596, Accuracy: 497/2227 (22.3170%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0303, Accuracy: 925/2227 (41.5357%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2216, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 300/896 (33.4821%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5758, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0569, Accuracy: 194/813 (23.8622%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0223, Accuracy: 428/813 (52.6445%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.0458, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0605, Accuracy: 189/1013 (18.6575%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 349/1013 (34.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6032, Accuracy: 73/10000 (0.7300%)
time spent on training: 207.80134510993958
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 91, 18, 23, 49, 95, 60, 89, 53, 14], weight: tensor([0.1164, 0.1101, 0.0567, 0.0765, 0.0470, 0.0641, 0.2381, 0.0958, 0.0869,
        0.1083])
[rfa agg] iter:  0, prev_obj_val: 77.34795379638672, obj_val: 79.14279174804688, abs dis: 1.7948379516601562
[rfa agg] iter:  0, weight: tensor([0.1066, 0.1537, 0.0412, 0.0814, 0.0278, 0.0529, 0.0748, 0.1317, 0.1156,
        0.2143])
[rfa agg] iter:  1, prev_obj_val: 79.14279174804688, obj_val: 83.8674087524414, abs dis: 4.724617004394531
[rfa agg] iter:  1, weight: tensor([0.0779, 0.1069, 0.0541, 0.1139, 0.0342, 0.0732, 0.0564, 0.1524, 0.1718,
        0.1591])
[rfa agg] iter:  2, prev_obj_val: 83.8674087524414, obj_val: 83.83435821533203, abs dis: 0.033050537109375
[rfa agg] iter:  2, weight: tensor([0.0696, 0.0890, 0.0713, 0.1343, 0.0434, 0.1004, 0.0538, 0.1380, 0.1791,
        0.1210])
[rfa agg] iter:  3, prev_obj_val: 83.83435821533203, obj_val: 85.97781372070312, abs dis: 2.1434555053710938
[rfa agg] iter:  3, weight: tensor([0.0687, 0.0876, 0.0717, 0.1363, 0.0434, 0.1023, 0.0534, 0.1362, 0.1811,
        0.1192])
[rfa agg] iter:  4, prev_obj_val: 85.97781372070312, obj_val: 85.97438049316406, abs dis: 0.0034332275390625
[rfa agg] iter:  4, weight: tensor([0.0678, 0.0849, 0.0804, 0.1382, 0.0483, 0.1149, 0.0537, 0.1294, 0.1703,
        0.1123])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 27.2583, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 12.2245, Accuracy: 34/9950 (0.3417%)
saving model
Done in 302.80069732666016 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0647, Accuracy: 239/803 (29.7634%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0370, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4247, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0853, Accuracy: 13/500 (2.6000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0499, Accuracy: 207/500 (41.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.0162, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.1022, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0595, Accuracy: 119/408 (29.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4724, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1289, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1004, Accuracy: 21/197 (10.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.5278, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0611, Accuracy: 467/2227 (20.9699%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0306, Accuracy: 890/2227 (39.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.4796, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0687, Accuracy: 212/807 (26.2701%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0354, Accuracy: 403/807 (49.9380%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5362, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0612, Accuracy: 372/1904 (19.5378%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0329, Accuracy: 648/1904 (34.0336%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3700, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0834, Accuracy: 52/682 (7.6246%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0400, Accuracy: 273/682 (40.0293%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6054, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.1123, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0593, Accuracy: 88/338 (26.0355%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5642, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0868, Accuracy: 36/486 (7.4074%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0487, Accuracy: 227/486 (46.7078%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.3439, Accuracy: 61/10000 (0.6100%)
time spent on training: 196.5142686367035
[rfa agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 82, 36, 79, 60, 20, 46, 80, 12, 30], weight: tensor([0.0961, 0.0599, 0.0489, 0.0236, 0.2666, 0.0966, 0.2280, 0.0817, 0.0405,
        0.0582])
[rfa agg] iter:  0, prev_obj_val: 106.24882507324219, obj_val: 106.61167907714844, abs dis: 0.36285400390625
[rfa agg] iter:  0, weight: tensor([0.1737, 0.0585, 0.0437, 0.0162, 0.1558, 0.1663, 0.1861, 0.1100, 0.0330,
        0.0567])
[rfa agg] iter:  1, prev_obj_val: 106.61167907714844, obj_val: 109.11475372314453, abs dis: 2.5030746459960938
[rfa agg] iter:  1, weight: tensor([0.2286, 0.0600, 0.0437, 0.0152, 0.1063, 0.2079, 0.1219, 0.1262, 0.0321,
        0.0582])
[rfa agg] iter:  2, prev_obj_val: 109.11475372314453, obj_val: 113.08007049560547, abs dis: 3.9653167724609375
[rfa agg] iter:  2, weight: tensor([0.2720, 0.0620, 0.0434, 0.0135, 0.0686, 0.2220, 0.0758, 0.1521, 0.0306,
        0.0599])
[rfa agg] iter:  3, prev_obj_val: 113.08007049560547, obj_val: 113.02999114990234, abs dis: 0.050079345703125
[rfa agg] iter:  3, weight: tensor([0.2212, 0.0792, 0.0536, 0.0152, 0.0625, 0.1899, 0.0678, 0.1978, 0.0363,
        0.0764])
[rfa agg] iter:  4, prev_obj_val: 113.02999114990234, obj_val: 113.0281753540039, abs dis: 0.0018157958984375
[rfa agg] iter:  4, weight: tensor([0.2115, 0.0800, 0.0539, 0.0152, 0.0622, 0.1847, 0.0674, 0.2113, 0.0364,
        0.0774])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 14.3749, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 7.2601, Accuracy: 70/9950 (0.7035%)
saving model
Done in 290.7913751602173 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0682, Accuracy: 220/1372 (16.0350%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 488/1372 (35.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.5273, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0707, Accuracy: 101/953 (10.5981%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8002, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0689, Accuracy: 112/735 (15.2381%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0239, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.8849, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0763, Accuracy: 184/928 (19.8276%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0292, Accuracy: 525/928 (56.5733%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.1901, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0907, Accuracy: 11/271 (4.0590%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0592, Accuracy: 92/271 (33.9483%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.5041, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0995, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0832, Accuracy: 9/186 (4.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5764, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0701, Accuracy: 286/1750 (16.3429%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0396, Accuracy: 630/1750 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.0464, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0529, Accuracy: 381/1552 (24.5490%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0222, Accuracy: 735/1552 (47.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.2205, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0656, Accuracy: 344/1742 (19.7474%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0358, Accuracy: 678/1742 (38.9208%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.4170, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0995, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0559, Accuracy: 145/416 (34.8558%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.5525, Accuracy: 78/10000 (0.7800%)
time spent on training: 216.67355847358704
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 64, 32, 1, 35, 56, 44, 74, 93, 78], weight: tensor([0.1385, 0.0962, 0.0742, 0.0937, 0.0274, 0.0188, 0.1767, 0.1567, 0.1759,
        0.0420])
[rfa agg] iter:  0, prev_obj_val: 72.65665435791016, obj_val: 71.24964904785156, abs dis: 1.4070053100585938
[rfa agg] iter:  0, weight: tensor([0.1873, 0.1693, 0.0772, 0.1472, 0.0139, 0.0081, 0.1160, 0.1410, 0.1147,
        0.0254])
[rfa agg] iter:  1, prev_obj_val: 71.24964904785156, obj_val: 71.24472045898438, abs dis: 0.0049285888671875
[rfa agg] iter:  1, weight: tensor([0.2067, 0.1556, 0.0715, 0.1383, 0.0132, 0.0077, 0.1186, 0.1472, 0.1172,
        0.0240])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 16.1773, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 6.7537, Accuracy: 326/9950 (3.2764%)
saving model
Done in 310.5655176639557 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0647, Accuracy: 239/1213 (19.7032%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0317, Accuracy: 518/1213 (42.7040%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.0894, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0528, Accuracy: 267/690 (38.6957%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0267, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.4203, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0626, Accuracy: 179/813 (22.0172%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0224, Accuracy: 433/813 (53.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 13.8050, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0608, Accuracy: 471/2227 (21.1495%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0302, Accuracy: 940/2227 (42.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1249, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0696, Accuracy: 167/1071 (15.5929%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0334, Accuracy: 467/1071 (43.6041%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.6827, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0736, Accuracy: 278/1581 (17.5838%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0375, Accuracy: 476/1581 (30.1075%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9442, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0575, Accuracy: 263/1129 (23.2950%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0266, Accuracy: 641/1129 (56.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.0023, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0704, Accuracy: 263/1750 (15.0286%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0400, Accuracy: 558/1750 (31.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1804, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0741, Accuracy: 189/928 (20.3664%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0275, Accuracy: 526/928 (56.6810%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.9126, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 172/1013 (16.9793%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 339/1013 (33.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.2526, Accuracy: 78/10000 (0.7800%)
time spent on training: 247.89661860466003
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 25, 53, 60, 55, 28, 37, 44, 1, 14], weight: tensor([0.0977, 0.0556, 0.0655, 0.1794, 0.0863, 0.1273, 0.0909, 0.1410, 0.0747,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 70.13812255859375, obj_val: 71.63645935058594, abs dis: 1.4983367919921875
[rfa agg] iter:  0, weight: tensor([0.1723, 0.0371, 0.0558, 0.0682, 0.1243, 0.1209, 0.1446, 0.0919, 0.0779,
        0.1071])
[rfa agg] iter:  1, prev_obj_val: 71.63645935058594, obj_val: 75.72602844238281, abs dis: 4.089569091796875
[rfa agg] iter:  1, weight: tensor([0.1704, 0.0399, 0.0630, 0.0560, 0.1383, 0.0900, 0.1557, 0.0718, 0.0874,
        0.1275])
[rfa agg] iter:  2, prev_obj_val: 75.72602844238281, obj_val: 75.69232940673828, abs dis: 0.03369903564453125
[rfa agg] iter:  2, weight: tensor([0.1373, 0.0480, 0.0803, 0.0512, 0.1432, 0.0754, 0.1416, 0.0628, 0.1052,
        0.1550])
[rfa agg] iter:  3, prev_obj_val: 75.69232940673828, obj_val: 75.69165802001953, abs dis: 0.00067138671875
[rfa agg] iter:  3, weight: tensor([0.1336, 0.0479, 0.0804, 0.0509, 0.1436, 0.0749, 0.1386, 0.0623, 0.1071,
        0.1606])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 14.4001, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 7.0045, Accuracy: 109/9950 (1.0955%)
saving model
Done in 341.8352129459381 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0844, Accuracy: 11/500 (2.2000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0351, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0884, Accuracy: 50/605 (8.2645%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0451, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.4615, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0813, Accuracy: 209/1190 (17.5630%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0366, Accuracy: 424/1190 (35.6303%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0302, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 93/530 (17.5472%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.1367, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0639, Accuracy: 208/599 (34.7245%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 14.8019, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0621, Accuracy: 261/891 (29.2929%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.9986, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0758, Accuracy: 177/1131 (15.6499%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0352, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.5865, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0988, Accuracy: 1/416 (0.2404%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0520, Accuracy: 151/416 (36.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5986, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0521, Accuracy: 417/1470 (28.3673%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0266, Accuracy: 772/1470 (52.5170%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.1425, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0665, Accuracy: 241/1154 (20.8839%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0290, Accuracy: 431/1154 (37.3484%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 12.1291, Accuracy: 76/10000 (0.7600%)
time spent on training: 200.7871754169464
[rfa agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 2, 84, 18, 95, 7, 87, 78, 22, 57], weight: tensor([0.0589, 0.0713, 0.1402, 0.0625, 0.0706, 0.1050, 0.1333, 0.0490, 0.1732,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 57.88066101074219, obj_val: 62.42998504638672, abs dis: 4.549324035644531
[rfa agg] iter:  0, weight: tensor([0.0584, 0.0957, 0.1156, 0.0701, 0.0950, 0.2019, 0.1294, 0.0406, 0.0925,
        0.1009])
[rfa agg] iter:  1, prev_obj_val: 62.42998504638672, obj_val: 64.2510986328125, abs dis: 1.8211135864257812
[rfa agg] iter:  1, weight: tensor([0.0758, 0.1254, 0.0957, 0.0909, 0.1244, 0.1679, 0.1044, 0.0501, 0.0802,
        0.0851])
[rfa agg] iter:  2, prev_obj_val: 64.2510986328125, obj_val: 64.23919677734375, abs dis: 0.01190185546875
[rfa agg] iter:  2, weight: tensor([0.0841, 0.1375, 0.0889, 0.1006, 0.1364, 0.1469, 0.0962, 0.0542, 0.0758,
        0.0795])
[rfa agg] iter:  3, prev_obj_val: 64.23919677734375, obj_val: 66.29737091064453, abs dis: 2.0581741333007812
[rfa agg] iter:  3, weight: tensor([0.0845, 0.1392, 0.0883, 0.1015, 0.1378, 0.1445, 0.0956, 0.0543, 0.0754,
        0.0789])
[rfa agg] iter:  4, prev_obj_val: 66.29737091064453, obj_val: 68.55567169189453, abs dis: 2.25830078125
[rfa agg] iter:  4, weight: tensor([0.0931, 0.1454, 0.0831, 0.1096, 0.1439, 0.1303, 0.0893, 0.0585, 0.0720,
        0.0748])
[rfa agg] iter:  5, prev_obj_val: 68.55567169189453, obj_val: 68.5497055053711, abs dis: 0.0059661865234375
[rfa agg] iter:  5, weight: tensor([0.1038, 0.1485, 0.0783, 0.1182, 0.1468, 0.1174, 0.0836, 0.0637, 0.0688,
        0.0709])
[rfa agg] iter:  6, prev_obj_val: 68.5497055053711, obj_val: 71.04027557373047, abs dis: 2.490570068359375
[rfa agg] iter:  6, weight: tensor([0.1046, 0.1490, 0.0778, 0.1194, 0.1472, 0.1162, 0.0831, 0.0638, 0.0684,
        0.0705])
[rfa agg] iter:  7, prev_obj_val: 71.04027557373047, obj_val: 71.03630828857422, abs dis: 0.00396728515625
[rfa agg] iter:  7, weight: tensor([0.1170, 0.1468, 0.0745, 0.1262, 0.1450, 0.1072, 0.0791, 0.0701, 0.0663,
        0.0678])
[rfa agg] iter:  8, prev_obj_val: 71.03630828857422, obj_val: 73.76470184326172, abs dis: 2.7283935546875
[rfa agg] iter:  8, weight: tensor([0.1182, 0.1466, 0.0741, 0.1273, 0.1448, 0.1065, 0.0787, 0.0704, 0.0660,
        0.0675])
[rfa agg] iter:  9, prev_obj_val: 73.76470184326172, obj_val: 71.03899383544922, abs dis: 2.7257080078125
[rfa agg] iter:  9, weight: tensor([0.1323, 0.1410, 0.0718, 0.1317, 0.1393, 0.0997, 0.0758, 0.0780, 0.0647,
        0.0657])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0740, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6665, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.1184594631195 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0970, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0802, Accuracy: 12/186 (6.4516%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.0067, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0859, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0506, Accuracy: 141/373 (37.8016%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3185, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0637, Accuracy: 217/1089 (19.9265%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0331, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.6189, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0593, Accuracy: 316/1036 (30.5019%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 640/1036 (61.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.4344, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0673, Accuracy: 322/1427 (22.5648%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0360, Accuracy: 540/1427 (37.8416%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4584, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0556, Accuracy: 383/1953 (19.6109%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0360, Accuracy: 676/1953 (34.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.7887, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0837, Accuracy: 60/682 (8.7977%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0414, Accuracy: 264/682 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.1665, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0688, Accuracy: 218/946 (23.0444%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0383, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5041, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0695, Accuracy: 245/1573 (15.5753%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0385, Accuracy: 494/1573 (31.4050%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.8040, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0609, Accuracy: 262/803 (32.6276%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0359, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6568, Accuracy: 62/10000 (0.6200%)
time spent on training: 222.45825028419495
[rfa agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 98, 59, 19, 34, 83, 80, 43, 40, 58], weight: tensor([0.0185, 0.0370, 0.1082, 0.1029, 0.1417, 0.1940, 0.0677, 0.0940, 0.1562,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 70.02008819580078, obj_val: 71.46353149414062, abs dis: 1.4434432983398438
[rfa agg] iter:  0, weight: tensor([0.0073, 0.0187, 0.1136, 0.1977, 0.1483, 0.0919, 0.0575, 0.1476, 0.1275,
        0.0900])
[rfa agg] iter:  1, prev_obj_val: 71.46353149414062, obj_val: 73.88616180419922, abs dis: 2.4226303100585938
[rfa agg] iter:  1, weight: tensor([0.0073, 0.0190, 0.1066, 0.2198, 0.1233, 0.0801, 0.0615, 0.1751, 0.1074,
        0.1000])
[rfa agg] iter:  2, prev_obj_val: 73.88616180419922, obj_val: 73.86546325683594, abs dis: 0.02069854736328125
[rfa agg] iter:  2, weight: tensor([0.0075, 0.0201, 0.0985, 0.2080, 0.1053, 0.0727, 0.0691, 0.2083, 0.0939,
        0.1167])
[rfa agg] iter:  3, prev_obj_val: 73.86546325683594, obj_val: 75.39277648925781, abs dis: 1.527313232421875
[rfa agg] iter:  3, weight: tensor([0.0074, 0.0199, 0.0968, 0.2057, 0.1040, 0.0721, 0.0687, 0.2155, 0.0929,
        0.1170])
[rfa agg] iter:  4, prev_obj_val: 75.39277648925781, obj_val: 75.38719940185547, abs dis: 0.00557708740234375
[rfa agg] iter:  4, weight: tensor([0.0076, 0.0207, 0.0936, 0.1905, 0.0977, 0.0695, 0.0739, 0.2302, 0.0881,
        0.1282])
[rfa agg] iter:  5, prev_obj_val: 75.38719940185547, obj_val: 73.869873046875, abs dis: 1.5173263549804688
[rfa agg] iter:  5, weight: tensor([0.0076, 0.0207, 0.0929, 0.1877, 0.0973, 0.0692, 0.0738, 0.2344, 0.0877,
        0.1288])
[rfa agg] iter:  6, prev_obj_val: 73.869873046875, obj_val: 75.39085388183594, abs dis: 1.5209808349609375
[rfa agg] iter:  6, weight: tensor([0.0074, 0.0199, 0.0959, 0.2016, 0.1034, 0.0717, 0.0685, 0.2217, 0.0925,
        0.1174])
[rfa agg] iter:  7, prev_obj_val: 75.39085388183594, obj_val: 75.38709259033203, abs dis: 0.00376129150390625
[rfa agg] iter:  7, weight: tensor([0.0076, 0.0207, 0.0934, 0.1896, 0.0976, 0.0694, 0.0738, 0.2317, 0.0880,
        0.1282])
[rfa agg] iter:  8, prev_obj_val: 75.38709259033203, obj_val: 73.86996459960938, abs dis: 1.5171279907226562
[rfa agg] iter:  8, weight: tensor([0.0076, 0.0207, 0.0929, 0.1875, 0.0972, 0.0692, 0.0737, 0.2348, 0.0877,
        0.1288])
[rfa agg] iter:  9, prev_obj_val: 73.86996459960938, obj_val: 75.39083862304688, abs dis: 1.5208740234375
[rfa agg] iter:  9, weight: tensor([0.0074, 0.0199, 0.0959, 0.2015, 0.1034, 0.0717, 0.0685, 0.2218, 0.0924,
        0.1174])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.3886, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 7.4786, Accuracy: 19/9950 (0.1910%)
saving model
Done in 313.4005789756775 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0806, Accuracy: 210/1190 (17.6471%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0369, Accuracy: 427/1190 (35.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9480, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0732, Accuracy: 265/1581 (16.7615%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0386, Accuracy: 444/1581 (28.0835%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5222, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0568, Accuracy: 196/813 (24.1082%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0222, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 13.5385, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0752, Accuracy: 263/1163 (22.6139%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0408, Accuracy: 405/1163 (34.8237%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.7413, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0693, Accuracy: 316/1988 (15.8954%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0379, Accuracy: 573/1988 (28.8229%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9514, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0678, Accuracy: 283/1750 (16.1714%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0395, Accuracy: 618/1750 (35.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3799, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0517, Accuracy: 272/690 (39.4203%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0248, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.2901, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0625, Accuracy: 362/1904 (19.0126%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0345, Accuracy: 624/1904 (32.7731%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6444, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0692, Accuracy: 124/735 (16.8707%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 13.0784, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.1011, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0834, Accuracy: 9/186 (4.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5643, Accuracy: 54/10000 (0.5400%)
time spent on training: 248.41054272651672
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 28, 53, 68, 85, 44, 25, 46, 32, 56], weight: tensor([0.0992, 0.1318, 0.0677, 0.0969, 0.1657, 0.1458, 0.0575, 0.1587, 0.0613,
        0.0155])
[rfa agg] iter:  0, prev_obj_val: 74.38841247558594, obj_val: 75.2940444946289, abs dis: 0.9056320190429688
[rfa agg] iter:  0, weight: tensor([0.1642, 0.1713, 0.0571, 0.1702, 0.1002, 0.1314, 0.0391, 0.1144, 0.0463,
        0.0058])
[rfa agg] iter:  1, prev_obj_val: 75.2940444946289, obj_val: 77.89813995361328, abs dis: 2.604095458984375
[rfa agg] iter:  1, weight: tensor([0.1772, 0.1597, 0.0591, 0.1898, 0.0934, 0.1210, 0.0400, 0.1064, 0.0476,
        0.0058])
[rfa agg] iter:  2, prev_obj_val: 77.89813995361328, obj_val: 79.4202651977539, abs dis: 1.522125244140625
[rfa agg] iter:  2, weight: tensor([0.1916, 0.1386, 0.0664, 0.2095, 0.0861, 0.1083, 0.0438, 0.0970, 0.0527,
        0.0061])
[rfa agg] iter:  3, prev_obj_val: 79.4202651977539, obj_val: 77.88420104980469, abs dis: 1.5360641479492188
[rfa agg] iter:  3, weight: tensor([0.1971, 0.1292, 0.0709, 0.2161, 0.0829, 0.1028, 0.0461, 0.0930, 0.0558,
        0.0062])
[rfa agg] iter:  4, prev_obj_val: 77.88420104980469, obj_val: 79.41898345947266, abs dis: 1.5347824096679688
[rfa agg] iter:  4, weight: tensor([0.1953, 0.1359, 0.0659, 0.2131, 0.0851, 0.1069, 0.0434, 0.0960, 0.0523,
        0.0060])
[rfa agg] iter:  5, prev_obj_val: 79.41898345947266, obj_val: 77.88431549072266, abs dis: 1.53466796875
[rfa agg] iter:  5, weight: tensor([0.1977, 0.1289, 0.0707, 0.2165, 0.0828, 0.1026, 0.0460, 0.0928, 0.0557,
        0.0062])
[rfa agg] iter:  6, prev_obj_val: 77.88431549072266, obj_val: 79.41897583007812, abs dis: 1.5346603393554688
[rfa agg] iter:  6, weight: tensor([0.1954, 0.1359, 0.0659, 0.2132, 0.0851, 0.1068, 0.0434, 0.0960, 0.0523,
        0.0060])
[rfa agg] iter:  7, prev_obj_val: 79.41897583007812, obj_val: 77.88431549072266, abs dis: 1.5346603393554688
[rfa agg] iter:  7, weight: tensor([0.1977, 0.1289, 0.0707, 0.2165, 0.0828, 0.1026, 0.0460, 0.0928, 0.0557,
        0.0062])
[rfa agg] iter:  8, prev_obj_val: 77.88431549072266, obj_val: 79.41897583007812, abs dis: 1.5346603393554688
[rfa agg] iter:  8, weight: tensor([0.1954, 0.1359, 0.0659, 0.2132, 0.0851, 0.1068, 0.0434, 0.0960, 0.0523,
        0.0060])
[rfa agg] iter:  9, prev_obj_val: 79.41897583007812, obj_val: 77.88431549072266, abs dis: 1.5346603393554688
[rfa agg] iter:  9, weight: tensor([0.1977, 0.1289, 0.0707, 0.2165, 0.0828, 0.1026, 0.0460, 0.0928, 0.0557,
        0.0062])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1420, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.0826, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.96489810943604 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1740, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1622, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1397, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0762, Accuracy: 171/774 (22.0930%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0388, Accuracy: 307/774 (39.6641%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8283, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0552, Accuracy: 396/1953 (20.2765%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 698/1953 (35.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5193, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0710, Accuracy: 98/530 (18.4906%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0395, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.9864, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0838, Accuracy: 40/568 (7.0423%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0449, Accuracy: 259/568 (45.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1854, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0677, Accuracy: 178/1402 (12.6961%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0429, Accuracy: 332/1402 (23.6805%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6814, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0704, Accuracy: 301/1581 (19.0386%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0377, Accuracy: 488/1581 (30.8665%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.0577, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0934, Accuracy: 12/408 (2.9412%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 138/408 (33.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6515, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0708, Accuracy: 339/1988 (17.0523%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0382, Accuracy: 557/1988 (28.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7670, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0985, Accuracy: 6/416 (1.4423%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0521, Accuracy: 148/416 (35.5769%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8071, Accuracy: 70/10000 (0.7000%)
time spent on training: 221.1599109172821
[rfa agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 81, 83, 18, 62, 66, 28, 36, 85, 78], weight: tensor([0.0088, 0.0798, 0.2012, 0.0546, 0.0585, 0.1445, 0.1629, 0.0420, 0.2048,
        0.0429])
[rfa agg] iter:  0, prev_obj_val: 86.02894592285156, obj_val: 85.59910583496094, abs dis: 0.429840087890625
[rfa agg] iter:  0, weight: tensor([0.0033, 0.0696, 0.1442, 0.0339, 0.0366, 0.2968, 0.2410, 0.0227, 0.1289,
        0.0230])
[rfa agg] iter:  1, prev_obj_val: 85.59910583496094, obj_val: 86.84095764160156, abs dis: 1.241851806640625
[rfa agg] iter:  1, weight: tensor([0.0031, 0.0659, 0.1354, 0.0320, 0.0346, 0.3320, 0.2341, 0.0214, 0.1198,
        0.0217])
[rfa agg] iter:  2, prev_obj_val: 86.84095764160156, obj_val: 86.83853912353516, abs dis: 0.00241851806640625
[rfa agg] iter:  2, weight: tensor([0.0033, 0.0713, 0.1333, 0.0342, 0.0369, 0.3352, 0.2214, 0.0228, 0.1186,
        0.0231])
[rfa agg] iter:  3, prev_obj_val: 86.83853912353516, obj_val: 88.21897888183594, abs dis: 1.3804397583007812
[rfa agg] iter:  3, weight: tensor([0.0033, 0.0712, 0.1330, 0.0341, 0.0369, 0.3375, 0.2199, 0.0227, 0.1183,
        0.0230])
[rfa agg] iter:  4, prev_obj_val: 88.21897888183594, obj_val: 86.84037780761719, abs dis: 1.37860107421875
[rfa agg] iter:  4, weight: tensor([0.0035, 0.0783, 0.1332, 0.0370, 0.0400, 0.3261, 0.2132, 0.0245, 0.1192,
        0.0249])
[rfa agg] iter:  5, prev_obj_val: 86.84037780761719, obj_val: 88.21875762939453, abs dis: 1.3783798217773438
[rfa agg] iter:  5, weight: tensor([0.0033, 0.0715, 0.1333, 0.0342, 0.0370, 0.3363, 0.2199, 0.0228, 0.1186,
        0.0231])
[rfa agg] iter:  6, prev_obj_val: 88.21875762939453, obj_val: 86.84042358398438, abs dis: 1.3783340454101562
[rfa agg] iter:  6, weight: tensor([0.0035, 0.0784, 0.1332, 0.0371, 0.0401, 0.3258, 0.2133, 0.0246, 0.1192,
        0.0249])
[rfa agg] iter:  7, prev_obj_val: 86.84042358398438, obj_val: 88.21875, abs dis: 1.378326416015625
[rfa agg] iter:  7, weight: tensor([0.0033, 0.0715, 0.1333, 0.0342, 0.0370, 0.3362, 0.2200, 0.0228, 0.1186,
        0.0231])
[rfa agg] iter:  8, prev_obj_val: 88.21875, obj_val: 86.84042358398438, abs dis: 1.378326416015625
[rfa agg] iter:  8, weight: tensor([0.0035, 0.0784, 0.1332, 0.0371, 0.0401, 0.3258, 0.2133, 0.0246, 0.1192,
        0.0249])
[rfa agg] iter:  9, prev_obj_val: 86.84042358398438, obj_val: 88.21875, abs dis: 1.378326416015625
[rfa agg] iter:  9, weight: tensor([0.0033, 0.0715, 0.1333, 0.0342, 0.0370, 0.3362, 0.2200, 0.0228, 0.1186,
        0.0231])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 12.9042, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 10.4540, Accuracy: 1/9950 (0.0101%)
saving model
Done in 314.8572506904602 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0707, Accuracy: 233/1372 (16.9825%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0354, Accuracy: 463/1372 (33.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.3634, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1474, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1391, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3065, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0608, Accuracy: 263/1446 (18.1881%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0378, Accuracy: 442/1446 (30.5671%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1799, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0688, Accuracy: 223/901 (24.7503%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0399, Accuracy: 412/901 (45.7270%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.2470, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0688, Accuracy: 269/1750 (15.3714%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0397, Accuracy: 597/1750 (34.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1355, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0658, Accuracy: 177/1402 (12.6248%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0427, Accuracy: 314/1402 (22.3966%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6589, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0640, Accuracy: 302/1662 (18.1709%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0377, Accuracy: 506/1662 (30.4452%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6454, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0519, Accuracy: 419/1470 (28.5034%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0258, Accuracy: 783/1470 (53.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.2138, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0687, Accuracy: 180/1131 (15.9151%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0329, Accuracy: 469/1131 (41.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.5786, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0750, Accuracy: 180/1154 (15.5979%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0340, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.1993, Accuracy: 68/10000 (0.6800%)
time spent on training: 256.64219403266907
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 47, 26, 4, 44, 66, 94, 22, 38, 15], weight: tensor([0.1104, 0.0108, 0.1164, 0.0725, 0.1409, 0.1129, 0.1338, 0.1183, 0.0910,
        0.0929])
[rfa agg] iter:  0, prev_obj_val: 52.13658142089844, obj_val: 54.144100189208984, abs dis: 2.007518768310547
[rfa agg] iter:  0, weight: tensor([0.1420, 0.0032, 0.1263, 0.0622, 0.0806, 0.1539, 0.0940, 0.1200, 0.1186,
        0.0992])
[rfa agg] iter:  1, prev_obj_val: 54.144100189208984, obj_val: 52.03801727294922, abs dis: 2.1060829162597656
[rfa agg] iter:  1, weight: tensor([0.1389, 0.0034, 0.1219, 0.0677, 0.0785, 0.1486, 0.0908, 0.1160, 0.1312,
        0.1028])
[rfa agg] iter:  2, prev_obj_val: 52.03801727294922, obj_val: 54.14336395263672, abs dis: 2.1053466796875
[rfa agg] iter:  2, weight: tensor([0.1440, 0.0032, 0.1257, 0.0614, 0.0791, 0.1551, 0.0921, 0.1187, 0.1222,
        0.0986])
[rfa agg] iter:  3, prev_obj_val: 54.14336395263672, obj_val: 52.038082122802734, abs dis: 2.1052818298339844
[rfa agg] iter:  3, weight: tensor([0.1390, 0.0034, 0.1218, 0.0677, 0.0785, 0.1486, 0.0908, 0.1159, 0.1316,
        0.1027])
[rfa agg] iter:  4, prev_obj_val: 52.038082122802734, obj_val: 54.14335250854492, abs dis: 2.1052703857421875
[rfa agg] iter:  4, weight: tensor([0.1440, 0.0032, 0.1257, 0.0614, 0.0791, 0.1551, 0.0921, 0.1187, 0.1222,
        0.0986])
[rfa agg] iter:  5, prev_obj_val: 54.14335250854492, obj_val: 52.038082122802734, abs dis: 2.1052703857421875
[rfa agg] iter:  5, weight: tensor([0.1390, 0.0034, 0.1218, 0.0677, 0.0785, 0.1486, 0.0908, 0.1159, 0.1316,
        0.1027])
[rfa agg] iter:  6, prev_obj_val: 52.038082122802734, obj_val: 54.14335632324219, abs dis: 2.105274200439453
[rfa agg] iter:  6, weight: tensor([0.1440, 0.0032, 0.1257, 0.0614, 0.0791, 0.1551, 0.0921, 0.1187, 0.1222,
        0.0986])
[rfa agg] iter:  7, prev_obj_val: 54.14335632324219, obj_val: 52.038082122802734, abs dis: 2.105274200439453
[rfa agg] iter:  7, weight: tensor([0.1390, 0.0034, 0.1218, 0.0677, 0.0785, 0.1486, 0.0908, 0.1159, 0.1316,
        0.1027])
[rfa agg] iter:  8, prev_obj_val: 52.038082122802734, obj_val: 54.14335632324219, abs dis: 2.105274200439453
[rfa agg] iter:  8, weight: tensor([0.1440, 0.0032, 0.1257, 0.0614, 0.0791, 0.1551, 0.0921, 0.1187, 0.1222,
        0.0986])
[rfa agg] iter:  9, prev_obj_val: 54.14335632324219, obj_val: 52.038082122802734, abs dis: 2.105274200439453
[rfa agg] iter:  9, weight: tensor([0.1390, 0.0034, 0.1218, 0.0677, 0.0785, 0.1486, 0.0908, 0.1159, 0.1316,
        0.1027])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 15.5214, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 11.2814, Accuracy: 1/9950 (0.0101%)
saving model
Done in 348.1818346977234 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.1185, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0691, Accuracy: 59/312 (18.9103%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3342, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0685, Accuracy: 247/1573 (15.7025%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0383, Accuracy: 506/1573 (32.1678%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6321, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0680, Accuracy: 187/1131 (16.5340%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0330, Accuracy: 486/1131 (42.9708%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.5718, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0687, Accuracy: 193/1013 (19.0523%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0300, Accuracy: 442/1013 (43.6328%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.7671, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0863, Accuracy: 14/515 (2.7184%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0549, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.7062, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0618, Accuracy: 212/776 (27.3196%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0318, Accuracy: 384/776 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.6491, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0700, Accuracy: 273/1581 (17.2676%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0378, Accuracy: 473/1581 (29.9178%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.7588, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0713, Accuracy: 284/1418 (20.0282%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0361, Accuracy: 513/1418 (36.1777%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8490, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0615, Accuracy: 260/891 (29.1807%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.6940, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0748, Accuracy: 130/636 (20.4403%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6885, Accuracy: 50/10000 (0.5000%)
time spent on training: 224.20210099220276
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 40, 38, 39, 33, 75, 28, 70, 7, 52], weight: tensor([0.0317, 0.1598, 0.1149, 0.1029, 0.0523, 0.0788, 0.1606, 0.1440, 0.0905,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 60.4478645324707, obj_val: 62.37018585205078, abs dis: 1.9223213195800781
[rfa agg] iter:  0, weight: tensor([0.0145, 0.0975, 0.1669, 0.2022, 0.0351, 0.0968, 0.0977, 0.1097, 0.1295,
        0.0501])
[rfa agg] iter:  1, prev_obj_val: 62.37018585205078, obj_val: 63.75273513793945, abs dis: 1.3825492858886719
[rfa agg] iter:  1, weight: tensor([0.0151, 0.0846, 0.1486, 0.2175, 0.0376, 0.1116, 0.0848, 0.0939, 0.1510,
        0.0553])
[rfa agg] iter:  2, prev_obj_val: 63.75273513793945, obj_val: 63.74618911743164, abs dis: 0.0065460205078125
[rfa agg] iter:  2, weight: tensor([0.0158, 0.0807, 0.1359, 0.2112, 0.0399, 0.1227, 0.0808, 0.0885, 0.1651,
        0.0594])
[rfa agg] iter:  3, prev_obj_val: 63.74618911743164, obj_val: 63.74608612060547, abs dis: 0.000102996826171875
[rfa agg] iter:  3, weight: tensor([0.0157, 0.0805, 0.1344, 0.2104, 0.0399, 0.1234, 0.0805, 0.0882, 0.1676,
        0.0594])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.8063, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 8.7202, Accuracy: 13/9950 (0.1307%)
saving model
Done in 318.6661276817322 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0915, Accuracy: 6/271 (2.2140%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0649, Accuracy: 94/271 (34.6863%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4930, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0848, Accuracy: 18/515 (3.4951%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0554, Accuracy: 135/515 (26.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1261, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0692, Accuracy: 295/1418 (20.8039%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0353, Accuracy: 549/1418 (38.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.8491, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 196/861 (22.7642%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0229, Accuracy: 428/861 (49.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.8205, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0770, Accuracy: 111/818 (13.5697%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0350, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.4154, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0676, Accuracy: 252/896 (28.1250%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0364, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4946, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0851, Accuracy: 27/568 (4.7535%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0455, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.3810, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0814, Accuracy: 60/605 (9.9174%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0454, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.5255, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0936, Accuracy: 14/440 (3.1818%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0585, Accuracy: 135/440 (30.6818%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.6207, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0805, Accuracy: 152/715 (21.2587%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0502, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5277, Accuracy: 54/10000 (0.5400%)
time spent on training: 189.90715336799622
[rfa agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 33, 70, 10, 71, 89, 62, 2, 49, 23], weight: tensor([0.0381, 0.0725, 0.1995, 0.1211, 0.1151, 0.1261, 0.0799, 0.0851, 0.0619,
        0.1006])
[rfa agg] iter:  0, prev_obj_val: 51.64257049560547, obj_val: 56.130191802978516, abs dis: 4.487621307373047
[rfa agg] iter:  0, weight: tensor([0.0246, 0.0775, 0.0724, 0.1328, 0.1533, 0.1324, 0.1133, 0.1169, 0.0575,
        0.1193])
[rfa agg] iter:  1, prev_obj_val: 56.130191802978516, obj_val: 56.06511688232422, abs dis: 0.06507492065429688
[rfa agg] iter:  1, weight: tensor([0.0308, 0.0901, 0.0657, 0.1063, 0.1237, 0.1080, 0.1552, 0.1348, 0.0777,
        0.1076])
[rfa agg] iter:  2, prev_obj_val: 56.06511688232422, obj_val: 60.7286376953125, abs dis: 4.663520812988281
[rfa agg] iter:  2, weight: tensor([0.0307, 0.0908, 0.0646, 0.1035, 0.1208, 0.1052, 0.1637, 0.1366, 0.0787,
        0.1053])
[rfa agg] iter:  3, prev_obj_val: 60.7286376953125, obj_val: 60.71359634399414, abs dis: 0.015041351318359375
[rfa agg] iter:  3, weight: tensor([0.0375, 0.0964, 0.0642, 0.0945, 0.1075, 0.0966, 0.1754, 0.1301, 0.1003,
        0.0973])
[rfa agg] iter:  4, prev_obj_val: 60.71359634399414, obj_val: 60.71331787109375, abs dis: 0.000278472900390625
[rfa agg] iter:  4, weight: tensor([0.0377, 0.0968, 0.0637, 0.0935, 0.1063, 0.0956, 0.1792, 0.1286, 0.1024,
        0.0962])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.1108, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 8.7766, Accuracy: 9/9950 (0.0905%)
saving model
Done in 284.7356457710266 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0733, Accuracy: 163/677 (24.0768%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0243, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.5001, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0809, Accuracy: 107/603 (17.7446%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0472, Accuracy: 293/603 (48.5904%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2834, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0601, Accuracy: 216/776 (27.8351%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0306, Accuracy: 377/776 (48.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.6035, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0665, Accuracy: 285/1657 (17.1998%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0389, Accuracy: 439/1657 (26.4937%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.2927, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0659, Accuracy: 217/1154 (18.8042%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0314, Accuracy: 415/1154 (35.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.3559, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0734, Accuracy: 177/719 (24.6175%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0392, Accuracy: 470/719 (65.3686%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.8914, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0657, Accuracy: 356/1742 (20.4363%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0359, Accuracy: 634/1742 (36.3949%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3990, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0606, Accuracy: 266/1645 (16.1702%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0361, Accuracy: 529/1645 (32.1581%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4385, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0719, Accuracy: 277/1581 (17.5206%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0376, Accuracy: 506/1581 (32.0051%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8307, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0625, Accuracy: 322/1440 (22.3611%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0305, Accuracy: 611/1440 (42.4306%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7748, Accuracy: 86/10000 (0.8600%)
time spent on training: 256.4258930683136
[rfa agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 75, 0, 57, 41, 93, 13, 28, 29], weight: tensor([0.0564, 0.0503, 0.0647, 0.1382, 0.0962, 0.0599, 0.1452, 0.1372, 0.1318,
        0.1201])
[rfa agg] iter:  0, prev_obj_val: 64.56018829345703, obj_val: 65.95501708984375, abs dis: 1.3948287963867188
[rfa agg] iter:  0, weight: tensor([0.0408, 0.0331, 0.0573, 0.1301, 0.1234, 0.0467, 0.1114, 0.1310, 0.1480,
        0.1782])
[rfa agg] iter:  1, prev_obj_val: 65.95501708984375, obj_val: 64.49071502685547, abs dis: 1.4643020629882812
[rfa agg] iter:  1, weight: tensor([0.0439, 0.0355, 0.0621, 0.1250, 0.1320, 0.0503, 0.1078, 0.1263, 0.1423,
        0.1748])
[rfa agg] iter:  2, prev_obj_val: 64.49071502685547, obj_val: 65.95381927490234, abs dis: 1.463104248046875
[rfa agg] iter:  2, weight: tensor([0.0404, 0.0328, 0.0567, 0.1278, 0.1274, 0.0462, 0.1096, 0.1295, 0.1471,
        0.1825])
[rfa agg] iter:  3, prev_obj_val: 65.95381927490234, obj_val: 64.49080657958984, abs dis: 1.4630126953125
[rfa agg] iter:  3, weight: tensor([0.0438, 0.0355, 0.0621, 0.1248, 0.1325, 0.0502, 0.1077, 0.1262, 0.1421,
        0.1751])
[rfa agg] iter:  4, prev_obj_val: 64.49080657958984, obj_val: 65.95379638671875, abs dis: 1.4629898071289062
[rfa agg] iter:  4, weight: tensor([0.0404, 0.0328, 0.0567, 0.1278, 0.1275, 0.0462, 0.1096, 0.1295, 0.1471,
        0.1825])
[rfa agg] iter:  5, prev_obj_val: 65.95379638671875, obj_val: 64.49081420898438, abs dis: 1.462982177734375
[rfa agg] iter:  5, weight: tensor([0.0438, 0.0355, 0.0621, 0.1248, 0.1325, 0.0502, 0.1077, 0.1262, 0.1421,
        0.1751])
[rfa agg] iter:  6, prev_obj_val: 64.49081420898438, obj_val: 65.95379638671875, abs dis: 1.462982177734375
[rfa agg] iter:  6, weight: tensor([0.0404, 0.0328, 0.0567, 0.1278, 0.1275, 0.0462, 0.1096, 0.1295, 0.1471,
        0.1825])
[rfa agg] iter:  7, prev_obj_val: 65.95379638671875, obj_val: 64.49081420898438, abs dis: 1.462982177734375
[rfa agg] iter:  7, weight: tensor([0.0438, 0.0355, 0.0621, 0.1248, 0.1325, 0.0502, 0.1077, 0.1262, 0.1421,
        0.1751])
[rfa agg] iter:  8, prev_obj_val: 64.49081420898438, obj_val: 65.95379638671875, abs dis: 1.462982177734375
[rfa agg] iter:  8, weight: tensor([0.0404, 0.0328, 0.0567, 0.1278, 0.1275, 0.0462, 0.1096, 0.1295, 0.1471,
        0.1825])
[rfa agg] iter:  9, prev_obj_val: 65.95379638671875, obj_val: 64.49081420898438, abs dis: 1.462982177734375
[rfa agg] iter:  9, weight: tensor([0.0438, 0.0355, 0.0621, 0.1248, 0.1325, 0.0502, 0.1077, 0.1262, 0.1421,
        0.1751])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.1847, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 9.9202, Accuracy: 2/9950 (0.0201%)
saving model
Done in 350.1590633392334 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0546, Accuracy: 374/1552 (24.0979%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 746/1552 (48.0670%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 12.5012, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0646, Accuracy: 330/1956 (16.8712%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0359, Accuracy: 573/1956 (29.2945%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0556, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0646, Accuracy: 324/1427 (22.7050%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 531/1427 (37.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6030, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0783, Accuracy: 178/928 (19.1810%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0267, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.9767, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0601, Accuracy: 300/1715 (17.4927%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0345, Accuracy: 614/1715 (35.8017%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1404, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0663, Accuracy: 161/1013 (15.8934%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0373, Accuracy: 310/1013 (30.6022%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.7359, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0844, Accuracy: 95/669 (14.2003%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0465, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1959, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0665, Accuracy: 203/1402 (14.4793%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 343/1402 (24.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6663, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0599, Accuracy: 257/1130 (22.7434%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0309, Accuracy: 465/1130 (41.1504%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.9214, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0670, Accuracy: 214/1241 (17.2442%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0417, Accuracy: 391/1241 (31.5068%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.5883, Accuracy: 58/10000 (0.5800%)
time spent on training: 271.7226414680481
[rfa agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [74, 6, 34, 1, 92, 14, 45, 66, 54, 72], weight: tensor([0.1191, 0.1501, 0.1095, 0.0712, 0.1316, 0.0777, 0.0513, 0.1076, 0.0867,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 56.19978332519531, obj_val: 59.93953323364258, abs dis: 3.7397499084472656
[rfa agg] iter:  0, weight: tensor([0.1104, 0.0699, 0.1438, 0.0544, 0.0907, 0.0742, 0.0267, 0.1581, 0.1180,
        0.1538])
[rfa agg] iter:  1, prev_obj_val: 59.93953323364258, obj_val: 63.673458099365234, abs dis: 3.7339248657226562
[rfa agg] iter:  1, weight: tensor([0.0920, 0.0628, 0.1187, 0.0658, 0.0784, 0.0963, 0.0314, 0.1351, 0.1548,
        0.1647])
[rfa agg] iter:  2, prev_obj_val: 63.673458099365234, obj_val: 63.655879974365234, abs dis: 0.017578125
[rfa agg] iter:  2, weight: tensor([0.0843, 0.0605, 0.1045, 0.0770, 0.0736, 0.1182, 0.0364, 0.1180, 0.1773,
        0.1503])
[rfa agg] iter:  3, prev_obj_val: 63.655879974365234, obj_val: 65.84888458251953, abs dis: 2.193004608154297
[rfa agg] iter:  3, weight: tensor([0.0838, 0.0602, 0.1036, 0.0774, 0.0733, 0.1196, 0.0364, 0.1169, 0.1811,
        0.1477])
[rfa agg] iter:  4, prev_obj_val: 65.84888458251953, obj_val: 65.84524536132812, abs dis: 0.00363922119140625
[rfa agg] iter:  4, weight: tensor([0.0812, 0.0597, 0.0988, 0.0839, 0.0718, 0.1319, 0.0395, 0.1110, 0.1831,
        0.1392])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.6732, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 10.0842, Accuracy: 1/9950 (0.0101%)
saving model
Done in 362.149968624115 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0584, Accuracy: 197/813 (24.2312%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0217, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 13.2517, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0507, Accuracy: 418/1470 (28.4354%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 816/1470 (55.5102%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2675, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0612, Accuracy: 311/1662 (18.7124%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0364, Accuracy: 559/1662 (33.6342%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2814, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0659, Accuracy: 207/1213 (17.0651%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0324, Accuracy: 506/1213 (41.7148%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.4284, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0620, Accuracy: 320/1587 (20.1638%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0360, Accuracy: 572/1587 (36.0428%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7270, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0735, Accuracy: 150/1049 (14.2993%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0347, Accuracy: 464/1049 (44.2326%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.8203, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1358, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1234, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9724, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0835, Accuracy: 127/715 (17.7622%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0474, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9583, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0709, Accuracy: 226/901 (25.0832%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0372, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.0996, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0803, Accuracy: 81/605 (13.3884%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0418, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2305, Accuracy: 54/10000 (0.5400%)
time spent on training: 233.8776571750641
[rfa agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 22, 94, 97, 27, 51, 47, 23, 4, 2], weight: tensor([0.0801, 0.1448, 0.1638, 0.1195, 0.1564, 0.1034, 0.0132, 0.0705, 0.0888,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 61.2669792175293, obj_val: 63.613075256347656, abs dis: 2.3460960388183594
[rfa agg] iter:  0, weight: tensor([0.0963, 0.1220, 0.1012, 0.1666, 0.1104, 0.1557, 0.0052, 0.0650, 0.1309,
        0.0468])
[rfa agg] iter:  1, prev_obj_val: 63.613075256347656, obj_val: 66.92355346679688, abs dis: 3.3104782104492188
[rfa agg] iter:  1, weight: tensor([0.1132, 0.1065, 0.0905, 0.1532, 0.0983, 0.1596, 0.0054, 0.0728, 0.1482,
        0.0523])
[rfa agg] iter:  2, prev_obj_val: 66.92355346679688, obj_val: 63.60744094848633, abs dis: 3.316112518310547
[rfa agg] iter:  2, weight: tensor([0.1366, 0.0969, 0.0841, 0.1343, 0.0903, 0.1486, 0.0058, 0.0834, 0.1592,
        0.0607])
[rfa agg] iter:  3, prev_obj_val: 63.60744094848633, obj_val: 65.15548706054688, abs dis: 1.5480461120605469
[rfa agg] iter:  3, weight: tensor([0.1157, 0.1049, 0.0896, 0.1497, 0.0974, 0.1588, 0.0054, 0.0735, 0.1524,
        0.0524])
[rfa agg] iter:  4, prev_obj_val: 65.15548706054688, obj_val: 65.15233612060547, abs dis: 0.00315093994140625
[rfa agg] iter:  4, weight: tensor([0.1250, 0.1008, 0.0867, 0.1422, 0.0936, 0.1549, 0.0056, 0.0780, 0.1569,
        0.0562])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.8977, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 11.7632, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.19201469421387 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0965, Accuracy: 9/416 (2.1635%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0532, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.3312, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 70/781 (8.9629%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0389, Accuracy: 239/781 (30.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.4951, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0667, Accuracy: 261/1657 (15.7514%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0382, Accuracy: 465/1657 (28.0628%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8437, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0544, Accuracy: 293/1275 (22.9804%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0216, Accuracy: 625/1275 (49.0196%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.5023, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0649, Accuracy: 252/1573 (16.0203%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0373, Accuracy: 539/1573 (34.2657%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8271, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0766, Accuracy: 177/928 (19.0733%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0278, Accuracy: 550/928 (59.2672%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.2021, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0635, Accuracy: 235/1154 (20.3640%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0300, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.9373, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 201/861 (23.3449%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.6769, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0698, Accuracy: 289/1581 (18.2796%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0375, Accuracy: 532/1581 (33.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.6049, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0985, Accuracy: 7/466 (1.5021%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0560, Accuracy: 171/466 (36.6953%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.3230, Accuracy: 55/10000 (0.5500%)
time spent on training: 243.39638781547546
[rfa agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 3, 0, 9, 40, 1, 57, 10, 28, 76], weight: tensor([0.0389, 0.0730, 0.1550, 0.1192, 0.1471, 0.0868, 0.1079, 0.0805, 0.1479,
        0.0436])
[rfa agg] iter:  0, prev_obj_val: 63.07784652709961, obj_val: 65.72555541992188, abs dis: 2.6477088928222656
[rfa agg] iter:  0, weight: tensor([0.0225, 0.0866, 0.1081, 0.1804, 0.1155, 0.1115, 0.1291, 0.1030, 0.1154,
        0.0279])
[rfa agg] iter:  1, prev_obj_val: 65.72555541992188, obj_val: 65.7105712890625, abs dis: 0.014984130859375
[rfa agg] iter:  1, weight: tensor([0.0248, 0.1027, 0.0986, 0.1638, 0.1043, 0.1257, 0.1244, 0.1204, 0.1042,
        0.0310])
[rfa agg] iter:  2, prev_obj_val: 65.7105712890625, obj_val: 65.71045684814453, abs dis: 0.00011444091796875
[rfa agg] iter:  2, weight: tensor([0.0247, 0.1035, 0.0982, 0.1622, 0.1039, 0.1272, 0.1235, 0.1220, 0.1038,
        0.0310])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.6051, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 11.3201, Accuracy: 1/9950 (0.0101%)
saving model
Done in 335.66730070114136 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0967, Accuracy: 6/466 (1.2876%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0560, Accuracy: 166/466 (35.6223%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1086, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0661, Accuracy: 186/1513 (12.2935%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0411, Accuracy: 393/1513 (25.9749%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6951, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0713, Accuracy: 199/928 (21.4440%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0270, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.1363, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0603, Accuracy: 341/1440 (23.6806%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0313, Accuracy: 635/1440 (44.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.7628, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0694, Accuracy: 189/719 (26.2865%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0350, Accuracy: 468/719 (65.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.6591, Accuracy: 57/10000 (0.5700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0634, Accuracy: 280/1574 (17.7891%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0328, Accuracy: 535/1574 (33.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6335, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0618, Accuracy: 468/2227 (21.0148%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0313, Accuracy: 901/2227 (40.4580%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.3084, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0772, Accuracy: 83/605 (13.7190%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0412, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.2230, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0657, Accuracy: 150/1013 (14.8075%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0368, Accuracy: 350/1013 (34.5508%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0372, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0603, Accuracy: 291/1628 (17.8747%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0296, Accuracy: 708/1628 (43.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.4251, Accuracy: 113/10000 (1.1300%)
time spent on training: 275.9432370662689
[rfa agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.040607198877239334
[rfa agg] init. name: [76, 8, 1, 29, 41, 17, 60, 2, 14, 5], weight: tensor([0.0385, 0.1249, 0.0766, 0.1189, 0.0594, 0.1299, 0.1839, 0.0499, 0.0836,
        0.1344])
[rfa agg] iter:  0, prev_obj_val: 76.14618682861328, obj_val: 75.89125061035156, abs dis: 0.25493621826171875
[rfa agg] iter:  0, weight: tensor([0.0231, 0.1577, 0.0878, 0.1662, 0.0512, 0.1412, 0.0818, 0.0351, 0.1262,
        0.1297])
[rfa agg] iter:  1, prev_obj_val: 75.89125061035156, obj_val: 75.89095306396484, abs dis: 0.00029754638671875
[rfa agg] iter:  1, weight: tensor([0.0228, 0.1574, 0.0876, 0.1694, 0.0506, 0.1402, 0.0798, 0.0346, 0.1290,
        0.1288])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.9160, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 9.8051, Accuracy: 4/9950 (0.0402%)
saving model
Done in 373.6564745903015 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0580, Accuracy: 301/1129 (26.6608%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0277, Accuracy: 626/1129 (55.4473%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.7545, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0950, Accuracy: 16/271 (5.9041%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0637, Accuracy: 82/271 (30.2583%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3757, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0853, Accuracy: 12/500 (2.4000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.1484, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0714, Accuracy: 107/938 (11.4072%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0368, Accuracy: 327/938 (34.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.8180, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0566, Accuracy: 398/1953 (20.3789%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 690/1953 (35.3303%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7168, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0637, Accuracy: 239/891 (26.8238%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0288, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.7271, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0615, Accuracy: 286/1446 (19.7787%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0374, Accuracy: 462/1446 (31.9502%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6802, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0626, Accuracy: 271/1573 (17.2282%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0378, Accuracy: 504/1573 (32.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4668, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0577, Accuracy: 220/690 (31.8841%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.2772, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0570, Accuracy: 200/813 (24.6002%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0226, Accuracy: 431/813 (53.0135%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 13.2891, Accuracy: 62/10000 (0.6200%)
time spent on training: 238.3444619178772
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 35, 82, 73, 83, 7, 26, 40, 25, 53], weight: tensor([0.1106, 0.0266, 0.0490, 0.0919, 0.1914, 0.0873, 0.1417, 0.1542, 0.0676,
        0.0797])
[rfa agg] iter:  0, prev_obj_val: 71.68651580810547, obj_val: 74.35636138916016, abs dis: 2.6698455810546875
[rfa agg] iter:  0, weight: tensor([0.1854, 0.0133, 0.0333, 0.1577, 0.0841, 0.1187, 0.1285, 0.1103, 0.0638,
        0.1050])
[rfa agg] iter:  1, prev_obj_val: 74.35636138916016, obj_val: 77.25318145751953, abs dis: 2.896820068359375
[rfa agg] iter:  1, weight: tensor([0.1582, 0.0140, 0.0365, 0.1885, 0.0708, 0.1381, 0.1009, 0.0891, 0.0732,
        0.1307])
[rfa agg] iter:  2, prev_obj_val: 77.25318145751953, obj_val: 77.23228454589844, abs dis: 0.02089691162109375
[rfa agg] iter:  2, weight: tensor([0.1308, 0.0148, 0.0403, 0.1924, 0.0650, 0.1490, 0.0883, 0.0795, 0.0832,
        0.1566])
[rfa agg] iter:  3, prev_obj_val: 77.23228454589844, obj_val: 77.23204803466797, abs dis: 0.00023651123046875
[rfa agg] iter:  3, weight: tensor([0.1278, 0.0148, 0.0401, 0.1935, 0.0645, 0.1501, 0.0875, 0.0789, 0.0831,
        0.1597])
[rfa agg] iter:  4, prev_obj_val: 77.23204803466797, obj_val: 79.02584838867188, abs dis: 1.7938003540039062
[rfa agg] iter:  4, weight: tensor([0.1275, 0.0148, 0.0401, 0.1937, 0.0645, 0.1502, 0.0874, 0.0788, 0.0830,
        0.1601])
[rfa agg] iter:  5, prev_obj_val: 79.02584838867188, obj_val: 81.04199981689453, abs dis: 2.0161514282226562
[rfa agg] iter:  5, weight: tensor([0.1190, 0.0154, 0.0428, 0.1849, 0.0628, 0.1520, 0.0834, 0.0758, 0.0899,
        0.1739])
[rfa agg] iter:  6, prev_obj_val: 81.04199981689453, obj_val: 79.02476501464844, abs dis: 2.0172348022460938
[rfa agg] iter:  6, weight: tensor([0.1114, 0.0163, 0.0463, 0.1724, 0.0615, 0.1517, 0.0802, 0.0733, 0.0984,
        0.1884])
[rfa agg] iter:  7, prev_obj_val: 79.02476501464844, obj_val: 81.04037475585938, abs dis: 2.0156097412109375
[rfa agg] iter:  7, weight: tensor([0.1177, 0.0154, 0.0429, 0.1810, 0.0626, 0.1520, 0.0832, 0.0756, 0.0906,
        0.1790])
[rfa agg] iter:  8, prev_obj_val: 81.04037475585938, obj_val: 79.02497863769531, abs dis: 2.0153961181640625
[rfa agg] iter:  8, weight: tensor([0.1113, 0.0163, 0.0463, 0.1718, 0.0614, 0.1516, 0.0802, 0.0733, 0.0984,
        0.1894])
[rfa agg] iter:  9, prev_obj_val: 79.02497863769531, obj_val: 81.04034423828125, abs dis: 2.0153656005859375
[rfa agg] iter:  9, weight: tensor([0.1177, 0.0154, 0.0429, 0.1809, 0.0626, 0.1520, 0.0832, 0.0756, 0.0906,
        0.1792])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.7934, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 7.9217, Accuracy: 36/9950 (0.3618%)
saving model
Done in 330.9392499923706 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0576, Accuracy: 197/590 (33.3898%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0360, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 13.8234, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0625, Accuracy: 210/1071 (19.6078%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0327, Accuracy: 461/1071 (43.0439%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.3688, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1633, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1469, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.8799, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0767, Accuracy: 125/603 (20.7297%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1988, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0846, Accuracy: 78/818 (9.5355%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0352, Accuracy: 351/818 (42.9095%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.4175, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0756, Accuracy: 183/1154 (15.8579%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0303, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.0616, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.1082, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0614, Accuracy: 76/312 (24.3590%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.8916, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0717, Accuracy: 159/735 (21.6327%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0249, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.7464, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0713, Accuracy: 271/1949 (13.9046%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0363, Accuracy: 572/1949 (29.3484%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.3238, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.1002, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0821, Accuracy: 7/186 (3.7634%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2190, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.84767651557922
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 55, 61, 88, 71, 15, 24, 32, 21, 56], weight: tensor([0.0786, 0.1427, 0.0113, 0.0804, 0.1090, 0.1538, 0.0416, 0.0980, 0.2598,
        0.0248])
[rfa agg] iter:  0, prev_obj_val: 76.77626037597656, obj_val: 77.62811279296875, abs dis: 0.8518524169921875
[rfa agg] iter:  0, weight: tensor([0.0792, 0.2206, 0.0048, 0.0854, 0.1679, 0.1635, 0.0239, 0.1374, 0.1056,
        0.0117])
[rfa agg] iter:  1, prev_obj_val: 77.62811279296875, obj_val: 78.35689544677734, abs dis: 0.7287826538085938
[rfa agg] iter:  1, weight: tensor([0.0900, 0.1838, 0.0048, 0.1008, 0.1959, 0.1314, 0.0250, 0.1686, 0.0878,
        0.0118])
[rfa agg] iter:  2, prev_obj_val: 78.35689544677734, obj_val: 79.34854888916016, abs dis: 0.9916534423828125
[rfa agg] iter:  2, weight: tensor([0.0947, 0.1620, 0.0048, 0.1084, 0.2064, 0.1186, 0.0254, 0.1854, 0.0824,
        0.0119])
[rfa agg] iter:  3, prev_obj_val: 79.34854888916016, obj_val: 82.07474517822266, abs dis: 2.7261962890625
[rfa agg] iter:  3, weight: tensor([0.0999, 0.1455, 0.0048, 0.1172, 0.2079, 0.1092, 0.0260, 0.1994, 0.0780,
        0.0120])
[rfa agg] iter:  4, prev_obj_val: 82.07474517822266, obj_val: 80.5723876953125, abs dis: 1.5023574829101562
[rfa agg] iter:  4, weight: tensor([0.1138, 0.1234, 0.0050, 0.1420, 0.1928, 0.0962, 0.0282, 0.2140, 0.0721,
        0.0127])
[rfa agg] iter:  5, prev_obj_val: 80.5723876953125, obj_val: 80.56922149658203, abs dis: 0.00316619873046875
[rfa agg] iter:  5, weight: tensor([0.1073, 0.1303, 0.0049, 0.1300, 0.1982, 0.1001, 0.0268, 0.2163, 0.0738,
        0.0122])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0024, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 6.6163, Accuracy: 90/9950 (0.9045%)
saving model
Done in 298.03562211990356 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0842, Accuracy: 147/715 (20.5594%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0436, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0021, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0777, Accuracy: 42/631 (6.6561%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0456, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8462, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0647, Accuracy: 330/1427 (23.1254%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0366, Accuracy: 552/1427 (38.6826%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8283, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0651, Accuracy: 310/1475 (21.0169%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0340, Accuracy: 608/1475 (41.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.7503, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.1080, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0607, Accuracy: 66/312 (21.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7454, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0866, Accuracy: 49/682 (7.1848%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0430, Accuracy: 241/682 (35.3372%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.5325, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0571, Accuracy: 299/1129 (26.4836%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0264, Accuracy: 644/1129 (57.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.0554, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1574, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1526, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9124, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0581, Accuracy: 289/1030 (28.0583%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0291, Accuracy: 597/1030 (57.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.3292, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0595, Accuracy: 260/1340 (19.4030%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0303, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.5563, Accuracy: 75/10000 (0.7500%)
time spent on training: 222.19901776313782
[rfa agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 48, 34, 65, 24, 80, 37, 61, 91, 77], weight: tensor([0.0810, 0.0715, 0.1617, 0.1671, 0.0354, 0.0773, 0.1279, 0.0096, 0.1167,
        0.1518])
[rfa agg] iter:  0, prev_obj_val: 62.82479476928711, obj_val: 61.39206314086914, abs dis: 1.4327316284179688
[rfa agg] iter:  0, weight: tensor([0.0919, 0.0736, 0.1277, 0.1124, 0.0202, 0.0927, 0.1790, 0.0040, 0.1493,
        0.1492])
[rfa agg] iter:  1, prev_obj_val: 61.39206314086914, obj_val: 62.6825065612793, abs dis: 1.2904434204101562
[rfa agg] iter:  1, weight: tensor([0.0857, 0.0665, 0.1295, 0.1120, 0.0188, 0.0833, 0.1928, 0.0038, 0.1540,
        0.1537])
[rfa agg] iter:  2, prev_obj_val: 62.6825065612793, obj_val: 61.3899040222168, abs dis: 1.2926025390625
[rfa agg] iter:  2, weight: tensor([0.0919, 0.0722, 0.1248, 0.1092, 0.0199, 0.0910, 0.1866, 0.0040, 0.1535,
        0.1471])
[rfa agg] iter:  3, prev_obj_val: 61.3899040222168, obj_val: 62.682594299316406, abs dis: 1.2926902770996094
[rfa agg] iter:  3, weight: tensor([0.0856, 0.0663, 0.1291, 0.1117, 0.0187, 0.0831, 0.1939, 0.0038, 0.1545,
        0.1532])
[rfa agg] iter:  4, prev_obj_val: 62.682594299316406, obj_val: 61.389892578125, abs dis: 1.2927017211914062
[rfa agg] iter:  4, weight: tensor([0.0919, 0.0722, 0.1248, 0.1091, 0.0199, 0.0910, 0.1868, 0.0040, 0.1535,
        0.1470])
[rfa agg] iter:  5, prev_obj_val: 61.389892578125, obj_val: 62.68260192871094, abs dis: 1.2927093505859375
[rfa agg] iter:  5, weight: tensor([0.0856, 0.0663, 0.1291, 0.1117, 0.0187, 0.0831, 0.1939, 0.0038, 0.1545,
        0.1532])
[rfa agg] iter:  6, prev_obj_val: 62.68260192871094, obj_val: 61.389888763427734, abs dis: 1.2927131652832031
[rfa agg] iter:  6, weight: tensor([0.0919, 0.0722, 0.1248, 0.1091, 0.0199, 0.0910, 0.1868, 0.0040, 0.1535,
        0.1470])
[rfa agg] iter:  7, prev_obj_val: 61.389888763427734, obj_val: 62.68260192871094, abs dis: 1.2927131652832031
[rfa agg] iter:  7, weight: tensor([0.0856, 0.0663, 0.1291, 0.1117, 0.0187, 0.0831, 0.1939, 0.0038, 0.1545,
        0.1532])
[rfa agg] iter:  8, prev_obj_val: 62.68260192871094, obj_val: 61.38988494873047, abs dis: 1.2927169799804688
[rfa agg] iter:  8, weight: tensor([0.0919, 0.0722, 0.1248, 0.1091, 0.0199, 0.0910, 0.1868, 0.0040, 0.1535,
        0.1470])
[rfa agg] iter:  9, prev_obj_val: 61.38988494873047, obj_val: 62.682594299316406, abs dis: 1.2927093505859375
[rfa agg] iter:  9, weight: tensor([0.0856, 0.0663, 0.1291, 0.1117, 0.0187, 0.0831, 0.1939, 0.0038, 0.1545,
        0.1532])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.1098, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.6823, Accuracy: 264/9950 (2.6533%)
saving model
Done in 315.76901054382324 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0664, Accuracy: 320/1904 (16.8067%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0343, Accuracy: 616/1904 (32.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4867, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0702, Accuracy: 114/953 (11.9622%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1897, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0762, Accuracy: 224/1190 (18.8235%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0368, Accuracy: 433/1190 (36.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.0888, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0807, Accuracy: 144/715 (20.1399%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0481, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5986, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0706, Accuracy: 175/1131 (15.4730%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0344, Accuracy: 427/1131 (37.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.4483, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0760, Accuracy: 200/901 (22.1976%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0375, Accuracy: 412/901 (45.7270%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.0736, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0663, Accuracy: 274/1657 (16.5359%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0377, Accuracy: 471/1657 (28.4249%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1535, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0799, Accuracy: 130/636 (20.4403%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0358, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.8884, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0769, Accuracy: 252/1003 (25.1246%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0403, Accuracy: 390/1003 (38.8833%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4910, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0617, Accuracy: 203/1154 (17.5910%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0287, Accuracy: 464/1154 (40.2080%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 12.2074, Accuracy: 63/10000 (0.6300%)
time spent on training: 256.67412543296814
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 64, 84, 23, 38, 4, 0, 52, 86, 57], weight: tensor([0.1693, 0.0848, 0.1058, 0.0636, 0.1006, 0.0801, 0.1474, 0.0566, 0.0892,
        0.1026])
[rfa agg] iter:  0, prev_obj_val: 62.06989288330078, obj_val: 64.96084594726562, abs dis: 2.8909530639648438
[rfa agg] iter:  0, weight: tensor([0.0737, 0.1132, 0.1381, 0.0517, 0.1436, 0.0953, 0.0896, 0.0386, 0.1451,
        0.1110])
[rfa agg] iter:  1, prev_obj_val: 64.96084594726562, obj_val: 68.40435028076172, abs dis: 3.4435043334960938
[rfa agg] iter:  1, weight: tensor([0.0643, 0.1355, 0.1190, 0.0596, 0.1303, 0.1088, 0.0755, 0.0445, 0.1656,
        0.0969])
[rfa agg] iter:  2, prev_obj_val: 68.40435028076172, obj_val: 66.52653503417969, abs dis: 1.8778152465820312
[rfa agg] iter:  2, weight: tensor([0.0619, 0.1493, 0.1067, 0.0687, 0.1180, 0.1178, 0.0713, 0.0519, 0.1649,
        0.0897])
[rfa agg] iter:  3, prev_obj_val: 66.52653503417969, obj_val: 68.39630126953125, abs dis: 1.8697662353515625
[rfa agg] iter:  3, weight: tensor([0.0624, 0.1465, 0.1105, 0.0638, 0.1221, 0.1154, 0.0725, 0.0476, 0.1679,
        0.0913])
[rfa agg] iter:  4, prev_obj_val: 68.39630126953125, obj_val: 66.52681732177734, abs dis: 1.8694839477539062
[rfa agg] iter:  4, weight: tensor([0.0617, 0.1509, 0.1061, 0.0687, 0.1173, 0.1185, 0.0711, 0.0518, 0.1650,
        0.0891])
[rfa agg] iter:  5, prev_obj_val: 66.52681732177734, obj_val: 68.3962631225586, abs dis: 1.86944580078125
[rfa agg] iter:  5, weight: tensor([0.0624, 0.1467, 0.1104, 0.0638, 0.1220, 0.1154, 0.0725, 0.0476, 0.1679,
        0.0912])
[rfa agg] iter:  6, prev_obj_val: 68.3962631225586, obj_val: 66.52682495117188, abs dis: 1.8694381713867188
[rfa agg] iter:  6, weight: tensor([0.0617, 0.1509, 0.1061, 0.0687, 0.1173, 0.1185, 0.0711, 0.0518, 0.1650,
        0.0891])
[rfa agg] iter:  7, prev_obj_val: 66.52682495117188, obj_val: 68.39627075195312, abs dis: 1.86944580078125
[rfa agg] iter:  7, weight: tensor([0.0624, 0.1467, 0.1104, 0.0638, 0.1220, 0.1154, 0.0725, 0.0476, 0.1679,
        0.0912])
[rfa agg] iter:  8, prev_obj_val: 68.39627075195312, obj_val: 66.52682495117188, abs dis: 1.86944580078125
[rfa agg] iter:  8, weight: tensor([0.0617, 0.1509, 0.1061, 0.0687, 0.1173, 0.1185, 0.0711, 0.0518, 0.1650,
        0.0891])
[rfa agg] iter:  9, prev_obj_val: 66.52682495117188, obj_val: 68.39627075195312, abs dis: 1.86944580078125
[rfa agg] iter:  9, weight: tensor([0.0624, 0.1467, 0.1104, 0.0638, 0.1220, 0.1154, 0.0725, 0.0476, 0.1679,
        0.0912])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3430, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 7.1115, Accuracy: 94/9950 (0.9447%)
saving model
Done in 348.7363774776459 sec.
Saving all the graphs.
This run has a label: Jun.20_19.29.16. Visdom environment: tiny
