current path: saved_models/model_tiny_Jun.28_18.50.23
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [84, 86, 65, 96, 55, 56, 28, 93, 16, 79].
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 461/1190 (38.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1079, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 374/1003 (37.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.6205, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 368/1475 (24.9492%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0306, Accuracy: 678/1475 (45.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0462, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3425, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0573, Accuracy: 235/1071 (21.9421%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9136, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3125, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 595/1581 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7634, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 389/1742 (22.3307%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 681/1742 (39.0930%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7851, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0659, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7766, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3232, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.69328355789185
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1003, 1475, 311, 1071, 186, 1581, 1742, 708, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6222, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.4719693660736 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 99, 85, 29, 7, 20].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 373/1475 (25.2881%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 650/1475 (44.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9649, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0418, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7903, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 410/1750 (23.4286%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 651/1750 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6570, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3831, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0294, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2167, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0666, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 378/773 (48.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0424, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 461/1988 (23.1891%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 655/1988 (32.9477%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.5090, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 444/1440 (30.8333%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 706/1440 (49.0278%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0578, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 343/891 (38.4961%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9167, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 395/807 (48.9467%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9746, Accuracy: 50/10000 (0.5000%)
time spent on training: 180.38164710998535
[foolsgold agg] training data poison_ratio: 0.07502091661243841  data num: [1475, 631, 1750, 312, 690, 773, 1988, 1440, 891, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.023444036441387005
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6206, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.0653738975525 sec.
Server Epoch:3 choose agents : [76, 59, 8, 85, 95, 14, 4, 70, 94, 11].
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   1, Avg loss: 0.0869, Accuracy: 34/466 (7.2961%)
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.5974, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0542, Accuracy: 296/1089 (27.1809%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0293, Accuracy: 425/1089 (39.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4576, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0609, Accuracy: 217/1513 (14.3424%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3937, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 423/1988 (21.2777%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 670/1988 (33.7022%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2207, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 322/599 (53.7563%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 316/1013 (31.1945%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.4743, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0610, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 408/901 (45.2830%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8566, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 329/1418 (23.2017%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 591/1418 (41.6784%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6215, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6916, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 340/712 (47.7528%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.4197, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.9595844745636
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 1089, 1513, 1988, 599, 1013, 901, 1418, 1662, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3167, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.41353106498718 sec.
Server Epoch:4 choose agents : [21, 65, 32, 76, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 407/1949 (20.8825%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 659/1949 (33.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 9.0732, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 375/1475 (25.4237%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0324, Accuracy: 650/1475 (44.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9702, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0617, Accuracy: 190/735 (25.8503%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 350/735 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7193, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0862, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6187, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 431/891 (48.3726%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 26/312 (8.3333%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0577, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0332, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2749, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 278/636 (43.7107%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2304, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 313/1645 (19.0274%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 588/1645 (35.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9105, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0390, Accuracy: 297/953 (31.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4418, Accuracy: 72/10000 (0.7200%)
time spent on training: 122.29601860046387
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 466, 891, 312, 719, 636, 1645, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3166, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6135, Accuracy: 0/9950 (0.0000%)
saving model
Done in 194.39600205421448 sec.
Server Epoch:5 choose agents : [62, 97, 55, 2, 52, 21, 47, 93, 91, 83].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0697, Accuracy: 134/568 (23.5915%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7909, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 351/1213 (28.9365%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 501/1213 (41.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6196, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 524/1071 (48.9262%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9886, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 322/605 (53.2231%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7808, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 278/636 (43.7107%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0324, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1836, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 386/1949 (19.8050%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2397, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1253, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1100, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 442/1742 (25.3731%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 729/1742 (41.8485%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 9.5258, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0529, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0273, Accuracy: 578/1030 (56.1165%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1924, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 416/1953 (21.3006%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 751/1953 (38.4537%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5881, Accuracy: 114/10000 (1.1400%)
time spent on training: 146.05718064308167
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 1213, 1071, 605, 636, 1949, 134, 1742, 1030, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.64070905 1.         1.
 0.64070905 1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6132, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.92186284065247 sec.
Server Epoch:6 choose agents : [42, 85, 94, 95, 56, 86, 53, 33, 44, 96].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 356/1372 (25.9475%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 494/1372 (36.0058%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8969, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 455/1988 (22.8873%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 636/1988 (31.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8129, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 586/1662 (35.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8923, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6030, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0615, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 413/1003 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.4899, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 283/813 (34.8093%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.4342, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7274, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 387/1750 (22.1143%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 616/1750 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5487, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3472, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.3169960975647
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1988, 1662, 599, 186, 1003, 813, 515, 1750, 311]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3163, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6132, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.75669193267822 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 80, 84, 10, 91].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 507/1071 (47.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8339, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3044, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 62/515 (12.0388%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0544, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6757, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 26/312 (8.3333%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3875, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 603/1418 (42.5247%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4823, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 280/813 (34.4403%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.3143, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   1, Avg loss: 0.0709, Accuracy: 138/682 (20.2346%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3433, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 306/1190 (25.7143%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 465/1190 (39.0756%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0222, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 216/861 (25.0871%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7684, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 312/1030 (30.2913%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 646/1030 (62.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1281, Accuracy: 83/10000 (0.8300%)
time spent on training: 135.57257461547852
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 682, 1190, 861, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3162, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6129, Accuracy: 0/9950 (0.0000%)
saving model
Done in 206.82975816726685 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0561, Accuracy: 365/1475 (24.7458%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.1016, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3815, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 303/1645 (18.4195%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 606/1645 (36.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0298, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0562, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 532/928 (57.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5346, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0523, Accuracy: 326/1089 (29.9357%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0279, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0219, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 434/1440 (30.1389%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 668/1440 (46.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7490, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0320, Accuracy: 677/1904 (35.5567%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6915, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 385/1574 (24.4600%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 683/1574 (43.3926%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0777, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4453, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0537, Accuracy: 54/10000 (0.5400%)
time spent on training: 135.38647985458374
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3160, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6111, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.14968276023865 sec.
Server Epoch:9 choose agents : [38, 85, 61, 13, 88, 99, 52, 77, 37, 93].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 467/1131 (41.2909%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3144, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 447/1988 (22.4849%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 681/1988 (34.2555%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7867, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3047, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 290/1645 (17.6292%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 627/1645 (38.1155%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1419, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8459, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0688, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0301, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9130, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0572, Accuracy: 277/636 (43.5535%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1899, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 315/1340 (23.5075%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 521/1340 (38.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5881, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 420/1129 (37.2011%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 736/1129 (65.1904%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1631, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 703/1742 (40.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6502, Accuracy: 86/10000 (0.8600%)
time spent on training: 168.37679815292358
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 1988, 85, 1645, 603, 773, 636, 1340, 1129, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3159, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6110, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.31337451934814 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 89, 31, 57, 97, 99, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 231/1241 (18.6140%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 387/1241 (31.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0493, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0554, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 455/1154 (39.4281%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9320, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 382/1750 (21.8286%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 663/1750 (37.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6392, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 327/896 (36.4955%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 419/896 (46.7634%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.1666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0831, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0385, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7229, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 293/1154 (25.3899%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0258, Accuracy: 491/1154 (42.5477%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3666, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 371/1213 (30.5853%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 496/1213 (40.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6039, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0682, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 362/773 (46.8305%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9583, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 406/1956 (20.7566%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 633/1956 (32.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2357, Accuracy: 114/10000 (1.1400%)
time spent on training: 185.68272924423218
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 1154, 186, 1750, 896, 460, 1154, 1213, 773, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3158, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6117, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.51783895492554 sec.
Server Epoch:11 choose agents : [25, 79, 30, 6, 93, 12, 88, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 313/690 (45.3623%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.2200, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   1, Avg loss: 0.1020, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3218, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0813, Accuracy: 65/486 (13.3745%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.7159, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 372/1956 (19.0184%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 666/1956 (34.0491%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0823, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 712/1742 (40.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1628, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0879, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4499, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.9773, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.4146, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 435/1587 (27.4102%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 627/1587 (39.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3796, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 321/1013 (31.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.4369, Accuracy: 61/10000 (0.6100%)
time spent on training: 137.10504698753357
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 197, 486, 1956, 1742, 338, 603, 712, 1587, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3157, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6113, Accuracy: 0/9950 (0.0000%)
saving model
Done in 207.4217734336853 sec.
Server Epoch:12 choose agents : [37, 81, 94, 32, 34, 87, 63, 99, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 432/1129 (38.2640%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 719/1129 (63.6847%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8250, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 229/774 (29.5866%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 295/774 (38.1137%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.0348, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 337/1662 (20.2768%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8052, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 192/735 (26.1224%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1160, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 383/1427 (26.8395%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 608/1427 (42.6069%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.8487, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   1, Avg loss: 0.0590, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 383/1131 (33.8638%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 460/888 (51.8018%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0759, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   2, Avg loss: 0.0303, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9843, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 534/1470 (36.3265%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 810/1470 (55.1020%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2764, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 351/1013 (34.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6940, Accuracy: 67/10000 (0.6700%)
time spent on training: 147.27304887771606
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 774, 1662, 735, 1427, 1131, 888, 773, 1470, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3155, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6072, Accuracy: 0/9950 (0.0000%)
saving model
Done in 216.0778682231903 sec.
Server Epoch:13 choose agents : [36, 76, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0882, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0564, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.4469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 152/818 (18.5819%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.8988, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0555, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0314, Accuracy: 470/1154 (40.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8038, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9721, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 349/1574 (22.1728%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 659/1574 (41.8679%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2854, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 495/1049 (47.1878%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4238, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1244, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1074, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3887, Accuracy: 50/10000 (0.5000%)
time spent on training: 124.56368565559387
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 466, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3155, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 195.436283826828 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 83, 61, 84, 99].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 331/1418 (23.3427%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 556/1418 (39.2102%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7211, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0565, Accuracy: 381/1475 (25.8305%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 644/1475 (43.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9066, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 353/1402 (25.1783%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3117, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8236, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0590, Accuracy: 379/1427 (26.5592%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0161, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 143/818 (17.4817%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1068, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 402/1953 (20.5837%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 738/1953 (37.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8778, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3045, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 309/1190 (25.9664%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 442/1190 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0596, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   1, Avg loss: 0.0647, Accuracy: 184/773 (23.8034%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 380/773 (49.1591%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9259, Accuracy: 50/10000 (0.5000%)
time spent on training: 180.21299195289612
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1475, 1402, 568, 1427, 818, 1953, 85, 1190, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3153, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6050, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.07356357574463 sec.
Server Epoch:15 choose agents : [70, 63, 84, 79, 26, 42, 18, 66, 39, 95].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 346/1418 (24.4006%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5004, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 261/888 (29.3919%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1456, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 313/1190 (26.3025%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 472/1190 (39.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0889, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   1, Avg loss: 0.1000, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   2, Avg loss: 0.0864, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3226, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 324/1446 (22.4066%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 487/1446 (33.6791%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5342, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 505/1372 (36.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8886, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0812, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 276/1402 (19.6862%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 418/1402 (29.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2710, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 497/1013 (49.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5177, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   1, Avg loss: 0.0533, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6265, Accuracy: 50/10000 (0.5000%)
time spent on training: 137.87664031982422
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 888, 1190, 197, 1446, 1372, 530, 1402, 1013, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3152, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6052, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.44740200042725 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 80, 6, 64, 96, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3900, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 509/1470 (34.6259%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 848/1470 (57.6871%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0967, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 150/818 (18.3374%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 334/818 (40.8313%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9479, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 397/1402 (28.3167%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3084, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   1, Avg loss: 0.0710, Accuracy: 140/682 (20.5279%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3707, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 398/1956 (20.3476%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 621/1956 (31.7485%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0826, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 327/953 (34.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4932, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0523, Accuracy: 317/1089 (29.1093%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0004, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 62/515 (12.0388%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7502, Accuracy: 49/10000 (0.4900%)
time spent on training: 163.28339552879333
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 682, 1956, 953, 311, 1089, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3151, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.21520376205444 sec.
Server Epoch:17 choose agents : [36, 29, 28, 81, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0880, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.4951, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 406/1440 (28.1944%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 648/1440 (45.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8404, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 361/1581 (22.8336%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 621/1581 (39.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5811, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   1, Avg loss: 0.0684, Accuracy: 230/774 (29.7158%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   2, Avg loss: 0.0383, Accuracy: 276/774 (35.6589%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.2758, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 235/1071 (21.9421%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6021, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 263/888 (29.6171%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0468, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0770, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7207, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0576, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.8767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 377/1628 (23.1572%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 765/1628 (46.9902%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1285, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0629, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 324/946 (34.2495%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0460, Accuracy: 62/10000 (0.6200%)
time spent on training: 185.01433396339417
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 774, 1071, 888, 515, 715, 1628, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3149, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6025, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.61927604675293 sec.
Server Epoch:18 choose agents : [77, 90, 3, 24, 2, 8, 79, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7242, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0581, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0306, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.6183, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3918, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9176, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 238/1513 (15.7303%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 459/1513 (30.3371%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2104, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 12/197 (6.0914%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   2, Avg loss: 0.0856, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3203, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 498/1049 (47.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6118, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0665, Accuracy: 169/938 (18.0171%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 315/938 (33.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3946, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 670/1440 (46.5278%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.8051, Accuracy: 69/10000 (0.6900%)
time spent on training: 170.40447068214417
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 677, 781, 312, 605, 1513, 197, 1049, 938, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3148, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6009, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.09678673744202 sec.
Server Epoch:19 choose agents : [7, 87, 36, 17, 90, 93, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1314, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 401/1131 (35.4553%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8412, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0567, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 402/1574 (25.5400%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.0965, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 466/677 (68.8331%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0918, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6657, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 396/1949 (20.3181%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 628/1949 (32.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4799, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 585/2227 (26.2685%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1029/2227 (46.2057%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5526, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/712 (49.2978%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5802, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/1154 (42.4610%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7242, Accuracy: 50/10000 (0.5000%)
time spent on training: 182.47567415237427
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 1131, 408, 1574, 677, 1742, 1949, 2227, 712, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3147, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.5992, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.96612286567688 sec.
Server Epoch:20 choose agents : [76, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0857, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0508, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.5981, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5492, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 507/1071 (47.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6529, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0625, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 180/953 (18.8877%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 345/953 (36.2015%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5000, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 145/809 (17.9234%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 351/809 (43.3869%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5481, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 167/818 (20.4156%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0317, Accuracy: 331/818 (40.4645%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2653, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.4735, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 333/1089 (30.5785%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0341, Accuracy: 445/1089 (40.8632%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5121, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 198/861 (22.9965%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 443/861 (51.4518%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8510, Accuracy: 50/10000 (0.5000%)
time spent on training: 168.8738932609558
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3147, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.5986, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.4737114906311 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 77, 99, 74, 94, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0562, Accuracy: 464/1657 (28.0024%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0301, Accuracy: 796/1657 (48.0386%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0257, Accuracy: 837/1657 (50.5130%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0250, Accuracy: 853/1657 (51.4786%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0247, Accuracy: 867/1657 (52.3235%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0242, Accuracy: 873/1657 (52.6856%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0239, Accuracy: 879/1657 (53.0477%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0235, Accuracy: 890/1657 (53.7115%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0235, Accuracy: 902/1657 (54.4357%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0237, Accuracy: 876/1657 (52.8666%), train_poison_data_count: 520
Global model norm: 112.05520577208807.
Norm before scaling: 112.02931047832973. Distance: 1.2397162368863177
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3933, Accuracy: 63/10000 (0.6300%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.1899, Accuracy: 9888/9950 (99.3769%)
Scaling by  100
Scaled Norm after poisoning: 164.89871417782493, distance: 123.97162131159293
Total norm for 1 adversaries is: 164.89871417782493. distance: 123.97162131159293
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 379/1574 (24.0788%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 673/1574 (42.7573%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1364, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 328/1446 (22.6833%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 509/1446 (35.2006%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4547, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1261, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1111, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 563/1340 (42.0149%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7165, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   1, Avg loss: 0.0671, Accuracy: 177/773 (22.8978%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 392/773 (50.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2728, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 499/1552 (32.1521%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 756/1552 (48.7113%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.5537, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 320/1662 (19.2539%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 596/1662 (35.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7922, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 388/1475 (26.3051%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 688/1475 (46.6441%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1710, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 504/1470 (34.2857%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 825/1470 (56.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.4770, Accuracy: 67/10000 (0.6700%)
time spent on training: 284.13310647010803
[foolsgold agg] training data poison_ratio: 0.12665290835435297  data num: [1657, 1574, 1446, 134, 1340, 773, 1552, 1662, 1475, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0395790338607353
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3145, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5931, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.76008915901184 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 75, 2, 0, 8, 77, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 349/712 (49.0169%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5553, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 547/1470 (37.2109%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 845/1470 (57.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9835, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0806, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 157/440 (35.6818%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0065, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 246/776 (31.7010%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.8757, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7772, Accuracy: 53/10000 (0.5300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 376/1657 (22.6916%)
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 517/1657 (31.2010%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8640, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 242/1513 (15.9947%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 483/1513 (31.9233%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3678, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 320/1340 (23.8806%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.7644, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 472/1130 (41.7699%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6018, Accuracy: 53/10000 (0.5300%)
time spent on training: 198.38173627853394
[foolsgold agg] training data poison_ratio: 0.16288213899537993  data num: [712, 1470, 440, 530, 776, 605, 1657, 1513, 1340, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.05090066843605623
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3144, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5931, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.62723422050476 sec.
Server Epoch:23 choose agents : [20, 9, 53, 95, 2, 87, 22, 76, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0607, Accuracy: 226/807 (28.0050%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0342, Accuracy: 397/807 (49.1945%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0274, Accuracy: 475/807 (58.8600%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0246, Accuracy: 522/807 (64.6840%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0243, Accuracy: 517/807 (64.0644%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0221, Accuracy: 526/807 (65.1797%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0215, Accuracy: 538/807 (66.6667%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0207, Accuracy: 533/807 (66.0471%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0206, Accuracy: 534/807 (66.1710%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0214, Accuracy: 528/807 (65.4275%), train_poison_data_count: 260
Global model norm: 112.05510554940145.
Norm before scaling: 112.04430276122923. Distance: 0.8687150234618789
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1469, Accuracy: 57/10000 (0.5700%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.4758, Accuracy: 9572/9950 (96.2010%)
Scaling by  100
Scaled Norm after poisoning: 140.66096067983824, distance: 86.8715039764191
Total norm for 1 adversaries is: 140.66096067983824. distance: 86.8715039764191
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 363/1275 (28.4706%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 665/1275 (52.1569%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.2235, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 284/813 (34.9323%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 456/813 (56.0886%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.0572, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7598, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 437/1131 (38.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 544/1470 (37.0068%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 844/1470 (57.4150%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.0753, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.6079, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5571, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 394/1628 (24.2015%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 835/1628 (51.2899%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.1848, Accuracy: 125/10000 (1.2500%)
time spent on training: 248.51519775390625
[foolsgold agg] training data poison_ratio: 0.08428198433420366  data num: [807, 1275, 813, 599, 605, 1131, 1470, 466, 781, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.02633812010443864
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3143, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5902, Accuracy: 0/9950 (0.0000%)
saving model
Done in 319.4253466129303 sec.
Server Epoch:24 choose agents : [63, 82, 85, 83, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.3820, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5823, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 450/1988 (22.6358%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 692/1988 (34.8089%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7914, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 733/1953 (37.5320%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5439, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 228/1013 (22.5074%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 332/1013 (32.7739%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6745, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0632, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 437/1163 (37.5752%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6935, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 111/781 (14.2125%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9036, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 347/712 (48.7360%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 501/1049 (47.7598%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5469, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 146/818 (17.8484%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1532, Accuracy: 66/10000 (0.6600%)
time spent on training: 197.79803609848022
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 500, 1988, 1953, 1013, 1163, 781, 712, 1049, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3142, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5904, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.2261211872101 sec.
Server Epoch:25 choose agents : [15, 70, 45, 27, 54, 88, 16, 95, 32, 3].
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0298, Accuracy: 406/1154 (35.1820%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 354/1418 (24.9647%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0323, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0115, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0681, Accuracy: 197/669 (29.4469%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 440/1587 (27.7253%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 619/1587 (39.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2513, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 495/1130 (43.8053%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0753, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8979, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0652, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0345, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8489, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6563, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0605, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 334/735 (45.4422%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9701, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 234/781 (29.9616%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.5826, Accuracy: 69/10000 (0.6900%)
time spent on training: 122.49975824356079
[foolsgold agg] training data poison_ratio: 0.0  data num: [1154, 1418, 669, 1587, 1130, 603, 708, 599, 735, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3141, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5874, Accuracy: 0/9950 (0.0000%)
saving model
Done in 190.07656741142273 sec.
Server Epoch:26 choose agents : [16, 82, 49, 81, 57, 74, 75, 46, 55, 43].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 269/708 (37.9944%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7402, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.5954, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 28/440 (6.3636%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4985, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   1, Avg loss: 0.0687, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   2, Avg loss: 0.0357, Accuracy: 283/774 (36.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.1807, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0539, Accuracy: 299/1154 (25.9099%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 523/1154 (45.3206%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.4808, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 514/1552 (33.1186%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.5332, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0654, Accuracy: 244/776 (31.4433%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8625, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 428/1904 (22.4790%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 700/1904 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.1211, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 242/1071 (22.5957%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 541/1071 (50.5135%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6802, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.9705, Accuracy: 51/10000 (0.5100%)
time spent on training: 126.49622130393982
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 500, 440, 774, 1154, 1552, 776, 1904, 1071, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3140, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5874, Accuracy: 0/9950 (0.0000%)
saving model
Done in 196.80983304977417 sec.
Server Epoch:27 choose agents : [80, 8, 51, 85, 26, 14, 96, 99, 43, 16].
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 140/682 (20.5279%)
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 232/682 (34.0176%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.2373, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 234/1513 (15.4660%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 494/1513 (32.6504%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4664, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 234/1049 (22.3070%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 504/1049 (48.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3973, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 451/1988 (22.6861%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 674/1988 (33.9034%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8872, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 337/1446 (23.3057%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 523/1446 (36.1687%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3697, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 382/1013 (37.7098%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.7613, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3439, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0651, Accuracy: 179/773 (23.1565%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0332, Accuracy: 417/773 (53.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.2872, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.9499, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   1, Avg loss: 0.0630, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.9895, Accuracy: 62/10000 (0.6200%)
time spent on training: 135.35503387451172
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 1513, 1049, 1988, 1446, 1013, 311, 773, 946, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3140, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5876, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.1834647655487 sec.
Server Epoch:28 choose agents : [55, 21, 93, 68, 49, 92, 86, 77, 7, 84].
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6953, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 399/1949 (20.4720%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 607/1949 (31.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2699, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 416/1742 (23.8806%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 687/1742 (39.4374%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9890, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 372/1163 (31.9862%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 429/1163 (36.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.8301, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5209, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 450/1715 (26.2391%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 706/1715 (41.1662%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4638, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   1, Avg loss: 0.0637, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 359/1003 (35.7926%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.7704, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 342/1340 (25.5224%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 540/1340 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5277, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   2, Avg loss: 0.0269, Accuracy: 420/891 (47.1380%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1662, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 475/1190 (39.9160%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9039, Accuracy: 61/10000 (0.6100%)
time spent on training: 153.52815198898315
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 1949, 1742, 1163, 440, 1715, 1003, 1340, 891, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3138, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5880, Accuracy: 0/9950 (0.0000%)
saving model
Done in 220.23236083984375 sec.
Server Epoch:29 choose agents : [20, 12, 59, 54, 88, 96, 63, 66, 61, 58].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 354/807 (43.8662%)
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4495, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 310/1089 (28.4665%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 431/1089 (39.5776%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.4441, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0298, Accuracy: 453/1130 (40.0885%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4511, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0756, Accuracy: 137/603 (22.7197%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.8465, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7953, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 395/1402 (28.1740%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.2460, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3045, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 392/803 (48.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.1141, Accuracy: 51/10000 (0.5100%)
time spent on training: 135.3784351348877
[foolsgold agg] training data poison_ratio: 0.10823497854077253  data num: [807, 338, 1089, 1130, 603, 311, 888, 1402, 85, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.033823430793991416
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3138, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5889, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.39862728118896 sec.
Server Epoch:30 choose agents : [70, 49, 92, 67, 44, 24, 1, 14, 90, 0].
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 364/1418 (25.6700%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 643/1418 (45.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8773, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.4988, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 464/1715 (27.0554%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 728/1715 (42.4490%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4286, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 56/426 (13.1455%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 417/1750 (23.8286%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 670/1750 (38.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6110, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3861, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8216, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6664, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1125, Accuracy: 53/10000 (0.5300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 375/1657 (22.6313%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 526/1657 (31.7441%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8892, Accuracy: 60/10000 (0.6000%)
time spent on training: 154.6682834625244
[foolsgold agg] training data poison_ratio: 0.16031346749226005  data num: [1418, 440, 1715, 426, 1750, 312, 928, 1013, 677, 1657]
[foolsgold agg] considering poison per batch poison_fraction: 0.05009795859133127
[foolsgold agg] wv: [1.         0.99380348 1.         1.         1.         0.99380348
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3137, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5893, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.5715479850769 sec.
Server Epoch:31 choose agents : [70, 30, 32, 95, 1, 61, 22, 99, 68, 97].
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 342/1418 (24.1185%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 648/1418 (45.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5088, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 68/486 (13.9918%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7507, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9316, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0514, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6875, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 549/928 (59.1595%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5431, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1270, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1150, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3040, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 561/1470 (38.1633%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 801/1470 (54.4898%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0019, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   1, Avg loss: 0.0676, Accuracy: 178/773 (23.0272%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   2, Avg loss: 0.0312, Accuracy: 373/773 (48.2536%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.0188, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   1, Avg loss: 0.0624, Accuracy: 363/1163 (31.2124%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 450/1163 (38.6930%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.9225, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0530, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 469/1213 (38.6645%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6194, Accuracy: 84/10000 (0.8400%)
time spent on training: 125.5402467250824
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 486, 735, 599, 928, 85, 1470, 773, 1163, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5860, Accuracy: 0/9950 (0.0000%)
saving model
Done in 193.9473955631256 sec.
Server Epoch:32 choose agents : [31, 27, 46, 19, 20, 85, 9, 91, 81, 59].
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0399, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7329, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 443/1587 (27.9143%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 609/1587 (38.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.0390, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 421/1904 (22.1113%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 676/1904 (35.5042%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7697, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 396/1036 (38.2239%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 673/1036 (64.9614%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.3096, Accuracy: 52/10000 (0.5200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 348/807 (43.1227%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.6413, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0529, Accuracy: 491/1988 (24.6982%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9810, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 346/1275 (27.1373%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 690/1275 (54.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.5644, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 340/1030 (33.0097%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   2, Avg loss: 0.0253, Accuracy: 631/1030 (61.2621%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4276, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   1, Avg loss: 0.0666, Accuracy: 248/774 (32.0413%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   2, Avg loss: 0.0381, Accuracy: 277/774 (35.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2528, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   1, Avg loss: 0.0535, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 458/1089 (42.0569%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.4255, Accuracy: 73/10000 (0.7300%)
time spent on training: 165.97691106796265
[foolsgold agg] training data poison_ratio: 0.06753138075313808  data num: [460, 1587, 1904, 1036, 807, 1988, 1275, 1030, 774, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.02110355648535565
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3136, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.3046054840088 sec.
Server Epoch:33 choose agents : [49, 13, 80, 70, 48, 78, 56, 37, 83, 46].
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 28/440 (6.3636%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4969, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 327/1645 (19.8784%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9588, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.3201, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 345/1418 (24.3300%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5728, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 98/631 (15.5309%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8370, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   1, Avg loss: 0.0839, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 72/186 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 395/1129 (34.9867%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 702/1129 (62.1789%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3211, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 446/1953 (22.8367%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 749/1953 (38.3513%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0169, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 684/1904 (35.9244%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7738, Accuracy: 113/10000 (1.1300%)
time spent on training: 140.71525597572327
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1645, 682, 1418, 631, 416, 186, 1129, 1953, 1904]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3134, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5867, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.32896065711975 sec.
Server Epoch:34 choose agents : [60, 55, 12, 50, 72, 14, 25, 49, 31, 77].
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 609/2227 (27.3462%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1028/2227 (46.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3820, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 276/1071 (25.7703%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7537, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0495, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 156/809 (19.2831%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 323/809 (39.9258%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.2874, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 244/1241 (19.6616%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 410/1241 (33.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3948, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 322/1013 (31.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.8365, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   2, Avg loss: 0.0289, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.5481, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4923, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 55/460 (11.9565%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   2, Avg loss: 0.0386, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.7657, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 326/1340 (24.3284%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 547/1340 (40.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0209, Accuracy: 65/10000 (0.6500%)
time spent on training: 138.06039690971375
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1071, 338, 809, 1241, 1013, 690, 440, 460, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3133, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 206.41646027565002 sec.
Server Epoch:35 choose agents : [56, 59, 12, 2, 67, 49, 72, 34, 13, 42].
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0589, Accuracy: 307/1089 (28.1910%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1322, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4452, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5649, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0478, Accuracy: 153/440 (34.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5019, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 263/1241 (21.1926%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 456/1241 (36.7446%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3007, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 386/1427 (27.0498%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 573/1427 (40.1542%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.9404, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 610/1645 (37.0821%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7243, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 362/1372 (26.3848%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 517/1372 (37.6822%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6880, Accuracy: 62/10000 (0.6200%)
time spent on training: 132.05123662948608
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 1089, 338, 605, 426, 440, 1241, 1427, 1645, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3132, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 199.53754806518555 sec.
Server Epoch:36 choose agents : [7, 12, 61, 44, 77, 43, 52, 34, 92, 71].
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 433/891 (48.5971%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0214, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0865, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0485, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4344, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3042, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 388/1750 (22.1714%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 664/1750 (37.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.3904, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 321/1340 (23.9552%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 544/1340 (40.5970%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9085, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 327/946 (34.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0149, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.2050, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 378/1427 (26.4891%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0340, Accuracy: 605/1427 (42.3966%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9949, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 489/1715 (28.5131%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 720/1715 (41.9825%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5017, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 157/818 (19.1932%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 357/818 (43.6430%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9170, Accuracy: 63/10000 (0.6300%)
time spent on training: 147.5353808403015
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 338, 85, 1750, 1340, 946, 636, 1427, 1715, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3131, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.206303358078 sec.
Server Epoch:37 choose agents : [11, 33, 59, 95, 52, 25, 78, 26, 47, 1].
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0537, Accuracy: 342/712 (48.0337%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.8361, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0522, Accuracy: 117/515 (22.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7545, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 308/1089 (28.2828%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0306, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3507, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3405, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.4641, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 30/416 (7.2115%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.5387, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   1, Avg loss: 0.0554, Accuracy: 332/1446 (22.9599%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 499/1446 (34.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1060, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1256, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 562/928 (60.5603%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6445, Accuracy: 70/10000 (0.7000%)
time spent on training: 132.63691544532776
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 515, 1089, 599, 636, 690, 416, 1446, 134, 928]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3131, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5864, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.63887310028076 sec.
Server Epoch:38 choose agents : [84, 78, 4, 39, 42, 59, 73, 34, 20, 88].
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 333/1190 (27.9832%)
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8622, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.5625, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0327, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.6067, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 319/1013 (31.4906%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 469/1013 (46.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4973, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 359/1372 (26.1662%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0377, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4620, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 311/938 (33.1557%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4542, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 411/1427 (28.8017%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   2, Avg loss: 0.0340, Accuracy: 591/1427 (41.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8506, Accuracy: 52/10000 (0.5200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0584, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0307, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.6893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0751, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.9916, Accuracy: 50/10000 (0.5000%)
time spent on training: 168.84822249412537
[foolsgold agg] training data poison_ratio: 0.08271832718327184  data num: [1190, 416, 901, 1013, 1372, 1089, 938, 1427, 807, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.025849477244772448
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3130, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5851, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.32294464111328 sec.
Server Epoch:39 choose agents : [43, 8, 17, 27, 59, 44, 32, 92, 66, 71].
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0050, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 512/1513 (33.8401%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1783, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 425/1574 (27.0013%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 684/1574 (43.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4311, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 448/1587 (28.2294%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 560/1587 (35.2867%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1318, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 330/1089 (30.3030%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0735, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 420/1750 (24.0000%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 665/1750 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4902, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 199/735 (27.0748%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 321/735 (43.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7530, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 488/1715 (28.4548%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5302, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 371/1402 (26.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.2429, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 340/818 (41.5648%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9286, Accuracy: 57/10000 (0.5700%)
time spent on training: 174.87964940071106
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1513, 1574, 1587, 1089, 1750, 735, 1715, 1402, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3128, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5815, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.78823065757751 sec.
Server Epoch:40 choose agents : [72, 92, 10, 79, 82, 55, 2, 64, 84, 44].
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 262/1241 (21.1120%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 396/1241 (31.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2265, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 416/1715 (24.2566%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 728/1715 (42.4490%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8452, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 226/861 (26.2485%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 455/861 (52.8455%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   1, Avg loss: 0.1016, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   2, Avg loss: 0.0841, Accuracy: 64/197 (32.4873%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3229, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.6883, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 238/1071 (22.2222%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8416, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.8307, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 296/953 (31.0598%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5183, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.0018, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 388/1750 (22.1714%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 681/1750 (38.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6590, Accuracy: 116/10000 (1.1600%)
time spent on training: 159.1685299873352
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 1715, 861, 197, 500, 1071, 605, 953, 1190, 1750]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3128, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5798, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 228.41639065742493 sec.
Server Epoch:41 choose agents : [65, 85, 25, 90, 38, 75, 45, 21, 51, 16].
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0548, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 648/1475 (43.9322%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7400, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 438/1988 (22.0322%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 665/1988 (33.4507%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2405, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.3983, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0577, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0440, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 506/1131 (44.7392%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4420, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.8818, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0677, Accuracy: 201/669 (30.0448%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8385, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 647/1949 (33.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2316, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 513/1049 (48.9037%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1386, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   1, Avg loss: 0.0647, Accuracy: 279/708 (39.4068%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   2, Avg loss: 0.0356, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8796, Accuracy: 57/10000 (0.5700%)
time spent on training: 171.8265197277069
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 1988, 690, 677, 1131, 776, 669, 1949, 1049, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3127, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5789, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 240.95028924942017 sec.
Server Epoch:42 choose agents : [4, 43, 67, 60, 32, 45, 94, 15, 38, 34].
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0344, Accuracy: 370/901 (41.0655%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 299/946 (31.6068%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 326/946 (34.4609%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.9807, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0428, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.5437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 560/2227 (25.1459%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1011/2227 (45.3974%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2866, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 199/735 (27.0748%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 370/735 (50.3401%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8834, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0682, Accuracy: 206/669 (30.7922%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7732, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 348/1662 (20.9386%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 621/1662 (37.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6927, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 502/1154 (43.5009%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8874, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 242/1131 (21.3970%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 501/1131 (44.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.2266, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 376/1427 (26.3490%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 594/1427 (41.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0773, Accuracy: 60/10000 (0.6000%)
time spent on training: 172.04676628112793
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 946, 426, 2227, 735, 669, 1662, 1154, 1131, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3126, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5740, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 239.19310188293457 sec.
Server Epoch:43 choose agents : [30, 90, 78, 76, 95, 4, 91, 40, 31, 21].
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0807, Accuracy: 74/486 (15.2263%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7935, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 28/416 (6.7308%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.5400, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.6574, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   1, Avg loss: 0.0511, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0589, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 428/901 (47.5028%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6134, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0545, Accuracy: 351/1030 (34.0777%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0246, Accuracy: 651/1030 (63.2039%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.9324, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 355/1573 (22.5683%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 552/1573 (35.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5780, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7326, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 400/1949 (20.5233%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 634/1949 (32.5295%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3031, Accuracy: 90/10000 (0.9000%)
time spent on training: 156.6706030368805
[foolsgold agg] training data poison_ratio: 0.0  data num: [486, 677, 416, 466, 599, 901, 1030, 1573, 460, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.02169487 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3125, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5737, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.7122094631195 sec.
Server Epoch:44 choose agents : [99, 52, 94, 4, 15, 32, 64, 58, 36, 57].
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 173/773 (22.3803%)
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 397/773 (51.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.2059, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 294/636 (46.2264%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.2338, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 600/1662 (36.1011%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8215, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0649, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0305, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7456, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 406/1154 (35.1820%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0611, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6810, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 312/953 (32.7387%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.3928, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0563, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.0326, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4939, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0285, Accuracy: 522/1154 (45.2340%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4840, Accuracy: 70/10000 (0.7000%)
time spent on training: 159.12594723701477
[foolsgold agg] training data poison_ratio: 0.0  data num: [773, 636, 1662, 901, 1154, 735, 953, 803, 408, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3124, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5684, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.01915979385376 sec.
Server Epoch:45 choose agents : [29, 81, 27, 2, 94, 56, 14, 99, 62, 76].
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 411/1440 (28.5417%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 672/1440 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7834, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   1, Avg loss: 0.0684, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   2, Avg loss: 0.0375, Accuracy: 294/774 (37.9845%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.3863, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 408/1587 (25.7089%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 596/1587 (37.5551%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0385, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0403, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9407, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 348/1662 (20.9386%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 609/1662 (36.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7449, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 332/1013 (32.7739%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6256, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 176/773 (22.7684%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   2, Avg loss: 0.0302, Accuracy: 399/773 (51.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1157, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 146/568 (25.7042%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7996, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 50/466 (10.7296%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.6716, Accuracy: 50/10000 (0.5000%)
time spent on training: 155.16553497314453
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 774, 1587, 605, 1662, 186, 1013, 773, 568, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3123, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5683, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.15892100334167 sec.
Server Epoch:46 choose agents : [97, 54, 16, 75, 96, 90, 39, 50, 12, 17].
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 370/1213 (30.5029%)
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 478/1213 (39.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6557, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5056, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0689, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0330, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8303, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 251/776 (32.3454%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9764, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3444, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 313/677 (46.2334%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9468, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 532/1013 (52.5173%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7345, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 168/809 (20.7664%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 341/809 (42.1508%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9539, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 30/338 (8.8757%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.4569, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 425/1574 (27.0013%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 679/1574 (43.1385%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0885, Accuracy: 91/10000 (0.9100%)
time spent on training: 146.32102704048157
[foolsgold agg] training data poison_ratio: 0.0  data num: [1213, 1130, 708, 776, 311, 677, 1013, 809, 338, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3123, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5685, Accuracy: 0/9950 (0.0000%)
saving model
Done in 213.38491773605347 sec.
Server Epoch:47 choose agents : [66, 77, 20, 72, 32, 75, 26, 83, 55, 13].
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 276/1402 (19.6862%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0906, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7958, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 350/807 (43.3705%)
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.5438, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 263/1241 (21.1926%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 403/1241 (32.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1013, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 334/735 (45.4422%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2353, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.8907, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 333/1446 (23.0290%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.3431, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 413/1953 (21.1470%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 722/1953 (36.9688%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7853, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 458/1071 (42.7638%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0862, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 310/1645 (18.8450%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 651/1645 (39.5745%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9143, Accuracy: 117/10000 (1.1700%)
time spent on training: 198.93085289001465
[foolsgold agg] training data poison_ratio: 0.06499677835051547  data num: [1402, 1340, 807, 1241, 735, 776, 1446, 1953, 1071, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.020311493234536085
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3121, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5646, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.19102692604065 sec.
Server Epoch:48 choose agents : [42, 90, 83, 4, 11, 19, 73, 61, 96, 39].
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 527/1372 (38.4111%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9317, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 417/1953 (21.3518%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5669, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 329/901 (36.5150%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 392/901 (43.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0468, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0525, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 447/712 (62.7809%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.7187, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 397/1036 (38.3205%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 665/1036 (64.1892%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1397, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0656, Accuracy: 171/938 (18.2303%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0150, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3039, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 50/311 (16.0772%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3480, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 500/1013 (49.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4869, Accuracy: 66/10000 (0.6600%)
time spent on training: 154.5236780643463
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 677, 1953, 901, 712, 1036, 938, 85, 311, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3120, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5630, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.42423224449158 sec.
Server Epoch:49 choose agents : [20, 2, 31, 41, 84, 98, 18, 69, 11, 22].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 358/807 (44.3618%)
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8982, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0642, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8029, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0823, Accuracy: 48/460 (10.4348%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0363, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.7126, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0595, Accuracy: 330/719 (45.8971%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.5554, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 404/1190 (33.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.1629, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0824, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.4600, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0700, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0344, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.0521, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.5782, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 541/1470 (36.8027%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1457, Accuracy: 61/10000 (0.6100%)
time spent on training: 151.02690267562866
[foolsgold agg] training data poison_ratio: 0.10823497854077253  data num: [807, 605, 460, 719, 1190, 373, 530, 590, 712, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.033823430793991416
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3120, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5628, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.68111968040466 sec.
Server Epoch:50 choose agents : [40, 49, 82, 52, 64, 6, 61, 8, 71, 42].
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 389/1573 (24.7298%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 598/1573 (38.0165%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.2501, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0793, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.6825, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2976, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 175/953 (18.3631%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.5323, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 408/1956 (20.8589%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 651/1956 (33.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3036, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1145, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3036, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 261/1513 (17.2505%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 475/1513 (31.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7287, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 358/818 (43.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4060, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0525, Accuracy: 352/1372 (25.6560%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 546/1372 (39.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9097, Accuracy: 86/10000 (0.8600%)
time spent on training: 160.8342502117157
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 440, 500, 636, 953, 1956, 85, 1513, 818, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3120, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5621, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 228.58273220062256 sec.
Server Epoch:51 choose agents : [5, 57, 22, 34, 60, 42, 12, 72, 7, 93].
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 406/1628 (24.9386%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 823/1628 (50.5528%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1443, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0556, Accuracy: 303/1154 (26.2565%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 541/1154 (46.8804%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.8771, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 502/1470 (34.1497%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 818/1470 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0218, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 384/1427 (26.9096%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 590/1427 (41.3455%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.8491, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 519/2227 (23.3049%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1024/2227 (45.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1942, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.8968, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0459, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.4534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 278/1241 (22.4013%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 450/1241 (36.2611%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2399, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9544, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 404/1742 (23.1917%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9633, Accuracy: 85/10000 (0.8500%)
time spent on training: 206.54208946228027
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1154, 1470, 1427, 2227, 1372, 338, 1241, 891, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3119, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5609, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.4881680011749 sec.
Server Epoch:52 choose agents : [90, 34, 84, 61, 58, 18, 42, 1, 32, 31].
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 435/677 (64.2541%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4477, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 422/1427 (29.5725%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.0459, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 442/1190 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.9790, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1152, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3037, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0352, Accuracy: 384/803 (47.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9672, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.1331, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 346/1372 (25.2187%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 540/1372 (39.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9773, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6263, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 208/735 (28.2993%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.5478, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 58/460 (12.6087%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7854, Accuracy: 50/10000 (0.5000%)
time spent on training: 155.26479291915894
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 1427, 1190, 85, 803, 530, 1372, 928, 735, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3118, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5580, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.95518016815186 sec.
Server Epoch:53 choose agents : [44, 27, 62, 20, 28, 49, 40, 8, 16, 22].
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 674/1750 (38.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3418, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 430/1587 (27.0951%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 595/1587 (37.4921%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2986, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7702, Accuracy: 49/10000 (0.4900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.9962, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 403/1581 (25.4902%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 603/1581 (38.1404%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7431, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 39/440 (8.8636%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0478, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.5194, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 362/1573 (23.0134%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 536/1573 (34.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9864, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 226/1513 (14.9372%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 479/1513 (31.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3488, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8405, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 561/1470 (38.1633%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 837/1470 (56.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1553, Accuracy: 68/10000 (0.6800%)
time spent on training: 203.44333791732788
[foolsgold agg] training data poison_ratio: 0.06726681670417604  data num: [1750, 1587, 568, 807, 1581, 440, 1573, 1513, 708, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.021020880220055015
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3117, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5577, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.40199851989746 sec.
Server Epoch:54 choose agents : [38, 69, 16, 89, 47, 84, 8, 7, 93, 54].
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0612, Accuracy: 257/1131 (22.7233%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 464/1131 (41.0256%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3736, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.0137, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0617, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.7185, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 324/896 (36.1607%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 418/896 (46.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.2052, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1217, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1085, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2060, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 249/1513 (16.4574%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 505/1513 (33.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2580, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.8166, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 401/1742 (23.0195%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6542, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5913, Accuracy: 50/10000 (0.5000%)
time spent on training: 168.93415093421936
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 590, 708, 896, 134, 1190, 1513, 891, 1742, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3116, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5573, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.23587322235107 sec.
Server Epoch:55 choose agents : [88, 77, 16, 55, 79, 13, 61, 12, 27, 98].
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8487, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 339/1340 (25.2985%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 568/1340 (42.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8584, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0602, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8894, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 259/1071 (24.1830%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 500/1071 (46.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7749, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   1, Avg loss: 0.1047, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   2, Avg loss: 0.0834, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3209, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 303/1645 (18.4195%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 625/1645 (37.9939%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8400, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3040, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 28/338 (8.2840%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0485, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4571, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 454/1587 (28.6074%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 617/1587 (38.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.1288, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   1, Avg loss: 0.0824, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   2, Avg loss: 0.0487, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4431, Accuracy: 50/10000 (0.5000%)
time spent on training: 159.2242624759674
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 1340, 708, 1071, 197, 1645, 85, 338, 1587, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3115, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5566, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.83470702171326 sec.
Server Epoch:56 choose agents : [41, 84, 47, 20, 89, 72, 45, 32, 26, 7].
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0589, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0311, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4358, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0612, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.9843, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1204, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 348/807 (43.1227%)
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.9367, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.2682, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 237/1241 (19.0975%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 396/1241 (31.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4179, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 197/669 (29.4469%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8171, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 210/735 (28.5714%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6150, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 350/1446 (24.2047%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 497/1446 (34.3707%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1256, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1509, Accuracy: 51/10000 (0.5100%)
time spent on training: 187.43172526359558
[foolsgold agg] training data poison_ratio: 0.09246104491292392  data num: [719, 1190, 134, 807, 896, 1241, 669, 735, 1446, 891]
[foolsgold agg] considering poison per batch poison_fraction: 0.028894076535288728
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3114, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5529, Accuracy: 0/9950 (0.0000%)
saving model
Done in 254.3550968170166 sec.
Server Epoch:57 choose agents : [40, 56, 4, 32, 74, 75, 70, 88, 9, 35].
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 347/1573 (22.0598%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 545/1573 (34.6472%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5455, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0595, Accuracy: 336/901 (37.2919%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0348, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.0206, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0596, Accuracy: 205/735 (27.8912%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 372/735 (50.6122%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0558, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 474/1552 (30.5412%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 778/1552 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.1702, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 254/776 (32.7320%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1620, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 336/1418 (23.6953%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 612/1418 (43.1594%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0979, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.0664, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 367/1275 (28.7843%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 679/1275 (53.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3679, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 45/271 (16.6052%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 112/271 (41.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3724, Accuracy: 49/10000 (0.4900%)
time spent on training: 189.2273769378662
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 186, 901, 735, 1552, 776, 1418, 603, 1275, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3114, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5502, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.08885192871094 sec.
Server Epoch:58 choose agents : [34, 31, 89, 35, 74, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 399/1427 (27.9608%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 579/1427 (40.5746%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.0265, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7418, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.2219, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 43/271 (15.8672%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3647, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 513/1552 (33.0541%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 782/1552 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 11.0382, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 382/1036 (36.8726%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 663/1036 (63.9961%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.3338, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 435/1587 (27.4102%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 614/1587 (38.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2707, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0394, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3964, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7559, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0601, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7790, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.34899997711182
[foolsgold agg] training data poison_ratio: 0.0  data num: [1427, 460, 896, 271, 1552, 1036, 1587, 312, 515, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3113, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5502, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.3094277381897 sec.
Server Epoch:59 choose agents : [69, 83, 6, 40, 21, 23, 97, 75, 53, 99].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0584, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.0038, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 735/1953 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7914, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1956 (33.5890%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3287, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 367/1573 (23.3312%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 610/1573 (38.7794%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.5010, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 377/1949 (19.3433%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 596/1949 (30.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.9192, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7705, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 348/1213 (28.6892%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   2, Avg loss: 0.0267, Accuracy: 523/1213 (43.1162%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.4243, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 423/776 (54.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.0770, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 276/813 (33.9483%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 461/813 (56.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.5997, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0646, Accuracy: 189/773 (24.4502%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2998, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.16902542114258
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 1953, 1956, 1573, 1949, 715, 1213, 776, 813, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3112, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5507, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.39718413352966 sec.
Server Epoch:60 choose agents : [51, 98, 53, 74, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 552/1049 (52.6215%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7879, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4486, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0503, Accuracy: 277/813 (34.0713%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 438/813 (53.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4726, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 514/1552 (33.1186%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 751/1552 (48.3892%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.6682, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 354/1372 (25.8017%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 537/1372 (39.1399%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0528, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1158, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3031, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 31/338 (9.1716%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0461, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4506, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 495/1130 (43.8053%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 357/1418 (25.1763%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 676/1418 (47.6728%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6527, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0530, Accuracy: 360/712 (50.5618%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7870, Accuracy: 50/10000 (0.5000%)
time spent on training: 185.514057636261
[foolsgold agg] training data poison_ratio: 0.0  data num: [1049, 373, 813, 1552, 1372, 85, 338, 1130, 1418, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3112, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5510, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 252.48304295539856 sec.
Server Epoch:61 choose agents : [84, 20, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8023, Accuracy: 65/10000 (0.6500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 440/807 (54.5229%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8596, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 228/1049 (21.7350%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 536/1049 (51.0963%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5152, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0568, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.4150, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4389, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 411/1956 (21.0123%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 666/1956 (34.0491%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8592, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 252/1071 (23.5294%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2286, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 482/813 (59.2866%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.4051, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0848, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4605, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.9602, Accuracy: 50/10000 (0.5000%)
time spent on training: 195.41549491882324
[foolsgold agg] training data poison_ratio: 0.08375713544369487  data num: [1190, 807, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.02617410482615465
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3111, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5510, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.6327688694 sec.
Server Epoch:62 choose agents : [83, 78, 24, 81, 4, 30, 93, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 419/1953 (21.4542%)
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 746/1953 (38.1976%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0092, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 47/416 (11.2981%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 191/416 (45.9135%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.5447, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 174/312 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3942, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0652, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 286/774 (36.9509%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.4126, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0626, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 365/901 (40.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.5301, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 69/486 (14.1975%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7966, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 450/1742 (25.8324%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 713/1742 (40.9300%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6480, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0774, Accuracy: 77/515 (14.9515%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7638, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 295/590 (50.0000%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0536, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 580/2227 (26.0440%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1016/2227 (45.6219%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2905, Accuracy: 129/10000 (1.2900%)
time spent on training: 185.37833642959595
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 416, 312, 774, 901, 486, 1742, 515, 590, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3110, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5495, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.1868977546692 sec.
Server Epoch:63 choose agents : [18, 64, 38, 94, 55, 90, 58, 59, 66, 76].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0548, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 319/953 (33.4732%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.6419, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 443/1131 (39.1689%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.0966, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 321/1662 (19.3141%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 622/1662 (37.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9791, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 246/1071 (22.9692%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 509/1071 (47.5257%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.0367, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1221, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 373/803 (46.4508%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.1381, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 308/1089 (28.2828%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0279, Accuracy: 478/1089 (43.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2303, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 266/1402 (18.9729%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 411/1402 (29.3153%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.0548, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0852, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.7157, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.7463231086731
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 1662, 1071, 677, 803, 1089, 1402, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3110, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5483, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.8100185394287 sec.
Server Epoch:64 choose agents : [77, 13, 57, 64, 48, 23, 71, 35, 32, 75].
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0432, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 637/1645 (38.7234%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0704, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0539, Accuracy: 299/1154 (25.9099%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 529/1154 (45.8406%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2149, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 199/953 (20.8814%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.4433, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0405, Accuracy: 232/631 (36.7670%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7245, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0631, Accuracy: 161/818 (19.6822%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 374/818 (45.7213%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.4435, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0573, Accuracy: 116/271 (42.8044%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3694, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 208/735 (28.2993%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8324, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   1, Avg loss: 0.0622, Accuracy: 251/776 (32.3454%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.8127, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.02512621879578
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1645, 1154, 953, 631, 715, 818, 271, 735, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3109, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5439, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.63782811164856 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 84, 30, 66, 73, 81, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 389/1581 (24.6047%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 586/1581 (37.0651%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3310, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 421/1129 (37.2896%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 737/1129 (65.2790%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5467, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 34/338 (10.0592%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0455, Accuracy: 156/338 (46.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4505, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0558, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.1223, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 461/1190 (38.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0443, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0801, Accuracy: 74/486 (15.2263%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.7359, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 360/1402 (25.6776%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.1098, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 332/938 (35.3945%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.4186, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 239/774 (30.8786%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 309/774 (39.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.1569, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0520, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0284, Accuracy: 443/712 (62.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.6724, Accuracy: 51/10000 (0.5100%)
time spent on training: 184.4564299583435
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1190, 486, 1402, 938, 774, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3109, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5438, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.7832531929016 sec.
Server Epoch:66 choose agents : [89, 62, 94, 18, 81, 93, 91, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 428/896 (47.7679%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.1352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 152/568 (26.7606%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7975, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 352/1662 (21.1793%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1662 (37.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8136, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0767, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0404, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2020, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   1, Avg loss: 0.0679, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   2, Avg loss: 0.0375, Accuracy: 287/774 (37.0801%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2804, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 415/1742 (23.8232%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6500, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   1, Avg loss: 0.0532, Accuracy: 323/1030 (31.3592%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 612/1030 (59.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1778, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0648, Accuracy: 185/938 (19.7228%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 321/938 (34.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6223, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.8715, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 170/818 (20.7824%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 381/818 (46.5770%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.1887, Accuracy: 60/10000 (0.6000%)
time spent on training: 192.3184311389923
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 568, 1662, 530, 774, 1742, 1030, 938, 891, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3108, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5421, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.7162868976593 sec.
Server Epoch:67 choose agents : [44, 83, 96, 56, 6, 74, 64, 39, 14, 77].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 391/1750 (22.3429%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.5936, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 442/1953 (22.6318%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 795/1953 (40.7066%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8424, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3556, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0820, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 403/1956 (20.6033%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 651/1956 (33.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1854, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 511/1552 (32.9253%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.6056, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 180/953 (18.8877%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 325/953 (34.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8838, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 312/1013 (30.7996%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 526/1013 (51.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6826, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 327/1013 (32.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8468, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 573/1340 (42.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0009, Accuracy: 56/10000 (0.5600%)
time spent on training: 225.19756245613098
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1953, 311, 186, 1956, 1552, 953, 1013, 1013, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3107, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5413, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.22656512260437 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 83, 9, 17, 87, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 398/1949 (20.4207%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4308, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 40/312 (12.8205%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.4070, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.6256, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 416/1750 (23.7714%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 696/1750 (39.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6136, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 445/1953 (22.7855%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 775/1953 (39.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.5587, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 368/1275 (28.8627%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 703/1275 (55.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.3661, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 383/1574 (24.3329%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 655/1574 (41.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2635, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0586, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6274, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 286/636 (44.9686%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2845, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 430/888 (48.4234%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2023, Accuracy: 59/10000 (0.5900%)
time spent on training: 230.09696125984192
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1953, 1275, 1574, 1131, 636, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3107, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5415, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.92037296295166 sec.
Server Epoch:69 choose agents : [21, 31, 44, 89, 70, 80, 83, 5, 69, 75].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 432/1949 (22.1652%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 647/1949 (33.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4113, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.8377, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0579, Accuracy: 423/1750 (24.1714%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 702/1750 (40.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7656, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.2258, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 367/1418 (25.8815%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7883, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   1, Avg loss: 0.0699, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 269/682 (39.4428%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.4773, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 761/1953 (38.9657%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0679, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0516, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 841/1628 (51.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2117, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0307, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2302, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.8439, Accuracy: 50/10000 (0.5000%)
time spent on training: 232.7152988910675
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 896, 1418, 682, 1953, 1628, 590, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3106, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5415, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.6146936416626 sec.
Server Epoch:70 choose agents : [7, 74, 76, 0, 16, 9, 19, 97, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 367/891 (41.1897%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.1732, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 501/1552 (32.2809%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 779/1552 (50.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.5122, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 50/466 (10.7296%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.6463, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 347/1657 (20.9415%)
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 506/1657 (30.5371%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.5782, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0392, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9356, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 371/1275 (29.0980%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 712/1275 (55.8431%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.3874, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 412/1036 (39.7683%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 687/1036 (66.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.2496, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 370/1213 (30.5029%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 487/1213 (40.1484%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.6041, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 101/631 (16.0063%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8835, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 395/1402 (28.1740%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2825, Accuracy: 79/10000 (0.7900%)
time spent on training: 237.29282474517822
[foolsgold agg] training data poison_ratio: 0.15298679715631058  data num: [891, 1552, 466, 1657, 708, 1275, 1036, 1213, 631, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.04780837411134706
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3106, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5425, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.2826397418976 sec.
Server Epoch:71 choose agents : [49, 6, 74, 90, 82, 24, 33, 78, 18, 84].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0785, Accuracy: 33/440 (7.5000%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5336, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 385/1956 (19.6830%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2983, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 470/1552 (30.2835%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.6381, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 324/677 (47.8582%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3607, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 184/500 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.6634, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 50/312 (16.0256%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3953, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0492, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.7261, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 44/416 (10.5769%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 184/416 (44.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5967, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.3524, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 322/1190 (27.0588%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 470/1190 (39.4958%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.1208, Accuracy: 60/10000 (0.6000%)
time spent on training: 175.5472674369812
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1956, 1552, 677, 500, 312, 515, 416, 530, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.98280075 1.         1.         1.         1.         0.98280075
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3105, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5429, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.3034064769745 sec.
Server Epoch:72 choose agents : [31, 17, 64, 91, 34, 99, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7716, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 391/1574 (24.8412%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 653/1574 (41.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2911, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 330/953 (34.6275%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.4892, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 329/1030 (31.9417%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 656/1030 (63.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3472, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 401/1427 (28.1009%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 548/1427 (38.4022%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8589, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0643, Accuracy: 199/773 (25.7439%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 377/773 (48.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.9705, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0624, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 355/901 (39.4007%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0655, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7529, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 515/1470 (35.0340%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9672, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 402/1036 (38.8031%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 693/1036 (66.8919%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0766, Accuracy: 55/10000 (0.5500%)
time spent on training: 218.25083541870117
[foolsgold agg] training data poison_ratio: 0.0  data num: [460, 1574, 953, 1030, 1427, 773, 901, 888, 1470, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3104, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5413, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.1758921146393 sec.
Server Epoch:73 choose agents : [27, 0, 34, 96, 4, 72, 81, 12, 59, 88].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 463/1587 (29.1745%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 621/1587 (39.1304%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2221, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 363/1657 (21.9071%)
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 537/1657 (32.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4617, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 394/1427 (27.6104%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 589/1427 (41.2754%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.0012, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0782, Accuracy: 55/311 (17.6849%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3500, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0622, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0309, Accuracy: 404/901 (44.8391%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8060, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 256/1241 (20.6285%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 436/1241 (35.1330%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1719, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0678, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 284/774 (36.6925%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.2744, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0851, Accuracy: 31/338 (9.1716%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0448, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4551, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0596, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0264, Accuracy: 483/1089 (44.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1124, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   1, Avg loss: 0.0732, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1340, Accuracy: 52/10000 (0.5200%)
time spent on training: 234.19985795021057
[foolsgold agg] training data poison_ratio: 0.1669016921837228  data num: [1587, 1657, 1427, 311, 901, 1241, 774, 338, 1089, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.05215677880741337
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3103, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5419, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.50236082077026 sec.
Server Epoch:74 choose agents : [9, 38, 0, 63, 50, 44, 1, 92, 93, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0486, Accuracy: 368/1275 (28.8627%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 747/1275 (58.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.7552, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 263/1131 (23.2538%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 514/1131 (45.4465%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.3746, Accuracy: 83/10000 (0.8300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 367/1657 (22.1485%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 520/1657 (31.3820%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8029, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3748, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 147/809 (18.1706%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 363/809 (44.8702%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4368, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 412/1750 (23.5429%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 689/1750 (39.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2877, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 296/928 (31.8966%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 572/928 (61.6379%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6709, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 467/1715 (27.2303%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 710/1715 (41.3994%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8086, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 760/1742 (43.6280%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9874, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 473/813 (58.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6019, Accuracy: 49/10000 (0.4900%)
time spent on training: 278.53676199913025
[foolsgold agg] training data poison_ratio: 0.13039030531948378  data num: [1275, 1131, 1657, 888, 809, 1750, 928, 1715, 1742, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.040746970412338684
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3103, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5420, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.37005257606506 sec.
Server Epoch:75 choose agents : [88, 65, 74, 85, 4, 55, 81, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 152/603 (25.2073%)
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2, Avg loss: 0.0444, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.8813, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 393/1475 (26.6441%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 704/1475 (47.7288%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0268, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 483/1552 (31.1211%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 779/1552 (50.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.3991, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 464/1988 (23.3400%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 677/1988 (34.0543%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2289, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0596, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9685, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9113, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   1, Avg loss: 0.0653, Accuracy: 253/774 (32.6873%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   2, Avg loss: 0.0363, Accuracy: 283/774 (36.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.3239, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0459, Accuracy: 149/338 (44.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.4478, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 400/1949 (20.5233%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.1450, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 179/953 (18.7828%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0373, Accuracy: 343/953 (35.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.4895, Accuracy: 75/10000 (0.7500%)
time spent on training: 252.8810293674469
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 1475, 1552, 1988, 901, 1071, 774, 338, 1949, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3103, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5403, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.11652755737305 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 83, 39, 17, 88, 92, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 406/1628 (24.9386%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 821/1628 (50.4300%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2020, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 241/1241 (19.4198%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 430/1241 (34.6495%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.3641, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0577, Accuracy: 221/861 (25.6678%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 452/861 (52.4971%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7579, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 265/1071 (24.7432%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 487/1071 (45.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1042, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 450/1953 (23.0415%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 775/1953 (39.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9330, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0534, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 504/1013 (49.7532%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.6396, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 403/1574 (25.6036%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9762, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0736, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8643, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 446/1715 (26.0058%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 724/1715 (42.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.6497, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 47/271 (17.3432%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0577, Accuracy: 111/271 (40.9594%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3687, Accuracy: 48/10000 (0.4800%)
time spent on training: 248.73069953918457
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1953, 1013, 1574, 603, 1715, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.92399131 1.
 1.         1.         1.         0.92399131]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3102, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5406, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.9079873561859 sec.
Server Epoch:77 choose agents : [61, 17, 99, 31, 50, 89, 71, 60, 94, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 416/1574 (26.4295%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9517, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   1, Avg loss: 0.0652, Accuracy: 196/773 (25.3558%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   2, Avg loss: 0.0294, Accuracy: 412/773 (53.2988%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.5004, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0805, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8620, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 147/809 (18.1706%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 352/809 (43.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4963, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   1, Avg loss: 0.0590, Accuracy: 344/896 (38.3929%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   2, Avg loss: 0.0352, Accuracy: 426/896 (47.5446%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.2992, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 170/818 (20.7824%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0298, Accuracy: 382/818 (46.6993%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0894, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 583/2227 (26.1787%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1061/2227 (47.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6537, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 302/1662 (18.1709%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6957, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 397/1581 (25.1107%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 611/1581 (38.6464%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6424, Accuracy: 93/10000 (0.9300%)
time spent on training: 244.09386038780212
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 1574, 773, 460, 809, 896, 818, 2227, 1662, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3100, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5389, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.72055292129517 sec.
Server Epoch:78 choose agents : [1, 64, 48, 76, 98, 36, 26, 89, 18, 92].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0554, Accuracy: 300/928 (32.3276%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8804, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 285/953 (29.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.5985, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 111/631 (17.5911%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.9835, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0845, Accuracy: 46/466 (9.8712%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   1, Avg loss: 0.0820, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.4518, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.5059, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 526/1446 (36.3762%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3514, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 415/896 (46.3170%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.3479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1890, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 482/1715 (28.1050%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 719/1715 (41.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6569, Accuracy: 89/10000 (0.8900%)
time spent on training: 194.50858426094055
[foolsgold agg] training data poison_ratio: 0.0  data num: [928, 953, 631, 466, 373, 408, 1446, 896, 530, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3100, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5377, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.0023829936981 sec.
Server Epoch:79 choose agents : [70, 34, 15, 96, 95, 25, 53, 86, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 365/1418 (25.7405%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 647/1418 (45.6276%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5939, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0576, Accuracy: 431/1427 (30.2032%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 594/1427 (41.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.8263, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 340/1154 (29.4627%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 504/1154 (43.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2, Avg loss: 0.0527, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3465, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 341/599 (56.9282%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0720, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.3277, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 267/813 (32.8413%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 469/813 (57.6876%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.8989, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 357/1003 (35.5932%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 390/1003 (38.8833%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.5056, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0753, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0405, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0710, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 289/636 (45.4403%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.3004, Accuracy: 50/10000 (0.5000%)
time spent on training: 198.25537633895874
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 311, 599, 690, 813, 1003, 530, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3099, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5375, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.8744435310364 sec.
Server Epoch:80 choose agents : [90, 47, 51, 91, 87, 77, 74, 61, 97, 76].
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4135, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1215, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1066, Accuracy: 25/134 (18.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 243/1049 (23.1649%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 525/1049 (50.0477%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4845, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0507, Accuracy: 347/1030 (33.6893%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6091, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   2, Avg loss: 0.0310, Accuracy: 434/1131 (38.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6435, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 342/1340 (25.5224%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 565/1340 (42.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6853, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 499/1552 (32.1521%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 767/1552 (49.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.2925, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3036, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 482/1213 (39.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6639, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0836, Accuracy: 54/466 (11.5880%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0472, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6494, Accuracy: 50/10000 (0.5000%)
time spent on training: 204.00273847579956
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 134, 1049, 1030, 1131, 1340, 1552, 85, 1213, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3099, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5378, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.1336214542389 sec.
Server Epoch:81 choose agents : [60, 92, 18, 24, 50, 96, 61, 90, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 658/2227 (29.5465%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3391, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 453/1715 (26.4140%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 741/1715 (43.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5114, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 129/530 (24.3396%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.1808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 40/312 (12.8205%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3986, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0624, Accuracy: 152/809 (18.7886%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 346/809 (42.7689%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2139, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3502, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1150, Accuracy: 13/85 (15.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3035, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2942, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 500/1130 (44.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5803, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 337/1154 (29.2028%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 457/1154 (39.6014%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8711, Accuracy: 53/10000 (0.5300%)
time spent on training: 217.41450452804565
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1715, 530, 312, 809, 311, 85, 677, 1130, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3098, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.1455352306366 sec.
Server Epoch:82 choose agents : [59, 83, 37, 80, 61, 21, 47, 81, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0580, Accuracy: 332/1089 (30.4867%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 492/1089 (45.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.3509, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 437/1953 (22.3758%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 747/1953 (38.2488%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1384, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 434/1129 (38.4411%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3991, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 147/682 (21.5543%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0384, Accuracy: 224/682 (32.8446%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4003, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 2/85 (2.3529%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3034, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 422/1949 (21.6521%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 638/1949 (32.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2746, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1195, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1085, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0661, Accuracy: 251/774 (32.4289%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0350, Accuracy: 333/774 (43.0233%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3142, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 660/1645 (40.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8126, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0797, Accuracy: 77/460 (16.7391%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8301, Accuracy: 50/10000 (0.5000%)
time spent on training: 244.52392625808716
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1953, 1129, 682, 85, 1949, 134, 774, 1645, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.73046908 1.         1.         0.73046908]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3097, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5352, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.98283648490906 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 75, 94, 79].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0608, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1023, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 399/1475 (27.0508%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 637/1475 (43.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0316, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0770, Accuracy: 76/515 (14.7573%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.6932, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9124, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 82/408 (20.0980%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.4996, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 311/1154 (26.9497%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 496/1154 (42.9809%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1795, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0688, Accuracy: 209/669 (31.2407%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0395, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.8585, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   2, Avg loss: 0.0321, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.3407, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 350/1662 (21.0590%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6120, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   1, Avg loss: 0.1012, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   2, Avg loss: 0.0882, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3204, Accuracy: 50/10000 (0.5000%)
time spent on training: 221.56243991851807
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 776, 1662, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3096, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.8740174770355 sec.
Server Epoch:84 choose agents : [98, 26, 54, 61, 56, 29, 38, 45, 2, 15].
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 24/373 (6.4343%)
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.4617, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 360/1446 (24.8963%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.2077, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0557, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.3698, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3039, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0819, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0667, Accuracy: 80/186 (43.0108%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 430/1440 (29.8611%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 680/1440 (47.2222%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8863, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 267/1131 (23.6074%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 527/1131 (46.5959%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4929, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0657, Accuracy: 213/669 (31.8386%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8184, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0304, Accuracy: 479/1154 (41.5078%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5852, Accuracy: 57/10000 (0.5700%)
time spent on training: 224.0857937335968
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3096, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5344, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.97992277145386 sec.
Server Epoch:85 choose agents : [83, 3, 85, 18, 96, 8, 88, 79, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 462/1953 (23.6559%)
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 790/1953 (40.4506%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6758, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0727, Accuracy: 119/781 (15.2369%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6062, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   1, Avg loss: 0.0526, Accuracy: 464/1988 (23.3400%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 675/1988 (33.9537%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8502, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 128/530 (24.1509%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.1980, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 50/311 (16.0772%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3502, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 243/1513 (16.0608%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 453/1513 (29.9405%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4231, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1, Avg loss: 0.0737, Accuracy: 150/603 (24.8756%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8859, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1, Avg loss: 0.0998, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2, Avg loss: 0.0833, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3207, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0611, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.7583, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 399/803 (49.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0551, Accuracy: 54/10000 (0.5400%)
time spent on training: 226.68762063980103
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 781, 1988, 530, 311, 1513, 603, 197, 715, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3096, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5349, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.56043457984924 sec.
Server Epoch:86 choose agents : [57, 99, 60, 19, 35, 84, 81, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0538, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 466/1154 (40.3813%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.8989, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 194/773 (25.0970%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.0354, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0488, Accuracy: 603/2227 (27.0768%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1033/2227 (46.3853%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.0463, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 422/1036 (40.7336%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 650/1036 (62.7413%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.7034, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 40/271 (14.7601%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 110/271 (40.5904%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3662, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 313/1190 (26.3025%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1637, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0647, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0361, Accuracy: 303/774 (39.1473%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.2144, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 411/1750 (23.4857%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 682/1750 (38.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5268, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0588, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.4403, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0552, Accuracy: 325/1089 (29.8439%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0356, Accuracy: 482/1089 (44.2608%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3321, Accuracy: 65/10000 (0.6500%)
time spent on training: 254.82841420173645
[foolsgold agg] training data poison_ratio: 0.0  data num: [1154, 773, 2227, 1036, 271, 1190, 774, 1750, 719, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.0395884513855 sec.
Server Epoch:87 choose agents : [85, 29, 54, 69, 86, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 654/1988 (32.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1319, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 440/1440 (30.5556%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 696/1440 (48.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0577, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 352/1130 (31.1504%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6129, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 300/590 (50.8475%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0328, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4787, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0603, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.7541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 203/669 (30.3438%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0396, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.7790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5187, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1203, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1088, Accuracy: 27/134 (20.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0518, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.7591, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0073, Accuracy: 67/10000 (0.6700%)
time spent on training: 248.4175968170166
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1440, 1130, 590, 1003, 669, 1446, 134, 515, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5346, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.2054340839386 sec.
Server Epoch:88 choose agents : [62, 82, 84, 18, 63, 67, 29, 37, 86, 79].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 150/568 (26.4085%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.7655, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.6351, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   1, Avg loss: 0.0609, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   2, Avg loss: 0.0312, Accuracy: 498/1190 (41.8487%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.0283, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 126/530 (23.7736%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0404, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2231, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 274/888 (30.8559%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 443/888 (49.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.9165, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0779, Accuracy: 57/426 (13.3803%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.6051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0478, Accuracy: 433/1440 (30.0694%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 673/1440 (46.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0885, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 408/1129 (36.1382%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 725/1129 (64.2161%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.4870, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0618, Accuracy: 365/1003 (36.3908%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.9836, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   1, Avg loss: 0.1021, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   2, Avg loss: 0.0895, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3208, Accuracy: 50/10000 (0.5000%)
time spent on training: 211.3431601524353
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 500, 1190, 530, 888, 426, 1440, 1129, 1003, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.94085517 1.         0.94085517
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5348, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.46697306632996 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 95, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 313/946 (33.0867%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 334/946 (35.3066%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0781, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 105/631 (16.6403%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 213/631 (33.7559%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0203, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 434/1587 (27.3472%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 620/1587 (39.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1605, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0502, Accuracy: 407/1628 (25.0000%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 811/1628 (49.8157%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6313, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0665, Accuracy: 209/669 (31.2407%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8653, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0776, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0401, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.6006, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7438, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8652, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 514/1013 (50.7404%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.4438, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0608, Accuracy: 294/708 (41.5254%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.9172, Accuracy: 55/10000 (0.5500%)
time spent on training: 224.170250415802
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 599, 715, 1013, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5344, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.455894947052 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 76, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/690 (45.3623%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.5529, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0582, Accuracy: 338/719 (47.0097%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0329, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.4901, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 495/1013 (48.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4498, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 343/1573 (21.8055%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 550/1573 (34.9650%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4238, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 400/1427 (28.0308%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 607/1427 (42.5368%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.0031, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 46/466 (9.8712%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.6626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 438/1440 (30.4167%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 703/1440 (48.8194%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2582, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0634, Accuracy: 152/818 (18.5819%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 337/818 (41.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2843, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 483/1513 (31.9233%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3263, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 298/813 (36.6544%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.7537, Accuracy: 50/10000 (0.5000%)
time spent on training: 256.5010552406311
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 466, 1440, 818, 1513, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5346, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.15008878707886 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 90, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0530, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.5204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 406/1427 (28.4513%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 577/1427 (40.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.8349, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0631, Accuracy: 168/818 (20.5379%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3929, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.7904, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0599, Accuracy: 266/1241 (21.4343%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 449/1241 (36.1805%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1282, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 332/677 (49.0399%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 462/677 (68.2422%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3856, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 271/888 (30.5180%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 451/888 (50.7883%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2453, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 120/781 (15.3649%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 248/781 (31.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.6838, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 156/809 (19.2831%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5207, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 52/312 (16.6667%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3936, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.64839005470276
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 677, 888, 781, 809, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.12381649017334 sec.
Server Epoch:92 choose agents : [91, 89, 76, 1, 58, 42, 94, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   1, Avg loss: 0.0506, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 589/1030 (57.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.6663, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.4202, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0459, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.7192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0553, Accuracy: 291/928 (31.3578%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 599/928 (64.5474%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.7707, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.0748, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 501/1372 (36.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9080, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 356/1662 (21.4200%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 653/1662 (39.2900%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9563, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 304/1013 (30.0099%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.8219, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 432/1440 (30.0000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 683/1440 (47.4306%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1331, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0788, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.7923, Accuracy: 44/10000 (0.4400%)
time spent on training: 244.09788465499878
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 896, 466, 928, 803, 1372, 1662, 1013, 1440, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5352, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.74663519859314 sec.
Server Epoch:93 choose agents : [75, 7, 35, 2, 93, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   1, Avg loss: 0.0648, Accuracy: 261/776 (33.6340%)
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.9551, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 425/891 (47.6992%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2501, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 42/271 (15.4982%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 120/271 (44.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3661, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8317, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 471/1742 (27.0379%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   2, Avg loss: 0.0309, Accuracy: 729/1742 (41.8485%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6346, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 349/1154 (30.2426%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 462/1154 (40.0347%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0605, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 431/1904 (22.6366%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 686/1904 (36.0294%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4746, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0776, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.5878, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0549, Accuracy: 286/1071 (26.7040%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9931, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0648, Accuracy: 173/938 (18.4435%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 364/938 (38.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5057, Accuracy: 54/10000 (0.5400%)
time spent on training: 242.82322645187378
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 891, 271, 605, 1742, 1154, 1904, 426, 1071, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5341, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.1874141693115 sec.
Server Epoch:94 choose agents : [54, 23, 95, 98, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0537, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0282, Accuracy: 501/1130 (44.3363%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8094, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0613, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8071, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 342/599 (57.0952%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   2, Avg loss: 0.0304, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.4682, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 408/1581 (25.8065%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 621/1581 (39.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.6752, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 288/636 (45.2830%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0701, Accuracy: 107/631 (16.9572%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8900, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 51/312 (16.3462%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.4000, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0499, Accuracy: 388/1628 (23.8329%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 815/1628 (50.0614%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4730, Accuracy: 153/10000 (1.5300%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0736, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 223/781 (28.5531%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.7356, Accuracy: 73/10000 (0.7300%)
time spent on training: 218.5050172805786
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 715, 599, 373, 1581, 636, 631, 312, 1628, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3091, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5346, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.3476779460907 sec.
Server Epoch:95 choose agents : [79, 4, 1, 10, 41, 2, 58, 11, 29, 77].
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   1, Avg loss: 0.0997, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   2, Avg loss: 0.0829, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0614, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0311, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.8926, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 293/928 (31.5733%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 559/928 (60.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.5775, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 216/861 (25.0871%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9121, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 338/719 (47.0097%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0311, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4582, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.9481, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 344/803 (42.8394%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.0699, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0541, Accuracy: 351/712 (49.2978%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.0937, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0479, Accuracy: 426/1440 (29.5833%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 687/1440 (47.7083%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1581, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 346/1340 (25.8209%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 609/1340 (45.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7848, Accuracy: 56/10000 (0.5600%)
time spent on training: 231.47199201583862
[foolsgold agg] training data poison_ratio: 0.0  data num: [197, 901, 928, 861, 719, 605, 803, 712, 1440, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5343, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.8911259174347 sec.
Server Epoch:96 choose agents : [77, 9, 2, 30, 42, 20, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   1, Avg loss: 0.0528, Accuracy: 353/1340 (26.3433%)
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.6990, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0487, Accuracy: 377/1275 (29.5686%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 716/1275 (56.1569%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.8173, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 234/605 (38.6777%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8698, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9109, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 363/1372 (26.4577%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8510, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/807 (52.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9286, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1235, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1150, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3037, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 226/781 (28.9373%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6845, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 346/1154 (29.9827%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0271, Accuracy: 498/1154 (43.1542%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.7264, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 420/1956 (21.4724%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3100, Accuracy: 134/10000 (1.3400%)
time spent on training: 258.6281785964966
[foolsgold agg] training data poison_ratio: 0.08183754183145725  data num: [1340, 1275, 605, 486, 1372, 807, 85, 781, 1154, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.02557423182233039
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5344, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.30021262168884 sec.
Server Epoch:97 choose agents : [38, 36, 83, 74, 84, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5713, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0862, Accuracy: 80/408 (19.6078%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.5128, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 454/1953 (23.2463%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 793/1953 (40.6042%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8795, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 493/1552 (31.7655%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.8094, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0606, Accuracy: 333/1190 (27.9832%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 462/1190 (38.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1987, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0590, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 530/1513 (35.0297%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6648, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 455/1587 (28.6704%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 620/1587 (39.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3485, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0578, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0316, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4726, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/1446 (24.2739%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 509/1446 (35.2006%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5741, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 354/1130 (31.3274%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0283, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6010, Accuracy: 57/10000 (0.5700%)
time spent on training: 312.61139607429504
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 408, 1953, 1552, 1190, 1513, 1587, 719, 1446, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5350, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.81590390205383 sec.
Server Epoch:98 choose agents : [70, 56, 62, 89, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0539, Accuracy: 392/1418 (27.6446%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 668/1418 (47.1086%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7656, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0820, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 78/186 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 164/568 (28.8732%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.7477, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2862, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 259/1241 (20.8703%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 451/1241 (36.3417%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2255, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0621, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0344, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.9803, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 314/690 (45.5072%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.6786, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 81/515 (15.7282%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 111/515 (21.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8536, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 561/1470 (38.1633%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 850/1470 (57.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1236, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.1510, Accuracy: 77/10000 (0.7700%)
time spent on training: 239.87592482566833
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 896, 1241, 708, 690, 515, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5354, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.75575256347656 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 81, 38, 62, 92, 78].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.4002, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0782, Accuracy: 41/440 (9.3182%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.5290, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 50/271 (18.4502%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3669, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0608, Accuracy: 279/1402 (19.9001%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 402/1402 (28.6733%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3463, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0556, Accuracy: 316/690 (45.7971%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.6286, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 251/774 (32.4289%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 281/774 (36.3049%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.3321, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 259/1131 (22.9001%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 481/1131 (42.5287%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.5837, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 153/568 (26.9366%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.8126, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 470/1715 (27.4052%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   2, Avg loss: 0.0301, Accuracy: 745/1715 (43.4402%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4960, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 40/416 (9.6154%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 195/416 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.6146, Accuracy: 50/10000 (0.5000%)
time spent on training: 216.42165541648865
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 774, 1131, 568, 1715, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.99155175 0.99155175 1.         1.         1.         1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3089, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5359, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.90802240371704 sec.
Server Epoch:100 choose agents : [47, 65, 85, 24, 39, 5, 1, 53, 87, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1078, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3087, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 706/1475 (47.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.1236, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   1, Avg loss: 0.0525, Accuracy: 433/1988 (21.7807%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 678/1988 (34.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1814, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0744, Accuracy: 55/312 (17.6282%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0390, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3995, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0529, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 524/1013 (51.7275%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7558, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0500, Accuracy: 393/1628 (24.1400%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0249, Accuracy: 822/1628 (50.4914%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.3527, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 300/928 (32.3276%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 580/928 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7619, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 291/813 (35.7934%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3049, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 309/1131 (27.3210%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 421/1131 (37.2237%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.1317, Accuracy: 50/10000 (0.5000%)
time spent on training: 277.61226320266724
[foolsgold agg] training data poison_ratio: 0.0  data num: [134, 1475, 1988, 312, 1013, 1628, 928, 813, 1131, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3088, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5349, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.2623267173767 sec.
Saving all the graphs.
This run has a label: Jun.28_18.50.23. Visdom environment: tiny
