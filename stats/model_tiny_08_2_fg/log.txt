current path: saved_models/model_tiny_Jun.17_20.07.04
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 10, 30, 44, 55]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [89, 91, 69, 74, 59, 60, 29, 99, 17, 84].
___Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 325/896 (36.2723%)
___Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1345, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 326/1030 (31.6505%)
___Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 604/1030 (58.6408%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.3034, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.9425, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 483/1552 (31.1211%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 744/1552 (47.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.6963, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 313/1089 (28.7420%)
___Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   2, Avg loss: 0.0312, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2436, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 540/2227 (24.2479%)
___Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 997/2227 (44.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.6148, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 437/1440 (30.3472%)
___Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 633/1440 (43.9583%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8377, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 166/773 (21.4748%)
___Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   2, Avg loss: 0.0331, Accuracy: 369/773 (47.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8852, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 386/1574 (24.5235%)
___Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 666/1574 (42.3126%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9848, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.9426, Accuracy: 56/10000 (0.5600%)
time spent on training: 137.0749969482422
[foolsgold agg] training data poison_ratio: 0.1255561847746946  data num: [896, 1030, 590, 1552, 1089, 2227, 1440, 773, 1574, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.039236307742092066
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3169, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6204, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.84146881103516 sec.
Server Epoch:2 choose agents : [69, 51, 47, 25, 26, 30, 90, 31, 7, 55].
___Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   1, Avg loss: 0.0574, Accuracy: 274/590 (46.4407%)
___Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5446, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 534/1049 (50.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2696, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1213, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1100, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0580, Accuracy: 301/690 (43.6232%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.1382, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 310/1446 (21.4385%)
___Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 465/1446 (32.1577%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2760, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   1, Avg loss: 0.0817, Accuracy: 65/486 (13.3745%)
___Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   2, Avg loss: 0.0421, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7581, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 304/677 (44.9040%)
___Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9529, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 54/460 (11.7391%)
___Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 350/891 (39.2817%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9847, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   1, Avg loss: 0.0570, Accuracy: 242/1071 (22.5957%)
___Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7183, Accuracy: 74/10000 (0.7400%)
time spent on training: 138.96945714950562
[foolsgold agg] training data poison_ratio: 0.2077662129703763  data num: [590, 1049, 134, 690, 1446, 486, 677, 460, 891, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.06492694155324259
[foolsgold agg] wv: [1.         1.         0.81277291 1.         1.         0.9340153
 1.         0.81277291 0.9340153  1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.6770451068878 sec.
Server Epoch:3 choose agents : [81, 63, 8, 90, 20, 15, 4, 75, 0, 12].
___Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 235/774 (30.3618%)
___Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 298/774 (38.5013%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.1922, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 248/888 (27.9279%)
___Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 443/888 (49.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8993, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 216/1513 (14.2763%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 458/1513 (30.2710%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5743, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 463/677 (68.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1630, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6783, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0587, Accuracy: 319/1154 (27.6430%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 396/1154 (34.3154%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7936, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0610, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7596, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 237/776 (30.5412%)
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7128, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 368/1657 (22.2088%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5670, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.4540, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.910471200943
[foolsgold agg] training data poison_ratio: 0.25977859778597784  data num: [774, 888, 1513, 677, 807, 1154, 901, 776, 1657, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.08118081180811808
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3166, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.4121723175049 sec.
Server Epoch:4 choose agents : [22, 69, 34, 81, 7, 25, 43, 56, 14, 68].
___Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 535/1470 (36.3946%)
___Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 863/1470 (58.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9954, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   1, Avg loss: 0.0601, Accuracy: 272/590 (46.1017%)
___Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5753, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 375/1427 (26.2789%)
___Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8711, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   1, Avg loss: 0.0693, Accuracy: 237/774 (30.6202%)
___Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 278/774 (35.9173%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3557, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0269, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9254, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 299/690 (43.3333%)
___Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   2, Avg loss: 0.0290, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2241, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 323/946 (34.1438%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1234, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 218/1013 (21.5202%)
___Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 315/1013 (31.0958%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6504, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   1, Avg loss: 0.0634, Accuracy: 360/1163 (30.9544%)
___Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 433/1163 (37.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5536, Accuracy: 57/10000 (0.5700%)
time spent on training: 102.63860702514648
[foolsgold agg] training data poison_ratio: 0.0  data num: [1470, 590, 1427, 774, 891, 690, 946, 186, 1013, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3164, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6189, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.8293058872223 sec.
Server Epoch:5 choose agents : [66, 95, 59, 2, 56, 22, 50, 99, 97, 88].
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 260/1402 (18.5449%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 393/1402 (28.0314%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1563, Accuracy: 70/10000 (0.7000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 327/599 (54.5910%)
___Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5805, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   1, Avg loss: 0.0542, Accuracy: 289/1089 (26.5381%)
___Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 478/1089 (43.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2022, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 232/605 (38.3471%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0408, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8699, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 502/1470 (34.1497%)
___Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 873/1470 (59.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1240, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 139/809 (17.1817%)
___Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 354/809 (43.7577%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2391, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0680, Accuracy: 163/773 (21.0867%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0308, Accuracy: 370/773 (47.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1870, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0530, Accuracy: 356/1213 (29.3487%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 457/1213 (37.6752%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5402, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 132/603 (21.8905%)
___Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8160, Accuracy: 48/10000 (0.4800%)
time spent on training: 132.86165070533752
[foolsgold agg] training data poison_ratio: 0.06846496742484856  data num: [1402, 599, 1089, 605, 186, 1470, 809, 773, 1213, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.021395302320265173
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3163, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6182, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.93036675453186 sec.
Server Epoch:6 choose agents : [45, 90, 0, 20, 60, 91, 57, 35, 47, 74].
___Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   1, Avg loss: 0.0685, Accuracy: 189/669 (28.2511%)
___Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7587, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   1, Avg loss: 0.0591, Accuracy: 303/677 (44.7563%)
___Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 435/677 (64.2541%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9499, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 351/1657 (21.1829%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 511/1657 (30.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5718, Accuracy: 69/10000 (0.6900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 351/807 (43.4944%)
___Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.6583, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 560/2227 (25.1459%)
___Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1031/2227 (46.2955%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1387, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   1, Avg loss: 0.0514, Accuracy: 314/1030 (30.4854%)
___Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 631/1030 (61.2621%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4443, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   1, Avg loss: 0.0565, Accuracy: 301/1154 (26.0832%)
___Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   2, Avg loss: 0.0270, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.3363, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 31/271 (11.4391%)
___Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   2, Avg loss: 0.0548, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3639, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   1, Avg loss: 0.1265, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   2, Avg loss: 0.1094, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 478/1552 (30.7990%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 758/1552 (48.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 11.5840, Accuracy: 94/10000 (0.9400%)
time spent on training: 140.77090120315552
[foolsgold agg] training data poison_ratio: 0.39457653763018274  data num: [669, 677, 1657, 807, 2227, 1030, 1154, 271, 134, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.12330516800943211
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3162, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6169, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.8894546031952 sec.
Server Epoch:7 choose agents : [59, 65, 35, 25, 75, 57, 85, 89, 11, 97].
___Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 286/1089 (26.2626%)
___Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 455/1089 (41.7815%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0754, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 395/1475 (26.7797%)
___Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 669/1475 (45.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9407, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0572, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3647, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0564, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0286, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.4346, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   1, Avg loss: 0.0623, Accuracy: 246/776 (31.7010%)
___Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   2, Avg loss: 0.0329, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.7626, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   1, Avg loss: 0.0566, Accuracy: 299/1154 (25.9099%)
___Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 425/1154 (36.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2807, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 469/1988 (23.5915%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2554, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 326/896 (36.3839%)
___Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1817, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   1, Avg loss: 0.0554, Accuracy: 339/712 (47.6124%)
___Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 408/712 (57.3034%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3624, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 362/1213 (29.8434%)
___Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 500/1213 (41.2201%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9854, Accuracy: 78/10000 (0.7800%)
time spent on training: 165.66347765922546
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1475, 271, 690, 776, 1154, 1988, 896, 712, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3161, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6143, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.9338312149048 sec.
Server Epoch:8 choose agents : [69, 25, 14, 1, 63, 31, 49, 18, 13, 67].
___Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.9360, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 302/690 (43.7681%)
___Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3217, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 231/1013 (22.8036%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 328/1013 (32.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6286, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 288/928 (31.0345%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 578/928 (62.2845%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5797, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0552, Accuracy: 252/888 (28.3784%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 373/888 (42.0045%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2615, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   2, Avg loss: 0.0387, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7166, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   1, Avg loss: 0.0813, Accuracy: 15/440 (3.4091%)
___Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   2, Avg loss: 0.0494, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.5102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 120/530 (22.6415%)
___Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0403, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 293/1645 (17.8116%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 592/1645 (35.9878%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9211, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   1, Avg loss: 0.0793, Accuracy: 43/426 (10.0939%)
___Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   2, Avg loss: 0.0429, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.5535, Accuracy: 50/10000 (0.5000%)
time spent on training: 96.8396246433258
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 690, 1013, 928, 888, 460, 440, 530, 1645, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3159, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6137, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.07360768318176 sec.
Server Epoch:9 choose agents : [40, 90, 65, 14, 93, 30, 56, 82, 39, 99].
___Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 354/1573 (22.5048%)
___Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 552/1573 (35.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0627, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 311/677 (45.9380%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9247, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0556, Accuracy: 382/1475 (25.8983%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8941, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 221/1013 (21.8164%)
___Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 333/1013 (32.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.5964, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0562, Accuracy: 425/1742 (24.3972%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 692/1742 (39.7245%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9039, Accuracy: 81/10000 (0.8100%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   1, Avg loss: 0.0809, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6849, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 61/500 (12.2000%)
___Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6177, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 310/1013 (30.6022%)
___Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 450/1013 (44.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3137, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 185/773 (23.9327%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 389/773 (50.3234%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9467, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.9742455482483
[foolsgold agg] training data poison_ratio: 0.05149396058486968  data num: [1573, 677, 1475, 1013, 1742, 486, 186, 500, 1013, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.016091862682771775
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3157, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6119, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.6907413005829 sec.
Server Epoch:10 choose agents : [77, 16, 60, 47, 94, 33, 61, 95, 30, 6].
___Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 327/1340 (24.4030%)
___Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 526/1340 (39.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4351, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   1, Avg loss: 0.0611, Accuracy: 278/708 (39.2655%)
___Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9790, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 560/2227 (25.1459%)
___Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 983/2227 (44.1401%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8435, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   1, Avg loss: 0.1232, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   2, Avg loss: 0.1126, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 327/1662 (19.6751%)
___Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7114, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 66/515 (12.8155%)
___Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7080, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3048, Accuracy: 47/10000 (0.4700%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 322/599 (53.7563%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0268, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3397, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0813, Accuracy: 66/486 (13.5802%)
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7897, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 411/1956 (21.0123%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1956 (31.5951%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.4776, Accuracy: 111/10000 (1.1100%)
time spent on training: 144.81421494483948
[foolsgold agg] training data poison_ratio: 0.1117174629324547  data num: [1340, 708, 2227, 134, 1662, 515, 85, 599, 486, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.034911707166392095
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3156, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.77597403526306 sec.
Server Epoch:11 choose agents : [26, 84, 32, 6, 99, 13, 93, 12, 28, 15].
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 333/1446 (23.0290%)
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 494/1446 (34.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1332, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2588, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 352/735 (47.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6681, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 411/1956 (21.0123%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 646/1956 (33.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1782, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 184/773 (23.8034%)
___Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 424/773 (54.8512%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3301, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 637/1645 (38.7234%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7422, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 403/1742 (23.1343%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 692/1742 (39.7245%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0227, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0493, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4379, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 396/1581 (25.0474%)
___Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 571/1581 (36.1164%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5493, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 316/1154 (27.3830%)
___Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9687, Accuracy: 52/10000 (0.5200%)
time spent on training: 201.65451884269714
[foolsgold agg] training data poison_ratio: 0.0  data num: [1446, 1190, 735, 1956, 773, 1645, 1742, 338, 1581, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.86528112 1.
 1.         0.86528112 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6065, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.21875762939453 sec.
Server Epoch:12 choose agents : [39, 86, 0, 34, 36, 92, 67, 30, 23, 15].
___Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 315/1013 (31.0958%)
___Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 484/1013 (47.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7588, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0638, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 385/1003 (38.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5694, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 383/1657 (23.1141%)
___Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 523/1657 (31.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4561, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 367/1427 (25.7183%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7850, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0876, Accuracy: 77/408 (18.8725%)
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4593, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 474/1715 (27.6385%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 702/1715 (40.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4533, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 47/426 (11.0329%)
___Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.5415, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0815, Accuracy: 59/486 (12.1399%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7729, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 323/715 (45.1748%)
___Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   2, Avg loss: 0.0394, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7224, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 321/1154 (27.8163%)
___Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 385/1154 (33.3622%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6204, Accuracy: 50/10000 (0.5000%)
time spent on training: 141.85941219329834
[foolsgold agg] training data poison_ratio: 0.21421431427429027  data num: [1013, 1003, 1657, 1427, 408, 1715, 426, 486, 715, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.06694197321071571
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3152, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6053, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.041987657547 sec.
Server Epoch:13 choose agents : [38, 81, 76, 16, 60, 7, 18, 54, 50, 25].
___Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 243/1131 (21.4854%)
___Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 465/1131 (41.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.3076, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 237/774 (30.6202%)
___Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 283/774 (36.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1295, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 47/466 (10.0858%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6291, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.8723, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 555/2227 (24.9214%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 1038/2227 (46.6098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2903, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9837, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0767, Accuracy: 106/530 (20.0000%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.0082, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1130 (30.2655%)
___Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 479/1130 (42.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0287, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 143/809 (17.6761%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 337/809 (41.6564%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0686, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 303/690 (43.9130%)
___Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1854, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.62381172180176
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 774, 466, 708, 2227, 891, 530, 1130, 809, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3152, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6038, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.904732465744 sec.
Server Epoch:14 choose agents : [75, 69, 70, 66, 36, 76, 88, 65, 89, 30].
___Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   1, Avg loss: 0.0651, Accuracy: 245/776 (31.5722%)
___Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9400, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 285/590 (48.3051%)
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0330, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.7645, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 337/1418 (23.7659%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 660/1418 (46.5444%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5835, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 262/1402 (18.6876%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 402/1402 (28.6733%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0120, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 71/408 (17.4020%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0568, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4744, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   1, Avg loss: 0.0870, Accuracy: 35/466 (7.5107%)
___Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6561, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   1, Avg loss: 0.0750, Accuracy: 128/603 (21.2272%)
___Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.9972, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 371/1475 (25.1525%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 686/1475 (46.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8497, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 333/896 (37.1652%)
___Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.3876, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   1, Avg loss: 0.0803, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   2, Avg loss: 0.0417, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.7831, Accuracy: 42/10000 (0.4200%)
time spent on training: 121.50238347053528
[foolsgold agg] training data poison_ratio: 0.05704225352112676  data num: [776, 590, 1418, 1402, 408, 466, 603, 1475, 896, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.017825704225352113
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3150, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6019, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.0043785572052 sec.
Server Epoch:15 choose agents : [75, 67, 89, 84, 27, 45, 19, 70, 41, 20].
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0633, Accuracy: 250/776 (32.2165%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.7183, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 43/426 (10.0939%)
___Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   2, Avg loss: 0.0425, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5747, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   1, Avg loss: 0.0623, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2276, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 311/1190 (26.1345%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8627, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 450/1587 (28.3554%)
___Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 591/1587 (37.2401%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2735, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   1, Avg loss: 0.0689, Accuracy: 196/669 (29.2975%)
___Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7085, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   1, Avg loss: 0.0474, Accuracy: 375/1036 (36.1969%)
___Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 634/1036 (61.1969%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.0600, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 377/1418 (26.5867%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 677/1418 (47.7433%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8351, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0575, Accuracy: 333/719 (46.3143%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0328, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3024, Accuracy: 55/10000 (0.5500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 343/807 (42.5031%)
___Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0539, Accuracy: 50/10000 (0.5000%)
time spent on training: 175.84472918510437
[foolsgold agg] training data poison_ratio: 0.08473330533389332  data num: [776, 426, 896, 1190, 1587, 669, 1036, 1418, 719, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.026479157916841665
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3149, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6013, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.4647982120514 sec.
Server Epoch:16 choose agents : [25, 23, 76, 70, 85, 6, 68, 74, 63, 35].
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0582, Accuracy: 297/690 (43.0435%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1306, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0620, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7215, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 35/466 (7.5107%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6238, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 332/1418 (23.4133%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 592/1418 (41.7489%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7734, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 431/1988 (21.6801%)
___Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 651/1988 (32.7465%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8291, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 392/1956 (20.0409%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 644/1956 (32.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1803, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 369/1163 (31.7283%)
___Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   2, Avg loss: 0.0378, Accuracy: 400/1163 (34.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.8888, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 501/1552 (32.2809%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 751/1552 (48.3892%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.2104, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 261/888 (29.3919%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 448/888 (50.4505%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7319, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 36/271 (13.2841%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3638, Accuracy: 52/10000 (0.5200%)
time spent on training: 139.21080875396729
[foolsgold agg] training data poison_ratio: 0.13973170072926983  data num: [690, 715, 466, 1418, 1988, 1956, 1163, 1552, 888, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.04366615647789682
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3148, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6019, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.44941091537476 sec.
Server Epoch:17 choose agents : [38, 31, 29, 86, 59, 67, 35, 24, 5, 46].
___Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 242/1131 (21.3970%)
___Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2259, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 51/460 (11.0870%)
___Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6708, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 442/1440 (30.6944%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9620, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 382/1003 (38.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.6721, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   1, Avg loss: 0.0600, Accuracy: 314/1089 (28.8338%)
___Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3752, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 44/426 (10.3286%)
___Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   2, Avg loss: 0.0427, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.5413, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 44/271 (16.2362%)
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3630, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 27/312 (8.6538%)
___Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   2, Avg loss: 0.0416, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3786, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 410/1628 (25.1843%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 832/1628 (51.1057%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1876, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 424/1904 (22.2689%)
___Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 667/1904 (35.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8486, Accuracy: 88/10000 (0.8800%)
time spent on training: 168.112797498703
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 460, 1440, 1003, 1089, 426, 271, 312, 1628, 1904]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3147, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6023, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.86193466186523 sec.
Server Epoch:18 choose agents : [82, 96, 3, 25, 2, 8, 84, 54, 78, 31].
___Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 58/500 (11.6000%)
___Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6544, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 41/311 (13.1833%)
___Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3453, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 104/781 (13.3163%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.5841, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3655, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 232/605 (38.3471%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7600, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 248/1513 (16.3913%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 493/1513 (32.5843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5527, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1554, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 488/1130 (43.1858%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6503, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 38/416 (9.1346%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0483, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5458, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   1, Avg loss: 0.0828, Accuracy: 50/460 (10.8696%)
___Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7897, Accuracy: 50/10000 (0.5000%)
time spent on training: 119.94706416130066
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 311, 781, 690, 605, 1513, 1190, 1130, 416, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3146, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6025, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.2040193080902 sec.
Server Epoch:19 choose agents : [7, 92, 38, 18, 96, 99, 22, 64, 12, 16].
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 439/891 (49.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9021, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 448/1715 (26.1224%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 696/1715 (40.5831%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6900, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 482/1131 (42.6172%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1171, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 259/530 (48.8679%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.1307, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 48/311 (15.4341%)
___Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3442, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 168/773 (21.7335%)
___Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 397/773 (51.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9976, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 543/1470 (36.9388%)
___Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 846/1470 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1886, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 169/953 (17.7335%)
___Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 319/953 (33.4732%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.3302, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4309, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0616, Accuracy: 274/708 (38.7006%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8046, Accuracy: 66/10000 (0.6600%)
time spent on training: 163.10093808174133
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 1715, 1131, 530, 311, 773, 1470, 953, 338, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.87490096
 1.         1.         0.87490096 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3145, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6007, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.5227520465851 sec.
Server Epoch:20 choose agents : [81, 15, 59, 7, 68, 53, 76, 56, 63, 11].
___Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   2, Avg loss: 0.0357, Accuracy: 316/774 (40.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1875, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0555, Accuracy: 331/1154 (28.6828%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 503/1154 (43.5875%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8747, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 305/1089 (28.0073%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 495/1089 (45.4545%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1253, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 352/891 (39.5062%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7749, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   1, Avg loss: 0.0620, Accuracy: 370/1163 (31.8143%)
___Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 443/1163 (38.0911%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7200, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 288/813 (35.4244%)
___Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 444/813 (54.6125%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.1220, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 39/466 (8.3691%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.6052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 260/888 (29.2793%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 461/888 (51.9144%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4442, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.4830, Accuracy: 50/10000 (0.5000%)
time spent on training: 119.5036289691925
[foolsgold agg] training data poison_ratio: 0.0  data num: [774, 1154, 1089, 891, 1163, 813, 466, 186, 888, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3145, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.6011, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.83881282806396 sec.
Server Epoch:21 choose agents : [0, 18, 27, 50, 82, 44, 79, 20, 69, 23].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0567, Accuracy: 394/1657 (23.7779%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0343, Accuracy: 634/1657 (38.2619%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0297, Accuracy: 701/1657 (42.3054%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0291, Accuracy: 731/1657 (44.1159%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0284, Accuracy: 747/1657 (45.0815%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0272, Accuracy: 802/1657 (48.4007%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0268, Accuracy: 795/1657 (47.9783%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0262, Accuracy: 826/1657 (49.8491%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0256, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0260, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Global model norm: 112.05517526954077.
Norm before scaling: 112.02891385290897. Distance: 1.2255023821430564
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5773, Accuracy: 46/10000 (0.4600%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.7084, Accuracy: 9651/9950 (96.9950%)
Scaling by  100
Scaled Norm after poisoning: 163.81818713897428, distance: 122.55023682912653
Total norm for 3 adversaries is: 163.81818713897428. distance: 122.55023682912653
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   1, Avg loss: 0.0765, Accuracy: 107/530 (20.1887%)
___Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.0829, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 425/1587 (26.7801%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 596/1587 (37.5551%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1130, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 141/809 (17.4289%)
___Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 326/809 (40.2967%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4973, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.6119, Accuracy: 52/10000 (0.5200%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 396/1750 (22.6286%)
___Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5889, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   1, Avg loss: 0.1007, Accuracy: 19/197 (9.6447%)
___Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3227, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.8633, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 289/590 (48.9831%)
___Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7068, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.7816, Accuracy: 50/10000 (0.5000%)
time spent on training: 258.68248891830444
[foolsgold agg] training data poison_ratio: 0.4609494640122512  data num: [1657, 530, 1587, 809, 500, 1750, 197, 807, 590, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.1440467075038285
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3144, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5977, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.7106728553772 sec.
Server Epoch:22 choose agents : [12, 23, 52, 19, 80, 2, 44, 8, 82, 58].
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0878, Accuracy: 24/338 (7.1006%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0500, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4495, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   2, Avg loss: 0.0394, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7115, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   1, Avg loss: 0.0578, Accuracy: 277/636 (43.5535%)
___Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0870, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   1, Avg loss: 0.0465, Accuracy: 398/1036 (38.4170%)
___Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 659/1036 (63.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.2373, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 140/682 (20.5279%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3599, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 235/605 (38.8430%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7830, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 401/1750 (22.9143%)
___Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 667/1750 (38.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8373, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 243/1513 (16.0608%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 484/1513 (31.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4659, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6288, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0581, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9627, Accuracy: 51/10000 (0.5100%)
time spent on training: 152.62122464179993
[foolsgold agg] training data poison_ratio: 0.20401025880158546  data num: [338, 715, 636, 1036, 682, 605, 1750, 1513, 500, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.06375320587549546
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3143, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5977, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.4241027832031 sec.
Server Epoch:23 choose agents : [20, 9, 57, 74, 2, 92, 23, 81, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0603, Accuracy: 230/807 (28.5006%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0346, Accuracy: 362/807 (44.8575%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0291, Accuracy: 411/807 (50.9294%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0286, Accuracy: 410/807 (50.8055%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0277, Accuracy: 426/807 (52.7881%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0255, Accuracy: 465/807 (57.6208%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0256, Accuracy: 473/807 (58.6121%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0243, Accuracy: 471/807 (58.3643%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0242, Accuracy: 471/807 (58.3643%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0239, Accuracy: 485/807 (60.0991%), train_poison_data_count: 260
Global model norm: 112.05507068931553.
Norm before scaling: 112.04428097157614. Distance: 0.8659813199198022
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3645, Accuracy: 69/10000 (0.6900%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.8924, Accuracy: 8635/9950 (86.7839%)
Scaling by  100
Scaled Norm after poisoning: 140.49519008670723, distance: 86.59812556610275
Total norm for 2 adversaries is: 140.49519008670723. distance: 86.59812556610275
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 348/1275 (27.2941%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 678/1275 (53.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3180, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 310/1154 (26.8631%)
___Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 498/1154 (43.1542%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8894, Accuracy: 57/10000 (0.5700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 461/1552 (29.7036%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 760/1552 (48.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.4996, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8604, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   1, Avg loss: 0.0510, Accuracy: 474/1715 (27.6385%)
___Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 721/1715 (42.0408%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8345, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   1, Avg loss: 0.0618, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7443, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0673, Accuracy: 240/774 (31.0078%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0370, Accuracy: 294/774 (37.9845%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.1405, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 107/781 (13.7004%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 219/781 (28.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5585, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 385/1628 (23.6486%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 824/1628 (50.6143%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2794, Accuracy: 124/10000 (1.2400%)
time spent on training: 241.63398265838623
[foolsgold agg] training data poison_ratio: 0.21433763401780848  data num: [807, 1275, 1154, 1552, 605, 1715, 715, 774, 781, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.06698051063056515
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3141, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5958, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.24976992607117 sec.
Server Epoch:24 choose agents : [67, 87, 90, 88, 15, 72, 3, 12, 54, 76].
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 41/426 (9.6244%)
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0412, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5907, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 297/1131 (26.2599%)
___Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 427/1131 (37.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8114, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 316/677 (46.6765%)
___Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.4784, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 134/603 (22.2222%)
___Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.8370, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 385/1154 (33.3622%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9797, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 258/1241 (20.7897%)
___Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.2557, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0753, Accuracy: 109/781 (13.9565%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4791, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   2, Avg loss: 0.0459, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.4646, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 341/1130 (30.1770%)
___Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 449/1130 (39.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3291, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 43/466 (9.2275%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6527, Accuracy: 50/10000 (0.5000%)
time spent on training: 168.77642130851746
[foolsgold agg] training data poison_ratio: 0.0  data num: [426, 1131, 677, 603, 1154, 1241, 781, 338, 1130, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3140, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5958, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.2349238395691 sec.
Server Epoch:25 choose agents : [74, 16, 75, 48, 28, 58, 93, 17, 20, 34].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0478, Accuracy: 392/1552 (25.2577%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0232, Accuracy: 680/1552 (43.8144%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0205, Accuracy: 822/1552 (52.9639%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0195, Accuracy: 872/1552 (56.1856%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0188, Accuracy: 929/1552 (59.8582%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0181, Accuracy: 946/1552 (60.9536%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0182, Accuracy: 938/1552 (60.4381%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0172, Accuracy: 994/1552 (64.0464%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0174, Accuracy: 972/1552 (62.6289%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0170, Accuracy: 982/1552 (63.2732%), train_poison_data_count: 496
Global model norm: 112.05494867892939.
Norm before scaling: 112.03166840926052. Distance: 1.2672932309068872
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.8369, Accuracy: 88/10000 (0.8800%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.7213, Accuracy: 8176/9950 (82.1709%)
Scaling by  100
Scaled Norm after poisoning: 167.13594415362903, distance: 126.72932292513245
Total norm for 2 adversaries is: 167.13594415362903. distance: 126.72932292513245
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0618, Accuracy: 285/708 (40.2542%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7558, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   1, Avg loss: 0.0624, Accuracy: 248/776 (31.9588%)
___Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.8230, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 102/631 (16.1648%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 224/631 (35.4992%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8696, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 368/1581 (23.2764%)
___Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 556/1581 (35.1676%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.4518, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 357/803 (44.4583%)
___Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 371/803 (46.2017%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.9407, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 399/1742 (22.9047%)
___Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 720/1742 (41.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8110, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 387/1574 (24.5870%)
___Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.2325, Accuracy: 97/10000 (0.9700%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 349/807 (43.2466%)
___Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.0986, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 387/1427 (27.1198%)
___Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 579/1427 (40.5746%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.0258, Accuracy: 77/10000 (0.7700%)
time spent on training: 327.8243405818939
[foolsgold agg] training data poison_ratio: 0.20334453926385657  data num: [1552, 708, 776, 631, 1581, 803, 1742, 1574, 807, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.06354516851995518
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3137, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5900, Accuracy: 0/9950 (0.0000%)
saving model
Done in 461.06497740745544 sec.
Server Epoch:26 choose agents : [17, 3, 87, 52, 86, 61, 79, 80, 49, 59].
___Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 402/1574 (25.5400%)
___Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 690/1574 (43.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.3542, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0747, Accuracy: 110/781 (14.0845%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6936, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 293/1131 (25.9063%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5634, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 279/636 (43.8679%)
___Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.2026, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0624, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.5998, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3042, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.0991, Accuracy: 19/197 (9.6447%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0806, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3214, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0707, Accuracy: 134/682 (19.6481%)
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.2286, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0808, Accuracy: 29/440 (6.5909%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4831, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 329/1089 (30.2112%)
___Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 482/1089 (44.2608%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2433, Accuracy: 58/10000 (0.5800%)
time spent on training: 118.41104412078857
[foolsgold agg] training data poison_ratio: 0.0  data num: [1574, 781, 1131, 636, 1003, 85, 197, 682, 440, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3136, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5894, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.49339127540588 sec.
Server Epoch:27 choose agents : [95, 46, 85, 8, 54, 90, 27, 15, 74, 44].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0652, Accuracy: 193/599 (32.2204%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0256, Accuracy: 317/599 (52.9215%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0257, Accuracy: 367/599 (61.2688%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0260, Accuracy: 394/599 (65.7763%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0225, Accuracy: 409/599 (68.2805%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0213, Accuracy: 439/599 (73.2888%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0227, Accuracy: 428/599 (71.4524%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0208, Accuracy: 431/599 (71.9533%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0214, Accuracy: 450/599 (75.1252%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0214, Accuracy: 440/599 (73.4558%), train_poison_data_count: 200
Global model norm: 112.05484409849268.
Norm before scaling: 112.04732712396579. Distance: 0.800358656118663
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5419, Accuracy: 49/10000 (0.4900%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6508, Accuracy: 6414/9950 (64.4623%)
Scaling by  100
Scaled Norm after poisoning: 136.8550427802169, distance: 80.03586842394478
Total norm for 3 adversaries is: 136.8550427802169. distance: 80.03586842394478
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 415/1904 (21.7962%)
___Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 652/1904 (34.2437%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7329, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 438/1988 (22.0322%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 699/1988 (35.1610%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0306, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 256/1513 (16.9200%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 485/1513 (32.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5803, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 484/1130 (42.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6742, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0768, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 425/1587 (26.7801%)
___Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 631/1587 (39.7606%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1532, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 322/1154 (27.9029%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0312, Accuracy: 491/1154 (42.5477%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6705, Accuracy: 66/10000 (0.6600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 481/1552 (30.9923%)
___Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 775/1552 (49.9356%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.3629, Accuracy: 79/10000 (0.7900%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 379/1750 (21.6571%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 658/1750 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6498, Accuracy: 112/10000 (1.1200%)
time spent on training: 269.9243655204773
[foolsgold agg] training data poison_ratio: 0.2815793272701025  data num: [599, 1904, 1988, 1513, 1130, 677, 1587, 1154, 1552, 1750]
[foolsgold agg] considering poison per batch poison_fraction: 0.08799353977190702
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3135, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5909, Accuracy: 0/9950 (0.0000%)
saving model
Done in 398.086790561676 sec.
Server Epoch:28 choose agents : [46, 17, 59, 22, 99, 72, 52, 98, 91, 82].
___Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   1, Avg loss: 0.0552, Accuracy: 431/1904 (22.6366%)
___Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 667/1904 (35.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6322, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 400/1574 (25.4130%)
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 690/1574 (43.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2598, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 310/1089 (28.4665%)
___Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 496/1089 (45.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0921, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 505/1470 (34.3537%)
___Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 810/1470 (55.1020%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9661, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   1, Avg loss: 0.0667, Accuracy: 170/773 (21.9922%)
___Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1262, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 251/1241 (20.2256%)
___Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1548, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 277/636 (43.5535%)
___Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.2187, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 23/373 (6.1662%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.4437, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0519, Accuracy: 341/1030 (33.1068%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3938, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7115, Accuracy: 52/10000 (0.5200%)
time spent on training: 132.380033493042
[foolsgold agg] training data poison_ratio: 0.0  data num: [1904, 1574, 1089, 1470, 773, 1241, 636, 373, 1030, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3134, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5906, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.2523148059845 sec.
Server Epoch:29 choose agents : [10, 7, 89, 13, 63, 58, 93, 74, 67, 70].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0624, Accuracy: 164/861 (19.0476%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0278, Accuracy: 313/861 (36.3531%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0232, Accuracy: 417/861 (48.4321%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0223, Accuracy: 409/861 (47.5029%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0218, Accuracy: 403/861 (46.8060%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0219, Accuracy: 437/861 (50.7549%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0213, Accuracy: 442/861 (51.3357%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0206, Accuracy: 459/861 (53.3101%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0202, Accuracy: 471/861 (54.7038%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0203, Accuracy: 460/861 (53.4262%), train_poison_data_count: 280
Global model norm: 112.05472644538472.
Norm before scaling: 112.04479956416986. Distance: 1.042718064259267
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.3181, Accuracy: 90/10000 (0.9000%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.9594, Accuracy: 8485/9950 (85.2764%)
Scaling by  100
Scaled Norm after poisoning: 151.9792851838697, distance: 104.27180995629882
Total norm for 2 adversaries is: 151.9792851838697. distance: 104.27180995629882
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 360/891 (40.4040%)
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 470/891 (52.7497%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1521, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0353, Accuracy: 406/896 (45.3125%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2901, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 323/1645 (19.6353%)
___Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 603/1645 (36.6565%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6686, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 257/888 (28.9414%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 381/888 (42.9054%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3641, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 352/803 (43.8356%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.9559, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 422/1742 (24.2250%)
___Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 712/1742 (40.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7592, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 432/1552 (27.8351%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1357, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   1, Avg loss: 0.0784, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5498, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1418 (24.1185%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 618/1418 (43.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6066, Accuracy: 112/10000 (1.1200%)
time spent on training: 271.1334662437439
[foolsgold agg] training data poison_ratio: 0.21695738176586946  data num: [861, 891, 896, 1645, 888, 803, 1742, 1552, 426, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.06779918180183421
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5844, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.50037932395935 sec.
Server Epoch:30 choose agents : [65, 62, 75, 52, 98, 71, 47, 25, 1, 15].
___Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   1, Avg loss: 0.0575, Accuracy: 394/1475 (26.7119%)
___Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 678/1475 (45.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.2298, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.7604, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   1, Avg loss: 0.0639, Accuracy: 253/776 (32.6031%)
___Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.9758, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 284/636 (44.6541%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.1101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   1, Avg loss: 0.0824, Accuracy: 19/373 (5.0938%)
___Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.4419, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 152/818 (18.5819%)
___Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 349/818 (42.6650%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1817, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   2, Avg loss: 0.1116, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 313/690 (45.3623%)
___Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   2, Avg loss: 0.0288, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.5254, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 291/928 (31.3578%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5546, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0557, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 492/1154 (42.6343%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6508, Accuracy: 52/10000 (0.5200%)
time spent on training: 127.28200173377991
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 568, 776, 636, 373, 818, 134, 690, 928, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3132, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5836, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.01363730430603 sec.
Server Epoch:31 choose agents : [30, 71, 96, 55, 75, 32, 34, 20, 1, 65].
poison local model 30 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Average loss: 0.0822, Accuracy: 51/486 (10.4938%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Average loss: 0.0430, Accuracy: 175/486 (36.0082%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   3, Average loss: 0.0358, Accuracy: 175/486 (36.0082%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   4, Average loss: 0.0367, Accuracy: 179/486 (36.8313%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   5, Average loss: 0.0334, Accuracy: 172/486 (35.3909%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   6, Average loss: 0.0323, Accuracy: 198/486 (40.7407%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   7, Average loss: 0.0320, Accuracy: 191/486 (39.3004%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   8, Average loss: 0.0317, Accuracy: 219/486 (45.0617%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   9, Average loss: 0.0315, Accuracy: 236/486 (48.5597%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch  10, Average loss: 0.0321, Accuracy: 196/486 (40.3292%), train_poison_data_count: 160
Global model norm: 112.05461314968251.
Norm before scaling: 112.04922275639622. Distance: 0.717261722355887
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3183, Accuracy: 58/10000 (0.5800%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 1.0110, Accuracy: 7298/9950 (73.3467%)
Scaling by  100
Scaled Norm after poisoning: 132.39448186433225, distance: 71.72617404385062
Total norm for 3 adversaries is: 132.39448186433225. distance: 71.72617404385062
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 152/818 (18.5819%)
___Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.0303, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3451, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 241/1071 (22.5023%)
___Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 495/1071 (46.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9901, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 250/776 (32.2165%)
___Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 424/776 (54.6392%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8029, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 197/735 (26.8027%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8442, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 389/1427 (27.2600%)
___Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.9241, Accuracy: 58/10000 (0.5800%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   1, Avg loss: 0.0561, Accuracy: 358/807 (44.3618%)
___Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 435/807 (53.9033%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1512, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 291/928 (31.3578%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 565/928 (60.8836%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6485, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 384/1475 (26.0339%)
___Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 687/1475 (46.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8446, Accuracy: 95/10000 (0.9500%)
time spent on training: 249.10196018218994
[foolsgold agg] training data poison_ratio: 0.26760244509848313  data num: [486, 818, 311, 1071, 776, 735, 1427, 807, 928, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.08362576409327598
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3131, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5779, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.2386407852173 sec.
Server Epoch:32 choose agents : [65, 23, 30, 72, 95, 33, 28, 49, 21, 55].
___Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 400/1475 (27.1186%)
___Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 657/1475 (44.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.8509, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7762, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   1, Avg loss: 0.0799, Accuracy: 77/486 (15.8436%)
___Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7789, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0622, Accuracy: 243/1241 (19.5810%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 397/1241 (31.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.0773, Accuracy: 54/10000 (0.5400%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0521, Accuracy: 328/599 (54.7579%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5159, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   2, Avg loss: 0.0488, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7903, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 366/1581 (23.1499%)
___Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 586/1581 (37.0651%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6416, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0807, Accuracy: 21/440 (4.7727%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.4950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 424/1949 (21.7547%)
___Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 637/1949 (32.6834%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.3298, Accuracy: 87/10000 (0.8700%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 252/1071 (23.5294%)
___Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.1251, Accuracy: 53/10000 (0.5300%)
time spent on training: 183.69447112083435
[foolsgold agg] training data poison_ratio: 0.21405877680698968  data num: [1475, 715, 486, 1241, 599, 515, 1581, 440, 1949, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.06689336775218427
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3130, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5767, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.13868832588196 sec.
Server Epoch:33 choose agents : [44, 90, 9, 28, 97, 86, 63, 52, 14, 85].
poison local model 44 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Average loss: 0.0582, Accuracy: 432/1750 (24.6857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Average loss: 0.0342, Accuracy: 686/1750 (39.2000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   3, Average loss: 0.0301, Accuracy: 764/1750 (43.6571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   4, Average loss: 0.0286, Accuracy: 869/1750 (49.6571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   5, Average loss: 0.0274, Accuracy: 923/1750 (52.7429%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   6, Average loss: 0.0266, Accuracy: 928/1750 (53.0286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   7, Average loss: 0.0265, Accuracy: 944/1750 (53.9429%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   8, Average loss: 0.0258, Accuracy: 984/1750 (56.2286%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   9, Average loss: 0.0253, Accuracy: 975/1750 (55.7143%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch  10, Average loss: 0.0255, Accuracy: 978/1750 (55.8857%), train_poison_data_count: 560
Global model norm: 112.05450856893265.
Norm before scaling: 112.02571028841996. Distance: 1.2584677464440743
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3714, Accuracy: 103/10000 (1.0300%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.4652, Accuracy: 9685/9950 (97.3367%)
Scaling by  100
Scaled Norm after poisoning: 166.10177250145466, distance: 125.84676477019582
Total norm for 1 adversaries is: 166.10177250145466. distance: 125.84676477019582
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   1, Avg loss: 0.0557, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5173, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 344/1275 (26.9804%)
___Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 688/1275 (53.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.0584, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 384/1581 (24.2884%)
___Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 576/1581 (36.4326%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5009, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 351/1213 (28.9365%)
___Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 506/1213 (41.7148%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7309, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 362/1003 (36.0917%)
___Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 394/1003 (39.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.5470, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 261/888 (29.3919%)
___Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 450/888 (50.6757%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1904, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 286/636 (44.9686%)
___Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   2, Avg loss: 0.0325, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.2202, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 217/1013 (21.4215%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 291/1013 (28.7266%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.6117, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 416/1988 (20.9256%)
___Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 670/1988 (33.7022%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8900, Accuracy: 75/10000 (0.7500%)
time spent on training: 278.9641170501709
[foolsgold agg] training data poison_ratio: 0.145542248835662  data num: [1750, 677, 1275, 1581, 1213, 1003, 888, 636, 1013, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.045481952761144376
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3129, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5744, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.73199701309204 sec.
Server Epoch:34 choose agents : [75, 51, 83, 60, 39, 88, 49, 64, 59, 13].
___Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   1, Avg loss: 0.0648, Accuracy: 252/776 (32.4742%)
___Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 418/776 (53.8660%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.1453, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 221/1049 (21.0677%)
___Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.5253, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 443/1953 (22.6831%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 760/1953 (38.9145%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0479, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 605/2227 (27.1666%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1037, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   1, Avg loss: 0.0538, Accuracy: 311/1013 (30.7009%)
___Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 472/1013 (46.5943%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.2729, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 136/603 (22.5539%)
___Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   2, Avg loss: 0.0455, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.9993, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0806, Accuracy: 23/440 (5.2273%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 153/440 (34.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.5056, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   1, Avg loss: 0.0645, Accuracy: 171/953 (17.9433%)
___Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4340, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 302/1089 (27.7319%)
___Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.6057, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 311/1645 (18.9058%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 608/1645 (36.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9150, Accuracy: 109/10000 (1.0900%)
time spent on training: 163.75133347511292
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 1049, 1953, 2227, 1013, 603, 440, 953, 1089, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3127, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5702, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.87549471855164 sec.
Server Epoch:35 choose agents : [55, 53, 77, 15, 26, 52, 33, 82, 60, 63].
poison local model 55 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   1, Average loss: 0.0593, Accuracy: 232/1071 (21.6620%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   2, Average loss: 0.0312, Accuracy: 379/1071 (35.3875%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   3, Average loss: 0.0273, Accuracy: 447/1071 (41.7367%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   4, Average loss: 0.0265, Accuracy: 503/1071 (46.9655%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   5, Average loss: 0.0254, Accuracy: 534/1071 (49.8599%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   6, Average loss: 0.0248, Accuracy: 550/1071 (51.3539%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   7, Average loss: 0.0253, Accuracy: 548/1071 (51.1671%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   8, Average loss: 0.0247, Accuracy: 559/1071 (52.1942%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   9, Average loss: 0.0231, Accuracy: 602/1071 (56.2092%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch  10, Average loss: 0.0234, Accuracy: 584/1071 (54.5285%), train_poison_data_count: 340
Global model norm: 112.05439527301016.
Norm before scaling: 112.03930846191885. Distance: 1.0348173342407132
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4703, Accuracy: 79/10000 (0.7900%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.9044, Accuracy: 9007/9950 (90.5226%)
Scaling by  100
Scaled Norm after poisoning: 151.0609096937391, distance: 103.48174091657427
Total norm for 1 adversaries is: 151.0609096937391. distance: 103.48174091657427
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 284/813 (34.9323%)
___Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 475/813 (58.4256%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.5890, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 323/1340 (24.1045%)
___Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 555/1340 (41.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6856, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 532/1154 (46.1005%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8583, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 334/1446 (23.0982%)
___Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2962, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 284/636 (44.6541%)
___Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.3202, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 68/515 (13.2039%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7561, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 63/500 (12.6000%)
___Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.6513, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 558/2227 (25.0561%)
___Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1003/2227 (45.0382%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1613, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   1, Avg loss: 0.0548, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 415/888 (46.7342%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1616, Accuracy: 50/10000 (0.5000%)
time spent on training: 255.39624786376953
[foolsgold agg] training data poison_ratio: 0.10113314447592069  data num: [1071, 813, 1340, 1154, 1446, 636, 515, 500, 2227, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.03160410764872521
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3127, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5683, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.51905250549316 sec.
Server Epoch:36 choose agents : [13, 2, 71, 52, 77, 36, 14, 45, 7, 65].
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 317/1645 (19.2705%)
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 600/1645 (36.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9158, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0616, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0407, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9053, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 164/818 (20.0489%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0905, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0573, Accuracy: 284/636 (44.6541%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.1642, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 321/1340 (23.9552%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 562/1340 (41.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0122, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   1, Avg loss: 0.0879, Accuracy: 64/408 (15.6863%)
___Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4819, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 369/1013 (36.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.6224, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 205/669 (30.6428%)
___Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8146, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2583, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 371/1475 (25.1525%)
___Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 698/1475 (47.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9587, Accuracy: 82/10000 (0.8200%)
time spent on training: 150.56367230415344
[foolsgold agg] training data poison_ratio: 0.0  data num: [1645, 605, 818, 636, 1340, 408, 1013, 669, 891, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3126, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5676, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.50641322135925 sec.
Server Epoch:37 choose agents : [47, 82, 46, 56, 36, 98, 76, 12, 35, 63].
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1233, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1091, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.6055, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 418/1904 (21.9538%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 671/1904 (35.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7887, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 79/408 (19.3627%)
___Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   2, Avg loss: 0.0556, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.4988, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 23/373 (6.1662%)
___Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.4237, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 35/466 (7.5107%)
___Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.6130, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 19/338 (5.6213%)
___Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.4388, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 41/271 (15.1292%)
___Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   2, Avg loss: 0.0570, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3674, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 258/888 (29.0541%)
___Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 451/888 (50.7883%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.8657, Accuracy: 54/10000 (0.5400%)
time spent on training: 116.35708284378052
[foolsgold agg] training data poison_ratio: 0.0  data num: [134, 500, 1904, 186, 408, 373, 466, 338, 271, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3125, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5680, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.72506713867188 sec.
Server Epoch:38 choose agents : [20, 56, 26, 83, 27, 50, 1, 89, 4, 41].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 353/807 (43.7423%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8929, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 350/1446 (24.2047%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 473/1446 (32.7109%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.2084, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 446/1953 (22.8367%)
___Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 766/1953 (39.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.8424, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 432/1587 (27.2212%)
___Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 583/1587 (36.7360%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4730, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 158/809 (19.5303%)
___Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.2567, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0559, Accuracy: 287/928 (30.9267%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6701, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 447/896 (49.8884%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.2747, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 333/901 (36.9589%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 382/901 (42.3973%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1024, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0582, Accuracy: 333/719 (46.3143%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0327, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.2233, Accuracy: 53/10000 (0.5300%)
time spent on training: 175.85347890853882
[foolsgold agg] training data poison_ratio: 0.07887021110242377  data num: [807, 186, 1446, 1953, 1587, 809, 928, 896, 901, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.02464694096950743
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3124, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5679, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.57995533943176 sec.
Server Epoch:39 choose agents : [45, 63, 78, 36, 55, 93, 46, 8, 18, 28].
___Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 199/669 (29.7459%)
___Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.7489, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 259/888 (29.1667%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4321, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   1, Avg loss: 0.0839, Accuracy: 37/416 (8.8942%)
___Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.5839, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.4869, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 501/1071 (46.7787%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0146, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 394/1742 (22.6177%)
___Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 714/1742 (40.9874%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8534, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 415/1904 (21.7962%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 670/1904 (35.1891%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5884, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 247/1513 (16.3252%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 485/1513 (32.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.2234, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   2, Avg loss: 0.0434, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.1296, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 370/1581 (23.4029%)
___Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 590/1581 (37.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6599, Accuracy: 92/10000 (0.9200%)
time spent on training: 170.29634809494019
[foolsgold agg] training data poison_ratio: 0.09988808058198097  data num: [669, 888, 416, 408, 1071, 1742, 1904, 1513, 530, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.03121502518186905
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3123, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5678, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.25052666664124 sec.
Server Epoch:40 choose agents : [63, 47, 34, 98, 70, 76, 77, 11, 84, 87].
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 265/888 (29.8423%)
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1244, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1229, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1075, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 369/1427 (25.8584%)
___Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 586/1427 (41.0652%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.8595, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 23/373 (6.1662%)
___Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.4520, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 331/1418 (23.3427%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 619/1418 (43.6530%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7787, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 48/466 (10.3004%)
___Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   2, Avg loss: 0.0505, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.6648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 333/1340 (24.8507%)
___Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 576/1340 (42.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8560, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   1, Avg loss: 0.0568, Accuracy: 343/712 (48.1742%)
___Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 376/712 (52.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.3555, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 483/1190 (40.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.0416, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 410/1131 (36.2511%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6834, Accuracy: 50/10000 (0.5000%)
time spent on training: 150.50634002685547
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 134, 1427, 373, 1418, 466, 1340, 712, 1190, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3123, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5684, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 286.50638365745544 sec.
Server Epoch:41 choose agents : [59, 2, 68, 89, 47, 69, 90, 26, 96, 40].
___Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   1, Avg loss: 0.0591, Accuracy: 330/1089 (30.3030%)
___Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   2, Avg loss: 0.0274, Accuracy: 439/1089 (40.3122%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5215, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0621, Accuracy: 230/605 (38.0165%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8062, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 373/1163 (32.0722%)
___Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   2, Avg loss: 0.0383, Accuracy: 406/1163 (34.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.8028, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0616, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 417/896 (46.5402%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.1666, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   2, Avg loss: 0.1091, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   1, Avg loss: 0.0543, Accuracy: 290/590 (49.1525%)
___Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   2, Avg loss: 0.0329, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2860, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 354/1446 (24.4813%)
___Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 487/1446 (33.6791%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2681, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3453, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 362/1573 (23.0134%)
___Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 562/1573 (35.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7042, Accuracy: 77/10000 (0.7700%)
time spent on training: 147.93187594413757
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 605, 1163, 896, 134, 590, 677, 1446, 311, 1573]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.90327701 1.         1.         0.90327701 1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3122, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5686, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 286.6729950904846 sec.
Server Epoch:42 choose agents : [80, 48, 22, 54, 17, 4, 46, 71, 64, 34].
___Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 143/682 (20.9677%)
___Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 228/682 (33.4311%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.2281, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   1, Avg loss: 0.0717, Accuracy: 93/631 (14.7385%)
___Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8306, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 562/1470 (38.2313%)
___Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 854/1470 (58.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0092, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 355/1130 (31.4159%)
___Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 468/1130 (41.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5341, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 387/1574 (24.5870%)
___Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 666/1574 (42.3126%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4193, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 329/901 (36.5150%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0860, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 422/1904 (22.1639%)
___Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 691/1904 (36.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.3746, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 155/818 (18.9487%)
___Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 366/818 (44.7433%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0463, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 168/953 (17.6285%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 328/953 (34.4176%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.3905, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 385/1427 (26.9797%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 587/1427 (41.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.9933, Accuracy: 57/10000 (0.5700%)
time spent on training: 166.73977971076965
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 631, 1470, 1130, 1574, 901, 1904, 818, 953, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3121, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5664, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 302.0602970123291 sec.
Server Epoch:43 choose agents : [48, 64, 0, 16, 40, 36, 32, 96, 83, 81].
___Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 98/631 (15.5309%)
___Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8471, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 172/953 (18.0483%)
___Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 316/953 (33.1584%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.5268, Accuracy: 73/10000 (0.7300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 374/1657 (22.5709%)
___Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5645, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   1, Avg loss: 0.0668, Accuracy: 277/708 (39.1243%)
___Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   2, Avg loss: 0.0341, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.9054, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 360/1573 (22.8862%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 566/1573 (35.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5210, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 71/408 (17.4020%)
___Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.4839, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 201/735 (27.3469%)
___Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 310/735 (42.1769%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.8489, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3451, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 438/1953 (22.4270%)
___Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 760/1953 (38.9145%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.9434, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   1, Avg loss: 0.0676, Accuracy: 241/774 (31.1370%)
___Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 309/774 (39.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.3453, Accuracy: 58/10000 (0.5800%)
time spent on training: 195.6746861934662
[foolsgold agg] training data poison_ratio: 0.17077192620838916  data num: [631, 953, 1657, 708, 1573, 408, 735, 311, 1953, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.05336622694012161
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.28774189949036 sec.
Server Epoch:44 choose agents : [20, 4, 97, 32, 42, 33, 22, 30, 56, 0].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 355/807 (43.9901%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.0398, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0637, Accuracy: 325/901 (36.0710%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 384/901 (42.6193%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.9528, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 514/1213 (42.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6337, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 204/735 (27.7551%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 350/735 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3372, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 362/1372 (26.3848%)
___Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 515/1372 (37.5364%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9182, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 71/515 (13.7864%)
___Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   2, Avg loss: 0.0520, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.7487, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 522/1470 (35.5102%)
___Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 843/1470 (57.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9973, Accuracy: 70/10000 (0.7000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   1, Avg loss: 0.0798, Accuracy: 74/486 (15.2263%)
___Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8052, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 365/1657 (22.0278%)
___Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 518/1657 (31.2613%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6693, Accuracy: 55/10000 (0.5500%)
time spent on training: 190.93712067604065
[foolsgold agg] training data poison_ratio: 0.3157782059516164  data num: [807, 901, 1213, 735, 1372, 515, 1470, 486, 186, 1657]
[foolsgold agg] considering poison per batch poison_fraction: 0.09868068935988011
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5576, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.941410779953 sec.
Server Epoch:45 choose agents : [4, 16, 34, 68, 62, 38, 61, 31, 86, 28].
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0343, Accuracy: 380/901 (42.1754%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4201, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   2, Avg loss: 0.0375, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9221, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 370/1427 (25.9285%)
___Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 586/1427 (41.0652%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0024, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 372/1163 (31.9862%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0368, Accuracy: 437/1163 (37.5752%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.8381, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 151/568 (26.5845%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7403, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 255/1131 (22.5464%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 518/1131 (45.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.2164, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3040, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 64/460 (13.9130%)
___Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7561, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 372/1003 (37.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.5008, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 392/1581 (24.7944%)
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 578/1581 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5272, Accuracy: 75/10000 (0.7500%)
time spent on training: 160.04859042167664
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 708, 1427, 1163, 568, 1131, 85, 460, 1003, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3118, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5572, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.42013716697693 sec.
Server Epoch:46 choose agents : [2, 0, 60, 15, 30, 66, 81, 95, 58, 17].
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 237/605 (39.1736%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8040, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 352/1657 (21.2432%)
___Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 514/1657 (31.0199%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7310, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 612/2227 (27.4809%)
___Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4142, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0552, Accuracy: 333/1154 (28.8562%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8994, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8562, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 254/1402 (18.1170%)
___Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 380/1402 (27.1041%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2285, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   1, Avg loss: 0.0695, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 275/774 (35.5297%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.3222, Accuracy: 56/10000 (0.5600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6543, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 351/803 (43.7111%)
___Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0740, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 412/1574 (26.1753%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 684/1574 (43.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.1018, Accuracy: 88/10000 (0.8800%)
time spent on training: 213.34204649925232
[foolsgold agg] training data poison_ratio: 0.24306355819519546  data num: [605, 1657, 2227, 1154, 486, 1402, 774, 599, 803, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.07595736193599859
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3117, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5555, Accuracy: 0/9950 (0.0000%)
saving model
Done in 347.74724531173706 sec.
Server Epoch:47 choose agents : [80, 74, 96, 95, 41, 53, 13, 18, 70, 82].
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 135/682 (19.7947%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 228/682 (33.4311%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.2522, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 441/1552 (28.4149%)
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 738/1552 (47.5515%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.0536, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 48/311 (15.4341%)
___Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3472, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 329/599 (54.9249%)
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0318, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9729, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   1, Avg loss: 0.0600, Accuracy: 330/719 (45.8971%)
___Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   2, Avg loss: 0.0312, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.4033, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 274/813 (33.7023%)
___Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8117, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 336/1645 (20.4255%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 633/1645 (38.4802%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9646, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 115/530 (21.6981%)
___Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.2162, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 350/1418 (24.6827%)
___Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 664/1418 (46.8265%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7727, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 75/500 (15.0000%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6571, Accuracy: 47/10000 (0.4700%)
time spent on training: 177.29959750175476
[foolsgold agg] training data poison_ratio: 0.24529592884023263  data num: [682, 1552, 311, 599, 719, 813, 1645, 530, 1418, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0766549777625727
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5559, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.2706377506256 sec.
Server Epoch:48 choose agents : [55, 77, 34, 80, 27, 88, 59, 14, 45, 96].
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 240/1071 (22.4090%)
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 523/1071 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9874, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 341/1340 (25.4478%)
___Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8325, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 381/1427 (26.6994%)
___Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 571/1427 (40.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9958, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 149/682 (21.8475%)
___Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   2, Avg loss: 0.0388, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.4206, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 426/1587 (26.8431%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 612/1587 (38.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.1587, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 143/603 (23.7148%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9220, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   1, Avg loss: 0.0598, Accuracy: 309/1089 (28.3747%)
___Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2442, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.1203, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 199/669 (29.7459%)
___Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.8300, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 57/311 (18.3280%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3476, Accuracy: 50/10000 (0.5000%)
time spent on training: 178.96496725082397
[foolsgold agg] training data poison_ratio: 0.109375  data num: [1071, 1340, 1427, 682, 1587, 603, 1089, 1013, 669, 311]
[foolsgold agg] considering poison per batch poison_fraction: 0.0341796875
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3116, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5566, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.0299801826477 sec.
Server Epoch:49 choose agents : [88, 4, 12, 21, 78, 65, 74, 41, 55, 2].
___Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 139/603 (23.0514%)
___Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0065, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0353, Accuracy: 430/901 (47.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.9497, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   2, Avg loss: 0.0490, Accuracy: 126/338 (37.2781%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.4399, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 414/1949 (21.2417%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2518, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 183/416 (43.9904%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.5598, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0544, Accuracy: 413/1475 (28.0000%)
___Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 662/1475 (44.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.9878, Accuracy: 103/10000 (1.0300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 456/1552 (29.3814%)
___Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 778/1552 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.3313, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0609, Accuracy: 331/719 (46.0362%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0302, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.2523, Accuracy: 53/10000 (0.5300%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 278/1071 (25.9570%)
___Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0119, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 239/605 (39.5041%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8724, Accuracy: 50/10000 (0.5000%)
time spent on training: 186.61941623687744
[foolsgold agg] training data poison_ratio: 0.2724062727178316  data num: [603, 901, 338, 1949, 416, 1475, 1552, 719, 1071, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.08512696022432237
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5550, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.44931983947754 sec.
Server Epoch:50 choose agents : [33, 43, 89, 10, 19, 73, 12, 23, 42, 52].
___Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 70/515 (13.5922%)
___Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   2, Avg loss: 0.0501, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7327, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 305/946 (32.2410%)
___Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.0660, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 341/896 (38.0580%)
___Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2406, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 446/861 (51.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3147, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 400/1036 (38.6100%)
___Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 679/1036 (65.5405%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.2744, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 185/938 (19.7228%)
___Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3741, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   2, Avg loss: 0.0455, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.4492, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   1, Avg loss: 0.0635, Accuracy: 323/715 (45.1748%)
___Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7441, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 346/1372 (25.2187%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0319, Accuracy: 475/1372 (34.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1325, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 281/636 (44.1824%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.1247, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.04556608200073
[foolsgold agg] training data poison_ratio: 0.10432569974554708  data num: [515, 946, 896, 861, 1036, 938, 338, 715, 1372, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.032601781170483464
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5542, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 310.35823249816895 sec.
Server Epoch:51 choose agents : [87, 56, 68, 6, 65, 8, 42, 76, 52, 45].
___Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 409/1131 (36.1627%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7100, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0667, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   1, Avg loss: 0.0614, Accuracy: 379/1163 (32.5881%)
___Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 413/1163 (35.5116%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.7973, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 402/1956 (20.5521%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3254, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   1, Avg loss: 0.0550, Accuracy: 401/1475 (27.1864%)
___Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 644/1475 (43.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9906, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 277/1513 (18.3080%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 503/1513 (33.2452%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4690, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 334/1372 (24.3440%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 497/1372 (36.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.8988, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0855, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6627, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 284/636 (44.6541%)
___Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.4503, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   1, Avg loss: 0.0677, Accuracy: 196/669 (29.2975%)
___Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.7937, Accuracy: 50/10000 (0.5000%)
time spent on training: 174.69316601753235
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 186, 1163, 1956, 1475, 1513, 1372, 466, 636, 669]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5539, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.17577505111694 sec.
Server Epoch:52 choose agents : [5, 61, 23, 36, 64, 45, 13, 77, 7, 99].
___Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 387/1628 (23.7715%)
___Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 814/1628 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3125, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3042, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7894, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.5109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 171/953 (17.9433%)
___Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.5511, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   1, Avg loss: 0.0682, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   2, Avg loss: 0.0398, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7342, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 348/1645 (21.1550%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 645/1645 (39.2097%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1805, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 325/1340 (24.2537%)
___Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 528/1340 (39.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9473, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 352/891 (39.5062%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 415/891 (46.5769%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2040, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   1, Avg loss: 0.0643, Accuracy: 186/773 (24.0621%)
___Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   2, Avg loss: 0.0340, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4007, Accuracy: 50/10000 (0.5000%)
time spent on training: 167.42970490455627
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 85, 715, 408, 953, 669, 1645, 1340, 891, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3114, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5531, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.25457763671875 sec.
Server Epoch:53 choose agents : [96, 36, 89, 65, 62, 19, 45, 1, 34, 33].
___Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 50/311 (16.0772%)
___Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3490, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.5116, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 337/896 (37.6116%)
___Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.2255, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 403/1475 (27.3220%)
___Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 674/1475 (45.6949%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.8905, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 142/568 (25.0000%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7894, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 394/1036 (38.0309%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 636/1036 (61.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.1545, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 201/669 (30.0448%)
___Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7595, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 295/928 (31.7888%)
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5974, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 423/1427 (29.6426%)
___Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 606/1427 (42.4667%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.9371, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   1, Avg loss: 0.0796, Accuracy: 74/515 (14.3689%)
___Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   2, Avg loss: 0.0515, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8176, Accuracy: 48/10000 (0.4800%)
time spent on training: 157.8529577255249
[foolsgold agg] training data poison_ratio: 0.0  data num: [311, 408, 896, 1475, 568, 1036, 669, 928, 1427, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3113, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5515, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.29850816726685 sec.
Server Epoch:54 choose agents : [47, 28, 66, 55, 29, 52, 42, 8, 17, 23].
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1093, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 408/1581 (25.8065%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 555/1581 (35.1044%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6374, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 254/1402 (18.1170%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 385/1402 (27.4608%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4326, Accuracy: 84/10000 (0.8400%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 240/1071 (22.4090%)
___Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 498/1071 (46.4986%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8280, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 415/1440 (28.8194%)
___Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 626/1440 (43.4722%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8245, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 292/636 (45.9119%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.3052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 367/1372 (26.7493%)
___Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   2, Avg loss: 0.0307, Accuracy: 506/1372 (36.8805%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6930, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 236/1513 (15.5981%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 482/1513 (31.8572%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4406, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 396/1574 (25.1588%)
___Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 639/1574 (40.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1716, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 316/715 (44.1958%)
___Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.7701, Accuracy: 50/10000 (0.5000%)
time spent on training: 199.65813732147217
[foolsgold agg] training data poison_ratio: 0.09363525091799266  data num: [134, 1581, 1402, 1071, 1440, 636, 1372, 1513, 1574, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.029261015911872704
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5517, Accuracy: 0/9950 (0.0000%)
saving model
Done in 327.44923281669617 sec.
Server Epoch:55 choose agents : [40, 73, 17, 94, 50, 89, 8, 7, 99, 58].
___Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 378/1573 (24.0305%)
___Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 585/1573 (37.1901%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.2536, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0655, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 359/938 (38.2729%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5401, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 382/1574 (24.2694%)
___Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 631/1574 (40.0889%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3626, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1662 (20.8183%)
___Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 593/1662 (35.6799%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6306, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 162/809 (20.0247%)
___Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 351/809 (43.3869%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.9999, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 336/896 (37.5000%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 428/896 (47.7679%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.2967, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 248/1513 (16.3913%)
___Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 470/1513 (31.0641%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.1885, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.9934, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0675, Accuracy: 186/773 (24.0621%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 363/773 (46.9599%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0865, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 358/803 (44.5828%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9997, Accuracy: 57/10000 (0.5700%)
time spent on training: 211.18508577346802
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 938, 1574, 1662, 809, 896, 1513, 891, 773, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3111, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5502, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.2275285720825 sec.
Server Epoch:56 choose agents : [93, 82, 17, 59, 84, 14, 65, 13, 28, 10].
___Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 426/1742 (24.4546%)
___Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 688/1742 (39.4948%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1655, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0496, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.6482, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 395/1574 (25.0953%)
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 654/1574 (41.5502%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1218, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 303/1089 (27.8237%)
___Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   2, Avg loss: 0.0310, Accuracy: 428/1089 (39.3021%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3888, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 324/1190 (27.2269%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.0467, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 339/1013 (33.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.6374, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0544, Accuracy: 378/1475 (25.6271%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 702/1475 (47.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.8981, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 333/1645 (20.2432%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 600/1645 (36.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9724, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 405/1581 (25.6167%)
___Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 569/1581 (35.9899%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9451, Accuracy: 100/10000 (1.0000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 438/861 (50.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1200, Accuracy: 54/10000 (0.5400%)
time spent on training: 209.94796633720398
[foolsgold agg] training data poison_ratio: 0.06795580110497237  data num: [1742, 500, 1574, 1089, 1190, 1013, 1475, 1645, 1581, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.021236187845303865
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3110, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5482, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.2709572315216 sec.
Server Epoch:57 choose agents : [43, 89, 50, 55, 94, 77, 48, 34, 27, 7].
___Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   1, Avg loss: 0.0620, Accuracy: 313/946 (33.0867%)
___Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 329/946 (34.7780%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.0467, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0596, Accuracy: 340/896 (37.9464%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.2566, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 151/809 (18.6650%)
___Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2975, Accuracy: 77/10000 (0.7700%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 279/1071 (26.0504%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 487/1071 (45.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.9635, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 340/1662 (20.4573%)
___Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 632/1662 (38.0265%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0184, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 316/1340 (23.5821%)
___Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 554/1340 (41.3433%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6430, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 103/631 (16.3233%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8491, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 409/1427 (28.6615%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 557/1427 (39.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.8397, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 447/1587 (28.1664%)
___Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 594/1587 (37.4291%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2755, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 365/891 (40.9652%)
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 412/891 (46.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1102, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.54151844978333
[foolsgold agg] training data poison_ratio: 0.09511545293072825  data num: [946, 896, 809, 1071, 1662, 1340, 631, 1427, 1587, 891]
[foolsgold agg] considering poison per batch poison_fraction: 0.029723579040852578
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5485, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.0713720321655 sec.
Server Epoch:58 choose agents : [42, 60, 4, 34, 79, 80, 75, 93, 9, 37].
___Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 356/1372 (25.9475%)
___Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 542/1372 (39.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.9028, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 564/2227 (25.3256%)
___Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2080, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0607, Accuracy: 333/901 (36.9589%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0341, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.7826, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 401/1427 (28.1009%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.9058, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   2, Avg loss: 0.0876, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3191, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 146/682 (21.4076%)
___Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.3095, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 250/776 (32.2165%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.0130, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 410/1742 (23.5362%)
___Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 709/1742 (40.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.6330, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 373/1275 (29.2549%)
___Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 742/1275 (58.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.5716, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 397/1129 (35.1639%)
___Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 744/1129 (65.8990%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3823, Accuracy: 118/10000 (1.1800%)
time spent on training: 197.10561561584473
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 2227, 901, 1427, 197, 682, 776, 1742, 1275, 1129]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5467, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.71929574012756 sec.
Server Epoch:59 choose agents : [36, 33, 94, 37, 79, 21, 28, 25, 35, 24].
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 75/408 (18.3824%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4838, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 79/515 (15.3398%)
___Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   2, Avg loss: 0.0521, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7064, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 333/1662 (20.0361%)
___Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1662 (37.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.8828, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 388/1129 (34.3667%)
___Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 710/1129 (62.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6396, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   1, Avg loss: 0.0998, Accuracy: 18/197 (9.1371%)
___Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   2, Avg loss: 0.0819, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3210, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 367/1949 (18.8302%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 619/1949 (31.7599%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2840, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 367/1581 (23.2132%)
___Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 607/1581 (38.3934%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.8715, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.3908, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 36/271 (13.2841%)
___Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   2, Avg loss: 0.0573, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3674, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 37/312 (11.8590%)
___Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3856, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.40003418922424
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 515, 1662, 1129, 197, 1949, 1581, 690, 271, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3107, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5465, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.6267750263214 sec.
Server Epoch:60 choose agents : [73, 88, 6, 42, 22, 24, 95, 80, 57, 30].
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 174/938 (18.5501%)
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 316/938 (33.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5964, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.8762, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 409/1956 (20.9100%)
___Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 667/1956 (34.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.3170, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 345/1372 (25.1458%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 513/1372 (37.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0169, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 540/1470 (36.7347%)
___Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 829/1470 (56.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.2682, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 29/312 (9.2949%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0400, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3903, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   1, Avg loss: 0.0523, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0475, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 139/682 (20.3812%)
___Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.6418, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 289/1154 (25.0433%)
___Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   2, Avg loss: 0.0251, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5221, Accuracy: 76/10000 (0.7600%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 86/486 (17.6955%)
___Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   2, Avg loss: 0.0397, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.8087, Accuracy: 55/10000 (0.5500%)
time spent on training: 212.3413281440735
[foolsgold agg] training data poison_ratio: 0.11335144170497284  data num: [938, 603, 1956, 1372, 1470, 312, 599, 682, 1154, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.035422325532804014
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5449, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 341.049818277359 sec.
Server Epoch:61 choose agents : [54, 10, 57, 79, 45, 65, 13, 58, 75, 12].
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 350/1130 (30.9735%)
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 449/1130 (39.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5611, Accuracy: 54/10000 (0.5400%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   1, Avg loss: 0.0572, Accuracy: 209/861 (24.2741%)
___Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 455/861 (52.8455%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9844, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   1, Avg loss: 0.0573, Accuracy: 296/1154 (25.6499%)
___Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   2, Avg loss: 0.0263, Accuracy: 468/1154 (40.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2557, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1033, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0860, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3215, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.7863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   1, Avg loss: 0.0541, Accuracy: 397/1475 (26.9153%)
___Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 711/1475 (48.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8428, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   2, Avg loss: 0.0320, Accuracy: 681/1645 (41.3982%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1558, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 346/803 (43.0884%)
___Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.1025, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 255/776 (32.8608%)
___Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   2, Avg loss: 0.0301, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.0128, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 19/338 (5.6213%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0496, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4719, Accuracy: 50/10000 (0.5000%)
time spent on training: 190.1546471118927
[foolsgold agg] training data poison_ratio: 0.09515915119363395  data num: [1130, 861, 1154, 197, 669, 1475, 1645, 803, 776, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.02973723474801061
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3106, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5439, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.2637209892273 sec.
Server Epoch:62 choose agents : [89, 55, 54, 26, 40, 6, 59, 57, 13, 73].
___Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.2570, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 252/1071 (23.5294%)
___Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 534/1071 (49.8599%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9049, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 336/1130 (29.7345%)
___Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   2, Avg loss: 0.0283, Accuracy: 498/1130 (44.0708%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7655, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 346/1446 (23.9281%)
___Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.1979, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 372/1573 (23.6491%)
___Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 581/1573 (36.9358%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4669, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 419/1956 (21.4213%)
___Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1571, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 304/1089 (27.9155%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 424/1089 (38.9348%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2905, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   1, Avg loss: 0.0553, Accuracy: 297/1154 (25.7366%)
___Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   2, Avg loss: 0.0258, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.7205, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0571, Accuracy: 320/1645 (19.4529%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 645/1645 (39.2097%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9785, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   1, Avg loss: 0.0648, Accuracy: 182/938 (19.4030%)
___Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 354/938 (37.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.3430, Accuracy: 52/10000 (0.5200%)
time spent on training: 241.4598309993744
[foolsgold agg] training data poison_ratio: 0.08303612963250116  data num: [896, 1071, 1130, 1446, 1573, 1956, 1089, 1154, 1645, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.025948790510156614
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.7907643318176 sec.
Server Epoch:63 choose agents : [88, 83, 25, 86, 4, 32, 99, 35, 73, 64].
___Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 145/603 (24.0464%)
___Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.9036, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 468/1953 (23.9631%)
___Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   2, Avg loss: 0.0329, Accuracy: 813/1953 (41.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.0172, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0557, Accuracy: 308/690 (44.6377%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.3989, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   1, Avg loss: 0.0633, Accuracy: 362/1003 (36.0917%)
___Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 375/1003 (37.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.8803, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0602, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1126, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 205/735 (27.8912%)
___Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1666, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 190/773 (24.5796%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.9696, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 44/271 (16.2362%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0531, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3719, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   1, Avg loss: 0.0646, Accuracy: 182/938 (19.4030%)
___Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 306/938 (32.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1580, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0637, Accuracy: 168/953 (17.6285%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5360, Accuracy: 64/10000 (0.6400%)
time spent on training: 167.11753106117249
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 1953, 690, 1003, 901, 735, 773, 271, 938, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.94696812 1.         1.         1.         1.
 1.         0.94696812 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5375, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.4937393665314 sec.
Server Epoch:64 choose agents : [19, 68, 40, 0, 59, 96, 62, 63, 70, 81].
___Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 390/1036 (37.6448%)
___Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 692/1036 (66.7954%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1709, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   1, Avg loss: 0.0612, Accuracy: 368/1163 (31.6423%)
___Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 449/1163 (38.6071%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.5220, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 331/1573 (21.0426%)
___Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 555/1573 (35.2829%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.5022, Accuracy: 64/10000 (0.6400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 387/1657 (23.3555%)
___Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 537/1657 (32.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.6759, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   1, Avg loss: 0.0569, Accuracy: 318/1089 (29.2011%)
___Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   2, Avg loss: 0.0302, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8168, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3495, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 154/568 (27.1127%)
___Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.6746, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 265/888 (29.8423%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3238, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 352/1418 (24.8237%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.6955, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0656, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0374, Accuracy: 303/774 (39.1473%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.3116, Accuracy: 54/10000 (0.5400%)
time spent on training: 232.5462875366211
[foolsgold agg] training data poison_ratio: 0.15815596067576596  data num: [1036, 1163, 1573, 1657, 1089, 311, 568, 888, 1418, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.04942373771117686
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3105, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5374, Accuracy: 0/9950 (0.0000%)
saving model
Done in 357.9981119632721 sec.
Server Epoch:65 choose agents : [82, 14, 61, 68, 51, 24, 76, 37, 34, 80].
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.6994, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 229/1013 (22.6061%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.6767, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1283, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3038, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0614, Accuracy: 374/1163 (32.1582%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0361, Accuracy: 440/1163 (37.8332%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.9097, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 504/1049 (48.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.4097, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 39/312 (12.5000%)
___Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   2, Avg loss: 0.0416, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3912, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0849, Accuracy: 54/466 (11.5880%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.7139, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 415/1129 (36.7582%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 748/1129 (66.2533%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3009, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 384/1427 (26.9096%)
___Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 560/1427 (39.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.9820, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0697, Accuracy: 146/682 (21.4076%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 254/682 (37.2434%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.5622, Accuracy: 59/10000 (0.5900%)
time spent on training: 164.2031786441803
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1013, 85, 1163, 1049, 312, 466, 1129, 1427, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5375, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.02824306488037 sec.
Server Epoch:66 choose agents : [29, 39, 13, 16, 89, 32, 70, 78, 86, 12].
___Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 426/1440 (29.5833%)
___Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6931, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 495/1013 (48.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5997, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 344/1645 (20.9119%)
___Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 652/1645 (39.6353%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8396, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 287/708 (40.5367%)
___Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   2, Avg loss: 0.0400, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.8014, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 337/896 (37.6116%)
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 432/896 (48.2143%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2793, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   1, Avg loss: 0.0588, Accuracy: 212/735 (28.8435%)
___Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 321/735 (43.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1903, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 379/1418 (26.7278%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 661/1418 (46.6150%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6474, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 31/416 (7.4519%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0456, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.5883, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 359/1003 (35.7926%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 374/1003 (37.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7103, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 24/338 (7.1006%)
___Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.4582, Accuracy: 49/10000 (0.4900%)
time spent on training: 193.8802170753479
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 1013, 1645, 708, 896, 735, 1418, 416, 1003, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3103, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.25769209861755 sec.
Server Epoch:67 choose agents : [94, 66, 0, 19, 86, 99, 97, 78, 7, 76].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 357/1662 (21.4801%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 619/1662 (37.2443%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.9633, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 258/1402 (18.4023%)
___Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 392/1402 (27.9601%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.2527, Accuracy: 79/10000 (0.7900%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 366/1657 (22.0881%)
___Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 543/1657 (32.7701%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6409, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0458, Accuracy: 387/1036 (37.3552%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 667/1036 (64.3822%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.2643, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 362/1003 (36.0917%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7045, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   1, Avg loss: 0.0655, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   2, Avg loss: 0.0292, Accuracy: 411/773 (53.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.0855, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 358/1213 (29.5136%)
___Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 494/1213 (40.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.4750, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 180/416 (43.2692%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.5796, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/891 (39.9551%)
___Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.3246, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 44/466 (9.4421%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.6714, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.50387907028198
[foolsgold agg] training data poison_ratio: 0.1575244795132617  data num: [1662, 1402, 1657, 1036, 1003, 773, 1213, 416, 891, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.04922639984789429
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3103, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5349, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.48404908180237 sec.
Server Epoch:68 choose agents : [47, 88, 74, 60, 6, 79, 68, 41, 15, 82].
___Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   2, Avg loss: 0.1044, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3107, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8420, Accuracy: 51/10000 (0.5100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 497/1552 (32.0232%)
___Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 749/1552 (48.2603%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.3789, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 622/2227 (27.9300%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1304, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 423/1956 (21.6258%)
___Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 679/1956 (34.7137%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1705, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   1, Avg loss: 0.1034, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   2, Avg loss: 0.0835, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3193, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   1, Avg loss: 0.0624, Accuracy: 370/1163 (31.8143%)
___Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   2, Avg loss: 0.0360, Accuracy: 447/1163 (38.4351%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.7883, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 328/719 (45.6189%)
___Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   2, Avg loss: 0.0304, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.4420, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   1, Avg loss: 0.0589, Accuracy: 331/1154 (28.6828%)
___Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 472/1154 (40.9012%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0110, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.6792, Accuracy: 53/10000 (0.5300%)
time spent on training: 213.14377689361572
[foolsgold agg] training data poison_ratio: 0.15208231259186672  data num: [134, 603, 1552, 2227, 1956, 197, 1163, 719, 1154, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.047525722684958346
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.38573455810547 sec.
Server Epoch:69 choose agents : [22, 25, 63, 47, 88, 9, 18, 92, 56, 67].
___Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 514/1470 (34.9660%)
___Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 842/1470 (57.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2589, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   1, Avg loss: 0.0556, Accuracy: 307/690 (44.4928%)
___Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5574, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 262/888 (29.5045%)
___Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 410/888 (46.1712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.7277, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   1, Avg loss: 0.1246, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   2, Avg loss: 0.1089, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0756, Accuracy: 138/603 (22.8856%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.8653, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 361/1275 (28.3137%)
___Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 716/1275 (56.1569%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.3241, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   2, Avg loss: 0.0417, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.9794, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 467/1715 (27.2303%)
___Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 732/1715 (42.6822%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4725, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   1, Avg loss: 0.0780, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   2, Avg loss: 0.0408, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.5769, Accuracy: 50/10000 (0.5000%)
time spent on training: 176.10009694099426
[foolsgold agg] training data poison_ratio: 0.0  data num: [1470, 690, 888, 134, 603, 1275, 530, 1715, 186, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.97013589 1.         1.         0.97013589]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.24313139915466 sec.
Server Epoch:70 choose agents : [22, 33, 47, 94, 75, 85, 88, 5, 73, 80].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 549/1470 (37.3469%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 871/1470 (59.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9368, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   1, Avg loss: 0.0791, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   2, Avg loss: 0.0497, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9919, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1212, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1082, Accuracy: 21/134 (15.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 340/1662 (20.4573%)
___Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 625/1662 (37.6053%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.6087, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 257/776 (33.1186%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0282, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.7903, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 447/1988 (22.4849%)
___Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 671/1988 (33.7525%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9004, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 142/603 (23.5489%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9226, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 363/1628 (22.2973%)
___Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 799/1628 (49.0786%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2968, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 167/938 (17.8038%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 309/938 (32.9424%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3407, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 150/682 (21.9941%)
___Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.4722, Accuracy: 52/10000 (0.5200%)
time spent on training: 197.77310037612915
[foolsgold agg] training data poison_ratio: 0.0  data num: [1470, 515, 134, 1662, 776, 1988, 603, 1628, 938, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5320, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.61949348449707 sec.
Server Epoch:71 choose agents : [7, 79, 81, 44, 17, 9, 21, 95, 51, 70].
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 356/891 (39.9551%)
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.4385, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1043, Accuracy: 13/197 (6.5990%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0894, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3207, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 255/774 (32.9457%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 275/774 (35.5297%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.2302, Accuracy: 64/10000 (0.6400%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 395/1750 (22.5714%)
___Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 665/1750 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5339, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 410/1574 (26.0483%)
___Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 689/1574 (43.7738%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.9294, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 370/1275 (29.0196%)
___Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 707/1275 (55.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.7736, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 410/1949 (21.0364%)
___Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 640/1949 (32.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4529, Accuracy: 86/10000 (0.8600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   1, Avg loss: 0.0511, Accuracy: 338/599 (56.4274%)
___Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8464, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 536/1049 (51.0963%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.4594, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 338/1418 (23.8364%)
___Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 632/1418 (44.5698%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.4182, Accuracy: 101/10000 (1.0100%)
time spent on training: 257.93534207344055
[foolsgold agg] training data poison_ratio: 0.20468804461484838  data num: [891, 197, 774, 1750, 1574, 1275, 1949, 599, 1049, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.06396501394214012
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5317, Accuracy: 0/9950 (0.0000%)
saving model
Done in 383.7053105831146 sec.
Server Epoch:72 choose agents : [52, 6, 79, 96, 87, 25, 35, 83, 19, 89].
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 282/636 (44.3396%)
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.2566, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 449/1956 (22.9550%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 658/1956 (33.6401%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.1161, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   1, Avg loss: 0.1026, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   2, Avg loss: 0.0867, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3210, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 48/311 (15.4341%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0531, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3499, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 404/1131 (35.7206%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7087, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 315/690 (45.6522%)
___Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   2, Avg loss: 0.0274, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.5589, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3743, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 437/1953 (22.3758%)
___Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 722/1953 (36.9688%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2225, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0466, Accuracy: 388/1036 (37.4517%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 703/1036 (67.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9575, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 342/896 (38.1696%)
___Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 418/896 (46.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.3379, Accuracy: 50/10000 (0.5000%)
time spent on training: 186.97685861587524
[foolsgold agg] training data poison_ratio: 0.0  data num: [636, 1956, 197, 311, 1131, 690, 271, 1953, 1036, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.96969353 0.96969353 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3099, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.64143800735474 sec.
Server Epoch:73 choose agents : [33, 18, 68, 97, 36, 30, 4, 67, 23, 21].
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0529, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.9033, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   1, Avg loss: 0.0747, Accuracy: 123/530 (23.2075%)
___Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1886, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   1, Avg loss: 0.0608, Accuracy: 375/1163 (32.2442%)
___Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 441/1163 (37.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.7061, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 531/1213 (43.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7543, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 80/408 (19.6078%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0532, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.5147, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7922, Accuracy: 41/10000 (0.4100%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0596, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.7712, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 48/426 (11.2676%)
___Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.5810, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 326/715 (45.5944%)
___Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7297, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 395/1949 (20.2668%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 621/1949 (31.8625%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4355, Accuracy: 94/10000 (0.9400%)
time spent on training: 206.19301462173462
[foolsgold agg] training data poison_ratio: 0.05851191909463039  data num: [515, 530, 1163, 1213, 408, 486, 901, 426, 715, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.018284974717071998
[foolsgold agg] wv: [1.         0.95499612 1.         1.         1.         1.
 1.         0.95499612 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5325, Accuracy: 0/9950 (0.0000%)
saving model
Done in 333.31852769851685 sec.
Server Epoch:74 choose agents : [28, 44, 36, 74, 4, 77, 86, 13, 63, 93].
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 388/1581 (24.5414%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 593/1581 (37.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5451, Accuracy: 93/10000 (0.9300%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 401/1750 (22.9143%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 642/1750 (36.6857%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4999, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   1, Avg loss: 0.0853, Accuracy: 85/408 (20.8333%)
___Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   2, Avg loss: 0.0547, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.5175, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 445/1552 (28.6727%)
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 778/1552 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.8807, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0576, Accuracy: 332/901 (36.8479%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0312, Accuracy: 448/901 (49.7225%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.7782, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   1, Avg loss: 0.0528, Accuracy: 341/1340 (25.4478%)
___Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6919, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   1, Avg loss: 0.0619, Accuracy: 365/1003 (36.3908%)
___Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   2, Avg loss: 0.0338, Accuracy: 394/1003 (39.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.0085, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 583/1645 (35.4407%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0886, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 261/888 (29.3919%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 407/888 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6867, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 436/1742 (25.0287%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0312, Accuracy: 736/1742 (42.2503%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6802, Accuracy: 87/10000 (0.8700%)
time spent on training: 246.09640765190125
[foolsgold agg] training data poison_ratio: 0.2577673692427791  data num: [1581, 1750, 408, 1552, 901, 1340, 1003, 1645, 888, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.08055230288836847
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 370.8763897418976 sec.
Server Epoch:75 choose agents : [9, 40, 44, 67, 53, 47, 1, 98, 99, 57].
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1, Avg loss: 0.0489, Accuracy: 381/1275 (29.8824%)
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 771/1275 (60.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.4386, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 375/1573 (23.8398%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0339, Accuracy: 616/1573 (39.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.3096, Accuracy: 83/10000 (0.8300%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 426/1750 (24.3429%)
___Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5506, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   1, Avg loss: 0.0774, Accuracy: 62/426 (14.5540%)
___Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   2, Avg loss: 0.0406, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.5956, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 293/813 (36.0394%)
___Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7895, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   1, Avg loss: 0.1232, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   2, Avg loss: 0.1091, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0552, Accuracy: 294/928 (31.6810%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 577/928 (62.1767%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.0203, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.4439, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   1, Avg loss: 0.0648, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   2, Avg loss: 0.0303, Accuracy: 393/773 (50.8409%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0622, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1, Avg loss: 0.0537, Accuracy: 300/1154 (25.9965%)
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 529/1154 (45.8406%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2322, Accuracy: 74/10000 (0.7400%)
time spent on training: 235.72410321235657
[foolsgold agg] training data poison_ratio: 0.19023806935536472  data num: [1275, 1573, 1750, 426, 813, 134, 928, 373, 773, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.05944939667355147
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.98851323127747 sec.
Server Epoch:76 choose agents : [93, 69, 79, 90, 4, 59, 86, 13, 22, 68].
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 425/1742 (24.3972%)
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 723/1742 (41.5040%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8918, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1, Avg loss: 0.0583, Accuracy: 290/590 (49.1525%)
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.6208, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   1, Avg loss: 0.1031, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   2, Avg loss: 0.0872, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3200, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   1, Avg loss: 0.0555, Accuracy: 329/677 (48.5968%)
___Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.2975, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0602, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.6378, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 279/1089 (25.6198%)
___Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   2, Avg loss: 0.0325, Accuracy: 505/1089 (46.3728%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.0842, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   1, Avg loss: 0.0617, Accuracy: 357/1003 (35.5932%)
___Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   2, Avg loss: 0.0337, Accuracy: 402/1003 (40.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8227, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 317/1645 (19.2705%)
___Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 644/1645 (39.1489%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1428, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 508/1470 (34.5578%)
___Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 864/1470 (58.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1575, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 371/1163 (31.9003%)
___Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   2, Avg loss: 0.0356, Accuracy: 440/1163 (37.8332%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8363, Accuracy: 63/10000 (0.6300%)
time spent on training: 216.94043445587158
[foolsgold agg] training data poison_ratio: 0.0  data num: [1742, 590, 197, 677, 901, 1089, 1003, 1645, 1470, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.92592453956604 sec.
Server Epoch:77 choose agents : [5, 77, 11, 59, 88, 41, 18, 93, 98, 37].
___Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   1, Avg loss: 0.0502, Accuracy: 396/1628 (24.3243%)
___Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 870/1628 (53.4398%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2369, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   1, Avg loss: 0.0525, Accuracy: 342/1340 (25.5224%)
___Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9586, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 340/712 (47.7528%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.7631, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 318/1089 (29.2011%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 478/1089 (43.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2221, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0727, Accuracy: 155/603 (25.7048%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.1160, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   1, Avg loss: 0.0587, Accuracy: 336/719 (46.7316%)
___Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.4185, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 118/530 (22.2642%)
___Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   2, Avg loss: 0.0364, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.1518, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 442/1742 (25.3731%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 687/1742 (39.4374%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.1083, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4487, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 380/1129 (33.6581%)
___Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 746/1129 (66.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6577, Accuracy: 102/10000 (1.0200%)
time spent on training: 211.06414079666138
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1340, 712, 1089, 603, 719, 530, 1742, 373, 1129]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5331, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.9007523059845 sec.
Server Epoch:78 choose agents : [65, 18, 30, 33, 53, 94, 76, 64, 0, 29].
___Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 385/1475 (26.1017%)
___Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 676/1475 (45.8305%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.9595, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0743, Accuracy: 126/530 (23.7736%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0401, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.2425, Accuracy: 64/10000 (0.6400%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0786, Accuracy: 78/486 (16.0494%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8476, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 76/515 (14.7573%)
___Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   2, Avg loss: 0.0540, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.7226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 302/813 (37.1464%)
___Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 472/813 (58.0566%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2877, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 344/1662 (20.6980%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7535, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6833, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.6409, Accuracy: 64/10000 (0.6400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 350/1657 (21.1225%)
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 549/1657 (33.1322%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5745, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 425/1440 (29.5139%)
___Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 709/1440 (49.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.9274, Accuracy: 72/10000 (0.7200%)
time spent on training: 238.5347490310669
[foolsgold agg] training data poison_ratio: 0.21436430929278782  data num: [1475, 530, 486, 515, 813, 1662, 466, 953, 1657, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0669888466539962
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5309, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.99717712402344 sec.
Server Epoch:79 choose agents : [1, 68, 51, 81, 10, 38, 27, 94, 19, 98].
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0554, Accuracy: 291/928 (31.3578%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 575/928 (61.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8411, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   1, Avg loss: 0.0606, Accuracy: 386/1163 (33.1900%)
___Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 502/1163 (43.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.0289, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 227/1049 (21.6397%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 529/1049 (50.4290%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5925, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   1, Avg loss: 0.0697, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2892, Accuracy: 53/10000 (0.5300%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 220/861 (25.5517%)
___Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0952, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   1, Avg loss: 0.0604, Accuracy: 265/1131 (23.4306%)
___Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.7861, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 421/1587 (26.5280%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.2693, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/1662 (20.8183%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 610/1662 (36.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8163, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 411/1036 (39.6718%)
___Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 673/1036 (64.9614%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.3916, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 25/373 (6.7024%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.4736, Accuracy: 50/10000 (0.5000%)
time spent on training: 236.55075550079346
[foolsgold agg] training data poison_ratio: 0.0815032184778493  data num: [928, 1163, 1049, 774, 861, 1131, 1587, 1662, 1036, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.025469755774327908
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.3028209209442 sec.
Server Epoch:80 choose agents : [75, 36, 16, 74, 20, 26, 57, 91, 19, 56].
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0659, Accuracy: 257/776 (33.1186%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8070, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   1, Avg loss: 0.0856, Accuracy: 85/408 (20.8333%)
___Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.5293, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   1, Avg loss: 0.0632, Accuracy: 291/708 (41.1017%)
___Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   2, Avg loss: 0.0352, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9402, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0421, Accuracy: 561/1552 (36.1469%)
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 795/1552 (51.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.9382, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   2, Avg loss: 0.0314, Accuracy: 435/807 (53.9033%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.7871, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 328/1446 (22.6833%)
___Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 497/1446 (34.3707%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1321, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   1, Avg loss: 0.0553, Accuracy: 302/1154 (26.1698%)
___Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 513/1154 (44.4541%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.2444, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 347/1030 (33.6893%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 632/1030 (61.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5953, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 394/1036 (38.0309%)
___Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 644/1036 (62.1622%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1263, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 78/186 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3107, Accuracy: 50/10000 (0.5000%)
time spent on training: 224.66532111167908
[foolsgold agg] training data poison_ratio: 0.2591453367021861  data num: [776, 408, 708, 1552, 807, 1446, 1154, 1030, 1036, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.08098291771943315
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5315, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.70538663864136 sec.
Server Epoch:81 choose agents : [96, 50, 54, 97, 92, 82, 79, 65, 95, 81].
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 56/311 (18.0064%)
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3493, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 166/809 (20.5192%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 382/809 (47.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2441, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 359/1130 (31.7699%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 457/1130 (40.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8757, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   1, Avg loss: 0.0515, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5031, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 478/1715 (27.8717%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 708/1715 (41.2828%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.4255, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.6861, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   1, Avg loss: 0.1008, Accuracy: 22/197 (11.1675%)
___Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3202, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   1, Avg loss: 0.0569, Accuracy: 408/1475 (27.6610%)
___Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 709/1475 (48.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.1180, Accuracy: 87/10000 (0.8700%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 336/599 (56.0935%)
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0313, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7222, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0664, Accuracy: 250/774 (32.2997%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.5436, Accuracy: 57/10000 (0.5700%)
time spent on training: 207.9065556526184
[foolsgold agg] training data poison_ratio: 0.06866903588215063  data num: [311, 809, 1130, 1213, 1715, 500, 197, 1475, 599, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.021459073713172072
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5307, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.80981278419495 sec.
Server Epoch:82 choose agents : [64, 98, 19, 25, 53, 74, 65, 96, 58, 16].
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 170/953 (17.8384%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4662, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.4444, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   1, Avg loss: 0.0465, Accuracy: 398/1036 (38.4170%)
___Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 684/1036 (66.0232%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6384, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   1, Avg loss: 0.0558, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   2, Avg loss: 0.0274, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4817, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 292/813 (35.9164%)
___Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 462/813 (56.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.0033, Accuracy: 52/10000 (0.5200%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 513/1552 (33.0541%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 771/1552 (49.6778%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.4307, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   1, Avg loss: 0.0537, Accuracy: 406/1475 (27.5254%)
___Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   2, Avg loss: 0.0303, Accuracy: 757/1475 (51.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.9483, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 62/311 (19.9357%)
___Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3506, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 354/803 (44.0847%)
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 383/803 (47.6961%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.0292, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1, Avg loss: 0.0641, Accuracy: 279/708 (39.4068%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2, Avg loss: 0.0349, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8242, Accuracy: 53/10000 (0.5300%)
time spent on training: 207.4351122379303
[foolsgold agg] training data poison_ratio: 0.17810420013770945  data num: [953, 373, 1036, 690, 813, 1552, 1475, 311, 803, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0556575625430342
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5284, Accuracy: 0/9950 (0.0000%)
saving model
Done in 333.30573773384094 sec.
Server Epoch:83 choose agents : [63, 88, 39, 85, 65, 22, 50, 86, 14, 33].
___Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 259/888 (29.1667%)
___Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 375/888 (42.2297%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4787, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   1, Avg loss: 0.0733, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9730, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 500/1013 (49.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7022, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 445/1988 (22.3843%)
___Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 672/1988 (33.8028%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4204, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 410/1475 (27.7966%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1332, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   1, Avg loss: 0.0444, Accuracy: 544/1470 (37.0068%)
___Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 845/1470 (57.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3685, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 150/809 (18.5414%)
___Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.2593, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   1, Avg loss: 0.0617, Accuracy: 379/1003 (37.7866%)
___Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 356/1003 (35.4935%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.6533, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 221/1013 (21.8164%)
___Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 341/1013 (33.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.6352, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 82/515 (15.9223%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0528, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.6884, Accuracy: 58/10000 (0.5800%)
time spent on training: 226.31718683242798
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 603, 1013, 1988, 1475, 1470, 809, 1003, 1013, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5278, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.6282546520233 sec.
Server Epoch:84 choose agents : [46, 69, 35, 2, 38, 61, 48, 80, 0, 84].
___Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 426/1904 (22.3739%)
___Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 690/1904 (36.2395%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6497, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   1, Avg loss: 0.0554, Accuracy: 297/590 (50.3390%)
___Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.9413, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 36/271 (13.2841%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0564, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3710, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0645, Accuracy: 237/605 (39.1736%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8334, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0605, Accuracy: 257/1131 (22.7233%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6068, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 12/85 (14.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3038, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 98/631 (15.5309%)
___Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 213/631 (33.7559%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.9364, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 151/682 (22.1408%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.4550, Accuracy: 57/10000 (0.5700%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 360/1657 (21.7260%)
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 550/1657 (33.1925%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7791, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 318/1190 (26.7227%)
___Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.8688, Accuracy: 65/10000 (0.6500%)
time spent on training: 241.55178809165955
[foolsgold agg] training data poison_ratio: 0.18945803796021038  data num: [1904, 590, 271, 605, 1131, 85, 631, 682, 1657, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.05920563686256575
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3093, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5284, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.6826169490814 sec.
Server Epoch:85 choose agents : [10, 27, 58, 65, 60, 31, 40, 48, 2, 16].
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 232/861 (26.9454%)
___Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.9238, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 433/1587 (27.2842%)
___Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 605/1587 (38.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3336, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 349/803 (43.4620%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0703, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1, Avg loss: 0.0546, Accuracy: 389/1475 (26.3729%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2, Avg loss: 0.0291, Accuracy: 729/1475 (49.4237%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.0555, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   1, Avg loss: 0.0486, Accuracy: 615/2227 (27.6156%)
___Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1046/2227 (46.9690%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2733, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 69/460 (15.0000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0363, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8375, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 390/1573 (24.7934%)
___Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 588/1573 (37.3808%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.5576, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 104/631 (16.4818%)
___Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8762, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 246/605 (40.6612%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8128, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   1, Avg loss: 0.0652, Accuracy: 291/708 (41.1017%)
___Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 419/708 (59.1808%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.9521, Accuracy: 49/10000 (0.4900%)
time spent on training: 240.85629677772522
[foolsgold agg] training data poison_ratio: 0.0787740164684355  data num: [861, 1587, 803, 1475, 2227, 460, 1573, 631, 605, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.024616880146386095
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3093, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5265, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.806902885437 sec.
Server Epoch:86 choose agents : [88, 3, 90, 19, 74, 8, 93, 84, 24, 62].
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 144/603 (23.8806%)
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 275/603 (45.6053%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0286, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 116/781 (14.8528%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 251/781 (32.1383%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.7728, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 426/677 (62.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1943, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 427/1036 (41.2162%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 654/1036 (63.1274%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.2942, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 531/1552 (34.2139%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 742/1552 (47.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.8391, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 258/1513 (17.0522%)
___Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 498/1513 (32.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3979, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 413/1742 (23.7084%)
___Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 715/1742 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.7638, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 445/1190 (37.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.0203, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 38/312 (12.1795%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3992, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   1, Avg loss: 0.0679, Accuracy: 155/568 (27.2887%)
___Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.7605, Accuracy: 55/10000 (0.5500%)
time spent on training: 259.4158854484558
[foolsgold agg] training data poison_ratio: 0.15560457188690596  data num: [603, 781, 677, 1036, 1552, 1513, 1742, 1190, 312, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.04862642871465811
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3092, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5267, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.06703186035156 sec.
Server Epoch:87 choose agents : [61, 30, 64, 21, 37, 89, 86, 47, 43, 63].
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1252, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3040, Accuracy: 49/10000 (0.4900%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   1, Avg loss: 0.0776, Accuracy: 92/486 (18.9300%)
___Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.9072, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 171/953 (17.9433%)
___Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.6182, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 425/1949 (21.8061%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 656/1949 (33.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3889, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 456/1129 (40.3897%)
___Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 760/1129 (67.3162%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2541, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 350/896 (39.0625%)
___Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.2592, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 366/1003 (36.4905%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 383/1003 (38.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.9739, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1186, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1077, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0608, Accuracy: 303/946 (32.0296%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 366/946 (38.6892%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1277, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   1, Avg loss: 0.0533, Accuracy: 268/888 (30.1802%)
___Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.7567, Accuracy: 53/10000 (0.5300%)
time spent on training: 197.3064455986023
[foolsgold agg] training data poison_ratio: 0.057385759829968117  data num: [85, 486, 953, 1949, 1129, 896, 1003, 134, 946, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.017933049946865037
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5256, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.50230050086975 sec.
Server Epoch:88 choose agents : [90, 31, 58, 73, 91, 48, 27, 50, 35, 61].
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 327/677 (48.3013%)
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 462/677 (68.2422%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2306, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 65/460 (14.1304%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8414, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.9823, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 178/938 (18.9765%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 306/938 (32.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2002, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1, Avg loss: 0.0514, Accuracy: 334/1030 (32.4272%)
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 660/1030 (64.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3645, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 101/631 (16.0063%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 460/1587 (28.9855%)
___Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 632/1587 (39.8236%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3649, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 159/809 (19.6539%)
___Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 367/809 (45.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3111, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1, Avg loss: 0.0850, Accuracy: 46/271 (16.9742%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3719, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3036, Accuracy: 51/10000 (0.5100%)
time spent on training: 230.36453294754028
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 460, 803, 938, 1030, 631, 1587, 809, 271, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5242, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.53794026374817 sec.
Server Epoch:89 choose agents : [66, 87, 89, 19, 67, 71, 31, 39, 91, 84].
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 267/1402 (19.0442%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 376/1402 (26.8188%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2516, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 302/1131 (26.7020%)
___Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   2, Avg loss: 0.0310, Accuracy: 459/1131 (40.5836%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0732, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 343/896 (38.2812%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 427/896 (47.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2563, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 391/1036 (37.7413%)
___Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 637/1036 (61.4865%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1834, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0774, Accuracy: 61/426 (14.3192%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0398, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.6024, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 162/818 (19.8044%)
___Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 369/818 (45.1100%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1660, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   1, Avg loss: 0.0800, Accuracy: 70/460 (15.2174%)
___Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8043, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 321/1013 (31.6881%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 501/1013 (49.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6356, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 336/1030 (32.6214%)
___Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 650/1030 (63.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3244, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0610, Accuracy: 333/1190 (27.9832%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.0665, Accuracy: 63/10000 (0.6300%)
time spent on training: 215.65377187728882
[foolsgold agg] training data poison_ratio: 0.0  data num: [1402, 1131, 896, 1036, 426, 818, 460, 1013, 1030, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5247, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.79291248321533 sec.
Server Epoch:90 choose agents : [46, 51, 28, 5, 48, 71, 20, 24, 41, 17].
___Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 426/1904 (22.3739%)
___Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 702/1904 (36.8697%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6224, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 235/1049 (22.4023%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 525/1049 (50.0477%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6980, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 414/1581 (26.1860%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 598/1581 (37.8242%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7132, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 377/1628 (23.1572%)
___Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 813/1628 (49.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3107, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 100/631 (15.8479%)
___Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.8874, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 155/818 (18.9487%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 354/818 (43.2763%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.0807, Accuracy: 69/10000 (0.6900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   2, Avg loss: 0.0309, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.0438, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 37/312 (11.8590%)
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 177/312 (56.7308%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3969, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0583, Accuracy: 329/719 (45.7580%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.5300, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 396/1574 (25.1588%)
___Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 621/1574 (39.4536%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9910, Accuracy: 91/10000 (0.9100%)
time spent on training: 259.00915026664734
[foolsgold agg] training data poison_ratio: 0.07321055973872811  data num: [1904, 1049, 1581, 1628, 631, 818, 807, 312, 719, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.022878299918352538
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5255, Accuracy: 0/9950 (0.0000%)
saving model
Done in 385.14503836631775 sec.
Server Epoch:91 choose agents : [26, 43, 41, 42, 36, 81, 31, 76, 8, 57].
___Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 347/1446 (23.9972%)
___Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 481/1446 (33.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2082, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 310/946 (32.7696%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 337/946 (35.6237%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.9876, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   2, Avg loss: 0.0316, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.3925, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 333/1372 (24.2711%)
___Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 523/1372 (38.1195%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8829, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 87/408 (21.3235%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0534, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.5333, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 258/774 (33.3333%)
___Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   2, Avg loss: 0.0344, Accuracy: 304/774 (39.2765%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.4106, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/460 (15.6522%)
___Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   2, Avg loss: 0.0356, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8407, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   1, Avg loss: 0.0834, Accuracy: 51/466 (10.9442%)
___Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7571, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   1, Avg loss: 0.0590, Accuracy: 271/1513 (17.9114%)
___Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 478/1513 (31.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3903, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 313/1154 (27.1231%)
___Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 429/1154 (37.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7289, Accuracy: 66/10000 (0.6600%)
time spent on training: 217.61584377288818
[foolsgold agg] training data poison_ratio: 0.0  data num: [1446, 946, 719, 1372, 408, 774, 460, 466, 1513, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3090, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5259, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.37103962898254 sec.
Server Epoch:92 choose agents : [38, 36, 76, 12, 77, 96, 67, 3, 53, 25].
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 266/1131 (23.5190%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 516/1131 (45.6233%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3799, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   1, Avg loss: 0.0849, Accuracy: 86/408 (21.0784%)
___Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   2, Avg loss: 0.0521, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.5251, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0470, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.7034, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   1, Avg loss: 0.0862, Accuracy: 29/338 (8.5799%)
___Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   2, Avg loss: 0.0460, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.4628, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 340/1340 (25.3731%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 535/1340 (39.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0027, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3533, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0766, Accuracy: 68/426 (15.9624%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.5704, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0734, Accuracy: 111/781 (14.2125%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 232/781 (29.7055%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.0328, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 287/813 (35.3014%)
___Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 440/813 (54.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.3531, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 308/690 (44.6377%)
___Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.5088, Accuracy: 56/10000 (0.5600%)
time spent on training: 201.07758975028992
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 408, 466, 338, 1340, 311, 426, 781, 813, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3090, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5263, Accuracy: 0/9950 (0.0000%)
saving model
Done in 330.81653356552124 sec.
Server Epoch:93 choose agents : [97, 94, 81, 1, 62, 45, 0, 15, 31, 32].
___Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 347/1213 (28.6068%)
___Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 474/1213 (39.0767%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8515, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 382/1662 (22.9844%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1147, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   1, Avg loss: 0.0656, Accuracy: 249/774 (32.1705%)
___Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   2, Avg loss: 0.0350, Accuracy: 304/774 (39.2765%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.2636, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 297/928 (32.0043%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 560/928 (60.3448%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7517, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 149/568 (26.2324%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.7363, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0663, Accuracy: 215/669 (32.1375%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0390, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.7889, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 384/1657 (23.1744%)
___Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 539/1657 (32.5287%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9948, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0561, Accuracy: 329/1154 (28.5095%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 448/1154 (38.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8955, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 72/460 (15.6522%)
___Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   2, Avg loss: 0.0361, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8213, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 207/735 (28.1633%)
___Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   2, Avg loss: 0.0219, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7889, Accuracy: 59/10000 (0.5900%)
time spent on training: 232.7033989429474
[foolsgold agg] training data poison_ratio: 0.16873727087576373  data num: [1213, 1662, 774, 928, 568, 669, 1657, 1154, 460, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.05273039714867617
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3089, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5237, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.7702090740204 sec.
Server Epoch:94 choose agents : [80, 7, 37, 2, 99, 16, 49, 71, 59, 78].
___Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 153/682 (22.4340%)
___Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3651, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 468/891 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9169, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 437/1129 (38.7068%)
___Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 712/1129 (63.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.1102, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0613, Accuracy: 240/605 (39.6694%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8732, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 194/773 (25.0970%)
___Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   2, Avg loss: 0.0291, Accuracy: 383/773 (49.5472%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5066, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1, Avg loss: 0.0624, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.9516, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 29/440 (6.5909%)
___Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.5336, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 175/818 (21.3936%)
___Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 376/818 (45.9658%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9352, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   1, Avg loss: 0.0575, Accuracy: 328/1089 (30.1194%)
___Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8106, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 40/416 (9.6154%)
___Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 191/416 (45.9135%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.5898, Accuracy: 50/10000 (0.5000%)
time spent on training: 199.29704523086548
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 891, 1129, 605, 773, 708, 440, 818, 1089, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3089, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5240, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.72124218940735 sec.
Server Epoch:95 choose agents : [58, 24, 20, 10, 29, 56, 51, 25, 5, 3].
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 349/803 (43.4620%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 388/803 (48.3188%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.9709, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 174/312 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3909, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 360/807 (44.6097%)
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.6560, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 212/861 (24.6225%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0206, Accuracy: 482/861 (55.9814%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2778, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 432/1440 (30.0000%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1396, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 2/186 (1.0753%)
___Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 239/1049 (22.7836%)
___Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.4227, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 312/690 (45.2174%)
___Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.5162, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 407/1628 (25.0000%)
___Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 782/1628 (48.0344%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.0284, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.7771, Accuracy: 70/10000 (0.7000%)
time spent on training: 264.3695662021637
[foolsgold agg] training data poison_ratio: 0.19492812901717893  data num: [803, 312, 807, 861, 1440, 186, 1049, 690, 1628, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.060915040317868416
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3088, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5242, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.7443947792053 sec.
Server Epoch:96 choose agents : [84, 4, 1, 11, 43, 2, 62, 12, 31, 82].
___Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 335/1190 (28.1513%)
___Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3270, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0632, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 361/901 (40.0666%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.8064, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0555, Accuracy: 296/928 (31.8966%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 567/928 (61.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8815, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 343/712 (48.1742%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.7227, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 309/946 (32.6638%)
___Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   2, Avg loss: 0.0352, Accuracy: 384/946 (40.5920%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.0231, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 241/605 (39.8347%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8526, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 155/568 (27.2887%)
___Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8212, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0863, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0458, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.4569, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   1, Avg loss: 0.0805, Accuracy: 55/460 (11.9565%)
___Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9034, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.7029, Accuracy: 41/10000 (0.4100%)
time spent on training: 191.65188431739807
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 901, 928, 712, 946, 605, 568, 338, 460, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3088, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5242, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.0006730556488 sec.
Server Epoch:97 choose agents : [82, 9, 2, 32, 45, 55, 65, 3, 16, 6].
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.6930, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   1, Avg loss: 0.0482, Accuracy: 371/1275 (29.0980%)
___Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 725/1275 (56.8627%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.9001, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 245/605 (40.4959%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.8395, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 219/735 (29.7959%)
___Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0665, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 213/669 (31.8386%)
___Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   2, Avg loss: 0.0389, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.9786, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   1, Avg loss: 0.0547, Accuracy: 312/1071 (29.1317%)
___Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3495, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   1, Avg loss: 0.0561, Accuracy: 415/1475 (28.1356%)
___Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 634/1475 (42.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.0607, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0727, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0350, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.8662, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1, Avg loss: 0.0625, Accuracy: 285/708 (40.2542%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2, Avg loss: 0.0342, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.8773, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   1, Avg loss: 0.0540, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 656/1956 (33.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.2163, Accuracy: 106/10000 (1.0600%)
time spent on training: 276.50296783447266
[foolsgold agg] training data poison_ratio: 0.10956521739130434  data num: [500, 1275, 605, 735, 669, 1071, 1475, 781, 708, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.034239130434782605
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3087, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.88384771347046 sec.
Server Epoch:98 choose agents : [40, 38, 88, 79, 89, 8, 28, 43, 27, 58].
___Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 389/1573 (24.7298%)
___Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 595/1573 (37.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4305, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   1, Avg loss: 0.0605, Accuracy: 268/1131 (23.6958%)
___Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 485/1131 (42.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4679, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.9991, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   1, Avg loss: 0.1012, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   2, Avg loss: 0.0861, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3224, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 342/896 (38.1696%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3387, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 253/1513 (16.7217%)
___Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 497/1513 (32.8486%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2930, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 406/1581 (25.6799%)
___Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   2, Avg loss: 0.0327, Accuracy: 628/1581 (39.7217%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6151, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0624, Accuracy: 298/946 (31.5011%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.0066, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 419/1587 (26.4020%)
___Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 636/1587 (40.0756%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1565, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   1, Avg loss: 0.0562, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.1566, Accuracy: 50/10000 (0.5000%)
time spent on training: 232.21405267715454
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 1131, 603, 197, 896, 1513, 1581, 946, 1587, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3087, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5204, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.26652789115906 sec.
Server Epoch:99 choose agents : [75, 60, 66, 94, 77, 17, 26, 35, 23, 61].
___Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   1, Avg loss: 0.0658, Accuracy: 255/776 (32.8608%)
___Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.0928, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 611/2227 (27.4360%)
___Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1014/2227 (45.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1477, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 274/1402 (19.5435%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 422/1402 (30.0999%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.2957, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 361/1662 (21.7208%)
___Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7305, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0522, Accuracy: 330/1340 (24.6269%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9129, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 436/1574 (27.7001%)
___Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 705/1574 (44.7903%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9638, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 332/1446 (22.9599%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 502/1446 (34.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3162, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 45/271 (16.6052%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0541, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3699, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0623, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.7376, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3033, Accuracy: 49/10000 (0.4900%)
time spent on training: 263.3189995288849
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 2227, 1402, 1662, 1340, 1574, 1446, 271, 715, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3086, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.51441383361816 sec.
Server Epoch:100 choose agents : [25, 52, 37, 70, 26, 86, 40, 66, 98, 83].
___Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 314/690 (45.5072%)
___Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.6016, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 292/636 (45.9119%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.4230, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 427/1129 (37.8211%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 741/1129 (65.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8703, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 376/1418 (26.5162%)
___Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 647/1418 (45.6276%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7687, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 354/1446 (24.4813%)
___Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 519/1446 (35.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3559, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 373/1003 (37.1884%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.8614, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 405/1573 (25.7470%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 583/1573 (37.0629%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4636, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 269/1402 (19.1869%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 375/1402 (26.7475%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.2340, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 37/373 (9.9196%)
___Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.4646, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 431/1953 (22.0686%)
___Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 810/1953 (41.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7984, Accuracy: 128/10000 (1.2800%)
time spent on training: 259.08251190185547
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 636, 1129, 1418, 1446, 1003, 1573, 1402, 373, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3086, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5199, Accuracy: 0/9950 (0.0000%)
saving model
Done in 386.3683121204376 sec.
Saving all the graphs.
This run has a label: Jun.17_20.07.04. Visdom environment: tiny
