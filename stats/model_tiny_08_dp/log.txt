current path: saved_models/model_tiny_Jun.13_09.06.38
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 10, 30, 44, 55]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [89, 91, 69, 74, 59, 60, 29, 99, 17, 84].
___Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 326/896 (36.3839%)
___Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 438/896 (48.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1388, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 331/1030 (32.1359%)
___Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 587/1030 (56.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.3537, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.0358, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 495/1552 (31.8943%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 753/1552 (48.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 10.8124, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 305/1089 (28.0073%)
___Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 499/1089 (45.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.1287, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 545/2227 (24.4724%)
___Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 984/2227 (44.1850%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.1265, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 433/1440 (30.0694%)
___Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 640/1440 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7561, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 167/773 (21.6041%)
___Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 380/773 (49.1591%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.8008, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 389/1574 (24.7141%)
___Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 674/1574 (42.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.1556, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 479/1190 (40.2521%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.9355, Accuracy: 55/10000 (0.5500%)
time spent on training: 113.04207491874695
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3036, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3429, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.4401092529297 sec.
Server Epoch:2 choose agents : [69, 51, 47, 25, 26, 30, 90, 31, 7, 55].
___Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   1, Avg loss: 0.0541, Accuracy: 301/590 (51.0169%)
___Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9711, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 210/1049 (20.0191%)
___Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 484/1049 (46.1392%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7565, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1232, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3190, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0579, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.4691, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   1, Avg loss: 0.0561, Accuracy: 325/1446 (22.4758%)
___Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 519/1446 (35.8921%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1931, Accuracy: 62/10000 (0.6200%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   1, Avg loss: 0.0798, Accuracy: 77/486 (15.8436%)
___Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   2, Avg loss: 0.0426, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.8485, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 290/677 (42.8360%)
___Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 449/677 (66.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.6759, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   1, Avg loss: 0.0802, Accuracy: 55/460 (11.9565%)
___Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   2, Avg loss: 0.0384, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.8047, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0268, Accuracy: 440/891 (49.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1466, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   1, Avg loss: 0.0580, Accuracy: 230/1071 (21.4753%)
___Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 484/1071 (45.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8715, Accuracy: 75/10000 (0.7500%)
time spent on training: 130.1789948940277
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3030, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3396, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.33466362953186 sec.
Server Epoch:3 choose agents : [81, 63, 8, 90, 20, 15, 4, 75, 0, 12].
___Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 242/774 (31.2661%)
___Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   2, Avg loss: 0.0391, Accuracy: 264/774 (34.1085%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4776, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   1, Avg loss: 0.0569, Accuracy: 247/888 (27.8153%)
___Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 396/888 (44.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.8021, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0612, Accuracy: 218/1513 (14.4085%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 460/1513 (30.4032%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.6122, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 295/677 (43.5746%)
___Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 448/677 (66.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.5005, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 391/807 (48.4511%)
___Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 405/807 (50.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2331, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 493/1154 (42.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0579, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 322/901 (35.7381%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0318, Accuracy: 384/901 (42.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2714, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 227/776 (29.2526%)
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0302, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.4398, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 352/1657 (21.2432%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 498/1657 (30.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0806, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 10/338 (2.9586%)
___Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 150/338 (44.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.6593, Accuracy: 49/10000 (0.4900%)
time spent on training: 138.62921833992004
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3171, Accuracy: 39/10000 (0.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3893, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.7315180301666 sec.
Server Epoch:4 choose agents : [22, 69, 34, 81, 7, 25, 43, 56, 14, 68].
___Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   1, Avg loss: 0.0478, Accuracy: 527/1470 (35.8503%)
___Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 799/1470 (54.3537%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.2150, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   1, Avg loss: 0.0534, Accuracy: 323/590 (54.7458%)
___Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.2348, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 353/1427 (24.7372%)
___Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 566/1427 (39.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.2391, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 260/774 (33.5917%)
___Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   2, Avg loss: 0.0340, Accuracy: 316/774 (40.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.5318, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 361/891 (40.5163%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 450/891 (50.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.3855, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 313/690 (45.3623%)
___Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 450/690 (65.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.6142, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   1, Avg loss: 0.0638, Accuracy: 290/946 (30.6554%)
___Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 380/946 (40.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.3363, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 77/186 (41.3978%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3608, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 212/1013 (20.9279%)
___Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 326/1013 (32.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9507, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   1, Avg loss: 0.0654, Accuracy: 355/1163 (30.5245%)
___Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 437/1163 (37.5752%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9739, Accuracy: 60/10000 (0.6000%)
time spent on training: 111.08743691444397
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3343, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.4635, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.45239996910095 sec.
Server Epoch:5 choose agents : [66, 95, 59, 2, 56, 22, 50, 99, 97, 88].
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0632, Accuracy: 229/1402 (16.3338%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0394, Accuracy: 374/1402 (26.6762%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.3239, Accuracy: 73/10000 (0.7300%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   1, Avg loss: 0.0538, Accuracy: 307/599 (51.2521%)
___Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 9.6317, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   1, Avg loss: 0.0518, Accuracy: 316/1089 (29.0174%)
___Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 482/1089 (44.2608%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.1062, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 220/605 (36.3636%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.4338, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 70/186 (37.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.4174, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   1, Avg loss: 0.0480, Accuracy: 515/1470 (35.0340%)
___Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 820/1470 (55.7823%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.3507, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   1, Avg loss: 0.0659, Accuracy: 126/809 (15.5748%)
___Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 336/809 (41.5328%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.9771, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0651, Accuracy: 173/773 (22.3803%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0340, Accuracy: 436/773 (56.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2684, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0549, Accuracy: 356/1213 (29.3487%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 507/1213 (41.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2814, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   1, Avg loss: 0.0750, Accuracy: 131/603 (21.7247%)
___Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.6099, Accuracy: 48/10000 (0.4800%)
time spent on training: 125.52117800712585
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3978, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.5040, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.2083213329315 sec.
Server Epoch:6 choose agents : [45, 90, 0, 20, 60, 91, 57, 35, 47, 74].
___Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   1, Avg loss: 0.0706, Accuracy: 169/669 (25.2616%)
___Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.3408, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   1, Avg loss: 0.0543, Accuracy: 305/677 (45.0517%)
___Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 416/677 (61.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.9797, Accuracy: 48/10000 (0.4800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0593, Accuracy: 332/1657 (20.0362%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0356, Accuracy: 474/1657 (28.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0688, Accuracy: 69/10000 (0.6900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 372/807 (46.0967%)
___Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 400/807 (49.5663%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3872, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   1, Avg loss: 0.0505, Accuracy: 537/2227 (24.1132%)
___Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   2, Avg loss: 0.0289, Accuracy: 995/2227 (44.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.7679, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   1, Avg loss: 0.0505, Accuracy: 320/1030 (31.0680%)
___Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 625/1030 (60.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.7038, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   1, Avg loss: 0.0586, Accuracy: 247/1154 (21.4038%)
___Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 431/1154 (37.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 10.1806, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   1, Avg loss: 0.0935, Accuracy: 19/271 (7.0111%)
___Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   2, Avg loss: 0.0623, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.7066, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   1, Avg loss: 0.1183, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   2, Avg loss: 0.1055, Accuracy: 12/134 (8.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.4634, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 466/1552 (30.0258%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 770/1552 (49.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 11.1485, Accuracy: 81/10000 (0.8100%)
time spent on training: 160.52115941047668
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.5023, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.2891, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.4664776325226 sec.
Server Epoch:7 choose agents : [59, 65, 35, 25, 75, 57, 85, 89, 11, 97].
___Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   1, Avg loss: 0.0575, Accuracy: 298/1089 (27.3646%)
___Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 9.2595, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   1, Avg loss: 0.0583, Accuracy: 365/1475 (24.7458%)
___Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 628/1475 (42.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7620, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0929, Accuracy: 9/271 (3.3210%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0598, Accuracy: 97/271 (35.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.7384, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 319/690 (46.2319%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0296, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.3164, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   1, Avg loss: 0.0664, Accuracy: 204/776 (26.2887%)
___Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 411/776 (52.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7622, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   1, Avg loss: 0.0590, Accuracy: 243/1154 (21.0572%)
___Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   2, Avg loss: 0.0279, Accuracy: 433/1154 (37.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 9.4563, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0549, Accuracy: 490/1988 (24.6479%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0361, Accuracy: 649/1988 (32.6459%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3613, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   1, Avg loss: 0.0663, Accuracy: 275/896 (30.6920%)
___Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   2, Avg loss: 0.0357, Accuracy: 427/896 (47.6562%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.6884, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 343/712 (48.1742%)
___Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 419/712 (58.8483%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5014, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   1, Avg loss: 0.0547, Accuracy: 377/1213 (31.0800%)
___Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   2, Avg loss: 0.0281, Accuracy: 455/1213 (37.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.2855, Accuracy: 91/10000 (0.9100%)
time spent on training: 127.75703120231628
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.6879, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.3559, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.05062103271484 sec.
Server Epoch:8 choose agents : [69, 25, 14, 1, 63, 31, 49, 18, 13, 67].
___Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   1, Avg loss: 0.0512, Accuracy: 325/590 (55.0847%)
___Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   2, Avg loss: 0.0290, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3157, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 307/690 (44.4928%)
___Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.2085, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0671, Accuracy: 173/1013 (17.0780%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 312/1013 (30.7996%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.2621, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0556, Accuracy: 302/928 (32.5431%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 538/928 (57.9741%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3052, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0563, Accuracy: 225/888 (25.3378%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 442/888 (49.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.7399, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   1, Avg loss: 0.0773, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.6454, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   1, Avg loss: 0.0822, Accuracy: 11/440 (2.5000%)
___Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   2, Avg loss: 0.0490, Accuracy: 156/440 (35.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.1139, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   1, Avg loss: 0.0816, Accuracy: 89/530 (16.7925%)
___Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 274/530 (51.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.5770, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0589, Accuracy: 289/1645 (17.5684%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 588/1645 (35.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1265, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   1, Avg loss: 0.0779, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   2, Avg loss: 0.0427, Accuracy: 177/426 (41.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.6324, Accuracy: 51/10000 (0.5100%)
time spent on training: 116.14020919799805
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.4377, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 6.1357, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.8290026187897 sec.
Server Epoch:9 choose agents : [40, 90, 65, 14, 93, 30, 56, 82, 39, 99].
___Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   1, Avg loss: 0.0562, Accuracy: 308/1573 (19.5804%)
___Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 603/1573 (38.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.5249, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0530, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.8378, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0595, Accuracy: 356/1475 (24.1356%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 689/1475 (46.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.2604, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   1, Avg loss: 0.0669, Accuracy: 181/1013 (17.8677%)
___Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 361/1013 (35.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.1737, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0567, Accuracy: 383/1742 (21.9862%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 704/1742 (40.4133%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.3179, Accuracy: 81/10000 (0.8100%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   1, Avg loss: 0.0788, Accuracy: 63/486 (12.9630%)
___Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 213/486 (43.8272%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.0291, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0815, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0655, Accuracy: 67/186 (36.0215%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.8856, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   1, Avg loss: 0.0788, Accuracy: 38/500 (7.6000%)
___Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 185/500 (37.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.7400, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   1, Avg loss: 0.0552, Accuracy: 278/1013 (27.4432%)
___Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   2, Avg loss: 0.0274, Accuracy: 462/1013 (45.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.2643, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 171/773 (22.1216%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 381/773 (49.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7526, Accuracy: 56/10000 (0.5600%)
time spent on training: 133.18767619132996
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.8019, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 7.4352, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.45471143722534 sec.
Server Epoch:10 choose agents : [77, 16, 60, 47, 94, 33, 61, 95, 30, 6].
___Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 299/1340 (22.3134%)
___Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 547/1340 (40.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.6004, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   1, Avg loss: 0.0797, Accuracy: 173/708 (24.4350%)
___Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   2, Avg loss: 0.0382, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9704, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   1, Avg loss: 0.0510, Accuracy: 547/2227 (24.5622%)
___Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1017/2227 (45.6668%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.4212, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   1, Avg loss: 0.1247, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   2, Avg loss: 0.1044, Accuracy: 4/134 (2.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.6790, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   1, Avg loss: 0.0594, Accuracy: 333/1662 (20.0361%)
___Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   2, Avg loss: 0.0342, Accuracy: 585/1662 (35.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.0120, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   1, Avg loss: 0.0888, Accuracy: 8/515 (1.5534%)
___Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   2, Avg loss: 0.0549, Accuracy: 133/515 (25.8252%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9313, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1319, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1234, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.8415, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 297/599 (49.5826%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 10.7927, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0774, Accuracy: 61/486 (12.5514%)
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.4816, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0558, Accuracy: 334/1956 (17.0757%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 607/1956 (31.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.4554, Accuracy: 76/10000 (0.7600%)
time spent on training: 142.96447730064392
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7473, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 8.1671, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.58758425712585 sec.
Server Epoch:11 choose agents : [26, 84, 32, 6, 99, 13, 93, 12, 28, 15].
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0577, Accuracy: 282/1446 (19.5021%)
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 500/1446 (34.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.3236, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 293/1190 (24.6218%)
___Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 438/1190 (36.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0355, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0675, Accuracy: 126/735 (17.1429%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 342/735 (46.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.3138, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 352/1956 (17.9959%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0333, Accuracy: 579/1956 (29.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.3927, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   1, Avg loss: 0.0677, Accuracy: 165/773 (21.3454%)
___Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 428/773 (55.3687%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.3348, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0595, Accuracy: 301/1645 (18.2979%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 600/1645 (36.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.1632, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0576, Accuracy: 408/1742 (23.4214%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 681/1742 (39.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.6136, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 18/338 (5.3254%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0507, Accuracy: 128/338 (37.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.9192, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   1, Avg loss: 0.0591, Accuracy: 358/1581 (22.6439%)
___Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   2, Avg loss: 0.0349, Accuracy: 578/1581 (36.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9727, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   1, Avg loss: 0.0597, Accuracy: 280/1154 (24.2634%)
___Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 458/1154 (39.6880%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.8355, Accuracy: 65/10000 (0.6500%)
time spent on training: 132.88236594200134
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.7987, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 9.9264, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.5725407600403 sec.
Server Epoch:12 choose agents : [39, 86, 0, 34, 36, 92, 67, 30, 23, 15].
___Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 302/1013 (29.8124%)
___Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   2, Avg loss: 0.0270, Accuracy: 495/1013 (48.8648%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.3710, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 335/1003 (33.3998%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 413/1003 (41.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.0793, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   1, Avg loss: 0.0594, Accuracy: 342/1657 (20.6397%)
___Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 520/1657 (31.3820%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2759, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0563, Accuracy: 386/1427 (27.0498%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 594/1427 (41.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5343, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0959, Accuracy: 18/408 (4.4118%)
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0597, Accuracy: 149/408 (36.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2561, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0546, Accuracy: 405/1715 (23.6152%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 683/1715 (39.8251%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.5061, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   2, Avg loss: 0.0440, Accuracy: 175/426 (41.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.5964, Accuracy: 58/10000 (0.5800%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 60/486 (12.3457%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0432, Accuracy: 205/486 (42.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.1764, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   1, Avg loss: 0.0633, Accuracy: 263/715 (36.7832%)
___Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   2, Avg loss: 0.0369, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2231, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   1, Avg loss: 0.0600, Accuracy: 282/1154 (24.4367%)
___Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 452/1154 (39.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.6480, Accuracy: 74/10000 (0.7400%)
time spent on training: 152.1044602394104
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 10.0194, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 11.6242, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.2631604671478 sec.
Server Epoch:13 choose agents : [38, 81, 76, 16, 60, 7, 18, 54, 50, 25].
___Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   1, Avg loss: 0.0653, Accuracy: 202/1131 (17.8603%)
___Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 467/1131 (41.2909%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0837, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   1, Avg loss: 0.0678, Accuracy: 253/774 (32.6873%)
___Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   2, Avg loss: 0.0374, Accuracy: 288/774 (37.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.1473, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0954, Accuracy: 8/466 (1.7167%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0541, Accuracy: 184/466 (39.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.7374, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0718, Accuracy: 194/708 (27.4011%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0412, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.8649, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0515, Accuracy: 557/2227 (25.0112%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0288, Accuracy: 1000/2227 (44.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.7113, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0560, Accuracy: 335/891 (37.5982%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0270, Accuracy: 439/891 (49.2705%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.2128, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0876, Accuracy: 66/530 (12.4528%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0422, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0724, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 325/1130 (28.7611%)
___Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 469/1130 (41.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.6618, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0684, Accuracy: 120/809 (14.8331%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 310/809 (38.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.7356, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   1, Avg loss: 0.0620, Accuracy: 252/690 (36.5217%)
___Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   2, Avg loss: 0.0296, Accuracy: 454/690 (65.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.5209, Accuracy: 70/10000 (0.7000%)
time spent on training: 131.09093236923218
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 10.6798, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 12.5317, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.35014605522156 sec.
Server Epoch:14 choose agents : [75, 69, 70, 66, 36, 76, 88, 65, 89, 30].
___Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   1, Avg loss: 0.0682, Accuracy: 192/776 (24.7423%)
___Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 413/776 (53.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.8636, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0522, Accuracy: 285/590 (48.3051%)
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.3364, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0608, Accuracy: 300/1418 (21.1566%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 592/1418 (41.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2564, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0635, Accuracy: 239/1402 (17.0471%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0394, Accuracy: 378/1402 (26.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.7541, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0951, Accuracy: 24/408 (5.8824%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0589, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.5177, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   1, Avg loss: 0.0960, Accuracy: 5/466 (1.0730%)
___Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   2, Avg loss: 0.0533, Accuracy: 176/466 (37.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.9871, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   1, Avg loss: 0.0777, Accuracy: 123/603 (20.3980%)
___Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.9640, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0583, Accuracy: 367/1475 (24.8814%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0332, Accuracy: 607/1475 (41.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.8120, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 281/896 (31.3616%)
___Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 450/896 (50.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1589, Accuracy: 63/10000 (0.6300%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   1, Avg loss: 0.0830, Accuracy: 53/486 (10.9053%)
___Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   2, Avg loss: 0.0433, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6902, Accuracy: 56/10000 (0.5600%)
time spent on training: 140.38492846488953
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 11.5951, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 15.1682, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.78958106040955 sec.
Server Epoch:15 choose agents : [75, 67, 89, 84, 27, 45, 19, 70, 41, 20].
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0683, Accuracy: 196/776 (25.2577%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 403/776 (51.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.7338, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   1, Avg loss: 0.0865, Accuracy: 18/426 (4.2254%)
___Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   2, Avg loss: 0.0454, Accuracy: 180/426 (42.2535%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.2147, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   1, Avg loss: 0.0639, Accuracy: 280/896 (31.2500%)
___Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   2, Avg loss: 0.0351, Accuracy: 463/896 (51.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.5863, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 322/1190 (27.0588%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 445/1190 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9414, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   1, Avg loss: 0.0567, Accuracy: 380/1587 (23.9445%)
___Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   2, Avg loss: 0.0346, Accuracy: 576/1587 (36.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.0759, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   1, Avg loss: 0.0703, Accuracy: 168/669 (25.1121%)
___Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   2, Avg loss: 0.0423, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.5673, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   1, Avg loss: 0.0523, Accuracy: 340/1036 (32.8185%)
___Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 643/1036 (62.0656%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 10.9612, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0589, Accuracy: 355/1418 (25.0353%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 591/1418 (41.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.6478, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0708, Accuracy: 251/719 (34.9096%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0335, Accuracy: 462/719 (64.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.0063, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   1, Avg loss: 0.0634, Accuracy: 266/807 (32.9616%)
___Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 399/807 (49.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.1657, Accuracy: 65/10000 (0.6500%)
time spent on training: 147.63831543922424
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 10.8715, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 14.4748, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.2780566215515 sec.
Server Epoch:16 choose agents : [25, 23, 76, 70, 85, 6, 68, 74, 63, 35].
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0623, Accuracy: 257/690 (37.2464%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0306, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1328, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0625, Accuracy: 273/715 (38.1818%)
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.3921, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0948, Accuracy: 9/466 (1.9313%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0558, Accuracy: 178/466 (38.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.8306, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0593, Accuracy: 339/1418 (23.9069%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 579/1418 (40.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.4103, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   1, Avg loss: 0.0573, Accuracy: 457/1988 (22.9879%)
___Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 662/1988 (33.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.3063, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0553, Accuracy: 350/1956 (17.8937%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 583/1956 (29.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.5436, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   1, Avg loss: 0.0641, Accuracy: 340/1163 (29.2347%)
___Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   2, Avg loss: 0.0376, Accuracy: 471/1163 (40.4987%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6294, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 490/1552 (31.5722%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 746/1552 (48.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 11.0550, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0565, Accuracy: 241/888 (27.1396%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 444/888 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.4750, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0961, Accuracy: 3/271 (1.1070%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0610, Accuracy: 89/271 (32.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.2774, Accuracy: 53/10000 (0.5300%)
time spent on training: 152.47628784179688
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 10.2786, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 17.3438, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.11675810813904 sec.
Server Epoch:17 choose agents : [38, 31, 29, 86, 59, 67, 35, 24, 5, 46].
___Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   1, Avg loss: 0.0664, Accuracy: 206/1131 (18.2140%)
___Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 433/1131 (38.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.3457, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   1, Avg loss: 0.0751, Accuracy: 77/460 (16.7391%)
___Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 190/460 (41.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7277, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 426/1440 (29.5833%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 664/1440 (46.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.9617, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 353/1003 (35.1944%)
___Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 387/1003 (38.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4983, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   1, Avg loss: 0.0575, Accuracy: 280/1089 (25.7117%)
___Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 453/1089 (41.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 13.3382, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   1, Avg loss: 0.0873, Accuracy: 17/426 (3.9906%)
___Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   2, Avg loss: 0.0475, Accuracy: 178/426 (41.7840%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.3764, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0993, Accuracy: 4/271 (1.4760%)
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0644, Accuracy: 100/271 (36.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.2092, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   1, Avg loss: 0.0896, Accuracy: 6/312 (1.9231%)
___Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   2, Avg loss: 0.0476, Accuracy: 146/312 (46.7949%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.7261, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0567, Accuracy: 318/1628 (19.5332%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 745/1628 (45.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.6874, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   1, Avg loss: 0.0572, Accuracy: 408/1904 (21.4286%)
___Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 694/1904 (36.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.1334, Accuracy: 89/10000 (0.8900%)
time spent on training: 132.6876814365387
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 10.3682, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 15.9308, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.47335863113403 sec.
Server Epoch:18 choose agents : [82, 96, 3, 25, 2, 8, 84, 54, 78, 31].
___Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   1, Avg loss: 0.0779, Accuracy: 44/500 (8.8000%)
___Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 178/500 (35.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.3467, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   1, Avg loss: 0.0822, Accuracy: 26/311 (8.3601%)
___Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   2, Avg loss: 0.0579, Accuracy: 133/311 (42.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.9276, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0763, Accuracy: 84/781 (10.7554%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1253, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   1, Avg loss: 0.0608, Accuracy: 270/690 (39.1304%)
___Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   2, Avg loss: 0.0309, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1824, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0707, Accuracy: 169/605 (27.9339%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0430, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.6540, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0638, Accuracy: 232/1513 (15.3338%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0374, Accuracy: 455/1513 (30.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.9198, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   1, Avg loss: 0.0611, Accuracy: 315/1190 (26.4706%)
___Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/1190 (37.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.9827, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   1, Avg loss: 0.0508, Accuracy: 353/1130 (31.2389%)
___Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 501/1130 (44.3363%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.5180, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0902, Accuracy: 15/416 (3.6058%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0512, Accuracy: 167/416 (40.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.0074, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   1, Avg loss: 0.0750, Accuracy: 83/460 (18.0435%)
___Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   2, Avg loss: 0.0385, Accuracy: 189/460 (41.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.5800, Accuracy: 54/10000 (0.5400%)
time spent on training: 123.58280515670776
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 11.1495, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 16.3735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.8127727508545 sec.
Server Epoch:19 choose agents : [7, 92, 38, 18, 96, 99, 22, 64, 12, 16].
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0572, Accuracy: 311/891 (34.9046%)
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 450/891 (50.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.7685, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 368/1715 (21.4577%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 693/1715 (40.4082%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.6690, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   1, Avg loss: 0.0642, Accuracy: 200/1131 (17.6835%)
___Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 462/1131 (40.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.1243, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0934, Accuracy: 64/530 (12.0755%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0428, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4796, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   1, Avg loss: 0.0817, Accuracy: 27/311 (8.6817%)
___Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   2, Avg loss: 0.0571, Accuracy: 134/311 (43.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.8310, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   1, Avg loss: 0.0671, Accuracy: 173/773 (22.3803%)
___Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 389/773 (50.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.4466, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   1, Avg loss: 0.0473, Accuracy: 479/1470 (32.5850%)
___Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 822/1470 (55.9184%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.9548, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 183/953 (19.2025%)
___Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   2, Avg loss: 0.0389, Accuracy: 293/953 (30.7450%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7031, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   1, Avg loss: 0.0907, Accuracy: 9/338 (2.6627%)
___Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   2, Avg loss: 0.0496, Accuracy: 144/338 (42.6036%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.8807, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0731, Accuracy: 165/708 (23.3051%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0422, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7716, Accuracy: 51/10000 (0.5100%)
time spent on training: 137.87842535972595
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 10.1966, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 15.2207, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.700323343277 sec.
Server Epoch:20 choose agents : [81, 15, 59, 7, 68, 53, 76, 56, 63, 11].
___Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   1, Avg loss: 0.0726, Accuracy: 226/774 (29.1990%)
___Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   2, Avg loss: 0.0392, Accuracy: 315/774 (40.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6896, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 285/1154 (24.6967%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 431/1154 (37.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.5494, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0559, Accuracy: 319/1089 (29.2929%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 422/1089 (38.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 11.4902, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0578, Accuracy: 323/891 (36.2514%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 423/891 (47.4747%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5545, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   1, Avg loss: 0.0642, Accuracy: 319/1163 (27.4291%)
___Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   2, Avg loss: 0.0385, Accuracy: 439/1163 (37.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6998, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   1, Avg loss: 0.0549, Accuracy: 243/813 (29.8893%)
___Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 447/813 (54.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 12.1023, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0940, Accuracy: 12/466 (2.5751%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0533, Accuracy: 169/466 (36.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0187, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   1, Avg loss: 0.0767, Accuracy: 3/186 (1.6129%)
___Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   2, Avg loss: 0.0609, Accuracy: 81/186 (43.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.7334, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0554, Accuracy: 275/888 (30.9685%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 422/888 (47.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.8506, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 306/712 (42.9775%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 405/712 (56.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.5929, Accuracy: 71/10000 (0.7100%)
time spent on training: 131.58134818077087
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 12.6533, Accuracy: 39/10000 (0.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 17.3610, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.0453231334686 sec.
Server Epoch:21 choose agents : [0, 18, 27, 50, 82, 44, 79, 20, 69, 23].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0614, Accuracy: 337/1657 (20.3380%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0349, Accuracy: 578/1657 (34.8823%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0310, Accuracy: 667/1657 (40.2535%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0301, Accuracy: 705/1657 (42.5468%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0294, Accuracy: 727/1657 (43.8745%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0286, Accuracy: 729/1657 (43.9952%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0279, Accuracy: 775/1657 (46.7713%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0273, Accuracy: 782/1657 (47.1937%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0269, Accuracy: 800/1657 (48.2800%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0266, Accuracy: 814/1657 (49.1249%), train_poison_data_count: 520
Global model norm: 187.37590685237524.
Norm before scaling: 187.32396945198977. Distance: 1.3365416025379218
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0953, Accuracy: 63/10000 (0.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.8021, Accuracy: 9256/9950 (93.0251%)
Scaling by  100
Scaled Norm after poisoning: 225.49613702345323, distance: 133.65415666469187
Total norm for 3 adversaries is: 225.49613702345323. distance: 133.65415666469187
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   1, Avg loss: 0.0940, Accuracy: 58/530 (10.9434%)
___Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   2, Avg loss: 0.0451, Accuracy: 262/530 (49.4340%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.6909, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0567, Accuracy: 388/1587 (24.4486%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0351, Accuracy: 539/1587 (33.9635%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9568, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   1, Avg loss: 0.0703, Accuracy: 115/809 (14.2151%)
___Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   2, Avg loss: 0.0288, Accuracy: 332/809 (41.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.0368, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   1, Avg loss: 0.0773, Accuracy: 54/500 (10.8000%)
___Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 181/500 (36.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.3924, Accuracy: 59/10000 (0.5900%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   1, Avg loss: 0.0630, Accuracy: 349/1750 (19.9429%)
___Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   2, Avg loss: 0.0362, Accuracy: 660/1750 (37.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9261, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   1, Avg loss: 0.1136, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   2, Avg loss: 0.0943, Accuracy: 10/197 (5.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.9469, Accuracy: 56/10000 (0.5600%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0664, Accuracy: 247/807 (30.6072%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0346, Accuracy: 399/807 (49.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.6697, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   1, Avg loss: 0.0548, Accuracy: 238/590 (40.3390%)
___Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 10.9278, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   1, Avg loss: 0.0685, Accuracy: 238/715 (33.2867%)
___Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   2, Avg loss: 0.0368, Accuracy: 437/715 (61.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.6443, Accuracy: 58/10000 (0.5800%)
time spent on training: 249.10002326965332
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7786, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 2.6386, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.1976749897003 sec.
Server Epoch:22 choose agents : [12, 23, 52, 19, 80, 2, 44, 8, 82, 58].
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1288, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0677, Accuracy: 58/338 (17.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.4240, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   1, Avg loss: 0.0904, Accuracy: 122/715 (17.0629%)
___Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   2, Avg loss: 0.0516, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.3489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   1, Avg loss: 0.0919, Accuracy: 66/636 (10.3774%)
___Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   2, Avg loss: 0.0395, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 14.8189, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   1, Avg loss: 0.0706, Accuracy: 242/1036 (23.3591%)
___Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 647/1036 (62.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 14.8010, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0886, Accuracy: 57/682 (8.3578%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0429, Accuracy: 239/682 (35.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.2271, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.1039, Accuracy: 28/605 (4.6281%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0522, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.0840, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   1, Avg loss: 0.0767, Accuracy: 255/1750 (14.5714%)
___Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   2, Avg loss: 0.0367, Accuracy: 622/1750 (35.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2557, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0799, Accuracy: 123/1513 (8.1295%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0389, Accuracy: 421/1513 (27.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.8954, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   1, Avg loss: 0.1058, Accuracy: 3/500 (0.6000%)
___Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   2, Avg loss: 0.0546, Accuracy: 141/500 (28.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.4216, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0922, Accuracy: 157/803 (19.5517%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0451, Accuracy: 417/803 (51.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.8572, Accuracy: 51/10000 (0.5100%)
time spent on training: 144.23638105392456
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.6497, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 2.8991, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.438246011734 sec.
Server Epoch:23 choose agents : [20, 9, 57, 74, 2, 92, 23, 81, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0693, Accuracy: 232/807 (28.7485%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0375, Accuracy: 361/807 (44.7336%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0282, Accuracy: 444/807 (55.0186%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0268, Accuracy: 474/807 (58.7361%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0246, Accuracy: 502/807 (62.2057%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0236, Accuracy: 508/807 (62.9492%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0242, Accuracy: 494/807 (61.2144%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0240, Accuracy: 491/807 (60.8426%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0232, Accuracy: 500/807 (61.9579%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0233, Accuracy: 498/807 (61.7100%), train_poison_data_count: 260
Global model norm: 193.25250645205097.
Norm before scaling: 193.22691485660064. Distance: 0.9309363752334627
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.9878, Accuracy: 59/10000 (0.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.3845, Accuracy: 9442/9950 (94.8945%)
Scaling by  100
Scaled Norm after poisoning: 211.98648431267972, distance: 93.09363985391268
Total norm for 2 adversaries is: 211.98648431267972. distance: 93.09363985391268
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0697, Accuracy: 228/1275 (17.8824%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0206, Accuracy: 650/1275 (50.9804%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.0300, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   1, Avg loss: 0.0747, Accuracy: 175/1154 (15.1646%)
___Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   2, Avg loss: 0.0279, Accuracy: 437/1154 (37.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.2481, Accuracy: 67/10000 (0.6700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0593, Accuracy: 356/1552 (22.9381%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 755/1552 (48.6469%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.0495, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0990, Accuracy: 46/605 (7.6033%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0501, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.2441, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   1, Avg loss: 0.0675, Accuracy: 296/1715 (17.2595%)
___Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 674/1715 (39.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.7753, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   1, Avg loss: 0.0845, Accuracy: 143/715 (20.0000%)
___Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   2, Avg loss: 0.0488, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.1643, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0936, Accuracy: 106/774 (13.6951%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0462, Accuracy: 326/774 (42.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.9906, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.1017, Accuracy: 14/781 (1.7926%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0389, Accuracy: 229/781 (29.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.7232, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0629, Accuracy: 269/1628 (16.5233%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0274, Accuracy: 751/1628 (46.1302%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.6422, Accuracy: 134/10000 (1.3400%)
time spent on training: 235.33255529403687
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.5935, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.5347, Accuracy: 8635/9950 (86.7839%)
saving model
Done in 377.9543721675873 sec.
Server Epoch:24 choose agents : [67, 87, 90, 88, 15, 72, 3, 12, 54, 76].
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.1177, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0554, Accuracy: 123/426 (28.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3805, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   1, Avg loss: 0.0780, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   2, Avg loss: 0.0337, Accuracy: 373/1131 (32.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8764, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   1, Avg loss: 0.0624, Accuracy: 158/677 (23.3383%)
___Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 454/677 (67.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 12.7408, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   1, Avg loss: 0.0931, Accuracy: 35/603 (5.8043%)
___Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2960, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   1, Avg loss: 0.0754, Accuracy: 229/1154 (19.8440%)
___Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 388/1154 (33.6222%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.2002, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   1, Avg loss: 0.0816, Accuracy: 155/1241 (12.4899%)
___Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   2, Avg loss: 0.0389, Accuracy: 404/1241 (32.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.5566, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0980, Accuracy: 25/781 (3.2010%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0378, Accuracy: 215/781 (27.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.2535, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   2, Avg loss: 0.0622, Accuracy: 48/338 (14.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.9222, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   1, Avg loss: 0.0648, Accuracy: 241/1130 (21.3274%)
___Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 472/1130 (41.7699%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.2140, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.1215, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0553, Accuracy: 126/466 (27.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.8960, Accuracy: 50/10000 (0.5000%)
time spent on training: 131.1835618019104
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 11.9094, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.1234, Accuracy: 5191/9950 (52.1709%)
saving model
Done in 281.19628143310547 sec.
Server Epoch:25 choose agents : [74, 16, 75, 48, 28, 58, 93, 17, 20, 34].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0505, Accuracy: 483/1552 (31.1211%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0217, Accuracy: 776/1552 (50.0000%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0190, Accuracy: 901/1552 (58.0541%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0189, Accuracy: 900/1552 (57.9897%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0183, Accuracy: 922/1552 (59.4072%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0178, Accuracy: 952/1552 (61.3402%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0174, Accuracy: 946/1552 (60.9536%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0176, Accuracy: 954/1552 (61.4691%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0169, Accuracy: 961/1552 (61.9201%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0168, Accuracy: 985/1552 (63.4665%), train_poison_data_count: 496
Global model norm: 198.9703574028051.
Norm before scaling: 198.91640046763365. Distance: 1.3367365628008205
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.9711, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.2469, Accuracy: 9246/9950 (92.9246%)
Scaling by  100
Scaled Norm after poisoning: 234.80326705297352, distance: 133.67364204705802
Total norm for 2 adversaries is: 234.80326705297352. distance: 133.67364204705802
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0860, Accuracy: 104/708 (14.6893%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0399, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.4940, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   1, Avg loss: 0.0823, Accuracy: 139/776 (17.9124%)
___Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   2, Avg loss: 0.0317, Accuracy: 395/776 (50.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.8540, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0974, Accuracy: 3/631 (0.4754%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0445, Accuracy: 216/631 (34.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.4111, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   1, Avg loss: 0.0668, Accuracy: 293/1581 (18.5326%)
___Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   2, Avg loss: 0.0347, Accuracy: 562/1581 (35.5471%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.2652, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   1, Avg loss: 0.0767, Accuracy: 213/803 (26.5255%)
___Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   2, Avg loss: 0.0402, Accuracy: 404/803 (50.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5908, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   1, Avg loss: 0.0695, Accuracy: 306/1742 (17.5660%)
___Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   2, Avg loss: 0.0334, Accuracy: 680/1742 (39.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.4235, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   1, Avg loss: 0.0628, Accuracy: 258/1574 (16.3914%)
___Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   2, Avg loss: 0.0296, Accuracy: 579/1574 (36.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.7215, Accuracy: 89/10000 (0.8900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   1, Avg loss: 0.0306, Accuracy: 417/807 (51.6729%)
___Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   2, Avg loss: 0.0245, Accuracy: 458/807 (56.7534%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.5034, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   1, Avg loss: 0.0671, Accuracy: 303/1427 (21.2334%)
___Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   2, Avg loss: 0.0346, Accuracy: 579/1427 (40.5746%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9672, Accuracy: 78/10000 (0.7800%)
time spent on training: 256.07792949676514
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 27.5664, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 2.6630, Accuracy: 3013/9950 (30.2814%)
saving model
Done in 399.9834620952606 sec.
Server Epoch:26 choose agents : [17, 3, 87, 52, 86, 61, 79, 80, 49, 59].
___Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   1, Avg loss: 0.0787, Accuracy: 236/1574 (14.9936%)
___Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 622/1574 (39.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.5052, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/781 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0408, Accuracy: 227/781 (29.0653%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.8184, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0954, Accuracy: 164/1131 (14.5004%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0340, Accuracy: 369/1131 (32.6260%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.3017, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   1, Avg loss: 0.1122, Accuracy: 47/636 (7.3899%)
___Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   2, Avg loss: 0.0426, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 16.2282, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.1024, Accuracy: 171/1003 (17.0489%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0392, Accuracy: 383/1003 (38.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8832, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   1, Avg loss: 0.2365, Accuracy: 6/85 (7.0588%)
___Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   2, Avg loss: 0.2149, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 12.2332, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1986, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.1572, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.2309, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.1206, Accuracy: 1/682 (0.1466%)
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0425, Accuracy: 257/682 (37.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.1902, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.1461, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0727, Accuracy: 46/440 (10.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8435, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   1, Avg loss: 0.0878, Accuracy: 151/1089 (13.8659%)
___Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   2, Avg loss: 0.0325, Accuracy: 430/1089 (39.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 13.1186, Accuracy: 65/10000 (0.6500%)
time spent on training: 134.43013215065002
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.4495, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 4.4753, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.5057215690613 sec.
Server Epoch:27 choose agents : [95, 46, 85, 8, 54, 90, 27, 15, 74, 44].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0717, Accuracy: 144/599 (24.0401%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0266, Accuracy: 400/599 (66.7780%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0209, Accuracy: 481/599 (80.3005%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0229, Accuracy: 475/599 (79.2988%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0220, Accuracy: 469/599 (78.2972%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0210, Accuracy: 470/599 (78.4641%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0197, Accuracy: 483/599 (80.6344%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0183, Accuracy: 487/599 (81.3022%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0165, Accuracy: 486/599 (81.1352%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0186, Accuracy: 477/599 (79.6327%), train_poison_data_count: 200
Global model norm: 204.49868199453022.
Norm before scaling: 204.47847151350678. Distance: 0.8268760764186366
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.2372, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.0485, Accuracy: 9846/9950 (98.9548%)
Scaling by  100
Scaled Norm after poisoning: 218.54593159962965, distance: 82.68760924501476
Total norm for 3 adversaries is: 218.54593159962965. distance: 82.68760924501476
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   1, Avg loss: 0.0772, Accuracy: 307/1904 (16.1239%)
___Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 671/1904 (35.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6995, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0767, Accuracy: 353/1988 (17.7565%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0372, Accuracy: 647/1988 (32.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.4828, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0867, Accuracy: 138/1513 (9.1210%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 459/1513 (30.3371%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6437, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0850, Accuracy: 188/1130 (16.6372%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 489/1130 (43.2743%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 12.1064, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   1, Avg loss: 0.0866, Accuracy: 116/677 (17.1344%)
___Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   2, Avg loss: 0.0259, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 14.7246, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   1, Avg loss: 0.0771, Accuracy: 282/1587 (17.7694%)
___Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   2, Avg loss: 0.0354, Accuracy: 534/1587 (33.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.3488, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0909, Accuracy: 196/1154 (16.9844%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0339, Accuracy: 379/1154 (32.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.0215, Accuracy: 78/10000 (0.7800%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   1, Avg loss: 0.0225, Accuracy: 755/1552 (48.6469%)
___Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   2, Avg loss: 0.0197, Accuracy: 847/1552 (54.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.8689, Accuracy: 87/10000 (0.8700%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0834, Accuracy: 249/1750 (14.2286%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0364, Accuracy: 609/1750 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.1445, Accuracy: 111/10000 (1.1100%)
time spent on training: 273.0271146297455
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.8185, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 4.0274, Accuracy: 0/9950 (0.0000%)
saving model
Done in 416.2180199623108 sec.
Server Epoch:28 choose agents : [46, 17, 59, 22, 99, 72, 52, 98, 91, 82].
___Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   1, Avg loss: 0.0726, Accuracy: 322/1904 (16.9118%)
___Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 672/1904 (35.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2716, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0722, Accuracy: 257/1574 (16.3278%)
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0290, Accuracy: 595/1574 (37.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.3286, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   1, Avg loss: 0.0841, Accuracy: 193/1089 (17.7227%)
___Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 498/1089 (45.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.5632, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   1, Avg loss: 0.0687, Accuracy: 357/1470 (24.2857%)
___Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   2, Avg loss: 0.0253, Accuracy: 812/1470 (55.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.9120, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   1, Avg loss: 0.0975, Accuracy: 84/773 (10.8668%)
___Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   2, Avg loss: 0.0377, Accuracy: 402/773 (52.0052%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 11.0023, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   1, Avg loss: 0.0858, Accuracy: 210/1241 (16.9218%)
___Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   2, Avg loss: 0.0384, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2444, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   1, Avg loss: 0.0990, Accuracy: 100/636 (15.7233%)
___Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.4646, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1592, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0758, Accuracy: 35/373 (9.3834%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.1214, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0823, Accuracy: 170/1030 (16.5049%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0283, Accuracy: 634/1030 (61.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 11.3447, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0542, Accuracy: 149/500 (29.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2628, Accuracy: 63/10000 (0.6300%)
time spent on training: 156.55047297477722
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.9617, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 3.3437, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.11831736564636 sec.
Server Epoch:29 choose agents : [10, 7, 89, 13, 63, 58, 93, 74, 67, 70].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0703, Accuracy: 246/861 (28.5714%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0274, Accuracy: 388/861 (45.0639%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0198, Accuracy: 489/861 (56.7944%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0192, Accuracy: 502/861 (58.3043%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0183, Accuracy: 523/861 (60.7433%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0177, Accuracy: 550/861 (63.8792%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0177, Accuracy: 554/861 (64.3438%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0176, Accuracy: 560/861 (65.0407%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0165, Accuracy: 582/861 (67.5958%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0167, Accuracy: 567/861 (65.8537%), train_poison_data_count: 280
Global model norm: 209.92018572543233.
Norm before scaling: 209.89100594117892. Distance: 1.106709407522991
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.8532, Accuracy: 94/10000 (0.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.1790, Accuracy: 9568/9950 (96.1608%)
Scaling by  100
Scaled Norm after poisoning: 234.4511209719416, distance: 110.67093414290177
Total norm for 2 adversaries is: 234.4511209719416. distance: 110.67093414290177
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0788, Accuracy: 196/891 (21.9978%)
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0277, Accuracy: 468/891 (52.5253%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.7507, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0845, Accuracy: 197/896 (21.9866%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 458/896 (51.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3187, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   1, Avg loss: 0.0733, Accuracy: 224/1645 (13.6170%)
___Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   2, Avg loss: 0.0338, Accuracy: 590/1645 (35.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.9949, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0840, Accuracy: 121/888 (13.6261%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0293, Accuracy: 411/888 (46.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.2010, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0820, Accuracy: 203/803 (25.2802%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0403, Accuracy: 370/803 (46.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4363, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   1, Avg loss: 0.0715, Accuracy: 296/1742 (16.9920%)
___Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 687/1742 (39.4374%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2902, Accuracy: 86/10000 (0.8600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0385, Accuracy: 490/1552 (31.5722%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 783/1552 (50.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.2181, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   1, Avg loss: 0.1240, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   2, Avg loss: 0.0563, Accuracy: 135/426 (31.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.4549, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0749, Accuracy: 276/1418 (19.4640%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0324, Accuracy: 603/1418 (42.5247%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.5112, Accuracy: 95/10000 (0.9500%)
time spent on training: 250.9399914741516
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.6987, Accuracy: 88/10000 (0.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.3048, Accuracy: 9074/9950 (91.1960%)
saving model
Done in 399.30316853523254 sec.
Server Epoch:30 choose agents : [65, 62, 75, 52, 98, 71, 47, 25, 1, 15].
___Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   1, Avg loss: 0.0757, Accuracy: 265/1475 (17.9661%)
___Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   2, Avg loss: 0.0348, Accuracy: 590/1475 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.2105, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   1, Avg loss: 0.1106, Accuracy: 4/568 (0.7042%)
___Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   2, Avg loss: 0.0499, Accuracy: 249/568 (43.8380%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.1613, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   1, Avg loss: 0.0948, Accuracy: 116/776 (14.9485%)
___Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   2, Avg loss: 0.0336, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.5477, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0927, Accuracy: 85/636 (13.3648%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0400, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.2226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   1, Avg loss: 0.1447, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   2, Avg loss: 0.0807, Accuracy: 22/373 (5.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.1644, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   1, Avg loss: 0.1049, Accuracy: 19/818 (2.3227%)
___Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   2, Avg loss: 0.0325, Accuracy: 339/818 (41.4425%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.8528, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   1, Avg loss: 0.1919, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   2, Avg loss: 0.1651, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5411, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   1, Avg loss: 0.0867, Accuracy: 121/690 (17.5362%)
___Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   2, Avg loss: 0.0370, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.8116, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0803, Accuracy: 164/928 (17.6724%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0254, Accuracy: 560/928 (60.3448%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.9342, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0849, Accuracy: 204/1154 (17.6776%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 402/1154 (34.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.0820, Accuracy: 67/10000 (0.6700%)
time spent on training: 136.34806036949158
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.1607, Accuracy: 89/10000 (0.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 0.3190, Accuracy: 9083/9950 (91.2864%)
saving model
Done in 282.85817289352417 sec.
Server Epoch:31 choose agents : [30, 71, 96, 55, 75, 32, 34, 20, 1, 65].
poison local model 30 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Average loss: 0.0947, Accuracy: 105/486 (21.6049%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Average loss: 0.0521, Accuracy: 161/486 (33.1276%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   3, Average loss: 0.0388, Accuracy: 175/486 (36.0082%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   4, Average loss: 0.0376, Accuracy: 188/486 (38.6831%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   5, Average loss: 0.0351, Accuracy: 231/486 (47.5309%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   6, Average loss: 0.0318, Accuracy: 238/486 (48.9712%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   7, Average loss: 0.0316, Accuracy: 220/486 (45.2675%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   8, Average loss: 0.0312, Accuracy: 239/486 (49.1770%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   9, Average loss: 0.0300, Accuracy: 258/486 (53.0864%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch  10, Average loss: 0.0313, Accuracy: 236/486 (48.5597%), train_poison_data_count: 160
Global model norm: 215.20672292879235.
Norm before scaling: 215.19075839821747. Distance: 0.7775224643172732
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5003, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.2367, Accuracy: 9317/9950 (93.6382%)
Scaling by  100
Scaled Norm after poisoning: 227.18270283793615, distance: 77.75224197933137
Total norm for 3 adversaries is: 227.18270283793615. distance: 77.75224197933137
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   1, Avg loss: 0.0962, Accuracy: 39/818 (4.7677%)
___Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 359/818 (43.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.0611, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.1330, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0849, Accuracy: 23/311 (7.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.1817, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   1, Avg loss: 0.0818, Accuracy: 151/1071 (14.0990%)
___Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 511/1071 (47.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.7996, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   1, Avg loss: 0.0869, Accuracy: 127/776 (16.3660%)
___Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   2, Avg loss: 0.0343, Accuracy: 400/776 (51.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.2156, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0810, Accuracy: 91/735 (12.3810%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0277, Accuracy: 329/735 (44.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.5637, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   1, Avg loss: 0.0756, Accuracy: 234/1427 (16.3980%)
___Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 528/1427 (37.0007%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.5591, Accuracy: 77/10000 (0.7700%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   1, Avg loss: 0.0815, Accuracy: 142/807 (17.5960%)
___Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   2, Avg loss: 0.0351, Accuracy: 386/807 (47.8315%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.4162, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0752, Accuracy: 166/928 (17.8879%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 582/928 (62.7155%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.4603, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   1, Avg loss: 0.0729, Accuracy: 291/1475 (19.7288%)
___Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 636/1475 (43.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.2248, Accuracy: 98/10000 (0.9800%)
time spent on training: 243.73364281654358
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.8463, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 3.3820, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.2487509250641 sec.
Server Epoch:32 choose agents : [65, 23, 30, 72, 95, 33, 28, 49, 21, 55].
___Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   1, Avg loss: 0.0662, Accuracy: 304/1475 (20.6102%)
___Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 668/1475 (45.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.3271, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0820, Accuracy: 157/715 (21.9580%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0466, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.6480, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   1, Avg loss: 0.0393, Accuracy: 204/486 (41.9753%)
___Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   2, Avg loss: 0.0304, Accuracy: 260/486 (53.4979%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7351, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0775, Accuracy: 183/1241 (14.7462%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0378, Accuracy: 394/1241 (31.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1607, Accuracy: 63/10000 (0.6300%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0969, Accuracy: 81/599 (13.5225%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0307, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 16.6734, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   1, Avg loss: 0.1226, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   2, Avg loss: 0.0713, Accuracy: 106/515 (20.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1712, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   1, Avg loss: 0.0645, Accuracy: 272/1581 (17.2043%)
___Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   2, Avg loss: 0.0350, Accuracy: 570/1581 (36.0531%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.3375, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.1052, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0546, Accuracy: 107/440 (24.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4021, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   1, Avg loss: 0.0642, Accuracy: 315/1949 (16.1621%)
___Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 619/1949 (31.7599%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.8539, Accuracy: 84/10000 (0.8400%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   1, Avg loss: 0.0766, Accuracy: 150/1071 (14.0056%)
___Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   2, Avg loss: 0.0309, Accuracy: 511/1071 (47.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.1352, Accuracy: 77/10000 (0.7700%)
time spent on training: 197.8940498828888
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 13.4628, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 0.0228, Accuracy: 9922/9950 (99.7186%)
saving model
Done in 340.65291261672974 sec.
Server Epoch:33 choose agents : [44, 90, 9, 28, 97, 86, 63, 52, 14, 85].
poison local model 44 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Average loss: 0.0578, Accuracy: 601/1750 (34.3429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Average loss: 0.0329, Accuracy: 825/1750 (47.1429%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   3, Average loss: 0.0275, Accuracy: 917/1750 (52.4000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   4, Average loss: 0.0267, Accuracy: 945/1750 (54.0000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   5, Average loss: 0.0259, Accuracy: 956/1750 (54.6286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   6, Average loss: 0.0258, Accuracy: 971/1750 (55.4857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   7, Average loss: 0.0252, Accuracy: 983/1750 (56.1714%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   8, Average loss: 0.0248, Accuracy: 985/1750 (56.2857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   9, Average loss: 0.0246, Accuracy: 1007/1750 (57.5429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch  10, Average loss: 0.0244, Accuracy: 1010/1750 (57.7143%), train_poison_data_count: 560
Global model norm: 220.35728268257893.
Norm before scaling: 220.28806602094903. Distance: 1.3697396136741422
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.5371, Accuracy: 108/10000 (1.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.2657, Accuracy: 9417/9950 (94.6432%)
Scaling by  100
Scaled Norm after poisoning: 253.14214448111954, distance: 136.973951104763
Total norm for 1 adversaries is: 253.14214448111954. distance: 136.973951104763
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   1, Avg loss: 0.0590, Accuracy: 187/677 (27.6219%)
___Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.4532, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   1, Avg loss: 0.0596, Accuracy: 302/1275 (23.6863%)
___Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 733/1275 (57.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.7066, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   1, Avg loss: 0.0625, Accuracy: 291/1581 (18.4061%)
___Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 597/1581 (37.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.5635, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   1, Avg loss: 0.0730, Accuracy: 264/1213 (21.7642%)
___Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   2, Avg loss: 0.0286, Accuracy: 497/1213 (40.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.3818, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   1, Avg loss: 0.0726, Accuracy: 241/1003 (24.0279%)
___Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   2, Avg loss: 0.0361, Accuracy: 386/1003 (38.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2129, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   1, Avg loss: 0.0726, Accuracy: 134/888 (15.0901%)
___Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   2, Avg loss: 0.0280, Accuracy: 423/888 (47.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.5047, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   1, Avg loss: 0.0723, Accuracy: 130/636 (20.4403%)
___Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   2, Avg loss: 0.0360, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.3998, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0822, Accuracy: 78/1013 (7.6999%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0372, Accuracy: 348/1013 (34.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.0425, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   1, Avg loss: 0.0633, Accuracy: 352/1988 (17.7062%)
___Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 644/1988 (32.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2187, Accuracy: 99/10000 (0.9900%)
time spent on training: 265.5580551624298
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2514, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.4974, Accuracy: 8636/9950 (86.7940%)
saving model
Done in 412.1898989677429 sec.
Server Epoch:34 choose agents : [75, 51, 83, 60, 39, 88, 49, 64, 59, 13].
___Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   1, Avg loss: 0.0899, Accuracy: 114/776 (14.6907%)
___Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   2, Avg loss: 0.0345, Accuracy: 394/776 (50.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.8667, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   1, Avg loss: 0.0797, Accuracy: 130/1049 (12.3928%)
___Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   2, Avg loss: 0.0329, Accuracy: 509/1049 (48.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.2903, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0747, Accuracy: 313/1953 (16.0266%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 745/1953 (38.1464%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2856, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0640, Accuracy: 508/2227 (22.8110%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0290, Accuracy: 1024/2227 (45.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9328, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   1, Avg loss: 0.0742, Accuracy: 155/1013 (15.3011%)
___Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   2, Avg loss: 0.0291, Accuracy: 497/1013 (49.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.3096, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   1, Avg loss: 0.0645, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 276/603 (45.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.4586, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.1170, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0636, Accuracy: 75/440 (17.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.4647, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   1, Avg loss: 0.0814, Accuracy: 80/953 (8.3945%)
___Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 305/953 (32.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.6775, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   1, Avg loss: 0.0759, Accuracy: 176/1089 (16.1616%)
___Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   2, Avg loss: 0.0332, Accuracy: 450/1089 (41.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 11.4862, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0685, Accuracy: 320/1645 (19.4529%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 617/1645 (37.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.0972, Accuracy: 109/10000 (1.0900%)
time spent on training: 182.59474062919617
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.4733, Accuracy: 81/10000 (0.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 0.8754, Accuracy: 6849/9950 (68.8342%)
saving model
Done in 322.988392829895 sec.
Server Epoch:35 choose agents : [55, 53, 77, 15, 26, 52, 33, 82, 60, 63].
poison local model 55 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   1, Average loss: 0.0692, Accuracy: 298/1071 (27.8245%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   2, Average loss: 0.0300, Accuracy: 484/1071 (45.1914%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   3, Average loss: 0.0243, Accuracy: 559/1071 (52.1942%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   4, Average loss: 0.0237, Accuracy: 620/1071 (57.8898%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   5, Average loss: 0.0233, Accuracy: 627/1071 (58.5434%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   6, Average loss: 0.0217, Accuracy: 632/1071 (59.0103%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   7, Average loss: 0.0223, Accuracy: 636/1071 (59.3838%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   8, Average loss: 0.0212, Accuracy: 651/1071 (60.7843%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   9, Average loss: 0.0210, Accuracy: 648/1071 (60.5042%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch  10, Average loss: 0.0208, Accuracy: 656/1071 (61.2512%), train_poison_data_count: 340
Global model norm: 225.3304431135527.
Norm before scaling: 225.28990004547475. Distance: 1.186155863524884
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.6415, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.2119, Accuracy: 9349/9950 (93.9598%)
Scaling by  100
Scaled Norm after poisoning: 250.75088795954443, distance: 118.61559005090773
Total norm for 1 adversaries is: 250.75088795954443. distance: 118.61559005090773
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   1, Avg loss: 0.0751, Accuracy: 129/813 (15.8672%)
___Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 482/813 (59.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 13.8198, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   1, Avg loss: 0.0627, Accuracy: 235/1340 (17.5373%)
___Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   2, Avg loss: 0.0296, Accuracy: 513/1340 (38.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.4031, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   1, Avg loss: 0.0767, Accuracy: 219/1154 (18.9775%)
___Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 444/1154 (38.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.1820, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   1, Avg loss: 0.0732, Accuracy: 204/1446 (14.1079%)
___Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 529/1446 (36.5837%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1128, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   1, Avg loss: 0.0792, Accuracy: 121/636 (19.0252%)
___Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   2, Avg loss: 0.0390, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.3652, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0646, Accuracy: 81/515 (15.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3944, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   1, Avg loss: 0.1111, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   2, Avg loss: 0.0627, Accuracy: 135/500 (27.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.9153, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   1, Avg loss: 0.0622, Accuracy: 480/2227 (21.5537%)
___Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   2, Avg loss: 0.0295, Accuracy: 971/2227 (43.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.9099, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   1, Avg loss: 0.0750, Accuracy: 119/888 (13.4009%)
___Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   2, Avg loss: 0.0282, Accuracy: 454/888 (51.1261%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 11.7623, Accuracy: 83/10000 (0.8300%)
time spent on training: 252.8486771583557
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.8010, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.2279, Accuracy: 9211/9950 (92.5729%)
saving model
Done in 398.00350284576416 sec.
Server Epoch:36 choose agents : [13, 2, 71, 52, 77, 36, 14, 45, 7, 65].
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0733, Accuracy: 218/1645 (13.2523%)
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0339, Accuracy: 582/1645 (35.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.7763, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.1182, Accuracy: 7/605 (1.1570%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0497, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.5691, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0943, Accuracy: 44/818 (5.3790%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 371/818 (45.3545%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.1642, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0884, Accuracy: 101/636 (15.8805%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0430, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.4863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0680, Accuracy: 220/1340 (16.4179%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0288, Accuracy: 548/1340 (40.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.8041, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   1, Avg loss: 0.1113, Accuracy: 57/408 (13.9706%)
___Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   2, Avg loss: 0.0715, Accuracy: 146/408 (35.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.8535, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0976, Accuracy: 63/1013 (6.2192%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0374, Accuracy: 372/1013 (36.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.9632, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   1, Avg loss: 0.1039, Accuracy: 35/669 (5.2317%)
___Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   2, Avg loss: 0.0432, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7227, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0893, Accuracy: 159/891 (17.8451%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0314, Accuracy: 433/891 (48.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.3898, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   1, Avg loss: 0.0709, Accuracy: 295/1475 (20.0000%)
___Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   2, Avg loss: 0.0346, Accuracy: 630/1475 (42.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.5181, Accuracy: 102/10000 (1.0200%)
time spent on training: 168.9503993988037
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.8154, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 5.1990, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.95683431625366 sec.
Server Epoch:37 choose agents : [47, 82, 46, 56, 36, 98, 76, 12, 35, 63].
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1969, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1687, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.2045, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   1, Avg loss: 0.1168, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   2, Avg loss: 0.0598, Accuracy: 128/500 (25.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.0309, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0736, Accuracy: 291/1904 (15.2836%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 652/1904 (34.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.3894, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   1, Avg loss: 0.1362, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   2, Avg loss: 0.1115, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8676, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   1, Avg loss: 0.1058, Accuracy: 52/408 (12.7451%)
___Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   2, Avg loss: 0.0669, Accuracy: 149/408 (36.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.8934, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   1, Avg loss: 0.1220, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   2, Avg loss: 0.0656, Accuracy: 58/373 (15.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8442, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   1, Avg loss: 0.1189, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   2, Avg loss: 0.0590, Accuracy: 131/466 (28.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1085, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   1, Avg loss: 0.1317, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   2, Avg loss: 0.0648, Accuracy: 39/338 (11.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6024, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   1, Avg loss: 0.1412, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   2, Avg loss: 0.0875, Accuracy: 15/271 (5.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.7430, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   1, Avg loss: 0.0779, Accuracy: 122/888 (13.7387%)
___Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   2, Avg loss: 0.0283, Accuracy: 446/888 (50.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 11.4699, Accuracy: 83/10000 (0.8300%)
time spent on training: 131.57409954071045
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.7765, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 5.3976, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.1717300415039 sec.
Server Epoch:38 choose agents : [20, 56, 26, 83, 27, 50, 1, 89, 4, 41].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0846, Accuracy: 129/807 (15.9851%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0363, Accuracy: 405/807 (50.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.3624, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.1035, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7373, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0694, Accuracy: 279/1446 (19.2946%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0361, Accuracy: 507/1446 (35.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.9080, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   1, Avg loss: 0.0724, Accuracy: 304/1953 (15.5658%)
___Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   2, Avg loss: 0.0348, Accuracy: 717/1953 (36.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.0952, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   1, Avg loss: 0.0681, Accuracy: 321/1587 (20.2268%)
___Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   2, Avg loss: 0.0349, Accuracy: 558/1587 (35.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.6525, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   1, Avg loss: 0.0919, Accuracy: 83/809 (10.2596%)
___Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   2, Avg loss: 0.0328, Accuracy: 292/809 (36.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.4304, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0742, Accuracy: 184/928 (19.8276%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 544/928 (58.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.1914, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   1, Avg loss: 0.0858, Accuracy: 171/896 (19.0848%)
___Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   2, Avg loss: 0.0388, Accuracy: 431/896 (48.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2006, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0852, Accuracy: 196/901 (21.7536%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0388, Accuracy: 423/901 (46.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.1488, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0880, Accuracy: 149/719 (20.7232%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0389, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.6947, Accuracy: 69/10000 (0.6900%)
time spent on training: 183.27181482315063
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5944, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 5.6808, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.85307359695435 sec.
Server Epoch:39 choose agents : [45, 63, 78, 36, 55, 93, 46, 8, 18, 28].
___Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   1, Avg loss: 0.0874, Accuracy: 55/669 (8.2212%)
___Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   2, Avg loss: 0.0383, Accuracy: 361/669 (53.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3633, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0704, Accuracy: 135/888 (15.2027%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 451/888 (50.7883%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.3299, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   1, Avg loss: 0.0806, Accuracy: 105/416 (25.2404%)
___Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 183/416 (43.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.9468, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   1, Avg loss: 0.0945, Accuracy: 64/408 (15.6863%)
___Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   2, Avg loss: 0.0617, Accuracy: 148/408 (36.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.3135, Accuracy: 58/10000 (0.5800%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   1, Avg loss: 0.0298, Accuracy: 450/1071 (42.0168%)
___Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   2, Avg loss: 0.0242, Accuracy: 566/1071 (52.8478%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.9440, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   1, Avg loss: 0.0663, Accuracy: 332/1742 (19.0586%)
___Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   2, Avg loss: 0.0331, Accuracy: 674/1742 (38.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2266, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0679, Accuracy: 289/1904 (15.1786%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 702/1904 (36.8697%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.4390, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0723, Accuracy: 156/1513 (10.3106%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0380, Accuracy: 442/1513 (29.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.7229, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   1, Avg loss: 0.1052, Accuracy: 24/530 (4.5283%)
___Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   2, Avg loss: 0.0521, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.8332, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   1, Avg loss: 0.0707, Accuracy: 269/1581 (17.0145%)
___Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   2, Avg loss: 0.0362, Accuracy: 539/1581 (34.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3396, Accuracy: 92/10000 (0.9200%)
time spent on training: 181.99195218086243
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.2395, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 5.2830, Accuracy: 0/9950 (0.0000%)
saving model
Done in 330.3727056980133 sec.
Server Epoch:40 choose agents : [63, 47, 34, 98, 70, 76, 77, 11, 84, 87].
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0654, Accuracy: 144/888 (16.2162%)
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0277, Accuracy: 447/888 (50.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 11.6354, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1709, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1476, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8684, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   1, Avg loss: 0.0746, Accuracy: 260/1427 (18.2200%)
___Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 528/1427 (37.0007%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.9971, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   1, Avg loss: 0.0992, Accuracy: 1/373 (0.2681%)
___Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   2, Avg loss: 0.0550, Accuracy: 86/373 (23.0563%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0983, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0696, Accuracy: 258/1418 (18.1946%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 572/1418 (40.3385%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.5824, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   1, Avg loss: 0.1024, Accuracy: 1/466 (0.2146%)
___Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   2, Avg loss: 0.0545, Accuracy: 161/466 (34.5494%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.9922, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   1, Avg loss: 0.0587, Accuracy: 245/1340 (18.2836%)
___Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   2, Avg loss: 0.0290, Accuracy: 513/1340 (38.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.4339, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   1, Avg loss: 0.0825, Accuracy: 117/712 (16.4326%)
___Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   2, Avg loss: 0.0316, Accuracy: 436/712 (61.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 11.2951, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0690, Accuracy: 236/1190 (19.8319%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 442/1190 (37.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8953, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   1, Avg loss: 0.0643, Accuracy: 235/1131 (20.7781%)
___Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   2, Avg loss: 0.0331, Accuracy: 431/1131 (38.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.4143, Accuracy: 59/10000 (0.5900%)
time spent on training: 161.15298676490784
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.8488, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 5.0589, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 305.3428394794464 sec.
Server Epoch:41 choose agents : [59, 2, 68, 89, 47, 69, 90, 26, 96, 40].
___Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   1, Avg loss: 0.0681, Accuracy: 199/1089 (18.2736%)
___Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   2, Avg loss: 0.0325, Accuracy: 483/1089 (44.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.9654, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0936, Accuracy: 37/605 (6.1157%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0472, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.8152, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   1, Avg loss: 0.0802, Accuracy: 226/1163 (19.4325%)
___Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   2, Avg loss: 0.0406, Accuracy: 428/1163 (36.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1441, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0766, Accuracy: 191/896 (21.3170%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0387, Accuracy: 455/896 (50.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1928, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   1, Avg loss: 0.1651, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   2, Avg loss: 0.1423, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.3339, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   1, Avg loss: 0.0778, Accuracy: 115/590 (19.4915%)
___Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   2, Avg loss: 0.0365, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 13.6766, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0656, Accuracy: 170/677 (25.1108%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 11.9345, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   1, Avg loss: 0.0630, Accuracy: 281/1446 (19.4329%)
___Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 492/1446 (34.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9739, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.1087, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0722, Accuracy: 63/311 (20.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.9834, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   1, Avg loss: 0.0719, Accuracy: 251/1573 (15.9568%)
___Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   2, Avg loss: 0.0372, Accuracy: 593/1573 (37.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.6178, Accuracy: 74/10000 (0.7400%)
time spent on training: 163.51147484779358
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 19.5603, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 3.9966, Accuracy: 1492/9950 (14.9950%)
saving model
Saving model on epoch 41
Done in 308.1773443222046 sec.
Server Epoch:42 choose agents : [80, 48, 22, 54, 17, 4, 46, 71, 64, 34].
___Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   1, Avg loss: 0.0749, Accuracy: 90/682 (13.1965%)
___Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 273/682 (40.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.2203, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   1, Avg loss: 0.0965, Accuracy: 8/631 (1.2678%)
___Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   2, Avg loss: 0.0477, Accuracy: 208/631 (32.9635%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.9894, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   1, Avg loss: 0.0615, Accuracy: 339/1470 (23.0612%)
___Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 806/1470 (54.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.0872, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   1, Avg loss: 0.0649, Accuracy: 245/1130 (21.6814%)
___Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 464/1130 (41.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.3418, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   1, Avg loss: 0.0615, Accuracy: 252/1574 (16.0102%)
___Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 628/1574 (39.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.2618, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0805, Accuracy: 220/901 (24.4173%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0359, Accuracy: 395/901 (43.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1735, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   1, Avg loss: 0.0638, Accuracy: 315/1904 (16.5441%)
___Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 708/1904 (37.1849%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.5156, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   1, Avg loss: 0.0725, Accuracy: 81/818 (9.9022%)
___Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 362/818 (44.2543%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.0189, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0719, Accuracy: 102/953 (10.7030%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0389, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2988, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0707, Accuracy: 270/1427 (18.9208%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0356, Accuracy: 542/1427 (37.9818%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2883, Accuracy: 68/10000 (0.6800%)
time spent on training: 189.72010350227356
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 28.1568, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 9.6733, Accuracy: 230/9950 (2.3116%)
saving model
Saving model on epoch 42
Done in 337.0065050125122 sec.
Server Epoch:43 choose agents : [48, 64, 0, 16, 40, 36, 32, 96, 83, 81].
___Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   1, Avg loss: 0.0931, Accuracy: 9/631 (1.4263%)
___Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   2, Avg loss: 0.0477, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.6657, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   1, Avg loss: 0.0710, Accuracy: 106/953 (11.1228%)
___Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 320/953 (33.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.3574, Accuracy: 63/10000 (0.6300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   1, Avg loss: 0.0631, Accuracy: 275/1657 (16.5963%)
___Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 488/1657 (29.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.8957, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   1, Avg loss: 0.0756, Accuracy: 134/708 (18.9266%)
___Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   2, Avg loss: 0.0420, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.5644, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0701, Accuracy: 240/1573 (15.2575%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0379, Accuracy: 556/1573 (35.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0886, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   1, Avg loss: 0.0811, Accuracy: 94/408 (23.0392%)
___Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 153/408 (37.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.3567, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   1, Avg loss: 0.0692, Accuracy: 98/735 (13.3333%)
___Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 357/735 (48.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 12.6234, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   1, Avg loss: 0.1030, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   2, Avg loss: 0.0695, Accuracy: 76/311 (24.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.1848, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   1, Avg loss: 0.0677, Accuracy: 288/1953 (14.7465%)
___Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 710/1953 (36.3543%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1237, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   1, Avg loss: 0.0898, Accuracy: 81/774 (10.4651%)
___Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   2, Avg loss: 0.0404, Accuracy: 332/774 (42.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.1242, Accuracy: 68/10000 (0.6800%)
time spent on training: 192.78879284858704
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.5072, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 4.7278, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.30307269096375 sec.
Server Epoch:44 choose agents : [20, 4, 97, 32, 42, 33, 22, 30, 56, 0].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0736, Accuracy: 157/807 (19.4548%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0355, Accuracy: 422/807 (52.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4667, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0720, Accuracy: 228/901 (25.3052%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0370, Accuracy: 415/901 (46.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.9232, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   1, Avg loss: 0.0714, Accuracy: 240/1213 (19.7857%)
___Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 449/1213 (37.0157%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.6602, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0665, Accuracy: 140/735 (19.0476%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 380/735 (51.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 11.9428, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   1, Avg loss: 0.0681, Accuracy: 215/1372 (15.6706%)
___Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   2, Avg loss: 0.0348, Accuracy: 486/1372 (35.4227%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.0310, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   1, Avg loss: 0.1128, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   2, Avg loss: 0.0636, Accuracy: 97/515 (18.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.1570, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   1, Avg loss: 0.0595, Accuracy: 352/1470 (23.9456%)
___Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 792/1470 (53.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.7912, Accuracy: 111/10000 (1.1100%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   1, Avg loss: 0.0831, Accuracy: 8/486 (1.6461%)
___Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 222/486 (45.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.9050, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.1065, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0872, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.7875, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   1, Avg loss: 0.0626, Accuracy: 263/1657 (15.8721%)
___Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 498/1657 (30.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.6803, Accuracy: 62/10000 (0.6200%)
time spent on training: 217.06783866882324
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3059, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 4.2631, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.8203353881836 sec.
Server Epoch:45 choose agents : [4, 16, 34, 68, 62, 38, 61, 31, 86, 28].
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0691, Accuracy: 232/901 (25.7492%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0376, Accuracy: 418/901 (46.3929%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.6322, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   1, Avg loss: 0.0733, Accuracy: 154/708 (21.7514%)
___Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.6689, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   1, Avg loss: 0.0713, Accuracy: 289/1427 (20.2523%)
___Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   2, Avg loss: 0.0347, Accuracy: 547/1427 (38.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0726, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0765, Accuracy: 240/1163 (20.6363%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0390, Accuracy: 440/1163 (37.8332%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9620, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0667, Accuracy: 129/568 (22.7113%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0424, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.7468, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0709, Accuracy: 195/1131 (17.2414%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 526/1131 (46.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.6644, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1576, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1442, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.5550, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   1, Avg loss: 0.1010, Accuracy: 1/460 (0.2174%)
___Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   2, Avg loss: 0.0469, Accuracy: 175/460 (38.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.3405, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0652, Accuracy: 262/1003 (26.1216%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0377, Accuracy: 375/1003 (37.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.1072, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0672, Accuracy: 274/1581 (17.3308%)
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0361, Accuracy: 548/1581 (34.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.4457, Accuracy: 93/10000 (0.9300%)
time spent on training: 186.09456610679626
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.2513, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 4.5551, Accuracy: 0/9950 (0.0000%)
saving model
Done in 330.7845540046692 sec.
Server Epoch:46 choose agents : [2, 0, 60, 15, 30, 66, 81, 95, 58, 17].
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0924, Accuracy: 39/605 (6.4463%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0497, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.0075, Accuracy: 53/10000 (0.5300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   1, Avg loss: 0.0603, Accuracy: 290/1657 (17.5015%)
___Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 477/1657 (28.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.7154, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   1, Avg loss: 0.0583, Accuracy: 472/2227 (21.1944%)
___Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   2, Avg loss: 0.0305, Accuracy: 922/2227 (41.4010%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.6332, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0704, Accuracy: 249/1154 (21.5771%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0316, Accuracy: 408/1154 (35.3553%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.4153, Accuracy: 74/10000 (0.7400%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0837, Accuracy: 13/486 (2.6749%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 220/486 (45.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.1755, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   1, Avg loss: 0.0761, Accuracy: 159/1402 (11.3409%)
___Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 339/1402 (24.1797%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.3778, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   1, Avg loss: 0.0957, Accuracy: 64/774 (8.2687%)
___Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   2, Avg loss: 0.0405, Accuracy: 345/774 (44.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.5354, Accuracy: 70/10000 (0.7000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0870, Accuracy: 99/599 (16.5275%)
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 15.9878, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   1, Avg loss: 0.0621, Accuracy: 239/803 (29.7634%)
___Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   2, Avg loss: 0.0387, Accuracy: 427/803 (53.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.3273, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0579, Accuracy: 285/1574 (18.1067%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 637/1574 (40.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.4085, Accuracy: 94/10000 (0.9400%)
time spent on training: 236.9605393409729
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.2103, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 4.7549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.5868082046509 sec.
Server Epoch:47 choose agents : [80, 74, 96, 95, 41, 53, 13, 18, 70, 82].
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0720, Accuracy: 87/682 (12.7566%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0398, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.1587, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0448, Accuracy: 425/1552 (27.3840%)
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 706/1552 (45.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 11.8956, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   1, Avg loss: 0.0975, Accuracy: 2/311 (0.6431%)
___Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   2, Avg loss: 0.0675, Accuracy: 95/311 (30.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.6823, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0838, Accuracy: 115/599 (19.1987%)
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 15.9521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   1, Avg loss: 0.0741, Accuracy: 212/719 (29.4854%)
___Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   2, Avg loss: 0.0377, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.3845, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   1, Avg loss: 0.0652, Accuracy: 166/813 (20.4182%)
___Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   2, Avg loss: 0.0198, Accuracy: 483/813 (59.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 13.8544, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0649, Accuracy: 243/1645 (14.7720%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0346, Accuracy: 549/1645 (33.3739%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.8399, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   1, Avg loss: 0.0919, Accuracy: 75/530 (14.1509%)
___Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   2, Avg loss: 0.0486, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.8950, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   1, Avg loss: 0.0664, Accuracy: 264/1418 (18.6178%)
___Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   2, Avg loss: 0.0334, Accuracy: 574/1418 (40.4795%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.8594, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0855, Accuracy: 30/500 (6.0000%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0540, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.4749, Accuracy: 68/10000 (0.6800%)
time spent on training: 198.41456198692322
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.1589, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 4.4720, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.8365478515625 sec.
Server Epoch:48 choose agents : [55, 77, 34, 80, 27, 88, 59, 14, 45, 96].
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0376, Accuracy: 366/1071 (34.1737%)
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0257, Accuracy: 526/1071 (49.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.0628, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   1, Avg loss: 0.0552, Accuracy: 238/1340 (17.7612%)
___Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 544/1340 (40.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.7813, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   1, Avg loss: 0.0704, Accuracy: 276/1427 (19.3413%)
___Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   2, Avg loss: 0.0347, Accuracy: 577/1427 (40.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.1063, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   1, Avg loss: 0.0719, Accuracy: 79/682 (11.5836%)
___Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   2, Avg loss: 0.0402, Accuracy: 250/682 (36.6569%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.4774, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0600, Accuracy: 315/1587 (19.8488%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0346, Accuracy: 563/1587 (35.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.4364, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0733, Accuracy: 92/603 (15.2570%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.4043, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   1, Avg loss: 0.0688, Accuracy: 231/1089 (21.2121%)
___Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   2, Avg loss: 0.0309, Accuracy: 474/1089 (43.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.0128, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   1, Avg loss: 0.0828, Accuracy: 71/1013 (7.0089%)
___Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   2, Avg loss: 0.0368, Accuracy: 368/1013 (36.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.2160, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   1, Avg loss: 0.0813, Accuracy: 82/669 (12.2571%)
___Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 358/669 (53.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0776, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0944, Accuracy: 3/311 (0.9646%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0659, Accuracy: 96/311 (30.8682%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.4636, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.6792070865631
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.2024, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 4.5298, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.25650787353516 sec.
Server Epoch:49 choose agents : [88, 4, 12, 21, 78, 65, 74, 41, 55, 2].
___Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   1, Avg loss: 0.0721, Accuracy: 102/603 (16.9154%)
___Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.1696, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0693, Accuracy: 258/901 (28.6349%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0356, Accuracy: 402/901 (44.6171%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.0055, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   1, Avg loss: 0.1067, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   2, Avg loss: 0.0598, Accuracy: 88/338 (26.0355%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.4584, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0611, Accuracy: 314/1949 (16.1108%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 603/1949 (30.9389%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.9439, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   1, Avg loss: 0.0746, Accuracy: 85/416 (20.4327%)
___Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 193/416 (46.3942%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2731, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0587, Accuracy: 323/1475 (21.8983%)
___Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 591/1475 (40.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.2845, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 440/1552 (28.3505%)
___Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 757/1552 (48.7758%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 11.6917, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0700, Accuracy: 228/719 (31.7107%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0358, Accuracy: 462/719 (64.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3752, Accuracy: 60/10000 (0.6000%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   1, Avg loss: 0.0369, Accuracy: 372/1071 (34.7339%)
___Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   2, Avg loss: 0.0262, Accuracy: 527/1071 (49.2063%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2629, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0877, Accuracy: 51/605 (8.4298%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0477, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3059, Accuracy: 52/10000 (0.5200%)
time spent on training: 198.4288890361786
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.2364, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 4.4778, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.9868657588959 sec.
Server Epoch:50 choose agents : [33, 43, 89, 10, 19, 73, 12, 23, 42, 52].
___Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   1, Avg loss: 0.1103, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   2, Avg loss: 0.0654, Accuracy: 100/515 (19.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.6935, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   1, Avg loss: 0.0645, Accuracy: 196/946 (20.7188%)
___Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   2, Avg loss: 0.0370, Accuracy: 356/946 (37.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.9737, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   1, Avg loss: 0.0698, Accuracy: 239/896 (26.6741%)
___Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   2, Avg loss: 0.0376, Accuracy: 454/896 (50.6696%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4038, Accuracy: 57/10000 (0.5700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   1, Avg loss: 0.0519, Accuracy: 181/861 (21.0221%)
___Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   2, Avg loss: 0.0207, Accuracy: 465/861 (54.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 11.1398, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   1, Avg loss: 0.0622, Accuracy: 275/1036 (26.5444%)
___Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 617/1036 (59.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 13.4339, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   1, Avg loss: 0.0754, Accuracy: 140/938 (14.9254%)
___Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   2, Avg loss: 0.0384, Accuracy: 333/938 (35.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.3934, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   1, Avg loss: 0.1059, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   2, Avg loss: 0.0598, Accuracy: 89/338 (26.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0377, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   1, Avg loss: 0.0776, Accuracy: 183/715 (25.5944%)
___Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   2, Avg loss: 0.0452, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.1011, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0651, Accuracy: 226/1372 (16.4723%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0345, Accuracy: 508/1372 (37.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.2119, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0704, Accuracy: 167/636 (26.2579%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0377, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.5954, Accuracy: 50/10000 (0.5000%)
time spent on training: 178.81690287590027
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.2855, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 4.7094, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 322.22620940208435 sec.
Server Epoch:51 choose agents : [87, 56, 68, 6, 65, 8, 42, 76, 52, 45].
___Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 287/1131 (25.3758%)
___Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   2, Avg loss: 0.0347, Accuracy: 396/1131 (35.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.0210, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.1019, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0836, Accuracy: 2/186 (1.0753%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.2066, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   1, Avg loss: 0.0728, Accuracy: 239/1163 (20.5503%)
___Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   2, Avg loss: 0.0386, Accuracy: 459/1163 (39.4669%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2219, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0632, Accuracy: 282/1956 (14.4172%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 576/1956 (29.4479%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8425, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   1, Avg loss: 0.0596, Accuracy: 326/1475 (22.1017%)
___Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 576/1475 (39.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3189, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0669, Accuracy: 186/1513 (12.2935%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0384, Accuracy: 426/1513 (28.1560%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.4973, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0651, Accuracy: 220/1372 (16.0350%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0338, Accuracy: 513/1372 (37.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.1080, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0873, Accuracy: 15/466 (3.2189%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0508, Accuracy: 178/466 (38.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2395, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   1, Avg loss: 0.0711, Accuracy: 168/636 (26.4151%)
___Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   2, Avg loss: 0.0368, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8791, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   1, Avg loss: 0.0817, Accuracy: 66/669 (9.8655%)
___Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   2, Avg loss: 0.0387, Accuracy: 357/669 (53.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2473, Accuracy: 90/10000 (0.9000%)
time spent on training: 199.6171383857727
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.2288, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 4.2700, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.5725817680359 sec.
Server Epoch:52 choose agents : [5, 61, 23, 36, 64, 45, 13, 77, 7, 99].
___Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   1, Avg loss: 0.0579, Accuracy: 271/1628 (16.6462%)
___Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 704/1628 (43.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.6712, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1528, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1400, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0262, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   1, Avg loss: 0.0795, Accuracy: 172/715 (24.0559%)
___Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   2, Avg loss: 0.0473, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.9259, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   1, Avg loss: 0.0898, Accuracy: 53/408 (12.9902%)
___Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   2, Avg loss: 0.0579, Accuracy: 150/408 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9687, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   1, Avg loss: 0.0685, Accuracy: 122/953 (12.8017%)
___Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 337/953 (35.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3460, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   1, Avg loss: 0.0783, Accuracy: 79/669 (11.8087%)
___Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   2, Avg loss: 0.0405, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3801, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0653, Accuracy: 241/1645 (14.6505%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0355, Accuracy: 541/1645 (32.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.6576, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 279/1340 (20.8209%)
___Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   2, Avg loss: 0.0283, Accuracy: 512/1340 (38.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.7792, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0696, Accuracy: 190/891 (21.3244%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0281, Accuracy: 436/891 (48.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.0061, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   1, Avg loss: 0.0693, Accuracy: 142/773 (18.3700%)
___Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   2, Avg loss: 0.0327, Accuracy: 386/773 (49.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.2987, Accuracy: 75/10000 (0.7500%)
time spent on training: 204.5595099925995
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 17.9889, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 5.4151, Accuracy: 529/9950 (5.3166%)
saving model
Done in 348.200234413147 sec.
Server Epoch:53 choose agents : [96, 36, 89, 65, 62, 19, 45, 1, 34, 33].
___Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   1, Avg loss: 0.0863, Accuracy: 15/311 (4.8232%)
___Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   2, Avg loss: 0.0598, Accuracy: 118/311 (37.9421%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.8609, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   1, Avg loss: 0.0889, Accuracy: 38/408 (9.3137%)
___Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 149/408 (36.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.6437, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   1, Avg loss: 0.0699, Accuracy: 253/896 (28.2366%)
___Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   2, Avg loss: 0.0371, Accuracy: 445/896 (49.6652%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.1221, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   1, Avg loss: 0.0600, Accuracy: 309/1475 (20.9492%)
___Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 610/1475 (41.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.3163, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0673, Accuracy: 127/568 (22.3592%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0419, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.0754, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0602, Accuracy: 272/1036 (26.2548%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 646/1036 (62.3552%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 13.3380, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   1, Avg loss: 0.0775, Accuracy: 86/669 (12.8550%)
___Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.3023, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0627, Accuracy: 239/928 (25.7543%)
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0250, Accuracy: 522/928 (56.2500%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.1136, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   1, Avg loss: 0.0689, Accuracy: 289/1427 (20.2523%)
___Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 538/1427 (37.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2529, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   1, Avg loss: 0.1083, Accuracy: 1/515 (0.1942%)
___Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   2, Avg loss: 0.0686, Accuracy: 106/515 (20.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9347, Accuracy: 52/10000 (0.5200%)
time spent on training: 188.35732769966125
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 22.1292, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 10.4586, Accuracy: 61/9950 (0.6131%)
saving model
Done in 330.0310423374176 sec.
Server Epoch:54 choose agents : [47, 28, 66, 55, 29, 52, 42, 8, 17, 23].
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1603, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1407, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.6515, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0649, Accuracy: 289/1581 (18.2796%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0371, Accuracy: 517/1581 (32.7008%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4744, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0767, Accuracy: 168/1402 (11.9829%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0410, Accuracy: 348/1402 (24.8217%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.3242, Accuracy: 65/10000 (0.6500%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   1, Avg loss: 0.0407, Accuracy: 364/1071 (33.9869%)
___Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   2, Avg loss: 0.0273, Accuracy: 502/1071 (46.8721%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.9389, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   1, Avg loss: 0.0565, Accuracy: 374/1440 (25.9722%)
___Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   2, Avg loss: 0.0293, Accuracy: 676/1440 (46.9444%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.2108, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0665, Accuracy: 203/636 (31.9182%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.3255, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   1, Avg loss: 0.0662, Accuracy: 225/1372 (16.3994%)
___Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   2, Avg loss: 0.0344, Accuracy: 489/1372 (35.6414%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.5621, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0659, Accuracy: 206/1513 (13.6153%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/1513 (28.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.3923, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   1, Avg loss: 0.0583, Accuracy: 282/1574 (17.9161%)
___Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   2, Avg loss: 0.0297, Accuracy: 597/1574 (37.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.5662, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   1, Avg loss: 0.0738, Accuracy: 211/715 (29.5105%)
___Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   2, Avg loss: 0.0450, Accuracy: 437/715 (61.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.7354, Accuracy: 69/10000 (0.6900%)
time spent on training: 233.7272162437439
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 16.0331, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 4.5847, Accuracy: 856/9950 (8.6030%)
saving model
Done in 374.86202335357666 sec.
Server Epoch:55 choose agents : [40, 73, 17, 94, 50, 89, 8, 7, 99, 58].
___Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   1, Avg loss: 0.0707, Accuracy: 223/1573 (14.1767%)
___Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   2, Avg loss: 0.0389, Accuracy: 531/1573 (33.7572%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9864, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0730, Accuracy: 146/938 (15.5650%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0385, Accuracy: 314/938 (33.4755%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.4527, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   1, Avg loss: 0.0578, Accuracy: 278/1574 (17.6620%)
___Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 647/1574 (41.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.3522, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   1, Avg loss: 0.0717, Accuracy: 252/1662 (15.1625%)
___Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   2, Avg loss: 0.0353, Accuracy: 577/1662 (34.7172%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.7219, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   1, Avg loss: 0.0734, Accuracy: 123/809 (15.2040%)
___Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   2, Avg loss: 0.0315, Accuracy: 307/809 (37.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.9420, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0692, Accuracy: 259/896 (28.9062%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0370, Accuracy: 449/896 (50.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.0853, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   1, Avg loss: 0.0637, Accuracy: 218/1513 (14.4085%)
___Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   2, Avg loss: 0.0384, Accuracy: 425/1513 (28.0899%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.4709, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   1, Avg loss: 0.0647, Accuracy: 203/891 (22.7834%)
___Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 460/891 (51.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.5266, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 163/773 (21.0867%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 417/773 (53.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.6820, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0598, Accuracy: 258/803 (32.1295%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0395, Accuracy: 395/803 (49.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.2945, Accuracy: 58/10000 (0.5800%)
time spent on training: 224.4719216823578
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.9493, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 6.5933, Accuracy: 50/9950 (0.5025%)
saving model
Done in 371.37602043151855 sec.
Server Epoch:56 choose agents : [93, 82, 17, 59, 84, 14, 65, 13, 28, 10].
___Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   1, Avg loss: 0.0616, Accuracy: 338/1742 (19.4030%)
___Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   2, Avg loss: 0.0335, Accuracy: 654/1742 (37.5431%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.6532, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0852, Accuracy: 33/500 (6.6000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0518, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.4246, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0577, Accuracy: 300/1574 (19.0597%)
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 624/1574 (39.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.3705, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   1, Avg loss: 0.0647, Accuracy: 246/1089 (22.5895%)
___Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   2, Avg loss: 0.0315, Accuracy: 469/1089 (43.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.3757, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0660, Accuracy: 267/1190 (22.4370%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 452/1190 (37.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.8377, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   1, Avg loss: 0.0826, Accuracy: 81/1013 (7.9961%)
___Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   2, Avg loss: 0.0382, Accuracy: 347/1013 (34.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.4748, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0593, Accuracy: 320/1475 (21.6949%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0341, Accuracy: 608/1475 (41.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.5338, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0634, Accuracy: 256/1645 (15.5623%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0352, Accuracy: 549/1645 (33.3739%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.0358, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   1, Avg loss: 0.0652, Accuracy: 291/1581 (18.4061%)
___Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   2, Avg loss: 0.0366, Accuracy: 504/1581 (31.8786%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.7918, Accuracy: 76/10000 (0.7600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   1, Avg loss: 0.0542, Accuracy: 177/861 (20.5575%)
___Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 453/861 (52.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.0967, Accuracy: 97/10000 (0.9700%)
time spent on training: 239.16926908493042
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.1548, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 7.0329, Accuracy: 16/9950 (0.1608%)
saving model
Done in 382.10168528556824 sec.
Server Epoch:57 choose agents : [43, 89, 50, 55, 94, 77, 48, 34, 27, 7].
___Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 241/946 (25.4757%)
___Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 370/946 (39.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.2296, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0674, Accuracy: 266/896 (29.6875%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0369, Accuracy: 447/896 (49.8884%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.0815, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   1, Avg loss: 0.0725, Accuracy: 118/809 (14.5859%)
___Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   2, Avg loss: 0.0313, Accuracy: 304/809 (37.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.7697, Accuracy: 81/10000 (0.8100%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0440, Accuracy: 308/1071 (28.7582%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0278, Accuracy: 520/1071 (48.5528%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.5950, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   1, Avg loss: 0.0709, Accuracy: 231/1662 (13.8989%)
___Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   2, Avg loss: 0.0360, Accuracy: 516/1662 (31.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8529, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   1, Avg loss: 0.0509, Accuracy: 317/1340 (23.6567%)
___Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   2, Avg loss: 0.0282, Accuracy: 538/1340 (40.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.5075, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0833, Accuracy: 52/631 (8.2409%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0473, Accuracy: 234/631 (37.0840%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8176, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0682, Accuracy: 316/1427 (22.1444%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0354, Accuracy: 536/1427 (37.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.2455, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   1, Avg loss: 0.0590, Accuracy: 356/1587 (22.4323%)
___Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   2, Avg loss: 0.0350, Accuracy: 586/1587 (36.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.2169, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0651, Accuracy: 210/891 (23.5690%)
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0279, Accuracy: 471/891 (52.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.7982, Accuracy: 70/10000 (0.7000%)
time spent on training: 225.39747190475464
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.9786, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 7.2945, Accuracy: 30/9950 (0.3015%)
saving model
Done in 374.4911890029907 sec.
Server Epoch:58 choose agents : [42, 60, 4, 34, 79, 80, 75, 93, 9, 37].
___Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   1, Avg loss: 0.0656, Accuracy: 224/1372 (16.3265%)
___Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   2, Avg loss: 0.0339, Accuracy: 509/1372 (37.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0643, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   1, Avg loss: 0.0554, Accuracy: 514/2227 (23.0804%)
___Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 923/2227 (41.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0112, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0742, Accuracy: 234/901 (25.9711%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0390, Accuracy: 367/901 (40.7325%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.3171, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0661, Accuracy: 331/1427 (23.1955%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 530/1427 (37.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.2071, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   1, Avg loss: 0.1114, Accuracy: 2/197 (1.0152%)
___Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   2, Avg loss: 0.0950, Accuracy: 11/197 (5.5838%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.3656, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   1, Avg loss: 0.0699, Accuracy: 88/682 (12.9032%)
___Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   2, Avg loss: 0.0415, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.8828, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0704, Accuracy: 171/776 (22.0361%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0326, Accuracy: 418/776 (53.8660%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1572, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   1, Avg loss: 0.0613, Accuracy: 373/1742 (21.4122%)
___Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   2, Avg loss: 0.0331, Accuracy: 663/1742 (38.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.6859, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   1, Avg loss: 0.0608, Accuracy: 293/1275 (22.9804%)
___Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 696/1275 (54.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 11.9490, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   1, Avg loss: 0.0589, Accuracy: 318/1129 (28.1665%)
___Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   2, Avg loss: 0.0287, Accuracy: 678/1129 (60.0531%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.4435, Accuracy: 91/10000 (0.9100%)
time spent on training: 228.57902479171753
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 12.9020, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 7.8840, Accuracy: 14/9950 (0.1407%)
saving model
Done in 369.28003787994385 sec.
Server Epoch:59 choose agents : [36, 33, 94, 37, 79, 21, 28, 25, 35, 24].
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0883, Accuracy: 46/408 (11.2745%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0584, Accuracy: 150/408 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.0148, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   1, Avg loss: 0.1105, Accuracy: 5/515 (0.9709%)
___Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   2, Avg loss: 0.0687, Accuracy: 109/515 (21.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.5853, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   1, Avg loss: 0.0689, Accuracy: 276/1662 (16.6065%)
___Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   2, Avg loss: 0.0365, Accuracy: 511/1662 (30.7461%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.0080, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   1, Avg loss: 0.0575, Accuracy: 337/1129 (29.8494%)
___Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   2, Avg loss: 0.0291, Accuracy: 659/1129 (58.3702%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.4169, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   1, Avg loss: 0.1176, Accuracy: 7/197 (3.5533%)
___Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   2, Avg loss: 0.1013, Accuracy: 13/197 (6.5990%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.9653, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0619, Accuracy: 311/1949 (15.9569%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0349, Accuracy: 569/1949 (29.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.1501, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   1, Avg loss: 0.0642, Accuracy: 302/1581 (19.1018%)
___Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   2, Avg loss: 0.0363, Accuracy: 554/1581 (35.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.6056, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   1, Avg loss: 0.0624, Accuracy: 208/690 (30.1449%)
___Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.9780, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   1, Avg loss: 0.1082, Accuracy: 7/271 (2.5830%)
___Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   2, Avg loss: 0.0719, Accuracy: 66/271 (24.3542%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.7856, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   1, Avg loss: 0.0991, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   2, Avg loss: 0.0571, Accuracy: 95/312 (30.4487%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.9172, Accuracy: 50/10000 (0.5000%)
time spent on training: 209.31707572937012
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.9330, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 6.7858, Accuracy: 103/9950 (1.0352%)
saving model
Done in 351.9243757724762 sec.
Server Epoch:60 choose agents : [73, 88, 6, 42, 22, 24, 95, 80, 57, 30].
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0691, Accuracy: 174/938 (18.5501%)
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0373, Accuracy: 322/938 (34.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.4823, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0698, Accuracy: 126/603 (20.8955%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0436, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.5289, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   1, Avg loss: 0.0624, Accuracy: 335/1956 (17.1268%)
___Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   2, Avg loss: 0.0350, Accuracy: 576/1956 (29.4479%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.8311, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0652, Accuracy: 210/1372 (15.3061%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0350, Accuracy: 470/1372 (34.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5332, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   1, Avg loss: 0.0591, Accuracy: 375/1470 (25.5102%)
___Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 766/1470 (52.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.5011, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0997, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0567, Accuracy: 106/312 (33.9744%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7501, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   1, Avg loss: 0.0729, Accuracy: 170/599 (28.3806%)
___Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 14.7792, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 95/682 (13.9296%)
___Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   2, Avg loss: 0.0394, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6829, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   1, Avg loss: 0.0665, Accuracy: 227/1154 (19.6707%)
___Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   2, Avg loss: 0.0283, Accuracy: 481/1154 (41.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 11.1864, Accuracy: 73/10000 (0.7300%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   1, Avg loss: 0.0861, Accuracy: 22/486 (4.5267%)
___Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 215/486 (44.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.8027, Accuracy: 51/10000 (0.5100%)
time spent on training: 247.52679586410522
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 11.3115, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 7.2114, Accuracy: 30/9950 (0.3015%)
saving model
Saving model on epoch 60
Done in 394.0187849998474 sec.
Server Epoch:61 choose agents : [54, 10, 57, 79, 45, 65, 13, 58, 75, 12].
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0589, Accuracy: 286/1130 (25.3097%)
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0303, Accuracy: 477/1130 (42.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.3068, Accuracy: 63/10000 (0.6300%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 165/861 (19.1638%)
___Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 447/861 (51.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.9691, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   1, Avg loss: 0.0694, Accuracy: 233/1154 (20.1906%)
___Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   2, Avg loss: 0.0280, Accuracy: 453/1154 (39.2548%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 11.0137, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1131, Accuracy: 1/197 (0.5076%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0915, Accuracy: 14/197 (7.1066%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.0171, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   1, Avg loss: 0.0772, Accuracy: 109/669 (16.2930%)
___Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   2, Avg loss: 0.0425, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.0716, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   1, Avg loss: 0.0634, Accuracy: 310/1475 (21.0169%)
___Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   2, Avg loss: 0.0358, Accuracy: 600/1475 (40.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.9714, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   1, Avg loss: 0.0634, Accuracy: 247/1645 (15.0152%)
___Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   2, Avg loss: 0.0351, Accuracy: 553/1645 (33.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.0330, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   1, Avg loss: 0.0627, Accuracy: 259/803 (32.2540%)
___Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   2, Avg loss: 0.0378, Accuracy: 426/803 (53.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.2946, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   1, Avg loss: 0.0769, Accuracy: 156/776 (20.1031%)
___Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 421/776 (54.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.4991, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0994, Accuracy: 6/338 (1.7751%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0569, Accuracy: 108/338 (31.9527%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.2938, Accuracy: 51/10000 (0.5100%)
time spent on training: 232.33401727676392
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 13.3083, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 9.5677, Accuracy: 1/9950 (0.0101%)
saving model
Done in 378.44168162345886 sec.
Server Epoch:62 choose agents : [89, 55, 54, 26, 40, 6, 59, 57, 13, 73].
___Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   1, Avg loss: 0.0662, Accuracy: 279/896 (31.1384%)
___Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   2, Avg loss: 0.0366, Accuracy: 454/896 (50.6696%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.2424, Accuracy: 61/10000 (0.6100%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   1, Avg loss: 0.0467, Accuracy: 309/1071 (28.8515%)
___Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   2, Avg loss: 0.0281, Accuracy: 491/1071 (45.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.6133, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   1, Avg loss: 0.0604, Accuracy: 275/1130 (24.3363%)
___Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   2, Avg loss: 0.0312, Accuracy: 439/1130 (38.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 10.1563, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   1, Avg loss: 0.0572, Accuracy: 315/1446 (21.7842%)
___Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   2, Avg loss: 0.0359, Accuracy: 531/1446 (36.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.1351, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   1, Avg loss: 0.0689, Accuracy: 245/1573 (15.5753%)
___Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   2, Avg loss: 0.0376, Accuracy: 568/1573 (36.1093%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.1996, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   1, Avg loss: 0.0621, Accuracy: 308/1956 (15.7464%)
___Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   2, Avg loss: 0.0345, Accuracy: 588/1956 (30.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.9207, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0646, Accuracy: 297/1089 (27.2727%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0325, Accuracy: 458/1089 (42.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.5235, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   1, Avg loss: 0.0656, Accuracy: 229/1154 (19.8440%)
___Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   2, Avg loss: 0.0286, Accuracy: 500/1154 (43.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 10.7105, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0627, Accuracy: 259/1645 (15.7447%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0344, Accuracy: 574/1645 (34.8936%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.9657, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   1, Avg loss: 0.0685, Accuracy: 189/938 (20.1493%)
___Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   2, Avg loss: 0.0373, Accuracy: 351/938 (37.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.4051, Accuracy: 77/10000 (0.7700%)
time spent on training: 261.83737230300903
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 12.6219, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 11.4490, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.6660461425781 sec.
Server Epoch:63 choose agents : [88, 83, 25, 86, 4, 32, 99, 35, 73, 64].
___Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   1, Avg loss: 0.0670, Accuracy: 148/603 (24.5439%)
___Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 280/603 (46.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.6485, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   1, Avg loss: 0.0677, Accuracy: 316/1953 (16.1802%)
___Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   2, Avg loss: 0.0362, Accuracy: 696/1953 (35.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.0701, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0628, Accuracy: 197/690 (28.5507%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0294, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.7026, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   1, Avg loss: 0.0636, Accuracy: 271/1003 (27.0189%)
___Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   2, Avg loss: 0.0364, Accuracy: 411/1003 (40.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.1683, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0777, Accuracy: 236/901 (26.1931%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0382, Accuracy: 385/901 (42.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.4750, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   1, Avg loss: 0.0648, Accuracy: 131/735 (17.8231%)
___Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   2, Avg loss: 0.0214, Accuracy: 377/735 (51.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.7234, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0641, Accuracy: 184/773 (23.8034%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 415/773 (53.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.6819, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1154, Accuracy: 3/271 (1.1070%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0750, Accuracy: 60/271 (22.1402%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.0907, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   1, Avg loss: 0.0702, Accuracy: 175/938 (18.6567%)
___Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   2, Avg loss: 0.0369, Accuracy: 355/938 (37.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.0723, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0766, Accuracy: 94/953 (9.8636%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 319/953 (33.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.6723, Accuracy: 54/10000 (0.5400%)
time spent on training: 196.53412890434265
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.9902, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 10.1544, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.054318189621 sec.
Server Epoch:64 choose agents : [19, 68, 40, 0, 59, 96, 62, 63, 70, 81].
___Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   1, Avg loss: 0.0612, Accuracy: 252/1036 (24.3243%)
___Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 644/1036 (62.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 13.3860, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   1, Avg loss: 0.0755, Accuracy: 223/1163 (19.1745%)
___Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   2, Avg loss: 0.0389, Accuracy: 465/1163 (39.9828%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.4852, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   1, Avg loss: 0.0678, Accuracy: 257/1573 (16.3382%)
___Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   2, Avg loss: 0.0386, Accuracy: 547/1573 (34.7743%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.1851, Accuracy: 72/10000 (0.7200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 303/1657 (18.2861%)
___Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   2, Avg loss: 0.0361, Accuracy: 485/1657 (29.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6629, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   1, Avg loss: 0.0623, Accuracy: 285/1089 (26.1708%)
___Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 481/1089 (44.1690%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6316, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   1, Avg loss: 0.0922, Accuracy: 4/311 (1.2862%)
___Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   2, Avg loss: 0.0629, Accuracy: 99/311 (31.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.7177, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   1, Avg loss: 0.0645, Accuracy: 178/568 (31.3380%)
___Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   2, Avg loss: 0.0426, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.2079, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0624, Accuracy: 153/888 (17.2297%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0286, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 11.1788, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0676, Accuracy: 272/1418 (19.1819%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0337, Accuracy: 596/1418 (42.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6552, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0911, Accuracy: 83/774 (10.7235%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0403, Accuracy: 366/774 (47.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.6547, Accuracy: 67/10000 (0.6700%)
time spent on training: 233.4827687740326
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 11.9489, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 10.7759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 381.69133615493774 sec.
Server Epoch:65 choose agents : [82, 14, 61, 68, 51, 24, 76, 37, 34, 80].
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0891, Accuracy: 18/500 (3.6000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0544, Accuracy: 186/500 (37.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4086, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0828, Accuracy: 77/1013 (7.6012%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0382, Accuracy: 370/1013 (36.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.9572, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1510, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1426, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.0868, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0773, Accuracy: 213/1163 (18.3147%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0392, Accuracy: 453/1163 (38.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4264, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   1, Avg loss: 0.0723, Accuracy: 143/1049 (13.6320%)
___Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 454/1049 (43.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.3959, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   1, Avg loss: 0.0880, Accuracy: 4/312 (1.2821%)
___Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   2, Avg loss: 0.0502, Accuracy: 123/312 (39.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.3138, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 21/466 (4.5064%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0522, Accuracy: 181/466 (38.8412%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3269, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0573, Accuracy: 341/1129 (30.2037%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0276, Accuracy: 703/1129 (62.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.8722, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   1, Avg loss: 0.0639, Accuracy: 324/1427 (22.7050%)
___Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   2, Avg loss: 0.0352, Accuracy: 544/1427 (38.1219%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3721, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0668, Accuracy: 103/682 (15.1026%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 274/682 (40.1760%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.4355, Accuracy: 60/10000 (0.6000%)
time spent on training: 190.61762952804565
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 12.1262, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 12.0255, Accuracy: 0/9950 (0.0000%)
saving model
Done in 333.05112624168396 sec.
Server Epoch:66 choose agents : [29, 39, 13, 16, 89, 32, 70, 78, 86, 12].
___Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   1, Avg loss: 0.0555, Accuracy: 361/1440 (25.0694%)
___Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   2, Avg loss: 0.0289, Accuracy: 667/1440 (46.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.5395, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   1, Avg loss: 0.0567, Accuracy: 235/1013 (23.1984%)
___Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   2, Avg loss: 0.0291, Accuracy: 461/1013 (45.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.7149, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   1, Avg loss: 0.0637, Accuracy: 247/1645 (15.0152%)
___Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   2, Avg loss: 0.0348, Accuracy: 577/1645 (35.0760%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.0953, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   1, Avg loss: 0.0621, Accuracy: 213/708 (30.0847%)
___Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 425/708 (60.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3866, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0665, Accuracy: 266/896 (29.6875%)
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0377, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.0957, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   1, Avg loss: 0.0671, Accuracy: 123/735 (16.7347%)
___Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 367/735 (49.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 12.6184, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0665, Accuracy: 275/1418 (19.3935%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 609/1418 (42.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.7594, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0788, Accuracy: 48/416 (11.5385%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 192/416 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.1761, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0663, Accuracy: 271/1003 (27.0189%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0363, Accuracy: 408/1003 (40.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.4305, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   1, Avg loss: 0.0983, Accuracy: 8/338 (2.3669%)
___Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   2, Avg loss: 0.0579, Accuracy: 114/338 (33.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.6798, Accuracy: 50/10000 (0.5000%)
time spent on training: 221.07802200317383
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 11.9414, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 11.4129, Accuracy: 1/9950 (0.0101%)
saving model
Done in 364.37065839767456 sec.
Server Epoch:67 choose agents : [94, 66, 0, 19, 86, 99, 97, 78, 7, 76].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0684, Accuracy: 276/1662 (16.6065%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0358, Accuracy: 556/1662 (33.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.8333, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   1, Avg loss: 0.0775, Accuracy: 157/1402 (11.1983%)
___Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   2, Avg loss: 0.0413, Accuracy: 351/1402 (25.0357%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.4433, Accuracy: 75/10000 (0.7500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   1, Avg loss: 0.0564, Accuracy: 364/1657 (21.9674%)
___Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   2, Avg loss: 0.0368, Accuracy: 479/1657 (28.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.7709, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0608, Accuracy: 260/1036 (25.0965%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 642/1036 (61.9691%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 14.0903, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0642, Accuracy: 268/1003 (26.7198%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0359, Accuracy: 391/1003 (38.9831%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.1299, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   1, Avg loss: 0.0607, Accuracy: 184/773 (23.8034%)
___Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 400/773 (51.7464%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.3092, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   1, Avg loss: 0.0687, Accuracy: 268/1213 (22.0940%)
___Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   2, Avg loss: 0.0292, Accuracy: 461/1213 (38.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.6593, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0787, Accuracy: 50/416 (12.0192%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0456, Accuracy: 192/416 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.8651, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   1, Avg loss: 0.0725, Accuracy: 189/891 (21.2121%)
___Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   2, Avg loss: 0.0285, Accuracy: 461/891 (51.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.1803, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 17/466 (3.6481%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 173/466 (37.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.3833, Accuracy: 56/10000 (0.5600%)
time spent on training: 239.40980076789856
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.0805, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 4.1596, Accuracy: 0/9950 (0.0000%)
saving model
Done in 386.3886902332306 sec.
Server Epoch:68 choose agents : [47, 88, 74, 60, 6, 79, 68, 41, 15, 82].
___Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   1, Avg loss: 0.1400, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   2, Avg loss: 0.1314, Accuracy: 2/134 (1.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.6119, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0681, Accuracy: 143/603 (23.7148%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 265/603 (43.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4283, Accuracy: 58/10000 (0.5800%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   1, Avg loss: 0.0474, Accuracy: 388/1552 (25.0000%)
___Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 712/1552 (45.8763%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 11.7857, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0566, Accuracy: 493/2227 (22.1374%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0302, Accuracy: 946/2227 (42.4787%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.0409, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   1, Avg loss: 0.0605, Accuracy: 304/1956 (15.5419%)
___Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   2, Avg loss: 0.0335, Accuracy: 624/1956 (31.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.1519, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   1, Avg loss: 0.1143, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   2, Avg loss: 0.0942, Accuracy: 17/197 (8.6294%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.4463, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   1, Avg loss: 0.0742, Accuracy: 224/1163 (19.2605%)
___Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   2, Avg loss: 0.0379, Accuracy: 474/1163 (40.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2897, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   1, Avg loss: 0.0680, Accuracy: 232/719 (32.2670%)
___Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   2, Avg loss: 0.0362, Accuracy: 463/719 (64.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.4312, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   1, Avg loss: 0.0658, Accuracy: 297/1154 (25.7366%)
___Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 428/1154 (37.0884%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.9707, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0855, Accuracy: 25/500 (5.0000%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0523, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.0080, Accuracy: 60/10000 (0.6000%)
time spent on training: 229.10957098007202
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.0873, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 4.2538, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.6335804462433 sec.
Server Epoch:69 choose agents : [22, 25, 63, 47, 88, 9, 18, 92, 56, 67].
___Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   1, Avg loss: 0.0544, Accuracy: 386/1470 (26.2585%)
___Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 823/1470 (55.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.0872, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   1, Avg loss: 0.0653, Accuracy: 216/690 (31.3043%)
___Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   2, Avg loss: 0.0326, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.4226, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   1, Avg loss: 0.0629, Accuracy: 176/888 (19.8198%)
___Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 11.1310, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   1, Avg loss: 0.1440, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   2, Avg loss: 0.1292, Accuracy: 8/134 (5.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6608, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0676, Accuracy: 135/603 (22.3881%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 260/603 (43.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.5385, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   1, Avg loss: 0.0631, Accuracy: 275/1275 (21.5686%)
___Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   2, Avg loss: 0.0216, Accuracy: 648/1275 (50.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 12.0548, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   1, Avg loss: 0.0921, Accuracy: 82/530 (15.4717%)
___Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   2, Avg loss: 0.0483, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.5595, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   1, Avg loss: 0.0623, Accuracy: 322/1715 (18.7755%)
___Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   2, Avg loss: 0.0329, Accuracy: 641/1715 (37.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.9426, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   1, Avg loss: 0.1054, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   2, Avg loss: 0.0871, Accuracy: 2/186 (1.0753%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6150, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   1, Avg loss: 0.0974, Accuracy: 10/426 (2.3474%)
___Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/426 (35.4460%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.6878, Accuracy: 57/10000 (0.5700%)
time spent on training: 190.95843029022217
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.0536, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 3.7980, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.0956370830536 sec.
Server Epoch:70 choose agents : [22, 33, 47, 94, 75, 85, 88, 5, 73, 80].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0554, Accuracy: 380/1470 (25.8503%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 779/1470 (52.9932%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.1667, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   1, Avg loss: 0.1033, Accuracy: 1/515 (0.1942%)
___Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   2, Avg loss: 0.0642, Accuracy: 116/515 (22.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.2701, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1396, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1254, Accuracy: 3/134 (2.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.3298, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   1, Avg loss: 0.0674, Accuracy: 266/1662 (16.0048%)
___Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   2, Avg loss: 0.0359, Accuracy: 548/1662 (32.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0993, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0743, Accuracy: 135/776 (17.3969%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0326, Accuracy: 437/776 (56.3144%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.2376, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   1, Avg loss: 0.0639, Accuracy: 362/1988 (18.2093%)
___Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   2, Avg loss: 0.0392, Accuracy: 608/1988 (30.5835%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4722, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0696, Accuracy: 135/603 (22.3881%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0473, Accuracy: 274/603 (45.4395%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.9572, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   1, Avg loss: 0.0591, Accuracy: 285/1628 (17.5061%)
___Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   2, Avg loss: 0.0278, Accuracy: 702/1628 (43.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.8534, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0697, Accuracy: 155/938 (16.5245%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0380, Accuracy: 333/938 (35.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.6265, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   1, Avg loss: 0.0656, Accuracy: 110/682 (16.1290%)
___Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 245/682 (35.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.5295, Accuracy: 52/10000 (0.5200%)
time spent on training: 230.699369430542
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.1132, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 3.7102, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.25783228874207 sec.
Server Epoch:71 choose agents : [7, 79, 81, 44, 17, 9, 21, 95, 51, 70].
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1, Avg loss: 0.0723, Accuracy: 199/891 (22.3345%)
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 443/891 (49.7194%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.5158, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1190, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.1037, Accuracy: 7/197 (3.5533%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.2438, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0912, Accuracy: 71/774 (9.1731%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0473, Accuracy: 366/774 (47.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.3029, Accuracy: 72/10000 (0.7200%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   1, Avg loss: 0.0567, Accuracy: 324/1750 (18.5143%)
___Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   2, Avg loss: 0.0360, Accuracy: 640/1750 (36.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3964, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   1, Avg loss: 0.0603, Accuracy: 273/1574 (17.3443%)
___Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 629/1574 (39.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.1896, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   1, Avg loss: 0.0607, Accuracy: 287/1275 (22.5098%)
___Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 685/1275 (53.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 11.7136, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   1, Avg loss: 0.0600, Accuracy: 344/1949 (17.6501%)
___Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   2, Avg loss: 0.0340, Accuracy: 631/1949 (32.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0784, Accuracy: 81/10000 (0.8100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   1, Avg loss: 0.0782, Accuracy: 138/599 (23.0384%)
___Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 15.7222, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   1, Avg loss: 0.0683, Accuracy: 180/1049 (17.1592%)
___Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   2, Avg loss: 0.0325, Accuracy: 500/1049 (47.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.5905, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   1, Avg loss: 0.0640, Accuracy: 285/1418 (20.0987%)
___Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   2, Avg loss: 0.0337, Accuracy: 612/1418 (43.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0149, Accuracy: 86/10000 (0.8600%)
time spent on training: 266.02558398246765
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 15.8322, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 16.0636, Accuracy: 0/9950 (0.0000%)
saving model
Done in 414.12283849716187 sec.
Server Epoch:72 choose agents : [52, 6, 79, 96, 87, 25, 35, 83, 19, 89].
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1, Avg loss: 0.0599, Accuracy: 251/636 (39.4654%)
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/636 (66.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9729, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1, Avg loss: 0.0603, Accuracy: 297/1956 (15.1840%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 646/1956 (33.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9421, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   1, Avg loss: 0.1201, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   2, Avg loss: 0.0995, Accuracy: 9/197 (4.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.2864, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0876, Accuracy: 7/311 (2.2508%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0591, Accuracy: 108/311 (34.7267%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.8435, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0618, Accuracy: 254/1131 (22.4580%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0342, Accuracy: 421/1131 (37.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.6248, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   1, Avg loss: 0.0655, Accuracy: 201/690 (29.1304%)
___Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   2, Avg loss: 0.0307, Accuracy: 464/690 (67.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.6652, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   1, Avg loss: 0.1193, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   2, Avg loss: 0.0844, Accuracy: 55/271 (20.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.8411, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   1, Avg loss: 0.0682, Accuracy: 318/1953 (16.2826%)
___Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   2, Avg loss: 0.0366, Accuracy: 716/1953 (36.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2240, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0545, Accuracy: 282/1036 (27.2201%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 610/1036 (58.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 13.7508, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   1, Avg loss: 0.0696, Accuracy: 243/896 (27.1205%)
___Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   2, Avg loss: 0.0372, Accuracy: 466/896 (52.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.4656, Accuracy: 67/10000 (0.6700%)
time spent on training: 221.2614245414734
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.1708, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 3.5381, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.6731381416321 sec.
Server Epoch:73 choose agents : [33, 18, 68, 97, 36, 30, 4, 67, 23, 21].
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1058, Accuracy: 3/515 (0.5825%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0672, Accuracy: 113/515 (21.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.8556, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   1, Avg loss: 0.0915, Accuracy: 85/530 (16.0377%)
___Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   2, Avg loss: 0.0543, Accuracy: 263/530 (49.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7625, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   1, Avg loss: 0.0773, Accuracy: 204/1163 (17.5408%)
___Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   2, Avg loss: 0.0406, Accuracy: 452/1163 (38.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.4823, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1, Avg loss: 0.0701, Accuracy: 279/1213 (23.0008%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2, Avg loss: 0.0297, Accuracy: 464/1213 (38.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.7877, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0956, Accuracy: 18/408 (4.4118%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0598, Accuracy: 144/408 (35.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.3207, Accuracy: 55/10000 (0.5500%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   1, Avg loss: 0.0870, Accuracy: 30/486 (6.1728%)
___Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 219/486 (45.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.0697, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0752, Accuracy: 227/901 (25.1942%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0370, Accuracy: 404/901 (44.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.0073, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   1, Avg loss: 0.0916, Accuracy: 28/426 (6.5728%)
___Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   2, Avg loss: 0.0550, Accuracy: 171/426 (40.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.5099, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   1, Avg loss: 0.0739, Accuracy: 211/715 (29.5105%)
___Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   2, Avg loss: 0.0415, Accuracy: 435/715 (60.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.2167, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0598, Accuracy: 351/1949 (18.0092%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 584/1949 (29.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.1069, Accuracy: 78/10000 (0.7800%)
time spent on training: 231.45975160598755
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 16.8216, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 14.7491, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.1307590007782 sec.
Server Epoch:74 choose agents : [28, 44, 36, 74, 4, 77, 86, 13, 63, 93].
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0670, Accuracy: 298/1581 (18.8488%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0381, Accuracy: 514/1581 (32.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.6329, Accuracy: 89/10000 (0.8900%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 299/1750 (17.0857%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0372, Accuracy: 604/1750 (34.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.4830, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   1, Avg loss: 0.0922, Accuracy: 15/408 (3.6765%)
___Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   2, Avg loss: 0.0573, Accuracy: 148/408 (36.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.4562, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0481, Accuracy: 382/1552 (24.6134%)
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0233, Accuracy: 682/1552 (43.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 12.0050, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0736, Accuracy: 225/901 (24.9723%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0382, Accuracy: 398/901 (44.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.1252, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   1, Avg loss: 0.0546, Accuracy: 257/1340 (19.1791%)
___Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   2, Avg loss: 0.0290, Accuracy: 533/1340 (39.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.3610, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   1, Avg loss: 0.0698, Accuracy: 225/1003 (22.4327%)
___Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   2, Avg loss: 0.0373, Accuracy: 374/1003 (37.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.4989, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   1, Avg loss: 0.0642, Accuracy: 247/1645 (15.0152%)
___Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   2, Avg loss: 0.0351, Accuracy: 549/1645 (33.3739%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.1339, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0649, Accuracy: 165/888 (18.5811%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0277, Accuracy: 443/888 (49.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 11.6571, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0665, Accuracy: 343/1742 (19.6900%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0336, Accuracy: 672/1742 (38.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.1847, Accuracy: 80/10000 (0.8000%)
time spent on training: 298.22916865348816
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.1024, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 3.6402, Accuracy: 0/9950 (0.0000%)
saving model
Done in 441.7820327281952 sec.
Server Epoch:75 choose agents : [9, 40, 44, 67, 53, 47, 1, 98, 99, 57].
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1, Avg loss: 0.0575, Accuracy: 302/1275 (23.6863%)
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 674/1275 (52.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.0985, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0684, Accuracy: 266/1573 (16.9104%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0399, Accuracy: 503/1573 (31.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.1098, Accuracy: 76/10000 (0.7600%)
poison local model 44 index 6 
___Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   1, Avg loss: 0.0571, Accuracy: 297/1750 (16.9714%)
___Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 632/1750 (36.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.4477, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   1, Avg loss: 0.0890, Accuracy: 35/426 (8.2160%)
___Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   2, Avg loss: 0.0574, Accuracy: 176/426 (41.3146%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.8131, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   1, Avg loss: 0.0557, Accuracy: 215/813 (26.4453%)
___Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   2, Avg loss: 0.0206, Accuracy: 471/813 (57.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.9321, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   1, Avg loss: 0.1394, Accuracy: 3/134 (2.2388%)
___Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   2, Avg loss: 0.1223, Accuracy: 7/134 (5.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.1415, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0701, Accuracy: 200/928 (21.5517%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0260, Accuracy: 552/928 (59.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.5888, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   1, Avg loss: 0.1005, Accuracy: 1/373 (0.2681%)
___Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   2, Avg loss: 0.0590, Accuracy: 97/373 (26.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.4016, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   1, Avg loss: 0.0622, Accuracy: 169/773 (21.8629%)
___Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 412/773 (53.2988%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.9810, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1, Avg loss: 0.0710, Accuracy: 215/1154 (18.6308%)
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2, Avg loss: 0.0312, Accuracy: 408/1154 (35.3553%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.1138, Accuracy: 64/10000 (0.6400%)
time spent on training: 245.35173535346985
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 13.4062, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 10.9603, Accuracy: 9/9950 (0.0905%)
saving model
Done in 388.9361970424652 sec.
Server Epoch:76 choose agents : [93, 69, 79, 90, 4, 59, 86, 13, 22, 68].
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0666, Accuracy: 354/1742 (20.3215%)
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0333, Accuracy: 676/1742 (38.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.5832, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1, Avg loss: 0.0732, Accuracy: 172/590 (29.1525%)
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2, Avg loss: 0.0342, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 12.4506, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   2, Avg loss: 0.1005, Accuracy: 5/197 (2.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.2055, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   1, Avg loss: 0.0598, Accuracy: 222/677 (32.7917%)
___Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.9370, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0722, Accuracy: 234/901 (25.9711%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0362, Accuracy: 401/901 (44.5061%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1408, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   1, Avg loss: 0.0676, Accuracy: 260/1089 (23.8751%)
___Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   2, Avg loss: 0.0337, Accuracy: 465/1089 (42.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.7112, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   1, Avg loss: 0.0676, Accuracy: 248/1003 (24.7258%)
___Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   2, Avg loss: 0.0373, Accuracy: 369/1003 (36.7896%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.4306, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   1, Avg loss: 0.0632, Accuracy: 235/1645 (14.2857%)
___Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   2, Avg loss: 0.0349, Accuracy: 552/1645 (33.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1520, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   1, Avg loss: 0.0555, Accuracy: 362/1470 (24.6259%)
___Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   2, Avg loss: 0.0268, Accuracy: 779/1470 (52.9932%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.4228, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   1, Avg loss: 0.0794, Accuracy: 197/1163 (16.9390%)
___Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   2, Avg loss: 0.0418, Accuracy: 438/1163 (37.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.6855, Accuracy: 63/10000 (0.6300%)
time spent on training: 239.54963302612305
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 27.0044, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 24.3220, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.232381105423 sec.
Server Epoch:77 choose agents : [5, 77, 11, 59, 88, 41, 18, 93, 98, 37].
___Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   1, Avg loss: 0.0596, Accuracy: 305/1628 (18.7346%)
___Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   2, Avg loss: 0.0266, Accuracy: 784/1628 (48.1572%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.5656, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 299/1340 (22.3134%)
___Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   2, Avg loss: 0.0290, Accuracy: 493/1340 (36.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.7586, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1, Avg loss: 0.0727, Accuracy: 156/712 (21.9101%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 464/712 (65.1685%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 11.7107, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0755, Accuracy: 254/1089 (23.3242%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0332, Accuracy: 393/1089 (36.0882%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.2679, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0702, Accuracy: 131/603 (21.7247%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 267/603 (44.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.6303, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   1, Avg loss: 0.0680, Accuracy: 223/719 (31.0153%)
___Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   2, Avg loss: 0.0390, Accuracy: 458/719 (63.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.8486, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   1, Avg loss: 0.0891, Accuracy: 86/530 (16.2264%)
___Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   2, Avg loss: 0.0500, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.5424, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0674, Accuracy: 321/1742 (18.4271%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0339, Accuracy: 683/1742 (39.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8421, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.1041, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0612, Accuracy: 91/373 (24.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.1828, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   1, Avg loss: 0.0536, Accuracy: 351/1129 (31.0895%)
___Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   2, Avg loss: 0.0263, Accuracy: 696/1129 (61.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.4627, Accuracy: 98/10000 (0.9800%)
time spent on training: 243.99341320991516
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 15.0204, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 10.3866, Accuracy: 22/9950 (0.2211%)
saving model
Done in 391.31555247306824 sec.
Server Epoch:78 choose agents : [65, 18, 30, 33, 53, 94, 76, 64, 0, 29].
___Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   1, Avg loss: 0.0624, Accuracy: 326/1475 (22.1017%)
___Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   2, Avg loss: 0.0345, Accuracy: 574/1475 (38.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.5829, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0872, Accuracy: 98/530 (18.4906%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0506, Accuracy: 263/530 (49.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.5640, Accuracy: 64/10000 (0.6400%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0878, Accuracy: 28/486 (5.7613%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0418, Accuracy: 204/486 (41.9753%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 10.4524, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   1, Avg loss: 0.1059, Accuracy: 8/515 (1.5534%)
___Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   2, Avg loss: 0.0693, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9182, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   1, Avg loss: 0.0600, Accuracy: 207/813 (25.4613%)
___Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 430/813 (52.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 12.6802, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1, Avg loss: 0.0699, Accuracy: 276/1662 (16.6065%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2, Avg loss: 0.0372, Accuracy: 498/1662 (29.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.1143, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0878, Accuracy: 11/466 (2.3605%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 175/466 (37.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.6984, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0746, Accuracy: 70/953 (7.3452%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0402, Accuracy: 302/953 (31.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8853, Accuracy: 63/10000 (0.6300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 343/1657 (20.7001%)
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0360, Accuracy: 491/1657 (29.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.5768, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   1, Avg loss: 0.0583, Accuracy: 348/1440 (24.1667%)
___Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 669/1440 (46.4583%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.5566, Accuracy: 73/10000 (0.7300%)
time spent on training: 262.0045077800751
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 14.8316, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 8.8672, Accuracy: 86/9950 (0.8643%)
saving model
Done in 402.71573638916016 sec.
Server Epoch:79 choose agents : [1, 68, 51, 81, 10, 38, 27, 94, 19, 98].
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0682, Accuracy: 216/928 (23.2759%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 594/928 (64.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.8606, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   1, Avg loss: 0.0801, Accuracy: 189/1163 (16.2511%)
___Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   2, Avg loss: 0.0432, Accuracy: 430/1163 (36.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.7264, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0643, Accuracy: 189/1049 (18.0172%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0318, Accuracy: 510/1049 (48.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.5714, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   1, Avg loss: 0.0949, Accuracy: 60/774 (7.7519%)
___Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   2, Avg loss: 0.0447, Accuracy: 347/774 (44.8320%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.2843, Accuracy: 79/10000 (0.7900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   1, Avg loss: 0.0600, Accuracy: 167/861 (19.3961%)
___Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 447/861 (51.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 11.2316, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   1, Avg loss: 0.0698, Accuracy: 217/1131 (19.1866%)
___Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   2, Avg loss: 0.0322, Accuracy: 499/1131 (44.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.8809, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0614, Accuracy: 317/1587 (19.9748%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0359, Accuracy: 550/1587 (34.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.6628, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0693, Accuracy: 251/1662 (15.1023%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0372, Accuracy: 507/1662 (30.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.7926, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   1, Avg loss: 0.0553, Accuracy: 292/1036 (28.1853%)
___Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 654/1036 (63.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 12.8792, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.1019, Accuracy: 4/373 (1.0724%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0611, Accuracy: 96/373 (25.7373%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0243, Accuracy: 52/10000 (0.5200%)
time spent on training: 256.25465393066406
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 13.4681, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 10.7684, Accuracy: 5/9950 (0.0503%)
saving model
Done in 401.4948570728302 sec.
Server Epoch:80 choose agents : [75, 36, 16, 74, 20, 26, 57, 91, 19, 56].
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0762, Accuracy: 128/776 (16.4948%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0326, Accuracy: 414/776 (53.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.0748, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   1, Avg loss: 0.0909, Accuracy: 22/408 (5.3922%)
___Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   2, Avg loss: 0.0555, Accuracy: 156/408 (38.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3601, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   1, Avg loss: 0.0744, Accuracy: 179/708 (25.2825%)
___Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   2, Avg loss: 0.0361, Accuracy: 431/708 (60.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.0339, Accuracy: 65/10000 (0.6500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0502, Accuracy: 399/1552 (25.7088%)
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0238, Accuracy: 678/1552 (43.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.9384, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   1, Avg loss: 0.0678, Accuracy: 176/807 (21.8092%)
___Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   2, Avg loss: 0.0350, Accuracy: 411/807 (50.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.0851, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   1, Avg loss: 0.0564, Accuracy: 296/1446 (20.4703%)
___Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   2, Avg loss: 0.0368, Accuracy: 490/1446 (33.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3828, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   1, Avg loss: 0.0661, Accuracy: 226/1154 (19.5841%)
___Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 449/1154 (38.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.3162, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0672, Accuracy: 213/1030 (20.6796%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0282, Accuracy: 577/1030 (56.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.2564, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   1, Avg loss: 0.0583, Accuracy: 277/1036 (26.7375%)
___Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 595/1036 (57.4324%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 13.3154, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   1, Avg loss: 0.0995, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   2, Avg loss: 0.0826, Accuracy: 8/186 (4.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5715, Accuracy: 51/10000 (0.5100%)
time spent on training: 256.4590404033661
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 14.0621, Accuracy: 37/10000 (0.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 9.4025, Accuracy: 30/9950 (0.3015%)
saving model
Done in 396.6100947856903 sec.
Server Epoch:81 choose agents : [96, 50, 54, 97, 92, 82, 79, 65, 95, 81].
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0913, Accuracy: 8/311 (2.5723%)
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0615, Accuracy: 100/311 (32.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.8407, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0685, Accuracy: 119/809 (14.7095%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0297, Accuracy: 352/809 (43.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 10.6849, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0622, Accuracy: 280/1130 (24.7788%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0314, Accuracy: 434/1130 (38.4071%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.8314, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   1, Avg loss: 0.0716, Accuracy: 249/1213 (20.5276%)
___Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 501/1213 (41.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.8808, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0616, Accuracy: 321/1715 (18.7172%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0336, Accuracy: 619/1715 (36.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.3635, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   1, Avg loss: 0.0885, Accuracy: 21/500 (4.2000%)
___Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   2, Avg loss: 0.0542, Accuracy: 193/500 (38.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.5961, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   1, Avg loss: 0.1131, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   2, Avg loss: 0.0957, Accuracy: 9/197 (4.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.2435, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   1, Avg loss: 0.0600, Accuracy: 371/1475 (25.1525%)
___Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   2, Avg loss: 0.0348, Accuracy: 577/1475 (39.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4837, Accuracy: 92/10000 (0.9200%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0713, Accuracy: 179/599 (29.8831%)
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 14.7886, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0970, Accuracy: 60/774 (7.7519%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0419, Accuracy: 345/774 (44.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.4775, Accuracy: 68/10000 (0.6800%)
time spent on training: 228.31245017051697
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 15.6871, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 9.0805, Accuracy: 72/9950 (0.7236%)
saving model
Done in 375.70743203163147 sec.
Server Epoch:82 choose agents : [64, 98, 19, 25, 53, 74, 65, 96, 58, 16].
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0734, Accuracy: 108/953 (11.3326%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 294/953 (30.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.6456, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   1, Avg loss: 0.1022, Accuracy: 2/373 (0.5362%)
___Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   2, Avg loss: 0.0609, Accuracy: 92/373 (24.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4979, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   1, Avg loss: 0.0556, Accuracy: 308/1036 (29.7297%)
___Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   2, Avg loss: 0.0262, Accuracy: 601/1036 (58.0116%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 13.0987, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   1, Avg loss: 0.0702, Accuracy: 173/690 (25.0725%)
___Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   2, Avg loss: 0.0319, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 11.2258, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   1, Avg loss: 0.0583, Accuracy: 236/813 (29.0283%)
___Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   2, Avg loss: 0.0218, Accuracy: 432/813 (53.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 12.6956, Accuracy: 49/10000 (0.4900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0484, Accuracy: 407/1552 (26.2242%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0233, Accuracy: 701/1552 (45.1675%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 11.9565, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   1, Avg loss: 0.0578, Accuracy: 384/1475 (26.0339%)
___Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   2, Avg loss: 0.0343, Accuracy: 581/1475 (39.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.5649, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   1, Avg loss: 0.0919, Accuracy: 2/311 (0.6431%)
___Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   2, Avg loss: 0.0629, Accuracy: 97/311 (31.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.2385, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0753, Accuracy: 201/803 (25.0311%)
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0417, Accuracy: 435/803 (54.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4775, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1, Avg loss: 0.0666, Accuracy: 180/708 (25.4237%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2, Avg loss: 0.0415, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.9155, Accuracy: 56/10000 (0.5600%)
time spent on training: 249.0320644378662
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 15.6300, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 8.1034, Accuracy: 240/9950 (2.4121%)
saving model
Done in 391.09293150901794 sec.
Server Epoch:83 choose agents : [63, 88, 39, 85, 65, 22, 50, 86, 14, 33].
___Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   1, Avg loss: 0.0607, Accuracy: 181/888 (20.3829%)
___Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 453/888 (51.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 11.6175, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 111/603 (18.4080%)
___Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   2, Avg loss: 0.0485, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.9596, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   1, Avg loss: 0.0609, Accuracy: 208/1013 (20.5331%)
___Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   2, Avg loss: 0.0294, Accuracy: 493/1013 (48.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.5224, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   1, Avg loss: 0.0628, Accuracy: 366/1988 (18.4105%)
___Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   2, Avg loss: 0.0384, Accuracy: 604/1988 (30.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.6458, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 371/1475 (25.1525%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0331, Accuracy: 631/1475 (42.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.6417, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   1, Avg loss: 0.0589, Accuracy: 334/1470 (22.7211%)
___Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   2, Avg loss: 0.0273, Accuracy: 788/1470 (53.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.2961, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   1, Avg loss: 0.0674, Accuracy: 136/809 (16.8109%)
___Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   2, Avg loss: 0.0297, Accuracy: 344/809 (42.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.8935, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   1, Avg loss: 0.0677, Accuracy: 238/1003 (23.7288%)
___Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 417/1003 (41.5753%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3373, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   1, Avg loss: 0.0790, Accuracy: 126/1013 (12.4383%)
___Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   2, Avg loss: 0.0413, Accuracy: 328/1013 (32.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.1026, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.1093, Accuracy: 3/515 (0.5825%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0670, Accuracy: 103/515 (20.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.1087, Accuracy: 63/10000 (0.6300%)
time spent on training: 280.73421835899353
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 13.2250, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 6.7633, Accuracy: 262/9950 (2.6332%)
saving model
Done in 421.98583006858826 sec.
Server Epoch:84 choose agents : [46, 69, 35, 2, 38, 61, 48, 80, 0, 84].
___Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   1, Avg loss: 0.0627, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   2, Avg loss: 0.0322, Accuracy: 696/1904 (36.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7011, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   1, Avg loss: 0.0669, Accuracy: 195/590 (33.0508%)
___Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   2, Avg loss: 0.0405, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 12.9966, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1283, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0871, Accuracy: 28/271 (10.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.6814, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0802, Accuracy: 95/605 (15.7025%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0456, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.6718, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0658, Accuracy: 267/1131 (23.6074%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 503/1131 (44.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7686, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1451, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1327, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.4293, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   1, Avg loss: 0.0858, Accuracy: 39/631 (6.1807%)
___Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   2, Avg loss: 0.0494, Accuracy: 231/631 (36.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7817, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0659, Accuracy: 98/682 (14.3695%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 264/682 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.5675, Accuracy: 65/10000 (0.6500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0607, Accuracy: 308/1657 (18.5878%)
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0373, Accuracy: 467/1657 (28.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.8549, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   1, Avg loss: 0.0699, Accuracy: 231/1190 (19.4118%)
___Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 452/1190 (37.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.9366, Accuracy: 75/10000 (0.7500%)
time spent on training: 271.59323287010193
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 13.1304, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 4.6089, Accuracy: 1214/9950 (12.2010%)
saving model
Done in 413.96127820014954 sec.
Server Epoch:85 choose agents : [10, 27, 58, 65, 60, 31, 40, 48, 2, 16].
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   1, Avg loss: 0.0637, Accuracy: 126/861 (14.6341%)
___Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   2, Avg loss: 0.0226, Accuracy: 441/861 (51.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 11.0661, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   1, Avg loss: 0.0614, Accuracy: 338/1587 (21.2980%)
___Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   2, Avg loss: 0.0370, Accuracy: 541/1587 (34.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5502, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0738, Accuracy: 217/803 (27.0237%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0427, Accuracy: 433/803 (53.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.6523, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 388/1475 (26.3051%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2, Avg loss: 0.0342, Accuracy: 563/1475 (38.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5763, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   1, Avg loss: 0.0579, Accuracy: 471/2227 (21.1495%)
___Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   2, Avg loss: 0.0322, Accuracy: 872/2227 (39.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.1511, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0995, Accuracy: 18/460 (3.9130%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0495, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.3218, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   1, Avg loss: 0.0729, Accuracy: 238/1573 (15.1303%)
___Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   2, Avg loss: 0.0403, Accuracy: 510/1573 (32.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.2620, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   1, Avg loss: 0.0859, Accuracy: 28/631 (4.4374%)
___Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   2, Avg loss: 0.0496, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.8156, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0786, Accuracy: 115/605 (19.0083%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0453, Accuracy: 330/605 (54.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4274, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   1, Avg loss: 0.0657, Accuracy: 185/708 (26.1299%)
___Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   2, Avg loss: 0.0390, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5776, Accuracy: 75/10000 (0.7500%)
time spent on training: 304.62309551239014
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 12.7453, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 5.1396, Accuracy: 942/9950 (9.4673%)
saving model
Done in 450.5718643665314 sec.
Server Epoch:86 choose agents : [88, 3, 90, 19, 74, 8, 93, 84, 24, 62].
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1, Avg loss: 0.0720, Accuracy: 122/603 (20.2322%)
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2, Avg loss: 0.0483, Accuracy: 276/603 (45.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.8971, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0813, Accuracy: 76/781 (9.7311%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0401, Accuracy: 205/781 (26.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.2101, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   1, Avg loss: 0.0597, Accuracy: 219/677 (32.3486%)
___Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 12.5841, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0532, Accuracy: 308/1036 (29.7297%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0268, Accuracy: 608/1036 (58.6873%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 13.4440, Accuracy: 64/10000 (0.6400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0475, Accuracy: 375/1552 (24.1624%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0236, Accuracy: 699/1552 (45.0387%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 11.6999, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   1, Avg loss: 0.0718, Accuracy: 193/1513 (12.7561%)
___Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   2, Avg loss: 0.0405, Accuracy: 398/1513 (26.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.5846, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   1, Avg loss: 0.0701, Accuracy: 276/1742 (15.8439%)
___Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   2, Avg loss: 0.0361, Accuracy: 630/1742 (36.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.0328, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0707, Accuracy: 230/1190 (19.3277%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0337, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.0480, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0908, Accuracy: 4/312 (1.2821%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0486, Accuracy: 102/312 (32.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3197, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 126/568 (22.1831%)
___Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   2, Avg loss: 0.0455, Accuracy: 261/568 (45.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.6644, Accuracy: 58/10000 (0.5800%)
time spent on training: 272.4494185447693
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 15.2014, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 6.7783, Accuracy: 373/9950 (3.7487%)
saving model
Done in 414.21594762802124 sec.
Server Epoch:87 choose agents : [61, 30, 64, 21, 37, 89, 86, 47, 43, 63].
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1467, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1397, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5598, Accuracy: 41/10000 (0.4100%)
poison local model 30 index 5 
___Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   1, Avg loss: 0.0820, Accuracy: 24/486 (4.9383%)
___Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 207/486 (42.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.0574, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   1, Avg loss: 0.0730, Accuracy: 96/953 (10.0735%)
___Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   2, Avg loss: 0.0389, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.8886, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1, Avg loss: 0.0617, Accuracy: 287/1949 (14.7255%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2, Avg loss: 0.0365, Accuracy: 556/1949 (28.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.2241, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   1, Avg loss: 0.0585, Accuracy: 312/1129 (27.6351%)
___Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   2, Avg loss: 0.0287, Accuracy: 683/1129 (60.4960%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.6963, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   1, Avg loss: 0.0680, Accuracy: 247/896 (27.5670%)
___Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   2, Avg loss: 0.0374, Accuracy: 437/896 (48.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5709, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0687, Accuracy: 239/1003 (23.8285%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0391, Accuracy: 385/1003 (38.3848%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.3690, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1471, Accuracy: 4/134 (2.9851%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1377, Accuracy: 4/134 (2.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.8219, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0696, Accuracy: 243/946 (25.6871%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 356/946 (37.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.0753, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   1, Avg loss: 0.0609, Accuracy: 188/888 (21.1712%)
___Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   2, Avg loss: 0.0279, Accuracy: 429/888 (48.3108%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 11.7366, Accuracy: 73/10000 (0.7300%)
time spent on training: 255.03802275657654
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 16.4266, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 7.6899, Accuracy: 228/9950 (2.2915%)
saving model
Done in 396.4029941558838 sec.
Server Epoch:88 choose agents : [90, 31, 58, 73, 91, 48, 27, 50, 35, 61].
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1, Avg loss: 0.0623, Accuracy: 203/677 (29.9852%)
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 434/677 (64.1064%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 12.5712, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0955, Accuracy: 19/460 (4.1304%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0507, Accuracy: 180/460 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.7709, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   1, Avg loss: 0.0725, Accuracy: 203/803 (25.2802%)
___Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   2, Avg loss: 0.0414, Accuracy: 446/803 (55.5417%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.6142, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1, Avg loss: 0.0670, Accuracy: 199/938 (21.2154%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2, Avg loss: 0.0391, Accuracy: 330/938 (35.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.3695, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1, Avg loss: 0.0729, Accuracy: 208/1030 (20.1942%)
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2, Avg loss: 0.0280, Accuracy: 617/1030 (59.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.8291, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0861, Accuracy: 28/631 (4.4374%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0478, Accuracy: 225/631 (35.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.6269, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   1, Avg loss: 0.0618, Accuracy: 341/1587 (21.4871%)
___Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   2, Avg loss: 0.0363, Accuracy: 548/1587 (34.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.5401, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   1, Avg loss: 0.0648, Accuracy: 145/809 (17.9234%)
___Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   2, Avg loss: 0.0304, Accuracy: 332/809 (41.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.7895, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2, Avg loss: 0.0879, Accuracy: 39/271 (14.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.3014, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1497, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1359, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.5859, Accuracy: 41/10000 (0.4100%)
time spent on training: 216.38976168632507
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.1614, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 3.8793, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.4769859313965 sec.
Server Epoch:89 choose agents : [66, 87, 89, 19, 67, 71, 31, 39, 91, 84].
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0757, Accuracy: 157/1402 (11.1983%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 331/1402 (23.6091%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.5373, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   1, Avg loss: 0.0621, Accuracy: 215/1131 (19.0097%)
___Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   2, Avg loss: 0.0349, Accuracy: 398/1131 (35.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.4586, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0701, Accuracy: 236/896 (26.3393%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0382, Accuracy: 431/896 (48.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2852, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   1, Avg loss: 0.0529, Accuracy: 329/1036 (31.7568%)
___Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 652/1036 (62.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 13.4689, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0966, Accuracy: 14/426 (3.2864%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0562, Accuracy: 165/426 (38.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.0725, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   1, Avg loss: 0.0687, Accuracy: 84/818 (10.2689%)
___Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   2, Avg loss: 0.0335, Accuracy: 305/818 (37.2861%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.3376, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   1, Avg loss: 0.0974, Accuracy: 22/460 (4.7826%)
___Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   2, Avg loss: 0.0497, Accuracy: 180/460 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.5459, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0565, Accuracy: 242/1013 (23.8894%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 452/1013 (44.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.3148, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   1, Avg loss: 0.0725, Accuracy: 218/1030 (21.1650%)
___Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 601/1030 (58.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 11.2106, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0718, Accuracy: 217/1190 (18.2353%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0347, Accuracy: 436/1190 (36.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.0434, Accuracy: 78/10000 (0.7800%)
time spent on training: 247.7235622406006
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 18.6777, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 6.3212, Accuracy: 748/9950 (7.5176%)
saving model
Done in 387.253790140152 sec.
Server Epoch:90 choose agents : [46, 51, 28, 5, 48, 71, 20, 24, 41, 17].
___Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   1, Avg loss: 0.0647, Accuracy: 352/1904 (18.4874%)
___Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   2, Avg loss: 0.0326, Accuracy: 659/1904 (34.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.6887, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0683, Accuracy: 167/1049 (15.9199%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0313, Accuracy: 505/1049 (48.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.8539, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0718, Accuracy: 287/1581 (18.1531%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0389, Accuracy: 500/1581 (31.6256%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.4688, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   1, Avg loss: 0.0606, Accuracy: 331/1628 (20.3317%)
___Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   2, Avg loss: 0.0280, Accuracy: 731/1628 (44.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.2246, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   1, Avg loss: 0.0852, Accuracy: 25/631 (3.9620%)
___Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   2, Avg loss: 0.0476, Accuracy: 227/631 (35.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.5834, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0684, Accuracy: 91/818 (11.1247%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0336, Accuracy: 326/818 (39.8533%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.4037, Accuracy: 64/10000 (0.6400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   1, Avg loss: 0.0663, Accuracy: 182/807 (22.5527%)
___Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   2, Avg loss: 0.0341, Accuracy: 415/807 (51.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.0789, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0983, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0533, Accuracy: 91/312 (29.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.4406, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0671, Accuracy: 221/719 (30.7371%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0364, Accuracy: 447/719 (62.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.7003, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   1, Avg loss: 0.0615, Accuracy: 321/1574 (20.3939%)
___Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 597/1574 (37.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.1218, Accuracy: 91/10000 (0.9100%)
time spent on training: 264.6784255504608
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.7650, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 4.9251, Accuracy: 912/9950 (9.1658%)
saving model
Done in 412.2113733291626 sec.
Server Epoch:91 choose agents : [26, 43, 41, 42, 36, 81, 31, 76, 8, 57].
___Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   1, Avg loss: 0.0580, Accuracy: 322/1446 (22.2683%)
___Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   2, Avg loss: 0.0382, Accuracy: 499/1446 (34.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.3971, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0675, Accuracy: 246/946 (26.0042%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0382, Accuracy: 345/946 (36.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.0822, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   1, Avg loss: 0.0665, Accuracy: 219/719 (30.4590%)
___Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   2, Avg loss: 0.0386, Accuracy: 450/719 (62.5869%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 10.0707, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   1, Avg loss: 0.0722, Accuracy: 190/1372 (13.8484%)
___Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   2, Avg loss: 0.0360, Accuracy: 459/1372 (33.4548%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.5822, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0939, Accuracy: 13/408 (3.1863%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4775, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   1, Avg loss: 0.0915, Accuracy: 71/774 (9.1731%)
___Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   2, Avg loss: 0.0430, Accuracy: 351/774 (45.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.8475, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   1, Avg loss: 0.0960, Accuracy: 24/460 (5.2174%)
___Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   2, Avg loss: 0.0488, Accuracy: 178/460 (38.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.4246, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   1, Avg loss: 0.0906, Accuracy: 9/466 (1.9313%)
___Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   2, Avg loss: 0.0530, Accuracy: 175/466 (37.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4867, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   1, Avg loss: 0.0716, Accuracy: 214/1513 (14.1441%)
___Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/1513 (28.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.5769, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   1, Avg loss: 0.0710, Accuracy: 209/1154 (18.1109%)
___Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   2, Avg loss: 0.0289, Accuracy: 433/1154 (37.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 11.5913, Accuracy: 58/10000 (0.5800%)
time spent on training: 217.65841603279114
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 12.0655, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 5.0066, Accuracy: 782/9950 (7.8593%)
saving model
Done in 365.7076072692871 sec.
Server Epoch:92 choose agents : [38, 36, 76, 12, 77, 96, 67, 3, 53, 25].
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0724, Accuracy: 216/1131 (19.0981%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0345, Accuracy: 493/1131 (43.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.0220, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   1, Avg loss: 0.0964, Accuracy: 8/408 (1.9608%)
___Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   2, Avg loss: 0.0573, Accuracy: 146/408 (35.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.6302, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0878, Accuracy: 14/466 (3.0043%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 188/466 (40.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.8421, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   1, Avg loss: 0.1178, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   2, Avg loss: 0.0704, Accuracy: 49/338 (14.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3609, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0526, Accuracy: 290/1340 (21.6418%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0297, Accuracy: 513/1340 (38.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.1981, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0958, Accuracy: 2/311 (0.6431%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0659, Accuracy: 84/311 (27.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2840, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0960, Accuracy: 20/426 (4.6948%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0582, Accuracy: 166/426 (38.9671%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.9588, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0830, Accuracy: 58/781 (7.4264%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0398, Accuracy: 215/781 (27.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.5211, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   1, Avg loss: 0.0546, Accuracy: 204/813 (25.0923%)
___Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   2, Avg loss: 0.0202, Accuracy: 477/813 (58.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 13.3922, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   1, Avg loss: 0.0707, Accuracy: 172/690 (24.9275%)
___Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   2, Avg loss: 0.0317, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 12.8600, Accuracy: 57/10000 (0.5700%)
time spent on training: 183.8026032447815
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 12.3061, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 4.2963, Accuracy: 1350/9950 (13.5678%)
saving model
Done in 331.96903371810913 sec.
Server Epoch:93 choose agents : [97, 94, 81, 1, 62, 45, 0, 15, 31, 32].
___Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   1, Avg loss: 0.0664, Accuracy: 246/1213 (20.2803%)
___Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 484/1213 (39.9011%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.2387, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0720, Accuracy: 252/1662 (15.1625%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0372, Accuracy: 512/1662 (30.8063%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.1369, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   1, Avg loss: 0.0931, Accuracy: 60/774 (7.7519%)
___Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   2, Avg loss: 0.0416, Accuracy: 359/774 (46.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.3415, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0753, Accuracy: 196/928 (21.1207%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0293, Accuracy: 494/928 (53.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.9262, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0746, Accuracy: 89/568 (15.6690%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0459, Accuracy: 267/568 (47.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.8910, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0721, Accuracy: 129/669 (19.2825%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.9888, Accuracy: 78/10000 (0.7800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   1, Avg loss: 0.0619, Accuracy: 290/1657 (17.5015%)
___Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   2, Avg loss: 0.0381, Accuracy: 473/1657 (28.5456%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.9521, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0642, Accuracy: 278/1154 (24.0901%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0317, Accuracy: 464/1154 (40.2080%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.5401, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   1, Avg loss: 0.0943, Accuracy: 17/460 (3.6957%)
___Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   2, Avg loss: 0.0502, Accuracy: 183/460 (39.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5748, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   1, Avg loss: 0.0708, Accuracy: 108/735 (14.6939%)
___Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 364/735 (49.5238%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.1781, Accuracy: 59/10000 (0.5900%)
time spent on training: 239.62258648872375
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.9506, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 3.6361, Accuracy: 2085/9950 (20.9548%)
saving model
Done in 388.62739849090576 sec.
Server Epoch:94 choose agents : [80, 7, 37, 2, 99, 16, 49, 71, 59, 78].
___Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   1, Avg loss: 0.0615, Accuracy: 141/682 (20.6745%)
___Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 255/682 (37.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.2742, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   1, Avg loss: 0.0802, Accuracy: 157/891 (17.6207%)
___Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   2, Avg loss: 0.0312, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.4281, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   1, Avg loss: 0.0623, Accuracy: 288/1129 (25.5093%)
___Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   2, Avg loss: 0.0293, Accuracy: 647/1129 (57.3074%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.1569, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0869, Accuracy: 74/605 (12.2314%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0491, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.8985, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   1, Avg loss: 0.0781, Accuracy: 122/773 (15.7827%)
___Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   2, Avg loss: 0.0325, Accuracy: 402/773 (52.0052%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 11.3457, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1, Avg loss: 0.0714, Accuracy: 183/708 (25.8475%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 424/708 (59.8870%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.5833, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   1, Avg loss: 0.0888, Accuracy: 5/440 (1.1364%)
___Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   2, Avg loss: 0.0529, Accuracy: 119/440 (27.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.9778, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   1, Avg loss: 0.0713, Accuracy: 82/818 (10.0244%)
___Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   2, Avg loss: 0.0340, Accuracy: 324/818 (39.6088%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.3525, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   1, Avg loss: 0.0705, Accuracy: 238/1089 (21.8549%)
___Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   2, Avg loss: 0.0321, Accuracy: 463/1089 (42.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.0257, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   1, Avg loss: 0.0909, Accuracy: 9/416 (2.1635%)
___Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   2, Avg loss: 0.0512, Accuracy: 148/416 (35.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.7071, Accuracy: 66/10000 (0.6600%)
time spent on training: 197.45876145362854
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 13.6951, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 2.6905, Accuracy: 3303/9950 (33.1960%)
saving model
Done in 341.8477454185486 sec.
Server Epoch:95 choose agents : [58, 24, 20, 10, 29, 56, 51, 25, 5, 3].
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0745, Accuracy: 203/803 (25.2802%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0428, Accuracy: 430/803 (53.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.8748, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   1, Avg loss: 0.0979, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   2, Avg loss: 0.0561, Accuracy: 89/312 (28.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.1495, Accuracy: 53/10000 (0.5300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1, Avg loss: 0.0661, Accuracy: 196/807 (24.2875%)
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2, Avg loss: 0.0338, Accuracy: 402/807 (49.8141%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.8528, Accuracy: 69/10000 (0.6900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0645, Accuracy: 134/861 (15.5633%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0240, Accuracy: 423/861 (49.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 11.6721, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0609, Accuracy: 318/1440 (22.0833%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0300, Accuracy: 652/1440 (45.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.9758, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   1, Avg loss: 0.0977, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   2, Avg loss: 0.0796, Accuracy: 9/186 (4.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0381, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   1, Avg loss: 0.0698, Accuracy: 158/1049 (15.0620%)
___Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   2, Avg loss: 0.0313, Accuracy: 504/1049 (48.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.8694, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   1, Avg loss: 0.0725, Accuracy: 166/690 (24.0580%)
___Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   2, Avg loss: 0.0329, Accuracy: 466/690 (67.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 11.5118, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   1, Avg loss: 0.0590, Accuracy: 334/1628 (20.5160%)
___Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 754/1628 (46.3145%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.9418, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0849, Accuracy: 37/781 (4.7375%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0413, Accuracy: 219/781 (28.0410%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.4509, Accuracy: 77/10000 (0.7700%)
time spent on training: 231.79963040351868
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 15.9297, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 3.5228, Accuracy: 2180/9950 (21.9095%)
saving model
Done in 384.49922943115234 sec.
Server Epoch:96 choose agents : [84, 4, 1, 11, 43, 2, 62, 12, 31, 82].
___Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   1, Avg loss: 0.0734, Accuracy: 220/1190 (18.4874%)
___Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   2, Avg loss: 0.0350, Accuracy: 446/1190 (37.4790%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.2810, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0681, Accuracy: 262/901 (29.0788%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 423/901 (46.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.3126, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0756, Accuracy: 185/928 (19.9353%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0274, Accuracy: 525/928 (56.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 11.4681, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0676, Accuracy: 192/712 (26.9663%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 439/712 (61.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.8768, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   1, Avg loss: 0.0706, Accuracy: 221/946 (23.3615%)
___Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   2, Avg loss: 0.0378, Accuracy: 381/946 (40.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.1663, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0846, Accuracy: 86/605 (14.2149%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0486, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.0272, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   1, Avg loss: 0.0750, Accuracy: 106/568 (18.6620%)
___Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   2, Avg loss: 0.0465, Accuracy: 255/568 (44.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7977, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.1198, Accuracy: 2/338 (0.5917%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0673, Accuracy: 66/338 (19.5266%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.3759, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   1, Avg loss: 0.0957, Accuracy: 25/460 (5.4348%)
___Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   2, Avg loss: 0.0510, Accuracy: 189/460 (41.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.7168, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0904, Accuracy: 16/500 (3.2000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0560, Accuracy: 181/500 (36.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.9305, Accuracy: 60/10000 (0.6000%)
time spent on training: 193.30945348739624
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 13.6025, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 5.0726, Accuracy: 731/9950 (7.3467%)
saving model
Done in 341.5919737815857 sec.
Server Epoch:97 choose agents : [82, 9, 2, 32, 45, 55, 65, 3, 16, 6].
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0899, Accuracy: 9/500 (1.8000%)
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0559, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.0886, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   1, Avg loss: 0.0580, Accuracy: 306/1275 (24.0000%)
___Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 725/1275 (56.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 12.0731, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0844, Accuracy: 78/605 (12.8926%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0483, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9182, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   1, Avg loss: 0.0669, Accuracy: 110/735 (14.9660%)
___Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 344/735 (46.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 12.6975, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   1, Avg loss: 0.0714, Accuracy: 128/669 (19.1330%)
___Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   2, Avg loss: 0.0421, Accuracy: 358/669 (53.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.2468, Accuracy: 84/10000 (0.8400%)
poison local model 55 index 7 
___Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   1, Avg loss: 0.0607, Accuracy: 212/1071 (19.7946%)
___Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 510/1071 (47.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.6188, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   1, Avg loss: 0.0592, Accuracy: 391/1475 (26.5085%)
___Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   2, Avg loss: 0.0351, Accuracy: 562/1475 (38.1017%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.8593, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0842, Accuracy: 58/781 (7.4264%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0406, Accuracy: 252/781 (32.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.0357, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1, Avg loss: 0.0795, Accuracy: 162/708 (22.8814%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2, Avg loss: 0.0385, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9831, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   1, Avg loss: 0.0615, Accuracy: 320/1956 (16.3599%)
___Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   2, Avg loss: 0.0350, Accuracy: 570/1956 (29.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.2799, Accuracy: 104/10000 (1.0400%)
time spent on training: 240.4075984954834
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 11.2772, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 5.0499, Accuracy: 551/9950 (5.5377%)
saving model
Done in 388.3595139980316 sec.
Server Epoch:98 choose agents : [40, 38, 88, 79, 89, 8, 28, 43, 27, 58].
___Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   1, Avg loss: 0.0702, Accuracy: 255/1573 (16.2111%)
___Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   2, Avg loss: 0.0388, Accuracy: 542/1573 (34.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.4428, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   1, Avg loss: 0.0731, Accuracy: 219/1131 (19.3634%)
___Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   2, Avg loss: 0.0335, Accuracy: 478/1131 (42.2635%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.3357, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0774, Accuracy: 72/603 (11.9403%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 290/603 (48.0929%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.1149, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   2, Avg loss: 0.0960, Accuracy: 4/197 (2.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.8773, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0670, Accuracy: 276/896 (30.8036%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0373, Accuracy: 465/896 (51.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.0788, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   1, Avg loss: 0.0720, Accuracy: 224/1513 (14.8050%)
___Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   2, Avg loss: 0.0398, Accuracy: 424/1513 (28.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.7402, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   1, Avg loss: 0.0738, Accuracy: 276/1581 (17.4573%)
___Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   2, Avg loss: 0.0391, Accuracy: 538/1581 (34.0291%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.5747, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0688, Accuracy: 217/946 (22.9387%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0393, Accuracy: 346/946 (36.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.4478, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   1, Avg loss: 0.0637, Accuracy: 361/1587 (22.7473%)
___Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   2, Avg loss: 0.0373, Accuracy: 546/1587 (34.4045%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.7444, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   1, Avg loss: 0.0744, Accuracy: 192/803 (23.9103%)
___Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   2, Avg loss: 0.0423, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.9121, Accuracy: 56/10000 (0.5600%)
time spent on training: 244.45682787895203
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9513, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 5.1367, Accuracy: 557/9950 (5.5980%)
saving model
Done in 391.32344245910645 sec.
Server Epoch:99 choose agents : [75, 60, 66, 94, 77, 17, 26, 35, 23, 61].
___Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   1, Avg loss: 0.0757, Accuracy: 143/776 (18.4278%)
___Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 414/776 (53.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.3807, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   1, Avg loss: 0.0587, Accuracy: 491/2227 (22.0476%)
___Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   2, Avg loss: 0.0323, Accuracy: 881/2227 (39.5599%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.1914, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0740, Accuracy: 173/1402 (12.3395%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0413, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.6682, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   1, Avg loss: 0.0711, Accuracy: 215/1662 (12.9362%)
___Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   2, Avg loss: 0.0381, Accuracy: 498/1662 (29.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.2989, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0556, Accuracy: 274/1340 (20.4478%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0296, Accuracy: 504/1340 (37.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.1497, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   1, Avg loss: 0.0607, Accuracy: 306/1574 (19.4409%)
___Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   2, Avg loss: 0.0303, Accuracy: 590/1574 (37.4841%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.8772, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0597, Accuracy: 314/1446 (21.7151%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0378, Accuracy: 502/1446 (34.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.5478, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.1323, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0917, Accuracy: 8/271 (2.9520%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.3751, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0731, Accuracy: 186/715 (26.0140%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0413, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.5886, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1462, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1388, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.8534, Accuracy: 48/10000 (0.4800%)
time spent on training: 254.59285831451416
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.9072, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.3104, Accuracy: 427/9950 (4.2915%)
saving model
Done in 405.2205390930176 sec.
Server Epoch:100 choose agents : [25, 52, 37, 70, 26, 86, 40, 66, 98, 83].
___Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   1, Avg loss: 0.0698, Accuracy: 176/690 (25.5072%)
___Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   2, Avg loss: 0.0327, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.7650, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0613, Accuracy: 215/636 (33.8050%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0350, Accuracy: 428/636 (67.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.6956, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0622, Accuracy: 303/1129 (26.8379%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0289, Accuracy: 675/1129 (59.7874%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.3283, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   1, Avg loss: 0.0707, Accuracy: 256/1418 (18.0536%)
___Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   2, Avg loss: 0.0342, Accuracy: 583/1418 (41.1142%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.2473, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   1, Avg loss: 0.0596, Accuracy: 302/1446 (20.8852%)
___Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   2, Avg loss: 0.0390, Accuracy: 466/1446 (32.2268%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.4738, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0731, Accuracy: 209/1003 (20.8375%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0398, Accuracy: 371/1003 (36.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.4923, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0694, Accuracy: 250/1573 (15.8932%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0400, Accuracy: 509/1573 (32.3586%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.5585, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1, Avg loss: 0.0724, Accuracy: 178/1402 (12.6961%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 365/1402 (26.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.6364, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   1, Avg loss: 0.1004, Accuracy: 3/373 (0.8043%)
___Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   2, Avg loss: 0.0598, Accuracy: 87/373 (23.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.1368, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   1, Avg loss: 0.0715, Accuracy: 312/1953 (15.9754%)
___Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   2, Avg loss: 0.0383, Accuracy: 680/1953 (34.8182%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.3817, Accuracy: 92/10000 (0.9200%)
time spent on training: 257.5035288333893
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.6931, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 4.5396, Accuracy: 1113/9950 (11.1859%)
saving model
Done in 408.5807168483734 sec.
Saving all the graphs.
This run has a label: Jun.13_09.06.38. Visdom environment: tiny
