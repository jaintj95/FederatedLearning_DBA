current path: saved_models/model_tiny_Jun.16_12.14.41
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.4297, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 380/1657 (22.9330%)
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0356, Accuracy: 461/1657 (27.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.4031, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 309/1340 (23.0597%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 572/1340 (42.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7245, Accuracy: 57/10000 (0.5700%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 387/1750 (22.1143%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 670/1750 (38.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7676, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 249/1402 (17.7603%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.2568, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5566, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 56/515 (10.8738%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0544, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.7939, Accuracy: 56/10000 (0.5600%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 295/690 (42.7536%)
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.2287, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 391/1036 (37.7413%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 642/1036 (61.9691%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 9.2314, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 474/1715 (27.6385%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 730/1715 (42.5656%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6564, Accuracy: 91/10000 (0.9100%)
time spent on training: 147.3793752193451
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3003, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.63020157814026 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0526, Accuracy: 344/1340 (25.6716%)
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 543/1340 (40.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.0686, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0568, Accuracy: 301/1154 (26.0832%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 447/1154 (38.7348%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 9.0826, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.1827, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 374/1581 (23.6559%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 594/1581 (37.5712%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7335, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 419/1440 (29.0972%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 702/1440 (48.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7180, Accuracy: 62/10000 (0.6200%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3066, Accuracy: 40/10000 (0.4000%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 170/773 (21.9922%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 414/773 (53.5576%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.3544, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 371/1427 (25.9986%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 576/1427 (40.3644%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.7652, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 231/1513 (15.2677%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 494/1513 (32.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1956, Accuracy: 102/10000 (1.0200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 427/1988 (21.4789%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 657/1988 (33.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8264, Accuracy: 84/10000 (0.8400%)
time spent on training: 159.30807638168335
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.2998, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3166, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.35429215431213 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 330/896 (36.8304%)
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.3337, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 337/1418 (23.7659%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 640/1418 (45.1340%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7801, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 369/1275 (28.9412%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 718/1275 (56.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 9.5801, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 389/773 (50.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2306, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0533, Accuracy: 363/1129 (32.1523%)
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0258, Accuracy: 682/1129 (60.4074%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8810, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 410/1574 (26.0483%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 645/1574 (40.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.3187, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0637, Accuracy: 319/901 (35.4051%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 412/901 (45.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.5315, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 174/500 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.7159, Accuracy: 42/10000 (0.4200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 72/486 (14.8148%)
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0419, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.8575, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 304/1645 (18.4802%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 648/1645 (39.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7867, Accuracy: 112/10000 (1.1200%)
time spent on training: 154.55460572242737
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3014, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3384, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.5685029029846 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 36/312 (11.5385%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4445, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 323/1340 (24.1045%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 563/1340 (42.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8250, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 249/1131 (22.0159%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 495/1131 (43.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.4604, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 331/896 (36.9420%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 458/896 (51.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2160, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 251/1513 (16.5896%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 474/1513 (31.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.5507, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 379/1581 (23.9722%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 604/1581 (38.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8155, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 103/631 (16.3233%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 211/631 (33.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 138/568 (24.2958%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9110, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0650, Accuracy: 273/708 (38.5593%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0359, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.0104, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.7845, Accuracy: 50/10000 (0.5000%)
time spent on training: 134.27425956726074
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3031, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.3480, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.99337673187256 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 168/938 (17.9104%)
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 304/938 (32.4094%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.5714, Accuracy: 53/10000 (0.5300%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 31/440 (7.0455%)
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 153/440 (34.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.6254, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 264/1402 (18.8302%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 373/1402 (26.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.4464, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 232/605 (38.3471%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9490, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 149/568 (26.2324%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9403, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 42/312 (13.4615%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.4649, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 63/186 (33.8710%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3271, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0574, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0267, Accuracy: 462/690 (66.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.4723, Accuracy: 54/10000 (0.5400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 200/861 (23.2288%)
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 420/861 (48.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.3276, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 371/1213 (30.5853%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/1213 (40.3957%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.1437, Accuracy: 81/10000 (0.8100%)
time spent on training: 163.15393900871277
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3049, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.3389, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.09104442596436 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 164/809 (20.2719%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 348/809 (43.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3044, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 200/773 (25.8732%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 393/773 (50.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4189, Accuracy: 60/10000 (0.6000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0794, Accuracy: 76/486 (15.6379%)
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.2452, Accuracy: 46/10000 (0.4600%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 422/1129 (37.3782%)
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 734/1129 (65.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8917, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 48/426 (11.2676%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0425, Accuracy: 176/426 (41.3146%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.8433, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 382/1657 (23.0537%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 493/1657 (29.7526%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4993, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 424/888 (47.7477%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0775, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0548, Accuracy: 304/1013 (30.0099%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 442/1013 (43.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.1968, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 281/636 (44.1824%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.6475, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 405/1750 (23.1429%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 642/1750 (36.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5134, Accuracy: 115/10000 (1.1500%)
time spent on training: 180.68656420707703
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3066, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3504, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.6694748401642 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 272/1402 (19.4009%)
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 404/1402 (28.8160%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.3234, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0631, Accuracy: 241/1241 (19.4198%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 379/1241 (30.5399%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.2754, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 498/1013 (49.1609%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9068, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 404/1581 (25.5534%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 596/1581 (37.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5747, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 60/500 (12.0000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9661, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 269/888 (30.2928%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 471/888 (53.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3634, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 431/1742 (24.7417%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 726/1742 (41.6762%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9548, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.6051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0859, Accuracy: 33/338 (9.7633%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0462, Accuracy: 146/338 (43.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.6537, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 209/861 (24.2741%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 459/861 (53.3101%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.2993, Accuracy: 50/10000 (0.5000%)
time spent on training: 150.480313539505
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3086, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.3665, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.9382321834564 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0509, Accuracy: 364/1340 (27.1642%)
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 580/1340 (43.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1915, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0549, Accuracy: 392/1581 (24.7944%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 539/1581 (34.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0365, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 286/708 (40.3955%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.0336, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 529/928 (57.0043%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1216, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0551, Accuracy: 365/1418 (25.7405%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 666/1418 (46.9676%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.5845, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 403/1427 (28.2411%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 614/1427 (43.0273%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.9509, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 432/1130 (38.2301%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7586, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 402/1949 (20.6260%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 591/1949 (30.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1840, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 342/1013 (33.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.8030, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0665, Accuracy: 243/776 (31.3144%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 398/776 (51.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.1943, Accuracy: 52/10000 (0.5200%)
time spent on training: 152.14891815185547
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3108, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.3828, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.32686042785645 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0663, Accuracy: 213/669 (31.8386%)
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.9492, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 203/773 (26.2613%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 410/773 (53.0401%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.9559, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 258/1241 (20.7897%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 414/1241 (33.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.3236, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 294/708 (41.5254%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0389, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.0469, Accuracy: 64/10000 (0.6400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 452/1552 (29.1237%)
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 769/1552 (49.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 10.8483, Accuracy: 94/10000 (0.9400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1268, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3236, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 158/568 (27.8169%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.0993, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 323/677 (47.7105%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7553, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 301/946 (31.8182%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 313/946 (33.0867%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.1533, Accuracy: 70/10000 (0.7000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0548, Accuracy: 315/690 (45.6522%)
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0269, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.7926, Accuracy: 59/10000 (0.5900%)
time spent on training: 161.70671582221985
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3126, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.3976, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.7925202846527 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 322/1190 (27.0588%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 439/1190 (36.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.4059, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 127/530 (23.9623%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.7658, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0763, Accuracy: 61/426 (14.3192%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 173/426 (40.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.9465, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 292/636 (45.9119%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0302, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9907, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0511, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0327, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.2581, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 65/408 (15.9314%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0536, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7633, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0620, Accuracy: 375/1163 (32.2442%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 422/1163 (36.2855%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.8910, Accuracy: 76/10000 (0.7600%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0786, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 147/440 (33.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7894, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 6/85 (7.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3248, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 359/891 (40.2918%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 446/891 (50.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.3463, Accuracy: 51/10000 (0.5100%)
time spent on training: 159.28919744491577
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3146, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.4097, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.8772497177124 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 418/1440 (29.0278%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 662/1440 (45.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.2686, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 456/1715 (26.5889%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 738/1715 (43.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9041, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0869, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0561, Accuracy: 106/271 (39.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.5347, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 353/891 (39.6184%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.5844, Accuracy: 53/10000 (0.5300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0536, Accuracy: 326/690 (47.2464%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.0631, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 216/1013 (21.3228%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 301/1013 (29.7137%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.0464, Accuracy: 64/10000 (0.6400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 499/1552 (32.1521%)
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 757/1552 (48.7758%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 10.9169, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 360/1645 (21.8845%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 650/1645 (39.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.2100, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 216/735 (29.3878%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 358/735 (48.7075%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.4604, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 421/1574 (26.7471%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 695/1574 (44.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0836, Accuracy: 103/10000 (1.0300%)
time spent on training: 178.49017214775085
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3172, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.3860, Accuracy: 0/9950 (0.0000%)
saving model
Done in 424.1029336452484 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 348/946 (36.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.3659, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 335/1662 (20.1564%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 617/1662 (37.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.3148, Accuracy: 104/10000 (1.0400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0769, Accuracy: 84/486 (17.2840%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0393, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.4387, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0598, Accuracy: 277/1131 (24.4916%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 514/1131 (45.4465%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.0783, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 369/1573 (23.4584%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 560/1573 (35.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5586, Accuracy: 68/10000 (0.6800%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0574, Accuracy: 333/807 (41.2639%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 416/807 (51.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.0919, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 255/776 (32.8608%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 386/776 (49.7423%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.4232, Accuracy: 54/10000 (0.5400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3308, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 323/1446 (22.3375%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 500/1446 (34.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.2382, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0504, Accuracy: 416/1574 (26.4295%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 675/1574 (42.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2695, Accuracy: 115/10000 (1.1500%)
time spent on training: 177.8686556816101
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3198, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.3957, Accuracy: 0/9950 (0.0000%)
saving model
Done in 416.6996922492981 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 355/1372 (25.8746%)
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 524/1372 (38.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4812, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 332/896 (37.0536%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.5519, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 449/1953 (22.9903%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 771/1953 (39.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3927, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0744, Accuracy: 133/530 (25.0943%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.8366, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0754, Accuracy: 69/426 (16.1972%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0409, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.1874, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0587, Accuracy: 272/1513 (17.9775%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 491/1513 (32.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.3689, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 374/1949 (19.1893%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1949 (31.9138%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4227, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 578/2227 (25.9542%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1040/2227 (46.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3379, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 78/186 (41.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3568, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0541, Accuracy: 430/1581 (27.1980%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 595/1581 (37.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1704, Accuracy: 93/10000 (0.9300%)
time spent on training: 159.403461933136
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3224, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.3830, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.28093695640564 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 176/500 (35.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.2262, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0507, Accuracy: 354/1340 (26.4179%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0262, Accuracy: 598/1340 (44.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.4425, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 42/416 (10.0962%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 179/416 (43.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.1116, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 177/938 (18.8699%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 330/938 (35.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0332, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 382/1573 (24.2848%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 593/1573 (37.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6034, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 463/1953 (23.7071%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 839/1953 (42.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.8671, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 367/1213 (30.2556%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 490/1213 (40.3957%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7993, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 277/1241 (22.3207%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0358, Accuracy: 453/1241 (36.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6380, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0793, Accuracy: 40/373 (10.7239%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.9154, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3359, Accuracy: 54/10000 (0.5400%)
time spent on training: 158.96033644676208
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3246, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.3624, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.6984510421753 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 83/500 (16.6000%)
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 183/500 (36.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.2770, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0642, Accuracy: 258/776 (33.2474%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 411/776 (52.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.4886, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0793, Accuracy: 32/373 (8.5791%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0465, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.8849, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 455/1715 (26.5306%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 762/1715 (44.4315%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.8730, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.3544, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0615, Accuracy: 169/809 (20.8900%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 350/809 (43.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9248, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 542/1470 (36.8707%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 823/1470 (55.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.2612, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0828, Accuracy: 47/416 (11.2981%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 178/416 (42.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.1247, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 420/1904 (22.0588%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 662/1904 (34.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.8722, Accuracy: 106/10000 (1.0600%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0498, Accuracy: 440/1129 (38.9725%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 759/1129 (67.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.4297, Accuracy: 114/10000 (1.1400%)
time spent on training: 158.33965349197388
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3267, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.3728, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.7915735244751 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0536, Accuracy: 426/1581 (26.9450%)
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 585/1581 (37.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8637, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 352/1446 (24.3430%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 521/1446 (36.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.5831, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 426/1953 (21.8126%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 785/1953 (40.1946%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9980, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0812, Accuracy: 61/416 (14.6635%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0441, Accuracy: 172/416 (41.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.2889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 439/1742 (25.2009%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 693/1742 (39.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1721, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0524, Accuracy: 361/891 (40.5163%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0248, Accuracy: 458/891 (51.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6013, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0838, Accuracy: 58/466 (12.4464%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0468, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.2164, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 382/1750 (21.8286%)
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 694/1750 (39.6571%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.7030, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0545, Accuracy: 372/1418 (26.2341%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0295, Accuracy: 675/1418 (47.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.0579, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 484/1013 (47.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6800, Accuracy: 62/10000 (0.6200%)
time spent on training: 182.19355487823486
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3295, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.3891, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.60209345817566 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0524, Accuracy: 355/1372 (25.8746%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 546/1372 (39.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.6157, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 392/1427 (27.4702%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 602/1427 (42.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4662, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0784, Accuracy: 92/515 (17.8641%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 142/515 (27.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.2081, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1662 (20.6980%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 637/1662 (38.3273%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.5379, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 259/1402 (18.4736%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 344/1402 (24.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7572, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 269/776 (34.6649%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 421/776 (54.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4835, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0524, Accuracy: 329/1013 (32.4778%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 523/1013 (51.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0391, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 438/1587 (27.5992%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 607/1587 (38.2483%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4332, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 394/1956 (20.1431%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0309, Accuracy: 712/1956 (36.4008%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.2576, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 237/1049 (22.5929%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0291, Accuracy: 565/1049 (53.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9606, Accuracy: 95/10000 (0.9500%)
time spent on training: 166.50481915473938
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3318, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.3945, Accuracy: 0/9950 (0.0000%)
saving model
Done in 414.5404438972473 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.6811, Accuracy: 59/10000 (0.5900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 400/1628 (24.5700%)
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 807/1628 (49.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.0538, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 123/781 (15.7490%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 238/781 (30.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.4333, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0535, Accuracy: 419/1581 (26.5022%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0326, Accuracy: 631/1581 (39.9114%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.3260, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 218/605 (36.0331%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.2544, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 372/1275 (29.1765%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 712/1275 (55.8431%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.6573, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0503, Accuracy: 457/1715 (26.6472%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 727/1715 (42.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.0688, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 613/2227 (27.5258%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1013/2227 (45.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.3547, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0631, Accuracy: 352/1003 (35.0947%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 370/1003 (36.8893%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.1806, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0566, Accuracy: 390/1427 (27.3301%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0323, Accuracy: 620/1427 (43.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.5512, Accuracy: 76/10000 (0.7600%)
time spent on training: 191.5572555065155
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3337, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.3825, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.5119197368622 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0579, Accuracy: 288/1513 (19.0350%)
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0355, Accuracy: 489/1513 (32.3199%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.0441, Accuracy: 110/10000 (1.1000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0585, Accuracy: 325/807 (40.2726%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 414/807 (51.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4699, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0522, Accuracy: 368/1372 (26.8222%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 506/1372 (36.8805%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2874, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 424/1949 (21.7547%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 597/1949 (30.6311%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.1876, Accuracy: 85/10000 (0.8500%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 370/1628 (22.7273%)
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0248, Accuracy: 868/1628 (53.3170%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.8659, Accuracy: 136/10000 (1.3600%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0544, Accuracy: 328/690 (47.5362%)
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0251, Accuracy: 467/690 (67.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.6092, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 46/312 (14.7436%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0383, Accuracy: 164/312 (52.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.9634, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 150/818 (18.3374%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 375/818 (45.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.8595, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0559, Accuracy: 349/1645 (21.2158%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0318, Accuracy: 658/1645 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.1316, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 132/530 (24.9057%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.1625, Accuracy: 64/10000 (0.6400%)
time spent on training: 205.33884739875793
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3359, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.3814, Accuracy: 0/9950 (0.0000%)
saving model
Done in 442.2908685207367 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 348/896 (38.8393%)
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0326, Accuracy: 476/896 (53.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.6712, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0502, Accuracy: 447/1574 (28.3990%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 699/1574 (44.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5300, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0606, Accuracy: 273/1402 (19.4722%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 414/1402 (29.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6016, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0572, Accuracy: 295/1513 (19.4977%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0355, Accuracy: 509/1513 (33.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.0019, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0819, Accuracy: 72/466 (15.4506%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0469, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.3692, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0541, Accuracy: 308/1089 (28.2828%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 10.0350, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 424/1953 (21.7102%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0330, Accuracy: 762/1953 (39.0169%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8246, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0676, Accuracy: 152/568 (26.7606%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0388, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.4633, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0539, Accuracy: 380/1418 (26.7983%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 660/1418 (46.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.1347, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0857, Accuracy: 26/338 (7.6923%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 134/338 (39.6450%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.9592, Accuracy: 50/10000 (0.5000%)
time spent on training: 172.39733791351318
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3378, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.3905, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.58946347236633 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0567, Accuracy: 383/1657 (23.1141%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0347, Accuracy: 535/1657 (32.2873%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0319, Accuracy: 589/1657 (35.5462%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0313, Accuracy: 620/1657 (37.4170%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0304, Accuracy: 637/1657 (38.4430%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0303, Accuracy: 673/1657 (40.6156%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0297, Accuracy: 672/1657 (40.5552%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0292, Accuracy: 700/1657 (42.2450%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0291, Accuracy: 700/1657 (42.2450%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0290, Accuracy: 700/1657 (42.2450%), train_poison_data_count: 520
Global model norm: 112.02820776901459.
Norm before scaling: 112.00162177955282. Distance: 1.1772348537090438
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.7977, Accuracy: 70/10000 (0.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.0396, Accuracy: 8934/9950 (89.7889%)
Scaling by  100
Scaled Norm after poisoning: 160.23363069671112, distance: 117.72348676427104
Total norm for 3 adversaries is: 160.23363069671112. distance: 117.72348676427104
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 420/1949 (21.5495%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0325, Accuracy: 646/1949 (33.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3382, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 64/460 (13.9130%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.6000, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 3/186 (1.6129%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 73/186 (39.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3895, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 334/677 (49.3353%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.8941, Accuracy: 60/10000 (0.6000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 390/1475 (26.4407%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 723/1475 (49.0169%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.3807, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 309/1131 (27.3210%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 401/1131 (35.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0752, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0498, Accuracy: 468/1129 (41.4526%)
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0232, Accuracy: 747/1129 (66.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.6113, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0505, Accuracy: 351/1340 (26.1940%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 554/1340 (41.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.2002, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 323/1446 (22.3375%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 499/1446 (34.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.7472, Accuracy: 61/10000 (0.6100%)
time spent on training: 316.84968423843384
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.0031, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.4920, Accuracy: 30/9950 (0.3015%)
saving model
Done in 572.4962840080261 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0670, Accuracy: 271/1645 (16.4742%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0315, Accuracy: 635/1645 (38.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.4426, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0723, Accuracy: 232/1446 (16.0443%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0356, Accuracy: 503/1446 (34.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.7358, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0853, Accuracy: 163/803 (20.2989%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0406, Accuracy: 414/803 (51.5567%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.3006, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0539, Accuracy: 420/1470 (28.5714%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 868/1470 (59.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.1833, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0960, Accuracy: 27/603 (4.4776%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.2710, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0969, Accuracy: 50/605 (8.2645%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0497, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.1405, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0726, Accuracy: 283/1475 (19.1864%)
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 676/1475 (45.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.9053, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0667, Accuracy: 234/1275 (18.3529%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0186, Accuracy: 728/1275 (57.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 11.2690, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0620, Accuracy: 152/677 (22.4520%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0250, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.1257, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0808, Accuracy: 95/953 (9.9685%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 332/953 (34.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2884, Accuracy: 81/10000 (0.8100%)
time spent on training: 194.30468201637268
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.7377, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.6587, Accuracy: 30/9950 (0.3015%)
saving model
Done in 438.70462131500244 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0636, Accuracy: 240/807 (29.7398%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0364, Accuracy: 311/807 (38.5378%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0293, Accuracy: 382/807 (47.3358%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0284, Accuracy: 401/807 (49.6902%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0286, Accuracy: 420/807 (52.0446%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0265, Accuracy: 432/807 (53.5316%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0263, Accuracy: 436/807 (54.0273%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0263, Accuracy: 440/807 (54.5229%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0255, Accuracy: 448/807 (55.5143%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0256, Accuracy: 452/807 (56.0099%), train_poison_data_count: 260
Global model norm: 111.99808173580475.
Norm before scaling: 111.98249462109023. Distance: 0.8190151309477588
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6622, Accuracy: 71/10000 (0.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.6840, Accuracy: 9316/9950 (93.6281%)
Scaling by  100
Scaled Norm after poisoning: 137.24156110213116, distance: 81.90151645993802
Total norm for 3 adversaries is: 137.24156110213116. distance: 81.90151645993802
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0789, Accuracy: 153/712 (21.4888%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0305, Accuracy: 446/712 (62.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 10.3513, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0749, Accuracy: 129/888 (14.5270%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 454/888 (51.1261%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.1215, Accuracy: 85/10000 (0.8500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0706, Accuracy: 315/1750 (18.0000%)
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 695/1750 (39.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7853, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0921, Accuracy: 65/605 (10.7438%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0469, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7719, Accuracy: 52/10000 (0.5200%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0550, Accuracy: 403/1552 (25.9665%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0200, Accuracy: 819/1552 (52.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.5808, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0689, Accuracy: 237/1446 (16.3900%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 519/1446 (35.8921%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7734, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0800, Accuracy: 211/896 (23.5491%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0374, Accuracy: 436/896 (48.6607%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7790, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0974, Accuracy: 17/781 (2.1767%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.9819, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0619, Accuracy: 375/1956 (19.1718%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0299, Accuracy: 731/1956 (37.3722%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.2682, Accuracy: 122/10000 (1.2200%)
time spent on training: 308.7327206134796
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.4237, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.9688, Accuracy: 7586/9950 (76.2412%)
saving model
Done in 549.7595989704132 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0845, Accuracy: 130/776 (16.7526%)
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0311, Accuracy: 426/776 (54.8969%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.5206, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.1212, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0735, Accuracy: 30/311 (9.6463%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.4884, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0852, Accuracy: 93/773 (12.0310%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0343, Accuracy: 432/773 (55.8862%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.0956, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0688, Accuracy: 238/1213 (19.6208%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 519/1213 (42.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.9705, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0640, Accuracy: 299/1574 (18.9962%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0271, Accuracy: 674/1574 (42.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8777, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0909, Accuracy: 31/682 (4.5455%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 268/682 (39.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.1632, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0956, Accuracy: 24/781 (3.0730%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 241/781 (30.8579%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.7022, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0640, Accuracy: 291/1645 (17.6900%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0312, Accuracy: 673/1645 (40.9119%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2101, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0577, Accuracy: 567/2227 (25.4603%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1057/2227 (47.4630%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.1412, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0645, Accuracy: 360/1953 (18.4332%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 840/1953 (43.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.4527, Accuracy: 117/10000 (1.1700%)
time spent on training: 198.3471577167511
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.9551, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.0527, Accuracy: 7895/9950 (79.3467%)
saving model
Done in 443.15662121772766 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0486, Accuracy: 503/1552 (32.4098%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0208, Accuracy: 786/1552 (50.6443%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0176, Accuracy: 895/1552 (57.6675%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0171, Accuracy: 943/1552 (60.7603%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0170, Accuracy: 971/1552 (62.5644%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0163, Accuracy: 980/1552 (63.1443%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0159, Accuracy: 1003/1552 (64.6263%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0159, Accuracy: 1014/1552 (65.3351%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0159, Accuracy: 1019/1552 (65.6572%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0158, Accuracy: 1016/1552 (65.4639%), train_poison_data_count: 496
Global model norm: 111.9781429216769.
Norm before scaling: 111.95042412129352. Distance: 1.2478825755018823
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.5828, Accuracy: 96/10000 (0.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.4011, Accuracy: 8886/9950 (89.3065%)
Scaling by  100
Scaled Norm after poisoning: 165.33200499298374, distance: 124.78825424869721
Total norm for 3 adversaries is: 165.33200499298374. distance: 124.78825424869721
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0994, Accuracy: 8/530 (1.5094%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.7919, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.1001, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0523, Accuracy: 144/500 (28.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.1489, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0678, Accuracy: 155/813 (19.0652%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 482/813 (59.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.1013, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0681, Accuracy: 131/735 (17.8231%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0252, Accuracy: 396/735 (53.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 11.6719, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0741, Accuracy: 112/953 (11.7524%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.0789, Accuracy: 71/10000 (0.7100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0754, Accuracy: 149/599 (24.8748%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0318, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.5085, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0615, Accuracy: 277/1036 (26.7375%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 686/1036 (66.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 14.1293, Accuracy: 70/10000 (0.7000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0670, Accuracy: 296/1750 (16.9143%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0340, Accuracy: 737/1750 (42.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.6450, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0737, Accuracy: 192/1131 (16.9761%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 542/1131 (47.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.1402, Accuracy: 102/10000 (1.0200%)
time spent on training: 310.50986409187317
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.5259, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.5451, Accuracy: 8275/9950 (83.1658%)
saving model
Done in 552.3636546134949 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0814, Accuracy: 199/1036 (19.2085%)
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0276, Accuracy: 644/1036 (62.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 15.0234, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.1211, Accuracy: 2/781 (0.2561%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 225/781 (28.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.1857, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.1540, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0988, Accuracy: 0/311 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.1846, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0975, Accuracy: 141/803 (17.5592%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0434, Accuracy: 431/803 (53.6737%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.7882, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0800, Accuracy: 247/1662 (14.8616%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0321, Accuracy: 686/1662 (41.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.2868, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0974, Accuracy: 202/1163 (17.3689%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 474/1163 (40.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.7441, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0956, Accuracy: 155/1131 (13.7047%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 389/1131 (34.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.9882, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.4893, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0878, Accuracy: 188/1130 (16.6372%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 475/1130 (42.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.2243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0922, Accuracy: 148/1402 (10.5563%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 417/1402 (29.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.9438, Accuracy: 73/10000 (0.7300%)
time spent on training: 181.83144211769104
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.7781, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 0.6886, Accuracy: 7746/9950 (77.8492%)
saving model
Done in 424.00744438171387 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0787, Accuracy: 155/599 (25.8765%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0271, Accuracy: 391/599 (65.2755%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0209, Accuracy: 483/599 (80.6344%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0187, Accuracy: 486/599 (81.1352%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0204, Accuracy: 477/599 (79.6327%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0184, Accuracy: 488/599 (81.4691%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0175, Accuracy: 498/599 (83.1386%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0172, Accuracy: 480/599 (80.1336%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0162, Accuracy: 499/599 (83.3055%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0154, Accuracy: 502/599 (83.8063%), train_poison_data_count: 200
Global model norm: 111.94640266802904.
Norm before scaling: 111.93313782678479. Distance: 0.8420412279827219
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.0361, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1077, Accuracy: 9492/9950 (95.3970%)
Scaling by  100
Scaled Norm after poisoning: 138.7599377071783, distance: 84.20412094651306
Total norm for 3 adversaries is: 138.7599377071783. distance: 84.20412094651306
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0890, Accuracy: 111/1049 (10.5815%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 520/1049 (49.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.9774, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0751, Accuracy: 312/1742 (17.9104%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 740/1742 (42.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.2885, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0742, Accuracy: 229/1275 (17.9608%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0185, Accuracy: 728/1275 (57.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.0592, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0630, Accuracy: 549/2227 (24.6520%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1076/2227 (48.3161%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.1841, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.1038, Accuracy: 53/773 (6.8564%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 428/773 (55.3687%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.6941, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.1165, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0456, Accuracy: 165/460 (35.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.7270, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0717, Accuracy: 274/1574 (17.4079%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0265, Accuracy: 743/1574 (47.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.7803, Accuracy: 112/10000 (1.1200%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.1319, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0638, Accuracy: 63/440 (14.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.1892, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0719, Accuracy: 298/1475 (20.2034%)
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 660/1475 (44.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.5030, Accuracy: 100/10000 (1.0000%)
time spent on training: 313.7318477630615
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.8352, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1985, Accuracy: 8935/9950 (89.7990%)
saving model
Done in 558.1391139030457 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0844, Accuracy: 128/1049 (12.2021%)
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 510/1049 (48.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.7601, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0714, Accuracy: 266/1036 (25.6757%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 708/1036 (68.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 13.2875, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0807, Accuracy: 188/1402 (13.4094%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 403/1402 (28.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7682, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.1369, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0596, Accuracy: 52/312 (16.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.1739, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0921, Accuracy: 123/690 (17.8261%)
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0316, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.6824, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.1021, Accuracy: 41/682 (6.0117%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 269/682 (39.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.6960, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0852, Accuracy: 186/803 (23.1631%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0381, Accuracy: 389/803 (48.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.1224, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0836, Accuracy: 209/1154 (18.1109%)
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0304, Accuracy: 394/1154 (34.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.1683, Accuracy: 84/10000 (0.8400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0590, Accuracy: 323/1657 (19.4931%)
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0305, Accuracy: 633/1657 (38.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.3500, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0834, Accuracy: 129/677 (19.0547%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 459/677 (67.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 11.7574, Accuracy: 62/10000 (0.6200%)
time spent on training: 229.36950302124023
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7829, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 0.2655, Accuracy: 8624/9950 (86.6734%)
saving model
Done in 472.92670345306396 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Average loss: 0.0487, Accuracy: 619/1628 (38.0221%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Average loss: 0.0217, Accuracy: 893/1628 (54.8526%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Average loss: 0.0197, Accuracy: 1022/1628 (62.7764%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Average loss: 0.0188, Accuracy: 1082/1628 (66.4619%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Average loss: 0.0184, Accuracy: 1086/1628 (66.7076%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Average loss: 0.0177, Accuracy: 1099/1628 (67.5061%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Average loss: 0.0173, Accuracy: 1130/1628 (69.4103%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Average loss: 0.0164, Accuracy: 1136/1628 (69.7789%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Average loss: 0.0169, Accuracy: 1125/1628 (69.1032%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Average loss: 0.0169, Accuracy: 1120/1628 (68.7961%), train_poison_data_count: 520
Global model norm: 111.92867514766938.
Norm before scaling: 111.8994430350862. Distance: 1.2596765294469119
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2151, Accuracy: 150/10000 (1.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.1730, Accuracy: 9542/9950 (95.8995%)
Scaling by  100
Scaled Norm after poisoning: 166.0813818301889, distance: 125.96764527548333
Total norm for 3 adversaries is: 166.0813818301889. distance: 125.96764527548333
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0714, Accuracy: 221/1513 (14.6067%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 526/1513 (34.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.9208, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.1230, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0575, Accuracy: 88/373 (23.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.9374, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0821, Accuracy: 114/1013 (11.2537%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 354/1013 (34.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.0570, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0696, Accuracy: 311/1418 (21.9323%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0297, Accuracy: 713/1418 (50.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2947, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0784, Accuracy: 118/953 (12.3820%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 335/953 (35.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.6267, Accuracy: 80/10000 (0.8000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0355, Accuracy: 584/1552 (37.6289%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0181, Accuracy: 894/1552 (57.6031%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.5975, Accuracy: 109/10000 (1.0900%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.1138, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0530, Accuracy: 92/440 (20.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.8411, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0882, Accuracy: 124/776 (15.9794%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 410/776 (52.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2708, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0530, Accuracy: 129/416 (31.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.5299, Accuracy: 74/10000 (0.7400%)
time spent on training: 322.69667410850525
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.1446, Accuracy: 148/10000 (1.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.4063, Accuracy: 8707/9950 (87.5075%)
saving model
Done in 565.462676525116 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0823, Accuracy: 151/1241 (12.1676%)
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 441/1241 (35.5359%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.8843, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.1009, Accuracy: 57/590 (9.6610%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0389, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 13.9115, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.1230, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0593, Accuracy: 110/500 (22.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6784, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0868, Accuracy: 156/803 (19.4271%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0420, Accuracy: 444/803 (55.2927%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.4614, Accuracy: 56/10000 (0.5600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0855, Accuracy: 183/1154 (15.8579%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0300, Accuracy: 430/1154 (37.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.2463, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1850, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.1462, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.8788, Accuracy: 149/10000 (1.4900%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0957, Accuracy: 72/636 (11.3208%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0382, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.0747, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0735, Accuracy: 254/1581 (16.0658%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 619/1581 (39.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.1382, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0718, Accuracy: 287/928 (30.9267%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0251, Accuracy: 588/928 (63.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.3220, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0667, Accuracy: 339/1574 (21.5375%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 682/1574 (43.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5435, Accuracy: 119/10000 (1.1900%)
time spent on training: 203.62173581123352
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6752, Accuracy: 141/10000 (1.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 0.8227, Accuracy: 7356/9950 (73.9296%)
saving model
Done in 445.70710611343384 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Average loss: 0.0681, Accuracy: 229/861 (26.5970%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Average loss: 0.0211, Accuracy: 489/861 (56.7944%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Average loss: 0.0153, Accuracy: 601/861 (69.8026%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Average loss: 0.0153, Accuracy: 589/861 (68.4088%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Average loss: 0.0146, Accuracy: 611/861 (70.9640%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Average loss: 0.0146, Accuracy: 619/861 (71.8931%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Average loss: 0.0143, Accuracy: 622/861 (72.2416%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Average loss: 0.0138, Accuracy: 614/861 (71.3124%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Average loss: 0.0141, Accuracy: 625/861 (72.5900%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Average loss: 0.0130, Accuracy: 640/861 (74.3322%), train_poison_data_count: 280
Global model norm: 111.89587357645277.
Norm before scaling: 111.88008455624487. Distance: 1.1183181056896583
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.3552, Accuracy: 103/10000 (1.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.1086, Accuracy: 9688/9950 (97.3668%)
Scaling by  100
Scaled Norm after poisoning: 156.6799646672318, distance: 111.83181341723606
Total norm for 4 adversaries is: 156.6799646672318. distance: 111.83181341723606
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1731, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.1391, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.4777, Accuracy: 156/10000 (1.5600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0223, Accuracy: 938/1628 (57.6167%)
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0179, Accuracy: 1082/1628 (66.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.6389, Accuracy: 175/10000 (1.7500%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0683, Accuracy: 361/1988 (18.1590%)
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0344, Accuracy: 760/1988 (38.2294%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8733, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.1152, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0569, Accuracy: 111/500 (22.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7913, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.1428, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0881, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.7035, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0830, Accuracy: 137/1131 (12.1132%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 556/1131 (49.1600%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.6330, Accuracy: 108/10000 (1.0800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0724, Accuracy: 266/1750 (15.2000%)
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 702/1750 (40.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8269, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0659, Accuracy: 309/928 (33.2974%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 591/928 (63.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.1269, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0784, Accuracy: 171/1241 (13.7792%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 403/1241 (32.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7880, Accuracy: 84/10000 (0.8400%)
time spent on training: 334.19933319091797
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.2668, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.2102, Accuracy: 9293/9950 (93.3970%)
saving model
Done in 578.345470905304 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0828, Accuracy: 157/1241 (12.6511%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7563, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0773, Accuracy: 221/1446 (15.2835%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 481/1446 (33.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.5931, Accuracy: 67/10000 (0.6700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.2180, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1983, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8804, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.1090, Accuracy: 7/682 (1.0264%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0396, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.2918, Accuracy: 58/10000 (0.5800%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.1210, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0590, Accuracy: 74/440 (16.8182%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.9146, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.1419, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0684, Accuracy: 60/408 (14.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.6324, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0761, Accuracy: 86/735 (11.7007%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.4758, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0775, Accuracy: 215/1130 (19.0265%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 489/1130 (43.2743%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.4546, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.1027, Accuracy: 89/715 (12.4476%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0509, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1671, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0720, Accuracy: 356/1988 (17.9074%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0344, Accuracy: 747/1988 (37.5755%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8520, Accuracy: 89/10000 (0.8900%)
time spent on training: 224.2188379764557
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7610, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 0.4009, Accuracy: 8698/9950 (87.4171%)
saving model
Done in 460.6138970851898 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0635, Accuracy: 422/1154 (36.5685%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0267, Accuracy: 620/1154 (53.7262%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0217, Accuracy: 679/1154 (58.8388%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0206, Accuracy: 720/1154 (62.3917%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0200, Accuracy: 715/1154 (61.9584%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0204, Accuracy: 697/1154 (60.3986%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0195, Accuracy: 716/1154 (62.0451%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0190, Accuracy: 725/1154 (62.8250%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0187, Accuracy: 729/1154 (63.1716%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0185, Accuracy: 748/1154 (64.8180%), train_poison_data_count: 362
Global model norm: 111.87622206036455.
Norm before scaling: 111.8537296469702. Distance: 1.2914931067896778
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9938, Accuracy: 83/10000 (0.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.2422, Accuracy: 9155/9950 (92.0101%)
Scaling by  100
Scaled Norm after poisoning: 168.89653938321234, distance: 129.14931251026852
Total norm for 2 adversaries is: 168.89653938321234. distance: 129.14931251026852
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0927, Accuracy: 71/773 (9.1850%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 415/773 (53.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.1724, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0892, Accuracy: 119/712 (16.7135%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 455/712 (63.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.1142, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0689, Accuracy: 93/735 (12.6531%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0210, Accuracy: 383/735 (52.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.1488, Accuracy: 75/10000 (0.7500%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0185, Accuracy: 536/861 (62.2532%)
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0157, Accuracy: 578/861 (67.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.1660, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0640, Accuracy: 350/1662 (21.0590%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0310, Accuracy: 692/1662 (41.6366%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9143, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0752, Accuracy: 249/1418 (17.5599%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 689/1418 (48.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.3661, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0795, Accuracy: 168/803 (20.9215%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0382, Accuracy: 432/803 (53.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.3582, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0868, Accuracy: 119/708 (16.8079%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0446, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.8834, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0707, Accuracy: 308/1742 (17.6808%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0309, Accuracy: 770/1742 (44.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2808, Accuracy: 81/10000 (0.8100%)
time spent on training: 327.84778356552124
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9848, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.3544, Accuracy: 8746/9950 (87.8995%)
saving model
Done in 569.6649651527405 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1170, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0570, Accuracy: 104/500 (20.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6082, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0819, Accuracy: 154/1154 (13.3449%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0291, Accuracy: 432/1154 (37.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.5679, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0704, Accuracy: 219/1030 (21.2621%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 585/1030 (56.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9576, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0578, Accuracy: 84/426 (19.7183%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.3534, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0918, Accuracy: 138/946 (14.5877%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0400, Accuracy: 322/946 (34.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.2137, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0770, Accuracy: 200/1213 (16.4880%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 517/1213 (42.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9772, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0778, Accuracy: 205/1130 (18.1416%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 484/1130 (42.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.7361, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.1000, Accuracy: 24/818 (2.9340%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0324, Accuracy: 392/818 (47.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.2771, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0753, Accuracy: 239/1402 (17.0471%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0379, Accuracy: 432/1402 (30.8131%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6779, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0897, Accuracy: 80/1013 (7.8973%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 367/1013 (36.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.3299, Accuracy: 99/10000 (0.9900%)
time spent on training: 205.99398231506348
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.4928, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 0.4828, Accuracy: 8389/9950 (84.3116%)
saving model
Done in 442.4569070339203 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Average loss: 0.0669, Accuracy: 210/690 (30.4348%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Average loss: 0.0274, Accuracy: 444/690 (64.3478%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Average loss: 0.0191, Accuracy: 489/690 (70.8696%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Average loss: 0.0181, Accuracy: 493/690 (71.4493%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Average loss: 0.0167, Accuracy: 486/690 (70.4348%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Average loss: 0.0167, Accuracy: 497/690 (72.0290%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Average loss: 0.0156, Accuracy: 511/690 (74.0580%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Average loss: 0.0150, Accuracy: 524/690 (75.9420%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Average loss: 0.0151, Accuracy: 519/690 (75.2174%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Average loss: 0.0150, Accuracy: 521/690 (75.5072%), train_poison_data_count: 220
Global model norm: 111.84984004794106.
Norm before scaling: 111.83703528320795. Distance: 0.8618167866389919
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3942, Accuracy: 67/10000 (0.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.1190, Accuracy: 9633/9950 (96.8141%)
Scaling by  100
Scaled Norm after poisoning: 139.91735144139557, distance: 86.18167866943212
Total norm for 1 adversaries is: 139.91735144139557. distance: 86.18167866943212
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0699, Accuracy: 202/1089 (18.5491%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0261, Accuracy: 584/1089 (53.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.6266, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0843, Accuracy: 197/1190 (16.5546%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 464/1190 (38.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.9403, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0650, Accuracy: 302/1574 (19.1868%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0260, Accuracy: 737/1574 (46.8234%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.5488, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0679, Accuracy: 278/1440 (19.3056%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 730/1440 (50.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.7282, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0796, Accuracy: 164/803 (20.4234%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 411/803 (51.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3260, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0638, Accuracy: 77/408 (18.8725%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.0507, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0768, Accuracy: 118/677 (17.4298%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 11.3897, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.1161, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0545, Accuracy: 96/426 (22.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.2719, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0722, Accuracy: 264/1418 (18.6178%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 705/1418 (49.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3200, Accuracy: 103/10000 (1.0300%)
time spent on training: 304.4894037246704
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3143, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.1818, Accuracy: 9296/9950 (93.4271%)
saving model
Done in 543.5867562294006 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0787, Accuracy: 115/1013 (11.3524%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 375/1013 (37.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.9265, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.1042, Accuracy: 18/605 (2.9752%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0464, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1727, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.1232, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.1611, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0805, Accuracy: 163/803 (20.2989%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0357, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.0271, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0855, Accuracy: 184/1190 (15.4622%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 470/1190 (39.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7795, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0729, Accuracy: 246/1573 (15.6389%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 628/1573 (39.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6978, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0887, Accuracy: 132/708 (18.6441%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0406, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.5153, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0934, Accuracy: 39/809 (4.8208%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0281, Accuracy: 352/809 (43.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.6143, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0727, Accuracy: 193/1513 (12.7561%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0352, Accuracy: 553/1513 (36.5499%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6083, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0775, Accuracy: 163/1241 (13.1346%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 437/1241 (35.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6616, Accuracy: 80/10000 (0.8000%)
time spent on training: 234.31496953964233
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.7465, Accuracy: 77/10000 (0.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 0.2770, Accuracy: 8952/9950 (89.9698%)
saving model
Done in 478.21654891967773 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Average loss: 0.0794, Accuracy: 128/486 (26.3374%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Average loss: 0.0445, Accuracy: 193/486 (39.7119%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Average loss: 0.0311, Accuracy: 257/486 (52.8807%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Average loss: 0.0313, Accuracy: 256/486 (52.6749%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Average loss: 0.0300, Accuracy: 269/486 (55.3498%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Average loss: 0.0271, Accuracy: 279/486 (57.4074%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Average loss: 0.0269, Accuracy: 287/486 (59.0535%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Average loss: 0.0265, Accuracy: 277/486 (56.9959%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Average loss: 0.0261, Accuracy: 289/486 (59.4650%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Average loss: 0.0269, Accuracy: 283/486 (58.2305%), train_poison_data_count: 160
Global model norm: 111.83316693433348.
Norm before scaling: 111.82438187985883. Distance: 0.7427939497156404
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.9454, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.1110, Accuracy: 9551/9950 (95.9899%)
Scaling by  100
Scaled Norm after poisoning: 133.31429470193734, distance: 74.27939627472412
Total norm for 2 adversaries is: 133.31429470193734. distance: 74.27939627472412
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0828, Accuracy: 95/636 (14.9371%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0335, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.6670, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0719, Accuracy: 136/677 (20.0886%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.7036, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0771, Accuracy: 139/1049 (13.2507%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0286, Accuracy: 564/1049 (53.7655%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.6511, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0890, Accuracy: 36/568 (6.3380%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0448, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.2514, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0685, Accuracy: 266/1573 (16.9104%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 634/1573 (40.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6018, Accuracy: 88/10000 (0.8800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0488, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0255, Accuracy: 597/1154 (51.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.5556, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0631, Accuracy: 389/1953 (19.9181%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0315, Accuracy: 979/1953 (50.1280%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6622, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0684, Accuracy: 270/1645 (16.4134%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0314, Accuracy: 668/1645 (40.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.0906, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0700, Accuracy: 158/1013 (15.5972%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 533/1013 (52.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.0923, Accuracy: 80/10000 (0.8000%)
time spent on training: 344.55388283729553
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.8728, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.2008, Accuracy: 9185/9950 (92.3116%)
saving model
Done in 587.8170409202576 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0653, Accuracy: 302/1418 (21.2976%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0295, Accuracy: 731/1418 (51.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2743, Accuracy: 110/10000 (1.1000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0642, Accuracy: 312/1129 (27.6351%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0232, Accuracy: 749/1129 (66.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.2357, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0830, Accuracy: 47/568 (8.2746%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0441, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.3170, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0620, Accuracy: 311/1440 (21.5972%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 750/1440 (52.0833%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5968, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0624, Accuracy: 201/1030 (19.5146%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0248, Accuracy: 647/1030 (62.8155%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.6641, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.1066, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0430, Accuracy: 155/460 (33.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5356, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.1180, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0944, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.0003, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0651, Accuracy: 227/928 (24.4612%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 609/928 (65.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.2757, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0613, Accuracy: 112/373 (30.0268%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0416, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.5897, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0770, Accuracy: 207/901 (22.9745%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0379, Accuracy: 398/901 (44.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2445, Accuracy: 59/10000 (0.5900%)
time spent on training: 217.50635266304016
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.4852, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 0.2880, Accuracy: 8942/9950 (89.8693%)
saving model
Done in 469.6530592441559 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Average loss: 0.0521, Accuracy: 404/1129 (35.7839%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Average loss: 0.0217, Accuracy: 721/1129 (63.8618%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Average loss: 0.0167, Accuracy: 806/1129 (71.3906%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Average loss: 0.0168, Accuracy: 806/1129 (71.3906%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Average loss: 0.0168, Accuracy: 800/1129 (70.8592%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Average loss: 0.0161, Accuracy: 821/1129 (72.7192%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Average loss: 0.0150, Accuracy: 853/1129 (75.5536%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Average loss: 0.0156, Accuracy: 829/1129 (73.4278%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Average loss: 0.0153, Accuracy: 838/1129 (74.2250%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Average loss: 0.0154, Accuracy: 840/1129 (74.4021%), train_poison_data_count: 360
Global model norm: 111.82105455676717.
Norm before scaling: 111.80221532493218. Distance: 1.029628229823204
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6898, Accuracy: 101/10000 (1.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.1354, Accuracy: 9407/9950 (94.5427%)
Scaling by  100
Scaled Norm after poisoning: 150.25953458724342, distance: 102.96281754534013
Total norm for 2 adversaries is: 150.25953458724342. distance: 102.96281754534013
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0609, Accuracy: 315/1904 (16.5441%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0299, Accuracy: 783/1904 (41.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.7959, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0795, Accuracy: 56/809 (6.9221%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 347/809 (42.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.4151, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0636, Accuracy: 311/1418 (21.9323%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 711/1418 (50.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2811, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0758, Accuracy: 205/1003 (20.4387%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0362, Accuracy: 369/1003 (36.7896%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.2334, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0644, Accuracy: 274/1573 (17.4189%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 598/1573 (38.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5775, Accuracy: 91/10000 (0.9100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 503/1552 (32.4098%)
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0188, Accuracy: 867/1552 (55.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.8219, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0642, Accuracy: 194/1049 (18.4938%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0279, Accuracy: 503/1049 (47.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3311, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0582, Accuracy: 258/1275 (20.2353%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0176, Accuracy: 777/1275 (60.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.3223, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0595, Accuracy: 358/1949 (18.3684%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 698/1949 (35.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2150, Accuracy: 104/10000 (1.0400%)
time spent on training: 407.3414809703827
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5692, Accuracy: 116/10000 (1.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.2603, Accuracy: 8860/9950 (89.0452%)
saving model
Done in 659.562294960022 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0766, Accuracy: 79/735 (10.7483%)
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0240, Accuracy: 322/735 (43.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 10.9994, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0738, Accuracy: 276/1418 (19.4640%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 733/1418 (51.6925%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0181, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0948, Accuracy: 67/636 (10.5346%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0373, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.8655, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0831, Accuracy: 152/1131 (13.4394%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 526/1131 (46.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.6414, Accuracy: 108/10000 (1.0800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0588, Accuracy: 244/1154 (21.1438%)
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0249, Accuracy: 639/1154 (55.3726%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.1120, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.1355, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0647, Accuracy: 77/416 (18.5096%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.7974, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0657, Accuracy: 366/1953 (18.7404%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0315, Accuracy: 900/1953 (46.0829%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.7013, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0813, Accuracy: 230/1190 (19.3277%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 457/1190 (38.4034%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.7240, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.1446, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0729, Accuracy: 7/338 (2.0710%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.3521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0685, Accuracy: 321/1715 (18.7172%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0296, Accuracy: 808/1715 (47.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.2565, Accuracy: 117/10000 (1.1700%)
time spent on training: 255.5296928882599
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.0666, Accuracy: 119/10000 (1.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 0.4350, Accuracy: 8225/9950 (82.6633%)
saving model
Saving model on epoch 40
Done in 495.9491548538208 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Average loss: 0.0558, Accuracy: 615/1750 (35.1429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Average loss: 0.0291, Accuracy: 949/1750 (54.2286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Average loss: 0.0254, Accuracy: 1001/1750 (57.2000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Average loss: 0.0252, Accuracy: 1022/1750 (58.4000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Average loss: 0.0249, Accuracy: 1015/1750 (58.0000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Average loss: 0.0245, Accuracy: 1006/1750 (57.4857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Average loss: 0.0242, Accuracy: 1025/1750 (58.5714%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Average loss: 0.0237, Accuracy: 1045/1750 (59.7143%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Average loss: 0.0238, Accuracy: 1033/1750 (59.0286%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Average loss: 0.0234, Accuracy: 1034/1750 (59.0857%), train_poison_data_count: 560
Global model norm: 111.79781730036146.
Norm before scaling: 111.76332152840887. Distance: 1.2793058205794108
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0366, Accuracy: 120/10000 (1.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.2676, Accuracy: 9485/9950 (95.3266%)
Scaling by  100
Scaled Norm after poisoning: 167.1223120576663, distance: 127.9305842048726
Total norm for 1 adversaries is: 167.1223120576663. distance: 127.9305842048726
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0807, Accuracy: 12/311 (3.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.1612, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0734, Accuracy: 225/1402 (16.0485%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 402/1402 (28.6733%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5043, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0961, Accuracy: 28/605 (4.6281%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0446, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.2862, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.1141, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0566, Accuracy: 162/466 (34.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6727, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.1090, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0555, Accuracy: 55/373 (14.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.7143, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0868, Accuracy: 79/636 (12.4214%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0352, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.1194, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0689, Accuracy: 204/1340 (15.2239%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 524/1340 (39.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.8025, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0902, Accuracy: 59/773 (7.6326%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0326, Accuracy: 430/773 (55.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.6764, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0666, Accuracy: 284/1440 (19.7222%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0286, Accuracy: 734/1440 (50.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.0618, Accuracy: 89/10000 (0.8900%)
time spent on training: 311.7993903160095
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0334, Accuracy: 122/10000 (1.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.4005, Accuracy: 9047/9950 (90.9246%)
saving model
Saving model on epoch 41
Done in 562.3282351493835 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0546, Accuracy: 421/1628 (25.8600%)
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0214, Accuracy: 997/1628 (61.2408%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.5485, Accuracy: 180/10000 (1.8000%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0908, Accuracy: 62/669 (9.2676%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0436, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.2421, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0665, Accuracy: 125/603 (20.7297%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0444, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.4580, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0786, Accuracy: 111/813 (13.6531%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 479/813 (58.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 12.5215, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.1149, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0648, Accuracy: 31/312 (9.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.5996, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0606, Accuracy: 511/2227 (22.9457%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1087/2227 (48.8101%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1512, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0689, Accuracy: 224/1036 (21.6216%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 706/1036 (68.1467%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 12.4164, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0853, Accuracy: 181/901 (20.0888%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0372, Accuracy: 423/901 (46.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.7395, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0776, Accuracy: 145/1049 (13.8227%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 538/1049 (51.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.4403, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1617, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.1276, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.3427, Accuracy: 101/10000 (1.0100%)
time spent on training: 261.35297417640686
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.7821, Accuracy: 119/10000 (1.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 0.9722, Accuracy: 7323/9950 (73.5980%)
saving model
Saving model on epoch 42
Done in 511.64630699157715 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Average loss: 0.0713, Accuracy: 128/440 (29.0909%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Average loss: 0.0494, Accuracy: 148/440 (33.6364%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Average loss: 0.0369, Accuracy: 237/440 (53.8636%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Average loss: 0.0341, Accuracy: 253/440 (57.5000%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Average loss: 0.0317, Accuracy: 268/440 (60.9091%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Average loss: 0.0308, Accuracy: 253/440 (57.5000%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Average loss: 0.0303, Accuracy: 251/440 (57.0455%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Average loss: 0.0297, Accuracy: 257/440 (58.4091%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Average loss: 0.0293, Accuracy: 251/440 (57.0455%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Average loss: 0.0277, Accuracy: 262/440 (59.5455%), train_poison_data_count: 140
Global model norm: 111.76013219586625.
Norm before scaling: 111.7530410660041. Distance: 0.610212703930992
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.4799, Accuracy: 58/10000 (0.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.1361, Accuracy: 9818/9950 (98.6734%)
Scaling by  100
Scaled Norm after poisoning: 126.56328703458993, distance: 61.0212725459327
Total norm for 3 adversaries is: 126.56328703458993. distance: 61.0212725459327
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0915, Accuracy: 25/818 (3.0562%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0318, Accuracy: 407/818 (49.7555%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.7650, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0760, Accuracy: 180/1131 (15.9151%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 559/1131 (49.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.3604, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0737, Accuracy: 118/813 (14.5141%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0194, Accuracy: 488/813 (60.0246%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 12.7202, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0997, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0434, Accuracy: 171/486 (35.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1413, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.1028, Accuracy: 2/530 (0.3774%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0436, Accuracy: 259/530 (48.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0978, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0864, Accuracy: 66/669 (9.8655%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0425, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.0547, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0706, Accuracy: 274/1573 (17.4189%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 600/1573 (38.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.6165, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.1227, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0788, Accuracy: 18/271 (6.6421%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.4741, Accuracy: 83/10000 (0.8300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 433/1628 (26.5971%)
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0217, Accuracy: 981/1628 (60.2580%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.4858, Accuracy: 175/10000 (1.7500%)
time spent on training: 343.30218982696533
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.3922, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.2649, Accuracy: 9346/9950 (93.9296%)
saving model
Done in 589.876234292984 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0657, Accuracy: 200/1030 (19.4175%)
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 628/1030 (60.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.8488, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.1151, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0747, Accuracy: 28/271 (10.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3260, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0731, Accuracy: 195/896 (21.7634%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0363, Accuracy: 455/896 (50.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.5687, Accuracy: 58/10000 (0.5800%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 361/1129 (31.9752%)
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0199, Accuracy: 788/1129 (69.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.3188, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0742, Accuracy: 205/901 (22.7525%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0364, Accuracy: 388/901 (43.0633%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.8883, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0673, Accuracy: 139/861 (16.1440%)
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0188, Accuracy: 510/861 (59.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.8678, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1531, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1282, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.0639, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.1120, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0599, Accuracy: 88/408 (21.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.7627, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0730, Accuracy: 26/312 (8.3333%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0451, Accuracy: 146/312 (46.7949%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.0163, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1684, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1534, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.0817, Accuracy: 68/10000 (0.6800%)
time spent on training: 216.49055671691895
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.2509, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.3971, Accuracy: 8950/9950 (89.9497%)
saving model
Done in 463.8743546009064 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Average loss: 0.0613, Accuracy: 306/1071 (28.5714%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Average loss: 0.0240, Accuracy: 594/1071 (55.4622%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Average loss: 0.0203, Accuracy: 703/1071 (65.6396%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Average loss: 0.0199, Accuracy: 692/1071 (64.6125%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Average loss: 0.0200, Accuracy: 682/1071 (63.6788%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Average loss: 0.0193, Accuracy: 697/1071 (65.0794%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Average loss: 0.0188, Accuracy: 702/1071 (65.5462%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Average loss: 0.0181, Accuracy: 702/1071 (65.5462%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Average loss: 0.0187, Accuracy: 698/1071 (65.1727%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Average loss: 0.0192, Accuracy: 703/1071 (65.6396%), train_poison_data_count: 340
Global model norm: 111.75054617456014.
Norm before scaling: 111.73279631978025. Distance: 1.1054018896797306
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8280, Accuracy: 92/10000 (0.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.1123, Accuracy: 9632/9950 (96.8040%)
Scaling by  100
Scaled Norm after poisoning: 155.52566483341263, distance: 110.54019524871937
Total norm for 2 adversaries is: 155.52566483341263. distance: 110.54019524871937
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0756, Accuracy: 86/568 (15.1408%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0465, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.8232, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0912, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 191/486 (39.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0543, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0740, Accuracy: 217/901 (24.0844%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 405/901 (44.9501%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0752, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0936, Accuracy: 10/530 (1.8868%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0423, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0550, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0720, Accuracy: 172/1131 (15.2078%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 558/1131 (49.3369%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.4886, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0989, Accuracy: 1/466 (0.2146%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0537, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.1369, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0750, Accuracy: 133/590 (22.5424%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0344, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 10.6868, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0671, Accuracy: 232/1372 (16.9096%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 591/1372 (43.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.4269, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0758, Accuracy: 230/1163 (19.7764%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 510/1163 (43.8521%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.2609, Accuracy: 66/10000 (0.6600%)
time spent on training: 349.39022517204285
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.7939, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.1590, Accuracy: 9445/9950 (94.9246%)
saving model
Done in 597.0062108039856 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0837, Accuracy: 246/1427 (17.2390%)
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0341, Accuracy: 595/1427 (41.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.5649, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0741, Accuracy: 254/1662 (15.2828%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0316, Accuracy: 681/1662 (40.9747%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.9941, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0816, Accuracy: 74/735 (10.0680%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 342/735 (46.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.8713, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.1089, Accuracy: 6/605 (0.9917%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0472, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.9390, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.1193, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0463, Accuracy: 160/486 (32.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0858, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.1271, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0588, Accuracy: 102/426 (23.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.9941, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0725, Accuracy: 272/1574 (17.2808%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 706/1574 (44.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5898, Accuracy: 136/10000 (1.3600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.2135, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1944, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.3229, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0878, Accuracy: 101/938 (10.7676%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0359, Accuracy: 338/938 (36.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0355, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0896, Accuracy: 139/896 (15.5134%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0373, Accuracy: 484/896 (54.0179%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7923, Accuracy: 64/10000 (0.6400%)
time spent on training: 243.93350648880005
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.2796, Accuracy: 97/10000 (0.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.3561, Accuracy: 8748/9950 (87.9196%)
saving model
Done in 493.31502056121826 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Average loss: 0.0932, Accuracy: 19/85 (22.3529%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Average loss: 0.0864, Accuracy: 26/85 (30.5882%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Average loss: 0.0773, Accuracy: 32/85 (37.6471%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Average loss: 0.0725, Accuracy: 34/85 (40.0000%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Average loss: 0.0753, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Average loss: 0.0705, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Average loss: 0.0728, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Average loss: 0.0700, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Average loss: 0.0706, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Average loss: 0.0702, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Global model norm: 111.72954493301.
Norm before scaling: 111.72804594192095. Distance: 0.15540691852253194
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0642, Accuracy: 75/10000 (0.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0678, Accuracy: 9918/9950 (99.6784%)
Scaling by  100
Scaled Norm after poisoning: 112.64542683793249, distance: 15.540691491726346
Total norm for 4 adversaries is: 112.64542683793249. distance: 15.540691491726346
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0952, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0449, Accuracy: 98/440 (22.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0761, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0876, Accuracy: 75/953 (7.8699%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0401, Accuracy: 349/953 (36.6212%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.4091, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0690, Accuracy: 233/1036 (22.4903%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0232, Accuracy: 696/1036 (67.1815%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.0835, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0889, Accuracy: 38/603 (6.3018%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0474, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.6001, Accuracy: 66/10000 (0.6600%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0539, Accuracy: 432/1750 (24.6857%)
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0304, Accuracy: 814/1750 (46.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8378, Accuracy: 140/10000 (1.4000%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0556, Accuracy: 434/1628 (26.6585%)
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0208, Accuracy: 989/1628 (60.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.2524, Accuracy: 159/10000 (1.5900%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0705, Accuracy: 289/1904 (15.1786%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0297, Accuracy: 815/1904 (42.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0236, Accuracy: 157/10000 (1.5700%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0773, Accuracy: 173/1089 (15.8861%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 561/1089 (51.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.4326, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0866, Accuracy: 82/1013 (8.0948%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 368/1013 (36.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8852, Accuracy: 84/10000 (0.8400%)
time spent on training: 392.0468783378601
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.6494, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.1102, Accuracy: 9892/9950 (99.4171%)
saving model
Done in 639.9390971660614 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0637, Accuracy: 332/1949 (17.0344%)
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0322, Accuracy: 683/1949 (35.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.1167, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0853, Accuracy: 76/416 (18.2692%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0503, Accuracy: 152/416 (36.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.7008, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0786, Accuracy: 115/677 (16.9867%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.5562, Accuracy: 59/10000 (0.5900%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0632, Accuracy: 373/1988 (18.7626%)
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 754/1988 (37.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.6529, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0790, Accuracy: 192/1190 (16.1345%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 473/1190 (39.7479%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.6790, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0767, Accuracy: 162/1131 (14.3236%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 554/1131 (48.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2227, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0811, Accuracy: 51/603 (8.4577%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5068, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.1166, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0495, Accuracy: 120/460 (26.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.4339, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0709, Accuracy: 212/1213 (17.4773%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 527/1213 (43.4460%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.7352, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0770, Accuracy: 186/1402 (13.2668%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 432/1402 (30.8131%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.3986, Accuracy: 82/10000 (0.8200%)
time spent on training: 293.13334441185
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.3291, Accuracy: 81/10000 (0.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.2373, Accuracy: 9669/9950 (97.1759%)
saving model
Done in 544.47944688797 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Average loss: 0.0546, Accuracy: 556/1475 (37.6949%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Average loss: 0.0257, Accuracy: 844/1475 (57.2203%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Average loss: 0.0212, Accuracy: 949/1475 (64.3390%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Average loss: 0.0210, Accuracy: 936/1475 (63.4576%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Average loss: 0.0203, Accuracy: 958/1475 (64.9492%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Average loss: 0.0205, Accuracy: 972/1475 (65.8983%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Average loss: 0.0201, Accuracy: 974/1475 (66.0339%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Average loss: 0.0199, Accuracy: 973/1475 (65.9661%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Average loss: 0.0188, Accuracy: 997/1475 (67.5932%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Average loss: 0.0193, Accuracy: 976/1475 (66.1695%), train_poison_data_count: 463
Global model norm: 111.72378048114913.
Norm before scaling: 111.69621276172482. Distance: 1.1714671124454932
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2941, Accuracy: 104/10000 (1.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.1913, Accuracy: 9536/9950 (95.8392%)
Scaling by  100
Scaled Norm after poisoning: 159.53857414627035, distance: 117.14670539941574
Total norm for 2 adversaries is: 159.53857414627035. distance: 117.14670539941574
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0835, Accuracy: 123/708 (17.3729%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0381, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.0761, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0755, Accuracy: 75/809 (9.2707%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 364/809 (44.9938%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.9120, Accuracy: 116/10000 (1.1600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0500, Accuracy: 466/1628 (28.6241%)
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0208, Accuracy: 993/1628 (60.9951%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2471, Accuracy: 170/10000 (1.7000%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0670, Accuracy: 217/1213 (17.8895%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 587/1213 (48.3924%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8978, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0773, Accuracy: 194/901 (21.5316%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0354, Accuracy: 434/901 (48.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.7511, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0648, Accuracy: 305/1645 (18.5410%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0310, Accuracy: 741/1645 (45.0456%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.1329, Accuracy: 144/10000 (1.4400%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0831, Accuracy: 119/715 (16.6434%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0477, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.5965, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0788, Accuracy: 198/1003 (19.7408%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0381, Accuracy: 356/1003 (35.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2869, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0696, Accuracy: 183/1241 (14.7462%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 457/1241 (36.8251%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.7097, Accuracy: 74/10000 (0.7400%)
time spent on training: 418.48259377479553
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2546, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.3050, Accuracy: 9143/9950 (91.8894%)
saving model
Done in 659.8480291366577 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0586, Accuracy: 398/1750 (22.7429%)
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0313, Accuracy: 807/1750 (46.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.6410, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0697, Accuracy: 333/1904 (17.4895%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0295, Accuracy: 826/1904 (43.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3023, Accuracy: 122/10000 (1.2200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0673, Accuracy: 363/1988 (18.2596%)
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 744/1988 (37.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7394, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1027, Accuracy: 7/605 (1.1570%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0458, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7011, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.1225, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0662, Accuracy: 86/408 (21.0784%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.9768, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.1135, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0523, Accuracy: 196/631 (31.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.4675, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.1144, Accuracy: 2/373 (0.5362%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0629, Accuracy: 45/373 (12.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.6330, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0621, Accuracy: 227/1071 (21.1951%)
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0257, Accuracy: 579/1071 (54.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.1496, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0654, Accuracy: 380/1470 (25.8503%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 905/1470 (61.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.5355, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0947, Accuracy: 59/774 (7.6227%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0367, Accuracy: 409/774 (52.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3337, Accuracy: 86/10000 (0.8600%)
time spent on training: 302.9279923439026
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.9163, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 0.4309, Accuracy: 8745/9950 (87.8894%)
saving model
Saving model on epoch 50
Done in 552.627498626709 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Average loss: 0.0529, Accuracy: 720/1988 (36.2173%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Average loss: 0.0285, Accuracy: 1027/1988 (51.6600%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Average loss: 0.0255, Accuracy: 1091/1988 (54.8793%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Average loss: 0.0258, Accuracy: 1055/1988 (53.0684%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Average loss: 0.0254, Accuracy: 1078/1988 (54.2254%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Average loss: 0.0255, Accuracy: 1092/1988 (54.9296%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Average loss: 0.0250, Accuracy: 1097/1988 (55.1811%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Average loss: 0.0244, Accuracy: 1115/1988 (56.0865%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Average loss: 0.0245, Accuracy: 1137/1988 (57.1932%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Average loss: 0.0246, Accuracy: 1114/1988 (56.0362%), train_poison_data_count: 624
Global model norm: 111.69216466895742.
Norm before scaling: 111.65301387697737. Distance: 1.297775645220723
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3945, Accuracy: 85/10000 (0.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.1155, Accuracy: 9651/9950 (96.9950%)
Scaling by  100
Scaled Norm after poisoning: 168.14982391085042, distance: 129.7775741412976
Total norm for 1 adversaries is: 168.14982391085042. distance: 129.7775741412976
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0659, Accuracy: 285/1645 (17.3252%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0307, Accuracy: 726/1645 (44.1337%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8203, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0679, Accuracy: 213/1446 (14.7303%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 555/1446 (38.3817%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8708, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1678, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1410, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.5086, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0740, Accuracy: 174/803 (21.6687%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0376, Accuracy: 445/803 (55.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3306, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.1145, Accuracy: 1/311 (0.3215%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0767, Accuracy: 26/311 (8.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.3469, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0921, Accuracy: 20/568 (3.5211%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0479, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.2978, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.1066, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0529, Accuracy: 169/466 (36.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6101, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0799, Accuracy: 160/891 (17.9574%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0302, Accuracy: 467/891 (52.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.5151, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0751, Accuracy: 199/1241 (16.0355%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 469/1241 (37.7921%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6229, Accuracy: 82/10000 (0.8200%)
time spent on training: 375.80617809295654
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.4000, Accuracy: 89/10000 (0.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.1670, Accuracy: 9415/9950 (94.6231%)
saving model
Done in 622.2809119224548 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0655, Accuracy: 229/1275 (17.9608%)
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0185, Accuracy: 759/1275 (59.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.5473, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1893, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1627, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0026, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0691, Accuracy: 362/1953 (18.5356%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0321, Accuracy: 926/1953 (47.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.4230, Accuracy: 149/10000 (1.4900%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0788, Accuracy: 145/803 (18.0573%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0385, Accuracy: 441/803 (54.9191%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.7382, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0931, Accuracy: 33/809 (4.0791%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0288, Accuracy: 353/809 (43.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.5682, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0712, Accuracy: 286/1956 (14.6217%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0299, Accuracy: 785/1956 (40.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9954, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0892, Accuracy: 180/1163 (15.4772%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0386, Accuracy: 523/1163 (44.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.3506, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0685, Accuracy: 249/1446 (17.2199%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 531/1446 (36.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.6142, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0772, Accuracy: 235/1573 (14.9396%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 616/1573 (39.1608%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9571, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0919, Accuracy: 51/818 (6.2347%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0345, Accuracy: 329/818 (40.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.6160, Accuracy: 101/10000 (1.0100%)
time spent on training: 294.9042999744415
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0819, Accuracy: 93/10000 (0.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 0.3039, Accuracy: 9013/9950 (90.5829%)
saving model
Done in 532.1832005977631 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0870, Accuracy: 36/809 (4.4499%)
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0282, Accuracy: 359/809 (44.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.4373, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0881, Accuracy: 71/1013 (7.0089%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 383/1013 (37.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2000, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0821, Accuracy: 176/1190 (14.7899%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 475/1190 (39.9160%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.7169, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0789, Accuracy: 169/1513 (11.1699%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 541/1513 (35.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.6483, Accuracy: 124/10000 (1.2400%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0831, Accuracy: 100/690 (14.4928%)
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0286, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.8162, Accuracy: 80/10000 (0.8000%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0561, Accuracy: 419/1628 (25.7371%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0208, Accuracy: 1009/1628 (61.9779%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.3247, Accuracy: 173/10000 (1.7300%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0739, Accuracy: 254/1573 (16.1475%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 604/1573 (38.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8585, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.1116, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0656, Accuracy: 39/373 (10.4558%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.6652, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0789, Accuracy: 164/1241 (13.2151%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 495/1241 (39.8872%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.7905, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0901, Accuracy: 69/590 (11.6949%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0403, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.9335, Accuracy: 50/10000 (0.5000%)
time spent on training: 322.2495629787445
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.8178, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 0.4082, Accuracy: 8758/9950 (88.0201%)
saving model
Done in 567.6348371505737 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0756, Accuracy: 166/1241 (13.3763%)
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 469/1241 (37.7921%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.8334, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0625, Accuracy: 384/1470 (26.1224%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 905/1470 (61.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.4418, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0816, Accuracy: 45/809 (5.5624%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 382/809 (47.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.1982, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0743, Accuracy: 185/928 (19.9353%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 617/928 (66.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.3605, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0788, Accuracy: 138/1131 (12.2016%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 555/1131 (49.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.5596, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.1152, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0656, Accuracy: 82/408 (20.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.0470, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0855, Accuracy: 85/636 (13.3648%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0360, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.1678, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0527, Accuracy: 170/735 (23.1293%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0199, Accuracy: 346/735 (47.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.7806, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0799, Accuracy: 110/938 (11.7271%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 379/938 (40.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.0600, Accuracy: 84/10000 (0.8400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0330, Accuracy: 814/1988 (40.9457%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0295, Accuracy: 915/1988 (46.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.9973, Accuracy: 105/10000 (1.0500%)
time spent on training: 288.48921179771423
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.6474, Accuracy: 97/10000 (0.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 0.4736, Accuracy: 8640/9950 (86.8342%)
saving model
Done in 536.8253283500671 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.1080, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0614, Accuracy: 106/515 (20.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.8015, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0687, Accuracy: 177/803 (22.0423%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0363, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.4320, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1589, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1423, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.4265, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0577, Accuracy: 231/1275 (18.1176%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0176, Accuracy: 772/1275 (60.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.4368, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0657, Accuracy: 256/1036 (24.7104%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 710/1036 (68.5328%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.3187, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0613, Accuracy: 269/1446 (18.6030%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 558/1446 (38.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.7218, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0897, Accuracy: 40/669 (5.9791%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0449, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.4218, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0837, Accuracy: 70/774 (9.0439%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0347, Accuracy: 395/774 (51.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9124, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.1058, Accuracy: 29/599 (4.8414%)
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.8562, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0996, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.3975, Accuracy: 108/10000 (1.0800%)
time spent on training: 240.23634362220764
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.5138, Accuracy: 96/10000 (0.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.5344, Accuracy: 8534/9950 (85.7688%)
saving model
Done in 487.5913562774658 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0988, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0590, Accuracy: 55/373 (14.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.5422, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0553, Accuracy: 245/1275 (19.2157%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0175, Accuracy: 796/1275 (62.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.3430, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0726, Accuracy: 203/1513 (13.4171%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0356, Accuracy: 572/1513 (37.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.6314, Accuracy: 133/10000 (1.3300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0724, Accuracy: 125/690 (18.1159%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0259, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.6180, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0806, Accuracy: 70/953 (7.3452%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0394, Accuracy: 337/953 (35.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.4069, Accuracy: 89/10000 (0.8900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0490, Accuracy: 458/1552 (29.5103%)
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0181, Accuracy: 897/1552 (57.7964%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.5140, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0766, Accuracy: 108/677 (15.9527%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.4407, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0624, Accuracy: 242/1036 (23.3591%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0221, Accuracy: 721/1036 (69.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.9850, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0769, Accuracy: 188/1402 (13.4094%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 474/1402 (33.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.4088, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0632, Accuracy: 340/1715 (19.8251%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0295, Accuracy: 810/1715 (47.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0414, Accuracy: 110/10000 (1.1000%)
time spent on training: 336.5806429386139
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.3466, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 0.5983, Accuracy: 8432/9950 (84.7437%)
saving model
Done in 582.2499558925629 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0778, Accuracy: 118/708 (16.6667%)
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0442, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.1285, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0700, Accuracy: 183/1241 (14.7462%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0361, Accuracy: 462/1241 (37.2280%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.6389, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0779, Accuracy: 86/1013 (8.4896%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 411/1013 (40.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.1148, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0480, Accuracy: 186/735 (25.3061%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0190, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.2913, Accuracy: 77/10000 (0.7700%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 239/1071 (22.3156%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0252, Accuracy: 601/1071 (56.1158%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.9585, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0953, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0494, Accuracy: 222/631 (35.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.2140, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0952, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0564, Accuracy: 71/373 (19.0349%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.4903, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.1086, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0925, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.1579, Accuracy: 108/10000 (1.0800%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0343, Accuracy: 800/1988 (40.2414%)
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0298, Accuracy: 937/1988 (47.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9452, Accuracy: 104/10000 (1.0400%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0984, Accuracy: 53/599 (8.8481%)
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0266, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.4657, Accuracy: 50/10000 (0.5000%)
time spent on training: 282.9305520057678
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.2622, Accuracy: 96/10000 (0.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.6237, Accuracy: 8409/9950 (84.5126%)
saving model
Done in 530.4754450321198 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0725, Accuracy: 202/1190 (16.9748%)
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 519/1190 (43.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.7811, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0614, Accuracy: 155/813 (19.0652%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 455/813 (55.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 11.9565, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0710, Accuracy: 164/1131 (14.5004%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0295, Accuracy: 580/1131 (51.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.3762, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.1077, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0479, Accuracy: 125/460 (27.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.3628, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0692, Accuracy: 202/1513 (13.3510%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0351, Accuracy: 563/1513 (37.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.5345, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1456, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1354, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.1088, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0958, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0509, Accuracy: 125/426 (29.3427%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.8471, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0778, Accuracy: 189/901 (20.9767%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0365, Accuracy: 432/901 (47.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.8308, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0700, Accuracy: 204/1131 (18.0371%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0325, Accuracy: 413/1131 (36.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.1263, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0814, Accuracy: 42/603 (6.9652%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.4522, Accuracy: 74/10000 (0.7400%)
time spent on training: 198.1866843700409
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.1500, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 0.6532, Accuracy: 8406/9950 (84.4824%)
saving model
Done in 445.6598331928253 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0949, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0553, Accuracy: 123/500 (24.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.8361, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0453, Accuracy: 494/1552 (31.8299%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0183, Accuracy: 888/1552 (57.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.7721, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0747, Accuracy: 125/712 (17.5562%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 466/712 (65.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.2447, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0775, Accuracy: 140/719 (19.4715%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0388, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.1890, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0650, Accuracy: 267/1573 (16.9739%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 636/1573 (40.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6874, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0986, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0596, Accuracy: 109/408 (26.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.7181, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0922, Accuracy: 67/599 (11.1853%)
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0311, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.9197, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0678, Accuracy: 211/1131 (18.6561%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 459/1131 (40.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.1529, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0830, Accuracy: 121/715 (16.9231%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0442, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.8476, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0475, Accuracy: 198/735 (26.9388%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0193, Accuracy: 356/735 (48.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.6993, Accuracy: 77/10000 (0.7700%)
time spent on training: 235.94895124435425
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.0596, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.6848, Accuracy: 8399/9950 (84.4121%)
saving model
Done in 474.75286841392517 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0583, Accuracy: 334/1581 (21.1259%)
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0315, Accuracy: 669/1581 (42.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5400, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0675, Accuracy: 157/1013 (15.4985%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 510/1013 (50.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.0445, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0660, Accuracy: 282/1587 (17.7694%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 617/1587 (38.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.6377, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0749, Accuracy: 108/774 (13.9535%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0349, Accuracy: 403/774 (52.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.9438, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0617, Accuracy: 224/1213 (18.4666%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 602/1213 (49.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7253, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0693, Accuracy: 202/891 (22.6712%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0291, Accuracy: 461/891 (51.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.2666, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1403, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1294, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.9221, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0867, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0498, Accuracy: 87/312 (27.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.4506, Accuracy: 57/10000 (0.5700%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 116/440 (26.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.5279, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0775, Accuracy: 59/603 (9.7844%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0476, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.3921, Accuracy: 71/10000 (0.7100%)
time spent on training: 207.02079820632935
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.9854, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 0.7200, Accuracy: 8380/9950 (84.2211%)
saving model
Saving model on epoch 60
Done in 444.60863518714905 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0697, Accuracy: 136/888 (15.3153%)
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 426/888 (47.9730%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.7367, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0603, Accuracy: 234/1213 (19.2910%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 586/1213 (48.3100%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.6832, Accuracy: 93/10000 (0.9300%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1327, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1244, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.9679, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0567, Accuracy: 576/2227 (25.8644%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0268, Accuracy: 1133/2227 (50.8756%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.9044, Accuracy: 129/10000 (1.2900%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0521, Accuracy: 269/1071 (25.1167%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0247, Accuracy: 614/1071 (57.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.6875, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0660, Accuracy: 221/1131 (19.5402%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 403/1131 (35.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.4441, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0691, Accuracy: 77/809 (9.5179%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0263, Accuracy: 393/809 (48.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.9428, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0656, Accuracy: 204/1241 (16.4384%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 479/1241 (38.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.7668, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0729, Accuracy: 113/1013 (11.1550%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 413/1013 (40.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.8976, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0735, Accuracy: 69/953 (7.2403%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 350/953 (36.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.3955, Accuracy: 86/10000 (0.8600%)
time spent on training: 271.24224042892456
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.9030, Accuracy: 96/10000 (0.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 0.7279, Accuracy: 8432/9950 (84.7437%)
saving model
Done in 506.5609350204468 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0899, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0530, Accuracy: 142/500 (28.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.8405, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0602, Accuracy: 333/1645 (20.2432%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 747/1645 (45.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.9267, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0857, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0527, Accuracy: 90/373 (24.1287%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.4475, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0348, Accuracy: 793/1988 (39.8893%)
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0297, Accuracy: 931/1988 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.7690, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0559, Accuracy: 542/2227 (24.3377%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1080/2227 (48.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.0282, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0570, Accuracy: 348/1440 (24.1667%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0267, Accuracy: 790/1440 (54.8611%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.5712, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0770, Accuracy: 82/669 (12.2571%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.1974, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0672, Accuracy: 207/891 (23.2323%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0282, Accuracy: 469/891 (52.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.2268, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0697, Accuracy: 221/1402 (15.7632%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 453/1402 (32.3110%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6790, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0673, Accuracy: 148/888 (16.6667%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 423/888 (47.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.6900, Accuracy: 90/10000 (0.9000%)
time spent on training: 269.8350064754486
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.8446, Accuracy: 101/10000 (1.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 0.7504, Accuracy: 8445/9950 (84.8744%)
saving model
Done in 511.28098940849304 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0702, Accuracy: 130/1013 (12.8332%)
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 395/1013 (38.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8903, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0716, Accuracy: 119/774 (15.3747%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0361, Accuracy: 384/774 (49.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9528, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0583, Accuracy: 250/1213 (20.6101%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0264, Accuracy: 577/1213 (47.5680%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8660, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0603, Accuracy: 281/1030 (27.2816%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0228, Accuracy: 677/1030 (65.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.2725, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 365/1581 (23.0867%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0307, Accuracy: 698/1581 (44.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.4918, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0619, Accuracy: 292/1662 (17.5692%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0313, Accuracy: 724/1662 (43.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8348, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0685, Accuracy: 213/901 (23.6404%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 417/901 (46.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8781, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1021, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0682, Accuracy: 27/271 (9.9631%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.0012, Accuracy: 79/10000 (0.7900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0630, Accuracy: 175/690 (25.3623%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0245, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.1770, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0645, Accuracy: 184/1013 (18.1639%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 485/1013 (47.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8932, Accuracy: 88/10000 (0.8800%)
time spent on training: 263.8292694091797
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.7861, Accuracy: 99/10000 (0.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 0.7913, Accuracy: 8433/9950 (84.7538%)
saving model
Done in 505.40168380737305 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0702, Accuracy: 139/774 (17.9587%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0352, Accuracy: 381/774 (49.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8411, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0683, Accuracy: 103/818 (12.5917%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 379/818 (46.3325%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.4213, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0529, Accuracy: 442/1470 (30.0680%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 926/1470 (62.9932%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2720, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0853, Accuracy: 6/466 (1.2876%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 177/466 (37.9828%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.1578, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0752, Accuracy: 87/669 (13.0045%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0387, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.0071, Accuracy: 78/10000 (0.7800%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 21/486 (4.3210%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0383, Accuracy: 202/486 (41.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.6701, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0683, Accuracy: 206/1402 (14.6933%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 482/1402 (34.3795%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.5050, Accuracy: 88/10000 (0.8800%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0468, Accuracy: 488/1628 (29.9754%)
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0206, Accuracy: 981/1628 (60.2580%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.1306, Accuracy: 175/10000 (1.7500%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0680, Accuracy: 147/590 (24.9153%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.5851, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0595, Accuracy: 347/1418 (24.4711%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0294, Accuracy: 752/1418 (53.0324%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0646, Accuracy: 108/10000 (1.0800%)
time spent on training: 253.38685631752014
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.7345, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 0.8233, Accuracy: 8438/9950 (84.8040%)
saving model
Done in 503.5682706832886 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0863, Accuracy: 5/416 (1.2019%)
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0481, Accuracy: 174/416 (41.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.6758, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0656, Accuracy: 211/896 (23.5491%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0351, Accuracy: 472/896 (52.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.6378, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0651, Accuracy: 173/677 (25.5539%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.1005, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0724, Accuracy: 153/708 (21.6102%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0387, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1570, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0704, Accuracy: 246/1163 (21.1522%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0369, Accuracy: 528/1163 (45.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.2553, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0833, Accuracy: 13/466 (2.7897%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.2699, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0616, Accuracy: 197/1154 (17.0711%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0251, Accuracy: 573/1154 (49.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.8470, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0626, Accuracy: 326/1587 (20.5419%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 634/1587 (39.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.5250, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0571, Accuracy: 409/1953 (20.9421%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0312, Accuracy: 944/1953 (48.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.3358, Accuracy: 160/10000 (1.6000%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0704, Accuracy: 180/719 (25.0348%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0369, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4842, Accuracy: 51/10000 (0.5100%)
time spent on training: 204.42551851272583
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.6904, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.8525, Accuracy: 8434/9950 (84.7638%)
saving model
Done in 445.3117105960846 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0645, Accuracy: 198/1131 (17.5066%)
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0291, Accuracy: 520/1131 (45.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.0367, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0712, Accuracy: 86/603 (14.2620%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.4089, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0889, Accuracy: 11/515 (2.1359%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0618, Accuracy: 115/515 (22.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.5625, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0701, Accuracy: 165/946 (17.4419%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0371, Accuracy: 367/946 (38.7949%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.0952, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0680, Accuracy: 134/1013 (13.2280%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0346, Accuracy: 407/1013 (40.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.9403, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0801, Accuracy: 22/530 (4.1509%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 275/530 (51.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.2610, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0811, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0503, Accuracy: 105/373 (28.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.3794, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.0973, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0670, Accuracy: 47/271 (17.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.9336, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0849, Accuracy: 6/416 (1.4423%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0475, Accuracy: 187/416 (44.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.8086, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0654, Accuracy: 240/1003 (23.9282%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0356, Accuracy: 413/1003 (41.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.4700, Accuracy: 61/10000 (0.6100%)
time spent on training: 169.0465657711029
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.6582, Accuracy: 103/10000 (1.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 0.8652, Accuracy: 8468/9950 (85.1055%)
saving model
Done in 413.22888588905334 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0597, Accuracy: 319/1662 (19.1937%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0311, Accuracy: 690/1662 (41.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.7905, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 337/1645 (20.4863%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0300, Accuracy: 783/1645 (47.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.8051, Accuracy: 125/10000 (1.2500%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0831, Accuracy: 109/599 (18.1970%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 12.6027, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 172/938 (18.3369%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0325, Accuracy: 353/938 (37.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.1572, Accuracy: 81/10000 (0.8100%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0759, Accuracy: 24/486 (4.9383%)
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0376, Accuracy: 209/486 (43.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.7416, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0512, Accuracy: 459/1470 (31.2245%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 924/1470 (62.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.1167, Accuracy: 115/10000 (1.1500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0588, Accuracy: 188/690 (27.2464%)
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0240, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.2517, Accuracy: 90/10000 (0.9000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0624, Accuracy: 171/861 (19.8606%)
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0188, Accuracy: 529/861 (61.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.4110, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0654, Accuracy: 226/1003 (22.5324%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0355, Accuracy: 397/1003 (39.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.5959, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0631, Accuracy: 237/1513 (15.6642%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0348, Accuracy: 571/1513 (37.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.6046, Accuracy: 139/10000 (1.3900%)
time spent on training: 265.6117653846741
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.6180, Accuracy: 103/10000 (1.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 0.8744, Accuracy: 8511/9950 (85.5377%)
saving model
Done in 518.7205290794373 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 431/1953 (22.0686%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0303, Accuracy: 987/1953 (50.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.4769, Accuracy: 148/10000 (1.4800%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0668, Accuracy: 162/636 (25.4717%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.7331, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0557, Accuracy: 272/1213 (22.4237%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 627/1213 (51.6900%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6028, Accuracy: 97/10000 (0.9700%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0510, Accuracy: 483/1750 (27.6000%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0310, Accuracy: 809/1750 (46.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.4732, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0836, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0469, Accuracy: 156/426 (36.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.8061, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0623, Accuracy: 228/891 (25.5892%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0268, Accuracy: 478/891 (53.6476%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2308, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0608, Accuracy: 254/1131 (22.4580%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 417/1131 (36.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.1691, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0809, Accuracy: 22/466 (4.7210%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 181/466 (38.8412%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.0215, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0586, Accuracy: 373/1904 (19.5903%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0285, Accuracy: 885/1904 (46.4811%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.8606, Accuracy: 172/10000 (1.7200%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0570, Accuracy: 359/1574 (22.8081%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0255, Accuracy: 769/1574 (48.8564%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2983, Accuracy: 126/10000 (1.2600%)
time spent on training: 252.1962070465088
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.5852, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 0.8858, Accuracy: 8558/9950 (86.0101%)
saving model
Done in 510.32865381240845 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0622, Accuracy: 195/677 (28.8035%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.7469, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0789, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0458, Accuracy: 124/312 (39.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.3566, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0536, Accuracy: 409/1581 (25.8697%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0306, Accuracy: 732/1581 (46.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6141, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0575, Accuracy: 373/1418 (26.3047%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0294, Accuracy: 743/1418 (52.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.1045, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0655, Accuracy: 162/636 (25.4717%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.6256, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0543, Accuracy: 287/1213 (23.6603%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 620/1213 (51.1129%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.7439, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0654, Accuracy: 180/712 (25.2809%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 462/712 (64.8876%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.4479, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0571, Accuracy: 374/1949 (19.1893%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0317, Accuracy: 720/1949 (36.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.0591, Accuracy: 103/10000 (1.0300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0707, Accuracy: 167/807 (20.6939%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0329, Accuracy: 443/807 (54.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6316, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0660, Accuracy: 101/568 (17.7817%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0404, Accuracy: 267/568 (47.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.3089, Accuracy: 59/10000 (0.5900%)
time spent on training: 229.0030586719513
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.5629, Accuracy: 103/10000 (1.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.8948, Accuracy: 8601/9950 (86.4422%)
saving model
Done in 476.86058163642883 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0659, Accuracy: 161/776 (20.7474%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0273, Accuracy: 440/776 (56.7010%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.0930, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 3/312 (0.9615%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0449, Accuracy: 133/312 (42.6282%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.4154, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0870, Accuracy: 7/408 (1.7157%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0533, Accuracy: 141/408 (34.5588%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.6004, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0638, Accuracy: 175/636 (27.5157%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.4171, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0797, Accuracy: 117/599 (19.5326%)
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0253, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 12.2213, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0820, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0503, Accuracy: 194/500 (38.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.8007, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0579, Accuracy: 421/1742 (24.1676%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0300, Accuracy: 768/1742 (44.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.9589, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0539, Accuracy: 313/1213 (25.8038%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 586/1213 (48.3100%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.6650, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0576, Accuracy: 361/1956 (18.4560%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0293, Accuracy: 787/1956 (40.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.9274, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 158/774 (20.4134%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 387/774 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7383, Accuracy: 78/10000 (0.7800%)
time spent on training: 218.963449716568
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.5403, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 0.8984, Accuracy: 8647/9950 (86.9045%)
saving model
Done in 463.27306270599365 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0706, Accuracy: 99/603 (16.4179%)
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0432, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1984, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0610, Accuracy: 255/1513 (16.8539%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0344, Accuracy: 573/1513 (37.8718%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.6099, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0594, Accuracy: 265/1131 (23.4306%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 471/1131 (41.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.0903, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0643, Accuracy: 231/896 (25.7812%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 497/896 (55.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.4681, Accuracy: 65/10000 (0.6500%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0452, Accuracy: 513/1475 (34.7797%)
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0242, Accuracy: 842/1475 (57.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.9511, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0524, Accuracy: 344/1036 (33.2046%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0232, Accuracy: 705/1036 (68.0502%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 11.6202, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0636, Accuracy: 191/712 (26.8258%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0251, Accuracy: 465/712 (65.3090%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.2136, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0735, Accuracy: 180/715 (25.1748%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0413, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.6087, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0730, Accuracy: 6/440 (1.3636%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0434, Accuracy: 177/440 (40.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.4436, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0604, Accuracy: 236/1154 (20.4506%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 570/1154 (49.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.0451, Accuracy: 89/10000 (0.8900%)
time spent on training: 241.115718126297
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.5193, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.8949, Accuracy: 8713/9950 (87.5678%)
saving model
Done in 482.87881731987 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0810, Accuracy: 20/416 (4.8077%)
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 201/416 (48.3173%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.6902, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0566, Accuracy: 260/803 (32.3786%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0324, Accuracy: 454/803 (56.5380%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.1342, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0610, Accuracy: 234/891 (26.2626%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 475/891 (53.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.3435, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0587, Accuracy: 278/1131 (24.5800%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0305, Accuracy: 486/1131 (42.9708%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.0823, Accuracy: 67/10000 (0.6700%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0443, Accuracy: 571/1628 (35.0737%)
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0205, Accuracy: 1012/1628 (62.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9997, Accuracy: 172/10000 (1.7200%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0731, Accuracy: 68/311 (21.8650%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0546, Accuracy: 131/311 (42.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.2039, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0531, Accuracy: 393/1581 (24.8577%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0303, Accuracy: 716/1581 (45.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.5021, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0594, Accuracy: 207/1013 (20.4344%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 522/1013 (51.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.7441, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 345/1030 (33.4951%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0238, Accuracy: 676/1030 (65.6311%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.8040, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0496, Accuracy: 531/1470 (36.1224%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 945/1470 (64.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.2308, Accuracy: 110/10000 (1.1000%)
time spent on training: 245.26373505592346
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.5036, Accuracy: 100/10000 (1.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 0.9180, Accuracy: 8707/9950 (87.5075%)
saving model
Done in 503.1275017261505 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0775, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 134/373 (35.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.3621, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 11/408 (2.6961%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0523, Accuracy: 146/408 (35.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.5896, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0562, Accuracy: 397/1949 (20.3694%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0317, Accuracy: 743/1949 (38.1221%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.0101, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0787, Accuracy: 39/466 (8.3691%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 184/466 (39.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.8500, Accuracy: 58/10000 (0.5800%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0597, Accuracy: 189/861 (21.9512%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0182, Accuracy: 519/861 (60.2787%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.5305, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0589, Accuracy: 321/1573 (20.4069%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0335, Accuracy: 702/1573 (44.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.7996, Accuracy: 87/10000 (0.8700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1225, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1182, Accuracy: 2/85 (2.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.5036, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0670, Accuracy: 250/901 (27.7469%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 435/901 (48.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.6646, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0664, Accuracy: 172/776 (22.1649%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0263, Accuracy: 452/776 (58.2474%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.1522, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 305/1446 (21.0927%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0333, Accuracy: 589/1446 (40.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.4195, Accuracy: 99/10000 (0.9900%)
time spent on training: 240.20109272003174
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.4882, Accuracy: 103/10000 (1.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 0.9377, Accuracy: 8714/9950 (87.5779%)
saving model
Done in 483.61229062080383 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0700, Accuracy: 197/715 (27.5524%)
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0427, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.4782, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0481, Accuracy: 223/735 (30.3401%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0181, Accuracy: 407/735 (55.3741%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.9507, Accuracy: 84/10000 (0.8400%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0452, Accuracy: 528/1475 (35.7966%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0242, Accuracy: 840/1475 (56.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6858, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0586, Accuracy: 344/1573 (21.8690%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0334, Accuracy: 666/1573 (42.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.5275, Accuracy: 103/10000 (1.0300%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0498, Accuracy: 515/1750 (29.4286%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0316, Accuracy: 825/1750 (47.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.5058, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0643, Accuracy: 247/901 (27.4140%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 442/901 (49.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7496, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0645, Accuracy: 246/1190 (20.6723%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0296, Accuracy: 526/1190 (44.2017%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6328, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0572, Accuracy: 376/1662 (22.6233%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0306, Accuracy: 736/1662 (44.2840%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7783, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0651, Accuracy: 148/1013 (14.6101%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0339, Accuracy: 403/1013 (39.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.8250, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 416/1418 (29.3371%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0282, Accuracy: 761/1418 (53.6671%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.2873, Accuracy: 112/10000 (1.1200%)
time spent on training: 286.18272280693054
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.4715, Accuracy: 106/10000 (1.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 0.9193, Accuracy: 8832/9950 (88.7638%)
saving model
Done in 527.5485818386078 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0410, Accuracy: 548/1552 (35.3093%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0178, Accuracy: 907/1552 (58.4407%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.3600, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0615, Accuracy: 201/712 (28.2303%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 468/712 (65.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.3780, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0702, Accuracy: 124/669 (18.5351%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0381, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.1025, Accuracy: 78/10000 (0.7800%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0450, Accuracy: 535/1475 (36.2712%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0239, Accuracy: 834/1475 (56.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.6605, Accuracy: 136/10000 (1.3600%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0656, Accuracy: 175/776 (22.5515%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0256, Accuracy: 449/776 (57.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.9984, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0668, Accuracy: 235/1089 (21.5794%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0236, Accuracy: 625/1089 (57.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.4687, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0622, Accuracy: 182/636 (28.6164%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.7216, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 284/928 (30.6034%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0210, Accuracy: 630/928 (67.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.5796, Accuracy: 108/10000 (1.0800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0561, Accuracy: 312/1154 (27.0364%)
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0261, Accuracy: 608/1154 (52.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.5649, Accuracy: 116/10000 (1.1600%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 225/690 (32.6087%)
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0235, Accuracy: 471/690 (68.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.0156, Accuracy: 91/10000 (0.9100%)
time spent on training: 281.51502799987793
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.4572, Accuracy: 109/10000 (1.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.9211, Accuracy: 8892/9950 (89.3668%)
saving model
Done in 525.2099215984344 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0612, Accuracy: 187/888 (21.0586%)
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0244, Accuracy: 458/888 (51.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.6488, Accuracy: 99/10000 (0.9900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0405, Accuracy: 572/1552 (36.8557%)
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0183, Accuracy: 869/1552 (55.9923%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.3834, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 266/1340 (19.8507%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0259, Accuracy: 651/1340 (48.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.6830, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 276/1131 (24.4032%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 446/1131 (39.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.0231, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0723, Accuracy: 140/773 (18.1113%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0274, Accuracy: 444/773 (57.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.2312, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 276/901 (30.6326%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 461/901 (51.1654%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9561, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0645, Accuracy: 263/1402 (18.7589%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0379, Accuracy: 466/1402 (33.2382%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.4303, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0567, Accuracy: 372/1662 (22.3827%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0304, Accuracy: 719/1662 (43.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.8848, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 172/1013 (16.9793%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0337, Accuracy: 391/1013 (38.5982%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9444, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0439, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.3512, Accuracy: 60/10000 (0.6000%)
time spent on training: 261.167528629303
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.4416, Accuracy: 109/10000 (1.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 0.9509, Accuracy: 8891/9950 (89.3568%)
saving model
Done in 506.47866010665894 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0780, Accuracy: 56/466 (12.0172%)
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0459, Accuracy: 192/466 (41.2017%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.7742, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0561, Accuracy: 388/1956 (19.8364%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0291, Accuracy: 770/1956 (39.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9787, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 248/1190 (20.8403%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0299, Accuracy: 524/1190 (44.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8082, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0897, Accuracy: 9/338 (2.6627%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0536, Accuracy: 110/338 (32.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.1965, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0638, Accuracy: 259/1402 (18.4736%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0372, Accuracy: 476/1402 (33.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.3223, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 307/1213 (25.3092%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0251, Accuracy: 635/1213 (52.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.6812, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0560, Accuracy: 435/1904 (22.8466%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0281, Accuracy: 893/1904 (46.9013%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8212, Accuracy: 165/10000 (1.6500%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0556, Accuracy: 418/1949 (21.4469%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0312, Accuracy: 723/1949 (37.0959%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9541, Accuracy: 105/10000 (1.0500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0399, Accuracy: 595/1552 (38.3376%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0181, Accuracy: 881/1552 (56.7655%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.1792, Accuracy: 116/10000 (1.1600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 347/1154 (30.0693%)
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0246, Accuracy: 643/1154 (55.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8854, Accuracy: 122/10000 (1.2200%)
time spent on training: 310.59623861312866
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.4263, Accuracy: 115/10000 (1.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.9898, Accuracy: 8895/9950 (89.3970%)
saving model
Done in 565.6951124668121 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0652, Accuracy: 233/719 (32.4061%)
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0341, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.3332, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0604, Accuracy: 270/1241 (21.7566%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0351, Accuracy: 490/1241 (39.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.5185, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0549, Accuracy: 414/1949 (21.2417%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0313, Accuracy: 733/1949 (37.6090%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.1256, Accuracy: 108/10000 (1.0800%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1240, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1157, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4311, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0843, Accuracy: 13/408 (3.1863%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0523, Accuracy: 150/408 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.9489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0581, Accuracy: 265/1089 (24.3343%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0250, Accuracy: 614/1089 (56.3820%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.1997, Accuracy: 139/10000 (1.3900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0768, Accuracy: 158/599 (26.3773%)
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 12.1577, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 453/1953 (23.1951%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0304, Accuracy: 945/1953 (48.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.3483, Accuracy: 163/10000 (1.6300%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 141/818 (17.2372%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0287, Accuracy: 404/818 (49.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.3756, Accuracy: 108/10000 (1.0800%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0719, Accuracy: 70/486 (14.4033%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0363, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.6624, Accuracy: 54/10000 (0.5400%)
time spent on training: 278.0342345237732
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4156, Accuracy: 113/10000 (1.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 1.0048, Accuracy: 8899/9950 (89.4372%)
saving model
Done in 530.0328040122986 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0852, Accuracy: 33/515 (6.4078%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 178/515 (34.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.6870, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 297/928 (32.0043%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0218, Accuracy: 624/928 (67.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5195, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0771, Accuracy: 65/466 (13.9485%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0445, Accuracy: 192/466 (41.2017%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.9184, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0561, Accuracy: 262/1154 (22.7036%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 582/1154 (50.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.8527, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0627, Accuracy: 259/896 (28.9062%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 473/896 (52.7902%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2335, Accuracy: 64/10000 (0.6400%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0482, Accuracy: 372/1071 (34.7339%)
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0247, Accuracy: 611/1071 (57.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5686, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0607, Accuracy: 277/1372 (20.1895%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0304, Accuracy: 603/1372 (43.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.1996, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0902, Accuracy: 2/460 (0.4348%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0422, Accuracy: 184/460 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2772, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0750, Accuracy: 157/599 (26.2104%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0268, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 11.9105, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0482, Accuracy: 538/1470 (36.5986%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0228, Accuracy: 954/1470 (64.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.9037, Accuracy: 118/10000 (1.1800%)
time spent on training: 263.7137441635132
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.4051, Accuracy: 123/10000 (1.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 1.0229, Accuracy: 8908/9950 (89.5276%)
saving model
Done in 513.7990934848785 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0548, Accuracy: 347/1154 (30.0693%)
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0252, Accuracy: 574/1154 (49.7400%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.9394, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0785, Accuracy: 9/500 (1.8000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 215/500 (43.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.7646, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0573, Accuracy: 360/1573 (22.8862%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 649/1573 (41.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5607, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0760, Accuracy: 78/530 (14.7170%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0355, Accuracy: 283/530 (53.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.0190, Accuracy: 72/10000 (0.7200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0499, Accuracy: 543/1750 (31.0286%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0313, Accuracy: 817/1750 (46.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.3718, Accuracy: 139/10000 (1.3900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0495, Accuracy: 456/1129 (40.3897%)
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 773/1129 (68.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.7253, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0531, Accuracy: 385/1440 (26.7361%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0257, Accuracy: 787/1440 (54.6528%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3959, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0598, Accuracy: 198/888 (22.2973%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0242, Accuracy: 455/888 (51.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.4198, Accuracy: 93/10000 (0.9300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/1657 (20.2173%)
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 576/1657 (34.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.6448, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0472, Accuracy: 558/1470 (37.9592%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0230, Accuracy: 938/1470 (63.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.8893, Accuracy: 114/10000 (1.1400%)
time spent on training: 322.92705488204956
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3932, Accuracy: 123/10000 (1.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 1.0513, Accuracy: 8907/9950 (89.5176%)
saving model
Done in 579.3494176864624 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0655, Accuracy: 142/568 (25.0000%)
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.2016, Accuracy: 66/10000 (0.6600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0427, Accuracy: 656/1628 (40.2948%)
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0199, Accuracy: 1006/1628 (61.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.7679, Accuracy: 178/10000 (1.7800%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0896, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0765, Accuracy: 8/186 (4.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.4097, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0515, Accuracy: 660/2227 (29.6363%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0263, Accuracy: 1112/2227 (49.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.0904, Accuracy: 131/10000 (1.3100%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 247/861 (28.6876%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0179, Accuracy: 528/861 (61.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.4824, Accuracy: 112/10000 (1.1200%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0678, Accuracy: 184/807 (22.8005%)
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0309, Accuracy: 445/807 (55.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.4482, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0596, Accuracy: 231/677 (34.1211%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.7521, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 291/1131 (25.7294%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0303, Accuracy: 456/1131 (40.3183%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.0672, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0598, Accuracy: 278/1241 (22.4013%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0353, Accuracy: 480/1241 (38.6785%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.6326, Accuracy: 83/10000 (0.8300%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0704, Accuracy: 35/440 (7.9545%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0429, Accuracy: 181/440 (41.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.5389, Accuracy: 57/10000 (0.5700%)
time spent on training: 303.2760229110718
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3848, Accuracy: 131/10000 (1.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 1.0567, Accuracy: 8932/9950 (89.7688%)
saving model
Done in 554.958785533905 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0615, Accuracy: 260/896 (29.0179%)
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 494/896 (55.1339%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.2526, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0622, Accuracy: 159/818 (19.4377%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0276, Accuracy: 438/818 (53.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4913, Accuracy: 99/10000 (0.9900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0543, Accuracy: 368/1154 (31.8891%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0250, Accuracy: 641/1154 (55.5459%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.6937, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0471, Accuracy: 547/1470 (37.2109%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 929/1470 (63.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7546, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0528, Accuracy: 459/1581 (29.0323%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0304, Accuracy: 704/1581 (44.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.5871, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0616, Accuracy: 295/1089 (27.0891%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0265, Accuracy: 643/1089 (59.0450%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.0038, Accuracy: 121/10000 (1.2100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0497, Accuracy: 557/1750 (31.8286%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0309, Accuracy: 831/1750 (47.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.3863, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0588, Accuracy: 245/1241 (19.7421%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0347, Accuracy: 536/1241 (43.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.5028, Accuracy: 83/10000 (0.8300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0421, Accuracy: 656/1628 (40.2948%)
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0198, Accuracy: 1049/1628 (64.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7771, Accuracy: 180/10000 (1.8000%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0656, Accuracy: 142/953 (14.9003%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0361, Accuracy: 353/953 (37.0409%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.2252, Accuracy: 92/10000 (0.9200%)
time spent on training: 340.7877457141876
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3781, Accuracy: 132/10000 (1.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 1.0744, Accuracy: 8939/9950 (89.8392%)
saving model
Done in 593.7833037376404 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0492, Accuracy: 563/1750 (32.1714%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0313, Accuracy: 813/1750 (46.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.4855, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0733, Accuracy: 97/530 (18.3019%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2408, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 431/1418 (30.3949%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0283, Accuracy: 745/1418 (52.5388%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9176, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 362/1213 (29.8434%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0247, Accuracy: 641/1213 (52.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.4840, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0672, Accuracy: 213/946 (22.5159%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0349, Accuracy: 413/946 (43.6575%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.9196, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 441/1742 (25.3157%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0297, Accuracy: 784/1742 (45.0057%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8838, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0580, Accuracy: 296/1241 (23.8517%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 502/1241 (40.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.6249, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0749, Accuracy: 17/312 (5.4487%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0431, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.3726, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0885, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0755, Accuracy: 10/186 (5.3763%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.4011, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 414/1662 (24.9097%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0298, Accuracy: 762/1662 (45.8484%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.7250, Accuracy: 117/10000 (1.1700%)
time spent on training: 296.1217215061188
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3707, Accuracy: 144/10000 (1.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 1.0903, Accuracy: 8950/9950 (89.9497%)
saving model
Done in 541.997838973999 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0670, Accuracy: 216/708 (30.5085%)
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0362, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0422, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0840, Accuracy: 23/408 (5.6373%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0513, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.4895, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0614, Accuracy: 239/1049 (22.7836%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0254, Accuracy: 580/1049 (55.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0984, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 305/1340 (22.7612%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0250, Accuracy: 655/1340 (48.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.6406, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0587, Accuracy: 230/1013 (22.7048%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 498/1013 (49.1609%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.4450, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0717, Accuracy: 122/605 (20.1653%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0413, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.1909, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0590, Accuracy: 291/1372 (21.2099%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0297, Accuracy: 627/1372 (45.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.3998, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0656, Accuracy: 297/1163 (25.5374%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 575/1163 (49.4411%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.1396, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 253/813 (31.1193%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 488/813 (60.0246%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 11.8549, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0687, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0432, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0609, Accuracy: 72/10000 (0.7200%)
time spent on training: 255.68939685821533
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3624, Accuracy: 145/10000 (1.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 1.1202, Accuracy: 8944/9950 (89.8894%)
saving model
Done in 499.13645815849304 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0709, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0351, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.6870, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0534, Accuracy: 465/1715 (27.1137%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0282, Accuracy: 885/1715 (51.6035%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.0294, Accuracy: 114/10000 (1.1400%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0477, Accuracy: 416/1071 (38.8422%)
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0248, Accuracy: 604/1071 (56.3959%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5069, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0887, Accuracy: 13/460 (2.8261%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0441, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.3829, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 141/953 (14.7954%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0361, Accuracy: 336/953 (35.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.2854, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0579, Accuracy: 291/1241 (23.4488%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0347, Accuracy: 502/1241 (40.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.7103, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 32/426 (7.5117%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0449, Accuracy: 171/426 (40.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.6988, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0631, Accuracy: 343/1427 (24.0364%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0316, Accuracy: 662/1427 (46.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.4827, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0686, Accuracy: 144/669 (21.5247%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0367, Accuracy: 360/669 (53.8117%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.9775, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0515, Accuracy: 264/813 (32.4723%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 488/813 (60.0246%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 12.2248, Accuracy: 59/10000 (0.5900%)
time spent on training: 287.94150400161743
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3566, Accuracy: 146/10000 (1.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 1.1030, Accuracy: 8989/9950 (90.3417%)
saving model
Done in 526.2742199897766 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0703, Accuracy: 129/605 (21.3223%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0406, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.2684, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0730, Accuracy: 118/530 (22.2642%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0365, Accuracy: 275/530 (51.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.2709, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0506, Accuracy: 372/1213 (30.6678%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0246, Accuracy: 649/1213 (53.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.5724, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0675, Accuracy: 114/781 (14.5967%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0337, Accuracy: 288/781 (36.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.9232, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0676, Accuracy: 174/773 (22.5097%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0287, Accuracy: 447/773 (57.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.2815, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 597/1470 (40.6122%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0221, Accuracy: 937/1470 (63.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.7442, Accuracy: 114/10000 (1.1400%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0491, Accuracy: 603/1750 (34.4571%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0309, Accuracy: 812/1750 (46.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.4155, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0475, Accuracy: 365/1275 (28.6275%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0166, Accuracy: 813/1275 (63.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.0660, Accuracy: 135/10000 (1.3500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0391, Accuracy: 663/1552 (42.7191%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0177, Accuracy: 916/1552 (59.0206%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.5942, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 467/1715 (27.2303%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0280, Accuracy: 867/1715 (50.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.8666, Accuracy: 116/10000 (1.1600%)
time spent on training: 334.8075771331787
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3512, Accuracy: 162/10000 (1.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 1.1105, Accuracy: 9019/9950 (90.6432%)
saving model
Done in 576.7912817001343 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0593, Accuracy: 366/1587 (23.0624%)
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0324, Accuracy: 672/1587 (42.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.5497, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0644, Accuracy: 228/590 (38.6441%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0326, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.1021, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0649, Accuracy: 298/1163 (25.6234%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 546/1163 (46.9475%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.2140, Accuracy: 88/10000 (0.8800%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1208, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3567, Accuracy: 144/10000 (1.4400%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0617, Accuracy: 202/818 (24.6944%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0278, Accuracy: 435/818 (53.1785%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5420, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0697, Accuracy: 226/715 (31.6084%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.5861, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0639, Accuracy: 247/719 (34.3533%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 471/719 (65.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.1707, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0754, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0469, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.3163, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 416/1662 (25.0301%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0298, Accuracy: 723/1662 (43.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.6781, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0601, Accuracy: 231/636 (36.3208%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.6488, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.6297483444214
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3440, Accuracy: 161/10000 (1.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 1.1147, Accuracy: 9031/9950 (90.7638%)
saving model
Done in 500.64884185791016 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0764, Accuracy: 92/631 (14.5800%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0434, Accuracy: 292/631 (46.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.1002, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 459/1418 (32.3695%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0282, Accuracy: 756/1418 (53.3145%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.8426, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0657, Accuracy: 195/773 (25.2264%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0324, Accuracy: 439/773 (56.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.3898, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0616, Accuracy: 349/1427 (24.4569%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0310, Accuracy: 661/1427 (46.3210%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5116, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 164/953 (17.2088%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0355, Accuracy: 363/953 (38.0902%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.2849, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0648, Accuracy: 221/774 (28.5530%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0350, Accuracy: 386/774 (49.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.7264, Accuracy: 74/10000 (0.7400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 364/1657 (21.9674%)
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0321, Accuracy: 598/1657 (36.0893%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5868, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0509, Accuracy: 274/813 (33.7023%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0176, Accuracy: 487/813 (59.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.6255, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0875, Accuracy: 17/460 (3.6957%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0424, Accuracy: 189/460 (41.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.3222, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0877, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0748, Accuracy: 19/186 (10.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3765, Accuracy: 68/10000 (0.6800%)
time spent on training: 288.90459179878235
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3367, Accuracy: 163/10000 (1.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 1.1223, Accuracy: 9041/9950 (90.8643%)
saving model
Done in 530.0488681793213 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0571, Accuracy: 245/1013 (24.1856%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 522/1013 (51.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6232, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0641, Accuracy: 291/1163 (25.0215%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0349, Accuracy: 559/1163 (48.0653%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2758, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0635, Accuracy: 194/938 (20.6823%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0308, Accuracy: 394/938 (42.0043%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2383, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0745, Accuracy: 66/311 (21.2219%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 133/311 (42.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.0125, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0752, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0463, Accuracy: 157/373 (42.0912%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.2581, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 604/1470 (41.0884%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0223, Accuracy: 937/1470 (63.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.8876, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 213/776 (27.4485%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0273, Accuracy: 450/776 (57.9897%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2864, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1155, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.0986, Accuracy: 4/197 (2.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3540, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0610, Accuracy: 334/1427 (23.4057%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0311, Accuracy: 672/1427 (47.0918%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.6171, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0652, Accuracy: 237/946 (25.0529%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0346, Accuracy: 403/946 (42.6004%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.0330, Accuracy: 97/10000 (0.9700%)
time spent on training: 260.2074739933014
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3312, Accuracy: 164/10000 (1.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 1.1223, Accuracy: 9056/9950 (91.0151%)
saving model
Done in 503.2369792461395 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 373/1657 (22.5106%)
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0320, Accuracy: 602/1657 (36.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.7894, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0739, Accuracy: 66/311 (21.2219%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0531, Accuracy: 134/311 (43.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.9626, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0527, Accuracy: 490/1715 (28.5714%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0277, Accuracy: 892/1715 (52.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.7753, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 278/1049 (26.5014%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0260, Accuracy: 585/1049 (55.7674%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.0891, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0568, Accuracy: 266/1154 (23.0503%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 587/1154 (50.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.9102, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0503, Accuracy: 245/735 (33.3333%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0177, Accuracy: 456/735 (62.0408%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.1997, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 426/1956 (21.7791%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0288, Accuracy: 793/1956 (40.5419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.9986, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 301/813 (37.0234%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 485/813 (59.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.5534, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1162, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0976, Accuracy: 2/197 (1.0152%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3490, Accuracy: 111/10000 (1.1100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0478, Accuracy: 488/1129 (43.2241%)
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0202, Accuracy: 794/1129 (70.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.6560, Accuracy: 122/10000 (1.2200%)
time spent on training: 334.0767910480499
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3258, Accuracy: 162/10000 (1.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 1.1289, Accuracy: 9074/9950 (91.1960%)
saving model
Done in 570.8620140552521 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0585, Accuracy: 391/1587 (24.6377%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0324, Accuracy: 679/1587 (42.7851%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4860, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0541, Accuracy: 466/1904 (24.4748%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0275, Accuracy: 909/1904 (47.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.9185, Accuracy: 181/10000 (1.8100%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0502, Accuracy: 418/1036 (40.3475%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0213, Accuracy: 753/1036 (72.6834%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 11.3837, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0515, Accuracy: 428/1440 (29.7222%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 802/1440 (55.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4542, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0748, Accuracy: 98/631 (15.5309%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0437, Accuracy: 283/631 (44.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.1027, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1216, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1115, Accuracy: 9/134 (6.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3389, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0572, Accuracy: 349/1573 (22.1869%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0331, Accuracy: 652/1573 (41.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4297, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 279/896 (31.1384%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 481/896 (53.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3559, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0595, Accuracy: 388/1427 (27.1899%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0311, Accuracy: 651/1427 (45.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3774, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0530, Accuracy: 522/1953 (26.7281%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0300, Accuracy: 972/1953 (49.7696%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.5239, Accuracy: 164/10000 (1.6400%)
time spent on training: 342.36179542541504
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3168, Accuracy: 166/10000 (1.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 1.1613, Accuracy: 9049/9950 (90.9447%)
saving model
Done in 583.922905921936 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0468, Accuracy: 391/1275 (30.6667%)
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0162, Accuracy: 831/1275 (65.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.0370, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0586, Accuracy: 221/888 (24.8874%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0240, Accuracy: 465/888 (52.3649%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.2998, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0572, Accuracy: 351/1372 (25.5831%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0298, Accuracy: 609/1372 (44.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3887, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0563, Accuracy: 351/1573 (22.3140%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0328, Accuracy: 681/1573 (43.2931%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.3715, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 502/1953 (25.7040%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0296, Accuracy: 954/1953 (48.8479%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.4086, Accuracy: 155/10000 (1.5500%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0533, Accuracy: 463/1645 (28.1459%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0297, Accuracy: 767/1645 (46.6261%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.9218, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 278/1190 (23.3613%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0298, Accuracy: 503/1190 (42.2689%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.6354, Accuracy: 108/10000 (1.0800%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0416, Accuracy: 715/1628 (43.9189%)
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0196, Accuracy: 1020/1628 (62.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.8571, Accuracy: 176/10000 (1.7600%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0601, Accuracy: 228/776 (29.3814%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0266, Accuracy: 451/776 (58.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2116, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0666, Accuracy: 113/781 (14.4686%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0330, Accuracy: 288/781 (36.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.9900, Accuracy: 110/10000 (1.1000%)
time spent on training: 384.224835395813
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3106, Accuracy: 171/10000 (1.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 1.2015, Accuracy: 8995/9950 (90.4020%)
saving model
Done in 630.6611952781677 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0557, Accuracy: 325/1089 (29.8439%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0241, Accuracy: 607/1089 (55.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.1311, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0522, Accuracy: 474/1581 (29.9810%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0299, Accuracy: 748/1581 (47.3118%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.6788, Accuracy: 113/10000 (1.1300%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0547, Accuracy: 310/861 (36.0046%)
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0171, Accuracy: 538/861 (62.4855%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5294, Accuracy: 113/10000 (1.1300%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0716, Accuracy: 191/599 (31.8865%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 11.9087, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 291/896 (32.4777%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0324, Accuracy: 476/896 (53.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.1656, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0540, Accuracy: 362/928 (39.0086%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0200, Accuracy: 660/928 (71.1207%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.3439, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0607, Accuracy: 255/590 (43.2203%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.9412, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0604, Accuracy: 189/809 (23.3622%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0244, Accuracy: 421/809 (52.0396%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.9806, Accuracy: 124/10000 (1.2400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0700, Accuracy: 101/486 (20.7819%)
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0349, Accuracy: 217/486 (44.6502%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.7012, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0535, Accuracy: 444/1574 (28.2084%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0249, Accuracy: 799/1574 (50.7624%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.4024, Accuracy: 150/10000 (1.5000%)
time spent on training: 339.2456452846527
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3049, Accuracy: 170/10000 (1.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 1.2257, Accuracy: 8977/9950 (90.2211%)
saving model
Done in 579.530561208725 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0591, Accuracy: 370/1427 (25.9285%)
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0307, Accuracy: 663/1427 (46.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.6183, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0899, Accuracy: 7/271 (2.5830%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0600, Accuracy: 147/271 (54.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.8228, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0683, Accuracy: 160/603 (26.5340%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0414, Accuracy: 290/603 (48.0929%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.0992, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0583, Accuracy: 352/1513 (23.2650%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0334, Accuracy: 599/1513 (39.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.5422, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0623, Accuracy: 265/719 (36.8567%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.3426, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0685, Accuracy: 153/605 (25.2893%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.1632, Accuracy: 72/10000 (0.7200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0540, Accuracy: 275/690 (39.8551%)
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0220, Accuracy: 474/690 (68.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.1995, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0705, Accuracy: 144/530 (27.1698%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0351, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.2154, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0590, Accuracy: 330/1130 (29.2035%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0277, Accuracy: 505/1130 (44.6903%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.6036, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1141, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0965, Accuracy: 5/197 (2.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3252, Accuracy: 124/10000 (1.2400%)
time spent on training: 265.94576597213745
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3005, Accuracy: 171/10000 (1.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 1.2385, Accuracy: 8980/9950 (90.2513%)
saving model
Done in 508.6695342063904 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 305/1402 (21.7546%)
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0369, Accuracy: 498/1402 (35.5207%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.3321, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 294/1003 (29.3121%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 394/1003 (39.2822%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.4939, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0632, Accuracy: 179/953 (18.7828%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0353, Accuracy: 342/953 (35.8867%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.3281, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0570, Accuracy: 412/1587 (25.9609%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0322, Accuracy: 652/1587 (41.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.6535, Accuracy: 73/10000 (0.7300%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0472, Accuracy: 522/1129 (46.2356%)
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0200, Accuracy: 783/1129 (69.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4735, Accuracy: 120/10000 (1.2000%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0480, Accuracy: 429/1071 (40.0560%)
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0250, Accuracy: 619/1071 (57.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5764, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0818, Accuracy: 58/515 (11.2621%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0557, Accuracy: 187/515 (36.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.5950, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0657, Accuracy: 172/568 (30.2817%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0385, Accuracy: 267/568 (47.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.2013, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0559, Accuracy: 293/1154 (25.3899%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 555/1154 (48.0936%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.1714, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0518, Accuracy: 468/1581 (29.6015%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0297, Accuracy: 731/1581 (46.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.4740, Accuracy: 118/10000 (1.1800%)
time spent on training: 359.41332387924194
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.2976, Accuracy: 173/10000 (1.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 1.2364, Accuracy: 9003/9950 (90.4824%)
saving model
Done in 602.1254503726959 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0535, Accuracy: 425/1956 (21.7280%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0284, Accuracy: 783/1956 (40.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9136, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0658, Accuracy: 134/781 (17.1575%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0327, Accuracy: 306/781 (39.1805%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9681, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 512/1715 (29.8542%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0272, Accuracy: 899/1715 (52.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.7653, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0624, Accuracy: 307/901 (34.0733%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 433/901 (48.0577%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9184, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0532, Accuracy: 379/928 (40.8405%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0202, Accuracy: 651/928 (70.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.5044, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0883, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0500, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.1131, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0732, Accuracy: 127/631 (20.1268%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0435, Accuracy: 291/631 (46.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.1935, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0682, Accuracy: 164/605 (27.1074%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.1593, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0610, Accuracy: 250/590 (42.3729%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.5229, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0532, Accuracy: 448/1645 (27.2340%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0292, Accuracy: 798/1645 (48.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8148, Accuracy: 149/10000 (1.4900%)
time spent on training: 317.15696358680725
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.2922, Accuracy: 184/10000 (1.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 1.2425, Accuracy: 8988/9950 (90.3317%)
saving model
Done in 559.0903642177582 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0588, Accuracy: 375/1427 (26.2789%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0300, Accuracy: 704/1427 (49.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6637, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0584, Accuracy: 253/677 (37.3708%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.8580, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0599, Accuracy: 251/712 (35.2528%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0228, Accuracy: 458/712 (64.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9497, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0670, Accuracy: 175/605 (28.9256%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.1236, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0900, Accuracy: 7/271 (2.5830%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0595, Accuracy: 139/271 (51.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.8402, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0599, Accuracy: 192/809 (23.7330%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0240, Accuracy: 428/809 (52.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.0259, Accuracy: 127/10000 (1.2700%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0441, Accuracy: 778/1988 (39.1348%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0302, Accuracy: 932/1988 (46.8813%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6340, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0560, Accuracy: 344/1241 (27.7196%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0343, Accuracy: 489/1241 (39.4037%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5117, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0645, Accuracy: 154/781 (19.7183%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0329, Accuracy: 305/781 (39.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9572, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0708, Accuracy: 134/530 (25.2830%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0349, Accuracy: 279/530 (52.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9967, Accuracy: 69/10000 (0.6900%)
time spent on training: 331.8276426792145
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.2925, Accuracy: 180/10000 (1.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 1.2593, Accuracy: 8951/9950 (89.9598%)
saving model
Done in 578.7078375816345 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0572, Accuracy: 291/891 (32.6599%)
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 471/891 (52.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.2829, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0664, Accuracy: 166/669 (24.8132%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0366, Accuracy: 364/669 (54.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.8588, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0568, Accuracy: 349/1372 (25.4373%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0293, Accuracy: 601/1372 (43.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1847, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0492, Accuracy: 389/1213 (32.0692%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0244, Accuracy: 622/1213 (51.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.8027, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 302/1131 (26.7020%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0298, Accuracy: 462/1131 (40.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.9788, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0752, Accuracy: 36/373 (9.6515%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0464, Accuracy: 156/373 (41.8231%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.2671, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0466, Accuracy: 405/1275 (31.7647%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0162, Accuracy: 808/1275 (63.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9487, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0514, Accuracy: 242/735 (32.9252%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0176, Accuracy: 451/735 (61.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.1837, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0722, Accuracy: 133/631 (21.0777%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0419, Accuracy: 292/631 (46.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.9682, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0853, Accuracy: 26/460 (5.6522%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0407, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.3658, Accuracy: 50/10000 (0.5000%)
time spent on training: 284.4006485939026
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.2907, Accuracy: 179/10000 (1.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 1.2433, Accuracy: 9008/9950 (90.5327%)
saving model
Done in 523.0527613162994 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0621, Accuracy: 185/953 (19.4124%)
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0353, Accuracy: 369/953 (38.7198%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.2208, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 41/500 (8.2000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 211/500 (42.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.7619, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0756, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.7311, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0628, Accuracy: 209/938 (22.2814%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0308, Accuracy: 414/938 (44.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.0521, Accuracy: 90/10000 (0.9000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0696, Accuracy: 204/599 (34.0568%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0249, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 11.9645, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0596, Accuracy: 295/1190 (24.7899%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0282, Accuracy: 547/1190 (45.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.6228, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0496, Accuracy: 432/1036 (41.6988%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0211, Accuracy: 750/1036 (72.3938%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 11.0378, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0512, Accuracy: 435/1440 (30.2083%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0249, Accuracy: 830/1440 (57.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4299, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0552, Accuracy: 262/1013 (25.8638%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0248, Accuracy: 518/1013 (51.1352%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.5533, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 335/1446 (23.1674%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0328, Accuracy: 591/1446 (40.8714%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.4177, Accuracy: 98/10000 (0.9800%)
time spent on training: 345.17158007621765
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.2868, Accuracy: 184/10000 (1.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 1.2243, Accuracy: 9059/9950 (91.0452%)
saving model
Done in 584.7578122615814 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0631, Accuracy: 326/1163 (28.0310%)
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0346, Accuracy: 558/1163 (47.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.1203, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0513, Accuracy: 501/1581 (31.6888%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0298, Accuracy: 746/1581 (47.1853%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.3697, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 292/803 (36.3636%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 452/803 (56.2889%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.9835, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0616, Accuracy: 265/719 (36.8567%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.4745, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0776, Accuracy: 64/416 (15.3846%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0425, Accuracy: 235/416 (56.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.6059, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0514, Accuracy: 469/1440 (32.5694%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0250, Accuracy: 823/1440 (57.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.3059, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 447/1662 (26.8953%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0295, Accuracy: 723/1662 (43.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.7063, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0661, Accuracy: 179/669 (26.7564%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0363, Accuracy: 362/669 (54.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.0619, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0631, Accuracy: 216/938 (23.0277%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0307, Accuracy: 416/938 (44.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.1970, Accuracy: 84/10000 (0.8400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0525, Accuracy: 397/1154 (34.4021%)
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0240, Accuracy: 638/1154 (55.2860%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.6031, Accuracy: 116/10000 (1.1600%)
time spent on training: 348.52093482017517
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.2828, Accuracy: 180/10000 (1.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 1.2309, Accuracy: 9083/9950 (91.2864%)
saving model
Done in 590.8553085327148 sec.
Saving all the graphs.
This run has a label: Jun.16_12.14.41. Visdom environment: tiny
