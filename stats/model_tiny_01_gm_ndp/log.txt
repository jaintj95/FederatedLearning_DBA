current path: saved_models/model_tiny_Jun.27_07.36.27
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 430/1953 (22.0174%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 766/1953 (39.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2349, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 679/1988 (34.1549%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1494, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.3066, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7914, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 334/1130 (29.5575%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 482/1130 (42.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 239/1071 (22.3156%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 472/1071 (44.0710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7101, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 624/1587 (39.3195%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2127, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 444/1715 (25.8892%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 710/1715 (41.3994%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4599, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 377/1154 (32.6690%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5260, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5567, Accuracy: 50/10000 (0.5000%)
time spent on training: 92.00742197036743
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 85, 64, 95, 54, 55, 27, 92, 15, 78], weight: tensor([0.1554, 0.1582, 0.0758, 0.0477, 0.0899, 0.0852, 0.1263, 0.1365, 0.0918,
        0.0331])
[rfa agg] iter:  0, prev_obj_val: 62.14203643798828, obj_val: 65.56404113769531, abs dis: 3.4220046997070312
[rfa agg] iter: 0, weight: tensor([0.0802, 0.0742, 0.0650, 0.0224, 0.1474, 0.1076, 0.1593, 0.1165, 0.2152,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 65.56404113769531, obj_val: 73.20126342773438, abs dis: 7.6372222900390625
[rfa agg] iter: 1, weight: tensor([0.0421, 0.0395, 0.0606, 0.0172, 0.2153, 0.1266, 0.0679, 0.0553, 0.3665,
        0.0089])
[rfa agg] iter:  2, prev_obj_val: 73.20126342773438, obj_val: 73.07551574707031, abs dis: 0.1257476806640625
[rfa agg] iter: 2, weight: tensor([0.0368, 0.0350, 0.1160, 0.0225, 0.2259, 0.3104, 0.0521, 0.0452, 0.1451,
        0.0109])
[rfa agg] iter:  3, prev_obj_val: 73.07551574707031, obj_val: 73.06794738769531, abs dis: 0.007568359375
[rfa agg] iter: 3, weight: tensor([0.0337, 0.0320, 0.1073, 0.0206, 0.2099, 0.3703, 0.0477, 0.0413, 0.1273,
        0.0100])
[rfa agg] iter:  4, prev_obj_val: 73.06794738769531, obj_val: 73.06673431396484, abs dis: 0.00121307373046875
[rfa agg] iter: 4, weight: tensor([0.0327, 0.0311, 0.1037, 0.0200, 0.2006, 0.3931, 0.0462, 0.0401, 0.1228,
        0.0097])
[rfa agg] iter:  5, prev_obj_val: 73.06673431396484, obj_val: 75.80718231201172, abs dis: 2.740447998046875
[rfa agg] iter: 5, weight: tensor([0.0323, 0.0306, 0.1022, 0.0197, 0.1966, 0.4028, 0.0456, 0.0396, 0.1210,
        0.0096])
[rfa agg] iter:  6, prev_obj_val: 75.80718231201172, obj_val: 73.07131958007812, abs dis: 2.7358627319335938
[rfa agg] iter: 6, weight: tensor([0.0359, 0.0342, 0.1486, 0.0244, 0.1732, 0.3640, 0.0495, 0.0434, 0.1153,
        0.0116])
[rfa agg] iter:  7, prev_obj_val: 73.07131958007812, obj_val: 73.0666732788086, abs dis: 0.00464630126953125
[rfa agg] iter: 7, weight: tensor([0.0328, 0.0311, 0.1047, 0.0200, 0.1979, 0.3944, 0.0463, 0.0402, 0.1229,
        0.0097])
[rfa agg] iter:  8, prev_obj_val: 73.0666732788086, obj_val: 75.80724334716797, abs dis: 2.740570068359375
[rfa agg] iter: 8, weight: tensor([0.0322, 0.0306, 0.1021, 0.0197, 0.1961, 0.4036, 0.0456, 0.0395, 0.1209,
        0.0096])
[rfa agg] iter:  9, prev_obj_val: 75.80724334716797, obj_val: 73.07129669189453, abs dis: 2.7359466552734375
[rfa agg] iter: 9, weight: tensor([0.0359, 0.0342, 0.1485, 0.0244, 0.1731, 0.3642, 0.0495, 0.0434, 0.1153,
        0.0116])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3405, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.7873113155365 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5696, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1226, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1146, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3141, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 336/946 (35.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.0014, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7481, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3967, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0829, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4760, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 310/1190 (26.0504%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 439/1190 (36.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0220, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 386/1581 (24.4149%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 599/1581 (37.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5414, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0555, Accuracy: 391/1956 (19.9898%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 654/1956 (33.4356%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1718, Accuracy: 109/10000 (1.0900%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 364/1574 (23.1258%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 641/1574 (40.7243%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0140, Accuracy: 94/10000 (0.9400%)
time spent on training: 135.16004967689514
[rfa agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.05053164166837888
[rfa agg] init. name: [64, 47, 43, 23, 24, 98, 84, 28, 6, 17], weight: tensor([0.0979, 0.0138, 0.0972, 0.0735, 0.0321, 0.0383, 0.1223, 0.1624, 0.2009,
        0.1617])
[rfa agg] iter:  0, prev_obj_val: 63.5233154296875, obj_val: 65.79754638671875, abs dis: 2.27423095703125
[rfa agg] iter: 0, weight: tensor([0.1098, 0.0035, 0.1091, 0.0452, 0.0095, 0.0123, 0.4468, 0.0997, 0.0647,
        0.0993])
[rfa agg] iter:  1, prev_obj_val: 65.79754638671875, obj_val: 68.46824645996094, abs dis: 2.6707000732421875
[rfa agg] iter: 1, weight: tensor([0.1614, 0.0041, 0.1630, 0.0580, 0.0112, 0.0146, 0.3336, 0.0945, 0.0654,
        0.0941])
[rfa agg] iter:  2, prev_obj_val: 68.46824645996094, obj_val: 69.85012817382812, abs dis: 1.3818817138671875
[rfa agg] iter: 2, weight: tensor([0.2391, 0.0042, 0.2451, 0.0676, 0.0117, 0.0153, 0.1987, 0.0802, 0.0584,
        0.0798])
[rfa agg] iter:  3, prev_obj_val: 69.85012817382812, obj_val: 71.37886047363281, abs dis: 1.5287322998046875
[rfa agg] iter: 3, weight: tensor([0.2861, 0.0038, 0.2951, 0.0658, 0.0106, 0.0140, 0.1439, 0.0659, 0.0491,
        0.0656])
[rfa agg] iter:  4, prev_obj_val: 71.37886047363281, obj_val: 75.73863220214844, abs dis: 4.359771728515625
[rfa agg] iter: 4, weight: tensor([0.3296, 0.0032, 0.3486, 0.0599, 0.0089, 0.0118, 0.0997, 0.0501, 0.0382,
        0.0500])
[rfa agg] iter:  5, prev_obj_val: 75.73863220214844, obj_val: 75.73709869384766, abs dis: 0.00153350830078125
[rfa agg] iter: 5, weight: tensor([0.3361, 0.0034, 0.3543, 0.0804, 0.0097, 0.0130, 0.0777, 0.0450, 0.0356,
        0.0449])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.2997, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.2926, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.37658882141113 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.0025, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 455/891 (51.0662%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2751, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 436/1190 (36.6387%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9801, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0559, Accuracy: 334/1662 (20.0963%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 582/1662 (35.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8951, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0586, Accuracy: 300/1645 (18.2371%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 616/1645 (37.4468%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0854, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6589, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0564, Accuracy: 280/590 (47.4576%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 415/1742 (23.8232%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 712/1742 (40.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8381, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 225/861 (26.1324%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 457/861 (53.0778%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1271, Accuracy: 53/10000 (0.5300%)
time spent on training: 129.06056189537048
[rfa agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 58, 7, 84, 94, 13, 3, 69, 93, 10], weight: tensor([0.0709, 0.0734, 0.0814, 0.1088, 0.1519, 0.1504, 0.0714, 0.0539, 0.1592,
        0.0787])
[rfa agg] iter:  0, prev_obj_val: 58.218021392822266, obj_val: 60.20103073120117, abs dis: 1.9830093383789062
[rfa agg] iter: 0, weight: tensor([0.0844, 0.0873, 0.1227, 0.2294, 0.0813, 0.0804, 0.0844, 0.0371, 0.0698,
        0.1233])
[rfa agg] iter:  1, prev_obj_val: 60.20103073120117, obj_val: 70.60741424560547, abs dis: 10.406383514404297
[rfa agg] iter: 1, weight: tensor([0.1070, 0.1106, 0.1721, 0.1176, 0.0566, 0.0560, 0.1061, 0.0382, 0.0499,
        0.1858])
[rfa agg] iter:  2, prev_obj_val: 70.60741424560547, obj_val: 70.54348754882812, abs dis: 0.06392669677734375
[rfa agg] iter: 2, weight: tensor([0.2087, 0.2085, 0.1113, 0.0406, 0.0276, 0.0273, 0.1811, 0.0509, 0.0252,
        0.1187])
[rfa agg] iter:  3, prev_obj_val: 70.54348754882812, obj_val: 78.0362777709961, abs dis: 7.492790222167969
[rfa agg] iter: 3, weight: tensor([0.2181, 0.2145, 0.1049, 0.0388, 0.0265, 0.0262, 0.1857, 0.0489, 0.0242,
        0.1124])
[rfa agg] iter:  4, prev_obj_val: 78.0362777709961, obj_val: 64.91008758544922, abs dis: 13.126190185546875
[rfa agg] iter: 4, weight: tensor([0.1639, 0.1675, 0.1114, 0.0531, 0.0388, 0.0384, 0.1580, 0.1205, 0.0357,
        0.1126])
[rfa agg] iter:  5, prev_obj_val: 64.91008758544922, obj_val: 74.21221160888672, abs dis: 9.3021240234375
[rfa agg] iter: 5, weight: tensor([0.1848, 0.1813, 0.1419, 0.0395, 0.0247, 0.0245, 0.1602, 0.0309, 0.0224,
        0.1898])
[rfa agg] iter:  6, prev_obj_val: 74.21221160888672, obj_val: 78.0308837890625, abs dis: 3.8186721801757812
[rfa agg] iter: 6, weight: tensor([0.1875, 0.1891, 0.1121, 0.0472, 0.0334, 0.0330, 0.1735, 0.0780, 0.0306,
        0.1156])
[rfa agg] iter:  7, prev_obj_val: 78.0308837890625, obj_val: 64.91023254394531, abs dis: 13.120651245117188
[rfa agg] iter: 7, weight: tensor([0.1634, 0.1670, 0.1115, 0.0532, 0.0388, 0.0384, 0.1579, 0.1212, 0.0358,
        0.1128])
[rfa agg] iter:  8, prev_obj_val: 64.91023254394531, obj_val: 74.21221160888672, abs dis: 9.301979064941406
[rfa agg] iter: 8, weight: tensor([0.1848, 0.1813, 0.1419, 0.0395, 0.0248, 0.0245, 0.1602, 0.0309, 0.0224,
        0.1898])
[rfa agg] iter:  9, prev_obj_val: 74.21221160888672, obj_val: 78.0308837890625, abs dis: 3.8186721801757812
[rfa agg] iter: 9, weight: tensor([0.1875, 0.1891, 0.1121, 0.0472, 0.0334, 0.0330, 0.1735, 0.0780, 0.0306,
        0.1156])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3014, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3020, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.52058625221252 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 332/807 (41.1400%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 436/807 (54.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6140, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0625, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 335/953 (35.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4649, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 51/460 (11.0870%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0616, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6478, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0558, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 643/1956 (32.8732%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.1236, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0624, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0560, Accuracy: 315/1573 (20.0254%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 593/1573 (37.6987%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4084, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/1049 (46.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5686, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0892, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.5174, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0554, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.3553, Accuracy: 52/10000 (0.5200%)
time spent on training: 128.114586353302
[rfa agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 64, 31, 75, 6, 23, 40, 51, 12, 63], weight: tensor([0.0848, 0.1002, 0.0483, 0.0816, 0.2056, 0.0751, 0.1653, 0.1102, 0.0355,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 59.55649948120117, obj_val: 59.95410919189453, abs dis: 0.3976097106933594
[rfa agg] iter: 0, weight: tensor([0.0778, 0.2015, 0.0187, 0.0755, 0.0468, 0.0544, 0.0639, 0.3320, 0.0111,
        0.1183])
[rfa agg] iter:  1, prev_obj_val: 59.95410919189453, obj_val: 69.92814636230469, abs dis: 9.974037170410156
[rfa agg] iter: 1, weight: tensor([0.1117, 0.2934, 0.0169, 0.1106, 0.0285, 0.0649, 0.0359, 0.0974, 0.0095,
        0.2311])
[rfa agg] iter:  2, prev_obj_val: 69.92814636230469, obj_val: 76.7358627319336, abs dis: 6.807716369628906
[rfa agg] iter: 2, weight: tensor([0.1811, 0.0911, 0.0328, 0.1851, 0.0299, 0.2453, 0.0351, 0.0600, 0.0162,
        0.1234])
[rfa agg] iter:  3, prev_obj_val: 76.7358627319336, obj_val: 76.73355102539062, abs dis: 0.00231170654296875
[rfa agg] iter: 3, weight: tensor([0.1532, 0.0955, 0.0603, 0.1500, 0.0397, 0.2412, 0.0456, 0.0701, 0.0270,
        0.1174])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3031, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.2923, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.82828783988953 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3144, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3912, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 467/1130 (41.3274%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.4731, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 547/928 (58.9440%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6819, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 525/1049 (50.0477%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5581, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 430/807 (53.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 377/1904 (19.8004%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 693/1904 (36.3971%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6672, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 472/1715 (27.5219%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 710/1715 (41.3994%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6385, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7085, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8082, Accuracy: 56/10000 (0.5600%)
time spent on training: 130.3211100101471
[rfa agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 96, 54, 1, 51, 20, 46, 92, 90, 82], weight: tensor([0.0093, 0.0342, 0.1241, 0.1019, 0.1152, 0.0886, 0.2091, 0.1883, 0.0743,
        0.0549])
[rfa agg] iter:  0, prev_obj_val: 61.90904998779297, obj_val: 64.07553100585938, abs dis: 2.1664810180664062
[rfa agg] iter: 0, weight: tensor([0.0017, 0.0077, 0.3691, 0.1091, 0.3069, 0.0546, 0.0470, 0.0556, 0.0321,
        0.0163])
[rfa agg] iter:  1, prev_obj_val: 64.07553100585938, obj_val: 68.6082534790039, abs dis: 4.532722473144531
[rfa agg] iter: 1, weight: tensor([0.0021, 0.0097, 0.1872, 0.2497, 0.2931, 0.0895, 0.0470, 0.0537, 0.0464,
        0.0216])
[rfa agg] iter:  2, prev_obj_val: 68.6082534790039, obj_val: 72.83171081542969, abs dis: 4.223457336425781
[rfa agg] iter: 2, weight: tensor([0.0023, 0.0113, 0.1098, 0.3896, 0.1409, 0.1632, 0.0427, 0.0476, 0.0660,
        0.0266])
[rfa agg] iter:  3, prev_obj_val: 72.83171081542969, obj_val: 75.10967254638672, abs dis: 2.2779617309570312
[rfa agg] iter: 3, weight: tensor([0.0028, 0.0138, 0.0941, 0.2220, 0.1110, 0.3307, 0.0438, 0.0482, 0.0993,
        0.0343])
[rfa agg] iter:  4, prev_obj_val: 75.10967254638672, obj_val: 77.7515640258789, abs dis: 2.6418914794921875
[rfa agg] iter: 4, weight: tensor([0.0025, 0.0130, 0.0753, 0.1476, 0.0864, 0.4543, 0.0377, 0.0412, 0.1087,
        0.0333])
[rfa agg] iter:  5, prev_obj_val: 77.7515640258789, obj_val: 77.7492904663086, abs dis: 0.0022735595703125
[rfa agg] iter: 5, weight: tensor([0.0029, 0.0149, 0.0739, 0.1286, 0.0830, 0.4238, 0.0395, 0.0429, 0.1507,
        0.0398])
[rfa agg] iter:  6, prev_obj_val: 77.7492904663086, obj_val: 80.6065902709961, abs dis: 2.8572998046875
[rfa agg] iter: 6, weight: tensor([0.0029, 0.0150, 0.0744, 0.1294, 0.0836, 0.4185, 0.0398, 0.0432, 0.1531,
        0.0401])
[rfa agg] iter:  7, prev_obj_val: 80.6065902709961, obj_val: 83.52104187011719, abs dis: 2.9144515991210938
[rfa agg] iter: 7, weight: tensor([0.0035, 0.0184, 0.0782, 0.1253, 0.0865, 0.3023, 0.0443, 0.0478, 0.2424,
        0.0515])
[rfa agg] iter:  8, prev_obj_val: 83.52104187011719, obj_val: 80.60346221923828, abs dis: 2.9175796508789062
[rfa agg] iter: 8, weight: tensor([0.0035, 0.0191, 0.0702, 0.1052, 0.0766, 0.2034, 0.0418, 0.0449, 0.3783,
        0.0569])
[rfa agg] iter:  9, prev_obj_val: 80.60346221923828, obj_val: 83.51632690429688, abs dis: 2.9128646850585938
[rfa agg] iter: 9, weight: tensor([0.0035, 0.0184, 0.0785, 0.1257, 0.0868, 0.2807, 0.0444, 0.0480, 0.2621,
        0.0519])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3052, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.2927, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.7514135837555 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0606, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.6921, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 331/1190 (27.8151%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 477/1190 (40.0840%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2658, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 685/1742 (39.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4166, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 337/1662 (20.2768%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 605/1662 (36.4019%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2865, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0530, Accuracy: 273/1071 (25.4902%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2856, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 440/1988 (22.1328%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3065, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 273/636 (42.9245%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.6371, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0612, Accuracy: 199/735 (27.0748%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 336/735 (45.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.4695, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 329/946 (34.7780%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.0934, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 325/599 (54.2571%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.6376, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.79672050476074
[rfa agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 84, 93, 94, 55, 85, 52, 32, 43, 95], weight: tensor([0.0637, 0.1054, 0.1543, 0.1472, 0.0949, 0.1761, 0.0563, 0.0651, 0.0838,
        0.0531])
[rfa agg] iter:  0, prev_obj_val: 64.94267272949219, obj_val: 68.07957458496094, abs dis: 3.13690185546875
[rfa agg] iter: 0, weight: tensor([0.0353, 0.4278, 0.0754, 0.0937, 0.1487, 0.0586, 0.0247, 0.0361, 0.0764,
        0.0233])
[rfa agg] iter:  1, prev_obj_val: 68.07957458496094, obj_val: 70.77298736572266, abs dis: 2.6934127807617188
[rfa agg] iter: 1, weight: tensor([0.0460, 0.1854, 0.0511, 0.0595, 0.3733, 0.0428, 0.0293, 0.0471, 0.1378,
        0.0276])
[rfa agg] iter:  2, prev_obj_val: 70.77298736572266, obj_val: 76.27930450439453, abs dis: 5.506317138671875
[rfa agg] iter: 2, weight: tensor([0.0593, 0.1283, 0.0487, 0.0557, 0.3022, 0.0417, 0.0355, 0.0609, 0.2345,
        0.0333])
[rfa agg] iter:  3, prev_obj_val: 76.27930450439453, obj_val: 80.79659271240234, abs dis: 4.5172882080078125
[rfa agg] iter: 3, weight: tensor([0.0949, 0.0898, 0.0446, 0.0499, 0.1425, 0.0392, 0.0484, 0.0980, 0.3472,
        0.0455])
[rfa agg] iter:  4, prev_obj_val: 80.79659271240234, obj_val: 80.77268981933594, abs dis: 0.02390289306640625
[rfa agg] iter: 4, weight: tensor([0.1595, 0.0801, 0.0450, 0.0498, 0.1113, 0.0402, 0.0668, 0.1672, 0.2172,
        0.0630])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3073, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.2591, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.04355931282043 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 454/1130 (40.1770%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3563, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 569/2227 (25.5501%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1017/2227 (45.6668%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.7416, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0588, Accuracy: 216/735 (29.3878%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 375/735 (51.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4281, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0584, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0396, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.8706, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0568, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3253, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 277/636 (43.5535%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0397, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0971, Accuracy: 26/197 (13.1980%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3697, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 414/1953 (21.1982%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 768/1953 (39.3241%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.6669, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 367/1275 (28.7843%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 715/1275 (56.0784%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.3399, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 425/677 (62.7770%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7779, Accuracy: 55/10000 (0.5500%)
time spent on training: 137.70734119415283
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 60, 32, 23, 69, 52, 79, 83, 9, 90], weight: tensor([0.1115, 0.2197, 0.0725, 0.0705, 0.0582, 0.0628, 0.0194, 0.1927, 0.1258,
        0.0668])
[rfa agg] iter:  0, prev_obj_val: 81.14297485351562, obj_val: 83.34003448486328, abs dis: 2.1970596313476562
[rfa agg] iter: 0, weight: tensor([0.1977, 0.0571, 0.0353, 0.0343, 0.0227, 0.0244, 0.0047, 0.0682, 0.5267,
        0.0289])
[rfa agg] iter:  1, prev_obj_val: 83.34003448486328, obj_val: 86.9429931640625, abs dis: 3.6029586791992188
[rfa agg] iter: 1, weight: tensor([0.4513, 0.0531, 0.0551, 0.0537, 0.0327, 0.0352, 0.0061, 0.0604, 0.2091,
        0.0433])
[rfa agg] iter:  2, prev_obj_val: 86.9429931640625, obj_val: 88.24501037597656, abs dis: 1.3020172119140625
[rfa agg] iter: 2, weight: tensor([0.3007, 0.0646, 0.0995, 0.0966, 0.0539, 0.0580, 0.0090, 0.0718, 0.1719,
        0.0740])
[rfa agg] iter:  3, prev_obj_val: 88.24501037597656, obj_val: 90.92459106445312, abs dis: 2.6795806884765625
[rfa agg] iter: 3, weight: tensor([0.2497, 0.0653, 0.1178, 0.1143, 0.0610, 0.0656, 0.0098, 0.0720, 0.1593,
        0.0853])
[rfa agg] iter:  4, prev_obj_val: 90.92459106445312, obj_val: 90.91835021972656, abs dis: 0.0062408447265625
[rfa agg] iter: 4, weight: tensor([0.1750, 0.0601, 0.1566, 0.1516, 0.0718, 0.0771, 0.0103, 0.0654, 0.1267,
        0.1054])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3096, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.2108, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.22300362586975 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0617, Accuracy: 181/953 (18.9927%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0370, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6750, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0367, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8897, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0881, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6738, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 380/1657 (22.9330%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 477/1657 (28.7870%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2185, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 374/803 (46.5753%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2988, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 398/1581 (25.1739%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 618/1581 (39.0892%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9677, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0688, Accuracy: 196/669 (29.2975%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0471, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0616, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0382, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 335/712 (47.0506%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0283, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.9245, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 146/568 (25.7042%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0112, Accuracy: 58/10000 (0.5800%)
time spent on training: 137.3525984287262
[rfa agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 23, 12, 0, 58, 28, 45, 16, 11, 62], weight: tensor([0.1095, 0.0821, 0.0388, 0.1904, 0.0923, 0.1816, 0.0769, 0.0813, 0.0818,
        0.0653])
[rfa agg] iter:  0, prev_obj_val: 53.14336395263672, obj_val: 57.51152038574219, abs dis: 4.368156433105469
[rfa agg] iter: 0, weight: tensor([0.2523, 0.1072, 0.0135, 0.0443, 0.2170, 0.0460, 0.0696, 0.1069, 0.1069,
        0.0363])
[rfa agg] iter:  1, prev_obj_val: 57.51152038574219, obj_val: 66.7292709350586, abs dis: 9.217750549316406
[rfa agg] iter: 1, weight: tensor([0.0602, 0.1747, 0.0137, 0.0255, 0.1125, 0.0262, 0.1678, 0.1889, 0.1808,
        0.0497])
[rfa agg] iter:  2, prev_obj_val: 66.7292709350586, obj_val: 70.20130920410156, abs dis: 3.4720382690429688
[rfa agg] iter: 2, weight: tensor([0.0669, 0.1199, 0.0295, 0.0366, 0.0928, 0.0373, 0.1998, 0.1195, 0.1195,
        0.1782])
[rfa agg] iter:  3, prev_obj_val: 70.20130920410156, obj_val: 70.19241333007812, abs dis: 0.0088958740234375
[rfa agg] iter: 3, weight: tensor([0.0619, 0.0993, 0.0342, 0.0361, 0.0813, 0.0367, 0.1492, 0.0984, 0.0987,
        0.3041])
[rfa agg] iter:  4, prev_obj_val: 70.19241333007812, obj_val: 70.19227600097656, abs dis: 0.0001373291015625
[rfa agg] iter: 4, weight: tensor([0.0607, 0.0971, 0.0336, 0.0354, 0.0797, 0.0359, 0.1449, 0.0963, 0.0965,
        0.3198])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3121, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.2008, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.1503129005432 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 726/1129 (64.3047%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2945, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 314/1190 (26.3866%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4150, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 561/2227 (25.1908%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1033/2227 (46.3853%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3791, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0884, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6805, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0589, Accuracy: 290/1131 (25.6410%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 388/1131 (34.3059%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9798, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 14/373 (3.7534%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6879, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0589, Accuracy: 246/1049 (23.4509%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 491/1049 (46.8065%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7019, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.9485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0856, Accuracy: 100/408 (24.5098%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0547, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.7138, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 469/1715 (27.3469%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 697/1715 (40.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1405, Accuracy: 93/10000 (0.9300%)
time spent on training: 145.00939297676086
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 84, 60, 12, 87, 98, 51, 76, 36, 92], weight: tensor([0.1126, 0.1187, 0.2221, 0.0337, 0.1128, 0.0372, 0.1046, 0.0465, 0.0407,
        0.1711])
[rfa agg] iter:  0, prev_obj_val: 67.79593658447266, obj_val: 71.66770935058594, abs dis: 3.8717727661132812
[rfa agg] iter: 0, weight: tensor([0.1922, 0.3092, 0.0461, 0.0080, 0.2128, 0.0089, 0.1264, 0.0130, 0.0105,
        0.0729])
[rfa agg] iter:  1, prev_obj_val: 71.66770935058594, obj_val: 74.0033187866211, abs dis: 2.3356094360351562
[rfa agg] iter: 1, weight: tensor([0.2092, 0.1461, 0.0333, 0.0083, 0.2349, 0.0091, 0.2884, 0.0139, 0.0110,
        0.0459])
[rfa agg] iter:  2, prev_obj_val: 74.0033187866211, obj_val: 76.75469970703125, abs dis: 2.7513809204101562
[rfa agg] iter: 2, weight: tensor([0.1884, 0.1311, 0.0363, 0.0097, 0.2023, 0.0107, 0.3429, 0.0165, 0.0129,
        0.0491])
[rfa agg] iter:  3, prev_obj_val: 76.75469970703125, obj_val: 71.52681732177734, abs dis: 5.227882385253906
[rfa agg] iter: 3, weight: tensor([0.1856, 0.1374, 0.0434, 0.0125, 0.1946, 0.0138, 0.3169, 0.0215, 0.0168,
        0.0575])
[rfa agg] iter:  4, prev_obj_val: 71.52681732177734, obj_val: 76.7562484741211, abs dis: 5.22943115234375
[rfa agg] iter: 4, weight: tensor([0.1927, 0.1275, 0.0305, 0.0076, 0.2175, 0.0083, 0.3512, 0.0127, 0.0100,
        0.0420])
[rfa agg] iter:  5, prev_obj_val: 76.7562484741211, obj_val: 71.52674102783203, abs dis: 5.2295074462890625
[rfa agg] iter: 5, weight: tensor([0.1856, 0.1371, 0.0434, 0.0125, 0.1946, 0.0138, 0.3174, 0.0215, 0.0167,
        0.0575])
[rfa agg] iter:  6, prev_obj_val: 71.52674102783203, obj_val: 76.75627136230469, abs dis: 5.229530334472656
[rfa agg] iter: 6, weight: tensor([0.1926, 0.1275, 0.0305, 0.0076, 0.2174, 0.0083, 0.3514, 0.0127, 0.0100,
        0.0420])
[rfa agg] iter:  7, prev_obj_val: 76.75627136230469, obj_val: 71.5267333984375, abs dis: 5.2295379638671875
[rfa agg] iter: 7, weight: tensor([0.1856, 0.1371, 0.0434, 0.0125, 0.1946, 0.0138, 0.3174, 0.0215, 0.0167,
        0.0575])
[rfa agg] iter:  8, prev_obj_val: 71.5267333984375, obj_val: 76.75626373291016, abs dis: 5.229530334472656
[rfa agg] iter: 8, weight: tensor([0.1926, 0.1275, 0.0305, 0.0076, 0.2174, 0.0083, 0.3514, 0.0127, 0.0100,
        0.0420])
[rfa agg] iter:  9, prev_obj_val: 76.75626373291016, obj_val: 71.52674102783203, abs dis: 5.229522705078125
[rfa agg] iter: 9, weight: tensor([0.1855, 0.1371, 0.0434, 0.0125, 0.1946, 0.0138, 0.3174, 0.0215, 0.0167,
        0.0575])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3146, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.1893, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.58544826507568 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 156/818 (19.0709%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7699, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 364/1013 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9527, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0524, Accuracy: 291/1071 (27.1709%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 511/1071 (47.7124%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1969, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0584, Accuracy: 327/946 (34.5666%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0352, Accuracy: 381/946 (40.2748%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.3594, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6426, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 75/486 (15.4321%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0397, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.3705, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0807, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0657, Accuracy: 79/186 (42.4731%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3554, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 53/311 (17.0418%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4549, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 19/373 (5.0938%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7367, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 354/1628 (21.7445%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 843/1628 (51.7813%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6503, Accuracy: 147/10000 (1.4700%)
time spent on training: 129.81967496871948
[rfa agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 14, 55, 43, 88, 30, 56, 96, 98, 5], weight: tensor([0.1100, 0.1362, 0.1440, 0.1272, 0.0811, 0.0654, 0.0250, 0.0418, 0.0502,
        0.2190])
[rfa agg] iter:  0, prev_obj_val: 51.251220703125, obj_val: 54.876953125, abs dis: 3.625732421875
[rfa agg] iter: 0, weight: tensor([0.4296, 0.1208, 0.0961, 0.1604, 0.0716, 0.0354, 0.0068, 0.0142, 0.0194,
        0.0458])
[rfa agg] iter:  1, prev_obj_val: 54.876953125, obj_val: 56.94369888305664, abs dis: 2.0667457580566406
[rfa agg] iter: 1, weight: tensor([0.3468, 0.1153, 0.0975, 0.1413, 0.1314, 0.0557, 0.0095, 0.0204, 0.0286,
        0.0536])
[rfa agg] iter:  2, prev_obj_val: 56.94369888305664, obj_val: 59.046180725097656, abs dis: 2.1024818420410156
[rfa agg] iter: 2, weight: tensor([0.2656, 0.1140, 0.0985, 0.1352, 0.1889, 0.0704, 0.0111, 0.0243, 0.0345,
        0.0574])
[rfa agg] iter:  3, prev_obj_val: 59.046180725097656, obj_val: 59.039920806884766, abs dis: 0.006259918212890625
[rfa agg] iter: 3, weight: tensor([0.2035, 0.1035, 0.0912, 0.1198, 0.2670, 0.0826, 0.0119, 0.0265, 0.0382,
        0.0559])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3171, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.1895, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.79365611076355 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0785, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.6540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0798, Accuracy: 67/416 (16.1058%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0453, Accuracy: 203/416 (48.7981%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.0260, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 432/1440 (30.0000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 653/1440 (45.3472%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1012, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0517, Accuracy: 380/1628 (23.3415%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 802/1628 (49.2629%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9546, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 474/1715 (27.6385%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 735/1715 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1813, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0552, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 400/712 (56.1798%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5046, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0562, Accuracy: 323/1131 (28.5588%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3617, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0558, Accuracy: 232/861 (26.9454%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 445/861 (51.6841%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3659, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 521/1446 (36.0304%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3819, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 317/1645 (19.2705%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.2342, Accuracy: 125/10000 (1.2500%)
time spent on training: 149.10394048690796
[rfa agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 78, 29, 5, 92, 11, 87, 10, 26, 13], weight: tensor([0.0276, 0.0368, 0.1274, 0.1440, 0.1517, 0.0630, 0.1000, 0.0762, 0.1279,
        0.1455])
[rfa agg] iter:  0, prev_obj_val: 54.70570373535156, obj_val: 58.531288146972656, abs dis: 3.8255844116210938
[rfa agg] iter: 0, weight: tensor([0.0089, 0.0138, 0.1406, 0.0920, 0.0851, 0.0405, 0.3169, 0.0680, 0.1410,
        0.0932])
[rfa agg] iter:  1, prev_obj_val: 58.531288146972656, obj_val: 60.80991744995117, abs dis: 2.2786293029785156
[rfa agg] iter: 1, weight: tensor([0.0079, 0.0125, 0.0937, 0.0667, 0.0626, 0.0390, 0.4861, 0.0697, 0.0943,
        0.0676])
[rfa agg] iter:  2, prev_obj_val: 60.80991744995117, obj_val: 60.80947494506836, abs dis: 0.0004425048828125
[rfa agg] iter: 2, weight: tensor([0.0083, 0.0132, 0.0860, 0.0634, 0.0599, 0.0428, 0.4958, 0.0797, 0.0866,
        0.0642])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3204, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.1826, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.4242012500763 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 103/408 (25.2451%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0536, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7430, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 146/682 (21.4076%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9468, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0544, Accuracy: 445/1742 (25.5454%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 754/1742 (43.2836%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8397, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0401, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.3463, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0806, Accuracy: 61/515 (11.8447%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.0855, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0618, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 354/1003 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9067, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0663, Accuracy: 158/568 (27.8169%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.1663, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8531, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 434/1949 (22.2678%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 654/1949 (33.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2971, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 643/1645 (39.0881%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.5969, Accuracy: 103/10000 (1.0300%)
time spent on training: 143.0267436504364
[rfa agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 80, 93, 31, 33, 86, 62, 98, 21, 13], weight: tensor([0.0437, 0.0730, 0.1864, 0.0492, 0.0551, 0.1073, 0.0608, 0.0399, 0.2086,
        0.1760])
[rfa agg] iter:  0, prev_obj_val: 82.80684661865234, obj_val: 84.8133316040039, abs dis: 2.0064849853515625
[rfa agg] iter: 0, weight: tensor([0.0280, 0.0733, 0.1309, 0.0347, 0.0431, 0.3523, 0.0476, 0.0234, 0.1130,
        0.1538])
[rfa agg] iter:  1, prev_obj_val: 84.8133316040039, obj_val: 88.50601959228516, abs dis: 3.69268798828125
[rfa agg] iter: 1, weight: tensor([0.0196, 0.0563, 0.0688, 0.0246, 0.0312, 0.6093, 0.0344, 0.0162, 0.0612,
        0.0785])
[rfa agg] iter:  2, prev_obj_val: 88.50601959228516, obj_val: 90.07158660888672, abs dis: 1.5655670166015625
[rfa agg] iter: 2, weight: tensor([0.0273, 0.0904, 0.0716, 0.0351, 0.0458, 0.5120, 0.0505, 0.0222, 0.0652,
        0.0798])
[rfa agg] iter:  3, prev_obj_val: 90.07158660888672, obj_val: 90.06629943847656, abs dis: 0.00528717041015625
[rfa agg] iter: 3, weight: tensor([0.0341, 0.1207, 0.0808, 0.0443, 0.0584, 0.4063, 0.0645, 0.0275, 0.0740,
        0.0894])
[rfa agg] iter:  4, prev_obj_val: 90.06629943847656, obj_val: 91.64480590820312, abs dis: 1.5785064697265625
[rfa agg] iter: 4, weight: tensor([0.0343, 0.1217, 0.0812, 0.0445, 0.0588, 0.4027, 0.0649, 0.0277, 0.0745,
        0.0899])
[rfa agg] iter:  5, prev_obj_val: 91.64480590820312, obj_val: 93.22769165039062, abs dis: 1.5828857421875
[rfa agg] iter: 5, weight: tensor([0.0392, 0.1510, 0.0836, 0.0515, 0.0689, 0.3291, 0.0761, 0.0314, 0.0772,
        0.0920])
[rfa agg] iter:  6, prev_obj_val: 93.22769165039062, obj_val: 94.81739044189453, abs dis: 1.5896987915039062
[rfa agg] iter: 6, weight: tensor([0.0429, 0.1837, 0.0823, 0.0571, 0.0779, 0.2696, 0.0861, 0.0341, 0.0764,
        0.0900])
[rfa agg] iter:  7, prev_obj_val: 94.81739044189453, obj_val: 96.41432189941406, abs dis: 1.5969314575195312
[rfa agg] iter: 7, weight: tensor([0.0454, 0.2226, 0.0777, 0.0613, 0.0854, 0.2203, 0.0944, 0.0356, 0.0725,
        0.0846])
[rfa agg] iter:  8, prev_obj_val: 96.41432189941406, obj_val: 98.02155303955078, abs dis: 1.6072311401367188
[rfa agg] iter: 8, weight: tensor([0.0463, 0.2733, 0.0703, 0.0636, 0.0910, 0.1770, 0.1006, 0.0358, 0.0659,
        0.0761])
[rfa agg] iter:  9, prev_obj_val: 98.02155303955078, obj_val: 99.65141296386719, abs dis: 1.6298599243164062
[rfa agg] iter: 9, weight: tensor([0.0446, 0.3470, 0.0597, 0.0627, 0.0927, 0.1361, 0.1026, 0.0340, 0.0563,
        0.0644])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3230, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.1826, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.82917046546936 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0867, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6167, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 270/776 (34.7938%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4434, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 394/1418 (27.7856%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 690/1418 (48.6601%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0942, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 312/1013 (30.7996%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1349, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0509, Accuracy: 319/1071 (29.7852%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0278, Accuracy: 532/1071 (49.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7662, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 418/1956 (21.3701%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1938, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0664, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0336, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.3525, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0641, Accuracy: 159/809 (19.6539%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 356/809 (44.0049%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1146, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0538, Accuracy: 455/1904 (23.8971%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 691/1904 (36.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2949, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0372, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9817, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.32165360450745
[rfa agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 75, 70, 14, 55, 6, 16, 50, 46, 23], weight: tensor([0.0255, 0.0729, 0.1333, 0.0952, 0.1006, 0.1838, 0.0665, 0.0760, 0.1789,
        0.0672])
[rfa agg] iter:  0, prev_obj_val: 66.73548126220703, obj_val: 68.8994369506836, abs dis: 2.1639556884765625
[rfa agg] iter: 0, weight: tensor([0.0093, 0.0651, 0.1433, 0.1798, 0.2842, 0.0727, 0.0503, 0.0676, 0.0769,
        0.0509])
[rfa agg] iter:  1, prev_obj_val: 68.8994369506836, obj_val: 71.8852310180664, abs dis: 2.9857940673828125
[rfa agg] iter: 1, weight: tensor([0.0067, 0.0683, 0.0548, 0.3913, 0.2403, 0.0356, 0.0473, 0.0707, 0.0371,
        0.0479])
[rfa agg] iter:  2, prev_obj_val: 71.8852310180664, obj_val: 75.39468383789062, abs dis: 3.5094528198242188
[rfa agg] iter: 2, weight: tensor([0.0089, 0.1178, 0.0577, 0.2967, 0.1650, 0.0401, 0.0744, 0.1224, 0.0416,
        0.0754])
[rfa agg] iter:  3, prev_obj_val: 75.39468383789062, obj_val: 77.2773208618164, abs dis: 1.8826370239257812
[rfa agg] iter: 3, weight: tensor([0.0095, 0.1955, 0.0494, 0.1540, 0.1089, 0.0363, 0.1034, 0.2009, 0.0375,
        0.1048])
[rfa agg] iter:  4, prev_obj_val: 77.2773208618164, obj_val: 85.53260803222656, abs dis: 8.255287170410156
[rfa agg] iter: 4, weight: tensor([0.0084, 0.2444, 0.0392, 0.1035, 0.0786, 0.0295, 0.1109, 0.2436, 0.0304,
        0.1115])
[rfa agg] iter:  5, prev_obj_val: 85.53260803222656, obj_val: 85.48641204833984, abs dis: 0.04619598388671875
[rfa agg] iter: 5, weight: tensor([0.0097, 0.1650, 0.0323, 0.0629, 0.0532, 0.0259, 0.2324, 0.1678, 0.0266,
        0.2241])
[rfa agg] iter:  6, prev_obj_val: 85.48641204833984, obj_val: 89.21040344238281, abs dis: 3.7239913940429688
[rfa agg] iter: 6, weight: tensor([0.0093, 0.1537, 0.0309, 0.0600, 0.0508, 0.0248, 0.2501, 0.1546, 0.0254,
        0.2404])
[rfa agg] iter:  7, prev_obj_val: 89.21040344238281, obj_val: 93.2195053100586, abs dis: 4.009101867675781
[rfa agg] iter: 7, weight: tensor([0.0122, 0.1378, 0.0361, 0.0653, 0.0565, 0.0295, 0.2486, 0.1406, 0.0302,
        0.2432])
[rfa agg] iter:  8, prev_obj_val: 93.2195053100586, obj_val: 79.53545379638672, abs dis: 13.684051513671875
[rfa agg] iter: 8, weight: tensor([0.0169, 0.1378, 0.0444, 0.0755, 0.0665, 0.0368, 0.2213, 0.1418, 0.0377,
        0.2213])
[rfa agg] iter:  9, prev_obj_val: 79.53545379638672, obj_val: 82.24968719482422, abs dis: 2.7142333984375
[rfa agg] iter: 9, weight: tensor([0.0079, 0.2558, 0.0330, 0.0768, 0.0612, 0.0254, 0.1363, 0.2401, 0.0262,
        0.1371])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3259, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.1874, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.2018222808838 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 299/590 (50.6780%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0295, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3563, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0623, Accuracy: 182/953 (19.0976%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 331/953 (34.7324%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9337, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0565, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 638/1475 (43.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5360, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1166, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3410, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0520, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2055, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 391/1418 (27.5740%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6625, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.1856, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 621/2227 (27.8850%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1067/2227 (47.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1771, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 460/1953 (23.5535%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 789/1953 (40.3994%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7406, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0800, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0462, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.9112, Accuracy: 50/10000 (0.5000%)
time spent on training: 146.61331272125244
[rfa agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 64, 65, 61, 33, 70, 82, 60, 83, 98], weight: tensor([0.0585, 0.0945, 0.1462, 0.0084, 0.0510, 0.1405, 0.0496, 0.2207, 0.1936,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 78.86548614501953, obj_val: 78.7624740600586, abs dis: 0.1030120849609375
[rfa agg] iter: 0, weight: tensor([0.0253, 0.0719, 0.2694, 0.0022, 0.0203, 0.3983, 0.0183, 0.0813, 0.1011,
        0.0119])
[rfa agg] iter:  1, prev_obj_val: 78.7624740600586, obj_val: 78.7622299194336, abs dis: 0.000244140625
[rfa agg] iter: 1, weight: tensor([0.0246, 0.0697, 0.2651, 0.0021, 0.0197, 0.4123, 0.0178, 0.0790, 0.0982,
        0.0115])
[rfa agg] iter:  2, prev_obj_val: 78.7622299194336, obj_val: 77.09750366210938, abs dis: 1.6647262573242188
[rfa agg] iter: 2, weight: tensor([0.0245, 0.0696, 0.2644, 0.0021, 0.0197, 0.4134, 0.0177, 0.0789, 0.0981,
        0.0115])
[rfa agg] iter:  3, prev_obj_val: 77.09750366210938, obj_val: 78.76506805419922, abs dis: 1.6675643920898438
[rfa agg] iter: 3, weight: tensor([0.0195, 0.0537, 0.2647, 0.0017, 0.0157, 0.4674, 0.0142, 0.0679, 0.0858,
        0.0093])
[rfa agg] iter:  4, prev_obj_val: 78.76506805419922, obj_val: 77.09708404541016, abs dis: 1.6679840087890625
[rfa agg] iter: 4, weight: tensor([0.0244, 0.0693, 0.2625, 0.0021, 0.0196, 0.4168, 0.0177, 0.0785, 0.0976,
        0.0115])
[rfa agg] iter:  5, prev_obj_val: 77.09708404541016, obj_val: 78.76512145996094, abs dis: 1.6680374145507812
[rfa agg] iter: 5, weight: tensor([0.0195, 0.0537, 0.2644, 0.0017, 0.0157, 0.4680, 0.0142, 0.0679, 0.0857,
        0.0093])
[rfa agg] iter:  6, prev_obj_val: 78.76512145996094, obj_val: 77.09707641601562, abs dis: 1.6680450439453125
[rfa agg] iter: 6, weight: tensor([0.0244, 0.0693, 0.2624, 0.0021, 0.0196, 0.4168, 0.0177, 0.0785, 0.0976,
        0.0115])
[rfa agg] iter:  7, prev_obj_val: 77.09707641601562, obj_val: 78.7651138305664, abs dis: 1.6680374145507812
[rfa agg] iter: 7, weight: tensor([0.0195, 0.0537, 0.2644, 0.0017, 0.0157, 0.4680, 0.0142, 0.0679, 0.0857,
        0.0093])
[rfa agg] iter:  8, prev_obj_val: 78.7651138305664, obj_val: 77.09707641601562, abs dis: 1.6680374145507812
[rfa agg] iter: 8, weight: tensor([0.0244, 0.0693, 0.2624, 0.0021, 0.0196, 0.4168, 0.0177, 0.0785, 0.0976,
        0.0115])
[rfa agg] iter:  9, prev_obj_val: 77.09707641601562, obj_val: 78.7651138305664, abs dis: 1.6680374145507812
[rfa agg] iter: 9, weight: tensor([0.0195, 0.0537, 0.2644, 0.0017, 0.0157, 0.4680, 0.0142, 0.0679, 0.0857,
        0.0093])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3282, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.0878, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.97305130958557 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 297/590 (50.3390%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5247, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0663, Accuracy: 166/568 (29.2254%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3529, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 463/1953 (23.7071%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 789/1953 (40.3994%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0748, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0807, Accuracy: 58/416 (13.9423%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0445, Accuracy: 211/416 (50.7212%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2642, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4076, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0513, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0771, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 277/530 (52.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4960, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 426/1475 (28.8814%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 674/1475 (45.6949%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7215, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 263/1131 (23.2538%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 517/1131 (45.7118%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5118, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 372/1662 (22.3827%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 602/1662 (36.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2860, Accuracy: 104/10000 (1.0400%)
time spent on training: 148.12164974212646
[rfa agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 62, 83, 78, 25, 41, 18, 65, 38, 94], weight: tensor([0.0606, 0.0584, 0.2006, 0.0427, 0.0709, 0.0739, 0.0544, 0.1515, 0.1162,
        0.1707])
[rfa agg] iter:  0, prev_obj_val: 71.92412567138672, obj_val: 74.03026580810547, abs dis: 2.10614013671875
[rfa agg] iter: 0, weight: tensor([0.0372, 0.0316, 0.0685, 0.0188, 0.0501, 0.0614, 0.0295, 0.1063, 0.5042,
        0.0922])
[rfa agg] iter:  1, prev_obj_val: 74.03026580810547, obj_val: 75.23253631591797, abs dis: 1.2022705078125
[rfa agg] iter: 1, weight: tensor([0.0508, 0.0425, 0.0757, 0.0246, 0.0699, 0.0882, 0.0396, 0.1095, 0.4012,
        0.0979])
[rfa agg] iter:  2, prev_obj_val: 75.23253631591797, obj_val: 78.93522644042969, abs dis: 3.7026901245117188
[rfa agg] iter: 2, weight: tensor([0.0599, 0.0496, 0.0797, 0.0283, 0.0838, 0.1079, 0.0463, 0.1120, 0.3311,
        0.1014])
[rfa agg] iter:  3, prev_obj_val: 78.93522644042969, obj_val: 80.1672592163086, abs dis: 1.2320327758789062
[rfa agg] iter: 3, weight: tensor([0.0818, 0.0648, 0.0746, 0.0349, 0.1220, 0.1728, 0.0605, 0.0974, 0.2002,
        0.0909])
[rfa agg] iter:  4, prev_obj_val: 80.1672592163086, obj_val: 82.71546936035156, abs dis: 2.5482101440429688
[rfa agg] iter: 4, weight: tensor([0.0877, 0.0679, 0.0689, 0.0356, 0.1353, 0.2039, 0.0633, 0.0881, 0.1664,
        0.0830])
[rfa agg] iter:  5, prev_obj_val: 82.71546936035156, obj_val: 85.51982116699219, abs dis: 2.804351806640625
[rfa agg] iter: 5, weight: tensor([0.0939, 0.0685, 0.0527, 0.0336, 0.1606, 0.2912, 0.0639, 0.0650, 0.1085,
        0.0621])
[rfa agg] iter:  6, prev_obj_val: 85.51982116699219, obj_val: 89.37677001953125, abs dis: 3.8569488525390625
[rfa agg] iter: 6, weight: tensor([0.0919, 0.0604, 0.0332, 0.0268, 0.1920, 0.4012, 0.0562, 0.0396, 0.0603,
        0.0384])
[rfa agg] iter:  7, prev_obj_val: 89.37677001953125, obj_val: 97.336181640625, abs dis: 7.95941162109375
[rfa agg] iter: 7, weight: tensor([0.1488, 0.0799, 0.0285, 0.0301, 0.3370, 0.1893, 0.0743, 0.0330, 0.0468,
        0.0323])
[rfa agg] iter:  8, prev_obj_val: 97.336181640625, obj_val: 100.5542984008789, abs dis: 3.2181167602539062
[rfa agg] iter: 8, weight: tensor([0.2252, 0.2225, 0.0250, 0.0448, 0.1214, 0.0767, 0.1923, 0.0280, 0.0364,
        0.0277])
[rfa agg] iter:  9, prev_obj_val: 100.5542984008789, obj_val: 100.54075622558594, abs dis: 0.01354217529296875
[rfa agg] iter: 9, weight: tensor([0.1273, 0.3414, 0.0208, 0.0474, 0.0776, 0.0546, 0.2560, 0.0230, 0.0293,
        0.0229])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3307, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.0863, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.87788724899292 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0567, Accuracy: 336/715 (46.9930%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0392, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1832, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 407/1949 (20.8825%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 676/1949 (34.6845%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.8655, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0526, Accuracy: 425/1418 (29.9718%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2075, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0536, Accuracy: 427/1475 (28.9492%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0303, Accuracy: 728/1475 (49.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.5390, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1034, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0848, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.4066, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 354/1628 (21.7445%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 846/1628 (51.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.8946, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 421/888 (47.4099%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.1535, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 337/599 (56.2604%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.6877, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0566, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4466, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0567, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 330/735 (44.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.7371, Accuracy: 53/10000 (0.5300%)
time spent on training: 153.348304271698
[rfa agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 21, 70, 65, 79, 5, 63, 95, 58, 32], weight: tensor([0.0687, 0.1873, 0.1363, 0.1417, 0.0189, 0.1564, 0.0853, 0.0576, 0.0772,
        0.0706])
[rfa agg] iter:  0, prev_obj_val: 65.58636474609375, obj_val: 66.63519287109375, abs dis: 1.048828125
[rfa agg] iter: 0, weight: tensor([0.0627, 0.1002, 0.2110, 0.1787, 0.0081, 0.1427, 0.1087, 0.0410, 0.0823,
        0.0647])
[rfa agg] iter:  1, prev_obj_val: 66.63519287109375, obj_val: 68.78398895263672, abs dis: 2.1487960815429688
[rfa agg] iter: 1, weight: tensor([0.0687, 0.0979, 0.1936, 0.1664, 0.0086, 0.1358, 0.1227, 0.0443, 0.0913,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 68.78398895263672, obj_val: 72.06159973144531, abs dis: 3.2776107788085938
[rfa agg] iter: 2, weight: tensor([0.0807, 0.0904, 0.1591, 0.1409, 0.0092, 0.1196, 0.1560, 0.0500, 0.1108,
        0.0833])
[rfa agg] iter:  3, prev_obj_val: 72.06159973144531, obj_val: 73.1639633178711, abs dis: 1.1023635864257812
[rfa agg] iter: 3, weight: tensor([0.0957, 0.0709, 0.1095, 0.1001, 0.0090, 0.0887, 0.2299, 0.0543, 0.1429,
        0.0992])
[rfa agg] iter:  4, prev_obj_val: 73.1639633178711, obj_val: 75.49285125732422, abs dis: 2.328887939453125
[rfa agg] iter: 4, weight: tensor([0.0980, 0.0618, 0.0920, 0.0848, 0.0084, 0.0760, 0.2707, 0.0532, 0.1533,
        0.1019])
[rfa agg] iter:  5, prev_obj_val: 75.49285125732422, obj_val: 78.59176635742188, abs dis: 3.0989151000976562
[rfa agg] iter: 5, weight: tensor([0.0920, 0.0398, 0.0558, 0.0521, 0.0063, 0.0476, 0.3989, 0.0444, 0.1667,
        0.0965])
[rfa agg] iter:  6, prev_obj_val: 78.59176635742188, obj_val: 89.31498718261719, abs dis: 10.723220825195312
[rfa agg] iter: 6, weight: tensor([0.1081, 0.0286, 0.0380, 0.0359, 0.0053, 0.0334, 0.3373, 0.0432, 0.2532,
        0.1170])
[rfa agg] iter:  7, prev_obj_val: 89.31498718261719, obj_val: 92.88628387451172, abs dis: 3.5712966918945312
[rfa agg] iter: 7, weight: tensor([0.2250, 0.0292, 0.0359, 0.0344, 0.0077, 0.0328, 0.1020, 0.1066, 0.1464,
        0.2800])
[rfa agg] iter:  8, prev_obj_val: 92.88628387451172, obj_val: 92.88209533691406, abs dis: 0.00418853759765625
[rfa agg] iter: 8, weight: tensor([0.2038, 0.0336, 0.0406, 0.0391, 0.0097, 0.0374, 0.0999, 0.1754, 0.1325,
        0.2281])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3337, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 4.9738, Accuracy: 4/9950 (0.0402%)
saving model
Done in 250.66540360450745 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0878, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0561, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7024, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 393/1581 (24.8577%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 601/1581 (38.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6645, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0544, Accuracy: 439/1587 (27.6623%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 625/1587 (39.3825%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9384, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0662, Accuracy: 161/682 (23.6070%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0370, Accuracy: 283/682 (41.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2822, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0524, Accuracy: 366/1130 (32.3894%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 480/1130 (42.4779%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7649, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0637, Accuracy: 183/568 (32.2183%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0389, Accuracy: 267/568 (47.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3656, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0543, Accuracy: 219/735 (29.7959%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.0474, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0466, Accuracy: 491/1470 (33.4014%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 846/1470 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.6691, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0613, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 423/901 (46.9478%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 346/1372 (25.2187%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 561/1372 (40.8892%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3501, Accuracy: 99/10000 (0.9900%)
time spent on training: 150.64671564102173
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 28, 27, 80, 54, 62, 32, 22, 4, 42], weight: tensor([0.0263, 0.1535, 0.1541, 0.0662, 0.1097, 0.0552, 0.0714, 0.1428, 0.0875,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 55.989078521728516, obj_val: 59.67502212524414, abs dis: 3.685943603515625
[rfa agg] iter: 0, weight: tensor([0.0102, 0.0723, 0.0726, 0.0560, 0.2145, 0.0335, 0.0747, 0.0863, 0.2864,
        0.0935])
[rfa agg] iter:  1, prev_obj_val: 59.67502212524414, obj_val: 66.82398223876953, abs dis: 7.148960113525391
[rfa agg] iter: 1, weight: tensor([0.0091, 0.0531, 0.0533, 0.0569, 0.1232, 0.0318, 0.0803, 0.0617, 0.4650,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 66.82398223876953, obj_val: 64.31514739990234, abs dis: 2.5088348388671875
[rfa agg] iter: 2, weight: tensor([0.0141, 0.0605, 0.0607, 0.1171, 0.1089, 0.0550, 0.1918, 0.0681, 0.2530,
        0.0708])
[rfa agg] iter:  3, prev_obj_val: 64.31514739990234, obj_val: 59.65370178222656, abs dis: 4.661445617675781
[rfa agg] iter: 3, weight: tensor([0.0127, 0.0605, 0.0607, 0.0945, 0.1169, 0.0476, 0.1477, 0.0687, 0.3186,
        0.0719])
[rfa agg] iter:  4, prev_obj_val: 59.65370178222656, obj_val: 64.33014678955078, abs dis: 4.676445007324219
[rfa agg] iter: 4, weight: tensor([0.0088, 0.0510, 0.0513, 0.0548, 0.1177, 0.0306, 0.0775, 0.0593, 0.4861,
        0.0630])
[rfa agg] iter:  5, prev_obj_val: 64.33014678955078, obj_val: 61.892906188964844, abs dis: 2.4372406005859375
[rfa agg] iter: 5, weight: tensor([0.0124, 0.0591, 0.0593, 0.0920, 0.1139, 0.0464, 0.1411, 0.0672, 0.3383,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 61.892906188964844, obj_val: 66.81197357177734, abs dis: 4.9190673828125
[rfa agg] iter: 6, weight: tensor([0.0104, 0.0546, 0.0548, 0.0701, 0.1142, 0.0373, 0.1031, 0.0627, 0.4268,
        0.0660])
[rfa agg] iter:  7, prev_obj_val: 66.81197357177734, obj_val: 64.31536102294922, abs dis: 2.496612548828125
[rfa agg] iter: 7, weight: tensor([0.0141, 0.0605, 0.0607, 0.1172, 0.1089, 0.0551, 0.1931, 0.0681, 0.2515,
        0.0708])
[rfa agg] iter:  8, prev_obj_val: 64.31536102294922, obj_val: 59.65375900268555, abs dis: 4.661602020263672
[rfa agg] iter: 8, weight: tensor([0.0127, 0.0605, 0.0608, 0.0945, 0.1169, 0.0476, 0.1477, 0.0687, 0.3185,
        0.0719])
[rfa agg] iter:  9, prev_obj_val: 59.65375900268555, obj_val: 64.33013153076172, abs dis: 4.676372528076172
[rfa agg] iter: 9, weight: tensor([0.0088, 0.0511, 0.0513, 0.0548, 0.1177, 0.0306, 0.0775, 0.0593, 0.4860,
        0.0630])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3365, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 4.9252, Accuracy: 14/9950 (0.1407%)
saving model
Done in 249.16441082954407 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0860, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3615, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7263, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0648, Accuracy: 219/605 (36.1983%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4216, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0585, Accuracy: 344/715 (48.1119%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0363, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.1790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 297/928 (32.0043%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.7834, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0547, Accuracy: 360/891 (40.4040%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 431/891 (48.3726%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9580, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0804, Accuracy: 61/416 (14.6635%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0454, Accuracy: 217/416 (52.1635%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4012, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0613, Accuracy: 172/809 (21.2608%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0260, Accuracy: 385/809 (47.5896%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.8448, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0607, Accuracy: 264/1241 (21.2732%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 458/1241 (36.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6730, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 395/1581 (24.9842%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 602/1581 (38.0772%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.8485, Accuracy: 100/10000 (1.0000%)
time spent on training: 144.6175856590271
[rfa agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 89, 2, 23, 1, 7, 78, 50, 72, 28], weight: tensor([0.0545, 0.1048, 0.0708, 0.0836, 0.1086, 0.1042, 0.0487, 0.0946, 0.1452,
        0.1850])
[rfa agg] iter:  0, prev_obj_val: 42.085384368896484, obj_val: 48.58470916748047, abs dis: 6.499324798583984
[rfa agg] iter: 0, weight: tensor([0.0219, 0.1662, 0.0466, 0.1408, 0.1018, 0.1582, 0.0163, 0.2754, 0.0416,
        0.0311])
[rfa agg] iter:  1, prev_obj_val: 48.58470916748047, obj_val: 54.25831604003906, abs dis: 5.673606872558594
[rfa agg] iter: 1, weight: tensor([0.0411, 0.1073, 0.1164, 0.2789, 0.0809, 0.1062, 0.0288, 0.1584, 0.0455,
        0.0366])
[rfa agg] iter:  2, prev_obj_val: 54.25831604003906, obj_val: 60.60346984863281, abs dis: 6.34515380859375
[rfa agg] iter: 2, weight: tensor([0.0652, 0.0897, 0.2797, 0.1622, 0.0730, 0.0891, 0.0423, 0.1128, 0.0468,
        0.0391])
[rfa agg] iter:  3, prev_obj_val: 60.60346984863281, obj_val: 64.08734130859375, abs dis: 3.4838714599609375
[rfa agg] iter: 3, weight: tensor([0.1112, 0.0750, 0.3363, 0.1062, 0.0638, 0.0743, 0.0624, 0.0869, 0.0450,
        0.0389])
[rfa agg] iter:  4, prev_obj_val: 64.08734130859375, obj_val: 60.60308074951172, abs dis: 3.4842605590820312
[rfa agg] iter: 4, weight: tensor([0.1773, 0.0763, 0.2402, 0.1004, 0.0660, 0.0756, 0.0871, 0.0860, 0.0485,
        0.0425])
[rfa agg] iter:  5, prev_obj_val: 60.60308074951172, obj_val: 64.08715057373047, abs dis: 3.48406982421875
[rfa agg] iter: 5, weight: tensor([0.1129, 0.0750, 0.3346, 0.1060, 0.0638, 0.0743, 0.0626, 0.0869, 0.0450,
        0.0389])
[rfa agg] iter:  6, prev_obj_val: 64.08715057373047, obj_val: 60.60308837890625, abs dis: 3.4840621948242188
[rfa agg] iter: 6, weight: tensor([0.1774, 0.0763, 0.2401, 0.1004, 0.0660, 0.0756, 0.0871, 0.0860, 0.0485,
        0.0425])
[rfa agg] iter:  7, prev_obj_val: 60.60308837890625, obj_val: 64.08714294433594, abs dis: 3.4840545654296875
[rfa agg] iter: 7, weight: tensor([0.1129, 0.0750, 0.3346, 0.1060, 0.0638, 0.0743, 0.0626, 0.0869, 0.0450,
        0.0389])
[rfa agg] iter:  8, prev_obj_val: 64.08714294433594, obj_val: 60.60308837890625, abs dis: 3.4840545654296875
[rfa agg] iter: 8, weight: tensor([0.1774, 0.0763, 0.2401, 0.1004, 0.0660, 0.0756, 0.0871, 0.0860, 0.0485,
        0.0425])
[rfa agg] iter:  9, prev_obj_val: 60.60308837890625, obj_val: 64.08714294433594, abs dis: 3.4840545654296875
[rfa agg] iter: 9, weight: tensor([0.1129, 0.0750, 0.3346, 0.1060, 0.0638, 0.0743, 0.0626, 0.0869, 0.0450,
        0.0389])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3392, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 4.9329, Accuracy: 18/9950 (0.1809%)
saving model
Done in 246.61551880836487 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 677/1956 (34.6115%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1477, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0620, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 368/1003 (36.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3267, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 116/271 (42.8044%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8424, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0352, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.3993, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 472/896 (52.6786%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.8431, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 451/1715 (26.2974%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 724/1715 (42.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8876, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0309, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0562, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 334/1089 (30.6703%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0291, Accuracy: 445/1089 (40.8632%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 12.3281, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0543, Accuracy: 251/861 (29.1521%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0204, Accuracy: 462/861 (53.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9054, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0603, Accuracy: 237/1013 (23.3959%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0346, Accuracy: 339/1013 (33.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3503, Accuracy: 73/10000 (0.7300%)
time spent on training: 155.05417108535767
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 86, 35, 16, 89, 92, 20, 59, 10, 14], weight: tensor([0.1896, 0.0972, 0.0263, 0.0686, 0.0868, 0.1662, 0.0782, 0.1055, 0.0834,
        0.0982])
[rfa agg] iter:  0, prev_obj_val: 56.3344612121582, obj_val: 59.575706481933594, abs dis: 3.2412452697753906
[rfa agg] iter: 0, weight: tensor([0.0452, 0.1809, 0.0068, 0.0399, 0.0785, 0.0563, 0.0550, 0.2755, 0.0754,
        0.1864])
[rfa agg] iter:  1, prev_obj_val: 59.575706481933594, obj_val: 66.75875091552734, abs dis: 7.18304443359375
[rfa agg] iter: 1, weight: tensor([0.0268, 0.1346, 0.0065, 0.0604, 0.2240, 0.0310, 0.1030, 0.0685, 0.2073,
        0.1380])
[rfa agg] iter:  2, prev_obj_val: 66.75875091552734, obj_val: 70.04794311523438, abs dis: 3.2891921997070312
[rfa agg] iter: 2, weight: tensor([0.0261, 0.0775, 0.0081, 0.1329, 0.1846, 0.0294, 0.2358, 0.0511, 0.1756,
        0.0789])
[rfa agg] iter:  3, prev_obj_val: 70.04794311523438, obj_val: 73.68736267089844, abs dis: 3.6394195556640625
[rfa agg] iter: 3, weight: tensor([0.0274, 0.0719, 0.0094, 0.2081, 0.1432, 0.0306, 0.2481, 0.0504, 0.1376,
        0.0733])
[rfa agg] iter:  4, prev_obj_val: 73.68736267089844, obj_val: 73.67202758789062, abs dis: 0.0153350830078125
[rfa agg] iter: 4, weight: tensor([0.0294, 0.0699, 0.0111, 0.3040, 0.1219, 0.0327, 0.1919, 0.0510, 0.1172,
        0.0711])
[rfa agg] iter:  5, prev_obj_val: 73.67202758789062, obj_val: 70.05359649658203, abs dis: 3.6184310913085938
[rfa agg] iter: 5, weight: tensor([0.0284, 0.0674, 0.0107, 0.3345, 0.1172, 0.0315, 0.1801, 0.0492, 0.1126,
        0.0685])
[rfa agg] iter:  6, prev_obj_val: 70.05359649658203, obj_val: 77.61033630371094, abs dis: 7.556739807128906
[rfa agg] iter: 6, weight: tensor([0.0269, 0.0705, 0.0092, 0.2408, 0.1384, 0.0301, 0.2299, 0.0494, 0.1330,
        0.0718])
[rfa agg] iter:  7, prev_obj_val: 77.61033630371094, obj_val: 63.810115814208984, abs dis: 13.800220489501953
[rfa agg] iter: 7, weight: tensor([0.0345, 0.0753, 0.0143, 0.3012, 0.1196, 0.0381, 0.1687, 0.0569, 0.1149,
        0.0764])
[rfa agg] iter:  8, prev_obj_val: 63.810115814208984, obj_val: 70.06550598144531, abs dis: 6.255390167236328
[rfa agg] iter: 8, weight: tensor([0.0238, 0.0803, 0.0068, 0.0939, 0.2270, 0.0271, 0.1910, 0.0500, 0.2178,
        0.0823])
[rfa agg] iter:  9, prev_obj_val: 70.06550598144531, obj_val: 73.68753814697266, abs dis: 3.6220321655273438
[rfa agg] iter: 9, weight: tensor([0.0278, 0.0730, 0.0095, 0.2047, 0.1462, 0.0311, 0.2421, 0.0511, 0.1403,
        0.0743])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3418, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 4.9392, Accuracy: 10/9950 (0.1005%)
saving model
Done in 251.2935209274292 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0592, Accuracy: 280/776 (36.0825%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6418, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 321/1645 (19.5137%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0317, Accuracy: 653/1645 (39.6960%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3526, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0528, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 458/1130 (40.5310%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.1718, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 417/1956 (21.3190%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0310, Accuracy: 687/1956 (35.1227%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5074, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 442/888 (49.7748%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.2915, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0780, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.3230, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0538, Accuracy: 426/1418 (30.0423%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 629/1418 (44.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4108, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0564, Accuracy: 266/1049 (25.3575%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0290, Accuracy: 541/1049 (51.5729%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4814, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 358/803 (44.5828%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5029, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0486, Accuracy: 383/1275 (30.0392%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0181, Accuracy: 799/1275 (62.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.3894, Accuracy: 110/10000 (1.1000%)
time spent on training: 163.5094859600067
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 13, 54, 6, 63, 49, 70, 51, 58, 9], weight: tensor([0.0682, 0.1446, 0.0993, 0.1719, 0.0780, 0.0387, 0.1246, 0.0922, 0.0706,
        0.1120])
[rfa agg] iter:  0, prev_obj_val: 53.192420959472656, obj_val: 55.717342376708984, abs dis: 2.524921417236328
[rfa agg] iter: 0, weight: tensor([0.0398, 0.0530, 0.3418, 0.0389, 0.0567, 0.0104, 0.0720, 0.1938, 0.0412,
        0.1524])
[rfa agg] iter:  1, prev_obj_val: 55.717342376708984, obj_val: 59.557044982910156, abs dis: 3.839702606201172
[rfa agg] iter: 1, weight: tensor([0.0493, 0.0470, 0.2486, 0.0361, 0.0742, 0.0114, 0.0601, 0.3164, 0.0511,
        0.1060])
[rfa agg] iter:  2, prev_obj_val: 59.557044982910156, obj_val: 61.666385650634766, abs dis: 2.1093406677246094
[rfa agg] iter: 2, weight: tensor([0.0791, 0.0518, 0.1687, 0.0412, 0.1310, 0.0155, 0.0633, 0.2688, 0.0819,
        0.0987])
[rfa agg] iter:  3, prev_obj_val: 61.666385650634766, obj_val: 63.83503723144531, abs dis: 2.168651580810547
[rfa agg] iter: 3, weight: tensor([0.0994, 0.0521, 0.1445, 0.0421, 0.1792, 0.0173, 0.0624, 0.2073, 0.1028,
        0.0931])
[rfa agg] iter:  4, prev_obj_val: 63.83503723144531, obj_val: 63.82622528076172, abs dis: 0.00881195068359375
[rfa agg] iter: 4, weight: tensor([0.1185, 0.0482, 0.1180, 0.0395, 0.2415, 0.0178, 0.0568, 0.1561, 0.1224,
        0.0814])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3453, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 4.9523, Accuracy: 10/9950 (0.1005%)
saving model
Done in 261.01470470428467 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0651, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0327, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.5094, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0262, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4003, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0540, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0309, Accuracy: 705/1904 (37.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9054, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 51/466 (10.9442%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.9876, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0797, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.1295, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.8354, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0541, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0310, Accuracy: 699/1742 (40.1263%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.4463, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0612, Accuracy: 190/953 (19.9370%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0367, Accuracy: 328/953 (34.4176%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5309, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 394/1949 (20.2155%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 648/1949 (33.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.7346, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0533, Accuracy: 244/861 (28.3391%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0204, Accuracy: 463/861 (53.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.0759, Accuracy: 77/10000 (0.7700%)
time spent on training: 160.98212695121765
[rfa agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 25, 46, 76, 98, 73, 93, 64, 21, 10], weight: tensor([0.0669, 0.0652, 0.1799, 0.0440, 0.0352, 0.0886, 0.1646, 0.0900, 0.1841,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 78.42910766601562, obj_val: 79.54314422607422, abs dis: 1.1140365600585938
[rfa agg] iter: 0, weight: tensor([0.0710, 0.0606, 0.1216, 0.0298, 0.0202, 0.1619, 0.1356, 0.1652, 0.1142,
        0.1199])
[rfa agg] iter:  1, prev_obj_val: 79.54314422607422, obj_val: 81.53878021240234, abs dis: 1.995635986328125
[rfa agg] iter: 1, weight: tensor([0.0719, 0.0585, 0.0748, 0.0265, 0.0173, 0.2248, 0.0807, 0.2315, 0.0711,
        0.1429])
[rfa agg] iter:  2, prev_obj_val: 81.53878021240234, obj_val: 87.16205596923828, abs dis: 5.6232757568359375
[rfa agg] iter: 2, weight: tensor([0.0513, 0.0379, 0.0282, 0.0148, 0.0092, 0.3012, 0.0297, 0.3430, 0.0271,
        0.1577])
[rfa agg] iter:  3, prev_obj_val: 87.16205596923828, obj_val: 84.83110809326172, abs dis: 2.3309478759765625
[rfa agg] iter: 3, weight: tensor([0.1281, 0.0792, 0.0344, 0.0252, 0.0148, 0.1713, 0.0358, 0.1777, 0.0332,
        0.3003])
[rfa agg] iter:  4, prev_obj_val: 84.83110809326172, obj_val: 92.22881317138672, abs dis: 7.397705078125
[rfa agg] iter: 4, weight: tensor([0.0815, 0.0542, 0.0287, 0.0187, 0.0112, 0.1825, 0.0299, 0.1918, 0.0276,
        0.3738])
[rfa agg] iter:  5, prev_obj_val: 92.22881317138672, obj_val: 89.59566497802734, abs dis: 2.633148193359375
[rfa agg] iter: 5, weight: tensor([0.2778, 0.1385, 0.0360, 0.0341, 0.0190, 0.1194, 0.0372, 0.1222, 0.0349,
        0.1807])
[rfa agg] iter:  6, prev_obj_val: 89.59566497802734, obj_val: 89.58882904052734, abs dis: 0.0068359375
[rfa agg] iter: 6, weight: tensor([0.2071, 0.1082, 0.0366, 0.0304, 0.0174, 0.1435, 0.0379, 0.1476, 0.0354,
        0.2359])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3479, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 4.8596, Accuracy: 41/9950 (0.4121%)
saving model
Done in 264.5860824584961 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 423/1949 (21.7034%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0325, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2377, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 115/631 (18.2250%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.4893, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 142/530 (26.7925%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.7699, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0443, Accuracy: 490/1552 (31.5722%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 760/1552 (48.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.5320, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0555, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 580/928 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3150, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 186/773 (24.0621%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7884, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8913, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0845, Accuracy: 50/466 (10.7296%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0462, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.4010, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 277/813 (34.0713%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 11.5628, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 280/1513 (18.5063%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0356, Accuracy: 498/1513 (32.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6784, Accuracy: 114/10000 (1.1400%)
time spent on training: 158.1655673980713
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 48, 18, 74, 1, 99, 7, 76, 53, 8], weight: tensor([0.1940, 0.0628, 0.0528, 0.1545, 0.0924, 0.0769, 0.0887, 0.0464, 0.0809,
        0.1506])
[rfa agg] iter:  0, prev_obj_val: 66.49596405029297, obj_val: 67.15837097167969, abs dis: 0.6624069213867188
[rfa agg] iter: 0, weight: tensor([0.0838, 0.0488, 0.0362, 0.1194, 0.2033, 0.0987, 0.1436, 0.0285, 0.1040,
        0.1338])
[rfa agg] iter:  1, prev_obj_val: 67.15837097167969, obj_val: 74.75320434570312, abs dis: 7.5948333740234375
[rfa agg] iter: 1, weight: tensor([0.0361, 0.0372, 0.0261, 0.0459, 0.3590, 0.1087, 0.2025, 0.0197, 0.1152,
        0.0496])
[rfa agg] iter:  2, prev_obj_val: 74.75320434570312, obj_val: 83.41708374023438, abs dis: 8.66387939453125
[rfa agg] iter: 2, weight: tensor([0.0288, 0.0668, 0.0409, 0.0339, 0.0986, 0.2491, 0.1423, 0.0281, 0.2758,
        0.0358])
[rfa agg] iter:  3, prev_obj_val: 83.41708374023438, obj_val: 80.4139404296875, abs dis: 3.003143310546875
[rfa agg] iter: 3, weight: tensor([0.0381, 0.2127, 0.1001, 0.0432, 0.0889, 0.1456, 0.1120, 0.0596, 0.1545,
        0.0454])
[rfa agg] iter:  4, prev_obj_val: 80.4139404296875, obj_val: 77.47777557373047, abs dis: 2.9361648559570312
[rfa agg] iter: 4, weight: tensor([0.0376, 0.1509, 0.0784, 0.0431, 0.0971, 0.1785, 0.1271, 0.0495, 0.1924,
        0.0454])
[rfa agg] iter:  5, prev_obj_val: 77.47777557373047, obj_val: 80.41355895996094, abs dis: 2.9357833862304688
[rfa agg] iter: 5, weight: tensor([0.0337, 0.1006, 0.0575, 0.0392, 0.0983, 0.2176, 0.1355, 0.0380, 0.2381,
        0.0414])
[rfa agg] iter:  6, prev_obj_val: 80.41355895996094, obj_val: 80.41072845458984, abs dis: 0.00283050537109375
[rfa agg] iter: 6, weight: tensor([0.0375, 0.1482, 0.0781, 0.0431, 0.0970, 0.1807, 0.1272, 0.0494, 0.1933,
        0.0453])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3481, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 4.8717, Accuracy: 42/9950 (0.4221%)
saving model
Done in 256.6645336151123 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0557, Accuracy: 283/636 (44.4969%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0301, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6625, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 373/1662 (22.4428%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0324, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3112, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0544, Accuracy: 304/928 (32.7586%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0229, Accuracy: 589/928 (63.4698%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.7751, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0612, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0337, Accuracy: 387/1003 (38.5842%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3880, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0526, Accuracy: 445/1949 (22.8322%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0322, Accuracy: 649/1949 (33.2991%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3319, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0588, Accuracy: 287/776 (36.9845%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7400, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.7716, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0602, Accuracy: 350/901 (38.8457%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 412/901 (45.7270%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0651, Accuracy: 172/568 (30.2817%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0389, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5783, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0709, Accuracy: 231/774 (29.8450%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0334, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4913, Accuracy: 71/10000 (0.7100%)
time spent on training: 157.77177619934082
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 94, 1, 86, 21, 75, 2, 4, 62, 81], weight: tensor([0.0649, 0.1696, 0.0947, 0.1023, 0.1988, 0.0792, 0.0617, 0.0919, 0.0579,
        0.0790])
[rfa agg] iter:  0, prev_obj_val: 61.359249114990234, obj_val: 67.2270278930664, abs dis: 5.867778778076172
[rfa agg] iter: 0, weight: tensor([0.0348, 0.0707, 0.1627, 0.3110, 0.0535, 0.0733, 0.0331, 0.1605, 0.0273,
        0.0731])
[rfa agg] iter:  1, prev_obj_val: 67.2270278930664, obj_val: 75.28778076171875, abs dis: 8.060752868652344
[rfa agg] iter: 1, weight: tensor([0.0691, 0.0348, 0.1000, 0.0802, 0.0298, 0.2357, 0.0659, 0.0979, 0.0454,
        0.2413])
[rfa agg] iter:  2, prev_obj_val: 75.28778076171875, obj_val: 75.25371551513672, abs dis: 0.03406524658203125
[rfa agg] iter: 2, weight: tensor([0.1812, 0.0380, 0.0782, 0.0682, 0.0335, 0.1275, 0.1747, 0.0761, 0.0950,
        0.1276])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3497, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 4.8899, Accuracy: 42/9950 (0.4221%)
saving model
Done in 257.3621394634247 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0610, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 447/1190 (37.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1579, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0749, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9193, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0559, Accuracy: 354/1645 (21.5198%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0317, Accuracy: 651/1645 (39.5745%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6139, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 62/426 (14.5540%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0403, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5524, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0375, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4198, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0512, Accuracy: 265/861 (30.7782%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0195, Accuracy: 485/861 (56.3298%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.2284, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0607, Accuracy: 188/809 (23.2386%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0256, Accuracy: 369/809 (45.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.7278, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0525, Accuracy: 443/1418 (31.2412%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0295, Accuracy: 682/1418 (48.0959%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.0039, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0605, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0345, Accuracy: 361/1013 (35.6367%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7271, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0544, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.1701, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.09295630455017
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 82, 13, 67, 2, 10, 50, 70, 14, 69], weight: tensor([0.1314, 0.0552, 0.1816, 0.0470, 0.0668, 0.0951, 0.0893, 0.1566, 0.1118,
        0.0651])
[rfa agg] iter:  0, prev_obj_val: 51.637237548828125, obj_val: 57.726806640625, abs dis: 6.089569091796875
[rfa agg] iter: 0, weight: tensor([0.0859, 0.0255, 0.0474, 0.0188, 0.0443, 0.3148, 0.1593, 0.0552, 0.2055,
        0.0432])
[rfa agg] iter:  1, prev_obj_val: 57.726806640625, obj_val: 59.939910888671875, abs dis: 2.213104248046875
[rfa agg] iter: 1, weight: tensor([0.0635, 0.0389, 0.0428, 0.0271, 0.0827, 0.1892, 0.3275, 0.0473, 0.1004,
        0.0806])
[rfa agg] iter:  2, prev_obj_val: 59.939910888671875, obj_val: 59.936500549316406, abs dis: 0.00341033935546875
[rfa agg] iter: 2, weight: tensor([0.0654, 0.0484, 0.0457, 0.0331, 0.1134, 0.1594, 0.2768, 0.0501, 0.0974,
        0.1104])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3520, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 4.9097, Accuracy: 28/9950 (0.2814%)
saving model
Done in 254.2285921573639 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 392/1750 (22.4000%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 700/1750 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.2112, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 338/1446 (23.3748%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0339, Accuracy: 535/1446 (36.9986%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5608, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0475, Accuracy: 278/813 (34.1943%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 489/813 (60.1476%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.1703, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0538, Accuracy: 328/1131 (29.0009%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 403/1131 (35.6322%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.4483, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 440/1154 (38.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.3059, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 373/1662 (22.4428%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0322, Accuracy: 620/1662 (37.3045%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3310, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0798, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.9530, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0612, Accuracy: 243/605 (40.1653%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0382, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.5868, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0660, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 327/774 (42.2481%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.3216, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0698, Accuracy: 107/631 (16.9572%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 235/631 (37.2425%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.6825, Accuracy: 53/10000 (0.5300%)
time spent on training: 171.2959451675415
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 26, 53, 87, 15, 94, 31, 2, 81, 48], weight: tensor([0.1678, 0.1387, 0.0780, 0.1085, 0.1107, 0.1594, 0.0441, 0.0580, 0.0742,
        0.0605])
[rfa agg] iter:  0, prev_obj_val: 55.47111129760742, obj_val: 60.04484176635742, abs dis: 4.57373046875
[rfa agg] iter: 0, weight: tensor([0.0547, 0.0854, 0.0589, 0.3878, 0.2234, 0.0640, 0.0159, 0.0265, 0.0558,
        0.0276])
[rfa agg] iter:  1, prev_obj_val: 60.04484176635742, obj_val: 65.00114440917969, abs dis: 4.956302642822266
[rfa agg] iter: 1, weight: tensor([0.0658, 0.0926, 0.1190, 0.2468, 0.1695, 0.0748, 0.0259, 0.0453, 0.1129,
        0.0473])
[rfa agg] iter:  2, prev_obj_val: 65.00114440917969, obj_val: 64.98143005371094, abs dis: 0.01971435546875
[rfa agg] iter: 2, weight: tensor([0.0558, 0.0730, 0.2144, 0.1370, 0.1093, 0.0621, 0.0304, 0.0575, 0.2005,
        0.0600])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3529, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 4.9276, Accuracy: 19/9950 (0.1910%)
saving model
Done in 270.9991593360901 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0664, Accuracy: 147/682 (21.5543%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6366, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0810, Accuracy: 3/186 (1.6129%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0653, Accuracy: 80/186 (43.0108%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4239, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0631, Accuracy: 190/938 (20.2559%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0320, Accuracy: 371/938 (39.5522%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.3474, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 488/1552 (31.4433%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 788/1552 (50.7732%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.6121, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 202/669 (30.1943%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0389, Accuracy: 357/669 (53.3632%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.4283, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0515, Accuracy: 354/1130 (31.3274%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 480/1130 (42.4779%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.1032, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 322/1372 (23.4694%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 492/1372 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.3149, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1052, Accuracy: 9/197 (4.5685%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0913, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4310, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 422/891 (47.3625%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.3661, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0586, Accuracy: 198/809 (24.4747%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0254, Accuracy: 387/809 (47.8368%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.7161, Accuracy: 118/10000 (1.1800%)
time spent on training: 163.21617698669434
[rfa agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 56, 73, 74, 45, 54, 42, 79, 7, 50], weight: tensor([0.0809, 0.0221, 0.1113, 0.1842, 0.0794, 0.1341, 0.1628, 0.0234, 0.1057,
        0.0960])
[rfa agg] iter:  0, prev_obj_val: 45.346954345703125, obj_val: 46.25007629394531, abs dis: 0.9031219482421875
[rfa agg] iter: 0, weight: tensor([0.0527, 0.0045, 0.3044, 0.0406, 0.0515, 0.0869, 0.0501, 0.0052, 0.2699,
        0.1343])
[rfa agg] iter:  1, prev_obj_val: 46.25007629394531, obj_val: 49.76520919799805, abs dis: 3.5151329040527344
[rfa agg] iter: 1, weight: tensor([0.0543, 0.0041, 0.2047, 0.0345, 0.0529, 0.0678, 0.0417, 0.0048, 0.3736,
        0.1614])
[rfa agg] iter:  2, prev_obj_val: 49.76520919799805, obj_val: 57.37032699584961, abs dis: 7.6051177978515625
[rfa agg] iter: 2, weight: tensor([0.0898, 0.0052, 0.1255, 0.0360, 0.0869, 0.0622, 0.0423, 0.0061, 0.2224,
        0.3235])
[rfa agg] iter:  3, prev_obj_val: 57.37032699584961, obj_val: 60.307125091552734, abs dis: 2.936798095703125
[rfa agg] iter: 3, weight: tensor([0.2583, 0.0070, 0.0840, 0.0366, 0.2370, 0.0550, 0.0415, 0.0084, 0.1102,
        0.1620])
[rfa agg] iter:  4, prev_obj_val: 60.307125091552734, obj_val: 63.87001037597656, abs dis: 3.562885284423828
[rfa agg] iter: 4, weight: tensor([0.3386, 0.0063, 0.0631, 0.0302, 0.2929, 0.0438, 0.0339, 0.0077, 0.0788,
        0.1047])
[rfa agg] iter:  5, prev_obj_val: 63.87001037597656, obj_val: 63.869529724121094, abs dis: 0.00048065185546875
[rfa agg] iter: 5, weight: tensor([0.3177, 0.0082, 0.0683, 0.0354, 0.2858, 0.0497, 0.0394, 0.0100, 0.0824,
        0.1030])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3551, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 4.9118, Accuracy: 35/9950 (0.3518%)
saving model
Done in 261.428688287735 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0504, Accuracy: 450/1574 (28.5896%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0243, Accuracy: 839/1574 (53.3037%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0200, Accuracy: 941/1574 (59.7840%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0190, Accuracy: 958/1574 (60.8640%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0186, Accuracy: 968/1574 (61.4994%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0185, Accuracy: 978/1574 (62.1347%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0179, Accuracy: 991/1574 (62.9606%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0176, Accuracy: 1017/1574 (64.6125%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0170, Accuracy: 1012/1574 (64.2948%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0172, Accuracy: 982/1574 (62.3888%), train_poison_data_count: 500
Global model norm: 112.02486906514329.
Norm before scaling: 112.00132532697995. Distance: 1.220180259113724
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9648, Accuracy: 100/10000 (1.0000%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.1449, Accuracy: 9872/9950 (99.2161%)
Scaling by  100
Scaled Norm after poisoning: 163.58994443997773, distance: 122.0180130464863
Total norm for 1 adversaries is: 163.58994443997773. distance: 122.0180130464863
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0310, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0709, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0575, Accuracy: 196/809 (24.2274%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0251, Accuracy: 370/809 (45.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9983, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0269, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0613, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0553, Accuracy: 369/1645 (22.4316%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0312, Accuracy: 686/1645 (41.7021%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2708, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.3708, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0799, Accuracy: 34/373 (9.1153%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3401, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 535/1372 (38.9942%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2162, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 453/1154 (39.2548%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2365, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0510, Accuracy: 365/1130 (32.3009%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9711, Accuracy: 60/10000 (0.6000%)
time spent on training: 296.5370726585388
[rfa agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.04668517463933181
[rfa agg] init. name: [17, 84, 50, 25, 13, 95, 98, 42, 15, 54], weight: tensor([0.1494, 0.1129, 0.0768, 0.0655, 0.1561, 0.0569, 0.0354, 0.1302, 0.1095,
        0.1073])
[rfa agg] iter:  0, prev_obj_val: 28359.9453125, obj_val: 19001.5234375, abs dis: 9358.421875
[rfa agg] iter: 0, weight: tensor([0.0299, 0.1289, 0.0873, 0.0744, 0.1788, 0.0646, 0.0401, 0.1488, 0.1250,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 19001.5234375, obj_val: 17082.201171875, abs dis: 1919.322265625
[rfa agg] iter: 1, weight: tensor([0.0053, 0.1323, 0.0885, 0.0751, 0.1864, 0.0650, 0.0401, 0.1538, 0.1283,
        0.1253])
[rfa agg] iter:  2, prev_obj_val: 17082.201171875, obj_val: 16740.775390625, abs dis: 341.42578125
[rfa agg] iter: 2, weight: tensor([0.0009, 0.1331, 0.0827, 0.0686, 0.2068, 0.0587, 0.0346, 0.1611, 0.1291,
        0.1244])
[rfa agg] iter:  3, prev_obj_val: 16740.775390625, obj_val: 16713.900390625, abs dis: 26.875
[rfa agg] iter: 3, weight: tensor([8.4123e-05, 8.7673e-02, 3.5909e-02, 2.7036e-02, 5.0480e-01, 2.2167e-02,
        1.1299e-02, 1.5100e-01, 8.5015e-02, 7.5019e-02])
[rfa agg] iter:  4, prev_obj_val: 16713.900390625, obj_val: 16715.072265625, abs dis: 1.171875
[rfa agg] iter: 4, weight: tensor([4.2211e-05, 1.7670e-01, 3.3634e-02, 2.3019e-02, 1.0951e-01, 1.8172e-02,
        8.3139e-03, 3.4085e-01, 1.7117e-01, 1.1858e-01])
[rfa agg] iter:  5, prev_obj_val: 16715.072265625, obj_val: 16721.087890625, abs dis: 6.015625
[rfa agg] iter: 5, weight: tensor([3.2841e-05, 2.2579e-01, 4.1586e-02, 2.5529e-02, 5.3180e-02, 1.9416e-02,
        8.0867e-03, 8.8131e-02, 2.2379e-01, 3.1446e-01])
[rfa agg] iter:  6, prev_obj_val: 16721.087890625, obj_val: 16723.369140625, abs dis: 2.28125
[rfa agg] iter: 6, weight: tensor([5.1184e-05, 1.8175e-01, 9.1523e-02, 5.0474e-02, 6.9866e-02, 3.7161e-02,
        1.4400e-02, 9.9777e-02, 1.7760e-01, 2.7740e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3555, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 4.9310, Accuracy: 29/9950 (0.2915%)
saving model
Done in 393.9849796295166 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 319/807 (39.5291%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0310, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.2362, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 449/1715 (26.1808%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 718/1715 (41.8659%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2315, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 67/426 (15.7277%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0407, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.6649, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0693, Accuracy: 121/631 (19.1759%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 231/631 (36.6086%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9398, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0506, Accuracy: 333/1030 (32.3301%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0241, Accuracy: 673/1030 (65.3398%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.5058, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 469/1988 (23.5915%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 693/1988 (34.8592%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1910, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0826, Accuracy: 46/466 (9.8712%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0461, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0233, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 396/1956 (20.2454%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0311, Accuracy: 696/1956 (35.5828%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5977, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 419/1953 (21.4542%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 741/1953 (37.9416%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2840, Accuracy: 107/10000 (1.0700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 408/1574 (25.9212%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 688/1574 (43.7103%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5740, Accuracy: 92/10000 (0.9200%)
time spent on training: 210.26727294921875
[rfa agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.039205722939582334
[rfa agg] init. name: [20, 92, 67, 48, 91, 85, 76, 6, 83, 17], weight: tensor([0.0643, 0.1367, 0.0340, 0.0503, 0.0821, 0.1585, 0.0371, 0.1559, 0.1557,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 70.79003143310547, obj_val: 66.73673248291016, abs dis: 4.0532989501953125
[rfa agg] iter: 0, weight: tensor([0.0422, 0.1850, 0.0137, 0.0251, 0.0917, 0.1036, 0.0160, 0.1140, 0.1136,
        0.2951])
[rfa agg] iter:  1, prev_obj_val: 66.73673248291016, obj_val: 66.72928619384766, abs dis: 0.0074462890625
[rfa agg] iter: 1, weight: tensor([0.0307, 0.1887, 0.0103, 0.0187, 0.0626, 0.0928, 0.0120, 0.1035, 0.1031,
        0.3776])
[rfa agg] iter:  2, prev_obj_val: 66.72928619384766, obj_val: 64.76051330566406, abs dis: 1.9687728881835938
[rfa agg] iter: 2, weight: tensor([0.0304, 0.1872, 0.0103, 0.0185, 0.0621, 0.0921, 0.0119, 0.1027, 0.1023,
        0.3825])
[rfa agg] iter:  3, prev_obj_val: 64.76051330566406, obj_val: 66.7326431274414, abs dis: 1.9721298217773438
[rfa agg] iter: 3, weight: tensor([0.0245, 0.1819, 0.0084, 0.0151, 0.0488, 0.0825, 0.0098, 0.0928, 0.0924,
        0.4438])
[rfa agg] iter:  4, prev_obj_val: 66.7326431274414, obj_val: 64.75999450683594, abs dis: 1.9726486206054688
[rfa agg] iter: 4, weight: tensor([0.0302, 0.1858, 0.0102, 0.0184, 0.0617, 0.0915, 0.0119, 0.1021, 0.1017,
        0.3864])
[rfa agg] iter:  5, prev_obj_val: 64.75999450683594, obj_val: 66.73269653320312, abs dis: 1.9727020263671875
[rfa agg] iter: 5, weight: tensor([0.0245, 0.1817, 0.0084, 0.0151, 0.0488, 0.0824, 0.0098, 0.0927, 0.0924,
        0.4442])
[rfa agg] iter:  6, prev_obj_val: 66.73269653320312, obj_val: 64.76000213623047, abs dis: 1.9726943969726562
[rfa agg] iter: 6, weight: tensor([0.0302, 0.1858, 0.0102, 0.0184, 0.0617, 0.0915, 0.0119, 0.1021, 0.1017,
        0.3864])
[rfa agg] iter:  7, prev_obj_val: 64.76000213623047, obj_val: 66.73270416259766, abs dis: 1.9727020263671875
[rfa agg] iter: 7, weight: tensor([0.0245, 0.1817, 0.0084, 0.0151, 0.0488, 0.0824, 0.0098, 0.0927, 0.0924,
        0.4442])
[rfa agg] iter:  8, prev_obj_val: 66.73270416259766, obj_val: 64.76000213623047, abs dis: 1.9727020263671875
[rfa agg] iter: 8, weight: tensor([0.0302, 0.1858, 0.0102, 0.0184, 0.0617, 0.0915, 0.0119, 0.1021, 0.1017,
        0.3864])
[rfa agg] iter:  9, prev_obj_val: 64.76000213623047, obj_val: 66.73270416259766, abs dis: 1.9727020263671875
[rfa agg] iter: 9, weight: tensor([0.0245, 0.1817, 0.0084, 0.0151, 0.0488, 0.0824, 0.0098, 0.0927, 0.0924,
        0.4442])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3560, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 4.9578, Accuracy: 10/9950 (0.1005%)
saving model
Done in 310.102463722229 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 312/712 (43.8202%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1004, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0553, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.9594, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0460, Accuracy: 326/813 (40.0984%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 495/813 (60.8856%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.6713, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0530, Accuracy: 330/1131 (29.1777%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 441/1131 (38.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6214, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 337/599 (56.2604%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.3810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0657, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0387, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7417, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0531, Accuracy: 449/1475 (30.4407%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0300, Accuracy: 729/1475 (49.4237%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4710, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0483, Accuracy: 668/2227 (29.9955%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1093/2227 (49.0795%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3004, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0547, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0276, Accuracy: 466/1154 (40.3813%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.8517, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0524, Accuracy: 305/590 (51.6949%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0317, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.9833, Accuracy: 50/10000 (0.5000%)
time spent on training: 173.48891615867615
[rfa agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 58, 53, 87, 95, 62, 65, 60, 57, 69], weight: tensor([0.0707, 0.0797, 0.0807, 0.1123, 0.0595, 0.0564, 0.1464, 0.2211, 0.1146,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 68.28929901123047, obj_val: 69.62161254882812, abs dis: 1.3323135375976562
[rfa agg] iter: 0, weight: tensor([0.0326, 0.0429, 0.0434, 0.2979, 0.0214, 0.0183, 0.0934, 0.0448, 0.3843,
        0.0211])
[rfa agg] iter:  1, prev_obj_val: 69.62161254882812, obj_val: 72.95684051513672, abs dis: 3.3352279663085938
[rfa agg] iter: 1, weight: tensor([0.0674, 0.0970, 0.0980, 0.2982, 0.0396, 0.0326, 0.0841, 0.0519, 0.1923,
        0.0390])
[rfa agg] iter:  2, prev_obj_val: 72.95684051513672, obj_val: 74.82913970947266, abs dis: 1.8722991943359375
[rfa agg] iter: 2, weight: tensor([0.1119, 0.2003, 0.2010, 0.1297, 0.0535, 0.0417, 0.0627, 0.0441, 0.1023,
        0.0528])
[rfa agg] iter:  3, prev_obj_val: 74.82913970947266, obj_val: 85.9070816040039, abs dis: 11.07794189453125
[rfa agg] iter: 3, weight: tensor([0.1168, 0.2906, 0.2834, 0.0664, 0.0450, 0.0335, 0.0373, 0.0276, 0.0552,
        0.0444])
[rfa agg] iter:  4, prev_obj_val: 85.9070816040039, obj_val: 85.87169647216797, abs dis: 0.0353851318359375
[rfa agg] iter: 4, weight: tensor([0.1862, 0.1216, 0.1225, 0.0502, 0.1614, 0.0861, 0.0353, 0.0289, 0.0447,
        0.1633])
[rfa agg] iter:  5, prev_obj_val: 85.87169647216797, obj_val: 88.81596374511719, abs dis: 2.9442672729492188
[rfa agg] iter: 5, weight: tensor([0.1887, 0.1189, 0.1201, 0.0495, 0.1643, 0.0855, 0.0348, 0.0285, 0.0441,
        0.1654])
[rfa agg] iter:  6, prev_obj_val: 88.81596374511719, obj_val: 95.65106964111328, abs dis: 6.835105895996094
[rfa agg] iter: 6, weight: tensor([0.1216, 0.0862, 0.0871, 0.0413, 0.2311, 0.1002, 0.0300, 0.0250, 0.0371,
        0.2405])
[rfa agg] iter:  7, prev_obj_val: 95.65106964111328, obj_val: 95.64214324951172, abs dis: 0.0089263916015625
[rfa agg] iter: 7, weight: tensor([0.0715, 0.0586, 0.0594, 0.0344, 0.2293, 0.2287, 0.0263, 0.0226, 0.0313,
        0.2379])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3569, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 4.9630, Accuracy: 8/9950 (0.0804%)
saving model
Done in 272.6358742713928 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0698, Accuracy: 117/631 (18.5420%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7333, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0233, Accuracy: 652/1030 (63.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.2171, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 345/1402 (24.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7526, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0594, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 316/946 (33.4038%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5409, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0581, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.1806, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0569, Accuracy: 361/1657 (21.7864%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0333, Accuracy: 555/1657 (33.4943%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.7509, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0551, Accuracy: 344/1645 (20.9119%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0311, Accuracy: 666/1645 (40.4863%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1748, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0332, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0633, Accuracy: 210/773 (27.1669%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0303, Accuracy: 404/773 (52.2639%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.2466, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0519, Accuracy: 314/590 (53.2203%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.4343, Accuracy: 50/10000 (0.5000%)
time spent on training: 175.13576793670654
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 91, 66, 43, 23, 0, 13, 89, 99, 69], weight: tensor([0.0614, 0.1001, 0.1363, 0.0920, 0.0695, 0.1611, 0.1599, 0.0871, 0.0752,
        0.0574])
[rfa agg] iter:  0, prev_obj_val: 51.29413986206055, obj_val: 55.29769515991211, abs dis: 4.0035552978515625
[rfa agg] iter: 0, weight: tensor([0.0344, 0.2363, 0.0763, 0.2357, 0.0578, 0.0544, 0.0540, 0.1366, 0.0824,
        0.0322])
[rfa agg] iter:  1, prev_obj_val: 55.29769515991211, obj_val: 68.00566101074219, abs dis: 12.707965850830078
[rfa agg] iter: 1, weight: tensor([0.0389, 0.0824, 0.0435, 0.1928, 0.0819, 0.0344, 0.0341, 0.3002, 0.1556,
        0.0364])
[rfa agg] iter:  2, prev_obj_val: 68.00566101074219, obj_val: 71.2335433959961, abs dis: 3.2278823852539062
[rfa agg] iter: 2, weight: tensor([0.1269, 0.0593, 0.0429, 0.0855, 0.2312, 0.0367, 0.0365, 0.1124, 0.1508,
        0.1179])
[rfa agg] iter:  3, prev_obj_val: 71.2335433959961, obj_val: 74.64842987060547, abs dis: 3.414886474609375
[rfa agg] iter: 3, weight: tensor([0.1797, 0.0550, 0.0413, 0.0754, 0.1930, 0.0359, 0.0356, 0.0941, 0.1197,
        0.1704])
[rfa agg] iter:  4, prev_obj_val: 74.64842987060547, obj_val: 74.63534545898438, abs dis: 0.01308441162109375
[rfa agg] iter: 4, weight: tensor([0.2585, 0.0458, 0.0356, 0.0607, 0.1265, 0.0313, 0.0310, 0.0733, 0.0876,
        0.2496])
[rfa agg] iter:  5, prev_obj_val: 74.63534545898438, obj_val: 74.6352310180664, abs dis: 0.00011444091796875
[rfa agg] iter: 5, weight: tensor([0.2672, 0.0446, 0.0347, 0.0591, 0.1212, 0.0305, 0.0302, 0.0715, 0.0851,
        0.2558])
[rfa agg] iter:  6, prev_obj_val: 74.6352310180664, obj_val: 78.27335357666016, abs dis: 3.63812255859375
[rfa agg] iter: 6, weight: tensor([0.2682, 0.0445, 0.0346, 0.0590, 0.1207, 0.0304, 0.0302, 0.0713, 0.0849,
        0.2561])
[rfa agg] iter:  7, prev_obj_val: 78.27335357666016, obj_val: 78.26264953613281, abs dis: 0.01070404052734375
[rfa agg] iter: 7, weight: tensor([0.3320, 0.0341, 0.0273, 0.0439, 0.0782, 0.0243, 0.0241, 0.0517, 0.0589,
        0.3255])
[rfa agg] iter:  8, prev_obj_val: 78.26264953613281, obj_val: 78.26243591308594, abs dis: 0.000213623046875
[rfa agg] iter: 8, weight: tensor([0.3425, 0.0323, 0.0259, 0.0415, 0.0735, 0.0230, 0.0228, 0.0489, 0.0557,
        0.3341])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3575, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 4.9825, Accuracy: 5/9950 (0.0503%)
saving model
Done in 276.0210883617401 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0500, Accuracy: 443/1440 (30.7639%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 693/1440 (48.1250%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9407, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0784, Accuracy: 78/460 (16.9565%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.2246, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 371/1662 (22.3225%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0321, Accuracy: 645/1662 (38.8087%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3329, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0569, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0335, Accuracy: 544/1657 (32.8304%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9108, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0483, Accuracy: 680/2227 (30.5344%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0272, Accuracy: 1056/2227 (47.4181%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2470, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0524, Accuracy: 427/1949 (21.9087%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.7322, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0799, Accuracy: 35/373 (9.3834%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0464, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.6148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0766, Accuracy: 74/426 (17.3709%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0408, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8283, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0811, Accuracy: 29/311 (9.3248%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8756, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0778, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3043, Accuracy: 61/10000 (0.6100%)
time spent on training: 185.82267045974731
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 31, 94, 0, 60, 21, 98, 67, 96, 30], weight: tensor([0.1310, 0.0419, 0.1512, 0.1508, 0.2026, 0.1773, 0.0339, 0.0388, 0.0283,
        0.0442])
[rfa agg] iter:  0, prev_obj_val: 75.76844024658203, obj_val: 73.00912475585938, abs dis: 2.7593154907226562
[rfa agg] iter: 0, weight: tensor([0.4508, 0.0135, 0.1676, 0.1658, 0.0704, 0.0888, 0.0096, 0.0117, 0.0075,
        0.0143])
[rfa agg] iter:  1, prev_obj_val: 73.00912475585938, obj_val: 68.72491455078125, abs dis: 4.284210205078125
[rfa agg] iter: 1, weight: tensor([0.5707, 0.0094, 0.1356, 0.1348, 0.0524, 0.0672, 0.0067, 0.0081, 0.0052,
        0.0099])
[rfa agg] iter:  2, prev_obj_val: 68.72491455078125, obj_val: 67.12953186035156, abs dis: 1.5953826904296875
[rfa agg] iter: 2, weight: tensor([0.5463, 0.0074, 0.1552, 0.1542, 0.0483, 0.0646, 0.0053, 0.0065, 0.0042,
        0.0079])
[rfa agg] iter:  3, prev_obj_val: 67.12953186035156, obj_val: 67.08470153808594, abs dis: 0.044830322265625
[rfa agg] iter: 3, weight: tensor([0.3849, 0.0085, 0.2203, 0.2188, 0.0593, 0.0810, 0.0061, 0.0074, 0.0048,
        0.0089])
[rfa agg] iter:  4, prev_obj_val: 67.08470153808594, obj_val: 68.75802612304688, abs dis: 1.6733245849609375
[rfa agg] iter: 4, weight: tensor([0.3648, 0.0086, 0.2290, 0.2269, 0.0603, 0.0826, 0.0062, 0.0075, 0.0049,
        0.0091])
[rfa agg] iter:  5, prev_obj_val: 68.75802612304688, obj_val: 68.72496032714844, abs dis: 0.0330657958984375
[rfa agg] iter: 5, weight: tensor([0.4885, 0.0083, 0.1761, 0.1747, 0.0538, 0.0719, 0.0060, 0.0072, 0.0047,
        0.0088])
[rfa agg] iter:  6, prev_obj_val: 68.72496032714844, obj_val: 68.72250366210938, abs dis: 0.0024566650390625
[rfa agg] iter: 6, weight: tensor([0.5227, 0.0078, 0.1637, 0.1627, 0.0506, 0.0676, 0.0056, 0.0068, 0.0044,
        0.0082])
[rfa agg] iter:  7, prev_obj_val: 68.72250366210938, obj_val: 68.72232055664062, abs dis: 0.00018310546875
[rfa agg] iter: 7, weight: tensor([0.5319, 0.0077, 0.1604, 0.1594, 0.0497, 0.0664, 0.0055, 0.0067, 0.0043,
        0.0081])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3568, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.0033, Accuracy: 12/9950 (0.1206%)
saving model
Done in 283.540931224823 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 334/1446 (23.0982%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0338, Accuracy: 516/1446 (35.6846%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5898, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0657, Accuracy: 221/669 (33.0344%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0380, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2995, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0484, Accuracy: 386/1036 (37.2587%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 659/1036 (63.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.6209, Accuracy: 77/10000 (0.7700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0486, Accuracy: 456/1574 (28.9708%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0262, Accuracy: 709/1574 (45.0445%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.6790, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0603, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0309, Accuracy: 468/1190 (39.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9854, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0581, Accuracy: 320/1513 (21.1500%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0353, Accuracy: 521/1513 (34.4349%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8059, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.6060, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0645, Accuracy: 158/682 (23.1672%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0359, Accuracy: 254/682 (37.2434%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7783, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 355/803 (44.2092%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 392/803 (48.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2268, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0672, Accuracy: 135/631 (21.3946%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0390, Accuracy: 249/631 (39.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2520, Accuracy: 61/10000 (0.6100%)
time spent on training: 190.45290112495422
[rfa agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[rfa agg] considering poison per batch poison_fraction: 0.04812396047353487
[rfa agg] init. name: [26, 45, 19, 17, 84, 8, 90, 80, 58, 48], weight: tensor([0.1415, 0.0655, 0.1014, 0.1540, 0.1164, 0.1480, 0.0662, 0.0667, 0.0786,
        0.0617])
[rfa agg] iter:  0, prev_obj_val: 49.650230407714844, obj_val: 55.12664794921875, abs dis: 5.476417541503906
[rfa agg] iter: 0, weight: tensor([0.0787, 0.0431, 0.3777, 0.0658, 0.1610, 0.0716, 0.0438, 0.0439, 0.0800,
        0.0345])
[rfa agg] iter:  1, prev_obj_val: 55.12664794921875, obj_val: 58.07783126831055, abs dis: 2.951183319091797
[rfa agg] iter: 1, weight: tensor([0.0727, 0.0802, 0.1738, 0.0642, 0.1120, 0.0682, 0.0821, 0.0822, 0.2049,
        0.0596])
[rfa agg] iter:  2, prev_obj_val: 58.07783126831055, obj_val: 61.69173049926758, abs dis: 3.6138992309570312
[rfa agg] iter: 2, weight: tensor([0.0523, 0.0891, 0.1000, 0.0471, 0.0739, 0.0496, 0.0917, 0.0912, 0.3438,
        0.0613])
[rfa agg] iter:  3, prev_obj_val: 61.69173049926758, obj_val: 68.871337890625, abs dis: 7.179607391357422
[rfa agg] iter: 3, weight: tensor([0.0402, 0.1188, 0.0664, 0.0368, 0.0531, 0.0384, 0.1252, 0.1218, 0.3277,
        0.0716])
[rfa agg] iter:  4, prev_obj_val: 68.871337890625, obj_val: 68.75750732421875, abs dis: 0.11383056640625
[rfa agg] iter: 4, weight: tensor([0.0237, 0.2023, 0.0338, 0.0222, 0.0292, 0.0230, 0.2730, 0.2100, 0.0768,
        0.1060])
[rfa agg] iter:  5, prev_obj_val: 68.75750732421875, obj_val: 89.0702896118164, abs dis: 20.312782287597656
[rfa agg] iter: 5, weight: tensor([0.0213, 0.2111, 0.0303, 0.0199, 0.0262, 0.0206, 0.2943, 0.2117, 0.0671,
        0.0974])
[rfa agg] iter:  6, prev_obj_val: 89.0702896118164, obj_val: 61.73238754272461, abs dis: 27.337902069091797
[rfa agg] iter: 6, weight: tensor([0.0526, 0.1382, 0.0642, 0.0504, 0.0597, 0.0516, 0.1415, 0.1407, 0.0932,
        0.2079])
[rfa agg] iter:  7, prev_obj_val: 61.73238754272461, obj_val: 72.25155639648438, abs dis: 10.519168853759766
[rfa agg] iter: 7, weight: tensor([0.0423, 0.1280, 0.0698, 0.0387, 0.0560, 0.0404, 0.1331, 0.1297, 0.2858,
        0.0762])
[rfa agg] iter:  8, prev_obj_val: 72.25155639648438, obj_val: 72.17723846435547, abs dis: 0.07431793212890625
[rfa agg] iter: 8, weight: tensor([0.0262, 0.1875, 0.0360, 0.0246, 0.0317, 0.0254, 0.2226, 0.1930, 0.0713,
        0.1818])
[rfa agg] iter:  9, prev_obj_val: 72.17723846435547, obj_val: 72.17709350585938, abs dis: 0.00014495849609375
[rfa agg] iter: 9, weight: tensor([0.0250, 0.1930, 0.0342, 0.0235, 0.0301, 0.0242, 0.2219, 0.1920, 0.0668,
        0.1893])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3572, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.0188, Accuracy: 8/9950 (0.0804%)
saving model
Done in 291.7875146865845 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0471, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.5626, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1048, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0888, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4505, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0481, Accuracy: 339/590 (57.4576%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0286, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.5503, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1215, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1099, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 509/1340 (37.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.2218, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0532, Accuracy: 299/1071 (27.9178%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0275, Accuracy: 524/1071 (48.9262%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8673, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0879, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0521, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.4177, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0468, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0164, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0635, Accuracy: 228/669 (34.0807%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0385, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.4149, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 450/1089 (41.3223%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.1957, Accuracy: 60/10000 (0.6000%)
time spent on training: 150.14079594612122
[rfa agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 79, 69, 47, 77, 55, 36, 82, 45, 59], weight: tensor([0.0533, 0.0311, 0.0931, 0.0211, 0.2115, 0.1690, 0.0644, 0.0789, 0.1056,
        0.1719])
[rfa agg] iter:  0, prev_obj_val: 50.00912094116211, obj_val: 53.48380661010742, abs dis: 3.4746856689453125
[rfa agg] iter: 0, weight: tensor([0.0298, 0.0128, 0.1796, 0.0077, 0.0685, 0.0940, 0.0439, 0.0689, 0.4142,
        0.0807])
[rfa agg] iter:  1, prev_obj_val: 53.48380661010742, obj_val: 59.87099838256836, abs dis: 6.3871917724609375
[rfa agg] iter: 1, weight: tensor([0.0316, 0.0123, 0.4187, 0.0072, 0.0457, 0.0572, 0.0506, 0.0917, 0.2344,
        0.0507])
[rfa agg] iter:  2, prev_obj_val: 59.87099838256836, obj_val: 65.00779724121094, abs dis: 5.136798858642578
[rfa agg] iter: 2, weight: tensor([0.0603, 0.0197, 0.1730, 0.0110, 0.0484, 0.0567, 0.1185, 0.3427, 0.1183,
        0.0515])
[rfa agg] iter:  3, prev_obj_val: 65.00779724121094, obj_val: 68.03411102294922, abs dis: 3.0263137817382812
[rfa agg] iter: 3, weight: tensor([0.0850, 0.0217, 0.0897, 0.0115, 0.0383, 0.0435, 0.2603, 0.3371, 0.0730,
        0.0399])
[rfa agg] iter:  4, prev_obj_val: 68.03411102294922, obj_val: 68.00628662109375, abs dis: 0.02782440185546875
[rfa agg] iter: 4, weight: tensor([0.1073, 0.0217, 0.0645, 0.0111, 0.0318, 0.0355, 0.4797, 0.1607, 0.0551,
        0.0328])
[rfa agg] iter:  5, prev_obj_val: 68.00628662109375, obj_val: 71.44174194335938, abs dis: 3.435455322265625
[rfa agg] iter: 5, weight: tensor([0.0882, 0.0178, 0.0529, 0.0091, 0.0261, 0.0291, 0.5755, 0.1292, 0.0452,
        0.0269])
[rfa agg] iter:  6, prev_obj_val: 71.44174194335938, obj_val: 71.42684936523438, abs dis: 0.014892578125
[rfa agg] iter: 6, weight: tensor([0.2383, 0.0326, 0.0697, 0.0159, 0.0386, 0.0425, 0.3256, 0.1356, 0.0616,
        0.0394])
[rfa agg] iter:  7, prev_obj_val: 71.42684936523438, obj_val: 68.02272033691406, abs dis: 3.4041290283203125
[rfa agg] iter: 7, weight: tensor([0.2520, 0.0329, 0.0702, 0.0160, 0.0388, 0.0428, 0.3086, 0.1369, 0.0621,
        0.0397])
[rfa agg] iter:  8, prev_obj_val: 68.02272033691406, obj_val: 65.01518249511719, abs dis: 3.007537841796875
[rfa agg] iter: 8, weight: tensor([0.1024, 0.0204, 0.0606, 0.0105, 0.0299, 0.0334, 0.5116, 0.1485, 0.0518,
        0.0308])
[rfa agg] iter:  9, prev_obj_val: 65.01518249511719, obj_val: 64.99720764160156, abs dis: 0.017974853515625
[rfa agg] iter: 9, weight: tensor([0.0839, 0.0213, 0.0878, 0.0113, 0.0377, 0.0427, 0.2917, 0.3127, 0.0717,
        0.0392])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3572, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.0299, Accuracy: 6/9950 (0.0603%)
saving model
Done in 246.06407356262207 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0500, Accuracy: 376/1130 (33.2743%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.6931, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0528, Accuracy: 324/712 (45.5056%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0217, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0762, Accuracy: 70/440 (15.9091%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0455, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4910, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0623, Accuracy: 200/818 (24.4499%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0288, Accuracy: 401/818 (49.0220%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7821, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0540, Accuracy: 384/1645 (23.3435%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 694/1645 (42.1884%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.4276, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0785, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0422, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4766, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0661, Accuracy: 141/631 (22.3455%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0392, Accuracy: 248/631 (39.3027%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9305, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0756, Accuracy: 96/486 (19.7531%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0386, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.5308, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0441, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.6880, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0521, Accuracy: 317/1071 (29.5985%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0279, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.9192, Accuracy: 83/10000 (0.8300%)
time spent on training: 161.83220314979553
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 11, 49, 71, 13, 24, 48, 30, 76, 55], weight: tensor([0.1465, 0.0923, 0.0571, 0.1061, 0.2133, 0.0405, 0.0818, 0.0630, 0.0604,
        0.1389])
[rfa agg] iter:  0, prev_obj_val: 51.89510726928711, obj_val: 56.80942916870117, abs dis: 4.9143218994140625
[rfa agg] iter: 0, weight: tensor([0.0743, 0.2032, 0.0243, 0.4243, 0.0420, 0.0130, 0.0686, 0.0322, 0.0308,
        0.0873])
[rfa agg] iter:  1, prev_obj_val: 56.80942916870117, obj_val: 58.529579162597656, abs dis: 1.7201499938964844
[rfa agg] iter: 1, weight: tensor([0.0648, 0.2537, 0.0441, 0.1618, 0.0442, 0.0209, 0.2133, 0.0645, 0.0616,
        0.0712])
[rfa agg] iter:  2, prev_obj_val: 58.529579162597656, obj_val: 58.515174865722656, abs dis: 0.014404296875
[rfa agg] iter: 2, weight: tensor([0.0568, 0.1723, 0.0473, 0.1204, 0.0401, 0.0214, 0.3384, 0.0725, 0.0690,
        0.0618])
[rfa agg] iter:  3, prev_obj_val: 58.515174865722656, obj_val: 60.443023681640625, abs dis: 1.9278488159179688
[rfa agg] iter: 3, weight: tensor([0.0552, 0.1660, 0.0460, 0.1167, 0.0390, 0.0208, 0.3586, 0.0705, 0.0672,
        0.0600])
[rfa agg] iter:  4, prev_obj_val: 60.443023681640625, obj_val: 65.23165893554688, abs dis: 4.78863525390625
[rfa agg] iter: 4, weight: tensor([0.0432, 0.1061, 0.0447, 0.0818, 0.0315, 0.0191, 0.4850, 0.0728, 0.0692,
        0.0466])
[rfa agg] iter:  5, prev_obj_val: 65.23165893554688, obj_val: 70.51163482666016, abs dis: 5.279975891113281
[rfa agg] iter: 5, weight: tensor([0.0494, 0.0922, 0.0852, 0.0795, 0.0381, 0.0307, 0.2376, 0.1730, 0.1620,
        0.0525])
[rfa agg] iter:  6, prev_obj_val: 70.51163482666016, obj_val: 70.47716522216797, abs dis: 0.0344696044921875
[rfa agg] iter: 6, weight: tensor([0.0303, 0.0474, 0.1115, 0.0436, 0.0245, 0.0278, 0.0826, 0.3276, 0.2728,
        0.0318])
[rfa agg] iter:  7, prev_obj_val: 70.47716522216797, obj_val: 73.80677795410156, abs dis: 3.3296127319335938
[rfa agg] iter: 7, weight: tensor([0.0278, 0.0436, 0.1026, 0.0400, 0.0225, 0.0256, 0.0751, 0.3543, 0.2793,
        0.0292])
[rfa agg] iter:  8, prev_obj_val: 73.80677795410156, obj_val: 70.48506164550781, abs dis: 3.32171630859375
[rfa agg] iter: 8, weight: tensor([0.0332, 0.0486, 0.2220, 0.0457, 0.0275, 0.0383, 0.0763, 0.2513, 0.2223,
        0.0347])
[rfa agg] iter:  9, prev_obj_val: 70.48506164550781, obj_val: 70.476806640625, abs dis: 0.0082550048828125
[rfa agg] iter: 9, weight: tensor([0.0287, 0.0449, 0.1071, 0.0413, 0.0232, 0.0263, 0.0775, 0.3438, 0.2772,
        0.0301])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3562, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.0485, Accuracy: 7/9950 (0.0704%)
saving model
Done in 262.35038590431213 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0570, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0335, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.0369, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 328/712 (46.0674%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0271, Accuracy: 413/712 (58.0056%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.2434, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0544, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0222, Accuracy: 602/928 (64.8707%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.5098, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 265/1402 (18.9016%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 416/1402 (29.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0267, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0663, Accuracy: 136/631 (21.5531%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0386, Accuracy: 249/631 (39.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.9896, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0623, Accuracy: 195/818 (23.8386%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0284, Accuracy: 401/818 (49.0220%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6386, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0818, Accuracy: 61/515 (11.8447%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0495, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.7965, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0456, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5022, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0597, Accuracy: 322/719 (44.7844%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0324, Accuracy: 440/719 (61.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7051, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0537, Accuracy: 372/1956 (19.0184%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0307, Accuracy: 693/1956 (35.4294%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3509, Accuracy: 124/10000 (1.2400%)
time spent on training: 172.17913031578064
[rfa agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 11, 1, 66, 48, 71, 33, 12, 41, 6], weight: tensor([0.0910, 0.0807, 0.1052, 0.1589, 0.0715, 0.0927, 0.0584, 0.0383, 0.0815,
        0.2217])
[rfa agg] iter:  0, prev_obj_val: 59.988075256347656, obj_val: 62.869895935058594, abs dis: 2.8818206787109375
[rfa agg] iter: 0, weight: tensor([0.1326, 0.0805, 0.3719, 0.0690, 0.0435, 0.1366, 0.0296, 0.0130, 0.0809,
        0.0424])
[rfa agg] iter:  1, prev_obj_val: 62.869895935058594, obj_val: 67.89813232421875, abs dis: 5.028236389160156
[rfa agg] iter: 1, weight: tensor([0.1455, 0.2284, 0.0673, 0.0309, 0.0664, 0.1572, 0.0371, 0.0124, 0.2320,
        0.0228])
[rfa agg] iter:  2, prev_obj_val: 67.89813232421875, obj_val: 70.8187484741211, abs dis: 2.9206161499023438
[rfa agg] iter: 2, weight: tensor([0.1147, 0.1878, 0.0679, 0.0380, 0.1644, 0.1184, 0.0738, 0.0202, 0.1856,
        0.0292])
[rfa agg] iter:  3, prev_obj_val: 70.8187484741211, obj_val: 77.34181213378906, abs dis: 6.523063659667969
[rfa agg] iter: 3, weight: tensor([0.0967, 0.1382, 0.0628, 0.0377, 0.2756, 0.0992, 0.0995, 0.0232, 0.1376,
        0.0295])
[rfa agg] iter:  4, prev_obj_val: 77.34181213378906, obj_val: 81.00701904296875, abs dis: 3.6652069091796875
[rfa agg] iter: 4, weight: tensor([0.0725, 0.0889, 0.0534, 0.0359, 0.3059, 0.0741, 0.2203, 0.0308, 0.0892,
        0.0291])
[rfa agg] iter:  5, prev_obj_val: 81.00701904296875, obj_val: 88.99154663085938, abs dis: 7.984527587890625
[rfa agg] iter: 5, weight: tensor([0.0670, 0.0785, 0.0516, 0.0363, 0.1965, 0.0683, 0.3553, 0.0377, 0.0788,
        0.0300])
[rfa agg] iter:  6, prev_obj_val: 88.99154663085938, obj_val: 67.91915893554688, abs dis: 21.0723876953125
[rfa agg] iter: 6, weight: tensor([0.0821, 0.0906, 0.0677, 0.0515, 0.1577, 0.0837, 0.2464, 0.0855, 0.0912,
        0.0437])
[rfa agg] iter:  7, prev_obj_val: 67.91915893554688, obj_val: 67.8890609741211, abs dis: 0.03009796142578125
[rfa agg] iter: 7, weight: tensor([0.1157, 0.1837, 0.0683, 0.0383, 0.1699, 0.1187, 0.0757, 0.0203, 0.1799,
        0.0294])
[rfa agg] iter:  8, prev_obj_val: 67.8890609741211, obj_val: 70.81795501708984, abs dis: 2.92889404296875
[rfa agg] iter: 8, weight: tensor([0.1147, 0.1863, 0.0678, 0.0380, 0.1688, 0.1182, 0.0740, 0.0201, 0.1829,
        0.0292])
[rfa agg] iter:  9, prev_obj_val: 70.81795501708984, obj_val: 77.3417739868164, abs dis: 6.5238189697265625
[rfa agg] iter: 9, weight: tensor([0.0966, 0.1380, 0.0628, 0.0377, 0.2762, 0.0992, 0.0994, 0.0232, 0.1374,
        0.0295])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3566, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.0634, Accuracy: 6/9950 (0.0603%)
saving model
Done in 269.420126914978 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 335/712 (47.0506%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0271, Accuracy: 396/712 (55.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6586, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0482, Accuracy: 663/2227 (29.7710%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3612, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0595, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0345, Accuracy: 356/946 (37.6321%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2292, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0814, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0443, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.1882, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 354/1372 (25.8017%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0304, Accuracy: 553/1372 (40.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7209, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0550, Accuracy: 292/1049 (27.8360%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0285, Accuracy: 555/1049 (52.9075%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.9539, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0531, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.6426, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0492, Accuracy: 358/1030 (34.7573%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0249, Accuracy: 664/1030 (64.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.5423, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0533, Accuracy: 453/1418 (31.9464%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 708/1418 (49.9295%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7538, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0508, Accuracy: 285/861 (33.1010%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0200, Accuracy: 472/861 (54.8200%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.9418, Accuracy: 96/10000 (0.9600%)
time spent on training: 195.37400937080383
[rfa agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 60, 43, 76, 42, 51, 33, 91, 70, 10], weight: tensor([0.0672, 0.2102, 0.0893, 0.0440, 0.1295, 0.0990, 0.0486, 0.0972, 0.1338,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 62.192909240722656, obj_val: 66.28595733642578, abs dis: 4.093048095703125
[rfa agg] iter: 0, weight: tensor([0.0397, 0.0441, 0.1030, 0.0157, 0.1134, 0.2485, 0.0192, 0.2508, 0.0942,
        0.0714])
[rfa agg] iter:  1, prev_obj_val: 66.28595733642578, obj_val: 72.46044921875, abs dis: 6.174491882324219
[rfa agg] iter: 1, weight: tensor([0.0551, 0.0316, 0.2864, 0.0172, 0.0580, 0.1679, 0.0218, 0.1685, 0.0520,
        0.1415])
[rfa agg] iter:  2, prev_obj_val: 72.46044921875, obj_val: 72.38978576660156, abs dis: 0.0706634521484375
[rfa agg] iter: 2, weight: tensor([0.0916, 0.0288, 0.2221, 0.0210, 0.0464, 0.0906, 0.0278, 0.0898, 0.0427,
        0.3392])
[rfa agg] iter:  3, prev_obj_val: 72.38978576660156, obj_val: 84.37890625, abs dis: 11.989120483398438
[rfa agg] iter: 3, weight: tensor([0.0829, 0.0260, 0.1980, 0.0190, 0.0419, 0.0811, 0.0251, 0.0804, 0.0385,
        0.4072])
[rfa agg] iter:  4, prev_obj_val: 84.37890625, obj_val: 78.11128997802734, abs dis: 6.267616271972656
[rfa agg] iter: 4, weight: tensor([0.3640, 0.0345, 0.1101, 0.0412, 0.0488, 0.0733, 0.0601, 0.0723, 0.0459,
        0.1498])
[rfa agg] iter:  5, prev_obj_val: 78.11128997802734, obj_val: 81.12355041503906, abs dis: 3.0122604370117188
[rfa agg] iter: 5, weight: tensor([0.2209, 0.0345, 0.1538, 0.0317, 0.0518, 0.0866, 0.0435, 0.0855, 0.0482,
        0.2434])
[rfa agg] iter:  6, prev_obj_val: 81.12355041503906, obj_val: 81.11396026611328, abs dis: 0.00959014892578125
[rfa agg] iter: 6, weight: tensor([0.3213, 0.0339, 0.1260, 0.0353, 0.0494, 0.0780, 0.0498, 0.0769, 0.0462,
        0.1833])
[rfa agg] iter:  7, prev_obj_val: 81.11396026611328, obj_val: 81.11370086669922, abs dis: 0.0002593994140625
[rfa agg] iter: 7, weight: tensor([0.3394, 0.0332, 0.1230, 0.0345, 0.0482, 0.0761, 0.0487, 0.0751, 0.0451,
        0.1767])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3583, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.0631, Accuracy: 6/9950 (0.0603%)
saving model
Done in 294.3897683620453 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0552, Accuracy: 229/735 (31.1565%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0212, Accuracy: 398/735 (54.1497%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.6270, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1110, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0536, Accuracy: 406/1662 (24.4284%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0317, Accuracy: 663/1662 (39.8917%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.5151, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0543, Accuracy: 270/1049 (25.7388%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 550/1049 (52.4309%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1626, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5802, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 351/1340 (26.1940%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0258, Accuracy: 617/1340 (46.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.3600, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0260, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2546, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0539, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0303, Accuracy: 747/1904 (39.2332%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0482, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0558, Accuracy: 380/1657 (22.9330%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0333, Accuracy: 552/1657 (33.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3023, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 463/1953 (23.7071%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 808/1953 (41.3722%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4413, Accuracy: 118/10000 (1.1800%)
time spent on training: 204.88320684432983
[rfa agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 58, 94, 51, 24, 77, 25, 46, 0, 83], weight: tensor([0.0607, 0.0663, 0.1373, 0.0867, 0.0258, 0.1107, 0.0570, 0.1573, 0.1369,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 62.23423767089844, obj_val: 67.01957702636719, abs dis: 4.78533935546875
[rfa agg] iter: 0, weight: tensor([0.0263, 0.0324, 0.1058, 0.0824, 0.0063, 0.4882, 0.0223, 0.0680, 0.1055,
        0.0629])
[rfa agg] iter:  1, prev_obj_val: 67.01957702636719, obj_val: 68.80070495605469, abs dis: 1.7811279296875
[rfa agg] iter: 1, weight: tensor([0.0405, 0.0510, 0.1049, 0.1602, 0.0089, 0.3508, 0.0336, 0.0749, 0.1048,
        0.0703])
[rfa agg] iter:  2, prev_obj_val: 68.80070495605469, obj_val: 68.7945556640625, abs dis: 0.0061492919921875
[rfa agg] iter: 2, weight: tensor([0.0462, 0.0589, 0.1040, 0.2097, 0.0099, 0.2815, 0.0380, 0.0762, 0.1038,
        0.0718])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3567, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.0472, Accuracy: 10/9950 (0.1005%)
saving model
Done in 301.94254660606384 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0513, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0264, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9098, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0704, Accuracy: 125/781 (16.0051%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0342, Accuracy: 266/781 (34.0589%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4321, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0588, Accuracy: 281/1131 (24.8453%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0287, Accuracy: 525/1131 (46.4191%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6702, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0319, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1671, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 346/803 (43.0884%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0328, Accuracy: 405/803 (50.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.9535, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0609, Accuracy: 262/1241 (21.1120%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 444/1241 (35.7776%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0555, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0806, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0490, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7636, Accuracy: 54/10000 (0.5400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0487, Accuracy: 476/1574 (30.2414%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0256, Accuracy: 729/1574 (46.3151%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4098, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0532, Accuracy: 338/1131 (29.8851%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0303, Accuracy: 467/1131 (41.2909%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5503, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0517, Accuracy: 357/1372 (26.0204%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 561/1372 (40.8892%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.9060, Accuracy: 96/10000 (0.9600%)
time spent on training: 203.92220664024353
[rfa agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.04637267841991138
[rfa agg] init. name: [77, 3, 38, 41, 58, 72, 33, 17, 87, 42], weight: tensor([0.1263, 0.0736, 0.1066, 0.0678, 0.0757, 0.1170, 0.0486, 0.1484, 0.1066,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 46.828163146972656, obj_val: 53.28241729736328, abs dis: 6.454254150390625
[rfa agg] iter: 0, weight: tensor([0.0845, 0.1432, 0.1386, 0.0893, 0.1452, 0.0937, 0.0326, 0.0599, 0.1387,
        0.0742])
[rfa agg] iter:  1, prev_obj_val: 53.28241729736328, obj_val: 62.3168830871582, abs dis: 9.034465789794922
[rfa agg] iter: 1, weight: tensor([0.0471, 0.2799, 0.0656, 0.1164, 0.2664, 0.0503, 0.0301, 0.0362, 0.0656,
        0.0425])
[rfa agg] iter:  2, prev_obj_val: 62.3168830871582, obj_val: 66.06459045410156, abs dis: 3.7477073669433594
[rfa agg] iter: 2, weight: tensor([0.0404, 0.1925, 0.0509, 0.3144, 0.1926, 0.0421, 0.0459, 0.0330, 0.0509,
        0.0373])
[rfa agg] iter:  3, prev_obj_val: 66.06459045410156, obj_val: 58.83390808105469, abs dis: 7.230682373046875
[rfa agg] iter: 3, weight: tensor([0.0453, 0.1584, 0.0556, 0.3338, 0.1606, 0.0469, 0.0645, 0.0375, 0.0556,
        0.0420])
[rfa agg] iter:  4, prev_obj_val: 58.83390808105469, obj_val: 66.07270050048828, abs dis: 7.238792419433594
[rfa agg] iter: 4, weight: tensor([0.0367, 0.2480, 0.0476, 0.2460, 0.2385, 0.0385, 0.0340, 0.0294, 0.0475,
        0.0337])
[rfa agg] iter:  5, prev_obj_val: 66.07270050048828, obj_val: 62.274898529052734, abs dis: 3.797801971435547
[rfa agg] iter: 5, weight: tensor([0.0459, 0.1617, 0.0564, 0.3220, 0.1640, 0.0475, 0.0654, 0.0381, 0.0564,
        0.0426])
[rfa agg] iter:  6, prev_obj_val: 62.274898529052734, obj_val: 66.06491088867188, abs dis: 3.7900123596191406
[rfa agg] iter: 6, weight: tensor([0.0372, 0.1725, 0.0468, 0.3790, 0.1723, 0.0387, 0.0422, 0.0303, 0.0468,
        0.0343])
[rfa agg] iter:  7, prev_obj_val: 66.06491088867188, obj_val: 66.06322479248047, abs dis: 0.00168609619140625
[rfa agg] iter: 7, weight: tensor([0.0446, 0.1556, 0.0548, 0.3445, 0.1576, 0.0462, 0.0635, 0.0370, 0.0548,
        0.0414])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3566, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.0671, Accuracy: 9/9950 (0.0905%)
saving model
Done in 302.58590054512024 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 463/891 (51.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7767, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0569, Accuracy: 293/708 (41.3842%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0406, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 499/1446 (34.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9269, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0557, Accuracy: 362/803 (45.0809%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9179, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0593, Accuracy: 294/946 (31.0782%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0339, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1079, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0793, Accuracy: 88/460 (19.1304%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0345, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9306, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0496, Accuracy: 354/1030 (34.3689%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0231, Accuracy: 672/1030 (65.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.8562, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0534, Accuracy: 428/1475 (29.0169%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0294, Accuracy: 673/1475 (45.6271%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7820, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0525, Accuracy: 469/1418 (33.0748%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0290, Accuracy: 712/1418 (50.2116%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0387, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0618, Accuracy: 189/818 (23.1051%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0289, Accuracy: 383/818 (46.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.1337, Accuracy: 79/10000 (0.7900%)
time spent on training: 187.4005389213562
[rfa agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 16, 26, 58, 43, 31, 91, 65, 70, 71], weight: tensor([0.0891, 0.0708, 0.1447, 0.0803, 0.0946, 0.0460, 0.1031, 0.1476, 0.1419,
        0.0818])
[rfa agg] iter:  0, prev_obj_val: 43.505828857421875, obj_val: 45.05420684814453, abs dis: 1.5483779907226562
[rfa agg] iter: 0, weight: tensor([0.1430, 0.0548, 0.0528, 0.0857, 0.3021, 0.0169, 0.1578, 0.0476, 0.0518,
        0.0874])
[rfa agg] iter:  1, prev_obj_val: 45.05420684814453, obj_val: 56.98535919189453, abs dis: 11.93115234375
[rfa agg] iter: 1, weight: tensor([0.2207, 0.0609, 0.0377, 0.1108, 0.2855, 0.0157, 0.0860, 0.0344, 0.0370,
        0.1113])
[rfa agg] iter:  2, prev_obj_val: 56.98535919189453, obj_val: 60.64097595214844, abs dis: 3.6556167602539062
[rfa agg] iter: 2, weight: tensor([0.1097, 0.2694, 0.0340, 0.1813, 0.0806, 0.0296, 0.0525, 0.0318, 0.0334,
        0.1777])
[rfa agg] iter:  3, prev_obj_val: 60.64097595214844, obj_val: 64.57451629638672, abs dis: 3.9335403442382812
[rfa agg] iter: 3, weight: tensor([0.1035, 0.3002, 0.0381, 0.1532, 0.0806, 0.0396, 0.0560, 0.0357, 0.0374,
        0.1556])
[rfa agg] iter:  4, prev_obj_val: 64.57451629638672, obj_val: 56.88193130493164, abs dis: 7.692584991455078
[rfa agg] iter: 4, weight: tensor([0.1102, 0.2440, 0.0460, 0.1482, 0.0894, 0.0581, 0.0648, 0.0433, 0.0452,
        0.1508])
[rfa agg] iter:  5, prev_obj_val: 56.88193130493164, obj_val: 60.63985824584961, abs dis: 3.7579269409179688
[rfa agg] iter: 5, weight: tensor([0.0992, 0.3238, 0.0313, 0.1673, 0.0734, 0.0273, 0.0482, 0.0292, 0.0306,
        0.1698])
[rfa agg] iter:  6, prev_obj_val: 60.63985824584961, obj_val: 68.56460571289062, abs dis: 7.924747467041016
[rfa agg] iter: 6, weight: tensor([0.1022, 0.3087, 0.0377, 0.1510, 0.0798, 0.0392, 0.0554, 0.0354, 0.0370,
        0.1537])
[rfa agg] iter:  7, prev_obj_val: 68.56460571289062, obj_val: 56.889739990234375, abs dis: 11.67486572265625
[rfa agg] iter: 7, weight: tensor([0.1123, 0.2031, 0.0521, 0.1416, 0.0939, 0.0817, 0.0707, 0.0492, 0.0511,
        0.1442])
[rfa agg] iter:  8, prev_obj_val: 56.889739990234375, obj_val: 60.639808654785156, abs dis: 3.7500686645507812
[rfa agg] iter: 8, weight: tensor([0.1006, 0.3144, 0.0317, 0.1696, 0.0745, 0.0277, 0.0488, 0.0296, 0.0311,
        0.1720])
[rfa agg] iter:  9, prev_obj_val: 60.639808654785156, obj_val: 64.5749282836914, abs dis: 3.93511962890625
[rfa agg] iter: 9, weight: tensor([0.1025, 0.3073, 0.0378, 0.1514, 0.0799, 0.0393, 0.0555, 0.0354, 0.0370,
        0.1541])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3578, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.0726, Accuracy: 5/9950 (0.0503%)
saving model
Done in 288.85587549209595 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0490, Accuracy: 369/1030 (35.8252%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0244, Accuracy: 664/1030 (64.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.7698, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0486, Accuracy: 368/1275 (28.8627%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0183, Accuracy: 755/1275 (59.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.1366, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0814, Accuracy: 58/416 (13.9423%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 223/416 (53.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.0010, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0636, Accuracy: 240/774 (31.0078%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0341, Accuracy: 345/774 (44.5736%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.5702, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0509, Accuracy: 373/1130 (33.0088%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 493/1130 (43.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.6821, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0545, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0216, Accuracy: 632/928 (68.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.4075, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0523, Accuracy: 281/888 (31.6441%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0247, Accuracy: 486/888 (54.7297%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.0536, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 430/1953 (22.0174%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0322, Accuracy: 824/1953 (42.1915%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1123, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0340, Accuracy: 352/946 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3462, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0607, Accuracy: 195/953 (20.4617%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0363, Accuracy: 333/953 (34.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9655, Accuracy: 73/10000 (0.7300%)
time spent on training: 202.20643305778503
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 9, 78, 81, 54, 1, 63, 83, 43, 64], weight: tensor([0.1001, 0.1239, 0.0404, 0.0752, 0.1098, 0.0902, 0.0863, 0.1897, 0.0919,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 44.91641616821289, obj_val: 52.34383010864258, abs dis: 7.4274139404296875
[rfa agg] iter: 0, weight: tensor([0.0753, 0.0407, 0.0084, 0.0592, 0.0586, 0.1822, 0.1200, 0.0197, 0.2093,
        0.2268])
[rfa agg] iter:  1, prev_obj_val: 52.34383010864258, obj_val: 59.539527893066406, abs dis: 7.195697784423828
[rfa agg] iter: 1, weight: tensor([0.0608, 0.0417, 0.0137, 0.1985, 0.0529, 0.1176, 0.2391, 0.0239, 0.1244,
        0.1275])
[rfa agg] iter:  2, prev_obj_val: 59.539527893066406, obj_val: 55.739139556884766, abs dis: 3.8003883361816406
[rfa agg] iter: 2, weight: tensor([0.0656, 0.0494, 0.0220, 0.2915, 0.0594, 0.1032, 0.1626, 0.0309, 0.1068,
        0.1085])
[rfa agg] iter:  3, prev_obj_val: 55.739139556884766, obj_val: 63.49617385864258, abs dis: 7.7570343017578125
[rfa agg] iter: 3, weight: tensor([0.0568, 0.0409, 0.0156, 0.3402, 0.0504, 0.0966, 0.1705, 0.0245, 0.1011,
        0.1033])
[rfa agg] iter:  4, prev_obj_val: 63.49617385864258, obj_val: 52.31446838378906, abs dis: 11.181705474853516
[rfa agg] iter: 4, weight: tensor([0.0731, 0.0572, 0.0299, 0.2517, 0.0673, 0.1073, 0.1529, 0.0371, 0.1109,
        0.1125])
[rfa agg] iter:  5, prev_obj_val: 52.31446838378906, obj_val: 59.53594207763672, abs dis: 7.221473693847656
[rfa agg] iter: 5, weight: tensor([0.0596, 0.0408, 0.0134, 0.2206, 0.0518, 0.1131, 0.2337, 0.0234, 0.1201,
        0.1236])
[rfa agg] iter:  6, prev_obj_val: 59.53594207763672, obj_val: 55.73883819580078, abs dis: 3.7971038818359375
[rfa agg] iter: 6, weight: tensor([0.0653, 0.0492, 0.0220, 0.2950, 0.0592, 0.1026, 0.1616, 0.0307, 0.1063,
        0.1081])
[rfa agg] iter:  7, prev_obj_val: 55.73883819580078, obj_val: 63.49628829956055, abs dis: 7.757450103759766
[rfa agg] iter: 7, weight: tensor([0.0567, 0.0409, 0.0156, 0.3414, 0.0504, 0.0965, 0.1701, 0.0245, 0.1010,
        0.1031])
[rfa agg] iter:  8, prev_obj_val: 63.49628829956055, obj_val: 52.31447219848633, abs dis: 11.181816101074219
[rfa agg] iter: 8, weight: tensor([0.0731, 0.0572, 0.0299, 0.2518, 0.0673, 0.1073, 0.1529, 0.0371, 0.1109,
        0.1125])
[rfa agg] iter:  9, prev_obj_val: 52.31447219848633, obj_val: 59.53593444824219, abs dis: 7.221462249755859
[rfa agg] iter: 9, weight: tensor([0.0596, 0.0408, 0.0134, 0.2206, 0.0518, 0.1131, 0.2337, 0.0234, 0.1201,
        0.1236])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3581, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.0401, Accuracy: 10/9950 (0.1005%)
saving model
Saving model on epoch 40
Done in 300.17934584617615 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0594, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0301, Accuracy: 485/1190 (40.7563%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1651, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4546, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0585, Accuracy: 334/896 (37.2768%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0430, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0499, Accuracy: 515/1129 (45.6156%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0233, Accuracy: 767/1129 (67.9362%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9394, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0446, Accuracy: 503/1552 (32.4098%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 791/1552 (50.9665%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.1819, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 422/1750 (24.1143%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0342, Accuracy: 698/1750 (39.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5927, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 323/807 (40.0248%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0305, Accuracy: 432/807 (53.5316%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0844, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0562, Accuracy: 254/809 (31.3968%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0242, Accuracy: 407/809 (50.3090%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9403, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 341/1154 (29.5494%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 418/1154 (36.2218%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.4796, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0699, Accuracy: 135/781 (17.2855%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0338, Accuracy: 251/781 (32.1383%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4721, Accuracy: 97/10000 (0.9700%)
time spent on training: 199.84780192375183
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 24, 89, 37, 74, 44, 20, 50, 15, 3], weight: tensor([0.1146, 0.0301, 0.0863, 0.1088, 0.1495, 0.1686, 0.0777, 0.0779, 0.1112,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 47.21654510498047, obj_val: 52.508575439453125, abs dis: 5.292030334472656
[rfa agg] iter: 0, weight: tensor([0.1742, 0.0083, 0.0927, 0.2499, 0.0619, 0.0509, 0.0633, 0.0640, 0.1728,
        0.0619])
[rfa agg] iter:  1, prev_obj_val: 52.508575439453125, obj_val: 53.93708419799805, abs dis: 1.4285087585449219
[rfa agg] iter: 1, weight: tensor([0.0949, 0.0102, 0.2248, 0.1177, 0.0504, 0.0438, 0.1201, 0.1242, 0.0925,
        0.1214])
[rfa agg] iter:  2, prev_obj_val: 53.93708419799805, obj_val: 57.77236557006836, abs dis: 3.8352813720703125
[rfa agg] iter: 2, weight: tensor([0.0710, 0.0090, 0.2928, 0.0847, 0.0403, 0.0354, 0.1287, 0.1362, 0.0693,
        0.1326])
[rfa agg] iter:  3, prev_obj_val: 57.77236557006836, obj_val: 63.893367767333984, abs dis: 6.121002197265625
[rfa agg] iter: 3, weight: tensor([0.0434, 0.0075, 0.2310, 0.0495, 0.0273, 0.0245, 0.1671, 0.2054, 0.0422,
        0.2021])
[rfa agg] iter:  4, prev_obj_val: 63.893367767333984, obj_val: 63.87670135498047, abs dis: 0.016666412353515625
[rfa agg] iter: 4, weight: tensor([0.0419, 0.0096, 0.1266, 0.0466, 0.0287, 0.0261, 0.1976, 0.2451, 0.0408,
        0.2370])
[rfa agg] iter:  5, prev_obj_val: 63.87670135498047, obj_val: 63.87662887573242, abs dis: 7.2479248046875e-05
[rfa agg] iter: 5, weight: tensor([0.0414, 0.0095, 0.1220, 0.0460, 0.0283, 0.0257, 0.2025, 0.2471, 0.0402,
        0.2373])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3586, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.0506, Accuracy: 12/9950 (0.1206%)
saving model
Saving model on epoch 41
Done in 296.55649399757385 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0526, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 540/1372 (39.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.6660, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0376, Accuracy: 407/1402 (29.0300%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7162, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0605, Accuracy: 309/1089 (28.3747%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 484/1089 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.9115, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0786, Accuracy: 85/460 (18.4783%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0363, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9495, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 369/1750 (21.0857%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 681/1750 (38.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6642, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 425/1742 (24.3972%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0309, Accuracy: 737/1742 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3045, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0596, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0330, Accuracy: 409/1013 (40.3751%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0038, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0500, Accuracy: 487/1129 (43.1355%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0228, Accuracy: 771/1129 (68.2905%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.0033, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0814, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0539, Accuracy: 150/515 (29.1262%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1866, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0473, Accuracy: 460/1440 (31.9444%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0264, Accuracy: 730/1440 (50.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9437, Accuracy: 88/10000 (0.8800%)
time spent on training: 224.68291926383972
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 66, 59, 31, 44, 93, 14, 37, 33, 29], weight: tensor([0.1152, 0.1177, 0.0914, 0.0386, 0.1469, 0.1462, 0.0850, 0.0948, 0.0432,
        0.1209])
[rfa agg] iter:  0, prev_obj_val: 45.73002624511719, obj_val: 50.7197151184082, abs dis: 4.989688873291016
[rfa agg] iter: 0, weight: tensor([0.1523, 0.1561, 0.1622, 0.0117, 0.0601, 0.0598, 0.0832, 0.1827, 0.0144,
        0.1176])
[rfa agg] iter:  1, prev_obj_val: 50.7197151184082, obj_val: 55.68507766723633, abs dis: 4.965362548828125
[rfa agg] iter: 1, weight: tensor([0.0843, 0.0862, 0.2303, 0.0115, 0.0437, 0.0435, 0.1187, 0.2964, 0.0143,
        0.0712])
[rfa agg] iter:  2, prev_obj_val: 55.68507766723633, obj_val: 53.01702117919922, abs dis: 2.6680564880371094
[rfa agg] iter: 2, weight: tensor([0.0751, 0.0768, 0.2016, 0.0142, 0.0441, 0.0439, 0.2213, 0.2391, 0.0179,
        0.0660])
[rfa agg] iter:  3, prev_obj_val: 53.01702117919922, obj_val: 50.669212341308594, abs dis: 2.347808837890625
[rfa agg] iter: 3, weight: tensor([0.0771, 0.0788, 0.2235, 0.0125, 0.0428, 0.0426, 0.1583, 0.2823, 0.0156,
        0.0666])
[rfa agg] iter:  4, prev_obj_val: 50.669212341308594, obj_val: 53.010902404785156, abs dis: 2.3416900634765625
[rfa agg] iter: 4, weight: tensor([0.0805, 0.0823, 0.2319, 0.0111, 0.0419, 0.0417, 0.1142, 0.3145, 0.0137,
        0.0682])
[rfa agg] iter:  5, prev_obj_val: 53.010902404785156, obj_val: 53.008750915527344, abs dis: 0.0021514892578125
[rfa agg] iter: 5, weight: tensor([0.0758, 0.0775, 0.2241, 0.0123, 0.0421, 0.0419, 0.1512, 0.2944, 0.0153,
        0.0655])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3563, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.0497, Accuracy: 15/9950 (0.1508%)
saving model
Saving model on epoch 42
Done in 318.82102394104004 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0584, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0318, Accuracy: 476/896 (53.1250%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2594, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0510, Accuracy: 357/1340 (26.6418%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0259, Accuracy: 596/1340 (44.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.6734, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 430/1440 (29.8611%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0265, Accuracy: 705/1440 (48.9583%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0547, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0583, Accuracy: 287/776 (36.9845%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0264, Accuracy: 433/776 (55.7990%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0699, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0531, Accuracy: 410/1662 (24.6691%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0316, Accuracy: 680/1662 (40.9146%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.7503, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0671, Accuracy: 149/781 (19.0781%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0331, Accuracy: 270/781 (34.5711%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4351, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 320/677 (47.2674%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.1042, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0521, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0250, Accuracy: 536/1013 (52.9121%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.8193, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0738, Accuracy: 108/486 (22.2222%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0380, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8822, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 325/807 (40.2726%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0306, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6559, Accuracy: 76/10000 (0.7600%)
time spent on training: 213.48214411735535
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 77, 29, 75, 94, 3, 90, 39, 30, 20], weight: tensor([0.0907, 0.1357, 0.1458, 0.0786, 0.1683, 0.0791, 0.0685, 0.1026, 0.0492,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 46.33177947998047, obj_val: 49.45857238769531, abs dis: 3.1267929077148438
[rfa agg] iter: 0, weight: tensor([0.1603, 0.0725, 0.0575, 0.0904, 0.0476, 0.0912, 0.0451, 0.3235, 0.0195,
        0.0924])
[rfa agg] iter:  1, prev_obj_val: 49.45857238769531, obj_val: 60.26250076293945, abs dis: 10.80392837524414
[rfa agg] iter: 1, weight: tensor([0.2055, 0.0362, 0.0308, 0.1881, 0.0271, 0.1917, 0.0542, 0.0804, 0.0180,
        0.1680])
[rfa agg] iter:  2, prev_obj_val: 60.26250076293945, obj_val: 63.70340347290039, abs dis: 3.4409027099609375
[rfa agg] iter: 2, weight: tensor([0.0978, 0.0397, 0.0353, 0.1365, 0.0324, 0.1377, 0.2823, 0.0627, 0.0390,
        0.1366])
[rfa agg] iter:  3, prev_obj_val: 63.70340347290039, obj_val: 67.52831268310547, abs dis: 3.824909210205078
[rfa agg] iter: 3, weight: tensor([0.0702, 0.0323, 0.0290, 0.0903, 0.0268, 0.0909, 0.4811, 0.0485, 0.0389,
        0.0919])
[rfa agg] iter:  4, prev_obj_val: 67.52831268310547, obj_val: 71.49060821533203, abs dis: 3.9622955322265625
[rfa agg] iter: 4, weight: tensor([0.0806, 0.0410, 0.0371, 0.0972, 0.0345, 0.0978, 0.3919, 0.0587, 0.0617,
        0.0996])
[rfa agg] iter:  5, prev_obj_val: 71.49060821533203, obj_val: 60.235958099365234, abs dis: 11.254650115966797
[rfa agg] iter: 5, weight: tensor([0.0924, 0.0510, 0.0464, 0.1065, 0.0436, 0.1072, 0.2734, 0.0703, 0.0997,
        0.1096])
[rfa agg] iter:  6, prev_obj_val: 60.235958099365234, obj_val: 67.52842712402344, abs dis: 7.292469024658203
[rfa agg] iter: 6, weight: tensor([0.0942, 0.0385, 0.0343, 0.1315, 0.0314, 0.1329, 0.3067, 0.0608, 0.0378,
        0.1318])
[rfa agg] iter:  7, prev_obj_val: 67.52842712402344, obj_val: 67.52548217773438, abs dis: 0.0029449462890625
[rfa agg] iter: 7, weight: tensor([0.0829, 0.0421, 0.0381, 0.1000, 0.0355, 0.1008, 0.3745, 0.0603, 0.0634,
        0.1026])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3552, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.0643, Accuracy: 15/9950 (0.1508%)
saving model
Done in 311.7838900089264 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0785, Accuracy: 53/373 (14.2091%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0461, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.4972, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0530, Accuracy: 307/1049 (29.2660%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0268, Accuracy: 558/1049 (53.1935%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3659, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0531, Accuracy: 440/1742 (25.2583%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0305, Accuracy: 736/1742 (42.2503%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.5359, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0656, Accuracy: 146/781 (18.6940%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0330, Accuracy: 278/781 (35.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9877, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0581, Accuracy: 271/1013 (26.7522%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0330, Accuracy: 383/1013 (37.8085%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2392, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0782, Accuracy: 94/460 (20.4348%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.4180, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0507, Accuracy: 290/888 (32.6577%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 475/888 (53.4910%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.3342, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 303/1154 (26.2565%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 542/1154 (46.9671%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 12.9838, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0884, Accuracy: 14/271 (5.1661%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0546, Accuracy: 134/271 (49.4465%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.2390, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0805, Accuracy: 8/186 (4.3011%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0646, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4322, Accuracy: 50/10000 (0.5000%)
time spent on training: 205.70723938941956
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 51, 93, 3, 14, 31, 63, 57, 35, 56], weight: tensor([0.0471, 0.1325, 0.2200, 0.0986, 0.1280, 0.0581, 0.1122, 0.1458, 0.0342,
        0.0235])
[rfa agg] iter:  0, prev_obj_val: 51.01801681518555, obj_val: 53.47727584838867, abs dis: 2.459259033203125
[rfa agg] iter: 0, weight: tensor([0.0137, 0.1573, 0.0443, 0.1231, 0.2790, 0.0217, 0.2533, 0.0934, 0.0090,
        0.0051])
[rfa agg] iter:  1, prev_obj_val: 53.47727584838867, obj_val: 57.63859939575195, abs dis: 4.161323547363281
[rfa agg] iter: 1, weight: tensor([0.0125, 0.0898, 0.0333, 0.1789, 0.1310, 0.0205, 0.4604, 0.0609, 0.0081,
        0.0045])
[rfa agg] iter:  2, prev_obj_val: 57.63859939575195, obj_val: 57.54730987548828, abs dis: 0.09128952026367188
[rfa agg] iter: 2, weight: tensor([0.0166, 0.0795, 0.0362, 0.4006, 0.1030, 0.0285, 0.2599, 0.0593, 0.0106,
        0.0058])
[rfa agg] iter:  3, prev_obj_val: 57.54730987548828, obj_val: 66.12226867675781, abs dis: 8.574958801269531
[rfa agg] iter: 3, weight: tensor([0.0144, 0.0689, 0.0314, 0.4944, 0.0892, 0.0247, 0.2115, 0.0514, 0.0091,
        0.0050])
[rfa agg] iter:  4, prev_obj_val: 66.12226867675781, obj_val: 60.26008605957031, abs dis: 5.8621826171875
[rfa agg] iter: 4, weight: tensor([0.0379, 0.1054, 0.0592, 0.2844, 0.1250, 0.0726, 0.1941, 0.0857, 0.0234,
        0.0123])
[rfa agg] iter:  5, prev_obj_val: 60.26008605957031, obj_val: 63.15261459350586, abs dis: 2.892528533935547
[rfa agg] iter: 5, weight: tensor([0.0213, 0.0849, 0.0418, 0.4153, 0.1059, 0.0377, 0.2070, 0.0654, 0.0134,
        0.0073])
[rfa agg] iter:  6, prev_obj_val: 63.15261459350586, obj_val: 66.10321044921875, abs dis: 2.9505958557128906
[rfa agg] iter: 6, weight: tensor([0.0293, 0.0975, 0.0514, 0.3422, 0.1182, 0.0538, 0.2021, 0.0773, 0.0183,
        0.0098])
[rfa agg] iter:  7, prev_obj_val: 66.10321044921875, obj_val: 57.576904296875, abs dis: 8.52630615234375
[rfa agg] iter: 7, weight: tensor([0.0381, 0.1059, 0.0594, 0.2808, 0.1255, 0.0730, 0.1954, 0.0860, 0.0234,
        0.0123])
[rfa agg] iter:  8, prev_obj_val: 57.576904296875, obj_val: 60.24665832519531, abs dis: 2.6697540283203125
[rfa agg] iter: 8, weight: tensor([0.0154, 0.0739, 0.0336, 0.4593, 0.0955, 0.0265, 0.2257, 0.0550, 0.0098,
        0.0054])
[rfa agg] iter:  9, prev_obj_val: 60.24665832519531, obj_val: 60.24580764770508, abs dis: 0.000850677490234375
[rfa agg] iter: 9, weight: tensor([0.0204, 0.0812, 0.0400, 0.4416, 0.1013, 0.0361, 0.1971, 0.0626, 0.0129,
        0.0070])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3571, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.0886, Accuracy: 5/9950 (0.0503%)
saving model
Done in 298.9473831653595 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0327, Accuracy: 633/1581 (40.0380%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9576, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0653, Accuracy: 161/682 (23.6070%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0366, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1825, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0335, Accuracy: 549/1446 (37.9668%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6040, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0527, Accuracy: 311/928 (33.5129%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0221, Accuracy: 611/928 (65.8405%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.8246, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 418/1742 (23.9954%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0306, Accuracy: 742/1742 (42.5947%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1829, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0529, Accuracy: 304/1071 (28.3847%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0275, Accuracy: 552/1071 (51.5406%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.3751, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0545, Accuracy: 380/1645 (23.1003%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0305, Accuracy: 710/1645 (43.1611%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5296, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0785, Accuracy: 50/373 (13.4048%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6588, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3612, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0592, Accuracy: 289/776 (37.2423%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9976, Accuracy: 76/10000 (0.7600%)
time spent on training: 240.15269351005554
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 80, 26, 1, 93, 55, 13, 98, 61, 75], weight: tensor([0.1531, 0.0660, 0.1400, 0.0898, 0.1687, 0.1037, 0.1593, 0.0361, 0.0082,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 57.764793395996094, obj_val: 63.194740295410156, abs dis: 5.4299468994140625
[rfa agg] iter: 0, weight: tensor([0.1150, 0.0432, 0.1506, 0.1234, 0.0870, 0.2936, 0.1038, 0.0142, 0.0025,
        0.0667])
[rfa agg] iter:  1, prev_obj_val: 63.194740295410156, obj_val: 67.20337677001953, abs dis: 4.008636474609375
[rfa agg] iter: 1, weight: tensor([0.0634, 0.0421, 0.0755, 0.1896, 0.0517, 0.4301, 0.0590, 0.0122, 0.0020,
        0.0743])
[rfa agg] iter:  2, prev_obj_val: 67.20337677001953, obj_val: 69.35226440429688, abs dis: 2.1488876342773438
[rfa agg] iter: 2, weight: tensor([0.0578, 0.0520, 0.0666, 0.3682, 0.0484, 0.2336, 0.0544, 0.0137, 0.0022,
        0.1031])
[rfa agg] iter:  3, prev_obj_val: 69.35226440429688, obj_val: 69.31504821777344, abs dis: 0.0372161865234375
[rfa agg] iter: 3, weight: tensor([0.0457, 0.0487, 0.0521, 0.5061, 0.0388, 0.1455, 0.0433, 0.0120, 0.0019,
        0.1059])
[rfa agg] iter:  4, prev_obj_val: 69.31504821777344, obj_val: 74.7116928100586, abs dis: 5.396644592285156
[rfa agg] iter: 4, weight: tensor([0.0398, 0.0423, 0.0453, 0.5725, 0.0338, 0.1244, 0.0377, 0.0105, 0.0017,
        0.0920])
[rfa agg] iter:  5, prev_obj_val: 74.7116928100586, obj_val: 77.49229431152344, abs dis: 2.7806015014648438
[rfa agg] iter: 5, weight: tensor([0.0537, 0.0824, 0.0598, 0.3279, 0.0465, 0.1283, 0.0512, 0.0174, 0.0027,
        0.2302])
[rfa agg] iter:  6, prev_obj_val: 77.49229431152344, obj_val: 74.66423797607422, abs dis: 2.8280563354492188
[rfa agg] iter: 6, weight: tensor([0.0503, 0.0966, 0.0556, 0.2128, 0.0440, 0.1090, 0.0481, 0.0182, 0.0027,
        0.3627])
[rfa agg] iter:  7, prev_obj_val: 74.66423797607422, obj_val: 77.48284912109375, abs dis: 2.8186111450195312
[rfa agg] iter: 7, weight: tensor([0.0540, 0.0838, 0.0602, 0.2915, 0.0468, 0.1290, 0.0515, 0.0175, 0.0027,
        0.2630])
[rfa agg] iter:  8, prev_obj_val: 77.48284912109375, obj_val: 74.6655044555664, abs dis: 2.8173446655273438
[rfa agg] iter: 8, weight: tensor([0.0498, 0.0958, 0.0550, 0.2093, 0.0436, 0.1080, 0.0477, 0.0180, 0.0027,
        0.3701])
[rfa agg] iter:  9, prev_obj_val: 74.6655044555664, obj_val: 77.48271942138672, abs dis: 2.8172149658203125
[rfa agg] iter: 9, weight: tensor([0.0540, 0.0838, 0.0602, 0.2909, 0.0468, 0.1290, 0.0515, 0.0175, 0.0027,
        0.2636])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3574, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.1156, Accuracy: 3/9950 (0.0302%)
saving model
Done in 335.65027117729187 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0821, Accuracy: 22/311 (7.0740%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0560, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0463, Accuracy: 319/813 (39.2374%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 476/813 (58.5486%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 13.5000, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.3172, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 572/1552 (36.8557%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0202, Accuracy: 826/1552 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.7519, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0538, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.1226, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0585, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/896 (50.2232%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3695, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0581, Accuracy: 294/1131 (25.9947%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0285, Accuracy: 506/1131 (44.7392%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2680, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0747, Accuracy: 81/440 (18.4091%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0448, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.6881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 336/712 (47.1910%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0240, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.9797, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0570, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0339, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3687, Accuracy: 78/10000 (0.7800%)
time spent on training: 204.06222772598267
[rfa agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 53, 15, 74, 95, 89, 38, 49, 11, 16], weight: tensor([0.0374, 0.0978, 0.1388, 0.1866, 0.0720, 0.1077, 0.1360, 0.0529, 0.0856,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 43.622520446777344, obj_val: 47.90323257446289, abs dis: 4.280712127685547
[rfa agg] iter: 0, weight: tensor([0.0103, 0.2051, 0.0676, 0.0419, 0.0441, 0.3270, 0.0826, 0.0187, 0.1021,
        0.1008])
[rfa agg] iter:  1, prev_obj_val: 47.90323257446289, obj_val: 53.16994857788086, abs dis: 5.266716003417969
[rfa agg] iter: 1, weight: tensor([0.0099, 0.1545, 0.0364, 0.0265, 0.0637, 0.0956, 0.0416, 0.0195, 0.2889,
        0.2635])
[rfa agg] iter:  2, prev_obj_val: 53.16994857788086, obj_val: 56.149017333984375, abs dis: 2.9790687561035156
[rfa agg] iter: 2, weight: tensor([0.0169, 0.1271, 0.0467, 0.0361, 0.1687, 0.0944, 0.0523, 0.0357, 0.2128,
        0.2093])
[rfa agg] iter:  3, prev_obj_val: 56.149017333984375, obj_val: 66.30818176269531, abs dis: 10.159164428710938
[rfa agg] iter: 3, weight: tensor([0.0196, 0.1099, 0.0469, 0.0372, 0.2901, 0.0870, 0.0521, 0.0435, 0.1576,
        0.1561])
[rfa agg] iter:  4, prev_obj_val: 66.30818176269531, obj_val: 59.276092529296875, abs dis: 7.0320892333984375
[rfa agg] iter: 4, weight: tensor([0.0383, 0.0992, 0.0567, 0.0479, 0.2711, 0.0875, 0.0618, 0.1069, 0.1157,
        0.1149])
[rfa agg] iter:  5, prev_obj_val: 59.276092529296875, obj_val: 66.31641387939453, abs dis: 7.040321350097656
[rfa agg] iter: 5, weight: tensor([0.0200, 0.0856, 0.0411, 0.0333, 0.4351, 0.0710, 0.0454, 0.0470, 0.1112,
        0.1102])
[rfa agg] iter:  6, prev_obj_val: 66.31641387939453, obj_val: 59.27486038208008, abs dis: 7.041553497314453
[rfa agg] iter: 6, weight: tensor([0.0380, 0.0983, 0.0563, 0.0475, 0.2775, 0.0868, 0.0613, 0.1060, 0.1146,
        0.1138])
[rfa agg] iter:  7, prev_obj_val: 59.27486038208008, obj_val: 66.31668090820312, abs dis: 7.041820526123047
[rfa agg] iter: 7, weight: tensor([0.0199, 0.0853, 0.0410, 0.0332, 0.4373, 0.0707, 0.0452, 0.0468, 0.1108,
        0.1098])
[rfa agg] iter:  8, prev_obj_val: 66.31668090820312, obj_val: 59.27484130859375, abs dis: 7.041839599609375
[rfa agg] iter: 8, weight: tensor([0.0380, 0.0983, 0.0563, 0.0475, 0.2776, 0.0868, 0.0613, 0.1059, 0.1145,
        0.1138])
[rfa agg] iter:  9, prev_obj_val: 59.27484130859375, obj_val: 66.31668853759766, abs dis: 7.041847229003906
[rfa agg] iter: 9, weight: tensor([0.0199, 0.0853, 0.0410, 0.0332, 0.4373, 0.0707, 0.0452, 0.0468, 0.1108,
        0.1098])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3577, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.1285, Accuracy: 4/9950 (0.0402%)
saving model
Done in 300.1483325958252 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0533, Accuracy: 424/1475 (28.7458%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0295, Accuracy: 728/1475 (49.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0519, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0809, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0451, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2783, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0495, Accuracy: 438/1574 (27.8272%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0260, Accuracy: 706/1574 (44.8539%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9306, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0599, Accuracy: 219/818 (26.7726%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0289, Accuracy: 376/818 (45.9658%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.3911, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0794, Accuracy: 89/460 (19.3478%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9034, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0439, Accuracy: 543/1552 (34.9871%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 813/1552 (52.3840%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.5964, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0549, Accuracy: 307/690 (44.4928%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0252, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9182, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0735, Accuracy: 96/500 (19.2000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0469, Accuracy: 201/500 (40.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.5736, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0515, Accuracy: 368/1130 (32.5664%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/1130 (43.3628%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.2683, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 14/338 (4.1420%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 154/338 (45.5621%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.6955, Accuracy: 50/10000 (0.5000%)
time spent on training: 225.1021683216095
[rfa agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[rfa agg] considering poison per batch poison_fraction: 0.054634566255692546
[rfa agg] init. name: [65, 76, 17, 71, 31, 74, 25, 82, 54, 12], weight: tensor([0.1638, 0.0518, 0.1748, 0.0909, 0.0511, 0.1724, 0.0766, 0.0555, 0.1255,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 65.33601379394531, obj_val: 67.7778091430664, abs dis: 2.4417953491210938
[rfa agg] iter: 0, weight: tensor([0.0993, 0.0404, 0.0956, 0.2376, 0.0399, 0.0942, 0.1039, 0.0434, 0.2229,
        0.0228])
[rfa agg] iter:  1, prev_obj_val: 67.7778091430664, obj_val: 72.28797149658203, abs dis: 4.510162353515625
[rfa agg] iter: 1, weight: tensor([0.0756, 0.0399, 0.0735, 0.3744, 0.0394, 0.0724, 0.1166, 0.0428, 0.1437,
        0.0217])
[rfa agg] iter:  2, prev_obj_val: 72.28797149658203, obj_val: 76.3626937866211, abs dis: 4.0747222900390625
[rfa agg] iter: 2, weight: tensor([0.0482, 0.0388, 0.0474, 0.4786, 0.0383, 0.0467, 0.1639, 0.0417, 0.0768,
        0.0196])
[rfa agg] iter:  3, prev_obj_val: 76.3626937866211, obj_val: 81.05046844482422, abs dis: 4.687774658203125
[rfa agg] iter: 3, weight: tensor([0.0470, 0.0526, 0.0465, 0.2132, 0.0520, 0.0458, 0.3928, 0.0566, 0.0690,
        0.0245])
[rfa agg] iter:  4, prev_obj_val: 81.05046844482422, obj_val: 76.32158660888672, abs dis: 4.7288818359375
[rfa agg] iter: 4, weight: tensor([0.0425, 0.0712, 0.0422, 0.1254, 0.0706, 0.0416, 0.4421, 0.0768, 0.0584,
        0.0292])
[rfa agg] iter:  5, prev_obj_val: 76.32158660888672, obj_val: 78.49215698242188, abs dis: 2.1705703735351562
[rfa agg] iter: 5, weight: tensor([0.0441, 0.0494, 0.0436, 0.1932, 0.0489, 0.0430, 0.4370, 0.0531, 0.0647,
        0.0230])
[rfa agg] iter:  6, prev_obj_val: 78.49215698242188, obj_val: 86.49212646484375, abs dis: 7.999969482421875
[rfa agg] iter: 6, weight: tensor([0.0316, 0.0428, 0.0314, 0.1112, 0.0424, 0.0309, 0.5998, 0.0461, 0.0449,
        0.0189])
[rfa agg] iter:  7, prev_obj_val: 86.49212646484375, obj_val: 83.73299407958984, abs dis: 2.7591323852539062
[rfa agg] iter: 7, weight: tensor([0.0480, 0.1373, 0.0479, 0.1092, 0.1376, 0.0473, 0.2151, 0.1496, 0.0626,
        0.0453])
[rfa agg] iter:  8, prev_obj_val: 83.73299407958984, obj_val: 83.73013305664062, abs dis: 0.00286102294921875
[rfa agg] iter: 8, weight: tensor([0.0492, 0.1064, 0.0490, 0.1258, 0.1057, 0.0483, 0.2952, 0.1151, 0.0658,
        0.0394])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3564, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.1256, Accuracy: 2/9950 (0.0201%)
saving model
Done in 321.75089859962463 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0566, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0310, Accuracy: 446/719 (62.0306%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3595, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0583, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0316, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2098, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0731, Accuracy: 91/500 (18.2000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 203/500 (40.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2243, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0626, Accuracy: 177/781 (22.6633%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0320, Accuracy: 287/781 (36.7478%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1385, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0512, Accuracy: 290/861 (33.6818%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0185, Accuracy: 497/861 (57.7236%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.3381, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0494, Accuracy: 398/1036 (38.4170%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 690/1036 (66.6023%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 14.0853, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0587, Accuracy: 282/1241 (22.7236%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 413/1241 (33.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9114, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0485, Accuracy: 701/2227 (31.4773%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1059/2227 (47.5528%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.1004, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0495, Accuracy: 380/599 (63.4391%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0287, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.4106, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0579, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0281, Accuracy: 549/1131 (48.5411%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6193, Accuracy: 103/10000 (1.0300%)
time spent on training: 226.24579286575317
[rfa agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 89, 82, 3, 10, 19, 72, 60, 95, 38], weight: tensor([0.0720, 0.0897, 0.0500, 0.0782, 0.0862, 0.1037, 0.1242, 0.2229, 0.0600,
        0.1132])
[rfa agg] iter:  0, prev_obj_val: 60.315826416015625, obj_val: 62.83700180053711, abs dis: 2.5211753845214844
[rfa agg] iter: 0, weight: tensor([0.0402, 0.0820, 0.0157, 0.0542, 0.0786, 0.3079, 0.1126, 0.0349, 0.0241,
        0.2499])
[rfa agg] iter:  1, prev_obj_val: 62.83700180053711, obj_val: 70.27947998046875, abs dis: 7.442478179931641
[rfa agg] iter: 1, weight: tensor([0.0708, 0.2607, 0.0197, 0.1176, 0.2282, 0.1024, 0.0573, 0.0279, 0.0339,
        0.0814])
[rfa agg] iter:  2, prev_obj_val: 70.27947998046875, obj_val: 76.3560562133789, abs dis: 6.076576232910156
[rfa agg] iter: 2, weight: tensor([0.2133, 0.1437, 0.0284, 0.2410, 0.1356, 0.0579, 0.0422, 0.0254, 0.0602,
        0.0522])
[rfa agg] iter:  3, prev_obj_val: 76.3560562133789, obj_val: 83.20368957519531, abs dis: 6.847633361816406
[rfa agg] iter: 3, weight: tensor([0.2870, 0.1086, 0.0442, 0.1519, 0.1040, 0.0580, 0.0454, 0.0296, 0.1173,
        0.0540])
[rfa agg] iter:  4, prev_obj_val: 83.20368957519531, obj_val: 86.75811767578125, abs dis: 3.5544281005859375
[rfa agg] iter: 4, weight: tensor([0.1614, 0.0899, 0.0700, 0.1080, 0.0862, 0.0564, 0.0465, 0.0325, 0.2955,
        0.0536])
[rfa agg] iter:  5, prev_obj_val: 86.75811767578125, obj_val: 86.73800659179688, abs dis: 0.020111083984375
[rfa agg] iter: 5, weight: tensor([0.1052, 0.0679, 0.0746, 0.0779, 0.0650, 0.0450, 0.0379, 0.0273, 0.4560,
        0.0431])
[rfa agg] iter:  6, prev_obj_val: 86.73800659179688, obj_val: 86.73421478271484, abs dis: 0.00379180908203125
[rfa agg] iter: 6, weight: tensor([0.0914, 0.0595, 0.0654, 0.0681, 0.0569, 0.0394, 0.0333, 0.0239, 0.5243,
        0.0378])
[rfa agg] iter:  7, prev_obj_val: 86.73421478271484, obj_val: 86.73318481445312, abs dis: 0.00102996826171875
[rfa agg] iter: 7, weight: tensor([0.0848, 0.0554, 0.0607, 0.0633, 0.0529, 0.0367, 0.0309, 0.0223, 0.5579,
        0.0352])
[rfa agg] iter:  8, prev_obj_val: 86.73318481445312, obj_val: 90.62132263183594, abs dis: 3.8881378173828125
[rfa agg] iter: 8, weight: tensor([0.0812, 0.0531, 0.0582, 0.0607, 0.0507, 0.0352, 0.0297, 0.0214, 0.5761,
        0.0337])
[rfa agg] iter:  9, prev_obj_val: 90.62132263183594, obj_val: 86.7435302734375, abs dis: 3.8777923583984375
[rfa agg] iter: 9, weight: tensor([0.1004, 0.0717, 0.1147, 0.0793, 0.0685, 0.0498, 0.0428, 0.0317, 0.3929,
        0.0481])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3573, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.1243, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.568320274353 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0485, Accuracy: 474/1574 (30.1144%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0252, Accuracy: 746/1574 (47.3952%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.5112, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0499, Accuracy: 341/928 (36.7457%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0209, Accuracy: 650/928 (70.0431%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3038, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0735, Accuracy: 104/486 (21.3992%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0371, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3678, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 392/1573 (24.9205%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 593/1573 (37.6987%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8551, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 467/1953 (23.9119%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0326, Accuracy: 801/1953 (41.0138%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1928, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 350/1213 (28.8541%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 544/1213 (44.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.4927, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0746, Accuracy: 145/530 (27.3585%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2041, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 350/1163 (30.0946%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0349, Accuracy: 492/1163 (42.3044%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.3536, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0509, Accuracy: 278/861 (32.2880%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0189, Accuracy: 493/861 (57.2590%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.6141, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0522, Accuracy: 440/1949 (22.5757%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0321, Accuracy: 636/1949 (32.6321%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4898, Accuracy: 103/10000 (1.0300%)
time spent on training: 263.87357234954834
[rfa agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.040218724448078495
[rfa agg] init. name: [17, 1, 30, 40, 83, 97, 18, 68, 10, 21], weight: tensor([0.1287, 0.0759, 0.0397, 0.1286, 0.1597, 0.0992, 0.0433, 0.0951, 0.0704,
        0.1594])
[rfa agg] iter:  0, prev_obj_val: 62.38318634033203, obj_val: 69.78313446044922, abs dis: 7.3999481201171875
[rfa agg] iter: 0, weight: tensor([0.0767, 0.0548, 0.0115, 0.0759, 0.0460, 0.3468, 0.0137, 0.2868, 0.0420,
        0.0459])
[rfa agg] iter:  1, prev_obj_val: 69.78313446044922, obj_val: 67.46664428710938, abs dis: 2.3164901733398438
[rfa agg] iter: 1, weight: tensor([0.0735, 0.1214, 0.0180, 0.0731, 0.0509, 0.2644, 0.0220, 0.2416, 0.0843,
        0.0508])
[rfa agg] iter:  2, prev_obj_val: 67.46664428710938, obj_val: 72.15003204345703, abs dis: 4.683387756347656
[rfa agg] iter: 2, weight: tensor([0.0684, 0.0907, 0.0149, 0.0679, 0.0459, 0.3091, 0.0180, 0.2746, 0.0647,
        0.0458])
[rfa agg] iter:  3, prev_obj_val: 72.15003204345703, obj_val: 74.54032897949219, abs dis: 2.3902969360351562
[rfa agg] iter: 3, weight: tensor([0.0752, 0.1607, 0.0207, 0.0748, 0.0535, 0.2223, 0.0254, 0.2077, 0.1063,
        0.0534])
[rfa agg] iter:  4, prev_obj_val: 74.54032897949219, obj_val: 72.1379165649414, abs dis: 2.4024124145507812
[rfa agg] iter: 4, weight: tensor([0.0726, 0.2114, 0.0225, 0.0723, 0.0530, 0.1843, 0.0278, 0.1735, 0.1296,
        0.0529])
[rfa agg] iter:  5, prev_obj_val: 72.1379165649414, obj_val: 72.1335678100586, abs dis: 0.0043487548828125
[rfa agg] iter: 5, weight: tensor([0.0753, 0.1659, 0.0208, 0.0749, 0.0536, 0.2192, 0.0255, 0.2043, 0.1072,
        0.0535])
[rfa agg] iter:  6, prev_obj_val: 72.1335678100586, obj_val: 74.53974151611328, abs dis: 2.4061737060546875
[rfa agg] iter: 6, weight: tensor([0.0752, 0.1641, 0.0207, 0.0748, 0.0536, 0.2202, 0.0254, 0.2055, 0.1069,
        0.0534])
[rfa agg] iter:  7, prev_obj_val: 74.53974151611328, obj_val: 72.137939453125, abs dis: 2.4018020629882812
[rfa agg] iter: 7, weight: tensor([0.0726, 0.2116, 0.0225, 0.0723, 0.0530, 0.1842, 0.0278, 0.1734, 0.1296,
        0.0529])
[rfa agg] iter:  8, prev_obj_val: 72.137939453125, obj_val: 72.1335678100586, abs dis: 0.00437164306640625
[rfa agg] iter: 8, weight: tensor([0.0753, 0.1659, 0.0208, 0.0749, 0.0536, 0.2192, 0.0255, 0.2043, 0.1072,
        0.0535])
[rfa agg] iter:  9, prev_obj_val: 72.1335678100586, obj_val: 74.53974151611328, abs dis: 2.4061737060546875
[rfa agg] iter: 9, weight: tensor([0.0752, 0.1641, 0.0207, 0.0748, 0.0536, 0.2202, 0.0254, 0.2055, 0.1069,
        0.0534])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3554, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.1364, Accuracy: 2/9950 (0.0201%)
saving model
Done in 360.2871811389923 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0525, Accuracy: 307/1013 (30.3060%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0249, Accuracy: 527/1013 (52.0237%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9649, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0659, Accuracy: 149/631 (23.6133%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0388, Accuracy: 272/631 (43.1062%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3597, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0658, Accuracy: 249/774 (32.1705%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0316, Accuracy: 336/774 (43.4109%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1432, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0515, Accuracy: 359/1049 (34.2231%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0264, Accuracy: 582/1049 (55.4814%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3038, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0499, Accuracy: 282/888 (31.7568%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0244, Accuracy: 453/888 (51.0135%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.2245, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0487, Accuracy: 447/1628 (27.4570%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0242, Accuracy: 849/1628 (52.1499%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.6046, Accuracy: 150/10000 (1.5000%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 673/2227 (30.2200%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0268, Accuracy: 1061/2227 (47.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2255, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0245, Accuracy: 477/891 (53.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.8697, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0519, Accuracy: 486/1418 (34.2736%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0286, Accuracy: 729/1418 (51.4104%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1985, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0574, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0290, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8634, Accuracy: 63/10000 (0.6300%)
time spent on training: 232.10965251922607
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 48, 81, 51, 63, 5, 60, 7, 70, 41], weight: tensor([0.0901, 0.0561, 0.0689, 0.0933, 0.0790, 0.1449, 0.1982, 0.0793, 0.1262,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 65.74951171875, obj_val: 65.86180114746094, abs dis: 0.1122894287109375
[rfa agg] iter: 0, weight: tensor([0.1654, 0.0315, 0.0594, 0.2506, 0.0830, 0.0916, 0.0573, 0.0829, 0.1316,
        0.0467])
[rfa agg] iter:  1, prev_obj_val: 65.86180114746094, obj_val: 70.61128234863281, abs dis: 4.749481201171875
[rfa agg] iter: 1, weight: tensor([0.3071, 0.0240, 0.0540, 0.2801, 0.0852, 0.0424, 0.0299, 0.0843, 0.0538,
        0.0392])
[rfa agg] iter:  2, prev_obj_val: 70.61128234863281, obj_val: 84.1468505859375, abs dis: 13.535568237304688
[rfa agg] iter: 2, weight: tensor([0.1488, 0.0326, 0.1091, 0.0945, 0.2420, 0.0331, 0.0255, 0.2109, 0.0390,
        0.0646])
[rfa agg] iter:  3, prev_obj_val: 84.1468505859375, obj_val: 87.79864501953125, abs dis: 3.65179443359375
[rfa agg] iter: 3, weight: tensor([0.0695, 0.0842, 0.1796, 0.0573, 0.1193, 0.0323, 0.0269, 0.1173, 0.0357,
        0.2780])
[rfa agg] iter:  4, prev_obj_val: 87.79864501953125, obj_val: 87.79735565185547, abs dis: 0.00128936767578125
[rfa agg] iter: 4, weight: tensor([0.0679, 0.1207, 0.1470, 0.0574, 0.1052, 0.0342, 0.0289, 0.1044, 0.0376,
        0.2965])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3545, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.1393, Accuracy: 1/9950 (0.0101%)
saving model
Saving model on epoch 50
Done in 329.00971007347107 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0576, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0345, Accuracy: 362/901 (40.1776%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.4617, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0817, Accuracy: 9/186 (4.8387%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0660, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.4271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0524, Accuracy: 446/1949 (22.8835%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 671/1949 (34.4279%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2933, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0828, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0497, Accuracy: 155/515 (30.0971%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.7509, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0570, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 439/1089 (40.3122%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.4363, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0523, Accuracy: 349/719 (48.5396%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0302, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7236, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0513, Accuracy: 330/712 (46.3483%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0231, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.2548, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0590, Accuracy: 226/818 (27.6284%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0278, Accuracy: 417/818 (50.9780%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5657, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0535, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 713/1956 (36.4519%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3029, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 512/1715 (29.8542%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0288, Accuracy: 805/1715 (46.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0607, Accuracy: 101/10000 (1.0100%)
time spent on training: 232.8408751487732
[rfa agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 56, 21, 33, 59, 41, 11, 71, 6, 92], weight: tensor([0.0853, 0.0176, 0.1846, 0.0488, 0.1031, 0.0681, 0.0674, 0.0775, 0.1852,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 75.17103576660156, obj_val: 75.90001678466797, abs dis: 0.7289810180664062
[rfa agg] iter: 0, weight: tensor([0.1136, 0.0065, 0.0974, 0.0282, 0.3441, 0.0550, 0.0545, 0.0721, 0.0978,
        0.1309])
[rfa agg] iter:  1, prev_obj_val: 75.90001678466797, obj_val: 76.44884490966797, abs dis: 0.548828125
[rfa agg] iter: 1, weight: tensor([0.1047, 0.0050, 0.0650, 0.0226, 0.5004, 0.0459, 0.0455, 0.0616, 0.0653,
        0.0839])
[rfa agg] iter:  2, prev_obj_val: 76.44884490966797, obj_val: 82.52326965332031, abs dis: 6.074424743652344
[rfa agg] iter: 2, weight: tensor([0.0920, 0.0040, 0.0479, 0.0183, 0.6016, 0.0380, 0.0377, 0.0517, 0.0481,
        0.0607])
[rfa agg] iter:  3, prev_obj_val: 82.52326965332031, obj_val: 85.39564514160156, abs dis: 2.87237548828125
[rfa agg] iter: 3, weight: tensor([0.3290, 0.0062, 0.0519, 0.0325, 0.1774, 0.0820, 0.0812, 0.1262, 0.0521,
        0.0615])
[rfa agg] iter:  4, prev_obj_val: 85.39564514160156, obj_val: 87.32444763183594, abs dis: 1.928802490234375
[rfa agg] iter: 4, weight: tensor([0.3853, 0.0054, 0.0397, 0.0313, 0.1010, 0.0931, 0.0929, 0.1652, 0.0399,
        0.0461])
[rfa agg] iter:  5, prev_obj_val: 87.32444763183594, obj_val: 89.33618927001953, abs dis: 2.0117416381835938
[rfa agg] iter: 5, weight: tensor([0.2742, 0.0059, 0.0397, 0.0355, 0.0913, 0.1177, 0.1180, 0.2321, 0.0399,
        0.0457])
[rfa agg] iter:  6, prev_obj_val: 89.33618927001953, obj_val: 89.31437683105469, abs dis: 0.02181243896484375
[rfa agg] iter: 6, weight: tensor([0.1731, 0.0056, 0.0349, 0.0356, 0.0740, 0.1377, 0.1393, 0.3249, 0.0351,
        0.0398])
[rfa agg] iter:  7, prev_obj_val: 89.31437683105469, obj_val: 89.31378173828125, abs dis: 0.0005950927734375
[rfa agg] iter: 7, weight: tensor([0.1635, 0.0054, 0.0339, 0.0346, 0.0717, 0.1342, 0.1359, 0.3482, 0.0340,
        0.0386])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3553, Accuracy: 90/10000 (0.9000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.1596, Accuracy: 2/9950 (0.0201%)
saving model
Done in 328.99983644485474 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0581, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0319, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3056, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 84/515 (16.3107%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 153/515 (29.7087%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3267, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 467/1953 (23.9119%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0318, Accuracy: 871/1953 (44.5981%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8412, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0481, Accuracy: 714/2227 (32.0611%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1062/2227 (47.6875%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3586, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0238, Accuracy: 551/1154 (47.7470%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.4966, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0725, Accuracy: 153/530 (28.8679%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0352, Accuracy: 281/530 (53.0189%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4691, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0551, Accuracy: 358/719 (49.7914%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0290, Accuracy: 437/719 (60.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1838, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0568, Accuracy: 335/1657 (20.2173%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0334, Accuracy: 553/1657 (33.3736%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1830, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0785, Accuracy: 92/460 (20.0000%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0344, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1807, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0728, Accuracy: 118/486 (24.2798%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0367, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2495, Accuracy: 62/10000 (0.6200%)
time spent on training: 249.31281328201294
[rfa agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 33, 83, 60, 57, 18, 41, 0, 31, 30], weight: tensor([0.0846, 0.0486, 0.1843, 0.2102, 0.1089, 0.0500, 0.0678, 0.1564, 0.0434,
        0.0459])
[rfa agg] iter:  0, prev_obj_val: 85.02388000488281, obj_val: 87.32479095458984, abs dis: 2.3009109497070312
[rfa agg] iter: 0, weight: tensor([0.0798, 0.0252, 0.0954, 0.0799, 0.4557, 0.0259, 0.0482, 0.1474, 0.0206,
        0.0218])
[rfa agg] iter:  1, prev_obj_val: 87.32479095458984, obj_val: 90.06832885742188, abs dis: 2.7435379028320312
[rfa agg] iter: 1, weight: tensor([0.0767, 0.0212, 0.0611, 0.0529, 0.6018, 0.0218, 0.0431, 0.0861, 0.0172,
        0.0181])
[rfa agg] iter:  2, prev_obj_val: 90.06832885742188, obj_val: 94.31670379638672, abs dis: 4.248374938964844
[rfa agg] iter: 2, weight: tensor([0.1367, 0.0334, 0.0798, 0.0703, 0.4114, 0.0344, 0.0716, 0.1072, 0.0267,
        0.0283])
[rfa agg] iter:  3, prev_obj_val: 94.31670379638672, obj_val: 97.19630432128906, abs dis: 2.8796005249023438
[rfa agg] iter: 3, weight: tensor([0.2514, 0.0444, 0.0789, 0.0711, 0.2292, 0.0458, 0.1074, 0.1002, 0.0348,
        0.0368])
[rfa agg] iter:  4, prev_obj_val: 97.19630432128906, obj_val: 104.4532699584961, abs dis: 7.256965637207031
[rfa agg] iter: 4, weight: tensor([0.3813, 0.0437, 0.0624, 0.0569, 0.1450, 0.0450, 0.1198, 0.0769, 0.0335,
        0.0355])
[rfa agg] iter:  5, prev_obj_val: 104.4532699584961, obj_val: 104.43867492675781, abs dis: 0.01459503173828125
[rfa agg] iter: 5, weight: tensor([0.3347, 0.0538, 0.0459, 0.0429, 0.0807, 0.0557, 0.2525, 0.0539, 0.0388,
        0.0410])
[rfa agg] iter:  6, prev_obj_val: 104.43867492675781, obj_val: 109.00525665283203, abs dis: 4.566581726074219
[rfa agg] iter: 6, weight: tensor([0.3280, 0.0535, 0.0456, 0.0425, 0.0800, 0.0553, 0.2625, 0.0535, 0.0385,
        0.0407])
[rfa agg] iter:  7, prev_obj_val: 109.00525665283203, obj_val: 106.63581085205078, abs dis: 2.36944580078125
[rfa agg] iter: 7, weight: tensor([0.1561, 0.0608, 0.0372, 0.0350, 0.0592, 0.0630, 0.4609, 0.0428, 0.0413,
        0.0437])
[rfa agg] iter:  8, prev_obj_val: 106.63581085205078, obj_val: 108.95584869384766, abs dis: 2.320037841796875
[rfa agg] iter: 8, weight: tensor([0.2007, 0.0542, 0.0394, 0.0370, 0.0658, 0.0560, 0.4229, 0.0458, 0.0380,
        0.0402])
[rfa agg] iter:  9, prev_obj_val: 108.95584869384766, obj_val: 117.13231658935547, abs dis: 8.176467895507812
[rfa agg] iter: 9, weight: tensor([0.1340, 0.0531, 0.0325, 0.0306, 0.0517, 0.0550, 0.5314, 0.0374, 0.0361,
        0.0382])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3555, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.1589, Accuracy: 3/9950 (0.0302%)
saving model
Done in 343.41280364990234 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0590, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0331, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4585, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0332, Accuracy: 534/1446 (36.9295%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5997, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1182, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3605, Accuracy: 59/10000 (0.5900%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0484, Accuracy: 464/1574 (29.4790%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0256, Accuracy: 719/1574 (45.6798%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.7318, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0560, Accuracy: 413/1587 (26.0239%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0326, Accuracy: 630/1587 (39.6975%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8331, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0661, Accuracy: 152/631 (24.0887%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0380, Accuracy: 275/631 (43.5816%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3679, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0519, Accuracy: 310/1013 (30.6022%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0243, Accuracy: 545/1013 (53.8006%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.5935, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0239, Accuracy: 484/891 (54.3210%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.0764, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 350/1154 (30.3293%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.0985, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0524, Accuracy: 436/1949 (22.3704%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 656/1949 (33.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6633, Accuracy: 103/10000 (1.0300%)
time spent on training: 265.5358543395996
[rfa agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.043621408300815886
[rfa agg] init. name: [43, 26, 61, 17, 27, 48, 39, 7, 15, 21], weight: tensor([0.0839, 0.1282, 0.0075, 0.1396, 0.1407, 0.0560, 0.0898, 0.0790, 0.1023,
        0.1728])
[rfa agg] iter:  0, prev_obj_val: 54.089263916015625, obj_val: 55.26130676269531, abs dis: 1.1720428466796875
[rfa agg] iter: 0, weight: tensor([0.0744, 0.1128, 0.0016, 0.0828, 0.0840, 0.0224, 0.1045, 0.0563, 0.4095,
        0.0518])
[rfa agg] iter:  1, prev_obj_val: 55.26130676269531, obj_val: 60.17283630371094, abs dis: 4.911529541015625
[rfa agg] iter: 1, weight: tensor([0.0781, 0.0935, 0.0015, 0.0710, 0.0719, 0.0220, 0.1145, 0.0578, 0.4435,
        0.0461])
[rfa agg] iter:  2, prev_obj_val: 60.17283630371094, obj_val: 63.75168228149414, abs dis: 3.578845977783203
[rfa agg] iter: 2, weight: tensor([0.1488, 0.0812, 0.0019, 0.0665, 0.0673, 0.0306, 0.2689, 0.0976, 0.1897,
        0.0473])
[rfa agg] iter:  3, prev_obj_val: 63.75168228149414, obj_val: 66.02078247070312, abs dis: 2.2691001892089844
[rfa agg] iter: 3, weight: tensor([0.1930, 0.0511, 0.0015, 0.0434, 0.0439, 0.0261, 0.4119, 0.1042, 0.0926,
        0.0323])
[rfa agg] iter:  4, prev_obj_val: 66.02078247070312, obj_val: 74.96011352539062, abs dis: 8.9393310546875
[rfa agg] iter: 4, weight: tensor([0.2657, 0.0459, 0.0015, 0.0395, 0.0400, 0.0274, 0.3462, 0.1273, 0.0764,
        0.0301])
[rfa agg] iter:  5, prev_obj_val: 74.96011352539062, obj_val: 71.60107421875, abs dis: 3.359039306640625
[rfa agg] iter: 5, weight: tensor([0.2325, 0.0463, 0.0021, 0.0412, 0.0417, 0.0452, 0.1413, 0.3509, 0.0657,
        0.0331])
[rfa agg] iter:  6, prev_obj_val: 71.60107421875, obj_val: 82.27497863769531, abs dis: 10.673904418945312
[rfa agg] iter: 6, weight: tensor([0.2924, 0.0427, 0.0017, 0.0376, 0.0381, 0.0351, 0.1534, 0.3059, 0.0633,
        0.0298])
[rfa agg] iter:  7, prev_obj_val: 82.27497863769531, obj_val: 74.87762451171875, abs dis: 7.3973541259765625
[rfa agg] iter: 7, weight: tensor([0.1836, 0.0583, 0.0031, 0.0529, 0.0535, 0.0837, 0.1330, 0.3113, 0.0769,
        0.0438])
[rfa agg] iter:  8, prev_obj_val: 74.87762451171875, obj_val: 78.48153686523438, abs dis: 3.603912353515625
[rfa agg] iter: 8, weight: tensor([0.2071, 0.0419, 0.0019, 0.0374, 0.0378, 0.0410, 0.1251, 0.4182, 0.0596,
        0.0301])
[rfa agg] iter:  9, prev_obj_val: 78.48153686523438, obj_val: 68.68899536132812, abs dis: 9.79254150390625
[rfa agg] iter: 9, weight: tensor([0.1809, 0.0477, 0.0023, 0.0430, 0.0434, 0.0560, 0.1224, 0.4041, 0.0651,
        0.0351])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3550, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.1729, Accuracy: 1/9950 (0.0101%)
saving model
Done in 364.02933859825134 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0477, Accuracy: 495/1129 (43.8441%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0223, Accuracy: 767/1129 (67.9362%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.8793, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0605, Accuracy: 360/1163 (30.9544%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 441/1163 (37.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8796, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0581, Accuracy: 347/1154 (30.0693%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 446/1154 (38.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.4324, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 149/603 (24.7098%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0435, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6912, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0533, Accuracy: 429/1904 (22.5315%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0298, Accuracy: 790/1904 (41.4916%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3504, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 451/1953 (23.0927%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0319, Accuracy: 874/1953 (44.7517%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8339, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0494, Accuracy: 383/891 (42.9854%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0239, Accuracy: 478/891 (53.6476%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.0451, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0527, Accuracy: 438/1956 (22.3926%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 709/1956 (36.2474%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6681, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 496/1715 (28.9213%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0293, Accuracy: 772/1715 (45.0146%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9193, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0462, Accuracy: 318/813 (39.1144%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 478/813 (58.7946%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 13.5923, Accuracy: 62/10000 (0.6200%)
time spent on training: 290.2693476676941
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 68, 15, 88, 46, 83, 7, 6, 92, 53], weight: tensor([0.0850, 0.0876, 0.0869, 0.0454, 0.1434, 0.1471, 0.0671, 0.1473, 0.1291,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 63.29784393310547, obj_val: 65.32711791992188, abs dis: 2.0292739868164062
[rfa agg] iter: 0, weight: tensor([0.1301, 0.1858, 0.1797, 0.0219, 0.0931, 0.0857, 0.0494, 0.0858, 0.1286,
        0.0399])
[rfa agg] iter:  1, prev_obj_val: 65.32711791992188, obj_val: 69.1259994506836, abs dis: 3.7988815307617188
[rfa agg] iter: 1, weight: tensor([0.1480, 0.2783, 0.2522, 0.0174, 0.0549, 0.0513, 0.0427, 0.0514, 0.0704,
        0.0335])
[rfa agg] iter:  2, prev_obj_val: 69.1259994506836, obj_val: 76.5968246459961, abs dis: 7.4708251953125
[rfa agg] iter: 2, weight: tensor([0.2149, 0.3044, 0.2561, 0.0146, 0.0340, 0.0321, 0.0402, 0.0322, 0.0413,
        0.0302])
[rfa agg] iter:  3, prev_obj_val: 76.5968246459961, obj_val: 82.25508880615234, abs dis: 5.65826416015625
[rfa agg] iter: 3, weight: tensor([0.2701, 0.1798, 0.1733, 0.0277, 0.0471, 0.0450, 0.0926, 0.0450, 0.0551,
        0.0644])
[rfa agg] iter:  4, prev_obj_val: 82.25508880615234, obj_val: 73.86940002441406, abs dis: 8.385688781738281
[rfa agg] iter: 4, weight: tensor([0.2014, 0.1452, 0.1419, 0.0384, 0.0522, 0.0500, 0.1600, 0.0501, 0.0597,
        0.1012])
[rfa agg] iter:  5, prev_obj_val: 73.86940002441406, obj_val: 76.56907653808594, abs dis: 2.699676513671875
[rfa agg] iter: 5, weight: tensor([0.3104, 0.1942, 0.1824, 0.0222, 0.0421, 0.0400, 0.0693, 0.0401, 0.0498,
        0.0495])
[rfa agg] iter:  6, prev_obj_val: 76.56907653808594, obj_val: 79.38794708251953, abs dis: 2.8188705444335938
[rfa agg] iter: 6, weight: tensor([0.2852, 0.1746, 0.1680, 0.0273, 0.0465, 0.0444, 0.0915, 0.0444, 0.0544,
        0.0636])
[rfa agg] iter:  7, prev_obj_val: 79.38794708251953, obj_val: 73.85157775878906, abs dis: 5.536369323730469
[rfa agg] iter: 7, weight: tensor([0.2396, 0.1609, 0.1562, 0.0332, 0.0506, 0.0484, 0.1225, 0.0484, 0.0585,
        0.0817])
[rfa agg] iter:  8, prev_obj_val: 73.85157775878906, obj_val: 76.56951141357422, abs dis: 2.7179336547851562
[rfa agg] iter: 8, weight: tensor([0.3178, 0.1921, 0.1808, 0.0220, 0.0416, 0.0396, 0.0683, 0.0396, 0.0492,
        0.0489])
[rfa agg] iter:  9, prev_obj_val: 76.56951141357422, obj_val: 79.38803100585938, abs dis: 2.8185195922851562
[rfa agg] iter: 9, weight: tensor([0.2861, 0.1744, 0.1677, 0.0273, 0.0465, 0.0443, 0.0914, 0.0444, 0.0543,
        0.0635])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3509, Accuracy: 90/10000 (0.9000%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.1846, Accuracy: 1/9950 (0.0101%)
saving model
Done in 385.2275381088257 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0535, Accuracy: 326/1131 (28.8240%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0302, Accuracy: 421/1131 (37.2237%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.2239, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0810, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0454, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0993, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0552, Accuracy: 361/1154 (31.2825%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.0810, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0517, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0274, Accuracy: 546/1130 (48.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.0579, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0812, Accuracy: 65/416 (15.6250%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0441, Accuracy: 223/416 (53.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.1350, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0453, Accuracy: 153/338 (45.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.7404, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 720/2227 (32.3305%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0268, Accuracy: 1058/2227 (47.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1035, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0493, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0240, Accuracy: 460/712 (64.6067%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.2581, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0335, Accuracy: 535/1446 (36.9986%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8496, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0497, Accuracy: 371/1213 (30.5853%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 560/1213 (46.1665%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.4925, Accuracy: 102/10000 (1.0200%)
time spent on training: 243.6487956047058
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 76, 15, 54, 78, 12, 60, 11, 26, 97], weight: tensor([0.1105, 0.0455, 0.1128, 0.1104, 0.0407, 0.0330, 0.2176, 0.0696, 0.1413,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 59.24388885498047, obj_val: 65.96166229248047, abs dis: 6.7177734375
[rfa agg] iter: 0, weight: tensor([0.2547, 0.0089, 0.1680, 0.2704, 0.0072, 0.0054, 0.0250, 0.0225, 0.0543,
        0.1836])
[rfa agg] iter:  1, prev_obj_val: 65.96166229248047, obj_val: 65.95852661132812, abs dis: 0.00313568115234375
[rfa agg] iter: 1, weight: tensor([0.2346, 0.0189, 0.1515, 0.2363, 0.0151, 0.0111, 0.0415, 0.0541, 0.0760,
        0.1610])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3526, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.1896, Accuracy: 0/9950 (0.0000%)
saving model
Done in 338.53193759918213 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 380/1573 (24.1577%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0335, Accuracy: 619/1573 (39.3516%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0742, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 449/1953 (22.9903%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0317, Accuracy: 844/1953 (43.2156%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7156, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0535, Accuracy: 452/1904 (23.7395%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0296, Accuracy: 761/1904 (39.9685%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4282, Accuracy: 134/10000 (1.3400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0487, Accuracy: 506/1574 (32.1474%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0251, Accuracy: 751/1574 (47.7128%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8594, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5188, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0567, Accuracy: 247/818 (30.1956%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0273, Accuracy: 426/818 (52.0782%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.9423, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0568, Accuracy: 413/1750 (23.6000%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0341, Accuracy: 697/1750 (39.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4534, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0785, Accuracy: 92/460 (20.0000%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0353, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4131, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0532, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0248, Accuracy: 466/690 (67.5362%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.1983, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0530, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 729/1956 (37.2699%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4695, Accuracy: 127/10000 (1.2700%)
time spent on training: 289.7313756942749
[rfa agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.037035991265717945
[rfa agg] init. name: [40, 83, 46, 17, 88, 71, 44, 31, 25, 6], weight: tensor([0.1184, 0.1471, 0.1434, 0.1185, 0.0454, 0.0616, 0.1318, 0.0346, 0.0520,
        0.1473])
[rfa agg] iter:  0, prev_obj_val: 64.53524017333984, obj_val: 59.2248649597168, abs dis: 5.310375213623047
[rfa agg] iter: 0, weight: tensor([0.2425, 0.0938, 0.1033, 0.2450, 0.0198, 0.0352, 0.1290, 0.0130, 0.0246,
        0.0939])
[rfa agg] iter:  1, prev_obj_val: 59.2248649597168, obj_val: 59.22097396850586, abs dis: 0.0038909912109375
[rfa agg] iter: 1, weight: tensor([0.2834, 0.0793, 0.0888, 0.2882, 0.0137, 0.0239, 0.1172, 0.0091, 0.0169,
        0.0794])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3485, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.2137, Accuracy: 1/9950 (0.0101%)
saving model
Done in 386.0365364551544 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0503, Accuracy: 326/1013 (32.1816%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0242, Accuracy: 539/1013 (53.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.7432, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0527, Accuracy: 333/1071 (31.0924%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0271, Accuracy: 561/1071 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4700, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0637, Accuracy: 152/781 (19.4622%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0330, Accuracy: 275/781 (35.2113%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8079, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0772, Accuracy: 101/460 (21.9565%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8825, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0632, Accuracy: 191/938 (20.3625%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0326, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.2783, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0444, Accuracy: 545/1552 (35.1160%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 823/1552 (53.0284%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.2546, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0530, Accuracy: 317/590 (53.7288%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0288, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1331, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0524, Accuracy: 340/1131 (30.0619%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0293, Accuracy: 460/1131 (40.6720%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5527, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0571, Accuracy: 308/1513 (20.3569%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0347, Accuracy: 555/1513 (36.6821%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7449, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 370/1427 (25.9285%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0320, Accuracy: 599/1427 (41.9762%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5591, Accuracy: 93/10000 (0.9300%)
time spent on training: 255.2502806186676
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 55, 3, 31, 73, 74, 69, 87, 8, 34], weight: tensor([0.0967, 0.1022, 0.0746, 0.0439, 0.0895, 0.1481, 0.0563, 0.1080, 0.1444,
        0.1362])
[rfa agg] iter:  0, prev_obj_val: 44.00060272216797, obj_val: 47.93285369873047, abs dis: 3.9322509765625
[rfa agg] iter: 0, weight: tensor([0.3009, 0.1881, 0.0569, 0.0128, 0.1735, 0.0382, 0.0218, 0.1205, 0.0420,
        0.0452])
[rfa agg] iter:  1, prev_obj_val: 47.93285369873047, obj_val: 56.22126770019531, abs dis: 8.288414001464844
[rfa agg] iter: 1, weight: tensor([0.2037, 0.1173, 0.0859, 0.0152, 0.3501, 0.0357, 0.0271, 0.0852, 0.0387,
        0.0411])
[rfa agg] iter:  2, prev_obj_val: 56.22126770019531, obj_val: 56.16794204711914, abs dis: 0.053325653076171875
[rfa agg] iter: 2, weight: tensor([0.1226, 0.0937, 0.3076, 0.0260, 0.1866, 0.0420, 0.0518, 0.0778, 0.0449,
        0.0468])
[rfa agg] iter:  3, prev_obj_val: 56.16794204711914, obj_val: 56.16691207885742, abs dis: 0.00102996826171875
[rfa agg] iter: 3, weight: tensor([0.1159, 0.0889, 0.3455, 0.0248, 0.1739, 0.0400, 0.0495, 0.0741, 0.0428,
        0.0446])
[rfa agg] iter:  4, prev_obj_val: 56.16691207885742, obj_val: 59.201263427734375, abs dis: 3.034351348876953
[rfa agg] iter: 4, weight: tensor([0.1149, 0.0882, 0.3513, 0.0246, 0.1721, 0.0397, 0.0491, 0.0735, 0.0424,
        0.0442])
[rfa agg] iter:  5, prev_obj_val: 59.201263427734375, obj_val: 62.56201934814453, abs dis: 3.3607559204101562
[rfa agg] iter: 5, weight: tensor([0.0862, 0.0690, 0.4858, 0.0240, 0.1182, 0.0338, 0.0506, 0.0590, 0.0360,
        0.0374])
[rfa agg] iter:  6, prev_obj_val: 62.56201934814453, obj_val: 62.55912399291992, abs dis: 0.002895355224609375
[rfa agg] iter: 6, weight: tensor([0.0910, 0.0753, 0.4189, 0.0327, 0.1170, 0.0398, 0.0737, 0.0657, 0.0422,
        0.0436])
[rfa agg] iter:  7, prev_obj_val: 62.55912399291992, obj_val: 59.19000244140625, abs dis: 3.369121551513672
[rfa agg] iter: 7, weight: tensor([0.0925, 0.0765, 0.4094, 0.0332, 0.1189, 0.0404, 0.0750, 0.0668, 0.0429,
        0.0443])
[rfa agg] iter:  8, prev_obj_val: 59.19000244140625, obj_val: 62.56427001953125, abs dis: 3.374267578125
[rfa agg] iter: 8, weight: tensor([0.0816, 0.0653, 0.5133, 0.0228, 0.1114, 0.0321, 0.0480, 0.0559, 0.0342,
        0.0354])
[rfa agg] iter:  9, prev_obj_val: 62.56427001953125, obj_val: 66.07215881347656, abs dis: 3.5078887939453125
[rfa agg] iter: 9, weight: tensor([0.0903, 0.0748, 0.4230, 0.0325, 0.1162, 0.0396, 0.0731, 0.0653, 0.0420,
        0.0433])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3504, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.1638, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.62614607810974 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 91/515 (17.6699%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0546, Accuracy: 161/515 (31.2621%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3243, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0721, Accuracy: 111/486 (22.8395%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0362, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2677, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0733, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4164, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 387/1427 (27.1198%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0316, Accuracy: 657/1427 (46.0406%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7099, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0618, Accuracy: 203/938 (21.6418%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0317, Accuracy: 378/938 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0723, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0488, Accuracy: 396/1036 (38.2239%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0229, Accuracy: 731/1036 (70.5598%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.5655, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0332, Accuracy: 530/1446 (36.6528%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7823, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0587, Accuracy: 310/715 (43.3566%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.3965, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0572, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0214, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.5227, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0463, Accuracy: 580/1470 (39.4558%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 891/1470 (60.6122%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.1225, Accuracy: 103/10000 (1.0300%)
time spent on training: 244.58938431739807
[rfa agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 30, 88, 34, 73, 19, 26, 23, 32, 22], weight: tensor([0.0550, 0.0519, 0.0643, 0.1523, 0.1001, 0.1106, 0.1543, 0.0763, 0.0784,
        0.1569])
[rfa agg] iter:  0, prev_obj_val: 49.386436462402344, obj_val: 55.24858856201172, abs dis: 5.862152099609375
[rfa agg] iter: 0, weight: tensor([0.0265, 0.0215, 0.0372, 0.0551, 0.4506, 0.1504, 0.0558, 0.0716, 0.0746,
        0.0568])
[rfa agg] iter:  1, prev_obj_val: 55.24858856201172, obj_val: 58.82760238647461, abs dis: 3.5790138244628906
[rfa agg] iter: 1, weight: tensor([0.0460, 0.0351, 0.0714, 0.0515, 0.1670, 0.0923, 0.0522, 0.1985, 0.2330,
        0.0531])
[rfa agg] iter:  2, prev_obj_val: 58.82760238647461, obj_val: 64.17503356933594, abs dis: 5.347431182861328
[rfa agg] iter: 2, weight: tensor([0.0402, 0.0290, 0.0695, 0.0310, 0.0736, 0.0490, 0.0314, 0.2536, 0.3908,
        0.0319])
[rfa agg] iter:  3, prev_obj_val: 64.17503356933594, obj_val: 73.55702209472656, abs dis: 9.381988525390625
[rfa agg] iter: 3, weight: tensor([0.0820, 0.0539, 0.1743, 0.0398, 0.0777, 0.0574, 0.0403, 0.2031, 0.2304,
        0.0410])
[rfa agg] iter:  4, prev_obj_val: 73.55702209472656, obj_val: 77.12171173095703, abs dis: 3.5646896362304688
[rfa agg] iter: 4, weight: tensor([0.2180, 0.1040, 0.2822, 0.0350, 0.0562, 0.0455, 0.0354, 0.0917, 0.0959,
        0.0360])
[rfa agg] iter:  5, prev_obj_val: 77.12171173095703, obj_val: 80.97227478027344, abs dis: 3.8505630493164062
[rfa agg] iter: 5, weight: tensor([0.3333, 0.1449, 0.1791, 0.0327, 0.0500, 0.0414, 0.0331, 0.0743, 0.0775,
        0.0337])
[rfa agg] iter:  6, prev_obj_val: 80.97227478027344, obj_val: 80.96551513671875, abs dis: 0.0067596435546875
[rfa agg] iter: 6, weight: tensor([0.2717, 0.2601, 0.1325, 0.0340, 0.0496, 0.0420, 0.0344, 0.0690, 0.0717,
        0.0350])
[rfa agg] iter:  7, prev_obj_val: 80.96551513671875, obj_val: 80.96534729003906, abs dis: 0.0001678466796875
[rfa agg] iter: 7, weight: tensor([0.2588, 0.2750, 0.1315, 0.0339, 0.0495, 0.0418, 0.0343, 0.0688, 0.0715,
        0.0349])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3494, Accuracy: 87/10000 (0.8700%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.0805, Accuracy: 6/9950 (0.0603%)
saving model
Done in 343.2203462123871 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0604, Accuracy: 350/1163 (30.0946%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0352, Accuracy: 494/1163 (42.4764%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.3890, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0727, Accuracy: 99/500 (19.8000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0465, Accuracy: 209/500 (41.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.8005, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0489, Accuracy: 430/1628 (26.4128%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0239, Accuracy: 897/1628 (55.0983%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1492, Accuracy: 165/10000 (1.6500%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0498, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0240, Accuracy: 566/1013 (55.8736%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.8702, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0583, Accuracy: 302/807 (37.4226%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0312, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2845, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0469, Accuracy: 500/1470 (34.0136%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0233, Accuracy: 880/1470 (59.8639%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.4613, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0812, Accuracy: 12/311 (3.8585%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 132/311 (42.4437%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2135, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 524/1552 (33.7629%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0193, Accuracy: 878/1552 (56.5722%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.9123, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 277/636 (43.5535%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0284, Accuracy: 429/636 (67.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1681, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0776, Accuracy: 53/373 (14.2091%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0454, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8819, Accuracy: 50/10000 (0.5000%)
time spent on training: 243.1976923942566
[rfa agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 82, 5, 39, 20, 22, 96, 74, 52, 98], weight: tensor([0.1230, 0.0529, 0.1722, 0.1072, 0.0854, 0.1555, 0.0329, 0.1642, 0.0673,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 57.940879821777344, obj_val: 60.7923583984375, abs dis: 2.8514785766601562
[rfa agg] iter: 0, weight: tensor([0.1751, 0.0232, 0.0673, 0.4227, 0.0885, 0.0885, 0.0107, 0.0717, 0.0384,
        0.0140])
[rfa agg] iter:  1, prev_obj_val: 60.7923583984375, obj_val: 64.66972351074219, abs dis: 3.8773651123046875
[rfa agg] iter: 1, weight: tensor([0.1162, 0.0239, 0.0554, 0.5002, 0.1101, 0.0699, 0.0106, 0.0584, 0.0412,
        0.0141])
[rfa agg] iter:  2, prev_obj_val: 64.66972351074219, obj_val: 66.63362121582031, abs dis: 1.963897705078125
[rfa agg] iter: 2, weight: tensor([0.1193, 0.0361, 0.0663, 0.3047, 0.2220, 0.0809, 0.0154, 0.0693, 0.0656,
        0.0206])
[rfa agg] iter:  3, prev_obj_val: 66.63362121582031, obj_val: 64.64299011230469, abs dis: 1.990631103515625
[rfa agg] iter: 3, weight: tensor([0.1075, 0.0389, 0.0633, 0.2270, 0.3101, 0.0761, 0.0162, 0.0659, 0.0733,
        0.0218])
[rfa agg] iter:  4, prev_obj_val: 64.64299011230469, obj_val: 64.63677215576172, abs dis: 0.00621795654296875
[rfa agg] iter: 4, weight: tensor([0.1198, 0.0362, 0.0665, 0.2902, 0.2348, 0.0811, 0.0154, 0.0695, 0.0658,
        0.0207])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3492, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.0987, Accuracy: 6/9950 (0.0603%)
saving model
Done in 341.0183870792389 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0568, Accuracy: 236/809 (29.1718%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0239, Accuracy: 435/809 (53.7701%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.4301, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0494, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0263, Accuracy: 585/1213 (48.2275%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.3159, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0546, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0290, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.0887, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0618, Accuracy: 195/938 (20.7889%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0321, Accuracy: 379/938 (40.4051%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.2737, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0516, Accuracy: 367/719 (51.0431%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0287, Accuracy: 445/719 (61.8915%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9775, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 686/2227 (30.8038%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0219, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0512, Accuracy: 321/712 (45.0843%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0224, Accuracy: 443/712 (62.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.9131, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0468, Accuracy: 325/813 (39.9754%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 500/813 (61.5006%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 12.5571, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0520, Accuracy: 319/590 (54.0678%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0291, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.9103, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0517, Accuracy: 269/861 (31.2427%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0185, Accuracy: 508/861 (59.0012%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.0934, Accuracy: 115/10000 (1.1500%)
time spent on training: 233.63848209381104
[rfa agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [50, 97, 52, 73, 41, 60, 11, 53, 69, 10], weight: tensor([0.0850, 0.1274, 0.0668, 0.0986, 0.0755, 0.2340, 0.0748, 0.0854, 0.0620,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 63.225196838378906, obj_val: 63.5050163269043, abs dis: 0.2798194885253906
[rfa agg] iter: 0, weight: tensor([0.0956, 0.1416, 0.0382, 0.2759, 0.0641, 0.0424, 0.0638, 0.0960, 0.0355,
        0.1470])
[rfa agg] iter:  1, prev_obj_val: 63.5050163269043, obj_val: 74.9474105834961, abs dis: 11.442394256591797
[rfa agg] iter: 1, weight: tensor([0.1813, 0.0343, 0.0453, 0.0678, 0.1512, 0.0183, 0.1717, 0.1901, 0.0426,
        0.0973])
[rfa agg] iter:  2, prev_obj_val: 74.9474105834961, obj_val: 82.56109619140625, abs dis: 7.613685607910156
[rfa agg] iter: 2, weight: tensor([0.0842, 0.0380, 0.1973, 0.0551, 0.1191, 0.0243, 0.1210, 0.0851, 0.2113,
        0.0647])
[rfa agg] iter:  3, prev_obj_val: 82.56109619140625, obj_val: 78.46357727050781, abs dis: 4.0975189208984375
[rfa agg] iter: 3, weight: tensor([0.0690, 0.0386, 0.2530, 0.0513, 0.0843, 0.0265, 0.0844, 0.0695, 0.2662,
        0.0573])
[rfa agg] iter:  4, prev_obj_val: 78.46357727050781, obj_val: 82.55474090576172, abs dis: 4.091163635253906
[rfa agg] iter: 4, weight: tensor([0.0595, 0.0303, 0.2704, 0.0419, 0.0765, 0.0201, 0.0771, 0.0599, 0.3166,
        0.0478])
[rfa agg] iter:  5, prev_obj_val: 82.55474090576172, obj_val: 86.89039611816406, abs dis: 4.335655212402344
[rfa agg] iter: 5, weight: tensor([0.0671, 0.0375, 0.2602, 0.0499, 0.0816, 0.0258, 0.0817, 0.0675, 0.2729,
        0.0557])
[rfa agg] iter:  6, prev_obj_val: 86.89039611816406, obj_val: 74.8907470703125, abs dis: 11.999649047851562
[rfa agg] iter: 6, weight: tensor([0.0797, 0.0482, 0.2247, 0.0619, 0.0930, 0.0342, 0.0929, 0.0802, 0.2172,
        0.0680])
[rfa agg] iter:  7, prev_obj_val: 74.8907470703125, obj_val: 78.47318267822266, abs dis: 3.5824356079101562
[rfa agg] iter: 7, weight: tensor([0.0799, 0.0362, 0.2178, 0.0524, 0.1109, 0.0231, 0.1131, 0.0805, 0.2247,
        0.0614])
[rfa agg] iter:  8, prev_obj_val: 78.47318267822266, obj_val: 82.55426788330078, abs dis: 4.081085205078125
[rfa agg] iter: 8, weight: tensor([0.0613, 0.0312, 0.2639, 0.0431, 0.0791, 0.0207, 0.0797, 0.0617, 0.3100,
        0.0492])
[rfa agg] iter:  9, prev_obj_val: 82.55426788330078, obj_val: 86.89033508300781, abs dis: 4.336067199707031
[rfa agg] iter: 9, weight: tensor([0.0672, 0.0376, 0.2596, 0.0500, 0.0817, 0.0258, 0.0819, 0.0676, 0.2727,
        0.0558])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3500, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.0774, Accuracy: 6/9950 (0.0603%)
saving model
Saving model on epoch 60
Done in 330.09093403816223 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0529, Accuracy: 469/1953 (24.0143%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0315, Accuracy: 886/1953 (45.3661%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8117, Accuracy: 108/10000 (1.0800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0472, Accuracy: 480/1574 (30.4956%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0249, Accuracy: 771/1574 (48.9835%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.6009, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0566, Accuracy: 226/809 (27.9357%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0247, Accuracy: 408/809 (50.4326%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.1103, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0810, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 177/312 (56.7308%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8457, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0459, Accuracy: 550/1129 (48.7157%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0211, Accuracy: 777/1129 (68.8220%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.5270, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0479, Accuracy: 463/1628 (28.4398%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0236, Accuracy: 916/1628 (56.2654%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.2617, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0506, Accuracy: 370/1130 (32.7434%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0266, Accuracy: 558/1130 (49.3805%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.5611, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0526, Accuracy: 297/636 (46.6981%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0278, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5907, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0521, Accuracy: 340/712 (47.7528%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0235, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.0015, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0594, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0348, Accuracy: 448/1163 (38.5211%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.3529, Accuracy: 82/10000 (0.8200%)
time spent on training: 270.889564037323
[rfa agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.04452969400688032
[rfa agg] init. name: [83, 17, 50, 24, 37, 5, 54, 52, 11, 68], weight: tensor([0.1768, 0.1425, 0.0732, 0.0282, 0.1022, 0.1474, 0.1023, 0.0576, 0.0645,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 56.041412353515625, obj_val: 63.24916458129883, abs dis: 7.207752227783203
[rfa agg] iter: 0, weight: tensor([0.0348, 0.0536, 0.0326, 0.0052, 0.2351, 0.0482, 0.2707, 0.0166, 0.0243,
        0.2789])
[rfa agg] iter:  1, prev_obj_val: 63.24916458129883, obj_val: 63.23689270019531, abs dis: 0.012271881103515625
[rfa agg] iter: 1, weight: tensor([0.0481, 0.0660, 0.0812, 0.0097, 0.2358, 0.0611, 0.2464, 0.0348, 0.0561,
        0.1607])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3497, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.1032, Accuracy: 5/9950 (0.0503%)
saving model
Done in 368.84682750701904 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0725, Accuracy: 98/500 (19.6000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0456, Accuracy: 230/500 (46.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6513, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0510, Accuracy: 343/1340 (25.5970%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0251, Accuracy: 590/1340 (44.0299%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.3382, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0594, Accuracy: 305/715 (42.6573%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0371, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.3066, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0649, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0362, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5232, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0597, Accuracy: 181/781 (23.1754%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0320, Accuracy: 286/781 (36.6197%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.6410, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 460/1440 (31.9444%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0267, Accuracy: 716/1440 (49.7222%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0899, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 477/1715 (27.8134%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0285, Accuracy: 814/1715 (47.4636%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7750, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0569, Accuracy: 193/735 (26.2585%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0211, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 12.0223, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0586, Accuracy: 375/1163 (32.2442%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0345, Accuracy: 488/1163 (41.9604%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4255, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0523, Accuracy: 349/1089 (32.0478%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0264, Accuracy: 538/1089 (49.4031%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.4811, Accuracy: 64/10000 (0.6400%)
time spent on training: 262.6829733848572
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 77, 23, 80, 3, 29, 92, 32, 68, 59], weight: tensor([0.0492, 0.1319, 0.0704, 0.0671, 0.0769, 0.1417, 0.1688, 0.0723, 0.1145,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 52.08148956298828, obj_val: 54.981388092041016, abs dis: 2.8998985290527344
[rfa agg] iter: 0, weight: tensor([0.0297, 0.1078, 0.0894, 0.0671, 0.1357, 0.0851, 0.0664, 0.0924, 0.1442,
        0.1823])
[rfa agg] iter:  1, prev_obj_val: 54.981388092041016, obj_val: 58.004638671875, abs dis: 3.0232505798339844
[rfa agg] iter: 1, weight: tensor([0.0321, 0.0858, 0.1154, 0.0806, 0.2050, 0.0706, 0.0573, 0.1200, 0.1066,
        0.1267])
[rfa agg] iter:  2, prev_obj_val: 58.004638671875, obj_val: 61.786922454833984, abs dis: 3.7822837829589844
[rfa agg] iter: 2, weight: tensor([0.0276, 0.0542, 0.1330, 0.0815, 0.3419, 0.0460, 0.0386, 0.1410, 0.0638,
        0.0724])
[rfa agg] iter:  3, prev_obj_val: 61.786922454833984, obj_val: 67.33197021484375, abs dis: 5.545047760009766
[rfa agg] iter: 3, weight: tensor([0.0247, 0.0352, 0.1933, 0.0964, 0.2744, 0.0306, 0.0264, 0.2356, 0.0397,
        0.0437])
[rfa agg] iter:  4, prev_obj_val: 67.33197021484375, obj_val: 67.30491638183594, abs dis: 0.0270538330078125
[rfa agg] iter: 4, weight: tensor([0.0327, 0.0326, 0.2092, 0.2259, 0.1158, 0.0289, 0.0256, 0.2554, 0.0357,
        0.0384])
[rfa agg] iter:  5, prev_obj_val: 67.30491638183594, obj_val: 70.7481689453125, abs dis: 3.4432525634765625
[rfa agg] iter: 5, weight: tensor([0.0320, 0.0318, 0.2139, 0.2394, 0.1108, 0.0282, 0.0250, 0.2466, 0.0348,
        0.0374])
[rfa agg] iter:  6, prev_obj_val: 70.7481689453125, obj_val: 74.5497817993164, abs dis: 3.8016128540039062
[rfa agg] iter: 6, weight: tensor([0.0391, 0.0318, 0.1484, 0.4072, 0.0897, 0.0285, 0.0255, 0.1589, 0.0344,
        0.0366])
[rfa agg] iter:  7, prev_obj_val: 74.5497817993164, obj_val: 78.5101089477539, abs dis: 3.9603271484375
[rfa agg] iter: 7, weight: tensor([0.0612, 0.0398, 0.1390, 0.3633, 0.0953, 0.0360, 0.0325, 0.1451, 0.0426,
        0.0450])
[rfa agg] iter:  8, prev_obj_val: 78.5101089477539, obj_val: 67.31700134277344, abs dis: 11.193107604980469
[rfa agg] iter: 8, weight: tensor([0.0991, 0.0498, 0.1405, 0.2652, 0.1048, 0.0453, 0.0413, 0.1459, 0.0527,
        0.0553])
[rfa agg] iter:  9, prev_obj_val: 67.31700134277344, obj_val: 70.74629211425781, abs dis: 3.429290771484375
[rfa agg] iter: 9, weight: tensor([0.0324, 0.0322, 0.2111, 0.2478, 0.1120, 0.0286, 0.0253, 0.2375, 0.0353,
        0.0379])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3488, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.9293, Accuracy: 49/9950 (0.4925%)
saving model
Done in 369.76875376701355 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0724, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 282/530 (53.2075%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5652, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0510, Accuracy: 286/888 (32.2072%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0238, Accuracy: 508/888 (57.2072%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.2595, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0441, Accuracy: 576/1129 (51.0186%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 771/1129 (68.2905%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.8782, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0537, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0303, Accuracy: 707/1742 (40.5855%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6102, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0496, Accuracy: 381/1130 (33.7168%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0274, Accuracy: 521/1130 (46.1062%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.6457, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0574, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0318, Accuracy: 439/896 (48.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.5858, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0529, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 510/1154 (44.1941%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.0066, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 325/803 (40.4732%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 388/803 (48.3188%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.3411, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0546, Accuracy: 427/1475 (28.9492%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0295, Accuracy: 704/1475 (47.7288%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4371, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0573, Accuracy: 277/776 (35.6959%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0279, Accuracy: 441/776 (56.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.0019, Accuracy: 86/10000 (0.8600%)
time spent on training: 283.5601577758789
[rfa agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 63, 37, 93, 54, 89, 57, 58, 65, 75], weight: tensor([0.0504, 0.0844, 0.1073, 0.1655, 0.1074, 0.0851, 0.1097, 0.0763, 0.1402,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 46.94312286376953, obj_val: 53.49998092651367, abs dis: 6.556858062744141
[rfa agg] iter: 0, weight: tensor([0.0252, 0.1670, 0.1305, 0.0430, 0.1309, 0.1633, 0.0985, 0.0956, 0.0534,
        0.0927])
[rfa agg] iter:  1, prev_obj_val: 53.49998092651367, obj_val: 63.608795166015625, abs dis: 10.108814239501953
[rfa agg] iter: 1, weight: tensor([0.0230, 0.2264, 0.0483, 0.0236, 0.0483, 0.1996, 0.0406, 0.1830, 0.0275,
        0.1797])
[rfa agg] iter:  2, prev_obj_val: 63.608795166015625, obj_val: 63.59616470336914, abs dis: 0.012630462646484375
[rfa agg] iter: 2, weight: tensor([0.0556, 0.1371, 0.0593, 0.0348, 0.0594, 0.1349, 0.0522, 0.2178, 0.0392,
        0.2096])
[rfa agg] iter:  3, prev_obj_val: 63.59616470336914, obj_val: 67.50241088867188, abs dis: 3.9062461853027344
[rfa agg] iter: 3, weight: tensor([0.0553, 0.1352, 0.0590, 0.0346, 0.0591, 0.1327, 0.0519, 0.2201, 0.0389,
        0.2132])
[rfa agg] iter:  4, prev_obj_val: 67.50241088867188, obj_val: 59.80470657348633, abs dis: 7.697704315185547
[rfa agg] iter: 4, weight: tensor([0.0799, 0.1330, 0.0661, 0.0406, 0.0662, 0.1318, 0.0588, 0.1922, 0.0453,
        0.1860])
[rfa agg] iter:  5, prev_obj_val: 59.80470657348633, obj_val: 67.50688934326172, abs dis: 7.702182769775391
[rfa agg] iter: 5, weight: tensor([0.0368, 0.1351, 0.0496, 0.0276, 0.0497, 0.1306, 0.0432, 0.2507, 0.0314,
        0.2453])
[rfa agg] iter:  6, prev_obj_val: 67.50688934326172, obj_val: 56.332733154296875, abs dis: 11.174156188964844
[rfa agg] iter: 6, weight: tensor([0.0797, 0.1328, 0.0660, 0.0406, 0.0661, 0.1314, 0.0587, 0.1929, 0.0452,
        0.1865])
[rfa agg] iter:  7, prev_obj_val: 56.332733154296875, obj_val: 63.59986877441406, abs dis: 7.2671356201171875
[rfa agg] iter: 7, weight: tensor([0.0257, 0.1489, 0.0433, 0.0227, 0.0434, 0.1388, 0.0372, 0.2587, 0.0261,
        0.2552])
[rfa agg] iter:  8, prev_obj_val: 63.59986877441406, obj_val: 67.5025405883789, abs dis: 3.9026718139648438
[rfa agg] iter: 8, weight: tensor([0.0550, 0.1345, 0.0587, 0.0344, 0.0588, 0.1318, 0.0517, 0.2220, 0.0387,
        0.2144])
[rfa agg] iter:  9, prev_obj_val: 67.5025405883789, obj_val: 59.804691314697266, abs dis: 7.697849273681641
[rfa agg] iter: 9, weight: tensor([0.0799, 0.1330, 0.0661, 0.0406, 0.0662, 0.1318, 0.0588, 0.1922, 0.0453,
        0.1860])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3486, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 4.9384, Accuracy: 51/9950 (0.5126%)
saving model
Done in 384.88738107681274 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0818, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0446, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.4298, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0885, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0454, Accuracy: 159/338 (47.0414%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0052, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0845, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0685, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4180, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0494, Accuracy: 326/888 (36.7117%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 499/888 (56.1937%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.5034, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1084, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3728, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 561/1470 (38.1633%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0229, Accuracy: 913/1470 (62.1088%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1010, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0522, Accuracy: 502/1418 (35.4020%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0285, Accuracy: 723/1418 (50.9873%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1542, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 388/1427 (27.1899%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0317, Accuracy: 611/1427 (42.8171%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7090, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0770, Accuracy: 103/460 (22.3913%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0345, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1485, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 547/1552 (35.2448%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0197, Accuracy: 821/1552 (52.8995%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.8519, Accuracy: 99/10000 (0.9900%)
time spent on training: 242.57572388648987
[rfa agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 12, 56, 63, 47, 22, 70, 34, 31, 74], weight: tensor([0.0559, 0.0405, 0.0223, 0.1065, 0.0161, 0.1763, 0.1700, 0.1711, 0.0552,
        0.1861])
[rfa agg] iter:  0, prev_obj_val: 63.92583465576172, obj_val: 62.10976028442383, abs dis: 1.8160743713378906
[rfa agg] iter: 0, weight: tensor([0.0406, 0.0239, 0.0102, 0.2539, 0.0074, 0.1665, 0.1605, 0.1619, 0.0401,
        0.1349])
[rfa agg] iter:  1, prev_obj_val: 62.10976028442383, obj_val: 58.51438903808594, abs dis: 3.5953712463378906
[rfa agg] iter: 1, weight: tensor([0.0382, 0.0227, 0.0098, 0.2148, 0.0071, 0.1794, 0.1729, 0.1746, 0.0378,
        0.1427])
[rfa agg] iter:  2, prev_obj_val: 58.51438903808594, obj_val: 56.72456359863281, abs dis: 1.789825439453125
[rfa agg] iter: 2, weight: tensor([0.0325, 0.0197, 0.0087, 0.1531, 0.0062, 0.2023, 0.1949, 0.1970, 0.0321,
        0.1536])
[rfa agg] iter:  3, prev_obj_val: 56.72456359863281, obj_val: 56.72406768798828, abs dis: 0.00049591064453125
[rfa agg] iter: 3, weight: tensor([0.0293, 0.0179, 0.0079, 0.1291, 0.0057, 0.2126, 0.2048, 0.2071, 0.0290,
        0.1566])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3443, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.9678, Accuracy: 45/9950 (0.4523%)
saving model
Done in 346.2467141151428 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0555, Accuracy: 419/1587 (26.4020%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0317, Accuracy: 662/1587 (41.7139%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.1008, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 56/408 (13.7255%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0483, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.9300, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0514, Accuracy: 336/712 (47.1910%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0239, Accuracy: 440/712 (61.7978%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.4543, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0581, Accuracy: 264/1013 (26.0612%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0327, Accuracy: 400/1013 (39.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2706, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0522, Accuracy: 503/1953 (25.7552%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0311, Accuracy: 879/1953 (45.0077%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8748, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 445/1440 (30.9028%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0261, Accuracy: 747/1440 (51.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8266, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0518, Accuracy: 450/1475 (30.5085%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0288, Accuracy: 722/1475 (48.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.6461, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0569, Accuracy: 328/1241 (26.4303%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0343, Accuracy: 467/1241 (37.6309%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9586, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0638, Accuracy: 173/682 (25.3666%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0351, Accuracy: 275/682 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5368, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0512, Accuracy: 325/861 (37.7468%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0185, Accuracy: 507/861 (58.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.2590, Accuracy: 91/10000 (0.9100%)
time spent on training: 291.7394423484802
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 36, 11, 14, 83, 29, 65, 72, 80, 10], weight: tensor([0.1396, 0.0359, 0.0626, 0.0891, 0.1717, 0.1266, 0.1297, 0.1091, 0.0600,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 57.22047805786133, obj_val: 61.93867874145508, abs dis: 4.71820068359375
[rfa agg] iter: 0, weight: tensor([0.0953, 0.0139, 0.0428, 0.1541, 0.0613, 0.1239, 0.1039, 0.2950, 0.0357,
        0.0740])
[rfa agg] iter:  1, prev_obj_val: 61.93867874145508, obj_val: 65.36973571777344, abs dis: 3.4310569763183594
[rfa agg] iter: 1, weight: tensor([0.0752, 0.0155, 0.0538, 0.3288, 0.0530, 0.0907, 0.0795, 0.1551, 0.0431,
        0.1053])
[rfa agg] iter:  2, prev_obj_val: 65.36973571777344, obj_val: 67.52881622314453, abs dis: 2.1590805053710938
[rfa agg] iter: 2, weight: tensor([0.0456, 0.0118, 0.0456, 0.5446, 0.0337, 0.0531, 0.0475, 0.0795, 0.0352,
        0.1034])
[rfa agg] iter:  3, prev_obj_val: 67.52881622314453, obj_val: 69.90310668945312, abs dis: 2.3742904663085938
[rfa agg] iter: 3, weight: tensor([0.0474, 0.0136, 0.0568, 0.4812, 0.0358, 0.0543, 0.0491, 0.0775, 0.0428,
        0.1415])
[rfa agg] iter:  4, prev_obj_val: 69.90310668945312, obj_val: 72.3210678100586, abs dis: 2.4179611206054688
[rfa agg] iter: 4, weight: tensor([0.0540, 0.0174, 0.0789, 0.3230, 0.0416, 0.0611, 0.0556, 0.0838, 0.0576,
        0.2270])
[rfa agg] iter:  5, prev_obj_val: 72.3210678100586, obj_val: 72.30130004882812, abs dis: 0.01976776123046875
[rfa agg] iter: 5, weight: tensor([0.0508, 0.0183, 0.0929, 0.2157, 0.0399, 0.0569, 0.0521, 0.0755, 0.0650,
        0.3330])
[rfa agg] iter:  6, prev_obj_val: 72.30130004882812, obj_val: 72.30048370361328, abs dis: 0.00081634521484375
[rfa agg] iter: 6, weight: tensor([0.0493, 0.0177, 0.0900, 0.2043, 0.0386, 0.0551, 0.0505, 0.0731, 0.0629,
        0.3584])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3455, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 4.9795, Accuracy: 21/9950 (0.2111%)
saving model
Done in 398.0722711086273 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 145/603 (24.0464%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6435, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1287, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1185, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3515, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0539, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 751/1742 (43.1114%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1542, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0705, Accuracy: 162/530 (30.5660%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0364, Accuracy: 279/530 (52.6415%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2151, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0642, Accuracy: 148/682 (21.7009%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0354, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2909, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 495/1715 (28.8630%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0284, Accuracy: 817/1715 (47.6385%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9197, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/677 (47.2674%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.7606, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0564, Accuracy: 352/1241 (28.3642%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0350, Accuracy: 477/1241 (38.4367%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4824, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 404/1956 (20.6544%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 718/1956 (36.7076%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.6159, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0520, Accuracy: 508/1418 (35.8251%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0281, Accuracy: 729/1418 (51.4104%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.3197, Accuracy: 121/10000 (1.2100%)
time spent on training: 278.7892096042633
[rfa agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 61, 93, 18, 80, 92, 90, 72, 6, 70], weight: tensor([0.0566, 0.0080, 0.1636, 0.0498, 0.0640, 0.1610, 0.0636, 0.1165, 0.1837,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 64.63419342041016, obj_val: 65.99422454833984, abs dis: 1.3600311279296875
[rfa agg] iter: 0, weight: tensor([0.0211, 0.0017, 0.0850, 0.0170, 0.0264, 0.0962, 0.0262, 0.4606, 0.0684,
        0.1975])
[rfa agg] iter:  1, prev_obj_val: 65.99422454833984, obj_val: 70.14757537841797, abs dis: 4.153350830078125
[rfa agg] iter: 1, weight: tensor([0.0164, 0.0013, 0.0589, 0.0131, 0.0206, 0.0661, 0.0205, 0.6312, 0.0482,
        0.1237])
[rfa agg] iter:  2, prev_obj_val: 70.14757537841797, obj_val: 72.37557220458984, abs dis: 2.227996826171875
[rfa agg] iter: 2, weight: tensor([0.0282, 0.0021, 0.0811, 0.0223, 0.0358, 0.0896, 0.0355, 0.4920, 0.0684,
        0.1450])
[rfa agg] iter:  3, prev_obj_val: 72.37557220458984, obj_val: 67.96554565429688, abs dis: 4.410026550292969
[rfa agg] iter: 3, weight: tensor([0.0364, 0.0026, 0.0938, 0.0286, 0.0465, 0.1030, 0.0462, 0.4040, 0.0801,
        0.1586])
[rfa agg] iter:  4, prev_obj_val: 67.96554565429688, obj_val: 70.1340560913086, abs dis: 2.1685104370117188
[rfa agg] iter: 4, weight: tensor([0.0219, 0.0017, 0.0704, 0.0174, 0.0276, 0.0783, 0.0274, 0.5611, 0.0585,
        0.1357])
[rfa agg] iter:  5, prev_obj_val: 70.1340560913086, obj_val: 72.37481689453125, abs dis: 2.2407608032226562
[rfa agg] iter: 5, weight: tensor([0.0285, 0.0021, 0.0820, 0.0225, 0.0362, 0.0906, 0.0359, 0.4861, 0.0692,
        0.1469])
[rfa agg] iter:  6, prev_obj_val: 72.37481689453125, obj_val: 67.96564483642578, abs dis: 4.409172058105469
[rfa agg] iter: 6, weight: tensor([0.0364, 0.0026, 0.0938, 0.0286, 0.0465, 0.1031, 0.0463, 0.4037, 0.0802,
        0.1587])
[rfa agg] iter:  7, prev_obj_val: 67.96564483642578, obj_val: 70.13404083251953, abs dis: 2.16839599609375
[rfa agg] iter: 7, weight: tensor([0.0219, 0.0017, 0.0704, 0.0174, 0.0276, 0.0783, 0.0275, 0.5610, 0.0585,
        0.1357])
[rfa agg] iter:  8, prev_obj_val: 70.13404083251953, obj_val: 72.37481689453125, abs dis: 2.2407760620117188
[rfa agg] iter: 8, weight: tensor([0.0285, 0.0021, 0.0820, 0.0225, 0.0362, 0.0906, 0.0359, 0.4861, 0.0692,
        0.1469])
[rfa agg] iter:  9, prev_obj_val: 72.37481689453125, obj_val: 67.96565246582031, abs dis: 4.4091644287109375
[rfa agg] iter: 9, weight: tensor([0.0364, 0.0026, 0.0938, 0.0286, 0.0465, 0.1031, 0.0463, 0.4037, 0.0802,
        0.1587])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3424, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.0042, Accuracy: 22/9950 (0.2211%)
saving model
Done in 376.34614086151123 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0590, Accuracy: 300/946 (31.7125%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0325, Accuracy: 386/946 (40.8034%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.2959, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0728, Accuracy: 88/500 (17.6000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0461, Accuracy: 216/500 (43.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.5421, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0475, Accuracy: 359/599 (59.9332%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.5851, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0534, Accuracy: 330/1071 (30.8123%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0272, Accuracy: 553/1071 (51.6340%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9321, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0487, Accuracy: 450/1628 (27.6413%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0232, Accuracy: 933/1628 (57.3096%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.8149, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0616, Accuracy: 197/938 (21.0021%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0314, Accuracy: 374/938 (39.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9420, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0495, Accuracy: 322/888 (36.2613%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0236, Accuracy: 506/888 (56.9820%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.0373, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0573, Accuracy: 340/1131 (30.0619%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0276, Accuracy: 526/1131 (46.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3188, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0534, Accuracy: 381/1645 (23.1611%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0299, Accuracy: 724/1645 (44.0122%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2735, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0824, Accuracy: 64/466 (13.7339%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0416, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.1248, Accuracy: 50/10000 (0.5000%)
time spent on training: 268.10975885391235
[rfa agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 82, 95, 55, 5, 73, 63, 38, 13, 76], weight: tensor([0.0964, 0.0510, 0.0610, 0.1092, 0.1659, 0.0956, 0.0905, 0.1153, 0.1677,
        0.0475])
[rfa agg] iter:  0, prev_obj_val: 49.26112365722656, obj_val: 55.839637756347656, abs dis: 6.578514099121094
[rfa agg] iter: 0, weight: tensor([0.2960, 0.0142, 0.0237, 0.0995, 0.0295, 0.2735, 0.1474, 0.0731, 0.0298,
        0.0133])
[rfa agg] iter:  1, prev_obj_val: 55.839637756347656, obj_val: 64.68814086914062, abs dis: 8.848503112792969
[rfa agg] iter: 1, weight: tensor([0.1748, 0.0264, 0.0492, 0.0869, 0.0379, 0.1728, 0.3170, 0.0721, 0.0383,
        0.0246])
[rfa agg] iter:  2, prev_obj_val: 64.68814086914062, obj_val: 61.67638397216797, abs dis: 3.0117568969726562
[rfa agg] iter: 2, weight: tensor([0.1405, 0.0564, 0.1297, 0.0959, 0.0526, 0.1391, 0.1955, 0.0848, 0.0532,
        0.0523])
[rfa agg] iter:  3, prev_obj_val: 61.67638397216797, obj_val: 61.67515563964844, abs dis: 0.00122833251953125
[rfa agg] iter: 3, weight: tensor([0.1528, 0.0459, 0.0969, 0.0971, 0.0498, 0.1511, 0.2290, 0.0844, 0.0504,
        0.0426])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3422, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.9378, Accuracy: 55/9950 (0.5528%)
saving model
Done in 367.85848689079285 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 310/807 (38.4139%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0304, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.4611, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0576, Accuracy: 309/715 (43.2168%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0343, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.3255, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 335/803 (41.7186%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 389/803 (48.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.3166, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0583, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0331, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0017, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0725, Accuracy: 95/500 (19.0000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0454, Accuracy: 228/500 (45.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.3043, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0571, Accuracy: 323/1513 (21.3483%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0344, Accuracy: 564/1513 (37.2769%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1377, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0605, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0322, Accuracy: 440/708 (62.1469%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4033, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0610, Accuracy: 325/1003 (32.4028%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0326, Accuracy: 413/1003 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7839, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0519, Accuracy: 363/1049 (34.6044%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0256, Accuracy: 587/1049 (55.9581%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5015, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0383, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.3726, Accuracy: 60/10000 (0.6000%)
time spent on training: 230.00071167945862
[rfa agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 23, 58, 43, 82, 8, 16, 86, 51, 62], weight: tensor([0.0937, 0.0830, 0.0932, 0.1098, 0.0581, 0.1757, 0.0822, 0.1165, 0.1218,
        0.0660])
[rfa agg] iter:  0, prev_obj_val: 36.55577850341797, obj_val: 44.44601821899414, abs dis: 7.890239715576172
[rfa agg] iter: 0, weight: tensor([0.1938, 0.1625, 0.1983, 0.0756, 0.0230, 0.0273, 0.1806, 0.0583, 0.0473,
        0.0334])
[rfa agg] iter:  1, prev_obj_val: 44.44601821899414, obj_val: 47.67558670043945, abs dis: 3.2295684814453125
[rfa agg] iter: 1, weight: tensor([0.1224, 0.1889, 0.1233, 0.0745, 0.0527, 0.0372, 0.1946, 0.0635, 0.0551,
        0.0878])
[rfa agg] iter:  2, prev_obj_val: 47.67558670043945, obj_val: 54.3279914855957, abs dis: 6.65240478515625
[rfa agg] iter: 2, weight: tensor([0.1141, 0.1611, 0.1146, 0.0763, 0.0726, 0.0412, 0.1625, 0.0665, 0.0586,
        0.1325])
[rfa agg] iter:  3, prev_obj_val: 54.3279914855957, obj_val: 57.77760696411133, abs dis: 3.449615478515625
[rfa agg] iter: 3, weight: tensor([0.0828, 0.1013, 0.0827, 0.0625, 0.1179, 0.0382, 0.1011, 0.0562, 0.0508,
        0.3065])
[rfa agg] iter:  4, prev_obj_val: 57.77760696411133, obj_val: 57.757511138916016, abs dis: 0.0200958251953125
[rfa agg] iter: 4, weight: tensor([0.0575, 0.0674, 0.0575, 0.0454, 0.1360, 0.0292, 0.0671, 0.0414, 0.0377,
        0.4608])
[rfa agg] iter:  5, prev_obj_val: 57.757511138916016, obj_val: 57.75376892089844, abs dis: 0.003742218017578125
[rfa agg] iter: 5, weight: tensor([0.0502, 0.0587, 0.0501, 0.0397, 0.1190, 0.0255, 0.0585, 0.0361, 0.0330,
        0.5292])
[rfa agg] iter:  6, prev_obj_val: 57.75376892089844, obj_val: 54.330379486083984, abs dis: 3.423389434814453
[rfa agg] iter: 6, weight: tensor([0.0466, 0.0545, 0.0466, 0.0369, 0.1100, 0.0237, 0.0543, 0.0336, 0.0306,
        0.5632])
[rfa agg] iter:  7, prev_obj_val: 54.330379486083984, obj_val: 61.57678985595703, abs dis: 7.246410369873047
[rfa agg] iter: 7, weight: tensor([0.0768, 0.0937, 0.0768, 0.0583, 0.1103, 0.0356, 0.0935, 0.0524, 0.0473,
        0.3554])
[rfa agg] iter:  8, prev_obj_val: 61.57678985595703, obj_val: 61.56913375854492, abs dis: 0.007656097412109375
[rfa agg] iter: 8, weight: tensor([0.0590, 0.0668, 0.0589, 0.0483, 0.2672, 0.0325, 0.0664, 0.0444, 0.0409,
        0.3156])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3422, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.9555, Accuracy: 50/9950 (0.5025%)
saving model
Done in 333.2114899158478 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0559, Accuracy: 296/807 (36.6791%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0298, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.3741, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0707, Accuracy: 121/486 (24.8971%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0374, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6613, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0583, Accuracy: 315/946 (33.2981%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0327, Accuracy: 340/946 (35.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6040, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0719, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0443, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8414, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0505, Accuracy: 324/590 (54.9153%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.2504, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1063, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0858, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.5962, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0705, Accuracy: 116/500 (23.2000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0447, Accuracy: 224/500 (44.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6580, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0583, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 398/901 (44.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.8313, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0585, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0338, Accuracy: 505/1163 (43.4222%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6284, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 526/1552 (33.8918%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.1889, Accuracy: 90/10000 (0.9000%)
time spent on training: 217.23690938949585
[rfa agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 30, 43, 88, 69, 79, 82, 4, 68, 74], weight: tensor([0.1042, 0.0628, 0.1221, 0.0779, 0.0762, 0.0254, 0.0646, 0.1163, 0.1502,
        0.2004])
[rfa agg] iter:  0, prev_obj_val: 45.727386474609375, obj_val: 48.063297271728516, abs dis: 2.3359107971191406
[rfa agg] iter: 0, weight: tensor([0.3162, 0.0300, 0.2000, 0.0581, 0.0568, 0.0071, 0.0309, 0.1834, 0.0716,
        0.0459])
[rfa agg] iter:  1, prev_obj_val: 48.063297271728516, obj_val: 53.13068771362305, abs dis: 5.067390441894531
[rfa agg] iter: 1, weight: tensor([0.3846, 0.0383, 0.1316, 0.0844, 0.0822, 0.0083, 0.0394, 0.1236, 0.0634,
        0.0442])
[rfa agg] iter:  2, prev_obj_val: 53.13068771362305, obj_val: 53.075439453125, abs dis: 0.055248260498046875
[rfa agg] iter: 2, weight: tensor([0.1561, 0.0637, 0.0931, 0.2157, 0.2049, 0.0112, 0.0655, 0.0881, 0.0576,
        0.0441])
[rfa agg] iter:  3, prev_obj_val: 53.075439453125, obj_val: 54.85981750488281, abs dis: 1.7843780517578125
[rfa agg] iter: 3, weight: tensor([0.1500, 0.0627, 0.0916, 0.2208, 0.2126, 0.0110, 0.0647, 0.0867, 0.0567,
        0.0433])
[rfa agg] iter:  4, prev_obj_val: 54.85981750488281, obj_val: 69.23551940917969, abs dis: 14.375701904296875
[rfa agg] iter: 4, weight: tensor([0.0960, 0.0589, 0.0641, 0.2968, 0.2785, 0.0093, 0.0608, 0.0608, 0.0419,
        0.0329])
[rfa agg] iter:  5, prev_obj_val: 69.23551940917969, obj_val: 69.12178802490234, abs dis: 0.11373138427734375
[rfa agg] iter: 5, weight: tensor([0.0448, 0.2905, 0.0378, 0.0834, 0.0814, 0.0138, 0.3572, 0.0359, 0.0296,
        0.0256])
[rfa agg] iter:  6, prev_obj_val: 69.12178802490234, obj_val: 81.49296569824219, abs dis: 12.371177673339844
[rfa agg] iter: 6, weight: tensor([0.0348, 0.3135, 0.0294, 0.0641, 0.0626, 0.0107, 0.4142, 0.0279, 0.0230,
        0.0199])
[rfa agg] iter:  7, prev_obj_val: 81.49296569824219, obj_val: 56.979881286621094, abs dis: 24.513084411621094
[rfa agg] iter: 7, weight: tensor([0.0782, 0.2006, 0.0704, 0.1082, 0.1059, 0.0494, 0.2085, 0.0669, 0.0589,
        0.0531])
[rfa agg] iter:  8, prev_obj_val: 56.979881286621094, obj_val: 65.86103820800781, abs dis: 8.881156921386719
[rfa agg] iter: 8, weight: tensor([0.0644, 0.0587, 0.0462, 0.3435, 0.3176, 0.0081, 0.0607, 0.0438, 0.0317,
        0.0254])
[rfa agg] iter:  9, prev_obj_val: 65.86103820800781, obj_val: 69.13688659667969, abs dis: 3.275848388671875
[rfa agg] iter: 9, weight: tensor([0.0597, 0.2359, 0.0489, 0.1326, 0.1291, 0.0147, 0.2638, 0.0464, 0.0373,
        0.0317])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3433, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 4.9774, Accuracy: 38/9950 (0.3819%)
saving model
Done in 318.83814883232117 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0517, Accuracy: 414/1956 (21.1656%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0294, Accuracy: 715/1956 (36.5542%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3054, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0605, Accuracy: 207/938 (22.0682%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0315, Accuracy: 377/938 (40.1919%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1455, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0553, Accuracy: 300/776 (38.6598%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0265, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1524, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0625, Accuracy: 223/773 (28.8486%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 437/773 (56.5330%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.9804, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0537, Accuracy: 371/1154 (32.1490%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0258, Accuracy: 544/1154 (47.1404%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0509, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0572, Accuracy: 313/1513 (20.6874%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0345, Accuracy: 548/1513 (36.2194%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.0657, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0488, Accuracy: 413/1036 (39.8649%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 713/1036 (68.8224%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.4707, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0826, Accuracy: 12/311 (3.8585%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 138/311 (44.3730%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.1883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1064, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 424/1475 (28.7458%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0271, Accuracy: 782/1475 (53.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4457, Accuracy: 91/10000 (0.9100%)
time spent on training: 274.65733313560486
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 73, 75, 99, 15, 8, 19, 96, 47, 65], weight: tensor([0.1943, 0.0932, 0.0771, 0.0768, 0.1146, 0.1503, 0.1029, 0.0309, 0.0133,
        0.1465])
[rfa agg] iter:  0, prev_obj_val: 54.63724136352539, obj_val: 56.00400924682617, abs dis: 1.3667678833007812
[rfa agg] iter: 0, weight: tensor([0.0516, 0.0734, 0.0408, 0.0406, 0.4417, 0.0943, 0.1556, 0.0070, 0.0027,
        0.0924])
[rfa agg] iter:  1, prev_obj_val: 56.00400924682617, obj_val: 59.77131652832031, abs dis: 3.7673072814941406
[rfa agg] iter: 1, weight: tensor([0.0477, 0.0967, 0.0489, 0.0486, 0.3250, 0.0790, 0.2664, 0.0076, 0.0028,
        0.0773])
[rfa agg] iter:  2, prev_obj_val: 59.77131652832031, obj_val: 63.44926834106445, abs dis: 3.6779518127441406
[rfa agg] iter: 2, weight: tensor([0.0403, 0.1712, 0.0653, 0.0647, 0.1339, 0.0598, 0.3952, 0.0081, 0.0030,
        0.0585])
[rfa agg] iter:  3, prev_obj_val: 63.44926834106445, obj_val: 67.95027160644531, abs dis: 4.501003265380859
[rfa agg] iter: 3, weight: tensor([0.0383, 0.3639, 0.0914, 0.0902, 0.0974, 0.0536, 0.2006, 0.0090, 0.0033,
        0.0524])
[rfa agg] iter:  4, prev_obj_val: 67.95027160644531, obj_val: 67.94047546386719, abs dis: 0.009796142578125
[rfa agg] iter: 4, weight: tensor([0.0340, 0.4021, 0.1379, 0.1349, 0.0725, 0.0455, 0.1159, 0.0094, 0.0034,
        0.0445])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3403, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.7430, Accuracy: 410/9950 (4.1206%)
saving model
Done in 373.1442973613739 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0675, Accuracy: 173/631 (27.4168%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0396, Accuracy: 276/631 (43.7401%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1526, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0467, Accuracy: 498/1628 (30.5897%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0231, Accuracy: 903/1628 (55.4668%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.9186, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0560, Accuracy: 227/938 (24.2004%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0307, Accuracy: 383/938 (40.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.9925, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0567, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0319, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3047, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0641, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0333, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1009, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0575, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0361, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4392, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0540, Accuracy: 218/735 (29.6599%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0194, Accuracy: 425/735 (57.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.1903, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0506, Accuracy: 369/1340 (27.5373%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0252, Accuracy: 605/1340 (45.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.9849, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0704, Accuracy: 155/530 (29.2453%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0355, Accuracy: 284/530 (53.5849%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.7011, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0521, Accuracy: 484/1953 (24.7824%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0317, Accuracy: 838/1953 (42.9083%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7639, Accuracy: 138/10000 (1.3800%)
time spent on training: 275.0679566860199
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 5, 73, 89, 81, 23, 32, 77, 18, 83], weight: tensor([0.0622, 0.1606, 0.0925, 0.0884, 0.0763, 0.0705, 0.0725, 0.1321, 0.0523,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 62.95116424560547, obj_val: 67.61033630371094, abs dis: 4.659172058105469
[rfa agg] iter: 0, weight: tensor([0.0417, 0.0648, 0.2946, 0.1689, 0.0998, 0.0699, 0.0725, 0.1057, 0.0301,
        0.0519])
[rfa agg] iter:  1, prev_obj_val: 67.61033630371094, obj_val: 75.01589965820312, abs dis: 7.4055633544921875
[rfa agg] iter: 1, weight: tensor([0.0497, 0.0301, 0.1085, 0.1839, 0.2444, 0.1328, 0.1527, 0.0401, 0.0317,
        0.0261])
[rfa agg] iter:  2, prev_obj_val: 75.01589965820312, obj_val: 81.7159423828125, abs dis: 6.700042724609375
[rfa agg] iter: 2, weight: tensor([0.0999, 0.0289, 0.0677, 0.0900, 0.1229, 0.2063, 0.2685, 0.0363, 0.0537,
        0.0258])
[rfa agg] iter:  3, prev_obj_val: 81.7159423828125, obj_val: 85.24440002441406, abs dis: 3.5284576416015625
[rfa agg] iter: 3, weight: tensor([0.2523, 0.0337, 0.0660, 0.0808, 0.0955, 0.1404, 0.1516, 0.0409, 0.1082,
        0.0306])
[rfa agg] iter:  4, prev_obj_val: 85.24440002441406, obj_val: 89.06831359863281, abs dis: 3.82391357421875
[rfa agg] iter: 4, weight: tensor([0.3705, 0.0297, 0.0543, 0.0647, 0.0732, 0.0983, 0.1043, 0.0355, 0.1422,
        0.0272])
[rfa agg] iter:  5, prev_obj_val: 89.06831359863281, obj_val: 85.2341537475586, abs dis: 3.8341598510742188
[rfa agg] iter: 5, weight: tensor([0.3025, 0.0305, 0.0524, 0.0610, 0.0669, 0.0845, 0.0890, 0.0360, 0.2490,
        0.0281])
[rfa agg] iter:  6, prev_obj_val: 85.2341537475586, obj_val: 89.0701675415039, abs dis: 3.8360137939453125
[rfa agg] iter: 6, weight: tensor([0.3971, 0.0284, 0.0520, 0.0618, 0.0698, 0.0931, 0.0992, 0.0340, 0.1388,
        0.0260])
[rfa agg] iter:  7, prev_obj_val: 89.0701675415039, obj_val: 85.23365020751953, abs dis: 3.836517333984375
[rfa agg] iter: 7, weight: tensor([0.3067, 0.0304, 0.0522, 0.0608, 0.0666, 0.0841, 0.0886, 0.0359, 0.2467,
        0.0280])
[rfa agg] iter:  8, prev_obj_val: 85.23365020751953, obj_val: 89.07029724121094, abs dis: 3.8366470336914062
[rfa agg] iter: 8, weight: tensor([0.3985, 0.0283, 0.0518, 0.0617, 0.0696, 0.0929, 0.0989, 0.0339, 0.1384,
        0.0259])
[rfa agg] iter:  9, prev_obj_val: 89.07029724121094, obj_val: 85.23362731933594, abs dis: 3.836669921875
[rfa agg] iter: 9, weight: tensor([0.3069, 0.0304, 0.0522, 0.0608, 0.0666, 0.0841, 0.0885, 0.0359, 0.2465,
        0.0280])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3391, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.6662, Accuracy: 839/9950 (8.4322%)
saving model
Done in 382.6748836040497 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0693, Accuracy: 136/486 (27.9835%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0370, Accuracy: 221/486 (45.4733%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4255, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0590, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0332, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.6564, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0482, Accuracy: 327/888 (36.8243%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0233, Accuracy: 499/888 (56.1937%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.4785, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0543, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0209, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.5323, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 84/515 (16.3107%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0518, Accuracy: 178/515 (34.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7362, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0772, Accuracy: 60/373 (16.0858%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0453, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8100, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0597, Accuracy: 205/781 (26.2484%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0326, Accuracy: 312/781 (39.9488%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8590, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0664, Accuracy: 169/568 (29.7535%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0379, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0978, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 410/1949 (21.0364%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 650/1949 (33.3504%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3804, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0490, Accuracy: 444/1036 (42.8571%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0225, Accuracy: 734/1036 (70.8494%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.9231, Accuracy: 67/10000 (0.6700%)
time spent on training: 235.80485796928406
[rfa agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 16, 63, 90, 33, 98, 3, 62, 21, 19], weight: tensor([0.0609, 0.0887, 0.1113, 0.0848, 0.0645, 0.0467, 0.0979, 0.0712, 0.2442,
        0.1298])
[rfa agg] iter:  0, prev_obj_val: 59.82111740112305, obj_val: 61.505401611328125, abs dis: 1.6842842102050781
[rfa agg] iter: 0, weight: tensor([0.0256, 0.0943, 0.3873, 0.0656, 0.0320, 0.0150, 0.1672, 0.0353, 0.0405,
        0.1373])
[rfa agg] iter:  1, prev_obj_val: 61.505401611328125, obj_val: 69.74710083007812, abs dis: 8.24169921875
[rfa agg] iter: 1, weight: tensor([0.0385, 0.2454, 0.0977, 0.2645, 0.0560, 0.0188, 0.1371, 0.0620, 0.0278,
        0.0521])
[rfa agg] iter:  2, prev_obj_val: 69.74710083007812, obj_val: 79.01771545410156, abs dis: 9.270614624023438
[rfa agg] iter: 2, weight: tensor([0.0946, 0.0836, 0.0590, 0.1316, 0.2128, 0.0319, 0.0665, 0.2511, 0.0273,
        0.0415])
[rfa agg] iter:  3, prev_obj_val: 79.01771545410156, obj_val: 78.97566223144531, abs dis: 0.04205322265625
[rfa agg] iter: 3, weight: tensor([0.4078, 0.0495, 0.0416, 0.0631, 0.1341, 0.0519, 0.0439, 0.1518, 0.0239,
        0.0324])
[rfa agg] iter:  4, prev_obj_val: 78.97566223144531, obj_val: 90.96324920654297, abs dis: 11.987586975097656
[rfa agg] iter: 4, weight: tensor([0.5198, 0.0403, 0.0340, 0.0515, 0.1075, 0.0425, 0.0358, 0.1225, 0.0195,
        0.0265])
[rfa agg] iter:  5, prev_obj_val: 90.96324920654297, obj_val: 86.90640258789062, abs dis: 4.056846618652344
[rfa agg] iter: 5, weight: tensor([0.1559, 0.0619, 0.0572, 0.0725, 0.0979, 0.3018, 0.0580, 0.1087, 0.0385,
        0.0477])
[rfa agg] iter:  6, prev_obj_val: 86.90640258789062, obj_val: 78.9928970336914, abs dis: 7.913505554199219
[rfa agg] iter: 6, weight: tensor([0.2218, 0.0667, 0.0600, 0.0797, 0.1188, 0.1718, 0.0615, 0.1323, 0.0385,
        0.0490])
[rfa agg] iter:  7, prev_obj_val: 78.9928970336914, obj_val: 75.48210144042969, abs dis: 3.5107955932617188
[rfa agg] iter: 7, weight: tensor([0.4653, 0.0449, 0.0378, 0.0573, 0.1197, 0.0474, 0.0399, 0.1364, 0.0218,
        0.0295])
[rfa agg] iter:  8, prev_obj_val: 75.48210144042969, obj_val: 78.99626922607422, abs dis: 3.5141677856445312
[rfa agg] iter: 8, weight: tensor([0.2452, 0.0538, 0.0434, 0.0720, 0.2005, 0.0400, 0.0466, 0.2422, 0.0234,
        0.0329])
[rfa agg] iter:  9, prev_obj_val: 78.99626922607422, obj_val: 75.47982025146484, abs dis: 3.516448974609375
[rfa agg] iter: 9, weight: tensor([0.4489, 0.0460, 0.0387, 0.0587, 0.1245, 0.0484, 0.0408, 0.1415, 0.0223,
        0.0302])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3402, Accuracy: 87/10000 (0.8700%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.6902, Accuracy: 648/9950 (6.5126%)
saving model
Done in 332.3525688648224 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 360/1446 (24.8963%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0331, Accuracy: 572/1446 (39.5574%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7341, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0633, Accuracy: 234/773 (30.2717%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0279, Accuracy: 448/773 (57.9560%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5503, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 90/515 (17.4757%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0496, Accuracy: 163/515 (31.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2998, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0461, Accuracy: 353/599 (58.9316%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 11.8590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0598, Accuracy: 204/781 (26.1204%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0327, Accuracy: 283/781 (36.2356%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6377, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0573, Accuracy: 265/818 (32.3961%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0269, Accuracy: 419/818 (51.2225%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0881, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0637, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0356, Accuracy: 265/682 (38.8563%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5086, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0508, Accuracy: 332/712 (46.6292%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0228, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4616, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 336/803 (41.8431%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0325, Accuracy: 424/803 (52.8020%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.8999, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0536, Accuracy: 333/1131 (29.4430%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0293, Accuracy: 453/1131 (40.0531%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4108, Accuracy: 92/10000 (0.9200%)
time spent on training: 290.7806603908539
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 99, 33, 95, 3, 71, 80, 11, 58, 87], weight: tensor([0.1751, 0.0936, 0.0623, 0.0725, 0.0946, 0.0990, 0.0826, 0.0862, 0.0972,
        0.1369])
[rfa agg] iter:  0, prev_obj_val: 31.300865173339844, obj_val: 37.69596862792969, abs dis: 6.395103454589844
[rfa agg] iter: 0, weight: tensor([0.0220, 0.1604, 0.0233, 0.0375, 0.1637, 0.1674, 0.0688, 0.1545, 0.1697,
        0.0327])
[rfa agg] iter:  1, prev_obj_val: 37.69596862792969, obj_val: 40.710716247558594, abs dis: 3.0147476196289062
[rfa agg] iter: 1, weight: tensor([0.0256, 0.0798, 0.0529, 0.1126, 0.0807, 0.0836, 0.3118, 0.1356, 0.0832,
        0.0343])
[rfa agg] iter:  2, prev_obj_val: 40.710716247558594, obj_val: 56.04472351074219, abs dis: 15.334007263183594
[rfa agg] iter: 2, weight: tensor([0.0273, 0.0713, 0.0762, 0.1980, 0.0723, 0.0749, 0.2635, 0.1065, 0.0745,
        0.0355])
[rfa agg] iter:  3, prev_obj_val: 56.04472351074219, obj_val: 56.0145263671875, abs dis: 0.0301971435546875
[rfa agg] iter: 3, weight: tensor([0.0401, 0.0687, 0.2855, 0.1541, 0.0695, 0.0726, 0.1088, 0.0812, 0.0715,
        0.0479])
[rfa agg] iter:  4, prev_obj_val: 56.0145263671875, obj_val: 60.415306091308594, abs dis: 4.400779724121094
[rfa agg] iter: 4, weight: tensor([0.0387, 0.0662, 0.3125, 0.1483, 0.0670, 0.0700, 0.1041, 0.0781, 0.0689,
        0.0462])
[rfa agg] iter:  5, prev_obj_val: 60.415306091308594, obj_val: 40.733211517333984, abs dis: 19.68209457397461
[rfa agg] iter: 5, weight: tensor([0.0478, 0.0763, 0.2388, 0.1449, 0.0771, 0.0807, 0.1115, 0.0876, 0.0793,
        0.0561])
[rfa agg] iter:  6, prev_obj_val: 40.733211517333984, obj_val: 51.78608703613281, abs dis: 11.052875518798828
[rfa agg] iter: 6, weight: tensor([0.0279, 0.0728, 0.0798, 0.2112, 0.0737, 0.0767, 0.2377, 0.1080, 0.0759,
        0.0363])
[rfa agg] iter:  7, prev_obj_val: 51.78608703613281, obj_val: 56.01457977294922, abs dis: 4.228492736816406
[rfa agg] iter: 7, weight: tensor([0.0331, 0.0615, 0.3158, 0.1758, 0.0622, 0.0649, 0.1074, 0.0752, 0.0640,
        0.0403])
[rfa agg] iter:  8, prev_obj_val: 56.01457977294922, obj_val: 60.415496826171875, abs dis: 4.400917053222656
[rfa agg] iter: 8, weight: tensor([0.0385, 0.0659, 0.3161, 0.1478, 0.0666, 0.0696, 0.1035, 0.0777, 0.0685,
        0.0459])
[rfa agg] iter:  9, prev_obj_val: 60.415496826171875, obj_val: 40.73324203491211, abs dis: 19.682254791259766
[rfa agg] iter: 9, weight: tensor([0.0478, 0.0763, 0.2389, 0.1449, 0.0771, 0.0806, 0.1114, 0.0876, 0.0793,
        0.0561])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3427, Accuracy: 85/10000 (0.8500%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 4.7146, Accuracy: 487/9950 (4.8945%)
saving model
Done in 386.0072774887085 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0564, Accuracy: 328/1513 (21.6788%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0340, Accuracy: 555/1513 (36.6821%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1065, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0445, Accuracy: 577/1129 (51.1072%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 782/1129 (69.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8605, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0619, Accuracy: 239/773 (30.9185%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 448/773 (57.9560%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.0247, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0650, Accuracy: 170/568 (29.9296%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0375, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.3007, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0737, Accuracy: 78/440 (17.7273%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0439, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.7710, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0581, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0327, Accuracy: 357/946 (37.7378%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6462, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 333/1657 (20.0966%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0328, Accuracy: 567/1657 (34.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1372, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0484, Accuracy: 409/1030 (39.7087%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0248, Accuracy: 658/1030 (63.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6532, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 486/1715 (28.3382%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0284, Accuracy: 831/1715 (48.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1182, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0529, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0278, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6994, Accuracy: 58/10000 (0.5800%)
time spent on training: 321.80504322052
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 37, 99, 62, 49, 43, 0, 91, 92, 52], weight: tensor([0.1454, 0.1085, 0.0743, 0.0546, 0.0423, 0.0909, 0.1592, 0.0990, 0.1648,
        0.0611])
[rfa agg] iter:  0, prev_obj_val: 57.627471923828125, obj_val: 60.903018951416016, abs dis: 3.2755470275878906
[rfa agg] iter: 0, weight: tensor([0.0628, 0.1703, 0.0837, 0.0270, 0.0163, 0.2572, 0.0551, 0.2403, 0.0519,
        0.0352])
[rfa agg] iter:  1, prev_obj_val: 60.903018951416016, obj_val: 67.68563079833984, abs dis: 6.782611846923828
[rfa agg] iter: 1, weight: tensor([0.0495, 0.1070, 0.1077, 0.0279, 0.0163, 0.4281, 0.0444, 0.1396, 0.0422,
        0.0373])
[rfa agg] iter:  2, prev_obj_val: 67.68563079833984, obj_val: 67.63146209716797, abs dis: 0.054168701171875
[rfa agg] iter: 2, weight: tensor([0.0505, 0.0864, 0.3304, 0.0441, 0.0238, 0.2119, 0.0465, 0.0993, 0.0446,
        0.0625])
[rfa agg] iter:  3, prev_obj_val: 67.63146209716797, obj_val: 70.16193389892578, abs dis: 2.5304718017578125
[rfa agg] iter: 3, weight: tensor([0.0478, 0.0818, 0.3705, 0.0418, 0.0225, 0.1959, 0.0441, 0.0939, 0.0423,
        0.0595])
[rfa agg] iter:  4, prev_obj_val: 70.16193389892578, obj_val: 79.04759216308594, abs dis: 8.885658264160156
[rfa agg] iter: 4, weight: tensor([0.0400, 0.0647, 0.4952, 0.0411, 0.0213, 0.1322, 0.0371, 0.0725, 0.0357,
        0.0603])
[rfa agg] iter:  5, prev_obj_val: 79.04759216308594, obj_val: 82.06257629394531, abs dis: 3.014984130859375
[rfa agg] iter: 5, weight: tensor([0.0556, 0.0791, 0.2307, 0.1021, 0.0448, 0.1224, 0.0525, 0.0845, 0.0509,
        0.1774])
[rfa agg] iter:  6, prev_obj_val: 82.06257629394531, obj_val: 79.01356506347656, abs dis: 3.04901123046875
[rfa agg] iter: 6, weight: tensor([0.0526, 0.0724, 0.1690, 0.1255, 0.0496, 0.1058, 0.0500, 0.0767, 0.0485,
        0.2498])
[rfa agg] iter:  7, prev_obj_val: 79.01356506347656, obj_val: 82.06175994873047, abs dis: 3.0481948852539062
[rfa agg] iter: 7, weight: tensor([0.0557, 0.0792, 0.2213, 0.1033, 0.0449, 0.1224, 0.0526, 0.0849, 0.0510,
        0.1848])
[rfa agg] iter:  8, prev_obj_val: 82.06175994873047, obj_val: 76.00029754638672, abs dis: 6.06146240234375
[rfa agg] iter: 8, weight: tensor([0.0526, 0.0724, 0.1688, 0.1255, 0.0496, 0.1058, 0.0500, 0.0766, 0.0485,
        0.2502])
[rfa agg] iter:  9, prev_obj_val: 76.00029754638672, obj_val: 75.9867935180664, abs dis: 0.0135040283203125
[rfa agg] iter: 9, weight: tensor([0.0546, 0.0807, 0.2894, 0.0814, 0.0381, 0.1336, 0.0513, 0.0876, 0.0496,
        0.1337])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3409, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 4.7395, Accuracy: 386/9950 (3.8794%)
saving model
Done in 416.47450137138367 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0529, Accuracy: 341/1131 (30.1503%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0291, Accuracy: 469/1131 (41.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7898, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0615, Accuracy: 191/953 (20.0420%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0358, Accuracy: 336/953 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7362, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0572, Accuracy: 235/938 (25.0533%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0313, Accuracy: 373/938 (39.7655%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5533, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0599, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0294, Accuracy: 498/1190 (41.8487%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2650, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0588, Accuracy: 204/781 (26.1204%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0314, Accuracy: 280/781 (35.8515%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.2311, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0496, Accuracy: 383/1130 (33.8938%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0272, Accuracy: 537/1130 (47.5221%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.1238, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0637, Accuracy: 169/682 (24.7801%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0353, Accuracy: 266/682 (39.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.6367, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0510, Accuracy: 329/712 (46.2079%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0231, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1020, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 310/807 (38.4139%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0302, Accuracy: 415/807 (51.4250%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9476, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0488, Accuracy: 322/888 (36.2613%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0234, Accuracy: 498/888 (56.0811%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.4048, Accuracy: 90/10000 (0.9000%)
time spent on training: 295.86550641059875
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 64, 73, 84, 3, 54, 80, 11, 20, 63], weight: tensor([0.1228, 0.1035, 0.1018, 0.1292, 0.0848, 0.1227, 0.0740, 0.0773, 0.0876,
        0.0964])
[rfa agg] iter:  0, prev_obj_val: 26.11935806274414, obj_val: 35.320045471191406, abs dis: 9.200687408447266
[rfa agg] iter: 0, weight: tensor([0.0394, 0.0796, 0.0782, 0.0345, 0.2482, 0.0392, 0.0579, 0.1086, 0.1826,
        0.1319])
[rfa agg] iter:  1, prev_obj_val: 35.320045471191406, obj_val: 43.34101867675781, abs dis: 8.020973205566406
[rfa agg] iter: 1, weight: tensor([0.0406, 0.0626, 0.0616, 0.0369, 0.1165, 0.0404, 0.2159, 0.2299, 0.1150,
        0.0805])
[rfa agg] iter:  2, prev_obj_val: 43.34101867675781, obj_val: 43.330623626708984, abs dis: 0.010395050048828125
[rfa agg] iter: 2, weight: tensor([0.0471, 0.0656, 0.0645, 0.0436, 0.0956, 0.0470, 0.3187, 0.1425, 0.0972,
        0.0781])
[rfa agg] iter:  3, prev_obj_val: 43.330623626708984, obj_val: 43.330501556396484, abs dis: 0.0001220703125
[rfa agg] iter: 3, weight: tensor([0.0462, 0.0644, 0.0634, 0.0428, 0.0938, 0.0461, 0.3334, 0.1382, 0.0950,
        0.0766])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3442, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 4.7076, Accuracy: 444/9950 (4.4623%)
saving model
Done in 390.58943700790405 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0605, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0306, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.9408, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0565, Accuracy: 276/818 (33.7408%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0267, Accuracy: 423/818 (51.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2143, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0489, Accuracy: 390/1275 (30.5882%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0175, Accuracy: 753/1275 (59.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 11.0157, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0494, Accuracy: 370/1130 (32.7434%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0268, Accuracy: 528/1130 (46.7257%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0994, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0702, Accuracy: 123/500 (24.6000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0441, Accuracy: 236/500 (47.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.3457, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0554, Accuracy: 325/1131 (28.7356%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0274, Accuracy: 540/1131 (47.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5001, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0587, Accuracy: 289/708 (40.8192%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0326, Accuracy: 437/708 (61.7232%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.5470, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0532, Accuracy: 327/1131 (28.9125%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0296, Accuracy: 431/1131 (38.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2513, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0480, Accuracy: 394/1030 (38.2524%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0244, Accuracy: 683/1030 (66.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.9512, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0555, Accuracy: 408/1427 (28.5915%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0314, Accuracy: 649/1427 (45.4800%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1248, Accuracy: 78/10000 (0.7800%)
time spent on training: 300.8573782444
[rfa agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 71, 9, 54, 82, 38, 16, 87, 91, 34], weight: tensor([0.0896, 0.0814, 0.1269, 0.1124, 0.0497, 0.1125, 0.0704, 0.1125, 0.1025,
        0.1420])
[rfa agg] iter:  0, prev_obj_val: 32.405296325683594, obj_val: 36.749019622802734, abs dis: 4.343723297119141
[rfa agg] iter: 0, weight: tensor([0.2517, 0.0809, 0.0709, 0.1096, 0.0169, 0.1104, 0.0506, 0.1115, 0.1495,
        0.0481])
[rfa agg] iter:  1, prev_obj_val: 36.749019622802734, obj_val: 39.30434036254883, abs dis: 2.5553207397460938
[rfa agg] iter: 1, weight: tensor([0.2997, 0.1364, 0.0620, 0.0850, 0.0208, 0.0855, 0.0742, 0.0859, 0.1054,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 39.30434036254883, obj_val: 44.82129669189453, abs dis: 5.516956329345703
[rfa agg] iter: 2, weight: tensor([0.2262, 0.2044, 0.0614, 0.0807, 0.0242, 0.0810, 0.0987, 0.0814, 0.0959,
        0.0460])
[rfa agg] iter:  3, prev_obj_val: 44.82129669189453, obj_val: 44.770729064941406, abs dis: 0.050567626953125
[rfa agg] iter: 3, weight: tensor([0.1101, 0.3884, 0.0465, 0.0574, 0.0256, 0.0575, 0.1557, 0.0577, 0.0646,
        0.0366])
[rfa agg] iter:  4, prev_obj_val: 44.770729064941406, obj_val: 59.21462631225586, abs dis: 14.443897247314453
[rfa agg] iter: 4, weight: tensor([0.0964, 0.4568, 0.0414, 0.0511, 0.0228, 0.0513, 0.1388, 0.0514, 0.0574,
        0.0326])
[rfa agg] iter:  5, prev_obj_val: 59.21462631225586, obj_val: 47.999061584472656, abs dis: 11.215564727783203
[rfa agg] iter: 5, weight: tensor([0.0962, 0.1752, 0.0614, 0.0698, 0.0716, 0.0699, 0.2605, 0.0700, 0.0738,
        0.0516])
[rfa agg] iter:  6, prev_obj_val: 47.999061584472656, obj_val: 59.1815185546875, abs dis: 11.182456970214844
[rfa agg] iter: 6, weight: tensor([0.0937, 0.2969, 0.0457, 0.0550, 0.0300, 0.0552, 0.2709, 0.0553, 0.0607,
        0.0367])
[rfa agg] iter:  7, prev_obj_val: 59.1815185546875, obj_val: 47.999603271484375, abs dis: 11.181915283203125
[rfa agg] iter: 7, weight: tensor([0.0953, 0.1710, 0.0607, 0.0690, 0.0709, 0.0691, 0.2708, 0.0692, 0.0730,
        0.0510])
[rfa agg] iter:  8, prev_obj_val: 47.999603271484375, obj_val: 59.18136978149414, abs dis: 11.181766510009766
[rfa agg] iter: 8, weight: tensor([0.0937, 0.2954, 0.0457, 0.0550, 0.0299, 0.0551, 0.2727, 0.0552, 0.0606,
        0.0366])
[rfa agg] iter:  9, prev_obj_val: 59.18136978149414, obj_val: 47.999610900878906, abs dis: 11.181758880615234
[rfa agg] iter: 9, weight: tensor([0.0953, 0.1710, 0.0606, 0.0690, 0.0709, 0.0691, 0.2710, 0.0692, 0.0729,
        0.0510])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3450, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 4.7428, Accuracy: 291/9950 (2.9246%)
saving model
Done in 402.9729301929474 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0480, Accuracy: 708/2227 (31.7916%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0267, Accuracy: 1068/2227 (47.9569%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0210, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0567, Accuracy: 299/708 (42.2316%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0337, Accuracy: 440/708 (62.1469%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6416, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0759, Accuracy: 66/373 (17.6944%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0444, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.1074, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0660, Accuracy: 162/486 (33.3333%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0384, Accuracy: 218/486 (44.8560%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4227, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0730, Accuracy: 84/440 (19.0909%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0439, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.7541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0713, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0440, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8039, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0515, Accuracy: 501/1418 (35.3315%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 701/1418 (49.4358%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4441, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0536, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0260, Accuracy: 544/1089 (49.9541%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.9625, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 433/1742 (24.8565%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0297, Accuracy: 780/1742 (44.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5122, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0567, Accuracy: 411/1587 (25.8979%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0320, Accuracy: 635/1587 (40.0126%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8775, Accuracy: 64/10000 (0.6400%)
time spent on training: 304.9419400691986
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 16, 98, 30, 49, 88, 70, 59, 93, 27], weight: tensor([0.2087, 0.0663, 0.0349, 0.0455, 0.0412, 0.0565, 0.1329, 0.1020, 0.1632,
        0.1487])
[rfa agg] iter:  0, prev_obj_val: 74.7886734008789, obj_val: 76.11547088623047, abs dis: 1.3267974853515625
[rfa agg] iter: 0, weight: tensor([0.0801, 0.0434, 0.0134, 0.0203, 0.0170, 0.0300, 0.2803, 0.2139, 0.1205,
        0.1811])
[rfa agg] iter:  1, prev_obj_val: 76.11547088623047, obj_val: 76.11225891113281, abs dis: 0.00321197509765625
[rfa agg] iter: 1, weight: tensor([0.0784, 0.0466, 0.0141, 0.0214, 0.0179, 0.0319, 0.2429, 0.2668, 0.1145,
        0.1655])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3389, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 4.7352, Accuracy: 386/9950 (3.8794%)
saving model
Done in 402.30253648757935 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0557, Accuracy: 357/1657 (21.5450%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 570/1657 (34.3995%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4920, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0481, Accuracy: 341/888 (38.4009%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0230, Accuracy: 514/888 (57.8829%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.1194, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1084, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3597, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0569, Accuracy: 301/776 (38.7887%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0252, Accuracy: 467/776 (60.1804%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3404, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0500, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0260, Accuracy: 601/1213 (49.5466%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.7227, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0916, Accuracy: 11/271 (4.0590%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0568, Accuracy: 152/271 (56.0886%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.3758, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0546, Accuracy: 307/690 (44.4928%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0236, Accuracy: 469/690 (67.9710%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.1429, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0703, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6446, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0694, Accuracy: 161/530 (30.3774%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0347, Accuracy: 297/530 (56.0377%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7163, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0502, Accuracy: 429/1030 (41.6505%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0229, Accuracy: 688/1030 (66.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.9976, Accuracy: 107/10000 (1.0700%)
time spent on training: 236.43837714195251
[rfa agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 63, 47, 75, 97, 35, 25, 88, 18, 91], weight: tensor([0.2127, 0.1140, 0.0172, 0.0996, 0.1557, 0.0348, 0.0886, 0.0774, 0.0680,
        0.1322])
[rfa agg] iter:  0, prev_obj_val: 48.131656646728516, obj_val: 53.422645568847656, abs dis: 5.290988922119141
[rfa agg] iter: 0, weight: tensor([0.0429, 0.4154, 0.0038, 0.2016, 0.0750, 0.0094, 0.0704, 0.0464, 0.0329,
        0.1022])
[rfa agg] iter:  1, prev_obj_val: 53.422645568847656, obj_val: 55.287933349609375, abs dis: 1.8652877807617188
[rfa agg] iter: 1, weight: tensor([0.0435, 0.1598, 0.0055, 0.2442, 0.0635, 0.0142, 0.2247, 0.1061, 0.0641,
        0.0744])
[rfa agg] iter:  2, prev_obj_val: 55.287933349609375, obj_val: 57.36278533935547, abs dis: 2.0748519897460938
[rfa agg] iter: 2, weight: tensor([0.0381, 0.1155, 0.0053, 0.1634, 0.0538, 0.0139, 0.3522, 0.1267, 0.0695,
        0.0616])
[rfa agg] iter:  3, prev_obj_val: 57.36278533935547, obj_val: 59.92335891723633, abs dis: 2.5605735778808594
[rfa agg] iter: 3, weight: tensor([0.0280, 0.0737, 0.0043, 0.0948, 0.0384, 0.0115, 0.5046, 0.1363, 0.0654,
        0.0430])
[rfa agg] iter:  4, prev_obj_val: 59.92335891723633, obj_val: 65.9714126586914, abs dis: 6.048053741455078
[rfa agg] iter: 4, weight: tensor([0.0312, 0.0731, 0.0052, 0.0881, 0.0416, 0.0144, 0.3575, 0.2451, 0.0980,
        0.0458])
[rfa agg] iter:  5, prev_obj_val: 65.9714126586914, obj_val: 69.41275787353516, abs dis: 3.44134521484375
[rfa agg] iter: 5, weight: tensor([0.0336, 0.0654, 0.0069, 0.0731, 0.0426, 0.0201, 0.1501, 0.3025, 0.2601,
        0.0456])
[rfa agg] iter:  6, prev_obj_val: 69.41275787353516, obj_val: 69.38372802734375, abs dis: 0.02902984619140625
[rfa agg] iter: 6, weight: tensor([0.0310, 0.0562, 0.0071, 0.0611, 0.0386, 0.0215, 0.1073, 0.1790, 0.4574,
        0.0407])
[rfa agg] iter:  7, prev_obj_val: 69.38372802734375, obj_val: 69.37834930419922, abs dis: 0.00537872314453125
[rfa agg] iter: 7, weight: tensor([0.0266, 0.0482, 0.0061, 0.0523, 0.0331, 0.0185, 0.0916, 0.1494, 0.5394,
        0.0349])
[rfa agg] iter:  8, prev_obj_val: 69.37834930419922, obj_val: 69.37682342529297, abs dis: 0.00152587890625
[rfa agg] iter: 8, weight: tensor([0.0243, 0.0440, 0.0056, 0.0478, 0.0302, 0.0169, 0.0834, 0.1353, 0.5806,
        0.0319])
[rfa agg] iter:  9, prev_obj_val: 69.37682342529297, obj_val: 69.3763198852539, abs dis: 0.0005035400390625
[rfa agg] iter: 9, weight: tensor([0.0230, 0.0417, 0.0053, 0.0452, 0.0286, 0.0160, 0.0789, 0.1275, 0.6036,
        0.0302])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3371, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 4.7518, Accuracy: 363/9950 (3.6482%)
saving model
Done in 337.8333966732025 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0507, Accuracy: 327/590 (55.4237%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.6802, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0764, Accuracy: 92/515 (17.8641%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0478, Accuracy: 192/515 (37.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6908, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0584, Accuracy: 242/1013 (23.8894%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0319, Accuracy: 426/1013 (42.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4518, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0471, Accuracy: 367/599 (61.2688%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.8970, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 443/1662 (26.6546%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0309, Accuracy: 671/1662 (40.3730%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2005, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.0788, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 171/312 (54.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.1459, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0524, Accuracy: 294/636 (46.2264%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0275, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8074, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0569, Accuracy: 439/1988 (22.0825%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 735/1988 (36.9718%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9942, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0632, Accuracy: 192/530 (36.2264%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0329, Accuracy: 299/530 (56.4151%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9509, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0530, Accuracy: 345/1049 (32.8885%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0261, Accuracy: 546/1049 (52.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4356, Accuracy: 119/10000 (1.1900%)
time spent on training: 280.5914497375488
[rfa agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 33, 14, 95, 94, 24, 52, 85, 18, 51], weight: tensor([0.0663, 0.0579, 0.1139, 0.0673, 0.1869, 0.0351, 0.0715, 0.2235, 0.0596,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 72.82381439208984, obj_val: 75.92807006835938, abs dis: 3.1042556762695312
[rfa agg] iter: 0, weight: tensor([0.0338, 0.0261, 0.2637, 0.0343, 0.0840, 0.0108, 0.0364, 0.0590, 0.0269,
        0.4249])
[rfa agg] iter:  1, prev_obj_val: 75.92807006835938, obj_val: 79.63536834716797, abs dis: 3.7072982788085938
[rfa agg] iter: 1, weight: tensor([0.0681, 0.0488, 0.3228, 0.0692, 0.0759, 0.0173, 0.0734, 0.0597, 0.0505,
        0.2144])
[rfa agg] iter:  2, prev_obj_val: 79.63536834716797, obj_val: 80.89803314208984, abs dis: 1.262664794921875
[rfa agg] iter: 2, weight: tensor([0.1123, 0.0740, 0.1939, 0.1143, 0.0744, 0.0227, 0.1209, 0.0609, 0.0767,
        0.1497])
[rfa agg] iter:  3, prev_obj_val: 80.89803314208984, obj_val: 83.49234771728516, abs dis: 2.5943145751953125
[rfa agg] iter: 3, weight: tensor([0.1290, 0.0809, 0.1597, 0.1311, 0.0687, 0.0232, 0.1384, 0.0569, 0.0840,
        0.1280])
[rfa agg] iter:  4, prev_obj_val: 83.49234771728516, obj_val: 88.13129425048828, abs dis: 4.638946533203125
[rfa agg] iter: 4, weight: tensor([0.1671, 0.0898, 0.1004, 0.1697, 0.0515, 0.0216, 0.1778, 0.0436, 0.0939,
        0.0847])
[rfa agg] iter:  5, prev_obj_val: 88.13129425048828, obj_val: 97.8140869140625, abs dis: 9.682792663574219
[rfa agg] iter: 5, weight: tensor([0.2418, 0.0857, 0.0331, 0.2377, 0.0205, 0.0123, 0.2261, 0.0178, 0.0958,
        0.0293])
[rfa agg] iter:  6, prev_obj_val: 97.8140869140625, obj_val: 97.77596282958984, abs dis: 0.03812408447265625
[rfa agg] iter: 6, weight: tensor([0.1223, 0.2025, 0.0435, 0.1232, 0.0307, 0.0287, 0.1292, 0.0273, 0.2530,
        0.0396])
[rfa agg] iter:  7, prev_obj_val: 97.77596282958984, obj_val: 97.77580261230469, abs dis: 0.00016021728515625
[rfa agg] iter: 7, weight: tensor([0.1167, 0.2137, 0.0421, 0.1180, 0.0297, 0.0278, 0.1233, 0.0264, 0.2642,
        0.0383])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3394, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 4.7787, Accuracy: 273/9950 (2.7437%)
saving model
Done in 389.36820125579834 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0574, Accuracy: 340/896 (37.9464%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0314, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3419, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0539, Accuracy: 428/1904 (22.4790%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0288, Accuracy: 808/1904 (42.4370%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1689, Accuracy: 148/10000 (1.4800%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0571, Accuracy: 219/809 (27.0705%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0238, Accuracy: 420/809 (51.9159%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.3954, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0549, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0207, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.2940, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0608, Accuracy: 340/1003 (33.8983%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0326, Accuracy: 400/1003 (39.8804%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7724, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0817, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0439, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6930, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0570, Accuracy: 222/938 (23.6674%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0314, Accuracy: 373/938 (39.7655%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.7425, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 743/2227 (33.3633%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0266, Accuracy: 1072/2227 (48.1365%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3991, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0829, Accuracy: 4/311 (1.2862%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.0968, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0583, Accuracy: 288/776 (37.1134%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0252, Accuracy: 446/776 (57.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.7230, Accuracy: 105/10000 (1.0500%)
time spent on training: 334.0035321712494
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 46, 50, 90, 86, 76, 73, 60, 96, 75], weight: tensor([0.0895, 0.1903, 0.0808, 0.0677, 0.1002, 0.0466, 0.0937, 0.2225, 0.0311,
        0.0775])
[rfa agg] iter:  0, prev_obj_val: 82.79121398925781, obj_val: 78.7798843383789, abs dis: 4.011329650878906
[rfa agg] iter: 0, weight: tensor([0.1218, 0.1187, 0.0921, 0.0580, 0.2225, 0.0291, 0.1587, 0.0955, 0.0153,
        0.0884])
[rfa agg] iter:  1, prev_obj_val: 78.7798843383789, obj_val: 81.15430450439453, abs dis: 2.374420166015625
[rfa agg] iter: 1, weight: tensor([0.1108, 0.0356, 0.0691, 0.0353, 0.4193, 0.0152, 0.2102, 0.0307, 0.0074,
        0.0665])
[rfa agg] iter:  2, prev_obj_val: 81.15430450439453, obj_val: 90.36919403076172, abs dis: 9.214889526367188
[rfa agg] iter: 2, weight: tensor([0.2721, 0.0273, 0.1514, 0.0510, 0.1124, 0.0178, 0.1856, 0.0244, 0.0079,
        0.1501])
[rfa agg] iter:  3, prev_obj_val: 90.36919403076172, obj_val: 93.46182250976562, abs dis: 3.0926284790039062
[rfa agg] iter: 3, weight: tensor([0.1306, 0.0320, 0.2059, 0.1789, 0.0749, 0.0350, 0.0932, 0.0293, 0.0135,
        0.2068])
[rfa agg] iter:  4, prev_obj_val: 93.46182250976562, obj_val: 90.33930969238281, abs dis: 3.1225128173828125
[rfa agg] iter: 4, weight: tensor([0.1084, 0.0323, 0.1584, 0.3088, 0.0691, 0.0413, 0.0828, 0.0297, 0.0150,
        0.1542])
[rfa agg] iter:  5, prev_obj_val: 90.33930969238281, obj_val: 90.33030700683594, abs dis: 0.009002685546875
[rfa agg] iter: 5, weight: tensor([0.1260, 0.0316, 0.2077, 0.1881, 0.0738, 0.0345, 0.0913, 0.0289, 0.0132,
        0.2048])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3372, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.7372, Accuracy: 442/9950 (4.4422%)
saving model
Done in 437.1866114139557 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0572, Accuracy: 364/1089 (33.4252%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0265, Accuracy: 572/1089 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.8442, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0483, Accuracy: 450/1030 (43.6893%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0221, Accuracy: 691/1030 (67.0874%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.8087, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0619, Accuracy: 215/530 (40.5660%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0354, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5360, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0589, Accuracy: 314/715 (43.9161%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0349, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.3367, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0734, Accuracy: 75/440 (17.0455%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0438, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.8182, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0464, Accuracy: 363/599 (60.6010%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 11.3543, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0476, Accuracy: 747/2227 (33.5429%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0265, Accuracy: 1102/2227 (49.4836%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6258, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0569, Accuracy: 348/896 (38.8393%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0314, Accuracy: 476/896 (53.1250%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2648, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0480, Accuracy: 298/813 (36.6544%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 480/813 (59.0406%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.5833, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0575, Accuracy: 259/1013 (25.5676%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0316, Accuracy: 447/1013 (44.1264%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6168, Accuracy: 113/10000 (1.1300%)
time spent on training: 311.1787283420563
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 91, 18, 23, 49, 95, 60, 89, 53, 14], weight: tensor([0.1164, 0.1101, 0.0567, 0.0765, 0.0470, 0.0641, 0.2381, 0.0958, 0.0869,
        0.1083])
[rfa agg] iter:  0, prev_obj_val: 62.99698257446289, obj_val: 65.08094024658203, abs dis: 2.0839576721191406
[rfa agg] iter: 0, weight: tensor([0.1470, 0.2458, 0.0184, 0.0410, 0.0121, 0.0240, 0.0314, 0.0900, 0.0596,
        0.3307])
[rfa agg] iter:  1, prev_obj_val: 65.08094024658203, obj_val: 72.40115356445312, abs dis: 7.320213317871094
[rfa agg] iter: 1, weight: tensor([0.0697, 0.0882, 0.0282, 0.0890, 0.0168, 0.0395, 0.0283, 0.3310, 0.1787,
        0.1306])
[rfa agg] iter:  2, prev_obj_val: 72.40115356445312, obj_val: 77.89263916015625, abs dis: 5.491485595703125
[rfa agg] iter: 2, weight: tensor([0.0527, 0.0599, 0.0517, 0.2849, 0.0260, 0.0852, 0.0287, 0.1288, 0.2078,
        0.0742])
[rfa agg] iter:  3, prev_obj_val: 77.89263916015625, obj_val: 80.83514404296875, abs dis: 2.9425048828125
[rfa agg] iter: 3, weight: tensor([0.0545, 0.0604, 0.0922, 0.2210, 0.0390, 0.1849, 0.0330, 0.1039, 0.1395,
        0.0716])
[rfa agg] iter:  4, prev_obj_val: 80.83514404296875, obj_val: 83.90611267089844, abs dis: 3.0709686279296875
[rfa agg] iter: 4, weight: tensor([0.0494, 0.0541, 0.1179, 0.1520, 0.0431, 0.2924, 0.0314, 0.0869, 0.1094,
        0.0632])
[rfa agg] iter:  5, prev_obj_val: 83.90611267089844, obj_val: 87.28690338134766, abs dis: 3.3807907104492188
[rfa agg] iter: 5, weight: tensor([0.0393, 0.0426, 0.1445, 0.0989, 0.0425, 0.4147, 0.0260, 0.0646, 0.0778,
        0.0491])
[rfa agg] iter:  6, prev_obj_val: 87.28690338134766, obj_val: 90.8726577758789, abs dis: 3.58575439453125
[rfa agg] iter: 6, weight: tensor([0.0395, 0.0425, 0.2604, 0.0856, 0.0544, 0.3090, 0.0273, 0.0615, 0.0714,
        0.0484])
[rfa agg] iter:  7, prev_obj_val: 90.8726577758789, obj_val: 90.84559631347656, abs dis: 0.02706146240234375
[rfa agg] iter: 7, weight: tensor([0.0345, 0.0368, 0.4636, 0.0667, 0.0624, 0.1605, 0.0247, 0.0512, 0.0579,
        0.0415])
[rfa agg] iter:  8, prev_obj_val: 90.84559631347656, obj_val: 90.84071350097656, abs dis: 0.0048828125
[rfa agg] iter: 8, weight: tensor([0.0289, 0.0308, 0.5555, 0.0559, 0.0523, 0.1301, 0.0206, 0.0428, 0.0484,
        0.0348])
[rfa agg] iter:  9, prev_obj_val: 90.84071350097656, obj_val: 98.7884521484375, abs dis: 7.9477386474609375
[rfa agg] iter: 9, weight: tensor([0.0259, 0.0277, 0.6023, 0.0501, 0.0469, 0.1156, 0.0185, 0.0384, 0.0435,
        0.0312])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3414, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 4.7523, Accuracy: 202/9950 (2.0302%)
saving model
Done in 414.1200678348541 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 316/803 (39.3524%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 381/803 (47.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.5166, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0706, Accuracy: 110/500 (22.0000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0439, Accuracy: 236/500 (47.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4229, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.0827, Accuracy: 43/408 (10.5392%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0468, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2578, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1075, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0873, Accuracy: 45/197 (22.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.4486, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 711/2227 (31.9264%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0265, Accuracy: 1102/2227 (49.4836%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2205, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0551, Accuracy: 294/807 (36.4312%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0301, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8540, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0530, Accuracy: 413/1904 (21.6912%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0290, Accuracy: 780/1904 (40.9664%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4158, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0619, Accuracy: 175/682 (25.6598%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0349, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.0939, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.0863, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 166/338 (49.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.0374, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0662, Accuracy: 147/486 (30.2469%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0359, Accuracy: 221/486 (45.4733%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3945, Accuracy: 65/10000 (0.6500%)
time spent on training: 316.56747126579285
[rfa agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 82, 36, 79, 60, 20, 46, 80, 12, 30], weight: tensor([0.0961, 0.0599, 0.0489, 0.0236, 0.2666, 0.0966, 0.2280, 0.0817, 0.0405,
        0.0582])
[rfa agg] iter:  0, prev_obj_val: 101.6610107421875, obj_val: 101.45133209228516, abs dis: 0.20967864990234375
[rfa agg] iter: 0, weight: tensor([0.1806, 0.0566, 0.0420, 0.0159, 0.1482, 0.1805, 0.1793, 0.1099, 0.0319,
        0.0550])
[rfa agg] iter:  1, prev_obj_val: 101.45133209228516, obj_val: 103.2426986694336, abs dis: 1.7913665771484375
[rfa agg] iter: 1, weight: tensor([0.2730, 0.0501, 0.0358, 0.0126, 0.0782, 0.2677, 0.0891, 0.1186, 0.0264,
        0.0487])
[rfa agg] iter:  2, prev_obj_val: 103.2426986694336, obj_val: 106.4881820678711, abs dis: 3.2454833984375
[rfa agg] iter: 2, weight: tensor([0.3681, 0.0345, 0.0231, 0.0072, 0.0309, 0.3205, 0.0339, 0.1321, 0.0162,
        0.0335])
[rfa agg] iter:  3, prev_obj_val: 106.4881820678711, obj_val: 110.4492416381836, abs dis: 3.9610595703125
[rfa agg] iter: 3, weight: tensor([0.2029, 0.0557, 0.0356, 0.0103, 0.0373, 0.1985, 0.0405, 0.3407, 0.0242,
        0.0543])
[rfa agg] iter:  4, prev_obj_val: 110.4492416381836, obj_val: 110.4378890991211, abs dis: 0.0113525390625
[rfa agg] iter: 4, weight: tensor([0.1282, 0.0801, 0.0472, 0.0123, 0.0370, 0.1271, 0.0397, 0.4197, 0.0305,
        0.0782])
[rfa agg] iter:  5, prev_obj_val: 110.4378890991211, obj_val: 110.43769836425781, abs dis: 0.00019073486328125
[rfa agg] iter: 5, weight: tensor([0.1240, 0.0779, 0.0458, 0.0120, 0.0359, 0.1226, 0.0386, 0.4375, 0.0296,
        0.0760])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3428, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 4.7655, Accuracy: 204/9950 (2.0503%)
saving model
Done in 424.8179359436035 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0545, Accuracy: 319/1372 (23.2507%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0297, Accuracy: 574/1372 (41.8367%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.5209, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0620, Accuracy: 177/953 (18.5729%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0360, Accuracy: 338/953 (35.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8285, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0541, Accuracy: 242/735 (32.9252%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0201, Accuracy: 411/735 (55.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.5425, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0525, Accuracy: 336/928 (36.2069%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0208, Accuracy: 649/928 (69.9353%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.4254, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0925, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0568, Accuracy: 138/271 (50.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.4049, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0862, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0693, Accuracy: 54/186 (29.0323%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.4077, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0568, Accuracy: 424/1750 (24.2286%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0335, Accuracy: 740/1750 (42.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7187, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 563/1552 (36.2758%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0195, Accuracy: 829/1552 (53.4149%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.3802, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 452/1742 (25.9472%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0300, Accuracy: 759/1742 (43.5706%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6593, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0803, Accuracy: 72/416 (17.3077%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0424, Accuracy: 231/416 (55.5288%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1835, Accuracy: 84/10000 (0.8400%)
time spent on training: 326.9238660335541
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 64, 32, 1, 35, 56, 44, 74, 93, 78], weight: tensor([0.1385, 0.0962, 0.0742, 0.0937, 0.0274, 0.0188, 0.1767, 0.1567, 0.1759,
        0.0420])
[rfa agg] iter:  0, prev_obj_val: 65.7181396484375, obj_val: 67.0345458984375, abs dis: 1.31640625
[rfa agg] iter: 0, weight: tensor([0.1978, 0.1815, 0.0715, 0.1739, 0.0122, 0.0073, 0.1025, 0.1293, 0.1019,
        0.0222])
[rfa agg] iter:  1, prev_obj_val: 67.0345458984375, obj_val: 68.38033294677734, abs dis: 1.3457870483398438
[rfa agg] iter: 1, weight: tensor([0.1706, 0.2089, 0.0753, 0.1992, 0.0123, 0.0073, 0.0941, 0.1164, 0.0935,
        0.0224])
[rfa agg] iter:  2, prev_obj_val: 68.38033294677734, obj_val: 69.74880981445312, abs dis: 1.3684768676757812
[rfa agg] iter: 2, weight: tensor([0.1438, 0.2405, 0.0774, 0.2276, 0.0120, 0.0070, 0.0840, 0.1021, 0.0835,
        0.0220])
[rfa agg] iter:  3, prev_obj_val: 69.74880981445312, obj_val: 69.74638366699219, abs dis: 0.0024261474609375
[rfa agg] iter: 3, weight: tensor([0.1172, 0.2783, 0.0768, 0.2597, 0.0112, 0.0065, 0.0720, 0.0861, 0.0715,
        0.0207])
[rfa agg] iter:  4, prev_obj_val: 69.74638366699219, obj_val: 71.162353515625, abs dis: 1.4159698486328125
[rfa agg] iter: 4, weight: tensor([0.1167, 0.2786, 0.0766, 0.2609, 0.0111, 0.0065, 0.0718, 0.0858, 0.0713,
        0.0207])
[rfa agg] iter:  5, prev_obj_val: 71.162353515625, obj_val: 74.5667495727539, abs dis: 3.4043960571289062
[rfa agg] iter: 5, weight: tensor([0.0903, 0.3249, 0.0725, 0.2945, 0.0098, 0.0057, 0.0580, 0.0683, 0.0576,
        0.0184])
[rfa agg] iter:  6, prev_obj_val: 74.5667495727539, obj_val: 79.82709503173828, abs dis: 5.260345458984375
[rfa agg] iter: 6, weight: tensor([0.0508, 0.4225, 0.0627, 0.3292, 0.0071, 0.0040, 0.0350, 0.0403, 0.0348,
        0.0135])
[rfa agg] iter:  7, prev_obj_val: 79.82709503173828, obj_val: 79.81875610351562, abs dis: 0.00833892822265625
[rfa agg] iter: 7, weight: tensor([0.0654, 0.3214, 0.1350, 0.2880, 0.0115, 0.0065, 0.0479, 0.0539, 0.0476,
        0.0227])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3402, Accuracy: 90/10000 (0.9000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.5479, Accuracy: 1011/9950 (10.1608%)
saving model
Done in 428.5784385204315 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0480, Accuracy: 407/1213 (33.5532%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0258, Accuracy: 596/1213 (49.1344%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9480, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0553, Accuracy: 290/690 (42.0290%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0227, Accuracy: 476/690 (68.9855%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9259, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0464, Accuracy: 346/813 (42.5584%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 498/813 (61.2546%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 12.8210, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0471, Accuracy: 758/2227 (34.0368%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0265, Accuracy: 1083/2227 (48.6304%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9655, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0522, Accuracy: 335/1071 (31.2792%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0273, Accuracy: 573/1071 (53.5014%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.0985, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 380/1581 (24.0354%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1581 (41.5560%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8818, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0441, Accuracy: 572/1129 (50.6643%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0206, Accuracy: 792/1129 (70.1506%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.7326, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0568, Accuracy: 446/1750 (25.4857%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0331, Accuracy: 757/1750 (43.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7964, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0490, Accuracy: 400/928 (43.1034%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0202, Accuracy: 643/928 (69.2888%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.0908, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0583, Accuracy: 243/1013 (23.9882%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0316, Accuracy: 424/1013 (41.8559%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2400, Accuracy: 103/10000 (1.0300%)
time spent on training: 366.5338833332062
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 25, 53, 60, 55, 28, 37, 44, 1, 14], weight: tensor([0.0977, 0.0556, 0.0655, 0.1794, 0.0863, 0.1273, 0.0909, 0.1410, 0.0747,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 59.99930953979492, obj_val: 65.04788970947266, abs dis: 5.048580169677734
[rfa agg] iter: 0, weight: tensor([0.3780, 0.0214, 0.0328, 0.0378, 0.1074, 0.0749, 0.1653, 0.0541, 0.0535,
        0.0750])
[rfa agg] iter:  1, prev_obj_val: 65.04788970947266, obj_val: 75.51212310791016, abs dis: 10.4642333984375
[rfa agg] iter: 1, weight: tensor([0.0993, 0.0260, 0.0474, 0.0250, 0.2340, 0.0385, 0.1326, 0.0316, 0.1108,
        0.2547])
[rfa agg] iter:  2, prev_obj_val: 75.51212310791016, obj_val: 75.46200561523438, abs dis: 0.05011749267578125
[rfa agg] iter: 2, weight: tensor([0.0732, 0.0532, 0.1337, 0.0298, 0.1134, 0.0412, 0.0853, 0.0355, 0.2601,
        0.1746])
[rfa agg] iter:  3, prev_obj_val: 75.46200561523438, obj_val: 78.74446105957031, abs dis: 3.2824554443359375
[rfa agg] iter: 3, weight: tensor([0.0707, 0.0515, 0.1306, 0.0288, 0.1083, 0.0398, 0.0824, 0.0343, 0.2876,
        0.1659])
[rfa agg] iter:  4, prev_obj_val: 78.74446105957031, obj_val: 75.46842956542969, abs dis: 3.276031494140625
[rfa agg] iter: 4, weight: tensor([0.0712, 0.0667, 0.1968, 0.0313, 0.1021, 0.0424, 0.0811, 0.0369, 0.2284,
        0.1431])
[rfa agg] iter:  5, prev_obj_val: 75.46842956542969, obj_val: 75.46104431152344, abs dis: 0.00738525390625
[rfa agg] iter: 5, weight: tensor([0.0713, 0.0520, 0.1334, 0.0290, 0.1091, 0.0401, 0.0830, 0.0346, 0.2807,
        0.1667])
[rfa agg] iter:  6, prev_obj_val: 75.46104431152344, obj_val: 78.7450180053711, abs dis: 3.2839736938476562
[rfa agg] iter: 6, weight: tensor([0.0704, 0.0513, 0.1298, 0.0287, 0.1077, 0.0396, 0.0820, 0.0342, 0.2916,
        0.1647])
[rfa agg] iter:  7, prev_obj_val: 78.7450180053711, obj_val: 75.46836853027344, abs dis: 3.2766494750976562
[rfa agg] iter: 7, weight: tensor([0.0711, 0.0667, 0.1966, 0.0313, 0.1021, 0.0424, 0.0811, 0.0369, 0.2287,
        0.1430])
[rfa agg] iter:  8, prev_obj_val: 75.46836853027344, obj_val: 75.46104431152344, abs dis: 0.00732421875
[rfa agg] iter: 8, weight: tensor([0.0713, 0.0520, 0.1334, 0.0290, 0.1091, 0.0401, 0.0830, 0.0346, 0.2808,
        0.1667])
[rfa agg] iter:  9, prev_obj_val: 75.46104431152344, obj_val: 78.74502563476562, abs dis: 3.2839813232421875
[rfa agg] iter: 9, weight: tensor([0.0704, 0.0513, 0.1297, 0.0286, 0.1077, 0.0396, 0.0820, 0.0342, 0.2917,
        0.1647])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3366, Accuracy: 106/10000 (1.0600%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 4.5736, Accuracy: 839/9950 (8.4322%)
saving model
Done in 471.59541034698486 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0705, Accuracy: 105/500 (21.0000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0443, Accuracy: 230/500 (46.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6066, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0687, Accuracy: 190/605 (31.4050%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0374, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2568, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0590, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0294, Accuracy: 494/1190 (41.5126%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4313, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0580, Accuracy: 251/530 (47.3585%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0329, Accuracy: 301/530 (56.7925%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0605, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0444, Accuracy: 364/599 (60.7679%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 11.7031, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0514, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.1193, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0536, Accuracy: 326/1131 (28.8240%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0297, Accuracy: 410/1131 (36.2511%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3287, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0799, Accuracy: 68/416 (16.3462%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0427, Accuracy: 233/416 (56.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3030, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 550/1470 (37.4150%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0224, Accuracy: 921/1470 (62.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.1142, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0238, Accuracy: 549/1154 (47.5737%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.9236, Accuracy: 80/10000 (0.8000%)
time spent on training: 302.41330313682556
[rfa agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 2, 84, 18, 95, 7, 87, 78, 22, 57], weight: tensor([0.0589, 0.0713, 0.1402, 0.0625, 0.0706, 0.1050, 0.1333, 0.0490, 0.1732,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 49.102638244628906, obj_val: 52.33926773071289, abs dis: 3.2366294860839844
[rfa agg] iter: 0, weight: tensor([0.0459, 0.0911, 0.0905, 0.0604, 0.0904, 0.3322, 0.1030, 0.0318, 0.0674,
        0.0874])
[rfa agg] iter:  1, prev_obj_val: 52.33926773071289, obj_val: 57.493202209472656, abs dis: 5.153934478759766
[rfa agg] iter: 1, weight: tensor([0.0608, 0.1428, 0.0825, 0.0850, 0.1415, 0.2108, 0.0914, 0.0405, 0.0650,
        0.0797])
[rfa agg] iter:  2, prev_obj_val: 57.493202209472656, obj_val: 68.4947509765625, abs dis: 11.001548767089844
[rfa agg] iter: 2, weight: tensor([0.0622, 0.2718, 0.0438, 0.1057, 0.2743, 0.0789, 0.0472, 0.0370, 0.0368,
        0.0424])
[rfa agg] iter:  3, prev_obj_val: 68.4947509765625, obj_val: 68.4581069946289, abs dis: 0.03664398193359375
[rfa agg] iter: 3, weight: tensor([0.2497, 0.1207, 0.0351, 0.2403, 0.1200, 0.0499, 0.0368, 0.0821, 0.0314,
        0.0340])
[rfa agg] iter:  4, prev_obj_val: 68.4581069946289, obj_val: 65.12354278564453, abs dis: 3.334564208984375
[rfa agg] iter: 4, weight: tensor([0.2586, 0.1149, 0.0339, 0.2509, 0.1146, 0.0482, 0.0356, 0.0803, 0.0303,
        0.0328])
[rfa agg] iter:  5, prev_obj_val: 65.12354278564453, obj_val: 68.46734619140625, abs dis: 3.3438034057617188
[rfa agg] iter: 5, weight: tensor([0.1267, 0.1430, 0.0313, 0.3640, 0.1437, 0.0466, 0.0331, 0.0538, 0.0276,
        0.0303])
[rfa agg] iter:  6, prev_obj_val: 68.46734619140625, obj_val: 68.45814514160156, abs dis: 0.0092010498046875
[rfa agg] iter: 6, weight: tensor([0.2428, 0.1150, 0.0339, 0.2666, 0.1147, 0.0482, 0.0356, 0.0800, 0.0303,
        0.0328])
[rfa agg] iter:  7, prev_obj_val: 68.45814514160156, obj_val: 65.12310791015625, abs dis: 3.3350372314453125
[rfa agg] iter: 7, weight: tensor([0.2566, 0.1146, 0.0338, 0.2538, 0.1143, 0.0481, 0.0355, 0.0802, 0.0303,
        0.0327])
[rfa agg] iter:  8, prev_obj_val: 65.12310791015625, obj_val: 68.4674301147461, abs dis: 3.3443222045898438
[rfa agg] iter: 8, weight: tensor([0.1264, 0.1427, 0.0313, 0.3649, 0.1435, 0.0465, 0.0330, 0.0537, 0.0276,
        0.0303])
[rfa agg] iter:  9, prev_obj_val: 68.4674301147461, obj_val: 68.45814514160156, abs dis: 0.00928497314453125
[rfa agg] iter: 9, weight: tensor([0.2427, 0.1150, 0.0339, 0.2668, 0.1147, 0.0482, 0.0356, 0.0800, 0.0303,
        0.0328])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3391, Accuracy: 97/10000 (0.9700%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6035, Accuracy: 430/9950 (4.3216%)
saving model
Done in 413.17487478256226 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0842, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0683, Accuracy: 52/186 (27.9570%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.4246, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0752, Accuracy: 64/373 (17.1582%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0442, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0514, Accuracy: 321/1089 (29.4766%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0253, Accuracy: 557/1089 (51.1478%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.3766, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0494, Accuracy: 399/1036 (38.5135%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0222, Accuracy: 721/1036 (69.5946%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.8645, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 396/1427 (27.7505%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0312, Accuracy: 634/1427 (44.4289%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3321, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0529, Accuracy: 477/1953 (24.4240%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0307, Accuracy: 935/1953 (47.8751%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9603, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0595, Accuracy: 185/682 (27.1261%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0347, Accuracy: 277/682 (40.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3699, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0573, Accuracy: 296/946 (31.2896%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0316, Accuracy: 398/946 (42.0719%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5415, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 402/1573 (25.5563%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 636/1573 (40.4323%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5837, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.2165, Accuracy: 65/10000 (0.6500%)
time spent on training: 333.2678978443146
[rfa agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 98, 59, 19, 34, 83, 80, 43, 40, 58], weight: tensor([0.0185, 0.0370, 0.1082, 0.1029, 0.1417, 0.1940, 0.0677, 0.0940, 0.1562,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 57.9134521484375, obj_val: 60.895660400390625, abs dis: 2.982208251953125
[rfa agg] iter: 0, weight: tensor([0.0039, 0.0099, 0.3334, 0.2656, 0.0893, 0.0476, 0.0308, 0.0982, 0.0707,
        0.0506])
[rfa agg] iter:  1, prev_obj_val: 60.895660400390625, obj_val: 66.40106964111328, abs dis: 5.505409240722656
[rfa agg] iter: 1, weight: tensor([0.0040, 0.0103, 0.1884, 0.3703, 0.0634, 0.0392, 0.0359, 0.1694, 0.0536,
        0.0656])
[rfa agg] iter:  2, prev_obj_val: 66.40106964111328, obj_val: 66.26437377929688, abs dis: 0.13669586181640625
[rfa agg] iter: 2, weight: tensor([0.0042, 0.0113, 0.0942, 0.1368, 0.0482, 0.0331, 0.0459, 0.4800, 0.0426,
        0.1037])
[rfa agg] iter:  3, prev_obj_val: 66.26437377929688, obj_val: 71.35400390625, abs dis: 5.089630126953125
[rfa agg] iter: 3, weight: tensor([0.0032, 0.0085, 0.0700, 0.1009, 0.0362, 0.0249, 0.0345, 0.6113, 0.0320,
        0.0786])
[rfa agg] iter:  4, prev_obj_val: 71.35400390625, obj_val: 71.30604553222656, abs dis: 0.0479583740234375
[rfa agg] iter: 4, weight: tensor([0.0058, 0.0160, 0.0906, 0.1162, 0.0544, 0.0396, 0.0768, 0.3176, 0.0491,
        0.2338])
[rfa agg] iter:  5, prev_obj_val: 71.30604553222656, obj_val: 71.30584716796875, abs dis: 0.0001983642578125
[rfa agg] iter: 5, weight: tensor([0.0058, 0.0161, 0.0909, 0.1165, 0.0545, 0.0396, 0.0772, 0.3019, 0.0492,
        0.2484])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3386, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 4.6377, Accuracy: 363/9950 (3.6482%)
saving model
Done in 436.71915674209595 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0607, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0293, Accuracy: 497/1190 (41.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5332, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 410/1581 (25.9330%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0315, Accuracy: 647/1581 (40.9235%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.2300, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0458, Accuracy: 342/813 (42.0664%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 498/813 (61.2546%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 13.3116, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0574, Accuracy: 388/1163 (33.3620%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0348, Accuracy: 528/1163 (45.3998%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4835, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0559, Accuracy: 461/1988 (23.1891%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0339, Accuracy: 744/1988 (37.4245%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8770, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0569, Accuracy: 436/1750 (24.9143%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0334, Accuracy: 736/1750 (42.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6718, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 292/690 (42.3188%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0234, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.1190, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0529, Accuracy: 469/1904 (24.6324%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0287, Accuracy: 792/1904 (41.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3646, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0529, Accuracy: 231/735 (31.4286%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0197, Accuracy: 403/735 (54.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.3088, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0849, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0683, Accuracy: 56/186 (30.1075%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.4230, Accuracy: 51/10000 (0.5100%)
time spent on training: 381.821293592453
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 28, 53, 68, 85, 44, 25, 46, 32, 56], weight: tensor([0.0992, 0.1318, 0.0677, 0.0969, 0.1657, 0.1458, 0.0575, 0.1587, 0.0613,
        0.0155])
[rfa agg] iter:  0, prev_obj_val: 64.47078704833984, obj_val: 67.5140380859375, abs dis: 3.0432510375976562
[rfa agg] iter: 0, weight: tensor([0.2282, 0.1626, 0.0425, 0.2307, 0.0757, 0.1042, 0.0289, 0.0884, 0.0342,
        0.0043])
[rfa agg] iter:  1, prev_obj_val: 67.5140380859375, obj_val: 76.04222869873047, abs dis: 8.528190612792969
[rfa agg] iter: 1, weight: tensor([0.3325, 0.0719, 0.0314, 0.3789, 0.0401, 0.0517, 0.0204, 0.0456, 0.0247,
        0.0028])
[rfa agg] iter:  2, prev_obj_val: 76.04222869873047, obj_val: 76.03423309326172, abs dis: 0.00799560546875
[rfa agg] iter: 2, weight: tensor([0.2848, 0.0819, 0.0698, 0.2875, 0.0535, 0.0649, 0.0413, 0.0594, 0.0519,
        0.0050])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3325, Accuracy: 91/10000 (0.9100%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 4.6260, Accuracy: 499/9950 (5.0151%)
saving model
Done in 477.98799419403076 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1298, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1214, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3361, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0632, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0323, Accuracy: 337/774 (43.5401%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.9534, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0522, Accuracy: 476/1953 (24.3728%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0313, Accuracy: 856/1953 (43.8300%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7334, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0568, Accuracy: 267/530 (50.3774%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0325, Accuracy: 303/530 (57.1698%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4145, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0660, Accuracy: 157/568 (27.6408%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0377, Accuracy: 268/568 (47.1831%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3571, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0600, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0366, Accuracy: 487/1402 (34.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7577, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0544, Accuracy: 421/1581 (26.6287%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0312, Accuracy: 689/1581 (43.5800%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.9057, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0808, Accuracy: 57/408 (13.9706%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0458, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.0649, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0554, Accuracy: 475/1988 (23.8934%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0334, Accuracy: 742/1988 (37.3239%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2962, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0781, Accuracy: 90/416 (21.6346%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0430, Accuracy: 222/416 (53.3654%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2832, Accuracy: 78/10000 (0.7800%)
time spent on training: 328.7848770618439
[rfa agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 81, 83, 18, 62, 66, 28, 36, 85, 78], weight: tensor([0.0088, 0.0798, 0.2012, 0.0546, 0.0585, 0.1445, 0.1629, 0.0420, 0.2048,
        0.0429])
[rfa agg] iter:  0, prev_obj_val: 75.99883270263672, obj_val: 75.82571411132812, abs dis: 0.17311859130859375
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0468, 0.0945, 0.0214, 0.0230, 0.5087, 0.1875, 0.0141, 0.0874,
        0.0144])
[rfa agg] iter:  1, prev_obj_val: 75.82571411132812, obj_val: 74.0464859008789, abs dis: 1.7792282104492188
[rfa agg] iter: 1, weight: tensor([0.0020, 0.0426, 0.0860, 0.0195, 0.0209, 0.5525, 0.1709, 0.0129, 0.0795,
        0.0131])
[rfa agg] iter:  2, prev_obj_val: 74.0464859008789, obj_val: 75.83340454101562, abs dis: 1.7869186401367188
[rfa agg] iter: 2, weight: tensor([0.0014, 0.0290, 0.0655, 0.0136, 0.0145, 0.6573, 0.1401, 0.0090, 0.0603,
        0.0092])
[rfa agg] iter:  3, prev_obj_val: 75.83340454101562, obj_val: 75.8233642578125, abs dis: 0.010040283203125
[rfa agg] iter: 3, weight: tensor([0.0019, 0.0413, 0.0834, 0.0189, 0.0203, 0.5669, 0.1649, 0.0125, 0.0771,
        0.0127])
[rfa agg] iter:  4, prev_obj_val: 75.8233642578125, obj_val: 74.04454803466797, abs dis: 1.7788162231445312
[rfa agg] iter: 4, weight: tensor([0.0020, 0.0420, 0.0849, 0.0193, 0.0207, 0.5586, 0.1683, 0.0127, 0.0785,
        0.0130])
[rfa agg] iter:  5, prev_obj_val: 74.04454803466797, obj_val: 77.6913070678711, abs dis: 3.646759033203125
[rfa agg] iter: 5, weight: tensor([0.0014, 0.0289, 0.0653, 0.0135, 0.0145, 0.6588, 0.1395, 0.0090, 0.0600,
        0.0092])
[rfa agg] iter:  6, prev_obj_val: 77.6913070678711, obj_val: 75.82836151123047, abs dis: 1.862945556640625
[rfa agg] iter: 6, weight: tensor([0.0025, 0.0546, 0.0988, 0.0246, 0.0263, 0.4856, 0.1833, 0.0161, 0.0917,
        0.0164])
[rfa agg] iter:  7, prev_obj_val: 75.82836151123047, obj_val: 74.04721069335938, abs dis: 1.7811508178710938
[rfa agg] iter: 7, weight: tensor([0.0020, 0.0428, 0.0865, 0.0196, 0.0210, 0.5503, 0.1717, 0.0130, 0.0799,
        0.0132])
[rfa agg] iter:  8, prev_obj_val: 74.04721069335938, obj_val: 75.83329010009766, abs dis: 1.7860794067382812
[rfa agg] iter: 8, weight: tensor([0.0014, 0.0291, 0.0656, 0.0136, 0.0146, 0.6568, 0.1403, 0.0090, 0.0604,
        0.0092])
[rfa agg] iter:  9, prev_obj_val: 75.83329010009766, obj_val: 75.82335662841797, abs dis: 0.0099334716796875
[rfa agg] iter: 9, weight: tensor([0.0019, 0.0413, 0.0834, 0.0189, 0.0203, 0.5669, 0.1649, 0.0125, 0.0771,
        0.0128])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3294, Accuracy: 91/10000 (0.9100%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 4.6701, Accuracy: 390/9950 (3.9196%)
saving model
Done in 430.33530855178833 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0539, Accuracy: 338/1372 (24.6356%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0298, Accuracy: 578/1372 (42.1283%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.8781, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1218, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1099, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3670, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 357/1446 (24.6888%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0327, Accuracy: 555/1446 (38.3817%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6779, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0580, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.4357, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0566, Accuracy: 462/1750 (26.4000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0330, Accuracy: 765/1750 (43.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5662, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0572, Accuracy: 290/1402 (20.6847%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0361, Accuracy: 462/1402 (32.9529%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4004, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 419/1662 (25.2106%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0309, Accuracy: 706/1662 (42.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2435, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 601/1470 (40.8844%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0227, Accuracy: 903/1470 (61.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.3677, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0559, Accuracy: 331/1131 (29.2661%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0273, Accuracy: 547/1131 (48.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2592, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0532, Accuracy: 350/1154 (30.3293%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0257, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.5847, Accuracy: 86/10000 (0.8600%)
time spent on training: 384.58249068260193
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 47, 26, 4, 44, 66, 94, 22, 38, 15], weight: tensor([0.1104, 0.0108, 0.1164, 0.0725, 0.1409, 0.1129, 0.1338, 0.1183, 0.0910,
        0.0929])
[rfa agg] iter:  0, prev_obj_val: 38.18963623046875, obj_val: 40.46613311767578, abs dis: 2.2764968872070312
[rfa agg] iter: 0, weight: tensor([0.1198, 0.0019, 0.0923, 0.0455, 0.0472, 0.1239, 0.0584, 0.0941, 0.1542,
        0.2626])
[rfa agg] iter:  1, prev_obj_val: 40.46613311767578, obj_val: 43.15376663208008, abs dis: 2.687633514404297
[rfa agg] iter: 1, weight: tensor([0.0918, 0.0017, 0.0736, 0.0461, 0.0403, 0.0946, 0.0491, 0.0748, 0.1886,
        0.3394])
[rfa agg] iter:  2, prev_obj_val: 43.15376663208008, obj_val: 43.1420783996582, abs dis: 0.011688232421875
[rfa agg] iter: 2, weight: tensor([0.0798, 0.0018, 0.0661, 0.0526, 0.0385, 0.0821, 0.0462, 0.0672, 0.2663,
        0.2994])
[rfa agg] iter:  3, prev_obj_val: 43.1420783996582, obj_val: 43.14126968383789, abs dis: 0.0008087158203125
[rfa agg] iter: 3, weight: tensor([0.0792, 0.0018, 0.0657, 0.0523, 0.0383, 0.0816, 0.0459, 0.0668, 0.2836,
        0.2848])
[rfa agg] iter:  4, prev_obj_val: 43.14126968383789, obj_val: 43.141204833984375, abs dis: 6.4849853515625e-05
[rfa agg] iter: 4, weight: tensor([0.0792, 0.0018, 0.0657, 0.0523, 0.0382, 0.0815, 0.0459, 0.0667, 0.2884,
        0.2803])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3255, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 4.7153, Accuracy: 348/9950 (3.4975%)
saving model
Done in 478.7014629840851 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0795, Accuracy: 26/312 (8.3333%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 174/312 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2579, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 401/1573 (25.4927%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0329, Accuracy: 663/1573 (42.1488%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4635, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0535, Accuracy: 380/1131 (33.5986%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0267, Accuracy: 562/1131 (49.6905%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4392, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0500, Accuracy: 331/1013 (32.6752%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0239, Accuracy: 571/1013 (56.3672%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6674, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0754, Accuracy: 103/515 (20.0000%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0502, Accuracy: 174/515 (33.7864%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9932, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0578, Accuracy: 289/776 (37.2423%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0245, Accuracy: 456/776 (58.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5277, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0542, Accuracy: 428/1581 (27.0715%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0315, Accuracy: 666/1581 (42.1252%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7173, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0502, Accuracy: 513/1418 (36.1777%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0275, Accuracy: 725/1418 (51.1283%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9856, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0514, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0230, Accuracy: 495/891 (55.5556%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.7402, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0525, Accuracy: 293/636 (46.0692%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0264, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4068, Accuracy: 71/10000 (0.7100%)
time spent on training: 367.72582745552063
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 40, 38, 39, 33, 75, 28, 70, 7, 52], weight: tensor([0.0317, 0.1598, 0.1149, 0.1029, 0.0523, 0.0788, 0.1606, 0.1440, 0.0905,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 50.5320930480957, obj_val: 56.09843826293945, abs dis: 5.56634521484375
[rfa agg] iter: 0, weight: tensor([0.0084, 0.0568, 0.2090, 0.3776, 0.0211, 0.0672, 0.0571, 0.0669, 0.1059,
        0.0300])
[rfa agg] iter:  1, prev_obj_val: 56.09843826293945, obj_val: 62.710060119628906, abs dis: 6.611621856689453
[rfa agg] iter: 1, weight: tensor([0.0103, 0.0470, 0.1001, 0.2032, 0.0293, 0.1481, 0.0473, 0.0523, 0.3185,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 62.710060119628906, obj_val: 68.60006713867188, abs dis: 5.890007019042969
[rfa agg] iter: 2, weight: tensor([0.0116, 0.0389, 0.0665, 0.0984, 0.0378, 0.3696, 0.0391, 0.0420, 0.2343,
        0.0618])
[rfa agg] iter:  3, prev_obj_val: 68.60006713867188, obj_val: 65.54077911376953, abs dis: 3.0592880249023438
[rfa agg] iter: 3, weight: tensor([0.0181, 0.0491, 0.0761, 0.1015, 0.0684, 0.2877, 0.0494, 0.0523, 0.1735,
        0.1238])
[rfa agg] iter:  4, prev_obj_val: 65.54077911376953, obj_val: 62.64280319213867, abs dis: 2.8979759216308594
[rfa agg] iter: 4, weight: tensor([0.0140, 0.0423, 0.0687, 0.0958, 0.0489, 0.3737, 0.0425, 0.0454, 0.1850,
        0.0837])
[rfa agg] iter:  5, prev_obj_val: 62.64280319213867, obj_val: 68.6091537475586, abs dis: 5.966350555419922
[rfa agg] iter: 5, weight: tensor([0.0101, 0.0339, 0.0581, 0.0853, 0.0331, 0.4596, 0.0341, 0.0367, 0.1951,
        0.0540])
[rfa agg] iter:  6, prev_obj_val: 68.6091537475586, obj_val: 65.54027557373047, abs dis: 3.068878173828125
[rfa agg] iter: 6, weight: tensor([0.0180, 0.0489, 0.0757, 0.1009, 0.0681, 0.2931, 0.0491, 0.0521, 0.1714,
        0.1228])
[rfa agg] iter:  7, prev_obj_val: 65.54027557373047, obj_val: 62.64268493652344, abs dis: 2.8975906372070312
[rfa agg] iter: 7, weight: tensor([0.0140, 0.0423, 0.0686, 0.0956, 0.0489, 0.3746, 0.0425, 0.0454, 0.1846,
        0.0835])
[rfa agg] iter:  8, prev_obj_val: 62.64268493652344, obj_val: 68.60922241210938, abs dis: 5.9665374755859375
[rfa agg] iter: 8, weight: tensor([0.0101, 0.0339, 0.0581, 0.0853, 0.0330, 0.4600, 0.0341, 0.0367, 0.1949,
        0.0539])
[rfa agg] iter:  9, prev_obj_val: 68.60922241210938, obj_val: 65.54027557373047, abs dis: 3.0689468383789062
[rfa agg] iter: 9, weight: tensor([0.0180, 0.0489, 0.0757, 0.1009, 0.0681, 0.2931, 0.0491, 0.0521, 0.1714,
        0.1228])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3254, Accuracy: 103/10000 (1.0300%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 4.7450, Accuracy: 244/9950 (2.4523%)
saving model
Done in 461.0259358882904 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0912, Accuracy: 6/271 (2.2140%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0574, Accuracy: 124/271 (45.7565%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.3636, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0739, Accuracy: 112/515 (21.7476%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0475, Accuracy: 174/515 (33.7864%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5664, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0493, Accuracy: 517/1418 (36.4598%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0276, Accuracy: 732/1418 (51.6220%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.0767, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0492, Accuracy: 299/861 (34.7271%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0177, Accuracy: 520/861 (60.3949%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.7344, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0572, Accuracy: 261/818 (31.9071%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0267, Accuracy: 410/818 (50.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.9156, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0573, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0323, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3039, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0662, Accuracy: 158/568 (27.8169%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0366, Accuracy: 267/568 (47.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3030, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0657, Accuracy: 202/605 (33.3884%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.9855, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0742, Accuracy: 57/440 (12.9545%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0433, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.8051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0613, Accuracy: 300/715 (41.9580%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0335, Accuracy: 441/715 (61.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.6395, Accuracy: 83/10000 (0.8300%)
time spent on training: 291.97256731987
[rfa agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 33, 70, 10, 71, 89, 62, 2, 49, 23], weight: tensor([0.0381, 0.0725, 0.1995, 0.1211, 0.1151, 0.1261, 0.0799, 0.0851, 0.0619,
        0.1006])
[rfa agg] iter:  0, prev_obj_val: 39.434722900390625, obj_val: 50.231605529785156, abs dis: 10.796882629394531
[rfa agg] iter: 0, weight: tensor([0.0157, 0.0865, 0.0410, 0.0974, 0.1368, 0.1015, 0.0966, 0.1876, 0.0380,
        0.1988])
[rfa agg] iter:  1, prev_obj_val: 50.231605529785156, obj_val: 50.174285888671875, abs dis: 0.05731964111328125
[rfa agg] iter: 1, weight: tensor([0.0247, 0.2249, 0.0313, 0.0497, 0.0578, 0.0518, 0.2810, 0.1239, 0.0905,
        0.0643])
[rfa agg] iter:  2, prev_obj_val: 50.174285888671875, obj_val: 50.174129486083984, abs dis: 0.000156402587890625
[rfa agg] iter: 2, weight: tensor([0.0235, 0.2336, 0.0299, 0.0475, 0.0551, 0.0494, 0.2949, 0.1181, 0.0871,
        0.0610])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3262, Accuracy: 103/10000 (1.0300%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 4.7732, Accuracy: 168/9950 (1.6884%)
saving model
Done in 390.3002951145172 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0534, Accuracy: 298/677 (44.0177%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0212, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.4378, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0712, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.5533, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0540, Accuracy: 310/776 (39.9485%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0259, Accuracy: 444/776 (57.2165%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.9491, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0566, Accuracy: 320/1657 (19.3120%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 576/1657 (34.7616%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2474, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0563, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 527/1154 (45.6672%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.3071, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0563, Accuracy: 323/719 (44.9235%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0287, Accuracy: 445/719 (61.8915%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1271, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0526, Accuracy: 435/1742 (24.9713%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0291, Accuracy: 785/1742 (45.0631%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5791, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0525, Accuracy: 426/1645 (25.8967%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0294, Accuracy: 745/1645 (45.2888%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1767, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0540, Accuracy: 408/1581 (25.8065%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0310, Accuracy: 670/1581 (42.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.7516, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 469/1440 (32.5694%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 753/1440 (52.2917%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.2433, Accuracy: 90/10000 (0.9000%)
time spent on training: 402.0953257083893
[rfa agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 75, 0, 57, 41, 93, 13, 28, 29], weight: tensor([0.0564, 0.0503, 0.0647, 0.1382, 0.0962, 0.0599, 0.1452, 0.1372, 0.1318,
        0.1201])
[rfa agg] iter:  0, prev_obj_val: 53.243282318115234, obj_val: 54.80733871459961, abs dis: 1.564056396484375
[rfa agg] iter: 0, weight: tensor([0.0274, 0.0220, 0.0402, 0.0997, 0.3173, 0.0326, 0.0790, 0.0991, 0.1139,
        0.1688])
[rfa agg] iter:  1, prev_obj_val: 54.80733871459961, obj_val: 60.96867752075195, abs dis: 6.161338806152344
[rfa agg] iter: 1, weight: tensor([0.0254, 0.0202, 0.0379, 0.0805, 0.4418, 0.0304, 0.0650, 0.0800, 0.0907,
        0.1280])
[rfa agg] iter:  2, prev_obj_val: 60.96867752075195, obj_val: 58.677127838134766, abs dis: 2.2915496826171875
[rfa agg] iter: 2, weight: tensor([0.0378, 0.0295, 0.0602, 0.0806, 0.3979, 0.0466, 0.0680, 0.0801, 0.0879,
        0.1113])
[rfa agg] iter:  3, prev_obj_val: 58.677127838134766, obj_val: 63.328826904296875, abs dis: 4.651699066162109
[rfa agg] iter: 3, weight: tensor([0.0291, 0.0229, 0.0452, 0.0708, 0.4881, 0.0355, 0.0589, 0.0703, 0.0778,
        0.1015])
[rfa agg] iter:  4, prev_obj_val: 63.328826904296875, obj_val: 60.96961212158203, abs dis: 2.3592147827148438
[rfa agg] iter: 4, weight: tensor([0.0464, 0.0359, 0.0761, 0.0867, 0.3274, 0.0580, 0.0740, 0.0861, 0.0937,
        0.1157])
[rfa agg] iter:  5, prev_obj_val: 60.96961212158203, obj_val: 60.96635437011719, abs dis: 0.00325775146484375
[rfa agg] iter: 5, weight: tensor([0.0384, 0.0300, 0.0613, 0.0820, 0.3874, 0.0475, 0.0692, 0.0815, 0.0894,
        0.1133])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3231, Accuracy: 97/10000 (0.9700%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 4.8125, Accuracy: 129/9950 (1.2965%)
saving model
Done in 504.4482684135437 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 538/1552 (34.6649%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0195, Accuracy: 820/1552 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.8248, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0512, Accuracy: 440/1956 (22.4949%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 758/1956 (38.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1658, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0551, Accuracy: 424/1427 (29.7127%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 651/1427 (45.6202%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1900, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0470, Accuracy: 391/928 (42.1336%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0202, Accuracy: 642/928 (69.1810%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0649, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0508, Accuracy: 510/1715 (29.7376%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0280, Accuracy: 840/1715 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.2261, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0569, Accuracy: 260/1013 (25.6663%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0310, Accuracy: 442/1013 (43.6328%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1972, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0646, Accuracy: 213/669 (31.8386%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0364, Accuracy: 373/669 (55.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.6673, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0565, Accuracy: 327/1402 (23.3238%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0359, Accuracy: 460/1402 (32.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.2263, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0505, Accuracy: 360/1130 (31.8584%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0273, Accuracy: 496/1130 (43.8938%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0075, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0560, Accuracy: 336/1241 (27.0749%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0342, Accuracy: 483/1241 (38.9202%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7393, Accuracy: 86/10000 (0.8600%)
time spent on training: 444.7472321987152
[rfa agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [74, 6, 34, 1, 92, 14, 45, 66, 54, 72], weight: tensor([0.1191, 0.1501, 0.1095, 0.0712, 0.1316, 0.0777, 0.0513, 0.1076, 0.0867,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 44.785858154296875, obj_val: 49.45844650268555, abs dis: 4.672588348388672
[rfa agg] iter: 0, weight: tensor([0.0767, 0.0419, 0.1221, 0.0376, 0.0590, 0.0503, 0.0159, 0.1914, 0.0975,
        0.3076])
[rfa agg] iter:  1, prev_obj_val: 49.45844650268555, obj_val: 55.95127487182617, abs dis: 6.492828369140625
[rfa agg] iter: 1, weight: tensor([0.0632, 0.0401, 0.0863, 0.0556, 0.0525, 0.0812, 0.0205, 0.1126, 0.2226,
        0.2654])
[rfa agg] iter:  2, prev_obj_val: 55.95127487182617, obj_val: 61.279052734375, abs dis: 5.327777862548828
[rfa agg] iter: 2, weight: tensor([0.0511, 0.0359, 0.0637, 0.0862, 0.0446, 0.1537, 0.0254, 0.0764, 0.3435,
        0.1197])
[rfa agg] iter:  3, prev_obj_val: 61.279052734375, obj_val: 61.22725296020508, abs dis: 0.051799774169921875
[rfa agg] iter: 3, weight: tensor([0.0461, 0.0341, 0.0552, 0.1344, 0.0413, 0.3265, 0.0306, 0.0641, 0.1797,
        0.0879])
[rfa agg] iter:  4, prev_obj_val: 61.22725296020508, obj_val: 64.09888458251953, abs dis: 2.871631622314453
[rfa agg] iter: 4, weight: tensor([0.0440, 0.0326, 0.0526, 0.1313, 0.0394, 0.3607, 0.0293, 0.0611, 0.1654,
        0.0837])
[rfa agg] iter:  5, prev_obj_val: 64.09888458251953, obj_val: 70.88737487792969, abs dis: 6.788490295410156
[rfa agg] iter: 5, weight: tensor([0.0350, 0.0266, 0.0413, 0.1461, 0.0317, 0.4741, 0.0271, 0.0473, 0.1087,
        0.0621])
[rfa agg] iter:  6, prev_obj_val: 70.88737487792969, obj_val: 64.13728332519531, abs dis: 6.750091552734375
[rfa agg] iter: 6, weight: tensor([0.0422, 0.0333, 0.0484, 0.3111, 0.0389, 0.2603, 0.0451, 0.0543, 0.0995,
        0.0668])
[rfa agg] iter:  7, prev_obj_val: 64.13728332519531, obj_val: 67.34355926513672, abs dis: 3.2062759399414062
[rfa agg] iter: 7, weight: tensor([0.0377, 0.0285, 0.0443, 0.1711, 0.0341, 0.4225, 0.0292, 0.0508, 0.1152,
        0.0666])
[rfa agg] iter:  8, prev_obj_val: 67.34355926513672, obj_val: 74.5980224609375, abs dis: 7.254463195800781
[rfa agg] iter: 8, weight: tensor([0.0380, 0.0295, 0.0442, 0.2328, 0.0348, 0.3718, 0.0345, 0.0501, 0.1011,
        0.0634])
[rfa agg] iter:  9, prev_obj_val: 74.5980224609375, obj_val: 67.34972381591797, abs dis: 7.248298645019531
[rfa agg] iter: 9, weight: tensor([0.0463, 0.0372, 0.0524, 0.3310, 0.0430, 0.2036, 0.0592, 0.0584, 0.0989,
        0.0700])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3226, Accuracy: 119/10000 (1.1900%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 4.8424, Accuracy: 62/9950 (0.6231%)
saving model
Done in 543.0435154438019 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0448, Accuracy: 328/813 (40.3444%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0178, Accuracy: 515/813 (63.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 13.1077, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 617/1470 (41.9728%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0225, Accuracy: 915/1470 (62.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.5759, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0537, Accuracy: 444/1662 (26.7148%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0304, Accuracy: 703/1662 (42.2984%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3125, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0487, Accuracy: 385/1213 (31.7395%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0260, Accuracy: 562/1213 (46.3314%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.9815, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0556, Accuracy: 408/1587 (25.7089%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0322, Accuracy: 640/1587 (40.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8020, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0519, Accuracy: 364/1049 (34.6997%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0255, Accuracy: 576/1049 (54.9094%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4423, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1225, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1065, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3546, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 299/715 (41.8182%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0347, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3850, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0589, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 430/901 (47.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3844, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0661, Accuracy: 187/605 (30.9091%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 331/605 (54.7107%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.0834, Accuracy: 70/10000 (0.7000%)
time spent on training: 384.9637143611908
[rfa agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 22, 94, 97, 27, 51, 47, 23, 4, 2], weight: tensor([0.0801, 0.1448, 0.1638, 0.1195, 0.1564, 0.1034, 0.0132, 0.0705, 0.0888,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 48.7669677734375, obj_val: 49.9825439453125, abs dis: 1.215576171875
[rfa agg] iter: 0, weight: tensor([0.0658, 0.0793, 0.0602, 0.1863, 0.0646, 0.3293, 0.0031, 0.0464, 0.1368,
        0.0281])
[rfa agg] iter:  1, prev_obj_val: 49.9825439453125, obj_val: 55.21971130371094, abs dis: 5.2371673583984375
[rfa agg] iter: 1, weight: tensor([0.0713, 0.0701, 0.0546, 0.1454, 0.0582, 0.3535, 0.0031, 0.0492, 0.1656,
        0.0290])
[rfa agg] iter:  2, prev_obj_val: 55.21971130371094, obj_val: 59.69134521484375, abs dis: 4.4716339111328125
[rfa agg] iter: 2, weight: tensor([0.1205, 0.0577, 0.0477, 0.0941, 0.0500, 0.1555, 0.0035, 0.0735, 0.3595,
        0.0379])
[rfa agg] iter:  3, prev_obj_val: 59.69134521484375, obj_val: 62.16522979736328, abs dis: 2.4738845825195312
[rfa agg] iter: 3, weight: tensor([0.2286, 0.0544, 0.0463, 0.0802, 0.0482, 0.1112, 0.0041, 0.1135, 0.2634,
        0.0500])
[rfa agg] iter:  4, prev_obj_val: 62.16522979736328, obj_val: 59.68362045288086, abs dis: 2.481609344482422
[rfa agg] iter: 4, weight: tensor([0.3422, 0.0481, 0.0414, 0.0682, 0.0430, 0.0898, 0.0040, 0.1370, 0.1732,
        0.0531])
[rfa agg] iter:  5, prev_obj_val: 59.68362045288086, obj_val: 62.1607666015625, abs dis: 2.4771461486816406
[rfa agg] iter: 5, weight: tensor([0.2469, 0.0543, 0.0462, 0.0801, 0.0481, 0.1101, 0.0041, 0.1139, 0.2465,
        0.0499])
[rfa agg] iter:  6, prev_obj_val: 62.1607666015625, obj_val: 59.68414306640625, abs dis: 2.47662353515625
[rfa agg] iter: 6, weight: tensor([0.3457, 0.0479, 0.0413, 0.0679, 0.0428, 0.0894, 0.0040, 0.1364, 0.1719,
        0.0529])
[rfa agg] iter:  7, prev_obj_val: 59.68414306640625, obj_val: 62.16072463989258, abs dis: 2.476581573486328
[rfa agg] iter: 7, weight: tensor([0.2471, 0.0543, 0.0462, 0.0801, 0.0481, 0.1100, 0.0041, 0.1139, 0.2464,
        0.0499])
[rfa agg] iter:  8, prev_obj_val: 62.16072463989258, obj_val: 59.68415451049805, abs dis: 2.4765701293945312
[rfa agg] iter: 8, weight: tensor([0.3458, 0.0479, 0.0413, 0.0679, 0.0428, 0.0894, 0.0040, 0.1364, 0.1718,
        0.0529])
[rfa agg] iter:  9, prev_obj_val: 59.68415451049805, obj_val: 62.16071701049805, abs dis: 2.4765625
[rfa agg] iter: 9, weight: tensor([0.2471, 0.0543, 0.0462, 0.0801, 0.0481, 0.1100, 0.0041, 0.1139, 0.2464,
        0.0499])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3214, Accuracy: 116/10000 (1.1600%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.8653, Accuracy: 54/9950 (0.5427%)
saving model
Done in 481.2628741264343 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0792, Accuracy: 69/416 (16.5865%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0401, Accuracy: 233/416 (56.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.3950, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0600, Accuracy: 183/781 (23.4315%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0306, Accuracy: 300/781 (38.4123%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.3743, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0557, Accuracy: 335/1657 (20.2173%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0321, Accuracy: 589/1657 (35.5462%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1671, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0480, Accuracy: 411/1275 (32.2353%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 796/1275 (62.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.2121, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 367/1573 (23.3312%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0325, Accuracy: 640/1573 (40.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7370, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0444, Accuracy: 476/928 (51.2931%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0198, Accuracy: 668/928 (71.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8288, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0496, Accuracy: 347/1154 (30.0693%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0245, Accuracy: 581/1154 (50.3466%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.7479, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0492, Accuracy: 321/861 (37.2822%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0174, Accuracy: 531/861 (61.6725%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.2142, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0530, Accuracy: 449/1581 (28.3997%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 675/1581 (42.6945%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9503, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0822, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0440, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7712, Accuracy: 52/10000 (0.5200%)
time spent on training: 373.5543622970581
[rfa agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 3, 0, 9, 40, 1, 57, 10, 28, 76], weight: tensor([0.0389, 0.0730, 0.1550, 0.1192, 0.1471, 0.0868, 0.1079, 0.0805, 0.1479,
        0.0436])
[rfa agg] iter:  0, prev_obj_val: 51.16442108154297, obj_val: 55.908443450927734, abs dis: 4.744022369384766
[rfa agg] iter: 0, weight: tensor([0.0151, 0.0654, 0.0741, 0.1846, 0.0794, 0.1340, 0.2570, 0.0920, 0.0798,
        0.0187])
[rfa agg] iter:  1, prev_obj_val: 55.908443450927734, obj_val: 55.874916076660156, abs dis: 0.033527374267578125
[rfa agg] iter: 1, weight: tensor([0.0172, 0.0948, 0.0616, 0.1167, 0.0648, 0.2667, 0.1397, 0.1515, 0.0651,
        0.0217])
[rfa agg] iter:  2, prev_obj_val: 55.874916076660156, obj_val: 55.874725341796875, abs dis: 0.00019073486328125
[rfa agg] iter: 2, weight: tensor([0.0169, 0.0932, 0.0606, 0.1145, 0.0637, 0.2798, 0.1361, 0.1498, 0.0640,
        0.0213])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3220, Accuracy: 129/10000 (1.2900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.8994, Accuracy: 17/9950 (0.1709%)
saving model
Done in 468.4435956478119 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0821, Accuracy: 51/466 (10.9442%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0441, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.2363, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0562, Accuracy: 330/1513 (21.8110%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0339, Accuracy: 569/1513 (37.6074%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0258, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0418, Accuracy: 503/928 (54.2026%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0194, Accuracy: 658/928 (70.9052%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.9336, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 481/1440 (33.4028%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0253, Accuracy: 778/1440 (54.0278%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8232, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0542, Accuracy: 325/719 (45.2017%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0284, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1369, Accuracy: 65/10000 (0.6500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0484, Accuracy: 474/1574 (30.1144%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0245, Accuracy: 757/1574 (48.0940%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8208, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0473, Accuracy: 717/2227 (32.1958%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0258, Accuracy: 1142/2227 (51.2797%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1964, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0649, Accuracy: 197/605 (32.5620%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.1159, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0562, Accuracy: 260/1013 (25.6663%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0309, Accuracy: 421/1013 (41.5597%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5155, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0459, Accuracy: 560/1628 (34.3980%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0224, Accuracy: 960/1628 (58.9681%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0910, Accuracy: 156/10000 (1.5600%)
time spent on training: 437.90074634552
[rfa agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.040607198877239334
[rfa agg] init. name: [76, 8, 1, 29, 41, 17, 60, 2, 14, 5], weight: tensor([0.0385, 0.1249, 0.0766, 0.1189, 0.0594, 0.1299, 0.1839, 0.0499, 0.0836,
        0.1344])
[rfa agg] iter:  0, prev_obj_val: 66.8302993774414, obj_val: 68.51860809326172, abs dis: 1.6883087158203125
[rfa agg] iter: 0, weight: tensor([0.0193, 0.1581, 0.0967, 0.1914, 0.0456, 0.1352, 0.0686, 0.0304, 0.1360,
        0.1186])
[rfa agg] iter:  1, prev_obj_val: 68.51860809326172, obj_val: 70.2286376953125, abs dis: 1.7100296020507812
[rfa agg] iter: 1, weight: tensor([0.0206, 0.1457, 0.1106, 0.1725, 0.0498, 0.1266, 0.0678, 0.0327, 0.1611,
        0.1125])
[rfa agg] iter:  2, prev_obj_val: 70.2286376953125, obj_val: 70.22774505615234, abs dis: 0.00089263916015625
[rfa agg] iter: 2, weight: tensor([0.0216, 0.1325, 0.1254, 0.1535, 0.0535, 0.1168, 0.0656, 0.0345, 0.1916,
        0.1049])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3195, Accuracy: 142/10000 (1.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 4.8981, Accuracy: 17/9950 (0.1709%)
saving model
Done in 533.2635004520416 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0453, Accuracy: 543/1129 (48.0957%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0204, Accuracy: 771/1129 (68.2905%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5949, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0911, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 147/271 (54.2435%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4686, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0690, Accuracy: 99/500 (19.8000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0440, Accuracy: 250/500 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4932, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0582, Accuracy: 194/938 (20.6823%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0303, Accuracy: 408/938 (43.4968%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0238, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0525, Accuracy: 476/1953 (24.3728%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0304, Accuracy: 908/1953 (46.4926%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8404, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0495, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0233, Accuracy: 489/891 (54.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.1239, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 363/1446 (25.1037%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0326, Accuracy: 559/1446 (38.6584%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5370, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 414/1573 (26.3191%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0329, Accuracy: 642/1573 (40.8137%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7273, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0535, Accuracy: 289/690 (41.8841%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0226, Accuracy: 480/690 (69.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.4353, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0432, Accuracy: 319/813 (39.2374%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0177, Accuracy: 507/813 (62.3616%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.5661, Accuracy: 55/10000 (0.5500%)
time spent on training: 376.75240683555603
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 35, 82, 73, 83, 7, 26, 40, 25, 53], weight: tensor([0.1106, 0.0266, 0.0490, 0.0919, 0.1914, 0.0873, 0.1417, 0.1542, 0.0676,
        0.0797])
[rfa agg] iter:  0, prev_obj_val: 61.653438568115234, obj_val: 63.30941390991211, abs dis: 1.655975341796875
[rfa agg] iter: 0, weight: tensor([0.3144, 0.0091, 0.0224, 0.1792, 0.0561, 0.1168, 0.0963, 0.0788, 0.0461,
        0.0809])
[rfa agg] iter:  1, prev_obj_val: 63.30941390991211, obj_val: 66.9194564819336, abs dis: 3.6100425720214844
[rfa agg] iter: 1, weight: tensor([0.1933, 0.0091, 0.0231, 0.2828, 0.0481, 0.1549, 0.0760, 0.0643, 0.0507,
        0.0977])
[rfa agg] iter:  2, prev_obj_val: 66.9194564819336, obj_val: 73.61225891113281, abs dis: 6.692802429199219
[rfa agg] iter: 2, weight: tensor([0.0803, 0.0074, 0.0198, 0.3183, 0.0306, 0.2819, 0.0438, 0.0386, 0.0502,
        0.1292])
[rfa agg] iter:  3, prev_obj_val: 73.61225891113281, obj_val: 82.85865783691406, abs dis: 9.24639892578125
[rfa agg] iter: 3, weight: tensor([0.0594, 0.0091, 0.0269, 0.1225, 0.0293, 0.2124, 0.0389, 0.0353, 0.0881,
        0.3781])
[rfa agg] iter:  4, prev_obj_val: 82.85865783691406, obj_val: 79.61940002441406, abs dis: 3.2392578125
[rfa agg] iter: 4, weight: tensor([0.0648, 0.0158, 0.0538, 0.0998, 0.0379, 0.1319, 0.0475, 0.0440, 0.3062,
        0.1982])
[rfa agg] iter:  5, prev_obj_val: 79.61940002441406, obj_val: 76.50308227539062, abs dis: 3.1163177490234375
[rfa agg] iter: 5, weight: tensor([0.0672, 0.0140, 0.0451, 0.1107, 0.0372, 0.1539, 0.0475, 0.0437, 0.2241,
        0.2567])
[rfa agg] iter:  6, prev_obj_val: 76.50308227539062, obj_val: 79.62127685546875, abs dis: 3.118194580078125
[rfa agg] iter: 6, weight: tensor([0.0629, 0.0113, 0.0346, 0.1134, 0.0329, 0.1721, 0.0429, 0.0392, 0.1345,
        0.3563])
[rfa agg] iter:  7, prev_obj_val: 79.62127685546875, obj_val: 73.57034301757812, abs dis: 6.050933837890625
[rfa agg] iter: 7, weight: tensor([0.0670, 0.0140, 0.0450, 0.1105, 0.0372, 0.1550, 0.0475, 0.0437, 0.2096,
        0.2706])
[rfa agg] iter:  8, prev_obj_val: 73.57034301757812, obj_val: 79.63734436035156, abs dis: 6.0670013427734375
[rfa agg] iter: 8, weight: tensor([0.0563, 0.0086, 0.0254, 0.1137, 0.0276, 0.1951, 0.0368, 0.0333, 0.0846,
        0.4185])
[rfa agg] iter:  9, prev_obj_val: 79.63734436035156, obj_val: 73.56813049316406, abs dis: 6.0692138671875
[rfa agg] iter: 9, weight: tensor([0.0670, 0.0140, 0.0450, 0.1105, 0.0372, 0.1554, 0.0475, 0.0437, 0.2045,
        0.2752])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3197, Accuracy: 130/10000 (1.3000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 4.8521, Accuracy: 24/9950 (0.2412%)
saving model
Done in 477.14310693740845 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0531, Accuracy: 301/590 (51.0169%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.0636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0518, Accuracy: 342/1071 (31.9328%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0270, Accuracy: 553/1071 (51.6340%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.1375, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1298, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1220, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3225, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0708, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0424, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3254, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0570, Accuracy: 259/818 (31.6626%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0263, Accuracy: 418/818 (51.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.9931, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0537, Accuracy: 380/1154 (32.9289%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 467/1154 (40.4679%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.4222, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0793, Accuracy: 16/312 (5.1282%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0402, Accuracy: 176/312 (56.4103%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.9848, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0545, Accuracy: 225/735 (30.6122%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0196, Accuracy: 423/735 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.4524, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 425/1949 (21.8061%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0312, Accuracy: 689/1949 (35.3515%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4700, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 3/186 (1.6129%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4218, Accuracy: 50/10000 (0.5000%)
time spent on training: 312.10959792137146
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 55, 61, 88, 71, 15, 24, 32, 21, 56], weight: tensor([0.0786, 0.1427, 0.0113, 0.0804, 0.1090, 0.1538, 0.0416, 0.0980, 0.2598,
        0.0248])
[rfa agg] iter:  0, prev_obj_val: 64.69552612304688, obj_val: 65.61617279052734, abs dis: 0.9206466674804688
[rfa agg] iter: 0, weight: tensor([0.0569, 0.3409, 0.0034, 0.0582, 0.1694, 0.1700, 0.0158, 0.1104, 0.0670,
        0.0079])
[rfa agg] iter:  1, prev_obj_val: 65.61617279052734, obj_val: 67.5278549194336, abs dis: 1.91168212890625
[rfa agg] iter: 1, weight: tensor([0.0684, 0.2198, 0.0036, 0.0701, 0.2673, 0.1323, 0.0173, 0.1506, 0.0621,
        0.0085])
[rfa agg] iter:  2, prev_obj_val: 67.5278549194336, obj_val: 70.46074676513672, abs dis: 2.932891845703125
[rfa agg] iter: 2, weight: tensor([0.0584, 0.0797, 0.0023, 0.0599, 0.4976, 0.0573, 0.0118, 0.1947, 0.0326,
        0.0056])
[rfa agg] iter:  3, prev_obj_val: 70.46074676513672, obj_val: 77.21614837646484, abs dis: 6.755401611328125
[rfa agg] iter: 3, weight: tensor([0.0874, 0.0650, 0.0026, 0.0900, 0.2385, 0.0501, 0.0137, 0.4149, 0.0315,
        0.0063])
[rfa agg] iter:  4, prev_obj_val: 77.21614837646484, obj_val: 83.21116638183594, abs dis: 5.995018005371094
[rfa agg] iter: 4, weight: tensor([0.2718, 0.0541, 0.0033, 0.3039, 0.1061, 0.0446, 0.0187, 0.1578, 0.0315,
        0.0082])
[rfa agg] iter:  5, prev_obj_val: 83.21116638183594, obj_val: 83.20742797851562, abs dis: 0.0037384033203125
[rfa agg] iter: 5, weight: tensor([0.3174, 0.0482, 0.0038, 0.3490, 0.0784, 0.0410, 0.0235, 0.0981, 0.0308,
        0.0097])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3186, Accuracy: 132/10000 (1.3200%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 4.7922, Accuracy: 60/9950 (0.6030%)
saving model
Done in 411.68261456489563 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0580, Accuracy: 296/715 (41.3986%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0350, Accuracy: 441/715 (61.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.5571, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0680, Accuracy: 166/631 (26.3074%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0383, Accuracy: 295/631 (46.7512%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4462, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0567, Accuracy: 426/1427 (29.8528%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 657/1427 (46.0406%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1791, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0515, Accuracy: 454/1475 (30.7797%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0274, Accuracy: 758/1475 (51.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8580, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0789, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0394, Accuracy: 190/312 (60.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.9703, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0598, Accuracy: 178/682 (26.0997%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0344, Accuracy: 296/682 (43.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.3408, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0439, Accuracy: 586/1129 (51.9043%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0202, Accuracy: 783/1129 (69.3534%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.6075, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1298, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1213, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3243, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0502, Accuracy: 398/1030 (38.6408%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0222, Accuracy: 696/1030 (67.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1856, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0518, Accuracy: 330/1340 (24.6269%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0247, Accuracy: 618/1340 (46.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1976, Accuracy: 100/10000 (1.0000%)
time spent on training: 328.315550327301
[rfa agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 48, 34, 65, 24, 80, 37, 61, 91, 77], weight: tensor([0.0810, 0.0715, 0.1617, 0.1671, 0.0354, 0.0773, 0.1279, 0.0096, 0.1167,
        0.1518])
[rfa agg] iter:  0, prev_obj_val: 49.86711502075195, obj_val: 49.816688537597656, abs dis: 0.050426483154296875
[rfa agg] iter: 0, weight: tensor([0.0937, 0.0540, 0.0895, 0.0817, 0.0140, 0.0711, 0.2001, 0.0030, 0.2786,
        0.1143])
[rfa agg] iter:  1, prev_obj_val: 49.816688537597656, obj_val: 49.816585540771484, abs dis: 0.000102996826171875
[rfa agg] iter: 1, weight: tensor([0.0924, 0.0531, 0.0880, 0.0804, 0.0138, 0.0700, 0.1989, 0.0029, 0.2879,
        0.1124])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3145, Accuracy: 129/10000 (1.2900%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.7824, Accuracy: 92/9950 (0.9246%)
saving model
Done in 431.5752549171448 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0521, Accuracy: 460/1904 (24.1597%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0277, Accuracy: 853/1904 (44.8004%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1062, Accuracy: 169/10000 (1.6900%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0601, Accuracy: 211/953 (22.1406%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0354, Accuracy: 352/953 (36.9360%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7013, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0578, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0284, Accuracy: 551/1190 (46.3025%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0986, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0563, Accuracy: 301/715 (42.0979%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0357, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.5756, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0538, Accuracy: 376/1131 (33.2449%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0262, Accuracy: 557/1131 (49.2485%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1756, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0576, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0304, Accuracy: 420/901 (46.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2353, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0551, Accuracy: 373/1657 (22.5106%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0323, Accuracy: 588/1657 (35.4858%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2469, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0532, Accuracy: 276/636 (43.3962%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0255, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4692, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0606, Accuracy: 325/1003 (32.4028%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0334, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9055, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0497, Accuracy: 343/1154 (29.7227%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 563/1154 (48.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 12.1673, Accuracy: 63/10000 (0.6300%)
time spent on training: 406.7047562599182
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 64, 84, 23, 38, 4, 0, 52, 86, 57], weight: tensor([0.1693, 0.0848, 0.1058, 0.0636, 0.1006, 0.0801, 0.1474, 0.0566, 0.0892,
        0.1026])
[rfa agg] iter:  0, prev_obj_val: 46.37760543823242, obj_val: 51.70978927612305, abs dis: 5.332183837890625
[rfa agg] iter: 0, weight: tensor([0.0338, 0.0820, 0.1555, 0.0287, 0.2768, 0.0766, 0.0431, 0.0188, 0.1367,
        0.1480])
[rfa agg] iter:  1, prev_obj_val: 51.70978927612305, obj_val: 63.241554260253906, abs dis: 11.53176498413086
[rfa agg] iter: 1, weight: tensor([0.0258, 0.2281, 0.0656, 0.0393, 0.0862, 0.1901, 0.0310, 0.0227, 0.2480,
        0.0633])
[rfa agg] iter:  2, prev_obj_val: 63.241554260253906, obj_val: 59.90986251831055, abs dis: 3.3316917419433594
[rfa agg] iter: 2, weight: tensor([0.0375, 0.1967, 0.0698, 0.1374, 0.0805, 0.1808, 0.0431, 0.0584, 0.1283,
        0.0676])
[rfa agg] iter:  3, prev_obj_val: 59.90986251831055, obj_val: 59.90516662597656, abs dis: 0.004695892333984375
[rfa agg] iter: 3, weight: tensor([0.0332, 0.2361, 0.0657, 0.0945, 0.0775, 0.2121, 0.0385, 0.0441, 0.1347,
        0.0636])
[rfa agg] iter:  4, prev_obj_val: 59.90516662597656, obj_val: 63.22669982910156, abs dis: 3.321533203125
[rfa agg] iter: 4, weight: tensor([0.0330, 0.2378, 0.0654, 0.0933, 0.0769, 0.2140, 0.0383, 0.0438, 0.1342,
        0.0632])
[rfa agg] iter:  5, prev_obj_val: 63.22669982910156, obj_val: 59.9100227355957, abs dis: 3.3166770935058594
[rfa agg] iter: 5, weight: tensor([0.0375, 0.1964, 0.0696, 0.1391, 0.0803, 0.1811, 0.0430, 0.0583, 0.1272,
        0.0674])
[rfa agg] iter:  6, prev_obj_val: 59.9100227355957, obj_val: 59.90516662597656, abs dis: 0.004856109619140625
[rfa agg] iter: 6, weight: tensor([0.0332, 0.2361, 0.0657, 0.0945, 0.0775, 0.2121, 0.0385, 0.0441, 0.1347,
        0.0636])
[rfa agg] iter:  7, prev_obj_val: 59.90516662597656, obj_val: 63.22669982910156, abs dis: 3.321533203125
[rfa agg] iter: 7, weight: tensor([0.0330, 0.2378, 0.0654, 0.0933, 0.0769, 0.2140, 0.0383, 0.0438, 0.1342,
        0.0632])
[rfa agg] iter:  8, prev_obj_val: 63.22669982910156, obj_val: 59.9100227355957, abs dis: 3.3166770935058594
[rfa agg] iter: 8, weight: tensor([0.0375, 0.1964, 0.0696, 0.1391, 0.0803, 0.1811, 0.0430, 0.0583, 0.1272,
        0.0674])
[rfa agg] iter:  9, prev_obj_val: 59.9100227355957, obj_val: 59.90516662597656, abs dis: 0.004856109619140625
[rfa agg] iter: 9, weight: tensor([0.0332, 0.2361, 0.0657, 0.0945, 0.0775, 0.2121, 0.0385, 0.0441, 0.1347,
        0.0636])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3124, Accuracy: 143/10000 (1.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 4.7036, Accuracy: 207/9950 (2.0804%)
saving model
Done in 512.4303314685822 sec.
Saving all the graphs.
This run has a label: Jun.27_07.36.27. Visdom environment: tiny
