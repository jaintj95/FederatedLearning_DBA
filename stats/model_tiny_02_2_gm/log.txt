current path: saved_models/model_tiny_Jun.25_15.26.52
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [84, 86, 65, 96, 55, 56, 28, 93, 16, 79].
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 473/1190 (39.7479%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.9960, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 365/1003 (36.3908%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.5062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 372/1475 (25.2203%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 673/1475 (45.6271%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1457, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3431, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0574, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 504/1071 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2344, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3125, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 594/1581 (37.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7954, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   1, Avg loss: 0.0560, Accuracy: 384/1742 (22.0436%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 670/1742 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4295, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0660, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0364, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7972, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   2, Avg loss: 0.0836, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3232, Accuracy: 50/10000 (0.5000%)
time spent on training: 118.2097897529602
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1003, 1475, 311, 1071, 186, 1581, 1742, 708, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 86, 65, 96, 55, 56, 28, 93, 16, 79], weight: tensor([0.1257, 0.1060, 0.1559, 0.0329, 0.1132, 0.0197, 0.1671, 0.1841, 0.0748,
        0.0208])
[rfa agg] iter:  0, prev_obj_val: 53.86809539794922, obj_val: 56.588138580322266, abs dis: 2.720043182373047
[rfa agg] iter: 0, weight: tensor([0.2951, 0.1618, 0.0837, 0.0082, 0.2643, 0.0042, 0.0774, 0.0600, 0.0404,
        0.0048])
[rfa agg] iter:  1, prev_obj_val: 56.588138580322266, obj_val: 63.53443908691406, abs dis: 6.946300506591797
[rfa agg] iter: 1, weight: tensor([0.1632, 0.2341, 0.0615, 0.0076, 0.3795, 0.0038, 0.0580, 0.0466, 0.0412,
        0.0044])
[rfa agg] iter:  2, prev_obj_val: 63.53443908691406, obj_val: 66.44678497314453, abs dis: 2.9123458862304688
[rfa agg] iter: 2, weight: tensor([0.1152, 0.3986, 0.0605, 0.0102, 0.2285, 0.0051, 0.0582, 0.0489, 0.0689,
        0.0059])
[rfa agg] iter:  3, prev_obj_val: 66.44678497314453, obj_val: 60.7333869934082, abs dis: 5.713397979736328
[rfa agg] iter: 3, weight: tensor([0.1199, 0.3665, 0.0676, 0.0127, 0.2046, 0.0063, 0.0654, 0.0555, 0.0943,
        0.0073])
[rfa agg] iter:  4, prev_obj_val: 60.7333869934082, obj_val: 60.706878662109375, abs dis: 0.026508331298828125
[rfa agg] iter: 4, weight: tensor([0.1016, 0.4830, 0.0493, 0.0075, 0.2174, 0.0038, 0.0471, 0.0391, 0.0468,
        0.0044])
[rfa agg] iter:  5, prev_obj_val: 60.706878662109375, obj_val: 60.702301025390625, abs dis: 0.00457763671875
[rfa agg] iter: 5, weight: tensor([0.0932, 0.5254, 0.0454, 0.0069, 0.1993, 0.0035, 0.0434, 0.0360, 0.0430,
        0.0040])
[rfa agg] iter:  6, prev_obj_val: 60.702301025390625, obj_val: 63.46509552001953, abs dis: 2.7627944946289062
[rfa agg] iter: 6, weight: tensor([0.0891, 0.5483, 0.0435, 0.0066, 0.1882, 0.0033, 0.0415, 0.0344, 0.0411,
        0.0038])
[rfa agg] iter:  7, prev_obj_val: 63.46509552001953, obj_val: 63.4589729309082, abs dis: 0.006122589111328125
[rfa agg] iter: 7, weight: tensor([0.1013, 0.4815, 0.0536, 0.0091, 0.1890, 0.0045, 0.0515, 0.0433, 0.0610,
        0.0052])
[rfa agg] iter:  8, prev_obj_val: 63.4589729309082, obj_val: 66.45291137695312, abs dis: 2.993938446044922
[rfa agg] iter: 8, weight: tensor([0.1039, 0.4681, 0.0548, 0.0093, 0.1944, 0.0046, 0.0527, 0.0443, 0.0626,
        0.0053])
[rfa agg] iter:  9, prev_obj_val: 66.45291137695312, obj_val: 60.731658935546875, abs dis: 5.72125244140625
[rfa agg] iter: 9, weight: tensor([0.1188, 0.3734, 0.0671, 0.0126, 0.2013, 0.0062, 0.0648, 0.0551, 0.0935,
        0.0072])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3029, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.4585, Accuracy: 0/9950 (0.0000%)
saving model
Done in 218.27079844474792 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 99, 85, 29, 7, 20].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 364/1475 (24.6780%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 660/1475 (44.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8083, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7955, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0605, Accuracy: 359/1750 (20.5143%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0359, Accuracy: 657/1750 (37.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2824, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0793, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0427, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4152, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.3807, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0687, Accuracy: 165/773 (21.3454%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9449, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 435/1988 (21.8813%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 619/1988 (31.1368%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0724, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 408/1440 (28.3333%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 659/1440 (45.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8885, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 330/891 (37.0370%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 472/891 (52.9742%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0498, Accuracy: 53/10000 (0.5300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0558, Accuracy: 381/807 (47.2119%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.6717, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.94654965400696
[rfa agg] training data poison_ratio: 0.07502091661243841  data num: [1475, 631, 1750, 312, 690, 773, 1988, 1440, 891, 807]
[rfa agg] considering poison per batch poison_fraction: 0.023444036441387005
[rfa agg] init. name: [65, 48, 44, 24, 25, 99, 85, 29, 7, 20], weight: tensor([0.1371, 0.0587, 0.1627, 0.0290, 0.0641, 0.0719, 0.1848, 0.1339, 0.0828,
        0.0750])
[rfa agg] iter:  0, prev_obj_val: 70.62056732177734, obj_val: 70.60330963134766, abs dis: 0.0172576904296875
[rfa agg] iter: 0, weight: tensor([0.1805, 0.0436, 0.1209, 0.0138, 0.0537, 0.0799, 0.0952, 0.2197, 0.1096,
        0.0830])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3054, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3967, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.0754613876343 sec.
Server Epoch:3 choose agents : [76, 59, 8, 85, 95, 14, 4, 70, 94, 11].
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   1, Avg loss: 0.0898, Accuracy: 36/466 (7.7253%)
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   2, Avg loss: 0.0507, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.7531, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 472/1089 (43.3425%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4003, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 253/1513 (16.7217%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 495/1513 (32.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3921, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 445/1988 (22.3843%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 628/1988 (31.5895%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7612, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   1, Avg loss: 0.0533, Accuracy: 318/599 (53.0885%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3467, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 205/1013 (20.2369%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 351/1013 (34.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7347, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0626, Accuracy: 342/901 (37.9578%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0315, Accuracy: 417/901 (46.2819%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0573, Accuracy: 318/1418 (22.4260%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 591/1418 (41.6784%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6058, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0567, Accuracy: 335/1662 (20.1564%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 571/1662 (34.3562%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8930, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0518, Accuracy: 358/712 (50.2809%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8430, Accuracy: 50/10000 (0.5000%)
time spent on training: 142.10202836990356
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1089, 1513, 1988, 599, 1013, 901, 1418, 1662, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 59, 8, 85, 95, 14, 4, 70, 94, 11], weight: tensor([0.0410, 0.0959, 0.1332, 0.1750, 0.0527, 0.0892, 0.0793, 0.1248, 0.1463,
        0.0627])
[rfa agg] iter:  0, prev_obj_val: 59.40129470825195, obj_val: 63.998111724853516, abs dis: 4.5968170166015625
[rfa agg] iter: 0, weight: tensor([0.0170, 0.2850, 0.1194, 0.0613, 0.0267, 0.1295, 0.0882, 0.1376, 0.0946,
        0.0407])
[rfa agg] iter:  1, prev_obj_val: 63.998111724853516, obj_val: 65.58763122558594, abs dis: 1.5895195007324219
[rfa agg] iter: 1, weight: tensor([0.0172, 0.2670, 0.0714, 0.0441, 0.0283, 0.2509, 0.1352, 0.0776, 0.0612,
        0.0470])
[rfa agg] iter:  2, prev_obj_val: 65.58763122558594, obj_val: 72.0443115234375, abs dis: 6.4566802978515625
[rfa agg] iter: 2, weight: tensor([0.0168, 0.1892, 0.0615, 0.0394, 0.0281, 0.3399, 0.1575, 0.0661, 0.0535,
        0.0481])
[rfa agg] iter:  3, prev_obj_val: 72.0443115234375, obj_val: 74.72400665283203, abs dis: 2.6796951293945312
[rfa agg] iter: 3, weight: tensor([0.0204, 0.1061, 0.0517, 0.0361, 0.0365, 0.2614, 0.3154, 0.0543, 0.0466,
        0.0714])
[rfa agg] iter:  4, prev_obj_val: 74.72400665283203, obj_val: 74.71790313720703, abs dis: 0.006103515625
[rfa agg] iter: 4, weight: tensor([0.0236, 0.0980, 0.0526, 0.0376, 0.0435, 0.2011, 0.3498, 0.0549, 0.0478,
        0.0911])
[rfa agg] iter:  5, prev_obj_val: 74.71790313720703, obj_val: 74.71769714355469, abs dis: 0.00020599365234375
[rfa agg] iter: 5, weight: tensor([0.0233, 0.0967, 0.0519, 0.0372, 0.0430, 0.1953, 0.3611, 0.0542, 0.0472,
        0.0901])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3155, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.4929, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.68347072601318 sec.
Server Epoch:4 choose agents : [21, 65, 32, 76, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0550, Accuracy: 394/1949 (20.2155%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 641/1949 (32.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.7907, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 371/1475 (25.1525%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 641/1475 (43.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9529, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0623, Accuracy: 169/735 (22.9932%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 328/735 (44.6259%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.3292, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0889, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0512, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8629, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0546, Accuracy: 331/891 (37.1493%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4586, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0813, Accuracy: 16/312 (5.1282%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0435, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.5958, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 320/719 (44.5063%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5930, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0600, Accuracy: 253/636 (39.7799%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0326, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6197, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0587, Accuracy: 294/1645 (17.8723%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 585/1645 (35.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2732, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 188/953 (19.7272%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 324/953 (33.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7432, Accuracy: 58/10000 (0.5800%)
time spent on training: 135.24287056922913
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 466, 891, 312, 719, 636, 1645, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 65, 32, 76, 7, 24, 41, 52, 13, 64], weight: tensor([0.1993, 0.1508, 0.0751, 0.0476, 0.0911, 0.0319, 0.0735, 0.0650, 0.1682,
        0.0974])
[rfa agg] iter:  0, prev_obj_val: 70.8794937133789, obj_val: 72.20198822021484, abs dis: 1.3224945068359375
[rfa agg] iter: 0, weight: tensor([0.0818, 0.1224, 0.0853, 0.0303, 0.1676, 0.0152, 0.0833, 0.0531, 0.1069,
        0.2540])
[rfa agg] iter:  1, prev_obj_val: 72.20198822021484, obj_val: 77.73877716064453, abs dis: 5.5367889404296875
[rfa agg] iter: 1, weight: tensor([0.0396, 0.0529, 0.0769, 0.0215, 0.2236, 0.0100, 0.0747, 0.0409, 0.0484,
        0.4116])
[rfa agg] iter:  2, prev_obj_val: 77.73877716064453, obj_val: 79.59162902832031, abs dis: 1.8528518676757812
[rfa agg] iter: 2, weight: tensor([0.0369, 0.0455, 0.1888, 0.0313, 0.2369, 0.0131, 0.1785, 0.0697, 0.0431,
        0.1562])
[rfa agg] iter:  3, prev_obj_val: 79.59162902832031, obj_val: 84.52003479003906, abs dis: 4.92840576171875
[rfa agg] iter: 3, weight: tensor([0.0324, 0.0393, 0.2570, 0.0313, 0.1624, 0.0126, 0.2416, 0.0748, 0.0374,
        0.1113])
[rfa agg] iter:  4, prev_obj_val: 84.52003479003906, obj_val: 90.7092056274414, abs dis: 6.189170837402344
[rfa agg] iter: 4, weight: tensor([0.0308, 0.0363, 0.2797, 0.0400, 0.1039, 0.0145, 0.2621, 0.1162, 0.0349,
        0.0815])
[rfa agg] iter:  5, prev_obj_val: 90.7092056274414, obj_val: 81.86412811279297, abs dis: 8.845077514648438
[rfa agg] iter: 5, weight: tensor([0.0366, 0.0420, 0.1755, 0.0682, 0.0950, 0.0213, 0.1698, 0.2707, 0.0409,
        0.0801])
[rfa agg] iter:  6, prev_obj_val: 81.86412811279297, obj_val: 87.54242706298828, abs dis: 5.6782989501953125
[rfa agg] iter: 6, weight: tensor([0.0291, 0.0347, 0.2957, 0.0325, 0.1154, 0.0125, 0.2737, 0.0866, 0.0333,
        0.0864])
[rfa agg] iter:  7, prev_obj_val: 87.54242706298828, obj_val: 87.52613067626953, abs dis: 0.01629638671875
[rfa agg] iter: 7, weight: tensor([0.0351, 0.0407, 0.2278, 0.0539, 0.1023, 0.0183, 0.2180, 0.1806, 0.0394,
        0.0838])
[rfa agg] iter:  8, prev_obj_val: 87.52613067626953, obj_val: 87.52600860595703, abs dis: 0.0001220703125
[rfa agg] iter: 8, weight: tensor([0.0352, 0.0408, 0.2226, 0.0542, 0.1027, 0.0183, 0.2135, 0.1893, 0.0395,
        0.0839])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3387, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.2836, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.59950399398804 sec.
Server Epoch:5 choose agents : [62, 97, 55, 2, 52, 21, 47, 93, 91, 83].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 132/568 (23.2394%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.2841, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0491, Accuracy: 349/1213 (28.7716%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0264, Accuracy: 510/1213 (42.0445%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0745, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 244/1071 (22.7824%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2519, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 198/605 (32.7273%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0427, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.3527, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0617, Accuracy: 243/636 (38.2075%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0324, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.6891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0546, Accuracy: 395/1949 (20.2668%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 641/1949 (32.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.4726, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1270, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1133, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3663, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   1, Avg loss: 0.0558, Accuracy: 382/1742 (21.9288%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 717/1742 (41.1596%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3583, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 348/1030 (33.7864%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0281, Accuracy: 584/1030 (56.6990%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5535, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 416/1953 (21.3006%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 763/1953 (39.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6594, Accuracy: 122/10000 (1.2200%)
time spent on training: 138.67513751983643
[rfa agg] training data poison_ratio: 0.0  data num: [568, 1213, 1071, 605, 636, 1949, 134, 1742, 1030, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 97, 55, 2, 52, 21, 47, 93, 91, 83], weight: tensor([0.0521, 0.1113, 0.0982, 0.0555, 0.0583, 0.1788, 0.0123, 0.1598, 0.0945,
        0.1792])
[rfa agg] iter:  0, prev_obj_val: 70.67424011230469, obj_val: 73.01228332519531, abs dis: 2.338043212890625
[rfa agg] iter: 0, weight: tensor([0.0258, 0.2852, 0.1422, 0.0299, 0.0315, 0.1056, 0.0040, 0.1342, 0.1356,
        0.1061])
[rfa agg] iter:  1, prev_obj_val: 73.01228332519531, obj_val: 75.53548431396484, abs dis: 2.5232009887695312
[rfa agg] iter: 1, weight: tensor([0.0199, 0.3770, 0.1999, 0.0236, 0.0249, 0.0518, 0.0029, 0.0608, 0.1873,
        0.0520])
[rfa agg] iter:  2, prev_obj_val: 75.53548431396484, obj_val: 79.33208465576172, abs dis: 3.796600341796875
[rfa agg] iter: 2, weight: tensor([0.0203, 0.2154, 0.2982, 0.0244, 0.0257, 0.0438, 0.0028, 0.0503, 0.2752,
        0.0440])
[rfa agg] iter:  3, prev_obj_val: 79.33208465576172, obj_val: 81.86138153076172, abs dis: 2.529296875
[rfa agg] iter: 3, weight: tensor([0.0231, 0.1370, 0.3416, 0.0283, 0.0298, 0.0411, 0.0030, 0.0462, 0.3087,
        0.0412])
[rfa agg] iter:  4, prev_obj_val: 81.86138153076172, obj_val: 87.33255004882812, abs dis: 5.471168518066406
[rfa agg] iter: 4, weight: tensor([0.0297, 0.1389, 0.3142, 0.0368, 0.0387, 0.0478, 0.0037, 0.0533, 0.2889,
        0.0480])
[rfa agg] iter:  5, prev_obj_val: 87.33255004882812, obj_val: 81.86906433105469, abs dis: 5.4634857177734375
[rfa agg] iter: 5, weight: tensor([0.0471, 0.1465, 0.2510, 0.0598, 0.0631, 0.0610, 0.0055, 0.0671, 0.2376,
        0.0613])
[rfa agg] iter:  6, prev_obj_val: 81.86906433105469, obj_val: 79.316650390625, abs dis: 2.5524139404296875
[rfa agg] iter: 6, weight: tensor([0.0303, 0.1420, 0.3104, 0.0375, 0.0394, 0.0486, 0.0038, 0.0542, 0.2851,
        0.0487])
[rfa agg] iter:  7, prev_obj_val: 79.316650390625, obj_val: 81.86195373535156, abs dis: 2.5453033447265625
[rfa agg] iter: 7, weight: tensor([0.0228, 0.1331, 0.3482, 0.0279, 0.0294, 0.0405, 0.0030, 0.0456, 0.3091,
        0.0406])
[rfa agg] iter:  8, prev_obj_val: 81.86195373535156, obj_val: 87.33259582519531, abs dis: 5.47064208984375
[rfa agg] iter: 8, weight: tensor([0.0297, 0.1387, 0.3150, 0.0367, 0.0387, 0.0477, 0.0037, 0.0533, 0.2885,
        0.0479])
[rfa agg] iter:  9, prev_obj_val: 87.33259582519531, obj_val: 81.86907196044922, abs dis: 5.463523864746094
[rfa agg] iter: 9, weight: tensor([0.0471, 0.1465, 0.2511, 0.0598, 0.0631, 0.0610, 0.0055, 0.0671, 0.2376,
        0.0613])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3966, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.5424, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.4465615749359 sec.
Server Epoch:6 choose agents : [42, 85, 94, 95, 56, 86, 53, 33, 44, 96].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0553, Accuracy: 265/1372 (19.3149%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 524/1372 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2278, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0557, Accuracy: 396/1988 (19.9195%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 692/1988 (34.8089%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4187, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/1662 (20.7581%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 565/1662 (33.9952%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0469, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 301/599 (50.2504%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.1311, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0823, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 49/186 (26.3441%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4200, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0655, Accuracy: 331/1003 (33.0010%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0355, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0547, Accuracy: 225/813 (27.6753%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.6246, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0840, Accuracy: 35/515 (6.7961%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0548, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1394, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0604, Accuracy: 351/1750 (20.0571%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0360, Accuracy: 627/1750 (35.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6319, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0776, Accuracy: 22/311 (7.0740%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0522, Accuracy: 132/311 (42.4437%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5956, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.7327184677124
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1988, 1662, 599, 186, 1003, 813, 515, 1750, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 85, 94, 95, 56, 86, 53, 33, 44, 96], weight: tensor([0.1345, 0.1949, 0.1630, 0.0587, 0.0182, 0.0983, 0.0797, 0.0505, 0.1716,
        0.0305])
[rfa agg] iter:  0, prev_obj_val: 70.91983032226562, obj_val: 70.84607696533203, abs dis: 0.07375335693359375
[rfa agg] iter: 0, weight: tensor([0.3439, 0.0940, 0.1550, 0.0340, 0.0062, 0.1395, 0.0657, 0.0266, 0.1234,
        0.0117])
[rfa agg] iter:  1, prev_obj_val: 70.84607696533203, obj_val: 73.71368408203125, abs dis: 2.8676071166992188
[rfa agg] iter: 1, weight: tensor([0.3559, 0.0922, 0.1523, 0.0334, 0.0061, 0.1370, 0.0645, 0.0261, 0.1210,
        0.0115])
[rfa agg] iter:  2, prev_obj_val: 73.71368408203125, obj_val: 75.15580749511719, abs dis: 1.4421234130859375
[rfa agg] iter: 2, weight: tensor([0.2719, 0.0935, 0.1441, 0.0407, 0.0071, 0.1967, 0.0824, 0.0315, 0.1184,
        0.0136])
[rfa agg] iter:  3, prev_obj_val: 75.15580749511719, obj_val: 75.15347290039062, abs dis: 0.0023345947265625
[rfa agg] iter: 3, weight: tensor([0.2354, 0.0908, 0.1357, 0.0434, 0.0073, 0.2360, 0.0905, 0.0334, 0.1132,
        0.0142])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5395, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.2785, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.07428526878357 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 80, 84, 10, 91].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4185, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1269, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4252, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0832, Accuracy: 43/515 (8.3495%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0545, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1601, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0800, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0437, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.8410, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0595, Accuracy: 313/1418 (22.0733%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 628/1418 (44.2877%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.6025, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0534, Accuracy: 224/813 (27.5523%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 10.3150, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   1, Avg loss: 0.0718, Accuracy: 121/682 (17.7419%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   2, Avg loss: 0.0393, Accuracy: 238/682 (34.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3499, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   1, Avg loss: 0.0651, Accuracy: 303/1190 (25.4622%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   2, Avg loss: 0.0340, Accuracy: 417/1190 (35.0420%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.6125, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0615, Accuracy: 169/861 (19.6283%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 439/861 (50.9872%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.6589, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   1, Avg loss: 0.0493, Accuracy: 353/1030 (34.2718%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 617/1030 (59.9029%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.6008, Accuracy: 105/10000 (1.0500%)
time spent on training: 128.46480894088745
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 682, 1190, 861, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 61, 33, 24, 70, 53, 80, 84, 10, 91], weight: tensor([0.1343, 0.0107, 0.0646, 0.0391, 0.1778, 0.1019, 0.0855, 0.1492, 0.1079,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 40.348114013671875, obj_val: 45.99204635620117, abs dis: 5.643932342529297
[rfa agg] iter: 0, weight: tensor([0.1081, 0.0022, 0.0327, 0.0110, 0.0503, 0.2040, 0.0702, 0.0752, 0.3412,
        0.1053])
[rfa agg] iter:  1, prev_obj_val: 45.99204635620117, obj_val: 48.5247688293457, abs dis: 2.5327224731445312
[rfa agg] iter: 1, weight: tensor([0.0812, 0.0027, 0.0501, 0.0143, 0.0471, 0.3374, 0.1370, 0.0635, 0.1881,
        0.0785])
[rfa agg] iter:  2, prev_obj_val: 48.5247688293457, obj_val: 48.513763427734375, abs dis: 0.011005401611328125
[rfa agg] iter: 2, weight: tensor([0.0814, 0.0032, 0.0644, 0.0170, 0.0498, 0.2767, 0.2055, 0.0655, 0.1581,
        0.0786])
[rfa agg] iter:  3, prev_obj_val: 48.513763427734375, obj_val: 48.51365661621094, abs dis: 0.0001068115234375
[rfa agg] iter: 3, weight: tensor([0.0814, 0.0032, 0.0645, 0.0170, 0.0498, 0.2702, 0.2129, 0.0654, 0.1572,
        0.0785])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7950, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.1984, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.2629783153534 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 375/1475 (25.4237%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 549/1475 (37.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4874, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0842, Accuracy: 13/312 (4.1667%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0464, Accuracy: 155/312 (49.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8569, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0598, Accuracy: 292/1645 (17.7508%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 608/1645 (36.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5067, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 258/928 (27.8017%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 580/928 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2129, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0549, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0295, Accuracy: 449/1089 (41.2305%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.0099, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0499, Accuracy: 399/1440 (27.7083%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 687/1440 (47.7083%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.9718, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0576, Accuracy: 397/1904 (20.8508%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 680/1904 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.4762, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 361/1574 (22.9352%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 645/1574 (40.9784%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5837, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0904, Accuracy: 5/338 (1.4793%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9392, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 247/888 (27.8153%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5980, Accuracy: 59/10000 (0.5900%)
time spent on training: 141.2398419380188
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 24, 13, 1, 59, 29, 46, 17, 12, 63], weight: tensor([0.1272, 0.0269, 0.1419, 0.0800, 0.0939, 0.1242, 0.1642, 0.1358, 0.0292,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 54.424495697021484, obj_val: 56.13935470581055, abs dis: 1.7148590087890625
[rfa agg] iter: 0, weight: tensor([0.1482, 0.0087, 0.1136, 0.0761, 0.1832, 0.1888, 0.0798, 0.1299, 0.0101,
        0.0615])
[rfa agg] iter:  1, prev_obj_val: 56.13935470581055, obj_val: 57.945674896240234, abs dis: 1.8063201904296875
[rfa agg] iter: 1, weight: tensor([0.1342, 0.0091, 0.1057, 0.0843, 0.2267, 0.1665, 0.0764, 0.1192, 0.0106,
        0.0673])
[rfa agg] iter:  2, prev_obj_val: 57.945674896240234, obj_val: 57.93701171875, abs dis: 0.008663177490234375
[rfa agg] iter: 2, weight: tensor([0.1193, 0.0092, 0.0965, 0.0922, 0.2761, 0.1442, 0.0717, 0.1076, 0.0108,
        0.0724])
[rfa agg] iter:  3, prev_obj_val: 57.93701171875, obj_val: 57.93677520751953, abs dis: 0.00023651123046875
[rfa agg] iter: 3, weight: tensor([0.1179, 0.0091, 0.0955, 0.0911, 0.2847, 0.1421, 0.0709, 0.1063, 0.0106,
        0.0716])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2639, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 6.0946, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.87293100357056 sec.
Server Epoch:9 choose agents : [38, 85, 61, 13, 88, 99, 52, 77, 37, 93].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0632, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7414, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   1, Avg loss: 0.0559, Accuracy: 412/1988 (20.7243%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 650/1988 (32.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3591, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1308, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1247, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.5187, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0601, Accuracy: 296/1645 (17.9939%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 610/1645 (37.0821%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5432, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   1, Avg loss: 0.0801, Accuracy: 99/603 (16.4179%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4814, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 173/773 (22.3803%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2265, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0599, Accuracy: 237/636 (37.2642%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0569, Accuracy: 305/1340 (22.7612%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5218, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0556, Accuracy: 366/1129 (32.4181%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0267, Accuracy: 681/1129 (60.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9418, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0564, Accuracy: 384/1742 (22.0436%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 683/1742 (39.2078%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2402, Accuracy: 80/10000 (0.8000%)
time spent on training: 140.1105136871338
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 1988, 85, 1645, 603, 773, 636, 1340, 1129, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 85, 61, 13, 88, 99, 52, 77, 37, 93], weight: tensor([0.1021, 0.1796, 0.0077, 0.1486, 0.0545, 0.0698, 0.0574, 0.1210, 0.1020,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 60.604454040527344, obj_val: 62.51719665527344, abs dis: 1.9127426147460938
[rfa agg] iter: 0, weight: tensor([0.1779, 0.0603, 0.0017, 0.0985, 0.0220, 0.0401, 0.0232, 0.3162, 0.1810,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 62.51719665527344, obj_val: 63.72808837890625, abs dis: 1.2108917236328125
[rfa agg] iter: 1, weight: tensor([0.2510, 0.0511, 0.0016, 0.0778, 0.0224, 0.0428, 0.0236, 0.2047, 0.2604,
        0.0645])
[rfa agg] iter:  2, prev_obj_val: 63.72808837890625, obj_val: 65.29841613769531, abs dis: 1.5703277587890625
[rfa agg] iter: 2, weight: tensor([0.2929, 0.0438, 0.0015, 0.0648, 0.0211, 0.0414, 0.0222, 0.1472, 0.3106,
        0.0544])
[rfa agg] iter:  3, prev_obj_val: 65.29841613769531, obj_val: 69.74038696289062, abs dis: 4.4419708251953125
[rfa agg] iter: 3, weight: tensor([0.3138, 0.0392, 0.0014, 0.0564, 0.0208, 0.0421, 0.0219, 0.1156, 0.3408,
        0.0480])
[rfa agg] iter:  4, prev_obj_val: 69.74038696289062, obj_val: 69.73555755615234, abs dis: 0.00482940673828125
[rfa agg] iter: 4, weight: tensor([0.2872, 0.0470, 0.0020, 0.0645, 0.0304, 0.0666, 0.0320, 0.1142, 0.3001,
        0.0561])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6019, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.7349, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.11564755439758 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 89, 31, 57, 97, 99, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0658, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0378, Accuracy: 378/1241 (30.4593%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8558, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0585, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 401/1154 (34.7487%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.9914, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0805, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0650, Accuracy: 56/186 (30.1075%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5569, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0615, Accuracy: 334/1750 (19.0857%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 606/1750 (34.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7369, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   1, Avg loss: 0.0624, Accuracy: 300/896 (33.4821%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   2, Avg loss: 0.0363, Accuracy: 423/896 (47.2098%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5951, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0854, Accuracy: 49/460 (10.6522%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0418, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5708, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0551, Accuracy: 291/1154 (25.2166%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 469/1154 (40.6412%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.4287, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   1, Avg loss: 0.0502, Accuracy: 343/1213 (28.2770%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 512/1213 (42.2094%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6009, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 172/773 (22.2510%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 399/773 (51.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3085, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0586, Accuracy: 374/1956 (19.1207%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 604/1956 (30.8793%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2835, Accuracy: 87/10000 (0.8700%)
time spent on training: 135.82476592063904
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1154, 186, 1750, 896, 460, 1154, 1213, 773, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 15, 56, 44, 89, 31, 57, 97, 99, 6], weight: tensor([0.1151, 0.1070, 0.0172, 0.1623, 0.0831, 0.0427, 0.1070, 0.1125, 0.0717,
        0.1814])
[rfa agg] iter:  0, prev_obj_val: 51.99468994140625, obj_val: 55.403343200683594, abs dis: 3.4086532592773438
[rfa agg] iter: 0, weight: tensor([0.2386, 0.1982, 0.0026, 0.0480, 0.0378, 0.0094, 0.1871, 0.2107, 0.0277,
        0.0399])
[rfa agg] iter:  1, prev_obj_val: 55.403343200683594, obj_val: 57.49613952636719, abs dis: 2.0927963256835938
[rfa agg] iter: 1, weight: tensor([0.1569, 0.2110, 0.0034, 0.0488, 0.0607, 0.0129, 0.2033, 0.2183, 0.0424,
        0.0422])
[rfa agg] iter:  2, prev_obj_val: 57.49613952636719, obj_val: 59.775245666503906, abs dis: 2.2791061401367188
[rfa agg] iter: 2, weight: tensor([0.1481, 0.1985, 0.0041, 0.0537, 0.0791, 0.0156, 0.1937, 0.2061, 0.0541,
        0.0469])
[rfa agg] iter:  3, prev_obj_val: 59.775245666503906, obj_val: 62.154720306396484, abs dis: 2.379474639892578
[rfa agg] iter: 3, weight: tensor([0.1427, 0.1829, 0.0048, 0.0579, 0.1027, 0.0186, 0.1802, 0.1911, 0.0681,
        0.0510])
[rfa agg] iter:  4, prev_obj_val: 62.154720306396484, obj_val: 59.77568817138672, abs dis: 2.3790321350097656
[rfa agg] iter: 4, weight: tensor([0.1356, 0.1670, 0.0054, 0.0604, 0.1318, 0.0215, 0.1653, 0.1751, 0.0842,
        0.0538])
[rfa agg] iter:  5, prev_obj_val: 59.77568817138672, obj_val: 62.15445327758789, abs dis: 2.378765106201172
[rfa agg] iter: 5, weight: tensor([0.1431, 0.1817, 0.0048, 0.0580, 0.1039, 0.0186, 0.1793, 0.1909, 0.0686,
        0.0511])
[rfa agg] iter:  6, prev_obj_val: 62.15445327758789, obj_val: 59.77569580078125, abs dis: 2.3787574768066406
[rfa agg] iter: 6, weight: tensor([0.1356, 0.1669, 0.0054, 0.0604, 0.1318, 0.0215, 0.1653, 0.1751, 0.0842,
        0.0538])
[rfa agg] iter:  7, prev_obj_val: 59.77569580078125, obj_val: 62.15445327758789, abs dis: 2.3787574768066406
[rfa agg] iter: 7, weight: tensor([0.1431, 0.1817, 0.0048, 0.0580, 0.1039, 0.0186, 0.1793, 0.1909, 0.0686,
        0.0511])
[rfa agg] iter:  8, prev_obj_val: 62.15445327758789, obj_val: 59.77569580078125, abs dis: 2.3787574768066406
[rfa agg] iter: 8, weight: tensor([0.1356, 0.1669, 0.0054, 0.0604, 0.1318, 0.0215, 0.1653, 0.1751, 0.0842,
        0.0538])
[rfa agg] iter:  9, prev_obj_val: 59.77569580078125, obj_val: 62.15445327758789, abs dis: 2.3787574768066406
[rfa agg] iter: 9, weight: tensor([0.1431, 0.1817, 0.0048, 0.0580, 0.1039, 0.0186, 0.1793, 0.1909, 0.0686,
        0.0511])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1611, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6295, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.17201781272888 sec.
Server Epoch:11 choose agents : [25, 79, 30, 6, 93, 12, 88, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0518, Accuracy: 342/690 (49.5652%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1854, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   1, Avg loss: 0.1066, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   2, Avg loss: 0.0880, Accuracy: 35/197 (17.7665%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.5863, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0814, Accuracy: 58/486 (11.9342%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1944, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0575, Accuracy: 359/1956 (18.3538%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 672/1956 (34.3558%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9039, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0578, Accuracy: 403/1742 (23.1343%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 671/1742 (38.5189%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3656, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0937, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0532, Accuracy: 126/338 (37.2781%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.2515, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   1, Avg loss: 0.0815, Accuracy: 83/603 (13.7645%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   2, Avg loss: 0.0479, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8105, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 306/712 (42.9775%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0273, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5587, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0546, Accuracy: 412/1587 (25.9609%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 620/1587 (39.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4781, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 211/1013 (20.8292%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 310/1013 (30.6022%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2506, Accuracy: 73/10000 (0.7300%)
time spent on training: 130.8774425983429
[rfa agg] training data poison_ratio: 0.0  data num: [690, 197, 486, 1956, 1742, 338, 603, 712, 1587, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 79, 30, 6, 93, 12, 88, 11, 27, 14], weight: tensor([0.0740, 0.0211, 0.0521, 0.2098, 0.1868, 0.0363, 0.0647, 0.0764, 0.1702,
        0.1086])
[rfa agg] iter:  0, prev_obj_val: 78.61522674560547, obj_val: 79.82805633544922, abs dis: 1.21282958984375
[rfa agg] iter: 0, weight: tensor([0.0701, 0.0103, 0.0354, 0.1194, 0.1393, 0.0206, 0.0541, 0.0832, 0.1843,
        0.2833])
[rfa agg] iter:  1, prev_obj_val: 79.82805633544922, obj_val: 81.219970703125, abs dis: 1.3919143676757812
[rfa agg] iter: 1, weight: tensor([0.0698, 0.0095, 0.0338, 0.0957, 0.1092, 0.0194, 0.0530, 0.0849, 0.1391,
        0.3855])
[rfa agg] iter:  2, prev_obj_val: 81.219970703125, obj_val: 83.3479995727539, abs dis: 2.1280288696289062
[rfa agg] iter: 2, weight: tensor([0.0601, 0.0075, 0.0276, 0.0652, 0.0730, 0.0155, 0.0446, 0.0753, 0.0899,
        0.5412])
[rfa agg] iter:  3, prev_obj_val: 83.3479995727539, obj_val: 86.40350341796875, abs dis: 3.0555038452148438
[rfa agg] iter: 3, weight: tensor([0.0639, 0.0072, 0.0273, 0.0536, 0.0590, 0.0150, 0.0460, 0.0833, 0.0707,
        0.5740])
[rfa agg] iter:  4, prev_obj_val: 86.40350341796875, obj_val: 86.34381103515625, abs dis: 0.0596923828125
[rfa agg] iter: 4, weight: tensor([0.1082, 0.0104, 0.0421, 0.0675, 0.0733, 0.0224, 0.0746, 0.1504, 0.0858,
        0.3652])
[rfa agg] iter:  5, prev_obj_val: 86.34381103515625, obj_val: 86.34344482421875, abs dis: 0.0003662109375
[rfa agg] iter: 5, weight: tensor([0.1112, 0.0106, 0.0430, 0.0686, 0.0745, 0.0228, 0.0764, 0.1565, 0.0873,
        0.3491])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0398, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 6.4342, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.7837691307068 sec.
Server Epoch:12 choose agents : [37, 81, 94, 32, 34, 87, 63, 99, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 407/1129 (36.0496%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0257, Accuracy: 705/1129 (62.4446%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4798, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   1, Avg loss: 0.0724, Accuracy: 172/774 (22.2222%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   2, Avg loss: 0.0370, Accuracy: 331/774 (42.7649%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3540, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0564, Accuracy: 375/1662 (22.5632%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0348, Accuracy: 540/1662 (32.4910%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2366, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0660, Accuracy: 144/735 (19.5918%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.7363, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0656, Accuracy: 338/1427 (23.6861%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0343, Accuracy: 572/1427 (40.0841%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8985, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   1, Avg loss: 0.0623, Accuracy: 260/1131 (22.9885%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   2, Avg loss: 0.0333, Accuracy: 363/1131 (32.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.8549, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 237/888 (26.6892%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 409/888 (46.0586%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.2897, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 176/773 (22.7684%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 388/773 (50.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4689, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0505, Accuracy: 422/1470 (28.7075%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 787/1470 (53.5374%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.4446, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0610, Accuracy: 213/1013 (21.0267%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 328/1013 (32.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5051, Accuracy: 72/10000 (0.7200%)
time spent on training: 139.57104420661926
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 774, 1662, 735, 1427, 1131, 888, 773, 1470, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 81, 94, 32, 34, 87, 63, 99, 22, 14], weight: tensor([0.1026, 0.0704, 0.1511, 0.0668, 0.1297, 0.1028, 0.0807, 0.0703, 0.1336,
        0.0921])
[rfa agg] iter:  0, prev_obj_val: 45.262123107910156, obj_val: 48.90076446533203, abs dis: 3.638641357421875
[rfa agg] iter: 0, weight: tensor([0.1162, 0.0837, 0.0460, 0.0593, 0.0550, 0.1202, 0.1390, 0.0822, 0.0567,
        0.2417])
[rfa agg] iter:  1, prev_obj_val: 48.90076446533203, obj_val: 48.863101959228516, abs dis: 0.037662506103515625
[rfa agg] iter: 1, weight: tensor([0.0843, 0.1196, 0.0401, 0.0769, 0.0464, 0.0858, 0.2230, 0.1147, 0.0478,
        0.1614])
[rfa agg] iter:  2, prev_obj_val: 48.863101959228516, obj_val: 53.622833251953125, abs dis: 4.759731292724609
[rfa agg] iter: 2, weight: tensor([0.0822, 0.1184, 0.0393, 0.0757, 0.0455, 0.0839, 0.2395, 0.1147, 0.0468,
        0.1540])
[rfa agg] iter:  3, prev_obj_val: 53.622833251953125, obj_val: 56.540035247802734, abs dis: 2.9172019958496094
[rfa agg] iter: 3, weight: tensor([0.0607, 0.1775, 0.0334, 0.1059, 0.0376, 0.0614, 0.2248, 0.1650, 0.0388,
        0.0950])
[rfa agg] iter:  4, prev_obj_val: 56.540035247802734, obj_val: 67.70543670654297, abs dis: 11.165401458740234
[rfa agg] iter: 4, weight: tensor([0.0545, 0.2097, 0.0319, 0.1381, 0.0355, 0.0552, 0.1672, 0.1918, 0.0366,
        0.0797])
[rfa agg] iter:  5, prev_obj_val: 67.70543670654297, obj_val: 53.64621353149414, abs dis: 14.059223175048828
[rfa agg] iter: 5, weight: tensor([0.0591, 0.1546, 0.0397, 0.2583, 0.0429, 0.0595, 0.1156, 0.1499, 0.0442,
        0.0761])
[rfa agg] iter:  6, prev_obj_val: 53.64621353149414, obj_val: 59.90902328491211, abs dis: 6.262809753417969
[rfa agg] iter: 6, weight: tensor([0.0611, 0.1867, 0.0337, 0.1123, 0.0379, 0.0620, 0.2017, 0.1711, 0.0391,
        0.0944])
[rfa agg] iter:  7, prev_obj_val: 59.90902328491211, obj_val: 67.68997955322266, abs dis: 7.780956268310547
[rfa agg] iter: 7, weight: tensor([0.0532, 0.1990, 0.0327, 0.1947, 0.0361, 0.0537, 0.1355, 0.1841, 0.0372,
        0.0739])
[rfa agg] iter:  8, prev_obj_val: 67.68997955322266, obj_val: 56.56101989746094, abs dis: 11.128959655761719
[rfa agg] iter: 8, weight: tensor([0.0584, 0.1526, 0.0392, 0.2683, 0.0424, 0.0589, 0.1137, 0.1476, 0.0437,
        0.0752])
[rfa agg] iter:  9, prev_obj_val: 56.56101989746094, obj_val: 63.647491455078125, abs dis: 7.0864715576171875
[rfa agg] iter: 9, weight: tensor([0.0549, 0.2093, 0.0321, 0.1506, 0.0357, 0.0556, 0.1579, 0.1874, 0.0368,
        0.0799])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5707, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 7.6467, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.1043257713318 sec.
Server Epoch:13 choose agents : [36, 76, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0881, Accuracy: 22/408 (5.3922%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0541, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.5109, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0905, Accuracy: 19/466 (4.0773%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0524, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.6639, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0683, Accuracy: 132/818 (16.1369%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 332/818 (40.5868%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1587, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0561, Accuracy: 306/1154 (26.5165%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.4139, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0838, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 48/186 (25.8065%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7335, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0619, Accuracy: 286/891 (32.0988%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0287, Accuracy: 451/891 (50.6173%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1195, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0540, Accuracy: 339/1574 (21.5375%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 618/1574 (39.2630%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7611, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 213/1049 (20.3051%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 508/1049 (48.4271%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4199, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1293, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1138, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7187, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0832, Accuracy: 6/312 (1.9231%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0459, Accuracy: 151/312 (48.3974%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9145, Accuracy: 50/10000 (0.5000%)
time spent on training: 127.01488161087036
[rfa agg] training data poison_ratio: 0.0  data num: [408, 466, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 76, 71, 15, 56, 7, 17, 51, 47, 24], weight: tensor([0.0584, 0.0666, 0.1170, 0.1650, 0.0266, 0.1274, 0.2251, 0.1500, 0.0192,
        0.0446])
[rfa agg] iter:  0, prev_obj_val: 51.809234619140625, obj_val: 55.250125885009766, abs dis: 3.4408912658691406
[rfa agg] iter: 0, weight: tensor([0.0246, 0.0324, 0.2111, 0.1122, 0.0072, 0.3547, 0.0681, 0.1698, 0.0052,
        0.0148])
[rfa agg] iter:  1, prev_obj_val: 55.250125885009766, obj_val: 57.22574996948242, abs dis: 1.9756240844726562
[rfa agg] iter: 1, weight: tensor([0.0271, 0.0371, 0.3866, 0.0765, 0.0072, 0.2895, 0.0532, 0.1022, 0.0052,
        0.0154])
[rfa agg] iter:  2, prev_obj_val: 57.22574996948242, obj_val: 59.5549201965332, abs dis: 2.3291702270507812
[rfa agg] iter: 2, weight: tensor([0.0320, 0.0445, 0.4326, 0.0768, 0.0082, 0.2281, 0.0553, 0.0988, 0.0059,
        0.0178])
[rfa agg] iter:  3, prev_obj_val: 59.5549201965332, obj_val: 59.54884719848633, abs dis: 0.006072998046875
[rfa agg] iter: 3, weight: tensor([0.0426, 0.0606, 0.3769, 0.0871, 0.0105, 0.2175, 0.0649, 0.1091, 0.0076,
        0.0231])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9401, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 7.0175, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.4567883014679 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 83, 61, 84, 99].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0615, Accuracy: 292/1418 (20.5924%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 617/1418 (43.5120%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2193, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0581, Accuracy: 393/1475 (26.6441%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 622/1475 (42.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9884, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 231/1402 (16.4765%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 375/1402 (26.7475%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7253, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 124/568 (21.8310%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8693, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0650, Accuracy: 327/1427 (22.9152%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0342, Accuracy: 593/1427 (41.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9744, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 125/818 (15.2812%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7474, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 434/1953 (22.2222%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 744/1953 (38.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3897, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1309, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8198, Accuracy: 34/10000 (0.3400%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8700, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   1, Avg loss: 0.0634, Accuracy: 196/773 (25.3558%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   2, Avg loss: 0.0284, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6728, Accuracy: 71/10000 (0.7100%)
time spent on training: 148.40342593193054
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1475, 1402, 568, 1427, 818, 1953, 85, 1190, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 65, 66, 62, 34, 71, 83, 61, 84, 99], weight: tensor([0.1276, 0.1328, 0.1262, 0.0511, 0.1285, 0.0736, 0.1758, 0.0077, 0.1071,
        0.0696])
[rfa agg] iter:  0, prev_obj_val: 55.665069580078125, obj_val: 55.48830032348633, abs dis: 0.17676925659179688
[rfa agg] iter: 0, weight: tensor([0.1167, 0.0999, 0.1461, 0.0230, 0.1180, 0.0567, 0.0602, 0.0019, 0.3243,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 55.48830032348633, obj_val: 57.87609100341797, abs dis: 2.3877906799316406
[rfa agg] iter: 1, weight: tensor([0.1072, 0.0914, 0.1344, 0.0211, 0.1086, 0.0520, 0.0553, 0.0018, 0.3796,
        0.0486])
[rfa agg] iter:  2, prev_obj_val: 57.87609100341797, obj_val: 57.87312698364258, abs dis: 0.002964019775390625
[rfa agg] iter: 2, weight: tensor([0.1081, 0.0938, 0.1323, 0.0248, 0.1094, 0.0634, 0.0592, 0.0020, 0.3480,
        0.0589])
[rfa agg] iter:  3, prev_obj_val: 57.87312698364258, obj_val: 55.484188079833984, abs dis: 2.3889389038085938
[rfa agg] iter: 3, weight: tensor([0.1090, 0.0946, 0.1334, 0.0250, 0.1103, 0.0639, 0.0596, 0.0020, 0.3427,
        0.0595])
[rfa agg] iter:  4, prev_obj_val: 55.484188079833984, obj_val: 57.87691116333008, abs dis: 2.3927230834960938
[rfa agg] iter: 4, weight: tensor([0.1062, 0.0906, 0.1330, 0.0210, 0.1076, 0.0516, 0.0548, 0.0018, 0.3854,
        0.0482])
[rfa agg] iter:  5, prev_obj_val: 57.87691116333008, obj_val: 57.8731575012207, abs dis: 0.003753662109375
[rfa agg] iter: 5, weight: tensor([0.1080, 0.0937, 0.1321, 0.0248, 0.1093, 0.0633, 0.0591, 0.0020, 0.3490,
        0.0589])
[rfa agg] iter:  6, prev_obj_val: 57.8731575012207, obj_val: 55.484153747558594, abs dis: 2.3890037536621094
[rfa agg] iter: 6, weight: tensor([0.1090, 0.0945, 0.1333, 0.0250, 0.1103, 0.0639, 0.0596, 0.0020, 0.3429,
        0.0595])
[rfa agg] iter:  7, prev_obj_val: 55.484153747558594, obj_val: 57.876922607421875, abs dis: 2.3927688598632812
[rfa agg] iter: 7, weight: tensor([0.1062, 0.0906, 0.1330, 0.0210, 0.1076, 0.0516, 0.0548, 0.0018, 0.3854,
        0.0481])
[rfa agg] iter:  8, prev_obj_val: 57.876922607421875, obj_val: 57.8731575012207, abs dis: 0.003765106201171875
[rfa agg] iter: 8, weight: tensor([0.1080, 0.0937, 0.1321, 0.0248, 0.1093, 0.0633, 0.0591, 0.0020, 0.3490,
        0.0589])
[rfa agg] iter:  9, prev_obj_val: 57.8731575012207, obj_val: 55.484153747558594, abs dis: 2.3890037536621094
[rfa agg] iter: 9, weight: tensor([0.1090, 0.0945, 0.1333, 0.0250, 0.1103, 0.0639, 0.0596, 0.0020, 0.3429,
        0.0595])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1478, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 7.5242, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.48546624183655 sec.
Server Epoch:15 choose agents : [70, 63, 84, 79, 26, 42, 18, 66, 39, 95].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0598, Accuracy: 318/1418 (22.4260%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 638/1418 (44.9929%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5784, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0530, Accuracy: 229/888 (25.7883%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 426/888 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.2140, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0340, Accuracy: 424/1190 (35.6303%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9963, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   1, Avg loss: 0.1067, Accuracy: 4/197 (2.0305%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   2, Avg loss: 0.0923, Accuracy: 37/197 (18.7817%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7810, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0603, Accuracy: 295/1446 (20.4011%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 475/1446 (32.8492%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9133, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0564, Accuracy: 278/1372 (20.2624%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 476/1372 (34.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.7544, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0674, Accuracy: 116/530 (21.8868%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9472, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0632, Accuracy: 232/1402 (16.5478%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0394, Accuracy: 345/1402 (24.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2405, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0591, Accuracy: 244/1013 (24.0869%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0276, Accuracy: 519/1013 (51.2340%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9303, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   1, Avg loss: 0.0606, Accuracy: 238/599 (39.7329%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 11.0262, Accuracy: 50/10000 (0.5000%)
time spent on training: 145.14134860038757
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 888, 1190, 197, 1446, 1372, 530, 1402, 1013, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 63, 84, 79, 26, 42, 18, 66, 39, 95], weight: tensor([0.1410, 0.0883, 0.1183, 0.0196, 0.1438, 0.1364, 0.0527, 0.1394, 0.1007,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 44.80649948120117, obj_val: 50.391178131103516, abs dis: 5.584678649902344
[rfa agg] iter: 0, weight: tensor([0.0864, 0.1052, 0.1811, 0.0056, 0.0888, 0.1005, 0.0247, 0.1028, 0.2731,
        0.0319])
[rfa agg] iter:  1, prev_obj_val: 50.391178131103516, obj_val: 52.7432746887207, abs dis: 2.3520965576171875
[rfa agg] iter: 1, weight: tensor([0.0650, 0.1687, 0.1114, 0.0058, 0.0666, 0.0728, 0.0280, 0.0744, 0.3699,
        0.0374])
[rfa agg] iter:  2, prev_obj_val: 52.7432746887207, obj_val: 55.25754928588867, abs dis: 2.5142745971679688
[rfa agg] iter: 2, weight: tensor([0.0645, 0.2308, 0.1038, 0.0064, 0.0662, 0.0717, 0.0321, 0.0732, 0.3078,
        0.0434])
[rfa agg] iter:  3, prev_obj_val: 55.25754928588867, obj_val: 57.92475891113281, abs dis: 2.6672096252441406
[rfa agg] iter: 3, weight: tensor([0.0624, 0.3193, 0.0957, 0.0069, 0.0639, 0.0687, 0.0357, 0.0702, 0.2281,
        0.0491])
[rfa agg] iter:  4, prev_obj_val: 57.92475891113281, obj_val: 57.902305603027344, abs dis: 0.02245330810546875
[rfa agg] iter: 4, weight: tensor([0.0573, 0.4041, 0.0843, 0.0070, 0.0586, 0.0626, 0.0379, 0.0639, 0.1710,
        0.0533])
[rfa agg] iter:  5, prev_obj_val: 57.902305603027344, obj_val: 55.242530822753906, abs dis: 2.6597747802734375
[rfa agg] iter: 5, weight: tensor([0.0540, 0.4412, 0.0794, 0.0066, 0.0553, 0.0590, 0.0357, 0.0602, 0.1584,
        0.0502])
[rfa agg] iter:  6, prev_obj_val: 55.242530822753906, obj_val: 60.85926055908203, abs dis: 5.616729736328125
[rfa agg] iter: 6, weight: tensor([0.0580, 0.3812, 0.0887, 0.0064, 0.0594, 0.0639, 0.0332, 0.0652, 0.1983,
        0.0458])
[rfa agg] iter:  7, prev_obj_val: 60.85926055908203, obj_val: 60.85432815551758, abs dis: 0.004932403564453125
[rfa agg] iter: 7, weight: tensor([0.0588, 0.3990, 0.0835, 0.0079, 0.0601, 0.0638, 0.0451, 0.0651, 0.1515,
        0.0651])
[rfa agg] iter:  8, prev_obj_val: 60.85432815551758, obj_val: 60.85417556762695, abs dis: 0.000152587890625
[rfa agg] iter: 8, weight: tensor([0.0580, 0.4076, 0.0823, 0.0078, 0.0594, 0.0630, 0.0446, 0.0643, 0.1486,
        0.0644])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9307, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 7.5736, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.34326457977295 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 80, 6, 64, 96, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0899, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0495, Accuracy: 140/312 (44.8718%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0511, Accuracy: 431/1470 (29.3197%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0247, Accuracy: 817/1470 (55.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.2601, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 144/818 (17.6039%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 329/818 (40.2200%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6474, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 234/1402 (16.6904%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0396, Accuracy: 382/1402 (27.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2105, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   1, Avg loss: 0.0790, Accuracy: 74/682 (10.8504%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   2, Avg loss: 0.0388, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3182, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0589, Accuracy: 314/1956 (16.0532%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0332, Accuracy: 598/1956 (30.5726%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6607, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0603, Accuracy: 191/953 (20.0420%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0372, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7853, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0769, Accuracy: 8/311 (2.5723%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0501, Accuracy: 126/311 (40.5145%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.6670, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0558, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0299, Accuracy: 486/1089 (44.6281%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.1738, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0883, Accuracy: 25/515 (4.8544%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0579, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0017, Accuracy: 58/10000 (0.5800%)
time spent on training: 147.50088357925415
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 682, 1956, 953, 311, 1089, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 22, 71, 66, 80, 6, 64, 96, 59, 33], weight: tensor([0.0328, 0.1546, 0.0860, 0.1475, 0.0717, 0.2057, 0.1002, 0.0327, 0.1145,
        0.0542])
[rfa agg] iter:  0, prev_obj_val: 62.7960319519043, obj_val: 64.42786407470703, abs dis: 1.6318321228027344
[rfa agg] iter: 0, weight: tensor([0.0121, 0.1271, 0.0866, 0.1471, 0.0509, 0.0709, 0.1698, 0.0120, 0.2939,
        0.0295])
[rfa agg] iter:  1, prev_obj_val: 64.42786407470703, obj_val: 66.6988296508789, abs dis: 2.270965576171875
[rfa agg] iter: 1, weight: tensor([0.0126, 0.1050, 0.1052, 0.1178, 0.0577, 0.0639, 0.2397, 0.0126, 0.2533,
        0.0321])
[rfa agg] iter:  2, prev_obj_val: 66.6988296508789, obj_val: 69.66481018066406, abs dis: 2.9659805297851562
[rfa agg] iter: 2, weight: tensor([0.0125, 0.0831, 0.1286, 0.0913, 0.0635, 0.0544, 0.3582, 0.0125, 0.1624,
        0.0335])
[rfa agg] iter:  3, prev_obj_val: 69.66481018066406, obj_val: 71.53889465332031, abs dis: 1.87408447265625
[rfa agg] iter: 3, weight: tensor([0.0127, 0.0677, 0.1757, 0.0731, 0.0739, 0.0470, 0.3896, 0.0126, 0.1117,
        0.0361])
[rfa agg] iter:  4, prev_obj_val: 71.53889465332031, obj_val: 73.5553970336914, abs dis: 2.0165023803710938
[rfa agg] iter: 4, weight: tensor([0.0140, 0.0669, 0.2380, 0.0717, 0.0889, 0.0477, 0.3141, 0.0139, 0.1035,
        0.0413])
[rfa agg] iter:  5, prev_obj_val: 73.5553970336914, obj_val: 78.2059555053711, abs dis: 4.6505584716796875
[rfa agg] iter: 5, weight: tensor([0.0147, 0.0634, 0.3211, 0.0676, 0.1044, 0.0462, 0.2290, 0.0146, 0.0934,
        0.0456])
[rfa agg] iter:  6, prev_obj_val: 78.2059555053711, obj_val: 78.1874771118164, abs dis: 0.0184783935546875
[rfa agg] iter: 6, weight: tensor([0.0168, 0.0583, 0.3581, 0.0614, 0.1577, 0.0443, 0.1497, 0.0167, 0.0792,
        0.0579])
[rfa agg] iter:  7, prev_obj_val: 78.1874771118164, obj_val: 78.18726348876953, abs dis: 0.000213623046875
[rfa agg] iter: 7, weight: tensor([0.0165, 0.0572, 0.3679, 0.0603, 0.1582, 0.0436, 0.1451, 0.0164, 0.0776,
        0.0572])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.6612, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 6.7667, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.92014002799988 sec.
Server Epoch:17 choose agents : [36, 29, 28, 81, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0897, Accuracy: 23/408 (5.6373%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8420, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0518, Accuracy: 369/1440 (25.6250%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 626/1440 (43.4722%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.5250, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0577, Accuracy: 327/1581 (20.6831%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0349, Accuracy: 568/1581 (35.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2804, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   1, Avg loss: 0.0733, Accuracy: 177/774 (22.8682%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   2, Avg loss: 0.0371, Accuracy: 311/774 (40.1809%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2847, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0585, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0311, Accuracy: 468/1071 (43.6975%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.0749, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0486, Accuracy: 274/888 (30.8559%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 426/888 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.1796, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0882, Accuracy: 23/515 (4.4660%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0571, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8799, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0710, Accuracy: 230/715 (32.1678%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0418, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.2990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 303/1628 (18.6118%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0266, Accuracy: 752/1628 (46.1916%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.3692, Accuracy: 157/10000 (1.5700%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0657, Accuracy: 274/946 (28.9641%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0384, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0260, Accuracy: 59/10000 (0.5900%)
time spent on training: 153.99066352844238
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 774, 1071, 888, 515, 715, 1628, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 29, 28, 81, 55, 63, 33, 23, 5, 43], weight: tensor([0.0409, 0.1445, 0.1586, 0.0777, 0.1075, 0.0891, 0.0517, 0.0717, 0.1634,
        0.0949])
[rfa agg] iter:  0, prev_obj_val: 54.19649887084961, obj_val: 60.24420166015625, abs dis: 6.047702789306641
[rfa agg] iter: 0, weight: tensor([0.0166, 0.0661, 0.0580, 0.0954, 0.1868, 0.1677, 0.0273, 0.0672, 0.0540,
        0.2610])
[rfa agg] iter:  1, prev_obj_val: 60.24420166015625, obj_val: 60.15663146972656, abs dis: 0.0875701904296875
[rfa agg] iter: 1, weight: tensor([0.0196, 0.0479, 0.0438, 0.1739, 0.0929, 0.2558, 0.0352, 0.1167, 0.0414,
        0.1728])
[rfa agg] iter:  2, prev_obj_val: 60.15663146972656, obj_val: 65.33527374267578, abs dis: 5.178642272949219
[rfa agg] iter: 2, weight: tensor([0.0189, 0.0460, 0.0421, 0.1831, 0.0882, 0.2717, 0.0339, 0.1147, 0.0398,
        0.1615])
[rfa agg] iter:  3, prev_obj_val: 65.33527374267578, obj_val: 65.30467224121094, abs dis: 0.03060150146484375
[rfa agg] iter: 3, weight: tensor([0.0254, 0.0479, 0.0445, 0.2118, 0.0808, 0.1821, 0.0487, 0.1924, 0.0424,
        0.1240])
[rfa agg] iter:  4, prev_obj_val: 65.30467224121094, obj_val: 68.30094909667969, abs dis: 2.99627685546875
[rfa agg] iter: 4, weight: tensor([0.0250, 0.0472, 0.0439, 0.2155, 0.0795, 0.1737, 0.0481, 0.2038, 0.0417,
        0.1216])
[rfa agg] iter:  5, prev_obj_val: 68.30094909667969, obj_val: 65.3084716796875, abs dis: 2.9924774169921875
[rfa agg] iter: 5, weight: tensor([0.0294, 0.0486, 0.0454, 0.1913, 0.0777, 0.1500, 0.0590, 0.2435, 0.0434,
        0.1117])
[rfa agg] iter:  6, prev_obj_val: 65.3084716796875, obj_val: 65.30437469482422, abs dis: 0.00409698486328125
[rfa agg] iter: 6, weight: tensor([0.0249, 0.0470, 0.0437, 0.2092, 0.0792, 0.1710, 0.0479, 0.2146, 0.0416,
        0.1209])
[rfa agg] iter:  7, prev_obj_val: 65.30437469482422, obj_val: 68.30010223388672, abs dis: 2.9957275390625
[rfa agg] iter: 7, weight: tensor([0.0250, 0.0471, 0.0437, 0.2137, 0.0793, 0.1724, 0.0479, 0.2080, 0.0416,
        0.1212])
[rfa agg] iter:  8, prev_obj_val: 68.30010223388672, obj_val: 65.30864715576172, abs dis: 2.991455078125
[rfa agg] iter: 8, weight: tensor([0.0294, 0.0485, 0.0454, 0.1908, 0.0776, 0.1498, 0.0590, 0.2446, 0.0433,
        0.1116])
[rfa agg] iter:  9, prev_obj_val: 65.30864715576172, obj_val: 65.30438232421875, abs dis: 0.00426483154296875
[rfa agg] iter: 9, weight: tensor([0.0249, 0.0470, 0.0437, 0.2090, 0.0792, 0.1710, 0.0479, 0.2148, 0.0416,
        0.1209])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.8863, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 7.6084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.4301357269287 sec.
Server Epoch:18 choose agents : [77, 90, 3, 24, 2, 8, 79, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   1, Avg loss: 0.0552, Accuracy: 323/1340 (24.1045%)
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 561/1340 (41.8657%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.3356, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0643, Accuracy: 219/677 (32.3486%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.0490, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0819, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0380, Accuracy: 217/781 (27.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1045, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0925, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0523, Accuracy: 136/312 (43.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0669, Accuracy: 179/605 (29.5868%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0424, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0060, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0651, Accuracy: 211/1513 (13.9458%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0385, Accuracy: 430/1513 (28.4204%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4346, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   1, Avg loss: 0.1169, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   2, Avg loss: 0.0999, Accuracy: 9/197 (4.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8411, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 208/1049 (19.8284%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 466/1049 (44.4233%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.6594, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0725, Accuracy: 149/938 (15.8849%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0343, Accuracy: 317/938 (33.7953%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1933, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0510, Accuracy: 372/1440 (25.8333%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 642/1440 (44.5833%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0559, Accuracy: 84/10000 (0.8400%)
time spent on training: 146.7318766117096
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 677, 781, 312, 605, 1513, 197, 1049, 938, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 90, 3, 24, 2, 8, 79, 51, 73, 29], weight: tensor([0.1514, 0.0765, 0.0882, 0.0352, 0.0683, 0.1709, 0.0223, 0.1185, 0.1060,
        0.1627])
[rfa agg] iter:  0, prev_obj_val: 49.28141784667969, obj_val: 52.825340270996094, abs dis: 3.5439224243164062
[rfa agg] iter: 0, weight: tensor([0.1127, 0.0577, 0.1068, 0.0121, 0.0430, 0.0810, 0.0069, 0.2571, 0.2355,
        0.0873])
[rfa agg] iter:  1, prev_obj_val: 52.825340270996094, obj_val: 54.426700592041016, abs dis: 1.6013603210449219
[rfa agg] iter: 1, weight: tensor([0.0851, 0.0778, 0.1767, 0.0134, 0.0545, 0.0663, 0.0076, 0.1573, 0.2912,
        0.0701])
[rfa agg] iter:  2, prev_obj_val: 54.426700592041016, obj_val: 58.35210418701172, abs dis: 3.925403594970703
[rfa agg] iter: 2, weight: tensor([0.0782, 0.0889, 0.2301, 0.0140, 0.0602, 0.0622, 0.0079, 0.1304, 0.2628,
        0.0655])
[rfa agg] iter:  3, prev_obj_val: 58.35210418701172, obj_val: 63.20390319824219, abs dis: 4.851799011230469
[rfa agg] iter: 3, weight: tensor([0.0664, 0.1214, 0.3387, 0.0150, 0.0751, 0.0547, 0.0084, 0.0985, 0.1647,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 63.20390319824219, obj_val: 65.87036895751953, abs dis: 2.6664657592773438
[rfa agg] iter: 4, weight: tensor([0.0636, 0.2072, 0.2668, 0.0183, 0.1124, 0.0540, 0.0100, 0.0866, 0.1250,
        0.0559])
[rfa agg] iter:  5, prev_obj_val: 65.87036895751953, obj_val: 63.18785095214844, abs dis: 2.6825180053710938
[rfa agg] iter: 5, weight: tensor([0.0597, 0.2869, 0.1936, 0.0194, 0.1388, 0.0514, 0.0105, 0.0786, 0.1080,
        0.0530])
[rfa agg] iter:  6, prev_obj_val: 63.18785095214844, obj_val: 63.17645263671875, abs dis: 0.0113983154296875
[rfa agg] iter: 6, weight: tensor([0.0633, 0.2311, 0.2426, 0.0183, 0.1152, 0.0538, 0.0100, 0.0861, 0.1240,
        0.0557])
[rfa agg] iter:  7, prev_obj_val: 63.17645263671875, obj_val: 65.8639144897461, abs dis: 2.6874618530273438
[rfa agg] iter: 7, weight: tensor([0.0634, 0.2229, 0.2512, 0.0183, 0.1143, 0.0538, 0.0100, 0.0862, 0.1243,
        0.0557])
[rfa agg] iter:  8, prev_obj_val: 65.8639144897461, obj_val: 65.84717559814453, abs dis: 0.0167388916015625
[rfa agg] iter: 8, weight: tensor([0.0595, 0.2909, 0.1916, 0.0193, 0.1385, 0.0512, 0.0105, 0.0782, 0.1076,
        0.0528])
[rfa agg] iter:  9, prev_obj_val: 65.84717559814453, obj_val: 65.84651184082031, abs dis: 0.00066375732421875
[rfa agg] iter: 9, weight: tensor([0.0582, 0.3089, 0.1830, 0.0190, 0.1375, 0.0501, 0.0103, 0.0764, 0.1052,
        0.0517])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.7572, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 7.5600, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.83635187149048 sec.
Server Epoch:19 choose agents : [7, 87, 36, 17, 90, 93, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0607, Accuracy: 273/891 (30.6397%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0292, Accuracy: 436/891 (48.9338%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4893, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   1, Avg loss: 0.0636, Accuracy: 287/1131 (25.3758%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   2, Avg loss: 0.0336, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5303, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0910, Accuracy: 21/408 (5.1471%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 149/408 (36.5196%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9944, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0569, Accuracy: 303/1574 (19.2503%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 543/1574 (34.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9855, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   1, Avg loss: 0.0596, Accuracy: 230/677 (33.9734%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   2, Avg loss: 0.0213, Accuracy: 464/677 (68.5377%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 10.6275, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   1, Avg loss: 0.0579, Accuracy: 375/1742 (21.5270%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 698/1742 (40.0689%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7335, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0579, Accuracy: 323/1949 (16.5726%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 578/1949 (29.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5815, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 572/2227 (25.6848%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 986/2227 (44.2748%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7942, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 311/712 (43.6798%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 399/712 (56.0393%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5956, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 298/1154 (25.8232%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 363/1154 (31.4558%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.7989, Accuracy: 81/10000 (0.8100%)
time spent on training: 172.07904505729675
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1131, 408, 1574, 677, 1742, 1949, 2227, 712, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 87, 36, 17, 90, 93, 21, 60, 11, 15], weight: tensor([0.0715, 0.0907, 0.0327, 0.1263, 0.0543, 0.1398, 0.1564, 0.1787, 0.0571,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 71.99078369140625, obj_val: 75.92070770263672, abs dis: 3.9299240112304688
[rfa agg] iter: 0, weight: tensor([0.0553, 0.1328, 0.0136, 0.2334, 0.0308, 0.1406, 0.1068, 0.0855, 0.0355,
        0.1657])
[rfa agg] iter:  1, prev_obj_val: 75.92070770263672, obj_val: 79.97696685791016, abs dis: 4.0562591552734375
[rfa agg] iter: 1, weight: tensor([0.0654, 0.2033, 0.0140, 0.1372, 0.0337, 0.0964, 0.0789, 0.0666, 0.0396,
        0.2650])
[rfa agg] iter:  2, prev_obj_val: 79.97696685791016, obj_val: 83.8183364868164, abs dis: 3.84136962890625
[rfa agg] iter: 2, weight: tensor([0.0728, 0.2876, 0.0135, 0.0904, 0.0342, 0.0692, 0.0592, 0.0515, 0.0411,
        0.2805])
[rfa agg] iter:  3, prev_obj_val: 83.8183364868164, obj_val: 83.79363250732422, abs dis: 0.0247039794921875
[rfa agg] iter: 3, weight: tensor([0.0948, 0.3261, 0.0153, 0.0819, 0.0408, 0.0654, 0.0571, 0.0506, 0.0502,
        0.2177])
[rfa agg] iter:  4, prev_obj_val: 83.79363250732422, obj_val: 83.79141998291016, abs dis: 0.0022125244140625
[rfa agg] iter: 4, weight: tensor([0.0937, 0.3465, 0.0151, 0.0805, 0.0402, 0.0643, 0.0562, 0.0498, 0.0495,
        0.2044])
[rfa agg] iter:  5, prev_obj_val: 83.79141998291016, obj_val: 86.03791809082031, abs dis: 2.2464981079101562
[rfa agg] iter: 5, weight: tensor([0.0929, 0.3540, 0.0149, 0.0799, 0.0399, 0.0638, 0.0558, 0.0494, 0.0491,
        0.2004])
[rfa agg] iter:  6, prev_obj_val: 86.03791809082031, obj_val: 81.7528076171875, abs dis: 4.2851104736328125
[rfa agg] iter: 6, weight: tensor([0.1150, 0.3179, 0.0170, 0.0815, 0.0467, 0.0661, 0.0584, 0.0521, 0.0582,
        0.1870])
[rfa agg] iter:  7, prev_obj_val: 81.7528076171875, obj_val: 81.74201965332031, abs dis: 0.0107879638671875
[rfa agg] iter: 7, weight: tensor([0.0792, 0.3600, 0.0137, 0.0816, 0.0355, 0.0639, 0.0553, 0.0486, 0.0433,
        0.2189])
[rfa agg] iter:  8, prev_obj_val: 81.74201965332031, obj_val: 79.95169830322266, abs dis: 1.7903213500976562
[rfa agg] iter: 8, weight: tensor([0.0775, 0.3664, 0.0134, 0.0803, 0.0349, 0.0629, 0.0545, 0.0478, 0.0425,
        0.2196])
[rfa agg] iter:  9, prev_obj_val: 79.95169830322266, obj_val: 83.79975128173828, abs dis: 3.848052978515625
[rfa agg] iter: 9, weight: tensor([0.0700, 0.3391, 0.0129, 0.0864, 0.0328, 0.0664, 0.0569, 0.0495, 0.0396,
        0.2463])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.1170, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 7.8847, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.4245936870575 sec.
Server Epoch:20 choose agents : [76, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0921, Accuracy: 16/466 (3.4335%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0515, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.8778, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 322/1013 (31.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3420, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0577, Accuracy: 225/1071 (21.0084%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 497/1071 (46.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.7712, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0589, Accuracy: 295/891 (33.1089%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0285, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5951, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0613, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8116, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0689, Accuracy: 115/809 (14.2151%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0300, Accuracy: 320/809 (39.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.4619, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0626, Accuracy: 147/818 (17.9707%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 346/818 (42.2983%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8431, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0576, Accuracy: 233/636 (36.6352%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.6387, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0557, Accuracy: 248/1089 (22.7732%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 12.7783, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0590, Accuracy: 169/861 (19.6283%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0226, Accuracy: 413/861 (47.9675%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.3513, Accuracy: 86/10000 (0.8600%)
time spent on training: 153.05760431289673
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 14, 55, 7, 64, 50, 71, 52, 59, 10], weight: tensor([0.0541, 0.1177, 0.1244, 0.1035, 0.1107, 0.0940, 0.0950, 0.0739, 0.1265,
        0.1000])
[rfa agg] iter:  0, prev_obj_val: 33.95450210571289, obj_val: 30.899574279785156, abs dis: 3.0549278259277344
[rfa agg] iter: 0, weight: tensor([0.0447, 0.0782, 0.0680, 0.1165, 0.0930, 0.1573, 0.1543, 0.1192, 0.0576,
        0.1111])
[rfa agg] iter:  1, prev_obj_val: 30.899574279785156, obj_val: 37.037208557128906, abs dis: 6.13763427734375
[rfa agg] iter: 1, weight: tensor([0.0348, 0.0757, 0.0645, 0.1216, 0.0925, 0.1810, 0.1739, 0.0874, 0.0535,
        0.1152])
[rfa agg] iter:  2, prev_obj_val: 37.037208557128906, obj_val: 37.01801300048828, abs dis: 0.019195556640625
[rfa agg] iter: 2, weight: tensor([0.0553, 0.0762, 0.0673, 0.1079, 0.0886, 0.1417, 0.1403, 0.1620, 0.0576,
        0.1032])
[rfa agg] iter:  3, prev_obj_val: 37.01801300048828, obj_val: 40.29376983642578, abs dis: 3.2757568359375
[rfa agg] iter: 3, weight: tensor([0.0553, 0.0757, 0.0669, 0.1071, 0.0880, 0.1396, 0.1383, 0.1695, 0.0572,
        0.1024])
[rfa agg] iter:  4, prev_obj_val: 40.29376983642578, obj_val: 33.9095458984375, abs dis: 6.384223937988281
[rfa agg] iter: 4, weight: tensor([0.0672, 0.0724, 0.0649, 0.0977, 0.0826, 0.1213, 0.1209, 0.2229, 0.0562,
        0.0937])
[rfa agg] iter:  5, prev_obj_val: 33.9095458984375, obj_val: 30.900833129882812, abs dis: 3.0087127685546875
[rfa agg] iter: 5, weight: tensor([0.0447, 0.0768, 0.0669, 0.1149, 0.0914, 0.1579, 0.1548, 0.1268, 0.0563,
        0.1095])
[rfa agg] iter:  6, prev_obj_val: 30.900833129882812, obj_val: 37.03716278076172, abs dis: 6.136329650878906
[rfa agg] iter: 6, weight: tensor([0.0348, 0.0756, 0.0645, 0.1215, 0.0925, 0.1810, 0.1739, 0.0876, 0.0535,
        0.1151])
[rfa agg] iter:  7, prev_obj_val: 37.03716278076172, obj_val: 37.01801300048828, abs dis: 0.0191497802734375
[rfa agg] iter: 7, weight: tensor([0.0553, 0.0762, 0.0673, 0.1079, 0.0886, 0.1417, 0.1403, 0.1620, 0.0576,
        0.1032])
[rfa agg] iter:  8, prev_obj_val: 37.01801300048828, obj_val: 40.29377365112305, abs dis: 3.2757606506347656
[rfa agg] iter: 8, weight: tensor([0.0553, 0.0757, 0.0669, 0.1071, 0.0880, 0.1396, 0.1383, 0.1695, 0.0572,
        0.1024])
[rfa agg] iter:  9, prev_obj_val: 40.29377365112305, obj_val: 33.9095458984375, abs dis: 6.384227752685547
[rfa agg] iter: 9, weight: tensor([0.0672, 0.0724, 0.0649, 0.0977, 0.0826, 0.1213, 0.1209, 0.2229, 0.0562,
        0.0937])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.9564, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 7.9048, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.59674096107483 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 77, 99, 74, 94, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0526, Accuracy: 473/1657 (28.5456%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0309, Accuracy: 746/1657 (45.0211%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0267, Accuracy: 814/1657 (49.1249%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0265, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0260, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0254, Accuracy: 841/1657 (50.7544%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0249, Accuracy: 856/1657 (51.6596%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0246, Accuracy: 866/1657 (52.2631%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0245, Accuracy: 869/1657 (52.4442%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0240, Accuracy: 878/1657 (52.9873%), train_poison_data_count: 520
Global model norm: 187.48694746235003.
Norm before scaling: 187.43560352491733. Distance: 1.287530578324233
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7156, Accuracy: 63/10000 (0.6300%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.3222, Accuracy: 9695/9950 (97.4372%)
Scaling by  100
Scaled Norm after poisoning: 222.7953447112394, distance: 128.7530566991518
Total norm for 1 adversaries is: 222.7953447112394. distance: 128.7530566991518
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0566, Accuracy: 335/1574 (21.2834%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 636/1574 (40.4066%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9515, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0607, Accuracy: 295/1446 (20.4011%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0363, Accuracy: 449/1446 (31.0512%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8539, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1394, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1194, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.0876, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0552, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0290, Accuracy: 545/1340 (40.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.3348, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   1, Avg loss: 0.0709, Accuracy: 177/773 (22.8978%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 365/773 (47.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.7091, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0494, Accuracy: 394/1552 (25.3866%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 738/1552 (47.5515%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 11.6555, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0571, Accuracy: 335/1662 (20.1564%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0347, Accuracy: 578/1662 (34.7774%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.8524, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0581, Accuracy: 352/1475 (23.8644%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 587/1475 (39.7966%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9796, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0520, Accuracy: 448/1470 (30.4762%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 811/1470 (55.1701%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.5108, Accuracy: 98/10000 (0.9800%)
time spent on training: 295.4384489059448
[rfa agg] training data poison_ratio: 0.12665290835435297  data num: [1657, 1574, 1446, 134, 1340, 773, 1552, 1662, 1475, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0395790338607353
[rfa agg] init. name: [0, 17, 26, 47, 77, 99, 74, 94, 65, 22], weight: tensor([0.1267, 0.1203, 0.1105, 0.0102, 0.1024, 0.0591, 0.1186, 0.1270, 0.1127,
        0.1124])
[rfa agg] iter:  0, prev_obj_val: 25726.892578125, obj_val: 16504.548828125, abs dis: 9222.34375
[rfa agg] iter: 0, weight: tensor([0.0206, 0.1351, 0.1240, 0.0113, 0.1147, 0.0659, 0.1332, 0.1427, 0.1265,
        0.1260])
[rfa agg] iter:  1, prev_obj_val: 16504.548828125, obj_val: 14978.349609375, abs dis: 1526.19921875
[rfa agg] iter: 1, weight: tensor([0.0030, 0.1384, 0.1262, 0.0109, 0.1160, 0.0650, 0.1364, 0.1467, 0.1292,
        0.1283])
[rfa agg] iter:  2, prev_obj_val: 14978.349609375, obj_val: 14764.890625, abs dis: 213.458984375
[rfa agg] iter: 2, weight: tensor([0.0004, 0.1446, 0.1255, 0.0074, 0.1103, 0.0526, 0.1426, 0.1573, 0.1317,
        0.1276])
[rfa agg] iter:  3, prev_obj_val: 14764.890625, obj_val: 14761.04296875, abs dis: 3.84765625
[rfa agg] iter: 3, weight: tensor([3.2955e-05, 1.8676e-01, 9.6756e-02, 1.4440e-03, 6.0526e-02, 1.4694e-02,
        1.8188e-01, 2.3507e-01, 1.2503e-01, 9.7809e-02])
[rfa agg] iter:  4, prev_obj_val: 14761.04296875, obj_val: 14764.7314453125, abs dis: 3.6884765625
[rfa agg] iter: 4, weight: tensor([2.6940e-05, 1.3374e-01, 1.7871e-01, 1.3805e-03, 1.0813e-01, 1.6119e-02,
        1.2912e-01, 1.0370e-01, 1.5503e-01, 1.7405e-01])
[rfa agg] iter:  5, prev_obj_val: 14764.7314453125, obj_val: 14767.2509765625, abs dis: 2.51953125
[rfa agg] iter: 5, weight: tensor([2.9989e-05, 1.0929e-01, 1.8812e-01, 1.6136e-03, 1.6903e-01, 1.9891e-02,
        1.0733e-01, 8.8665e-02, 1.3249e-01, 1.8354e-01])
[rfa agg] iter:  6, prev_obj_val: 14767.2509765625, obj_val: 14770.08984375, abs dis: 2.8388671875
[rfa agg] iter: 6, weight: tensor([3.2200e-05, 1.0296e-01, 1.7366e-01, 1.7767e-03, 2.1866e-01, 2.2577e-02,
        1.0152e-01, 8.5988e-02, 1.2229e-01, 1.7054e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.1746, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 7.5093, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.21718192100525 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 75, 2, 0, 8, 77, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0579, Accuracy: 316/712 (44.3820%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 402/712 (56.4607%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.5799, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0516, Accuracy: 437/1470 (29.7279%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 813/1470 (55.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.8252, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0869, Accuracy: 7/440 (1.5909%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0516, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.9594, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0677, Accuracy: 140/530 (26.4151%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 277/530 (52.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5663, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   1, Avg loss: 0.0687, Accuracy: 209/776 (26.9330%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5916, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0665, Accuracy: 191/605 (31.5702%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0416, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1469, Accuracy: 61/10000 (0.6100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   1, Avg loss: 0.0569, Accuracy: 337/1657 (20.3380%)
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   2, Avg loss: 0.0360, Accuracy: 492/1657 (29.6922%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.4274, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0652, Accuracy: 189/1513 (12.4917%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0384, Accuracy: 422/1513 (27.8916%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.4129, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 331/1340 (24.7015%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   2, Avg loss: 0.0282, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3428, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0607, Accuracy: 264/1130 (23.3628%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0296, Accuracy: 471/1130 (41.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.6092, Accuracy: 56/10000 (0.5600%)
time spent on training: 198.33704352378845
[rfa agg] training data poison_ratio: 0.16288213899537993  data num: [712, 1470, 440, 530, 776, 605, 1657, 1513, 1340, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.05090066843605623
[rfa agg] init. name: [11, 22, 49, 18, 75, 2, 0, 8, 77, 54], weight: tensor([0.0700, 0.1445, 0.0433, 0.0521, 0.0763, 0.0595, 0.1629, 0.1487, 0.1317,
        0.1111])
[rfa agg] iter:  0, prev_obj_val: 58.5862922668457, obj_val: 60.243431091308594, abs dis: 1.6571388244628906
[rfa agg] iter: 0, weight: tensor([0.0888, 0.1076, 0.0252, 0.0391, 0.1253, 0.0517, 0.0860, 0.0975, 0.1334,
        0.2453])
[rfa agg] iter:  1, prev_obj_val: 60.243431091308594, obj_val: 61.993282318115234, abs dis: 1.7498512268066406
[rfa agg] iter: 1, weight: tensor([0.1016, 0.1022, 0.0271, 0.0426, 0.1494, 0.0570, 0.0832, 0.0933, 0.1243,
        0.2193])
[rfa agg] iter:  2, prev_obj_val: 61.993282318115234, obj_val: 63.77994155883789, abs dis: 1.7866592407226562
[rfa agg] iter: 2, weight: tensor([0.1167, 0.0962, 0.0287, 0.0461, 0.1796, 0.0625, 0.0796, 0.0884, 0.1148,
        0.1873])
[rfa agg] iter:  3, prev_obj_val: 63.77994155883789, obj_val: 65.6160888671875, abs dis: 1.8361473083496094
[rfa agg] iter: 3, weight: tensor([0.1325, 0.0881, 0.0297, 0.0487, 0.2166, 0.0670, 0.0741, 0.0815, 0.1035,
        0.1582])
[rfa agg] iter:  4, prev_obj_val: 65.6160888671875, obj_val: 69.63114166259766, abs dis: 4.015052795410156
[rfa agg] iter: 4, weight: tensor([0.1486, 0.0782, 0.0298, 0.0501, 0.2620, 0.0702, 0.0667, 0.0728, 0.0905,
        0.1312])
[rfa agg] iter:  5, prev_obj_val: 69.63114166259766, obj_val: 74.5273666381836, abs dis: 4.8962249755859375
[rfa agg] iter: 5, weight: tensor([0.1897, 0.0596, 0.0291, 0.0520, 0.3283, 0.0763, 0.0520, 0.0559, 0.0672,
        0.0899])
[rfa agg] iter:  6, prev_obj_val: 74.5273666381836, obj_val: 71.93418884277344, abs dis: 2.5931777954101562
[rfa agg] iter: 6, weight: tensor([0.2632, 0.0542, 0.0344, 0.0674, 0.2403, 0.1054, 0.0483, 0.0514, 0.0600,
        0.0754])
[rfa agg] iter:  7, prev_obj_val: 71.93418884277344, obj_val: 71.92998504638672, abs dis: 0.00420379638671875
[rfa agg] iter: 7, weight: tensor([0.2552, 0.0546, 0.0305, 0.0571, 0.2766, 0.0866, 0.0482, 0.0516, 0.0609,
        0.0787])
[rfa agg] iter:  8, prev_obj_val: 71.92998504638672, obj_val: 74.50244903564453, abs dis: 2.5724639892578125
[rfa agg] iter: 8, weight: tensor([0.2491, 0.0544, 0.0303, 0.0567, 0.2855, 0.0857, 0.0480, 0.0513, 0.0606,
        0.0784])
[rfa agg] iter:  9, prev_obj_val: 74.50244903564453, obj_val: 74.49227905273438, abs dis: 0.01016998291015625
[rfa agg] iter: 9, weight: tensor([0.2822, 0.0533, 0.0339, 0.0665, 0.2292, 0.1042, 0.0475, 0.0505, 0.0589,
        0.0740])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.6014, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 8.0860, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.44145369529724 sec.
Server Epoch:23 choose agents : [20, 9, 53, 95, 2, 87, 22, 76, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 210/807 (26.0223%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 435/807 (53.9033%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0276, Accuracy: 473/807 (58.6121%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0271, Accuracy: 475/807 (58.8600%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0237, Accuracy: 518/807 (64.1884%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0232, Accuracy: 509/807 (63.0731%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0227, Accuracy: 512/807 (63.4449%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0207, Accuracy: 528/807 (65.4275%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0212, Accuracy: 525/807 (65.0558%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0208, Accuracy: 534/807 (66.1710%), train_poison_data_count: 260
Global model norm: 193.4193145732866.
Norm before scaling: 193.39648191926864. Distance: 0.904055668277291
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9082, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.5968, Accuracy: 8651/9950 (86.9447%)
Scaling by  100
Scaled Norm after poisoning: 211.23286727862688, distance: 90.40555867347152
Total norm for 1 adversaries is: 211.23286727862688. distance: 90.40555867347152
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0614, Accuracy: 283/1275 (22.1961%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 655/1275 (51.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.3928, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0551, Accuracy: 221/813 (27.1833%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 468/813 (57.5646%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.6195, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   1, Avg loss: 0.0659, Accuracy: 227/599 (37.8965%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   2, Avg loss: 0.0332, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 13.0846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0656, Accuracy: 201/605 (33.2231%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0416, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1928, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   1, Avg loss: 0.0631, Accuracy: 287/1131 (25.3758%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   2, Avg loss: 0.0341, Accuracy: 375/1131 (33.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.6782, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0508, Accuracy: 486/1470 (33.0612%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0246, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.7353, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   1, Avg loss: 0.0856, Accuracy: 23/466 (4.9356%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 183/466 (39.2704%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4081, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0817, Accuracy: 103/781 (13.1882%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0395, Accuracy: 198/781 (25.3521%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.4294, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0570, Accuracy: 311/1628 (19.1032%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0274, Accuracy: 726/1628 (44.5946%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.6645, Accuracy: 117/10000 (1.1700%)
time spent on training: 258.77156710624695
[rfa agg] training data poison_ratio: 0.08428198433420366  data num: [807, 1275, 813, 599, 605, 1131, 1470, 466, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.02633812010443864
[rfa agg] init. name: [20, 9, 53, 95, 2, 87, 22, 76, 3, 5], weight: tensor([0.0843, 0.1332, 0.0849, 0.0626, 0.0632, 0.1181, 0.1535, 0.0487, 0.0816,
        0.1700])
[rfa agg] iter:  0, prev_obj_val: 9021.9296875, obj_val: 5320.4619140625, abs dis: 3701.4677734375
[rfa agg] iter: 0, weight: tensor([0.0084, 0.1447, 0.0911, 0.0668, 0.0674, 0.1279, 0.1677, 0.0517, 0.0875,
        0.1868])
[rfa agg] iter:  1, prev_obj_val: 5320.4619140625, obj_val: 4979.970703125, abs dis: 340.4912109375
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1490, 0.0834, 0.0583, 0.0589, 0.1271, 0.1827, 0.0439, 0.0801,
        0.2159])
[rfa agg] iter:  2, prev_obj_val: 4979.970703125, obj_val: 4978.12353515625, abs dis: 1.84716796875
[rfa agg] iter: 2, weight: tensor([5.5735e-05, 2.6288e-01, 4.2513e-02, 2.3238e-02, 2.3393e-02, 1.3213e-01,
        3.0562e-01, 1.5392e-02, 4.0864e-02, 1.5392e-01])
[rfa agg] iter:  3, prev_obj_val: 4978.12353515625, obj_val: 4982.26953125, abs dis: 4.14599609375
[rfa agg] iter: 3, weight: tensor([5.2031e-05, 3.1552e-01, 5.5659e-02, 2.7619e-02, 2.7790e-02, 2.6083e-01,
        1.4639e-01, 1.7609e-02, 5.3531e-02, 9.5003e-02])
[rfa agg] iter:  4, prev_obj_val: 4982.26953125, obj_val: 4986.36767578125, abs dis: 4.09814453125
[rfa agg] iter: 4, weight: tensor([6.2695e-05, 1.7536e-01, 1.0946e-01, 4.5474e-02, 4.5694e-02, 2.9358e-01,
        1.1113e-01, 2.7248e-02, 1.0661e-01, 8.5381e-02])
[rfa agg] iter:  5, prev_obj_val: 4986.36767578125, obj_val: 4987.7939453125, abs dis: 1.42626953125
[rfa agg] iter: 5, weight: tensor([6.5057e-05, 1.2961e-01, 1.7987e-01, 6.0552e-02, 6.0625e-02, 1.8542e-01,
        9.4758e-02, 3.4118e-02, 1.7804e-01, 7.6940e-02])
[rfa agg] iter:  6, prev_obj_val: 4987.7939453125, obj_val: 4991.0576171875, abs dis: 3.263671875
[rfa agg] iter: 6, weight: tensor([6.1115e-05, 1.1110e-01, 2.1403e-01, 6.3065e-02, 6.2955e-02, 1.4959e-01,
        8.4024e-02, 3.4494e-02, 2.1144e-01, 6.9235e-02])
[rfa agg] iter:  7, prev_obj_val: 4991.0576171875, obj_val: 4993.00390625, abs dis: 1.9462890625
[rfa agg] iter: 7, weight: tensor([4.9551e-05, 7.6870e-02, 2.7457e-01, 6.4133e-02, 6.3572e-02, 9.6458e-02,
        6.1192e-02, 3.2725e-02, 2.7868e-01, 5.1749e-02])
[rfa agg] iter:  8, prev_obj_val: 4993.00390625, obj_val: 4998.04052734375, abs dis: 5.03662109375
[rfa agg] iter: 8, weight: tensor([4.4651e-05, 6.4414e-02, 2.9577e-01, 6.6112e-02, 6.5111e-02, 7.8471e-02,
        5.2431e-02, 3.2243e-02, 3.0055e-01, 4.4855e-02])
[rfa agg] iter:  9, prev_obj_val: 4998.04052734375, obj_val: 4998.02197265625, abs dis: 0.0185546875
[rfa agg] iter: 9, weight: tensor([5.2609e-05, 6.6747e-02, 2.4916e-01, 1.0661e-01, 1.0278e-01, 7.7946e-02,
        5.6305e-02, 4.6397e-02, 2.4487e-01, 4.9149e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.8249, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 8.6798, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.788370847702 sec.
Server Epoch:24 choose agents : [63, 82, 85, 83, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0478, Accuracy: 311/888 (35.0225%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.7643, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0827, Accuracy: 37/500 (7.4000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0518, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2975, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   1, Avg loss: 0.0614, Accuracy: 335/1988 (16.8511%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 625/1988 (31.4386%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4855, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0573, Accuracy: 408/1953 (20.8909%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 766/1953 (39.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.3009, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0609, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 363/1013 (35.8342%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4092, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0662, Accuracy: 316/1163 (27.1711%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0392, Accuracy: 430/1163 (36.9733%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8082, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0789, Accuracy: 90/781 (11.5237%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0393, Accuracy: 211/781 (27.0166%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5307, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0556, Accuracy: 307/712 (43.1180%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 390/712 (54.7753%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.2532, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0654, Accuracy: 178/1049 (16.9685%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0325, Accuracy: 451/1049 (42.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.1620, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0597, Accuracy: 182/818 (22.2494%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 339/818 (41.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.5716, Accuracy: 78/10000 (0.7800%)
time spent on training: 167.47137689590454
[rfa agg] training data poison_ratio: 0.0  data num: [888, 500, 1988, 1953, 1013, 1163, 781, 712, 1049, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 82, 85, 83, 14, 68, 3, 11, 51, 71], weight: tensor([0.0817, 0.0460, 0.1830, 0.1798, 0.0932, 0.1070, 0.0719, 0.0655, 0.0965,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 67.9207763671875, obj_val: 69.93579864501953, abs dis: 2.0150222778320312
[rfa agg] iter: 0, weight: tensor([0.0869, 0.0202, 0.0577, 0.0611, 0.1676, 0.2380, 0.0615, 0.0475, 0.1947,
        0.0648])
[rfa agg] iter:  1, prev_obj_val: 69.93579864501953, obj_val: 74.32330322265625, abs dis: 4.387504577636719
[rfa agg] iter: 1, weight: tensor([0.1536, 0.0220, 0.0405, 0.0424, 0.2299, 0.1040, 0.0913, 0.0645, 0.1545,
        0.0973])
[rfa agg] iter:  2, prev_obj_val: 74.32330322265625, obj_val: 76.32535552978516, abs dis: 2.0020523071289062
[rfa agg] iter: 2, weight: tensor([0.2407, 0.0243, 0.0331, 0.0345, 0.1300, 0.0666, 0.1363, 0.0907, 0.0904,
        0.1535])
[rfa agg] iter:  3, prev_obj_val: 76.32535552978516, obj_val: 81.72232055664062, abs dis: 5.396965026855469
[rfa agg] iter: 3, weight: tensor([0.2307, 0.0249, 0.0304, 0.0316, 0.1012, 0.0574, 0.1570, 0.1050, 0.0748,
        0.1870])
[rfa agg] iter:  4, prev_obj_val: 81.72232055664062, obj_val: 81.69539642333984, abs dis: 0.02692413330078125
[rfa agg] iter: 4, weight: tensor([0.1518, 0.0323, 0.0311, 0.0322, 0.0825, 0.0531, 0.1735, 0.1685, 0.0657,
        0.2093])
[rfa agg] iter:  5, prev_obj_val: 81.69539642333984, obj_val: 84.9615707397461, abs dis: 3.26617431640625
[rfa agg] iter: 5, weight: tensor([0.1447, 0.0318, 0.0306, 0.0317, 0.0809, 0.0523, 0.1756, 0.1769, 0.0646,
        0.2108])
[rfa agg] iter:  6, prev_obj_val: 84.9615707397461, obj_val: 78.81807708740234, abs dis: 6.14349365234375
[rfa agg] iter: 6, weight: tensor([0.1297, 0.0389, 0.0329, 0.0341, 0.0794, 0.0538, 0.1631, 0.2159, 0.0651,
        0.1871])
[rfa agg] iter:  7, prev_obj_val: 78.81807708740234, obj_val: 84.97168731689453, abs dis: 6.1536102294921875
[rfa agg] iter: 7, weight: tensor([0.1695, 0.0275, 0.0298, 0.0310, 0.0873, 0.0535, 0.1779, 0.1415, 0.0676,
        0.2145])
[rfa agg] iter:  8, prev_obj_val: 84.97168731689453, obj_val: 78.81513214111328, abs dis: 6.15655517578125
[rfa agg] iter: 8, weight: tensor([0.1316, 0.0392, 0.0332, 0.0343, 0.0801, 0.0542, 0.1643, 0.2084, 0.0657,
        0.1892])
[rfa agg] iter:  9, prev_obj_val: 78.81513214111328, obj_val: 84.97198486328125, abs dis: 6.156852722167969
[rfa agg] iter: 9, weight: tensor([0.1697, 0.0275, 0.0298, 0.0309, 0.0872, 0.0534, 0.1781, 0.1408, 0.0676,
        0.2150])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 13.5710, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 10.9089, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.5097198486328 sec.
Server Epoch:25 choose agents : [15, 70, 45, 27, 54, 88, 16, 95, 32, 3].
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0549, Accuracy: 290/1154 (25.1300%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 395/1154 (34.2288%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.7012, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0664, Accuracy: 266/1418 (18.7588%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 590/1418 (41.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9759, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0686, Accuracy: 171/669 (25.5605%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1807, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0577, Accuracy: 421/1587 (26.5280%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0355, Accuracy: 572/1587 (36.0428%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1619, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0598, Accuracy: 273/1130 (24.1593%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0298, Accuracy: 467/1130 (41.3274%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.1695, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   1, Avg loss: 0.0945, Accuracy: 32/603 (5.3068%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   2, Avg loss: 0.0494, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.7900, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0648, Accuracy: 255/708 (36.0169%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0384, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.8507, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0709, Accuracy: 197/599 (32.8881%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0304, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 13.8195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0747, Accuracy: 100/735 (13.6054%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 374/735 (50.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.9805, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   1, Avg loss: 0.0794, Accuracy: 89/781 (11.3956%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 217/781 (27.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9231, Accuracy: 67/10000 (0.6700%)
time spent on training: 161.80521702766418
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 1418, 669, 1587, 1130, 603, 708, 599, 735, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [15, 70, 45, 27, 54, 88, 16, 95, 32, 3], weight: tensor([0.1230, 0.1511, 0.0713, 0.1691, 0.1204, 0.0643, 0.0754, 0.0638, 0.0783,
        0.0832])
[rfa agg] iter:  0, prev_obj_val: 50.78607177734375, obj_val: 54.74048614501953, abs dis: 3.9544143676757812
[rfa agg] iter: 0, weight: tensor([0.1096, 0.0759, 0.0831, 0.0697, 0.1369, 0.0598, 0.1117, 0.0592, 0.1212,
        0.1728])
[rfa agg] iter:  1, prev_obj_val: 54.74048614501953, obj_val: 58.64306640625, abs dis: 3.9025802612304688
[rfa agg] iter: 1, weight: tensor([0.0568, 0.0443, 0.1127, 0.0420, 0.0662, 0.0714, 0.1531, 0.0705, 0.1939,
        0.1891])
[rfa agg] iter:  2, prev_obj_val: 58.64306640625, obj_val: 71.54488372802734, abs dis: 12.901817321777344
[rfa agg] iter: 2, weight: tensor([0.0461, 0.0378, 0.1579, 0.0363, 0.0524, 0.0953, 0.1519, 0.0939, 0.2026,
        0.1258])
[rfa agg] iter:  3, prev_obj_val: 71.54488372802734, obj_val: 67.69609832763672, abs dis: 3.848785400390625
[rfa agg] iter: 3, weight: tensor([0.0485, 0.0425, 0.1458, 0.0416, 0.0534, 0.1872, 0.1018, 0.1816, 0.1121,
        0.0856])
[rfa agg] iter:  4, prev_obj_val: 67.69609832763672, obj_val: 71.4704360961914, abs dis: 3.7743377685546875
[rfa agg] iter: 4, weight: tensor([0.0435, 0.0376, 0.1552, 0.0366, 0.0482, 0.1977, 0.0991, 0.1876, 0.1123,
        0.0823])
[rfa agg] iter:  5, prev_obj_val: 71.4704360961914, obj_val: 67.69524383544922, abs dis: 3.7751922607421875
[rfa agg] iter: 5, weight: tensor([0.0465, 0.0407, 0.1409, 0.0399, 0.0512, 0.2042, 0.0954, 0.1943, 0.1056,
        0.0813])
[rfa agg] iter:  6, prev_obj_val: 67.69524383544922, obj_val: 67.69428253173828, abs dis: 0.0009613037109375
[rfa agg] iter: 6, weight: tensor([0.0432, 0.0373, 0.1537, 0.0364, 0.0479, 0.2011, 0.0979, 0.1897, 0.1112,
        0.0816])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 15.0853, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 12.3408, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.39920473098755 sec.
Server Epoch:26 choose agents : [16, 82, 49, 81, 57, 74, 75, 46, 55, 43].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0604, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0403, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3846, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0834, Accuracy: 45/500 (9.0000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0508, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8267, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0883, Accuracy: 1/440 (0.2273%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0525, Accuracy: 129/440 (29.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3882, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   1, Avg loss: 0.0686, Accuracy: 212/774 (27.3902%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   2, Avg loss: 0.0381, Accuracy: 305/774 (39.4057%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.5944, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0606, Accuracy: 260/1154 (22.5303%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 12.2237, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0492, Accuracy: 351/1552 (22.6160%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 728/1552 (46.9072%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.6353, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0672, Accuracy: 220/776 (28.3505%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 391/776 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.8450, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0573, Accuracy: 352/1904 (18.4874%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 653/1904 (34.2962%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.7329, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0598, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0309, Accuracy: 493/1071 (46.0317%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.2983, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   1, Avg loss: 0.0667, Accuracy: 272/946 (28.7526%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   2, Avg loss: 0.0387, Accuracy: 317/946 (33.5095%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6803, Accuracy: 52/10000 (0.5200%)
time spent on training: 164.17623949050903
[rfa agg] training data poison_ratio: 0.0  data num: [708, 500, 440, 774, 1154, 1552, 776, 1904, 1071, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 82, 49, 81, 57, 74, 75, 46, 55, 43], weight: tensor([0.0721, 0.0509, 0.0448, 0.0788, 0.1175, 0.1580, 0.0790, 0.1938, 0.1090,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 59.709800720214844, obj_val: 64.0783920288086, abs dis: 4.36859130859375
[rfa agg] iter: 0, weight: tensor([0.0682, 0.0253, 0.0197, 0.0954, 0.1291, 0.0699, 0.0964, 0.0558, 0.2132,
        0.2269])
[rfa agg] iter:  1, prev_obj_val: 64.0783920288086, obj_val: 65.7459487915039, abs dis: 1.6675567626953125
[rfa agg] iter: 1, weight: tensor([0.1045, 0.0302, 0.0228, 0.1565, 0.0802, 0.0524, 0.1668, 0.0445, 0.1188,
        0.2234])
[rfa agg] iter:  2, prev_obj_val: 65.7459487915039, obj_val: 70.2592544555664, abs dis: 4.5133056640625
[rfa agg] iter: 2, weight: tensor([0.1212, 0.0316, 0.0235, 0.1848, 0.0702, 0.0481, 0.2027, 0.0414, 0.0982,
        0.1782])
[rfa agg] iter:  3, prev_obj_val: 70.2592544555664, obj_val: 70.2385482788086, abs dis: 0.0207061767578125
[rfa agg] iter: 3, weight: tensor([0.1702, 0.0388, 0.0280, 0.1953, 0.0618, 0.0453, 0.2148, 0.0399, 0.0812,
        0.1247])
[rfa agg] iter:  4, prev_obj_val: 70.2385482788086, obj_val: 70.23831176757812, abs dis: 0.00023651123046875
[rfa agg] iter: 4, weight: tensor([0.1773, 0.0384, 0.0277, 0.1960, 0.0609, 0.0447, 0.2141, 0.0394, 0.0800,
        0.1214])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 17.0872, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 16.5682, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.8403584957123 sec.
Server Epoch:27 choose agents : [80, 8, 51, 85, 26, 14, 96, 99, 43, 16].
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   1, Avg loss: 0.0781, Accuracy: 84/682 (12.3167%)
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   2, Avg loss: 0.0399, Accuracy: 266/682 (39.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2600, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0672, Accuracy: 192/1513 (12.6900%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0392, Accuracy: 423/1513 (27.9577%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3771, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0650, Accuracy: 182/1049 (17.3499%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0322, Accuracy: 487/1049 (46.4252%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.8634, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0602, Accuracy: 353/1988 (17.7565%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 628/1988 (31.5895%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.6852, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0589, Accuracy: 320/1446 (22.1300%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8636, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 198/1013 (19.5459%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 357/1013 (35.2419%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7177, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   1, Avg loss: 0.0766, Accuracy: 6/311 (1.9293%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   2, Avg loss: 0.0505, Accuracy: 119/311 (38.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0295, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0699, Accuracy: 157/773 (20.3105%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0314, Accuracy: 375/773 (48.5123%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.6826, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0656, Accuracy: 273/946 (28.8584%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0376, Accuracy: 348/946 (36.7865%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8900, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   1, Avg loss: 0.0629, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   2, Avg loss: 0.0344, Accuracy: 419/708 (59.1808%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7740, Accuracy: 73/10000 (0.7300%)
time spent on training: 164.98532724380493
[rfa agg] training data poison_ratio: 0.0  data num: [682, 1513, 1049, 1988, 1446, 1013, 311, 773, 946, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 8, 51, 85, 26, 14, 96, 99, 43, 16], weight: tensor([0.0654, 0.1451, 0.1006, 0.1906, 0.1387, 0.0971, 0.0298, 0.0741, 0.0907,
        0.0679])
[rfa agg] iter:  0, prev_obj_val: 61.132476806640625, obj_val: 65.5978775024414, abs dis: 4.465400695800781
[rfa agg] iter: 0, weight: tensor([0.0446, 0.0977, 0.2212, 0.0590, 0.1086, 0.1944, 0.0105, 0.0698, 0.1405,
        0.0537])
[rfa agg] iter:  1, prev_obj_val: 65.5978775024414, obj_val: 71.89118194580078, abs dis: 6.293304443359375
[rfa agg] iter: 1, weight: tensor([0.0577, 0.0590, 0.1423, 0.0415, 0.0629, 0.2022, 0.0107, 0.1058, 0.2439,
        0.0741])
[rfa agg] iter:  2, prev_obj_val: 71.89118194580078, obj_val: 71.83361053466797, abs dis: 0.0575714111328125
[rfa agg] iter: 2, weight: tensor([0.0936, 0.0550, 0.1020, 0.0413, 0.0577, 0.1376, 0.0134, 0.1806, 0.1934,
        0.1254])
[rfa agg] iter:  3, prev_obj_val: 71.83361053466797, obj_val: 69.49230194091797, abs dis: 2.34130859375
[rfa agg] iter: 3, weight: tensor([0.0930, 0.0541, 0.0996, 0.0407, 0.0569, 0.1333, 0.0132, 0.1945, 0.1867,
        0.1279])
[rfa agg] iter:  4, prev_obj_val: 69.49230194091797, obj_val: 74.42036437988281, abs dis: 4.928062438964844
[rfa agg] iter: 4, weight: tensor([0.0781, 0.0554, 0.1086, 0.0408, 0.0585, 0.1515, 0.0123, 0.1669, 0.2220,
        0.1060])
[rfa agg] iter:  5, prev_obj_val: 74.42036437988281, obj_val: 74.39221954345703, abs dis: 0.02814483642578125
[rfa agg] iter: 5, weight: tensor([0.1116, 0.0528, 0.0916, 0.0404, 0.0552, 0.1184, 0.0142, 0.2061, 0.1587,
        0.1509])
[rfa agg] iter:  6, prev_obj_val: 74.39221954345703, obj_val: 74.39186096191406, abs dis: 0.00035858154296875
[rfa agg] iter: 6, weight: tensor([0.1113, 0.0521, 0.0901, 0.0399, 0.0545, 0.1159, 0.0141, 0.2140, 0.1533,
        0.1546])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 17.9794, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 19.6669, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.48792600631714 sec.
Server Epoch:28 choose agents : [55, 21, 93, 68, 49, 92, 86, 77, 7, 84].
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0575, Accuracy: 231/1071 (21.5686%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0305, Accuracy: 475/1071 (44.3511%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6493, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0574, Accuracy: 346/1949 (17.7527%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0338, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.8472, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0599, Accuracy: 370/1742 (21.2400%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 688/1742 (39.4948%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3120, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0641, Accuracy: 296/1163 (25.4514%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5028, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0910, Accuracy: 4/440 (0.9091%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0537, Accuracy: 138/440 (31.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0367, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0570, Accuracy: 372/1715 (21.6910%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0314, Accuracy: 667/1715 (38.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5323, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   1, Avg loss: 0.0728, Accuracy: 241/1003 (24.0279%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   2, Avg loss: 0.0381, Accuracy: 414/1003 (41.2762%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8970, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 316/1340 (23.5821%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 555/1340 (41.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.5091, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   1, Avg loss: 0.0584, Accuracy: 281/891 (31.5376%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   2, Avg loss: 0.0283, Accuracy: 463/891 (51.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.1805, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   1, Avg loss: 0.0644, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0753, Accuracy: 72/10000 (0.7200%)
time spent on training: 181.0223617553711
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 1949, 1742, 1163, 440, 1715, 1003, 1340, 891, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 21, 93, 68, 49, 92, 86, 77, 7, 84], weight: tensor([0.0857, 0.1559, 0.1393, 0.0930, 0.0352, 0.1372, 0.0802, 0.1072, 0.0713,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 55.64143753051758, obj_val: 60.37836837768555, abs dis: 4.736930847167969
[rfa agg] iter: 0, weight: tensor([0.1197, 0.0473, 0.0559, 0.2232, 0.0106, 0.0611, 0.0887, 0.1400, 0.0501,
        0.2033])
[rfa agg] iter:  1, prev_obj_val: 60.37836837768555, obj_val: 65.02633666992188, abs dis: 4.647968292236328
[rfa agg] iter: 1, weight: tensor([0.1865, 0.0428, 0.0489, 0.1734, 0.0123, 0.0527, 0.1455, 0.1002, 0.0697,
        0.1680])
[rfa agg] iter:  2, prev_obj_val: 65.02633666992188, obj_val: 67.74317169189453, abs dis: 2.7168350219726562
[rfa agg] iter: 2, weight: tensor([0.2074, 0.0409, 0.0459, 0.1248, 0.0139, 0.0491, 0.2167, 0.0837, 0.0937,
        0.1240])
[rfa agg] iter:  3, prev_obj_val: 67.74317169189453, obj_val: 62.54862976074219, abs dis: 5.194541931152344
[rfa agg] iter: 3, weight: tensor([0.1883, 0.0401, 0.0447, 0.1083, 0.0149, 0.0476, 0.2579, 0.0778, 0.1121,
        0.1082])
[rfa agg] iter:  4, prev_obj_val: 62.54862976074219, obj_val: 62.524620056152344, abs dis: 0.02400970458984375
[rfa agg] iter: 4, weight: tensor([0.2116, 0.0410, 0.0464, 0.1375, 0.0128, 0.0497, 0.1970, 0.0895, 0.0799,
        0.1347])
[rfa agg] iter:  5, prev_obj_val: 62.524620056152344, obj_val: 64.99693298339844, abs dis: 2.4723129272460938
[rfa agg] iter: 5, weight: tensor([0.2186, 0.0410, 0.0464, 0.1394, 0.0128, 0.0498, 0.1867, 0.0893, 0.0792,
        0.1368])
[rfa agg] iter:  6, prev_obj_val: 64.99693298339844, obj_val: 64.98955535888672, abs dis: 0.00737762451171875
[rfa agg] iter: 6, weight: tensor([0.2121, 0.0403, 0.0452, 0.1216, 0.0137, 0.0483, 0.2230, 0.0825, 0.0927,
        0.1205])
[rfa agg] iter:  7, prev_obj_val: 64.98955535888672, obj_val: 64.98927307128906, abs dis: 0.00028228759765625
[rfa agg] iter: 7, weight: tensor([0.2089, 0.0400, 0.0449, 0.1200, 0.0136, 0.0480, 0.2313, 0.0820, 0.0925,
        0.1189])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 15.6319, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 16.1137, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.2667860984802 sec.
Server Epoch:29 choose agents : [20, 12, 59, 54, 88, 96, 63, 66, 61, 58].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   1, Avg loss: 0.0599, Accuracy: 258/807 (31.9703%)
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   2, Avg loss: 0.0335, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9219, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0924, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 118/338 (34.9112%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1566, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0573, Accuracy: 237/1089 (21.7631%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.4787, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0594, Accuracy: 273/1130 (24.1593%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 501/1130 (44.3363%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1942, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0931, Accuracy: 31/603 (5.1410%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0489, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6422, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0751, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0488, Accuracy: 119/311 (38.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.7230, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0477, Accuracy: 311/888 (35.0225%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0246, Accuracy: 443/888 (49.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.7571, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0640, Accuracy: 241/1402 (17.1897%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 347/1402 (24.7504%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0192, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   1, Avg loss: 0.1322, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   2, Avg loss: 0.1235, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7937, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0664, Accuracy: 239/803 (29.7634%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0382, Accuracy: 418/803 (52.0548%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9248, Accuracy: 56/10000 (0.5600%)
time spent on training: 158.154887676239
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 338, 1089, 1130, 603, 311, 888, 1402, 85, 803]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 12, 59, 54, 88, 96, 63, 66, 61, 58], weight: tensor([0.1082, 0.0453, 0.1461, 0.1516, 0.0809, 0.0417, 0.1191, 0.1880, 0.0114,
        0.1077])
[rfa agg] iter:  0, prev_obj_val: 44.38152313232422, obj_val: 48.178466796875, abs dis: 3.7969436645507812
[rfa agg] iter: 0, weight: tensor([0.2183, 0.0185, 0.0765, 0.0871, 0.0743, 0.0147, 0.1922, 0.0612, 0.0028,
        0.2545])
[rfa agg] iter:  1, prev_obj_val: 48.178466796875, obj_val: 50.69319152832031, abs dis: 2.5147247314453125
[rfa agg] iter: 1, weight: tensor([0.2208, 0.0234, 0.0722, 0.0810, 0.1126, 0.0182, 0.1608, 0.0608, 0.0033,
        0.2470])
[rfa agg] iter:  2, prev_obj_val: 50.69319152832031, obj_val: 50.685543060302734, abs dis: 0.007648468017578125
[rfa agg] iter: 2, weight: tensor([0.2028, 0.0281, 0.0750, 0.0832, 0.1540, 0.0215, 0.1508, 0.0643, 0.0038,
        0.2166])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 14.4029, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 13.2322, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.840056180954 sec.
Server Epoch:30 choose agents : [70, 49, 92, 67, 44, 24, 1, 14, 90, 0].
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0698, Accuracy: 241/1418 (16.9958%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 540/1418 (38.0818%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.5602, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0911, Accuracy: 2/440 (0.4545%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0549, Accuracy: 128/440 (29.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3182, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   1, Avg loss: 0.0578, Accuracy: 351/1715 (20.4665%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   2, Avg loss: 0.0318, Accuracy: 652/1715 (38.0175%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3578, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0780, Accuracy: 19/426 (4.4601%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0377, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.1139, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0672, Accuracy: 276/1750 (15.7714%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 620/1750 (35.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0731, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.1021, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0576, Accuracy: 93/312 (29.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2382, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 281/928 (30.2802%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0252, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.0521, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0649, Accuracy: 171/1013 (16.8806%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.7570, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0612, Accuracy: 210/677 (31.0192%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.0675, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 317/1657 (19.1310%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0364, Accuracy: 470/1657 (28.3645%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.5057, Accuracy: 64/10000 (0.6400%)
time spent on training: 189.52385807037354
[rfa agg] training data poison_ratio: 0.16031346749226005  data num: [1418, 440, 1715, 426, 1750, 312, 928, 1013, 677, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.05009795859133127
[rfa agg] init. name: [70, 49, 92, 67, 44, 24, 1, 14, 90, 0], weight: tensor([0.1372, 0.0426, 0.1659, 0.0412, 0.1693, 0.0302, 0.0898, 0.0980, 0.0655,
        0.1603])
[rfa agg] iter:  0, prev_obj_val: 67.75360107421875, obj_val: 67.68264770507812, abs dis: 0.070953369140625
[rfa agg] iter: 0, weight: tensor([0.1747, 0.0231, 0.1199, 0.0224, 0.1111, 0.0139, 0.1441, 0.2049, 0.0544,
        0.1315])
[rfa agg] iter:  1, prev_obj_val: 67.68264770507812, obj_val: 67.68252563476562, abs dis: 0.0001220703125
[rfa agg] iter: 1, weight: tensor([0.1740, 0.0229, 0.1183, 0.0221, 0.1097, 0.0137, 0.1450, 0.2108, 0.0538,
        0.1298])
[rfa agg] iter:  2, prev_obj_val: 67.68252563476562, obj_val: 68.89146423339844, abs dis: 1.2089385986328125
[rfa agg] iter: 2, weight: tensor([0.1738, 0.0229, 0.1182, 0.0221, 0.1097, 0.0137, 0.1450, 0.2111, 0.0538,
        0.1297])
[rfa agg] iter:  3, prev_obj_val: 68.89146423339844, obj_val: 70.14482116699219, abs dis: 1.25335693359375
[rfa agg] iter: 3, weight: tensor([0.1551, 0.0233, 0.1092, 0.0225, 0.1017, 0.0138, 0.1594, 0.2400, 0.0560,
        0.1190])
[rfa agg] iter:  4, prev_obj_val: 70.14482116699219, obj_val: 70.1362533569336, abs dis: 0.00856781005859375
[rfa agg] iter: 4, weight: tensor([0.1355, 0.0232, 0.0988, 0.0224, 0.0923, 0.0137, 0.1745, 0.2756, 0.0572,
        0.1069])
[rfa agg] iter:  5, prev_obj_val: 70.1362533569336, obj_val: 70.13614654541016, abs dis: 0.0001068115234375
[rfa agg] iter: 5, weight: tensor([0.1339, 0.0230, 0.0979, 0.0222, 0.0915, 0.0135, 0.1744, 0.2809, 0.0567,
        0.1059])
[rfa agg] iter:  6, prev_obj_val: 70.13614654541016, obj_val: 68.8927001953125, abs dis: 1.2434463500976562
[rfa agg] iter: 6, weight: tensor([0.1337, 0.0230, 0.0978, 0.0222, 0.0914, 0.0135, 0.1742, 0.2817, 0.0567,
        0.1058])
[rfa agg] iter:  7, prev_obj_val: 68.8927001953125, obj_val: 70.1427001953125, abs dis: 1.25
[rfa agg] iter: 7, weight: tensor([0.1522, 0.0231, 0.1080, 0.0223, 0.1006, 0.0137, 0.1598, 0.2471, 0.0555,
        0.1177])
[rfa agg] iter:  8, prev_obj_val: 70.1427001953125, obj_val: 70.13622283935547, abs dis: 0.00647735595703125
[rfa agg] iter: 8, weight: tensor([0.1352, 0.0231, 0.0986, 0.0224, 0.0922, 0.0136, 0.1743, 0.2766, 0.0571,
        0.1068])
[rfa agg] iter:  9, prev_obj_val: 70.13622283935547, obj_val: 70.13614654541016, abs dis: 7.62939453125e-05
[rfa agg] iter: 9, weight: tensor([0.1338, 0.0230, 0.0978, 0.0222, 0.0915, 0.0135, 0.1743, 0.2811, 0.0567,
        0.1059])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.0095, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 9.1647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.5622925758362 sec.
Server Epoch:31 choose agents : [70, 30, 32, 95, 1, 61, 22, 99, 68, 97].
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0671, Accuracy: 248/1418 (17.4894%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0333, Accuracy: 574/1418 (40.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5625, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0876, Accuracy: 15/486 (3.0864%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.4516, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0746, Accuracy: 107/735 (14.5578%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.3410, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0708, Accuracy: 185/599 (30.8848%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0325, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 14.5093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 278/928 (29.9569%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 593/928 (63.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.0304, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1331, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1225, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.2659, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0494, Accuracy: 462/1470 (31.4286%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 803/1470 (54.6259%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.4240, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 159/773 (20.5692%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   2, Avg loss: 0.0287, Accuracy: 378/773 (48.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.0540, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   1, Avg loss: 0.0658, Accuracy: 291/1163 (25.0215%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 432/1163 (37.1453%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2559, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0582, Accuracy: 269/1213 (22.1764%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 503/1213 (41.4674%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.7779, Accuracy: 84/10000 (0.8400%)
time spent on training: 159.74436712265015
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 486, 735, 599, 928, 85, 1470, 773, 1163, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 30, 32, 95, 1, 61, 22, 99, 68, 97], weight: tensor([0.1599, 0.0548, 0.0829, 0.0675, 0.1046, 0.0096, 0.1657, 0.0871, 0.1311,
        0.1368])
[rfa agg] iter:  0, prev_obj_val: 48.6004524230957, obj_val: 51.52611541748047, abs dis: 2.9256629943847656
[rfa agg] iter: 0, weight: tensor([0.0834, 0.0323, 0.1059, 0.0551, 0.2347, 0.0029, 0.0860, 0.1374, 0.1279,
        0.1344])
[rfa agg] iter:  1, prev_obj_val: 51.52611541748047, obj_val: 53.34421920776367, abs dis: 1.8181037902832031
[rfa agg] iter: 1, weight: tensor([0.0716, 0.0359, 0.1372, 0.0648, 0.2244, 0.0030, 0.0740, 0.1808, 0.1016,
        0.1068])
[rfa agg] iter:  2, prev_obj_val: 53.34421920776367, obj_val: 55.38005447387695, abs dis: 2.0358352661132812
[rfa agg] iter: 2, weight: tensor([0.0671, 0.0384, 0.1624, 0.0719, 0.1903, 0.0030, 0.0694, 0.2089, 0.0920,
        0.0964])
[rfa agg] iter:  3, prev_obj_val: 55.38005447387695, obj_val: 60.22640609741211, abs dis: 4.846351623535156
[rfa agg] iter: 3, weight: tensor([0.0629, 0.0412, 0.1943, 0.0805, 0.1582, 0.0031, 0.0649, 0.2237, 0.0837,
        0.0875])
[rfa agg] iter:  4, prev_obj_val: 60.22640609741211, obj_val: 60.19498825073242, abs dis: 0.0314178466796875
[rfa agg] iter: 4, weight: tensor([0.0580, 0.0507, 0.2540, 0.1096, 0.1210, 0.0034, 0.0599, 0.1933, 0.0734,
        0.0767])
[rfa agg] iter:  5, prev_obj_val: 60.19498825073242, obj_val: 63.01041030883789, abs dis: 2.8154220581054688
[rfa agg] iter: 5, weight: tensor([0.0568, 0.0499, 0.2749, 0.1090, 0.1169, 0.0033, 0.0586, 0.1837, 0.0719,
        0.0750])
[rfa agg] iter:  6, prev_obj_val: 63.01041030883789, obj_val: 63.005828857421875, abs dis: 0.004581451416015625
[rfa agg] iter: 6, weight: tensor([0.0568, 0.0582, 0.2717, 0.1350, 0.1086, 0.0036, 0.0587, 0.1636, 0.0704,
        0.0734])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.7407, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 7.7981, Accuracy: 1/9950 (0.0101%)
saving model
Done in 260.894896030426 sec.
Server Epoch:32 choose agents : [31, 27, 46, 19, 20, 85, 9, 91, 81, 59].
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0918, Accuracy: 37/460 (8.0435%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0455, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8094, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0576, Accuracy: 392/1587 (24.7007%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0354, Accuracy: 586/1587 (36.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.3946, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0589, Accuracy: 340/1904 (17.8571%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 672/1904 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.5755, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0525, Accuracy: 339/1036 (32.7220%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0273, Accuracy: 603/1036 (58.2046%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.7710, Accuracy: 64/10000 (0.6400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0597, Accuracy: 265/807 (32.8377%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2024, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0619, Accuracy: 331/1988 (16.6499%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 634/1988 (31.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2844, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0564, Accuracy: 292/1275 (22.9020%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 671/1275 (52.6275%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.1709, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 314/1030 (30.4854%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   2, Avg loss: 0.0287, Accuracy: 582/1030 (56.5049%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.9509, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   1, Avg loss: 0.0715, Accuracy: 210/774 (27.1318%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   2, Avg loss: 0.0387, Accuracy: 316/774 (40.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4875, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   1, Avg loss: 0.0629, Accuracy: 259/1089 (23.7833%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 429/1089 (39.3939%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 14.5737, Accuracy: 55/10000 (0.5500%)
time spent on training: 195.4925138950348
[rfa agg] training data poison_ratio: 0.06753138075313808  data num: [460, 1587, 1904, 1036, 807, 1988, 1275, 1030, 774, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.02110355648535565
[rfa agg] init. name: [31, 27, 46, 19, 20, 85, 9, 91, 81, 59], weight: tensor([0.0385, 0.1328, 0.1593, 0.0867, 0.0675, 0.1664, 0.1067, 0.0862, 0.0648,
        0.0911])
[rfa agg] iter:  0, prev_obj_val: 64.0042953491211, obj_val: 65.8248519897461, abs dis: 1.820556640625
[rfa agg] iter: 0, weight: tensor([0.0168, 0.1016, 0.0696, 0.1640, 0.0529, 0.0616, 0.2260, 0.1383, 0.0505,
        0.1188])
[rfa agg] iter:  1, prev_obj_val: 65.8248519897461, obj_val: 67.1653060913086, abs dis: 1.3404541015625
[rfa agg] iter: 1, weight: tensor([0.0171, 0.0822, 0.0593, 0.2126, 0.0580, 0.0531, 0.1802, 0.1651, 0.0552,
        0.1171])
[rfa agg] iter:  2, prev_obj_val: 67.1653060913086, obj_val: 68.8027114868164, abs dis: 1.6374053955078125
[rfa agg] iter: 2, weight: tensor([0.0174, 0.0745, 0.0551, 0.2448, 0.0618, 0.0497, 0.1493, 0.1768, 0.0586,
        0.1121])
[rfa agg] iter:  3, prev_obj_val: 68.8027114868164, obj_val: 68.79804229736328, abs dis: 0.004669189453125
[rfa agg] iter: 3, weight: tensor([0.0180, 0.0691, 0.0522, 0.2650, 0.0674, 0.0473, 0.1287, 0.1815, 0.0638,
        0.1068])
[rfa agg] iter:  4, prev_obj_val: 68.79804229736328, obj_val: 68.79788208007812, abs dis: 0.00016021728515625
[rfa agg] iter: 4, weight: tensor([0.0179, 0.0686, 0.0518, 0.2705, 0.0671, 0.0470, 0.1269, 0.1814, 0.0634,
        0.1055])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8122, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 3.7209, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.6167814731598 sec.
Server Epoch:33 choose agents : [49, 13, 80, 70, 48, 78, 56, 37, 83, 46].
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0888, Accuracy: 3/440 (0.6818%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0525, Accuracy: 138/440 (31.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3603, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0651, Accuracy: 280/1645 (17.0213%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0349, Accuracy: 550/1645 (33.4347%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6870, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   1, Avg loss: 0.0738, Accuracy: 94/682 (13.7830%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   2, Avg loss: 0.0395, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.3704, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0651, Accuracy: 265/1418 (18.6883%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0328, Accuracy: 589/1418 (41.5374%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.7672, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0863, Accuracy: 40/631 (6.3391%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0489, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.3180, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   1, Avg loss: 0.0990, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   2, Avg loss: 0.0535, Accuracy: 160/416 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4351, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   1, Avg loss: 0.0928, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   2, Avg loss: 0.0762, Accuracy: 14/186 (7.5269%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.6207, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 403/1129 (35.6953%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 684/1129 (60.5846%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.1065, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   1, Avg loss: 0.0570, Accuracy: 411/1953 (21.0445%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   2, Avg loss: 0.0349, Accuracy: 718/1953 (36.7640%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9303, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   1, Avg loss: 0.0585, Accuracy: 342/1904 (17.9622%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 664/1904 (34.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8815, Accuracy: 115/10000 (1.1500%)
time spent on training: 179.6744978427887
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1645, 682, 1418, 631, 416, 186, 1129, 1953, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 13, 80, 70, 48, 78, 56, 37, 83, 46], weight: tensor([0.0423, 0.1581, 0.0656, 0.1363, 0.0606, 0.0400, 0.0179, 0.1085, 0.1877,
        0.1830])
[rfa agg] iter:  0, prev_obj_val: 75.35711669921875, obj_val: 76.61927795410156, abs dis: 1.2621612548828125
[rfa agg] iter: 0, weight: tensor([0.0208, 0.1610, 0.0465, 0.2370, 0.0388, 0.0196, 0.0065, 0.2464, 0.1083,
        0.1151])
[rfa agg] iter:  1, prev_obj_val: 76.61927795410156, obj_val: 76.60550689697266, abs dis: 0.01377105712890625
[rfa agg] iter: 1, weight: tensor([0.0209, 0.1456, 0.0474, 0.2146, 0.0394, 0.0197, 0.0065, 0.3000, 0.1000,
        0.1058])
[rfa agg] iter:  2, prev_obj_val: 76.60550689697266, obj_val: 75.15922546386719, abs dis: 1.4462814331054688
[rfa agg] iter: 2, weight: tensor([0.0206, 0.1438, 0.0469, 0.2108, 0.0390, 0.0195, 0.0064, 0.3095, 0.0989,
        0.1046])
[rfa agg] iter:  3, prev_obj_val: 75.15922546386719, obj_val: 76.61274719238281, abs dis: 1.453521728515625
[rfa agg] iter: 3, weight: tensor([0.0200, 0.1553, 0.0446, 0.2368, 0.0373, 0.0189, 0.0063, 0.2672, 0.1037,
        0.1100])
[rfa agg] iter:  4, prev_obj_val: 76.61274719238281, obj_val: 76.60531616210938, abs dis: 0.0074310302734375
[rfa agg] iter: 4, weight: tensor([0.0208, 0.1448, 0.0472, 0.2137, 0.0392, 0.0196, 0.0065, 0.3033, 0.0996,
        0.1053])
[rfa agg] iter:  5, prev_obj_val: 76.60531616210938, obj_val: 75.15941619873047, abs dis: 1.4458999633789062
[rfa agg] iter: 5, weight: tensor([0.0206, 0.1436, 0.0469, 0.2106, 0.0390, 0.0195, 0.0064, 0.3100, 0.0988,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 75.15941619873047, obj_val: 76.61273193359375, abs dis: 1.4533157348632812
[rfa agg] iter: 6, weight: tensor([0.0200, 0.1552, 0.0446, 0.2367, 0.0373, 0.0189, 0.0063, 0.2672, 0.1037,
        0.1100])
[rfa agg] iter:  7, prev_obj_val: 76.61273193359375, obj_val: 76.60531616210938, abs dis: 0.007415771484375
[rfa agg] iter: 7, weight: tensor([0.0208, 0.1448, 0.0472, 0.2137, 0.0392, 0.0196, 0.0065, 0.3033, 0.0996,
        0.1053])
[rfa agg] iter:  8, prev_obj_val: 76.60531616210938, obj_val: 75.15941619873047, abs dis: 1.4458999633789062
[rfa agg] iter: 8, weight: tensor([0.0206, 0.1436, 0.0469, 0.2106, 0.0390, 0.0195, 0.0064, 0.3100, 0.0988,
        0.1045])
[rfa agg] iter:  9, prev_obj_val: 75.15941619873047, obj_val: 76.61273193359375, abs dis: 1.4533157348632812
[rfa agg] iter: 9, weight: tensor([0.0200, 0.1552, 0.0446, 0.2367, 0.0373, 0.0189, 0.0063, 0.2672, 0.1037,
        0.1100])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.6226, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 9.2713, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.6289188861847 sec.
Server Epoch:34 choose agents : [60, 55, 12, 50, 72, 14, 25, 49, 31, 77].
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0516, Accuracy: 584/2227 (26.2236%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 991/2227 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7726, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0588, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0306, Accuracy: 509/1071 (47.5257%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.9427, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 12/338 (3.5503%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6771, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0697, Accuracy: 101/809 (12.4845%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 318/809 (39.3078%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.1270, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0705, Accuracy: 207/1241 (16.6801%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0382, Accuracy: 369/1241 (29.7341%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.9474, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 179/1013 (17.6703%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 320/1013 (31.5893%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.2807, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   1, Avg loss: 0.0581, Accuracy: 232/690 (33.6232%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.2031, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0894, Accuracy: 5/440 (1.1364%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0532, Accuracy: 126/440 (28.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.4067, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   1, Avg loss: 0.0940, Accuracy: 31/460 (6.7391%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   2, Avg loss: 0.0503, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0045, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   1, Avg loss: 0.0520, Accuracy: 332/1340 (24.7761%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 571/1340 (42.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.5181, Accuracy: 79/10000 (0.7900%)
time spent on training: 169.1795117855072
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1071, 338, 809, 1241, 1013, 690, 440, 460, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 55, 12, 50, 72, 14, 25, 49, 31, 77], weight: tensor([0.2313, 0.1112, 0.0351, 0.0840, 0.1289, 0.1052, 0.0717, 0.0457, 0.0478,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 69.3875961303711, obj_val: 70.24533081054688, abs dis: 0.8577346801757812
[rfa agg] iter: 0, weight: tensor([0.0575, 0.2356, 0.0131, 0.0767, 0.1796, 0.1972, 0.0472, 0.0187, 0.0216,
        0.1527])
[rfa agg] iter:  1, prev_obj_val: 70.24533081054688, obj_val: 72.5844497680664, abs dis: 2.3391189575195312
[rfa agg] iter: 1, weight: tensor([0.0499, 0.2553, 0.0130, 0.0868, 0.1302, 0.2575, 0.0505, 0.0188, 0.0221,
        0.1159])
[rfa agg] iter:  2, prev_obj_val: 72.5844497680664, obj_val: 72.56568908691406, abs dis: 0.01876068115234375
[rfa agg] iter: 2, weight: tensor([0.0493, 0.2112, 0.0149, 0.1160, 0.1096, 0.2873, 0.0631, 0.0218, 0.0259,
        0.1008])
[rfa agg] iter:  3, prev_obj_val: 72.56568908691406, obj_val: 74.12931823730469, abs dis: 1.563629150390625
[rfa agg] iter: 3, weight: tensor([0.0490, 0.2036, 0.0149, 0.1166, 0.1088, 0.2968, 0.0629, 0.0217, 0.0258,
        0.1000])
[rfa agg] iter:  4, prev_obj_val: 74.12931823730469, obj_val: 75.85247039794922, abs dis: 1.7231521606445312
[rfa agg] iter: 4, weight: tensor([0.0507, 0.1857, 0.0165, 0.1426, 0.1054, 0.2738, 0.0739, 0.0243, 0.0292,
        0.0979])
[rfa agg] iter:  5, prev_obj_val: 75.85247039794922, obj_val: 77.6961441040039, abs dis: 1.8436737060546875
[rfa agg] iter: 5, weight: tensor([0.0520, 0.1689, 0.0184, 0.1782, 0.1023, 0.2368, 0.0877, 0.0272, 0.0329,
        0.0956])
[rfa agg] iter:  6, prev_obj_val: 77.6961441040039, obj_val: 79.6616439819336, abs dis: 1.9654998779296875
[rfa agg] iter: 6, weight: tensor([0.0519, 0.1509, 0.0199, 0.2209, 0.0968, 0.1999, 0.1026, 0.0297, 0.0363,
        0.0911])
[rfa agg] iter:  7, prev_obj_val: 79.6616439819336, obj_val: 81.78099060058594, abs dis: 2.1193466186523438
[rfa agg] iter: 7, weight: tensor([0.0503, 0.1323, 0.0209, 0.2658, 0.0894, 0.1674, 0.1187, 0.0316, 0.0390,
        0.0847])
[rfa agg] iter:  8, prev_obj_val: 81.78099060058594, obj_val: 81.76951599121094, abs dis: 0.011474609375
[rfa agg] iter: 8, weight: tensor([0.0483, 0.1160, 0.0219, 0.2984, 0.0819, 0.1416, 0.1386, 0.0334, 0.0418,
        0.0781])
[rfa agg] iter:  9, prev_obj_val: 81.76951599121094, obj_val: 79.65071868896484, abs dis: 2.1187973022460938
[rfa agg] iter: 9, weight: tensor([0.0474, 0.1135, 0.0215, 0.3111, 0.0805, 0.1377, 0.1376, 0.0328, 0.0411,
        0.0766])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.9081, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 8.1744, Accuracy: 2/9950 (0.0201%)
saving model
Done in 271.2802908420563 sec.
Server Epoch:35 choose agents : [56, 59, 12, 2, 67, 49, 72, 34, 13, 42].
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0944, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0768, Accuracy: 20/186 (10.7527%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.6429, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0680, Accuracy: 237/1089 (21.7631%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 451/1089 (41.4141%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 12.2008, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0886, Accuracy: 8/338 (2.3669%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.5022, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0663, Accuracy: 169/605 (27.9339%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0426, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1758, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 14/426 (3.2864%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0395, Accuracy: 183/426 (42.9577%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.1850, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0923, Accuracy: 2/440 (0.4545%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0537, Accuracy: 127/440 (28.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2016, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   1, Avg loss: 0.0695, Accuracy: 197/1241 (15.8743%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   2, Avg loss: 0.0377, Accuracy: 402/1241 (32.3932%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.5213, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   1, Avg loss: 0.0688, Accuracy: 322/1427 (22.5648%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 555/1427 (38.8928%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0084, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   1, Avg loss: 0.0646, Accuracy: 283/1645 (17.2036%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   2, Avg loss: 0.0350, Accuracy: 563/1645 (34.2249%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7097, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   1, Avg loss: 0.0633, Accuracy: 223/1372 (16.2536%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   2, Avg loss: 0.0326, Accuracy: 478/1372 (34.8397%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.5272, Accuracy: 86/10000 (0.8600%)
time spent on training: 168.85123825073242
[rfa agg] training data poison_ratio: 0.0  data num: [186, 1089, 338, 605, 426, 440, 1241, 1427, 1645, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 59, 12, 2, 67, 49, 72, 34, 13, 42], weight: tensor([0.0212, 0.1242, 0.0385, 0.0690, 0.0486, 0.0502, 0.1415, 0.1627, 0.1876,
        0.1565])
[rfa agg] iter:  0, prev_obj_val: 64.67813110351562, obj_val: 60.56038284301758, abs dis: 4.117748260498047
[rfa agg] iter: 0, weight: tensor([0.0097, 0.2086, 0.0238, 0.0705, 0.0334, 0.0345, 0.2047, 0.1420, 0.1164,
        0.1564])
[rfa agg] iter:  1, prev_obj_val: 60.56038284301758, obj_val: 57.064125061035156, abs dis: 3.496257781982422
[rfa agg] iter: 1, weight: tensor([0.0079, 0.2260, 0.0189, 0.0531, 0.0263, 0.0272, 0.2272, 0.1423, 0.1117,
        0.1594])
[rfa agg] iter:  2, prev_obj_val: 57.064125061035156, obj_val: 58.72996520996094, abs dis: 1.6658401489257812
[rfa agg] iter: 2, weight: tensor([0.0065, 0.2137, 0.0152, 0.0407, 0.0209, 0.0216, 0.2612, 0.1455, 0.1086,
        0.1662])
[rfa agg] iter:  3, prev_obj_val: 58.72996520996094, obj_val: 60.5519905090332, abs dis: 1.8220252990722656
[rfa agg] iter: 3, weight: tensor([0.0071, 0.2214, 0.0168, 0.0462, 0.0233, 0.0241, 0.2457, 0.1434, 0.1097,
        0.1621])
[rfa agg] iter:  4, prev_obj_val: 60.5519905090332, obj_val: 58.729286193847656, abs dis: 1.8227043151855469
[rfa agg] iter: 4, weight: tensor([0.0079, 0.2285, 0.0188, 0.0526, 0.0261, 0.0270, 0.2281, 0.1416, 0.1111,
        0.1584])
[rfa agg] iter:  5, prev_obj_val: 58.729286193847656, obj_val: 58.72776794433594, abs dis: 0.00151824951171875
[rfa agg] iter: 5, weight: tensor([0.0071, 0.2255, 0.0169, 0.0462, 0.0233, 0.0241, 0.2423, 0.1432, 0.1097,
        0.1617])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 11.2456, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 9.1678, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.36286902427673 sec.
Server Epoch:36 choose agents : [7, 12, 61, 44, 77, 43, 52, 34, 92, 71].
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0598, Accuracy: 256/891 (28.7318%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0291, Accuracy: 417/891 (46.8013%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.7846, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 2/338 (0.5917%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8517, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1311, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1215, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0739, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0660, Accuracy: 309/1750 (17.6571%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0367, Accuracy: 649/1750 (37.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1892, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0521, Accuracy: 341/1340 (25.4478%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 552/1340 (41.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.9642, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0666, Accuracy: 244/946 (25.7928%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 367/946 (38.7949%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9475, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0598, Accuracy: 216/636 (33.9623%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.2835, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0700, Accuracy: 323/1427 (22.6349%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0354, Accuracy: 526/1427 (36.8605%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3776, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   1, Avg loss: 0.0573, Accuracy: 369/1715 (21.5160%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 659/1715 (38.4257%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.2717, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 139/818 (16.9927%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 354/818 (43.2763%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.4964, Accuracy: 65/10000 (0.6500%)
time spent on training: 181.230731010437
[rfa agg] training data poison_ratio: 0.0  data num: [891, 338, 85, 1750, 1340, 946, 636, 1427, 1715, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 12, 61, 44, 77, 43, 52, 34, 92, 71], weight: tensor([0.0896, 0.0340, 0.0085, 0.1760, 0.1347, 0.0951, 0.0639, 0.1435, 0.1724,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 61.75477600097656, obj_val: 63.907222747802734, abs dis: 2.152446746826172
[rfa agg] iter: 0, weight: tensor([0.1171, 0.0158, 0.0028, 0.0988, 0.2100, 0.1609, 0.0448, 0.1532, 0.1067,
        0.0898])
[rfa agg] iter:  1, prev_obj_val: 63.907222747802734, obj_val: 66.3972396850586, abs dis: 2.4900169372558594
[rfa agg] iter: 1, weight: tensor([0.1423, 0.0166, 0.0029, 0.0865, 0.1681, 0.2110, 0.0489, 0.1258, 0.0927,
        0.1053])
[rfa agg] iter:  2, prev_obj_val: 66.3972396850586, obj_val: 66.3692398071289, abs dis: 0.0279998779296875
[rfa agg] iter: 2, weight: tensor([0.1690, 0.0162, 0.0027, 0.0711, 0.1236, 0.2743, 0.0505, 0.0973, 0.0756,
        0.1197])
[rfa agg] iter:  3, prev_obj_val: 66.3692398071289, obj_val: 67.78944396972656, abs dis: 1.4202041625976562
[rfa agg] iter: 3, weight: tensor([0.1688, 0.0160, 0.0027, 0.0699, 0.1208, 0.2839, 0.0498, 0.0955, 0.0744,
        0.1183])
[rfa agg] iter:  4, prev_obj_val: 67.78944396972656, obj_val: 69.4120101928711, abs dis: 1.6225662231445312
[rfa agg] iter: 4, weight: tensor([0.1812, 0.0154, 0.0026, 0.0620, 0.1026, 0.3128, 0.0498, 0.0827, 0.0658,
        0.1251])
[rfa agg] iter:  5, prev_obj_val: 69.4120101928711, obj_val: 69.4079360961914, abs dis: 0.0040740966796875
[rfa agg] iter: 5, weight: tensor([0.1972, 0.0151, 0.0025, 0.0556, 0.0883, 0.3241, 0.0506, 0.0724, 0.0588,
        0.1355])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 12.0023, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 9.8478, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.21051502227783 sec.
Server Epoch:37 choose agents : [11, 33, 59, 95, 52, 25, 78, 26, 47, 1].
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0558, Accuracy: 291/712 (40.8708%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.5661, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0752, Accuracy: 55/515 (10.6796%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0569, Accuracy: 112/515 (21.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3302, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0650, Accuracy: 256/1089 (23.5078%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0342, Accuracy: 432/1089 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.8783, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   1, Avg loss: 0.0730, Accuracy: 177/599 (29.5492%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 15.6388, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0611, Accuracy: 202/636 (31.7610%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.7155, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 235/690 (34.0580%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 11.2037, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   1, Avg loss: 0.0954, Accuracy: 4/416 (0.9615%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   2, Avg loss: 0.0510, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7354, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   1, Avg loss: 0.0591, Accuracy: 301/1446 (20.8160%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7898, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1438, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1344, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.6627, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 259/928 (27.9095%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 560/928 (60.3448%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.6247, Accuracy: 99/10000 (0.9900%)
time spent on training: 155.42778420448303
[rfa agg] training data poison_ratio: 0.0  data num: [712, 515, 1089, 599, 636, 690, 416, 1446, 134, 928]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 33, 59, 95, 52, 25, 78, 26, 47, 1], weight: tensor([0.0994, 0.0719, 0.1520, 0.0836, 0.0888, 0.0963, 0.0581, 0.2018, 0.0187,
        0.1295])
[rfa agg] iter:  0, prev_obj_val: 48.209537506103516, obj_val: 55.418846130371094, abs dis: 7.209308624267578
[rfa agg] iter: 0, weight: tensor([0.1995, 0.0720, 0.0772, 0.1159, 0.1184, 0.1797, 0.0386, 0.0647, 0.0066,
        0.1275])
[rfa agg] iter:  1, prev_obj_val: 55.418846130371094, obj_val: 58.06401062011719, abs dis: 2.6451644897460938
[rfa agg] iter: 1, weight: tensor([0.1150, 0.1248, 0.0540, 0.1836, 0.1711, 0.1585, 0.0621, 0.0492, 0.0079,
        0.0738])
[rfa agg] iter:  2, prev_obj_val: 58.06401062011719, obj_val: 55.267425537109375, abs dis: 2.7965850830078125
[rfa agg] iter: 2, weight: tensor([0.1022, 0.1502, 0.0535, 0.1783, 0.1699, 0.1391, 0.0773, 0.0497, 0.0088,
        0.0709])
[rfa agg] iter:  3, prev_obj_val: 55.267425537109375, obj_val: 58.059757232666016, abs dis: 2.7923316955566406
[rfa agg] iter: 3, weight: tensor([0.1064, 0.1361, 0.0513, 0.1917, 0.1775, 0.1503, 0.0620, 0.0471, 0.0077,
        0.0700])
[rfa agg] iter:  4, prev_obj_val: 58.059757232666016, obj_val: 55.26781463623047, abs dis: 2.791942596435547
[rfa agg] iter: 4, weight: tensor([0.1015, 0.1521, 0.0533, 0.1786, 0.1702, 0.1381, 0.0773, 0.0495, 0.0088,
        0.0706])
[rfa agg] iter:  5, prev_obj_val: 55.26781463623047, obj_val: 58.05970764160156, abs dis: 2.7918930053710938
[rfa agg] iter: 5, weight: tensor([0.1063, 0.1364, 0.0513, 0.1917, 0.1775, 0.1502, 0.0620, 0.0471, 0.0077,
        0.0699])
[rfa agg] iter:  6, prev_obj_val: 58.05970764160156, obj_val: 55.267822265625, abs dis: 2.7918853759765625
[rfa agg] iter: 6, weight: tensor([0.1015, 0.1521, 0.0533, 0.1786, 0.1702, 0.1381, 0.0773, 0.0495, 0.0088,
        0.0706])
[rfa agg] iter:  7, prev_obj_val: 55.267822265625, obj_val: 58.05970764160156, abs dis: 2.7918853759765625
[rfa agg] iter: 7, weight: tensor([0.1063, 0.1364, 0.0513, 0.1917, 0.1775, 0.1502, 0.0620, 0.0471, 0.0077,
        0.0699])
[rfa agg] iter:  8, prev_obj_val: 58.05970764160156, obj_val: 55.267822265625, abs dis: 2.7918853759765625
[rfa agg] iter: 8, weight: tensor([0.1015, 0.1521, 0.0533, 0.1786, 0.1702, 0.1381, 0.0773, 0.0495, 0.0088,
        0.0706])
[rfa agg] iter:  9, prev_obj_val: 55.267822265625, obj_val: 58.05970764160156, abs dis: 2.7918853759765625
[rfa agg] iter: 9, weight: tensor([0.1063, 0.1364, 0.0513, 0.1917, 0.1775, 0.1502, 0.0620, 0.0471, 0.0077,
        0.0699])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 11.8881, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 10.8909, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.9696705341339 sec.
Server Epoch:38 choose agents : [84, 78, 4, 39, 42, 59, 73, 34, 20, 88].
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   1, Avg loss: 0.0648, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   2, Avg loss: 0.0337, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6428, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   1, Avg loss: 0.0958, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   2, Avg loss: 0.0517, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7012, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0669, Accuracy: 272/901 (30.1887%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 422/901 (46.8368%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6322, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0593, Accuracy: 236/1013 (23.2971%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0274, Accuracy: 492/1013 (48.5686%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.3851, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0602, Accuracy: 250/1372 (18.2216%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0331, Accuracy: 448/1372 (32.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.2635, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0589, Accuracy: 261/1089 (23.9669%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 493/1089 (45.2709%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0856, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0733, Accuracy: 130/938 (13.8593%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0360, Accuracy: 332/938 (35.3945%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.1362, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   1, Avg loss: 0.0671, Accuracy: 336/1427 (23.5459%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   2, Avg loss: 0.0348, Accuracy: 561/1427 (39.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1202, Accuracy: 80/10000 (0.8000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0622, Accuracy: 256/807 (31.7224%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0342, Accuracy: 394/807 (48.8228%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0134, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0832, Accuracy: 57/603 (9.4527%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4992, Accuracy: 59/10000 (0.5900%)
time spent on training: 189.96715188026428
[rfa agg] training data poison_ratio: 0.08271832718327184  data num: [1190, 416, 901, 1013, 1372, 1089, 938, 1427, 807, 603]
[rfa agg] considering poison per batch poison_fraction: 0.025849477244772448
[rfa agg] init. name: [84, 78, 4, 39, 42, 59, 73, 34, 20, 88], weight: tensor([0.1220, 0.0426, 0.0924, 0.1038, 0.1406, 0.1116, 0.0961, 0.1463, 0.0827,
        0.0618])
[rfa agg] iter:  0, prev_obj_val: 42.51751708984375, obj_val: 51.27267837524414, abs dis: 8.75516128540039
[rfa agg] iter: 0, weight: tensor([0.0947, 0.0177, 0.1655, 0.1744, 0.0661, 0.0870, 0.1844, 0.0613, 0.1079,
        0.0408])
[rfa agg] iter:  1, prev_obj_val: 51.27267837524414, obj_val: 54.10395812988281, abs dis: 2.831279754638672
[rfa agg] iter: 1, weight: tensor([0.0787, 0.0271, 0.1407, 0.1243, 0.0616, 0.0755, 0.1512, 0.0584, 0.2082,
        0.0742])
[rfa agg] iter:  2, prev_obj_val: 54.10395812988281, obj_val: 54.09844970703125, abs dis: 0.0055084228515625
[rfa agg] iter: 2, weight: tensor([0.0761, 0.0306, 0.1273, 0.1134, 0.0610, 0.0733, 0.1359, 0.0580, 0.2339,
        0.0903])
[rfa agg] iter:  3, prev_obj_val: 54.09844970703125, obj_val: 54.09828567504883, abs dis: 0.000164031982421875
[rfa agg] iter: 3, weight: tensor([0.0756, 0.0305, 0.1259, 0.1124, 0.0605, 0.0728, 0.1345, 0.0576, 0.2401,
        0.0902])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 12.6408, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 12.0522, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.46928310394287 sec.
Server Epoch:39 choose agents : [43, 8, 17, 27, 59, 44, 32, 92, 66, 71].
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0669, Accuracy: 236/946 (24.9471%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0376, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8764, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0669, Accuracy: 166/1513 (10.9716%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0396, Accuracy: 398/1513 (26.3054%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3506, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0585, Accuracy: 375/1574 (23.8247%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0296, Accuracy: 619/1574 (39.3266%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.8377, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0588, Accuracy: 376/1587 (23.6925%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0362, Accuracy: 555/1587 (34.9716%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3528, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0584, Accuracy: 251/1089 (23.0487%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0298, Accuracy: 483/1089 (44.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.1985, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0652, Accuracy: 279/1750 (15.9429%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0362, Accuracy: 638/1750 (36.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0049, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0706, Accuracy: 113/735 (15.3741%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 12.5713, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   1, Avg loss: 0.0566, Accuracy: 345/1715 (20.1166%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 630/1715 (36.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4976, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   1, Avg loss: 0.0660, Accuracy: 240/1402 (17.1184%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   2, Avg loss: 0.0407, Accuracy: 346/1402 (24.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2107, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0619, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 354/818 (43.2763%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.5117, Accuracy: 84/10000 (0.8400%)
time spent on training: 214.98867297172546
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1513, 1574, 1587, 1089, 1750, 735, 1715, 1402, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 8, 17, 27, 59, 44, 32, 92, 66, 71], weight: tensor([0.0721, 0.1152, 0.1199, 0.1209, 0.0829, 0.1333, 0.0560, 0.1306, 0.1068,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 52.128021240234375, obj_val: 56.13521957397461, abs dis: 4.007198333740234
[rfa agg] iter: 0, weight: tensor([0.0711, 0.1336, 0.1152, 0.1183, 0.1054, 0.0841, 0.0359, 0.0920, 0.1994,
        0.0451])
[rfa agg] iter:  1, prev_obj_val: 56.13521957397461, obj_val: 56.1220588684082, abs dis: 0.01316070556640625
[rfa agg] iter: 1, weight: tensor([0.0931, 0.1208, 0.1063, 0.1087, 0.1283, 0.0813, 0.0441, 0.0880, 0.1732,
        0.0563])
[rfa agg] iter:  2, prev_obj_val: 56.1220588684082, obj_val: 56.12190246582031, abs dis: 0.000156402587890625
[rfa agg] iter: 2, weight: tensor([0.0934, 0.1202, 0.1061, 0.1084, 0.1316, 0.0811, 0.0440, 0.0878, 0.1713,
        0.0562])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 14.0866, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 14.0892, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.6685287952423 sec.
Server Epoch:40 choose agents : [72, 92, 10, 79, 82, 55, 2, 64, 84, 44].
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0669, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0377, Accuracy: 399/1241 (32.1515%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4720, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0550, Accuracy: 381/1715 (22.2157%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 639/1715 (37.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.9115, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0580, Accuracy: 200/861 (23.2288%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.3896, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   1, Avg loss: 0.0979, Accuracy: 11/197 (5.5838%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 39/197 (19.7970%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3915, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   1, Avg loss: 0.0776, Accuracy: 53/500 (10.6000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 203/500 (40.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.3887, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0617, Accuracy: 230/1071 (21.4753%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.5356, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0712, Accuracy: 138/605 (22.8099%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0433, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.7564, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0686, Accuracy: 145/953 (15.2151%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0943, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0663, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4602, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   1, Avg loss: 0.0650, Accuracy: 277/1750 (15.8286%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 629/1750 (35.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0228, Accuracy: 110/10000 (1.1000%)
time spent on training: 187.280827999115
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1715, 861, 197, 500, 1071, 605, 953, 1190, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 92, 10, 79, 82, 55, 2, 64, 84, 44], weight: tensor([0.1231, 0.1701, 0.0854, 0.0195, 0.0496, 0.1062, 0.0600, 0.0945, 0.1180,
        0.1736])
[rfa agg] iter:  0, prev_obj_val: 57.1967887878418, obj_val: 63.326637268066406, abs dis: 6.129848480224609
[rfa agg] iter: 0, weight: tensor([0.1458, 0.0702, 0.1054, 0.0061, 0.0228, 0.2230, 0.0349, 0.1528, 0.1734,
        0.0655])
[rfa agg] iter:  1, prev_obj_val: 63.326637268066406, obj_val: 63.19925308227539, abs dis: 0.12738418579101562
[rfa agg] iter: 1, weight: tensor([0.0954, 0.0574, 0.1887, 0.0069, 0.0282, 0.1673, 0.0459, 0.2468, 0.1092,
        0.0543])
[rfa agg] iter:  2, prev_obj_val: 63.19925308227539, obj_val: 67.91534423828125, abs dis: 4.716091156005859
[rfa agg] iter: 2, weight: tensor([0.0902, 0.0545, 0.1956, 0.0065, 0.0269, 0.1551, 0.0437, 0.2740, 0.1020,
        0.0516])
[rfa agg] iter:  3, prev_obj_val: 67.91534423828125, obj_val: 65.40264892578125, abs dis: 2.5126953125
[rfa agg] iter: 3, weight: tensor([0.0817, 0.0537, 0.2588, 0.0076, 0.0330, 0.1266, 0.0559, 0.2411, 0.0906,
        0.0511])
[rfa agg] iter:  4, prev_obj_val: 65.40264892578125, obj_val: 70.6628189086914, abs dis: 5.260169982910156
[rfa agg] iter: 4, weight: tensor([0.0829, 0.0524, 0.2459, 0.0068, 0.0288, 0.1336, 0.0479, 0.2592, 0.0926,
        0.0498])
[rfa agg] iter:  5, prev_obj_val: 70.6628189086914, obj_val: 67.8954086303711, abs dis: 2.7674102783203125
[rfa agg] iter: 5, weight: tensor([0.0813, 0.0555, 0.2759, 0.0085, 0.0382, 0.1200, 0.0663, 0.2123, 0.0893,
        0.0529])
[rfa agg] iter:  6, prev_obj_val: 67.8954086303711, obj_val: 67.89322662353516, abs dis: 0.0021820068359375
[rfa agg] iter: 6, weight: tensor([0.0802, 0.0528, 0.2824, 0.0075, 0.0325, 0.1233, 0.0552, 0.2269, 0.0889,
        0.0502])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 13.0592, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 12.4193, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 289.8161988258362 sec.
Server Epoch:41 choose agents : [65, 85, 25, 90, 38, 75, 45, 21, 51, 16].
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0575, Accuracy: 365/1475 (24.7458%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 614/1475 (41.6271%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0853, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0591, Accuracy: 359/1988 (18.0584%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0378, Accuracy: 598/1988 (30.0805%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4286, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 241/690 (34.9275%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0274, Accuracy: 472/690 (68.4058%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.1730, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0651, Accuracy: 204/677 (30.1329%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.8327, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0678, Accuracy: 189/1131 (16.7109%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0320, Accuracy: 446/1131 (39.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0328, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   1, Avg loss: 0.0696, Accuracy: 186/776 (23.9691%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   2, Avg loss: 0.0306, Accuracy: 383/776 (49.3557%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.3833, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2588, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0582, Accuracy: 331/1949 (16.9831%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0345, Accuracy: 594/1949 (30.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.7226, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   1, Avg loss: 0.0709, Accuracy: 162/1049 (15.4433%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 476/1049 (45.3765%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.2163, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   1, Avg loss: 0.0637, Accuracy: 251/708 (35.4520%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   2, Avg loss: 0.0380, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5581, Accuracy: 49/10000 (0.4900%)
time spent on training: 206.04021787643433
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 1988, 690, 677, 1131, 776, 669, 1949, 1049, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 85, 25, 90, 38, 75, 45, 21, 51, 16], weight: tensor([0.1327, 0.1789, 0.0621, 0.0609, 0.1018, 0.0698, 0.0602, 0.1754, 0.0944,
        0.0637])
[rfa agg] iter:  0, prev_obj_val: 74.0414047241211, obj_val: 76.0340576171875, abs dis: 1.9926528930664062
[rfa agg] iter: 0, weight: tensor([0.1419, 0.0836, 0.0467, 0.0460, 0.2407, 0.0686, 0.0453, 0.0889, 0.1845,
        0.0539])
[rfa agg] iter:  1, prev_obj_val: 76.0340576171875, obj_val: 77.06477355957031, abs dis: 1.0307159423828125
[rfa agg] iter: 1, weight: tensor([0.0941, 0.0628, 0.0530, 0.0522, 0.2445, 0.0846, 0.0511, 0.0661, 0.2290,
        0.0625])
[rfa agg] iter:  2, prev_obj_val: 77.06477355957031, obj_val: 79.71456146240234, abs dis: 2.6497879028320312
[rfa agg] iter: 2, weight: tensor([0.0878, 0.0606, 0.0574, 0.0565, 0.2208, 0.0941, 0.0552, 0.0637, 0.2360,
        0.0681])
[rfa agg] iter:  3, prev_obj_val: 79.71456146240234, obj_val: 82.83189392089844, abs dis: 3.1173324584960938
[rfa agg] iter: 3, weight: tensor([0.0812, 0.0589, 0.0707, 0.0697, 0.1755, 0.1237, 0.0678, 0.0616, 0.2053,
        0.0854])
[rfa agg] iter:  4, prev_obj_val: 82.83189392089844, obj_val: 86.40291595458984, abs dis: 3.5710220336914062
[rfa agg] iter: 4, weight: tensor([0.0723, 0.0548, 0.0863, 0.0851, 0.1359, 0.1632, 0.0824, 0.0571, 0.1569,
        0.1060])
[rfa agg] iter:  5, prev_obj_val: 86.40291595458984, obj_val: 84.52044677734375, abs dis: 1.8824691772460938
[rfa agg] iter: 5, weight: tensor([0.0605, 0.0476, 0.1027, 0.1014, 0.1018, 0.2000, 0.0972, 0.0494, 0.1134,
        0.1262])
[rfa agg] iter:  6, prev_obj_val: 84.52044677734375, obj_val: 82.8072280883789, abs dis: 1.7132186889648438
[rfa agg] iter: 6, weight: tensor([0.0655, 0.0507, 0.0942, 0.0926, 0.1152, 0.1936, 0.0896, 0.0527, 0.1280,
        0.1179])
[rfa agg] iter:  7, prev_obj_val: 82.8072280883789, obj_val: 86.39581298828125, abs dis: 3.5885848999023438
[rfa agg] iter: 7, weight: tensor([0.0717, 0.0544, 0.0867, 0.0852, 0.1331, 0.1723, 0.0828, 0.0566, 0.1495,
        0.1079])
[rfa agg] iter:  8, prev_obj_val: 86.39581298828125, obj_val: 84.52066802978516, abs dis: 1.8751449584960938
[rfa agg] iter: 8, weight: tensor([0.0603, 0.0475, 0.1026, 0.1011, 0.1015, 0.2018, 0.0970, 0.0493, 0.1128,
        0.1261])
[rfa agg] iter:  9, prev_obj_val: 84.52066802978516, obj_val: 82.8072738647461, abs dis: 1.7133941650390625
[rfa agg] iter: 9, weight: tensor([0.0655, 0.0507, 0.0942, 0.0925, 0.1151, 0.1939, 0.0896, 0.0527, 0.1279,
        0.1179])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.6885, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 9.9920, Accuracy: 1/9950 (0.0101%)
saving model
Saving model on epoch 41
Done in 306.03988790512085 sec.
Server Epoch:42 choose agents : [4, 43, 67, 60, 32, 45, 94, 15, 38, 34].
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0619, Accuracy: 293/901 (32.5194%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9389, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0663, Accuracy: 259/946 (27.3784%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0385, Accuracy: 333/946 (35.2008%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1761, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0759, Accuracy: 38/426 (8.9202%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0378, Accuracy: 186/426 (43.6620%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.2610, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0522, Accuracy: 529/2227 (23.7539%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 943/2227 (42.3440%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9644, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0662, Accuracy: 120/735 (16.3265%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 13.5823, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0683, Accuracy: 210/669 (31.3901%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0423, Accuracy: 350/669 (52.3169%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.3542, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   1, Avg loss: 0.0623, Accuracy: 292/1662 (17.5692%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   2, Avg loss: 0.0349, Accuracy: 555/1662 (33.3935%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.1564, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0584, Accuracy: 272/1154 (23.5702%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.4217, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   1, Avg loss: 0.0670, Accuracy: 205/1131 (18.1256%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4063, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0662, Accuracy: 339/1427 (23.7561%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 561/1427 (39.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1298, Accuracy: 69/10000 (0.6900%)
time spent on training: 214.75064849853516
[rfa agg] training data poison_ratio: 0.0  data num: [901, 946, 426, 2227, 735, 669, 1662, 1154, 1131, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 43, 67, 60, 32, 45, 94, 15, 38, 34], weight: tensor([0.0799, 0.0839, 0.0378, 0.1975, 0.0652, 0.0593, 0.1474, 0.1023, 0.1003,
        0.1265])
[rfa agg] iter:  0, prev_obj_val: 68.32135009765625, obj_val: 72.3611831665039, abs dis: 4.039833068847656
[rfa agg] iter: 0, weight: tensor([0.0975, 0.1088, 0.0163, 0.0602, 0.0493, 0.0388, 0.0952, 0.1776, 0.2285,
        0.1276])
[rfa agg] iter:  1, prev_obj_val: 72.3611831665039, obj_val: 72.30421447753906, abs dis: 0.05696868896484375
[rfa agg] iter: 1, weight: tensor([0.1420, 0.1754, 0.0185, 0.0509, 0.0650, 0.0489, 0.0725, 0.1363, 0.2014,
        0.0889])
[rfa agg] iter:  2, prev_obj_val: 72.30421447753906, obj_val: 72.30352020263672, abs dis: 0.00069427490234375
[rfa agg] iter: 2, weight: tensor([0.1470, 0.1827, 0.0184, 0.0504, 0.0647, 0.0486, 0.0718, 0.1316, 0.1968,
        0.0880])
[rfa agg] iter:  3, prev_obj_val: 72.30352020263672, obj_val: 73.87615966796875, abs dis: 1.5726394653320312
[rfa agg] iter: 3, weight: tensor([0.1477, 0.1835, 0.0184, 0.0504, 0.0647, 0.0485, 0.0717, 0.1311, 0.1960,
        0.0879])
[rfa agg] iter:  4, prev_obj_val: 73.87615966796875, obj_val: 75.63980865478516, abs dis: 1.7636489868164062
[rfa agg] iter: 4, weight: tensor([0.1617, 0.2109, 0.0191, 0.0485, 0.0706, 0.0521, 0.0675, 0.1183, 0.1702,
        0.0812])
[rfa agg] iter:  5, prev_obj_val: 75.63980865478516, obj_val: 75.62956237792969, abs dis: 0.01024627685546875
[rfa agg] iter: 5, weight: tensor([0.1736, 0.2406, 0.0196, 0.0462, 0.0771, 0.0557, 0.0630, 0.1051, 0.1446,
        0.0745])
[rfa agg] iter:  6, prev_obj_val: 75.62956237792969, obj_val: 75.6292724609375, abs dis: 0.0002899169921875
[rfa agg] iter: 6, weight: tensor([0.1749, 0.2474, 0.0195, 0.0457, 0.0765, 0.0551, 0.0623, 0.1034, 0.1414,
        0.0738])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 11.9078, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 8.6999, Accuracy: 10/9950 (0.1005%)
saving model
Saving model on epoch 42
Done in 315.8663856983185 sec.
Server Epoch:43 choose agents : [30, 90, 78, 76, 95, 4, 91, 40, 31, 21].
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0812, Accuracy: 36/486 (7.4074%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.2531, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0632, Accuracy: 208/677 (30.7238%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 12.0516, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   1, Avg loss: 0.0911, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   2, Avg loss: 0.0493, Accuracy: 166/416 (39.9038%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.4066, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   1, Avg loss: 0.0830, Accuracy: 21/466 (4.5064%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   2, Avg loss: 0.0465, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.6662, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   1, Avg loss: 0.0707, Accuracy: 181/599 (30.2170%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 15.4321, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0584, Accuracy: 320/901 (35.5161%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0364, Accuracy: 411/901 (45.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.3490, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0574, Accuracy: 237/1030 (23.0097%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0285, Accuracy: 568/1030 (55.1456%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 12.8180, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0632, Accuracy: 284/1573 (18.0547%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0365, Accuracy: 554/1573 (35.2193%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3530, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   1, Avg loss: 0.0920, Accuracy: 27/460 (5.8696%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   2, Avg loss: 0.0467, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.7576, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   1, Avg loss: 0.0572, Accuracy: 327/1949 (16.7778%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   2, Avg loss: 0.0344, Accuracy: 577/1949 (29.6049%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.4301, Accuracy: 67/10000 (0.6700%)
time spent on training: 189.85866522789001
[rfa agg] training data poison_ratio: 0.0  data num: [486, 677, 416, 466, 599, 901, 1030, 1573, 460, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 90, 78, 76, 95, 4, 91, 40, 31, 21], weight: tensor([0.0568, 0.0791, 0.0486, 0.0545, 0.0700, 0.1053, 0.1204, 0.1838, 0.0538,
        0.2278])
[rfa agg] iter:  0, prev_obj_val: 75.54595947265625, obj_val: 78.56576538085938, abs dis: 3.019805908203125
[rfa agg] iter: 0, weight: tensor([0.0399, 0.0871, 0.0303, 0.0382, 0.0646, 0.2634, 0.2375, 0.1147, 0.0379,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 78.56576538085938, obj_val: 82.0946044921875, abs dis: 3.528839111328125
[rfa agg] iter: 1, weight: tensor([0.0531, 0.1459, 0.0386, 0.0510, 0.0976, 0.2505, 0.1563, 0.0860, 0.0507,
        0.0704])
[rfa agg] iter:  2, prev_obj_val: 82.0946044921875, obj_val: 83.37588500976562, abs dis: 1.281280517578125
[rfa agg] iter: 2, weight: tensor([0.0652, 0.2323, 0.0453, 0.0627, 0.1383, 0.1547, 0.1083, 0.0706, 0.0625,
        0.0600])
[rfa agg] iter:  3, prev_obj_val: 83.37588500976562, obj_val: 81.99285888671875, abs dis: 1.383026123046875
[rfa agg] iter: 3, weight: tensor([0.0667, 0.2820, 0.0453, 0.0641, 0.1539, 0.1206, 0.0895, 0.0613, 0.0640,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 81.99285888671875, obj_val: 86.78607940673828, abs dis: 4.793220520019531
[rfa agg] iter: 4, weight: tensor([0.0638, 0.2611, 0.0442, 0.0613, 0.1398, 0.1418, 0.1020, 0.0676, 0.0611,
        0.0575])
[rfa agg] iter:  5, prev_obj_val: 86.78607940673828, obj_val: 91.15853881835938, abs dis: 4.372459411621094
[rfa agg] iter: 5, weight: tensor([0.0784, 0.2673, 0.0506, 0.0755, 0.1927, 0.0898, 0.0713, 0.0523, 0.0761,
        0.0459])
[rfa agg] iter:  6, prev_obj_val: 91.15853881835938, obj_val: 93.6768569946289, abs dis: 2.5183181762695312
[rfa agg] iter: 6, weight: tensor([0.1077, 0.1782, 0.0652, 0.1043, 0.2085, 0.0747, 0.0625, 0.0488, 0.1063,
        0.0437])
[rfa agg] iter:  7, prev_obj_val: 93.6768569946289, obj_val: 88.83861541748047, abs dis: 4.8382415771484375
[rfa agg] iter: 7, weight: tensor([0.1307, 0.1402, 0.0759, 0.1265, 0.1803, 0.0685, 0.0585, 0.0470, 0.1298,
        0.0424])
[rfa agg] iter:  8, prev_obj_val: 88.83861541748047, obj_val: 91.1246337890625, abs dis: 2.2860183715820312
[rfa agg] iter: 8, weight: tensor([0.0955, 0.2018, 0.0583, 0.0918, 0.2215, 0.0796, 0.0653, 0.0498, 0.0923,
        0.0442])
[rfa agg] iter:  9, prev_obj_val: 91.1246337890625, obj_val: 93.67562866210938, abs dis: 2.550994873046875
[rfa agg] iter: 9, weight: tensor([0.1090, 0.1711, 0.0654, 0.1054, 0.2153, 0.0737, 0.0617, 0.0483, 0.1070,
        0.0432])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7843, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 3.6732, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.8667480945587 sec.
Server Epoch:44 choose agents : [99, 52, 94, 4, 15, 32, 64, 58, 36, 57].
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   1, Avg loss: 0.0645, Accuracy: 177/773 (22.8978%)
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   2, Avg loss: 0.0282, Accuracy: 418/773 (54.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.0331, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0515, Accuracy: 265/636 (41.6667%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0286, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1790, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   1, Avg loss: 0.0627, Accuracy: 287/1662 (17.2684%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   2, Avg loss: 0.0348, Accuracy: 570/1662 (34.2960%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7041, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0593, Accuracy: 304/901 (33.7403%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0343, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1612, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0594, Accuracy: 266/1154 (23.0503%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 436/1154 (37.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.4889, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0669, Accuracy: 124/735 (16.8707%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 12.7939, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0677, Accuracy: 144/953 (15.1102%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0390, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7738, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0654, Accuracy: 267/803 (33.2503%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0410, Accuracy: 402/803 (50.0623%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3193, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0828, Accuracy: 53/408 (12.9902%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0531, Accuracy: 158/408 (38.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3717, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0691, Accuracy: 218/1154 (18.8908%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0275, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.8943, Accuracy: 67/10000 (0.6700%)
time spent on training: 208.55279803276062
[rfa agg] training data poison_ratio: 0.0  data num: [773, 636, 1662, 901, 1154, 735, 953, 803, 408, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [99, 52, 94, 4, 15, 32, 64, 58, 36, 57], weight: tensor([0.0842, 0.0693, 0.1811, 0.0982, 0.1257, 0.0801, 0.1038, 0.0875, 0.0444,
        0.1257])
[rfa agg] iter:  0, prev_obj_val: 47.19953155517578, obj_val: 54.36618423461914, abs dis: 7.166652679443359
[rfa agg] iter: 0, weight: tensor([0.1256, 0.0546, 0.0519, 0.1424, 0.0769, 0.1089, 0.1885, 0.1526, 0.0210,
        0.0775])
[rfa agg] iter:  1, prev_obj_val: 54.36618423461914, obj_val: 57.01630401611328, abs dis: 2.6501197814941406
[rfa agg] iter: 1, weight: tensor([0.1370, 0.0921, 0.0466, 0.0992, 0.0606, 0.1898, 0.1138, 0.1705, 0.0296,
        0.0608])
[rfa agg] iter:  2, prev_obj_val: 57.01630401611328, obj_val: 54.27918243408203, abs dis: 2.73712158203125
[rfa agg] iter: 2, weight: tensor([0.1303, 0.1140, 0.0469, 0.0909, 0.0593, 0.2076, 0.1026, 0.1550, 0.0339,
        0.0595])
[rfa agg] iter:  3, prev_obj_val: 54.27918243408203, obj_val: 54.27583312988281, abs dis: 0.00334930419921875
[rfa agg] iter: 3, weight: tensor([0.1356, 0.0933, 0.0451, 0.0937, 0.0586, 0.2115, 0.1077, 0.1667, 0.0290,
        0.0587])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8002, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 3.9499, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.8365967273712 sec.
Server Epoch:45 choose agents : [29, 81, 27, 2, 94, 56, 14, 99, 62, 76].
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0557, Accuracy: 371/1440 (25.7639%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0288, Accuracy: 668/1440 (46.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.4871, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   1, Avg loss: 0.0749, Accuracy: 200/774 (25.8398%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   2, Avg loss: 0.0402, Accuracy: 325/774 (41.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5304, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0562, Accuracy: 403/1587 (25.3938%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0358, Accuracy: 564/1587 (35.5388%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2999, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0677, Accuracy: 137/605 (22.6446%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0424, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3103, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   1, Avg loss: 0.0617, Accuracy: 295/1662 (17.7497%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   2, Avg loss: 0.0343, Accuracy: 583/1662 (35.0782%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6492, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.1029, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0840, Accuracy: 4/186 (2.1505%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0708, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0691, Accuracy: 143/1013 (14.1165%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 342/1013 (33.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9684, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   1, Avg loss: 0.0635, Accuracy: 176/773 (22.7684%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 394/773 (50.9702%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 11.7161, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0701, Accuracy: 88/568 (15.4930%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0393, Accuracy: 259/568 (45.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6769, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0826, Accuracy: 28/466 (6.0086%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0467, Accuracy: 184/466 (39.4850%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5923, Accuracy: 58/10000 (0.5800%)
time spent on training: 201.35372066497803
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 774, 1587, 605, 1662, 186, 1013, 773, 568, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 81, 27, 2, 94, 56, 14, 99, 62, 76], weight: tensor([0.1587, 0.0853, 0.1749, 0.0667, 0.1832, 0.0205, 0.1116, 0.0852, 0.0626,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 62.99934768676758, obj_val: 65.30255126953125, abs dis: 2.303203582763672
[rfa agg] iter: 0, weight: tensor([0.1281, 0.1164, 0.1096, 0.0542, 0.1041, 0.0078, 0.2896, 0.1125, 0.0451,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 65.30255126953125, obj_val: 67.86141204833984, abs dis: 2.5588607788085938
[rfa agg] iter: 1, weight: tensor([0.0959, 0.1505, 0.0849, 0.0619, 0.0817, 0.0079, 0.2899, 0.1418, 0.0503,
        0.0351])
[rfa agg] iter:  2, prev_obj_val: 67.86141204833984, obj_val: 71.11742401123047, abs dis: 3.256011962890625
[rfa agg] iter: 2, weight: tensor([0.0849, 0.1935, 0.0767, 0.0739, 0.0743, 0.0084, 0.2137, 0.1757, 0.0589,
        0.0400])
[rfa agg] iter:  3, prev_obj_val: 71.11742401123047, obj_val: 73.0799331665039, abs dis: 1.9625091552734375
[rfa agg] iter: 3, weight: tensor([0.0747, 0.2247, 0.0687, 0.0897, 0.0669, 0.0088, 0.1534, 0.1972, 0.0700,
        0.0458])
[rfa agg] iter:  4, prev_obj_val: 73.0799331665039, obj_val: 71.09063720703125, abs dis: 1.9892959594726562
[rfa agg] iter: 4, weight: tensor([0.0714, 0.2257, 0.0662, 0.1020, 0.0646, 0.0092, 0.1343, 0.1974, 0.0788,
        0.0504])
[rfa agg] iter:  5, prev_obj_val: 71.09063720703125, obj_val: 71.08810424804688, abs dis: 0.002532958984375
[rfa agg] iter: 5, weight: tensor([0.0737, 0.2317, 0.0677, 0.0894, 0.0660, 0.0087, 0.1470, 0.2007, 0.0695,
        0.0455])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9113, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 3.9067, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.0758810043335 sec.
Server Epoch:46 choose agents : [97, 54, 16, 75, 96, 90, 39, 50, 12, 17].
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   1, Avg loss: 0.0584, Accuracy: 271/1213 (22.3413%)
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   2, Avg loss: 0.0308, Accuracy: 478/1213 (39.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.4349, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0645, Accuracy: 247/1130 (21.8584%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0302, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.3561, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0610, Accuracy: 266/708 (37.5706%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.1108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   1, Avg loss: 0.0687, Accuracy: 208/776 (26.8041%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.3653, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0767, Accuracy: 14/311 (4.5016%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0510, Accuracy: 123/311 (39.5498%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.2442, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   1, Avg loss: 0.0600, Accuracy: 239/677 (35.3028%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.6813, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0596, Accuracy: 253/1013 (24.9753%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 472/1013 (46.5943%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.6699, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   1, Avg loss: 0.0705, Accuracy: 121/809 (14.9567%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   2, Avg loss: 0.0307, Accuracy: 341/809 (42.1508%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.7916, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   1, Avg loss: 0.0803, Accuracy: 14/338 (4.1420%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   2, Avg loss: 0.0422, Accuracy: 154/338 (45.5621%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7151, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0602, Accuracy: 321/1574 (20.3939%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0295, Accuracy: 620/1574 (39.3901%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.2162, Accuracy: 89/10000 (0.8900%)
time spent on training: 196.64946508407593
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 1130, 708, 776, 311, 677, 1013, 809, 338, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 54, 16, 75, 96, 90, 39, 50, 12, 17], weight: tensor([0.1419, 0.1322, 0.0828, 0.0908, 0.0364, 0.0792, 0.1185, 0.0946, 0.0395,
        0.1841])
[rfa agg] iter:  0, prev_obj_val: 48.89509201049805, obj_val: 51.935874938964844, abs dis: 3.040782928466797
[rfa agg] iter: 0, weight: tensor([0.0874, 0.0953, 0.1172, 0.1690, 0.0144, 0.0952, 0.1334, 0.2132, 0.0179,
        0.0570])
[rfa agg] iter:  1, prev_obj_val: 51.935874938964844, obj_val: 54.138763427734375, abs dis: 2.2028884887695312
[rfa agg] iter: 1, weight: tensor([0.0712, 0.0763, 0.1402, 0.1728, 0.0152, 0.1212, 0.1022, 0.2318, 0.0193,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 54.138763427734375, obj_val: 54.130306243896484, abs dis: 0.008457183837890625
[rfa agg] iter: 2, weight: tensor([0.0692, 0.0735, 0.1553, 0.1619, 0.0168, 0.1482, 0.0951, 0.2086, 0.0216,
        0.0499])
[rfa agg] iter:  3, prev_obj_val: 54.130306243896484, obj_val: 54.13009262084961, abs dis: 0.000213623046875
[rfa agg] iter: 3, weight: tensor([0.0691, 0.0734, 0.1584, 0.1597, 0.0168, 0.1518, 0.0948, 0.2045, 0.0216,
        0.0498])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 16.9757, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 9.9249, Accuracy: 13/9950 (0.1307%)
saving model
Done in 296.2597186565399 sec.
Server Epoch:47 choose agents : [66, 77, 20, 72, 32, 75, 26, 83, 55, 13].
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0708, Accuracy: 187/1402 (13.3381%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 330/1402 (23.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3308, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   1, Avg loss: 0.0499, Accuracy: 357/1340 (26.6418%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 535/1340 (39.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.7941, Accuracy: 78/10000 (0.7800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 258/807 (31.9703%)
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   2, Avg loss: 0.0335, Accuracy: 400/807 (49.5663%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.6397, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0689, Accuracy: 203/1241 (16.3578%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 377/1241 (30.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2202, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0623, Accuracy: 130/735 (17.6871%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0211, Accuracy: 365/735 (49.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.3456, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0673, Accuracy: 222/776 (28.6082%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.2634, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0602, Accuracy: 314/1446 (21.7151%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 490/1446 (33.8866%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1338, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   1, Avg loss: 0.0582, Accuracy: 402/1953 (20.5837%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 730/1953 (37.3784%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9290, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   1, Avg loss: 0.0603, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 499/1071 (46.5920%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.4480, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0649, Accuracy: 267/1645 (16.2310%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0345, Accuracy: 574/1645 (34.8936%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.8006, Accuracy: 101/10000 (1.0100%)
time spent on training: 253.20429396629333
[rfa agg] training data poison_ratio: 0.06499677835051547  data num: [1402, 1340, 807, 1241, 735, 776, 1446, 1953, 1071, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.020311493234536085
[rfa agg] init. name: [66, 77, 20, 72, 32, 75, 26, 83, 55, 13], weight: tensor([0.1129, 0.1079, 0.0650, 0.1000, 0.0592, 0.0625, 0.1165, 0.1573, 0.0863,
        0.1325])
[rfa agg] iter:  0, prev_obj_val: 56.651206970214844, obj_val: 58.46413803100586, abs dis: 1.8129310607910156
[rfa agg] iter: 0, weight: tensor([0.1168, 0.1362, 0.0584, 0.1691, 0.0458, 0.0563, 0.1025, 0.0575, 0.1818,
        0.0757])
[rfa agg] iter:  1, prev_obj_val: 58.46413803100586, obj_val: 58.45491027832031, abs dis: 0.009227752685546875
[rfa agg] iter: 1, weight: tensor([0.1067, 0.1252, 0.0641, 0.1555, 0.0496, 0.0617, 0.0944, 0.0553, 0.2161,
        0.0714])
[rfa agg] iter:  2, prev_obj_val: 58.45491027832031, obj_val: 58.45454406738281, abs dis: 0.0003662109375
[rfa agg] iter: 2, weight: tensor([0.1057, 0.1238, 0.0637, 0.1534, 0.0492, 0.0612, 0.0935, 0.0549, 0.2239,
        0.0708])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 16.6925, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 11.1383, Accuracy: 5/9950 (0.0503%)
saving model
Done in 348.0602557659149 sec.
Server Epoch:48 choose agents : [42, 90, 83, 4, 11, 19, 73, 61, 96, 39].
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0584, Accuracy: 230/1372 (16.7638%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 453/1372 (33.0175%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4093, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0592, Accuracy: 235/677 (34.7120%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 12.2493, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   1, Avg loss: 0.0585, Accuracy: 388/1953 (19.8669%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 743/1953 (38.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0208, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0599, Accuracy: 290/901 (32.1865%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0337, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2020, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0622, Accuracy: 262/712 (36.7978%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 436/712 (61.2360%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.7849, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0511, Accuracy: 346/1036 (33.3977%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 651/1036 (62.8378%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 12.9693, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0735, Accuracy: 140/938 (14.9254%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0374, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6501, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1288, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6386, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 5/311 (1.6077%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0505, Accuracy: 120/311 (38.5852%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6587, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0565, Accuracy: 269/1013 (26.5548%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 473/1013 (46.6930%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.7972, Accuracy: 78/10000 (0.7800%)
time spent on training: 204.7318093776703
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 677, 1953, 901, 712, 1036, 938, 85, 311, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 90, 83, 4, 11, 19, 73, 61, 96, 39], weight: tensor([0.1525, 0.0752, 0.2170, 0.1001, 0.0791, 0.1151, 0.1042, 0.0094, 0.0346,
        0.1126])
[rfa agg] iter:  0, prev_obj_val: 58.134342193603516, obj_val: 60.173465728759766, abs dis: 2.03912353515625
[rfa agg] iter: 0, weight: tensor([0.0959, 0.0494, 0.0558, 0.1473, 0.0602, 0.2176, 0.1516, 0.0022, 0.0109,
        0.2091])
[rfa agg] iter:  1, prev_obj_val: 60.173465728759766, obj_val: 63.73426818847656, abs dis: 3.560802459716797
[rfa agg] iter: 1, weight: tensor([0.0730, 0.0616, 0.0476, 0.1836, 0.0770, 0.1561, 0.1878, 0.0023, 0.0116,
        0.1994])
[rfa agg] iter:  2, prev_obj_val: 63.73426818847656, obj_val: 63.717037200927734, abs dis: 0.017230987548828125
[rfa agg] iter: 2, weight: tensor([0.0710, 0.0855, 0.0492, 0.1854, 0.1080, 0.1281, 0.1905, 0.0027, 0.0140,
        0.1656])
[rfa agg] iter:  3, prev_obj_val: 63.717037200927734, obj_val: 63.71697235107422, abs dis: 6.4849853515625e-05
[rfa agg] iter: 3, weight: tensor([0.0708, 0.0861, 0.0492, 0.1856, 0.1101, 0.1268, 0.1915, 0.0027, 0.0140,
        0.1632])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 13.7657, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 9.3235, Accuracy: 15/9950 (0.1508%)
saving model
Done in 300.3216435909271 sec.
Server Epoch:49 choose agents : [20, 2, 31, 41, 84, 98, 18, 69, 11, 22].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 259/807 (32.0942%)
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6880, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0643, Accuracy: 148/605 (24.4628%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0413, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6125, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0899, Accuracy: 37/460 (8.0435%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0447, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3972, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0811, Accuracy: 130/719 (18.0807%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0339, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.7730, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 296/1190 (24.8739%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   2, Avg loss: 0.0340, Accuracy: 413/1190 (34.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6446, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0462, Accuracy: 133/373 (35.6568%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8958, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 75/530 (14.1509%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.4377, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 230/590 (38.9831%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0345, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 13.4429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   1, Avg loss: 0.0609, Accuracy: 235/712 (33.0056%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.2524, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   1, Avg loss: 0.0525, Accuracy: 413/1470 (28.0952%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 788/1470 (53.6054%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.5276, Accuracy: 98/10000 (0.9800%)
time spent on training: 198.5800712108612
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 605, 460, 719, 1190, 373, 530, 590, 712, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 2, 31, 41, 84, 98, 18, 69, 11, 22], weight: tensor([0.1082, 0.0811, 0.0617, 0.0964, 0.1596, 0.0500, 0.0711, 0.0791, 0.0955,
        0.1972])
[rfa agg] iter:  0, prev_obj_val: 47.78558349609375, obj_val: 54.677921295166016, abs dis: 6.892337799072266
[rfa agg] iter: 0, weight: tensor([0.1780, 0.1055, 0.0487, 0.1636, 0.0743, 0.0263, 0.0699, 0.0999, 0.1732,
        0.0606])
[rfa agg] iter:  1, prev_obj_val: 54.677921295166016, obj_val: 57.08525466918945, abs dis: 2.4073333740234375
[rfa agg] iter: 1, weight: tensor([0.0973, 0.1610, 0.0926, 0.1095, 0.0559, 0.0397, 0.1359, 0.1482, 0.1105,
        0.0495])
[rfa agg] iter:  2, prev_obj_val: 57.08525466918945, obj_val: 57.07426452636719, abs dis: 0.010990142822265625
[rfa agg] iter: 2, weight: tensor([0.0862, 0.1580, 0.1164, 0.0953, 0.0536, 0.0453, 0.1587, 0.1422, 0.0962,
        0.0481])
[rfa agg] iter:  3, prev_obj_val: 57.07426452636719, obj_val: 57.07408142089844, abs dis: 0.00018310546875
[rfa agg] iter: 3, weight: tensor([0.0852, 0.1579, 0.1186, 0.0940, 0.0532, 0.0453, 0.1630, 0.1402, 0.0950,
        0.0477])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 22.1102, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 16.4724, Accuracy: 1/9950 (0.0101%)
saving model
Done in 299.7145411968231 sec.
Server Epoch:50 choose agents : [40, 49, 82, 52, 64, 6, 61, 8, 71, 42].
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0652, Accuracy: 282/1573 (17.9275%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0364, Accuracy: 564/1573 (35.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2595, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0896, Accuracy: 8/440 (1.8182%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0537, Accuracy: 136/440 (30.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5944, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   1, Avg loss: 0.0808, Accuracy: 28/500 (5.6000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 211/500 (42.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1201, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0533, Accuracy: 234/636 (36.7925%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.0728, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0696, Accuracy: 130/953 (13.6411%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3436, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0603, Accuracy: 328/1956 (16.7689%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0333, Accuracy: 608/1956 (31.0838%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1352, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1317, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1200, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4602, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0645, Accuracy: 226/1513 (14.9372%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0380, Accuracy: 452/1513 (29.8744%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6295, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   1, Avg loss: 0.0672, Accuracy: 148/818 (18.0929%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   2, Avg loss: 0.0330, Accuracy: 317/818 (38.7531%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.5695, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0583, Accuracy: 220/1372 (16.0350%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 437/1372 (31.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.9235, Accuracy: 76/10000 (0.7600%)
time spent on training: 208.0710711479187
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 440, 500, 636, 953, 1956, 85, 1513, 818, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 49, 82, 52, 64, 6, 61, 8, 71, 42], weight: tensor([0.1598, 0.0447, 0.0508, 0.0646, 0.0968, 0.1987, 0.0086, 0.1537, 0.0831,
        0.1393])
[rfa agg] iter:  0, prev_obj_val: 70.11900329589844, obj_val: 72.57373809814453, abs dis: 2.4547348022460938
[rfa agg] iter: 0, weight: tensor([0.1536, 0.0251, 0.0313, 0.0487, 0.1601, 0.1031, 0.0032, 0.1666, 0.0941,
        0.2143])
[rfa agg] iter:  1, prev_obj_val: 72.57373809814453, obj_val: 73.89871978759766, abs dis: 1.324981689453125
[rfa agg] iter: 1, weight: tensor([0.1355, 0.0274, 0.0344, 0.0548, 0.2075, 0.0957, 0.0034, 0.1456, 0.1125,
        0.1832])
[rfa agg] iter:  2, prev_obj_val: 73.89871978759766, obj_val: 72.56109619140625, abs dis: 1.3376235961914062
[rfa agg] iter: 2, weight: tensor([0.1251, 0.0282, 0.0356, 0.0573, 0.2399, 0.0906, 0.0034, 0.1336, 0.1223,
        0.1639])
[rfa agg] iter:  3, prev_obj_val: 72.56109619140625, obj_val: 75.30424499511719, abs dis: 2.7431488037109375
[rfa agg] iter: 3, weight: tensor([0.1344, 0.0273, 0.0343, 0.0546, 0.2143, 0.0951, 0.0034, 0.1442, 0.1126,
        0.1798])
[rfa agg] iter:  4, prev_obj_val: 75.30424499511719, obj_val: 75.2811279296875, abs dis: 0.0231170654296875
[rfa agg] iter: 4, weight: tensor([0.1148, 0.0287, 0.0364, 0.0595, 0.2710, 0.0851, 0.0034, 0.1221, 0.1321,
        0.1470])
[rfa agg] iter:  5, prev_obj_val: 75.2811279296875, obj_val: 75.28076934814453, abs dis: 0.00035858154296875
[rfa agg] iter: 5, weight: tensor([0.1132, 0.0284, 0.0361, 0.0589, 0.2803, 0.0840, 0.0034, 0.1203, 0.1313,
        0.1442])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 13.4676, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 9.5865, Accuracy: 8/9950 (0.0804%)
saving model
Saving model on epoch 50
Done in 308.16678738594055 sec.
Server Epoch:51 choose agents : [5, 57, 22, 34, 60, 42, 12, 72, 7, 93].
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0587, Accuracy: 300/1628 (18.4275%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 716/1628 (43.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5623, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0710, Accuracy: 199/1154 (17.2444%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0289, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.5290, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0516, Accuracy: 420/1470 (28.5714%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 792/1470 (53.8776%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.5308, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0683, Accuracy: 313/1427 (21.9341%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0342, Accuracy: 569/1427 (39.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2188, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0528, Accuracy: 492/2227 (22.0925%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 910/2227 (40.8621%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.9945, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0577, Accuracy: 229/1372 (16.6910%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0332, Accuracy: 484/1372 (35.2770%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.6150, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0809, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0454, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.6073, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0666, Accuracy: 185/1241 (14.9073%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0391, Accuracy: 389/1241 (31.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3660, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0718, Accuracy: 192/891 (21.5488%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.0476, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0618, Accuracy: 377/1742 (21.6418%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0333, Accuracy: 676/1742 (38.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6463, Accuracy: 88/10000 (0.8800%)
time spent on training: 263.2326862812042
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1154, 1470, 1427, 2227, 1372, 338, 1241, 891, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 57, 22, 34, 60, 42, 12, 72, 7, 93], weight: tensor([0.1207, 0.0855, 0.1090, 0.1058, 0.1651, 0.1017, 0.0251, 0.0920, 0.0660,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 54.34577941894531, obj_val: 58.943328857421875, abs dis: 4.5975494384765625
[rfa agg] iter: 0, weight: tensor([0.1058, 0.0849, 0.1770, 0.1688, 0.0523, 0.1647, 0.0065, 0.1249, 0.0334,
        0.0817])
[rfa agg] iter:  1, prev_obj_val: 58.943328857421875, obj_val: 61.053375244140625, abs dis: 2.11004638671875
[rfa agg] iter: 1, weight: tensor([0.0893, 0.1149, 0.1477, 0.1427, 0.0503, 0.1571, 0.0076, 0.1747, 0.0431,
        0.0724])
[rfa agg] iter:  2, prev_obj_val: 61.053375244140625, obj_val: 61.043617248535156, abs dis: 0.00975799560546875
[rfa agg] iter: 2, weight: tensor([0.0854, 0.1299, 0.1343, 0.1304, 0.0502, 0.1470, 0.0081, 0.1964, 0.0478,
        0.0705])
[rfa agg] iter:  3, prev_obj_val: 61.043617248535156, obj_val: 61.04334259033203, abs dis: 0.000274658203125
[rfa agg] iter: 3, weight: tensor([0.0849, 0.1313, 0.1327, 0.1291, 0.0500, 0.1451, 0.0081, 0.2012, 0.0476,
        0.0701])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.0050, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.5124, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.3664720058441 sec.
Server Epoch:52 choose agents : [90, 34, 84, 61, 58, 18, 42, 1, 32, 31].
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   1, Avg loss: 0.0577, Accuracy: 229/677 (33.8257%)
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 12.3474, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0676, Accuracy: 325/1427 (22.7751%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0354, Accuracy: 542/1427 (37.9818%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2155, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   1, Avg loss: 0.0655, Accuracy: 301/1190 (25.2941%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 425/1190 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.8569, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0601, Accuracy: 37/10000 (0.3700%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0679, Accuracy: 242/803 (30.1370%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0394, Accuracy: 421/803 (52.4284%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1939, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0724, Accuracy: 95/530 (17.9245%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.1168, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0578, Accuracy: 220/1372 (16.0350%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0335, Accuracy: 482/1372 (35.1312%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4129, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   1, Avg loss: 0.0654, Accuracy: 244/928 (26.2931%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.1614, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0631, Accuracy: 143/735 (19.4558%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 12.8227, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0928, Accuracy: 29/460 (6.3043%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0452, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4072, Accuracy: 44/10000 (0.4400%)
time spent on training: 186.2239067554474
[rfa agg] training data poison_ratio: 0.0  data num: [677, 1427, 1190, 85, 803, 530, 1372, 928, 735, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 34, 84, 61, 58, 18, 42, 1, 32, 31], weight: tensor([0.0825, 0.1739, 0.1450, 0.0104, 0.0978, 0.0646, 0.1672, 0.1131, 0.0896,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 51.55424880981445, obj_val: 56.89511489868164, abs dis: 5.3408660888671875
[rfa agg] iter: 0, weight: tensor([0.1065, 0.0832, 0.1152, 0.0034, 0.1990, 0.0531, 0.0891, 0.1651, 0.1462,
        0.0392])
[rfa agg] iter:  1, prev_obj_val: 56.89511489868164, obj_val: 64.11479187011719, abs dis: 7.219676971435547
[rfa agg] iter: 1, weight: tensor([0.1672, 0.0613, 0.0772, 0.0035, 0.1915, 0.0707, 0.0644, 0.1119, 0.2030,
        0.0492])
[rfa agg] iter:  2, prev_obj_val: 64.11479187011719, obj_val: 61.34355926513672, abs dis: 2.7712326049804688
[rfa agg] iter: 2, weight: tensor([0.2199, 0.0583, 0.0696, 0.0042, 0.1370, 0.1122, 0.0606, 0.0910, 0.1725,
        0.0747])
[rfa agg] iter:  3, prev_obj_val: 61.34355926513672, obj_val: 61.34046936035156, abs dis: 0.00308990478515625
[rfa agg] iter: 3, weight: tensor([0.2401, 0.0563, 0.0683, 0.0038, 0.1432, 0.0951, 0.0589, 0.0910, 0.1805,
        0.0628])
[rfa agg] iter:  4, prev_obj_val: 61.34046936035156, obj_val: 64.0615463256836, abs dis: 2.7210769653320312
[rfa agg] iter: 4, weight: tensor([0.2425, 0.0562, 0.0681, 0.0038, 0.1428, 0.0939, 0.0586, 0.0907, 0.1812,
        0.0624])
[rfa agg] iter:  5, prev_obj_val: 64.0615463256836, obj_val: 61.3442268371582, abs dis: 2.7173194885253906
[rfa agg] iter: 5, weight: tensor([0.2398, 0.0568, 0.0678, 0.0041, 0.1315, 0.1128, 0.0592, 0.0881, 0.1657,
        0.0741])
[rfa agg] iter:  6, prev_obj_val: 61.3442268371582, obj_val: 61.340492248535156, abs dis: 0.003734588623046875
[rfa agg] iter: 6, weight: tensor([0.2457, 0.0560, 0.0679, 0.0038, 0.1420, 0.0948, 0.0585, 0.0904, 0.1783,
        0.0626])
[rfa agg] iter:  7, prev_obj_val: 61.340492248535156, obj_val: 64.06139373779297, abs dis: 2.7209014892578125
[rfa agg] iter: 7, weight: tensor([0.2440, 0.0561, 0.0680, 0.0037, 0.1425, 0.0938, 0.0586, 0.0905, 0.1805,
        0.0623])
[rfa agg] iter:  8, prev_obj_val: 64.06139373779297, obj_val: 61.344261169433594, abs dis: 2.717132568359375
[rfa agg] iter: 8, weight: tensor([0.2402, 0.0568, 0.0678, 0.0041, 0.1315, 0.1128, 0.0591, 0.0880, 0.1656,
        0.0741])
[rfa agg] iter:  9, prev_obj_val: 61.344261169433594, obj_val: 61.340492248535156, abs dis: 0.0037689208984375
[rfa agg] iter: 9, weight: tensor([0.2458, 0.0560, 0.0679, 0.0038, 0.1420, 0.0948, 0.0585, 0.0903, 0.1782,
        0.0626])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0343, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.5572, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.4025363922119 sec.
Server Epoch:53 choose agents : [44, 27, 62, 20, 28, 49, 40, 8, 16, 22].
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0669, Accuracy: 300/1750 (17.1429%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 619/1750 (35.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1891, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0579, Accuracy: 393/1587 (24.7637%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0360, Accuracy: 556/1587 (35.0347%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2707, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0647, Accuracy: 120/568 (21.1268%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0387, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.7250, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   1, Avg loss: 0.0533, Accuracy: 293/807 (36.3073%)
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.7942, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0617, Accuracy: 325/1581 (20.5566%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0365, Accuracy: 498/1581 (31.4991%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4460, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0925, Accuracy: 6/440 (1.3636%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0537, Accuracy: 121/440 (27.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5891, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0648, Accuracy: 316/1573 (20.0890%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0376, Accuracy: 554/1573 (35.2193%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3397, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0641, Accuracy: 220/1513 (14.5406%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0385, Accuracy: 441/1513 (29.1474%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.5176, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   1, Avg loss: 0.0609, Accuracy: 252/708 (35.5932%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9312, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   1, Avg loss: 0.0504, Accuracy: 429/1470 (29.1837%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   2, Avg loss: 0.0259, Accuracy: 774/1470 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.3285, Accuracy: 102/10000 (1.0200%)
time spent on training: 257.04837822914124
[rfa agg] training data poison_ratio: 0.06726681670417604  data num: [1750, 1587, 568, 807, 1581, 440, 1573, 1513, 708, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.021020880220055015
[rfa agg] init. name: [44, 27, 62, 20, 28, 49, 40, 8, 16, 22], weight: tensor([0.1459, 0.1323, 0.0473, 0.0673, 0.1318, 0.0367, 0.1311, 0.1261, 0.0590,
        0.1225])
[rfa agg] iter:  0, prev_obj_val: 61.23372268676758, obj_val: 61.18893814086914, abs dis: 0.0447845458984375
[rfa agg] iter: 0, weight: tensor([0.1052, 0.1397, 0.0282, 0.0626, 0.1370, 0.0184, 0.1359, 0.1557, 0.0477,
        0.1698])
[rfa agg] iter:  1, prev_obj_val: 61.18893814086914, obj_val: 61.18880844116211, abs dis: 0.00012969970703125
[rfa agg] iter: 1, weight: tensor([0.1042, 0.1391, 0.0280, 0.0622, 0.1363, 0.0182, 0.1351, 0.1562, 0.0473,
        0.1733])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.1236, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 4.7821, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.0515902042389 sec.
Server Epoch:54 choose agents : [38, 69, 16, 89, 47, 84, 8, 7, 93, 54].
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0712, Accuracy: 165/1131 (14.5889%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0335, Accuracy: 414/1131 (36.6048%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.2135, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0609, Accuracy: 218/590 (36.9492%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0329, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.6834, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0650, Accuracy: 263/708 (37.1469%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0353, Accuracy: 412/708 (58.1921%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.4384, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   1, Avg loss: 0.0775, Accuracy: 196/896 (21.8750%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   2, Avg loss: 0.0388, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.4946, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1328, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1158, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.4344, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   1, Avg loss: 0.0658, Accuracy: 288/1190 (24.2017%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.9865, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0639, Accuracy: 244/1513 (16.1269%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0379, Accuracy: 450/1513 (29.7422%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3667, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0716, Accuracy: 189/891 (21.2121%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0290, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.9095, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   1, Avg loss: 0.0624, Accuracy: 381/1742 (21.8714%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 664/1742 (38.1171%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5890, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   1, Avg loss: 0.0648, Accuracy: 253/1130 (22.3894%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 454/1130 (40.1770%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.5498, Accuracy: 69/10000 (0.6900%)
time spent on training: 224.60490894317627
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 590, 708, 896, 134, 1190, 1513, 891, 1742, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 69, 16, 89, 47, 84, 8, 7, 93, 54], weight: tensor([0.1140, 0.0594, 0.0713, 0.0903, 0.0135, 0.1199, 0.1524, 0.0898, 0.1755,
        0.1139])
[rfa agg] iter:  0, prev_obj_val: 52.32778549194336, obj_val: 57.56694412231445, abs dis: 5.239158630371094
[rfa agg] iter: 0, weight: tensor([0.1858, 0.0357, 0.0539, 0.1064, 0.0039, 0.1518, 0.0895, 0.1056, 0.0679,
        0.1994])
[rfa agg] iter:  1, prev_obj_val: 57.56694412231445, obj_val: 61.521240234375, abs dis: 3.954296112060547
[rfa agg] iter: 1, weight: tensor([0.1371, 0.0500, 0.0766, 0.1716, 0.0046, 0.1135, 0.0735, 0.1711, 0.0598,
        0.1422])
[rfa agg] iter:  2, prev_obj_val: 61.521240234375, obj_val: 59.34857177734375, abs dis: 2.17266845703125
[rfa agg] iter: 2, weight: tensor([0.1097, 0.0599, 0.0919, 0.2022, 0.0049, 0.0945, 0.0660, 0.2029, 0.0552,
        0.1127])
[rfa agg] iter:  3, prev_obj_val: 59.34857177734375, obj_val: 57.468605041503906, abs dis: 1.8799667358398438
[rfa agg] iter: 3, weight: tensor([0.1166, 0.0533, 0.0838, 0.1979, 0.0046, 0.0995, 0.0677, 0.1997, 0.0559,
        0.1208])
[rfa agg] iter:  4, prev_obj_val: 57.468605041503906, obj_val: 59.3516845703125, abs dis: 1.8830795288085938
[rfa agg] iter: 4, weight: tensor([0.1297, 0.0490, 0.0768, 0.1823, 0.0045, 0.1089, 0.0716, 0.1835, 0.0584,
        0.1354])
[rfa agg] iter:  5, prev_obj_val: 59.3516845703125, obj_val: 57.466976165771484, abs dis: 1.8847084045410156
[rfa agg] iter: 5, weight: tensor([0.1185, 0.0536, 0.0834, 0.1954, 0.0047, 0.1007, 0.0683, 0.1966, 0.0563,
        0.1226])
[rfa agg] iter:  6, prev_obj_val: 57.466976165771484, obj_val: 59.35184097290039, abs dis: 1.8848648071289062
[rfa agg] iter: 6, weight: tensor([0.1299, 0.0491, 0.0768, 0.1820, 0.0045, 0.1090, 0.0717, 0.1831, 0.0584,
        0.1356])
[rfa agg] iter:  7, prev_obj_val: 59.35184097290039, obj_val: 57.466957092285156, abs dis: 1.8848838806152344
[rfa agg] iter: 7, weight: tensor([0.1185, 0.0536, 0.0834, 0.1954, 0.0047, 0.1007, 0.0683, 0.1965, 0.0564,
        0.1226])
[rfa agg] iter:  8, prev_obj_val: 57.466957092285156, obj_val: 59.351837158203125, abs dis: 1.8848800659179688
[rfa agg] iter: 8, weight: tensor([0.1299, 0.0491, 0.0768, 0.1820, 0.0045, 0.1090, 0.0717, 0.1831, 0.0584,
        0.1356])
[rfa agg] iter:  9, prev_obj_val: 59.351837158203125, obj_val: 57.466957092285156, abs dis: 1.8848800659179688
[rfa agg] iter: 9, weight: tensor([0.1185, 0.0536, 0.0834, 0.1954, 0.0047, 0.1007, 0.0683, 0.1965, 0.0564,
        0.1226])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.0746, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.4866590499878 sec.
Server Epoch:55 choose agents : [88, 77, 16, 55, 79, 13, 61, 12, 27, 98].
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   1, Avg loss: 0.0846, Accuracy: 55/603 (9.1211%)
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8612, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   1, Avg loss: 0.0552, Accuracy: 292/1340 (21.7910%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3531, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0600, Accuracy: 248/708 (35.0282%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 422/708 (59.6045%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8153, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 235/1071 (21.9421%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0302, Accuracy: 467/1071 (43.6041%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.8521, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   1, Avg loss: 0.1099, Accuracy: 4/197 (2.0305%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   2, Avg loss: 0.0800, Accuracy: 28/197 (14.2132%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6418, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0665, Accuracy: 232/1645 (14.1033%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0350, Accuracy: 549/1645 (33.3739%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8831, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1161, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.7098, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0776, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0430, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.7326, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0563, Accuracy: 403/1587 (25.3938%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0359, Accuracy: 564/1587 (35.5388%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.5254, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   1, Avg loss: 0.0891, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 126/373 (33.7802%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9628, Accuracy: 56/10000 (0.5600%)
time spent on training: 213.87641406059265
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1340, 708, 1071, 197, 1645, 85, 338, 1587, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 77, 16, 55, 79, 13, 61, 12, 27, 98], weight: tensor([0.0759, 0.1686, 0.0891, 0.1348, 0.0248, 0.2070, 0.0107, 0.0425, 0.1997,
        0.0469])
[rfa agg] iter:  0, prev_obj_val: 67.2442398071289, obj_val: 66.88355255126953, abs dis: 0.360687255859375
[rfa agg] iter: 0, weight: tensor([0.0662, 0.1844, 0.1008, 0.3316, 0.0110, 0.1224, 0.0040, 0.0229, 0.1316,
        0.0252])
[rfa agg] iter:  1, prev_obj_val: 66.88355255126953, obj_val: 65.63046264648438, abs dis: 1.2530899047851562
[rfa agg] iter: 1, weight: tensor([0.0602, 0.1708, 0.0920, 0.3886, 0.0100, 0.1110, 0.0036, 0.0208, 0.1200,
        0.0229])
[rfa agg] iter:  2, prev_obj_val: 65.63046264648438, obj_val: 66.8551254272461, abs dis: 1.2246627807617188
[rfa agg] iter: 2, weight: tensor([0.0528, 0.1730, 0.0795, 0.4146, 0.0091, 0.1094, 0.0033, 0.0187, 0.1189,
        0.0207])
[rfa agg] iter:  3, prev_obj_val: 66.8551254272461, obj_val: 66.85274505615234, abs dis: 0.00238037109375
[rfa agg] iter: 3, weight: tensor([0.0574, 0.1623, 0.0871, 0.4179, 0.0096, 0.1059, 0.0034, 0.0199, 0.1146,
        0.0219])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.0571, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.1927, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.56034660339355 sec.
Server Epoch:56 choose agents : [41, 84, 47, 20, 89, 72, 45, 32, 26, 7].
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0795, Accuracy: 132/719 (18.3588%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0352, Accuracy: 468/719 (65.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.4507, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0686, Accuracy: 291/1190 (24.4538%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6938, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1377, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1211, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4889, Accuracy: 44/10000 (0.4400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   1, Avg loss: 0.0561, Accuracy: 260/807 (32.2181%)
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6783, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   1, Avg loss: 0.0750, Accuracy: 195/896 (21.7634%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   2, Avg loss: 0.0384, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0992, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0689, Accuracy: 201/1241 (16.1966%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0404, Accuracy: 368/1241 (29.6535%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4749, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0718, Accuracy: 164/669 (24.5142%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0418, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4032, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0615, Accuracy: 128/735 (17.4150%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0215, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.7160, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0573, Accuracy: 322/1446 (22.2683%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0623, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   1, Avg loss: 0.0674, Accuracy: 190/891 (21.3244%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   2, Avg loss: 0.0296, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.0343, Accuracy: 63/10000 (0.6300%)
time spent on training: 241.72110629081726
[rfa agg] training data poison_ratio: 0.09246104491292392  data num: [719, 1190, 134, 807, 896, 1241, 669, 735, 1446, 891]
[rfa agg] considering poison per batch poison_fraction: 0.028894076535288728
[rfa agg] init. name: [41, 84, 47, 20, 89, 72, 45, 32, 26, 7], weight: tensor([0.0824, 0.1363, 0.0154, 0.0925, 0.1027, 0.1422, 0.0766, 0.0842, 0.1657,
        0.1021])
[rfa agg] iter:  0, prev_obj_val: 44.69338607788086, obj_val: 52.70726013183594, abs dis: 8.013874053955078
[rfa agg] iter: 0, weight: tensor([0.1112, 0.0792, 0.0046, 0.1463, 0.1405, 0.0734, 0.0804, 0.1262, 0.0602,
        0.1779])
[rfa agg] iter:  1, prev_obj_val: 52.70726013183594, obj_val: 49.95836639404297, abs dis: 2.7488937377929688
[rfa agg] iter: 1, weight: tensor([0.1463, 0.0643, 0.0057, 0.1357, 0.1119, 0.0609, 0.1241, 0.1744, 0.0531,
        0.1236])
[rfa agg] iter:  2, prev_obj_val: 49.95836639404297, obj_val: 49.9571533203125, abs dis: 0.00121307373046875
[rfa agg] iter: 2, weight: tensor([0.1468, 0.0633, 0.0051, 0.1404, 0.1138, 0.0598, 0.1132, 0.1793, 0.0515,
        0.1268])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.0518, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 4.9474, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.114604473114 sec.
Server Epoch:57 choose agents : [40, 56, 4, 32, 74, 75, 70, 88, 9, 35].
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0650, Accuracy: 307/1573 (19.5168%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0378, Accuracy: 519/1573 (32.9943%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0540, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.1033, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0863, Accuracy: 1/186 (0.5376%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3606, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0581, Accuracy: 342/901 (37.9578%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0346, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3606, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0583, Accuracy: 142/735 (19.3197%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0209, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.2971, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0482, Accuracy: 452/1552 (29.1237%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0225, Accuracy: 711/1552 (45.8119%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.9660, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0709, Accuracy: 192/776 (24.7423%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0301, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.8412, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0647, Accuracy: 281/1418 (19.8166%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0329, Accuracy: 579/1418 (40.8322%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.6485, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   1, Avg loss: 0.0823, Accuracy: 62/603 (10.2819%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.2196, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0600, Accuracy: 275/1275 (21.5686%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0212, Accuracy: 644/1275 (50.5098%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.0832, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   1, Avg loss: 0.0955, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   2, Avg loss: 0.0603, Accuracy: 89/271 (32.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.6119, Accuracy: 55/10000 (0.5500%)
time spent on training: 259.54238772392273
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 186, 901, 735, 1552, 776, 1418, 603, 1275, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 56, 4, 32, 74, 75, 70, 88, 9, 35], weight: tensor([0.1693, 0.0200, 0.0970, 0.0791, 0.1671, 0.0835, 0.1526, 0.0649, 0.1372,
        0.0292])
[rfa agg] iter:  0, prev_obj_val: 60.27024459838867, obj_val: 61.30836486816406, abs dis: 1.0381202697753906
[rfa agg] iter: 0, weight: tensor([0.1185, 0.0079, 0.1615, 0.0858, 0.1149, 0.1067, 0.1346, 0.0529, 0.2035,
        0.0138])
[rfa agg] iter:  1, prev_obj_val: 61.30836486816406, obj_val: 61.30056381225586, abs dis: 0.007801055908203125
[rfa agg] iter: 1, weight: tensor([0.1103, 0.0080, 0.1831, 0.0920, 0.1069, 0.1166, 0.1244, 0.0558, 0.1889,
        0.0141])
[rfa agg] iter:  2, prev_obj_val: 61.30056381225586, obj_val: 61.300453186035156, abs dis: 0.000110626220703125
[rfa agg] iter: 2, weight: tensor([0.1098, 0.0080, 0.1864, 0.0919, 0.1065, 0.1167, 0.1237, 0.0556, 0.1873,
        0.0141])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.9848, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.1447, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.36415004730225 sec.
Server Epoch:58 choose agents : [34, 31, 89, 35, 74, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0712, Accuracy: 290/1427 (20.3224%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 543/1427 (38.0519%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1155, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0915, Accuracy: 31/460 (6.7391%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0436, Accuracy: 191/460 (41.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.4530, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   1, Avg loss: 0.0753, Accuracy: 217/896 (24.2188%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   2, Avg loss: 0.0372, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3736, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0940, Accuracy: 2/271 (0.7380%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0596, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.8453, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   1, Avg loss: 0.0475, Accuracy: 447/1552 (28.8015%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 730/1552 (47.0361%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.0510, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0523, Accuracy: 347/1036 (33.4942%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 648/1036 (62.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.4445, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0569, Accuracy: 414/1587 (26.0870%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0356, Accuracy: 574/1587 (36.1689%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1206, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.1074, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0613, Accuracy: 74/312 (23.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.4194, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0885, Accuracy: 34/515 (6.6019%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0569, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3999, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0860, Accuracy: 154/715 (21.5385%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0474, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4361, Accuracy: 56/10000 (0.5600%)
time spent on training: 248.46476697921753
[rfa agg] training data poison_ratio: 0.0  data num: [1427, 460, 896, 271, 1552, 1036, 1587, 312, 515, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [34, 31, 89, 35, 74, 19, 27, 24, 33, 23], weight: tensor([0.1627, 0.0524, 0.1022, 0.0309, 0.1769, 0.1181, 0.1809, 0.0356, 0.0587,
        0.0815])
[rfa agg] iter:  0, prev_obj_val: 65.20198822021484, obj_val: 67.48571014404297, abs dis: 2.283721923828125
[rfa agg] iter: 0, weight: tensor([0.1260, 0.0364, 0.1817, 0.0154, 0.1083, 0.2631, 0.1115, 0.0178, 0.0449,
        0.0948])
[rfa agg] iter:  1, prev_obj_val: 67.48571014404297, obj_val: 68.93939971923828, abs dis: 1.4536895751953125
[rfa agg] iter: 1, weight: tensor([0.1095, 0.0403, 0.2246, 0.0164, 0.0958, 0.2358, 0.0987, 0.0190, 0.0499,
        0.1100])
[rfa agg] iter:  2, prev_obj_val: 68.93939971923828, obj_val: 72.38788604736328, abs dis: 3.448486328125
[rfa agg] iter: 2, weight: tensor([0.1034, 0.0431, 0.2514, 0.0172, 0.0914, 0.2049, 0.0942, 0.0199, 0.0536,
        0.1210])
[rfa agg] iter:  3, prev_obj_val: 72.38788604736328, obj_val: 70.56085205078125, abs dis: 1.8270339965820312
[rfa agg] iter: 3, weight: tensor([0.0950, 0.0507, 0.2652, 0.0193, 0.0855, 0.1649, 0.0880, 0.0223, 0.0634,
        0.1459])
[rfa agg] iter:  4, prev_obj_val: 70.56085205078125, obj_val: 70.5577392578125, abs dis: 0.00311279296875
[rfa agg] iter: 4, weight: tensor([0.0976, 0.0461, 0.2717, 0.0180, 0.0871, 0.1761, 0.0897, 0.0208, 0.0577,
        0.1351])
[rfa agg] iter:  5, prev_obj_val: 70.5577392578125, obj_val: 68.93064880371094, abs dis: 1.6270904541015625
[rfa agg] iter: 5, weight: tensor([0.0975, 0.0460, 0.2738, 0.0180, 0.0870, 0.1765, 0.0896, 0.0208, 0.0575,
        0.1334])
[rfa agg] iter:  6, prev_obj_val: 68.93064880371094, obj_val: 72.38280487060547, abs dis: 3.4521560668945312
[rfa agg] iter: 6, weight: tensor([0.1020, 0.0426, 0.2655, 0.0170, 0.0903, 0.1953, 0.0930, 0.0197, 0.0531,
        0.1215])
[rfa agg] iter:  7, prev_obj_val: 72.38280487060547, obj_val: 70.56061553955078, abs dis: 1.8221893310546875
[rfa agg] iter: 7, weight: tensor([0.0946, 0.0504, 0.2691, 0.0192, 0.0851, 0.1635, 0.0876, 0.0222, 0.0631,
        0.1452])
[rfa agg] iter:  8, prev_obj_val: 70.56061553955078, obj_val: 70.55772399902344, abs dis: 0.00289154052734375
[rfa agg] iter: 8, weight: tensor([0.0975, 0.0461, 0.2728, 0.0180, 0.0870, 0.1757, 0.0896, 0.0208, 0.0576,
        0.1348])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 20.3482, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 13.7121, Accuracy: 3/9950 (0.0302%)
saving model
Done in 347.5428807735443 sec.
Server Epoch:59 choose agents : [69, 83, 6, 40, 21, 23, 97, 75, 53, 99].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0597, Accuracy: 232/590 (39.3220%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 13.6889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   1, Avg loss: 0.0594, Accuracy: 340/1953 (17.4091%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   2, Avg loss: 0.0359, Accuracy: 692/1953 (35.4327%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2496, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0631, Accuracy: 323/1956 (16.5133%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0347, Accuracy: 603/1956 (30.8282%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.3414, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0648, Accuracy: 311/1573 (19.7711%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0366, Accuracy: 564/1573 (35.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1738, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0573, Accuracy: 330/1949 (16.9318%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 595/1949 (30.5285%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.0560, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0868, Accuracy: 152/715 (21.2587%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0495, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8802, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   1, Avg loss: 0.0576, Accuracy: 257/1213 (21.1871%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   2, Avg loss: 0.0308, Accuracy: 488/1213 (40.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.2685, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   1, Avg loss: 0.0663, Accuracy: 202/776 (26.0309%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   2, Avg loss: 0.0311, Accuracy: 390/776 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.9189, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0557, Accuracy: 202/813 (24.8462%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0217, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 13.3331, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0682, Accuracy: 164/773 (21.2160%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 401/773 (51.8758%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.1716, Accuracy: 62/10000 (0.6200%)
time spent on training: 286.36760663986206
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1953, 1956, 1573, 1949, 715, 1213, 776, 813, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 83, 6, 40, 21, 23, 97, 75, 53, 99], weight: tensor([0.0479, 0.1586, 0.1589, 0.1278, 0.1583, 0.0581, 0.0985, 0.0630, 0.0660,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 79.69319152832031, obj_val: 80.6089096069336, abs dis: 0.9157180786132812
[rfa agg] iter: 0, weight: tensor([0.0343, 0.1019, 0.1029, 0.1601, 0.1021, 0.0505, 0.2585, 0.0621, 0.0662,
        0.0613])
[rfa agg] iter:  1, prev_obj_val: 80.6089096069336, obj_val: 83.23281860351562, abs dis: 2.6239089965820312
[rfa agg] iter: 1, weight: tensor([0.0338, 0.0915, 0.0923, 0.1420, 0.0916, 0.0504, 0.3083, 0.0624, 0.0663,
        0.0613])
[rfa agg] iter:  2, prev_obj_val: 83.23281860351562, obj_val: 83.22564697265625, abs dis: 0.007171630859375
[rfa agg] iter: 2, weight: tensor([0.0367, 0.0830, 0.0836, 0.1211, 0.0830, 0.0558, 0.3233, 0.0701, 0.0749,
        0.0687])
[rfa agg] iter:  3, prev_obj_val: 83.22564697265625, obj_val: 84.7454833984375, abs dis: 1.51983642578125
[rfa agg] iter: 3, weight: tensor([0.0364, 0.0822, 0.0828, 0.1197, 0.0823, 0.0554, 0.3288, 0.0696, 0.0744,
        0.0682])
[rfa agg] iter:  4, prev_obj_val: 84.7454833984375, obj_val: 84.74207305908203, abs dis: 0.00341033935546875
[rfa agg] iter: 4, weight: tensor([0.0392, 0.0808, 0.0813, 0.1146, 0.0808, 0.0603, 0.3099, 0.0765, 0.0820,
        0.0747])
[rfa agg] iter:  5, prev_obj_val: 84.74207305908203, obj_val: 83.22904205322266, abs dis: 1.513031005859375
[rfa agg] iter: 5, weight: tensor([0.0395, 0.0812, 0.0818, 0.1153, 0.0812, 0.0608, 0.3052, 0.0771, 0.0827,
        0.0754])
[rfa agg] iter:  6, prev_obj_val: 83.22904205322266, obj_val: 83.22562408447266, abs dis: 0.00341796875
[rfa agg] iter: 6, weight: tensor([0.0367, 0.0828, 0.0834, 0.1205, 0.0828, 0.0559, 0.3235, 0.0703, 0.0751,
        0.0689])
[rfa agg] iter:  7, prev_obj_val: 83.22562408447266, obj_val: 84.74549865722656, abs dis: 1.5198745727539062
[rfa agg] iter: 7, weight: tensor([0.0364, 0.0822, 0.0828, 0.1197, 0.0823, 0.0554, 0.3289, 0.0696, 0.0744,
        0.0682])
[rfa agg] iter:  8, prev_obj_val: 84.74549865722656, obj_val: 84.7420654296875, abs dis: 0.0034332275390625
[rfa agg] iter: 8, weight: tensor([0.0392, 0.0808, 0.0813, 0.1146, 0.0808, 0.0603, 0.3099, 0.0765, 0.0820,
        0.0747])
[rfa agg] iter:  9, prev_obj_val: 84.7420654296875, obj_val: 83.22904205322266, abs dis: 1.5130233764648438
[rfa agg] iter: 9, weight: tensor([0.0395, 0.0812, 0.0818, 0.1153, 0.0812, 0.0608, 0.3052, 0.0771, 0.0827,
        0.0754])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9230, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.1831, Accuracy: 0/9950 (0.0000%)
saving model
Done in 383.946496963501 sec.
Server Epoch:60 choose agents : [51, 98, 53, 74, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0671, Accuracy: 176/1049 (16.7779%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0324, Accuracy: 470/1049 (44.8046%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8916, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   1, Avg loss: 0.0933, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   2, Avg loss: 0.0539, Accuracy: 107/373 (28.6863%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.6263, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0549, Accuracy: 218/813 (26.8143%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0215, Accuracy: 456/813 (56.0886%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.4258, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 741/1552 (47.7448%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.7492, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0604, Accuracy: 206/1372 (15.0146%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0347, Accuracy: 456/1372 (33.2362%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.2540, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1466, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1320, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.0900, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0483, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.7484, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0656, Accuracy: 228/1130 (20.1770%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0317, Accuracy: 439/1130 (38.8496%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.3010, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0665, Accuracy: 278/1418 (19.6051%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 549/1418 (38.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.6048, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0645, Accuracy: 210/712 (29.4944%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 436/712 (61.2360%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.7178, Accuracy: 63/10000 (0.6300%)
time spent on training: 232.63799571990967
[rfa agg] training data poison_ratio: 0.0  data num: [1049, 373, 813, 1552, 1372, 85, 338, 1130, 1418, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 98, 53, 74, 42, 61, 12, 54, 70, 11], weight: tensor([0.1186, 0.0422, 0.0919, 0.1755, 0.1552, 0.0096, 0.0382, 0.1278, 0.1604,
        0.0805])
[rfa agg] iter:  0, prev_obj_val: 57.12228775024414, obj_val: 56.86915588378906, abs dis: 0.2531318664550781
[rfa agg] iter: 0, weight: tensor([0.2031, 0.0210, 0.1315, 0.0971, 0.1241, 0.0032, 0.0191, 0.1992, 0.1107,
        0.0910])
[rfa agg] iter:  1, prev_obj_val: 56.86915588378906, obj_val: 56.86556625366211, abs dis: 0.003589630126953125
[rfa agg] iter: 1, weight: tensor([0.2184, 0.0202, 0.1292, 0.0928, 0.1188, 0.0031, 0.0184, 0.2055, 0.1057,
        0.0879])
[rfa agg] iter:  2, prev_obj_val: 56.86556625366211, obj_val: 56.865478515625, abs dis: 8.7738037109375e-05
[rfa agg] iter: 2, weight: tensor([0.2212, 0.0201, 0.1285, 0.0924, 0.1182, 0.0031, 0.0183, 0.2055, 0.1052,
        0.0874])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 15.3796, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 12.6152, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 331.8632798194885 sec.
Server Epoch:61 choose agents : [84, 20, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   1, Avg loss: 0.0657, Accuracy: 309/1190 (25.9664%)
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.6848, Accuracy: 75/10000 (0.7500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   1, Avg loss: 0.0598, Accuracy: 249/807 (30.8550%)
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5636, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0648, Accuracy: 174/1049 (16.5872%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 487/1049 (46.4252%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.9178, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0594, Accuracy: 255/690 (36.9565%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0318, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.3290, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0712, Accuracy: 175/1131 (15.4730%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0347, Accuracy: 450/1131 (39.7878%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.4437, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0635, Accuracy: 357/1956 (18.2515%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 587/1956 (30.0102%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.9492, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0521, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.7271, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0538, Accuracy: 231/813 (28.4133%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0211, Accuracy: 477/813 (58.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 13.5829, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.9711, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0572, Accuracy: 246/590 (41.6949%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 12.8415, Accuracy: 50/10000 (0.5000%)
time spent on training: 267.6343457698822
[rfa agg] training data poison_ratio: 0.08375713544369487  data num: [1190, 807, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[rfa agg] considering poison per batch poison_fraction: 0.02617410482615465
[rfa agg] init. name: [84, 20, 51, 25, 38, 6, 55, 53, 12, 69], weight: tensor([0.1235, 0.0838, 0.1089, 0.0716, 0.1174, 0.2030, 0.1112, 0.0844, 0.0351,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 58.104896545410156, obj_val: 62.25011444091797, abs dis: 4.1452178955078125
[rfa agg] iter: 0, weight: tensor([0.1344, 0.0996, 0.1566, 0.0591, 0.1551, 0.0600, 0.1728, 0.1041, 0.0152,
        0.0431])
[rfa agg] iter:  1, prev_obj_val: 62.25011444091797, obj_val: 63.81970977783203, abs dis: 1.5695953369140625
[rfa agg] iter: 1, weight: tensor([0.0987, 0.1496, 0.1216, 0.0865, 0.1134, 0.0534, 0.1321, 0.1656, 0.0187,
        0.0604])
[rfa agg] iter:  2, prev_obj_val: 63.81970977783203, obj_val: 65.73413848876953, abs dis: 1.9144287109375
[rfa agg] iter: 2, weight: tensor([0.0888, 0.1664, 0.1071, 0.0965, 0.1002, 0.0507, 0.1155, 0.1893, 0.0194,
        0.0661])
[rfa agg] iter:  3, prev_obj_val: 65.73413848876953, obj_val: 63.80943298339844, abs dis: 1.9247055053710938
[rfa agg] iter: 3, weight: tensor([0.0822, 0.1733, 0.0972, 0.1084, 0.0915, 0.0490, 0.1041, 0.2004, 0.0205,
        0.0734])
[rfa agg] iter:  4, prev_obj_val: 63.80943298339844, obj_val: 63.80543518066406, abs dis: 0.003997802734375
[rfa agg] iter: 4, weight: tensor([0.0874, 0.1695, 0.1044, 0.0968, 0.0981, 0.0501, 0.1130, 0.1956, 0.0192,
        0.0660])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 14.6874, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 12.0051, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.9999577999115 sec.
Server Epoch:62 choose agents : [83, 78, 24, 81, 4, 30, 93, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   1, Avg loss: 0.0585, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   2, Avg loss: 0.0366, Accuracy: 710/1953 (36.3543%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0948, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   1, Avg loss: 0.0869, Accuracy: 18/416 (4.3269%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.8314, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.1054, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0602, Accuracy: 75/312 (24.0385%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.6702, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0783, Accuracy: 190/774 (24.5478%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0415, Accuracy: 299/774 (38.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1655, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 307/901 (34.0733%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0074, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0846, Accuracy: 32/486 (6.5844%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 232/486 (47.7366%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.1417, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   1, Avg loss: 0.0604, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   2, Avg loss: 0.0336, Accuracy: 664/1742 (38.1171%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1286, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0829, Accuracy: 50/515 (9.7087%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3632, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0563, Accuracy: 241/590 (40.8475%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0345, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 12.2828, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0548, Accuracy: 474/2227 (21.2842%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 945/2227 (42.4338%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.9849, Accuracy: 117/10000 (1.1700%)
time spent on training: 262.24928092956543
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 416, 312, 774, 901, 486, 1742, 515, 590, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 78, 24, 81, 4, 30, 93, 33, 69, 60], weight: tensor([0.1970, 0.0420, 0.0315, 0.0781, 0.0909, 0.0490, 0.1757, 0.0519, 0.0595,
        0.2246])
[rfa agg] iter:  0, prev_obj_val: 99.04378509521484, obj_val: 99.83435821533203, abs dis: 0.7905731201171875
[rfa agg] iter: 0, weight: tensor([0.1830, 0.0309, 0.0201, 0.0994, 0.1493, 0.0389, 0.2240, 0.0443, 0.0562,
        0.1538])
[rfa agg] iter:  1, prev_obj_val: 99.83435821533203, obj_val: 101.61126708984375, abs dis: 1.7769088745117188
[rfa agg] iter: 1, weight: tensor([0.1743, 0.0319, 0.0206, 0.1055, 0.1632, 0.0402, 0.2123, 0.0459, 0.0586,
        0.1475])
[rfa agg] iter:  2, prev_obj_val: 101.61126708984375, obj_val: 102.51820373535156, abs dis: 0.9069366455078125
[rfa agg] iter: 2, weight: tensor([0.1576, 0.0338, 0.0215, 0.1183, 0.1902, 0.0429, 0.1868, 0.0492, 0.0636,
        0.1361])
[rfa agg] iter:  3, prev_obj_val: 102.51820373535156, obj_val: 102.5146484375, abs dis: 0.0035552978515625
[rfa agg] iter: 3, weight: tensor([0.1484, 0.0345, 0.0218, 0.1252, 0.2070, 0.0439, 0.1736, 0.0505, 0.0658,
        0.1293])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.8797, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.8869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.87494134902954 sec.
Server Epoch:63 choose agents : [18, 64, 38, 94, 55, 90, 58, 59, 66, 76].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0741, Accuracy: 86/530 (16.2264%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0435, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.6903, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0735, Accuracy: 125/953 (13.1165%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0402, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6010, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0729, Accuracy: 177/1131 (15.6499%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0343, Accuracy: 431/1131 (38.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7729, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0679, Accuracy: 253/1662 (15.2226%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0364, Accuracy: 528/1662 (31.7690%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6967, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0511, Accuracy: 271/1071 (25.3035%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/1071 (42.0168%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.7459, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   1, Avg loss: 0.0531, Accuracy: 238/677 (35.1551%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.8662, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0676, Accuracy: 249/803 (31.0087%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0401, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9099, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0587, Accuracy: 287/1089 (26.3545%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0328, Accuracy: 404/1089 (37.0983%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 13.6918, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0729, Accuracy: 189/1402 (13.4807%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0417, Accuracy: 346/1402 (24.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3125, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 15/466 (3.2189%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0456, Accuracy: 175/466 (37.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5356, Accuracy: 56/10000 (0.5600%)
time spent on training: 272.72061586380005
[rfa agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 1662, 1071, 677, 803, 1089, 1402, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 64, 38, 94, 55, 90, 58, 59, 66, 76], weight: tensor([0.0542, 0.0974, 0.1156, 0.1699, 0.1095, 0.0692, 0.0821, 0.1113, 0.1433,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 53.574153900146484, obj_val: 58.3968505859375, abs dis: 4.822696685791016
[rfa agg] iter: 0, weight: tensor([0.0387, 0.2129, 0.1295, 0.0699, 0.1427, 0.0697, 0.1308, 0.0872, 0.0893,
        0.0294])
[rfa agg] iter:  1, prev_obj_val: 58.3968505859375, obj_val: 62.83849334716797, abs dis: 4.441642761230469
[rfa agg] iter: 1, weight: tensor([0.0498, 0.1954, 0.1031, 0.0626, 0.1148, 0.0976, 0.1886, 0.0759, 0.0757,
        0.0366])
[rfa agg] iter:  2, prev_obj_val: 62.83849334716797, obj_val: 60.466392517089844, abs dis: 2.372100830078125
[rfa agg] iter: 2, weight: tensor([0.0627, 0.1539, 0.0914, 0.0602, 0.0996, 0.1318, 0.2139, 0.0710, 0.0708,
        0.0447])
[rfa agg] iter:  3, prev_obj_val: 60.466392517089844, obj_val: 62.81248092651367, abs dis: 2.346088409423828
[rfa agg] iter: 3, weight: tensor([0.0552, 0.1652, 0.0943, 0.0599, 0.1025, 0.1157, 0.2249, 0.0711, 0.0714,
        0.0398])
[rfa agg] iter:  4, prev_obj_val: 62.81248092651367, obj_val: 60.46722412109375, abs dis: 2.345256805419922
[rfa agg] iter: 4, weight: tensor([0.0623, 0.1501, 0.0902, 0.0594, 0.0976, 0.1331, 0.2232, 0.0698, 0.0699,
        0.0443])
[rfa agg] iter:  5, prev_obj_val: 60.46722412109375, obj_val: 62.812255859375, abs dis: 2.34503173828125
[rfa agg] iter: 5, weight: tensor([0.0551, 0.1644, 0.0941, 0.0597, 0.1021, 0.1156, 0.2273, 0.0709, 0.0712,
        0.0397])
[rfa agg] iter:  6, prev_obj_val: 62.812255859375, obj_val: 60.46725082397461, abs dis: 2.3450050354003906
[rfa agg] iter: 6, weight: tensor([0.0623, 0.1499, 0.0902, 0.0594, 0.0975, 0.1331, 0.2238, 0.0698, 0.0698,
        0.0443])
[rfa agg] iter:  7, prev_obj_val: 60.46725082397461, obj_val: 62.812252044677734, abs dis: 2.345001220703125
[rfa agg] iter: 7, weight: tensor([0.0551, 0.1643, 0.0941, 0.0597, 0.1021, 0.1156, 0.2274, 0.0708, 0.0712,
        0.0397])
[rfa agg] iter:  8, prev_obj_val: 62.812252044677734, obj_val: 60.46724319458008, abs dis: 2.3450088500976562
[rfa agg] iter: 8, weight: tensor([0.0623, 0.1499, 0.0902, 0.0594, 0.0975, 0.1330, 0.2238, 0.0698, 0.0698,
        0.0443])
[rfa agg] iter:  9, prev_obj_val: 60.46724319458008, obj_val: 62.81224822998047, abs dis: 2.3450050354003906
[rfa agg] iter: 9, weight: tensor([0.0551, 0.1643, 0.0941, 0.0597, 0.1021, 0.1156, 0.2274, 0.0708, 0.0712,
        0.0397])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8576, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.9673, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.2968692779541 sec.
Server Epoch:64 choose agents : [77, 13, 57, 64, 48, 23, 71, 35, 32, 75].
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   1, Avg loss: 0.0598, Accuracy: 284/1340 (21.1940%)
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   2, Avg loss: 0.0288, Accuracy: 547/1340 (40.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.7546, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0676, Accuracy: 247/1645 (15.0152%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0356, Accuracy: 519/1645 (31.5502%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.8224, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0696, Accuracy: 216/1154 (18.7175%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0283, Accuracy: 488/1154 (42.2877%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.6507, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0735, Accuracy: 108/953 (11.3326%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0400, Accuracy: 316/953 (33.1584%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5009, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0861, Accuracy: 61/631 (9.6672%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0487, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2973, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0795, Accuracy: 183/715 (25.5944%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0485, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1071, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0736, Accuracy: 127/818 (15.5257%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0332, Accuracy: 330/818 (40.3423%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.0214, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0974, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0638, Accuracy: 75/271 (27.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1497, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0617, Accuracy: 141/735 (19.1837%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 337/735 (45.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.5576, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   1, Avg loss: 0.0717, Accuracy: 174/776 (22.4227%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   2, Avg loss: 0.0313, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.5047, Accuracy: 76/10000 (0.7600%)
time spent on training: 240.08957743644714
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1645, 1154, 953, 631, 715, 818, 271, 735, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 13, 57, 64, 48, 23, 71, 35, 32, 75], weight: tensor([0.1483, 0.1820, 0.1277, 0.1054, 0.0698, 0.0791, 0.0905, 0.0300, 0.0813,
        0.0859])
[rfa agg] iter:  0, prev_obj_val: 53.50834274291992, obj_val: 58.24948501586914, abs dis: 4.741142272949219
[rfa agg] iter: 0, weight: tensor([0.0941, 0.0690, 0.0986, 0.1977, 0.0632, 0.0921, 0.1372, 0.0132, 0.1023,
        0.1326])
[rfa agg] iter:  1, prev_obj_val: 58.24948501586914, obj_val: 60.2774658203125, abs dis: 2.0279808044433594
[rfa agg] iter: 1, weight: tensor([0.0696, 0.0554, 0.0718, 0.1381, 0.0914, 0.1109, 0.1543, 0.0151, 0.1386,
        0.1548])
[rfa agg] iter:  2, prev_obj_val: 60.2774658203125, obj_val: 65.43201446533203, abs dis: 5.154548645019531
[rfa agg] iter: 2, weight: tensor([0.0665, 0.0540, 0.0682, 0.1216, 0.1066, 0.1155, 0.1505, 0.0162, 0.1514,
        0.1495])
[rfa agg] iter:  3, prev_obj_val: 65.43201446533203, obj_val: 65.41768646240234, abs dis: 0.0143280029296875
[rfa agg] iter: 3, weight: tensor([0.0654, 0.0548, 0.0664, 0.1066, 0.1493, 0.1188, 0.1349, 0.0197, 0.1525,
        0.1316])
[rfa agg] iter:  4, prev_obj_val: 65.41768646240234, obj_val: 62.69963073730469, abs dis: 2.7180557250976562
[rfa agg] iter: 4, weight: tensor([0.0651, 0.0545, 0.0660, 0.1057, 0.1548, 0.1189, 0.1332, 0.0197, 0.1530,
        0.1292])
[rfa agg] iter:  5, prev_obj_val: 62.69963073730469, obj_val: 65.42051696777344, abs dis: 2.72088623046875
[rfa agg] iter: 5, weight: tensor([0.0653, 0.0539, 0.0666, 0.1117, 0.1311, 0.1188, 0.1407, 0.0178, 0.1570,
        0.1371])
[rfa agg] iter:  6, prev_obj_val: 65.42051696777344, obj_val: 62.69903564453125, abs dis: 2.7214813232421875
[rfa agg] iter: 6, weight: tensor([0.0652, 0.0546, 0.0661, 0.1060, 0.1524, 0.1189, 0.1338, 0.0197, 0.1534,
        0.1300])
[rfa agg] iter:  7, prev_obj_val: 62.69903564453125, obj_val: 65.42057800292969, abs dis: 2.7215423583984375
[rfa agg] iter: 7, weight: tensor([0.0653, 0.0539, 0.0666, 0.1117, 0.1309, 0.1188, 0.1408, 0.0178, 0.1570,
        0.1372])
[rfa agg] iter:  8, prev_obj_val: 65.42057800292969, obj_val: 62.699031829833984, abs dis: 2.721546173095703
[rfa agg] iter: 8, weight: tensor([0.0652, 0.0546, 0.0661, 0.1060, 0.1524, 0.1189, 0.1338, 0.0197, 0.1534,
        0.1300])
[rfa agg] iter:  9, prev_obj_val: 62.699031829833984, obj_val: 65.42057037353516, abs dis: 2.721538543701172
[rfa agg] iter: 9, weight: tensor([0.0653, 0.0539, 0.0666, 0.1117, 0.1309, 0.1188, 0.1408, 0.0178, 0.1570,
        0.1372])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 16.8252, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 13.4042, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.25889468193054 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 84, 30, 66, 73, 81, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0642, Accuracy: 268/1581 (16.9513%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0366, Accuracy: 489/1581 (30.9298%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.9634, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0591, Accuracy: 311/1129 (27.5465%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0271, Accuracy: 658/1129 (58.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.8211, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0915, Accuracy: 13/338 (3.8462%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0513, Accuracy: 129/338 (38.1657%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.0642, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0718, Accuracy: 262/1154 (22.7036%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0311, Accuracy: 404/1154 (35.0087%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.2138, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   1, Avg loss: 0.0652, Accuracy: 309/1190 (25.9664%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 433/1190 (36.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.9432, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0829, Accuracy: 36/486 (7.4074%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0419, Accuracy: 234/486 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.3208, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0733, Accuracy: 183/1402 (13.0528%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 348/1402 (24.8217%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8469, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0786, Accuracy: 113/938 (12.0469%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0377, Accuracy: 345/938 (36.7804%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.4626, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   1, Avg loss: 0.0806, Accuracy: 170/774 (21.9638%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   2, Avg loss: 0.0413, Accuracy: 325/774 (41.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5343, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0659, Accuracy: 206/712 (28.9326%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0312, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.6412, Accuracy: 70/10000 (0.7000%)
time spent on training: 257.15641736984253
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1190, 486, 1402, 938, 774, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 37, 12, 15, 84, 30, 66, 73, 81, 11], weight: tensor([0.1629, 0.1163, 0.0348, 0.1189, 0.1226, 0.0501, 0.1445, 0.0967, 0.0798,
        0.0734])
[rfa agg] iter:  0, prev_obj_val: 52.711769104003906, obj_val: 57.89816665649414, abs dis: 5.186397552490234
[rfa agg] iter: 0, weight: tensor([0.0800, 0.1477, 0.0170, 0.1143, 0.1305, 0.0310, 0.0999, 0.1921, 0.1049,
        0.0826])
[rfa agg] iter:  1, prev_obj_val: 57.89816665649414, obj_val: 57.851043701171875, abs dis: 0.047122955322265625
[rfa agg] iter: 1, weight: tensor([0.0716, 0.1205, 0.0203, 0.0962, 0.1071, 0.0388, 0.0860, 0.2046, 0.1413,
        0.1137])
[rfa agg] iter:  2, prev_obj_val: 57.851043701171875, obj_val: 60.06376266479492, abs dis: 2.212718963623047
[rfa agg] iter: 2, weight: tensor([0.0706, 0.1176, 0.0202, 0.0944, 0.1049, 0.0385, 0.0848, 0.2073, 0.1462,
        0.1156])
[rfa agg] iter:  3, prev_obj_val: 60.06376266479492, obj_val: 57.85494613647461, abs dis: 2.2088165283203125
[rfa agg] iter: 3, weight: tensor([0.0695, 0.1112, 0.0218, 0.0909, 0.1000, 0.0424, 0.0824, 0.1922, 0.1590,
        0.1306])
[rfa agg] iter:  4, prev_obj_val: 57.85494613647461, obj_val: 60.0625, abs dis: 2.2075538635253906
[rfa agg] iter: 4, weight: tensor([0.0705, 0.1169, 0.0202, 0.0940, 0.1044, 0.0385, 0.0845, 0.2049, 0.1491,
        0.1170])
[rfa agg] iter:  5, prev_obj_val: 60.0625, obj_val: 57.85511779785156, abs dis: 2.2073822021484375
[rfa agg] iter: 5, weight: tensor([0.0695, 0.1111, 0.0218, 0.0908, 0.1000, 0.0424, 0.0823, 0.1918, 0.1595,
        0.1307])
[rfa agg] iter:  6, prev_obj_val: 57.85511779785156, obj_val: 60.06247329711914, abs dis: 2.207355499267578
[rfa agg] iter: 6, weight: tensor([0.0705, 0.1169, 0.0202, 0.0940, 0.1044, 0.0385, 0.0845, 0.2048, 0.1491,
        0.1170])
[rfa agg] iter:  7, prev_obj_val: 60.06247329711914, obj_val: 57.855125427246094, abs dis: 2.207347869873047
[rfa agg] iter: 7, weight: tensor([0.0695, 0.1111, 0.0218, 0.0908, 0.1000, 0.0424, 0.0823, 0.1918, 0.1595,
        0.1307])
[rfa agg] iter:  8, prev_obj_val: 57.855125427246094, obj_val: 60.062469482421875, abs dis: 2.2073440551757812
[rfa agg] iter: 8, weight: tensor([0.0705, 0.1169, 0.0202, 0.0940, 0.1044, 0.0385, 0.0845, 0.2048, 0.1491,
        0.1170])
[rfa agg] iter:  9, prev_obj_val: 60.062469482421875, obj_val: 57.855125427246094, abs dis: 2.2073440551757812
[rfa agg] iter: 9, weight: tensor([0.0695, 0.1111, 0.0218, 0.0908, 0.1000, 0.0424, 0.0823, 0.1918, 0.1595,
        0.1307])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 23.6153, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 19.3100, Accuracy: 0/9950 (0.0000%)
saving model
Done in 357.5417673587799 sec.
Server Epoch:66 choose agents : [89, 62, 94, 18, 81, 93, 91, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0767, Accuracy: 206/896 (22.9911%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0377, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.5769, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0661, Accuracy: 106/568 (18.6620%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.5874, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0675, Accuracy: 248/1662 (14.9218%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0361, Accuracy: 533/1662 (32.0698%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9421, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0744, Accuracy: 89/530 (16.7925%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.3408, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   1, Avg loss: 0.0777, Accuracy: 186/774 (24.0310%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   2, Avg loss: 0.0419, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.2785, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0588, Accuracy: 418/1742 (23.9954%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0325, Accuracy: 678/1742 (38.9208%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.2603, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   1, Avg loss: 0.0620, Accuracy: 232/1030 (22.5243%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   2, Avg loss: 0.0294, Accuracy: 573/1030 (55.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 11.0273, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0734, Accuracy: 135/938 (14.3923%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0365, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.6423, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0656, Accuracy: 208/891 (23.3446%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0299, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.1896, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0726, Accuracy: 126/818 (15.4034%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0323, Accuracy: 338/818 (41.3203%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.7684, Accuracy: 75/10000 (0.7500%)
time spent on training: 262.223703622818
[rfa agg] training data poison_ratio: 0.0  data num: [896, 568, 1662, 530, 774, 1742, 1030, 938, 891, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 62, 94, 18, 81, 93, 91, 73, 7, 71], weight: tensor([0.0910, 0.0577, 0.1687, 0.0538, 0.0786, 0.1769, 0.1046, 0.0952, 0.0905,
        0.0831])
[rfa agg] iter:  0, prev_obj_val: 59.905189514160156, obj_val: 63.00407791137695, abs dis: 3.098888397216797
[rfa agg] iter: 0, weight: tensor([0.1304, 0.0395, 0.0720, 0.0361, 0.0954, 0.0648, 0.1249, 0.1709, 0.1502,
        0.1158])
[rfa agg] iter:  1, prev_obj_val: 63.00407791137695, obj_val: 69.42486572265625, abs dis: 6.420787811279297
[rfa agg] iter: 1, weight: tensor([0.1368, 0.0482, 0.0540, 0.0436, 0.1117, 0.0497, 0.0887, 0.1466, 0.1646,
        0.1560])
[rfa agg] iter:  2, prev_obj_val: 69.42486572265625, obj_val: 66.93214416503906, abs dis: 2.4927215576171875
[rfa agg] iter: 2, weight: tensor([0.1265, 0.0736, 0.0543, 0.0644, 0.1220, 0.0506, 0.0793, 0.1170, 0.1432,
        0.1691])
[rfa agg] iter:  3, prev_obj_val: 66.93214416503906, obj_val: 66.93046569824219, abs dis: 0.001678466796875
[rfa agg] iter: 3, weight: tensor([0.1284, 0.0629, 0.0531, 0.0557, 0.1230, 0.0493, 0.0799, 0.1213, 0.1494,
        0.1771])
[rfa agg] iter:  4, prev_obj_val: 66.93046569824219, obj_val: 69.40680694580078, abs dis: 2.4763412475585938
[rfa agg] iter: 4, weight: tensor([0.1285, 0.0626, 0.0530, 0.0554, 0.1225, 0.0492, 0.0798, 0.1211, 0.1497,
        0.1780])
[rfa agg] iter:  5, prev_obj_val: 69.40680694580078, obj_val: 69.40484619140625, abs dis: 0.00196075439453125
[rfa agg] iter: 5, weight: tensor([0.1249, 0.0738, 0.0541, 0.0645, 0.1236, 0.0504, 0.0788, 0.1153, 0.1415,
        0.1732])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.8601, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.8328, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.0506241321564 sec.
Server Epoch:67 choose agents : [44, 83, 96, 56, 6, 74, 64, 39, 14, 77].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0670, Accuracy: 306/1750 (17.4857%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0384, Accuracy: 592/1750 (33.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0604, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   1, Avg loss: 0.0590, Accuracy: 384/1953 (19.6621%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   2, Avg loss: 0.0366, Accuracy: 672/1953 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1337, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0719, Accuracy: 20/311 (6.4309%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0484, Accuracy: 118/311 (37.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.8622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0936, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0765, Accuracy: 13/186 (6.9892%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7249, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0629, Accuracy: 350/1956 (17.8937%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0340, Accuracy: 597/1956 (30.5215%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9450, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   1, Avg loss: 0.0462, Accuracy: 455/1552 (29.3170%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 728/1552 (46.9072%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 13.1078, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0713, Accuracy: 121/953 (12.6967%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0409, Accuracy: 280/953 (29.3809%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.6237, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0622, Accuracy: 240/1013 (23.6920%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0272, Accuracy: 464/1013 (45.8045%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.2512, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0791, Accuracy: 89/1013 (8.7858%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0384, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8281, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   1, Avg loss: 0.0616, Accuracy: 285/1340 (21.2687%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   2, Avg loss: 0.0288, Accuracy: 559/1340 (41.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.3122, Accuracy: 82/10000 (0.8200%)
time spent on training: 306.0596969127655
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1953, 311, 186, 1956, 1552, 953, 1013, 1013, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 83, 96, 56, 6, 74, 64, 39, 14, 77], weight: tensor([0.1455, 0.1624, 0.0259, 0.0155, 0.1626, 0.1290, 0.0792, 0.0842, 0.0842,
        0.1114])
[rfa agg] iter:  0, prev_obj_val: 67.15853881835938, obj_val: 67.98626708984375, abs dis: 0.827728271484375
[rfa agg] iter: 0, weight: tensor([0.1364, 0.1073, 0.0093, 0.0049, 0.1067, 0.1834, 0.0670, 0.0796, 0.0802,
        0.2252])
[rfa agg] iter:  1, prev_obj_val: 67.98626708984375, obj_val: 69.16398620605469, abs dis: 1.1777191162109375
[rfa agg] iter: 1, weight: tensor([0.1242, 0.0987, 0.0093, 0.0049, 0.0981, 0.1706, 0.0691, 0.0823, 0.0830,
        0.2599])
[rfa agg] iter:  2, prev_obj_val: 69.16398620605469, obj_val: 72.00611114501953, abs dis: 2.8421249389648438
[rfa agg] iter: 2, weight: tensor([0.1161, 0.0938, 0.0095, 0.0050, 0.0933, 0.1559, 0.0736, 0.0879, 0.0887,
        0.2761])
[rfa agg] iter:  3, prev_obj_val: 72.00611114501953, obj_val: 71.99539184570312, abs dis: 0.01071929931640625
[rfa agg] iter: 3, weight: tensor([0.1060, 0.0881, 0.0104, 0.0053, 0.0878, 0.1367, 0.0874, 0.1049, 0.1061,
        0.2672])
[rfa agg] iter:  4, prev_obj_val: 71.99539184570312, obj_val: 71.99530792236328, abs dis: 8.392333984375e-05
[rfa agg] iter: 4, weight: tensor([0.1061, 0.0882, 0.0104, 0.0054, 0.0880, 0.1362, 0.0879, 0.1060, 0.1071,
        0.2648])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8657, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.6725, Accuracy: 0/9950 (0.0000%)
saving model
Done in 403.10744166374207 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 83, 9, 17, 87, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0617, Accuracy: 295/1949 (15.1360%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0350, Accuracy: 566/1949 (29.0405%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.8952, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.1005, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0559, Accuracy: 109/312 (34.9359%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.2579, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0521, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0304, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.0488, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0669, Accuracy: 296/1750 (16.9143%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0380, Accuracy: 598/1750 (34.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1155, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0579, Accuracy: 356/1953 (18.2284%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0367, Accuracy: 670/1953 (34.3062%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1805, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0594, Accuracy: 286/1275 (22.4314%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0211, Accuracy: 638/1275 (50.0392%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.5094, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0632, Accuracy: 339/1574 (21.5375%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0303, Accuracy: 628/1574 (39.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.7645, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0691, Accuracy: 226/1131 (19.9823%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 380/1131 (33.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.5019, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0541, Accuracy: 234/636 (36.7925%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0296, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.7083, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0648, Accuracy: 228/888 (25.6757%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0287, Accuracy: 397/888 (44.7072%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 11.2621, Accuracy: 73/10000 (0.7300%)
time spent on training: 310.21478962898254
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1953, 1275, 1574, 1131, 636, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 24, 59, 44, 83, 9, 17, 87, 52, 63], weight: tensor([0.1552, 0.0248, 0.0867, 0.1394, 0.1555, 0.1015, 0.1253, 0.0901, 0.0506,
        0.0707])
[rfa agg] iter:  0, prev_obj_val: 69.00898742675781, obj_val: 69.83345794677734, abs dis: 0.8244705200195312
[rfa agg] iter: 0, weight: tensor([0.1014, 0.0097, 0.0876, 0.1255, 0.1020, 0.1851, 0.1724, 0.1293, 0.0284,
        0.0586])
[rfa agg] iter:  1, prev_obj_val: 69.83345794677734, obj_val: 72.23512268066406, abs dis: 2.4016647338867188
[rfa agg] iter: 1, weight: tensor([0.0941, 0.0097, 0.0894, 0.1150, 0.0947, 0.2077, 0.1591, 0.1407, 0.0289,
        0.0608])
[rfa agg] iter:  2, prev_obj_val: 72.23512268066406, obj_val: 73.66789245605469, abs dis: 1.432769775390625
[rfa agg] iter: 2, weight: tensor([0.0851, 0.0101, 0.0943, 0.1014, 0.0856, 0.2230, 0.1343, 0.1667, 0.0311,
        0.0682])
[rfa agg] iter:  3, prev_obj_val: 73.66789245605469, obj_val: 72.21601104736328, abs dis: 1.4518814086914062
[rfa agg] iter: 3, weight: tensor([0.0810, 0.0104, 0.0963, 0.0951, 0.0813, 0.2239, 0.1231, 0.1839, 0.0323,
        0.0727])
[rfa agg] iter:  4, prev_obj_val: 72.21601104736328, obj_val: 72.21329498291016, abs dis: 0.002716064453125
[rfa agg] iter: 4, weight: tensor([0.0840, 0.0100, 0.0936, 0.0996, 0.0844, 0.2281, 0.1308, 0.1711, 0.0307,
        0.0676])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8842, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.9963, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.10445189476013 sec.
Server Epoch:69 choose agents : [21, 31, 44, 89, 70, 80, 83, 5, 69, 75].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0614, Accuracy: 321/1949 (16.4700%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0357, Accuracy: 534/1949 (27.3987%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.2773, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0920, Accuracy: 18/460 (3.9130%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0430, Accuracy: 168/460 (36.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.2836, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0656, Accuracy: 302/1750 (17.2571%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0381, Accuracy: 627/1750 (35.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1566, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   1, Avg loss: 0.0764, Accuracy: 207/896 (23.1027%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   2, Avg loss: 0.0389, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4845, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0646, Accuracy: 267/1418 (18.8293%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0348, Accuracy: 568/1418 (40.0564%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.5236, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   1, Avg loss: 0.0737, Accuracy: 98/682 (14.3695%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   2, Avg loss: 0.0397, Accuracy: 264/682 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.9755, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 393/1953 (20.1229%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0363, Accuracy: 695/1953 (35.5863%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3928, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0591, Accuracy: 295/1628 (18.1204%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0267, Accuracy: 776/1628 (47.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.3106, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0624, Accuracy: 204/590 (34.5763%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0361, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.7872, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   1, Avg loss: 0.0701, Accuracy: 176/776 (22.6804%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.6622, Accuracy: 67/10000 (0.6700%)
time spent on training: 326.6361348628998
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 896, 1418, 682, 1953, 1628, 590, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 31, 44, 89, 70, 80, 83, 5, 69, 75], weight: tensor([0.1610, 0.0380, 0.1446, 0.0740, 0.1172, 0.0564, 0.1614, 0.1345, 0.0488,
        0.0641])
[rfa agg] iter:  0, prev_obj_val: 76.52664184570312, obj_val: 76.38762664794922, abs dis: 0.13901519775390625
[rfa agg] iter: 0, weight: tensor([0.1163, 0.0218, 0.1428, 0.0744, 0.2212, 0.0417, 0.1180, 0.1729, 0.0331,
        0.0578])
[rfa agg] iter:  1, prev_obj_val: 76.38762664794922, obj_val: 76.38512420654297, abs dis: 0.00250244140625
[rfa agg] iter: 1, weight: tensor([0.1134, 0.0213, 0.1398, 0.0731, 0.2361, 0.0408, 0.1153, 0.1710, 0.0324,
        0.0566])
[rfa agg] iter:  2, prev_obj_val: 76.38512420654297, obj_val: 76.38504028320312, abs dis: 8.392333984375e-05
[rfa agg] iter: 2, weight: tensor([0.1131, 0.0213, 0.1392, 0.0728, 0.2387, 0.0407, 0.1150, 0.1703, 0.0323,
        0.0565])
[rfa agg] iter:  3, prev_obj_val: 76.38504028320312, obj_val: 74.89266204833984, abs dis: 1.4923782348632812
[rfa agg] iter: 3, weight: tensor([0.1130, 0.0213, 0.1391, 0.0728, 0.2392, 0.0407, 0.1150, 0.1701, 0.0323,
        0.0564])
[rfa agg] iter:  4, prev_obj_val: 74.89266204833984, obj_val: 74.89112091064453, abs dis: 0.0015411376953125
[rfa agg] iter: 4, weight: tensor([0.1139, 0.0198, 0.1421, 0.0661, 0.2471, 0.0375, 0.1159, 0.1762, 0.0298,
        0.0515])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.9122, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 6.1860, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.41052174568176 sec.
Server Epoch:70 choose agents : [7, 74, 76, 0, 16, 9, 19, 97, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0645, Accuracy: 210/891 (23.5690%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0293, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.4470, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0454, Accuracy: 453/1552 (29.1881%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 740/1552 (47.6804%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 12.4147, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 20/466 (4.2918%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   2, Avg loss: 0.0473, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2393, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   1, Avg loss: 0.0648, Accuracy: 245/1657 (14.7858%)
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   2, Avg loss: 0.0359, Accuracy: 463/1657 (27.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1290, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0648, Accuracy: 222/708 (31.3559%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3590, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0583, Accuracy: 287/1275 (22.5098%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0208, Accuracy: 664/1275 (52.0784%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.9579, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0515, Accuracy: 335/1036 (32.3359%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 647/1036 (62.4517%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.4562, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0556, Accuracy: 263/1213 (21.6818%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0301, Accuracy: 485/1213 (39.9835%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.8843, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0895, Accuracy: 44/631 (6.9731%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0489, Accuracy: 207/631 (32.8051%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4259, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0726, Accuracy: 175/1402 (12.4822%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0428, Accuracy: 345/1402 (24.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4391, Accuracy: 77/10000 (0.7700%)
time spent on training: 311.11486887931824
[rfa agg] training data poison_ratio: 0.15298679715631058  data num: [891, 1552, 466, 1657, 708, 1275, 1036, 1213, 631, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.04780837411134706
[rfa agg] init. name: [7, 74, 76, 0, 16, 9, 19, 97, 48, 66], weight: tensor([0.0823, 0.1433, 0.0430, 0.1530, 0.0654, 0.1177, 0.0957, 0.1120, 0.0583,
        0.1294])
[rfa agg] iter:  0, prev_obj_val: 55.71235656738281, obj_val: 58.770713806152344, abs dis: 3.0583572387695312
[rfa agg] iter: 0, weight: tensor([0.1058, 0.0876, 0.0242, 0.0859, 0.0586, 0.1349, 0.1866, 0.1564, 0.0418,
        0.1183])
[rfa agg] iter:  1, prev_obj_val: 58.770713806152344, obj_val: 60.65030288696289, abs dis: 1.8795890808105469
[rfa agg] iter: 1, weight: tensor([0.1289, 0.0806, 0.0276, 0.0795, 0.0694, 0.1210, 0.1958, 0.1431, 0.0492,
        0.1049])
[rfa agg] iter:  2, prev_obj_val: 60.65030288696289, obj_val: 58.76123809814453, abs dis: 1.8890647888183594
[rfa agg] iter: 2, weight: tensor([0.1463, 0.0787, 0.0299, 0.0778, 0.0774, 0.1148, 0.1862, 0.1340, 0.0544,
        0.1005])
[rfa agg] iter:  3, prev_obj_val: 58.76123809814453, obj_val: 60.64805221557617, abs dis: 1.8868141174316406
[rfa agg] iter: 3, weight: tensor([0.1337, 0.0803, 0.0276, 0.0792, 0.0702, 0.1197, 0.1948, 0.1408, 0.0493,
        0.1045])
[rfa agg] iter:  4, prev_obj_val: 60.64805221557617, obj_val: 58.76150131225586, abs dis: 1.8865509033203125
[rfa agg] iter: 4, weight: tensor([0.1469, 0.0786, 0.0299, 0.0777, 0.0775, 0.1147, 0.1859, 0.1338, 0.0544,
        0.1005])
[rfa agg] iter:  5, prev_obj_val: 58.76150131225586, obj_val: 60.64802551269531, abs dis: 1.8865242004394531
[rfa agg] iter: 5, weight: tensor([0.1337, 0.0803, 0.0276, 0.0792, 0.0702, 0.1197, 0.1947, 0.1408, 0.0493,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 60.64802551269531, obj_val: 58.76150894165039, abs dis: 1.8865165710449219
[rfa agg] iter: 6, weight: tensor([0.1469, 0.0786, 0.0299, 0.0777, 0.0775, 0.1147, 0.1858, 0.1338, 0.0544,
        0.1005])
[rfa agg] iter:  7, prev_obj_val: 58.76150894165039, obj_val: 60.648033142089844, abs dis: 1.8865242004394531
[rfa agg] iter: 7, weight: tensor([0.1337, 0.0803, 0.0276, 0.0792, 0.0702, 0.1197, 0.1947, 0.1408, 0.0493,
        0.1045])
[rfa agg] iter:  8, prev_obj_val: 60.648033142089844, obj_val: 58.76150894165039, abs dis: 1.8865242004394531
[rfa agg] iter: 8, weight: tensor([0.1469, 0.0786, 0.0299, 0.0777, 0.0775, 0.1147, 0.1858, 0.1338, 0.0544,
        0.1005])
[rfa agg] iter:  9, prev_obj_val: 58.76150894165039, obj_val: 60.648033142089844, abs dis: 1.8865242004394531
[rfa agg] iter: 9, weight: tensor([0.1337, 0.0803, 0.0276, 0.0792, 0.0702, 0.1197, 0.1947, 0.1408, 0.0493,
        0.1045])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 18.0860, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 17.6882, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.0570147037506 sec.
Server Epoch:71 choose agents : [49, 6, 74, 90, 82, 24, 33, 78, 18, 84].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0867, Accuracy: 11/440 (2.5000%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0508, Accuracy: 136/440 (30.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2733, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0636, Accuracy: 330/1956 (16.8712%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0349, Accuracy: 574/1956 (29.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.2722, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   1, Avg loss: 0.0443, Accuracy: 496/1552 (31.9588%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 755/1552 (48.6469%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.1766, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   1, Avg loss: 0.0544, Accuracy: 252/677 (37.2230%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 12.2787, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   1, Avg loss: 0.0891, Accuracy: 7/500 (1.4000%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   2, Avg loss: 0.0512, Accuracy: 182/500 (36.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.6137, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0980, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0539, Accuracy: 114/312 (36.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.0848, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0877, Accuracy: 55/515 (10.6796%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0582, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1976, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   1, Avg loss: 0.0800, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   2, Avg loss: 0.0437, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.9737, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0793, Accuracy: 65/530 (12.2642%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.6920, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   1, Avg loss: 0.0665, Accuracy: 262/1190 (22.0168%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   2, Avg loss: 0.0344, Accuracy: 431/1190 (36.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.3330, Accuracy: 63/10000 (0.6300%)
time spent on training: 249.82358527183533
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1956, 1552, 677, 500, 312, 515, 416, 530, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 6, 74, 90, 82, 24, 33, 78, 18, 84], weight: tensor([0.0544, 0.2418, 0.1919, 0.0837, 0.0618, 0.0386, 0.0637, 0.0514, 0.0655,
        0.1471])
[rfa agg] iter:  0, prev_obj_val: 86.49317169189453, obj_val: 87.64446258544922, abs dis: 1.1512908935546875
[rfa agg] iter: 0, weight: tensor([0.0502, 0.1258, 0.1575, 0.1364, 0.0642, 0.0284, 0.0720, 0.0471, 0.0761,
        0.2422])
[rfa agg] iter:  1, prev_obj_val: 87.64446258544922, obj_val: 89.14729309082031, abs dis: 1.5028305053710938
[rfa agg] iter: 1, weight: tensor([0.0545, 0.1142, 0.1388, 0.1622, 0.0707, 0.0301, 0.0796, 0.0511, 0.0849,
        0.2138])
[rfa agg] iter:  2, prev_obj_val: 89.14729309082031, obj_val: 90.84547424316406, abs dis: 1.69818115234375
[rfa agg] iter: 2, weight: tensor([0.0591, 0.1023, 0.1209, 0.1965, 0.0779, 0.0316, 0.0879, 0.0551, 0.0949,
        0.1739])
[rfa agg] iter:  3, prev_obj_val: 90.84547424316406, obj_val: 92.88795471191406, abs dis: 2.04248046875
[rfa agg] iter: 3, weight: tensor([0.0624, 0.0880, 0.1013, 0.2383, 0.0842, 0.0320, 0.0944, 0.0580, 0.1043,
        0.1372])
[rfa agg] iter:  4, prev_obj_val: 92.88795471191406, obj_val: 94.10755920410156, abs dis: 1.2196044921875
[rfa agg] iter: 4, weight: tensor([0.0653, 0.0734, 0.0826, 0.2774, 0.0904, 0.0318, 0.0990, 0.0601, 0.1136,
        0.1064])
[rfa agg] iter:  5, prev_obj_val: 94.10755920410156, obj_val: 97.21554565429688, abs dis: 3.1079864501953125
[rfa agg] iter: 5, weight: tensor([0.0676, 0.0669, 0.0745, 0.2877, 0.0950, 0.0318, 0.1013, 0.0617, 0.1198,
        0.0936])
[rfa agg] iter:  6, prev_obj_val: 97.21554565429688, obj_val: 95.54803466796875, abs dis: 1.667510986328125
[rfa agg] iter: 6, weight: tensor([0.0801, 0.0609, 0.0666, 0.2373, 0.1156, 0.0349, 0.1116, 0.0718, 0.1403,
        0.0808])
[rfa agg] iter:  7, prev_obj_val: 95.54803466796875, obj_val: 99.06002807617188, abs dis: 3.511993408203125
[rfa agg] iter: 7, weight: tensor([0.0740, 0.0636, 0.0701, 0.2556, 0.1068, 0.0334, 0.1086, 0.0671, 0.1344,
        0.0862])
[rfa agg] iter:  8, prev_obj_val: 99.06002807617188, obj_val: 97.18863677978516, abs dis: 1.8713912963867188
[rfa agg] iter: 8, weight: tensor([0.0896, 0.0587, 0.0637, 0.1967, 0.1312, 0.0372, 0.1163, 0.0794, 0.1513,
        0.0760])
[rfa agg] iter:  9, prev_obj_val: 97.18863677978516, obj_val: 97.1836929321289, abs dis: 0.00494384765625
[rfa agg] iter: 9, weight: tensor([0.0819, 0.0610, 0.0666, 0.2169, 0.1212, 0.0354, 0.1147, 0.0737, 0.1479,
        0.0805])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8867, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 6.6369, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.6986086368561 sec.
Server Epoch:72 choose agents : [31, 17, 64, 91, 34, 99, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0943, Accuracy: 4/460 (0.8696%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0410, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.2166, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0602, Accuracy: 351/1574 (22.2999%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0300, Accuracy: 621/1574 (39.4536%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.2921, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0735, Accuracy: 116/953 (12.1721%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7130, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0619, Accuracy: 267/1030 (25.9223%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0279, Accuracy: 579/1030 (56.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.9838, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0718, Accuracy: 284/1427 (19.9019%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0377, Accuracy: 526/1427 (36.8605%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3158, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0696, Accuracy: 154/773 (19.9224%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 392/773 (50.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.7529, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0713, Accuracy: 263/901 (29.1898%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0360, Accuracy: 398/901 (44.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3163, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0613, Accuracy: 230/888 (25.9009%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0286, Accuracy: 424/888 (47.7477%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.3087, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0470, Accuracy: 458/1470 (31.1565%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.9038, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0516, Accuracy: 340/1036 (32.8185%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 653/1036 (63.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.3742, Accuracy: 74/10000 (0.7400%)
time spent on training: 318.82150745391846
[rfa agg] training data poison_ratio: 0.0  data num: [460, 1574, 953, 1030, 1427, 773, 901, 888, 1470, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [31, 17, 64, 91, 34, 99, 4, 63, 22, 19], weight: tensor([0.0438, 0.1497, 0.0907, 0.0980, 0.1357, 0.0735, 0.0857, 0.0845, 0.1398,
        0.0986])
[rfa agg] iter:  0, prev_obj_val: 52.469871520996094, obj_val: 54.97280502319336, abs dis: 2.5029335021972656
[rfa agg] iter: 0, weight: tensor([0.0249, 0.0750, 0.1496, 0.1169, 0.0872, 0.0805, 0.1111, 0.1226, 0.0877,
        0.1445])
[rfa agg] iter:  1, prev_obj_val: 54.97280502319336, obj_val: 54.949005126953125, abs dis: 0.023799896240234375
[rfa agg] iter: 1, weight: tensor([0.0270, 0.0652, 0.1674, 0.1048, 0.0745, 0.0909, 0.1166, 0.1479, 0.0749,
        0.1308])
[rfa agg] iter:  2, prev_obj_val: 54.949005126953125, obj_val: 54.94865036010742, abs dis: 0.000354766845703125
[rfa agg] iter: 2, weight: tensor([0.0268, 0.0645, 0.1701, 0.1025, 0.0738, 0.0913, 0.1168, 0.1513, 0.0739,
        0.1288])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.7970, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 12.6029, Accuracy: 2/9950 (0.0201%)
saving model
Done in 411.0832440853119 sec.
Server Epoch:73 choose agents : [27, 0, 34, 96, 4, 72, 81, 12, 59, 88].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0608, Accuracy: 344/1587 (21.6761%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0360, Accuracy: 551/1587 (34.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1903, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   1, Avg loss: 0.0650, Accuracy: 273/1657 (16.4756%)
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   2, Avg loss: 0.0361, Accuracy: 482/1657 (29.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.9576, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0715, Accuracy: 288/1427 (20.1822%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 571/1427 (40.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.2132, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0515, Accuracy: 114/311 (36.6559%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6326, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0678, Accuracy: 279/901 (30.9656%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0364, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.3020, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0696, Accuracy: 188/1241 (15.1491%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0408, Accuracy: 372/1241 (29.9758%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5811, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0743, Accuracy: 172/774 (22.2222%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0392, Accuracy: 346/774 (44.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0267, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.1054, Accuracy: 9/338 (2.6627%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0574, Accuracy: 121/338 (35.7988%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4102, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0583, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0377, Accuracy: 383/1089 (35.1699%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 14.7387, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   1, Avg loss: 0.0958, Accuracy: 21/603 (3.4826%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   2, Avg loss: 0.0500, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4650, Accuracy: 55/10000 (0.5500%)
time spent on training: 328.76691460609436
[rfa agg] training data poison_ratio: 0.1669016921837228  data num: [1587, 1657, 1427, 311, 901, 1241, 774, 338, 1089, 603]
[rfa agg] considering poison per batch poison_fraction: 0.05215677880741337
[rfa agg] init. name: [27, 0, 34, 96, 4, 72, 81, 12, 59, 88], weight: tensor([0.1599, 0.1669, 0.1437, 0.0313, 0.0908, 0.1250, 0.0780, 0.0340, 0.1097,
        0.0607])
[rfa agg] iter:  0, prev_obj_val: 64.79728698730469, obj_val: 64.69991302490234, abs dis: 0.09737396240234375
[rfa agg] iter: 0, weight: tensor([0.1214, 0.1138, 0.1382, 0.0159, 0.1553, 0.1915, 0.1014, 0.0190, 0.0912,
        0.0525])
[rfa agg] iter:  1, prev_obj_val: 64.69991302490234, obj_val: 66.15547180175781, abs dis: 1.4555587768554688
[rfa agg] iter: 1, weight: tensor([0.1196, 0.1121, 0.1366, 0.0157, 0.1608, 0.1953, 0.1009, 0.0187, 0.0885,
        0.0519])
[rfa agg] iter:  2, prev_obj_val: 66.15547180175781, obj_val: 66.14995574951172, abs dis: 0.00551605224609375
[rfa agg] iter: 2, weight: tensor([0.1145, 0.1079, 0.1294, 0.0165, 0.1757, 0.1809, 0.1110, 0.0197, 0.0884,
        0.0560])
[rfa agg] iter:  3, prev_obj_val: 66.14995574951172, obj_val: 66.14985656738281, abs dis: 9.918212890625e-05
[rfa agg] iter: 3, weight: tensor([0.1143, 0.1076, 0.1290, 0.0164, 0.1784, 0.1792, 0.1113, 0.0197, 0.0882,
        0.0559])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 12.6826, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 11.6475, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.1331994533539 sec.
Server Epoch:74 choose agents : [9, 38, 0, 63, 50, 44, 1, 92, 93, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0590, Accuracy: 279/1275 (21.8824%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0211, Accuracy: 654/1275 (51.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.4148, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0691, Accuracy: 197/1131 (17.4182%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0340, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3768, Accuracy: 90/10000 (0.9000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0636, Accuracy: 280/1657 (16.8980%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0364, Accuracy: 470/1657 (28.3645%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.5277, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0604, Accuracy: 224/888 (25.2252%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0287, Accuracy: 413/888 (46.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.0631, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0800, Accuracy: 74/809 (9.1471%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0317, Accuracy: 313/809 (38.6897%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.7410, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0677, Accuracy: 310/1750 (17.7143%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0392, Accuracy: 564/1750 (32.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0605, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 281/928 (30.2802%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 538/928 (57.9741%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.4066, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0579, Accuracy: 350/1715 (20.4082%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0327, Accuracy: 639/1715 (37.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5783, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0599, Accuracy: 396/1742 (22.7325%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0327, Accuracy: 666/1742 (38.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.4455, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 226/813 (27.7983%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0225, Accuracy: 448/813 (55.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 13.2275, Accuracy: 56/10000 (0.5600%)
time spent on training: 371.8251757621765
[rfa agg] training data poison_ratio: 0.13039030531948378  data num: [1275, 1131, 1657, 888, 809, 1750, 928, 1715, 1742, 813]
[rfa agg] considering poison per batch poison_fraction: 0.040746970412338684
[rfa agg] init. name: [9, 38, 0, 63, 50, 44, 1, 92, 93, 53], weight: tensor([0.1003, 0.0890, 0.1304, 0.0699, 0.0637, 0.1377, 0.0730, 0.1350, 0.1371,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 62.88513946533203, obj_val: 63.784053802490234, abs dis: 0.8989143371582031
[rfa agg] iter: 0, weight: tensor([0.2000, 0.1462, 0.1100, 0.0695, 0.0561, 0.0929, 0.0788, 0.0979, 0.0923,
        0.0562])
[rfa agg] iter:  1, prev_obj_val: 63.784053802490234, obj_val: 66.50707244873047, abs dis: 2.7230186462402344
[rfa agg] iter: 1, weight: tensor([0.2103, 0.1581, 0.1006, 0.0724, 0.0581, 0.0850, 0.0830, 0.0895, 0.0845,
        0.0584])
[rfa agg] iter:  2, prev_obj_val: 66.50707244873047, obj_val: 68.10005950927734, abs dis: 1.592987060546875
[rfa agg] iter: 2, weight: tensor([0.1833, 0.1694, 0.0908, 0.0853, 0.0678, 0.0782, 0.0971, 0.0821, 0.0777,
        0.0682])
[rfa agg] iter:  3, prev_obj_val: 68.10005950927734, obj_val: 68.09590148925781, abs dis: 0.00415802001953125
[rfa agg] iter: 3, weight: tensor([0.1653, 0.1710, 0.0866, 0.0939, 0.0740, 0.0753, 0.1058, 0.0789, 0.0748,
        0.0744])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.2604, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 10.1256, Accuracy: 5/9950 (0.0503%)
saving model
Done in 470.32728099823 sec.
Server Epoch:75 choose agents : [88, 65, 74, 85, 4, 55, 81, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1, Avg loss: 0.0944, Accuracy: 27/603 (4.4776%)
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2, Avg loss: 0.0500, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5924, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0721, Accuracy: 258/1475 (17.4915%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0343, Accuracy: 536/1475 (36.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9596, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0470, Accuracy: 472/1552 (30.4124%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0234, Accuracy: 705/1552 (45.4253%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.8412, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0654, Accuracy: 309/1988 (15.5433%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0370, Accuracy: 605/1988 (30.4326%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7033, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0688, Accuracy: 271/901 (30.0777%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0346, Accuracy: 396/901 (43.9512%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.0948, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0487, Accuracy: 281/1071 (26.2372%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5414, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   1, Avg loss: 0.0727, Accuracy: 181/774 (23.3850%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   2, Avg loss: 0.0381, Accuracy: 330/774 (42.6357%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1540, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0971, Accuracy: 14/338 (4.1420%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0560, Accuracy: 129/338 (38.1657%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9185, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0591, Accuracy: 339/1949 (17.3935%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0353, Accuracy: 554/1949 (28.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3600, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0715, Accuracy: 116/953 (12.1721%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3435, Accuracy: 63/10000 (0.6300%)
time spent on training: 320.6295301914215
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1475, 1552, 1988, 901, 1071, 774, 338, 1949, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 65, 74, 85, 4, 55, 81, 12, 21, 64], weight: tensor([0.0520, 0.1271, 0.1337, 0.1713, 0.0776, 0.0923, 0.0667, 0.0291, 0.1680,
        0.0821])
[rfa agg] iter:  0, prev_obj_val: 75.45294952392578, obj_val: 77.87924194335938, abs dis: 2.4262924194335938
[rfa agg] iter: 0, weight: tensor([0.0356, 0.1696, 0.1742, 0.1041, 0.0897, 0.1411, 0.0608, 0.0144, 0.1129,
        0.0977])
[rfa agg] iter:  1, prev_obj_val: 77.87924194335938, obj_val: 80.0373306274414, abs dis: 2.1580886840820312
[rfa agg] iter: 1, weight: tensor([0.0398, 0.1417, 0.1412, 0.0898, 0.1077, 0.1773, 0.0706, 0.0155, 0.0966,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 80.0373306274414, obj_val: 81.29190826416016, abs dis: 1.25457763671875
[rfa agg] iter: 2, weight: tensor([0.0425, 0.1194, 0.1191, 0.0803, 0.1216, 0.1999, 0.0779, 0.0160, 0.0858,
        0.1376])
[rfa agg] iter:  3, prev_obj_val: 81.29190826416016, obj_val: 82.71023559570312, abs dis: 1.4183273315429688
[rfa agg] iter: 3, weight: tensor([0.0438, 0.1089, 0.1089, 0.0755, 0.1290, 0.2077, 0.0818, 0.0161, 0.0804,
        0.1478])
[rfa agg] iter:  4, prev_obj_val: 82.71023559570312, obj_val: 82.70633697509766, abs dis: 0.00389862060546875
[rfa agg] iter: 4, weight: tensor([0.0455, 0.1005, 0.1006, 0.0715, 0.1366, 0.2077, 0.0864, 0.0164, 0.0759,
        0.1589])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 14.2871, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 13.8438, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.45320320129395 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 83, 39, 17, 88, 92, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0576, Accuracy: 287/1628 (17.6290%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0281, Accuracy: 700/1628 (42.9975%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0187, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0713, Accuracy: 171/1241 (13.7792%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0419, Accuracy: 352/1241 (28.3642%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3568, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0666, Accuracy: 151/861 (17.5377%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0241, Accuracy: 426/861 (49.4774%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.7319, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0487, Accuracy: 265/1071 (24.7432%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0302, Accuracy: 468/1071 (43.6975%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6814, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   1, Avg loss: 0.0589, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   2, Avg loss: 0.0366, Accuracy: 673/1953 (34.4598%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6750, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0652, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0286, Accuracy: 415/1013 (40.9674%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8709, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0614, Accuracy: 323/1574 (20.5210%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0299, Accuracy: 607/1574 (38.5642%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.1611, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0953, Accuracy: 27/603 (4.4776%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0492, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.5838, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0573, Accuracy: 371/1715 (21.6327%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0325, Accuracy: 650/1715 (37.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.9024, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.1074, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0695, Accuracy: 70/271 (25.8303%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.3680, Accuracy: 57/10000 (0.5700%)
time spent on training: 349.45041942596436
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1953, 1013, 1574, 603, 1715, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 72, 10, 55, 83, 39, 17, 88, 92, 35], weight: tensor([0.1365, 0.1040, 0.0722, 0.0898, 0.1637, 0.0849, 0.1319, 0.0505, 0.1438,
        0.0227])
[rfa agg] iter:  0, prev_obj_val: 64.23078155517578, obj_val: 67.05386352539062, abs dis: 2.8230819702148438
[rfa agg] iter: 0, weight: tensor([0.1377, 0.1980, 0.0587, 0.1043, 0.0952, 0.0889, 0.1612, 0.0278, 0.1198,
        0.0085])
[rfa agg] iter:  1, prev_obj_val: 67.05386352539062, obj_val: 68.31735229492188, abs dis: 1.26348876953125
[rfa agg] iter: 1, weight: tensor([0.1120, 0.2276, 0.0698, 0.1291, 0.0820, 0.1098, 0.1288, 0.0312, 0.1005,
        0.0092])
[rfa agg] iter:  2, prev_obj_val: 68.31735229492188, obj_val: 69.79652404785156, abs dis: 1.4791717529296875
[rfa agg] iter: 2, weight: tensor([0.1043, 0.2263, 0.0749, 0.1413, 0.0782, 0.1201, 0.1185, 0.0325, 0.0945,
        0.0094])
[rfa agg] iter:  3, prev_obj_val: 69.79652404785156, obj_val: 69.78980255126953, abs dis: 0.00672149658203125
[rfa agg] iter: 3, weight: tensor([0.0991, 0.2118, 0.0815, 0.1536, 0.0758, 0.1320, 0.1115, 0.0344, 0.0906,
        0.0098])
[rfa agg] iter:  4, prev_obj_val: 69.78980255126953, obj_val: 69.7896728515625, abs dis: 0.00012969970703125
[rfa agg] iter: 4, weight: tensor([0.0989, 0.2091, 0.0818, 0.1558, 0.0757, 0.1330, 0.1112, 0.0344, 0.0903,
        0.0098])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.0555, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 7.0224, Accuracy: 0/9950 (0.0000%)
saving model
Done in 449.2553975582123 sec.
Server Epoch:77 choose agents : [61, 17, 99, 31, 50, 89, 71, 60, 94, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1646, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1511, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2313, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0599, Accuracy: 325/1574 (20.6480%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0300, Accuracy: 614/1574 (39.0089%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.3724, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   1, Avg loss: 0.0675, Accuracy: 159/773 (20.5692%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 424/773 (54.8512%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.9007, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0960, Accuracy: 3/460 (0.6522%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0409, Accuracy: 177/460 (38.4783%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.4753, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0767, Accuracy: 70/809 (8.6527%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 316/809 (39.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 11.0056, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   1, Avg loss: 0.0744, Accuracy: 208/896 (23.2143%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   2, Avg loss: 0.0371, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6643, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0714, Accuracy: 114/818 (13.9364%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0336, Accuracy: 335/818 (40.9535%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.8683, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0567, Accuracy: 434/2227 (19.4881%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0309, Accuracy: 889/2227 (39.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.0385, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0686, Accuracy: 257/1662 (15.4633%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0377, Accuracy: 510/1662 (30.6859%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6948, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0653, Accuracy: 285/1581 (18.0266%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0359, Accuracy: 532/1581 (33.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.1188, Accuracy: 83/10000 (0.8300%)
time spent on training: 310.2103259563446
[rfa agg] training data poison_ratio: 0.0  data num: [85, 1574, 773, 460, 809, 896, 818, 2227, 1662, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 17, 99, 31, 50, 89, 71, 60, 94, 28], weight: tensor([0.0078, 0.1446, 0.0710, 0.0423, 0.0743, 0.0823, 0.0751, 0.2046, 0.1527,
        0.1452])
[rfa agg] iter:  0, prev_obj_val: 79.82009887695312, obj_val: 78.53059387207031, abs dis: 1.2895050048828125
[rfa agg] iter: 0, weight: tensor([0.0031, 0.1843, 0.0703, 0.0266, 0.0772, 0.0948, 0.0774, 0.1023, 0.1733,
        0.1907])
[rfa agg] iter:  1, prev_obj_val: 78.53059387207031, obj_val: 79.62236022949219, abs dis: 1.091766357421875
[rfa agg] iter: 1, weight: tensor([0.0029, 0.1956, 0.0644, 0.0248, 0.0705, 0.0863, 0.0709, 0.1009, 0.1812,
        0.2025])
[rfa agg] iter:  2, prev_obj_val: 79.62236022949219, obj_val: 80.7710952758789, abs dis: 1.1487350463867188
[rfa agg] iter: 2, weight: tensor([0.0031, 0.1871, 0.0695, 0.0263, 0.0765, 0.0938, 0.0768, 0.1001, 0.1739,
        0.1929])
[rfa agg] iter:  3, prev_obj_val: 80.7710952758789, obj_val: 81.96924591064453, abs dis: 1.198150634765625
[rfa agg] iter: 3, weight: tensor([0.0032, 0.1775, 0.0751, 0.0279, 0.0831, 0.1025, 0.0835, 0.0990, 0.1659,
        0.1823])
[rfa agg] iter:  4, prev_obj_val: 81.96924591064453, obj_val: 80.77075958251953, abs dis: 1.198486328125
[rfa agg] iter: 4, weight: tensor([0.0033, 0.1677, 0.0808, 0.0294, 0.0901, 0.1117, 0.0905, 0.0972, 0.1576,
        0.1717])
[rfa agg] iter:  5, prev_obj_val: 80.77075958251953, obj_val: 81.96867370605469, abs dis: 1.1979141235351562
[rfa agg] iter: 5, weight: tensor([0.0032, 0.1767, 0.0755, 0.0279, 0.0835, 0.1034, 0.0839, 0.0990, 0.1654,
        0.1814])
[rfa agg] iter:  6, prev_obj_val: 81.96867370605469, obj_val: 80.7707748413086, abs dis: 1.1978988647460938
[rfa agg] iter: 6, weight: tensor([0.0033, 0.1676, 0.0808, 0.0294, 0.0901, 0.1117, 0.0905, 0.0972, 0.1576,
        0.1717])
[rfa agg] iter:  7, prev_obj_val: 80.7707748413086, obj_val: 81.96867370605469, abs dis: 1.1978988647460938
[rfa agg] iter: 7, weight: tensor([0.0032, 0.1766, 0.0755, 0.0279, 0.0835, 0.1034, 0.0839, 0.0990, 0.1654,
        0.1814])
[rfa agg] iter:  8, prev_obj_val: 81.96867370605469, obj_val: 80.7707748413086, abs dis: 1.1978988647460938
[rfa agg] iter: 8, weight: tensor([0.0033, 0.1676, 0.0808, 0.0294, 0.0901, 0.1117, 0.0905, 0.0972, 0.1576,
        0.1717])
[rfa agg] iter:  9, prev_obj_val: 80.7707748413086, obj_val: 81.96867370605469, abs dis: 1.1978988647460938
[rfa agg] iter: 9, weight: tensor([0.0032, 0.1766, 0.0755, 0.0279, 0.0835, 0.1034, 0.0839, 0.0990, 0.1654,
        0.1814])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.0573, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 6.6682, Accuracy: 0/9950 (0.0000%)
saving model
Done in 407.06577038764954 sec.
Server Epoch:78 choose agents : [1, 64, 48, 76, 98, 36, 26, 89, 18, 92].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0546, Accuracy: 302/928 (32.5431%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 11.0717, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0698, Accuracy: 140/953 (14.6905%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 319/953 (33.4732%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5664, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0883, Accuracy: 37/631 (5.8637%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0487, Accuracy: 242/631 (38.3518%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5561, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0855, Accuracy: 29/466 (6.2232%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 182/466 (39.0558%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2966, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   1, Avg loss: 0.0915, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   2, Avg loss: 0.0509, Accuracy: 111/373 (29.7587%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0215, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0890, Accuracy: 22/408 (5.3922%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0577, Accuracy: 148/408 (36.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5632, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0619, Accuracy: 287/1446 (19.8479%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0382, Accuracy: 455/1446 (31.4661%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4160, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1, Avg loss: 0.0743, Accuracy: 197/896 (21.9866%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2, Avg loss: 0.0382, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7671, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0802, Accuracy: 72/530 (13.5849%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0435, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2868, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   1, Avg loss: 0.0550, Accuracy: 387/1715 (22.5656%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   2, Avg loss: 0.0325, Accuracy: 647/1715 (37.7259%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9887, Accuracy: 83/10000 (0.8300%)
time spent on training: 273.2473554611206
[rfa agg] training data poison_ratio: 0.0  data num: [928, 953, 631, 466, 373, 408, 1446, 896, 530, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [1, 64, 48, 76, 98, 36, 26, 89, 18, 92], weight: tensor([0.1112, 0.1142, 0.0756, 0.0558, 0.0447, 0.0489, 0.1733, 0.1074, 0.0635,
        0.2055])
[rfa agg] iter:  0, prev_obj_val: 65.43099212646484, obj_val: 67.51753997802734, abs dis: 2.0865478515625
[rfa agg] iter: 0, weight: tensor([0.1679, 0.2335, 0.0797, 0.0420, 0.0258, 0.0321, 0.1015, 0.1805, 0.0542,
        0.0827])
[rfa agg] iter:  1, prev_obj_val: 67.51753997802734, obj_val: 70.42910766601562, abs dis: 2.9115676879882812
[rfa agg] iter: 1, weight: tensor([0.1518, 0.2077, 0.1059, 0.0506, 0.0294, 0.0378, 0.0852, 0.1931, 0.0666,
        0.0718])
[rfa agg] iter:  2, prev_obj_val: 70.42910766601562, obj_val: 73.96818542480469, abs dis: 3.5390777587890625
[rfa agg] iter: 2, weight: tensor([0.1351, 0.1700, 0.1419, 0.0625, 0.0346, 0.0457, 0.0815, 0.1751, 0.0832,
        0.0704])
[rfa agg] iter:  3, prev_obj_val: 73.96818542480469, obj_val: 73.92517852783203, abs dis: 0.04300689697265625
[rfa agg] iter: 3, weight: tensor([0.1161, 0.1373, 0.1868, 0.0763, 0.0400, 0.0544, 0.0757, 0.1448, 0.1019,
        0.0668])
[rfa agg] iter:  4, prev_obj_val: 73.92517852783203, obj_val: 75.9348373413086, abs dis: 2.0096588134765625
[rfa agg] iter: 4, weight: tensor([0.1137, 0.1347, 0.1953, 0.0768, 0.0401, 0.0545, 0.0748, 0.1406, 0.1034,
        0.0660])
[rfa agg] iter:  5, prev_obj_val: 75.9348373413086, obj_val: 73.93121337890625, abs dis: 2.0036239624023438
[rfa agg] iter: 5, weight: tensor([0.1046, 0.1214, 0.2147, 0.0840, 0.0426, 0.0589, 0.0713, 0.1272, 0.1118,
        0.0635])
[rfa agg] iter:  6, prev_obj_val: 73.93121337890625, obj_val: 75.93268585205078, abs dis: 2.0014724731445312
[rfa agg] iter: 6, weight: tensor([0.1122, 0.1333, 0.2005, 0.0770, 0.0401, 0.0546, 0.0743, 0.1382, 0.1041,
        0.0656])
[rfa agg] iter:  7, prev_obj_val: 75.93268585205078, obj_val: 73.93148803710938, abs dis: 2.0011978149414062
[rfa agg] iter: 7, weight: tensor([0.1044, 0.1212, 0.2158, 0.0839, 0.0426, 0.0589, 0.0712, 0.1269, 0.1117,
        0.0634])
[rfa agg] iter:  8, prev_obj_val: 73.93148803710938, obj_val: 75.93263244628906, abs dis: 2.0011444091796875
[rfa agg] iter: 8, weight: tensor([0.1122, 0.1332, 0.2007, 0.0770, 0.0401, 0.0546, 0.0743, 0.1382, 0.1040,
        0.0656])
[rfa agg] iter:  9, prev_obj_val: 75.93263244628906, obj_val: 73.9314956665039, abs dis: 2.0011367797851562
[rfa agg] iter: 9, weight: tensor([0.1044, 0.1212, 0.2158, 0.0839, 0.0426, 0.0589, 0.0712, 0.1269, 0.1117,
        0.0634])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.0776, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 6.4265, Accuracy: 0/9950 (0.0000%)
saving model
Done in 369.7286891937256 sec.
Server Epoch:79 choose agents : [70, 34, 15, 96, 95, 25, 53, 86, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0662, Accuracy: 297/1418 (20.9450%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 551/1418 (38.8575%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6200, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0714, Accuracy: 293/1427 (20.5326%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0373, Accuracy: 515/1427 (36.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2473, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0692, Accuracy: 263/1154 (22.7903%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0336, Accuracy: 377/1154 (32.6690%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.0457, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1, Avg loss: 0.0811, Accuracy: 14/311 (4.5016%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2, Avg loss: 0.0548, Accuracy: 120/311 (38.5852%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0794, Accuracy: 141/599 (23.5392%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 15.4640, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0707, Accuracy: 201/690 (29.1304%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0323, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.1299, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 228/813 (28.0443%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0221, Accuracy: 437/813 (53.7515%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 13.4693, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   1, Avg loss: 0.0723, Accuracy: 232/1003 (23.1306%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   2, Avg loss: 0.0388, Accuracy: 408/1003 (40.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6744, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 87/530 (16.4151%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0456, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.5241, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0658, Accuracy: 180/636 (28.3019%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0326, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.4498, Accuracy: 55/10000 (0.5500%)
time spent on training: 260.975430727005
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 311, 599, 690, 813, 1003, 530, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 34, 15, 96, 95, 25, 53, 86, 18, 52], weight: tensor([0.1652, 0.1663, 0.1345, 0.0362, 0.0698, 0.0804, 0.0947, 0.1169, 0.0618,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 57.51845169067383, obj_val: 57.263511657714844, abs dis: 0.2549400329589844
[rfa agg] iter: 0, weight: tensor([0.0894, 0.0914, 0.1077, 0.0191, 0.0725, 0.1045, 0.1926, 0.1912, 0.0559,
        0.0759])
[rfa agg] iter:  1, prev_obj_val: 57.263511657714844, obj_val: 60.7177734375, abs dis: 3.4542617797851562
[rfa agg] iter: 1, weight: tensor([0.0850, 0.0874, 0.1023, 0.0185, 0.0705, 0.1033, 0.2065, 0.1988, 0.0542,
        0.0736])
[rfa agg] iter:  2, prev_obj_val: 60.7177734375, obj_val: 64.1029052734375, abs dis: 3.3851318359375
[rfa agg] iter: 2, weight: tensor([0.0729, 0.0746, 0.0848, 0.0210, 0.0888, 0.1356, 0.2224, 0.1402, 0.0681,
        0.0915])
[rfa agg] iter:  3, prev_obj_val: 64.1029052734375, obj_val: 64.07307434082031, abs dis: 0.0298309326171875
[rfa agg] iter: 3, weight: tensor([0.0675, 0.0689, 0.0764, 0.0237, 0.1056, 0.1624, 0.1883, 0.1148, 0.0836,
        0.1088])
[rfa agg] iter:  4, prev_obj_val: 64.07307434082031, obj_val: 64.07252502441406, abs dis: 0.00054931640625
[rfa agg] iter: 4, weight: tensor([0.0671, 0.0685, 0.0758, 0.0237, 0.1063, 0.1674, 0.1819, 0.1137, 0.0848,
        0.1107])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.1294, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 7.0681, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.83499026298523 sec.
Server Epoch:80 choose agents : [90, 47, 51, 91, 87, 77, 74, 61, 97, 76].
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 230/677 (33.9734%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 424/677 (62.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 12.4057, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1383, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1245, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.1211, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0675, Accuracy: 185/1049 (17.6358%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0308, Accuracy: 499/1049 (47.5691%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1927, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0646, Accuracy: 247/1030 (23.9806%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0312, Accuracy: 549/1030 (53.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.7587, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   1, Avg loss: 0.0656, Accuracy: 240/1131 (21.2202%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   2, Avg loss: 0.0330, Accuracy: 403/1131 (35.6322%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.4201, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0614, Accuracy: 304/1340 (22.6866%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 569/1340 (42.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.8313, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0478, Accuracy: 455/1552 (29.3170%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 741/1552 (47.7448%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.6901, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1670, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1523, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.1217, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   1, Avg loss: 0.0584, Accuracy: 252/1213 (20.7749%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   2, Avg loss: 0.0302, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.0158, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0812, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 179/466 (38.4120%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.9005, Accuracy: 52/10000 (0.5200%)
time spent on training: 249.50158214569092
[rfa agg] training data poison_ratio: 0.0  data num: [677, 134, 1049, 1030, 1131, 1340, 1552, 85, 1213, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 47, 51, 91, 87, 77, 74, 61, 97, 76], weight: tensor([0.0780, 0.0154, 0.1209, 0.1187, 0.1303, 0.1544, 0.1789, 0.0098, 0.1398,
        0.0537])
[rfa agg] iter:  0, prev_obj_val: 53.56558609008789, obj_val: 55.19905090332031, abs dis: 1.6334648132324219
[rfa agg] iter: 0, weight: tensor([0.0713, 0.0055, 0.1462, 0.1544, 0.1885, 0.1324, 0.0948, 0.0032, 0.1712,
        0.0326])
[rfa agg] iter:  1, prev_obj_val: 55.19905090332031, obj_val: 53.348548889160156, abs dis: 1.8505020141601562
[rfa agg] iter: 1, weight: tensor([0.0790, 0.0058, 0.1483, 0.1594, 0.1864, 0.1263, 0.0917, 0.0033, 0.1644,
        0.0354])
[rfa agg] iter:  2, prev_obj_val: 53.348548889160156, obj_val: 55.1986198425293, abs dis: 1.8500709533691406
[rfa agg] iter: 2, weight: tensor([0.0697, 0.0053, 0.1467, 0.1594, 0.1938, 0.1284, 0.0914, 0.0031, 0.1704,
        0.0319])
[rfa agg] iter:  3, prev_obj_val: 55.1986198425293, obj_val: 53.348506927490234, abs dis: 1.8501129150390625
[rfa agg] iter: 3, weight: tensor([0.0789, 0.0058, 0.1481, 0.1601, 0.1868, 0.1260, 0.0915, 0.0033, 0.1641,
        0.0353])
[rfa agg] iter:  4, prev_obj_val: 53.348506927490234, obj_val: 55.1986198425293, abs dis: 1.8501129150390625
[rfa agg] iter: 4, weight: tensor([0.0696, 0.0053, 0.1467, 0.1595, 0.1938, 0.1283, 0.0913, 0.0031, 0.1704,
        0.0319])
[rfa agg] iter:  5, prev_obj_val: 55.1986198425293, obj_val: 53.3485107421875, abs dis: 1.8501091003417969
[rfa agg] iter: 5, weight: tensor([0.0789, 0.0058, 0.1481, 0.1601, 0.1868, 0.1260, 0.0915, 0.0033, 0.1641,
        0.0353])
[rfa agg] iter:  6, prev_obj_val: 53.3485107421875, obj_val: 55.19861602783203, abs dis: 1.8501052856445312
[rfa agg] iter: 6, weight: tensor([0.0696, 0.0053, 0.1467, 0.1595, 0.1938, 0.1283, 0.0913, 0.0031, 0.1704,
        0.0319])
[rfa agg] iter:  7, prev_obj_val: 55.19861602783203, obj_val: 53.3485107421875, abs dis: 1.8501052856445312
[rfa agg] iter: 7, weight: tensor([0.0789, 0.0058, 0.1481, 0.1601, 0.1868, 0.1260, 0.0915, 0.0033, 0.1641,
        0.0353])
[rfa agg] iter:  8, prev_obj_val: 53.3485107421875, obj_val: 55.19861602783203, abs dis: 1.8501052856445312
[rfa agg] iter: 8, weight: tensor([0.0696, 0.0053, 0.1467, 0.1595, 0.1938, 0.1283, 0.0913, 0.0031, 0.1704,
        0.0319])
[rfa agg] iter:  9, prev_obj_val: 55.19861602783203, obj_val: 53.3485107421875, abs dis: 1.8501052856445312
[rfa agg] iter: 9, weight: tensor([0.0789, 0.0058, 0.1481, 0.1601, 0.1868, 0.1260, 0.0915, 0.0033, 0.1641,
        0.0353])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.1729, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 7.2022, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.00042510032654 sec.
Server Epoch:81 choose agents : [60, 92, 18, 24, 50, 96, 61, 90, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0564, Accuracy: 480/2227 (21.5537%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0313, Accuracy: 873/2227 (39.2007%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2639, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0537, Accuracy: 396/1715 (23.0904%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0327, Accuracy: 644/1715 (37.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6014, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0742, Accuracy: 102/530 (19.2453%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0408, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.7354, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.1067, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0603, Accuracy: 78/312 (25.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3976, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0759, Accuracy: 79/809 (9.7651%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0315, Accuracy: 323/809 (39.9258%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 11.0834, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 16/311 (5.1447%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0522, Accuracy: 118/311 (37.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3583, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1661, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1530, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.1585, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0553, Accuracy: 242/677 (35.7459%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.3101, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0671, Accuracy: 237/1130 (20.9735%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0324, Accuracy: 428/1130 (37.8761%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.3769, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0716, Accuracy: 251/1154 (21.7504%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0323, Accuracy: 400/1154 (34.6620%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.8313, Accuracy: 65/10000 (0.6500%)
time spent on training: 271.9076609611511
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1715, 530, 312, 809, 311, 85, 677, 1130, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 92, 18, 24, 50, 96, 61, 90, 54, 15], weight: tensor([0.2488, 0.1916, 0.0592, 0.0349, 0.0904, 0.0347, 0.0095, 0.0756, 0.1263,
        0.1289])
[rfa agg] iter:  0, prev_obj_val: 90.0110855102539, obj_val: 91.54776763916016, abs dis: 1.53668212890625
[rfa agg] iter: 0, weight: tensor([0.1235, 0.1776, 0.0430, 0.0184, 0.1025, 0.0183, 0.0040, 0.0672, 0.2452,
        0.2004])
[rfa agg] iter:  1, prev_obj_val: 91.54776763916016, obj_val: 92.43720245361328, abs dis: 0.889434814453125
[rfa agg] iter: 1, weight: tensor([0.0991, 0.1335, 0.0470, 0.0191, 0.1259, 0.0189, 0.0040, 0.0766, 0.2803,
        0.1957])
[rfa agg] iter:  2, prev_obj_val: 92.43720245361328, obj_val: 93.54484558105469, abs dis: 1.1076431274414062
[rfa agg] iter: 2, weight: tensor([0.0950, 0.1251, 0.0490, 0.0196, 0.1362, 0.0194, 0.0040, 0.0811, 0.2839,
        0.1867])
[rfa agg] iter:  3, prev_obj_val: 93.54484558105469, obj_val: 96.16893005371094, abs dis: 2.62408447265625
[rfa agg] iter: 3, weight: tensor([0.0932, 0.1207, 0.0521, 0.0204, 0.1507, 0.0203, 0.0042, 0.0877, 0.2722,
        0.1785])
[rfa agg] iter:  4, prev_obj_val: 96.16893005371094, obj_val: 93.56039428710938, abs dis: 2.6085357666015625
[rfa agg] iter: 4, weight: tensor([0.0899, 0.1130, 0.0594, 0.0224, 0.1872, 0.0222, 0.0045, 0.1036, 0.2352,
        0.1627])
[rfa agg] iter:  5, prev_obj_val: 93.56039428710938, obj_val: 94.78489685058594, abs dis: 1.2245025634765625
[rfa agg] iter: 5, weight: tensor([0.0940, 0.1215, 0.0529, 0.0207, 0.1562, 0.0205, 0.0042, 0.0895, 0.2640,
        0.1766])
[rfa agg] iter:  6, prev_obj_val: 94.78489685058594, obj_val: 92.4522705078125, abs dis: 2.3326263427734375
[rfa agg] iter: 6, weight: tensor([0.0918, 0.1171, 0.0559, 0.0215, 0.1697, 0.0213, 0.0043, 0.0958, 0.2521,
        0.1705])
[rfa agg] iter:  7, prev_obj_val: 92.4522705078125, obj_val: 94.7977294921875, abs dis: 2.345458984375
[rfa agg] iter: 7, weight: tensor([0.0955, 0.1255, 0.0495, 0.0197, 0.1396, 0.0196, 0.0041, 0.0824, 0.2805,
        0.1837])
[rfa agg] iter:  8, prev_obj_val: 94.7977294921875, obj_val: 92.4501953125, abs dis: 2.3475341796875
[rfa agg] iter: 8, weight: tensor([0.0917, 0.1170, 0.0556, 0.0214, 0.1676, 0.0212, 0.0043, 0.0952, 0.2547,
        0.1711])
[rfa agg] iter:  9, prev_obj_val: 92.4501953125, obj_val: 94.79801940917969, abs dis: 2.3478240966796875
[rfa agg] iter: 9, weight: tensor([0.0954, 0.1254, 0.0495, 0.0197, 0.1394, 0.0195, 0.0041, 0.0823, 0.2811,
        0.1837])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.2077, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 7.0529, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.0931324958801 sec.
Server Epoch:82 choose agents : [59, 83, 37, 80, 61, 21, 47, 81, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0571, Accuracy: 287/1089 (26.3545%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0309, Accuracy: 493/1089 (45.2709%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.4627, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   1, Avg loss: 0.0628, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   2, Avg loss: 0.0372, Accuracy: 670/1953 (34.3062%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1091, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0616, Accuracy: 283/1129 (25.0664%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0270, Accuracy: 658/1129 (58.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5737, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0771, Accuracy: 77/682 (11.2903%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.7899, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1685, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1535, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.1586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0599, Accuracy: 341/1949 (17.4962%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0363, Accuracy: 552/1949 (28.3222%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5306, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1379, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1213, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4816, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0732, Accuracy: 157/774 (20.2842%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0401, Accuracy: 360/774 (46.5116%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.9939, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0671, Accuracy: 251/1645 (15.2584%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 540/1645 (32.8267%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.3319, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0938, Accuracy: 6/460 (1.3043%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0422, Accuracy: 174/460 (37.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.2837, Accuracy: 57/10000 (0.5700%)
time spent on training: 295.9051344394684
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1953, 1129, 682, 85, 1949, 134, 774, 1645, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 83, 37, 80, 61, 21, 47, 81, 13, 31], weight: tensor([0.1100, 0.1973, 0.1140, 0.0689, 0.0086, 0.1969, 0.0135, 0.0782, 0.1662,
        0.0465])
[rfa agg] iter:  0, prev_obj_val: 81.64057159423828, obj_val: 81.4795913696289, abs dis: 0.160980224609375
[rfa agg] iter: 0, weight: tensor([0.1191, 0.1519, 0.1953, 0.0544, 0.0034, 0.1529, 0.0058, 0.0742, 0.2143,
        0.0285])
[rfa agg] iter:  1, prev_obj_val: 81.4795913696289, obj_val: 81.47836303710938, abs dis: 0.00122833251953125
[rfa agg] iter: 1, weight: tensor([0.1179, 0.1484, 0.2038, 0.0535, 0.0034, 0.1494, 0.0057, 0.0731, 0.2169,
        0.0280])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.2091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 7.2305, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.59762263298035 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 75, 94, 79].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0627, Accuracy: 264/946 (27.9070%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 380/946 (40.1691%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.2795, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0699, Accuracy: 272/1475 (18.4407%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0359, Accuracy: 522/1475 (35.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8011, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0866, Accuracy: 27/515 (5.2427%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1606, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0883, Accuracy: 72/605 (11.9008%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0480, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6278, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0904, Accuracy: 21/408 (5.1471%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0549, Accuracy: 141/408 (34.5588%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1902, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0745, Accuracy: 207/1154 (17.9376%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0291, Accuracy: 416/1154 (36.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.9353, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0694, Accuracy: 191/669 (28.5501%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0419, Accuracy: 366/669 (54.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4986, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   1, Avg loss: 0.0684, Accuracy: 151/776 (19.4588%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 392/776 (50.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.4883, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0689, Accuracy: 286/1662 (17.2082%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 517/1662 (31.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.0647, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   1, Avg loss: 0.1196, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   2, Avg loss: 0.0941, Accuracy: 18/197 (9.1371%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.2432, Accuracy: 51/10000 (0.5100%)
time spent on training: 293.08424377441406
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 776, 1662, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 65, 33, 2, 36, 57, 45, 75, 94, 79], weight: tensor([0.1125, 0.1754, 0.0613, 0.0720, 0.0485, 0.1373, 0.0796, 0.0923, 0.1977,
        0.0234])
[rfa agg] iter:  0, prev_obj_val: 67.98202514648438, obj_val: 72.04537200927734, abs dis: 4.063346862792969
[rfa agg] iter: 0, weight: tensor([0.2257, 0.1130, 0.0512, 0.0728, 0.0339, 0.1396, 0.0900, 0.1493, 0.1128,
        0.0118])
[rfa agg] iter:  1, prev_obj_val: 72.04537200927734, obj_val: 75.10335540771484, abs dis: 3.0579833984375
[rfa agg] iter: 1, weight: tensor([0.1964, 0.0833, 0.0640, 0.1000, 0.0417, 0.1006, 0.1230, 0.1938, 0.0842,
        0.0130])
[rfa agg] iter:  2, prev_obj_val: 75.10335540771484, obj_val: 73.38294982910156, abs dis: 1.7204055786132812
[rfa agg] iter: 2, weight: tensor([0.1606, 0.0760, 0.0732, 0.1222, 0.0480, 0.0887, 0.1464, 0.1933, 0.0773,
        0.0141])
[rfa agg] iter:  3, prev_obj_val: 73.38294982910156, obj_val: 71.90450286865234, abs dis: 1.4784469604492188
[rfa agg] iter: 3, weight: tensor([0.1711, 0.0775, 0.0681, 0.1125, 0.0443, 0.0909, 0.1402, 0.2031, 0.0789,
        0.0134])
[rfa agg] iter:  4, prev_obj_val: 71.90450286865234, obj_val: 73.38372039794922, abs dis: 1.479217529296875
[rfa agg] iter: 4, weight: tensor([0.1879, 0.0802, 0.0633, 0.1013, 0.0411, 0.0951, 0.1283, 0.2086, 0.0814,
        0.0128])
[rfa agg] iter:  5, prev_obj_val: 73.38372039794922, obj_val: 71.90274047851562, abs dis: 1.4809799194335938
[rfa agg] iter: 5, weight: tensor([0.1736, 0.0777, 0.0677, 0.1105, 0.0441, 0.0914, 0.1371, 0.2056, 0.0790,
        0.0134])
[rfa agg] iter:  6, prev_obj_val: 71.90274047851562, obj_val: 73.38386535644531, abs dis: 1.4811248779296875
[rfa agg] iter: 6, weight: tensor([0.1881, 0.0802, 0.0632, 0.1011, 0.0411, 0.0951, 0.1279, 0.2090, 0.0814,
        0.0128])
[rfa agg] iter:  7, prev_obj_val: 73.38386535644531, obj_val: 71.90271759033203, abs dis: 1.4811477661132812
[rfa agg] iter: 7, weight: tensor([0.1736, 0.0777, 0.0677, 0.1105, 0.0441, 0.0914, 0.1370, 0.2056, 0.0790,
        0.0134])
[rfa agg] iter:  8, prev_obj_val: 71.90271759033203, obj_val: 73.38386535644531, abs dis: 1.4811477661132812
[rfa agg] iter: 8, weight: tensor([0.1881, 0.0802, 0.0632, 0.1011, 0.0411, 0.0951, 0.1279, 0.2091, 0.0814,
        0.0128])
[rfa agg] iter:  9, prev_obj_val: 73.38386535644531, obj_val: 71.90271759033203, abs dis: 1.4811477661132812
[rfa agg] iter: 9, weight: tensor([0.1736, 0.0777, 0.0677, 0.1105, 0.0441, 0.0914, 0.1370, 0.2057, 0.0790,
        0.0134])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.2351, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 7.2871, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.7002308368683 sec.
Server Epoch:84 choose agents : [98, 26, 54, 61, 56, 29, 38, 45, 2, 15].
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1, Avg loss: 0.0891, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2, Avg loss: 0.0508, Accuracy: 104/373 (27.8820%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0610, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0634, Accuracy: 302/1446 (20.8852%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0382, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.6420, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0621, Accuracy: 243/1130 (21.5044%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0316, Accuracy: 434/1130 (38.4071%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.1296, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1591, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1515, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0905, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0731, Accuracy: 11/186 (5.9140%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0586, Accuracy: 412/1440 (28.6111%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0299, Accuracy: 632/1440 (43.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.8644, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0666, Accuracy: 182/1131 (16.0920%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0339, Accuracy: 451/1131 (39.8762%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.6395, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0701, Accuracy: 183/669 (27.3543%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0422, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5229, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0885, Accuracy: 61/605 (10.0826%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0496, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.4190, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0662, Accuracy: 267/1154 (23.1369%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0347, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.8794, Accuracy: 54/10000 (0.5400%)
time spent on training: 288.447217464447
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 26, 54, 61, 56, 29, 38, 45, 2, 15], weight: tensor([0.0454, 0.1759, 0.1375, 0.0103, 0.0226, 0.1752, 0.1376, 0.0814, 0.0736,
        0.1404])
[rfa agg] iter:  0, prev_obj_val: 60.51065444946289, obj_val: 58.858699798583984, abs dis: 1.6519546508789062
[rfa agg] iter: 0, weight: tensor([0.0275, 0.1309, 0.1985, 0.0041, 0.0101, 0.1318, 0.1840, 0.0902, 0.0726,
        0.1503])
[rfa agg] iter:  1, prev_obj_val: 58.858699798583984, obj_val: 60.39324188232422, abs dis: 1.5345420837402344
[rfa agg] iter: 1, weight: tensor([0.0249, 0.1304, 0.2122, 0.0038, 0.0093, 0.1318, 0.1910, 0.0798, 0.0643,
        0.1524])
[rfa agg] iter:  2, prev_obj_val: 60.39324188232422, obj_val: 62.091697692871094, abs dis: 1.698455810546875
[rfa agg] iter: 2, weight: tensor([0.0269, 0.1279, 0.2060, 0.0040, 0.0099, 0.1290, 0.1868, 0.0883, 0.0711,
        0.1501])
[rfa agg] iter:  3, prev_obj_val: 62.091697692871094, obj_val: 60.393917083740234, abs dis: 1.6977806091308594
[rfa agg] iter: 3, weight: tensor([0.0293, 0.1256, 0.1971, 0.0043, 0.0106, 0.1266, 0.1814, 0.0989, 0.0793,
        0.1469])
[rfa agg] iter:  4, prev_obj_val: 60.393917083740234, obj_val: 62.09114456176758, abs dis: 1.6972274780273438
[rfa agg] iter: 4, weight: tensor([0.0271, 0.1279, 0.2049, 0.0041, 0.0099, 0.1291, 0.1866, 0.0893, 0.0716,
        0.1495])
[rfa agg] iter:  5, prev_obj_val: 62.09114456176758, obj_val: 60.39395523071289, abs dis: 1.6971893310546875
[rfa agg] iter: 5, weight: tensor([0.0293, 0.1256, 0.1970, 0.0043, 0.0106, 0.1266, 0.1814, 0.0990, 0.0793,
        0.1468])
[rfa agg] iter:  6, prev_obj_val: 60.39395523071289, obj_val: 62.09113311767578, abs dis: 1.6971778869628906
[rfa agg] iter: 6, weight: tensor([0.0271, 0.1279, 0.2049, 0.0041, 0.0099, 0.1291, 0.1866, 0.0893, 0.0716,
        0.1495])
[rfa agg] iter:  7, prev_obj_val: 62.09113311767578, obj_val: 60.39395523071289, abs dis: 1.6971778869628906
[rfa agg] iter: 7, weight: tensor([0.0293, 0.1256, 0.1970, 0.0043, 0.0106, 0.1266, 0.1814, 0.0990, 0.0793,
        0.1468])
[rfa agg] iter:  8, prev_obj_val: 60.39395523071289, obj_val: 62.09113311767578, abs dis: 1.6971778869628906
[rfa agg] iter: 8, weight: tensor([0.0271, 0.1279, 0.2049, 0.0041, 0.0099, 0.1291, 0.1866, 0.0893, 0.0716,
        0.1495])
[rfa agg] iter:  9, prev_obj_val: 62.09113311767578, obj_val: 60.39395523071289, abs dis: 1.6971778869628906
[rfa agg] iter: 9, weight: tensor([0.0293, 0.1256, 0.1970, 0.0043, 0.0106, 0.1266, 0.1814, 0.0990, 0.0793,
        0.1468])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2742, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 8.0253, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.9352240562439 sec.
Server Epoch:85 choose agents : [83, 3, 85, 18, 96, 8, 88, 79, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   1, Avg loss: 0.0629, Accuracy: 358/1953 (18.3308%)
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   2, Avg loss: 0.0369, Accuracy: 726/1953 (37.1736%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0845, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0773, Accuracy: 73/781 (9.3470%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0384, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.8562, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   1, Avg loss: 0.0698, Accuracy: 339/1988 (17.0523%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   2, Avg loss: 0.0387, Accuracy: 589/1988 (29.6278%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.2048, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0738, Accuracy: 92/530 (17.3585%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0429, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.9087, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   1, Avg loss: 0.0835, Accuracy: 14/311 (4.5016%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   2, Avg loss: 0.0575, Accuracy: 99/311 (31.8328%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3391, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0666, Accuracy: 210/1513 (13.8797%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0398, Accuracy: 457/1513 (30.2049%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3988, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1, Avg loss: 0.0977, Accuracy: 22/603 (3.6484%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2, Avg loss: 0.0508, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.3905, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1, Avg loss: 0.1155, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2, Avg loss: 0.0943, Accuracy: 8/197 (4.0609%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.0834, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0788, Accuracy: 194/715 (27.1329%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0476, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2374, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0658, Accuracy: 238/803 (29.6389%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0383, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.9696, Accuracy: 70/10000 (0.7000%)
time spent on training: 332.5269503593445
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 781, 1988, 530, 311, 1513, 603, 197, 715, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 3, 85, 18, 96, 8, 88, 79, 23, 58], weight: tensor([0.2079, 0.0831, 0.2116, 0.0564, 0.0331, 0.1611, 0.0642, 0.0210, 0.0761,
        0.0855])
[rfa agg] iter:  0, prev_obj_val: 90.71420288085938, obj_val: 92.69287109375, abs dis: 1.978668212890625
[rfa agg] iter: 0, weight: tensor([0.1560, 0.1048, 0.1464, 0.0466, 0.0198, 0.2644, 0.0588, 0.0116, 0.0826,
        0.1090])
[rfa agg] iter:  1, prev_obj_val: 92.69287109375, obj_val: 93.41807556152344, abs dis: 0.7252044677734375
[rfa agg] iter: 1, weight: tensor([0.1375, 0.1283, 0.1297, 0.0529, 0.0216, 0.2187, 0.0679, 0.0126, 0.0971,
        0.1337])
[rfa agg] iter:  2, prev_obj_val: 93.41807556152344, obj_val: 95.06160736083984, abs dis: 1.6435317993164062
[rfa agg] iter: 2, weight: tensor([0.1304, 0.1383, 0.1234, 0.0551, 0.0221, 0.1992, 0.0711, 0.0128, 0.1029,
        0.1447])
[rfa agg] iter:  3, prev_obj_val: 95.06160736083984, obj_val: 94.20892333984375, abs dis: 0.8526840209960938
[rfa agg] iter: 3, weight: tensor([0.1162, 0.1569, 0.1105, 0.0585, 0.0227, 0.1675, 0.0768, 0.0131, 0.1125,
        0.1654])
[rfa agg] iter:  4, prev_obj_val: 94.20892333984375, obj_val: 95.04420471191406, abs dis: 0.8352813720703125
[rfa agg] iter: 4, weight: tensor([0.1226, 0.1490, 0.1164, 0.0569, 0.0224, 0.1805, 0.0741, 0.0129, 0.1084,
        0.1568])
[rfa agg] iter:  5, prev_obj_val: 95.04420471191406, obj_val: 95.03948211669922, abs dis: 0.00472259521484375
[rfa agg] iter: 5, weight: tensor([0.1157, 0.1577, 0.1101, 0.0585, 0.0226, 0.1664, 0.0768, 0.0130, 0.1127,
        0.1665])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2513, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 8.0962, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.264714717865 sec.
Server Epoch:86 choose agents : [57, 99, 60, 19, 35, 84, 81, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0736, Accuracy: 193/1154 (16.7244%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0294, Accuracy: 428/1154 (37.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.4961, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0685, Accuracy: 145/773 (18.7581%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 417/773 (53.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.9596, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0581, Accuracy: 464/2227 (20.8352%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0307, Accuracy: 927/2227 (41.6255%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.4897, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0540, Accuracy: 322/1036 (31.0811%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 634/1036 (61.1969%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.2056, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.1138, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0769, Accuracy: 46/271 (16.9742%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.4495, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0681, Accuracy: 268/1190 (22.5210%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 414/1190 (34.7899%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.9825, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0767, Accuracy: 172/774 (22.2222%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0403, Accuracy: 346/774 (44.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0309, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0693, Accuracy: 259/1750 (14.8000%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0390, Accuracy: 577/1750 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.0836, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0795, Accuracy: 154/719 (21.4186%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.0707, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0572, Accuracy: 280/1089 (25.7117%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0318, Accuracy: 487/1089 (44.7199%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1863, Accuracy: 83/10000 (0.8300%)
time spent on training: 377.4717960357666
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 773, 2227, 1036, 271, 1190, 774, 1750, 719, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [57, 99, 60, 19, 35, 84, 81, 44, 41, 59], weight: tensor([0.1051, 0.0704, 0.2028, 0.0943, 0.0247, 0.1083, 0.0705, 0.1593, 0.0655,
        0.0992])
[rfa agg] iter:  0, prev_obj_val: 79.8590316772461, obj_val: 82.492919921875, abs dis: 2.6338882446289062
[rfa agg] iter: 0, weight: tensor([0.1333, 0.0724, 0.0882, 0.1630, 0.0119, 0.1794, 0.0713, 0.1168, 0.0594,
        0.1043])
[rfa agg] iter:  1, prev_obj_val: 82.492919921875, obj_val: 82.46646118164062, abs dis: 0.026458740234375
[rfa agg] iter: 1, weight: tensor([0.1245, 0.0889, 0.0736, 0.1870, 0.0128, 0.1675, 0.0855, 0.0916, 0.0707,
        0.0979])
[rfa agg] iter:  2, prev_obj_val: 82.46646118164062, obj_val: 82.466064453125, abs dis: 0.000396728515625
[rfa agg] iter: 2, weight: tensor([0.1230, 0.0892, 0.0731, 0.1916, 0.0128, 0.1661, 0.0859, 0.0909, 0.0708,
        0.0966])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.2805, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 7.8275, Accuracy: 0/9950 (0.0000%)
saving model
Done in 471.26064014434814 sec.
Server Epoch:87 choose agents : [85, 29, 54, 69, 86, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0688, Accuracy: 324/1988 (16.2978%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0379, Accuracy: 593/1988 (29.8290%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.7246, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0581, Accuracy: 399/1440 (27.7083%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0302, Accuracy: 611/1440 (42.4306%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.5049, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0617, Accuracy: 253/1130 (22.3894%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0315, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.8325, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0633, Accuracy: 197/590 (33.3898%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0356, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.8191, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0780, Accuracy: 208/1003 (20.7378%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0404, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3241, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 179/669 (26.7564%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0415, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8537, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0628, Accuracy: 245/1446 (16.9433%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0381, Accuracy: 469/1446 (32.4343%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.2418, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1491, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1334, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.3030, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0819, Accuracy: 36/515 (6.9903%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0564, Accuracy: 136/515 (26.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1125, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0710, Accuracy: 195/1154 (16.8977%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.7368, Accuracy: 70/10000 (0.7000%)
time spent on training: 360.81076169013977
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1440, 1130, 590, 1003, 669, 1446, 134, 515, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 29, 54, 69, 86, 45, 26, 47, 33, 57], weight: tensor([0.1974, 0.1430, 0.1122, 0.0586, 0.0996, 0.0664, 0.1436, 0.0133, 0.0511,
        0.1146])
[rfa agg] iter:  0, prev_obj_val: 69.10392761230469, obj_val: 70.59132385253906, abs dis: 1.487396240234375
[rfa agg] iter: 0, weight: tensor([0.0858, 0.1509, 0.1943, 0.0400, 0.1589, 0.0491, 0.1531, 0.0049, 0.0305,
        0.1326])
[rfa agg] iter:  1, prev_obj_val: 70.59132385253906, obj_val: 73.25936126708984, abs dis: 2.6680374145507812
[rfa agg] iter: 1, weight: tensor([0.0771, 0.1296, 0.2063, 0.0433, 0.1946, 0.0531, 0.1316, 0.0050, 0.0323,
        0.1272])
[rfa agg] iter:  2, prev_obj_val: 73.25936126708984, obj_val: 73.2391586303711, abs dis: 0.02020263671875
[rfa agg] iter: 2, weight: tensor([0.0729, 0.1146, 0.1945, 0.0491, 0.2320, 0.0603, 0.1163, 0.0053, 0.0358,
        0.1192])
[rfa agg] iter:  3, prev_obj_val: 73.2391586303711, obj_val: 74.89967346191406, abs dis: 1.6605148315429688
[rfa agg] iter: 3, weight: tensor([0.0721, 0.1129, 0.1922, 0.0487, 0.2416, 0.0598, 0.1147, 0.0053, 0.0354,
        0.1173])
[rfa agg] iter:  4, prev_obj_val: 74.89967346191406, obj_val: 73.24000549316406, abs dis: 1.65966796875
[rfa agg] iter: 4, weight: tensor([0.0711, 0.1082, 0.1822, 0.0528, 0.2536, 0.0646, 0.1098, 0.0055, 0.0378,
        0.1144])
[rfa agg] iter:  5, prev_obj_val: 73.24000549316406, obj_val: 74.89856719970703, abs dis: 1.6585617065429688
[rfa agg] iter: 5, weight: tensor([0.0717, 0.1120, 0.1898, 0.0485, 0.2475, 0.0595, 0.1139, 0.0053, 0.0353,
        0.1164])
[rfa agg] iter:  6, prev_obj_val: 74.89856719970703, obj_val: 73.24020385742188, abs dis: 1.6583633422851562
[rfa agg] iter: 6, weight: tensor([0.0710, 0.1080, 0.1817, 0.0527, 0.2552, 0.0645, 0.1096, 0.0055, 0.0378,
        0.1141])
[rfa agg] iter:  7, prev_obj_val: 73.24020385742188, obj_val: 74.89850616455078, abs dis: 1.6583023071289062
[rfa agg] iter: 7, weight: tensor([0.0717, 0.1120, 0.1897, 0.0485, 0.2479, 0.0595, 0.1139, 0.0053, 0.0352,
        0.1163])
[rfa agg] iter:  8, prev_obj_val: 74.89850616455078, obj_val: 73.2402114868164, abs dis: 1.658294677734375
[rfa agg] iter: 8, weight: tensor([0.0710, 0.1080, 0.1816, 0.0527, 0.2553, 0.0644, 0.1096, 0.0055, 0.0378,
        0.1141])
[rfa agg] iter:  9, prev_obj_val: 73.2402114868164, obj_val: 74.89849853515625, abs dis: 1.6582870483398438
[rfa agg] iter: 9, weight: tensor([0.0717, 0.1120, 0.1897, 0.0485, 0.2479, 0.0595, 0.1138, 0.0053, 0.0352,
        0.1163])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.2432, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 8.3398, Accuracy: 0/9950 (0.0000%)
saving model
Done in 457.6242961883545 sec.
Server Epoch:88 choose agents : [62, 82, 84, 18, 63, 67, 29, 37, 86, 79].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0732, Accuracy: 91/568 (16.0211%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0428, Accuracy: 269/568 (47.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3393, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   1, Avg loss: 0.0931, Accuracy: 11/500 (2.2000%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   2, Avg loss: 0.0554, Accuracy: 164/500 (32.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7724, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   1, Avg loss: 0.0691, Accuracy: 264/1190 (22.1849%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   2, Avg loss: 0.0338, Accuracy: 439/1190 (36.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.0150, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0808, Accuracy: 65/530 (12.2642%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0431, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.3550, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0675, Accuracy: 211/888 (23.7613%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0300, Accuracy: 406/888 (45.7207%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.2340, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0898, Accuracy: 19/426 (4.4601%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0486, Accuracy: 158/426 (37.0892%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7076, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0573, Accuracy: 378/1440 (26.2500%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0293, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2654, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0604, Accuracy: 290/1129 (25.6864%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0264, Accuracy: 647/1129 (57.3074%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.8991, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0759, Accuracy: 197/1003 (19.6411%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0399, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6299, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   1, Avg loss: 0.1184, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   2, Avg loss: 0.0920, Accuracy: 13/197 (6.5990%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.1620, Accuracy: 53/10000 (0.5300%)
time spent on training: 304.80418586730957
[rfa agg] training data poison_ratio: 0.0  data num: [568, 500, 1190, 530, 888, 426, 1440, 1129, 1003, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 82, 84, 18, 63, 67, 29, 37, 86, 79], weight: tensor([0.0722, 0.0635, 0.1512, 0.0673, 0.1128, 0.0541, 0.1830, 0.1434, 0.1274,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 55.53119659423828, obj_val: 56.39552307128906, abs dis: 0.8643264770507812
[rfa agg] iter: 0, weight: tensor([0.0695, 0.0522, 0.1336, 0.0628, 0.2001, 0.0381, 0.1014, 0.1412, 0.1890,
        0.0120])
[rfa agg] iter:  1, prev_obj_val: 56.39552307128906, obj_val: 59.09993362426758, abs dis: 2.7044105529785156
[rfa agg] iter: 1, weight: tensor([0.0750, 0.0558, 0.1243, 0.0670, 0.2176, 0.0402, 0.0952, 0.1319, 0.1807,
        0.0124])
[rfa agg] iter:  2, prev_obj_val: 59.09993362426758, obj_val: 59.07953643798828, abs dis: 0.020397186279296875
[rfa agg] iter: 2, weight: tensor([0.0943, 0.0685, 0.1146, 0.0826, 0.2072, 0.0481, 0.0913, 0.1210, 0.1583,
        0.0141])
[rfa agg] iter:  3, prev_obj_val: 59.07953643798828, obj_val: 59.079471588134766, abs dis: 6.4849853515625e-05
[rfa agg] iter: 3, weight: tensor([0.0956, 0.0691, 0.1142, 0.0837, 0.2063, 0.0484, 0.0912, 0.1204, 0.1569,
        0.0142])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2782, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 8.8202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.5586082935333 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 95, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 289/946 (30.5497%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0371, Accuracy: 366/946 (38.6892%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3039, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0827, Accuracy: 63/631 (9.9842%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0486, Accuracy: 227/631 (35.9746%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6210, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0616, Accuracy: 339/1587 (21.3611%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0364, Accuracy: 548/1587 (34.5306%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.8315, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0568, Accuracy: 368/1628 (22.6044%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0262, Accuracy: 784/1628 (48.1572%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.3592, Accuracy: 136/10000 (1.3600%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0667, Accuracy: 193/669 (28.8490%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 366/669 (54.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8705, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0904, Accuracy: 19/426 (4.4601%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0491, Accuracy: 161/426 (37.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7482, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1, Avg loss: 0.0818, Accuracy: 136/599 (22.7045%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2, Avg loss: 0.0309, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 17.5396, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0722, Accuracy: 215/715 (30.0699%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0435, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6965, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0608, Accuracy: 232/1013 (22.9023%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0278, Accuracy: 471/1013 (46.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.2165, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0721, Accuracy: 188/708 (26.5537%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0388, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1642, Accuracy: 60/10000 (0.6000%)
time spent on training: 314.4523501396179
[rfa agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 599, 715, 1013, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 48, 27, 5, 45, 67, 95, 23, 39, 16], weight: tensor([0.1060, 0.0707, 0.1779, 0.1825, 0.0750, 0.0477, 0.0671, 0.0801, 0.1135,
        0.0794])
[rfa agg] iter:  0, prev_obj_val: 64.42408752441406, obj_val: 65.84541320800781, abs dis: 1.42132568359375
[rfa agg] iter: 0, weight: tensor([0.1752, 0.0809, 0.0866, 0.0810, 0.0942, 0.0340, 0.0746, 0.1024, 0.1672,
        0.1038])
[rfa agg] iter:  1, prev_obj_val: 65.84541320800781, obj_val: 72.4195327758789, abs dis: 6.574119567871094
[rfa agg] iter: 1, weight: tensor([0.1601, 0.0931, 0.0757, 0.0712, 0.1105, 0.0372, 0.0840, 0.1111, 0.1433,
        0.1139])
[rfa agg] iter:  2, prev_obj_val: 72.4195327758789, obj_val: 72.3438720703125, abs dis: 0.07566070556640625
[rfa agg] iter: 2, weight: tensor([0.1132, 0.1312, 0.0653, 0.0621, 0.1356, 0.0492, 0.1130, 0.1124, 0.1029,
        0.1151])
[rfa agg] iter:  3, prev_obj_val: 72.3438720703125, obj_val: 70.32501983642578, abs dis: 2.0188522338867188
[rfa agg] iter: 3, weight: tensor([0.1094, 0.1352, 0.0643, 0.0612, 0.1387, 0.0491, 0.1161, 0.1117, 0.1002,
        0.1140])
[rfa agg] iter:  4, prev_obj_val: 70.32501983642578, obj_val: 70.3216781616211, abs dis: 0.0033416748046875
[rfa agg] iter: 4, weight: tensor([0.1175, 0.1250, 0.0662, 0.0628, 0.1364, 0.0453, 0.1088, 0.1142, 0.1071,
        0.1167])
[rfa agg] iter:  5, prev_obj_val: 70.3216781616211, obj_val: 72.3467788696289, abs dis: 2.0251007080078125
[rfa agg] iter: 5, weight: tensor([0.1182, 0.1239, 0.0663, 0.0629, 0.1362, 0.0453, 0.1079, 0.1147, 0.1075,
        0.1171])
[rfa agg] iter:  6, prev_obj_val: 72.3467788696289, obj_val: 70.32459259033203, abs dis: 2.022186279296875
[rfa agg] iter: 6, weight: tensor([0.1098, 0.1341, 0.0644, 0.0613, 0.1390, 0.0491, 0.1153, 0.1122, 0.1005,
        0.1144])
[rfa agg] iter:  7, prev_obj_val: 70.32459259033203, obj_val: 70.32168579101562, abs dis: 0.00290679931640625
[rfa agg] iter: 7, weight: tensor([0.1175, 0.1249, 0.0662, 0.0628, 0.1365, 0.0453, 0.1087, 0.1143, 0.1071,
        0.1167])
[rfa agg] iter:  8, prev_obj_val: 70.32168579101562, obj_val: 72.3467788696289, abs dis: 2.0250930786132812
[rfa agg] iter: 8, weight: tensor([0.1182, 0.1239, 0.0663, 0.0629, 0.1363, 0.0453, 0.1079, 0.1147, 0.1075,
        0.1171])
[rfa agg] iter:  9, prev_obj_val: 72.3467788696289, obj_val: 70.3245849609375, abs dis: 2.0221939086914062
[rfa agg] iter: 9, weight: tensor([0.1098, 0.1341, 0.0644, 0.0613, 0.1390, 0.0491, 0.1153, 0.1122, 0.1005,
        0.1144])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2153, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 9.1205, Accuracy: 0/9950 (0.0000%)
saving model
Done in 414.7672975063324 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 76, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0694, Accuracy: 197/690 (28.5507%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0321, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6481, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0782, Accuracy: 156/719 (21.6968%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0348, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.1893, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0605, Accuracy: 252/1013 (24.8766%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 470/1013 (46.3968%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.7595, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0671, Accuracy: 276/1573 (17.5461%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0381, Accuracy: 557/1573 (35.4100%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1946, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0729, Accuracy: 286/1427 (20.0420%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 569/1427 (39.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2561, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   1, Avg loss: 0.0764, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 186/466 (39.9142%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1482, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0593, Accuracy: 357/1440 (24.7917%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0297, Accuracy: 665/1440 (46.1806%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.3642, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0760, Accuracy: 114/818 (13.9364%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.1311, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0668, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0399, Accuracy: 412/1513 (27.2307%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4504, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0523, Accuracy: 234/813 (28.7823%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0212, Accuracy: 476/813 (58.5486%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 13.5140, Accuracy: 53/10000 (0.5300%)
time spent on training: 360.3583822250366
[rfa agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 466, 1440, 818, 1513, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 41, 39, 40, 34, 76, 29, 71, 8, 53], weight: tensor([0.0659, 0.0687, 0.0967, 0.1502, 0.1363, 0.0445, 0.1375, 0.0781, 0.1445,
        0.0776])
[rfa agg] iter:  0, prev_obj_val: 59.85974884033203, obj_val: 62.96549987792969, abs dis: 3.1057510375976562
[rfa agg] iter: 0, weight: tensor([0.0600, 0.0677, 0.1855, 0.1061, 0.1232, 0.0283, 0.1229, 0.0957, 0.1125,
        0.0982])
[rfa agg] iter:  1, prev_obj_val: 62.96549987792969, obj_val: 64.30323791503906, abs dis: 1.337738037109375
[rfa agg] iter: 1, weight: tensor([0.0711, 0.0790, 0.2037, 0.0865, 0.0975, 0.0315, 0.0977, 0.1182, 0.0910,
        0.1238])
[rfa agg] iter:  2, prev_obj_val: 64.30323791503906, obj_val: 62.92272186279297, abs dis: 1.3805160522460938
[rfa agg] iter: 2, weight: tensor([0.0763, 0.0839, 0.1958, 0.0809, 0.0901, 0.0329, 0.0903, 0.1287, 0.0847,
        0.1363])
[rfa agg] iter:  3, prev_obj_val: 62.92272186279297, obj_val: 64.30162048339844, abs dis: 1.3788986206054688
[rfa agg] iter: 3, weight: tensor([0.0713, 0.0794, 0.2055, 0.0853, 0.0957, 0.0313, 0.0959, 0.1201, 0.0894,
        0.1261])
[rfa agg] iter:  4, prev_obj_val: 64.30162048339844, obj_val: 62.922767639160156, abs dis: 1.3788528442382812
[rfa agg] iter: 4, weight: tensor([0.0763, 0.0839, 0.1960, 0.0808, 0.0900, 0.0328, 0.0902, 0.1287, 0.0846,
        0.1365])
[rfa agg] iter:  5, prev_obj_val: 62.922767639160156, obj_val: 64.30162048339844, abs dis: 1.3788528442382812
[rfa agg] iter: 5, weight: tensor([0.0713, 0.0794, 0.2055, 0.0852, 0.0957, 0.0313, 0.0959, 0.1201, 0.0894,
        0.1261])
[rfa agg] iter:  6, prev_obj_val: 64.30162048339844, obj_val: 62.92276382446289, abs dis: 1.3788566589355469
[rfa agg] iter: 6, weight: tensor([0.0763, 0.0839, 0.1961, 0.0808, 0.0900, 0.0328, 0.0902, 0.1287, 0.0846,
        0.1365])
[rfa agg] iter:  7, prev_obj_val: 62.92276382446289, obj_val: 64.30162048339844, abs dis: 1.3788566589355469
[rfa agg] iter: 7, weight: tensor([0.0713, 0.0794, 0.2055, 0.0852, 0.0957, 0.0313, 0.0959, 0.1201, 0.0894,
        0.1261])
[rfa agg] iter:  8, prev_obj_val: 64.30162048339844, obj_val: 62.92276382446289, abs dis: 1.3788566589355469
[rfa agg] iter: 8, weight: tensor([0.0763, 0.0839, 0.1961, 0.0808, 0.0900, 0.0328, 0.0902, 0.1287, 0.0846,
        0.1365])
[rfa agg] iter:  9, prev_obj_val: 62.92276382446289, obj_val: 64.30162811279297, abs dis: 1.3788642883300781
[rfa agg] iter: 9, weight: tensor([0.0713, 0.0794, 0.2055, 0.0852, 0.0957, 0.0313, 0.0959, 0.1201, 0.0894,
        0.1261])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.2467, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 9.0737, Accuracy: 0/9950 (0.0000%)
saving model
Done in 462.0497269630432 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 90, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0886, Accuracy: 34/408 (8.3333%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 144/408 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1279, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0724, Accuracy: 276/1427 (19.3413%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0373, Accuracy: 541/1427 (37.9117%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4438, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0756, Accuracy: 103/818 (12.5917%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0346, Accuracy: 329/818 (40.2200%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.1855, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0613, Accuracy: 218/712 (30.6180%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 405/712 (56.8820%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.1372, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0665, Accuracy: 182/1241 (14.6656%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0410, Accuracy: 370/1241 (29.8147%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5325, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   1, Avg loss: 0.0597, Accuracy: 242/677 (35.7459%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   2, Avg loss: 0.0248, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.9401, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0666, Accuracy: 199/888 (22.4099%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0291, Accuracy: 410/888 (46.1712%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.9376, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0774, Accuracy: 81/781 (10.3713%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0393, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.6451, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0688, Accuracy: 106/809 (13.1026%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0315, Accuracy: 319/809 (39.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.6564, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.1051, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0598, Accuracy: 89/312 (28.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2597, Accuracy: 55/10000 (0.5500%)
time spent on training: 343.31245040893555
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 677, 888, 781, 809, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 34, 71, 11, 72, 90, 63, 3, 50, 24], weight: tensor([0.0505, 0.1768, 0.1013, 0.0882, 0.1537, 0.0839, 0.1100, 0.0967, 0.1002,
        0.0386])
[rfa agg] iter:  0, prev_obj_val: 49.84608459472656, obj_val: 55.9078483581543, abs dis: 6.061763763427734
[rfa agg] iter: 0, weight: tensor([0.0320, 0.0715, 0.1520, 0.1113, 0.0859, 0.1041, 0.1416, 0.1306, 0.1527,
        0.0185])
[rfa agg] iter:  1, prev_obj_val: 55.9078483581543, obj_val: 58.325889587402344, abs dis: 2.418041229248047
[rfa agg] iter: 1, weight: tensor([0.0460, 0.0646, 0.1406, 0.1231, 0.0737, 0.1434, 0.1203, 0.1224, 0.1411,
        0.0247])
[rfa agg] iter:  2, prev_obj_val: 58.325889587402344, obj_val: 55.87120819091797, abs dis: 2.454681396484375
[rfa agg] iter: 2, weight: tensor([0.0529, 0.0652, 0.1333, 0.1245, 0.0736, 0.1560, 0.1150, 0.1178, 0.1340,
        0.0277])
[rfa agg] iter:  3, prev_obj_val: 55.87120819091797, obj_val: 55.869754791259766, abs dis: 0.001453399658203125
[rfa agg] iter: 3, weight: tensor([0.0463, 0.0640, 0.1373, 0.1251, 0.0730, 0.1533, 0.1178, 0.1197, 0.1386,
        0.0247])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.2555, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 9.0024, Accuracy: 0/9950 (0.0000%)
saving model
Done in 438.612651348114 sec.
Server Epoch:92 choose agents : [91, 89, 76, 1, 58, 42, 94, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   1, Avg loss: 0.0682, Accuracy: 232/1030 (22.5243%)
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   2, Avg loss: 0.0292, Accuracy: 548/1030 (53.2039%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.1837, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   1, Avg loss: 0.0717, Accuracy: 225/896 (25.1116%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   2, Avg loss: 0.0384, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4089, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0761, Accuracy: 61/466 (13.0901%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0239, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0646, Accuracy: 235/928 (25.3233%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0262, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.0603, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0655, Accuracy: 255/803 (31.7559%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 418/803 (52.0548%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3813, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0607, Accuracy: 271/1372 (19.7522%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0338, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7696, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   1, Avg loss: 0.0692, Accuracy: 264/1662 (15.8845%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   2, Avg loss: 0.0369, Accuracy: 505/1662 (30.3851%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0089, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0792, Accuracy: 98/1013 (9.6742%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0389, Accuracy: 343/1013 (33.8598%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.6910, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0574, Accuracy: 369/1440 (25.6250%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0296, Accuracy: 663/1440 (46.0417%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7210, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0835, Accuracy: 23/486 (4.7325%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 222/486 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.8171, Accuracy: 49/10000 (0.4900%)
time spent on training: 342.4676902294159
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 896, 466, 928, 803, 1372, 1662, 1013, 1440, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 89, 76, 1, 58, 42, 94, 14, 29, 30], weight: tensor([0.1020, 0.0887, 0.0462, 0.0919, 0.0795, 0.1359, 0.1646, 0.1003, 0.1426,
        0.0481])
[rfa agg] iter:  0, prev_obj_val: 59.276611328125, obj_val: 61.911678314208984, abs dis: 2.6350669860839844
[rfa agg] iter: 0, weight: tensor([0.1266, 0.1279, 0.0314, 0.1269, 0.1151, 0.1049, 0.0826, 0.1567, 0.0953,
        0.0327])
[rfa agg] iter:  1, prev_obj_val: 61.911678314208984, obj_val: 68.12751007080078, abs dis: 6.215831756591797
[rfa agg] iter: 1, weight: tensor([0.1167, 0.1419, 0.0346, 0.1305, 0.1373, 0.0911, 0.0743, 0.1533, 0.0841,
        0.0361])
[rfa agg] iter:  2, prev_obj_val: 68.12751007080078, obj_val: 65.79441833496094, abs dis: 2.3330917358398438
[rfa agg] iter: 2, weight: tensor([0.1033, 0.1482, 0.0447, 0.1243, 0.1698, 0.0826, 0.0706, 0.1323, 0.0776,
        0.0465])
[rfa agg] iter:  3, prev_obj_val: 65.79441833496094, obj_val: 65.79365539550781, abs dis: 0.000762939453125
[rfa agg] iter: 3, weight: tensor([0.1050, 0.1490, 0.0406, 0.1254, 0.1683, 0.0837, 0.0707, 0.1366, 0.0783,
        0.0423])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.2976, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 9.2857, Accuracy: 0/9950 (0.0000%)
saving model
Done in 442.16839146614075 sec.
Server Epoch:93 choose agents : [75, 7, 35, 2, 93, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   1, Avg loss: 0.0697, Accuracy: 160/776 (20.6186%)
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.3356, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0648, Accuracy: 197/891 (22.1100%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0312, Accuracy: 428/891 (48.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4391, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.1156, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0724, Accuracy: 48/271 (17.7122%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6345, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0940, Accuracy: 54/605 (8.9256%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0469, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.2440, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   1, Avg loss: 0.0642, Accuracy: 319/1742 (18.3123%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   2, Avg loss: 0.0337, Accuracy: 654/1742 (37.5431%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.2801, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0722, Accuracy: 255/1154 (22.0971%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0338, Accuracy: 387/1154 (33.5355%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.0606, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0609, Accuracy: 361/1904 (18.9601%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0324, Accuracy: 654/1904 (34.3487%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6913, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0951, Accuracy: 7/426 (1.6432%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0494, Accuracy: 148/426 (34.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.5657, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0542, Accuracy: 259/1071 (24.1830%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.1039, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0760, Accuracy: 150/938 (15.9915%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0382, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.4386, Accuracy: 69/10000 (0.6900%)
time spent on training: 332.5761206150055
[rfa agg] training data poison_ratio: 0.0  data num: [776, 891, 271, 605, 1742, 1154, 1904, 426, 1071, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 7, 35, 2, 93, 15, 46, 67, 55, 73], weight: tensor([0.0794, 0.0911, 0.0277, 0.0619, 0.1782, 0.1180, 0.1947, 0.0436, 0.1095,
        0.0959])
[rfa agg] iter:  0, prev_obj_val: 74.18279266357422, obj_val: 75.89154815673828, abs dis: 1.7087554931640625
[rfa agg] iter: 0, weight: tensor([0.0983, 0.1264, 0.0138, 0.0504, 0.0977, 0.1367, 0.0910, 0.0261, 0.1966,
        0.1631])
[rfa agg] iter:  1, prev_obj_val: 75.89154815673828, obj_val: 77.0512466430664, abs dis: 1.159698486328125
[rfa agg] iter: 1, weight: tensor([0.1147, 0.1475, 0.0140, 0.0550, 0.0780, 0.1124, 0.0738, 0.0273, 0.1849,
        0.1924])
[rfa agg] iter:  2, prev_obj_val: 77.0512466430664, obj_val: 77.04376983642578, abs dis: 0.007476806640625
[rfa agg] iter: 2, weight: tensor([0.1233, 0.1576, 0.0143, 0.0579, 0.0738, 0.1035, 0.0702, 0.0283, 0.1697,
        0.2014])
[rfa agg] iter:  3, prev_obj_val: 77.04376983642578, obj_val: 77.04362487792969, abs dis: 0.00014495849609375
[rfa agg] iter: 3, weight: tensor([0.1237, 0.1591, 0.0143, 0.0578, 0.0735, 0.1025, 0.0699, 0.0282, 0.1674,
        0.2037])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.3365, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 9.0086, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.29275608062744 sec.
Server Epoch:94 choose agents : [54, 23, 95, 98, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0664, Accuracy: 229/1130 (20.2655%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0327, Accuracy: 423/1130 (37.4336%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.8253, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0754, Accuracy: 208/715 (29.0909%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0455, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.1944, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   1, Avg loss: 0.0750, Accuracy: 149/599 (24.8748%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   2, Avg loss: 0.0317, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 15.7423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   1, Avg loss: 0.0898, Accuracy: 4/373 (1.0724%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   2, Avg loss: 0.0505, Accuracy: 117/373 (31.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.1683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0705, Accuracy: 277/1581 (17.5206%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0385, Accuracy: 510/1581 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8822, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0667, Accuracy: 164/636 (25.7862%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0350, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.4485, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0811, Accuracy: 63/631 (9.9842%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0492, Accuracy: 232/631 (36.7670%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.1640, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.1058, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0593, Accuracy: 84/312 (26.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4025, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0553, Accuracy: 382/1628 (23.4644%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 770/1628 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.0468, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0778, Accuracy: 78/781 (9.9872%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0401, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.9657, Accuracy: 88/10000 (0.8800%)
time spent on training: 278.8028881549835
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 715, 599, 373, 1581, 636, 631, 312, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 23, 95, 98, 28, 52, 48, 24, 5, 3], weight: tensor([0.1347, 0.0853, 0.0714, 0.0445, 0.1885, 0.0758, 0.0752, 0.0372, 0.1941,
        0.0931])
[rfa agg] iter:  0, prev_obj_val: 69.85778045654297, obj_val: 72.18223571777344, abs dis: 2.3244552612304688
[rfa agg] iter: 0, weight: tensor([0.1951, 0.1170, 0.0793, 0.0298, 0.1173, 0.0820, 0.0872, 0.0225, 0.1084,
        0.1614])
[rfa agg] iter:  1, prev_obj_val: 72.18223571777344, obj_val: 74.46620178222656, abs dis: 2.283966064453125
[rfa agg] iter: 1, weight: tensor([0.1356, 0.1351, 0.0983, 0.0330, 0.0889, 0.1005, 0.1128, 0.0244, 0.0833,
        0.1880])
[rfa agg] iter:  2, prev_obj_val: 74.46620178222656, obj_val: 77.72315216064453, abs dis: 3.2569503784179688
[rfa agg] iter: 2, weight: tensor([0.1110, 0.1380, 0.1118, 0.0356, 0.0786, 0.1138, 0.1347, 0.0260, 0.0742,
        0.1763])
[rfa agg] iter:  3, prev_obj_val: 77.72315216064453, obj_val: 77.7002944946289, abs dis: 0.022857666015625
[rfa agg] iter: 3, weight: tensor([0.0957, 0.1310, 0.1267, 0.0397, 0.0718, 0.1279, 0.1623, 0.0286, 0.0682,
        0.1482])
[rfa agg] iter:  4, prev_obj_val: 77.7002944946289, obj_val: 77.69996643066406, abs dis: 0.00032806396484375
[rfa agg] iter: 4, weight: tensor([0.0948, 0.1297, 0.1282, 0.0396, 0.0712, 0.1294, 0.1666, 0.0286, 0.0676,
        0.1442])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3100, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 8.9388, Accuracy: 0/9950 (0.0000%)
saving model
Done in 377.0651009082794 sec.
Server Epoch:95 choose agents : [79, 4, 1, 10, 41, 2, 58, 11, 29, 77].
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   2, Avg loss: 0.1079, Accuracy: 4/197 (2.0305%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.5081, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0730, Accuracy: 242/901 (26.8590%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0381, Accuracy: 377/901 (41.8424%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.8050, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0628, Accuracy: 260/928 (28.0172%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0258, Accuracy: 550/928 (59.2672%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.8962, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0639, Accuracy: 156/861 (18.1185%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0240, Accuracy: 435/861 (50.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.4297, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0786, Accuracy: 149/719 (20.7232%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0374, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.9431, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0939, Accuracy: 51/605 (8.4298%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0501, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6263, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0661, Accuracy: 241/803 (30.0125%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0393, Accuracy: 425/803 (52.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5864, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0569, Accuracy: 251/712 (35.2528%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0248, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.7444, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0592, Accuracy: 397/1440 (27.5694%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0296, Accuracy: 653/1440 (45.3472%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.4092, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   1, Avg loss: 0.0562, Accuracy: 302/1340 (22.5373%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   2, Avg loss: 0.0292, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0331, Accuracy: 92/10000 (0.9200%)
time spent on training: 291.6566393375397
[rfa agg] training data poison_ratio: 0.0  data num: [197, 901, 928, 861, 719, 605, 803, 712, 1440, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 4, 1, 10, 41, 2, 58, 11, 29, 77], weight: tensor([0.0232, 0.1059, 0.1091, 0.1012, 0.0845, 0.0711, 0.0944, 0.0837, 0.1693,
        0.1575])
[rfa agg] iter:  0, prev_obj_val: 50.988285064697266, obj_val: 54.368831634521484, abs dis: 3.3805465698242188
[rfa agg] iter: 0, weight: tensor([0.0096, 0.1177, 0.1220, 0.1582, 0.0937, 0.0660, 0.1518, 0.1020, 0.0821,
        0.0970])
[rfa agg] iter:  1, prev_obj_val: 54.368831634521484, obj_val: 54.33576965332031, abs dis: 0.033061981201171875
[rfa agg] iter: 1, weight: tensor([0.0107, 0.1037, 0.1082, 0.1485, 0.1044, 0.0826, 0.1711, 0.1202, 0.0700,
        0.0806])
[rfa agg] iter:  2, prev_obj_val: 54.33576965332031, obj_val: 54.33527755737305, abs dis: 0.000492095947265625
[rfa agg] iter: 2, weight: tensor([0.0106, 0.1018, 0.1065, 0.1458, 0.1050, 0.0835, 0.1747, 0.1230, 0.0694,
        0.0797])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.3111, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 8.6851, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.15194058418274 sec.
Server Epoch:96 choose agents : [77, 9, 2, 30, 42, 20, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   1, Avg loss: 0.0571, Accuracy: 298/1340 (22.2388%)
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   2, Avg loss: 0.0301, Accuracy: 532/1340 (39.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.4434, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0507, Accuracy: 326/1275 (25.5686%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0216, Accuracy: 654/1275 (51.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 12.1196, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0904, Accuracy: 64/605 (10.5785%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0504, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1866, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0856, Accuracy: 23/486 (4.7325%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0426, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.7058, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0614, Accuracy: 245/1372 (17.8571%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0341, Accuracy: 495/1372 (36.0787%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0008, Accuracy: 85/10000 (0.8500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   1, Avg loss: 0.0669, Accuracy: 197/807 (24.4114%)
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   2, Avg loss: 0.0356, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6818, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1504, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1395, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.9014, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0784, Accuracy: 72/781 (9.2190%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0383, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.8462, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0706, Accuracy: 275/1154 (23.8302%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0350, Accuracy: 426/1154 (36.9151%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.8857, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0644, Accuracy: 343/1956 (17.5358%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0348, Accuracy: 579/1956 (29.6012%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.4914, Accuracy: 107/10000 (1.0700%)
time spent on training: 353.15665578842163
[rfa agg] training data poison_ratio: 0.08183754183145725  data num: [1340, 1275, 605, 486, 1372, 807, 85, 781, 1154, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.02557423182233039
[rfa agg] init. name: [77, 9, 2, 30, 42, 20, 61, 3, 15, 6], weight: tensor([0.1359, 0.1293, 0.0614, 0.0493, 0.1391, 0.0818, 0.0086, 0.0792, 0.1170,
        0.1984])
[rfa agg] iter:  0, prev_obj_val: 65.87385559082031, obj_val: 68.77919006347656, abs dis: 2.90533447265625
[rfa agg] iter: 0, weight: tensor([0.1745, 0.1998, 0.0409, 0.0273, 0.1695, 0.0780, 0.0029, 0.0756, 0.1391,
        0.0926])
[rfa agg] iter:  1, prev_obj_val: 68.77919006347656, obj_val: 68.75543975830078, abs dis: 0.02375030517578125
[rfa agg] iter: 1, weight: tensor([0.1586, 0.1829, 0.0500, 0.0327, 0.1458, 0.1011, 0.0032, 0.0977, 0.1411,
        0.0869])
[rfa agg] iter:  2, prev_obj_val: 68.75543975830078, obj_val: 68.75536346435547, abs dis: 7.62939453125e-05
[rfa agg] iter: 2, weight: tensor([0.1575, 0.1818, 0.0503, 0.0327, 0.1448, 0.1024, 0.0032, 0.0991, 0.1415,
        0.0868])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.9246, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 10.9548, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.07393074035645 sec.
Server Epoch:97 choose agents : [38, 36, 83, 74, 84, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0741, Accuracy: 146/1131 (12.9089%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0339, Accuracy: 463/1131 (40.9372%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.6161, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0922, Accuracy: 32/408 (7.8431%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0595, Accuracy: 144/408 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.0670, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0628, Accuracy: 352/1953 (18.0236%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0372, Accuracy: 682/1953 (34.9206%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.1911, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   1, Avg loss: 0.0480, Accuracy: 438/1552 (28.2216%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   2, Avg loss: 0.0237, Accuracy: 674/1552 (43.4278%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.2069, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0717, Accuracy: 283/1190 (23.7815%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0352, Accuracy: 413/1190 (34.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.1161, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0673, Accuracy: 227/1513 (15.0033%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0395, Accuracy: 455/1513 (30.0727%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7542, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0631, Accuracy: 356/1587 (22.4323%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0360, Accuracy: 566/1587 (35.6648%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6228, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0772, Accuracy: 161/719 (22.3922%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0373, Accuracy: 468/719 (65.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.0125, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0595, Accuracy: 274/1446 (18.9488%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0373, Accuracy: 464/1446 (32.0885%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7090, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0671, Accuracy: 232/1130 (20.5310%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0335, Accuracy: 434/1130 (38.4071%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.9157, Accuracy: 66/10000 (0.6600%)
time spent on training: 410.42167615890503
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 1953, 1552, 1190, 1513, 1587, 719, 1446, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 83, 74, 84, 8, 27, 41, 26, 54], weight: tensor([0.0896, 0.0323, 0.1546, 0.1229, 0.0942, 0.1198, 0.1257, 0.0569, 0.1145,
        0.0895])
[rfa agg] iter:  0, prev_obj_val: 59.63530731201172, obj_val: 62.081016540527344, abs dis: 2.445709228515625
[rfa agg] iter: 0, weight: tensor([0.1151, 0.0135, 0.0807, 0.1168, 0.1300, 0.1306, 0.1199, 0.0361, 0.1367,
        0.1206])
[rfa agg] iter:  1, prev_obj_val: 62.081016540527344, obj_val: 63.67636489868164, abs dis: 1.5953483581542969
[rfa agg] iter: 1, weight: tensor([0.1328, 0.0146, 0.0742, 0.1042, 0.1450, 0.1170, 0.1074, 0.0402, 0.1247,
        0.1400])
[rfa agg] iter:  2, prev_obj_val: 63.67636489868164, obj_val: 62.05916976928711, abs dis: 1.6171951293945312
[rfa agg] iter: 2, weight: tensor([0.1423, 0.0152, 0.0717, 0.0983, 0.1498, 0.1102, 0.1018, 0.0427, 0.1171,
        0.1507])
[rfa agg] iter:  3, prev_obj_val: 62.05916976928711, obj_val: 63.67328643798828, abs dis: 1.6141166687011719
[rfa agg] iter: 3, weight: tensor([0.1361, 0.0145, 0.0734, 0.1021, 0.1473, 0.1151, 0.1062, 0.0399, 0.1219,
        0.1434])
[rfa agg] iter:  4, prev_obj_val: 63.67328643798828, obj_val: 62.05946731567383, abs dis: 1.6138191223144531
[rfa agg] iter: 4, weight: tensor([0.1427, 0.0152, 0.0716, 0.0981, 0.1501, 0.1100, 0.1017, 0.0426, 0.1168,
        0.1512])
[rfa agg] iter:  5, prev_obj_val: 62.05946731567383, obj_val: 63.67325210571289, abs dis: 1.6137847900390625
[rfa agg] iter: 5, weight: tensor([0.1361, 0.0145, 0.0734, 0.1021, 0.1474, 0.1151, 0.1062, 0.0399, 0.1219,
        0.1435])
[rfa agg] iter:  6, prev_obj_val: 63.67325210571289, obj_val: 62.059471130371094, abs dis: 1.6137809753417969
[rfa agg] iter: 6, weight: tensor([0.1428, 0.0152, 0.0716, 0.0981, 0.1501, 0.1100, 0.1017, 0.0426, 0.1168,
        0.1512])
[rfa agg] iter:  7, prev_obj_val: 62.059471130371094, obj_val: 63.673248291015625, abs dis: 1.6137771606445312
[rfa agg] iter: 7, weight: tensor([0.1361, 0.0145, 0.0734, 0.1021, 0.1474, 0.1151, 0.1062, 0.0399, 0.1219,
        0.1435])
[rfa agg] iter:  8, prev_obj_val: 63.673248291015625, obj_val: 62.059471130371094, abs dis: 1.6137771606445312
[rfa agg] iter: 8, weight: tensor([0.1428, 0.0152, 0.0716, 0.0981, 0.1501, 0.1100, 0.1017, 0.0426, 0.1168,
        0.1512])
[rfa agg] iter:  9, prev_obj_val: 62.059471130371094, obj_val: 63.673248291015625, abs dis: 1.6137771606445312
[rfa agg] iter: 9, weight: tensor([0.1361, 0.0145, 0.0734, 0.1021, 0.1474, 0.1151, 0.1062, 0.0399, 0.1219,
        0.1435])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0584, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 10.3128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 515.5737812519073 sec.
Server Epoch:98 choose agents : [70, 56, 62, 89, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0678, Accuracy: 273/1418 (19.2525%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0353, Accuracy: 576/1418 (40.6206%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8918, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0968, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0789, Accuracy: 3/186 (1.6129%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.8372, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0728, Accuracy: 85/568 (14.9648%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0426, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.0738, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0697, Accuracy: 228/896 (25.4464%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6306, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0682, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0414, Accuracy: 391/1241 (31.5068%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8292, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0766, Accuracy: 178/708 (25.1412%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2169, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0619, Accuracy: 241/690 (34.9275%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0309, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.3135, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0845, Accuracy: 44/515 (8.5437%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0527, Accuracy: 148/515 (28.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3638, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0523, Accuracy: 439/1470 (29.8639%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0257, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.9973, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0687, Accuracy: 209/1154 (18.1109%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0299, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.5660, Accuracy: 81/10000 (0.8100%)
time spent on training: 299.57090950012207
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 896, 1241, 708, 690, 515, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 56, 62, 89, 72, 16, 25, 33, 22, 57], weight: tensor([0.1603, 0.0210, 0.0642, 0.1013, 0.1403, 0.0800, 0.0780, 0.0582, 0.1662,
        0.1305])
[rfa agg] iter:  0, prev_obj_val: 64.17848205566406, obj_val: 65.22205352783203, abs dis: 1.0435714721679688
[rfa agg] iter: 0, weight: tensor([0.1068, 0.0101, 0.0642, 0.1884, 0.1402, 0.1075, 0.1035, 0.0525, 0.1108,
        0.1160])
[rfa agg] iter:  1, prev_obj_val: 65.22205352783203, obj_val: 66.61198425292969, abs dis: 1.3899307250976562
[rfa agg] iter: 1, weight: tensor([0.0984, 0.0102, 0.0680, 0.2052, 0.1285, 0.1141, 0.1113, 0.0543, 0.1025,
        0.1074])
[rfa agg] iter:  2, prev_obj_val: 66.61198425292969, obj_val: 68.19679260253906, abs dis: 1.584808349609375
[rfa agg] iter: 2, weight: tensor([0.0936, 0.0105, 0.0731, 0.2059, 0.1198, 0.1201, 0.1204, 0.0572, 0.0976,
        0.1018])
[rfa agg] iter:  3, prev_obj_val: 68.19679260253906, obj_val: 66.61090850830078, abs dis: 1.5858840942382812
[rfa agg] iter: 3, weight: tensor([0.0897, 0.0109, 0.0795, 0.1985, 0.1127, 0.1260, 0.1311, 0.0608, 0.0936,
        0.0972])
[rfa agg] iter:  4, prev_obj_val: 66.61090850830078, obj_val: 68.19535064697266, abs dis: 1.584442138671875
[rfa agg] iter: 4, weight: tensor([0.0931, 0.0106, 0.0736, 0.2038, 0.1192, 0.1218, 0.1223, 0.0574, 0.0971,
        0.1009])
[rfa agg] iter:  5, prev_obj_val: 68.19535064697266, obj_val: 66.61106872558594, abs dis: 1.5842819213867188
[rfa agg] iter: 5, weight: tensor([0.0897, 0.0110, 0.0795, 0.1980, 0.1127, 0.1263, 0.1313, 0.0608, 0.0935,
        0.0972])
[rfa agg] iter:  6, prev_obj_val: 66.61106872558594, obj_val: 68.1953353881836, abs dis: 1.5842666625976562
[rfa agg] iter: 6, weight: tensor([0.0931, 0.0106, 0.0736, 0.2037, 0.1192, 0.1219, 0.1224, 0.0574, 0.0971,
        0.1009])
[rfa agg] iter:  7, prev_obj_val: 68.1953353881836, obj_val: 66.61107635498047, abs dis: 1.584259033203125
[rfa agg] iter: 7, weight: tensor([0.0897, 0.0110, 0.0795, 0.1980, 0.1127, 0.1263, 0.1313, 0.0608, 0.0935,
        0.0972])
[rfa agg] iter:  8, prev_obj_val: 66.61107635498047, obj_val: 68.1953353881836, abs dis: 1.584259033203125
[rfa agg] iter: 8, weight: tensor([0.0931, 0.0106, 0.0736, 0.2037, 0.1192, 0.1219, 0.1224, 0.0574, 0.0971,
        0.1009])
[rfa agg] iter:  9, prev_obj_val: 68.1953353881836, obj_val: 66.61107635498047, abs dis: 1.584259033203125
[rfa agg] iter: 9, weight: tensor([0.0897, 0.0110, 0.0795, 0.1980, 0.1127, 0.1263, 0.1313, 0.0608, 0.0935,
        0.0972])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.2322, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 11.0084, Accuracy: 0/9950 (0.0000%)
saving model
Done in 398.0510857105255 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 81, 38, 62, 92, 78].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.1028, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0567, Accuracy: 97/312 (31.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0095, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0882, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0558, Accuracy: 137/440 (31.1364%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8823, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.1193, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0835, Accuracy: 48/271 (17.7122%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.5313, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0717, Accuracy: 210/1402 (14.9786%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0445, Accuracy: 332/1402 (23.6805%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4009, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0621, Accuracy: 228/690 (33.0435%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0301, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.5014, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   1, Avg loss: 0.0743, Accuracy: 178/774 (22.9974%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   2, Avg loss: 0.0386, Accuracy: 358/774 (46.2532%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.9677, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0731, Accuracy: 162/1131 (14.3236%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0339, Accuracy: 425/1131 (37.5774%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.5939, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0728, Accuracy: 85/568 (14.9648%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0425, Accuracy: 258/568 (45.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8344, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   1, Avg loss: 0.0585, Accuracy: 345/1715 (20.1166%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   2, Avg loss: 0.0324, Accuracy: 641/1715 (37.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1595, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   1, Avg loss: 0.0947, Accuracy: 1/416 (0.2404%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   2, Avg loss: 0.0493, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.9657, Accuracy: 73/10000 (0.7300%)
time spent on training: 299.1359214782715
[rfa agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 774, 1131, 568, 1715, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 49, 35, 66, 25, 81, 38, 62, 92, 78], weight: tensor([0.0404, 0.0570, 0.0351, 0.1816, 0.0894, 0.1003, 0.1465, 0.0736, 0.2222,
        0.0539])
[rfa agg] iter:  0, prev_obj_val: 74.47953796386719, obj_val: 77.31356048583984, abs dis: 2.8340225219726562
[rfa agg] iter: 0, weight: tensor([0.0291, 0.0533, 0.0252, 0.1314, 0.1529, 0.1873, 0.1687, 0.0950, 0.1072,
        0.0499])
[rfa agg] iter:  1, prev_obj_val: 77.31356048583984, obj_val: 80.18634796142578, abs dis: 2.8727874755859375
[rfa agg] iter: 1, weight: tensor([0.0319, 0.0611, 0.0274, 0.1066, 0.1892, 0.1891, 0.1315, 0.1170, 0.0898,
        0.0565])
[rfa agg] iter:  2, prev_obj_val: 80.18634796142578, obj_val: 80.1589126586914, abs dis: 0.027435302734375
[rfa agg] iter: 2, weight: tensor([0.0351, 0.0699, 0.0301, 0.0952, 0.2055, 0.1642, 0.1128, 0.1411, 0.0821,
        0.0639])
[rfa agg] iter:  3, prev_obj_val: 80.1589126586914, obj_val: 80.1584243774414, abs dis: 0.00048828125
[rfa agg] iter: 3, weight: tensor([0.0351, 0.0702, 0.0301, 0.0944, 0.2096, 0.1595, 0.1115, 0.1439, 0.0815,
        0.0641])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.3822, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 8.7423, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.4446439743042 sec.
Server Epoch:100 choose agents : [47, 65, 85, 24, 39, 5, 1, 53, 87, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1478, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1307, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.0502, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0661, Accuracy: 301/1475 (20.4068%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0347, Accuracy: 596/1475 (40.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.7940, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   1, Avg loss: 0.0742, Accuracy: 286/1988 (14.3863%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   2, Avg loss: 0.0390, Accuracy: 584/1988 (29.3763%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2995, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.1014, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0561, Accuracy: 100/312 (32.0513%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0913, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0624, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0279, Accuracy: 497/1013 (49.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3544, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0559, Accuracy: 375/1628 (23.0344%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 784/1628 (48.1572%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.4649, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0617, Accuracy: 270/928 (29.0948%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 590/928 (63.5776%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.8209, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0549, Accuracy: 225/813 (27.6753%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0217, Accuracy: 469/813 (57.6876%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 13.4024, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1, Avg loss: 0.0678, Accuracy: 216/1131 (19.0981%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2, Avg loss: 0.0342, Accuracy: 377/1131 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.7938, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0661, Accuracy: 250/803 (31.1333%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0388, Accuracy: 416/803 (51.8057%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4184, Accuracy: 60/10000 (0.6000%)
time spent on training: 401.88409900665283
[rfa agg] training data poison_ratio: 0.0  data num: [134, 1475, 1988, 312, 1013, 1628, 928, 813, 1131, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 65, 85, 24, 39, 5, 1, 53, 87, 58], weight: tensor([0.0131, 0.1443, 0.1944, 0.0305, 0.0991, 0.1592, 0.0908, 0.0795, 0.1106,
        0.0785])
[rfa agg] iter:  0, prev_obj_val: 73.3746109008789, obj_val: 73.38378143310547, abs dis: 0.0091705322265625
[rfa agg] iter: 0, weight: tensor([0.0051, 0.1397, 0.0956, 0.0142, 0.1477, 0.1358, 0.1054, 0.0784, 0.1980,
        0.0801])
[rfa agg] iter:  1, prev_obj_val: 73.38378143310547, obj_val: 73.94501495361328, abs dis: 0.5612335205078125
[rfa agg] iter: 1, weight: tensor([0.0050, 0.1265, 0.0859, 0.0138, 0.1593, 0.1206, 0.1073, 0.0793, 0.2208,
        0.0815])
[rfa agg] iter:  2, prev_obj_val: 73.94501495361328, obj_val: 74.7073745727539, abs dis: 0.762359619140625
[rfa agg] iter: 2, weight: tensor([0.0050, 0.1163, 0.0808, 0.0139, 0.1692, 0.1110, 0.1106, 0.0825, 0.2255,
        0.0852])
[rfa agg] iter:  3, prev_obj_val: 74.7073745727539, obj_val: 76.86229705810547, abs dis: 2.1549224853515625
[rfa agg] iter: 3, weight: tensor([0.0050, 0.1081, 0.0767, 0.0141, 0.1798, 0.1035, 0.1148, 0.0868, 0.2208,
        0.0903])
[rfa agg] iter:  4, prev_obj_val: 76.86229705810547, obj_val: 78.24433898925781, abs dis: 1.3820419311523438
[rfa agg] iter: 4, weight: tensor([0.0052, 0.0962, 0.0709, 0.0149, 0.1967, 0.0925, 0.1240, 0.0986, 0.1967,
        0.1044])
[rfa agg] iter:  5, prev_obj_val: 78.24433898925781, obj_val: 79.85943603515625, abs dis: 1.6150970458984375
[rfa agg] iter: 5, weight: tensor([0.0053, 0.0911, 0.0685, 0.0154, 0.2029, 0.0880, 0.1289, 0.1064, 0.1794,
        0.1141])
[rfa agg] iter:  6, prev_obj_val: 79.85943603515625, obj_val: 79.85469055175781, abs dis: 0.0047454833984375
[rfa agg] iter: 6, weight: tensor([0.0055, 0.0872, 0.0667, 0.0160, 0.2019, 0.0845, 0.1326, 0.1153, 0.1646,
        0.1256])
[rfa agg] iter:  7, prev_obj_val: 79.85469055175781, obj_val: 78.24225616455078, abs dis: 1.6124343872070312
[rfa agg] iter: 7, weight: tensor([0.0055, 0.0871, 0.0667, 0.0160, 0.2015, 0.0844, 0.1332, 0.1161, 0.1629,
        0.1266])
[rfa agg] iter:  8, prev_obj_val: 78.24225616455078, obj_val: 78.23848724365234, abs dis: 0.0037689208984375
[rfa agg] iter: 8, weight: tensor([0.0053, 0.0908, 0.0684, 0.0154, 0.2041, 0.0878, 0.1302, 0.1076, 0.1747,
        0.1156])
[rfa agg] iter:  9, prev_obj_val: 78.23848724365234, obj_val: 79.85845947265625, abs dis: 1.6199722290039062
[rfa agg] iter: 9, weight: tensor([0.0053, 0.0909, 0.0684, 0.0154, 0.2046, 0.0878, 0.1297, 0.1069, 0.1762,
        0.1148])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.9967, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 10.5845, Accuracy: 0/9950 (0.0000%)
saving model
Done in 494.9157545566559 sec.
Saving all the graphs.
This run has a label: Jun.25_15.26.52. Visdom environment: tiny
