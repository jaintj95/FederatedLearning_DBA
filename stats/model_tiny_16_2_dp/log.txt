current path: saved_models/model_tiny_Jun.17_08.10.30
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.4324, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 373/1657 (22.5106%)
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 502/1657 (30.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.4096, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 306/1340 (22.8358%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 593/1340 (44.2537%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6061, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 381/1750 (21.7714%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 639/1750 (36.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7376, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 245/1402 (17.4750%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 361/1402 (25.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.3902, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 47/426 (11.0329%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 173/426 (40.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5397, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 57/515 (11.0680%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0544, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.6876, Accuracy: 60/10000 (0.6000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 295/690 (42.7536%)
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1975, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 391/1036 (37.7413%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 649/1036 (62.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 9.2079, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 473/1715 (27.5802%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 759/1715 (44.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5838, Accuracy: 94/10000 (0.9400%)
time spent on training: 139.9469654560089
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3036, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3844, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.41053080558777 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0549, Accuracy: 312/1340 (23.2836%)
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 544/1340 (40.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5046, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 300/1154 (25.9965%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 471/1154 (40.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.5748, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0552, Accuracy: 276/636 (43.3962%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.2174, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 377/1581 (23.8457%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 584/1581 (36.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5607, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 404/1440 (28.0556%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0285, Accuracy: 637/1440 (44.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7410, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1202, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3092, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0667, Accuracy: 185/773 (23.9327%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0298, Accuracy: 422/773 (54.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1839, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 378/1427 (26.4891%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 582/1427 (40.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.0400, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 261/1513 (17.2505%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 503/1513 (33.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5582, Accuracy: 100/10000 (1.0000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 433/1988 (21.7807%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 658/1988 (33.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7108, Accuracy: 69/10000 (0.6900%)
time spent on training: 155.06848120689392
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3045, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3833, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.535605430603 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0629, Accuracy: 294/896 (32.8125%)
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 456/896 (50.8929%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4373, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 374/1418 (26.3752%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 632/1418 (44.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8209, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 364/1275 (28.5490%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 676/1275 (53.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 9.5047, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 168/773 (21.7335%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 416/773 (53.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2248, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0538, Accuracy: 407/1129 (36.0496%)
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 760/1129 (67.3162%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3213, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0530, Accuracy: 394/1574 (25.0318%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 640/1574 (40.6607%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.4161, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0655, Accuracy: 321/901 (35.6271%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 350/901 (38.8457%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.1308, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 60/500 (12.0000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 192/500 (38.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.7762, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0794, Accuracy: 59/486 (12.1399%)
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 217/486 (44.6502%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.5045, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0591, Accuracy: 296/1645 (17.9939%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 618/1645 (37.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9791, Accuracy: 116/10000 (1.1600%)
time spent on training: 157.21303153038025
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3147, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.5327, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.22362089157104 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0785, Accuracy: 22/312 (7.0513%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.5843, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0562, Accuracy: 294/1340 (21.9403%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 526/1340 (39.2537%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7683, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0627, Accuracy: 239/1131 (21.1317%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 488/1131 (43.1477%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.2827, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 297/896 (33.1473%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 456/896 (50.8929%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.5211, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0589, Accuracy: 269/1513 (17.7792%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 484/1513 (31.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.4284, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 417/1581 (26.3757%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 591/1581 (37.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7798, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0702, Accuracy: 101/631 (16.0063%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2106, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0704, Accuracy: 122/568 (21.4789%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0423, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9786, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0605, Accuracy: 263/708 (37.1469%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0404, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1255, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0838, Accuracy: 54/466 (11.5880%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.0002, Accuracy: 50/10000 (0.5000%)
time spent on training: 131.30715799331665
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3486, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.6073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.2146210670471 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0664, Accuracy: 176/938 (18.7633%)
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 336/938 (35.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.6541, Accuracy: 61/10000 (0.6100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7769, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0645, Accuracy: 246/1402 (17.5464%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 374/1402 (26.6762%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.2083, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0643, Accuracy: 210/605 (34.7107%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.2009, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 135/568 (23.7676%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0415, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.0570, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0792, Accuracy: 16/312 (5.1282%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.6674, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0816, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 56/186 (30.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3807, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0597, Accuracy: 279/690 (40.4348%)
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0290, Accuracy: 454/690 (65.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.5880, Accuracy: 66/10000 (0.6600%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0620, Accuracy: 174/861 (20.2091%)
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 436/861 (50.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2054, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0560, Accuracy: 331/1213 (27.2877%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 451/1213 (37.1805%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.8184, Accuracy: 82/10000 (0.8200%)
time spent on training: 155.85977268218994
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.4528, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.9309, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.3888957500458 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0606, Accuracy: 165/809 (20.3956%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 375/809 (46.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8808, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0659, Accuracy: 186/773 (24.0621%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0289, Accuracy: 402/773 (52.0052%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3639, Accuracy: 64/10000 (0.6400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 50/486 (10.2881%)
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.6382, Accuracy: 52/10000 (0.5200%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0537, Accuracy: 404/1129 (35.7839%)
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 721/1129 (63.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0156, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 36/426 (8.4507%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0405, Accuracy: 179/426 (42.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.1771, Accuracy: 54/10000 (0.5400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0591, Accuracy: 346/1657 (20.8811%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 507/1657 (30.5975%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9513, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0605, Accuracy: 219/888 (24.6622%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 437/888 (49.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.5913, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 283/1013 (27.9368%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 481/1013 (47.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.2104, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0620, Accuracy: 225/636 (35.3774%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0325, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.1404, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0601, Accuracy: 397/1750 (22.6857%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0362, Accuracy: 654/1750 (37.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6720, Accuracy: 116/10000 (1.1600%)
time spent on training: 183.6145989894867
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.7718, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 6.7866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 437.2946858406067 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0654, Accuracy: 214/1402 (15.2639%)
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 390/1402 (27.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.6060, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0631, Accuracy: 247/1241 (19.9033%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7803, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0555, Accuracy: 276/1013 (27.2458%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 440/1013 (43.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.1239, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 407/1581 (25.7432%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0346, Accuracy: 561/1581 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9980, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0775, Accuracy: 43/500 (8.6000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 184/500 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.3036, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0611, Accuracy: 218/888 (24.5495%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.5695, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 399/1742 (22.9047%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 694/1742 (39.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8903, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0839, Accuracy: 7/373 (1.8767%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0485, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9196, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0842, Accuracy: 25/338 (7.3964%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0481, Accuracy: 137/338 (40.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.0879, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0626, Accuracy: 179/861 (20.7898%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 441/861 (51.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.4126, Accuracy: 75/10000 (0.7500%)
time spent on training: 147.10598278045654
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1884, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 6.7082, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.90638518333435 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 297/1340 (22.1642%)
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 551/1340 (41.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3481, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0549, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 586/1581 (37.0651%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.8942, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0655, Accuracy: 235/708 (33.1921%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0431, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.6661, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0602, Accuracy: 271/928 (29.2026%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 575/928 (61.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0780, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 324/1418 (22.8491%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 611/1418 (43.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.8499, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 354/1427 (24.8073%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 594/1427 (41.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.3736, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 336/1130 (29.7345%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 497/1130 (43.9823%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.8237, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 380/1949 (19.4972%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 634/1949 (32.5295%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1986, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0669, Accuracy: 187/1013 (18.4600%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0369, Accuracy: 327/1013 (32.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.1824, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0680, Accuracy: 190/776 (24.4845%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0307, Accuracy: 359/776 (46.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.8768, Accuracy: 70/10000 (0.7000%)
time spent on training: 148.6845042705536
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.5432, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 7.2997, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.4410514831543 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0698, Accuracy: 174/669 (26.0090%)
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0420, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.3912, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 187/773 (24.1915%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0292, Accuracy: 384/773 (49.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7822, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0652, Accuracy: 228/1241 (18.3723%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.8126, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0655, Accuracy: 225/708 (31.7797%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0410, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.6240, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0414, Accuracy: 528/1552 (34.0206%)
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 738/1552 (47.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 10.6979, Accuracy: 72/10000 (0.7200%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1304, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.6494, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0625, Accuracy: 165/568 (29.0493%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.8645, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0587, Accuracy: 268/677 (39.5864%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 455/677 (67.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5279, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0665, Accuracy: 240/946 (25.3700%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 370/946 (39.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.4600, Accuracy: 70/10000 (0.7000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0524, Accuracy: 337/690 (48.8406%)
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.0199, Accuracy: 67/10000 (0.6700%)
time spent on training: 173.2341845035553
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5162, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 8.6990, Accuracy: 0/9950 (0.0000%)
saving model
Done in 425.7566556930542 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0644, Accuracy: 264/1190 (22.1849%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 454/1190 (38.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.1811, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0798, Accuracy: 97/530 (18.3019%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 279/530 (52.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.1268, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0797, Accuracy: 22/426 (5.1643%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 181/426 (42.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.6101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0623, Accuracy: 212/636 (33.3333%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.1578, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0541, Accuracy: 290/599 (48.4140%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.8283, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0993, Accuracy: 12/408 (2.9412%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0609, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.1502, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0682, Accuracy: 309/1163 (26.5692%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0381, Accuracy: 449/1163 (38.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.4319, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0846, Accuracy: 4/440 (0.9091%)
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0505, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.1553, Accuracy: 49/10000 (0.4900%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.9713, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0550, Accuracy: 307/891 (34.4557%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 452/891 (50.7295%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.9588, Accuracy: 60/10000 (0.6000%)
time spent on training: 163.20686221122742
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.3703, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 9.6735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.02728486061096 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0525, Accuracy: 379/1440 (26.3194%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 690/1440 (47.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.8759, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0544, Accuracy: 392/1715 (22.8571%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 637/1715 (37.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.3154, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0939, Accuracy: 2/271 (0.7380%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0608, Accuracy: 91/271 (33.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.0426, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0544, Accuracy: 305/891 (34.2312%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0269, Accuracy: 421/891 (47.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.8930, Accuracy: 62/10000 (0.6200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0526, Accuracy: 335/690 (48.5507%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.1412, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0682, Accuracy: 191/1013 (18.8549%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 361/1013 (35.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.6677, Accuracy: 61/10000 (0.6100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0408, Accuracy: 512/1552 (32.9897%)
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 768/1552 (49.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 11.1503, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0597, Accuracy: 303/1645 (18.4195%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 618/1645 (37.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.3076, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 228/735 (31.0204%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 373/735 (50.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.0790, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0547, Accuracy: 353/1574 (22.4269%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 631/1574 (40.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.8477, Accuracy: 97/10000 (0.9700%)
time spent on training: 172.9233844280243
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.8765, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 11.2954, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.19235157966614 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0679, Accuracy: 233/946 (24.6300%)
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0382, Accuracy: 339/946 (35.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.7266, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0568, Accuracy: 307/1662 (18.4717%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0342, Accuracy: 574/1662 (34.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.8350, Accuracy: 100/10000 (1.0000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0832, Accuracy: 32/486 (6.5844%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.0256, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0622, Accuracy: 222/1131 (19.6286%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 485/1131 (42.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7830, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0579, Accuracy: 321/1573 (20.4069%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 572/1573 (36.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7254, Accuracy: 79/10000 (0.7900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0608, Accuracy: 244/807 (30.2354%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 428/807 (53.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.4587, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 194/776 (25.0000%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 397/776 (51.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7918, Accuracy: 78/10000 (0.7800%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 4/85 (4.7059%)
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1196, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.0698, Accuracy: 41/10000 (0.4100%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0574, Accuracy: 323/1446 (22.3375%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 483/1446 (33.4025%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6385, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0547, Accuracy: 354/1574 (22.4905%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 655/1574 (41.6137%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.7418, Accuracy: 101/10000 (1.0100%)
time spent on training: 190.67690920829773
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 10.9008, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 11.5181, Accuracy: 0/9950 (0.0000%)
saving model
Done in 441.8096899986267 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0539, Accuracy: 286/1372 (20.8455%)
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0319, Accuracy: 493/1372 (35.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.9631, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0676, Accuracy: 254/896 (28.3482%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 454/896 (50.6696%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.0939, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0587, Accuracy: 341/1953 (17.4603%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0344, Accuracy: 704/1953 (36.0471%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3442, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0783, Accuracy: 87/530 (16.4151%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.2991, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0799, Accuracy: 25/426 (5.8685%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0428, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.9702, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0617, Accuracy: 212/1513 (14.0119%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 488/1513 (32.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4011, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0552, Accuracy: 378/1949 (19.3946%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 609/1949 (31.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.8212, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0514, Accuracy: 555/2227 (24.9214%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 944/2227 (42.3889%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 9.0952, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 47/186 (25.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.2195, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0538, Accuracy: 370/1581 (23.4029%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 590/1581 (37.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3291, Accuracy: 85/10000 (0.8500%)
time spent on training: 160.9861810207367
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 11.3447, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 11.8339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 412.3833951950073 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 185/500 (37.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.2633, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 281/1340 (20.9701%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 528/1340 (39.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.2097, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0878, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0497, Accuracy: 182/416 (43.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.9980, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0705, Accuracy: 153/938 (16.3113%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0345, Accuracy: 331/938 (35.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.3985, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0577, Accuracy: 312/1573 (19.8347%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 542/1573 (34.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1374, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0589, Accuracy: 357/1953 (18.2796%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 715/1953 (36.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1832, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0565, Accuracy: 317/1213 (26.1336%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 535/1213 (44.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.1505, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0666, Accuracy: 223/1241 (17.9694%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0373, Accuracy: 418/1241 (33.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0863, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0929, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0549, Accuracy: 131/373 (35.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.8180, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 3/85 (3.5294%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.5696, Accuracy: 50/10000 (0.5000%)
time spent on training: 162.6807246208191
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 11.8060, Accuracy: 41/10000 (0.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 14.1385, Accuracy: 0/9950 (0.0000%)
saving model
Done in 413.4545302391052 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 74/500 (14.8000%)
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 194/500 (38.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.9830, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 216/776 (27.8351%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 404/776 (52.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9770, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0936, Accuracy: 1/373 (0.2681%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0544, Accuracy: 112/373 (30.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.9840, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0559, Accuracy: 379/1715 (22.0991%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 686/1715 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9877, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0850, Accuracy: 47/460 (10.2174%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 171/460 (37.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.7227, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0619, Accuracy: 132/809 (16.3164%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 314/809 (38.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8384, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0467, Accuracy: 495/1470 (33.6735%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 832/1470 (56.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.1405, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0857, Accuracy: 44/416 (10.5769%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0507, Accuracy: 175/416 (42.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.1095, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0558, Accuracy: 379/1904 (19.9055%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0309, Accuracy: 693/1904 (36.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.4506, Accuracy: 101/10000 (1.0100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0540, Accuracy: 372/1129 (32.9495%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 712/1129 (63.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.9576, Accuracy: 111/10000 (1.1100%)
time spent on training: 166.24057269096375
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 11.1426, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 13.1697, Accuracy: 0/9950 (0.0000%)
saving model
Done in 418.1885826587677 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0528, Accuracy: 393/1581 (24.8577%)
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 589/1581 (37.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1468, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0574, Accuracy: 327/1446 (22.6141%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 499/1446 (34.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6564, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0597, Accuracy: 319/1953 (16.3338%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 693/1953 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.3059, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0821, Accuracy: 45/416 (10.8173%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0486, Accuracy: 185/416 (44.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.3140, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0568, Accuracy: 361/1742 (20.7233%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 702/1742 (40.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1293, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0559, Accuracy: 284/891 (31.8743%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 447/891 (50.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.4315, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0915, Accuracy: 6/466 (1.2876%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0503, Accuracy: 172/466 (36.9099%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.1866, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0638, Accuracy: 352/1750 (20.1143%)
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0360, Accuracy: 631/1750 (36.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9474, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0580, Accuracy: 304/1418 (21.4386%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 622/1418 (43.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.6462, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0593, Accuracy: 216/1013 (21.3228%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 524/1013 (51.7275%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.3668, Accuracy: 81/10000 (0.8100%)
time spent on training: 182.3586721420288
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 14.0501, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 16.1480, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.90943002700806 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0543, Accuracy: 286/1372 (20.8455%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 512/1372 (37.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.0051, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 331/1427 (23.1955%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 567/1427 (39.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9898, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0813, Accuracy: 56/515 (10.8738%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0529, Accuracy: 134/515 (26.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.0608, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0582, Accuracy: 273/1662 (16.4260%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0346, Accuracy: 557/1662 (33.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.9465, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0658, Accuracy: 213/1402 (15.1926%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 383/1402 (27.3181%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.6384, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0650, Accuracy: 214/776 (27.5773%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 387/776 (49.8711%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.1125, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0580, Accuracy: 231/1013 (22.8036%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0268, Accuracy: 493/1013 (48.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.6948, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0616, Accuracy: 373/1587 (23.5035%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0348, Accuracy: 605/1587 (38.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9550, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0535, Accuracy: 372/1956 (19.0184%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 641/1956 (32.7710%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.8202, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0673, Accuracy: 180/1049 (17.1592%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 495/1049 (47.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.4208, Accuracy: 105/10000 (1.0500%)
time spent on training: 164.93331670761108
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 13.7462, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 16.6512, Accuracy: 0/9950 (0.0000%)
saving model
Done in 413.8973705768585 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0640, Accuracy: 246/677 (36.3368%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0253, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.6531, Accuracy: 62/10000 (0.6200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 360/1628 (22.1130%)
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0274, Accuracy: 740/1628 (45.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.5761, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0857, Accuracy: 58/781 (7.4264%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0393, Accuracy: 199/781 (25.4802%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.0399, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1581 (22.0746%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 568/1581 (35.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.5225, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0654, Accuracy: 164/605 (27.1074%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0409, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.3908, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0560, Accuracy: 359/1275 (28.1569%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 657/1275 (51.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.7729, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0572, Accuracy: 414/1715 (24.1399%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 680/1715 (39.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.3544, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0525, Accuracy: 492/2227 (22.0925%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0293, Accuracy: 977/2227 (43.8707%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.8138, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 304/1003 (30.3091%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 398/1003 (39.6810%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.2428, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 357/1427 (25.0175%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0342, Accuracy: 585/1427 (40.9951%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.7583, Accuracy: 77/10000 (0.7700%)
time spent on training: 184.47351098060608
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 12.7741, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 18.5565, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.80955839157104 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0631, Accuracy: 188/1513 (12.4256%)
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 456/1513 (30.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.4540, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0640, Accuracy: 233/807 (28.8724%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0338, Accuracy: 401/807 (49.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4583, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 268/1372 (19.5335%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 521/1372 (37.9738%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.8504, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0582, Accuracy: 382/1949 (19.5998%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 622/1949 (31.9138%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.8920, Accuracy: 69/10000 (0.6900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0553, Accuracy: 345/1628 (21.1916%)
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0266, Accuracy: 776/1628 (47.6658%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.3396, Accuracy: 142/10000 (1.4200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0548, Accuracy: 298/690 (43.1884%)
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3880, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0850, Accuracy: 9/312 (2.8846%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0467, Accuracy: 154/312 (49.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.3855, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0674, Accuracy: 114/818 (13.9364%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0324, Accuracy: 330/818 (40.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.7289, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0598, Accuracy: 285/1645 (17.3252%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 599/1645 (36.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.6649, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0824, Accuracy: 76/530 (14.3396%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3018, Accuracy: 59/10000 (0.5900%)
time spent on training: 203.08378314971924
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 12.8358, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 16.6449, Accuracy: 0/9950 (0.0000%)
saving model
Done in 441.02787137031555 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0719, Accuracy: 244/896 (27.2321%)
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0366, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.3256, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0564, Accuracy: 301/1574 (19.1233%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 603/1574 (38.3100%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.2211, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0641, Accuracy: 241/1402 (17.1897%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 410/1402 (29.2439%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.9994, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0634, Accuracy: 172/1513 (11.3681%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0378, Accuracy: 444/1513 (29.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2826, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0921, Accuracy: 4/466 (0.8584%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0523, Accuracy: 179/466 (38.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.1622, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0574, Accuracy: 280/1089 (25.7117%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0297, Accuracy: 470/1089 (43.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.8858, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0595, Accuracy: 343/1953 (17.5627%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 700/1953 (35.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.3750, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0677, Accuracy: 83/568 (14.6127%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.0295, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0603, Accuracy: 290/1418 (20.4513%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0323, Accuracy: 602/1418 (42.4542%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2821, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0869, Accuracy: 15/338 (4.4379%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0492, Accuracy: 126/338 (37.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.4052, Accuracy: 49/10000 (0.4900%)
time spent on training: 172.86576008796692
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 14.4587, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 17.9948, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.0554869174957 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0620, Accuracy: 314/1657 (18.9499%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0359, Accuracy: 500/1657 (30.1750%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0325, Accuracy: 601/1657 (36.2704%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0318, Accuracy: 607/1657 (36.6325%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0311, Accuracy: 637/1657 (38.4430%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0313, Accuracy: 629/1657 (37.9602%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0304, Accuracy: 657/1657 (39.6500%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0297, Accuracy: 678/1657 (40.9173%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0292, Accuracy: 670/1657 (40.4345%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0295, Accuracy: 702/1657 (42.3657%), train_poison_data_count: 520
Global model norm: 187.38806033536395.
Norm before scaling: 187.33567799541015. Distance: 1.3357649128399307
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.1716, Accuracy: 57/10000 (0.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.8516, Accuracy: 8829/9950 (88.7337%)
Scaling by  100
Scaled Norm after poisoning: 225.4227885413318, distance: 133.5764864576659
Total norm for 3 adversaries is: 225.4227885413318. distance: 133.5764864576659
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0587, Accuracy: 387/1949 (19.8563%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 576/1949 (29.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.5267, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0836, Accuracy: 37/460 (8.0435%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 176/460 (38.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.4297, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 3/186 (1.6129%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 54/186 (29.0323%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7380, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0657, Accuracy: 254/677 (37.5185%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0280, Accuracy: 441/677 (65.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.9190, Accuracy: 59/10000 (0.5900%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0620, Accuracy: 340/1475 (23.0508%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 626/1475 (42.4407%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3205, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0670, Accuracy: 255/1131 (22.5464%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0335, Accuracy: 407/1131 (35.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.5303, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0538, Accuracy: 374/1129 (33.1267%)
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0265, Accuracy: 687/1129 (60.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.6016, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 271/1340 (20.2239%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 550/1340 (41.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.9135, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0605, Accuracy: 264/1446 (18.2573%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0365, Accuracy: 490/1446 (33.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9473, Accuracy: 66/10000 (0.6600%)
time spent on training: 329.71762204170227
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7298, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.9351, Accuracy: 30/9950 (0.3015%)
saving model
Done in 577.6465203762054 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0708, Accuracy: 231/1645 (14.0426%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 580/1645 (35.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.6080, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0781, Accuracy: 196/1446 (13.5546%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0376, Accuracy: 476/1446 (32.9184%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.0546, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0857, Accuracy: 171/803 (21.2951%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0420, Accuracy: 407/803 (50.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.4944, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0566, Accuracy: 424/1470 (28.8435%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 857/1470 (58.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.8520, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.1049, Accuracy: 7/603 (1.1609%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0488, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.5068, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0972, Accuracy: 50/605 (8.2645%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0508, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.8995, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0770, Accuracy: 267/1475 (18.1017%)
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0324, Accuracy: 635/1475 (43.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.7063, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0703, Accuracy: 254/1275 (19.9216%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0212, Accuracy: 613/1275 (48.0784%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 11.2009, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0662, Accuracy: 124/677 (18.3161%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.8547, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0817, Accuracy: 101/953 (10.5981%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 334/953 (35.0472%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.9146, Accuracy: 72/10000 (0.7200%)
time spent on training: 189.84989213943481
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.5933, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 2.1214, Accuracy: 30/9950 (0.3015%)
saving model
Done in 438.7254316806793 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0669, Accuracy: 238/807 (29.4919%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0376, Accuracy: 324/807 (40.1487%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0315, Accuracy: 333/807 (41.2639%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0286, Accuracy: 358/807 (44.3618%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0286, Accuracy: 362/807 (44.8575%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0260, Accuracy: 405/807 (50.1859%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0273, Accuracy: 396/807 (49.0706%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0258, Accuracy: 430/807 (53.2838%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0253, Accuracy: 436/807 (54.0273%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0256, Accuracy: 440/807 (54.5229%), train_poison_data_count: 260
Global model norm: 193.267190778078.
Norm before scaling: 193.24181337769525. Distance: 0.8893301736843691
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.3485, Accuracy: 61/10000 (0.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.5600, Accuracy: 9092/9950 (91.3769%)
Scaling by  100
Scaled Norm after poisoning: 210.2422338042478, distance: 88.93301991527106
Total norm for 3 adversaries is: 210.2422338042478. distance: 88.93301991527106
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0770, Accuracy: 150/712 (21.0674%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0321, Accuracy: 443/712 (62.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.1372, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0768, Accuracy: 120/888 (13.5135%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0278, Accuracy: 428/888 (48.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.9680, Accuracy: 72/10000 (0.7200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0751, Accuracy: 265/1750 (15.1429%)
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 582/1750 (33.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.9009, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0930, Accuracy: 49/605 (8.0992%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0476, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.7875, Accuracy: 64/10000 (0.6400%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0543, Accuracy: 396/1552 (25.5155%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 775/1552 (49.9356%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.6008, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0751, Accuracy: 199/1446 (13.7621%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0370, Accuracy: 506/1446 (34.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8107, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0888, Accuracy: 181/896 (20.2009%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0404, Accuracy: 423/896 (47.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.0263, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.1060, Accuracy: 12/781 (1.5365%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0398, Accuracy: 228/781 (29.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.2412, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0653, Accuracy: 324/1956 (16.5644%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 627/1956 (32.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.5277, Accuracy: 107/10000 (1.0700%)
time spent on training: 302.3305323123932
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.7418, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 2.0240, Accuracy: 0/9950 (0.0000%)
saving model
Done in 543.6950840950012 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0896, Accuracy: 121/776 (15.5928%)
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0351, Accuracy: 382/776 (49.2268%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.3490, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.1171, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0704, Accuracy: 53/311 (17.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.6161, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0811, Accuracy: 94/773 (12.1604%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 439/773 (56.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.4959, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0681, Accuracy: 249/1213 (20.5276%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 525/1213 (43.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.9132, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0671, Accuracy: 267/1574 (16.9632%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0295, Accuracy: 595/1574 (37.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.1920, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0924, Accuracy: 19/682 (2.7859%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.8764, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.1034, Accuracy: 17/781 (2.1767%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0380, Accuracy: 239/781 (30.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.0502, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0674, Accuracy: 248/1645 (15.0760%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 617/1645 (37.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.6643, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0585, Accuracy: 476/2227 (21.3740%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0289, Accuracy: 1008/2227 (45.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8710, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0688, Accuracy: 311/1953 (15.9242%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 722/1953 (36.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3616, Accuracy: 104/10000 (1.0400%)
time spent on training: 200.4278485774994
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.4408, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.8505, Accuracy: 30/9950 (0.3015%)
saving model
Done in 447.54909014701843 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0504, Accuracy: 446/1552 (28.7371%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0238, Accuracy: 682/1552 (43.9433%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0209, Accuracy: 782/1552 (50.3866%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0203, Accuracy: 838/1552 (53.9948%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0200, Accuracy: 865/1552 (55.7345%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0191, Accuracy: 896/1552 (57.7320%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0183, Accuracy: 899/1552 (57.9253%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0186, Accuracy: 945/1552 (60.8892%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0184, Accuracy: 936/1552 (60.3093%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0183, Accuracy: 933/1552 (60.1160%), train_poison_data_count: 496
Global model norm: 199.00278735485088.
Norm before scaling: 198.9486919566198. Distance: 1.3056427433895474
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 10.2138, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.4903, Accuracy: 8727/9950 (87.7085%)
Scaling by  100
Scaled Norm after poisoning: 233.07835491793313, distance: 130.5642726662811
Total norm for 3 adversaries is: 233.07835491793313. distance: 130.5642726662811
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.1003, Accuracy: 7/530 (1.3208%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0457, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.7203, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0942, Accuracy: 3/500 (0.6000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0522, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.8189, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0611, Accuracy: 164/813 (20.1722%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 478/813 (58.7946%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.4916, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0705, Accuracy: 126/735 (17.1429%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0239, Accuracy: 343/735 (46.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.3219, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0748, Accuracy: 107/953 (11.2277%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 296/953 (31.0598%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.4560, Accuracy: 61/10000 (0.6100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0777, Accuracy: 141/599 (23.5392%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0371, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 14.7075, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0682, Accuracy: 258/1036 (24.9035%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 671/1036 (64.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.3549, Accuracy: 69/10000 (0.6900%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0717, Accuracy: 270/1750 (15.4286%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0370, Accuracy: 617/1750 (35.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7521, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0796, Accuracy: 141/1131 (12.4668%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 480/1131 (42.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.6273, Accuracy: 111/10000 (1.1100%)
time spent on training: 320.17094230651855
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.8272, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 1.2269, Accuracy: 4508/9950 (45.3065%)
saving model
Done in 567.8913731575012 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0900, Accuracy: 187/1036 (18.0502%)
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 668/1036 (64.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 14.9859, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.1339, Accuracy: 3/781 (0.3841%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0420, Accuracy: 217/781 (27.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.1366, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.1574, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.1005, Accuracy: 0/311 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.2681, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.1021, Accuracy: 150/803 (18.6800%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0464, Accuracy: 412/803 (51.3076%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.5428, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0862, Accuracy: 203/1662 (12.2142%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0344, Accuracy: 573/1662 (34.4765%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.3677, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.1027, Accuracy: 186/1163 (15.9931%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 423/1163 (36.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8952, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.1033, Accuracy: 155/1131 (13.7047%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0354, Accuracy: 369/1131 (32.6260%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.1609, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.1352, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0537, Accuracy: 262/603 (43.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.7070, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0942, Accuracy: 177/1130 (15.6637%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0303, Accuracy: 476/1130 (42.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.4518, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0953, Accuracy: 156/1402 (11.1270%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 385/1402 (27.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.3385, Accuracy: 78/10000 (0.7800%)
time spent on training: 201.1673150062561
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.5582, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 2.4676, Accuracy: 0/9950 (0.0000%)
saving model
Done in 444.28325939178467 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0846, Accuracy: 143/599 (23.8731%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0315, Accuracy: 342/599 (57.0952%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0268, Accuracy: 372/599 (62.1035%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0273, Accuracy: 381/599 (63.6060%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0249, Accuracy: 403/599 (67.2788%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0248, Accuracy: 400/599 (66.7780%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0251, Accuracy: 417/599 (69.6160%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0249, Accuracy: 402/599 (67.1119%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0230, Accuracy: 418/599 (69.7830%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0230, Accuracy: 415/599 (69.2821%), train_poison_data_count: 200
Global model norm: 204.55922507308244.
Norm before scaling: 204.53857177498332. Distance: 0.8343279664574031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.2832, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.2219, Accuracy: 9314/9950 (93.6080%)
Scaling by  100
Scaled Norm after poisoning: 218.8401153667901, distance: 83.43279481115324
Total norm for 3 adversaries is: 218.8401153667901. distance: 83.43279481115324
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0927, Accuracy: 115/1049 (10.9628%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0316, Accuracy: 515/1049 (49.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.3223, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0795, Accuracy: 278/1742 (15.9587%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0330, Accuracy: 677/1742 (38.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.5278, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0758, Accuracy: 233/1275 (18.2745%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0186, Accuracy: 703/1275 (55.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.1370, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0649, Accuracy: 487/2227 (21.8680%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0288, Accuracy: 1009/2227 (45.3076%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.7381, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.1069, Accuracy: 51/773 (6.5977%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0377, Accuracy: 404/773 (52.2639%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.8466, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.1223, Accuracy: 46/460 (10.0000%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0470, Accuracy: 156/460 (33.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.9152, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0771, Accuracy: 273/1574 (17.3443%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 664/1574 (42.1855%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.4305, Accuracy: 127/10000 (1.2700%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.1360, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0676, Accuracy: 50/440 (11.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7234, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0761, Accuracy: 289/1475 (19.5932%)
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0333, Accuracy: 638/1475 (43.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.5812, Accuracy: 110/10000 (1.1000%)
time spent on training: 318.0459704399109
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.7825, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1903, Accuracy: 9419/9950 (94.6633%)
saving model
Done in 567.3391857147217 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0898, Accuracy: 128/1049 (12.2021%)
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 516/1049 (49.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.8995, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0804, Accuracy: 238/1036 (22.9730%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 687/1036 (66.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 13.0760, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0848, Accuracy: 184/1402 (13.1241%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0399, Accuracy: 384/1402 (27.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.5436, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.1514, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0681, Accuracy: 49/312 (15.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5995, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0922, Accuracy: 131/690 (18.9855%)
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0329, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.5343, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.1104, Accuracy: 26/682 (3.8123%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0409, Accuracy: 261/682 (38.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.2601, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0903, Accuracy: 180/803 (22.4159%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0390, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4603, Accuracy: 61/10000 (0.6100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0880, Accuracy: 196/1154 (16.9844%)
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0306, Accuracy: 419/1154 (36.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.4299, Accuracy: 71/10000 (0.7100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0625, Accuracy: 301/1657 (18.1654%)
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 560/1657 (33.7960%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.1812, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0820, Accuracy: 144/677 (21.2703%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 13.4085, Accuracy: 62/10000 (0.6200%)
time spent on training: 229.80855751037598
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 17.1730, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 0.1661, Accuracy: 9499/9950 (95.4673%)
saving model
Done in 472.722238779068 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Average loss: 0.0555, Accuracy: 451/1628 (27.7027%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Average loss: 0.0272, Accuracy: 755/1628 (46.3759%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Average loss: 0.0231, Accuracy: 899/1628 (55.2211%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Average loss: 0.0219, Accuracy: 949/1628 (58.2924%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Average loss: 0.0214, Accuracy: 992/1628 (60.9337%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Average loss: 0.0208, Accuracy: 999/1628 (61.3636%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Average loss: 0.0211, Accuracy: 991/1628 (60.8722%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Average loss: 0.0198, Accuracy: 1027/1628 (63.0835%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Average loss: 0.0195, Accuracy: 1037/1628 (63.6978%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Average loss: 0.0199, Accuracy: 1026/1628 (63.0221%), train_poison_data_count: 520
Global model norm: 209.99716329929316.
Norm before scaling: 209.93638359334. Distance: 1.3600969261102724
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.5999, Accuracy: 122/10000 (1.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.3210, Accuracy: 9297/9950 (93.4372%)
Scaling by  100
Scaled Norm after poisoning: 244.6627461936124, distance: 136.00969347348004
Total norm for 3 adversaries is: 244.6627461936124. distance: 136.00969347348004
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0757, Accuracy: 179/1513 (11.8308%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 481/1513 (31.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2164, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.1354, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0644, Accuracy: 65/373 (17.4263%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2033, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0844, Accuracy: 114/1013 (11.2537%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 363/1013 (35.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.2507, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0781, Accuracy: 270/1418 (19.0409%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0329, Accuracy: 558/1418 (39.3512%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.8740, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0852, Accuracy: 121/953 (12.6967%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0408, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3253, Accuracy: 67/10000 (0.6700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0394, Accuracy: 507/1552 (32.6675%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 798/1552 (51.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.5315, Accuracy: 85/10000 (0.8500%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.1200, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0552, Accuracy: 90/440 (20.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4423, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0881, Accuracy: 142/776 (18.2990%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0372, Accuracy: 374/776 (48.1959%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.6515, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1220, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0503, Accuracy: 158/416 (37.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2625, Accuracy: 77/10000 (0.7700%)
time spent on training: 326.4158091545105
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.2597, Accuracy: 114/10000 (1.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.4194, Accuracy: 8782/9950 (88.2613%)
saving model
Done in 572.9904971122742 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0869, Accuracy: 147/1241 (11.8453%)
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0384, Accuracy: 422/1241 (34.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5739, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0934, Accuracy: 90/590 (15.2542%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0366, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 14.0685, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.1201, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0609, Accuracy: 139/500 (27.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.7424, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0907, Accuracy: 159/803 (19.8007%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0420, Accuracy: 409/803 (50.9340%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.0013, Accuracy: 59/10000 (0.5900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0864, Accuracy: 161/1154 (13.9515%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 526/1154 (45.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.6986, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1977, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.1585, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6105, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.1040, Accuracy: 50/636 (7.8616%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0396, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.2281, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0710, Accuracy: 277/1581 (17.5206%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 602/1581 (38.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.3111, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0732, Accuracy: 261/928 (28.1250%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0272, Accuracy: 544/928 (58.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.2998, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0695, Accuracy: 293/1574 (18.6150%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 654/1574 (41.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.2036, Accuracy: 122/10000 (1.2200%)
time spent on training: 215.09674668312073
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.9787, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 1.0313, Accuracy: 6300/9950 (63.3166%)
saving model
Done in 468.5847134590149 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Average loss: 0.0710, Accuracy: 194/861 (22.5319%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Average loss: 0.0277, Accuracy: 351/861 (40.7666%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Average loss: 0.0221, Accuracy: 432/861 (50.1742%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Average loss: 0.0207, Accuracy: 459/861 (53.3101%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Average loss: 0.0195, Accuracy: 497/861 (57.7236%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Average loss: 0.0195, Accuracy: 518/861 (60.1626%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Average loss: 0.0190, Accuracy: 527/861 (61.2079%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Average loss: 0.0185, Accuracy: 525/861 (60.9756%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Average loss: 0.0179, Accuracy: 539/861 (62.6016%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Average loss: 0.0180, Accuracy: 546/861 (63.4146%), train_poison_data_count: 280
Global model norm: 215.2492922462232.
Norm before scaling: 215.21885663203398. Distance: 1.1136942314973381
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.5231, Accuracy: 83/10000 (0.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.4082, Accuracy: 8813/9950 (88.5729%)
Scaling by  100
Scaled Norm after poisoning: 239.37712140052147, distance: 111.36942326105492
Total norm for 4 adversaries is: 239.37712140052147. distance: 111.36942326105492
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1836, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.1513, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.9826, Accuracy: 102/10000 (1.0200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0263, Accuracy: 758/1628 (46.5602%)
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0204, Accuracy: 976/1628 (59.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.0894, Accuracy: 156/10000 (1.5600%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0705, Accuracy: 310/1988 (15.5936%)
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0375, Accuracy: 600/1988 (30.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.6079, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.1121, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0588, Accuracy: 142/500 (28.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.8919, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.1422, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0861, Accuracy: 2/271 (0.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7240, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0866, Accuracy: 136/1131 (12.0248%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 471/1131 (41.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.7437, Accuracy: 92/10000 (0.9200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0748, Accuracy: 267/1750 (15.2571%)
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0368, Accuracy: 634/1750 (36.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8607, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0675, Accuracy: 269/928 (28.9871%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0267, Accuracy: 532/928 (57.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.2939, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0826, Accuracy: 159/1241 (12.8122%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0383, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.3330, Accuracy: 65/10000 (0.6500%)
time spent on training: 325.45827889442444
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 12.6118, Accuracy: 81/10000 (0.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 1.3975, Accuracy: 4812/9950 (48.3618%)
saving model
Done in 572.4517714977264 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0881, Accuracy: 158/1241 (12.7317%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0392, Accuracy: 401/1241 (32.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.6580, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0829, Accuracy: 200/1446 (13.8313%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0363, Accuracy: 521/1446 (36.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2136, Accuracy: 70/10000 (0.7000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.2374, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.2157, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.3391, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.1106, Accuracy: 10/682 (1.4663%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0427, Accuracy: 254/682 (37.2434%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.2612, Accuracy: 70/10000 (0.7000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.1310, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0639, Accuracy: 64/440 (14.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2710, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.1604, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0789, Accuracy: 45/408 (11.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7680, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0768, Accuracy: 104/735 (14.1497%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0261, Accuracy: 365/735 (49.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 12.5167, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0813, Accuracy: 206/1130 (18.2301%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0311, Accuracy: 479/1130 (42.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.9457, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.1168, Accuracy: 73/715 (10.2098%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0513, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8722, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0741, Accuracy: 290/1988 (14.5875%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 620/1988 (31.1871%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2664, Accuracy: 80/10000 (0.8000%)
time spent on training: 240.5372142791748
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.5523, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 2.2756, Accuracy: 0/9950 (0.0000%)
saving model
Done in 484.9261302947998 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0740, Accuracy: 325/1154 (28.1629%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0296, Accuracy: 513/1154 (44.4541%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0230, Accuracy: 632/1154 (54.7660%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0235, Accuracy: 599/1154 (51.9064%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0231, Accuracy: 634/1154 (54.9393%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0223, Accuracy: 644/1154 (55.8059%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0221, Accuracy: 664/1154 (57.5390%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0205, Accuracy: 674/1154 (58.4055%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0211, Accuracy: 684/1154 (59.2721%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0213, Accuracy: 686/1154 (59.4454%), train_poison_data_count: 362
Global model norm: 220.4147989445128.
Norm before scaling: 220.36928346244176. Distance: 1.3849067992653394
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.5791, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.2326, Accuracy: 9415/9950 (94.6231%)
Scaling by  100
Scaled Norm after poisoning: 256.0551545810004, distance: 138.4906782738463
Total norm for 2 adversaries is: 256.0551545810004. distance: 138.4906782738463
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0971, Accuracy: 55/773 (7.1151%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0357, Accuracy: 393/773 (50.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 12.0926, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0888, Accuracy: 103/712 (14.4663%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0321, Accuracy: 434/712 (60.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.3226, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0694, Accuracy: 110/735 (14.9660%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0268, Accuracy: 331/735 (45.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 12.7073, Accuracy: 62/10000 (0.6200%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0221, Accuracy: 452/861 (52.4971%)
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0171, Accuracy: 559/861 (64.9245%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.7203, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0735, Accuracy: 264/1662 (15.8845%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0349, Accuracy: 526/1662 (31.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.7409, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0835, Accuracy: 230/1418 (16.2200%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 599/1418 (42.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.9491, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0866, Accuracy: 148/803 (18.4309%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0388, Accuracy: 440/803 (54.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.7202, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.1079, Accuracy: 62/708 (8.7571%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0422, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.2707, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0725, Accuracy: 280/1742 (16.0735%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 655/1742 (37.6005%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.4543, Accuracy: 87/10000 (0.8700%)
time spent on training: 332.3073010444641
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.3427, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 2.2090, Accuracy: 0/9950 (0.0000%)
saving model
Done in 580.6401045322418 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1202, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0600, Accuracy: 133/500 (26.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9162, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0913, Accuracy: 147/1154 (12.7383%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0284, Accuracy: 430/1154 (37.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 11.3953, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0743, Accuracy: 241/1030 (23.3981%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0281, Accuracy: 542/1030 (52.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.2138, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.1396, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0628, Accuracy: 70/426 (16.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2606, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0981, Accuracy: 123/946 (13.0021%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0417, Accuracy: 366/946 (38.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6817, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0835, Accuracy: 184/1213 (15.1690%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0294, Accuracy: 487/1213 (40.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.9279, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0834, Accuracy: 184/1130 (16.2832%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0298, Accuracy: 495/1130 (43.8053%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.4567, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.1040, Accuracy: 24/818 (2.9340%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0352, Accuracy: 317/818 (38.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.2359, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0826, Accuracy: 229/1402 (16.3338%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 376/1402 (26.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.9131, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0965, Accuracy: 79/1013 (7.7986%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0379, Accuracy: 352/1013 (34.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.3126, Accuracy: 72/10000 (0.7200%)
time spent on training: 183.82060718536377
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.9850, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 2.0336, Accuracy: 0/9950 (0.0000%)
saving model
Done in 427.3361313343048 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Average loss: 0.0701, Accuracy: 177/690 (25.6522%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Average loss: 0.0310, Accuracy: 380/690 (55.0725%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Average loss: 0.0219, Accuracy: 393/690 (56.9565%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Average loss: 0.0205, Accuracy: 432/690 (62.6087%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Average loss: 0.0186, Accuracy: 462/690 (66.9565%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Average loss: 0.0187, Accuracy: 475/690 (68.8406%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Average loss: 0.0185, Accuracy: 455/690 (65.9420%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Average loss: 0.0174, Accuracy: 477/690 (69.1304%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Average loss: 0.0176, Accuracy: 466/690 (67.5362%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Average loss: 0.0167, Accuracy: 503/690 (72.8986%), train_poison_data_count: 220
Global model norm: 225.41241716573646.
Norm before scaling: 225.38818943658072. Distance: 0.8870182959810301
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.8535, Accuracy: 72/10000 (0.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.2649, Accuracy: 8920/9950 (89.6482%)
Scaling by  100
Scaled Norm after poisoning: 239.80933995833024, distance: 88.70182451266152
Total norm for 1 adversaries is: 239.80933995833024. distance: 88.70182451266152
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0755, Accuracy: 172/1089 (15.7943%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 509/1089 (46.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.7204, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0926, Accuracy: 168/1190 (14.1176%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 440/1190 (36.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.7133, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0711, Accuracy: 244/1574 (15.5019%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 626/1574 (39.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.7547, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0739, Accuracy: 263/1440 (18.2639%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0288, Accuracy: 714/1440 (49.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.5066, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0866, Accuracy: 173/803 (21.5442%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0406, Accuracy: 426/803 (53.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.0691, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.1496, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0780, Accuracy: 38/408 (9.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.3648, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0769, Accuracy: 146/677 (21.5657%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0257, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 12.4035, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.1286, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0598, Accuracy: 78/426 (18.3099%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1903, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0794, Accuracy: 247/1418 (17.4189%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0337, Accuracy: 613/1418 (43.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.8055, Accuracy: 87/10000 (0.8700%)
time spent on training: 306.3972063064575
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.0192, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 2.1696, Accuracy: 0/9950 (0.0000%)
saving model
Done in 547.2461667060852 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0795, Accuracy: 126/1013 (12.4383%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0374, Accuracy: 366/1013 (36.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.9662, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.1052, Accuracy: 37/605 (6.1157%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0484, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.3132, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1840, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.1431, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1485, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0819, Accuracy: 179/803 (22.2914%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0381, Accuracy: 435/803 (54.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.2639, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0914, Accuracy: 185/1190 (15.5462%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 438/1190 (36.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.5701, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0688, Accuracy: 289/1573 (18.3725%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0355, Accuracy: 575/1573 (36.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4261, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.1024, Accuracy: 91/708 (12.8531%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0390, Accuracy: 425/708 (60.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.1932, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0994, Accuracy: 32/809 (3.9555%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0310, Accuracy: 285/809 (35.2287%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.1117, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0777, Accuracy: 179/1513 (11.8308%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/1513 (28.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.7511, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0811, Accuracy: 162/1241 (13.0540%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0410, Accuracy: 342/1241 (27.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.2992, Accuracy: 51/10000 (0.5100%)
time spent on training: 251.02040433883667
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.5984, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 0.4652, Accuracy: 7879/9950 (79.1859%)
saving model
Done in 496.7700319290161 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Average loss: 0.0900, Accuracy: 116/486 (23.8683%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Average loss: 0.0499, Accuracy: 164/486 (33.7449%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Average loss: 0.0359, Accuracy: 183/486 (37.6543%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Average loss: 0.0328, Accuracy: 208/486 (42.7984%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Average loss: 0.0338, Accuracy: 206/486 (42.3868%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Average loss: 0.0313, Accuracy: 233/486 (47.9424%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Average loss: 0.0311, Accuracy: 241/486 (49.5885%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Average loss: 0.0302, Accuracy: 231/486 (47.5309%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Average loss: 0.0295, Accuracy: 261/486 (53.7037%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Average loss: 0.0280, Accuracy: 264/486 (54.3210%), train_poison_data_count: 160
Global model norm: 230.31961488331817.
Norm before scaling: 230.30324777887958. Distance: 0.7723000765242163
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.4301, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.2018, Accuracy: 9467/9950 (95.1457%)
Scaling by  100
Scaled Norm after poisoning: 241.24211450843322, distance: 77.23001106678025
Total norm for 2 adversaries is: 241.24211450843322. distance: 77.23001106678025
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0870, Accuracy: 95/636 (14.9371%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0342, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 11.1568, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0697, Accuracy: 164/677 (24.2245%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 12.2357, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0831, Accuracy: 109/1049 (10.3908%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 494/1049 (47.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.2004, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0913, Accuracy: 43/568 (7.5704%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0465, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.9260, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0660, Accuracy: 286/1573 (18.1818%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 588/1573 (37.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.4727, Accuracy: 87/10000 (0.8700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0507, Accuracy: 290/1154 (25.1300%)
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0271, Accuracy: 481/1154 (41.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.2453, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0663, Accuracy: 348/1953 (17.8187%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 787/1953 (40.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.2765, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0738, Accuracy: 266/1645 (16.1702%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 625/1645 (37.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.2631, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0691, Accuracy: 163/1013 (16.0908%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0276, Accuracy: 476/1013 (46.9891%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.4390, Accuracy: 75/10000 (0.7500%)
time spent on training: 326.63776779174805
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1237, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.3282, Accuracy: 8920/9950 (89.6482%)
saving model
Done in 566.8618853092194 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0730, Accuracy: 251/1418 (17.7010%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 585/1418 (41.2553%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.7382, Accuracy: 93/10000 (0.9300%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0761, Accuracy: 240/1129 (21.2578%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0279, Accuracy: 637/1129 (56.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.6091, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0834, Accuracy: 59/568 (10.3873%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0459, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.9675, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0670, Accuracy: 295/1440 (20.4861%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0286, Accuracy: 690/1440 (47.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.7241, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0662, Accuracy: 219/1030 (21.2621%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0279, Accuracy: 536/1030 (52.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 11.2833, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.1058, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0402, Accuracy: 165/460 (35.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.3756, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.1192, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0962, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.7005, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0695, Accuracy: 195/928 (21.0129%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 592/928 (63.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.7436, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0613, Accuracy: 106/373 (28.4182%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0398, Accuracy: 160/373 (42.8954%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.3409, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0741, Accuracy: 241/901 (26.7481%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0350, Accuracy: 410/901 (45.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.0851, Accuracy: 57/10000 (0.5700%)
time spent on training: 205.13793754577637
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 12.6219, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 0.5912, Accuracy: 7738/9950 (77.7688%)
saving model
Done in 449.6166396141052 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Average loss: 0.0641, Accuracy: 329/1129 (29.1408%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Average loss: 0.0294, Accuracy: 511/1129 (45.2613%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Average loss: 0.0244, Accuracy: 617/1129 (54.6501%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Average loss: 0.0236, Accuracy: 618/1129 (54.7387%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Average loss: 0.0219, Accuracy: 658/1129 (58.2817%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Average loss: 0.0214, Accuracy: 651/1129 (57.6616%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Average loss: 0.0214, Accuracy: 660/1129 (58.4588%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Average loss: 0.0215, Accuracy: 652/1129 (57.7502%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Average loss: 0.0201, Accuracy: 671/1129 (59.4331%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Average loss: 0.0204, Accuracy: 696/1129 (61.6475%), train_poison_data_count: 360
Global model norm: 235.16060834831586.
Norm before scaling: 235.11574609647053. Distance: 1.1442004562263666
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3651, Accuracy: 84/10000 (0.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.2370, Accuracy: 9155/9950 (92.0101%)
Scaling by  100
Scaled Norm after poisoning: 257.2001591659694, distance: 114.42003467897351
Total norm for 2 adversaries is: 257.2001591659694. distance: 114.42003467897351
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0647, Accuracy: 346/1904 (18.1723%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 735/1904 (38.6029%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3980, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0859, Accuracy: 63/809 (7.7874%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0307, Accuracy: 300/809 (37.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.9537, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0716, Accuracy: 250/1418 (17.6305%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 571/1418 (40.2680%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.4251, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0812, Accuracy: 213/1003 (21.2363%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0395, Accuracy: 368/1003 (36.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.1867, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0626, Accuracy: 276/1573 (17.5461%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 599/1573 (38.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.0347, Accuracy: 85/10000 (0.8500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0473, Accuracy: 414/1552 (26.6753%)
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 791/1552 (50.9665%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.6146, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0683, Accuracy: 164/1049 (15.6339%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 518/1049 (49.3804%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.3749, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0598, Accuracy: 279/1275 (21.8824%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0210, Accuracy: 647/1275 (50.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.1128, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0642, Accuracy: 337/1949 (17.2909%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0345, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.8128, Accuracy: 86/10000 (0.8600%)
time spent on training: 382.3334639072418
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.1741, Accuracy: 80/10000 (0.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.5234, Accuracy: 7715/9950 (77.5377%)
saving model
Done in 627.3323013782501 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0737, Accuracy: 102/735 (13.8776%)
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0276, Accuracy: 308/735 (41.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 11.6677, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0786, Accuracy: 231/1418 (16.2906%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0341, Accuracy: 576/1418 (40.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8377, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0937, Accuracy: 73/636 (11.4780%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0357, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 11.2506, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0874, Accuracy: 135/1131 (11.9363%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0325, Accuracy: 511/1131 (45.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.1568, Accuracy: 101/10000 (1.0100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0651, Accuracy: 242/1154 (20.9705%)
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 501/1154 (43.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 10.3940, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.1226, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0563, Accuracy: 122/416 (29.3269%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8895, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0672, Accuracy: 356/1953 (18.2284%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 765/1953 (39.1705%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.1821, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0843, Accuracy: 219/1190 (18.4034%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0338, Accuracy: 465/1190 (39.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.4562, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.1366, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0634, Accuracy: 46/338 (13.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.2806, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0724, Accuracy: 276/1715 (16.0933%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 659/1715 (38.4257%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8968, Accuracy: 90/10000 (0.9000%)
time spent on training: 257.7665319442749
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.5780, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 2.3803, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 501.2635362148285 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Average loss: 0.0642, Accuracy: 528/1750 (30.1714%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Average loss: 0.0331, Accuracy: 826/1750 (47.2000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Average loss: 0.0281, Accuracy: 916/1750 (52.3429%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Average loss: 0.0277, Accuracy: 932/1750 (53.2571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Average loss: 0.0268, Accuracy: 937/1750 (53.5429%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Average loss: 0.0270, Accuracy: 932/1750 (53.2571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Average loss: 0.0256, Accuracy: 976/1750 (55.7714%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Average loss: 0.0255, Accuracy: 974/1750 (55.6571%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Average loss: 0.0252, Accuracy: 1006/1750 (57.4857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Average loss: 0.0253, Accuracy: 999/1750 (57.0857%), train_poison_data_count: 560
Global model norm: 239.84900849284327.
Norm before scaling: 239.77160356264042. Distance: 1.4474986271036387
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5336, Accuracy: 106/10000 (1.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.1828, Accuracy: 9588/9950 (96.3618%)
Scaling by  100
Scaled Norm after poisoning: 273.05403826440653, distance: 144.74986506902175
Total norm for 1 adversaries is: 273.05403826440653. distance: 144.74986506902175
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.1307, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0821, Accuracy: 22/311 (7.0740%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.7130, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0783, Accuracy: 214/1402 (15.2639%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 392/1402 (27.9601%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.0943, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0968, Accuracy: 52/605 (8.5950%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0476, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.5316, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.1123, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0533, Accuracy: 155/466 (33.2618%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.2755, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.1121, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0550, Accuracy: 74/373 (19.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.7876, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0882, Accuracy: 90/636 (14.1509%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0364, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.9362, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0694, Accuracy: 235/1340 (17.5373%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0291, Accuracy: 575/1340 (42.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.3420, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0925, Accuracy: 81/773 (10.4787%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0331, Accuracy: 374/773 (48.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 11.1006, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0705, Accuracy: 277/1440 (19.2361%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 705/1440 (48.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.7131, Accuracy: 77/10000 (0.7700%)
time spent on training: 335.9420666694641
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.7996, Accuracy: 82/10000 (0.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.4988, Accuracy: 8659/9950 (87.0251%)
saving model
Saving model on epoch 41
Done in 578.3221578598022 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0585, Accuracy: 283/1628 (17.3833%)
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 817/1628 (50.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.0851, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0973, Accuracy: 46/669 (6.8759%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0455, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5180, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0663, Accuracy: 130/603 (21.5589%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 264/603 (43.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.0057, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0699, Accuracy: 140/813 (17.2202%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 453/813 (55.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 14.3308, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.1379, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0808, Accuracy: 20/312 (6.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.9618, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0629, Accuracy: 482/2227 (21.6435%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 992/2227 (44.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.9021, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0731, Accuracy: 230/1036 (22.2008%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0276, Accuracy: 617/1036 (59.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 12.9426, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0888, Accuracy: 207/901 (22.9745%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0376, Accuracy: 393/901 (43.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2987, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0808, Accuracy: 111/1049 (10.5815%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0314, Accuracy: 495/1049 (47.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1180, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1667, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.1378, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.8915, Accuracy: 94/10000 (0.9400%)
time spent on training: 235.18926811218262
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.5406, Accuracy: 66/10000 (0.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 0.8803, Accuracy: 6930/9950 (69.6482%)
saving model
Saving model on epoch 42
Done in 483.0585107803345 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Average loss: 0.0799, Accuracy: 90/440 (20.4545%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Average loss: 0.0547, Accuracy: 146/440 (33.1818%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Average loss: 0.0384, Accuracy: 202/440 (45.9091%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Average loss: 0.0376, Accuracy: 193/440 (43.8636%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Average loss: 0.0356, Accuracy: 192/440 (43.6364%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Average loss: 0.0363, Accuracy: 200/440 (45.4545%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Average loss: 0.0329, Accuracy: 212/440 (48.1818%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Average loss: 0.0336, Accuracy: 222/440 (50.4545%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Average loss: 0.0313, Accuracy: 217/440 (49.3182%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Average loss: 0.0311, Accuracy: 211/440 (47.9545%), train_poison_data_count: 140
Global model norm: 244.43944163125556.
Norm before scaling: 244.42516269044395. Distance: 0.6618777970064912
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.1197, Accuracy: 73/10000 (0.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.1927, Accuracy: 9539/9950 (95.8693%)
Scaling by  100
Scaled Norm after poisoning: 251.77376222265497, distance: 66.18777664602241
Total norm for 3 adversaries is: 251.77376222265497. distance: 66.18777664602241
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0905, Accuracy: 50/818 (6.1125%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0339, Accuracy: 359/818 (43.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.4801, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0831, Accuracy: 120/1131 (10.6101%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0322, Accuracy: 518/1131 (45.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.5711, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0638, Accuracy: 157/813 (19.3112%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0198, Accuracy: 450/813 (55.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 14.1862, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0974, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0431, Accuracy: 201/486 (41.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.1919, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.1079, Accuracy: 15/530 (2.8302%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0477, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.7519, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0947, Accuracy: 53/669 (7.9223%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0460, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.8079, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0664, Accuracy: 263/1573 (16.7196%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0357, Accuracy: 578/1573 (36.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1148, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.1198, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0794, Accuracy: 42/271 (15.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.3416, Accuracy: 51/10000 (0.5100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0576, Accuracy: 288/1628 (17.6904%)
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 802/1628 (49.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.2923, Accuracy: 133/10000 (1.3300%)
time spent on training: 314.98014664649963
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.5108, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.1314, Accuracy: 9724/9950 (97.7286%)
saving model
Done in 561.1635890007019 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0697, Accuracy: 196/1030 (19.0291%)
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0275, Accuracy: 586/1030 (56.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.8515, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.1148, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0766, Accuracy: 42/271 (15.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.0436, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0755, Accuracy: 210/896 (23.4375%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0391, Accuracy: 423/896 (47.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9096, Accuracy: 61/10000 (0.6100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0562, Accuracy: 328/1129 (29.0523%)
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0228, Accuracy: 737/1129 (65.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.7967, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0798, Accuracy: 238/901 (26.4151%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0371, Accuracy: 368/901 (40.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.4044, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0716, Accuracy: 129/861 (14.9826%)
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 462/861 (53.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 11.5545, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1414, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1300, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.9287, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.1215, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0643, Accuracy: 71/408 (17.4020%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.2439, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 48/312 (15.3846%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0517, Accuracy: 152/312 (48.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.3711, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1748, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1622, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.8880, Accuracy: 67/10000 (0.6700%)
time spent on training: 221.64688301086426
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9581, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.1289, Accuracy: 9728/9950 (97.7688%)
saving model
Done in 468.81957030296326 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Average loss: 0.0609, Accuracy: 321/1071 (29.9720%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Average loss: 0.0302, Accuracy: 447/1071 (41.7367%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Average loss: 0.0251, Accuracy: 536/1071 (50.0467%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Average loss: 0.0243, Accuracy: 590/1071 (55.0887%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Average loss: 0.0237, Accuracy: 584/1071 (54.5285%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Average loss: 0.0230, Accuracy: 594/1071 (55.4622%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Average loss: 0.0225, Accuracy: 615/1071 (57.4230%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Average loss: 0.0218, Accuracy: 615/1071 (57.4230%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Average loss: 0.0216, Accuracy: 617/1071 (57.6097%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Average loss: 0.0213, Accuracy: 647/1071 (60.4108%), train_poison_data_count: 340
Global model norm: 248.98602182150708.
Norm before scaling: 248.94196424568517. Distance: 1.0825536685528534
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.6686, Accuracy: 83/10000 (0.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.1796, Accuracy: 9353/9950 (94.0000%)
Scaling by  100
Scaled Norm after poisoning: 267.214026461, distance: 108.25536757766332
Total norm for 2 adversaries is: 267.214026461. distance: 108.25536757766332
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0722, Accuracy: 121/568 (21.3028%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0456, Accuracy: 262/568 (46.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.2440, Accuracy: 49/10000 (0.4900%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0925, Accuracy: 3/486 (0.6173%)
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0446, Accuracy: 208/486 (42.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.8507, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0762, Accuracy: 240/901 (26.6371%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0363, Accuracy: 403/901 (44.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.2419, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0968, Accuracy: 33/530 (6.2264%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0480, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.7000, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0765, Accuracy: 137/1131 (12.1132%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0327, Accuracy: 485/1131 (42.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.1462, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0952, Accuracy: 4/466 (0.8584%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0507, Accuracy: 175/466 (37.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.6969, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0759, Accuracy: 146/590 (24.7458%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0362, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 12.6123, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0705, Accuracy: 181/1372 (13.1924%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0335, Accuracy: 493/1372 (35.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.4359, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0743, Accuracy: 257/1163 (22.0980%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0401, Accuracy: 462/1163 (39.7248%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8309, Accuracy: 62/10000 (0.6200%)
time spent on training: 337.1911211013794
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 10.8468, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.2093, Accuracy: 9208/9950 (92.5427%)
saving model
Done in 584.3034501075745 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0844, Accuracy: 255/1427 (17.8697%)
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0362, Accuracy: 551/1427 (38.6125%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0130, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0817, Accuracy: 216/1662 (12.9964%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0357, Accuracy: 540/1662 (32.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5295, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0796, Accuracy: 97/735 (13.1973%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0260, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 12.6828, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.1108, Accuracy: 15/605 (2.4793%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0491, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.8761, Accuracy: 57/10000 (0.5700%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.1196, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0475, Accuracy: 173/486 (35.5967%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.8815, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.1374, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0638, Accuracy: 105/426 (24.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.4846, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0747, Accuracy: 250/1574 (15.8831%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 628/1574 (39.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.3103, Accuracy: 103/10000 (1.0300%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.2140, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1955, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.0093, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0886, Accuracy: 131/938 (13.9659%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0379, Accuracy: 322/938 (34.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.9308, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0925, Accuracy: 177/896 (19.7545%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0401, Accuracy: 461/896 (51.4509%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.1423, Accuracy: 67/10000 (0.6700%)
time spent on training: 239.78779673576355
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 14.7011, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.7065, Accuracy: 7847/9950 (78.8643%)
saving model
Done in 481.45997858047485 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Average loss: 0.0969, Accuracy: 11/85 (12.9412%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Average loss: 0.0902, Accuracy: 20/85 (23.5294%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Average loss: 0.0796, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Average loss: 0.0800, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Average loss: 0.0753, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Average loss: 0.0767, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Average loss: 0.0773, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Average loss: 0.0748, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Average loss: 0.0746, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Average loss: 0.0745, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Global model norm: 253.44584604013536.
Norm before scaling: 253.4434493752995. Distance: 0.16110161566008505
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.7624, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0316, Accuracy: 9933/9950 (99.8291%)
Scaling by  100
Scaled Norm after poisoning: 253.71064195998952, distance: 16.1101611562538
Total norm for 4 adversaries is: 253.71064195998952. distance: 16.1101611562538
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0935, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0456, Accuracy: 108/440 (24.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0707, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0986, Accuracy: 59/953 (6.1910%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0426, Accuracy: 319/953 (33.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.4650, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0698, Accuracy: 247/1036 (23.8417%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 655/1036 (63.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 13.5196, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0876, Accuracy: 62/603 (10.2819%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0503, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.6503, Accuracy: 53/10000 (0.5300%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0572, Accuracy: 362/1750 (20.6857%)
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0334, Accuracy: 702/1750 (40.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.3234, Accuracy: 123/10000 (1.2300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0625, Accuracy: 258/1628 (15.8477%)
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 778/1628 (47.7887%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 10.0970, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0742, Accuracy: 296/1904 (15.5462%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 712/1904 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.2975, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0882, Accuracy: 178/1089 (16.3453%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 458/1089 (42.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 11.1798, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0882, Accuracy: 87/1013 (8.5884%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 367/1013 (36.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.8895, Accuracy: 77/10000 (0.7700%)
time spent on training: 370.91808462142944
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.9571, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0202, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 610.783931016922 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0711, Accuracy: 290/1949 (14.8794%)
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0347, Accuracy: 611/1949 (31.3494%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.0186, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0924, Accuracy: 45/416 (10.8173%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0506, Accuracy: 149/416 (35.8173%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.1321, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0758, Accuracy: 145/677 (21.4180%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0249, Accuracy: 470/677 (69.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 12.3064, Accuracy: 59/10000 (0.5900%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0659, Accuracy: 326/1988 (16.3984%)
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0372, Accuracy: 591/1988 (29.7284%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2595, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0829, Accuracy: 183/1190 (15.3782%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.4233, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0819, Accuracy: 117/1131 (10.3448%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0330, Accuracy: 489/1131 (43.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.7816, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0830, Accuracy: 80/603 (13.2670%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0491, Accuracy: 272/603 (45.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.3336, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.1286, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0489, Accuracy: 119/460 (25.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.0483, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0725, Accuracy: 224/1213 (18.4666%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0298, Accuracy: 507/1213 (41.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.7904, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0791, Accuracy: 183/1402 (13.0528%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 399/1402 (28.4593%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0648, Accuracy: 71/10000 (0.7100%)
time spent on training: 295.06783628463745
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 11.1026, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.0077, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 537.9031317234039 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Average loss: 0.0622, Accuracy: 462/1475 (31.3220%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Average loss: 0.0313, Accuracy: 628/1475 (42.5763%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Average loss: 0.0273, Accuracy: 722/1475 (48.9492%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Average loss: 0.0271, Accuracy: 741/1475 (50.2373%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Average loss: 0.0264, Accuracy: 789/1475 (53.4915%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Average loss: 0.0251, Accuracy: 786/1475 (53.2881%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Average loss: 0.0250, Accuracy: 778/1475 (52.7458%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Average loss: 0.0247, Accuracy: 814/1475 (55.1864%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Average loss: 0.0235, Accuracy: 814/1475 (55.1864%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Average loss: 0.0245, Accuracy: 802/1475 (54.3729%), train_poison_data_count: 463
Global model norm: 257.85298924484084.
Norm before scaling: 257.78394538838137. Distance: 1.3317191913464808
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3692, Accuracy: 73/10000 (0.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.2982, Accuracy: 9209/9950 (92.5528%)
Scaling by  100
Scaled Norm after poisoning: 283.69908684202704, distance: 133.17191074885125
Total norm for 2 adversaries is: 283.69908684202704. distance: 133.17191074885125
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0967, Accuracy: 96/708 (13.5593%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0386, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3620, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0763, Accuracy: 86/809 (10.6304%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0317, Accuracy: 315/809 (38.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.2373, Accuracy: 78/10000 (0.7800%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0581, Accuracy: 277/1628 (17.0147%)
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 723/1628 (44.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.7304, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0690, Accuracy: 233/1213 (19.2086%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 514/1213 (42.3743%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.4175, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0784, Accuracy: 215/901 (23.8624%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0376, Accuracy: 409/901 (45.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8667, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0711, Accuracy: 239/1645 (14.5289%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0341, Accuracy: 614/1645 (37.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8085, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0874, Accuracy: 122/715 (17.0629%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0455, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.7901, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0801, Accuracy: 218/1003 (21.7348%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0386, Accuracy: 373/1003 (37.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3606, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0718, Accuracy: 145/1241 (11.6841%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0389, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.6100, Accuracy: 59/10000 (0.5900%)
time spent on training: 373.4277331829071
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.1017, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.8037, Accuracy: 7263/9950 (72.9950%)
saving model
Done in 615.2893426418304 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0656, Accuracy: 275/1750 (15.7143%)
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 683/1750 (39.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2461, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0756, Accuracy: 318/1904 (16.7017%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 720/1904 (37.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3914, Accuracy: 130/10000 (1.3000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0701, Accuracy: 308/1988 (15.4930%)
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0375, Accuracy: 636/1988 (31.9920%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.5068, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1096, Accuracy: 23/605 (3.8017%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0506, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.0053, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.1309, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0700, Accuracy: 89/408 (21.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3126, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.1137, Accuracy: 3/631 (0.4754%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0516, Accuracy: 210/631 (33.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.7764, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.1191, Accuracy: 2/373 (0.5362%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0621, Accuracy: 64/373 (17.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.8698, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0687, Accuracy: 184/1071 (17.1802%)
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 530/1071 (49.4865%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.4488, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0672, Accuracy: 320/1470 (21.7687%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 815/1470 (55.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.9568, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0946, Accuracy: 59/774 (7.6227%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0413, Accuracy: 329/774 (42.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.6275, Accuracy: 70/10000 (0.7000%)
time spent on training: 306.1269974708557
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 13.3718, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 2.0082, Accuracy: 3508/9950 (35.2563%)
saving model
Saving model on epoch 50
Done in 546.2698907852173 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Average loss: 0.0600, Accuracy: 505/1988 (25.4024%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Average loss: 0.0347, Accuracy: 757/1988 (38.0785%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Average loss: 0.0311, Accuracy: 839/1988 (42.2032%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Average loss: 0.0294, Accuracy: 874/1988 (43.9638%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Average loss: 0.0295, Accuracy: 882/1988 (44.3662%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Average loss: 0.0289, Accuracy: 922/1988 (46.3783%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Average loss: 0.0287, Accuracy: 921/1988 (46.3280%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Average loss: 0.0288, Accuracy: 906/1988 (45.5734%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Average loss: 0.0285, Accuracy: 925/1988 (46.5292%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Average loss: 0.0279, Accuracy: 940/1988 (47.2837%), train_poison_data_count: 624
Global model norm: 262.08398582324713.
Norm before scaling: 261.9857164522524. Distance: 1.498361248665787
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3116, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.2195, Accuracy: 9313/9950 (93.5980%)
Scaling by  100
Scaled Norm after poisoning: 292.85867432090856, distance: 149.83613445194052
Total norm for 1 adversaries is: 292.85867432090856. distance: 149.83613445194052
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0715, Accuracy: 274/1645 (16.6565%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0346, Accuracy: 586/1645 (35.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.6559, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0754, Accuracy: 215/1446 (14.8686%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0395, Accuracy: 498/1446 (34.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.4458, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1819, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1592, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.7570, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0785, Accuracy: 196/803 (24.4085%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0396, Accuracy: 404/803 (50.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1817, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.1195, Accuracy: 2/311 (0.6431%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0772, Accuracy: 34/311 (10.9325%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.0741, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0954, Accuracy: 24/568 (4.2254%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0483, Accuracy: 260/568 (45.7746%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.4767, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.1035, Accuracy: 4/466 (0.8584%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0522, Accuracy: 176/466 (37.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3309, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0826, Accuracy: 191/891 (21.4366%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0330, Accuracy: 404/891 (45.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8349, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0772, Accuracy: 134/1241 (10.7977%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0391, Accuracy: 407/1241 (32.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.5330, Accuracy: 62/10000 (0.6200%)
time spent on training: 351.0626652240753
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.9677, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.4702, Accuracy: 8509/9950 (85.5176%)
saving model
Done in 596.7117388248444 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0693, Accuracy: 215/1275 (16.8627%)
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0208, Accuracy: 682/1275 (53.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 12.1042, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1958, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1663, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0004, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0734, Accuracy: 338/1953 (17.3067%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0349, Accuracy: 766/1953 (39.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4144, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0836, Accuracy: 153/803 (19.0535%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0405, Accuracy: 434/803 (54.0473%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4878, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0943, Accuracy: 46/809 (5.6860%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0326, Accuracy: 336/809 (41.5328%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.8051, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0805, Accuracy: 243/1956 (12.4233%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 614/1956 (31.3906%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.9396, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0912, Accuracy: 214/1163 (18.4007%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0433, Accuracy: 443/1163 (38.0911%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0708, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0746, Accuracy: 243/1446 (16.8050%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0390, Accuracy: 518/1446 (35.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9587, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0752, Accuracy: 258/1573 (16.4018%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 603/1573 (38.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3684, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0901, Accuracy: 71/818 (8.6797%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0356, Accuracy: 317/818 (38.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.1791, Accuracy: 81/10000 (0.8100%)
time spent on training: 306.7125265598297
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.3075, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 0.3532, Accuracy: 8921/9950 (89.6583%)
saving model
Done in 551.7064695358276 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0905, Accuracy: 47/809 (5.8096%)
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0317, Accuracy: 341/809 (42.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 10.6605, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0919, Accuracy: 82/1013 (8.0948%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0386, Accuracy: 363/1013 (35.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.1707, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0857, Accuracy: 178/1190 (14.9580%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 458/1190 (38.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.8338, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0858, Accuracy: 134/1513 (8.8566%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0396, Accuracy: 444/1513 (29.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.6397, Accuracy: 95/10000 (0.9500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0792, Accuracy: 141/690 (20.4348%)
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0338, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.0731, Accuracy: 59/10000 (0.5900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0631, Accuracy: 280/1628 (17.1990%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 770/1628 (47.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6208, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0729, Accuracy: 255/1573 (16.2111%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0362, Accuracy: 574/1573 (36.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2834, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.1175, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0635, Accuracy: 66/373 (17.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8940, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0817, Accuracy: 123/1241 (9.9114%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0397, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.6641, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0933, Accuracy: 75/590 (12.7119%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0409, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 14.6556, Accuracy: 50/10000 (0.5000%)
time spent on training: 231.15659523010254
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.8387, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 0.4603, Accuracy: 8472/9950 (85.1457%)
saving model
Done in 494.7073118686676 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0806, Accuracy: 123/1241 (9.9114%)
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0392, Accuracy: 382/1241 (30.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4742, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0657, Accuracy: 356/1470 (24.2177%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 848/1470 (57.6871%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.4295, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0869, Accuracy: 60/809 (7.4166%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0319, Accuracy: 329/809 (40.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.4085, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0897, Accuracy: 155/928 (16.7026%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0292, Accuracy: 515/928 (55.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.7396, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0865, Accuracy: 128/1131 (11.3174%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0323, Accuracy: 492/1131 (43.5013%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.8544, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0679, Accuracy: 91/408 (22.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.9592, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0854, Accuracy: 97/636 (15.2516%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0385, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 12.4972, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0588, Accuracy: 158/735 (21.4966%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0248, Accuracy: 344/735 (46.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.3201, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0829, Accuracy: 127/938 (13.5394%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0382, Accuracy: 328/938 (34.9680%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.2014, Accuracy: 74/10000 (0.7400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0369, Accuracy: 651/1988 (32.7465%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0325, Accuracy: 750/1988 (37.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.7071, Accuracy: 87/10000 (0.8700%)
time spent on training: 235.80618333816528
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.6165, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 0.3967, Accuracy: 8655/9950 (86.9849%)
saving model
Done in 495.5491383075714 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.1159, Accuracy: 2/515 (0.3883%)
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0645, Accuracy: 107/515 (20.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.1614, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0765, Accuracy: 172/803 (21.4197%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0369, Accuracy: 444/803 (55.2927%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.7858, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1745, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1595, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8371, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0597, Accuracy: 264/1275 (20.7059%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 684/1275 (53.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.4544, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0737, Accuracy: 216/1036 (20.8494%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 662/1036 (63.8996%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 13.9814, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0683, Accuracy: 281/1446 (19.4329%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0380, Accuracy: 526/1446 (36.3762%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8097, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.1060, Accuracy: 23/669 (3.4380%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0512, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.1630, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0862, Accuracy: 88/774 (11.3695%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0407, Accuracy: 328/774 (42.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.1808, Accuracy: 66/10000 (0.6600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.1055, Accuracy: 60/599 (10.0167%)
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0346, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 15.3808, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.1319, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.1097, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.7919, Accuracy: 71/10000 (0.7100%)
time spent on training: 212.80696606636047
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.7010, Accuracy: 67/10000 (0.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.8161, Accuracy: 7018/9950 (70.5327%)
saving model
Done in 468.8243544101715 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.1041, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0580, Accuracy: 80/373 (21.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0869, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0593, Accuracy: 255/1275 (20.0000%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 704/1275 (55.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.8726, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0827, Accuracy: 140/1513 (9.2531%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0399, Accuracy: 433/1513 (28.6186%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.8328, Accuracy: 89/10000 (0.8900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0697, Accuracy: 169/690 (24.4928%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0311, Accuracy: 462/690 (66.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.6657, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0931, Accuracy: 49/953 (5.1417%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0436, Accuracy: 310/953 (32.5289%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.5795, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0518, Accuracy: 439/1552 (28.2861%)
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 777/1552 (50.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.0697, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0809, Accuracy: 132/677 (19.4978%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0262, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.1869, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0716, Accuracy: 212/1036 (20.4633%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0255, Accuracy: 646/1036 (62.3552%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 13.8155, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0832, Accuracy: 151/1402 (10.7703%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 345/1402 (24.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.4944, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0752, Accuracy: 271/1715 (15.8017%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0328, Accuracy: 683/1715 (39.8251%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.1442, Accuracy: 102/10000 (1.0200%)
time spent on training: 273.9988305568695
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.1778, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 0.6643, Accuracy: 7760/9950 (77.9899%)
saving model
Done in 527.6004059314728 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0940, Accuracy: 100/708 (14.1243%)
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0453, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.0441, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0745, Accuracy: 151/1241 (12.1676%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.5725, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0830, Accuracy: 109/1013 (10.7601%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0371, Accuracy: 377/1013 (37.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.0570, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0582, Accuracy: 155/735 (21.0884%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0240, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 11.4845, Accuracy: 58/10000 (0.5800%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0649, Accuracy: 192/1071 (17.9272%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0285, Accuracy: 507/1071 (47.3389%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.5201, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.1007, Accuracy: 3/631 (0.4754%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0506, Accuracy: 242/631 (38.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.3585, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.1001, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0539, Accuracy: 93/373 (24.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.3714, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.1251, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.1056, Accuracy: 1/186 (0.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.5335, Accuracy: 73/10000 (0.7300%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0382, Accuracy: 620/1988 (31.1871%)
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0336, Accuracy: 717/1988 (36.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8250, Accuracy: 88/10000 (0.8800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0932, Accuracy: 91/599 (15.1920%)
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0345, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 15.1808, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.7756998538971
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 13.2776, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.5224, Accuracy: 8147/9950 (81.8794%)
saving model
Done in 518.6198782920837 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0771, Accuracy: 204/1190 (17.1429%)
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 463/1190 (38.9076%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.6424, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0607, Accuracy: 176/813 (21.6482%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0212, Accuracy: 463/813 (56.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 13.3541, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0801, Accuracy: 121/1131 (10.6985%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0319, Accuracy: 472/1131 (41.7330%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1937, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.1178, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0484, Accuracy: 147/460 (31.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5453, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0812, Accuracy: 134/1513 (8.8566%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0396, Accuracy: 424/1513 (28.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.9127, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1654, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1460, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.4267, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.1119, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0572, Accuracy: 106/426 (24.8826%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1736, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0860, Accuracy: 183/901 (20.3108%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0379, Accuracy: 397/901 (44.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.9591, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0746, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0335, Accuracy: 416/1131 (36.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5161, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0832, Accuracy: 66/603 (10.9453%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0489, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0477, Accuracy: 63/10000 (0.6300%)
time spent on training: 194.4182643890381
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 12.8948, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 0.7916, Accuracy: 7108/9950 (71.4372%)
saving model
Done in 449.9654748439789 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.1028, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0584, Accuracy: 154/500 (30.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.5333, Accuracy: 56/10000 (0.5600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0499, Accuracy: 428/1552 (27.5773%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 760/1552 (48.9691%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.2931, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0834, Accuracy: 114/712 (16.0112%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 445/712 (62.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.6176, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0820, Accuracy: 148/719 (20.5841%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0406, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.9969, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0674, Accuracy: 267/1573 (16.9739%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0365, Accuracy: 542/1573 (34.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.0701, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.1088, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0620, Accuracy: 121/408 (29.6569%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.1617, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0876, Accuracy: 111/599 (18.5309%)
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0357, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 15.4462, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0716, Accuracy: 211/1131 (18.6561%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0340, Accuracy: 425/1131 (37.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.3759, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0902, Accuracy: 105/715 (14.6853%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0448, Accuracy: 440/715 (61.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.8304, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0563, Accuracy: 171/735 (23.2653%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 371/735 (50.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.5529, Accuracy: 67/10000 (0.6700%)
time spent on training: 233.32797145843506
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.3968, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.8838, Accuracy: 6993/9950 (70.2814%)
saving model
Done in 489.29161286354065 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0606, Accuracy: 311/1581 (19.6711%)
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 541/1581 (34.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7089, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0677, Accuracy: 178/1013 (17.5716%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0291, Accuracy: 477/1013 (47.0879%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.8341, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0721, Accuracy: 298/1587 (18.7776%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0363, Accuracy: 548/1587 (34.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1778, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0766, Accuracy: 102/774 (13.1783%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0389, Accuracy: 342/774 (44.1860%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.2035, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0650, Accuracy: 248/1213 (20.4452%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0291, Accuracy: 505/1213 (41.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.6027, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0778, Accuracy: 213/891 (23.9057%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0329, Accuracy: 426/891 (47.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.0656, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1506, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1395, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.8165, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0924, Accuracy: 2/312 (0.6410%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0532, Accuracy: 113/312 (36.2179%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5135, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0834, Accuracy: 1/440 (0.2273%)
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0464, Accuracy: 128/440 (29.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.2965, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0841, Accuracy: 53/603 (8.7894%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 278/603 (46.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.0562, Accuracy: 57/10000 (0.5700%)
time spent on training: 236.11164951324463
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 14.3845, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 1.7264, Accuracy: 4506/9950 (45.2864%)
saving model
Saving model on epoch 60
Done in 496.27694511413574 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0736, Accuracy: 117/888 (13.1757%)
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0283, Accuracy: 441/888 (49.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 11.7860, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0641, Accuracy: 240/1213 (19.7857%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 509/1213 (41.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.5090, Accuracy: 69/10000 (0.6900%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1497, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1397, Accuracy: 2/85 (2.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.2167, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0627, Accuracy: 463/2227 (20.7903%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0306, Accuracy: 919/2227 (41.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.0397, Accuracy: 122/10000 (1.2200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0604, Accuracy: 183/1071 (17.0868%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 498/1071 (46.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.1389, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0718, Accuracy: 208/1131 (18.3908%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0343, Accuracy: 385/1131 (34.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.0339, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0780, Accuracy: 68/809 (8.4054%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0323, Accuracy: 309/809 (38.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.6918, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0732, Accuracy: 152/1241 (12.2482%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0394, Accuracy: 406/1241 (32.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.4944, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0811, Accuracy: 88/1013 (8.6871%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0379, Accuracy: 351/1013 (34.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.4822, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0845, Accuracy: 79/953 (8.2896%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0422, Accuracy: 322/953 (33.7880%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.5057, Accuracy: 73/10000 (0.7300%)
time spent on training: 279.11712741851807
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 17.1700, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 2.5366, Accuracy: 3879/9950 (38.9849%)
saving model
Done in 533.7931399345398 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0984, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0575, Accuracy: 139/500 (27.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.5975, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0690, Accuracy: 232/1645 (14.1033%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 540/1645 (32.8267%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.2239, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0843, Accuracy: 6/373 (1.6086%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 128/373 (34.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.9145, Accuracy: 52/10000 (0.5200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0410, Accuracy: 534/1988 (26.8612%)
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 701/1988 (35.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.1135, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0633, Accuracy: 429/2227 (19.2636%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0303, Accuracy: 888/2227 (39.8743%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.8016, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0663, Accuracy: 299/1440 (20.7639%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0297, Accuracy: 664/1440 (46.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.6258, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0951, Accuracy: 51/669 (7.6233%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0487, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.3095, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0726, Accuracy: 224/891 (25.1403%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0327, Accuracy: 418/891 (46.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.1654, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0798, Accuracy: 151/1402 (10.7703%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0413, Accuracy: 354/1402 (25.2496%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.7354, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0703, Accuracy: 145/888 (16.3288%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0279, Accuracy: 452/888 (50.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.9405, Accuracy: 75/10000 (0.7500%)
time spent on training: 272.3405020236969
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 14.7103, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 2.7104, Accuracy: 3204/9950 (32.2010%)
saving model
Done in 530.700896024704 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0790, Accuracy: 103/1013 (10.1678%)
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0388, Accuracy: 328/1013 (32.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.1666, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0775, Accuracy: 105/774 (13.5659%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0392, Accuracy: 316/774 (40.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.5222, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0620, Accuracy: 238/1213 (19.6208%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0291, Accuracy: 508/1213 (41.8796%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.1524, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0603, Accuracy: 240/1030 (23.3010%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0288, Accuracy: 576/1030 (55.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 11.2718, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0591, Accuracy: 308/1581 (19.4813%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 531/1581 (33.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.5358, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0758, Accuracy: 222/1662 (13.3574%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0362, Accuracy: 560/1662 (33.6943%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.7679, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0791, Accuracy: 196/901 (21.7536%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0408, Accuracy: 409/901 (45.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.1360, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0858, Accuracy: 13/271 (4.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.4274, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0617, Accuracy: 212/690 (30.7246%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0302, Accuracy: 463/690 (67.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.2625, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0674, Accuracy: 170/1013 (16.7818%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0297, Accuracy: 475/1013 (46.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.1605, Accuracy: 64/10000 (0.6400%)
time spent on training: 234.18270587921143
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.2717, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 2.1343, Accuracy: 3751/9950 (37.6985%)
saving model
Done in 487.1208429336548 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0761, Accuracy: 133/774 (17.1835%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0388, Accuracy: 321/774 (41.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2181, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0718, Accuracy: 122/818 (14.9144%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0343, Accuracy: 332/818 (40.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.6383, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0599, Accuracy: 352/1470 (23.9456%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 792/1470 (53.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.1938, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0992, Accuracy: 10/466 (2.1459%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0535, Accuracy: 148/466 (31.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6219, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0926, Accuracy: 55/669 (8.2212%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0464, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.9290, Accuracy: 62/10000 (0.6200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 32/486 (6.5844%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0430, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2973, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0780, Accuracy: 165/1402 (11.7689%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0418, Accuracy: 336/1402 (23.9658%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.5204, Accuracy: 72/10000 (0.7200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0569, Accuracy: 273/1628 (16.7690%)
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 761/1628 (46.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.7938, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0677, Accuracy: 156/590 (26.4407%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0358, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 12.9887, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0721, Accuracy: 230/1418 (16.2200%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0360, Accuracy: 582/1418 (41.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.1011, Accuracy: 84/10000 (0.8400%)
time spent on training: 275.64937829971313
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 13.1500, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 3.6175, Accuracy: 1620/9950 (16.2814%)
saving model
Done in 529.1397342681885 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0967, Accuracy: 3/416 (0.7212%)
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0556, Accuracy: 144/416 (34.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.9604, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0804, Accuracy: 182/896 (20.3125%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0393, Accuracy: 467/896 (52.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.6838, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0674, Accuracy: 178/677 (26.2925%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 12.5264, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0809, Accuracy: 140/708 (19.7740%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0487, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.5224, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0680, Accuracy: 276/1163 (23.7317%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0384, Accuracy: 467/1163 (40.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3217, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0965, Accuracy: 8/466 (1.7167%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0522, Accuracy: 165/466 (35.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4318, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0750, Accuracy: 209/1154 (18.1109%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0324, Accuracy: 483/1154 (41.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.5871, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0671, Accuracy: 326/1587 (20.5419%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0365, Accuracy: 586/1587 (36.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.5270, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0678, Accuracy: 312/1953 (15.9754%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0363, Accuracy: 707/1953 (36.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4305, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0697, Accuracy: 211/719 (29.3463%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0361, Accuracy: 457/719 (63.5605%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.6079, Accuracy: 58/10000 (0.5800%)
time spent on training: 259.6986451148987
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 13.5987, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 3.6225, Accuracy: 1828/9950 (18.3719%)
saving model
Done in 509.39035630226135 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0783, Accuracy: 144/1131 (12.7321%)
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0321, Accuracy: 437/1131 (38.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.3356, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0833, Accuracy: 57/603 (9.4527%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0497, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9733, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.1038, Accuracy: 14/515 (2.7184%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0647, Accuracy: 114/515 (22.1359%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.0050, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0795, Accuracy: 138/946 (14.5877%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0393, Accuracy: 348/946 (36.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.1314, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0772, Accuracy: 107/1013 (10.5627%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0381, Accuracy: 370/1013 (36.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.1432, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0920, Accuracy: 23/530 (4.3396%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0429, Accuracy: 282/530 (53.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.7858, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 16/373 (4.2895%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0499, Accuracy: 135/373 (36.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.7071, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.1212, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0839, Accuracy: 37/271 (13.6531%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.9521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0957, Accuracy: 6/416 (1.4423%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0553, Accuracy: 151/416 (36.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9434, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0637, Accuracy: 274/1003 (27.3180%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/1003 (42.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.5442, Accuracy: 52/10000 (0.5200%)
time spent on training: 214.92506313323975
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 16.8566, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 4.4335, Accuracy: 1425/9950 (14.3216%)
saving model
Done in 472.54869556427 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0753, Accuracy: 236/1662 (14.1998%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0379, Accuracy: 519/1662 (31.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.8248, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0694, Accuracy: 234/1645 (14.2249%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0355, Accuracy: 577/1645 (35.0760%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.8506, Accuracy: 106/10000 (1.0600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0702, Accuracy: 175/599 (29.2154%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 15.0194, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0694, Accuracy: 143/938 (15.2452%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0359, Accuracy: 331/938 (35.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.9041, Accuracy: 67/10000 (0.6700%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0763, Accuracy: 47/486 (9.6708%)
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 219/486 (45.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.9397, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0612, Accuracy: 338/1470 (22.9932%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0272, Accuracy: 779/1470 (52.9932%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.4511, Accuracy: 94/10000 (0.9400%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0628, Accuracy: 204/690 (29.5652%)
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 466/690 (67.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.3409, Accuracy: 70/10000 (0.7000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0695, Accuracy: 137/861 (15.9117%)
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 462/861 (53.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 11.3263, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 272/1003 (27.1186%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 397/1003 (39.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.6257, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0762, Accuracy: 122/1513 (8.0635%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0411, Accuracy: 405/1513 (26.7680%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.6070, Accuracy: 79/10000 (0.7900%)
time spent on training: 307.92807126045227
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 15.1307, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 6.2686, Accuracy: 276/9950 (2.7739%)
saving model
Done in 559.2672672271729 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0672, Accuracy: 303/1953 (15.5146%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0358, Accuracy: 717/1953 (36.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4547, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0695, Accuracy: 137/636 (21.5409%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0332, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.1021, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0591, Accuracy: 270/1213 (22.2589%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 523/1213 (43.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.1013, Accuracy: 69/10000 (0.6900%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0579, Accuracy: 336/1750 (19.2000%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0359, Accuracy: 654/1750 (37.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4712, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.1009, Accuracy: 3/426 (0.7042%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0523, Accuracy: 126/426 (29.5775%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.9262, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0677, Accuracy: 234/891 (26.2626%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0299, Accuracy: 452/891 (50.7295%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.3120, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0661, Accuracy: 221/1131 (19.5402%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0352, Accuracy: 373/1131 (32.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.1154, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0952, Accuracy: 10/466 (2.1459%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 173/466 (37.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3126, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0634, Accuracy: 338/1904 (17.7521%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0325, Accuracy: 696/1904 (36.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6637, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0608, Accuracy: 274/1574 (17.4079%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 644/1574 (40.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.3600, Accuracy: 90/10000 (0.9000%)
time spent on training: 278.4740471839905
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 15.7980, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 7.7747, Accuracy: 121/9950 (1.2161%)
saving model
Done in 530.6051363945007 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0619, Accuracy: 201/677 (29.6898%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 12.9647, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0945, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0536, Accuracy: 115/312 (36.8590%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.2677, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0600, Accuracy: 303/1581 (19.1651%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0361, Accuracy: 513/1581 (32.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.0402, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0709, Accuracy: 234/1418 (16.5021%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0353, Accuracy: 576/1418 (40.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.5187, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0662, Accuracy: 162/636 (25.4717%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0323, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.6163, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0575, Accuracy: 257/1213 (21.1871%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 529/1213 (43.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.1054, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0742, Accuracy: 144/712 (20.2247%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 458/712 (64.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.9750, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0635, Accuracy: 298/1949 (15.2899%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 583/1949 (29.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.1069, Accuracy: 72/10000 (0.7200%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0753, Accuracy: 155/807 (19.2069%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0375, Accuracy: 418/807 (51.7968%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.1842, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0703, Accuracy: 92/568 (16.1972%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0436, Accuracy: 258/568 (45.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.8399, Accuracy: 47/10000 (0.4700%)
time spent on training: 291.51608061790466
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.1505, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 5.6133, Accuracy: 0/9950 (0.0000%)
saving model
Done in 542.4187157154083 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0679, Accuracy: 238/776 (30.6701%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0316, Accuracy: 385/776 (49.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0081, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0925, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0524, Accuracy: 107/312 (34.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.3881, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0923, Accuracy: 14/408 (3.4314%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0582, Accuracy: 147/408 (36.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.5137, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0636, Accuracy: 170/636 (26.7296%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 426/636 (66.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.4263, Accuracy: 54/10000 (0.5400%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0689, Accuracy: 166/599 (27.7129%)
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0304, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 14.5940, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0916, Accuracy: 27/500 (5.4000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0570, Accuracy: 166/500 (33.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.0237, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0597, Accuracy: 316/1742 (18.1401%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0327, Accuracy: 640/1742 (36.7394%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.8815, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0576, Accuracy: 270/1213 (22.2589%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 511/1213 (42.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.7627, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0744, Accuracy: 256/1956 (13.0879%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 593/1956 (30.3170%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.1251, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0768, Accuracy: 116/774 (14.9871%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0400, Accuracy: 349/774 (45.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.4594, Accuracy: 65/10000 (0.6500%)
time spent on training: 262.00579929351807
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 71.8427, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 44.4232, Accuracy: 0/9950 (0.0000%)
saving model
Done in 519.5956425666809 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0829, Accuracy: 65/603 (10.7794%)
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0497, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.7821, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0708, Accuracy: 164/1513 (10.8394%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0399, Accuracy: 442/1513 (29.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.8297, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0660, Accuracy: 234/1131 (20.6897%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0341, Accuracy: 403/1131 (35.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.2153, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0794, Accuracy: 202/896 (22.5446%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0392, Accuracy: 465/896 (51.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.4423, Accuracy: 51/10000 (0.5100%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0609, Accuracy: 310/1475 (21.0169%)
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 594/1475 (40.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0441, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0646, Accuracy: 264/1036 (25.4826%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 636/1036 (61.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 13.2439, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0736, Accuracy: 153/712 (21.4888%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0317, Accuracy: 448/712 (62.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.9234, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0739, Accuracy: 174/715 (24.3357%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0422, Accuracy: 440/715 (61.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.5959, Accuracy: 79/10000 (0.7900%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0768, Accuracy: 7/440 (1.5909%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0448, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.0854, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0761, Accuracy: 190/1154 (16.4645%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 435/1154 (37.6950%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 11.3051, Accuracy: 64/10000 (0.6400%)
time spent on training: 272.7642664909363
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 13.0464, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 5.9078, Accuracy: 588/9950 (5.9095%)
saving model
Done in 530.6692843437195 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0851, Accuracy: 16/416 (3.8462%)
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0492, Accuracy: 157/416 (37.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.1983, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0708, Accuracy: 193/803 (24.0349%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0365, Accuracy: 425/803 (52.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6097, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0713, Accuracy: 227/891 (25.4770%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0313, Accuracy: 408/891 (45.7912%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.3172, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0663, Accuracy: 227/1131 (20.0707%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0333, Accuracy: 421/1131 (37.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.1671, Accuracy: 65/10000 (0.6500%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0562, Accuracy: 322/1628 (19.7789%)
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0281, Accuracy: 682/1628 (41.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.6321, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0818, Accuracy: 32/311 (10.2894%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0601, Accuracy: 123/311 (39.5498%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.5195, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0575, Accuracy: 336/1581 (21.2524%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0357, Accuracy: 553/1581 (34.9779%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6773, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0600, Accuracy: 219/1013 (21.6190%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0281, Accuracy: 509/1013 (50.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.1715, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0627, Accuracy: 211/1030 (20.4854%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0285, Accuracy: 579/1030 (56.2136%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.9616, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0588, Accuracy: 368/1470 (25.0340%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0268, Accuracy: 828/1470 (56.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.3658, Accuracy: 98/10000 (0.9800%)
time spent on training: 268.1273808479309
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.1646, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 6.2137, Accuracy: 0/9950 (0.0000%)
saving model
Done in 521.4001634120941 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0792, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 144/373 (38.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.6184, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0923, Accuracy: 12/408 (2.9412%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0566, Accuracy: 142/408 (34.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.9275, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0628, Accuracy: 319/1949 (16.3674%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0354, Accuracy: 581/1949 (29.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.9087, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0934, Accuracy: 16/466 (3.4335%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0519, Accuracy: 162/466 (34.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8338, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0713, Accuracy: 126/861 (14.6341%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 441/861 (51.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 11.6874, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0620, Accuracy: 295/1573 (18.7540%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0373, Accuracy: 555/1573 (35.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.1423, Accuracy: 66/10000 (0.6600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1352, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1304, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.6649, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0757, Accuracy: 229/901 (25.4162%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0389, Accuracy: 389/901 (43.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8047, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0685, Accuracy: 222/776 (28.6082%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0339, Accuracy: 376/776 (48.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.6017, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0663, Accuracy: 260/1446 (17.9806%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0401, Accuracy: 506/1446 (34.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.0974, Accuracy: 76/10000 (0.7600%)
time spent on training: 294.7575378417969
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.2420, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 6.1208, Accuracy: 0/9950 (0.0000%)
saving model
Done in 547.5442156791687 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0721, Accuracy: 210/715 (29.3706%)
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0396, Accuracy: 435/715 (60.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.3016, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0578, Accuracy: 151/735 (20.5442%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 363/735 (49.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 12.0472, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0619, Accuracy: 325/1475 (22.0339%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 627/1475 (42.5085%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.3569, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0619, Accuracy: 270/1573 (17.1647%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0376, Accuracy: 540/1573 (34.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3788, Accuracy: 79/10000 (0.7900%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 359/1750 (20.5143%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 633/1750 (36.1714%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3464, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0757, Accuracy: 216/901 (23.9734%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0371, Accuracy: 415/901 (46.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.7108, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0698, Accuracy: 233/1190 (19.5798%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 437/1190 (36.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.9569, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0725, Accuracy: 225/1662 (13.5379%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0373, Accuracy: 557/1662 (33.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.2759, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0729, Accuracy: 120/1013 (11.8460%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0388, Accuracy: 365/1013 (36.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.2441, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0711, Accuracy: 253/1418 (17.8420%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0361, Accuracy: 552/1418 (38.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.5319, Accuracy: 86/10000 (0.8600%)
time spent on training: 327.24776673316956
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.2187, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 5.4906, Accuracy: 0/9950 (0.0000%)
saving model
Done in 576.8609127998352 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0455, Accuracy: 437/1552 (28.1572%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0232, Accuracy: 700/1552 (45.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 11.5243, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0733, Accuracy: 156/712 (21.9101%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 441/712 (61.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 11.2776, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0806, Accuracy: 101/669 (15.0972%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0449, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.0682, Accuracy: 72/10000 (0.7200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0597, Accuracy: 321/1475 (21.7627%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 641/1475 (43.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.0329, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0623, Accuracy: 249/776 (32.0876%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0322, Accuracy: 387/776 (49.8711%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.2094, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0710, Accuracy: 281/1089 (25.8035%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0326, Accuracy: 446/1089 (40.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.6685, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0618, Accuracy: 187/636 (29.4025%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.6556, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0771, Accuracy: 228/928 (24.5690%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0270, Accuracy: 538/928 (57.9741%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.6746, Accuracy: 92/10000 (0.9200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0609, Accuracy: 250/1154 (21.6638%)
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0299, Accuracy: 464/1154 (40.2080%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 11.3556, Accuracy: 69/10000 (0.6900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0618, Accuracy: 224/690 (32.4638%)
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0289, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.0494, Accuracy: 62/10000 (0.6200%)
time spent on training: 303.37764835357666
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.1529, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 5.7961, Accuracy: 0/9950 (0.0000%)
saving model
Done in 563.8867115974426 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0756, Accuracy: 136/888 (15.3153%)
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0300, Accuracy: 433/888 (48.7613%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.5516, Accuracy: 67/10000 (0.6700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0442, Accuracy: 448/1552 (28.8660%)
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 711/1552 (45.8119%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 12.1010, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0614, Accuracy: 260/1340 (19.4030%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0285, Accuracy: 583/1340 (43.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.3002, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0637, Accuracy: 247/1131 (21.8391%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 408/1131 (36.0743%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1578, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0649, Accuracy: 176/773 (22.7684%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0358, Accuracy: 390/773 (50.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.9001, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0779, Accuracy: 224/901 (24.8613%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0362, Accuracy: 395/901 (43.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1051, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0785, Accuracy: 180/1402 (12.8388%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.2891, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0708, Accuracy: 235/1662 (14.1396%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 566/1662 (34.0554%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.0088, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0712, Accuracy: 142/1013 (14.0178%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0394, Accuracy: 337/1013 (33.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1104, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0864, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0477, Accuracy: 129/312 (41.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.9721, Accuracy: 50/10000 (0.5000%)
time spent on training: 317.7439019680023
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.1479, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 6.0306, Accuracy: 0/9950 (0.0000%)
saving model
Done in 570.8388049602509 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0891, Accuracy: 23/466 (4.9356%)
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 189/466 (40.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.2481, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0732, Accuracy: 289/1956 (14.7751%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0349, Accuracy: 569/1956 (29.0900%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.9811, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0668, Accuracy: 241/1190 (20.2521%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 441/1190 (37.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.0370, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0864, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0535, Accuracy: 122/338 (36.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.9294, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0769, Accuracy: 190/1402 (13.5521%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0414, Accuracy: 360/1402 (25.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.2152, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0552, Accuracy: 282/1213 (23.2481%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 521/1213 (42.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.3568, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0606, Accuracy: 393/1904 (20.6408%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0325, Accuracy: 697/1904 (36.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.4551, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0635, Accuracy: 315/1949 (16.1621%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 592/1949 (30.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.9091, Accuracy: 79/10000 (0.7900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0443, Accuracy: 449/1552 (28.9304%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0232, Accuracy: 675/1552 (43.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 11.6187, Accuracy: 88/10000 (0.8800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0617, Accuracy: 258/1154 (22.3570%)
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 430/1154 (37.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.3286, Accuracy: 71/10000 (0.7100%)
time spent on training: 363.7203643321991
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 12.2317, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 2.5733, Accuracy: 3213/9950 (32.2915%)
saving model
Done in 614.7948734760284 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0690, Accuracy: 200/719 (27.8164%)
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0367, Accuracy: 459/719 (63.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.7653, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0664, Accuracy: 215/1241 (17.3247%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0399, Accuracy: 382/1241 (30.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8600, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0633, Accuracy: 330/1949 (16.9318%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0355, Accuracy: 590/1949 (30.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8090, Accuracy: 76/10000 (0.7600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1418, Accuracy: 3/85 (3.5294%)
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1278, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.0381, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0919, Accuracy: 13/408 (3.1863%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0528, Accuracy: 147/408 (36.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9577, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0666, Accuracy: 287/1089 (26.3545%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0303, Accuracy: 472/1089 (43.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.6993, Accuracy: 82/10000 (0.8200%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0749, Accuracy: 165/599 (27.5459%)
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 14.7726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0698, Accuracy: 295/1953 (15.1050%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0367, Accuracy: 693/1953 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.2184, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0728, Accuracy: 121/818 (14.7922%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0325, Accuracy: 327/818 (39.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.9503, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0786, Accuracy: 42/486 (8.6420%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 215/486 (44.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.5310, Accuracy: 60/10000 (0.6000%)
time spent on training: 294.2571556568146
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.1038, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 6.1284, Accuracy: 0/9950 (0.0000%)
saving model
Done in 555.4233019351959 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0909, Accuracy: 25/515 (4.8544%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0567, Accuracy: 126/515 (24.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0911, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0775, Accuracy: 211/928 (22.7371%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0281, Accuracy: 523/928 (56.3578%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.7374, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0938, Accuracy: 15/466 (3.2189%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0500, Accuracy: 176/466 (37.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5494, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0717, Accuracy: 249/1154 (21.5771%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0314, Accuracy: 435/1154 (37.6950%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 11.2029, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0818, Accuracy: 186/896 (20.7589%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0408, Accuracy: 436/896 (48.6607%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5141, Accuracy: 66/10000 (0.6600%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 229/1071 (21.3819%)
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 486/1071 (45.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0504, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0795, Accuracy: 154/1372 (11.2245%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0348, Accuracy: 487/1372 (35.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.3148, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0997, Accuracy: 8/460 (1.7391%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0462, Accuracy: 180/460 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0438, Accuracy: 56/10000 (0.5600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0752, Accuracy: 165/599 (27.5459%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0315, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 14.2168, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0571, Accuracy: 391/1470 (26.5986%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0263, Accuracy: 806/1470 (54.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.9081, Accuracy: 93/10000 (0.9300%)
time spent on training: 245.8413212299347
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.0906, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 5.7405, Accuracy: 0/9950 (0.0000%)
saving model
Done in 492.4310898780823 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0598, Accuracy: 258/1154 (22.3570%)
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 466/1154 (40.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.5301, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0865, Accuracy: 25/500 (5.0000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0544, Accuracy: 169/500 (33.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.5069, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0624, Accuracy: 247/1573 (15.7025%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0373, Accuracy: 537/1573 (34.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3186, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0795, Accuracy: 55/530 (10.3774%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0407, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.9179, Accuracy: 68/10000 (0.6800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 344/1750 (19.6571%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0377, Accuracy: 638/1750 (36.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.4084, Accuracy: 111/10000 (1.1100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0663, Accuracy: 278/1129 (24.6236%)
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0268, Accuracy: 686/1129 (60.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.2018, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0696, Accuracy: 279/1440 (19.3750%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0304, Accuracy: 629/1440 (43.6806%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.1953, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0750, Accuracy: 158/888 (17.7928%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0299, Accuracy: 404/888 (45.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 11.1455, Accuracy: 75/10000 (0.7500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0694, Accuracy: 289/1657 (17.4412%)
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0374, Accuracy: 461/1657 (27.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.7647, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0569, Accuracy: 374/1470 (25.4422%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0265, Accuracy: 789/1470 (53.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.2048, Accuracy: 94/10000 (0.9400%)
time spent on training: 303.1636598110199
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.0766, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 5.5764, Accuracy: 0/9950 (0.0000%)
saving model
Done in 548.9360718727112 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0736, Accuracy: 77/568 (13.5563%)
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0431, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.2869, Accuracy: 47/10000 (0.4700%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 308/1628 (18.9189%)
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0291, Accuracy: 655/1628 (40.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.3771, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.1048, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0866, Accuracy: 1/186 (0.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.6668, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0602, Accuracy: 471/2227 (21.1495%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0322, Accuracy: 890/2227 (39.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.3312, Accuracy: 114/10000 (1.1400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0741, Accuracy: 119/861 (13.8211%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0228, Accuracy: 451/861 (52.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 11.5804, Accuracy: 92/10000 (0.9200%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0744, Accuracy: 161/807 (19.9504%)
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0378, Accuracy: 415/807 (51.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.3461, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0622, Accuracy: 217/677 (32.0532%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 457/677 (67.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 12.7367, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0652, Accuracy: 229/1131 (20.2476%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0341, Accuracy: 388/1131 (34.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.4150, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0665, Accuracy: 209/1241 (16.8413%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4580, Accuracy: 67/10000 (0.6700%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0745, Accuracy: 17/440 (3.8636%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0444, Accuracy: 137/440 (31.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4493, Accuracy: 55/10000 (0.5500%)
time spent on training: 272.15112495422363
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.0952, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 5.8921, Accuracy: 0/9950 (0.0000%)
saving model
Done in 532.7867441177368 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0778, Accuracy: 202/896 (22.5446%)
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0399, Accuracy: 461/896 (51.4509%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7128, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0724, Accuracy: 116/818 (14.1809%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0323, Accuracy: 323/818 (39.4866%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.9085, Accuracy: 81/10000 (0.8100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0626, Accuracy: 257/1154 (22.2704%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0319, Accuracy: 410/1154 (35.5286%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 11.0433, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0538, Accuracy: 405/1470 (27.5510%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 778/1470 (52.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.0638, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/1581 (22.2011%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 508/1581 (32.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7780, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0669, Accuracy: 240/1089 (22.0386%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0361, Accuracy: 468/1089 (42.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 12.9979, Accuracy: 55/10000 (0.5500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 365/1750 (20.8571%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0373, Accuracy: 636/1750 (36.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4650, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0652, Accuracy: 227/1241 (18.2917%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0389, Accuracy: 383/1241 (30.8622%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.3487, Accuracy: 53/10000 (0.5300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0545, Accuracy: 343/1628 (21.0688%)
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0283, Accuracy: 695/1628 (42.6904%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.7807, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0793, Accuracy: 92/953 (9.6537%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0431, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4203, Accuracy: 77/10000 (0.7700%)
time spent on training: 301.87323451042175
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.0586, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 6.1722, Accuracy: 0/9950 (0.0000%)
saving model
Done in 542.370922088623 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 365/1750 (20.8571%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0376, Accuracy: 612/1750 (34.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.5422, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0804, Accuracy: 62/530 (11.6981%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0433, Accuracy: 279/530 (52.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.0905, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0685, Accuracy: 232/1418 (16.3611%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0348, Accuracy: 571/1418 (40.2680%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.8854, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0549, Accuracy: 296/1213 (24.4023%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0287, Accuracy: 514/1213 (42.3743%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.1103, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0735, Accuracy: 160/946 (16.9133%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0381, Accuracy: 370/946 (39.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3043, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0641, Accuracy: 281/1742 (16.1309%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0331, Accuracy: 648/1742 (37.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.3009, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0632, Accuracy: 233/1241 (18.7752%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0390, Accuracy: 414/1241 (33.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3845, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0845, Accuracy: 6/312 (1.9231%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0454, Accuracy: 130/312 (41.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.5303, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.1003, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0828, Accuracy: 6/186 (3.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.3505, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0708, Accuracy: 261/1662 (15.7040%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0373, Accuracy: 546/1662 (32.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.8058, Accuracy: 82/10000 (0.8200%)
time spent on training: 265.32642793655396
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.0714, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 6.0638, Accuracy: 0/9950 (0.0000%)
saving model
Done in 512.9319760799408 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0714, Accuracy: 179/708 (25.2825%)
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0406, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.3313, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0976, Accuracy: 16/408 (3.9216%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0579, Accuracy: 128/408 (31.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0436, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0807, Accuracy: 127/1049 (12.1068%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0335, Accuracy: 445/1049 (42.4214%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.8752, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0598, Accuracy: 265/1340 (19.7761%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0288, Accuracy: 541/1340 (40.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.9462, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0563, Accuracy: 232/1013 (22.9023%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0281, Accuracy: 498/1013 (49.1609%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.1980, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0889, Accuracy: 93/605 (15.3719%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0527, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.8579, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0813, Accuracy: 150/1372 (10.9329%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0359, Accuracy: 464/1372 (33.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.0654, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0683, Accuracy: 284/1163 (24.4196%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0414, Accuracy: 459/1163 (39.4669%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.3118, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0544, Accuracy: 233/813 (28.6593%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0204, Accuracy: 463/813 (56.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 13.7261, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0786, Accuracy: 93/603 (15.4229%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0485, Accuracy: 277/603 (45.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.5156, Accuracy: 53/10000 (0.5300%)
time spent on training: 226.7207112312317
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 17.7349, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 6.2410, Accuracy: 715/9950 (7.1859%)
saving model
Done in 472.58115434646606 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0742, Accuracy: 53/486 (10.9053%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 223/486 (45.8848%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.6685, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0645, Accuracy: 290/1715 (16.9096%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0333, Accuracy: 648/1715 (37.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.1141, Accuracy: 78/10000 (0.7800%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 261/1071 (24.3697%)
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0313, Accuracy: 504/1071 (47.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.7351, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0986, Accuracy: 14/460 (3.0435%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0456, Accuracy: 167/460 (36.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.9960, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0763, Accuracy: 103/953 (10.8080%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0438, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4804, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0643, Accuracy: 224/1241 (18.0500%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0403, Accuracy: 398/1241 (32.0709%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5181, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.1012, Accuracy: 4/426 (0.9390%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0526, Accuracy: 137/426 (32.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.1439, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0652, Accuracy: 318/1427 (22.2845%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0350, Accuracy: 551/1427 (38.6125%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.7318, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0756, Accuracy: 112/669 (16.7414%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0432, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.9382, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0528, Accuracy: 234/813 (28.7823%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 479/813 (58.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 13.5158, Accuracy: 68/10000 (0.6800%)
time spent on training: 246.0726661682129
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.1837, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 6.4395, Accuracy: 0/9950 (0.0000%)
saving model
Done in 502.0754392147064 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0881, Accuracy: 81/605 (13.3884%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0516, Accuracy: 329/605 (54.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.9699, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0838, Accuracy: 45/530 (8.4906%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0425, Accuracy: 281/530 (53.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.9898, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0537, Accuracy: 280/1213 (23.0833%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 481/1213 (39.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.0199, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0857, Accuracy: 30/781 (3.8412%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0389, Accuracy: 234/781 (29.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.4164, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0684, Accuracy: 147/773 (19.0168%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 393/773 (50.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.1068, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0570, Accuracy: 367/1470 (24.9660%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0269, Accuracy: 751/1470 (51.0884%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.8262, Accuracy: 94/10000 (0.9400%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0566, Accuracy: 405/1750 (23.1429%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 657/1750 (37.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.4296, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0553, Accuracy: 280/1275 (21.9608%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0210, Accuracy: 656/1275 (51.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 12.0759, Accuracy: 93/10000 (0.9300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0450, Accuracy: 413/1552 (26.6108%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 779/1552 (50.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 12.0093, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0639, Accuracy: 289/1715 (16.8513%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0335, Accuracy: 617/1715 (35.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.2521, Accuracy: 82/10000 (0.8200%)
time spent on training: 285.14455127716064
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 14.9866, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 6.6099, Accuracy: 373/9950 (3.7487%)
saving model
Done in 543.74090051651 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0649, Accuracy: 356/1587 (22.4323%)
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0388, Accuracy: 567/1587 (35.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.2177, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0726, Accuracy: 140/590 (23.7288%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0357, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 13.8178, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0701, Accuracy: 272/1163 (23.3878%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0409, Accuracy: 451/1163 (38.7790%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.3163, Accuracy: 68/10000 (0.6800%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1486, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1363, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.7232, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0758, Accuracy: 125/818 (15.2812%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0333, Accuracy: 310/818 (37.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.9689, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0734, Accuracy: 193/715 (26.9930%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0438, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.4358, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0671, Accuracy: 201/719 (27.9555%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0365, Accuracy: 459/719 (63.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.0638, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 15/373 (4.0214%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0501, Accuracy: 140/373 (37.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.0437, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0700, Accuracy: 254/1662 (15.2828%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0375, Accuracy: 536/1662 (32.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.1498, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0603, Accuracy: 209/636 (32.8616%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0327, Accuracy: 425/636 (66.8239%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.8116, Accuracy: 56/10000 (0.5600%)
time spent on training: 248.25449657440186
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 15.6006, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 7.5781, Accuracy: 232/9950 (2.3317%)
saving model
Done in 503.3772795200348 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0955, Accuracy: 29/631 (4.5959%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0509, Accuracy: 223/631 (35.3407%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8370, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0680, Accuracy: 236/1418 (16.6432%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0359, Accuracy: 512/1418 (36.1072%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.0133, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0657, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 416/773 (53.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.0608, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0628, Accuracy: 329/1427 (23.0554%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0355, Accuracy: 554/1427 (38.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.3296, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0762, Accuracy: 111/953 (11.6474%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0433, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8492, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0768, Accuracy: 107/774 (13.8243%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0428, Accuracy: 331/774 (42.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.6468, Accuracy: 67/10000 (0.6700%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0679, Accuracy: 269/1657 (16.2342%)
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0373, Accuracy: 459/1657 (27.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.7517, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0530, Accuracy: 222/813 (27.3063%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0204, Accuracy: 467/813 (57.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 13.5707, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0953, Accuracy: 13/460 (2.8261%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0448, Accuracy: 173/460 (37.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.0799, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.1025, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0846, Accuracy: 5/186 (2.6882%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5068, Accuracy: 51/10000 (0.5100%)
time spent on training: 253.50805854797363
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 16.0054, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 8.7634, Accuracy: 93/9950 (0.9347%)
saving model
Done in 511.2942657470703 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0582, Accuracy: 205/1013 (20.2369%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0287, Accuracy: 472/1013 (46.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.0884, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0697, Accuracy: 291/1163 (25.0215%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0399, Accuracy: 460/1163 (39.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.4971, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0707, Accuracy: 167/938 (17.8038%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0378, Accuracy: 318/938 (33.9019%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.4325, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0848, Accuracy: 4/311 (1.2862%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0563, Accuracy: 100/311 (32.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6636, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0863, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0515, Accuracy: 131/373 (35.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.9542, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0546, Accuracy: 411/1470 (27.9592%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 780/1470 (53.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.0732, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0594, Accuracy: 307/776 (39.5619%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0315, Accuracy: 364/776 (46.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.0696, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1221, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.1012, Accuracy: 9/197 (4.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.5343, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0622, Accuracy: 334/1427 (23.4057%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 543/1427 (38.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6806, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0742, Accuracy: 160/946 (16.9133%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0399, Accuracy: 389/946 (41.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2696, Accuracy: 72/10000 (0.7200%)
time spent on training: 233.58631467819214
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 15.2446, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 10.5346, Accuracy: 30/9950 (0.3015%)
saving model
Done in 487.3074724674225 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0704, Accuracy: 259/1657 (15.6307%)
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0373, Accuracy: 463/1657 (27.9421%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.7240, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0858, Accuracy: 5/311 (1.6077%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0570, Accuracy: 99/311 (31.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.0583, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0643, Accuracy: 317/1715 (18.4840%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0333, Accuracy: 653/1715 (38.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.1436, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0810, Accuracy: 124/1049 (11.8208%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 492/1049 (46.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.7786, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0731, Accuracy: 212/1154 (18.3709%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0328, Accuracy: 423/1154 (36.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.9765, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0632, Accuracy: 135/735 (18.3673%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0254, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 12.3860, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0741, Accuracy: 293/1956 (14.9796%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0338, Accuracy: 604/1956 (30.8793%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.1690, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0520, Accuracy: 205/813 (25.2153%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0209, Accuracy: 447/813 (54.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 13.1629, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1160, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0967, Accuracy: 12/197 (6.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5036, Accuracy: 64/10000 (0.6400%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0648, Accuracy: 279/1129 (24.7121%)
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0270, Accuracy: 656/1129 (58.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.9281, Accuracy: 85/10000 (0.8500%)
time spent on training: 298.8592698574066
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.1444, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 6.8323, Accuracy: 0/9950 (0.0000%)
saving model
Done in 560.3541111946106 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0637, Accuracy: 369/1587 (23.2514%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0386, Accuracy: 560/1587 (35.2867%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2290, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0640, Accuracy: 309/1904 (16.2290%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0341, Accuracy: 638/1904 (33.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.8186, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0649, Accuracy: 252/1036 (24.3243%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0263, Accuracy: 627/1036 (60.5212%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 13.4658, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0706, Accuracy: 291/1440 (20.2083%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0309, Accuracy: 678/1440 (47.0833%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.8587, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0916, Accuracy: 35/631 (5.5468%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0502, Accuracy: 235/631 (37.2425%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.2152, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1103, Accuracy: 9/134 (6.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2850, Accuracy: 40/10000 (0.4000%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0668, Accuracy: 243/1573 (15.4482%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0388, Accuracy: 540/1573 (34.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.3343, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0831, Accuracy: 163/896 (18.1920%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0401, Accuracy: 456/896 (50.8929%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.4182, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0627, Accuracy: 352/1427 (24.6671%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0348, Accuracy: 554/1427 (38.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.6052, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0696, Accuracy: 350/1953 (17.9211%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0371, Accuracy: 716/1953 (36.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.5875, Accuracy: 107/10000 (1.0700%)
time spent on training: 301.18565487861633
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.1264, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 6.9568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 553.5527520179749 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0550, Accuracy: 312/1275 (24.4706%)
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 681/1275 (53.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 11.5473, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0791, Accuracy: 134/888 (15.0901%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0301, Accuracy: 440/888 (49.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 11.6568, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0824, Accuracy: 147/1372 (10.7143%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0357, Accuracy: 488/1372 (35.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.9876, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0648, Accuracy: 268/1573 (17.0375%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0385, Accuracy: 517/1573 (32.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2860, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0695, Accuracy: 310/1953 (15.8730%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0375, Accuracy: 678/1953 (34.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3676, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0691, Accuracy: 263/1645 (15.9878%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0369, Accuracy: 566/1645 (34.4073%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.0702, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0760, Accuracy: 204/1190 (17.1429%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 450/1190 (37.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.0441, Accuracy: 67/10000 (0.6700%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0548, Accuracy: 324/1628 (19.9017%)
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0280, Accuracy: 705/1628 (43.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.7716, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0575, Accuracy: 325/776 (41.8814%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0330, Accuracy: 354/776 (45.6186%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.2080, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0831, Accuracy: 44/781 (5.6338%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0391, Accuracy: 244/781 (31.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.5269, Accuracy: 68/10000 (0.6800%)
time spent on training: 317.95578026771545
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.1614, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 7.0897, Accuracy: 0/9950 (0.0000%)
saving model
Done in 576.1498739719391 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0694, Accuracy: 236/1089 (21.6713%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0293, Accuracy: 512/1089 (47.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.1849, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0596, Accuracy: 339/1581 (21.4421%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 546/1581 (34.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.7425, Accuracy: 89/10000 (0.8900%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0761, Accuracy: 85/861 (9.8722%)
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0243, Accuracy: 445/861 (51.6841%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 11.7526, Accuracy: 76/10000 (0.7600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0726, Accuracy: 157/599 (26.2104%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0326, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 15.1924, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0800, Accuracy: 162/896 (18.0804%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0407, Accuracy: 463/896 (51.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.3587, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0739, Accuracy: 217/928 (23.3836%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0273, Accuracy: 546/928 (58.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.8580, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0736, Accuracy: 146/590 (24.7458%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0367, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.7262, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0793, Accuracy: 75/809 (9.2707%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0326, Accuracy: 300/809 (37.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.5911, Accuracy: 82/10000 (0.8200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0766, Accuracy: 41/486 (8.4362%)
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 222/486 (45.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.1105, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0619, Accuracy: 254/1574 (16.1372%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0321, Accuracy: 558/1574 (35.4511%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5030, Accuracy: 80/10000 (0.8000%)
time spent on training: 291.12288665771484
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.1749, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 7.1019, Accuracy: 0/9950 (0.0000%)
saving model
Done in 551.2230451107025 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0630, Accuracy: 300/1427 (21.0231%)
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 518/1427 (36.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.3492, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1278, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0846, Accuracy: 22/271 (8.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.5162, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0780, Accuracy: 100/603 (16.5837%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0511, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.6407, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0712, Accuracy: 146/1513 (9.6497%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0417, Accuracy: 395/1513 (26.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.8321, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0677, Accuracy: 197/719 (27.3992%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0344, Accuracy: 459/719 (63.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.0300, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0891, Accuracy: 75/605 (12.3967%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0497, Accuracy: 329/605 (54.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.8444, Accuracy: 55/10000 (0.5500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0604, Accuracy: 220/690 (31.8841%)
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0290, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.5406, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0844, Accuracy: 41/530 (7.7358%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0443, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.7030, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0631, Accuracy: 263/1130 (23.2743%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 448/1130 (39.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.9132, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1165, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0988, Accuracy: 20/197 (10.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.3810, Accuracy: 56/10000 (0.5600%)
time spent on training: 253.26041054725647
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.1451, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 6.7927, Accuracy: 0/9950 (0.0000%)
saving model
Done in 504.4429326057434 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0765, Accuracy: 176/1402 (12.5535%)
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0425, Accuracy: 333/1402 (23.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.6410, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0603, Accuracy: 293/1003 (29.2124%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0373, Accuracy: 366/1003 (36.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.7362, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0762, Accuracy: 107/953 (11.2277%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0423, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5747, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0636, Accuracy: 386/1587 (24.3226%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0386, Accuracy: 535/1587 (33.7114%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.2529, Accuracy: 63/10000 (0.6300%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0671, Accuracy: 266/1129 (23.5607%)
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0281, Accuracy: 638/1129 (56.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.5543, Accuracy: 92/10000 (0.9200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 222/1071 (20.7283%)
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0306, Accuracy: 473/1071 (44.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.9769, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0921, Accuracy: 41/515 (7.9612%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0600, Accuracy: 141/515 (27.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4372, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0787, Accuracy: 80/568 (14.0845%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0467, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5155, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0708, Accuracy: 222/1154 (19.2374%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0327, Accuracy: 393/1154 (34.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 11.7599, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0607, Accuracy: 319/1581 (20.1771%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0367, Accuracy: 518/1581 (32.7641%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.6843, Accuracy: 86/10000 (0.8600%)
time spent on training: 303.5367913246155
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.1507, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 7.3435, Accuracy: 0/9950 (0.0000%)
saving model
Done in 561.0569839477539 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0756, Accuracy: 254/1956 (12.9857%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 554/1956 (28.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.3682, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0849, Accuracy: 22/781 (2.8169%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0411, Accuracy: 221/781 (28.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.5992, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0649, Accuracy: 300/1715 (17.4927%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0343, Accuracy: 653/1715 (38.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.5605, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0761, Accuracy: 197/901 (21.8646%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0358, Accuracy: 420/901 (46.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.3998, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0766, Accuracy: 200/928 (21.5517%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0287, Accuracy: 510/928 (54.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.7223, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 34/338 (10.0592%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0495, Accuracy: 137/338 (40.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.0112, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0868, Accuracy: 46/631 (7.2900%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0481, Accuracy: 251/631 (39.7781%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.4688, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0909, Accuracy: 72/605 (11.9008%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0529, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.9449, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0784, Accuracy: 127/590 (21.5254%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0370, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 13.5318, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0686, Accuracy: 264/1645 (16.0486%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0371, Accuracy: 545/1645 (33.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.2150, Accuracy: 95/10000 (0.9500%)
time spent on training: 265.47905111312866
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.1158, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 7.1870, Accuracy: 0/9950 (0.0000%)
saving model
Done in 521.1836688518524 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0628, Accuracy: 314/1427 (22.0042%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0349, Accuracy: 548/1427 (38.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.6022, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 244/677 (36.0414%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 474/677 (70.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 12.0560, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0851, Accuracy: 105/712 (14.7472%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0294, Accuracy: 450/712 (63.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 11.9326, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0908, Accuracy: 64/605 (10.5785%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0530, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.1655, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.1280, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0851, Accuracy: 16/271 (5.9041%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.1727, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0794, Accuracy: 72/809 (8.8999%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0324, Accuracy: 326/809 (40.2967%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.6389, Accuracy: 84/10000 (0.8400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0585, Accuracy: 393/1988 (19.7686%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0380, Accuracy: 650/1988 (32.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.7322, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0632, Accuracy: 229/1241 (18.4529%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0403, Accuracy: 367/1241 (29.5729%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.7208, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0856, Accuracy: 25/781 (3.2010%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0404, Accuracy: 214/781 (27.4008%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.5244, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0821, Accuracy: 37/530 (6.9811%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.7166, Accuracy: 46/10000 (0.4600%)
time spent on training: 277.4754765033722
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.1248, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 7.7424, Accuracy: 31/9950 (0.3116%)
saving model
Done in 544.670303106308 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0679, Accuracy: 207/891 (23.2323%)
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0312, Accuracy: 440/891 (49.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.2916, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0752, Accuracy: 130/669 (19.4320%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0440, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.7538, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0806, Accuracy: 137/1372 (9.9854%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0367, Accuracy: 460/1372 (33.5277%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.2129, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0546, Accuracy: 271/1213 (22.3413%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0301, Accuracy: 495/1213 (40.8079%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.1239, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0651, Accuracy: 247/1131 (21.8391%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0362, Accuracy: 354/1131 (31.2997%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.3597, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0959, Accuracy: 1/373 (0.2681%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0567, Accuracy: 112/373 (30.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.3137, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0569, Accuracy: 296/1275 (23.2157%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0214, Accuracy: 651/1275 (51.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 12.0057, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0634, Accuracy: 136/735 (18.5034%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0250, Accuracy: 340/735 (46.2585%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 12.4410, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0870, Accuracy: 37/631 (5.8637%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0484, Accuracy: 241/631 (38.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.8467, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0978, Accuracy: 8/460 (1.7391%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0475, Accuracy: 169/460 (36.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.8698, Accuracy: 62/10000 (0.6200%)
time spent on training: 247.46113276481628
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 11.0705, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 7.2368, Accuracy: 153/9950 (1.5377%)
saving model
Done in 502.7956075668335 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0771, Accuracy: 96/953 (10.0735%)
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0439, Accuracy: 313/953 (32.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4641, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0936, Accuracy: 10/500 (2.0000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0567, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.6982, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0982, Accuracy: 3/426 (0.7042%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0505, Accuracy: 146/426 (34.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.2599, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0725, Accuracy: 173/938 (18.4435%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0376, Accuracy: 320/938 (34.1151%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.2934, Accuracy: 49/10000 (0.4900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0731, Accuracy: 153/599 (25.5426%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 16.3832, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0761, Accuracy: 191/1190 (16.0504%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 450/1190 (37.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.0650, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0653, Accuracy: 254/1036 (24.5174%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0262, Accuracy: 615/1036 (59.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 14.2127, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0699, Accuracy: 281/1440 (19.5139%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0322, Accuracy: 646/1440 (44.8611%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.1741, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0590, Accuracy: 209/1013 (20.6318%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0298, Accuracy: 441/1013 (43.5341%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.1851, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0687, Accuracy: 247/1446 (17.0816%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0401, Accuracy: 438/1446 (30.2905%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.5617, Accuracy: 67/10000 (0.6700%)
time spent on training: 275.33220386505127
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.2384, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.4355, Accuracy: 370/9950 (3.7186%)
saving model
Done in 529.7104089260101 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0734, Accuracy: 294/1163 (25.2794%)
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0412, Accuracy: 447/1163 (38.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.3372, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0618, Accuracy: 293/1581 (18.5326%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0372, Accuracy: 520/1581 (32.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.1442, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0731, Accuracy: 191/803 (23.7858%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0406, Accuracy: 436/803 (54.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.2407, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0652, Accuracy: 193/719 (26.8428%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0341, Accuracy: 472/719 (65.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.8735, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0917, Accuracy: 11/416 (2.6442%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0531, Accuracy: 160/416 (38.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.3363, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0685, Accuracy: 295/1440 (20.4861%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0310, Accuracy: 694/1440 (48.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.8207, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0738, Accuracy: 219/1662 (13.1769%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0382, Accuracy: 518/1662 (31.1673%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.9037, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0723, Accuracy: 138/669 (20.6278%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0439, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.9989, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0740, Accuracy: 157/938 (16.7377%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0384, Accuracy: 311/938 (33.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.2310, Accuracy: 54/10000 (0.5400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0684, Accuracy: 249/1154 (21.5771%)
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0343, Accuracy: 379/1154 (32.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.0299, Accuracy: 67/10000 (0.6700%)
time spent on training: 300.3021252155304
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.6196, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 5.7222, Accuracy: 312/9950 (3.1357%)
saving model
Done in 556.5774457454681 sec.
Saving all the graphs.
This run has a label: Jun.17_08.10.30. Visdom environment: tiny
