current path: saved_models/model_tiny_Jun.26_07.39.30
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 10, 30, 44, 55]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [89, 91, 69, 74, 59, 60, 29, 99, 17, 84].
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 324/896 (36.1607%)
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1898, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   1, Avg loss: 0.0516, Accuracy: 335/1030 (32.5243%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 619/1030 (60.0971%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2303, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8688, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 497/1552 (32.0232%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.5205, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   1, Avg loss: 0.0538, Accuracy: 303/1089 (27.8237%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   2, Avg loss: 0.0304, Accuracy: 489/1089 (44.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2262, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 557/2227 (25.0112%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 1008/2227 (45.2627%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.3654, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   1, Avg loss: 0.0482, Accuracy: 431/1440 (29.9306%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   2, Avg loss: 0.0287, Accuracy: 638/1440 (44.3056%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7492, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 167/773 (21.6041%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 373/773 (48.2536%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8549, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 401/1574 (25.4765%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 684/1574 (43.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0668, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 469/1190 (39.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0107, Accuracy: 52/10000 (0.5200%)
time spent on training: 96.5375542640686
[rfa agg] training data poison_ratio: 0.1255561847746946  data num: [896, 1030, 590, 1552, 1089, 2227, 1440, 773, 1574, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.039236307742092066
[rfa agg] init. name: [89, 91, 69, 74, 59, 60, 29, 99, 17, 84], weight: tensor([0.0725, 0.0833, 0.0477, 0.1256, 0.0881, 0.1802, 0.1165, 0.0625, 0.1273,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 56.612579345703125, obj_val: 60.68092346191406, abs dis: 4.0683441162109375
[rfa agg] iter: 0, weight: tensor([0.0463, 0.1012, 0.0184, 0.0951, 0.1535, 0.0465, 0.1414, 0.0344, 0.0968,
        0.2664])
[rfa agg] iter:  1, prev_obj_val: 60.68092346191406, obj_val: 67.1481704711914, abs dis: 6.467247009277344
[rfa agg] iter: 1, weight: tensor([0.0533, 0.1711, 0.0178, 0.0533, 0.2862, 0.0318, 0.0686, 0.0372, 0.0542,
        0.2265])
[rfa agg] iter:  2, prev_obj_val: 67.1481704711914, obj_val: 72.50515747070312, abs dis: 5.356986999511719
[rfa agg] iter: 2, weight: tensor([0.1011, 0.2725, 0.0268, 0.0539, 0.1919, 0.0358, 0.0650, 0.0642, 0.0548,
        0.1342])
[rfa agg] iter:  3, prev_obj_val: 72.50515747070312, obj_val: 69.75480651855469, abs dis: 2.7503509521484375
[rfa agg] iter: 3, weight: tensor([0.1815, 0.2061, 0.0367, 0.0561, 0.1422, 0.0394, 0.0657, 0.1020, 0.0570,
        0.1135])
[rfa agg] iter:  4, prev_obj_val: 69.75480651855469, obj_val: 72.4974365234375, abs dis: 2.7426300048828125
[rfa agg] iter: 4, weight: tensor([0.1371, 0.2470, 0.0318, 0.0558, 0.1624, 0.0382, 0.0662, 0.0816, 0.0567,
        0.1232])
[rfa agg] iter:  5, prev_obj_val: 72.4974365234375, obj_val: 72.493408203125, abs dis: 0.0040283203125
[rfa agg] iter: 5, weight: tensor([0.1831, 0.2048, 0.0367, 0.0560, 0.1419, 0.0394, 0.0656, 0.1022, 0.0569,
        0.1134])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3034, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3552, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.89291334152222 sec.
Server Epoch:2 choose agents : [69, 51, 47, 25, 26, 30, 90, 31, 7, 55].
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   1, Avg loss: 0.0547, Accuracy: 295/590 (50.0000%)
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2023, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 204/1049 (19.4471%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 488/1049 (46.5205%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5224, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1230, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1101, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0581, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0296, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4572, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   1, Avg loss: 0.0562, Accuracy: 318/1446 (21.9917%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 489/1446 (33.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1677, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   1, Avg loss: 0.0581, Accuracy: 290/677 (42.8360%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6763, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.8818, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0267, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1388, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   1, Avg loss: 0.0580, Accuracy: 231/1071 (21.5686%)
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 476/1071 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.3688, Accuracy: 67/10000 (0.6700%)
time spent on training: 136.75180339813232
[rfa agg] training data poison_ratio: 0.2077662129703763  data num: [590, 1049, 134, 690, 1446, 486, 677, 460, 891, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06492694155324259
[rfa agg] init. name: [69, 51, 47, 25, 26, 30, 90, 31, 7, 55], weight: tensor([0.0787, 0.1400, 0.0179, 0.0921, 0.1930, 0.0649, 0.0903, 0.0614, 0.1189,
        0.1429])
[rfa agg] iter:  0, prev_obj_val: 43.751258850097656, obj_val: 50.583885192871094, abs dis: 6.8326263427734375
[rfa agg] iter: 0, weight: tensor([0.1060, 0.0782, 0.0054, 0.2223, 0.0497, 0.0453, 0.2166, 0.0427, 0.1535,
        0.0801])
[rfa agg] iter:  1, prev_obj_val: 50.583885192871094, obj_val: 53.443424224853516, abs dis: 2.859539031982422
[rfa agg] iter: 1, weight: tensor([0.3023, 0.0448, 0.0055, 0.1862, 0.0335, 0.0698, 0.1816, 0.0648, 0.0657,
        0.0458])
[rfa agg] iter:  2, prev_obj_val: 53.443424224853516, obj_val: 56.57199478149414, abs dis: 3.128570556640625
[rfa agg] iter: 2, weight: tensor([0.3024, 0.0473, 0.0066, 0.1486, 0.0365, 0.1036, 0.1457, 0.0948, 0.0661,
        0.0484])
[rfa agg] iter:  3, prev_obj_val: 56.57199478149414, obj_val: 63.27708053588867, abs dis: 6.705085754394531
[rfa agg] iter: 3, weight: tensor([0.2104, 0.0505, 0.0081, 0.1294, 0.0400, 0.1667, 0.1269, 0.1483, 0.0680,
        0.0516])
[rfa agg] iter:  4, prev_obj_val: 63.27708053588867, obj_val: 63.20557403564453, abs dis: 0.07150650024414062
[rfa agg] iter: 4, weight: tensor([0.0955, 0.0385, 0.0081, 0.0753, 0.0320, 0.3374, 0.0739, 0.2511, 0.0488,
        0.0394])
[rfa agg] iter:  5, prev_obj_val: 63.20557403564453, obj_val: 59.79059600830078, abs dis: 3.41497802734375
[rfa agg] iter: 5, weight: tensor([0.0794, 0.0323, 0.0069, 0.0630, 0.0269, 0.3886, 0.0618, 0.2672, 0.0409,
        0.0330])
[rfa agg] iter:  6, prev_obj_val: 59.79059600830078, obj_val: 63.21767044067383, abs dis: 3.427074432373047
[rfa agg] iter: 6, weight: tensor([0.1253, 0.0418, 0.0078, 0.0914, 0.0340, 0.2810, 0.0897, 0.2318, 0.0544,
        0.0427])
[rfa agg] iter:  7, prev_obj_val: 63.21767044067383, obj_val: 63.20115661621094, abs dis: 0.016513824462890625
[rfa agg] iter: 7, weight: tensor([0.0839, 0.0341, 0.0072, 0.0665, 0.0283, 0.3710, 0.0653, 0.2657, 0.0431,
        0.0348])
[rfa agg] iter:  8, prev_obj_val: 63.20115661621094, obj_val: 59.79332733154297, abs dis: 3.4078292846679688
[rfa agg] iter: 8, weight: tensor([0.0764, 0.0312, 0.0067, 0.0607, 0.0259, 0.4008, 0.0595, 0.2676, 0.0394,
        0.0319])
[rfa agg] iter:  9, prev_obj_val: 59.79332733154297, obj_val: 63.21741485595703, abs dis: 3.4240875244140625
[rfa agg] iter: 9, weight: tensor([0.1250, 0.0417, 0.0078, 0.0912, 0.0339, 0.2822, 0.0895, 0.2319, 0.0543,
        0.0426])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3029, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3414, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.756055355072 sec.
Server Epoch:3 choose agents : [81, 63, 8, 90, 20, 15, 4, 75, 0, 12].
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   2, Avg loss: 0.0387, Accuracy: 261/774 (33.7209%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5099, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   1, Avg loss: 0.0570, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 406/888 (45.7207%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2573, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0613, Accuracy: 226/1513 (14.9372%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0377, Accuracy: 443/1513 (29.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9126, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 296/677 (43.7223%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.4073, Accuracy: 57/10000 (0.5700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 390/807 (48.3271%)
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   2, Avg loss: 0.0329, Accuracy: 399/807 (49.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 510/1154 (44.1941%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2337, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0619, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 377/901 (41.8424%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3514, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0630, Accuracy: 230/776 (29.6392%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1177, Accuracy: 49/10000 (0.4900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 340/1657 (20.5190%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1847, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   1, Avg loss: 0.0864, Accuracy: 7/338 (2.0710%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6390, Accuracy: 48/10000 (0.4800%)
time spent on training: 152.01211810112
[rfa agg] training data poison_ratio: 0.25977859778597784  data num: [774, 888, 1513, 677, 807, 1154, 901, 776, 1657, 338]
[rfa agg] considering poison per batch poison_fraction: 0.08118081180811808
[rfa agg] init. name: [81, 63, 8, 90, 20, 15, 4, 75, 0, 12], weight: tensor([0.0816, 0.0936, 0.1595, 0.0714, 0.0851, 0.1217, 0.0950, 0.0818, 0.1747,
        0.0356])
[rfa agg] iter:  0, prev_obj_val: 46.78045654296875, obj_val: 51.075660705566406, abs dis: 4.295204162597656
[rfa agg] iter: 0, weight: tensor([0.0947, 0.1662, 0.0569, 0.0479, 0.0986, 0.1022, 0.2764, 0.0951, 0.0506,
        0.0114])
[rfa agg] iter:  1, prev_obj_val: 51.075660705566406, obj_val: 53.59968948364258, abs dis: 2.524028778076172
[rfa agg] iter: 1, weight: tensor([0.1924, 0.1436, 0.0281, 0.0659, 0.1992, 0.0390, 0.0868, 0.2091, 0.0261,
        0.0098])
[rfa agg] iter:  2, prev_obj_val: 53.59968948364258, obj_val: 56.755653381347656, abs dis: 3.155963897705078
[rfa agg] iter: 2, weight: tensor([0.1921, 0.1176, 0.0294, 0.0937, 0.2091, 0.0394, 0.0759, 0.2038, 0.0275,
        0.0115])
[rfa agg] iter:  3, prev_obj_val: 56.755653381347656, obj_val: 60.128841400146484, abs dis: 3.373188018798828
[rfa agg] iter: 3, weight: tensor([0.1693, 0.1124, 0.0343, 0.1587, 0.1813, 0.0445, 0.0784, 0.1737, 0.0322,
        0.0151])
[rfa agg] iter:  4, prev_obj_val: 60.128841400146484, obj_val: 67.57537841796875, abs dis: 7.446537017822266
[rfa agg] iter: 4, weight: tensor([0.1373, 0.1007, 0.0359, 0.2703, 0.1450, 0.0454, 0.0741, 0.1393, 0.0340,
        0.0179])
[rfa agg] iter:  5, prev_obj_val: 67.57537841796875, obj_val: 67.56914520263672, abs dis: 0.00623321533203125
[rfa agg] iter: 5, weight: tensor([0.1075, 0.0899, 0.0406, 0.3555, 0.1127, 0.0490, 0.0713, 0.1083, 0.0388,
        0.0264])
[rfa agg] iter:  6, prev_obj_val: 67.56914520263672, obj_val: 67.56902313232422, abs dis: 0.0001220703125
[rfa agg] iter: 6, weight: tensor([0.1051, 0.0880, 0.0398, 0.3693, 0.1101, 0.0480, 0.0698, 0.1059, 0.0380,
        0.0259])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3165, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3892, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.81390047073364 sec.
Server Epoch:4 choose agents : [22, 69, 34, 81, 7, 25, 43, 56, 14, 68].
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   1, Avg loss: 0.0479, Accuracy: 527/1470 (35.8503%)
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 812/1470 (55.2381%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0966, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   1, Avg loss: 0.0537, Accuracy: 320/590 (54.2373%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 363/1427 (25.4380%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 539/1427 (37.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.1823, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   1, Avg loss: 0.0673, Accuracy: 262/774 (33.8501%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 313/774 (40.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6365, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.3805, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   2, Avg loss: 0.0286, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7189, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   1, Avg loss: 0.0639, Accuracy: 292/946 (30.8668%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 370/946 (39.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2726, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 76/186 (40.8602%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3589, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 213/1013 (21.0267%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 303/1013 (29.9112%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8419, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   1, Avg loss: 0.0655, Accuracy: 354/1163 (30.4385%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 427/1163 (36.7154%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8780, Accuracy: 52/10000 (0.5200%)
time spent on training: 128.33062863349915
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 590, 1427, 774, 891, 690, 946, 186, 1013, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 69, 34, 81, 7, 25, 43, 56, 14, 68], weight: tensor([0.1607, 0.0645, 0.1560, 0.0846, 0.0974, 0.0754, 0.1034, 0.0203, 0.1107,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 39.94844055175781, obj_val: 47.10869216918945, abs dis: 7.160251617431641
[rfa agg] iter: 0, weight: tensor([0.0436, 0.0279, 0.0423, 0.0869, 0.1696, 0.0406, 0.3179, 0.0036, 0.2002,
        0.0675])
[rfa agg] iter:  1, prev_obj_val: 47.10869216918945, obj_val: 49.72947311401367, abs dis: 2.6207809448242188
[rfa agg] iter: 1, weight: tensor([0.0415, 0.0540, 0.0402, 0.2831, 0.2074, 0.0910, 0.1298, 0.0051, 0.0938,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 49.72947311401367, obj_val: 55.73979949951172, abs dis: 6.010326385498047
[rfa agg] iter: 2, weight: tensor([0.0422, 0.0687, 0.0409, 0.3031, 0.1639, 0.1260, 0.1103, 0.0057, 0.0859,
        0.0535])
[rfa agg] iter:  3, prev_obj_val: 55.73979949951172, obj_val: 52.670841217041016, abs dis: 3.068958282470703
[rfa agg] iter: 3, weight: tensor([0.0437, 0.1223, 0.0423, 0.1658, 0.1175, 0.2814, 0.0908, 0.0072, 0.0763,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 52.670841217041016, obj_val: 52.662845611572266, abs dis: 0.00799560546875
[rfa agg] iter: 4, weight: tensor([0.0451, 0.0950, 0.0437, 0.2186, 0.1416, 0.2054, 0.1037, 0.0068, 0.0845,
        0.0557])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3341, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.4549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.30959582328796 sec.
Server Epoch:5 choose agents : [66, 95, 59, 2, 56, 22, 50, 99, 97, 88].
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0632, Accuracy: 229/1402 (16.3338%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0396, Accuracy: 393/1402 (28.0314%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6581, Accuracy: 65/10000 (0.6500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   1, Avg loss: 0.0537, Accuracy: 308/599 (51.4190%)
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 9.6664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   1, Avg loss: 0.0515, Accuracy: 325/1089 (29.8439%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 469/1089 (43.0670%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1425, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 223/605 (36.8595%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.4546, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4166, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   1, Avg loss: 0.0485, Accuracy: 502/1470 (34.1497%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 804/1470 (54.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3360, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   1, Avg loss: 0.0661, Accuracy: 127/809 (15.6984%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   2, Avg loss: 0.0281, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0632, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0652, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 433/773 (56.0155%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1799, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0549, Accuracy: 353/1213 (29.1014%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 515/1213 (42.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8396, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   1, Avg loss: 0.0747, Accuracy: 123/603 (20.3980%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.8754, Accuracy: 51/10000 (0.5100%)
time spent on training: 132.38530921936035
[rfa agg] training data poison_ratio: 0.06846496742484856  data num: [1402, 599, 1089, 605, 186, 1470, 809, 773, 1213, 603]
[rfa agg] considering poison per batch poison_fraction: 0.021395302320265173
[rfa agg] init. name: [66, 95, 59, 2, 56, 22, 50, 99, 97, 88], weight: tensor([0.1602, 0.0685, 0.1245, 0.0692, 0.0213, 0.1680, 0.0925, 0.0884, 0.1386,
        0.0689])
[rfa agg] iter:  0, prev_obj_val: 46.09318923950195, obj_val: 47.80123519897461, abs dis: 1.7080459594726562
[rfa agg] iter: 0, weight: tensor([0.0931, 0.0556, 0.1606, 0.0562, 0.0071, 0.0857, 0.1785, 0.1683, 0.1386,
        0.0562])
[rfa agg] iter:  1, prev_obj_val: 47.80123519897461, obj_val: 52.040016174316406, abs dis: 4.238780975341797
[rfa agg] iter: 1, weight: tensor([0.0671, 0.0567, 0.1020, 0.0573, 0.0064, 0.0627, 0.2603, 0.2379, 0.0923,
        0.0573])
[rfa agg] iter:  2, prev_obj_val: 52.040016174316406, obj_val: 54.28605270385742, abs dis: 2.2460365295410156
[rfa agg] iter: 2, weight: tensor([0.0444, 0.0691, 0.0589, 0.0698, 0.0058, 0.0422, 0.3104, 0.2729, 0.0560,
        0.0703])
[rfa agg] iter:  3, prev_obj_val: 54.28605270385742, obj_val: 56.66221237182617, abs dis: 2.37615966796875
[rfa agg] iter: 3, weight: tensor([0.0493, 0.0987, 0.0631, 0.0996, 0.0071, 0.0470, 0.2469, 0.2270, 0.0607,
        0.1008])
[rfa agg] iter:  4, prev_obj_val: 56.66221237182617, obj_val: 59.11500549316406, abs dis: 2.4527931213378906
[rfa agg] iter: 4, weight: tensor([0.0499, 0.1347, 0.0620, 0.1361, 0.0079, 0.0478, 0.1871, 0.1756, 0.0602,
        0.1387])
[rfa agg] iter:  5, prev_obj_val: 59.11500549316406, obj_val: 64.66297912597656, abs dis: 5.5479736328125
[rfa agg] iter: 5, weight: tensor([0.0447, 0.1742, 0.0541, 0.1769, 0.0079, 0.0430, 0.1352, 0.1279, 0.0530,
        0.1830])
[rfa agg] iter:  6, prev_obj_val: 64.66297912597656, obj_val: 68.29380798339844, abs dis: 3.630828857421875
[rfa agg] iter: 6, weight: tensor([0.0284, 0.2316, 0.0329, 0.2417, 0.0062, 0.0275, 0.0641, 0.0609, 0.0327,
        0.2740])
[rfa agg] iter:  7, prev_obj_val: 68.29380798339844, obj_val: 68.29336547851562, abs dis: 0.0004425048828125
[rfa agg] iter: 7, weight: tensor([0.0324, 0.2293, 0.0368, 0.2413, 0.0079, 0.0315, 0.0653, 0.0622, 0.0368,
        0.2565])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3994, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.4947, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.036034822464 sec.
Server Epoch:6 choose agents : [45, 90, 0, 20, 60, 91, 57, 35, 47, 74].
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   1, Avg loss: 0.0707, Accuracy: 163/669 (24.3647%)
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.2677, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   1, Avg loss: 0.0517, Accuracy: 320/677 (47.2674%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 413/677 (61.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.6524, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0592, Accuracy: 336/1657 (20.2776%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 503/1657 (30.3561%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7260, Accuracy: 66/10000 (0.6600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 375/807 (46.4684%)
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 415/807 (51.4250%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.3985, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   1, Avg loss: 0.0506, Accuracy: 544/2227 (24.4275%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   2, Avg loss: 0.0288, Accuracy: 1002/2227 (44.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.7194, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   1, Avg loss: 0.0498, Accuracy: 342/1030 (33.2039%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 652/1030 (63.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.5487, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   1, Avg loss: 0.0588, Accuracy: 253/1154 (21.9237%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.9249, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   1, Avg loss: 0.0928, Accuracy: 19/271 (7.0111%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   2, Avg loss: 0.0624, Accuracy: 94/271 (34.6863%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7238, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   1, Avg loss: 0.1173, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   2, Avg loss: 0.1045, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4687, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 779/1552 (50.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 11.5433, Accuracy: 78/10000 (0.7800%)
time spent on training: 168.3945209980011
[rfa agg] training data poison_ratio: 0.39457653763018274  data num: [669, 677, 1657, 807, 2227, 1030, 1154, 271, 134, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.12330516800943211
[rfa agg] init. name: [45, 90, 0, 20, 60, 91, 57, 35, 47, 74], weight: tensor([0.0657, 0.0665, 0.1628, 0.0793, 0.2188, 0.1012, 0.1134, 0.0266, 0.0132,
        0.1525])
[rfa agg] iter:  0, prev_obj_val: 70.71736145019531, obj_val: 74.49435424804688, abs dis: 3.7769927978515625
[rfa agg] iter: 0, weight: tensor([0.0364, 0.0368, 0.1531, 0.0554, 0.0794, 0.1448, 0.3078, 0.0090, 0.0039,
        0.1735])
[rfa agg] iter:  1, prev_obj_val: 74.49435424804688, obj_val: 79.27434539794922, abs dis: 4.779991149902344
[rfa agg] iter: 1, weight: tensor([0.0388, 0.0392, 0.0840, 0.0648, 0.0535, 0.2762, 0.3417, 0.0085, 0.0036,
        0.0897])
[rfa agg] iter:  2, prev_obj_val: 79.27434539794922, obj_val: 79.18624877929688, abs dis: 0.08809661865234375
[rfa agg] iter: 2, weight: tensor([0.0515, 0.0520, 0.0742, 0.0953, 0.0515, 0.3983, 0.1855, 0.0100, 0.0042,
        0.0775])
[rfa agg] iter:  3, prev_obj_val: 79.18624877929688, obj_val: 77.32654571533203, abs dis: 1.8597030639648438
[rfa agg] iter: 3, weight: tensor([0.0478, 0.0484, 0.0689, 0.0890, 0.0478, 0.4469, 0.1661, 0.0093, 0.0039,
        0.0719])
[rfa agg] iter:  4, prev_obj_val: 77.32654571533203, obj_val: 81.25477600097656, abs dis: 3.9282302856445312
[rfa agg] iter: 4, weight: tensor([0.0380, 0.0385, 0.0629, 0.0679, 0.0426, 0.5034, 0.1696, 0.0077, 0.0033,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 81.25477600097656, obj_val: 81.23307800292969, abs dis: 0.021697998046875
[rfa agg] iter: 5, weight: tensor([0.0590, 0.0597, 0.0738, 0.1151, 0.0525, 0.3887, 0.1593, 0.0109, 0.0045,
        0.0766])
[rfa agg] iter:  6, prev_obj_val: 81.23307800292969, obj_val: 81.23270416259766, abs dis: 0.00037384033203125
[rfa agg] iter: 6, weight: tensor([0.0604, 0.0611, 0.0753, 0.1184, 0.0536, 0.3740, 0.1633, 0.0112, 0.0046,
        0.0782])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5079, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3540, Accuracy: 0/9950 (0.0000%)
saving model
Done in 327.02160143852234 sec.
Server Epoch:7 choose agents : [59, 65, 35, 25, 75, 57, 85, 89, 11, 97].
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   1, Avg loss: 0.0578, Accuracy: 293/1089 (26.9054%)
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 443/1089 (40.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 13.0492, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   1, Avg loss: 0.0579, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 632/1475 (42.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5707, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0928, Accuracy: 7/271 (2.5830%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0596, Accuracy: 94/271 (34.6863%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7791, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0555, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4078, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   1, Avg loss: 0.0664, Accuracy: 203/776 (26.1598%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8431, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   1, Avg loss: 0.0589, Accuracy: 245/1154 (21.2305%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   2, Avg loss: 0.0276, Accuracy: 425/1154 (36.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.8158, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0549, Accuracy: 491/1988 (24.6982%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 647/1988 (32.5453%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.0131, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   1, Avg loss: 0.0661, Accuracy: 273/896 (30.4688%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   2, Avg loss: 0.0352, Accuracy: 452/896 (50.4464%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.7456, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 335/712 (47.0506%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3901, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   1, Avg loss: 0.0553, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 482/1213 (39.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1065, Accuracy: 80/10000 (0.8000%)
time spent on training: 126.47109746932983
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1475, 271, 690, 776, 1154, 1988, 896, 712, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 65, 35, 25, 75, 57, 85, 89, 11, 97], weight: tensor([0.1061, 0.1437, 0.0264, 0.0672, 0.0756, 0.1124, 0.1937, 0.0873, 0.0694,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 56.67802047729492, obj_val: 60.80377960205078, abs dis: 4.125759124755859
[rfa agg] iter: 0, weight: tensor([0.1970, 0.0778, 0.0084, 0.0427, 0.0707, 0.1879, 0.0495, 0.1062, 0.0527,
        0.2072])
[rfa agg] iter:  1, prev_obj_val: 60.80377960205078, obj_val: 62.31877136230469, abs dis: 1.5149917602539062
[rfa agg] iter: 1, weight: tensor([0.1483, 0.0696, 0.0103, 0.0609, 0.1174, 0.1278, 0.0487, 0.2004, 0.0801,
        0.1364])
[rfa agg] iter:  2, prev_obj_val: 62.31877136230469, obj_val: 63.95014953613281, abs dis: 1.631378173828125
[rfa agg] iter: 2, weight: tensor([0.1200, 0.0619, 0.0102, 0.0643, 0.1356, 0.1060, 0.0445, 0.2571, 0.0875,
        0.1129])
[rfa agg] iter:  3, prev_obj_val: 63.95014953613281, obj_val: 65.76412200927734, abs dis: 1.8139724731445312
[rfa agg] iter: 3, weight: tensor([0.0939, 0.0521, 0.0095, 0.0649, 0.1531, 0.0843, 0.0384, 0.3223, 0.0921,
        0.0896])
[rfa agg] iter:  4, prev_obj_val: 65.76412200927734, obj_val: 67.91413116455078, abs dis: 2.1500091552734375
[rfa agg] iter: 4, weight: tensor([0.0726, 0.0430, 0.0087, 0.0651, 0.1771, 0.0661, 0.0324, 0.3676, 0.0974,
        0.0701])
[rfa agg] iter:  5, prev_obj_val: 67.91413116455078, obj_val: 73.174072265625, abs dis: 5.259941101074219
[rfa agg] iter: 5, weight: tensor([0.0634, 0.0396, 0.0089, 0.0743, 0.2362, 0.0583, 0.0305, 0.3079, 0.1192,
        0.0618])
[rfa agg] iter:  6, prev_obj_val: 73.174072265625, obj_val: 79.6151123046875, abs dis: 6.4410400390625
[rfa agg] iter: 6, weight: tensor([0.0547, 0.0373, 0.0103, 0.1182, 0.2582, 0.0512, 0.0298, 0.1579, 0.2282,
        0.0541])
[rfa agg] iter:  7, prev_obj_val: 79.6151123046875, obj_val: 87.205810546875, abs dis: 7.5906982421875
[rfa agg] iter: 7, weight: tensor([0.0502, 0.0367, 0.0126, 0.2458, 0.1465, 0.0475, 0.0302, 0.1057, 0.2746,
        0.0501])
[rfa agg] iter:  8, prev_obj_val: 87.205810546875, obj_val: 73.18560791015625, abs dis: 14.02020263671875
[rfa agg] iter: 8, weight: tensor([0.0553, 0.0428, 0.0186, 0.3498, 0.1161, 0.0529, 0.0363, 0.0972, 0.1753,
        0.0558])
[rfa agg] iter:  9, prev_obj_val: 73.18560791015625, obj_val: 79.60090637207031, abs dis: 6.4152984619140625
[rfa agg] iter: 9, weight: tensor([0.0543, 0.0371, 0.0103, 0.1265, 0.2302, 0.0509, 0.0296, 0.1457, 0.2617,
        0.0537])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6972, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.4881, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.43903136253357 sec.
Server Epoch:8 choose agents : [69, 25, 14, 1, 63, 31, 49, 18, 13, 67].
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   1, Avg loss: 0.0515, Accuracy: 320/590 (54.2373%)
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   2, Avg loss: 0.0291, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.3156, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   1, Avg loss: 0.0556, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   2, Avg loss: 0.0289, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.3076, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0672, Accuracy: 167/1013 (16.4857%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0366, Accuracy: 325/1013 (32.0829%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.3439, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0559, Accuracy: 297/928 (32.0043%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 530/928 (57.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2555, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0569, Accuracy: 220/888 (24.7748%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.6662, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   1, Avg loss: 0.0763, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   2, Avg loss: 0.0353, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6960, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   1, Avg loss: 0.0816, Accuracy: 8/440 (1.8182%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0769, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   1, Avg loss: 0.0819, Accuracy: 88/530 (16.6038%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8094, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0590, Accuracy: 289/1645 (17.5684%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 594/1645 (36.1094%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2911, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   1, Avg loss: 0.0780, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   2, Avg loss: 0.0429, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6027, Accuracy: 50/10000 (0.5000%)
time spent on training: 120.67360734939575
[rfa agg] training data poison_ratio: 0.0  data num: [590, 690, 1013, 928, 888, 460, 440, 530, 1645, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 25, 14, 1, 63, 31, 49, 18, 13, 67], weight: tensor([0.0775, 0.0907, 0.1331, 0.1219, 0.1167, 0.0604, 0.0578, 0.0696, 0.2162,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 49.63933181762695, obj_val: 54.727272033691406, abs dis: 5.087940216064453
[rfa agg] iter: 0, weight: tensor([0.1173, 0.2304, 0.1051, 0.1257, 0.1767, 0.0483, 0.0370, 0.0735, 0.0502,
        0.0358])
[rfa agg] iter:  1, prev_obj_val: 54.727272033691406, obj_val: 61.85788345336914, abs dis: 7.130611419677734
[rfa agg] iter: 1, weight: tensor([0.2586, 0.1970, 0.0567, 0.0621, 0.0745, 0.0731, 0.0479, 0.1489, 0.0350,
        0.0463])
[rfa agg] iter:  2, prev_obj_val: 61.85788345336914, obj_val: 64.8101577758789, abs dis: 2.9522743225097656
[rfa agg] iter: 2, weight: tensor([0.1245, 0.0907, 0.0456, 0.0481, 0.0545, 0.1920, 0.0894, 0.2375, 0.0320,
        0.0856])
[rfa agg] iter:  3, prev_obj_val: 64.8101577758789, obj_val: 71.82728576660156, abs dis: 7.017127990722656
[rfa agg] iter: 3, weight: tensor([0.0909, 0.0722, 0.0407, 0.0425, 0.0475, 0.2867, 0.1203, 0.1555, 0.0296,
        0.1140])
[rfa agg] iter:  4, prev_obj_val: 71.82728576660156, obj_val: 68.1341323852539, abs dis: 3.6931533813476562
[rfa agg] iter: 4, weight: tensor([0.0665, 0.0585, 0.0387, 0.0398, 0.0436, 0.1460, 0.2554, 0.0889, 0.0299,
        0.2328])
[rfa agg] iter:  5, prev_obj_val: 68.1341323852539, obj_val: 71.79364776611328, abs dis: 3.659515380859375
[rfa agg] iter: 5, weight: tensor([0.0736, 0.0621, 0.0383, 0.0396, 0.0438, 0.2137, 0.2033, 0.1076, 0.0288,
        0.1891])
[rfa agg] iter:  6, prev_obj_val: 71.79364776611328, obj_val: 68.1383285522461, abs dis: 3.6553192138671875
[rfa agg] iter: 6, weight: tensor([0.0626, 0.0551, 0.0364, 0.0375, 0.0411, 0.1369, 0.2722, 0.0836, 0.0282,
        0.2463])
[rfa agg] iter:  7, prev_obj_val: 68.1383285522461, obj_val: 71.79301452636719, abs dis: 3.6546859741210938
[rfa agg] iter: 7, weight: tensor([0.0732, 0.0618, 0.0381, 0.0394, 0.0436, 0.2119, 0.2055, 0.1070, 0.0286,
        0.1910])
[rfa agg] iter:  8, prev_obj_val: 71.79301452636719, obj_val: 68.13847351074219, abs dis: 3.654541015625
[rfa agg] iter: 8, weight: tensor([0.0625, 0.0550, 0.0364, 0.0374, 0.0410, 0.1366, 0.2728, 0.0835, 0.0282,
        0.2467])
[rfa agg] iter:  9, prev_obj_val: 68.13847351074219, obj_val: 71.7929916381836, abs dis: 3.6545181274414062
[rfa agg] iter: 9, weight: tensor([0.0732, 0.0618, 0.0381, 0.0394, 0.0436, 0.2118, 0.2056, 0.1069, 0.0286,
        0.1910])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4786, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 6.4083, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.37802147865295 sec.
Server Epoch:9 choose agents : [40, 90, 65, 14, 93, 30, 56, 82, 39, 99].
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   1, Avg loss: 0.0564, Accuracy: 309/1573 (19.6440%)
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 569/1573 (36.1729%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7735, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0511, Accuracy: 336/677 (49.6307%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0206, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.2751, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0599, Accuracy: 367/1475 (24.8814%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 671/1475 (45.4915%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2812, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   1, Avg loss: 0.0673, Accuracy: 187/1013 (18.4600%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 360/1013 (35.5380%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2127, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0568, Accuracy: 396/1742 (22.7325%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 679/1742 (38.9782%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.3368, Accuracy: 77/10000 (0.7700%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   1, Avg loss: 0.0773, Accuracy: 74/486 (15.2263%)
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   2, Avg loss: 0.0416, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0812, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0816, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0656, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.9334, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   1, Avg loss: 0.0790, Accuracy: 44/500 (8.8000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9819, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   1, Avg loss: 0.0550, Accuracy: 267/1013 (26.3574%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 461/1013 (45.5084%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0475, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0677, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 387/773 (50.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0859, Accuracy: 70/10000 (0.7000%)
time spent on training: 129.26841616630554
[rfa agg] training data poison_ratio: 0.05149396058486968  data num: [1573, 677, 1475, 1013, 1742, 486, 186, 500, 1013, 773]
[rfa agg] considering poison per batch poison_fraction: 0.016091862682771775
[rfa agg] init. name: [40, 90, 65, 14, 93, 30, 56, 82, 39, 99], weight: tensor([0.1667, 0.0717, 0.1563, 0.1073, 0.1846, 0.0515, 0.0197, 0.0530, 0.1073,
        0.0819])
[rfa agg] iter:  0, prev_obj_val: 60.87725067138672, obj_val: 61.88894271850586, abs dis: 1.0116920471191406
[rfa agg] iter: 0, weight: tensor([0.0811, 0.0466, 0.0861, 0.2926, 0.0656, 0.0223, 0.0054, 0.0230, 0.2990,
        0.0783])
[rfa agg] iter:  1, prev_obj_val: 61.88894271850586, obj_val: 66.7780532836914, abs dis: 4.889110565185547
[rfa agg] iter: 1, weight: tensor([0.0502, 0.0387, 0.0525, 0.3439, 0.0419, 0.0174, 0.0040, 0.0179, 0.3628,
        0.0708])
[rfa agg] iter:  2, prev_obj_val: 66.7780532836914, obj_val: 68.68790435791016, abs dis: 1.90985107421875
[rfa agg] iter: 2, weight: tensor([0.0620, 0.0782, 0.0638, 0.2471, 0.0536, 0.0307, 0.0065, 0.0316, 0.2507,
        0.1758])
[rfa agg] iter:  3, prev_obj_val: 68.68790435791016, obj_val: 68.67469024658203, abs dis: 0.013214111328125
[rfa agg] iter: 3, weight: tensor([0.0614, 0.0943, 0.0630, 0.1998, 0.0535, 0.0345, 0.0071, 0.0355, 0.2013,
        0.2496])
[rfa agg] iter:  4, prev_obj_val: 68.67469024658203, obj_val: 70.71156311035156, abs dis: 2.0368728637695312
[rfa agg] iter: 4, weight: tensor([0.0609, 0.0937, 0.0625, 0.1962, 0.0531, 0.0342, 0.0070, 0.0352, 0.1978,
        0.2594])
[rfa agg] iter:  5, prev_obj_val: 70.71156311035156, obj_val: 77.9879150390625, abs dis: 7.2763519287109375
[rfa agg] iter: 5, weight: tensor([0.0558, 0.1062, 0.0570, 0.1553, 0.0491, 0.0357, 0.0070, 0.0367, 0.1562,
        0.3411])
[rfa agg] iter:  6, prev_obj_val: 77.9879150390625, obj_val: 77.96397399902344, abs dis: 0.0239410400390625
[rfa agg] iter: 6, weight: tensor([0.0529, 0.2359, 0.0536, 0.1079, 0.0477, 0.0519, 0.0087, 0.0534, 0.1082,
        0.2799])
[rfa agg] iter:  7, prev_obj_val: 77.96397399902344, obj_val: 77.9637680053711, abs dis: 0.00020599365234375
[rfa agg] iter: 7, weight: tensor([0.0525, 0.2488, 0.0531, 0.1068, 0.0473, 0.0517, 0.0086, 0.0532, 0.1071,
        0.2708])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8680, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 7.5913, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.9408588409424 sec.
Server Epoch:10 choose agents : [77, 16, 60, 47, 94, 33, 61, 95, 30, 6].
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 300/1340 (22.3881%)
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.0521, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   1, Avg loss: 0.0794, Accuracy: 178/708 (25.1412%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   2, Avg loss: 0.0385, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6864, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   1, Avg loss: 0.0518, Accuracy: 505/2227 (22.6762%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 990/2227 (44.4544%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8188, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   1, Avg loss: 0.1230, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   2, Avg loss: 0.1065, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7954, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   1, Avg loss: 0.0595, Accuracy: 335/1662 (20.1564%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 601/1662 (36.1613%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0503, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   1, Avg loss: 0.0892, Accuracy: 3/515 (0.5825%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   2, Avg loss: 0.0556, Accuracy: 141/515 (27.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7994, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1333, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1247, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8653, Accuracy: 54/10000 (0.5400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 299/599 (49.9165%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 10.4917, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0767, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3337, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 340/1956 (17.3824%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 635/1956 (32.4642%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6079, Accuracy: 96/10000 (0.9600%)
time spent on training: 150.40822958946228
[rfa agg] training data poison_ratio: 0.1117174629324547  data num: [1340, 708, 2227, 134, 1662, 515, 85, 599, 486, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034911707166392095
[rfa agg] init. name: [77, 16, 60, 47, 94, 33, 61, 95, 30, 6], weight: tensor([0.1380, 0.0729, 0.2293, 0.0138, 0.1711, 0.0530, 0.0088, 0.0617, 0.0500,
        0.2014])
[rfa agg] iter:  0, prev_obj_val: 82.35310363769531, obj_val: 84.92381286621094, abs dis: 2.570709228515625
[rfa agg] iter: 0, weight: tensor([0.5135, 0.0384, 0.0850, 0.0037, 0.1850, 0.0212, 0.0022, 0.0268, 0.0186,
        0.1056])
[rfa agg] iter:  1, prev_obj_val: 84.92381286621094, obj_val: 84.86759185791016, abs dis: 0.05622100830078125
[rfa agg] iter: 1, weight: tensor([0.6443, 0.0339, 0.0626, 0.0031, 0.1213, 0.0182, 0.0018, 0.0233, 0.0158,
        0.0756])
[rfa agg] iter:  2, prev_obj_val: 84.86759185791016, obj_val: 86.88717651367188, abs dis: 2.0195846557617188
[rfa agg] iter: 2, weight: tensor([0.6862, 0.0300, 0.0554, 0.0027, 0.1067, 0.0161, 0.0016, 0.0206, 0.0140,
        0.0667])
[rfa agg] iter:  3, prev_obj_val: 86.88717651367188, obj_val: 84.88217163085938, abs dis: 2.0050048828125
[rfa agg] iter: 3, weight: tensor([0.5934, 0.0424, 0.0714, 0.0037, 0.1309, 0.0225, 0.0022, 0.0288, 0.0195,
        0.0851])
[rfa agg] iter:  4, prev_obj_val: 84.88217163085938, obj_val: 84.8631591796875, abs dis: 0.019012451171875
[rfa agg] iter: 4, weight: tensor([0.6708, 0.0314, 0.0580, 0.0029, 0.1120, 0.0169, 0.0017, 0.0216, 0.0147,
        0.0700])
[rfa agg] iter:  5, prev_obj_val: 84.8631591796875, obj_val: 84.86126708984375, abs dis: 0.00189208984375
[rfa agg] iter: 5, weight: tensor([0.6943, 0.0292, 0.0539, 0.0027, 0.1039, 0.0157, 0.0016, 0.0200, 0.0137,
        0.0650])
[rfa agg] iter:  6, prev_obj_val: 84.86126708984375, obj_val: 86.892822265625, abs dis: 2.03155517578125
[rfa agg] iter: 6, weight: tensor([0.7013, 0.0285, 0.0527, 0.0026, 0.1014, 0.0154, 0.0015, 0.0196, 0.0133,
        0.0635])
[rfa agg] iter:  7, prev_obj_val: 86.892822265625, obj_val: 84.8814697265625, abs dis: 2.0113525390625
[rfa agg] iter: 7, weight: tensor([0.5954, 0.0422, 0.0711, 0.0037, 0.1303, 0.0224, 0.0022, 0.0287, 0.0194,
        0.0847])
[rfa agg] iter:  8, prev_obj_val: 84.8814697265625, obj_val: 84.86309051513672, abs dis: 0.01837921142578125
[rfa agg] iter: 8, weight: tensor([0.6714, 0.0314, 0.0579, 0.0029, 0.1118, 0.0169, 0.0017, 0.0215, 0.0147,
        0.0699])
[rfa agg] iter:  9, prev_obj_val: 84.86309051513672, obj_val: 84.86126708984375, abs dis: 0.00182342529296875
[rfa agg] iter: 9, weight: tensor([0.6945, 0.0292, 0.0539, 0.0027, 0.1038, 0.0157, 0.0016, 0.0200, 0.0136,
        0.0650])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7913, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 8.3751, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.8628635406494 sec.
Server Epoch:11 choose agents : [26, 84, 32, 6, 99, 13, 93, 12, 28, 15].
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0576, Accuracy: 291/1446 (20.1245%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6391, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 291/1190 (24.4538%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 415/1190 (34.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4437, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0679, Accuracy: 125/735 (17.0068%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.4251, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0555, Accuracy: 357/1956 (18.2515%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0331, Accuracy: 623/1956 (31.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3236, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   1, Avg loss: 0.0651, Accuracy: 178/773 (23.0272%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 425/773 (54.9806%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.7116, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0599, Accuracy: 303/1645 (18.4195%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 593/1645 (36.0486%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9642, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0584, Accuracy: 381/1742 (21.8714%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 681/1742 (39.0930%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8396, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0887, Accuracy: 11/338 (3.2544%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0507, Accuracy: 133/338 (39.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6102, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   1, Avg loss: 0.0592, Accuracy: 355/1581 (22.4541%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   2, Avg loss: 0.0352, Accuracy: 541/1581 (34.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1508, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   1, Avg loss: 0.0598, Accuracy: 284/1154 (24.6101%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 466/1154 (40.3813%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8312, Accuracy: 87/10000 (0.8700%)
time spent on training: 142.47981524467468
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 1190, 735, 1956, 773, 1645, 1742, 338, 1581, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 84, 32, 6, 99, 13, 93, 12, 28, 15], weight: tensor([0.1151, 0.0947, 0.0585, 0.1557, 0.0615, 0.1310, 0.1387, 0.0269, 0.1259,
        0.0919])
[rfa agg] iter:  0, prev_obj_val: 54.419227600097656, obj_val: 57.74406051635742, abs dis: 3.3248329162597656
[rfa agg] iter: 0, weight: tensor([0.1784, 0.2084, 0.0288, 0.0619, 0.0342, 0.0975, 0.0765, 0.0078, 0.1127,
        0.1938])
[rfa agg] iter:  1, prev_obj_val: 57.74406051635742, obj_val: 59.77285385131836, abs dis: 2.0287933349609375
[rfa agg] iter: 1, weight: tensor([0.1149, 0.2942, 0.0281, 0.0488, 0.0339, 0.0717, 0.0583, 0.0072, 0.0806,
        0.2623])
[rfa agg] iter:  2, prev_obj_val: 59.77285385131836, obj_val: 65.01126098632812, abs dis: 5.238407135009766
[rfa agg] iter: 2, weight: tensor([0.0934, 0.3306, 0.0278, 0.0433, 0.0339, 0.0617, 0.0511, 0.0069, 0.0685,
        0.2829])
[rfa agg] iter:  3, prev_obj_val: 65.01126098632812, obj_val: 62.23786544799805, abs dis: 2.773395538330078
[rfa agg] iter: 3, weight: tensor([0.0945, 0.2926, 0.0404, 0.0500, 0.0505, 0.0678, 0.0576, 0.0093, 0.0740,
        0.2632])
[rfa agg] iter:  4, prev_obj_val: 62.23786544799805, obj_val: 62.235198974609375, abs dis: 0.002666473388671875
[rfa agg] iter: 4, weight: tensor([0.0907, 0.3199, 0.0325, 0.0452, 0.0401, 0.0627, 0.0526, 0.0078, 0.0690,
        0.2796])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.5770, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 10.1910, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.98071479797363 sec.
Server Epoch:12 choose agents : [39, 86, 0, 34, 36, 92, 67, 30, 23, 15].
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 300/1013 (29.6150%)
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   2, Avg loss: 0.0274, Accuracy: 458/1013 (45.2122%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2536, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 335/1003 (33.3998%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1442, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   1, Avg loss: 0.0599, Accuracy: 322/1657 (19.4327%)
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0797, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0564, Accuracy: 401/1427 (28.1009%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0343, Accuracy: 597/1427 (41.8360%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6094, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0960, Accuracy: 12/408 (2.9412%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0594, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.3226, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0548, Accuracy: 395/1715 (23.0321%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0316, Accuracy: 667/1715 (38.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.9300, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   1, Avg loss: 0.0782, Accuracy: 50/426 (11.7371%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   2, Avg loss: 0.0443, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4977, Accuracy: 53/10000 (0.5300%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0814, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0435, Accuracy: 206/486 (42.3868%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1233, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   1, Avg loss: 0.0632, Accuracy: 268/715 (37.4825%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   2, Avg loss: 0.0368, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.2030, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   1, Avg loss: 0.0589, Accuracy: 295/1154 (25.5633%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6680, Accuracy: 70/10000 (0.7000%)
time spent on training: 159.9271764755249
[rfa agg] training data poison_ratio: 0.21421431427429027  data num: [1013, 1003, 1657, 1427, 408, 1715, 426, 486, 715, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06694197321071571
[rfa agg] init. name: [39, 86, 0, 34, 36, 92, 67, 30, 23, 15], weight: tensor([0.1013, 0.1003, 0.1656, 0.1426, 0.0408, 0.1714, 0.0426, 0.0486, 0.0715,
        0.1154])
[rfa agg] iter:  0, prev_obj_val: 56.62464904785156, obj_val: 59.055641174316406, abs dis: 2.4309921264648438
[rfa agg] iter: 0, weight: tensor([0.2551, 0.2552, 0.0665, 0.0846, 0.0147, 0.0619, 0.0154, 0.0195, 0.0509,
        0.1763])
[rfa agg] iter:  1, prev_obj_val: 59.055641174316406, obj_val: 63.294246673583984, abs dis: 4.238605499267578
[rfa agg] iter: 1, weight: tensor([0.3184, 0.3337, 0.0476, 0.0580, 0.0130, 0.0448, 0.0136, 0.0174, 0.0498,
        0.1037])
[rfa agg] iter:  2, prev_obj_val: 63.294246673583984, obj_val: 65.76628112792969, abs dis: 2.472034454345703
[rfa agg] iter: 2, weight: tensor([0.2858, 0.2907, 0.0558, 0.0656, 0.0188, 0.0529, 0.0196, 0.0256, 0.0829,
        0.1024])
[rfa agg] iter:  3, prev_obj_val: 65.76628112792969, obj_val: 60.99515151977539, abs dis: 4.771129608154297
[rfa agg] iter: 3, weight: tensor([0.2531, 0.2535, 0.0622, 0.0720, 0.0232, 0.0592, 0.0242, 0.0320, 0.1135,
        0.1071])
[rfa agg] iter:  4, prev_obj_val: 60.99515151977539, obj_val: 63.290870666503906, abs dis: 2.2957191467285156
[rfa agg] iter: 4, weight: tensor([0.3126, 0.3188, 0.0499, 0.0596, 0.0151, 0.0471, 0.0158, 0.0204, 0.0623,
        0.0985])
[rfa agg] iter:  5, prev_obj_val: 63.290870666503906, obj_val: 65.76618957519531, abs dis: 2.4753189086914062
[rfa agg] iter: 5, weight: tensor([0.2865, 0.2893, 0.0559, 0.0657, 0.0188, 0.0530, 0.0196, 0.0256, 0.0832,
        0.1025])
[rfa agg] iter:  6, prev_obj_val: 65.76618957519531, obj_val: 60.995155334472656, abs dis: 4.771034240722656
[rfa agg] iter: 6, weight: tensor([0.2532, 0.2534, 0.0622, 0.0720, 0.0232, 0.0592, 0.0242, 0.0320, 0.1135,
        0.1071])
[rfa agg] iter:  7, prev_obj_val: 60.995155334472656, obj_val: 63.290870666503906, abs dis: 2.29571533203125
[rfa agg] iter: 7, weight: tensor([0.3126, 0.3187, 0.0499, 0.0596, 0.0151, 0.0471, 0.0158, 0.0204, 0.0623,
        0.0985])
[rfa agg] iter:  8, prev_obj_val: 63.290870666503906, obj_val: 65.76618957519531, abs dis: 2.4753189086914062
[rfa agg] iter: 8, weight: tensor([0.2865, 0.2893, 0.0559, 0.0657, 0.0188, 0.0530, 0.0196, 0.0256, 0.0832,
        0.1025])
[rfa agg] iter:  9, prev_obj_val: 65.76618957519531, obj_val: 60.995155334472656, abs dis: 4.771034240722656
[rfa agg] iter: 9, weight: tensor([0.2532, 0.2534, 0.0622, 0.0720, 0.0232, 0.0592, 0.0242, 0.0320, 0.1135,
        0.1071])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.5823, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 11.8300, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.6532983779907 sec.
Server Epoch:13 choose agents : [38, 81, 76, 16, 60, 7, 18, 54, 50, 25].
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   1, Avg loss: 0.0663, Accuracy: 199/1131 (17.5950%)
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1360, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   2, Avg loss: 0.0373, Accuracy: 290/774 (37.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.2387, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0940, Accuracy: 7/466 (1.5021%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0530, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.6676, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0721, Accuracy: 193/708 (27.2599%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0411, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0197, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0522, Accuracy: 527/2227 (23.6641%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0290, Accuracy: 993/2227 (44.5891%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7167, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0569, Accuracy: 338/891 (37.9349%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0272, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1516, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0886, Accuracy: 62/530 (11.6981%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0424, Accuracy: 262/530 (49.4340%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4541, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 319/1130 (28.2301%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 471/1130 (41.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.8332, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0675, Accuracy: 136/809 (16.8109%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0292, Accuracy: 320/809 (39.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.6655, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   1, Avg loss: 0.0604, Accuracy: 255/690 (36.9565%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   2, Avg loss: 0.0285, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2838, Accuracy: 60/10000 (0.6000%)
time spent on training: 126.88539338111877
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 774, 466, 708, 2227, 891, 530, 1130, 809, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 81, 76, 16, 60, 7, 18, 54, 50, 25], weight: tensor([0.1209, 0.0827, 0.0498, 0.0757, 0.2380, 0.0952, 0.0566, 0.1208, 0.0865,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 66.04859161376953, obj_val: 65.95833587646484, abs dis: 0.0902557373046875
[rfa agg] iter: 0, weight: tensor([0.2371, 0.0857, 0.0221, 0.0619, 0.0488, 0.1306, 0.0284, 0.2457, 0.0896,
        0.0501])
[rfa agg] iter:  1, prev_obj_val: 65.95833587646484, obj_val: 69.34687042236328, abs dis: 3.3885345458984375
[rfa agg] iter: 1, weight: tensor([0.0846, 0.1600, 0.0235, 0.0943, 0.0327, 0.2465, 0.0320, 0.0850, 0.1744,
        0.0670])
[rfa agg] iter:  2, prev_obj_val: 69.34687042236328, obj_val: 83.31050109863281, abs dis: 13.963630676269531
[rfa agg] iter: 2, weight: tensor([0.0549, 0.1819, 0.0275, 0.1611, 0.0270, 0.1371, 0.0398, 0.0551, 0.2115,
        0.1042])
[rfa agg] iter:  3, prev_obj_val: 83.31050109863281, obj_val: 76.75729370117188, abs dis: 6.5532073974609375
[rfa agg] iter: 3, weight: tensor([0.0561, 0.0983, 0.0824, 0.1275, 0.0357, 0.0864, 0.1518, 0.0562, 0.1041,
        0.2015])
[rfa agg] iter:  4, prev_obj_val: 76.75729370117188, obj_val: 83.2440185546875, abs dis: 6.486724853515625
[rfa agg] iter: 4, weight: tensor([0.0502, 0.1077, 0.0468, 0.1588, 0.0293, 0.0874, 0.0777, 0.0503, 0.1143,
        0.2775])
[rfa agg] iter:  5, prev_obj_val: 83.2440185546875, obj_val: 86.71378326416016, abs dis: 3.4697647094726562
[rfa agg] iter: 5, weight: tensor([0.0545, 0.0948, 0.0815, 0.1244, 0.0347, 0.0835, 0.1546, 0.0546, 0.1000,
        0.2174])
[rfa agg] iter:  6, prev_obj_val: 86.71378326416016, obj_val: 83.23812866210938, abs dis: 3.4756546020507812
[rfa agg] iter: 6, weight: tensor([0.0533, 0.0856, 0.1065, 0.1066, 0.0353, 0.0776, 0.2261, 0.0533, 0.0900,
        0.1659])
[rfa agg] iter:  7, prev_obj_val: 83.23812866210938, obj_val: 86.7114486694336, abs dis: 3.4733200073242188
[rfa agg] iter: 7, weight: tensor([0.0542, 0.0943, 0.0825, 0.1228, 0.0346, 0.0830, 0.1664, 0.0543, 0.0991,
        0.2088])
[rfa agg] iter:  8, prev_obj_val: 86.7114486694336, obj_val: 83.23844909667969, abs dis: 3.4729995727539062
[rfa agg] iter: 8, weight: tensor([0.0531, 0.0854, 0.1064, 0.1063, 0.0352, 0.0774, 0.2280, 0.0532, 0.0898,
        0.1652])
[rfa agg] iter:  9, prev_obj_val: 83.23844909667969, obj_val: 86.71143341064453, abs dis: 3.4729843139648438
[rfa agg] iter: 9, weight: tensor([0.0542, 0.0943, 0.0825, 0.1228, 0.0346, 0.0830, 0.1665, 0.0543, 0.0991,
        0.2087])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 10.3170, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 12.9843, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.39298009872437 sec.
Server Epoch:14 choose agents : [75, 69, 70, 66, 36, 76, 88, 65, 89, 30].
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   1, Avg loss: 0.0671, Accuracy: 204/776 (26.2887%)
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8538, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0530, Accuracy: 283/590 (47.9661%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 9.3420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0607, Accuracy: 322/1418 (22.7080%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 571/1418 (40.2680%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6774, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0641, Accuracy: 230/1402 (16.4051%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 366/1402 (26.1056%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9426, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0963, Accuracy: 18/408 (4.4118%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0597, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   1, Avg loss: 0.0951, Accuracy: 5/466 (1.0730%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   2, Avg loss: 0.0532, Accuracy: 168/466 (36.0515%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8536, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   1, Avg loss: 0.0767, Accuracy: 126/603 (20.8955%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1336, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0587, Accuracy: 364/1475 (24.6780%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0333, Accuracy: 592/1475 (40.1356%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4101, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   1, Avg loss: 0.0643, Accuracy: 280/896 (31.2500%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   2, Avg loss: 0.0353, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3428, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   1, Avg loss: 0.0842, Accuracy: 49/486 (10.0823%)
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   2, Avg loss: 0.0433, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3088, Accuracy: 62/10000 (0.6200%)
time spent on training: 139.13447046279907
[rfa agg] training data poison_ratio: 0.05704225352112676  data num: [776, 590, 1418, 1402, 408, 466, 603, 1475, 896, 486]
[rfa agg] considering poison per batch poison_fraction: 0.017825704225352113
[rfa agg] init. name: [75, 69, 70, 66, 36, 76, 88, 65, 89, 30], weight: tensor([0.0911, 0.0692, 0.1664, 0.1646, 0.0479, 0.0547, 0.0708, 0.1731, 0.1052,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 57.66128921508789, obj_val: 60.824893951416016, abs dis: 3.163604736328125
[rfa agg] iter: 0, weight: tensor([0.2365, 0.0605, 0.0656, 0.0731, 0.0241, 0.0322, 0.0617, 0.0617, 0.3511,
        0.0335])
[rfa agg] iter:  1, prev_obj_val: 60.824893951416016, obj_val: 66.05717468261719, abs dis: 5.232280731201172
[rfa agg] iter: 1, weight: tensor([0.3200, 0.0910, 0.0548, 0.0601, 0.0296, 0.0412, 0.0917, 0.0523, 0.2165,
        0.0429])
[rfa agg] iter:  2, prev_obj_val: 66.05717468261719, obj_val: 67.90958404541016, abs dis: 1.8524093627929688
[rfa agg] iter: 2, weight: tensor([0.1595, 0.1957, 0.0510, 0.0552, 0.0423, 0.0635, 0.1935, 0.0492, 0.1238,
        0.0662])
[rfa agg] iter:  3, prev_obj_val: 67.90958404541016, obj_val: 75.69795989990234, abs dis: 7.7883758544921875
[rfa agg] iter: 3, weight: tensor([0.1088, 0.2537, 0.0416, 0.0448, 0.0411, 0.0643, 0.2481, 0.0402, 0.0904,
        0.0671])
[rfa agg] iter:  4, prev_obj_val: 75.69795989990234, obj_val: 85.8590087890625, abs dis: 10.161048889160156
[rfa agg] iter: 4, weight: tensor([0.0745, 0.1955, 0.0395, 0.0422, 0.0707, 0.1338, 0.1962, 0.0385, 0.0688,
        0.1401])
[rfa agg] iter:  5, prev_obj_val: 85.8590087890625, obj_val: 85.79641723632812, abs dis: 0.062591552734375
[rfa agg] iter: 5, weight: tensor([0.0582, 0.0955, 0.0380, 0.0403, 0.1574, 0.2043, 0.0974, 0.0373, 0.0568,
        0.2148])
[rfa agg] iter:  6, prev_obj_val: 85.79641723632812, obj_val: 85.79472351074219, abs dis: 0.0016937255859375
[rfa agg] iter: 6, weight: tensor([0.0541, 0.0880, 0.0354, 0.0375, 0.1663, 0.2150, 0.0900, 0.0347, 0.0528,
        0.2262])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 11.2933, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 15.7691, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.2337565422058 sec.
Server Epoch:15 choose agents : [75, 67, 89, 84, 27, 45, 19, 70, 41, 20].
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0683, Accuracy: 201/776 (25.9021%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0346, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   1, Avg loss: 0.0857, Accuracy: 22/426 (5.1643%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   2, Avg loss: 0.0457, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2965, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   1, Avg loss: 0.0635, Accuracy: 283/896 (31.5848%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   2, Avg loss: 0.0354, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1746, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1075, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   1, Avg loss: 0.0567, Accuracy: 378/1587 (23.8185%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   2, Avg loss: 0.0346, Accuracy: 564/1587 (35.5388%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8996, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   1, Avg loss: 0.0708, Accuracy: 166/669 (24.8132%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   2, Avg loss: 0.0423, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.4603, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   1, Avg loss: 0.0526, Accuracy: 330/1036 (31.8533%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 624/1036 (60.2317%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.9260, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0595, Accuracy: 338/1418 (23.8364%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0323, Accuracy: 610/1418 (43.0183%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.8719, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0703, Accuracy: 257/719 (35.7441%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0330, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0313, Accuracy: 64/10000 (0.6400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   1, Avg loss: 0.0626, Accuracy: 267/807 (33.0855%)
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2287, Accuracy: 68/10000 (0.6800%)
time spent on training: 146.84792351722717
[rfa agg] training data poison_ratio: 0.08473330533389332  data num: [776, 426, 896, 1190, 1587, 669, 1036, 1418, 719, 807]
[rfa agg] considering poison per batch poison_fraction: 0.026479157916841665
[rfa agg] init. name: [75, 67, 89, 84, 27, 45, 19, 70, 41, 20], weight: tensor([0.0815, 0.0447, 0.0941, 0.1249, 0.1666, 0.0702, 0.1088, 0.1489, 0.0755,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 46.44046401977539, obj_val: 50.27134704589844, abs dis: 3.830883026123047
[rfa agg] iter: 0, weight: tensor([0.1400, 0.0185, 0.2447, 0.0819, 0.0500, 0.0601, 0.1263, 0.0548, 0.0871,
        0.1366])
[rfa agg] iter:  1, prev_obj_val: 50.27134704589844, obj_val: 61.65871810913086, abs dis: 11.387371063232422
[rfa agg] iter: 1, weight: tensor([0.2191, 0.0187, 0.1759, 0.0514, 0.0356, 0.0777, 0.0678, 0.0380, 0.1313,
        0.1844])
[rfa agg] iter:  2, prev_obj_val: 61.65871810913086, obj_val: 58.18737030029297, abs dis: 3.4713478088378906
[rfa agg] iter: 2, weight: tensor([0.1312, 0.0368, 0.1037, 0.0532, 0.0415, 0.2111, 0.0624, 0.0431, 0.1861,
        0.1308])
[rfa agg] iter:  3, prev_obj_val: 58.18737030029297, obj_val: 65.22786712646484, abs dis: 7.040496826171875
[rfa agg] iter: 3, weight: tensor([0.1360, 0.0286, 0.1032, 0.0485, 0.0369, 0.1949, 0.0581, 0.0386, 0.2201,
        0.1351])
[rfa agg] iter:  4, prev_obj_val: 65.22786712646484, obj_val: 52.515533447265625, abs dis: 12.712333679199219
[rfa agg] iter: 4, weight: tensor([0.1165, 0.0457, 0.0984, 0.0551, 0.0440, 0.2453, 0.0633, 0.0454, 0.1677,
        0.1187])
[rfa agg] iter:  5, prev_obj_val: 52.515533447265625, obj_val: 61.61730194091797, abs dis: 9.101768493652344
[rfa agg] iter: 5, weight: tensor([0.1890, 0.0209, 0.1328, 0.0488, 0.0351, 0.1060, 0.0619, 0.0372, 0.1914,
        0.1770])
[rfa agg] iter:  6, prev_obj_val: 61.61730194091797, obj_val: 61.57037353515625, abs dis: 0.04692840576171875
[rfa agg] iter: 6, weight: tensor([0.1280, 0.0363, 0.1014, 0.0523, 0.0408, 0.2178, 0.0613, 0.0424, 0.1910,
        0.1286])
[rfa agg] iter:  7, prev_obj_val: 61.57037353515625, obj_val: 61.568275451660156, abs dis: 0.00209808349609375
[rfa agg] iter: 7, weight: tensor([0.1213, 0.0352, 0.0978, 0.0505, 0.0394, 0.2457, 0.0592, 0.0410, 0.1874,
        0.1225])
[rfa agg] iter:  8, prev_obj_val: 61.568275451660156, obj_val: 65.21858215332031, abs dis: 3.6503067016601562
[rfa agg] iter: 8, weight: tensor([0.1198, 0.0350, 0.0969, 0.0501, 0.0391, 0.2530, 0.0587, 0.0406, 0.1857,
        0.1211])
[rfa agg] iter:  9, prev_obj_val: 65.21858215332031, obj_val: 58.19831085205078, abs dis: 7.020271301269531
[rfa agg] iter: 9, weight: tensor([0.1145, 0.0452, 0.0971, 0.0544, 0.0434, 0.2573, 0.0625, 0.0449, 0.1640,
        0.1167])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.7856, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 15.0719, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.69696521759033 sec.
Server Epoch:16 choose agents : [25, 23, 76, 70, 85, 6, 68, 74, 63, 35].
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0602, Accuracy: 256/690 (37.1014%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0291, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2331, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0624, Accuracy: 274/715 (38.3217%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3744, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0922, Accuracy: 16/466 (3.4335%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0542, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9470, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0601, Accuracy: 329/1418 (23.2017%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0319, Accuracy: 600/1418 (42.3131%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.5869, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   1, Avg loss: 0.0576, Accuracy: 427/1988 (21.4789%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 653/1988 (32.8471%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8667, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 353/1956 (18.0470%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6466, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   1, Avg loss: 0.0642, Accuracy: 343/1163 (29.4927%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   2, Avg loss: 0.0379, Accuracy: 460/1163 (39.5529%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6425, Accuracy: 55/10000 (0.5500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 485/1552 (31.2500%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 783/1552 (50.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.6342, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0577, Accuracy: 233/888 (26.2387%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 433/888 (48.7613%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.2841, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0972, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0613, Accuracy: 93/271 (34.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3850, Accuracy: 55/10000 (0.5500%)
time spent on training: 155.06180024147034
[rfa agg] training data poison_ratio: 0.13973170072926983  data num: [690, 715, 466, 1418, 1988, 1956, 1163, 1552, 888, 271]
[rfa agg] considering poison per batch poison_fraction: 0.04366615647789682
[rfa agg] init. name: [25, 23, 76, 70, 85, 6, 68, 74, 63, 35], weight: tensor([0.0621, 0.0644, 0.0420, 0.1277, 0.1790, 0.1761, 0.1047, 0.1397, 0.0799,
        0.0244])
[rfa agg] iter:  0, prev_obj_val: 72.14302825927734, obj_val: 73.32081604003906, abs dis: 1.1777877807617188
[rfa agg] iter: 0, weight: tensor([0.0380, 0.0444, 0.0190, 0.1748, 0.0745, 0.0798, 0.3578, 0.1286, 0.0744,
        0.0087])
[rfa agg] iter:  1, prev_obj_val: 73.32081604003906, obj_val: 74.92220306396484, abs dis: 1.6013870239257812
[rfa agg] iter: 1, weight: tensor([0.0352, 0.0415, 0.0174, 0.1372, 0.0626, 0.0669, 0.4570, 0.1035, 0.0709,
        0.0079])
[rfa agg] iter:  2, prev_obj_val: 74.92220306396484, obj_val: 78.69035339355469, abs dis: 3.7681503295898438
[rfa agg] iter: 2, weight: tensor([0.0374, 0.0444, 0.0181, 0.1225, 0.0602, 0.0641, 0.4719, 0.0956, 0.0777,
        0.0081])
[rfa agg] iter:  3, prev_obj_val: 78.69035339355469, obj_val: 76.75135040283203, abs dis: 1.9390029907226562
[rfa agg] iter: 3, weight: tensor([0.0537, 0.0651, 0.0250, 0.1276, 0.0701, 0.0743, 0.3474, 0.1043, 0.1215,
        0.0110])
[rfa agg] iter:  4, prev_obj_val: 76.75135040283203, obj_val: 74.93559265136719, abs dis: 1.8157577514648438
[rfa agg] iter: 4, weight: tensor([0.0470, 0.0564, 0.0223, 0.1309, 0.0681, 0.0723, 0.3862, 0.1046, 0.1024,
        0.0099])
[rfa agg] iter:  5, prev_obj_val: 74.93559265136719, obj_val: 74.92219543457031, abs dis: 0.013397216796875
[rfa agg] iter: 5, weight: tensor([0.0391, 0.0464, 0.0189, 0.1279, 0.0627, 0.0668, 0.4486, 0.0997, 0.0815,
        0.0085])
[rfa agg] iter:  6, prev_obj_val: 74.92219543457031, obj_val: 78.68914031982422, abs dis: 3.7669448852539062
[rfa agg] iter: 6, weight: tensor([0.0376, 0.0446, 0.0182, 0.1229, 0.0604, 0.0644, 0.4695, 0.0960, 0.0782,
        0.0082])
[rfa agg] iter:  7, prev_obj_val: 78.68914031982422, obj_val: 76.75139617919922, abs dis: 1.937744140625
[rfa agg] iter: 7, weight: tensor([0.0538, 0.0651, 0.0250, 0.1276, 0.0702, 0.0743, 0.3472, 0.1043, 0.1215,
        0.0110])
[rfa agg] iter:  8, prev_obj_val: 76.75139617919922, obj_val: 74.93559265136719, abs dis: 1.8158035278320312
[rfa agg] iter: 8, weight: tensor([0.0470, 0.0564, 0.0223, 0.1309, 0.0681, 0.0723, 0.3862, 0.1046, 0.1024,
        0.0099])
[rfa agg] iter:  9, prev_obj_val: 74.93559265136719, obj_val: 74.92219543457031, abs dis: 0.013397216796875
[rfa agg] iter: 9, weight: tensor([0.0391, 0.0464, 0.0189, 0.1279, 0.0627, 0.0668, 0.4486, 0.0997, 0.0815,
        0.0085])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.0528, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 17.7529, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.20925974845886 sec.
Server Epoch:17 choose agents : [38, 31, 29, 86, 59, 67, 35, 24, 5, 46].
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   1, Avg loss: 0.0675, Accuracy: 198/1131 (17.5066%)
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   2, Avg loss: 0.0321, Accuracy: 442/1131 (39.0805%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1334, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   1, Avg loss: 0.0733, Accuracy: 77/460 (16.7391%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7402, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0502, Accuracy: 404/1440 (28.0556%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7002, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   1, Avg loss: 0.0611, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 405/1003 (40.3789%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7481, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   1, Avg loss: 0.0578, Accuracy: 288/1089 (26.4463%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 407/1089 (37.3737%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 11.5112, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   1, Avg loss: 0.0880, Accuracy: 14/426 (3.2864%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   2, Avg loss: 0.0481, Accuracy: 177/426 (41.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2034, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.1002, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0658, Accuracy: 95/271 (35.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3282, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   1, Avg loss: 0.0901, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   2, Avg loss: 0.0479, Accuracy: 149/312 (47.7564%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.6835, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0568, Accuracy: 314/1628 (19.2875%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0265, Accuracy: 770/1628 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.8835, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   1, Avg loss: 0.0570, Accuracy: 395/1904 (20.7458%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 700/1904 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1457, Accuracy: 113/10000 (1.1300%)
time spent on training: 134.42287492752075
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 460, 1440, 1003, 1089, 426, 271, 312, 1628, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 31, 29, 86, 59, 67, 35, 24, 5, 46], weight: tensor([0.1170, 0.0476, 0.1490, 0.1038, 0.1127, 0.0441, 0.0280, 0.0323, 0.1685,
        0.1970])
[rfa agg] iter:  0, prev_obj_val: 62.363616943359375, obj_val: 65.13890838623047, abs dis: 2.7752914428710938
[rfa agg] iter: 0, weight: tensor([0.3271, 0.0185, 0.1130, 0.1715, 0.1903, 0.0156, 0.0083, 0.0096, 0.0817,
        0.0643])
[rfa agg] iter:  1, prev_obj_val: 65.13890838623047, obj_val: 67.10272979736328, abs dis: 1.9638214111328125
[rfa agg] iter: 1, weight: tensor([0.2970, 0.0197, 0.0914, 0.2463, 0.1833, 0.0164, 0.0087, 0.0100, 0.0700,
        0.0572])
[rfa agg] iter:  2, prev_obj_val: 67.10272979736328, obj_val: 67.07694244384766, abs dis: 0.025787353515625
[rfa agg] iter: 2, weight: tensor([0.2400, 0.0213, 0.0865, 0.3227, 0.1679, 0.0176, 0.0092, 0.0106, 0.0678,
        0.0563])
[rfa agg] iter:  3, prev_obj_val: 67.07694244384766, obj_val: 67.07479858398438, abs dis: 0.00214385986328125
[rfa agg] iter: 3, weight: tensor([0.2284, 0.0208, 0.0845, 0.3464, 0.1620, 0.0172, 0.0090, 0.0104, 0.0663,
        0.0550])
[rfa agg] iter:  4, prev_obj_val: 67.07479858398438, obj_val: 67.07456970214844, abs dis: 0.0002288818359375
[rfa agg] iter: 4, weight: tensor([0.2252, 0.0207, 0.0838, 0.3539, 0.1598, 0.0171, 0.0089, 0.0103, 0.0658,
        0.0546])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.8448, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 15.6192, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.7667455673218 sec.
Server Epoch:18 choose agents : [82, 96, 3, 25, 2, 8, 84, 54, 78, 31].
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/500 (8.6000%)
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4534, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   1, Avg loss: 0.0819, Accuracy: 24/311 (7.7170%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   2, Avg loss: 0.0575, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9397, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0761, Accuracy: 86/781 (11.0115%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 219/781 (28.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1048, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   1, Avg loss: 0.0588, Accuracy: 271/690 (39.2754%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   2, Avg loss: 0.0298, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.7374, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0703, Accuracy: 174/605 (28.7603%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0426, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.8601, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0645, Accuracy: 214/1513 (14.1441%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 476/1513 (31.4607%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1689, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   1, Avg loss: 0.0598, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2133, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   1, Avg loss: 0.0515, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 527/1130 (46.6372%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.9129, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0909, Accuracy: 14/416 (3.3654%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0523, Accuracy: 164/416 (39.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0495, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   1, Avg loss: 0.0738, Accuracy: 76/460 (16.5217%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 184/460 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5605, Accuracy: 60/10000 (0.6000%)
time spent on training: 131.58176279067993
[rfa agg] training data poison_ratio: 0.0  data num: [500, 311, 781, 690, 605, 1513, 1190, 1130, 416, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 96, 3, 25, 2, 8, 84, 54, 78, 31], weight: tensor([0.0658, 0.0409, 0.1028, 0.0908, 0.0796, 0.1992, 0.1567, 0.1488, 0.0548,
        0.0606])
[rfa agg] iter:  0, prev_obj_val: 53.93785095214844, obj_val: 57.71012878417969, abs dis: 3.77227783203125
[rfa agg] iter: 0, weight: tensor([0.0577, 0.0202, 0.2487, 0.2278, 0.1274, 0.0600, 0.0793, 0.0881, 0.0381,
        0.0526])
[rfa agg] iter:  1, prev_obj_val: 57.71012878417969, obj_val: 57.61866760253906, abs dis: 0.091461181640625
[rfa agg] iter: 1, weight: tensor([0.0746, 0.0212, 0.1184, 0.2904, 0.2234, 0.0450, 0.0554, 0.0599, 0.0445,
        0.0671])
[rfa agg] iter:  2, prev_obj_val: 57.61866760253906, obj_val: 61.7867317199707, abs dis: 4.168064117431641
[rfa agg] iter: 2, weight: tensor([0.0714, 0.0202, 0.1091, 0.3004, 0.2408, 0.0425, 0.0523, 0.0566, 0.0424,
        0.0642])
[rfa agg] iter:  3, prev_obj_val: 61.7867317199707, obj_val: 69.75680541992188, abs dis: 7.970073699951172
[rfa agg] iter: 3, weight: tensor([0.1184, 0.0266, 0.0900, 0.1763, 0.2716, 0.0439, 0.0521, 0.0555, 0.0620,
        0.1035])
[rfa agg] iter:  4, prev_obj_val: 69.75680541992188, obj_val: 72.84523010253906, abs dis: 3.0884246826171875
[rfa agg] iter: 4, weight: tensor([0.2473, 0.0369, 0.0650, 0.0946, 0.1206, 0.0402, 0.0456, 0.0477, 0.1104,
        0.1918])
[rfa agg] iter:  5, prev_obj_val: 72.84523010253906, obj_val: 72.83265686035156, abs dis: 0.0125732421875
[rfa agg] iter: 5, weight: tensor([0.2565, 0.0418, 0.0571, 0.0781, 0.0927, 0.0376, 0.0421, 0.0439, 0.1488,
        0.2015])
[rfa agg] iter:  6, prev_obj_val: 72.83265686035156, obj_val: 72.8323974609375, abs dis: 0.0002593994140625
[rfa agg] iter: 6, weight: tensor([0.2587, 0.0412, 0.0557, 0.0759, 0.0898, 0.0367, 0.0411, 0.0428, 0.1540,
        0.2042])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.6600, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 16.4066, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.46263217926025 sec.
Server Epoch:19 choose agents : [7, 92, 38, 18, 96, 99, 22, 64, 12, 16].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0580, Accuracy: 302/891 (33.8945%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0267, Accuracy: 459/891 (51.5152%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.6787, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0533, Accuracy: 383/1715 (22.3324%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0314, Accuracy: 679/1715 (39.5918%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.0016, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   1, Avg loss: 0.0644, Accuracy: 203/1131 (17.9487%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 474/1131 (41.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2419, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0934, Accuracy: 65/530 (12.2642%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0441, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5884, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   1, Avg loss: 0.0818, Accuracy: 21/311 (6.7524%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   2, Avg loss: 0.0566, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   1, Avg loss: 0.0653, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 402/773 (52.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9793, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   1, Avg loss: 0.0481, Accuracy: 484/1470 (32.9252%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 830/1470 (56.4626%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.8369, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   1, Avg loss: 0.0645, Accuracy: 177/953 (18.5729%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 297/953 (31.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4265, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   1, Avg loss: 0.0917, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   2, Avg loss: 0.0507, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0731, Accuracy: 162/708 (22.8814%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0426, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2413, Accuracy: 50/10000 (0.5000%)
time spent on training: 136.7205514907837
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1715, 1131, 530, 311, 773, 1470, 953, 338, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 92, 38, 18, 96, 99, 22, 64, 12, 16], weight: tensor([0.1010, 0.1944, 0.1282, 0.0601, 0.0353, 0.0876, 0.1667, 0.1080, 0.0383,
        0.0803])
[rfa agg] iter:  0, prev_obj_val: 53.68327713012695, obj_val: 56.901771545410156, abs dis: 3.218494415283203
[rfa agg] iter: 0, weight: tensor([0.1910, 0.0518, 0.1240, 0.0315, 0.0110, 0.1192, 0.0660, 0.3121, 0.0134,
        0.0799])
[rfa agg] iter:  1, prev_obj_val: 56.901771545410156, obj_val: 60.974334716796875, abs dis: 4.072563171386719
[rfa agg] iter: 1, weight: tensor([0.2348, 0.0434, 0.0825, 0.0388, 0.0121, 0.2034, 0.0526, 0.1917, 0.0150,
        0.1256])
[rfa agg] iter:  2, prev_obj_val: 60.974334716796875, obj_val: 66.32061004638672, abs dis: 5.346275329589844
[rfa agg] iter: 2, weight: tensor([0.1748, 0.0434, 0.0734, 0.0521, 0.0145, 0.2365, 0.0512, 0.1317, 0.0184,
        0.2039])
[rfa agg] iter:  3, prev_obj_val: 66.32061004638672, obj_val: 66.29629516601562, abs dis: 0.02431488037109375
[rfa agg] iter: 3, weight: tensor([0.1389, 0.0478, 0.0737, 0.0811, 0.0194, 0.1837, 0.0551, 0.1137, 0.0252,
        0.2614])
[rfa agg] iter:  4, prev_obj_val: 66.29629516601562, obj_val: 66.29544830322266, abs dis: 0.00084686279296875
[rfa agg] iter: 4, weight: tensor([0.1352, 0.0470, 0.0725, 0.0807, 0.0192, 0.1762, 0.0541, 0.1116, 0.0248,
        0.2787])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.7915, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 15.5855, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.44724464416504 sec.
Server Epoch:20 choose agents : [81, 15, 59, 7, 68, 53, 76, 56, 63, 11].
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   1, Avg loss: 0.0720, Accuracy: 222/774 (28.6822%)
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/774 (42.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6880, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 286/1154 (24.7834%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0300, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.8278, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0556, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 392/1089 (35.9963%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 12.9890, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0579, Accuracy: 326/891 (36.5881%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.6148, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 323/1163 (27.7730%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   2, Avg loss: 0.0377, Accuracy: 456/1163 (39.2089%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5246, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   1, Avg loss: 0.0548, Accuracy: 227/813 (27.9213%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 11.8369, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0933, Accuracy: 21/466 (4.5064%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0524, Accuracy: 175/466 (37.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0996, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   1, Avg loss: 0.0772, Accuracy: 5/186 (2.6882%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   2, Avg loss: 0.0613, Accuracy: 80/186 (43.0108%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0565, Accuracy: 272/888 (30.6306%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 413/888 (46.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.7731, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 317/712 (44.5225%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 402/712 (56.4607%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.6745, Accuracy: 69/10000 (0.6900%)
time spent on training: 133.24596524238586
[rfa agg] training data poison_ratio: 0.0  data num: [774, 1154, 1089, 891, 1163, 813, 466, 186, 888, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [81, 15, 59, 7, 68, 53, 76, 56, 63, 11], weight: tensor([0.0951, 0.1418, 0.1338, 0.1095, 0.1429, 0.0999, 0.0573, 0.0229, 0.1091,
        0.0875])
[rfa agg] iter:  0, prev_obj_val: 33.898223876953125, obj_val: 38.35979461669922, abs dis: 4.461570739746094
[rfa agg] iter: 0, weight: tensor([0.1770, 0.0520, 0.0554, 0.1490, 0.0527, 0.2094, 0.0252, 0.0048, 0.1457,
        0.1289])
[rfa agg] iter:  1, prev_obj_val: 38.35979461669922, obj_val: 44.74748992919922, abs dis: 6.3876953125
[rfa agg] iter: 1, weight: tensor([0.1669, 0.0506, 0.0529, 0.1203, 0.0512, 0.1896, 0.0349, 0.0060, 0.1188,
        0.2088])
[rfa agg] iter:  2, prev_obj_val: 44.74748992919922, obj_val: 38.338253021240234, abs dis: 6.409236907958984
[rfa agg] iter: 2, weight: tensor([0.1447, 0.0597, 0.0620, 0.1160, 0.0604, 0.1565, 0.0600, 0.0088, 0.1152,
        0.2167])
[rfa agg] iter:  3, prev_obj_val: 38.338253021240234, obj_val: 44.746856689453125, abs dis: 6.408603668212891
[rfa agg] iter: 3, weight: tensor([0.1619, 0.0497, 0.0521, 0.1166, 0.0504, 0.1825, 0.0345, 0.0059, 0.1155,
        0.2310])
[rfa agg] iter:  4, prev_obj_val: 44.746856689453125, obj_val: 38.338134765625, abs dis: 6.408721923828125
[rfa agg] iter: 4, weight: tensor([0.1442, 0.0595, 0.0618, 0.1156, 0.0603, 0.1559, 0.0599, 0.0088, 0.1148,
        0.2192])
[rfa agg] iter:  5, prev_obj_val: 38.338134765625, obj_val: 44.746864318847656, abs dis: 6.408729553222656
[rfa agg] iter: 5, weight: tensor([0.1618, 0.0497, 0.0520, 0.1165, 0.0503, 0.1823, 0.0344, 0.0059, 0.1154,
        0.2316])
[rfa agg] iter:  6, prev_obj_val: 44.746864318847656, obj_val: 38.338134765625, abs dis: 6.408729553222656
[rfa agg] iter: 6, weight: tensor([0.1441, 0.0595, 0.0618, 0.1156, 0.0602, 0.1559, 0.0599, 0.0088, 0.1148,
        0.2192])
[rfa agg] iter:  7, prev_obj_val: 38.338134765625, obj_val: 44.74687194824219, abs dis: 6.4087371826171875
[rfa agg] iter: 7, weight: tensor([0.1618, 0.0497, 0.0520, 0.1165, 0.0503, 0.1823, 0.0344, 0.0059, 0.1154,
        0.2317])
[rfa agg] iter:  8, prev_obj_val: 44.74687194824219, obj_val: 38.338134765625, abs dis: 6.4087371826171875
[rfa agg] iter: 8, weight: tensor([0.1441, 0.0595, 0.0618, 0.1156, 0.0602, 0.1559, 0.0599, 0.0088, 0.1148,
        0.2192])
[rfa agg] iter:  9, prev_obj_val: 38.338134765625, obj_val: 44.74687194824219, abs dis: 6.4087371826171875
[rfa agg] iter: 9, weight: tensor([0.1618, 0.0497, 0.0520, 0.1165, 0.0503, 0.1823, 0.0344, 0.0059, 0.1154,
        0.2317])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 11.7218, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 16.9207, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.4684479236603 sec.
Server Epoch:21 choose agents : [0, 18, 27, 50, 82, 44, 79, 20, 69, 23].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0621, Accuracy: 307/1657 (18.5275%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 598/1657 (36.0893%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0310, Accuracy: 656/1657 (39.5896%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0299, Accuracy: 703/1657 (42.4261%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0292, Accuracy: 702/1657 (42.3657%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0286, Accuracy: 735/1657 (44.3573%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0279, Accuracy: 765/1657 (46.1678%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0275, Accuracy: 778/1657 (46.9523%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0272, Accuracy: 782/1657 (47.1937%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0267, Accuracy: 802/1657 (48.4007%), train_poison_data_count: 520
Global model norm: 187.37702217054257.
Norm before scaling: 187.32498081542676. Distance: 1.3353990060686884
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1094, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 1.0323, Accuracy: 8281/9950 (83.2261%)
Scaling by  100
Scaled Norm after poisoning: 225.42193077648855, distance: 133.5399123974739
Total norm for 3 adversaries is: 225.42193077648855. distance: 133.5399123974739
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   1, Avg loss: 0.0943, Accuracy: 51/530 (9.6226%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   2, Avg loss: 0.0458, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7971, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0572, Accuracy: 392/1587 (24.7007%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0350, Accuracy: 545/1587 (34.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5198, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   1, Avg loss: 0.0693, Accuracy: 131/809 (16.1928%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   2, Avg loss: 0.0294, Accuracy: 319/809 (39.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.3517, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 54/500 (10.8000%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 184/500 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6670, Accuracy: 60/10000 (0.6000%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   1, Avg loss: 0.0635, Accuracy: 336/1750 (19.2000%)
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 643/1750 (36.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8817, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   1, Avg loss: 0.1134, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   2, Avg loss: 0.0912, Accuracy: 14/197 (7.1066%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.9184, Accuracy: 51/10000 (0.5100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0656, Accuracy: 242/807 (29.9876%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0341, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6058, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   1, Avg loss: 0.0553, Accuracy: 239/590 (40.5085%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.9616, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   1, Avg loss: 0.0681, Accuracy: 239/715 (33.4266%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   2, Avg loss: 0.0368, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.5030, Accuracy: 56/10000 (0.5600%)
time spent on training: 273.30677485466003
[rfa agg] training data poison_ratio: 0.4609494640122512  data num: [1657, 530, 1587, 809, 500, 1750, 197, 807, 590, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1440467075038285
[rfa agg] init. name: [0, 18, 27, 50, 82, 44, 79, 20, 69, 23], weight: tensor([0.1813, 0.0580, 0.1736, 0.0885, 0.0547, 0.1914, 0.0215, 0.0883, 0.0645,
        0.0782])
[rfa agg] iter:  0, prev_obj_val: 34524.60546875, obj_val: 24544.40234375, abs dis: 9980.203125
[rfa agg] iter: 0, weight: tensor([0.0467, 0.0672, 0.2027, 0.1028, 0.0634, 0.2239, 0.0249, 0.1026, 0.0749,
        0.0908])
[rfa agg] iter:  1, prev_obj_val: 24544.40234375, obj_val: 21872.974609375, abs dis: 2671.427734375
[rfa agg] iter: 1, weight: tensor([0.0107, 0.0690, 0.2122, 0.1061, 0.0650, 0.2352, 0.0254, 0.1058, 0.0770,
        0.0936])
[rfa agg] iter:  2, prev_obj_val: 21872.974609375, obj_val: 21256.05859375, abs dis: 616.916015625
[rfa agg] iter: 2, weight: tensor([0.0023, 0.0661, 0.2224, 0.1038, 0.0619, 0.2510, 0.0237, 0.1035, 0.0741,
        0.0911])
[rfa agg] iter:  3, prev_obj_val: 21256.05859375, obj_val: 21145.982421875, abs dis: 110.076171875
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0496, 0.2586, 0.0848, 0.0456, 0.3308, 0.0162, 0.0846, 0.0567,
        0.0727])
[rfa agg] iter:  4, prev_obj_val: 21145.982421875, obj_val: 21146.728515625, abs dis: 0.74609375
[rfa agg] iter: 4, weight: tensor([8.6817e-05, 2.4729e-02, 5.1795e-01, 5.1999e-02, 2.1821e-02, 2.5324e-01,
        6.7593e-03, 5.1899e-02, 2.9589e-02, 4.1932e-02])
[rfa agg] iter:  5, prev_obj_val: 21146.728515625, obj_val: 21148.6640625, abs dis: 1.935546875
[rfa agg] iter: 5, weight: tensor([1.0927e-04, 3.4653e-02, 4.3120e-01, 7.5948e-02, 3.0352e-02, 2.4053e-01,
        9.1947e-03, 7.5814e-02, 4.1791e-02, 6.0405e-02])
[rfa agg] iter:  6, prev_obj_val: 21148.6640625, obj_val: 21149.455078125, abs dis: 0.791015625
[rfa agg] iter: 6, weight: tensor([1.2900e-04, 5.0511e-02, 2.8640e-01, 1.2299e-01, 4.3513e-02, 2.0459e-01,
        1.2537e-02, 1.2286e-01, 6.2136e-02, 9.4322e-02])
[rfa agg] iter:  7, prev_obj_val: 21149.455078125, obj_val: 21151.201171875, abs dis: 1.74609375
[rfa agg] iter: 7, weight: tensor([1.2756e-04, 5.5241e-02, 2.3940e-01, 1.4348e-01, 4.7159e-02, 1.8171e-01,
        1.3240e-02, 1.4343e-01, 6.8736e-02, 1.0748e-01])
[rfa agg] iter:  8, prev_obj_val: 21151.201171875, obj_val: 21153.21484375, abs dis: 2.013671875
[rfa agg] iter: 8, weight: tensor([1.1023e-04, 6.0163e-02, 1.5936e-01, 1.8888e-01, 5.0128e-02, 1.3029e-01,
        1.3169e-02, 1.8938e-01, 7.7223e-02, 1.3128e-01])
[rfa agg] iter:  9, prev_obj_val: 21153.21484375, obj_val: 21157.384765625, abs dis: 4.169921875
[rfa agg] iter: 9, weight: tensor([7.4227e-05, 5.4737e-02, 8.7131e-02, 2.5132e-01, 4.3834e-02, 7.4902e-02,
        1.0442e-02, 2.5586e-01, 7.4182e-02, 1.4752e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.7245, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 15.2111, Accuracy: 0/9950 (0.0000%)
saving model
Done in 434.5079348087311 sec.
Server Epoch:22 choose agents : [12, 23, 52, 19, 80, 2, 44, 8, 82, 58].
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0507, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2145, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   1, Avg loss: 0.0644, Accuracy: 244/715 (34.1259%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   2, Avg loss: 0.0407, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.8261, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   1, Avg loss: 0.0721, Accuracy: 171/636 (26.8868%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   2, Avg loss: 0.0365, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   1, Avg loss: 0.0524, Accuracy: 333/1036 (32.1429%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 649/1036 (62.6448%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.4159, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0706, Accuracy: 99/682 (14.5161%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0391, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0274, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0718, Accuracy: 138/605 (22.8099%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0420, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4186, Accuracy: 52/10000 (0.5200%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   1, Avg loss: 0.0629, Accuracy: 331/1750 (18.9143%)
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   2, Avg loss: 0.0364, Accuracy: 630/1750 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9650, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0641, Accuracy: 219/1513 (14.4746%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0387, Accuracy: 419/1513 (27.6933%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.1553, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   1, Avg loss: 0.0737, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5308, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0687, Accuracy: 265/803 (33.0012%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0381, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.0729, Accuracy: 50/10000 (0.5000%)
time spent on training: 151.27915143966675
[rfa agg] training data poison_ratio: 0.20401025880158546  data num: [338, 715, 636, 1036, 682, 605, 1750, 1513, 500, 803]
[rfa agg] considering poison per batch poison_fraction: 0.06375320587549546
[rfa agg] init. name: [12, 23, 52, 19, 80, 2, 44, 8, 82, 58], weight: tensor([0.0394, 0.0834, 0.0741, 0.1208, 0.0795, 0.0705, 0.2040, 0.1764, 0.0583,
        0.0936])
[rfa agg] iter:  0, prev_obj_val: 62.097869873046875, obj_val: 63.09510040283203, abs dis: 0.9972305297851562
[rfa agg] iter: 0, weight: tensor([0.0205, 0.1187, 0.0683, 0.2388, 0.0922, 0.0652, 0.0747, 0.0927, 0.0392,
        0.1898])
[rfa agg] iter:  1, prev_obj_val: 63.09510040283203, obj_val: 70.43240356445312, abs dis: 7.337303161621094
[rfa agg] iter: 1, weight: tensor([0.0191, 0.1637, 0.0787, 0.1020, 0.1249, 0.0753, 0.0476, 0.0559, 0.0397,
        0.2932])
[rfa agg] iter:  2, prev_obj_val: 70.43240356445312, obj_val: 70.24856567382812, abs dis: 0.183837890625
[rfa agg] iter: 2, weight: tensor([0.0252, 0.1268, 0.1532, 0.0566, 0.2320, 0.1558, 0.0362, 0.0404, 0.0650,
        0.1088])
[rfa agg] iter:  3, prev_obj_val: 70.24856567382812, obj_val: 79.07835388183594, abs dis: 8.829788208007812
[rfa agg] iter: 3, weight: tensor([0.0240, 0.1187, 0.1618, 0.0531, 0.2466, 0.1628, 0.0340, 0.0380, 0.0624,
        0.0985])
[rfa agg] iter:  4, prev_obj_val: 79.07835388183594, obj_val: 72.8484878540039, abs dis: 6.229866027832031
[rfa agg] iter: 4, weight: tensor([0.0430, 0.0950, 0.1766, 0.0561, 0.1399, 0.1741, 0.0404, 0.0442, 0.1463,
        0.0845])
[rfa agg] iter:  5, prev_obj_val: 72.8484878540039, obj_val: 79.06026458740234, abs dis: 6.2117767333984375
[rfa agg] iter: 5, weight: tensor([0.0283, 0.1046, 0.1912, 0.0524, 0.1845, 0.1953, 0.0350, 0.0388, 0.0807,
        0.0892])
[rfa agg] iter:  6, prev_obj_val: 79.06026458740234, obj_val: 72.8487777709961, abs dis: 6.21148681640625
[rfa agg] iter: 6, weight: tensor([0.0429, 0.0939, 0.1789, 0.0557, 0.1372, 0.1770, 0.0401, 0.0438, 0.1468,
        0.0837])
[rfa agg] iter:  7, prev_obj_val: 72.8487777709961, obj_val: 79.06025695800781, abs dis: 6.211479187011719
[rfa agg] iter: 7, weight: tensor([0.0283, 0.1045, 0.1915, 0.0523, 0.1840, 0.1958, 0.0350, 0.0388, 0.0806,
        0.0891])
[rfa agg] iter:  8, prev_obj_val: 79.06025695800781, obj_val: 72.8487777709961, abs dis: 6.211479187011719
[rfa agg] iter: 8, weight: tensor([0.0429, 0.0939, 0.1789, 0.0557, 0.1372, 0.1770, 0.0401, 0.0438, 0.1468,
        0.0837])
[rfa agg] iter:  9, prev_obj_val: 72.8487777709961, obj_val: 79.06024932861328, abs dis: 6.2114715576171875
[rfa agg] iter: 9, weight: tensor([0.0283, 0.1045, 0.1915, 0.0523, 0.1840, 0.1958, 0.0350, 0.0388, 0.0806,
        0.0891])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 11.2588, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 15.5814, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.20812606811523 sec.
Server Epoch:23 choose agents : [20, 9, 57, 74, 2, 92, 23, 81, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0718, Accuracy: 150/807 (18.5874%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0391, Accuracy: 318/807 (39.4052%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0296, Accuracy: 383/807 (47.4597%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0275, Accuracy: 407/807 (50.4337%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0265, Accuracy: 441/807 (54.6468%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0251, Accuracy: 448/807 (55.5143%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0257, Accuracy: 443/807 (54.8947%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0253, Accuracy: 446/807 (55.2664%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0243, Accuracy: 463/807 (57.3730%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0241, Accuracy: 468/807 (57.9926%), train_poison_data_count: 260
Global model norm: 193.30443727123804.
Norm before scaling: 193.2810049513402. Distance: 0.9582221892770106
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9521, Accuracy: 69/10000 (0.6900%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9707, Accuracy: 6433/9950 (64.6533%)
Scaling by  100
Scaled Norm after poisoning: 213.42557616766553, distance: 95.82222308786203
Total norm for 2 adversaries is: 213.42557616766553. distance: 95.82222308786203
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0539, Accuracy: 356/1275 (27.9216%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 665/1275 (52.1569%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.8826, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   1, Avg loss: 0.0585, Accuracy: 252/1154 (21.8371%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 440/1154 (38.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.3566, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0475, Accuracy: 426/1552 (27.4485%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 744/1552 (47.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.9030, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0706, Accuracy: 138/605 (22.8099%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0415, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3833, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   1, Avg loss: 0.0555, Accuracy: 371/1715 (21.6327%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   2, Avg loss: 0.0314, Accuracy: 663/1715 (38.6589%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3482, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 266/715 (37.2028%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4935, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0694, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0404, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6937, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0797, Accuracy: 92/781 (11.7798%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.4841, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0569, Accuracy: 330/1628 (20.2703%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 794/1628 (48.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.3524, Accuracy: 125/10000 (1.2500%)
time spent on training: 256.9529707431793
[rfa agg] training data poison_ratio: 0.21433763401780848  data num: [807, 1275, 1154, 1552, 605, 1715, 715, 774, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.06698051063056515
[rfa agg] init. name: [20, 9, 57, 74, 2, 92, 23, 81, 3, 5], weight: tensor([0.0733, 0.1158, 0.1049, 0.1410, 0.0550, 0.1558, 0.0650, 0.0703, 0.0710,
        0.1479])
[rfa agg] iter:  0, prev_obj_val: 7930.2158203125, obj_val: 4578.90087890625, abs dis: 3351.31494140625
[rfa agg] iter: 0, weight: tensor([0.0062, 0.1241, 0.1121, 0.1526, 0.0577, 0.1694, 0.0684, 0.0742, 0.0749,
        0.1604])
[rfa agg] iter:  1, prev_obj_val: 4578.90087890625, obj_val: 4336.0966796875, abs dis: 242.80419921875
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1203, 0.1062, 0.1683, 0.0453, 0.1974, 0.0559, 0.0618, 0.0624,
        0.1819])
[rfa agg] iter:  2, prev_obj_val: 4336.0966796875, obj_val: 4338.4541015625, abs dis: 2.357421875
[rfa agg] iter: 2, weight: tensor([5.4843e-05, 2.4255e-01, 1.6206e-01, 1.7841e-01, 2.3042e-02, 1.3006e-01,
        3.2797e-02, 3.9704e-02, 4.0115e-02, 1.5121e-01])
[rfa agg] iter:  3, prev_obj_val: 4338.4541015625, obj_val: 4342.87744140625, abs dis: 4.42333984375
[rfa agg] iter: 3, weight: tensor([4.8543e-05, 3.1463e-01, 2.4463e-01, 1.0640e-01, 2.4607e-02, 8.6336e-02,
        3.6502e-02, 4.5523e-02, 4.6021e-02, 9.5306e-02])
[rfa agg] iter:  4, prev_obj_val: 4342.87744140625, obj_val: 4346.6728515625, abs dis: 3.79541015625
[rfa agg] iter: 4, weight: tensor([5.5724e-05, 2.3742e-01, 2.7377e-01, 9.6977e-02, 3.3279e-02, 8.3352e-02,
        5.1634e-02, 6.6580e-02, 6.7411e-02, 8.9525e-02])
[rfa agg] iter:  5, prev_obj_val: 4346.6728515625, obj_val: 4350.7431640625, abs dis: 4.0703125
[rfa agg] iter: 5, weight: tensor([6.3121e-05, 1.9402e-01, 2.3469e-01, 9.6895e-02, 4.2842e-02, 8.5492e-02,
        6.9223e-02, 9.2410e-02, 9.3699e-02, 9.0664e-02])
[rfa agg] iter:  6, prev_obj_val: 4350.7431640625, obj_val: 4348.669921875, abs dis: 2.0732421875
[rfa agg] iter: 6, weight: tensor([6.6707e-05, 1.6035e-01, 1.8383e-01, 9.1553e-02, 5.2425e-02, 8.2563e-02,
        8.9402e-02, 1.2563e-01, 1.2754e-01, 8.6641e-02])
[rfa agg] iter:  7, prev_obj_val: 4348.669921875, obj_val: 4352.84423828125, abs dis: 4.17431640625
[rfa agg] iter: 7, weight: tensor([6.5772e-05, 1.7608e-01, 2.0406e-01, 9.5373e-02, 4.8124e-02, 8.5125e-02,
        7.9986e-02, 1.1004e-01, 1.1136e-01, 8.9790e-02])
[rfa agg] iter:  8, prev_obj_val: 4352.84423828125, obj_val: 4350.7294921875, abs dis: 2.11474609375
[rfa agg] iter: 8, weight: tensor([6.6269e-05, 1.4342e-01, 1.6031e-01, 8.6349e-02, 5.6538e-02, 7.8618e-02,
        9.9767e-02, 1.4528e-01, 1.4753e-01, 8.2124e-02])
[rfa agg] iter:  9, prev_obj_val: 4350.7294921875, obj_val: 4348.67236328125, abs dis: 2.05712890625
[rfa agg] iter: 9, weight: tensor([6.6650e-05, 1.5909e-01, 1.8001e-01, 9.1475e-02, 5.2642e-02, 8.2509e-02,
        9.0165e-02, 1.2798e-01, 1.2947e-01, 8.6593e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.2815, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 16.0402, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.46094512939453 sec.
Server Epoch:24 choose agents : [67, 87, 90, 88, 15, 72, 3, 12, 54, 76].
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0870, Accuracy: 34/426 (7.9812%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0494, Accuracy: 178/426 (41.7840%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3632, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   1, Avg loss: 0.0614, Accuracy: 273/1131 (24.1379%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.7982, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   1, Avg loss: 0.0493, Accuracy: 350/677 (51.6987%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 427/677 (63.0724%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.2280, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   1, Avg loss: 0.0760, Accuracy: 125/603 (20.7297%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.2102, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 409/1154 (35.4419%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.6259, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   1, Avg loss: 0.0707, Accuracy: 198/1241 (15.9549%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   2, Avg loss: 0.0388, Accuracy: 384/1241 (30.9428%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4165, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0762, Accuracy: 97/781 (12.4200%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5578, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   1, Avg loss: 0.0903, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   2, Avg loss: 0.0501, Accuracy: 119/338 (35.2071%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1680, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 338/1130 (29.9115%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   2, Avg loss: 0.0301, Accuracy: 477/1130 (42.2124%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.5236, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0910, Accuracy: 18/466 (3.8627%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 168/466 (36.0515%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5656, Accuracy: 51/10000 (0.5100%)
time spent on training: 133.43688988685608
[rfa agg] training data poison_ratio: 0.0  data num: [426, 1131, 677, 603, 1154, 1241, 781, 338, 1130, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [67, 87, 90, 88, 15, 72, 3, 12, 54, 76], weight: tensor([0.0536, 0.1423, 0.0852, 0.0759, 0.1452, 0.1562, 0.0983, 0.0425, 0.1422,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 46.20058822631836, obj_val: 49.280174255371094, abs dis: 3.0795860290527344
[rfa agg] iter: 0, weight: tensor([0.0353, 0.0946, 0.1758, 0.1053, 0.0812, 0.0772, 0.2654, 0.0236, 0.0948,
        0.0468])
[rfa agg] iter:  1, prev_obj_val: 49.280174255371094, obj_val: 55.87087631225586, abs dis: 6.590702056884766
[rfa agg] iter: 1, weight: tensor([0.0388, 0.0737, 0.2775, 0.1442, 0.0647, 0.0624, 0.1858, 0.0252, 0.0739,
        0.0539])
[rfa agg] iter:  2, prev_obj_val: 55.87087631225586, obj_val: 53.30835723876953, abs dis: 2.562519073486328
[rfa agg] iter: 2, weight: tensor([0.0546, 0.0595, 0.2279, 0.2717, 0.0536, 0.0525, 0.1041, 0.0328, 0.0596,
        0.0836])
[rfa agg] iter:  3, prev_obj_val: 53.30835723876953, obj_val: 53.30223846435547, abs dis: 0.0061187744140625
[rfa agg] iter: 3, weight: tensor([0.0447, 0.0580, 0.2764, 0.2573, 0.0519, 0.0506, 0.1092, 0.0276, 0.0582,
        0.0660])
[rfa agg] iter:  4, prev_obj_val: 53.30223846435547, obj_val: 55.808101654052734, abs dis: 2.5058631896972656
[rfa agg] iter: 4, weight: tensor([0.0444, 0.0578, 0.2871, 0.2490, 0.0517, 0.0504, 0.1089, 0.0274, 0.0579,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 55.808101654052734, obj_val: 55.79297637939453, abs dis: 0.015125274658203125
[rfa agg] iter: 5, weight: tensor([0.0527, 0.0567, 0.2201, 0.3019, 0.0511, 0.0501, 0.0980, 0.0316, 0.0568,
        0.0809])
[rfa agg] iter:  6, prev_obj_val: 55.79297637939453, obj_val: 64.76310729980469, abs dis: 8.970130920410156
[rfa agg] iter: 6, weight: tensor([0.0518, 0.0554, 0.2075, 0.3247, 0.0500, 0.0489, 0.0955, 0.0310, 0.0555,
        0.0796])
[rfa agg] iter:  7, prev_obj_val: 64.76310729980469, obj_val: 61.58001708984375, abs dis: 3.1830902099609375
[rfa agg] iter: 7, weight: tensor([0.1104, 0.0614, 0.1342, 0.1899, 0.0564, 0.0559, 0.0873, 0.0581, 0.0615,
        0.1848])
[rfa agg] iter:  8, prev_obj_val: 61.58001708984375, obj_val: 55.82874298095703, abs dis: 5.751274108886719
[rfa agg] iter: 8, weight: tensor([0.0897, 0.0606, 0.1514, 0.2276, 0.0554, 0.0547, 0.0909, 0.0489, 0.0608,
        0.1599])
[rfa agg] iter:  9, prev_obj_val: 55.82874298095703, obj_val: 55.792266845703125, abs dis: 0.03647613525390625
[rfa agg] iter: 9, weight: tensor([0.0538, 0.0567, 0.2072, 0.3102, 0.0512, 0.0501, 0.0976, 0.0321, 0.0569,
        0.0841])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 11.7286, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 17.3647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.14442110061646 sec.
Server Epoch:25 choose agents : [74, 16, 75, 48, 28, 58, 93, 17, 20, 34].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0532, Accuracy: 346/1552 (22.2938%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0235, Accuracy: 705/1552 (45.4253%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0222, Accuracy: 744/1552 (47.9381%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0211, Accuracy: 816/1552 (52.5773%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0208, Accuracy: 842/1552 (54.2526%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0204, Accuracy: 847/1552 (54.5747%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0200, Accuracy: 870/1552 (56.0567%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0198, Accuracy: 892/1552 (57.4742%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0189, Accuracy: 918/1552 (59.1495%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0190, Accuracy: 899/1552 (57.9253%), train_poison_data_count: 496
Global model norm: 199.04623167432737.
Norm before scaling: 198.99405220382843. Distance: 1.386080312843283
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.3432, Accuracy: 89/10000 (0.8900%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.9253, Accuracy: 7076/9950 (71.1156%)
Scaling by  100
Scaled Norm after poisoning: 237.82788222262755, distance: 138.6080425268498
Total norm for 2 adversaries is: 237.82788222262755. distance: 138.6080425268498
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0736, Accuracy: 175/708 (24.7175%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.1355, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   1, Avg loss: 0.0658, Accuracy: 231/776 (29.7680%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.0384, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/631 (6.8146%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0428, Accuracy: 225/631 (35.6577%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0578, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   1, Avg loss: 0.0623, Accuracy: 335/1581 (21.1891%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 507/1581 (32.0683%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9247, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   1, Avg loss: 0.0704, Accuracy: 259/803 (32.2540%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   2, Avg loss: 0.0388, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5532, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   1, Avg loss: 0.0619, Accuracy: 352/1742 (20.2067%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 658/1742 (37.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3775, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 368/1574 (23.3799%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 633/1574 (40.2160%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9854, Accuracy: 101/10000 (1.0100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   1, Avg loss: 0.0672, Accuracy: 238/807 (29.4919%)
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   2, Avg loss: 0.0348, Accuracy: 396/807 (49.0706%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7776, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   1, Avg loss: 0.0567, Accuracy: 351/1427 (24.5971%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   2, Avg loss: 0.0344, Accuracy: 580/1427 (40.6447%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9327, Accuracy: 76/10000 (0.7600%)
time spent on training: 285.4418544769287
[rfa agg] training data poison_ratio: 0.20334453926385657  data num: [1552, 708, 776, 631, 1581, 803, 1742, 1574, 807, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.06354516851995518
[rfa agg] init. name: [74, 16, 75, 48, 28, 58, 93, 17, 20, 34], weight: tensor([0.1338, 0.0610, 0.0669, 0.0544, 0.1363, 0.0692, 0.1502, 0.1357, 0.0696,
        0.1230])
[rfa agg] iter:  0, prev_obj_val: 25922.48828125, obj_val: 16866.462890625, abs dis: 9056.025390625
[rfa agg] iter: 0, weight: tensor([0.0232, 0.0685, 0.0751, 0.0609, 0.1541, 0.0777, 0.1701, 0.1534, 0.0781,
        0.1389])
[rfa agg] iter:  1, prev_obj_val: 16866.462890625, obj_val: 15253.916015625, abs dis: 1612.546875
[rfa agg] iter: 1, weight: tensor([0.0036, 0.0682, 0.0749, 0.0603, 0.1591, 0.0776, 0.1772, 0.1584, 0.0779,
        0.1426])
[rfa agg] iter:  2, prev_obj_val: 15253.916015625, obj_val: 15017.4521484375, abs dis: 236.4638671875
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0574, 0.0642, 0.0492, 0.1717, 0.0664, 0.2054, 0.1710, 0.0667,
        0.1474])
[rfa agg] iter:  3, prev_obj_val: 15017.4521484375, obj_val: 15019.9912109375, abs dis: 2.5390625
[rfa agg] iter: 3, weight: tensor([4.0554e-05, 1.8327e-02, 2.1828e-02, 1.4119e-02, 2.7689e-01, 2.2621e-02,
        1.4574e-01, 2.7371e-01, 2.2628e-02, 2.0410e-01])
[rfa agg] iter:  4, prev_obj_val: 15019.9912109375, obj_val: 15023.9248046875, abs dis: 3.93359375
[rfa agg] iter: 4, weight: tensor([5.3844e-05, 3.0245e-02, 3.6761e-02, 2.2607e-02, 2.0241e-01, 3.8191e-02,
        1.1984e-01, 2.0038e-01, 3.8066e-02, 3.1145e-01])
[rfa agg] iter:  5, prev_obj_val: 15023.9248046875, obj_val: 15025.37890625, abs dis: 1.4541015625
[rfa agg] iter: 5, weight: tensor([6.7975e-05, 4.4713e-02, 5.5385e-02, 3.2560e-02, 1.8006e-01, 5.7582e-02,
        1.2301e-01, 1.7816e-01, 5.7250e-02, 2.7121e-01])
[rfa agg] iter:  6, prev_obj_val: 15025.37890625, obj_val: 15028.4033203125, abs dis: 3.0244140625
[rfa agg] iter: 6, weight: tensor([7.2341e-05, 5.0510e-02, 6.3090e-02, 3.6379e-02, 1.7439e-01, 6.5604e-02,
        1.2337e-01, 1.7275e-01, 6.5161e-02, 2.4867e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.3512, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 17.8676, Accuracy: 0/9950 (0.0000%)
saving model
Done in 443.2785620689392 sec.
Server Epoch:26 choose agents : [17, 3, 87, 52, 86, 61, 79, 80, 49, 59].
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 381/1574 (24.2058%)
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   2, Avg loss: 0.0284, Accuracy: 639/1574 (40.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9225, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0759, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0386, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.7316, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 415/1131 (36.6932%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.0126, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   1, Avg loss: 0.0641, Accuracy: 213/636 (33.4906%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   2, Avg loss: 0.0341, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.9391, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0600, Accuracy: 327/1003 (32.6022%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7919, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   1, Avg loss: 0.1401, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   2, Avg loss: 0.1312, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6483, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1098, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0881, Accuracy: 15/197 (7.6142%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.1709, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 105/682 (15.3959%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0387, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.7377, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 16/440 (3.6364%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 152/440 (34.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.0047, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   1, Avg loss: 0.0511, Accuracy: 282/1089 (25.8953%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 437/1089 (40.1286%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.7717, Accuracy: 87/10000 (0.8700%)
time spent on training: 138.94900703430176
[rfa agg] training data poison_ratio: 0.0  data num: [1574, 781, 1131, 636, 1003, 85, 197, 682, 440, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [17, 3, 87, 52, 86, 61, 79, 80, 49, 59], weight: tensor([0.2066, 0.1025, 0.1485, 0.0835, 0.1317, 0.0112, 0.0259, 0.0895, 0.0578,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 50.07765197753906, obj_val: 52.607757568359375, abs dis: 2.5301055908203125
[rfa agg] iter: 0, weight: tensor([0.0729, 0.2424, 0.1367, 0.0763, 0.1999, 0.0033, 0.0096, 0.1081, 0.0313,
        0.1196])
[rfa agg] iter:  1, prev_obj_val: 52.607757568359375, obj_val: 54.256126403808594, abs dis: 1.6483688354492188
[rfa agg] iter: 1, weight: tensor([0.0616, 0.3264, 0.1032, 0.0896, 0.1426, 0.0033, 0.0097, 0.1378, 0.0333,
        0.0925])
[rfa agg] iter:  2, prev_obj_val: 54.256126403808594, obj_val: 58.36513137817383, abs dis: 4.109004974365234
[rfa agg] iter: 2, weight: tensor([0.0579, 0.3293, 0.0921, 0.1012, 0.1213, 0.0033, 0.0100, 0.1664, 0.0353,
        0.0831])
[rfa agg] iter:  3, prev_obj_val: 58.36513137817383, obj_val: 63.34099578857422, abs dis: 4.975864410400391
[rfa agg] iter: 3, weight: tensor([0.0560, 0.2121, 0.0820, 0.1459, 0.1016, 0.0038, 0.0116, 0.2678, 0.0441,
        0.0752])
[rfa agg] iter:  4, prev_obj_val: 63.34099578857422, obj_val: 63.30859375, abs dis: 0.03240203857421875
[rfa agg] iter: 4, weight: tensor([0.0525, 0.1389, 0.0720, 0.2080, 0.0852, 0.0041, 0.0132, 0.3042, 0.0553,
        0.0667])
[rfa agg] iter:  5, prev_obj_val: 63.30859375, obj_val: 63.308189392089844, abs dis: 0.00040435791015625
[rfa agg] iter: 5, weight: tensor([0.0512, 0.1334, 0.0702, 0.2169, 0.0831, 0.0041, 0.0129, 0.3088, 0.0544,
        0.0650])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.9567, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 16.8848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.20297598838806 sec.
Server Epoch:27 choose agents : [95, 46, 85, 8, 54, 90, 27, 15, 74, 44].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0667, Accuracy: 230/599 (38.3973%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0266, Accuracy: 323/599 (53.9232%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0249, Accuracy: 304/599 (50.7513%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0245, Accuracy: 379/599 (63.2721%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0237, Accuracy: 385/599 (64.2738%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0224, Accuracy: 390/599 (65.1085%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0214, Accuracy: 411/599 (68.6144%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0201, Accuracy: 394/599 (65.7763%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0186, Accuracy: 412/599 (68.7813%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0202, Accuracy: 402/599 (67.1119%), train_poison_data_count: 200
Global model norm: 204.62501908979752.
Norm before scaling: 204.60730299160878. Distance: 0.7813824732045792
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2196, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6213, Accuracy: 6843/9950 (68.7739%)
Scaling by  100
Scaled Norm after poisoning: 217.2348329717175, distance: 78.13824887659052
Total norm for 3 adversaries is: 217.2348329717175. distance: 78.13824887659052
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   1, Avg loss: 0.0585, Accuracy: 389/1904 (20.4307%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 698/1904 (36.6597%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1750, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0580, Accuracy: 445/1988 (22.3843%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0376, Accuracy: 634/1988 (31.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5745, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0642, Accuracy: 210/1513 (13.8797%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0375, Accuracy: 436/1513 (28.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9948, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0569, Accuracy: 303/1130 (26.8142%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 464/1130 (41.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.8023, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   1, Avg loss: 0.0477, Accuracy: 337/677 (49.7784%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.5183, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   1, Avg loss: 0.0544, Accuracy: 390/1587 (24.5747%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   2, Avg loss: 0.0347, Accuracy: 558/1587 (35.1607%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0630, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0590, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0321, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.9459, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   1, Avg loss: 0.0462, Accuracy: 437/1552 (28.1572%)
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   2, Avg loss: 0.0221, Accuracy: 736/1552 (47.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.7550, Accuracy: 90/10000 (0.9000%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0641, Accuracy: 333/1750 (19.0286%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 628/1750 (35.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2049, Accuracy: 106/10000 (1.0600%)
time spent on training: 292.2991623878479
[rfa agg] training data poison_ratio: 0.2815793272701025  data num: [599, 1904, 1988, 1513, 1130, 677, 1587, 1154, 1552, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.08799353977190702
[rfa agg] init. name: [95, 46, 85, 8, 54, 90, 27, 15, 74, 44], weight: tensor([0.0432, 0.1374, 0.1435, 0.1092, 0.0816, 0.0489, 0.1146, 0.0833, 0.1120,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 3732.934326171875, obj_val: 2025.062744140625, abs dis: 1707.87158203125
[rfa agg] iter: 0, weight: tensor([0.0020, 0.1465, 0.1543, 0.1133, 0.0823, 0.0478, 0.1193, 0.0845, 0.1167,
        0.1334])
[rfa agg] iter:  1, prev_obj_val: 2025.062744140625, obj_val: 2000.239990234375, abs dis: 24.82275390625
[rfa agg] iter: 1, weight: tensor([5.2375e-05, 2.3506e-01, 2.8095e-01, 7.5297e-02, 3.3853e-02, 1.3780e-02,
        8.8396e-02, 3.6892e-02, 8.6171e-02, 1.4955e-01])
[rfa agg] iter:  2, prev_obj_val: 2000.239990234375, obj_val: 2004.2757568359375, abs dis: 4.0357666015625
[rfa agg] iter: 2, weight: tensor([3.2408e-05, 1.1900e-01, 8.5664e-02, 1.3832e-01, 3.7698e-02, 1.2274e-02,
        1.9693e-01, 4.2480e-02, 1.9437e-01, 1.7324e-01])
[rfa agg] iter:  3, prev_obj_val: 2004.2757568359375, obj_val: 2004.20556640625, abs dis: 0.0701904296875
[rfa agg] iter: 3, weight: tensor([3.3947e-05, 8.0685e-02, 6.4122e-02, 2.0877e-01, 5.6312e-02, 1.5402e-02,
        2.0566e-01, 6.4662e-02, 2.0041e-01, 1.0394e-01])
[rfa agg] iter:  4, prev_obj_val: 2004.20556640625, obj_val: 2008.3016357421875, abs dis: 4.0960693359375
[rfa agg] iter: 4, weight: tensor([3.3370e-05, 7.9052e-02, 6.2895e-02, 2.2350e-01, 5.5316e-02, 1.5141e-02,
        2.0294e-01, 6.3962e-02, 1.9619e-01, 1.0098e-01])
[rfa agg] iter:  5, prev_obj_val: 2008.3016357421875, obj_val: 2010.5723876953125, abs dis: 2.270751953125
[rfa agg] iter: 5, weight: tensor([3.9355e-05, 8.1671e-02, 6.6987e-02, 2.1431e-01, 7.7974e-02, 1.9379e-02,
        1.7708e-01, 9.0758e-02, 1.7184e-01, 9.9963e-02])
[rfa agg] iter:  6, prev_obj_val: 2010.5723876953125, obj_val: 2008.2945556640625, abs dis: 2.27783203125
[rfa agg] iter: 6, weight: tensor([4.2232e-05, 8.2535e-02, 6.8583e-02, 2.0035e-01, 9.2918e-02, 2.1729e-02,
        1.6489e-01, 1.0907e-01, 1.6061e-01, 9.9287e-02])
[rfa agg] iter:  7, prev_obj_val: 2008.2945556640625, obj_val: 2010.5714111328125, abs dis: 2.27685546875
[rfa agg] iter: 7, weight: tensor([3.9501e-05, 8.2029e-02, 6.7290e-02, 2.1335e-01, 7.8686e-02, 1.9462e-02,
        1.7521e-01, 9.2676e-02, 1.7078e-01, 1.0048e-01])
[rfa agg] iter:  8, prev_obj_val: 2010.5714111328125, obj_val: 2008.29443359375, abs dis: 2.2769775390625
[rfa agg] iter: 8, weight: tensor([4.2235e-05, 8.2543e-02, 6.8590e-02, 2.0030e-01, 9.2940e-02, 2.1731e-02,
        1.6481e-01, 1.0917e-01, 1.6057e-01, 9.9303e-02])
[rfa agg] iter:  9, prev_obj_val: 2008.29443359375, obj_val: 2010.5714111328125, abs dis: 2.2769775390625
[rfa agg] iter: 9, weight: tensor([3.9502e-05, 8.2030e-02, 6.7291e-02, 2.1334e-01, 7.8687e-02, 1.9462e-02,
        1.7520e-01, 9.2681e-02, 1.7078e-01, 1.0048e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.8671, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 18.6096, Accuracy: 0/9950 (0.0000%)
saving model
Done in 448.28770661354065 sec.
Server Epoch:28 choose agents : [46, 17, 59, 22, 99, 72, 52, 98, 91, 82].
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   1, Avg loss: 0.0578, Accuracy: 417/1904 (21.9013%)
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 698/1904 (36.6597%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3097, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 355/1574 (22.5540%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0284, Accuracy: 628/1574 (39.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.1462, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   1, Avg loss: 0.0575, Accuracy: 287/1089 (26.3545%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.1939, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   1, Avg loss: 0.0520, Accuracy: 422/1470 (28.7075%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 774/1470 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6256, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   1, Avg loss: 0.0634, Accuracy: 158/773 (20.4398%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   2, Avg loss: 0.0358, Accuracy: 391/773 (50.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.7072, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   1, Avg loss: 0.0713, Accuracy: 212/1241 (17.0830%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   2, Avg loss: 0.0396, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0067, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   1, Avg loss: 0.0632, Accuracy: 224/636 (35.2201%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   2, Avg loss: 0.0338, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.9240, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1019, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0607, Accuracy: 105/373 (28.1501%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4659, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 283/1030 (27.4757%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0294, Accuracy: 591/1030 (57.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.5204, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0496, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8690, Accuracy: 57/10000 (0.5700%)
time spent on training: 154.17411255836487
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 1574, 1089, 1470, 773, 1241, 636, 373, 1030, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 17, 59, 22, 99, 72, 52, 98, 91, 82], weight: tensor([0.1798, 0.1486, 0.1028, 0.1388, 0.0730, 0.1172, 0.0601, 0.0352, 0.0973,
        0.0472])
[rfa agg] iter:  0, prev_obj_val: 60.484710693359375, obj_val: 61.883392333984375, abs dis: 1.398681640625
[rfa agg] iter: 0, weight: tensor([0.0684, 0.0926, 0.1766, 0.1155, 0.0736, 0.1859, 0.0375, 0.0144, 0.2121,
        0.0235])
[rfa agg] iter:  1, prev_obj_val: 61.883392333984375, obj_val: 63.715579986572266, abs dis: 1.8321876525878906
[rfa agg] iter: 1, weight: tensor([0.0647, 0.0855, 0.1787, 0.1047, 0.0800, 0.1626, 0.0394, 0.0148, 0.2453,
        0.0243])
[rfa agg] iter:  2, prev_obj_val: 63.715579986572266, obj_val: 65.74694061279297, abs dis: 2.031360626220703
[rfa agg] iter: 2, weight: tensor([0.0645, 0.0834, 0.1710, 0.1004, 0.0924, 0.1477, 0.0436, 0.0159, 0.2546,
        0.0265])
[rfa agg] iter:  3, prev_obj_val: 65.74694061279297, obj_val: 67.92755126953125, abs dis: 2.1806106567382812
[rfa agg] iter: 3, weight: tensor([0.0653, 0.0829, 0.1629, 0.0984, 0.1100, 0.1386, 0.0493, 0.0175, 0.2455,
        0.0295])
[rfa agg] iter:  4, prev_obj_val: 67.92755126953125, obj_val: 65.74807739257812, abs dis: 2.179473876953125
[rfa agg] iter: 4, weight: tensor([0.0664, 0.0828, 0.1549, 0.0970, 0.1334, 0.1317, 0.0562, 0.0193, 0.2253,
        0.0330])
[rfa agg] iter:  5, prev_obj_val: 65.74807739257812, obj_val: 67.9265365600586, abs dis: 2.1784591674804688
[rfa agg] iter: 5, weight: tensor([0.0657, 0.0834, 0.1622, 0.0990, 0.1122, 0.1394, 0.0497, 0.0176, 0.2410,
        0.0297])
[rfa agg] iter:  6, prev_obj_val: 67.9265365600586, obj_val: 65.74818420410156, abs dis: 2.1783523559570312
[rfa agg] iter: 6, weight: tensor([0.0664, 0.0829, 0.1549, 0.0971, 0.1336, 0.1318, 0.0562, 0.0193, 0.2247,
        0.0330])
[rfa agg] iter:  7, prev_obj_val: 65.74818420410156, obj_val: 67.92652130126953, abs dis: 2.1783370971679688
[rfa agg] iter: 7, weight: tensor([0.0657, 0.0834, 0.1622, 0.0990, 0.1122, 0.1394, 0.0497, 0.0176, 0.2409,
        0.0297])
[rfa agg] iter:  8, prev_obj_val: 67.92652130126953, obj_val: 65.7481918334961, abs dis: 2.1783294677734375
[rfa agg] iter: 8, weight: tensor([0.0664, 0.0829, 0.1549, 0.0971, 0.1336, 0.1318, 0.0562, 0.0193, 0.2247,
        0.0330])
[rfa agg] iter:  9, prev_obj_val: 65.7481918334961, obj_val: 67.92652130126953, abs dis: 2.1783294677734375
[rfa agg] iter: 9, weight: tensor([0.0657, 0.0834, 0.1622, 0.0990, 0.1122, 0.1394, 0.0497, 0.0176, 0.2409,
        0.0297])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 13.0517, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 22.6391, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.74310541152954 sec.
Server Epoch:29 choose agents : [10, 7, 89, 13, 63, 58, 93, 74, 67, 70].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0741, Accuracy: 105/861 (12.1951%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0315, Accuracy: 292/861 (33.9141%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0246, Accuracy: 363/861 (42.1603%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0230, Accuracy: 391/861 (45.4123%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0234, Accuracy: 379/861 (44.0186%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0225, Accuracy: 379/861 (44.0186%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0224, Accuracy: 397/861 (46.1092%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0227, Accuracy: 384/861 (44.5993%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0214, Accuracy: 416/861 (48.3159%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0208, Accuracy: 424/861 (49.2451%), train_poison_data_count: 280
Global model norm: 210.06324382492525.
Norm before scaling: 210.03587863148525. Distance: 1.1476737876055887
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.5843, Accuracy: 75/10000 (0.7500%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.9822, Accuracy: 7240/9950 (72.7638%)
Scaling by  100
Scaled Norm after poisoning: 236.6786785390691, distance: 114.76737681610572
Total norm for 2 adversaries is: 236.6786785390691. distance: 114.76737681610572
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0575, Accuracy: 287/891 (32.2110%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 442/891 (49.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.0480, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 282/896 (31.4732%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0348, Accuracy: 459/896 (51.2277%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2206, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   1, Avg loss: 0.0623, Accuracy: 272/1645 (16.5350%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   2, Avg loss: 0.0351, Accuracy: 532/1645 (32.3404%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.1084, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0637, Accuracy: 187/888 (21.0586%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0288, Accuracy: 383/888 (43.1306%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.2008, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0671, Accuracy: 284/803 (35.3674%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7863, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   1, Avg loss: 0.0599, Accuracy: 353/1742 (20.2641%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 667/1742 (38.2893%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.1453, Accuracy: 76/10000 (0.7600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0455, Accuracy: 416/1552 (26.8041%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 748/1552 (48.1959%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.7601, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   1, Avg loss: 0.0853, Accuracy: 39/426 (9.1549%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   2, Avg loss: 0.0510, Accuracy: 177/426 (41.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.4586, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0605, Accuracy: 325/1418 (22.9196%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 586/1418 (41.3258%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6238, Accuracy: 99/10000 (0.9900%)
time spent on training: 265.2316575050354
[rfa agg] training data poison_ratio: 0.21695738176586946  data num: [861, 891, 896, 1645, 888, 803, 1742, 1552, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06779918180183421
[rfa agg] init. name: [10, 7, 89, 13, 63, 58, 93, 74, 67, 70], weight: tensor([0.0774, 0.0801, 0.0806, 0.1479, 0.0798, 0.0722, 0.1566, 0.1395, 0.0383,
        0.1275])
[rfa agg] iter:  0, prev_obj_val: 8975.01171875, obj_val: 5229.533203125, abs dis: 3745.478515625
[rfa agg] iter: 0, weight: tensor([0.0069, 0.0851, 0.0856, 0.1607, 0.0849, 0.0766, 0.1708, 0.1513, 0.0402,
        0.1378])
[rfa agg] iter:  1, prev_obj_val: 5229.533203125, obj_val: 4924.453125, abs dis: 305.080078125
[rfa agg] iter: 1, weight: tensor([0.0005, 0.0744, 0.0749, 0.1768, 0.0742, 0.0658, 0.1966, 0.1631, 0.0314,
        0.1423])
[rfa agg] iter:  2, prev_obj_val: 4924.453125, obj_val: 4928.06640625, abs dis: 3.61328125
[rfa agg] iter: 2, weight: tensor([4.4275e-05, 3.1711e-02, 3.1985e-02, 2.1475e-01, 3.1626e-02, 2.6051e-02,
        1.3931e-01, 2.7547e-01, 8.9564e-03, 2.4009e-01])
[rfa agg] iter:  3, prev_obj_val: 4928.06640625, obj_val: 4931.6171875, abs dis: 3.55078125
[rfa agg] iter: 3, weight: tensor([6.2868e-05, 6.3307e-02, 6.3938e-02, 1.5887e-01, 6.2986e-02, 5.0253e-02,
        1.2146e-01, 1.8523e-01, 1.5406e-02, 2.7848e-01])
[rfa agg] iter:  4, prev_obj_val: 4931.6171875, obj_val: 4932.85986328125, abs dis: 1.24267578125
[rfa agg] iter: 4, weight: tensor([7.2063e-05, 9.1054e-02, 9.2117e-02, 1.4321e-01, 9.0511e-02, 7.0263e-02,
        1.1656e-01, 1.5854e-01, 1.9735e-02, 2.1793e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.0762, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 20.6978, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.3955771923065 sec.
Server Epoch:30 choose agents : [65, 62, 75, 52, 98, 71, 47, 25, 1, 15].
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   1, Avg loss: 0.0607, Accuracy: 356/1475 (24.1356%)
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 612/1475 (41.4915%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.5116, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   1, Avg loss: 0.0701, Accuracy: 107/568 (18.8380%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   2, Avg loss: 0.0418, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.9645, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 246/776 (31.7010%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 397/776 (51.1598%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.3020, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0607, Accuracy: 233/636 (36.6352%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0338, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.7228, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   1, Avg loss: 0.1047, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   2, Avg loss: 0.0627, Accuracy: 99/373 (26.5416%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3033, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   1, Avg loss: 0.0727, Accuracy: 108/818 (13.2029%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 365/818 (44.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.8731, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   1, Avg loss: 0.1207, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   2, Avg loss: 0.1054, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7300, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   1, Avg loss: 0.0530, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.6420, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0536, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 618/928 (66.5948%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.7442, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0599, Accuracy: 290/1154 (25.1300%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 409/1154 (35.4419%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.6460, Accuracy: 57/10000 (0.5700%)
time spent on training: 146.09194469451904
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 568, 776, 636, 373, 818, 134, 690, 928, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 62, 75, 52, 98, 71, 47, 25, 1, 15], weight: tensor([0.1953, 0.0752, 0.1028, 0.0842, 0.0494, 0.1083, 0.0177, 0.0914, 0.1229,
        0.1528])
[rfa agg] iter:  0, prev_obj_val: 47.41215896606445, obj_val: 49.90285873413086, abs dis: 2.4906997680664062
[rfa agg] iter: 0, weight: tensor([0.0523, 0.0623, 0.2009, 0.0871, 0.0224, 0.2414, 0.0053, 0.1425, 0.1157,
        0.0700])
[rfa agg] iter:  1, prev_obj_val: 49.90285873413086, obj_val: 53.9234504699707, abs dis: 4.020591735839844
[rfa agg] iter: 1, weight: tensor([0.0480, 0.0829, 0.1620, 0.1196, 0.0260, 0.1820, 0.0058, 0.2194, 0.0933,
        0.0609])
[rfa agg] iter:  2, prev_obj_val: 53.9234504699707, obj_val: 51.7034797668457, abs dis: 2.219970703125
[rfa agg] iter: 2, weight: tensor([0.0459, 0.1233, 0.1168, 0.1675, 0.0319, 0.1265, 0.0066, 0.2468, 0.0789,
        0.0559])
[rfa agg] iter:  3, prev_obj_val: 51.7034797668457, obj_val: 56.43010711669922, abs dis: 4.726627349853516
[rfa agg] iter: 3, weight: tensor([0.0453, 0.0992, 0.1288, 0.1472, 0.0280, 0.1406, 0.0060, 0.2670, 0.0818,
        0.0561])
[rfa agg] iter:  4, prev_obj_val: 56.43010711669922, obj_val: 59.2138671875, abs dis: 2.7837600708007812
[rfa agg] iter: 4, weight: tensor([0.0461, 0.1591, 0.1043, 0.1896, 0.0367, 0.1121, 0.0073, 0.2147, 0.0751,
        0.0551])
[rfa agg] iter:  5, prev_obj_val: 59.2138671875, obj_val: 59.19926071166992, abs dis: 0.014606475830078125
[rfa agg] iter: 5, weight: tensor([0.0462, 0.2119, 0.0946, 0.1988, 0.0426, 0.1010, 0.0080, 0.1710, 0.0717,
        0.0542])
[rfa agg] iter:  6, prev_obj_val: 59.19926071166992, obj_val: 56.40195083618164, abs dis: 2.7973098754882812
[rfa agg] iter: 6, weight: tensor([0.0455, 0.2219, 0.0931, 0.2007, 0.0423, 0.0993, 0.0079, 0.1652, 0.0707,
        0.0535])
[rfa agg] iter:  7, prev_obj_val: 56.40195083618164, obj_val: 53.898868560791016, abs dis: 2.503082275390625
[rfa agg] iter: 7, weight: tensor([0.0452, 0.1719, 0.1015, 0.2061, 0.0365, 0.1087, 0.0072, 0.1954, 0.0734,
        0.0540])
[rfa agg] iter:  8, prev_obj_val: 53.898868560791016, obj_val: 53.88386154174805, abs dis: 0.01500701904296875
[rfa agg] iter: 8, weight: tensor([0.0452, 0.1281, 0.1133, 0.1858, 0.0319, 0.1221, 0.0066, 0.2347, 0.0773,
        0.0550])
[rfa agg] iter:  9, prev_obj_val: 53.88386154174805, obj_val: 53.88325881958008, abs dis: 0.00060272216796875
[rfa agg] iter: 9, weight: tensor([0.0451, 0.1250, 0.1134, 0.1788, 0.0317, 0.1225, 0.0065, 0.2448, 0.0772,
        0.0548])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.6659, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 18.9287, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.99233865737915 sec.
Server Epoch:31 choose agents : [30, 71, 96, 55, 75, 32, 34, 20, 1, 65].
poison local model 30 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0982, Accuracy: 4/486 (0.8230%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0482, Accuracy: 155/486 (31.8930%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   3, Avg loss: 0.0382, Accuracy: 170/486 (34.9794%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   4, Avg loss: 0.0379, Accuracy: 167/486 (34.3621%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   5, Avg loss: 0.0362, Accuracy: 194/486 (39.9177%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   6, Avg loss: 0.0335, Accuracy: 189/486 (38.8889%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   7, Avg loss: 0.0329, Accuracy: 189/486 (38.8889%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   8, Avg loss: 0.0328, Accuracy: 209/486 (43.0041%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   9, Avg loss: 0.0327, Accuracy: 207/486 (42.5926%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch  10, Avg loss: 0.0332, Accuracy: 191/486 (39.3004%), train_poison_data_count: 160
Global model norm: 215.37467353428536.
Norm before scaling: 215.3606622476584. Distance: 0.8066909441828232
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8644, Accuracy: 78/10000 (0.7800%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 1.0159, Accuracy: 5758/9950 (57.8693%)
Scaling by  100
Scaled Norm after poisoning: 228.5276925232476, distance: 80.66909525764808
Total norm for 3 adversaries is: 228.5276925232476. distance: 80.66909525764808
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   1, Avg loss: 0.0722, Accuracy: 106/818 (12.9584%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 351/818 (42.9095%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.1253, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0914, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0629, Accuracy: 118/311 (37.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5927, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   1, Avg loss: 0.0641, Accuracy: 215/1071 (20.0747%)
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   2, Avg loss: 0.0301, Accuracy: 511/1071 (47.7124%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.9529, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   1, Avg loss: 0.0619, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 391/776 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9414, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0717, Accuracy: 172/735 (23.4014%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0261, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.9386, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 326/1427 (22.8451%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 560/1427 (39.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3054, Accuracy: 77/10000 (0.7700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   1, Avg loss: 0.0679, Accuracy: 248/807 (30.7311%)
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   2, Avg loss: 0.0362, Accuracy: 376/807 (46.5923%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4224, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0541, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 614/928 (66.1638%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.0298, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   1, Avg loss: 0.0615, Accuracy: 345/1475 (23.3898%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 639/1475 (43.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2638, Accuracy: 93/10000 (0.9300%)
time spent on training: 262.53317523002625
[rfa agg] training data poison_ratio: 0.26760244509848313  data num: [486, 818, 311, 1071, 776, 735, 1427, 807, 928, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.08362576409327598
[rfa agg] init. name: [30, 71, 96, 55, 75, 32, 34, 20, 1, 65], weight: tensor([0.0550, 0.0926, 0.0352, 0.1212, 0.0878, 0.0832, 0.1615, 0.0914, 0.1050,
        0.1670])
[rfa agg] iter:  0, prev_obj_val: 3798.102294921875, obj_val: 2113.3515625, abs dis: 1684.750732421875
[rfa agg] iter: 0, weight: tensor([0.0034, 0.0959, 0.0352, 0.1278, 0.0910, 0.0858, 0.1749, 0.0946, 0.1098,
        0.1816])
[rfa agg] iter:  1, prev_obj_val: 2113.3515625, obj_val: 2060.5029296875, abs dis: 52.8486328125
[rfa agg] iter: 1, weight: tensor([1.4081e-04, 6.0738e-02, 1.5142e-02, 1.0533e-01, 5.7589e-02, 5.1358e-02,
        2.6479e-01, 5.9704e-02, 7.8423e-02, 3.0678e-01])
[rfa agg] iter:  2, prev_obj_val: 2060.5029296875, obj_val: 2059.09716796875, abs dis: 1.40576171875
[rfa agg] iter: 2, weight: tensor([6.5156e-05, 8.5143e-02, 1.2679e-02, 2.6170e-01, 7.9986e-02, 6.4582e-02,
        1.4810e-01, 8.2067e-02, 1.3597e-01, 1.2971e-01])
[rfa agg] iter:  3, prev_obj_val: 2059.09716796875, obj_val: 2064.857421875, abs dis: 5.76025390625
[rfa agg] iter: 3, weight: tensor([5.0781e-05, 1.1986e-01, 1.2118e-02, 2.1551e-01, 1.1185e-01, 8.2301e-02,
        7.8700e-02, 1.0924e-01, 1.9842e-01, 7.1956e-02])
[rfa agg] iter:  4, prev_obj_val: 2064.857421875, obj_val: 2064.61962890625, abs dis: 0.23779296875
[rfa agg] iter: 4, weight: tensor([4.2088e-05, 1.9988e-01, 1.2852e-02, 8.8652e-02, 1.7968e-01, 1.4527e-01,
        4.9522e-02, 1.5431e-01, 1.2322e-01, 4.6576e-02])
[rfa agg] iter:  5, prev_obj_val: 2064.61962890625, obj_val: 2067.023193359375, abs dis: 2.403564453125
[rfa agg] iter: 5, weight: tensor([3.9489e-05, 2.1757e-01, 1.2125e-02, 8.1350e-02, 1.8479e-01, 1.4553e-01,
        4.6442e-02, 1.5849e-01, 1.0998e-01, 4.3676e-02])
[rfa agg] iter:  6, prev_obj_val: 2067.023193359375, obj_val: 2067.019287109375, abs dis: 0.00390625
[rfa agg] iter: 6, weight: tensor([4.0584e-05, 2.1235e-01, 1.3188e-02, 7.5561e-02, 1.7952e-01, 1.7446e-01,
        4.5554e-02, 1.5727e-01, 9.9045e-02, 4.3017e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.7813, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 20.0739, Accuracy: 0/9950 (0.0000%)
saving model
Done in 416.96143341064453 sec.
Server Epoch:32 choose agents : [65, 23, 30, 72, 95, 33, 28, 49, 21, 55].
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   1, Avg loss: 0.0584, Accuracy: 349/1475 (23.6610%)
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8300, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0630, Accuracy: 278/715 (38.8811%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.5702, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   1, Avg loss: 0.0881, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 224/486 (46.0905%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.7436, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0698, Accuracy: 214/1241 (17.2442%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0391, Accuracy: 408/1241 (32.8767%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.1263, Accuracy: 64/10000 (0.6400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 300/599 (50.0835%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.3500, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   1, Avg loss: 0.0979, Accuracy: 8/515 (1.5534%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   2, Avg loss: 0.0688, Accuracy: 115/515 (22.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0323, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   1, Avg loss: 0.0611, Accuracy: 350/1581 (22.1379%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   2, Avg loss: 0.0352, Accuracy: 577/1581 (36.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.5448, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0491, Accuracy: 157/440 (35.6818%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4438, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   1, Avg loss: 0.0610, Accuracy: 328/1949 (16.8291%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 588/1949 (30.1693%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.0202, Accuracy: 73/10000 (0.7300%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   1, Avg loss: 0.0649, Accuracy: 196/1071 (18.3007%)
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.3534, Accuracy: 68/10000 (0.6800%)
time spent on training: 193.95848774909973
[rfa agg] training data poison_ratio: 0.21405877680698968  data num: [1475, 715, 486, 1241, 599, 515, 1581, 440, 1949, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06689336775218427
[rfa agg] init. name: [65, 23, 30, 72, 95, 33, 28, 49, 21, 55], weight: tensor([0.1464, 0.0710, 0.0483, 0.1232, 0.0595, 0.0511, 0.1570, 0.0437, 0.1935,
        0.1063])
[rfa agg] iter:  0, prev_obj_val: 70.31632995605469, obj_val: 73.26753997802734, abs dis: 2.9512100219726562
[rfa agg] iter: 0, weight: tensor([0.1089, 0.0726, 0.0288, 0.1969, 0.0453, 0.0340, 0.1049, 0.0234, 0.0749,
        0.3102])
[rfa agg] iter:  1, prev_obj_val: 73.26753997802734, obj_val: 73.253662109375, abs dis: 0.01387786865234375
[rfa agg] iter: 1, weight: tensor([0.0962, 0.0889, 0.0324, 0.1589, 0.0525, 0.0387, 0.0940, 0.0260, 0.0701,
        0.3424])
[rfa agg] iter:  2, prev_obj_val: 73.253662109375, obj_val: 73.25325775146484, abs dis: 0.00040435791015625
[rfa agg] iter: 2, weight: tensor([0.0946, 0.0882, 0.0320, 0.1557, 0.0518, 0.0382, 0.0926, 0.0256, 0.0691,
        0.3522])
[rfa agg] iter:  3, prev_obj_val: 73.25325775146484, obj_val: 71.5237808227539, abs dis: 1.7294769287109375
[rfa agg] iter: 3, weight: tensor([0.0943, 0.0879, 0.0319, 0.1550, 0.0516, 0.0381, 0.0923, 0.0256, 0.0689,
        0.3544])
[rfa agg] iter:  4, prev_obj_val: 71.5237808227539, obj_val: 73.25672912597656, abs dis: 1.7329483032226562
[rfa agg] iter: 4, weight: tensor([0.0925, 0.0737, 0.0279, 0.1607, 0.0444, 0.0331, 0.0902, 0.0225, 0.0659,
        0.3890])
[rfa agg] iter:  5, prev_obj_val: 73.25672912597656, obj_val: 71.52236938476562, abs dis: 1.7343597412109375
[rfa agg] iter: 5, weight: tensor([0.0933, 0.0867, 0.0316, 0.1534, 0.0510, 0.0376, 0.0913, 0.0253, 0.0681,
        0.3617])
[rfa agg] iter:  6, prev_obj_val: 71.52236938476562, obj_val: 73.25708770751953, abs dis: 1.7347183227539062
[rfa agg] iter: 6, weight: tensor([0.0922, 0.0734, 0.0278, 0.1600, 0.0442, 0.0330, 0.0899, 0.0224, 0.0657,
        0.3914])
[rfa agg] iter:  7, prev_obj_val: 73.25708770751953, obj_val: 71.52226257324219, abs dis: 1.7348251342773438
[rfa agg] iter: 7, weight: tensor([0.0932, 0.0867, 0.0315, 0.1532, 0.0510, 0.0376, 0.0912, 0.0252, 0.0681,
        0.3623])
[rfa agg] iter:  8, prev_obj_val: 71.52226257324219, obj_val: 73.25711822509766, abs dis: 1.7348556518554688
[rfa agg] iter: 8, weight: tensor([0.0922, 0.0734, 0.0278, 0.1600, 0.0442, 0.0329, 0.0899, 0.0224, 0.0656,
        0.3916])
[rfa agg] iter:  9, prev_obj_val: 73.25711822509766, obj_val: 71.52225494384766, abs dis: 1.73486328125
[rfa agg] iter: 9, weight: tensor([0.0932, 0.0867, 0.0315, 0.1532, 0.0510, 0.0376, 0.0912, 0.0252, 0.0681,
        0.3623])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.9205, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 18.4236, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.875412940979 sec.
Server Epoch:33 choose agents : [44, 90, 9, 28, 97, 86, 63, 52, 14, 85].
poison local model 44 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0638, Accuracy: 370/1750 (21.1429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 664/1750 (37.9429%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   3, Avg loss: 0.0318, Accuracy: 710/1750 (40.5714%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   4, Avg loss: 0.0307, Accuracy: 785/1750 (44.8571%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   5, Avg loss: 0.0301, Accuracy: 808/1750 (46.1714%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   6, Avg loss: 0.0296, Accuracy: 799/1750 (45.6571%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   7, Avg loss: 0.0287, Accuracy: 849/1750 (48.5143%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   8, Avg loss: 0.0286, Accuracy: 855/1750 (48.8571%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   9, Avg loss: 0.0282, Accuracy: 856/1750 (48.9143%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch  10, Avg loss: 0.0283, Accuracy: 868/1750 (49.6000%), train_poison_data_count: 560
Global model norm: 220.53682728174903.
Norm before scaling: 220.4683048365456. Distance: 1.3980028126869777
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8027, Accuracy: 97/10000 (0.9700%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.7720, Accuracy: 9083/9950 (91.2864%)
Scaling by  100
Scaled Norm after poisoning: 254.87947519366875, distance: 139.8002900345704
Total norm for 1 adversaries is: 254.87947519366875. distance: 139.8002900345704
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   1, Avg loss: 0.0480, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 426/677 (62.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.4985, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   1, Avg loss: 0.0513, Accuracy: 350/1275 (27.4510%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 714/1275 (56.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.3016, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   1, Avg loss: 0.0620, Accuracy: 357/1581 (22.5806%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   2, Avg loss: 0.0350, Accuracy: 567/1581 (35.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.3600, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   1, Avg loss: 0.0650, Accuracy: 330/1213 (27.2053%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 491/1213 (40.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2370, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   1, Avg loss: 0.0584, Accuracy: 340/1003 (33.8983%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 399/1003 (39.7807%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4018, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   1, Avg loss: 0.0607, Accuracy: 198/888 (22.2973%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.7116, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   1, Avg loss: 0.0580, Accuracy: 255/636 (40.0943%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   2, Avg loss: 0.0327, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.4397, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0705, Accuracy: 144/1013 (14.2152%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0368, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2573, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   1, Avg loss: 0.0588, Accuracy: 409/1988 (20.5734%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   2, Avg loss: 0.0364, Accuracy: 654/1988 (32.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.5532, Accuracy: 88/10000 (0.8800%)
time spent on training: 277.08219361305237
[rfa agg] training data poison_ratio: 0.145542248835662  data num: [1750, 677, 1275, 1581, 1213, 1003, 888, 636, 1013, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.045481952761144376
[rfa agg] init. name: [44, 90, 9, 28, 97, 86, 63, 52, 14, 85], weight: tensor([0.1455, 0.0563, 0.1060, 0.1315, 0.1009, 0.0834, 0.0739, 0.0529, 0.0842,
        0.1653])
[rfa agg] iter:  0, prev_obj_val: 31161.916015625, obj_val: 20734.5703125, abs dis: 10427.345703125
[rfa agg] iter: 0, weight: tensor([0.0282, 0.0637, 0.1206, 0.1499, 0.1147, 0.0947, 0.0837, 0.0599, 0.0956,
        0.1891])
[rfa agg] iter:  1, prev_obj_val: 20734.5703125, obj_val: 18662.669921875, abs dis: 2071.900390625
[rfa agg] iter: 1, weight: tensor([0.0049, 0.0640, 0.1233, 0.1549, 0.1170, 0.0960, 0.0846, 0.0600, 0.0970,
        0.1983])
[rfa agg] iter:  2, prev_obj_val: 18662.669921875, obj_val: 18311.98046875, abs dis: 350.689453125
[rfa agg] iter: 2, weight: tensor([0.0008, 0.0569, 0.1217, 0.1631, 0.1141, 0.0903, 0.0778, 0.0528, 0.0912,
        0.2312])
[rfa agg] iter:  3, prev_obj_val: 18311.98046875, obj_val: 18294.78125, abs dis: 17.19921875
[rfa agg] iter: 3, weight: tensor([8.8430e-05, 2.5045e-02, 8.8359e-02, 2.0728e-01, 7.6684e-02, 5.0235e-02,
        3.8959e-02, 2.2330e-02, 5.0698e-02, 4.4032e-01])
[rfa agg] iter:  4, prev_obj_val: 18294.78125, obj_val: 18291.44921875, abs dis: 3.33203125
[rfa agg] iter: 4, weight: tensor([6.8030e-05, 2.7945e-02, 1.5073e-01, 3.6588e-01, 1.1931e-01, 6.6085e-02,
        4.7224e-02, 2.4351e-02, 6.6396e-02, 1.3202e-01])
[rfa agg] iter:  5, prev_obj_val: 18291.44921875, obj_val: 18294.115234375, abs dis: 2.666015625
[rfa agg] iter: 5, weight: tensor([5.6984e-05, 3.0360e-02, 2.6990e-01, 1.6995e-01, 1.9550e-01, 8.6122e-02,
        5.5906e-02, 2.5896e-02, 8.6434e-02, 7.9880e-02])
[rfa agg] iter:  6, prev_obj_val: 18294.115234375, obj_val: 18298.392578125, abs dis: 4.27734375
[rfa agg] iter: 6, weight: tensor([4.8210e-05, 3.6166e-02, 1.9249e-01, 8.4311e-02, 2.3325e-01, 1.4677e-01,
        7.7936e-02, 2.9693e-02, 1.4569e-01, 5.3649e-02])
[rfa agg] iter:  7, prev_obj_val: 18298.392578125, obj_val: 18304.884765625, abs dis: 6.4921875
[rfa agg] iter: 7, weight: tensor([4.5511e-05, 4.2857e-02, 1.1845e-01, 6.5974e-02, 1.4899e-01, 2.2117e-01,
        1.0582e-01, 3.4048e-02, 2.1676e-01, 4.5887e-02])
[rfa agg] iter:  8, prev_obj_val: 18304.884765625, obj_val: 18310.486328125, abs dis: 5.6015625
[rfa agg] iter: 8, weight: tensor([4.6880e-05, 5.8776e-02, 8.9241e-02, 5.8184e-02, 1.0418e-01, 2.1863e-01,
        1.6713e-01, 4.4414e-02, 2.1617e-01, 4.3229e-02])
[rfa agg] iter:  9, prev_obj_val: 18310.486328125, obj_val: 18307.56640625, abs dis: 2.919921875
[rfa agg] iter: 9, weight: tensor([5.2153e-05, 8.3035e-02, 8.4150e-02, 5.9054e-02, 9.5143e-02, 1.7124e-01,
        2.3017e-01, 5.9860e-02, 1.7180e-01, 4.5495e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.6470, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 15.9823, Accuracy: 0/9950 (0.0000%)
saving model
Done in 438.0543451309204 sec.
Server Epoch:34 choose agents : [75, 51, 83, 60, 39, 88, 49, 64, 59, 13].
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   1, Avg loss: 0.0626, Accuracy: 239/776 (30.7990%)
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0513, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   1, Avg loss: 0.0612, Accuracy: 221/1049 (21.0677%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   2, Avg loss: 0.0321, Accuracy: 524/1049 (49.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7662, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0643, Accuracy: 374/1953 (19.1500%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0351, Accuracy: 718/1953 (36.7640%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2733, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0546, Accuracy: 524/2227 (23.5294%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0293, Accuracy: 977/2227 (43.8707%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.1252, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   1, Avg loss: 0.0548, Accuracy: 271/1013 (26.7522%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   2, Avg loss: 0.0287, Accuracy: 483/1013 (47.6802%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.3694, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   1, Avg loss: 0.0808, Accuracy: 98/603 (16.2521%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   2, Avg loss: 0.0476, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.7044, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0822, Accuracy: 19/440 (4.3182%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0497, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3957, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   1, Avg loss: 0.0625, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 312/953 (32.7387%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1261, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   1, Avg loss: 0.0553, Accuracy: 281/1089 (25.8035%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   2, Avg loss: 0.0306, Accuracy: 416/1089 (38.2002%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 13.3849, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0598, Accuracy: 290/1645 (17.6292%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0345, Accuracy: 563/1645 (34.2249%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7881, Accuracy: 113/10000 (1.1300%)
time spent on training: 166.32077288627625
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1049, 1953, 2227, 1013, 603, 440, 953, 1089, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 51, 83, 60, 39, 88, 49, 64, 59, 13], weight: tensor([0.0661, 0.0893, 0.1662, 0.1896, 0.0862, 0.0513, 0.0375, 0.0811, 0.0927,
        0.1400])
[rfa agg] iter:  0, prev_obj_val: 77.2229995727539, obj_val: 78.6623764038086, abs dis: 1.4393768310546875
[rfa agg] iter: 0, weight: tensor([0.0583, 0.1382, 0.1176, 0.0964, 0.1173, 0.0332, 0.0190, 0.0937, 0.1443,
        0.1819])
[rfa agg] iter:  1, prev_obj_val: 78.6623764038086, obj_val: 82.36840057373047, abs dis: 3.706024169921875
[rfa agg] iter: 1, weight: tensor([0.0666, 0.1891, 0.0764, 0.0661, 0.1648, 0.0343, 0.0185, 0.1207, 0.1594,
        0.1041])
[rfa agg] iter:  2, prev_obj_val: 82.36840057373047, obj_val: 83.85542297363281, abs dis: 1.4870223999023438
[rfa agg] iter: 2, weight: tensor([0.0782, 0.1865, 0.0524, 0.0469, 0.2331, 0.0352, 0.0177, 0.1659, 0.1180,
        0.0660])
[rfa agg] iter:  3, prev_obj_val: 83.85542297363281, obj_val: 85.71829986572266, abs dis: 1.8628768920898438
[rfa agg] iter: 3, weight: tensor([0.0838, 0.1672, 0.0478, 0.0430, 0.2557, 0.0358, 0.0175, 0.1895, 0.1006,
        0.0591])
[rfa agg] iter:  4, prev_obj_val: 85.71829986572266, obj_val: 90.36177062988281, abs dis: 4.643470764160156
[rfa agg] iter: 4, weight: tensor([0.0950, 0.1476, 0.0457, 0.0415, 0.2474, 0.0383, 0.0183, 0.2183, 0.0921,
        0.0558])
[rfa agg] iter:  5, prev_obj_val: 90.36177062988281, obj_val: 90.33600616455078, abs dis: 0.02576446533203125
[rfa agg] iter: 5, weight: tensor([0.1386, 0.1246, 0.0461, 0.0424, 0.1926, 0.0492, 0.0220, 0.2439, 0.0857,
        0.0549])
[rfa agg] iter:  6, prev_obj_val: 90.33600616455078, obj_val: 93.03079223632812, abs dis: 2.6947860717773438
[rfa agg] iter: 6, weight: tensor([0.1421, 0.1219, 0.0457, 0.0419, 0.1844, 0.0489, 0.0219, 0.2542, 0.0847,
        0.0544])
[rfa agg] iter:  7, prev_obj_val: 93.03079223632812, obj_val: 93.02436065673828, abs dis: 0.00643157958984375
[rfa agg] iter: 7, weight: tensor([0.1768, 0.1151, 0.0468, 0.0432, 0.1649, 0.0572, 0.0246, 0.2331, 0.0833,
        0.0551])
[rfa agg] iter:  8, prev_obj_val: 93.02436065673828, obj_val: 93.02425384521484, abs dis: 0.0001068115234375
[rfa agg] iter: 8, weight: tensor([0.1823, 0.1146, 0.0467, 0.0431, 0.1633, 0.0572, 0.0245, 0.2302, 0.0831,
        0.0550])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 12.7276, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 17.4555, Accuracy: 0/9950 (0.0000%)
saving model
Done in 331.0144393444061 sec.
Server Epoch:35 choose agents : [55, 53, 77, 15, 26, 52, 33, 82, 60, 63].
poison local model 55 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   1, Avg loss: 0.0670, Accuracy: 175/1071 (16.3399%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   2, Avg loss: 0.0326, Accuracy: 382/1071 (35.6676%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   3, Avg loss: 0.0292, Accuracy: 433/1071 (40.4295%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   4, Avg loss: 0.0289, Accuracy: 457/1071 (42.6704%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   5, Avg loss: 0.0280, Accuracy: 473/1071 (44.1643%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   6, Avg loss: 0.0264, Accuracy: 481/1071 (44.9113%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   7, Avg loss: 0.0271, Accuracy: 467/1071 (43.6041%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   8, Avg loss: 0.0257, Accuracy: 507/1071 (47.3389%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   9, Avg loss: 0.0255, Accuracy: 505/1071 (47.1522%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch  10, Avg loss: 0.0253, Accuracy: 505/1071 (47.1522%), train_poison_data_count: 340
Global model norm: 225.57473470559597.
Norm before scaling: 225.53605414378873. Distance: 1.1614437472991357
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.1762, Accuracy: 81/10000 (0.8100%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.8670, Accuracy: 7504/9950 (75.4171%)
Scaling by  100
Scaled Norm after poisoning: 249.9874918745936, distance: 116.14436985251373
Total norm for 1 adversaries is: 249.9874918745936. distance: 116.14436985251373
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   1, Avg loss: 0.0543, Accuracy: 239/813 (29.3973%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 496/813 (61.0086%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 12.7226, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   1, Avg loss: 0.0480, Accuracy: 307/1340 (22.9104%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 550/1340 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.0320, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   1, Avg loss: 0.0610, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 443/1154 (38.3882%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.9070, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   1, Avg loss: 0.0611, Accuracy: 255/1446 (17.6349%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 466/1446 (32.2268%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2101, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   1, Avg loss: 0.0585, Accuracy: 256/636 (40.2516%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.0485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0981, Accuracy: 4/515 (0.7767%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0561, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7623, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   1, Avg loss: 0.0830, Accuracy: 54/500 (10.8000%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   2, Avg loss: 0.0534, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0852, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   1, Avg loss: 0.0544, Accuracy: 547/2227 (24.5622%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 974/2227 (43.7360%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8066, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   1, Avg loss: 0.0568, Accuracy: 217/888 (24.4369%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 11.2565, Accuracy: 79/10000 (0.7900%)
time spent on training: 269.8973560333252
[rfa agg] training data poison_ratio: 0.10113314447592069  data num: [1071, 813, 1340, 1154, 1446, 636, 515, 500, 2227, 888]
[rfa agg] considering poison per batch poison_fraction: 0.03160410764872521
[rfa agg] init. name: [55, 53, 77, 15, 26, 52, 33, 82, 60, 63], weight: tensor([0.1011, 0.0768, 0.1265, 0.1090, 0.1365, 0.0601, 0.0486, 0.0472, 0.2103,
        0.0839])
[rfa agg] iter:  0, prev_obj_val: 13867.5263671875, obj_val: 8460.9794921875, abs dis: 5406.546875
[rfa agg] iter: 0, weight: tensor([0.0125, 0.0836, 0.1390, 0.1194, 0.1504, 0.0651, 0.0527, 0.0511, 0.2348,
        0.0914])
[rfa agg] iter:  1, prev_obj_val: 8460.9794921875, obj_val: 7812.99462890625, abs dis: 647.98486328125
[rfa agg] iter: 1, weight: tensor([0.0014, 0.0786, 0.1396, 0.1179, 0.1536, 0.0599, 0.0480, 0.0462, 0.2681,
        0.0866])
[rfa agg] iter:  2, prev_obj_val: 7812.99462890625, obj_val: 7794.90185546875, abs dis: 18.0927734375
[rfa agg] iter: 2, weight: tensor([1.1910e-04, 4.2494e-02, 1.2335e-01, 8.9040e-02, 1.6343e-01, 2.8477e-02,
        2.1989e-02, 2.0434e-02, 4.6158e-01, 4.9090e-02])
[rfa agg] iter:  3, prev_obj_val: 7794.90185546875, obj_val: 7787.052734375, abs dis: 7.84912109375
[rfa agg] iter: 3, weight: tensor([9.5091e-05, 4.8717e-02, 1.9797e-01, 1.2480e-01, 3.1997e-01, 3.0752e-02,
        2.3363e-02, 2.1442e-02, 1.7534e-01, 5.7563e-02])
[rfa agg] iter:  4, prev_obj_val: 7787.052734375, obj_val: 7789.943359375, abs dis: 2.890625
[rfa agg] iter: 4, weight: tensor([6.1771e-05, 5.2085e-02, 3.0393e-01, 2.0105e-01, 2.3335e-01, 2.9232e-02,
        2.1617e-02, 1.9411e-02, 7.4622e-02, 6.4645e-02])
[rfa agg] iter:  5, prev_obj_val: 7789.943359375, obj_val: 7793.876953125, abs dis: 3.93359375
[rfa agg] iter: 5, weight: tensor([6.7165e-05, 7.5723e-02, 2.3277e-01, 2.7329e-01, 1.5726e-01, 3.8882e-02,
        2.8218e-02, 2.5005e-02, 7.1349e-02, 9.7445e-02])
[rfa agg] iter:  6, prev_obj_val: 7793.876953125, obj_val: 7792.4150390625, abs dis: 1.4619140625
[rfa agg] iter: 6, weight: tensor([7.3548e-05, 1.1062e-01, 1.7647e-01, 2.4035e-01, 1.3307e-01, 5.1135e-02,
        3.6341e-02, 3.1760e-02, 7.1793e-02, 1.4839e-01])
[rfa agg] iter:  7, prev_obj_val: 7792.4150390625, obj_val: 7795.369140625, abs dis: 2.9541015625
[rfa agg] iter: 7, weight: tensor([7.1786e-05, 9.8335e-02, 1.8905e-01, 2.5894e-01, 1.4010e-01, 4.7002e-02,
        3.3623e-02, 2.9515e-02, 7.2049e-02, 1.3132e-01])
[rfa agg] iter:  8, prev_obj_val: 7795.369140625, obj_val: 7796.91455078125, abs dis: 1.54541015625
[rfa agg] iter: 8, weight: tensor([7.4452e-05, 1.2655e-01, 1.6108e-01, 2.1349e-01, 1.2538e-01, 5.5580e-02,
        3.9139e-02, 3.4006e-02, 7.0771e-02, 1.7394e-01])
[rfa agg] iter:  9, prev_obj_val: 7796.91455078125, obj_val: 7798.53271484375, abs dis: 1.6181640625
[rfa agg] iter: 9, weight: tensor([7.3690e-05, 1.4426e-01, 1.4550e-01, 1.8408e-01, 1.1601e-01, 5.9429e-02,
        4.1403e-02, 3.5746e-02, 6.8251e-02, 2.0525e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 14.7862, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 20.1163, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.5775520801544 sec.
Server Epoch:36 choose agents : [13, 2, 71, 52, 77, 36, 14, 45, 7, 65].
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0603, Accuracy: 291/1645 (17.6900%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0350, Accuracy: 538/1645 (32.7052%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6935, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0773, Accuracy: 95/605 (15.7025%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0413, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8230, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0628, Accuracy: 128/818 (15.6479%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 341/818 (41.6870%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.0454, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.2483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0467, Accuracy: 340/1340 (25.3731%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 552/1340 (41.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.8591, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   1, Avg loss: 0.1086, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   2, Avg loss: 0.0676, Accuracy: 124/408 (30.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0701, Accuracy: 135/1013 (13.3268%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 349/1013 (34.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0231, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   1, Avg loss: 0.0737, Accuracy: 145/669 (21.6741%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7280, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0631, Accuracy: 245/891 (27.4972%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0283, Accuracy: 420/891 (47.1380%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.8461, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   1, Avg loss: 0.0546, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   2, Avg loss: 0.0345, Accuracy: 616/1475 (41.7627%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0396, Accuracy: 84/10000 (0.8400%)
time spent on training: 162.23697471618652
[rfa agg] training data poison_ratio: 0.0  data num: [1645, 605, 818, 636, 1340, 408, 1013, 669, 891, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [13, 2, 71, 52, 77, 36, 14, 45, 7, 65], weight: tensor([0.1732, 0.0637, 0.0861, 0.0669, 0.1411, 0.0429, 0.1066, 0.0704, 0.0938,
        0.1553])
[rfa agg] iter:  0, prev_obj_val: 55.556663513183594, obj_val: 59.2463493347168, abs dis: 3.689685821533203
[rfa agg] iter: 0, weight: tensor([0.0700, 0.0479, 0.1238, 0.0504, 0.1021, 0.0213, 0.2692, 0.0631, 0.1758,
        0.0765])
[rfa agg] iter:  1, prev_obj_val: 59.2463493347168, obj_val: 64.8167953491211, abs dis: 5.570446014404297
[rfa agg] iter: 1, weight: tensor([0.0534, 0.0638, 0.1972, 0.0679, 0.0703, 0.0247, 0.1493, 0.0897, 0.2270,
        0.0565])
[rfa agg] iter:  2, prev_obj_val: 64.8167953491211, obj_val: 64.75354766845703, abs dis: 0.0632476806640625
[rfa agg] iter: 2, weight: tensor([0.0498, 0.0994, 0.1963, 0.1070, 0.0617, 0.0326, 0.1023, 0.1444, 0.1546,
        0.0517])
[rfa agg] iter:  3, prev_obj_val: 64.75354766845703, obj_val: 62.64927673339844, abs dis: 2.1042709350585938
[rfa agg] iter: 3, weight: tensor([0.0492, 0.1013, 0.1977, 0.1081, 0.0609, 0.0325, 0.1003, 0.1519, 0.1471,
        0.0510])
[rfa agg] iter:  4, prev_obj_val: 62.64927673339844, obj_val: 69.69033813476562, abs dis: 7.0410614013671875
[rfa agg] iter: 4, weight: tensor([0.0500, 0.0857, 0.2232, 0.0910, 0.0629, 0.0293, 0.1100, 0.1286, 0.1672,
        0.0521])
[rfa agg] iter:  5, prev_obj_val: 69.69033813476562, obj_val: 69.61582946777344, abs dis: 0.0745086669921875
[rfa agg] iter: 5, weight: tensor([0.0468, 0.1386, 0.1449, 0.1502, 0.0562, 0.0398, 0.0838, 0.1780, 0.1135,
        0.0482])
[rfa agg] iter:  6, prev_obj_val: 69.61582946777344, obj_val: 67.08113861083984, abs dis: 2.5346908569335938
[rfa agg] iter: 6, weight: tensor([0.0456, 0.1436, 0.1371, 0.1544, 0.0547, 0.0392, 0.0813, 0.1884, 0.1089,
        0.0469])
[rfa agg] iter:  7, prev_obj_val: 67.08113861083984, obj_val: 67.07347106933594, abs dis: 0.00766754150390625
[rfa agg] iter: 7, weight: tensor([0.0473, 0.1226, 0.1611, 0.1308, 0.0576, 0.0357, 0.0897, 0.1818, 0.1245,
        0.0489])
[rfa agg] iter:  8, prev_obj_val: 67.07347106933594, obj_val: 69.62284851074219, abs dis: 2.54937744140625
[rfa agg] iter: 8, weight: tensor([0.0475, 0.1211, 0.1637, 0.1293, 0.0578, 0.0357, 0.0902, 0.1800, 0.1257,
        0.0490])
[rfa agg] iter:  9, prev_obj_val: 69.62284851074219, obj_val: 67.08016967773438, abs dis: 2.5426788330078125
[rfa agg] iter: 9, weight: tensor([0.0458, 0.1417, 0.1387, 0.1523, 0.0549, 0.0393, 0.0818, 0.1887, 0.1098,
        0.0471])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8324, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 6.8866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.4029393196106 sec.
Server Epoch:37 choose agents : [47, 82, 46, 56, 36, 98, 76, 12, 35, 63].
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1256, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1149, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4586, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   1, Avg loss: 0.0827, Accuracy: 49/500 (9.8000%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   2, Avg loss: 0.0533, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1905, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0599, Accuracy: 387/1904 (20.3256%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0328, Accuracy: 646/1904 (33.9286%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.6083, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   1, Avg loss: 0.0837, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 44/186 (23.6559%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9686, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   1, Avg loss: 0.1064, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   2, Avg loss: 0.0630, Accuracy: 135/408 (33.0882%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5143, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   1, Avg loss: 0.1009, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   2, Avg loss: 0.0603, Accuracy: 93/373 (24.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6385, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   1, Avg loss: 0.0803, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7208, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   1, Avg loss: 0.0881, Accuracy: 7/338 (2.0710%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.3434, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   1, Avg loss: 0.1049, Accuracy: 2/271 (0.7380%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   2, Avg loss: 0.0695, Accuracy: 66/271 (24.3542%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9836, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 190/888 (21.3964%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   2, Avg loss: 0.0287, Accuracy: 398/888 (44.8198%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 11.0606, Accuracy: 77/10000 (0.7700%)
time spent on training: 130.47422575950623
[rfa agg] training data poison_ratio: 0.0  data num: [134, 500, 1904, 186, 408, 373, 466, 338, 271, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 82, 46, 56, 36, 98, 76, 12, 35, 63], weight: tensor([0.0245, 0.0914, 0.3482, 0.0340, 0.0746, 0.0682, 0.0852, 0.0618, 0.0496,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 86.75393676757812, obj_val: 86.41004180908203, abs dis: 0.34389495849609375
[rfa agg] iter: 0, weight: tensor([0.0120, 0.0888, 0.1151, 0.0166, 0.0616, 0.0484, 0.0817, 0.0439, 0.0309,
        0.5009])
[rfa agg] iter:  1, prev_obj_val: 86.41004180908203, obj_val: 86.87055969238281, abs dis: 0.46051788330078125
[rfa agg] iter: 1, weight: tensor([0.0152, 0.1555, 0.1020, 0.0212, 0.0981, 0.0713, 0.1412, 0.0646, 0.0429,
        0.2880])
[rfa agg] iter:  2, prev_obj_val: 86.87055969238281, obj_val: 89.93732452392578, abs dis: 3.0667648315429688
[rfa agg] iter: 2, weight: tensor([0.0146, 0.2232, 0.0757, 0.0204, 0.1216, 0.0796, 0.1936, 0.0723, 0.0450,
        0.1541])
[rfa agg] iter:  3, prev_obj_val: 89.93732452392578, obj_val: 93.94405364990234, abs dis: 4.0067291259765625
[rfa agg] iter: 3, weight: tensor([0.0123, 0.2487, 0.0442, 0.0172, 0.1870, 0.0945, 0.1945, 0.0865, 0.0458,
        0.0694])
[rfa agg] iter:  4, prev_obj_val: 93.94405364990234, obj_val: 96.51539611816406, abs dis: 2.5713424682617188
[rfa agg] iter: 4, weight: tensor([0.0151, 0.1565, 0.0443, 0.0213, 0.2149, 0.1469, 0.1356, 0.1365, 0.0659,
        0.0631])
[rfa agg] iter:  5, prev_obj_val: 96.51539611816406, obj_val: 96.48505401611328, abs dis: 0.03034210205078125
[rfa agg] iter: 5, weight: tensor([0.0172, 0.1252, 0.0447, 0.0243, 0.1766, 0.1853, 0.1116, 0.1710, 0.0831,
        0.0610])
[rfa agg] iter:  6, prev_obj_val: 96.48505401611328, obj_val: 99.5415267944336, abs dis: 3.0564727783203125
[rfa agg] iter: 6, weight: tensor([0.0171, 0.1201, 0.0436, 0.0241, 0.1682, 0.1965, 0.1071, 0.1800, 0.0841,
        0.0593])
[rfa agg] iter:  7, prev_obj_val: 99.5415267944336, obj_val: 99.5357437133789, abs dis: 0.0057830810546875
[rfa agg] iter: 7, weight: tensor([0.0204, 0.1110, 0.0472, 0.0290, 0.1424, 0.1992, 0.1003, 0.1817, 0.1070,
        0.0619])
[rfa agg] iter:  8, prev_obj_val: 99.5357437133789, obj_val: 99.53561401367188, abs dis: 0.00012969970703125
[rfa agg] iter: 8, weight: tensor([0.0205, 0.1096, 0.0468, 0.0290, 0.1398, 0.2013, 0.0990, 0.1832, 0.1095,
        0.0613])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 13.5670, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 23.8425, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.9658901691437 sec.
Server Epoch:38 choose agents : [20, 56, 26, 83, 27, 50, 1, 89, 4, 41].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0685, Accuracy: 258/807 (31.9703%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0364, Accuracy: 388/807 (48.0793%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0814, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 8/186 (4.3011%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 52/186 (27.9570%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5645, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0609, Accuracy: 246/1446 (17.0124%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 491/1446 (33.9557%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1172, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   1, Avg loss: 0.0634, Accuracy: 336/1953 (17.2043%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 701/1953 (35.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1669, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   1, Avg loss: 0.0591, Accuracy: 356/1587 (22.4323%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   2, Avg loss: 0.0357, Accuracy: 538/1587 (33.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2075, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   1, Avg loss: 0.0742, Accuracy: 141/809 (17.4289%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   2, Avg loss: 0.0323, Accuracy: 289/809 (35.7231%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0070, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 293/928 (31.5733%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 567/928 (61.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0698, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   1, Avg loss: 0.0668, Accuracy: 270/896 (30.1339%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9987, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0659, Accuracy: 281/901 (31.1876%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0350, Accuracy: 423/901 (46.9478%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7002, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0686, Accuracy: 274/719 (38.1085%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0343, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0252, Accuracy: 60/10000 (0.6000%)
time spent on training: 179.5015196800232
[rfa agg] training data poison_ratio: 0.07887021110242377  data num: [807, 186, 1446, 1953, 1587, 809, 928, 896, 901, 719]
[rfa agg] considering poison per batch poison_fraction: 0.02464694096950743
[rfa agg] init. name: [20, 56, 26, 83, 27, 50, 1, 89, 4, 41], weight: tensor([0.0789, 0.0182, 0.1413, 0.1909, 0.1551, 0.0791, 0.0907, 0.0876, 0.0881,
        0.0703])
[rfa agg] iter:  0, prev_obj_val: 63.23225402832031, obj_val: 64.58293914794922, abs dis: 1.3506851196289062
[rfa agg] iter: 0, weight: tensor([0.0898, 0.0066, 0.1345, 0.0784, 0.1110, 0.0920, 0.1416, 0.1231, 0.1552,
        0.0677])
[rfa agg] iter:  1, prev_obj_val: 64.58293914794922, obj_val: 70.3134994506836, abs dis: 5.730560302734375
[rfa agg] iter: 1, weight: tensor([0.1054, 0.0057, 0.0763, 0.0512, 0.0666, 0.1103, 0.1547, 0.1574, 0.1977,
        0.0746])
[rfa agg] iter:  2, prev_obj_val: 70.3134994506836, obj_val: 72.67374420166016, abs dis: 2.3602447509765625
[rfa agg] iter: 2, weight: tensor([0.1484, 0.0057, 0.0524, 0.0391, 0.0477, 0.1650, 0.1164, 0.1786, 0.1399,
        0.1069])
[rfa agg] iter:  3, prev_obj_val: 72.67374420166016, obj_val: 70.23388671875, abs dis: 2.4398574829101562
[rfa agg] iter: 3, weight: tensor([0.1639, 0.0059, 0.0497, 0.0379, 0.0456, 0.1851, 0.1023, 0.1664, 0.1172,
        0.1258])
[rfa agg] iter:  4, prev_obj_val: 70.23388671875, obj_val: 70.22964477539062, abs dis: 0.004241943359375
[rfa agg] iter: 4, weight: tensor([0.1569, 0.0055, 0.0509, 0.0380, 0.0463, 0.1755, 0.1084, 0.1807, 0.1288,
        0.1089])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.8378, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 7.2127, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.46871757507324 sec.
Server Epoch:39 choose agents : [45, 63, 78, 36, 55, 93, 46, 8, 18, 28].
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   1, Avg loss: 0.0731, Accuracy: 143/669 (21.3752%)
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   2, Avg loss: 0.0400, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7036, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 232/888 (26.1261%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.0207, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   1, Avg loss: 0.0887, Accuracy: 30/416 (7.2115%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   2, Avg loss: 0.0521, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.3075, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   1, Avg loss: 0.1022, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   2, Avg loss: 0.0612, Accuracy: 141/408 (34.5588%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3686, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   1, Avg loss: 0.0626, Accuracy: 203/1071 (18.9542%)
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 501/1071 (46.7787%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.3806, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   1, Avg loss: 0.0622, Accuracy: 358/1742 (20.5511%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   2, Avg loss: 0.0335, Accuracy: 655/1742 (37.6005%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4355, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0580, Accuracy: 391/1904 (20.5357%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 704/1904 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4108, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 218/1513 (14.4085%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 415/1513 (27.4289%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.6493, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   1, Avg loss: 0.1014, Accuracy: 43/530 (8.1132%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   2, Avg loss: 0.0495, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.1222, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   1, Avg loss: 0.0644, Accuracy: 353/1581 (22.3276%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 520/1581 (32.8906%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3725, Accuracy: 85/10000 (0.8500%)
time spent on training: 191.1768672466278
[rfa agg] training data poison_ratio: 0.09988808058198097  data num: [669, 888, 416, 408, 1071, 1742, 1904, 1513, 530, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.03121502518186905
[rfa agg] init. name: [45, 63, 78, 36, 55, 93, 46, 8, 18, 28], weight: tensor([0.0624, 0.0828, 0.0388, 0.0381, 0.0999, 0.1625, 0.1776, 0.1411, 0.0494,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 70.51109313964844, obj_val: 70.41454315185547, abs dis: 0.09654998779296875
[rfa agg] iter: 0, weight: tensor([0.0496, 0.1010, 0.0207, 0.0203, 0.2401, 0.1139, 0.1031, 0.1677, 0.0315,
        0.1522])
[rfa agg] iter:  1, prev_obj_val: 70.41454315185547, obj_val: 71.59656524658203, abs dis: 1.1820220947265625
[rfa agg] iter: 1, weight: tensor([0.0487, 0.0995, 0.0203, 0.0199, 0.2534, 0.1113, 0.1009, 0.1655, 0.0309,
        0.1496])
[rfa agg] iter:  2, prev_obj_val: 71.59656524658203, obj_val: 74.1906509399414, abs dis: 2.594085693359375
[rfa agg] iter: 2, weight: tensor([0.0503, 0.1058, 0.0205, 0.0201, 0.2917, 0.1028, 0.0940, 0.1482, 0.0315,
        0.1350])
[rfa agg] iter:  3, prev_obj_val: 74.1906509399414, obj_val: 75.6454086303711, abs dis: 1.4547576904296875
[rfa agg] iter: 3, weight: tensor([0.0521, 0.1180, 0.0203, 0.0199, 0.3723, 0.0847, 0.0785, 0.1156, 0.0317,
        0.1070])
[rfa agg] iter:  4, prev_obj_val: 75.6454086303711, obj_val: 75.63316345214844, abs dis: 0.01224517822265625
[rfa agg] iter: 4, weight: tensor([0.0521, 0.1230, 0.0197, 0.0193, 0.4170, 0.0750, 0.0700, 0.0998, 0.0311,
        0.0931])
[rfa agg] iter:  5, prev_obj_val: 75.63316345214844, obj_val: 75.63126373291016, abs dis: 0.00189971923828125
[rfa agg] iter: 5, weight: tensor([0.0504, 0.1190, 0.0190, 0.0187, 0.4363, 0.0725, 0.0677, 0.0963, 0.0301,
        0.0900])
[rfa agg] iter:  6, prev_obj_val: 75.63126373291016, obj_val: 75.63089752197266, abs dis: 0.0003662109375
[rfa agg] iter: 6, weight: tensor([0.0496, 0.1170, 0.0188, 0.0184, 0.4449, 0.0714, 0.0667, 0.0949, 0.0297,
        0.0887])
[rfa agg] iter:  7, prev_obj_val: 75.63089752197266, obj_val: 77.3321533203125, abs dis: 1.7012557983398438
[rfa agg] iter: 7, weight: tensor([0.0493, 0.1161, 0.0186, 0.0183, 0.4488, 0.0709, 0.0663, 0.0943, 0.0294,
        0.0881])
[rfa agg] iter:  8, prev_obj_val: 77.3321533203125, obj_val: 79.20603942871094, abs dis: 1.8738861083984375
[rfa agg] iter: 8, weight: tensor([0.0550, 0.1355, 0.0202, 0.0198, 0.4240, 0.0702, 0.0659, 0.0914, 0.0322,
        0.0858])
[rfa agg] iter:  9, prev_obj_val: 79.20603942871094, obj_val: 77.333984375, abs dis: 1.8720550537109375
[rfa agg] iter: 9, weight: tensor([0.0647, 0.1687, 0.0229, 0.0224, 0.3624, 0.0726, 0.0686, 0.0928, 0.0371,
        0.0877])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 17.3621, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 30.4565, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.487993478775 sec.
Server Epoch:40 choose agents : [63, 47, 34, 98, 70, 76, 77, 11, 84, 87].
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0519, Accuracy: 236/888 (26.5766%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0270, Accuracy: 439/888 (49.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.1262, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1341, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1144, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3445, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   1, Avg loss: 0.0626, Accuracy: 330/1427 (23.1254%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 540/1427 (37.8416%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4223, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   1, Avg loss: 0.0950, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   2, Avg loss: 0.0549, Accuracy: 117/373 (31.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2014, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0605, Accuracy: 309/1418 (21.7913%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 565/1418 (39.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6761, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   1, Avg loss: 0.0800, Accuracy: 29/466 (6.2232%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 177/466 (37.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.7423, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   1, Avg loss: 0.0473, Accuracy: 333/1340 (24.8507%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 552/1340 (41.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.6767, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   1, Avg loss: 0.0628, Accuracy: 209/712 (29.3539%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   2, Avg loss: 0.0281, Accuracy: 447/712 (62.7809%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.6751, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0579, Accuracy: 304/1190 (25.5462%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 433/1190 (36.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6332, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 277/1131 (24.4916%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   2, Avg loss: 0.0325, Accuracy: 406/1131 (35.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.1814, Accuracy: 61/10000 (0.6100%)
time spent on training: 158.65664744377136
[rfa agg] training data poison_ratio: 0.0  data num: [888, 134, 1427, 373, 1418, 466, 1340, 712, 1190, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 47, 34, 98, 70, 76, 77, 11, 84, 87], weight: tensor([0.0978, 0.0148, 0.1572, 0.0411, 0.1562, 0.0513, 0.1476, 0.0784, 0.1311,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 52.014060974121094, obj_val: 53.78525924682617, abs dis: 1.7711982727050781
[rfa agg] iter: 0, weight: tensor([0.2087, 0.0052, 0.0958, 0.0198, 0.0949, 0.0312, 0.1181, 0.0953, 0.1472,
        0.1838])
[rfa agg] iter:  1, prev_obj_val: 53.78525924682617, obj_val: 51.926971435546875, abs dis: 1.8582878112792969
[rfa agg] iter: 1, weight: tensor([0.2566, 0.0053, 0.0883, 0.0204, 0.0875, 0.0326, 0.1076, 0.1055, 0.1319,
        0.1644])
[rfa agg] iter:  2, prev_obj_val: 51.926971435546875, obj_val: 51.91975402832031, abs dis: 0.0072174072265625
[rfa agg] iter: 2, weight: tensor([0.2233, 0.0051, 0.0933, 0.0193, 0.0923, 0.0305, 0.1152, 0.0935, 0.1437,
        0.1838])
[rfa agg] iter:  3, prev_obj_val: 51.91975402832031, obj_val: 51.919673919677734, abs dis: 8.0108642578125e-05
[rfa agg] iter: 3, weight: tensor([0.2190, 0.0051, 0.0936, 0.0194, 0.0927, 0.0306, 0.1158, 0.0935, 0.1447,
        0.1858])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 22.5659, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 40.7098, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 315.30432081222534 sec.
Server Epoch:41 choose agents : [59, 2, 68, 89, 47, 69, 90, 26, 96, 40].
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   1, Avg loss: 0.0550, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   2, Avg loss: 0.0302, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9484, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0755, Accuracy: 106/605 (17.5207%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0420, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5226, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   1, Avg loss: 0.0686, Accuracy: 296/1163 (25.4514%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   2, Avg loss: 0.0396, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4784, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0651, Accuracy: 262/896 (29.2411%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0369, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9651, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   1, Avg loss: 0.1355, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   2, Avg loss: 0.1142, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4911, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   1, Avg loss: 0.0617, Accuracy: 220/590 (37.2881%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   2, Avg loss: 0.0335, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 14.3080, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0525, Accuracy: 281/677 (41.5066%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.1268, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   1, Avg loss: 0.0598, Accuracy: 245/1446 (16.9433%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   2, Avg loss: 0.0356, Accuracy: 478/1446 (33.0567%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3626, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0962, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0645, Accuracy: 99/311 (31.8328%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0601, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   1, Avg loss: 0.0642, Accuracy: 260/1573 (16.5289%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   2, Avg loss: 0.0370, Accuracy: 555/1573 (35.2829%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5144, Accuracy: 75/10000 (0.7500%)
time spent on training: 165.02511310577393
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 605, 1163, 896, 134, 590, 677, 1446, 311, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 2, 68, 89, 47, 69, 90, 26, 96, 40], weight: tensor([0.1284, 0.0713, 0.1371, 0.1056, 0.0158, 0.0695, 0.0798, 0.1704, 0.0367,
        0.1854])
[rfa agg] iter:  0, prev_obj_val: 57.299232482910156, obj_val: 59.63744354248047, abs dis: 2.3382110595703125
[rfa agg] iter: 0, weight: tensor([0.1437, 0.0673, 0.1519, 0.2653, 0.0060, 0.0654, 0.0904, 0.1020, 0.0173,
        0.0907])
[rfa agg] iter:  1, prev_obj_val: 59.63744354248047, obj_val: 61.157554626464844, abs dis: 1.520111083984375
[rfa agg] iter: 1, weight: tensor([0.1139, 0.0744, 0.1160, 0.3383, 0.0059, 0.0725, 0.1034, 0.0830, 0.0173,
        0.0753])
[rfa agg] iter:  2, prev_obj_val: 61.157554626464844, obj_val: 64.87992095947266, abs dis: 3.7223663330078125
[rfa agg] iter: 2, weight: tensor([0.1019, 0.0814, 0.1038, 0.3468, 0.0060, 0.0795, 0.1156, 0.0769, 0.0178,
        0.0704])
[rfa agg] iter:  3, prev_obj_val: 64.87992095947266, obj_val: 62.92749786376953, abs dis: 1.952423095703125
[rfa agg] iter: 3, weight: tensor([0.0937, 0.1114, 0.0947, 0.2565, 0.0069, 0.1092, 0.1635, 0.0742, 0.0210,
        0.0688])
[rfa agg] iter:  4, prev_obj_val: 62.92749786376953, obj_val: 64.84061431884766, abs dis: 1.913116455078125
[rfa agg] iter: 4, weight: tensor([0.0988, 0.0983, 0.1006, 0.2869, 0.0066, 0.0959, 0.1457, 0.0768, 0.0198,
        0.0708])
[rfa agg] iter:  5, prev_obj_val: 64.84061431884766, obj_val: 64.829833984375, abs dis: 0.01078033447265625
[rfa agg] iter: 5, weight: tensor([0.0937, 0.1131, 0.0948, 0.2478, 0.0069, 0.1105, 0.1690, 0.0743, 0.0211,
        0.0689])
[rfa agg] iter:  6, prev_obj_val: 64.829833984375, obj_val: 64.82963562011719, abs dis: 0.0001983642578125
[rfa agg] iter: 6, weight: tensor([0.0935, 0.1142, 0.0947, 0.2419, 0.0069, 0.1114, 0.1731, 0.0742, 0.0212,
        0.0689])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 46.9709, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 84.0163, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 322.02633929252625 sec.
Server Epoch:42 choose agents : [80, 48, 22, 54, 17, 4, 46, 71, 64, 34].
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   1, Avg loss: 0.0720, Accuracy: 94/682 (13.7830%)
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   2, Avg loss: 0.0400, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.6344, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   1, Avg loss: 0.0817, Accuracy: 57/631 (9.0333%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   2, Avg loss: 0.0454, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9264, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   1, Avg loss: 0.0548, Accuracy: 397/1470 (27.0068%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 833/1470 (56.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.8632, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   1, Avg loss: 0.0570, Accuracy: 306/1130 (27.0796%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 453/1130 (40.0885%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.7210, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   1, Avg loss: 0.0526, Accuracy: 321/1574 (20.3939%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 550/1574 (34.9428%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3168, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0698, Accuracy: 286/901 (31.7425%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 387/901 (42.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.1921, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   1, Avg loss: 0.0569, Accuracy: 372/1904 (19.5378%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 684/1904 (35.9244%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3364, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   1, Avg loss: 0.0611, Accuracy: 142/818 (17.3594%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 359/818 (43.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.8820, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 167/953 (17.5236%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0652, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0613, Accuracy: 336/1427 (23.5459%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0356, Accuracy: 548/1427 (38.4022%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3887, Accuracy: 67/10000 (0.6700%)
time spent on training: 181.166006565094
[rfa agg] training data poison_ratio: 0.0  data num: [682, 631, 1470, 1130, 1574, 901, 1904, 818, 953, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 48, 22, 54, 17, 4, 46, 71, 64, 34], weight: tensor([0.0594, 0.0549, 0.1279, 0.0983, 0.1370, 0.0784, 0.1657, 0.0712, 0.0829,
        0.1242])
[rfa agg] iter:  0, prev_obj_val: 58.45381164550781, obj_val: 66.18590545654297, abs dis: 7.732093811035156
[rfa agg] iter: 0, weight: tensor([0.0431, 0.0350, 0.1067, 0.2419, 0.0862, 0.1180, 0.0639, 0.0722, 0.1283,
        0.1049])
[rfa agg] iter:  1, prev_obj_val: 66.18590545654297, obj_val: 66.06204223632812, abs dis: 0.12386322021484375
[rfa agg] iter: 1, weight: tensor([0.0624, 0.0477, 0.0712, 0.1333, 0.0615, 0.1816, 0.0501, 0.1247, 0.1977,
        0.0697])
[rfa agg] iter:  2, prev_obj_val: 66.06204223632812, obj_val: 68.25869750976562, abs dis: 2.1966552734375
[rfa agg] iter: 2, weight: tensor([0.0606, 0.0463, 0.0686, 0.1245, 0.0594, 0.1908, 0.0484, 0.1226, 0.2117,
        0.0672])
[rfa agg] iter:  3, prev_obj_val: 68.25869750976562, obj_val: 73.36280059814453, abs dis: 5.104103088378906
[rfa agg] iter: 3, weight: tensor([0.0679, 0.0510, 0.0651, 0.1110, 0.0570, 0.1867, 0.0471, 0.1426, 0.2078,
        0.0637])
[rfa agg] iter:  4, prev_obj_val: 73.36280059814453, obj_val: 70.69454956054688, abs dis: 2.6682510375976562
[rfa agg] iter: 4, weight: tensor([0.0916, 0.0663, 0.0615, 0.0947, 0.0548, 0.1561, 0.0465, 0.1976, 0.1707,
        0.0601])
[rfa agg] iter:  5, prev_obj_val: 70.69454956054688, obj_val: 73.34104919433594, abs dis: 2.6464996337890625
[rfa agg] iter: 5, weight: tensor([0.0792, 0.0580, 0.0630, 0.1019, 0.0557, 0.1678, 0.0467, 0.1818, 0.1843,
        0.0616])
[rfa agg] iter:  6, prev_obj_val: 73.34104919433594, obj_val: 70.6966781616211, abs dis: 2.6443710327148438
[rfa agg] iter: 6, weight: tensor([0.0918, 0.0661, 0.0611, 0.0942, 0.0545, 0.1530, 0.0462, 0.2067, 0.1668,
        0.0597])
[rfa agg] iter:  7, prev_obj_val: 70.6966781616211, obj_val: 73.34060668945312, abs dis: 2.6439285278320312
[rfa agg] iter: 7, weight: tensor([0.0792, 0.0580, 0.0630, 0.1019, 0.0557, 0.1672, 0.0467, 0.1833, 0.1835,
        0.0616])
[rfa agg] iter:  8, prev_obj_val: 73.34060668945312, obj_val: 73.3348388671875, abs dis: 0.005767822265625
[rfa agg] iter: 8, weight: tensor([0.0918, 0.0660, 0.0611, 0.0942, 0.0545, 0.1529, 0.0462, 0.2071, 0.1666,
        0.0597])
[rfa agg] iter:  9, prev_obj_val: 73.3348388671875, obj_val: 73.3346176147461, abs dis: 0.00022125244140625
[rfa agg] iter: 9, weight: tensor([0.0920, 0.0659, 0.0608, 0.0938, 0.0542, 0.1506, 0.0460, 0.2134, 0.1639,
        0.0594])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 51.6379, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 94.2514, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 339.6645212173462 sec.
Server Epoch:43 choose agents : [48, 64, 0, 16, 40, 36, 32, 96, 83, 81].
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   1, Avg loss: 0.0815, Accuracy: 51/631 (8.0824%)
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   2, Avg loss: 0.0456, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.6019, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 150/953 (15.7398%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   2, Avg loss: 0.0391, Accuracy: 284/953 (29.8006%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9735, Accuracy: 48/10000 (0.4800%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   1, Avg loss: 0.0651, Accuracy: 301/1657 (18.1654%)
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   2, Avg loss: 0.0369, Accuracy: 457/1657 (27.5800%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9790, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   1, Avg loss: 0.0694, Accuracy: 167/708 (23.5876%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   2, Avg loss: 0.0392, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.3339, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0641, Accuracy: 276/1573 (17.5461%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0378, Accuracy: 548/1573 (34.8379%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3051, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   1, Avg loss: 0.0965, Accuracy: 10/408 (2.4510%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   2, Avg loss: 0.0566, Accuracy: 149/408 (36.5196%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   1, Avg loss: 0.0699, Accuracy: 153/735 (20.8163%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   2, Avg loss: 0.0246, Accuracy: 342/735 (46.5306%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 12.8822, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   1, Avg loss: 0.0942, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   2, Avg loss: 0.0649, Accuracy: 107/311 (34.4051%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.0059, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   1, Avg loss: 0.0646, Accuracy: 305/1953 (15.6170%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   2, Avg loss: 0.0356, Accuracy: 689/1953 (35.2791%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1602, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   1, Avg loss: 0.0783, Accuracy: 138/774 (17.8295%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   2, Avg loss: 0.0412, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.6720, Accuracy: 69/10000 (0.6900%)
time spent on training: 180.38266110420227
[rfa agg] training data poison_ratio: 0.17077192620838916  data num: [631, 953, 1657, 708, 1573, 408, 735, 311, 1953, 774]
[rfa agg] considering poison per batch poison_fraction: 0.05336622694012161
[rfa agg] init. name: [48, 64, 0, 16, 40, 36, 32, 96, 83, 81], weight: tensor([0.0650, 0.0982, 0.1708, 0.0730, 0.1621, 0.0420, 0.0757, 0.0321, 0.2013,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 76.01400756835938, obj_val: 76.82422637939453, abs dis: 0.8102188110351562
[rfa agg] iter: 0, weight: tensor([0.0597, 0.2144, 0.1375, 0.0873, 0.1457, 0.0277, 0.0927, 0.0175, 0.1042,
        0.1133])
[rfa agg] iter:  1, prev_obj_val: 76.82422637939453, obj_val: 78.03023529052734, abs dis: 1.2060089111328125
[rfa agg] iter: 1, weight: tensor([0.0611, 0.2671, 0.1102, 0.0921, 0.1159, 0.0272, 0.0995, 0.0169, 0.0864,
        0.1236])
[rfa agg] iter:  2, prev_obj_val: 78.03023529052734, obj_val: 79.8859634399414, abs dis: 1.8557281494140625
[rfa agg] iter: 2, weight: tensor([0.0617, 0.3127, 0.0865, 0.0963, 0.0901, 0.0261, 0.1068, 0.0159, 0.0700,
        0.1337])
[rfa agg] iter:  3, prev_obj_val: 79.8859634399414, obj_val: 82.58755493164062, abs dis: 2.7015914916992188
[rfa agg] iter: 3, weight: tensor([0.0668, 0.3007, 0.0715, 0.1076, 0.0740, 0.0265, 0.1251, 0.0157, 0.0594,
        0.1527])
[rfa agg] iter:  4, prev_obj_val: 82.58755493164062, obj_val: 84.20258331298828, abs dis: 1.6150283813476562
[rfa agg] iter: 4, weight: tensor([0.0798, 0.2163, 0.0637, 0.1305, 0.0654, 0.0292, 0.1645, 0.0168, 0.0541,
        0.1798])
[rfa agg] iter:  5, prev_obj_val: 84.20258331298828, obj_val: 84.18965911865234, abs dis: 0.0129241943359375
[rfa agg] iter: 5, weight: tensor([0.0873, 0.1706, 0.0593, 0.1441, 0.0607, 0.0304, 0.1914, 0.0171, 0.0509,
        0.1883])
[rfa agg] iter:  6, prev_obj_val: 84.18965911865234, obj_val: 86.10111236572266, abs dis: 1.9114532470703125
[rfa agg] iter: 6, weight: tensor([0.0869, 0.1656, 0.0590, 0.1458, 0.0604, 0.0302, 0.1940, 0.0170, 0.0506,
        0.1906])
[rfa agg] iter:  7, prev_obj_val: 86.10111236572266, obj_val: 90.807861328125, abs dis: 4.706748962402344
[rfa agg] iter: 7, weight: tensor([0.0969, 0.1413, 0.0555, 0.1543, 0.0567, 0.0319, 0.2169, 0.0176, 0.0481,
        0.1808])
[rfa agg] iter:  8, prev_obj_val: 90.807861328125, obj_val: 93.56775665283203, abs dis: 2.7598953247070312
[rfa agg] iter: 8, weight: tensor([0.1341, 0.1135, 0.0533, 0.1603, 0.0541, 0.0388, 0.2285, 0.0204, 0.0470,
        0.1500])
[rfa agg] iter:  9, prev_obj_val: 93.56775665283203, obj_val: 90.79906463623047, abs dis: 2.7686920166015625
[rfa agg] iter: 9, weight: tensor([0.1675, 0.1063, 0.0539, 0.1561, 0.0546, 0.0448, 0.2106, 0.0228, 0.0479,
        0.1355])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8688, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.8793, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.22105860710144 sec.
Server Epoch:44 choose agents : [20, 4, 97, 32, 42, 33, 22, 30, 56, 0].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0698, Accuracy: 221/807 (27.3854%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0361, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3521, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0638, Accuracy: 274/901 (30.4107%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0341, Accuracy: 415/901 (46.0599%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.8322, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   1, Avg loss: 0.0673, Accuracy: 300/1213 (24.7321%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   2, Avg loss: 0.0308, Accuracy: 418/1213 (34.4600%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.4428, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0659, Accuracy: 156/735 (21.2245%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 12.3994, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   1, Avg loss: 0.0629, Accuracy: 258/1372 (18.8047%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   2, Avg loss: 0.0348, Accuracy: 451/1372 (32.8717%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.7780, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   1, Avg loss: 0.1008, Accuracy: 1/515 (0.1942%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   2, Avg loss: 0.0588, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2917, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   1, Avg loss: 0.0542, Accuracy: 429/1470 (29.1837%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 780/1470 (53.0612%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.2722, Accuracy: 102/10000 (1.0200%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   1, Avg loss: 0.0828, Accuracy: 37/486 (7.6132%)
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.5087, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0874, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0707, Accuracy: 36/186 (19.3548%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.8827, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   1, Avg loss: 0.0645, Accuracy: 288/1657 (17.3808%)
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   2, Avg loss: 0.0366, Accuracy: 471/1657 (28.4249%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.5964, Accuracy: 69/10000 (0.6900%)
time spent on training: 201.97033524513245
[rfa agg] training data poison_ratio: 0.3157782059516164  data num: [807, 901, 1213, 735, 1372, 515, 1470, 486, 186, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.09868068935988011
[rfa agg] init. name: [20, 4, 97, 32, 42, 33, 22, 30, 56, 0], weight: tensor([0.0864, 0.0964, 0.1298, 0.0787, 0.1469, 0.0551, 0.1574, 0.0520, 0.0199,
        0.1774])
[rfa agg] iter:  0, prev_obj_val: 58.53443908691406, obj_val: 61.35023498535156, abs dis: 2.8157958984375
[rfa agg] iter: 0, weight: tensor([0.1371, 0.2162, 0.1621, 0.1022, 0.1104, 0.0411, 0.1037, 0.0345, 0.0076,
        0.0852])
[rfa agg] iter:  1, prev_obj_val: 61.35023498535156, obj_val: 65.033203125, abs dis: 3.6829681396484375
[rfa agg] iter: 1, weight: tensor([0.1710, 0.2316, 0.1282, 0.1250, 0.0920, 0.0451, 0.0876, 0.0375, 0.0078,
        0.0742])
[rfa agg] iter:  2, prev_obj_val: 65.033203125, obj_val: 67.14047241210938, abs dis: 2.107269287109375
[rfa agg] iter: 2, weight: tensor([0.2123, 0.1897, 0.1058, 0.1637, 0.0804, 0.0521, 0.0775, 0.0429, 0.0082,
        0.0673])
[rfa agg] iter:  3, prev_obj_val: 67.14047241210938, obj_val: 67.12849426269531, abs dis: 0.0119781494140625
[rfa agg] iter: 3, weight: tensor([0.2300, 0.1598, 0.0963, 0.1916, 0.0750, 0.0563, 0.0727, 0.0461, 0.0085,
        0.0637])
[rfa agg] iter:  4, prev_obj_val: 67.12849426269531, obj_val: 65.00588989257812, abs dis: 2.1226043701171875
[rfa agg] iter: 4, weight: tensor([0.2345, 0.1552, 0.0954, 0.1953, 0.0743, 0.0560, 0.0720, 0.0458, 0.0084,
        0.0631])
[rfa agg] iter:  5, prev_obj_val: 65.00588989257812, obj_val: 67.13331604003906, abs dis: 2.1274261474609375
[rfa agg] iter: 5, weight: tensor([0.2284, 0.1746, 0.1037, 0.1700, 0.0790, 0.0515, 0.0761, 0.0424, 0.0081,
        0.0661])
[rfa agg] iter:  6, prev_obj_val: 67.13331604003906, obj_val: 65.00480651855469, abs dis: 2.128509521484375
[rfa agg] iter: 6, weight: tensor([0.2342, 0.1573, 0.0959, 0.1918, 0.0746, 0.0561, 0.0723, 0.0459, 0.0084,
        0.0634])
[rfa agg] iter:  7, prev_obj_val: 65.00480651855469, obj_val: 67.13345336914062, abs dis: 2.1286468505859375
[rfa agg] iter: 7, weight: tensor([0.2284, 0.1749, 0.1037, 0.1696, 0.0790, 0.0516, 0.0762, 0.0424, 0.0081,
        0.0661])
[rfa agg] iter:  8, prev_obj_val: 67.13345336914062, obj_val: 65.00479125976562, abs dis: 2.128662109375
[rfa agg] iter: 8, weight: tensor([0.2342, 0.1574, 0.0959, 0.1918, 0.0746, 0.0561, 0.0723, 0.0459, 0.0084,
        0.0634])
[rfa agg] iter:  9, prev_obj_val: 65.00479125976562, obj_val: 67.13346099853516, abs dis: 2.1286697387695312
[rfa agg] iter: 9, weight: tensor([0.2284, 0.1750, 0.1037, 0.1696, 0.0790, 0.0516, 0.0762, 0.0424, 0.0081,
        0.0661])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8447, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.4759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.43883442878723 sec.
Server Epoch:45 choose agents : [4, 16, 34, 68, 62, 38, 61, 31, 86, 28].
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 283/901 (31.4095%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 417/901 (46.2819%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.3347, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   1, Avg loss: 0.0691, Accuracy: 193/708 (27.2599%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5099, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   1, Avg loss: 0.0648, Accuracy: 313/1427 (21.9341%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   2, Avg loss: 0.0349, Accuracy: 550/1427 (38.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.0073, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0681, Accuracy: 278/1163 (23.9037%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0384, Accuracy: 406/1163 (34.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1266, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0706, Accuracy: 102/568 (17.9577%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0419, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9568, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0650, Accuracy: 226/1131 (19.9823%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 467/1131 (41.2909%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.0048, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1373, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1267, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.8006, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   1, Avg loss: 0.0876, Accuracy: 40/460 (8.6957%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   2, Avg loss: 0.0414, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.5944, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0568, Accuracy: 334/1003 (33.3001%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 396/1003 (39.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2578, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0663, Accuracy: 333/1581 (21.0626%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0359, Accuracy: 561/1581 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1711, Accuracy: 90/10000 (0.9000%)
time spent on training: 180.49300503730774
[rfa agg] training data poison_ratio: 0.0  data num: [901, 708, 1427, 1163, 568, 1131, 85, 460, 1003, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 16, 34, 68, 62, 38, 61, 31, 86, 28], weight: tensor([0.0998, 0.0784, 0.1581, 0.1288, 0.0629, 0.1253, 0.0094, 0.0510, 0.1111,
        0.1751])
[rfa agg] iter:  0, prev_obj_val: 52.34253692626953, obj_val: 54.054656982421875, abs dis: 1.7121200561523438
[rfa agg] iter: 0, weight: tensor([0.2077, 0.0950, 0.0832, 0.1233, 0.0441, 0.1445, 0.0028, 0.0305, 0.1944,
        0.0744])
[rfa agg] iter:  1, prev_obj_val: 54.054656982421875, obj_val: 58.51879119873047, abs dis: 4.464134216308594
[rfa agg] iter: 1, weight: tensor([0.2274, 0.1074, 0.0787, 0.1134, 0.0480, 0.1312, 0.0029, 0.0328, 0.1870,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 58.51879119873047, obj_val: 56.18739700317383, abs dis: 2.3313941955566406
[rfa agg] iter: 2, weight: tensor([0.2044, 0.1518, 0.0778, 0.1050, 0.0629, 0.1189, 0.0034, 0.0417, 0.1624,
        0.0715])
[rfa agg] iter:  3, prev_obj_val: 56.18739700317383, obj_val: 56.18328094482422, abs dis: 0.004116058349609375
[rfa agg] iter: 3, weight: tensor([0.2179, 0.1320, 0.0782, 0.1088, 0.0550, 0.1242, 0.0032, 0.0370, 0.1724,
        0.0713])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.8261, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.6936, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.60757660865784 sec.
Server Epoch:46 choose agents : [2, 0, 60, 15, 30, 66, 81, 95, 58, 17].
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0803, Accuracy: 85/605 (14.0496%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0451, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.9647, Accuracy: 54/10000 (0.5400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   1, Avg loss: 0.0628, Accuracy: 303/1657 (18.2861%)
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   2, Avg loss: 0.0364, Accuracy: 465/1657 (28.0628%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.6252, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   1, Avg loss: 0.0553, Accuracy: 499/2227 (22.4068%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 942/2227 (42.2991%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.8118, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0619, Accuracy: 295/1154 (25.5633%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 400/1154 (34.6620%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.0668, Accuracy: 75/10000 (0.7500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0864, Accuracy: 28/486 (5.7613%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0434, Accuracy: 224/486 (46.0905%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.0778, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   1, Avg loss: 0.0684, Accuracy: 177/1402 (12.6248%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 329/1402 (23.4665%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2830, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   1, Avg loss: 0.0843, Accuracy: 108/774 (13.9535%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   2, Avg loss: 0.0386, Accuracy: 351/774 (45.3488%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7750, Accuracy: 72/10000 (0.7200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0539, Accuracy: 267/599 (44.5743%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 13.4829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   1, Avg loss: 0.0655, Accuracy: 269/803 (33.4994%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 420/803 (52.3039%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8315, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 342/1574 (21.7281%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 573/1574 (36.4041%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.8487, Accuracy: 91/10000 (0.9100%)
time spent on training: 219.9842495918274
[rfa agg] training data poison_ratio: 0.24306355819519546  data num: [605, 1657, 2227, 1154, 486, 1402, 774, 599, 803, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.07595736193599859
[rfa agg] init. name: [2, 0, 60, 15, 30, 66, 81, 95, 58, 17], weight: tensor([0.0536, 0.1469, 0.1974, 0.1023, 0.0431, 0.1243, 0.0686, 0.0531, 0.0712,
        0.1395])
[rfa agg] iter:  0, prev_obj_val: 74.72213745117188, obj_val: 78.82720184326172, abs dis: 4.105064392089844
[rfa agg] iter: 0, weight: tensor([0.0371, 0.1276, 0.0780, 0.2033, 0.0246, 0.2120, 0.0683, 0.0368, 0.0728,
        0.1395])
[rfa agg] iter:  1, prev_obj_val: 78.82720184326172, obj_val: 80.45563507080078, abs dis: 1.6284332275390625
[rfa agg] iter: 1, weight: tensor([0.0458, 0.1118, 0.0746, 0.2152, 0.0296, 0.1692, 0.0900, 0.0456, 0.0984,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 80.45563507080078, obj_val: 83.95021057128906, abs dis: 3.4945755004882812
[rfa agg] iter: 2, weight: tensor([0.0497, 0.1078, 0.0739, 0.2042, 0.0318, 0.1564, 0.1007, 0.0496, 0.1112,
        0.1147])
[rfa agg] iter:  3, prev_obj_val: 83.95021057128906, obj_val: 82.16443634033203, abs dis: 1.7857742309570312
[rfa agg] iter: 3, weight: tensor([0.0578, 0.0990, 0.0710, 0.1721, 0.0360, 0.1352, 0.1247, 0.0578, 0.1422,
        0.1042])
[rfa agg] iter:  4, prev_obj_val: 82.16443634033203, obj_val: 80.45707702636719, abs dis: 1.7073593139648438
[rfa agg] iter: 4, weight: tensor([0.0541, 0.1040, 0.0729, 0.1834, 0.0341, 0.1455, 0.1143, 0.0540, 0.1277,
        0.1099])
[rfa agg] iter:  5, prev_obj_val: 80.45707702636719, obj_val: 82.16458129882812, abs dis: 1.7075042724609375
[rfa agg] iter: 5, weight: tensor([0.0501, 0.1083, 0.0741, 0.1991, 0.0320, 0.1565, 0.1022, 0.0499, 0.1127,
        0.1151])
[rfa agg] iter:  6, prev_obj_val: 82.16458129882812, obj_val: 78.82682800292969, abs dis: 3.3377532958984375
[rfa agg] iter: 6, weight: tensor([0.0539, 0.1038, 0.0728, 0.1871, 0.0340, 0.1457, 0.1128, 0.0538, 0.1263,
        0.1098])
[rfa agg] iter:  7, prev_obj_val: 78.82682800292969, obj_val: 80.45459747314453, abs dis: 1.6277694702148438
[rfa agg] iter: 7, weight: tensor([0.0462, 0.1122, 0.0749, 0.2117, 0.0298, 0.1676, 0.0916, 0.0460, 0.1000,
        0.1200])
[rfa agg] iter:  8, prev_obj_val: 80.45459747314453, obj_val: 83.94988250732422, abs dis: 3.4952850341796875
[rfa agg] iter: 8, weight: tensor([0.0497, 0.1079, 0.0739, 0.2037, 0.0318, 0.1564, 0.1008, 0.0496, 0.1114,
        0.1148])
[rfa agg] iter:  9, prev_obj_val: 83.94988250732422, obj_val: 82.16444396972656, abs dis: 1.7854385375976562
[rfa agg] iter: 9, weight: tensor([0.0578, 0.0990, 0.0710, 0.1721, 0.0360, 0.1352, 0.1247, 0.0578, 0.1423,
        0.1042])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8797, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.7406, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.92921328544617 sec.
Server Epoch:47 choose agents : [80, 74, 96, 95, 41, 53, 13, 18, 70, 82].
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0750, Accuracy: 66/682 (9.6774%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0399, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8726, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0471, Accuracy: 418/1552 (26.9330%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0235, Accuracy: 680/1552 (43.8144%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.8631, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   1, Avg loss: 0.0939, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   2, Avg loss: 0.0649, Accuracy: 103/311 (33.1190%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.3186, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 257/599 (42.9048%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0287, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 13.8354, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   1, Avg loss: 0.0702, Accuracy: 247/719 (34.3533%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   2, Avg loss: 0.0362, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3856, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   1, Avg loss: 0.0563, Accuracy: 202/813 (24.8462%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   2, Avg loss: 0.0209, Accuracy: 440/813 (54.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 13.4110, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0635, Accuracy: 257/1645 (15.6231%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0346, Accuracy: 567/1645 (34.4681%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.8339, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   1, Avg loss: 0.0999, Accuracy: 50/530 (9.4340%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   2, Avg loss: 0.0481, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9594, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   1, Avg loss: 0.0617, Accuracy: 301/1418 (21.2271%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 570/1418 (40.1975%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.6202, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0513, Accuracy: 200/500 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3566, Accuracy: 76/10000 (0.7600%)
time spent on training: 191.03791117668152
[rfa agg] training data poison_ratio: 0.24529592884023263  data num: [682, 1552, 311, 599, 719, 813, 1645, 530, 1418, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0766549777625727
[rfa agg] init. name: [80, 74, 96, 95, 41, 53, 13, 18, 70, 82], weight: tensor([0.0778, 0.1770, 0.0355, 0.0683, 0.0820, 0.0927, 0.1876, 0.0604, 0.1617,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 69.57943725585938, obj_val: 71.01679229736328, abs dis: 1.4373550415039062
[rfa agg] iter: 0, weight: tensor([0.1098, 0.1084, 0.0213, 0.0798, 0.1416, 0.2027, 0.1043, 0.0603, 0.1222,
        0.0495])
[rfa agg] iter:  1, prev_obj_val: 71.01679229736328, obj_val: 75.89787292480469, abs dis: 4.881080627441406
[rfa agg] iter: 1, weight: tensor([0.1256, 0.0753, 0.0197, 0.0860, 0.1720, 0.2542, 0.0731, 0.0622, 0.0826,
        0.0493])
[rfa agg] iter:  2, prev_obj_val: 75.89787292480469, obj_val: 82.47529602050781, abs dis: 6.577423095703125
[rfa agg] iter: 2, weight: tensor([0.1775, 0.0549, 0.0211, 0.1218, 0.1893, 0.1790, 0.0539, 0.0828, 0.0585,
        0.0614])
[rfa agg] iter:  3, prev_obj_val: 82.47529602050781, obj_val: 79.92688751220703, abs dis: 2.5484085083007812
[rfa agg] iter: 3, weight: tensor([0.1745, 0.0505, 0.0266, 0.1714, 0.1357, 0.1157, 0.0500, 0.1293, 0.0530,
        0.0932])
[rfa agg] iter:  4, prev_obj_val: 79.92688751220703, obj_val: 77.73298645019531, abs dis: 2.1939010620117188
[rfa agg] iter: 4, weight: tensor([0.1902, 0.0502, 0.0240, 0.1692, 0.1458, 0.1230, 0.0496, 0.1146, 0.0529,
        0.0804])
[rfa agg] iter:  5, prev_obj_val: 77.73298645019531, obj_val: 82.43092346191406, abs dis: 4.69793701171875
[rfa agg] iter: 5, weight: tensor([0.2003, 0.0516, 0.0222, 0.1489, 0.1662, 0.1393, 0.0508, 0.0967, 0.0546,
        0.0694])
[rfa agg] iter:  6, prev_obj_val: 82.43092346191406, obj_val: 82.40531158447266, abs dis: 0.02561187744140625
[rfa agg] iter: 6, weight: tensor([0.1770, 0.0499, 0.0264, 0.1754, 0.1327, 0.1128, 0.0494, 0.1307, 0.0523,
        0.0935])
[rfa agg] iter:  7, prev_obj_val: 82.40531158447266, obj_val: 82.40491485595703, abs dis: 0.000396728515625
[rfa agg] iter: 7, weight: tensor([0.1730, 0.0494, 0.0263, 0.1809, 0.1291, 0.1106, 0.0489, 0.1352, 0.0518,
        0.0947])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.8585, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5521, Accuracy: 0/9950 (0.0000%)
saving model
Done in 347.8710927963257 sec.
Server Epoch:48 choose agents : [55, 77, 34, 80, 27, 88, 59, 14, 45, 96].
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0599, Accuracy: 222/1071 (20.7283%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0311, Accuracy: 458/1071 (42.7638%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.1014, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   1, Avg loss: 0.0500, Accuracy: 318/1340 (23.7313%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6252, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   1, Avg loss: 0.0642, Accuracy: 321/1427 (22.4947%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   2, Avg loss: 0.0350, Accuracy: 582/1427 (40.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2515, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   1, Avg loss: 0.0727, Accuracy: 81/682 (11.8768%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4718, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0582, Accuracy: 370/1587 (23.3144%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0351, Accuracy: 562/1587 (35.4127%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3230, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0860, Accuracy: 66/603 (10.9453%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0482, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.3037, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   1, Avg loss: 0.0602, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 460/1089 (42.2406%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.2711, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   1, Avg loss: 0.0757, Accuracy: 113/1013 (11.1550%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 357/1013 (35.2419%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4629, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   1, Avg loss: 0.0769, Accuracy: 121/669 (18.0867%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   2, Avg loss: 0.0419, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0375, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0911, Accuracy: 4/311 (1.2862%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0623, Accuracy: 101/311 (32.4759%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.6322, Accuracy: 50/10000 (0.5000%)
time spent on training: 185.2935242652893
[rfa agg] training data poison_ratio: 0.109375  data num: [1071, 1340, 1427, 682, 1587, 603, 1089, 1013, 669, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0341796875
[rfa agg] init. name: [55, 77, 34, 80, 27, 88, 59, 14, 45, 96], weight: tensor([0.1094, 0.1368, 0.1457, 0.0696, 0.1621, 0.0616, 0.1112, 0.1035, 0.0683,
        0.0318])
[rfa agg] iter:  0, prev_obj_val: 52.060516357421875, obj_val: 55.05324172973633, abs dis: 2.992725372314453
[rfa agg] iter: 0, weight: tensor([0.2033, 0.1143, 0.0921, 0.0597, 0.0811, 0.0448, 0.1077, 0.2266, 0.0578,
        0.0126])
[rfa agg] iter:  1, prev_obj_val: 55.05324172973633, obj_val: 56.95225143432617, abs dis: 1.8990097045898438
[rfa agg] iter: 1, weight: tensor([0.1847, 0.1012, 0.0842, 0.0740, 0.0760, 0.0545, 0.1008, 0.2388, 0.0716,
        0.0143])
[rfa agg] iter:  2, prev_obj_val: 56.95225143432617, obj_val: 58.996360778808594, abs dis: 2.044109344482422
[rfa agg] iter: 2, weight: tensor([0.1703, 0.0988, 0.0835, 0.0865, 0.0760, 0.0627, 0.0996, 0.2233, 0.0835,
        0.0157])
[rfa agg] iter:  3, prev_obj_val: 58.996360778808594, obj_val: 56.9526252746582, abs dis: 2.0437355041503906
[rfa agg] iter: 3, weight: tensor([0.1572, 0.0966, 0.0825, 0.1017, 0.0759, 0.0723, 0.0981, 0.2008, 0.0977,
        0.0172])
[rfa agg] iter:  4, prev_obj_val: 56.9526252746582, obj_val: 61.167930603027344, abs dis: 4.215305328369141
[rfa agg] iter: 4, weight: tensor([0.1693, 0.0994, 0.0839, 0.0882, 0.0765, 0.0635, 0.0999, 0.2183, 0.0851,
        0.0158])
[rfa agg] iter:  5, prev_obj_val: 61.167930603027344, obj_val: 63.408042907714844, abs dis: 2.2401123046875
[rfa agg] iter: 5, weight: tensor([0.1447, 0.0933, 0.0805, 0.1180, 0.0746, 0.0825, 0.0952, 0.1799, 0.1127,
        0.0186])
[rfa agg] iter:  6, prev_obj_val: 63.408042907714844, obj_val: 61.150386810302734, abs dis: 2.2576560974121094
[rfa agg] iter: 6, weight: tensor([0.1307, 0.0885, 0.0771, 0.1387, 0.0721, 0.0941, 0.0903, 0.1574, 0.1313,
        0.0198])
[rfa agg] iter:  7, prev_obj_val: 61.150386810302734, obj_val: 63.404869079589844, abs dis: 2.2544822692871094
[rfa agg] iter: 7, weight: tensor([0.1427, 0.0930, 0.0803, 0.1221, 0.0745, 0.0836, 0.0943, 0.1743, 0.1165,
        0.0186])
[rfa agg] iter:  8, prev_obj_val: 63.404869079589844, obj_val: 61.150634765625, abs dis: 2.2542343139648438
[rfa agg] iter: 8, weight: tensor([0.1306, 0.0885, 0.0771, 0.1391, 0.0720, 0.0942, 0.0902, 0.1569, 0.1317,
        0.0197])
[rfa agg] iter:  9, prev_obj_val: 61.150634765625, obj_val: 63.40484619140625, abs dis: 2.25421142578125
[rfa agg] iter: 9, weight: tensor([0.1427, 0.0930, 0.0803, 0.1221, 0.0745, 0.0836, 0.0943, 0.1743, 0.1165,
        0.0186])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9552, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5828, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.91096568107605 sec.
Server Epoch:49 choose agents : [88, 4, 12, 21, 78, 65, 74, 41, 55, 2].
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   1, Avg loss: 0.0840, Accuracy: 75/603 (12.4378%)
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   2, Avg loss: 0.0495, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5189, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0625, Accuracy: 281/901 (31.1876%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0346, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.8285, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   1, Avg loss: 0.0953, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   2, Avg loss: 0.0539, Accuracy: 123/338 (36.3905%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.7534, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0607, Accuracy: 335/1949 (17.1883%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0342, Accuracy: 592/1949 (30.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8650, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   1, Avg loss: 0.0880, Accuracy: 25/416 (6.0096%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   2, Avg loss: 0.0512, Accuracy: 159/416 (38.2212%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3737, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 358/1475 (24.2712%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0336, Accuracy: 624/1475 (42.3051%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.0459, Accuracy: 68/10000 (0.6800%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   1, Avg loss: 0.0470, Accuracy: 413/1552 (26.6108%)
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 732/1552 (47.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.7070, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0666, Accuracy: 259/719 (36.0223%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0344, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4545, Accuracy: 61/10000 (0.6100%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   1, Avg loss: 0.0581, Accuracy: 219/1071 (20.4482%)
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.2046, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0780, Accuracy: 94/605 (15.5372%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0438, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6267, Accuracy: 58/10000 (0.5800%)
time spent on training: 213.54047441482544
[rfa agg] training data poison_ratio: 0.2724062727178316  data num: [603, 901, 338, 1949, 416, 1475, 1552, 719, 1071, 605]
[rfa agg] considering poison per batch poison_fraction: 0.08512696022432237
[rfa agg] init. name: [88, 4, 12, 21, 78, 65, 74, 41, 55, 2], weight: tensor([0.0626, 0.0936, 0.0351, 0.2024, 0.0432, 0.1532, 0.1612, 0.0747, 0.1112,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 72.20114135742188, obj_val: 75.6084976196289, abs dis: 3.4073562622070312
[rfa agg] iter: 0, weight: tensor([0.0489, 0.1612, 0.0180, 0.0890, 0.0242, 0.1296, 0.1237, 0.0758, 0.2807,
        0.0489])
[rfa agg] iter:  1, prev_obj_val: 75.6084976196289, obj_val: 76.92013549804688, abs dis: 1.3116378784179688
[rfa agg] iter: 1, weight: tensor([0.0593, 0.2220, 0.0196, 0.0710, 0.0270, 0.0942, 0.0911, 0.0996, 0.2570,
        0.0591])
[rfa agg] iter:  2, prev_obj_val: 76.92013549804688, obj_val: 76.90660095214844, abs dis: 0.0135345458984375
[rfa agg] iter: 2, weight: tensor([0.0644, 0.2462, 0.0206, 0.0685, 0.0285, 0.0887, 0.0862, 0.1119, 0.2208,
        0.0642])
[rfa agg] iter:  3, prev_obj_val: 76.90660095214844, obj_val: 76.90580749511719, abs dis: 0.00079345703125
[rfa agg] iter: 3, weight: tensor([0.0642, 0.2548, 0.0205, 0.0681, 0.0284, 0.0881, 0.0857, 0.1121, 0.2141,
        0.0639])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0193, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5447, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.54549980163574 sec.
Server Epoch:50 choose agents : [33, 43, 89, 10, 19, 73, 12, 23, 42, 52].
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   1, Avg loss: 0.1020, Accuracy: 1/515 (0.1942%)
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   2, Avg loss: 0.0605, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8229, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 243/946 (25.6871%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   2, Avg loss: 0.0349, Accuracy: 368/946 (38.9006%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9092, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   1, Avg loss: 0.0642, Accuracy: 282/896 (31.4732%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4575, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   1, Avg loss: 0.0615, Accuracy: 168/861 (19.5122%)
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   2, Avg loss: 0.0222, Accuracy: 416/861 (48.3159%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.9809, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   1, Avg loss: 0.0604, Accuracy: 278/1036 (26.8340%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 635/1036 (61.2934%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 14.0228, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   1, Avg loss: 0.0763, Accuracy: 137/938 (14.6055%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   2, Avg loss: 0.0371, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.6115, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   1, Avg loss: 0.0962, Accuracy: 5/338 (1.4793%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   2, Avg loss: 0.0550, Accuracy: 125/338 (36.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2823, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   1, Avg loss: 0.0705, Accuracy: 239/715 (33.4266%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   2, Avg loss: 0.0425, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.0414, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0636, Accuracy: 267/1372 (19.4606%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0354, Accuracy: 465/1372 (33.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.5378, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0649, Accuracy: 215/636 (33.8050%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0366, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.8973, Accuracy: 50/10000 (0.5000%)
time spent on training: 181.99495911598206
[rfa agg] training data poison_ratio: 0.10432569974554708  data num: [515, 946, 896, 861, 1036, 938, 338, 715, 1372, 636]
[rfa agg] considering poison per batch poison_fraction: 0.032601781170483464
[rfa agg] init. name: [33, 43, 89, 10, 19, 73, 12, 23, 42, 52], weight: tensor([0.0624, 0.1146, 0.1086, 0.1043, 0.1255, 0.1137, 0.0410, 0.0866, 0.1662,
        0.0771])
[rfa agg] iter:  0, prev_obj_val: 38.86924743652344, obj_val: 42.47468948364258, abs dis: 3.6054420471191406
[rfa agg] iter: 0, weight: tensor([0.0455, 0.1387, 0.1706, 0.1550, 0.0935, 0.1387, 0.0185, 0.1092, 0.0602,
        0.0702])
[rfa agg] iter:  1, prev_obj_val: 42.47468948364258, obj_val: 47.231101989746094, abs dis: 4.756412506103516
[rfa agg] iter: 1, weight: tensor([0.0615, 0.1222, 0.1506, 0.1400, 0.0866, 0.1217, 0.0234, 0.1355, 0.0603,
        0.0983])
[rfa agg] iter:  2, prev_obj_val: 47.231101989746094, obj_val: 47.20044708251953, abs dis: 0.0306549072265625
[rfa agg] iter: 2, weight: tensor([0.0848, 0.1077, 0.1270, 0.1197, 0.0813, 0.1066, 0.0301, 0.1430, 0.0607,
        0.1391])
[rfa agg] iter:  3, prev_obj_val: 47.20044708251953, obj_val: 47.19999694824219, abs dis: 0.00045013427734375
[rfa agg] iter: 3, weight: tensor([0.0857, 0.1066, 0.1246, 0.1174, 0.0804, 0.1051, 0.0300, 0.1449, 0.0602,
        0.1451])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.9933, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5606, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 340.2689743041992 sec.
Server Epoch:51 choose agents : [87, 56, 68, 6, 65, 8, 42, 76, 52, 45].
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   1, Avg loss: 0.0561, Accuracy: 286/1131 (25.2874%)
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   2, Avg loss: 0.0328, Accuracy: 402/1131 (35.5438%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.9784, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0902, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0730, Accuracy: 26/186 (13.9785%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6817, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   1, Avg loss: 0.0674, Accuracy: 273/1163 (23.4738%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   2, Avg loss: 0.0378, Accuracy: 472/1163 (40.5847%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1599, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0620, Accuracy: 301/1956 (15.3885%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 566/1956 (28.9366%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7690, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   1, Avg loss: 0.0578, Accuracy: 354/1475 (24.0000%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   2, Avg loss: 0.0340, Accuracy: 582/1475 (39.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4609, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0638, Accuracy: 221/1513 (14.6067%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0383, Accuracy: 437/1513 (28.8830%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3406, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0646, Accuracy: 219/1372 (15.9621%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0339, Accuracy: 492/1372 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.0793, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0807, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 182/466 (39.0558%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.5236, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   1, Avg loss: 0.0661, Accuracy: 212/636 (33.3333%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   2, Avg loss: 0.0359, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   1, Avg loss: 0.0803, Accuracy: 95/669 (14.2003%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9803, Accuracy: 75/10000 (0.7500%)
time spent on training: 196.02612352371216
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 186, 1163, 1956, 1475, 1513, 1372, 466, 636, 669]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 56, 68, 6, 65, 8, 42, 76, 52, 45], weight: tensor([0.1070, 0.0176, 0.1101, 0.1851, 0.1396, 0.1432, 0.1298, 0.0441, 0.0602,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 63.03105926513672, obj_val: 66.34304809570312, abs dis: 3.3119888305664062
[rfa agg] iter: 0, weight: tensor([0.2339, 0.0055, 0.2009, 0.0743, 0.1118, 0.1200, 0.1565, 0.0210, 0.0348,
        0.0413])
[rfa agg] iter:  1, prev_obj_val: 66.34304809570312, obj_val: 66.32308197021484, abs dis: 0.01996612548828125
[rfa agg] iter: 1, weight: tensor([0.2745, 0.0059, 0.2018, 0.0697, 0.0991, 0.1056, 0.1331, 0.0233, 0.0396,
        0.0474])
[rfa agg] iter:  2, prev_obj_val: 66.32308197021484, obj_val: 66.32205200195312, abs dis: 0.00102996826171875
[rfa agg] iter: 2, weight: tensor([0.2861, 0.0058, 0.1996, 0.0687, 0.0972, 0.1037, 0.1302, 0.0230, 0.0390,
        0.0467])
[rfa agg] iter:  3, prev_obj_val: 66.32205200195312, obj_val: 66.32196807861328, abs dis: 8.392333984375e-05
[rfa agg] iter: 3, weight: tensor([0.2894, 0.0058, 0.1984, 0.0684, 0.0968, 0.1032, 0.1296, 0.0229, 0.0389,
        0.0465])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.9890, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.0957, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.7861008644104 sec.
Server Epoch:52 choose agents : [5, 61, 23, 36, 64, 45, 13, 77, 7, 99].
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   1, Avg loss: 0.0584, Accuracy: 330/1628 (20.2703%)
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 704/1628 (43.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8235, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1435, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1310, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9284, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   1, Avg loss: 0.0731, Accuracy: 212/715 (29.6503%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   2, Avg loss: 0.0460, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4050, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   1, Avg loss: 0.1018, Accuracy: 8/408 (1.9608%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   2, Avg loss: 0.0622, Accuracy: 142/408 (34.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9660, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 144/953 (15.1102%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.3361, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   1, Avg loss: 0.0777, Accuracy: 108/669 (16.1435%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   2, Avg loss: 0.0422, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2933, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0646, Accuracy: 278/1645 (16.8997%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0353, Accuracy: 526/1645 (31.9757%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.9285, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   1, Avg loss: 0.0505, Accuracy: 319/1340 (23.8060%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 533/1340 (39.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8616, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0658, Accuracy: 205/891 (23.0079%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0270, Accuracy: 440/891 (49.3827%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8718, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   1, Avg loss: 0.0624, Accuracy: 195/773 (25.2264%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 403/773 (52.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.7422, Accuracy: 75/10000 (0.7500%)
time spent on training: 187.01215434074402
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 85, 715, 408, 953, 669, 1645, 1340, 891, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 61, 23, 36, 64, 45, 13, 77, 7, 99], weight: tensor([0.1788, 0.0093, 0.0785, 0.0448, 0.1046, 0.0735, 0.1806, 0.1471, 0.0978,
        0.0849])
[rfa agg] iter:  0, prev_obj_val: 59.477535247802734, obj_val: 63.51871109008789, abs dis: 4.041175842285156
[rfa agg] iter: 0, weight: tensor([0.0954, 0.0031, 0.0797, 0.0238, 0.2251, 0.0645, 0.0955, 0.1499, 0.1591,
        0.1038])
[rfa agg] iter:  1, prev_obj_val: 63.51871109008789, obj_val: 65.13748168945312, abs dis: 1.6187705993652344
[rfa agg] iter: 1, weight: tensor([0.0606, 0.0028, 0.1025, 0.0250, 0.2263, 0.0810, 0.0607, 0.0826, 0.2202,
        0.1382])
[rfa agg] iter:  2, prev_obj_val: 65.13748168945312, obj_val: 67.15996551513672, abs dis: 2.0224838256835938
[rfa agg] iter: 2, weight: tensor([0.0577, 0.0029, 0.1150, 0.0266, 0.1936, 0.0909, 0.0579, 0.0765, 0.2266,
        0.1523])
[rfa agg] iter:  3, prev_obj_val: 67.15996551513672, obj_val: 67.15016174316406, abs dis: 0.00980377197265625
[rfa agg] iter: 3, weight: tensor([0.0572, 0.0031, 0.1309, 0.0294, 0.1681, 0.1056, 0.0574, 0.0742, 0.2109,
        0.1633])
[rfa agg] iter:  4, prev_obj_val: 67.15016174316406, obj_val: 69.4708251953125, abs dis: 2.3206634521484375
[rfa agg] iter: 4, weight: tensor([0.0571, 0.0031, 0.1335, 0.0294, 0.1657, 0.1069, 0.0573, 0.0741, 0.2074,
        0.1654])
[rfa agg] iter:  5, prev_obj_val: 69.4708251953125, obj_val: 69.46261596679688, abs dis: 0.008209228515625
[rfa agg] iter: 5, weight: tensor([0.0571, 0.0033, 0.1480, 0.0328, 0.1497, 0.1246, 0.0573, 0.0727, 0.1871,
        0.1674])
[rfa agg] iter:  6, prev_obj_val: 69.46261596679688, obj_val: 69.4624252319336, abs dis: 0.00019073486328125
[rfa agg] iter: 6, weight: tensor([0.0570, 0.0033, 0.1510, 0.0328, 0.1484, 0.1267, 0.0572, 0.0726, 0.1837,
        0.1673])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9956, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.9158, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.8674874305725 sec.
Server Epoch:53 choose agents : [96, 36, 89, 65, 62, 19, 45, 1, 34, 33].
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   1, Avg loss: 0.0848, Accuracy: 11/311 (3.5370%)
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   2, Avg loss: 0.0569, Accuracy: 125/311 (40.1929%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9589, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   1, Avg loss: 0.1003, Accuracy: 8/408 (1.9608%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   2, Avg loss: 0.0584, Accuracy: 139/408 (34.0686%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3411, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   1, Avg loss: 0.0638, Accuracy: 282/896 (31.4732%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   2, Avg loss: 0.0352, Accuracy: 428/896 (47.7679%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0632, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   1, Avg loss: 0.0578, Accuracy: 331/1475 (22.4407%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 600/1475 (40.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.5943, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0725, Accuracy: 86/568 (15.1408%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4992, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0584, Accuracy: 283/1036 (27.3166%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 635/1036 (61.2934%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 13.1352, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   1, Avg loss: 0.0767, Accuracy: 118/669 (17.6383%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   2, Avg loss: 0.0431, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0351, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0606, Accuracy: 252/928 (27.1552%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0251, Accuracy: 525/928 (56.5733%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.6417, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   1, Avg loss: 0.0652, Accuracy: 324/1427 (22.7050%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   2, Avg loss: 0.0354, Accuracy: 555/1427 (38.8928%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4363, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   1, Avg loss: 0.1036, Accuracy: 4/515 (0.7767%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   2, Avg loss: 0.0653, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6180, Accuracy: 52/10000 (0.5200%)
time spent on training: 181.33483576774597
[rfa agg] training data poison_ratio: 0.0  data num: [311, 408, 896, 1475, 568, 1036, 669, 928, 1427, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 36, 89, 65, 62, 19, 45, 1, 34, 33], weight: tensor([0.0378, 0.0496, 0.1088, 0.1792, 0.0690, 0.1258, 0.0813, 0.1127, 0.1733,
        0.0626])
[rfa agg] iter:  0, prev_obj_val: 55.849578857421875, obj_val: 59.4591178894043, abs dis: 3.609539031982422
[rfa agg] iter: 0, weight: tensor([0.0179, 0.0306, 0.2413, 0.0779, 0.0592, 0.1533, 0.1006, 0.1828, 0.0853,
        0.0509])
[rfa agg] iter:  1, prev_obj_val: 59.4591178894043, obj_val: 59.416107177734375, abs dis: 0.043010711669921875
[rfa agg] iter: 1, weight: tensor([0.0215, 0.0387, 0.2251, 0.0696, 0.0823, 0.1186, 0.1495, 0.1521, 0.0753,
        0.0673])
[rfa agg] iter:  2, prev_obj_val: 59.416107177734375, obj_val: 61.11094284057617, abs dis: 1.6948356628417969
[rfa agg] iter: 2, weight: tensor([0.0215, 0.0389, 0.2215, 0.0693, 0.0830, 0.1173, 0.1563, 0.1493, 0.0749,
        0.0679])
[rfa agg] iter:  3, prev_obj_val: 61.11094284057617, obj_val: 62.953392028808594, abs dis: 1.8424491882324219
[rfa agg] iter: 3, weight: tensor([0.0232, 0.0428, 0.1947, 0.0678, 0.0955, 0.1093, 0.1804, 0.1372, 0.0729,
        0.0762])
[rfa agg] iter:  4, prev_obj_val: 62.953392028808594, obj_val: 64.9668197631836, abs dis: 2.013427734375
[rfa agg] iter: 4, weight: tensor([0.0248, 0.0470, 0.1676, 0.0653, 0.1102, 0.1008, 0.2051, 0.1242, 0.0700,
        0.0850])
[rfa agg] iter:  5, prev_obj_val: 64.9668197631836, obj_val: 62.946388244628906, abs dis: 2.0204315185546875
[rfa agg] iter: 5, weight: tensor([0.0263, 0.0515, 0.1452, 0.0626, 0.1284, 0.0926, 0.2201, 0.1121, 0.0667,
        0.0945])
[rfa agg] iter:  6, prev_obj_val: 62.946388244628906, obj_val: 64.96331787109375, abs dis: 2.0169296264648438
[rfa agg] iter: 6, weight: tensor([0.0247, 0.0468, 0.1617, 0.0645, 0.1109, 0.0991, 0.2161, 0.1215, 0.0691,
        0.0855])
[rfa agg] iter:  7, prev_obj_val: 64.96331787109375, obj_val: 64.95706939697266, abs dis: 0.00624847412109375
[rfa agg] iter: 7, weight: tensor([0.0263, 0.0513, 0.1444, 0.0624, 0.1281, 0.0923, 0.2228, 0.1116, 0.0665,
        0.0943])
[rfa agg] iter:  8, prev_obj_val: 64.95706939697266, obj_val: 67.17456817626953, abs dis: 2.217498779296875
[rfa agg] iter: 8, weight: tensor([0.0262, 0.0513, 0.1427, 0.0621, 0.1289, 0.0917, 0.2255, 0.1107, 0.0661,
        0.0948])
[rfa agg] iter:  9, prev_obj_val: 67.17456817626953, obj_val: 72.21806335449219, abs dis: 5.043495178222656
[rfa agg] iter: 9, weight: tensor([0.0282, 0.0570, 0.1278, 0.0601, 0.1525, 0.0857, 0.2177, 0.1019, 0.0638,
        0.1053])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 29.9961, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 41.0641, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.4964032173157 sec.
Server Epoch:54 choose agents : [47, 28, 66, 55, 29, 52, 42, 8, 17, 23].
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1488, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1304, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4645, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0658, Accuracy: 324/1581 (20.4934%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 538/1581 (34.0291%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5385, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0711, Accuracy: 180/1402 (12.8388%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0407, Accuracy: 343/1402 (24.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6273, Accuracy: 54/10000 (0.5400%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   1, Avg loss: 0.0582, Accuracy: 223/1071 (20.8217%)
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 480/1071 (44.8179%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.4148, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   1, Avg loss: 0.0550, Accuracy: 373/1440 (25.9028%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   2, Avg loss: 0.0289, Accuracy: 697/1440 (48.4028%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1776, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0626, Accuracy: 221/636 (34.7484%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0362, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.0971, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   1, Avg loss: 0.0647, Accuracy: 256/1372 (18.6589%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   2, Avg loss: 0.0342, Accuracy: 500/1372 (36.4431%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1461, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0638, Accuracy: 231/1513 (15.2677%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0382, Accuracy: 442/1513 (29.2135%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5018, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   1, Avg loss: 0.0545, Accuracy: 299/1574 (18.9962%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 563/1574 (35.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.5210, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   1, Avg loss: 0.0676, Accuracy: 242/715 (33.8462%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   2, Avg loss: 0.0432, Accuracy: 436/715 (60.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.8759, Accuracy: 73/10000 (0.7300%)
time spent on training: 206.77669024467468
[rfa agg] training data poison_ratio: 0.09363525091799266  data num: [134, 1581, 1402, 1071, 1440, 636, 1372, 1513, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.029261015911872704
[rfa agg] init. name: [47, 28, 66, 55, 29, 52, 42, 8, 17, 23], weight: tensor([0.0117, 0.1382, 0.1226, 0.0936, 0.1259, 0.0556, 0.1200, 0.1323, 0.1376,
        0.0625])
[rfa agg] iter:  0, prev_obj_val: 49.82880783081055, obj_val: 47.687843322753906, abs dis: 2.1409645080566406
[rfa agg] iter: 0, weight: tensor([0.0035, 0.1051, 0.1599, 0.1465, 0.1353, 0.0300, 0.1510, 0.1191, 0.1073,
        0.0424])
[rfa agg] iter:  1, prev_obj_val: 47.687843322753906, obj_val: 49.77006530761719, abs dis: 2.0822219848632812
[rfa agg] iter: 1, weight: tensor([0.0032, 0.1052, 0.1707, 0.1287, 0.1408, 0.0268, 0.1574, 0.1216, 0.1082,
        0.0375])
[rfa agg] iter:  2, prev_obj_val: 49.77006530761719, obj_val: 45.77389907836914, abs dis: 3.996166229248047
[rfa agg] iter: 2, weight: tensor([0.0035, 0.1035, 0.1623, 0.1486, 0.1352, 0.0297, 0.1513, 0.1182, 0.1060,
        0.0419])
[rfa agg] iter:  3, prev_obj_val: 45.77389907836914, obj_val: 49.78069305419922, abs dis: 4.006793975830078
[rfa agg] iter: 3, weight: tensor([0.0029, 0.1064, 0.1794, 0.1094, 0.1465, 0.0241, 0.1629, 0.1249, 0.1101,
        0.0333])
[rfa agg] iter:  4, prev_obj_val: 49.78069305419922, obj_val: 47.687557220458984, abs dis: 2.0931358337402344
[rfa agg] iter: 4, weight: tensor([0.0035, 0.1036, 0.1629, 0.1466, 0.1354, 0.0297, 0.1518, 0.1184, 0.1061,
        0.0419])
[rfa agg] iter:  5, prev_obj_val: 47.687557220458984, obj_val: 49.77006530761719, abs dis: 2.082508087158203
[rfa agg] iter: 5, weight: tensor([0.0032, 0.1051, 0.1709, 0.1287, 0.1408, 0.0268, 0.1574, 0.1215, 0.1081,
        0.0375])
[rfa agg] iter:  6, prev_obj_val: 49.77006530761719, obj_val: 45.773902893066406, abs dis: 3.9961624145507812
[rfa agg] iter: 6, weight: tensor([0.0035, 0.1035, 0.1623, 0.1486, 0.1352, 0.0297, 0.1513, 0.1182, 0.1060,
        0.0419])
[rfa agg] iter:  7, prev_obj_val: 45.773902893066406, obj_val: 49.78070068359375, abs dis: 4.006797790527344
[rfa agg] iter: 7, weight: tensor([0.0029, 0.1064, 0.1794, 0.1094, 0.1465, 0.0241, 0.1629, 0.1249, 0.1101,
        0.0333])
[rfa agg] iter:  8, prev_obj_val: 49.78070068359375, obj_val: 47.68756103515625, abs dis: 2.0931396484375
[rfa agg] iter: 8, weight: tensor([0.0035, 0.1036, 0.1629, 0.1466, 0.1354, 0.0297, 0.1518, 0.1184, 0.1061,
        0.0419])
[rfa agg] iter:  9, prev_obj_val: 47.68756103515625, obj_val: 49.77006530761719, abs dis: 2.0825042724609375
[rfa agg] iter: 9, weight: tensor([0.0032, 0.1051, 0.1709, 0.1287, 0.1408, 0.0268, 0.1574, 0.1215, 0.1081,
        0.0375])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 22.8651, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 28.9087, Accuracy: 0/9950 (0.0000%)
saving model
Done in 369.88694643974304 sec.
Server Epoch:55 choose agents : [40, 73, 17, 94, 50, 89, 8, 7, 99, 58].
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   1, Avg loss: 0.0680, Accuracy: 243/1573 (15.4482%)
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   2, Avg loss: 0.0389, Accuracy: 518/1573 (32.9307%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1750, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0739, Accuracy: 150/938 (15.9915%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0379, Accuracy: 328/938 (34.9680%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.7899, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   1, Avg loss: 0.0536, Accuracy: 321/1574 (20.3939%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 582/1574 (36.9759%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.3605, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   1, Avg loss: 0.0725, Accuracy: 261/1662 (15.7040%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   2, Avg loss: 0.0356, Accuracy: 571/1662 (34.3562%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.6878, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   1, Avg loss: 0.0734, Accuracy: 109/809 (13.4734%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 317/809 (39.1842%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.6589, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0638, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0350, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0866, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   1, Avg loss: 0.0618, Accuracy: 246/1513 (16.2591%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   2, Avg loss: 0.0388, Accuracy: 411/1513 (27.1646%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4786, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   1, Avg loss: 0.0614, Accuracy: 224/891 (25.1403%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 455/891 (51.0662%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.1320, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0590, Accuracy: 223/773 (28.8486%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 423/773 (54.7219%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.6807, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0628, Accuracy: 258/803 (32.1295%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0384, Accuracy: 411/803 (51.1831%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1328, Accuracy: 54/10000 (0.5400%)
time spent on training: 209.96938920021057
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 938, 1574, 1662, 809, 896, 1513, 891, 773, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 73, 17, 94, 50, 89, 8, 7, 99, 58], weight: tensor([0.1376, 0.0821, 0.1377, 0.1454, 0.0708, 0.0784, 0.1323, 0.0779, 0.0676,
        0.0702])
[rfa agg] iter:  0, prev_obj_val: 57.91912841796875, obj_val: 59.29009246826172, abs dis: 1.3709640502929688
[rfa agg] iter: 0, weight: tensor([0.0882, 0.1548, 0.0900, 0.0843, 0.0866, 0.1180, 0.0963, 0.1177, 0.0784,
        0.0856])
[rfa agg] iter:  1, prev_obj_val: 59.29009246826172, obj_val: 63.02568435668945, abs dis: 3.7355918884277344
[rfa agg] iter: 1, weight: tensor([0.0684, 0.1828, 0.0695, 0.0658, 0.0942, 0.1345, 0.0737, 0.1341, 0.0834,
        0.0935])
[rfa agg] iter:  2, prev_obj_val: 63.02568435668945, obj_val: 67.26471710205078, abs dis: 4.239032745361328
[rfa agg] iter: 2, weight: tensor([0.0485, 0.1700, 0.0491, 0.0471, 0.1134, 0.1573, 0.0514, 0.1569, 0.0934,
        0.1130])
[rfa agg] iter:  3, prev_obj_val: 67.26471710205078, obj_val: 67.24691772460938, abs dis: 0.01779937744140625
[rfa agg] iter: 3, weight: tensor([0.0430, 0.1301, 0.0435, 0.0420, 0.1386, 0.1565, 0.0452, 0.1558, 0.1064,
        0.1389])
[rfa agg] iter:  4, prev_obj_val: 67.24691772460938, obj_val: 67.24674224853516, abs dis: 0.00017547607421875
[rfa agg] iter: 4, weight: tensor([0.0427, 0.1259, 0.0431, 0.0417, 0.1418, 0.1559, 0.0448, 0.1553, 0.1073,
        0.1414])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9683, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 4.7904, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.4376082420349 sec.
Server Epoch:56 choose agents : [93, 82, 17, 59, 84, 14, 65, 13, 28, 10].
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   1, Avg loss: 0.0627, Accuracy: 353/1742 (20.2641%)
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   2, Avg loss: 0.0335, Accuracy: 651/1742 (37.3708%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.5814, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0808, Accuracy: 52/500 (10.4000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0513, Accuracy: 195/500 (39.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.5248, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0546, Accuracy: 309/1574 (19.6315%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 575/1574 (36.5311%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.4101, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   2, Avg loss: 0.0312, Accuracy: 426/1089 (39.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.7906, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 286/1190 (24.0336%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6907, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   1, Avg loss: 0.0777, Accuracy: 89/1013 (8.7858%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   2, Avg loss: 0.0381, Accuracy: 347/1013 (34.2547%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6369, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0578, Accuracy: 319/1475 (21.6271%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0335, Accuracy: 619/1475 (41.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.2354, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0637, Accuracy: 257/1645 (15.6231%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0355, Accuracy: 547/1645 (33.2523%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0467, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   1, Avg loss: 0.0672, Accuracy: 328/1581 (20.7464%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   2, Avg loss: 0.0372, Accuracy: 514/1581 (32.5111%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4333, Accuracy: 70/10000 (0.7000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   1, Avg loss: 0.0641, Accuracy: 126/861 (14.6341%)
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   2, Avg loss: 0.0225, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.2365, Accuracy: 87/10000 (0.8700%)
time spent on training: 234.4262933731079
[rfa agg] training data poison_ratio: 0.06795580110497237  data num: [1742, 500, 1574, 1089, 1190, 1013, 1475, 1645, 1581, 861]
[rfa agg] considering poison per batch poison_fraction: 0.021236187845303865
[rfa agg] init. name: [93, 82, 17, 59, 84, 14, 65, 13, 28, 10], weight: tensor([0.1375, 0.0395, 0.1242, 0.0860, 0.0939, 0.0800, 0.1164, 0.1298, 0.1248,
        0.0680])
[rfa agg] iter:  0, prev_obj_val: 55.53460693359375, obj_val: 58.99666976928711, abs dis: 3.4620628356933594
[rfa agg] iter: 0, weight: tensor([0.0871, 0.0189, 0.1154, 0.1000, 0.1661, 0.1073, 0.1212, 0.1033, 0.1162,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 58.99666976928711, obj_val: 57.13460922241211, abs dis: 1.862060546875
[rfa agg] iter: 1, weight: tensor([0.0791, 0.0208, 0.1012, 0.1075, 0.1814, 0.1344, 0.1055, 0.0919, 0.1017,
        0.0766])
[rfa agg] iter:  2, prev_obj_val: 57.13460922241211, obj_val: 58.984588623046875, abs dis: 1.8499794006347656
[rfa agg] iter: 2, weight: tensor([0.0817, 0.0196, 0.1063, 0.1047, 0.1852, 0.1199, 0.1108, 0.0957, 0.1068,
        0.0693])
[rfa agg] iter:  3, prev_obj_val: 58.984588623046875, obj_val: 55.45812225341797, abs dis: 3.5264663696289062
[rfa agg] iter: 3, weight: tensor([0.0786, 0.0207, 0.1006, 0.1076, 0.1850, 0.1343, 0.1046, 0.0913, 0.1010,
        0.0762])
[rfa agg] iter:  4, prev_obj_val: 55.45812225341797, obj_val: 58.99137496948242, abs dis: 3.533252716064453
[rfa agg] iter: 4, weight: tensor([0.0850, 0.0186, 0.1129, 0.1006, 0.1811, 0.1067, 0.1177, 0.1006, 0.1134,
        0.0632])
[rfa agg] iter:  5, prev_obj_val: 58.99137496948242, obj_val: 57.134544372558594, abs dis: 1.8568305969238281
[rfa agg] iter: 5, weight: tensor([0.0788, 0.0208, 0.1009, 0.1073, 0.1842, 0.1338, 0.1050, 0.0916, 0.1013,
        0.0763])
[rfa agg] iter:  6, prev_obj_val: 57.134544372558594, obj_val: 58.98459243774414, abs dis: 1.8500480651855469
[rfa agg] iter: 6, weight: tensor([0.0816, 0.0196, 0.1063, 0.1047, 0.1857, 0.1198, 0.1107, 0.0956, 0.1068,
        0.0692])
[rfa agg] iter:  7, prev_obj_val: 58.98459243774414, obj_val: 55.4581298828125, abs dis: 3.5264625549316406
[rfa agg] iter: 7, weight: tensor([0.0786, 0.0207, 0.1006, 0.1076, 0.1851, 0.1343, 0.1046, 0.0913, 0.1010,
        0.0762])
[rfa agg] iter:  8, prev_obj_val: 55.4581298828125, obj_val: 58.99137496948242, abs dis: 3.533245086669922
[rfa agg] iter: 8, weight: tensor([0.0850, 0.0186, 0.1129, 0.1006, 0.1811, 0.1067, 0.1177, 0.1006, 0.1134,
        0.0632])
[rfa agg] iter:  9, prev_obj_val: 58.99137496948242, obj_val: 57.13454055786133, abs dis: 1.8568344116210938
[rfa agg] iter: 9, weight: tensor([0.0788, 0.0208, 0.1009, 0.1073, 0.1842, 0.1338, 0.1050, 0.0916, 0.1013,
        0.0763])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.0081, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.0563, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.4921164512634 sec.
Server Epoch:57 choose agents : [43, 89, 50, 55, 94, 77, 48, 34, 27, 7].
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 266/946 (28.1184%)
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0843, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0618, Accuracy: 293/896 (32.7009%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0350, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2757, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   1, Avg loss: 0.0723, Accuracy: 119/809 (14.7095%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   2, Avg loss: 0.0315, Accuracy: 308/809 (38.0717%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.2252, Accuracy: 82/10000 (0.8200%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0609, Accuracy: 207/1071 (19.3277%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1466, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   1, Avg loss: 0.0719, Accuracy: 222/1662 (13.3574%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   2, Avg loss: 0.0360, Accuracy: 547/1662 (32.9122%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8988, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   1, Avg loss: 0.0487, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.9521, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0797, Accuracy: 63/631 (9.9842%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0467, Accuracy: 241/631 (38.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.0977, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0657, Accuracy: 309/1427 (21.6538%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0367, Accuracy: 533/1427 (37.3511%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2885, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   1, Avg loss: 0.0600, Accuracy: 315/1587 (19.8488%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   2, Avg loss: 0.0354, Accuracy: 550/1587 (34.6566%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.4155, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0622, Accuracy: 228/891 (25.5892%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0275, Accuracy: 452/891 (50.7295%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.3397, Accuracy: 66/10000 (0.6600%)
time spent on training: 212.98946332931519
[rfa agg] training data poison_ratio: 0.09511545293072825  data num: [946, 896, 809, 1071, 1662, 1340, 631, 1427, 1587, 891]
[rfa agg] considering poison per batch poison_fraction: 0.029723579040852578
[rfa agg] init. name: [43, 89, 50, 55, 94, 77, 48, 34, 27, 7], weight: tensor([0.0840, 0.0796, 0.0718, 0.0951, 0.1476, 0.1190, 0.0560, 0.1267, 0.1409,
        0.0791])
[rfa agg] iter:  0, prev_obj_val: 51.500545501708984, obj_val: 56.43552017211914, abs dis: 4.934974670410156
[rfa agg] iter: 0, weight: tensor([0.1367, 0.1025, 0.0768, 0.1697, 0.0757, 0.1243, 0.0368, 0.0943, 0.0808,
        0.1023])
[rfa agg] iter:  1, prev_obj_val: 56.43552017211914, obj_val: 60.55361557006836, abs dis: 4.118095397949219
[rfa agg] iter: 1, weight: tensor([0.1761, 0.1440, 0.1071, 0.1292, 0.0550, 0.0789, 0.0439, 0.0641, 0.0576,
        0.1442])
[rfa agg] iter:  2, prev_obj_val: 60.55361557006836, obj_val: 63.13152313232422, abs dis: 2.5779075622558594
[rfa agg] iter: 2, weight: tensor([0.1620, 0.1606, 0.1350, 0.1013, 0.0495, 0.0668, 0.0519, 0.0560, 0.0514,
        0.1655])
[rfa agg] iter:  3, prev_obj_val: 63.13152313232422, obj_val: 63.128028869628906, abs dis: 0.0034942626953125
[rfa agg] iter: 3, weight: tensor([0.1461, 0.1615, 0.1537, 0.0933, 0.0487, 0.0642, 0.0592, 0.0545, 0.0504,
        0.1684])
[rfa agg] iter:  4, prev_obj_val: 63.128028869628906, obj_val: 60.541282653808594, abs dis: 2.5867462158203125
[rfa agg] iter: 4, weight: tensor([0.1445, 0.1610, 0.1564, 0.0929, 0.0487, 0.0640, 0.0592, 0.0544, 0.0503,
        0.1686])
[rfa agg] iter:  5, prev_obj_val: 60.541282653808594, obj_val: 63.1302375793457, abs dis: 2.5889549255371094
[rfa agg] iter: 5, weight: tensor([0.1574, 0.1610, 0.1392, 0.0993, 0.0492, 0.0662, 0.0518, 0.0556, 0.0510,
        0.1693])
[rfa agg] iter:  6, prev_obj_val: 63.1302375793457, obj_val: 60.54082107543945, abs dis: 2.58941650390625
[rfa agg] iter: 6, weight: tensor([0.1456, 0.1614, 0.1541, 0.0931, 0.0487, 0.0641, 0.0592, 0.0545, 0.0504,
        0.1689])
[rfa agg] iter:  7, prev_obj_val: 60.54082107543945, obj_val: 63.13029098510742, abs dis: 2.5894699096679688
[rfa agg] iter: 7, weight: tensor([0.1575, 0.1611, 0.1389, 0.0993, 0.0492, 0.0662, 0.0518, 0.0556, 0.0510,
        0.1694])
[rfa agg] iter:  8, prev_obj_val: 63.13029098510742, obj_val: 60.54081344604492, abs dis: 2.5894775390625
[rfa agg] iter: 8, weight: tensor([0.1456, 0.1614, 0.1541, 0.0931, 0.0487, 0.0641, 0.0592, 0.0545, 0.0504,
        0.1689])
[rfa agg] iter:  9, prev_obj_val: 60.54081344604492, obj_val: 63.130287170410156, abs dis: 2.5894737243652344
[rfa agg] iter: 9, weight: tensor([0.1575, 0.1612, 0.1389, 0.0993, 0.0492, 0.0662, 0.0518, 0.0556, 0.0510,
        0.1694])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.0173, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.1462, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.9169294834137 sec.
Server Epoch:58 choose agents : [42, 60, 4, 34, 79, 80, 75, 93, 9, 37].
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   1, Avg loss: 0.0641, Accuracy: 243/1372 (17.7114%)
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   2, Avg loss: 0.0336, Accuracy: 513/1372 (37.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0912, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   1, Avg loss: 0.0542, Accuracy: 527/2227 (23.6641%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 947/2227 (42.5236%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0509, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0679, Accuracy: 260/901 (28.8568%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0368, Accuracy: 369/901 (40.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0616, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0645, Accuracy: 350/1427 (24.5270%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 539/1427 (37.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.0583, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   1, Avg loss: 0.1107, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   2, Avg loss: 0.0943, Accuracy: 9/197 (4.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3631, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   1, Avg loss: 0.0741, Accuracy: 64/682 (9.3842%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.6662, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0661, Accuracy: 209/776 (26.9330%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0327, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.2872, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   1, Avg loss: 0.0625, Accuracy: 390/1742 (22.3881%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   2, Avg loss: 0.0331, Accuracy: 648/1742 (37.1986%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.8911, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   1, Avg loss: 0.0567, Accuracy: 321/1275 (25.1765%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   2, Avg loss: 0.0200, Accuracy: 697/1275 (54.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 11.5418, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   1, Avg loss: 0.0553, Accuracy: 347/1129 (30.7352%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   2, Avg loss: 0.0278, Accuracy: 665/1129 (58.9017%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.5392, Accuracy: 99/10000 (0.9900%)
time spent on training: 205.21902418136597
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 2227, 901, 1427, 197, 682, 776, 1742, 1275, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 60, 4, 34, 79, 80, 75, 93, 9, 37], weight: tensor([0.1170, 0.1899, 0.0768, 0.1217, 0.0168, 0.0582, 0.0662, 0.1485, 0.1087,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 64.64415740966797, obj_val: 67.07608032226562, abs dis: 2.4319229125976562
[rfa agg] iter: 0, weight: tensor([0.2147, 0.0663, 0.0590, 0.1862, 0.0048, 0.0285, 0.0395, 0.0994, 0.1836,
        0.1181])
[rfa agg] iter:  1, prev_obj_val: 67.07608032226562, obj_val: 69.9646987915039, abs dis: 2.8886184692382812
[rfa agg] iter: 1, weight: tensor([0.1770, 0.0606, 0.0750, 0.1459, 0.0053, 0.0337, 0.0480, 0.0846, 0.2096,
        0.1604])
[rfa agg] iter:  2, prev_obj_val: 69.9646987915039, obj_val: 71.70329284667969, abs dis: 1.7385940551757812
[rfa agg] iter: 2, weight: tensor([0.1460, 0.0592, 0.0929, 0.1243, 0.0058, 0.0393, 0.0573, 0.0791, 0.1985,
        0.1978])
[rfa agg] iter:  3, prev_obj_val: 71.70329284667969, obj_val: 71.69747161865234, abs dis: 0.00582122802734375
[rfa agg] iter: 3, weight: tensor([0.1339, 0.0586, 0.1044, 0.1160, 0.0061, 0.0426, 0.0630, 0.0767, 0.1834,
        0.2153])
[rfa agg] iter:  4, prev_obj_val: 71.69747161865234, obj_val: 71.69729614257812, abs dis: 0.00017547607421875
[rfa agg] iter: 4, weight: tensor([0.1331, 0.0584, 0.1045, 0.1154, 0.0061, 0.0425, 0.0629, 0.0764, 0.1811,
        0.2196])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9943, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.9577, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.1324095726013 sec.
Server Epoch:59 choose agents : [36, 33, 94, 37, 79, 21, 28, 25, 35, 24].
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0988, Accuracy: 10/408 (2.4510%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0628, Accuracy: 144/408 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1203, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   1, Avg loss: 0.1042, Accuracy: 12/515 (2.3301%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   2, Avg loss: 0.0634, Accuracy: 115/515 (22.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1282, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   1, Avg loss: 0.0708, Accuracy: 228/1662 (13.7184%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   2, Avg loss: 0.0363, Accuracy: 552/1662 (33.2130%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.0444, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   1, Avg loss: 0.0540, Accuracy: 351/1129 (31.0895%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   2, Avg loss: 0.0278, Accuracy: 666/1129 (58.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.3721, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   1, Avg loss: 0.1165, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   2, Avg loss: 0.0958, Accuracy: 7/197 (3.5533%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.3421, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0620, Accuracy: 325/1949 (16.6752%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0344, Accuracy: 583/1949 (29.9128%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.0502, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   1, Avg loss: 0.0658, Accuracy: 317/1581 (20.0506%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   2, Avg loss: 0.0369, Accuracy: 511/1581 (32.3213%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3405, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 235/690 (34.0580%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.7832, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   1, Avg loss: 0.1118, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   2, Avg loss: 0.0727, Accuracy: 50/271 (18.4502%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7424, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   1, Avg loss: 0.0933, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   2, Avg loss: 0.0516, Accuracy: 117/312 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.3621, Accuracy: 51/10000 (0.5100%)
time spent on training: 174.39361357688904
[rfa agg] training data poison_ratio: 0.0  data num: [408, 515, 1662, 1129, 197, 1949, 1581, 690, 271, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 33, 94, 37, 79, 21, 28, 25, 35, 24], weight: tensor([0.0468, 0.0591, 0.1907, 0.1296, 0.0226, 0.2237, 0.1814, 0.0792, 0.0311,
        0.0358])
[rfa agg] iter:  0, prev_obj_val: 81.25305938720703, obj_val: 82.1361312866211, abs dis: 0.8830718994140625
[rfa agg] iter: 0, weight: tensor([0.0284, 0.0426, 0.1693, 0.3327, 0.0107, 0.1243, 0.1851, 0.0726, 0.0160,
        0.0184])
[rfa agg] iter:  1, prev_obj_val: 82.1361312866211, obj_val: 83.50994873046875, abs dis: 1.3738174438476562
[rfa agg] iter: 1, weight: tensor([0.0271, 0.0409, 0.1465, 0.4038, 0.0101, 0.1092, 0.1591, 0.0708, 0.0151,
        0.0174])
[rfa agg] iter:  2, prev_obj_val: 83.50994873046875, obj_val: 82.07585906982422, abs dis: 1.4340896606445312
[rfa agg] iter: 2, weight: tensor([0.0277, 0.0421, 0.1354, 0.4291, 0.0102, 0.1030, 0.1457, 0.0739, 0.0153,
        0.0177])
[rfa agg] iter:  3, prev_obj_val: 82.07585906982422, obj_val: 80.83027648925781, abs dis: 1.2455825805664062
[rfa agg] iter: 3, weight: tensor([0.0253, 0.0382, 0.1361, 0.4450, 0.0094, 0.1020, 0.1475, 0.0661, 0.0141,
        0.0163])
[rfa agg] iter:  4, prev_obj_val: 80.83027648925781, obj_val: 82.07528686523438, abs dis: 1.2450103759765625
[rfa agg] iter: 4, weight: tensor([0.0241, 0.0362, 0.1429, 0.4359, 0.0091, 0.1051, 0.1560, 0.0616, 0.0135,
        0.0156])
[rfa agg] iter:  5, prev_obj_val: 82.07528686523438, obj_val: 80.8304214477539, abs dis: 1.2448654174804688
[rfa agg] iter: 5, weight: tensor([0.0252, 0.0381, 0.1360, 0.4461, 0.0094, 0.1018, 0.1473, 0.0658, 0.0141,
        0.0162])
[rfa agg] iter:  6, prev_obj_val: 80.8304214477539, obj_val: 82.07520294189453, abs dis: 1.244781494140625
[rfa agg] iter: 6, weight: tensor([0.0241, 0.0361, 0.1428, 0.4363, 0.0090, 0.1050, 0.1559, 0.0615, 0.0135,
        0.0156])
[rfa agg] iter:  7, prev_obj_val: 82.07520294189453, obj_val: 80.83045959472656, abs dis: 1.2447433471679688
[rfa agg] iter: 7, weight: tensor([0.0252, 0.0381, 0.1359, 0.4463, 0.0094, 0.1017, 0.1473, 0.0658, 0.0141,
        0.0162])
[rfa agg] iter:  8, prev_obj_val: 80.83045959472656, obj_val: 82.07518768310547, abs dis: 1.2447280883789062
[rfa agg] iter: 8, weight: tensor([0.0241, 0.0361, 0.1428, 0.4364, 0.0090, 0.1050, 0.1559, 0.0615, 0.0135,
        0.0156])
[rfa agg] iter:  9, prev_obj_val: 82.07518768310547, obj_val: 80.8304672241211, abs dis: 1.244720458984375
[rfa agg] iter: 9, weight: tensor([0.0252, 0.0381, 0.1359, 0.4464, 0.0094, 0.1017, 0.1473, 0.0658, 0.0141,
        0.0162])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9876, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.1926, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.8356685638428 sec.
Server Epoch:60 choose agents : [73, 88, 6, 42, 22, 24, 95, 80, 57, 30].
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0686, Accuracy: 171/938 (18.2303%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0365, Accuracy: 317/938 (33.7953%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.9933, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0816, Accuracy: 87/603 (14.4279%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0477, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5745, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   1, Avg loss: 0.0627, Accuracy: 340/1956 (17.3824%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 582/1956 (29.7546%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.8560, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0637, Accuracy: 250/1372 (18.2216%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0345, Accuracy: 478/1372 (34.8397%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4788, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   1, Avg loss: 0.0573, Accuracy: 398/1470 (27.0748%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 818/1470 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.0993, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0950, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0514, Accuracy: 123/312 (39.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.0873, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 279/599 (46.5776%)
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.0479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   1, Avg loss: 0.0739, Accuracy: 76/682 (11.1437%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   2, Avg loss: 0.0392, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.5685, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   1, Avg loss: 0.0625, Accuracy: 247/1154 (21.4038%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 484/1154 (41.9411%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.8326, Accuracy: 77/10000 (0.7700%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   1, Avg loss: 0.0937, Accuracy: 41/486 (8.4362%)
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   2, Avg loss: 0.0437, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8523, Accuracy: 50/10000 (0.5000%)
time spent on training: 223.4775824546814
[rfa agg] training data poison_ratio: 0.11335144170497284  data num: [938, 603, 1956, 1372, 1470, 312, 599, 682, 1154, 486]
[rfa agg] considering poison per batch poison_fraction: 0.035422325532804014
[rfa agg] init. name: [73, 88, 6, 42, 22, 24, 95, 80, 57, 30], weight: tensor([0.0980, 0.0630, 0.2043, 0.1433, 0.1536, 0.0326, 0.0626, 0.0712, 0.1206,
        0.0508])
[rfa agg] iter:  0, prev_obj_val: 69.91264343261719, obj_val: 71.69330596923828, abs dis: 1.7806625366210938
[rfa agg] iter: 0, weight: tensor([0.1965, 0.0538, 0.0895, 0.1580, 0.1444, 0.0163, 0.0527, 0.0701, 0.1847,
        0.0341])
[rfa agg] iter:  1, prev_obj_val: 71.69330596923828, obj_val: 72.83084869384766, abs dis: 1.137542724609375
[rfa agg] iter: 1, weight: tensor([0.2484, 0.0598, 0.0807, 0.1321, 0.1232, 0.0171, 0.0583, 0.0791, 0.1647,
        0.0366])
[rfa agg] iter:  2, prev_obj_val: 72.83084869384766, obj_val: 74.13018035888672, abs dis: 1.2993316650390625
[rfa agg] iter: 2, weight: tensor([0.2805, 0.0631, 0.0761, 0.1197, 0.1127, 0.0174, 0.0614, 0.0844, 0.1468,
        0.0378])
[rfa agg] iter:  3, prev_obj_val: 74.13018035888672, obj_val: 75.59632873535156, abs dis: 1.4661483764648438
[rfa agg] iter: 3, weight: tensor([0.2994, 0.0673, 0.0725, 0.1100, 0.1044, 0.0178, 0.0654, 0.0913, 0.1324,
        0.0395])
[rfa agg] iter:  4, prev_obj_val: 75.59632873535156, obj_val: 77.21959686279297, abs dis: 1.6232681274414062
[rfa agg] iter: 4, weight: tensor([0.2988, 0.0735, 0.0702, 0.1033, 0.0986, 0.0186, 0.0713, 0.1012, 0.1223,
        0.0421])
[rfa agg] iter:  5, prev_obj_val: 77.21959686279297, obj_val: 77.21406555175781, abs dis: 0.00553131103515625
[rfa agg] iter: 5, weight: tensor([0.2776, 0.0824, 0.0693, 0.0991, 0.0951, 0.0199, 0.0796, 0.1155, 0.1155,
        0.0460])
[rfa agg] iter:  6, prev_obj_val: 77.21406555175781, obj_val: 77.21398162841797, abs dis: 8.392333984375e-05
[rfa agg] iter: 6, weight: tensor([0.2737, 0.0831, 0.0695, 0.0994, 0.0954, 0.0200, 0.0802, 0.1169, 0.1155,
        0.0462])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.9826, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 3.6378, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 378.2318994998932 sec.
Server Epoch:61 choose agents : [54, 10, 57, 79, 45, 65, 13, 58, 75, 12].
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0579, Accuracy: 298/1130 (26.3717%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 465/1130 (41.1504%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.8074, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   1, Avg loss: 0.0660, Accuracy: 119/861 (13.8211%)
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 444/861 (51.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.8387, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   1, Avg loss: 0.0652, Accuracy: 245/1154 (21.2305%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   2, Avg loss: 0.0279, Accuracy: 482/1154 (41.7678%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.7104, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1160, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0926, Accuracy: 14/197 (7.1066%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7238, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   1, Avg loss: 0.0766, Accuracy: 122/669 (18.2362%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   2, Avg loss: 0.0431, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5402, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   1, Avg loss: 0.0617, Accuracy: 332/1475 (22.5085%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   2, Avg loss: 0.0358, Accuracy: 586/1475 (39.7288%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5221, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   1, Avg loss: 0.0655, Accuracy: 253/1645 (15.3799%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   2, Avg loss: 0.0354, Accuracy: 545/1645 (33.1307%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.3854, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   1, Avg loss: 0.0640, Accuracy: 261/803 (32.5031%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   2, Avg loss: 0.0374, Accuracy: 421/803 (52.4284%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2437, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   1, Avg loss: 0.0726, Accuracy: 187/776 (24.0979%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.3478, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0932, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0536, Accuracy: 119/338 (35.2071%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.2638, Accuracy: 51/10000 (0.5100%)
time spent on training: 210.61704301834106
[rfa agg] training data poison_ratio: 0.09515915119363395  data num: [1130, 861, 1154, 197, 669, 1475, 1645, 803, 776, 338]
[rfa agg] considering poison per batch poison_fraction: 0.02973723474801061
[rfa agg] init. name: [54, 10, 57, 79, 45, 65, 13, 58, 75, 12], weight: tensor([0.1249, 0.0952, 0.1275, 0.0218, 0.0739, 0.1630, 0.1818, 0.0887, 0.0858,
        0.0374])
[rfa agg] iter:  0, prev_obj_val: 57.65217208862305, obj_val: 59.59529113769531, abs dis: 1.9431190490722656
[rfa agg] iter: 0, weight: tensor([0.1843, 0.1612, 0.1283, 0.0088, 0.0720, 0.0902, 0.0831, 0.1305, 0.1229,
        0.0187])
[rfa agg] iter:  1, prev_obj_val: 59.59529113769531, obj_val: 62.723236083984375, abs dis: 3.1279449462890625
[rfa agg] iter: 1, weight: tensor([0.1424, 0.1934, 0.1042, 0.0088, 0.0809, 0.0753, 0.0703, 0.1611, 0.1444,
        0.0192])
[rfa agg] iter:  2, prev_obj_val: 62.723236083984375, obj_val: 60.98426055908203, abs dis: 1.7389755249023438
[rfa agg] iter: 2, weight: tensor([0.1106, 0.1942, 0.0862, 0.0091, 0.0950, 0.0654, 0.0619, 0.1936, 0.1636,
        0.0204])
[rfa agg] iter:  3, prev_obj_val: 60.98426055908203, obj_val: 62.701683044433594, abs dis: 1.7174224853515625
[rfa agg] iter: 3, weight: tensor([0.1201, 0.2017, 0.0913, 0.0088, 0.0862, 0.0681, 0.0641, 0.1844, 0.1560,
        0.0193])
[rfa agg] iter:  4, prev_obj_val: 62.701683044433594, obj_val: 60.985042572021484, abs dis: 1.7166404724121094
[rfa agg] iter: 4, weight: tensor([0.1088, 0.1954, 0.0849, 0.0091, 0.0944, 0.0646, 0.0612, 0.1978, 0.1636,
        0.0202])
[rfa agg] iter:  5, prev_obj_val: 60.985042572021484, obj_val: 62.701595306396484, abs dis: 1.716552734375
[rfa agg] iter: 5, weight: tensor([0.1200, 0.2020, 0.0911, 0.0088, 0.0861, 0.0680, 0.0641, 0.1850, 0.1557,
        0.0193])
[rfa agg] iter:  6, prev_obj_val: 62.701595306396484, obj_val: 60.985050201416016, abs dis: 1.7165451049804688
[rfa agg] iter: 6, weight: tensor([0.1088, 0.1955, 0.0849, 0.0091, 0.0944, 0.0646, 0.0612, 0.1979, 0.1635,
        0.0202])
[rfa agg] iter:  7, prev_obj_val: 60.985050201416016, obj_val: 62.701595306396484, abs dis: 1.7165451049804688
[rfa agg] iter: 7, weight: tensor([0.1199, 0.2020, 0.0911, 0.0088, 0.0861, 0.0680, 0.0640, 0.1851, 0.1557,
        0.0193])
[rfa agg] iter:  8, prev_obj_val: 62.701595306396484, obj_val: 60.98504638671875, abs dis: 1.7165489196777344
[rfa agg] iter: 8, weight: tensor([0.1088, 0.1955, 0.0849, 0.0091, 0.0944, 0.0646, 0.0612, 0.1979, 0.1635,
        0.0202])
[rfa agg] iter:  9, prev_obj_val: 60.98504638671875, obj_val: 62.701595306396484, abs dis: 1.7165489196777344
[rfa agg] iter: 9, weight: tensor([0.1199, 0.2020, 0.0911, 0.0088, 0.0861, 0.0680, 0.0640, 0.1851, 0.1557,
        0.0193])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.9918, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 3.4297, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.4248266220093 sec.
Server Epoch:62 choose agents : [89, 55, 54, 26, 40, 6, 59, 57, 13, 73].
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   1, Avg loss: 0.0622, Accuracy: 314/896 (35.0446%)
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   2, Avg loss: 0.0356, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2129, Accuracy: 52/10000 (0.5200%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   1, Avg loss: 0.0609, Accuracy: 203/1071 (18.9542%)
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   2, Avg loss: 0.0308, Accuracy: 480/1071 (44.8179%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.7136, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   1, Avg loss: 0.0593, Accuracy: 284/1130 (25.1327%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 438/1130 (38.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.1601, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   1, Avg loss: 0.0568, Accuracy: 291/1446 (20.1245%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2403, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   1, Avg loss: 0.0682, Accuracy: 246/1573 (15.6389%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   2, Avg loss: 0.0381, Accuracy: 521/1573 (33.1214%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1700, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   1, Avg loss: 0.0635, Accuracy: 295/1956 (15.0818%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 550/1956 (28.1186%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0340, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0605, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0333, Accuracy: 446/1089 (40.9550%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.4944, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   1, Avg loss: 0.0621, Accuracy: 257/1154 (22.2704%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   2, Avg loss: 0.0277, Accuracy: 482/1154 (41.7678%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.7410, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0651, Accuracy: 245/1645 (14.8936%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0365, Accuracy: 493/1645 (29.9696%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0963, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   2, Avg loss: 0.0366, Accuracy: 327/938 (34.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6745, Accuracy: 77/10000 (0.7700%)
time spent on training: 239.36213564872742
[rfa agg] training data poison_ratio: 0.08303612963250116  data num: [896, 1071, 1130, 1446, 1573, 1956, 1089, 1154, 1645, 938]
[rfa agg] considering poison per batch poison_fraction: 0.025948790510156614
[rfa agg] init. name: [89, 55, 54, 26, 40, 6, 59, 57, 13, 73], weight: tensor([0.0695, 0.0830, 0.0876, 0.1121, 0.1220, 0.1517, 0.0844, 0.0895, 0.1275,
        0.0727])
[rfa agg] iter:  0, prev_obj_val: 55.51771545410156, obj_val: 58.225990295410156, abs dis: 2.7082748413085938
[rfa agg] iter: 0, weight: tensor([0.0570, 0.1067, 0.1516, 0.1393, 0.1113, 0.0710, 0.0688, 0.1267, 0.0983,
        0.0693])
[rfa agg] iter:  1, prev_obj_val: 58.225990295410156, obj_val: 61.30219268798828, abs dis: 3.076202392578125
[rfa agg] iter: 1, weight: tensor([0.0675, 0.1325, 0.1959, 0.1043, 0.0854, 0.0589, 0.0665, 0.1272, 0.0772,
        0.0845])
[rfa agg] iter:  2, prev_obj_val: 61.30219268798828, obj_val: 59.5943489074707, abs dis: 1.7078437805175781
[rfa agg] iter: 2, weight: tensor([0.0797, 0.1498, 0.2042, 0.0875, 0.0743, 0.0537, 0.0650, 0.1158, 0.0680,
        0.1020])
[rfa agg] iter:  3, prev_obj_val: 59.5943489074707, obj_val: 63.2686653137207, abs dis: 3.67431640625
[rfa agg] iter: 3, weight: tensor([0.0725, 0.1447, 0.2119, 0.0924, 0.0779, 0.0551, 0.0645, 0.1181, 0.0706,
        0.0924])
[rfa agg] iter:  4, prev_obj_val: 63.2686653137207, obj_val: 61.28818130493164, abs dis: 1.9804840087890625
[rfa agg] iter: 4, weight: tensor([0.0890, 0.1564, 0.1946, 0.0823, 0.0709, 0.0524, 0.0649, 0.1094, 0.0653,
        0.1147])
[rfa agg] iter:  5, prev_obj_val: 61.28818130493164, obj_val: 61.28573226928711, abs dis: 0.00244903564453125
[rfa agg] iter: 5, weight: tensor([0.0801, 0.1542, 0.2048, 0.0863, 0.0737, 0.0533, 0.0644, 0.1126, 0.0673,
        0.1034])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 13.7756, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 21.4024, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.5298433303833 sec.
Server Epoch:63 choose agents : [88, 83, 25, 86, 4, 32, 99, 35, 73, 64].
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   1, Avg loss: 0.0773, Accuracy: 92/603 (15.2570%)
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   2, Avg loss: 0.0495, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.0658, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   1, Avg loss: 0.0669, Accuracy: 330/1953 (16.8971%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   2, Avg loss: 0.0367, Accuracy: 634/1953 (32.4629%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2124, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0574, Accuracy: 235/690 (34.0580%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.6286, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   1, Avg loss: 0.0604, Accuracy: 292/1003 (29.1127%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5468, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0729, Accuracy: 247/901 (27.4140%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0367, Accuracy: 389/901 (43.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5739, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   1, Avg loss: 0.0627, Accuracy: 124/735 (16.8707%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.7142, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0593, Accuracy: 222/773 (28.7193%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 442/773 (57.1798%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.0621, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1170, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0773, Accuracy: 53/271 (19.5572%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1205, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   1, Avg loss: 0.0687, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   2, Avg loss: 0.0364, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.0432, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0731, Accuracy: 107/953 (11.2277%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0391, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6732, Accuracy: 72/10000 (0.7200%)
time spent on training: 193.33682775497437
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1953, 690, 1003, 901, 735, 773, 271, 938, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 83, 25, 86, 4, 32, 99, 35, 73, 64], weight: tensor([0.0684, 0.2214, 0.0782, 0.1137, 0.1022, 0.0833, 0.0876, 0.0307, 0.1063,
        0.1080])
[rfa agg] iter:  0, prev_obj_val: 57.433692932128906, obj_val: 63.50177764892578, abs dis: 6.068084716796875
[rfa agg] iter: 0, weight: tensor([0.0450, 0.0542, 0.0593, 0.1806, 0.1333, 0.0786, 0.0858, 0.0107, 0.1655,
        0.1870])
[rfa agg] iter:  1, prev_obj_val: 63.50177764892578, obj_val: 68.20137023925781, abs dis: 4.699592590332031
[rfa agg] iter: 1, weight: tensor([0.0959, 0.0465, 0.1224, 0.1025, 0.1016, 0.1621, 0.1124, 0.0159, 0.1165,
        0.1242])
[rfa agg] iter:  2, prev_obj_val: 68.20137023925781, obj_val: 68.16674041748047, abs dis: 0.03462982177734375
[rfa agg] iter: 2, weight: tensor([0.1342, 0.0457, 0.1555, 0.0869, 0.0871, 0.1691, 0.1048, 0.0187, 0.0965,
        0.1015])
[rfa agg] iter:  3, prev_obj_val: 68.16674041748047, obj_val: 71.08247375488281, abs dis: 2.9157333374023438
[rfa agg] iter: 3, weight: tensor([0.1382, 0.0450, 0.1623, 0.0852, 0.0852, 0.1695, 0.1026, 0.0185, 0.0944,
        0.0992])
[rfa agg] iter:  4, prev_obj_val: 71.08247375488281, obj_val: 71.07811737060547, abs dis: 0.00435638427734375
[rfa agg] iter: 4, weight: tensor([0.1611, 0.0461, 0.1668, 0.0825, 0.0825, 0.1561, 0.0990, 0.0207, 0.0905,
        0.0946])
[rfa agg] iter:  5, prev_obj_val: 71.07811737060547, obj_val: 71.07798767089844, abs dis: 0.00012969970703125
[rfa agg] iter: 5, weight: tensor([0.1650, 0.0459, 0.1677, 0.0821, 0.0820, 0.1541, 0.0983, 0.0206, 0.0900,
        0.0941])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0028, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 3.2757, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.7012457847595 sec.
Server Epoch:64 choose agents : [19, 68, 40, 0, 59, 96, 62, 63, 70, 81].
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   1, Avg loss: 0.0600, Accuracy: 288/1036 (27.7992%)
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 633/1036 (61.1004%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 13.1645, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   1, Avg loss: 0.0728, Accuracy: 235/1163 (20.2064%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   2, Avg loss: 0.0393, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.0298, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   1, Avg loss: 0.0661, Accuracy: 272/1573 (17.2918%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   2, Avg loss: 0.0379, Accuracy: 535/1573 (34.0114%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2408, Accuracy: 73/10000 (0.7300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   1, Avg loss: 0.0622, Accuracy: 303/1657 (18.2861%)
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   2, Avg loss: 0.0376, Accuracy: 449/1657 (27.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7666, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   1, Avg loss: 0.0588, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 451/1089 (41.4141%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1469, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   1, Avg loss: 0.0927, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   2, Avg loss: 0.0621, Accuracy: 91/311 (29.2605%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   1, Avg loss: 0.0665, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   2, Avg loss: 0.0421, Accuracy: 259/568 (45.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1878, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0591, Accuracy: 188/888 (21.1712%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0270, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.0813, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0659, Accuracy: 284/1418 (20.0282%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 557/1418 (39.2807%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.6716, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0839, Accuracy: 89/774 (11.4987%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0408, Accuracy: 340/774 (43.9276%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.7626, Accuracy: 52/10000 (0.5200%)
time spent on training: 248.2926230430603
[rfa agg] training data poison_ratio: 0.15815596067576596  data num: [1036, 1163, 1573, 1657, 1089, 311, 568, 888, 1418, 774]
[rfa agg] considering poison per batch poison_fraction: 0.04942373771117686
[rfa agg] init. name: [19, 68, 40, 0, 59, 96, 62, 63, 70, 81], weight: tensor([0.0989, 0.1110, 0.1501, 0.1582, 0.1039, 0.0297, 0.0542, 0.0848, 0.1353,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 56.34543991088867, obj_val: 57.61490249633789, abs dis: 1.2694625854492188
[rfa agg] iter: 0, weight: tensor([0.2073, 0.1696, 0.0901, 0.0856, 0.1086, 0.0120, 0.0334, 0.1115, 0.1046,
        0.0772])
[rfa agg] iter:  1, prev_obj_val: 57.61490249633789, obj_val: 57.609153747558594, abs dis: 0.005748748779296875
[rfa agg] iter: 1, weight: tensor([0.2232, 0.1580, 0.0838, 0.0802, 0.1052, 0.0123, 0.0350, 0.1229, 0.0962,
        0.0833])
[rfa agg] iter:  2, prev_obj_val: 57.609153747558594, obj_val: 59.27526092529297, abs dis: 1.666107177734375
[rfa agg] iter: 2, weight: tensor([0.2273, 0.1561, 0.0834, 0.0798, 0.1043, 0.0122, 0.0349, 0.1231, 0.0956,
        0.0832])
[rfa agg] iter:  3, prev_obj_val: 59.27526092529297, obj_val: 59.2711296081543, abs dis: 0.004131317138671875
[rfa agg] iter: 3, weight: tensor([0.2173, 0.1448, 0.0811, 0.0779, 0.1031, 0.0130, 0.0381, 0.1398, 0.0919,
        0.0930])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 16.1833, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 25.8710, Accuracy: 0/9950 (0.0000%)
saving model
Done in 403.62132143974304 sec.
Server Epoch:65 choose agents : [82, 14, 61, 68, 51, 24, 76, 37, 34, 80].
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0856, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0528, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6164, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0792, Accuracy: 111/1013 (10.9576%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0380, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.2842, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1437, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1364, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3083, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0718, Accuracy: 247/1163 (21.2382%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0384, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3836, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   1, Avg loss: 0.0704, Accuracy: 158/1049 (15.0620%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   2, Avg loss: 0.0337, Accuracy: 452/1049 (43.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.3177, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   1, Avg loss: 0.0850, Accuracy: 5/312 (1.6026%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   2, Avg loss: 0.0467, Accuracy: 133/312 (42.6282%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5266, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0832, Accuracy: 24/466 (5.1502%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7038, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 365/1129 (32.3295%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0273, Accuracy: 679/1129 (60.1417%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.2184, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   1, Avg loss: 0.0616, Accuracy: 327/1427 (22.9152%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   2, Avg loss: 0.0350, Accuracy: 538/1427 (37.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2139, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0721, Accuracy: 75/682 (10.9971%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0389, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.7404, Accuracy: 61/10000 (0.6100%)
time spent on training: 182.44183492660522
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1013, 85, 1163, 1049, 312, 466, 1129, 1427, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 14, 61, 68, 51, 24, 76, 37, 34, 80], weight: tensor([0.0639, 0.1294, 0.0109, 0.1486, 0.1340, 0.0399, 0.0595, 0.1443, 0.1823,
        0.0871])
[rfa agg] iter:  0, prev_obj_val: 52.94260787963867, obj_val: 54.5383186340332, abs dis: 1.5957107543945312
[rfa agg] iter: 0, weight: tensor([0.0517, 0.2065, 0.0041, 0.1337, 0.1569, 0.0213, 0.0474, 0.1544, 0.1007,
        0.1233])
[rfa agg] iter:  1, prev_obj_val: 54.5383186340332, obj_val: 54.533477783203125, abs dis: 0.004840850830078125
[rfa agg] iter: 1, weight: tensor([0.0569, 0.2005, 0.0043, 0.1264, 0.1509, 0.0228, 0.0519, 0.1458, 0.0974,
        0.1430])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.8195, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 19.0301, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.63836121559143 sec.
Server Epoch:66 choose agents : [29, 39, 13, 16, 89, 32, 70, 78, 86, 12].
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   1, Avg loss: 0.0534, Accuracy: 392/1440 (27.2222%)
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 693/1440 (48.1250%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.8800, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   1, Avg loss: 0.0555, Accuracy: 252/1013 (24.8766%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   2, Avg loss: 0.0303, Accuracy: 476/1013 (46.9891%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.6742, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   1, Avg loss: 0.0655, Accuracy: 236/1645 (14.3465%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   2, Avg loss: 0.0361, Accuracy: 511/1645 (31.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0420, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   1, Avg loss: 0.0626, Accuracy: 214/708 (30.2260%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.6069, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0627, Accuracy: 312/896 (34.8214%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0365, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1641, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   1, Avg loss: 0.0639, Accuracy: 141/735 (19.1837%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 371/735 (50.4762%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 13.3010, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0657, Accuracy: 278/1418 (19.6051%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0343, Accuracy: 577/1418 (40.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8171, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0886, Accuracy: 12/416 (2.8846%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0486, Accuracy: 172/416 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7497, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 286/1003 (28.5145%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 373/1003 (37.1884%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.3071, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   1, Avg loss: 0.0926, Accuracy: 5/338 (1.4793%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   2, Avg loss: 0.0538, Accuracy: 125/338 (36.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.1148, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.5725221633911
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 1013, 1645, 708, 896, 735, 1418, 416, 1003, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 39, 13, 16, 89, 32, 70, 78, 86, 12], weight: tensor([0.1498, 0.1054, 0.1711, 0.0737, 0.0932, 0.0765, 0.1475, 0.0433, 0.1043,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 59.7237548828125, obj_val: 60.818260192871094, abs dis: 1.0945053100585938
[rfa agg] iter: 0, weight: tensor([0.0853, 0.1930, 0.0724, 0.0850, 0.1497, 0.1004, 0.0828, 0.0248, 0.1888,
        0.0178])
[rfa agg] iter:  1, prev_obj_val: 60.818260192871094, obj_val: 64.51875305175781, abs dis: 3.7004928588867188
[rfa agg] iter: 1, weight: tensor([0.0774, 0.1860, 0.0664, 0.0899, 0.1636, 0.1103, 0.0756, 0.0254, 0.1871,
        0.0181])
[rfa agg] iter:  2, prev_obj_val: 64.51875305175781, obj_val: 66.6793212890625, abs dis: 2.1605682373046875
[rfa agg] iter: 2, weight: tensor([0.0731, 0.1543, 0.0642, 0.1104, 0.1739, 0.1465, 0.0715, 0.0300, 0.1551,
        0.0211])
[rfa agg] iter:  3, prev_obj_val: 66.6793212890625, obj_val: 64.49397277832031, abs dis: 2.1853485107421875
[rfa agg] iter: 3, weight: tensor([0.0709, 0.1382, 0.0628, 0.1228, 0.1708, 0.1712, 0.0693, 0.0327, 0.1386,
        0.0227])
[rfa agg] iter:  4, prev_obj_val: 64.49397277832031, obj_val: 66.67546844482422, abs dis: 2.1814956665039062
[rfa agg] iter: 4, weight: tensor([0.0726, 0.1491, 0.0638, 0.1143, 0.1762, 0.1526, 0.0709, 0.0300, 0.1496,
        0.0210])
[rfa agg] iter:  5, prev_obj_val: 66.67546844482422, obj_val: 64.49431610107422, abs dis: 2.18115234375
[rfa agg] iter: 5, weight: tensor([0.0708, 0.1377, 0.0628, 0.1233, 0.1711, 0.1719, 0.0692, 0.0327, 0.1380,
        0.0227])
[rfa agg] iter:  6, prev_obj_val: 64.49431610107422, obj_val: 66.6754379272461, abs dis: 2.181121826171875
[rfa agg] iter: 6, weight: tensor([0.0726, 0.1490, 0.0638, 0.1143, 0.1763, 0.1526, 0.0709, 0.0300, 0.1496,
        0.0210])
[rfa agg] iter:  7, prev_obj_val: 66.6754379272461, obj_val: 64.49433135986328, abs dis: 2.1811065673828125
[rfa agg] iter: 7, weight: tensor([0.0708, 0.1377, 0.0628, 0.1233, 0.1711, 0.1719, 0.0692, 0.0327, 0.1380,
        0.0227])
[rfa agg] iter:  8, prev_obj_val: 64.49433135986328, obj_val: 66.67543029785156, abs dis: 2.1810989379882812
[rfa agg] iter: 8, weight: tensor([0.0726, 0.1490, 0.0638, 0.1143, 0.1763, 0.1526, 0.0709, 0.0300, 0.1496,
        0.0210])
[rfa agg] iter:  9, prev_obj_val: 66.67543029785156, obj_val: 64.49432373046875, abs dis: 2.1811065673828125
[rfa agg] iter: 9, weight: tensor([0.0708, 0.1377, 0.0628, 0.1233, 0.1711, 0.1719, 0.0692, 0.0327, 0.1380,
        0.0227])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0336, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 3.8581, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.57534408569336 sec.
Server Epoch:67 choose agents : [94, 66, 0, 19, 86, 99, 97, 78, 7, 76].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0687, Accuracy: 273/1662 (16.4260%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0363, Accuracy: 522/1662 (31.4079%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.0283, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   1, Avg loss: 0.0723, Accuracy: 170/1402 (12.1255%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   2, Avg loss: 0.0406, Accuracy: 354/1402 (25.2496%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4549, Accuracy: 74/10000 (0.7400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   1, Avg loss: 0.0609, Accuracy: 310/1657 (18.7085%)
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   2, Avg loss: 0.0376, Accuracy: 478/1657 (28.8473%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9005, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0582, Accuracy: 299/1036 (28.8610%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0275, Accuracy: 639/1036 (61.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 13.0847, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0611, Accuracy: 294/1003 (29.3121%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 408/1003 (40.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1423, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   1, Avg loss: 0.0568, Accuracy: 228/773 (29.4955%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.1227, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   1, Avg loss: 0.0676, Accuracy: 285/1213 (23.4955%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 484/1213 (39.9011%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.2305, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0889, Accuracy: 15/416 (3.6058%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0491, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5802, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   1, Avg loss: 0.0699, Accuracy: 201/891 (22.5589%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   2, Avg loss: 0.0295, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.2003, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 22/466 (4.7210%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 173/466 (37.1245%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4649, Accuracy: 54/10000 (0.5400%)
time spent on training: 238.35816407203674
[rfa agg] training data poison_ratio: 0.1575244795132617  data num: [1662, 1402, 1657, 1036, 1003, 773, 1213, 416, 891, 466]
[rfa agg] considering poison per batch poison_fraction: 0.04922639984789429
[rfa agg] init. name: [94, 66, 0, 19, 86, 99, 97, 78, 7, 76], weight: tensor([0.1580, 0.1333, 0.1575, 0.0985, 0.0954, 0.0735, 0.1153, 0.0395, 0.0847,
        0.0443])
[rfa agg] iter:  0, prev_obj_val: 55.41679382324219, obj_val: 59.53830337524414, abs dis: 4.121509552001953
[rfa agg] iter: 0, weight: tensor([0.0792, 0.1107, 0.0797, 0.1730, 0.1856, 0.0676, 0.1586, 0.0182, 0.1049,
        0.0225])
[rfa agg] iter:  1, prev_obj_val: 59.53830337524414, obj_val: 61.47761535644531, abs dis: 1.9393119812011719
[rfa agg] iter: 1, weight: tensor([0.0676, 0.0887, 0.0679, 0.1604, 0.2152, 0.0840, 0.1226, 0.0209, 0.1466,
        0.0261])
[rfa agg] iter:  2, prev_obj_val: 61.47761535644531, obj_val: 63.6903190612793, abs dis: 2.2127037048339844
[rfa agg] iter: 2, weight: tensor([0.0657, 0.0844, 0.0659, 0.1468, 0.2101, 0.0927, 0.1126, 0.0224, 0.1713,
        0.0281])
[rfa agg] iter:  3, prev_obj_val: 63.6903190612793, obj_val: 61.47431182861328, abs dis: 2.2160072326660156
[rfa agg] iter: 3, weight: tensor([0.0649, 0.0818, 0.0651, 0.1358, 0.1924, 0.1027, 0.1067, 0.0245, 0.1954,
        0.0308])
[rfa agg] iter:  4, prev_obj_val: 61.47431182861328, obj_val: 61.4702033996582, abs dis: 0.004108428955078125
[rfa agg] iter: 4, weight: tensor([0.0654, 0.0839, 0.0656, 0.1436, 0.2062, 0.0939, 0.1118, 0.0223, 0.1794,
        0.0280])
[rfa agg] iter:  5, prev_obj_val: 61.4702033996582, obj_val: 63.68855667114258, abs dis: 2.218353271484375
[rfa agg] iter: 5, weight: tensor([0.0654, 0.0840, 0.0656, 0.1444, 0.2087, 0.0931, 0.1119, 0.0223, 0.1766,
        0.0280])
[rfa agg] iter:  6, prev_obj_val: 63.68855667114258, obj_val: 61.47454833984375, abs dis: 2.214008331298828
[rfa agg] iter: 6, weight: tensor([0.0648, 0.0817, 0.0650, 0.1355, 0.1921, 0.1026, 0.1065, 0.0244, 0.1964,
        0.0308])
[rfa agg] iter:  7, prev_obj_val: 61.47454833984375, obj_val: 61.47021484375, abs dis: 0.00433349609375
[rfa agg] iter: 7, weight: tensor([0.0653, 0.0839, 0.0656, 0.1435, 0.2061, 0.0939, 0.1117, 0.0223, 0.1795,
        0.0280])
[rfa agg] iter:  8, prev_obj_val: 61.47021484375, obj_val: 63.688541412353516, abs dis: 2.2183265686035156
[rfa agg] iter: 8, weight: tensor([0.0654, 0.0840, 0.0656, 0.1444, 0.2087, 0.0931, 0.1119, 0.0223, 0.1766,
        0.0280])
[rfa agg] iter:  9, prev_obj_val: 63.688541412353516, obj_val: 61.47455596923828, abs dis: 2.2139854431152344
[rfa agg] iter: 9, weight: tensor([0.0648, 0.0817, 0.0650, 0.1355, 0.1921, 0.1026, 0.1065, 0.0244, 0.1964,
        0.0308])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.0273, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 3.7597, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.1990268230438 sec.
Server Epoch:68 choose agents : [47, 88, 74, 60, 6, 79, 68, 41, 15, 82].
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   1, Avg loss: 0.1385, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   2, Avg loss: 0.1276, Accuracy: 6/134 (4.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7129, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0762, Accuracy: 110/603 (18.2421%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.8434, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   1, Avg loss: 0.0508, Accuracy: 376/1552 (24.2268%)
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   2, Avg loss: 0.0233, Accuracy: 725/1552 (46.7139%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.8398, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0568, Accuracy: 465/2227 (20.8801%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0308, Accuracy: 909/2227 (40.8172%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9297, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   1, Avg loss: 0.0617, Accuracy: 312/1956 (15.9509%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   2, Avg loss: 0.0353, Accuracy: 598/1956 (30.5726%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.8955, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   1, Avg loss: 0.1123, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   2, Avg loss: 0.0910, Accuracy: 12/197 (6.0914%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.1513, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   1, Avg loss: 0.0706, Accuracy: 246/1163 (21.1522%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   2, Avg loss: 0.0386, Accuracy: 444/1163 (38.1771%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3541, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   1, Avg loss: 0.0669, Accuracy: 243/719 (33.7969%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   2, Avg loss: 0.0355, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.3926, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   1, Avg loss: 0.0620, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.2489, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0837, Accuracy: 22/500 (4.4000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0524, Accuracy: 188/500 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0357, Accuracy: 56/10000 (0.5600%)
time spent on training: 231.26197338104248
[rfa agg] training data poison_ratio: 0.15208231259186672  data num: [134, 603, 1552, 2227, 1956, 197, 1163, 719, 1154, 500]
[rfa agg] considering poison per batch poison_fraction: 0.047525722684958346
[rfa agg] init. name: [47, 88, 74, 60, 6, 79, 68, 41, 15, 82], weight: tensor([0.0131, 0.0591, 0.1521, 0.2182, 0.1917, 0.0193, 0.1140, 0.0705, 0.1131,
        0.0490])
[rfa agg] iter:  0, prev_obj_val: 83.95720672607422, obj_val: 85.29438018798828, abs dis: 1.3371734619140625
[rfa agg] iter: 0, weight: tensor([0.0049, 0.0367, 0.2360, 0.1138, 0.1387, 0.0077, 0.2119, 0.0516, 0.1727,
        0.0259])
[rfa agg] iter:  1, prev_obj_val: 85.29438018798828, obj_val: 86.29938507080078, abs dis: 1.0050048828125
[rfa agg] iter: 1, weight: tensor([0.0049, 0.0378, 0.1994, 0.1002, 0.1192, 0.0077, 0.2585, 0.0539, 0.1920,
        0.0264])
[rfa agg] iter:  2, prev_obj_val: 86.29938507080078, obj_val: 88.87064361572266, abs dis: 2.571258544921875
[rfa agg] iter: 2, weight: tensor([0.0049, 0.0386, 0.1780, 0.0945, 0.1112, 0.0078, 0.2841, 0.0553, 0.1989,
        0.0268])
[rfa agg] iter:  3, prev_obj_val: 88.87064361572266, obj_val: 88.85896301269531, abs dis: 0.01168060302734375
[rfa agg] iter: 3, weight: tensor([0.0051, 0.0420, 0.1514, 0.0877, 0.1013, 0.0081, 0.3104, 0.0610, 0.2045,
        0.0286])
[rfa agg] iter:  4, prev_obj_val: 88.85896301269531, obj_val: 87.48296356201172, abs dis: 1.3759994506835938
[rfa agg] iter: 4, weight: tensor([0.0050, 0.0415, 0.1490, 0.0867, 0.1001, 0.0080, 0.3174, 0.0603, 0.2035,
        0.0283])
[rfa agg] iter:  5, prev_obj_val: 87.48296356201172, obj_val: 88.85968017578125, abs dis: 1.3767166137695312
[rfa agg] iter: 5, weight: tensor([0.0049, 0.0394, 0.1588, 0.0890, 0.1036, 0.0078, 0.3123, 0.0567, 0.2005,
        0.0271])
[rfa agg] iter:  6, prev_obj_val: 88.85968017578125, obj_val: 87.48290252685547, abs dis: 1.3767776489257812
[rfa agg] iter: 6, weight: tensor([0.0050, 0.0415, 0.1492, 0.0867, 0.1001, 0.0080, 0.3185, 0.0603, 0.2023,
        0.0283])
[rfa agg] iter:  7, prev_obj_val: 87.48290252685547, obj_val: 88.85966491699219, abs dis: 1.3767623901367188
[rfa agg] iter: 7, weight: tensor([0.0049, 0.0394, 0.1587, 0.0889, 0.1036, 0.0078, 0.3128, 0.0567, 0.2001,
        0.0271])
[rfa agg] iter:  8, prev_obj_val: 88.85966491699219, obj_val: 87.48291778564453, abs dis: 1.3767471313476562
[rfa agg] iter: 8, weight: tensor([0.0050, 0.0415, 0.1492, 0.0867, 0.1001, 0.0080, 0.3188, 0.0603, 0.2022,
        0.0283])
[rfa agg] iter:  9, prev_obj_val: 87.48291778564453, obj_val: 88.85967254638672, abs dis: 1.3767547607421875
[rfa agg] iter: 9, weight: tensor([0.0049, 0.0394, 0.1587, 0.0889, 0.1036, 0.0078, 0.3129, 0.0567, 0.2001,
        0.0271])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0192, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 3.8067, Accuracy: 0/9950 (0.0000%)
saving model
Done in 389.3460793495178 sec.
Server Epoch:69 choose agents : [22, 25, 63, 47, 88, 9, 18, 92, 56, 67].
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   1, Avg loss: 0.0535, Accuracy: 379/1470 (25.7823%)
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 799/1470 (54.3537%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.0632, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   1, Avg loss: 0.0599, Accuracy: 224/690 (32.4638%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   2, Avg loss: 0.0310, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.3820, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   1, Avg loss: 0.0600, Accuracy: 179/888 (20.1577%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.3532, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   1, Avg loss: 0.1426, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   2, Avg loss: 0.1251, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0905, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0764, Accuracy: 109/603 (18.0763%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0486, Accuracy: 265/603 (43.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.9445, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   1, Avg loss: 0.0597, Accuracy: 296/1275 (23.2157%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 673/1275 (52.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.0789, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   1, Avg loss: 0.1008, Accuracy: 44/530 (8.3019%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   2, Avg loss: 0.0509, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1321, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   1, Avg loss: 0.0634, Accuracy: 323/1715 (18.8338%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1715 (36.2682%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.8013, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   1, Avg loss: 0.0969, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   2, Avg loss: 0.0789, Accuracy: 8/186 (4.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.5733, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   1, Avg loss: 0.0916, Accuracy: 19/426 (4.4601%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   2, Avg loss: 0.0535, Accuracy: 177/426 (41.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.5845, Accuracy: 46/10000 (0.4600%)
time spent on training: 180.19452452659607
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 690, 888, 134, 603, 1275, 530, 1715, 186, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 25, 63, 47, 88, 9, 18, 92, 56, 67], weight: tensor([0.1857, 0.0872, 0.1122, 0.0169, 0.0762, 0.1610, 0.0669, 0.2166, 0.0235,
        0.0538])
[rfa agg] iter:  0, prev_obj_val: 69.29589080810547, obj_val: 70.63126373291016, abs dis: 1.3353729248046875
[rfa agg] iter: 0, weight: tensor([0.1483, 0.1094, 0.2373, 0.0079, 0.0827, 0.1863, 0.0617, 0.1165, 0.0111,
        0.0389])
[rfa agg] iter:  1, prev_obj_val: 70.63126373291016, obj_val: 71.58059692382812, abs dis: 0.9493331909179688
[rfa agg] iter: 1, weight: tensor([0.1221, 0.1230, 0.2893, 0.0078, 0.0904, 0.1519, 0.0657, 0.0985, 0.0110,
        0.0402])
[rfa agg] iter:  2, prev_obj_val: 71.58059692382812, obj_val: 74.08113098144531, abs dis: 2.5005340576171875
[rfa agg] iter: 2, weight: tensor([0.1109, 0.1313, 0.3085, 0.0078, 0.0955, 0.1349, 0.0683, 0.0910, 0.0109,
        0.0410])
[rfa agg] iter:  3, prev_obj_val: 74.08113098144531, obj_val: 75.55014038085938, abs dis: 1.4690093994140625
[rfa agg] iter: 3, weight: tensor([0.0988, 0.1604, 0.2800, 0.0082, 0.1154, 0.1166, 0.0797, 0.0833, 0.0116,
        0.0460])
[rfa agg] iter:  4, prev_obj_val: 75.55014038085938, obj_val: 75.5348129272461, abs dis: 0.01532745361328125
[rfa agg] iter: 4, weight: tensor([0.0940, 0.1833, 0.2442, 0.0085, 0.1307, 0.1095, 0.0879, 0.0803, 0.0120,
        0.0495])
[rfa agg] iter:  5, prev_obj_val: 75.5348129272461, obj_val: 75.53426361083984, abs dis: 0.00054931640625
[rfa agg] iter: 5, weight: tensor([0.0940, 0.1883, 0.2367, 0.0086, 0.1323, 0.1095, 0.0885, 0.0803, 0.0121,
        0.0497])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0019, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 3.4444, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.898161649704 sec.
Server Epoch:70 choose agents : [22, 33, 47, 94, 75, 85, 88, 5, 73, 80].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0538, Accuracy: 392/1470 (26.6667%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 785/1470 (53.4014%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.2197, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   1, Avg loss: 0.0982, Accuracy: 7/515 (1.3592%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   2, Avg loss: 0.0611, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3664, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1437, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1210, Accuracy: 6/134 (4.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4411, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   1, Avg loss: 0.0679, Accuracy: 269/1662 (16.1853%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   2, Avg loss: 0.0356, Accuracy: 582/1662 (35.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8969, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0682, Accuracy: 180/776 (23.1959%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0310, Accuracy: 443/776 (57.0876%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.7527, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   1, Avg loss: 0.0632, Accuracy: 344/1988 (17.3038%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   2, Avg loss: 0.0390, Accuracy: 562/1988 (28.2696%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5169, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0780, Accuracy: 102/603 (16.9154%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.6554, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   1, Avg loss: 0.0624, Accuracy: 263/1628 (16.1548%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   2, Avg loss: 0.0280, Accuracy: 704/1628 (43.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0274, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0683, Accuracy: 160/938 (17.0576%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0363, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.7751, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 87/682 (12.7566%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 255/682 (37.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.8608, Accuracy: 53/10000 (0.5300%)
time spent on training: 245.84659266471863
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 515, 134, 1662, 776, 1988, 603, 1628, 938, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 33, 47, 94, 75, 85, 88, 5, 73, 80], weight: tensor([0.1414, 0.0495, 0.0129, 0.1599, 0.0746, 0.1912, 0.0580, 0.1566, 0.0902,
        0.0656])
[rfa agg] iter:  0, prev_obj_val: 74.84622192382812, obj_val: 75.88833618164062, abs dis: 1.0421142578125
[rfa agg] iter: 0, weight: tensor([0.2238, 0.0332, 0.0054, 0.1656, 0.0782, 0.1089, 0.0436, 0.1599, 0.1266,
        0.0548])
[rfa agg] iter:  1, prev_obj_val: 75.88833618164062, obj_val: 77.11296844482422, abs dis: 1.2246322631835938
[rfa agg] iter: 1, weight: tensor([0.2163, 0.0349, 0.0056, 0.1571, 0.0841, 0.1051, 0.0461, 0.1525, 0.1401,
        0.0582])
[rfa agg] iter:  2, prev_obj_val: 77.11296844482422, obj_val: 78.38558197021484, abs dis: 1.272613525390625
[rfa agg] iter: 2, weight: tensor([0.2008, 0.0370, 0.0058, 0.1496, 0.0915, 0.1026, 0.0492, 0.1453, 0.1558,
        0.0624])
[rfa agg] iter:  3, prev_obj_val: 78.38558197021484, obj_val: 77.11217498779297, abs dis: 1.273406982421875
[rfa agg] iter: 3, weight: tensor([0.1853, 0.0389, 0.0060, 0.1417, 0.0991, 0.0994, 0.0521, 0.1376, 0.1732,
        0.0666])
[rfa agg] iter:  4, prev_obj_val: 77.11217498779297, obj_val: 78.38436126708984, abs dis: 1.272186279296875
[rfa agg] iter: 4, weight: tensor([0.1982, 0.0370, 0.0058, 0.1493, 0.0920, 0.1025, 0.0493, 0.1448, 0.1585,
        0.0626])
[rfa agg] iter:  5, prev_obj_val: 78.38436126708984, obj_val: 77.11225891113281, abs dis: 1.2721023559570312
[rfa agg] iter: 5, weight: tensor([0.1851, 0.0389, 0.0060, 0.1417, 0.0991, 0.0994, 0.0521, 0.1376, 0.1734,
        0.0666])
[rfa agg] iter:  6, prev_obj_val: 77.11225891113281, obj_val: 78.38436126708984, abs dis: 1.2721023559570312
[rfa agg] iter: 6, weight: tensor([0.1982, 0.0370, 0.0058, 0.1493, 0.0920, 0.1025, 0.0493, 0.1448, 0.1585,
        0.0626])
[rfa agg] iter:  7, prev_obj_val: 78.38436126708984, obj_val: 77.11225891113281, abs dis: 1.2721023559570312
[rfa agg] iter: 7, weight: tensor([0.1851, 0.0389, 0.0060, 0.1417, 0.0991, 0.0994, 0.0521, 0.1376, 0.1734,
        0.0666])
[rfa agg] iter:  8, prev_obj_val: 77.11225891113281, obj_val: 78.38436126708984, abs dis: 1.2721023559570312
[rfa agg] iter: 8, weight: tensor([0.1982, 0.0370, 0.0058, 0.1493, 0.0920, 0.1025, 0.0493, 0.1448, 0.1585,
        0.0626])
[rfa agg] iter:  9, prev_obj_val: 78.38436126708984, obj_val: 77.11225891113281, abs dis: 1.2721023559570312
[rfa agg] iter: 9, weight: tensor([0.1851, 0.0389, 0.0060, 0.1417, 0.0991, 0.0994, 0.0521, 0.1376, 0.1734,
        0.0666])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0532, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 3.3068, Accuracy: 0/9950 (0.0000%)
saving model
Done in 403.9341444969177 sec.
Server Epoch:71 choose agents : [7, 79, 81, 44, 17, 9, 21, 95, 51, 70].
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1, Avg loss: 0.0690, Accuracy: 195/891 (21.8855%)
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2, Avg loss: 0.0295, Accuracy: 427/891 (47.9237%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.4136, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1211, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0984, Accuracy: 5/197 (2.5381%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2419, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0862, Accuracy: 99/774 (12.7907%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0488, Accuracy: 347/774 (44.8320%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.6069, Accuracy: 71/10000 (0.7100%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   1, Avg loss: 0.0658, Accuracy: 296/1750 (16.9143%)
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   2, Avg loss: 0.0373, Accuracy: 612/1750 (34.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2764, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   1, Avg loss: 0.0581, Accuracy: 294/1574 (18.6785%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 558/1574 (35.4511%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.5272, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   1, Avg loss: 0.0582, Accuracy: 285/1275 (22.3529%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 688/1275 (53.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.9728, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   1, Avg loss: 0.0604, Accuracy: 311/1949 (15.9569%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 586/1949 (30.0667%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1851, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   1, Avg loss: 0.0576, Accuracy: 229/599 (38.2304%)
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   2, Avg loss: 0.0311, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 14.1988, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   1, Avg loss: 0.0676, Accuracy: 163/1049 (15.5386%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   2, Avg loss: 0.0338, Accuracy: 459/1049 (43.7560%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.4286, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   1, Avg loss: 0.0637, Accuracy: 256/1418 (18.0536%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 590/1418 (41.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.0019, Accuracy: 82/10000 (0.8200%)
time spent on training: 282.5676038265228
[rfa agg] training data poison_ratio: 0.20468804461484838  data num: [891, 197, 774, 1750, 1574, 1275, 1949, 599, 1049, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06396501394214012
[rfa agg] init. name: [7, 79, 81, 44, 17, 9, 21, 95, 51, 70], weight: tensor([0.0776, 0.0172, 0.0674, 0.1525, 0.1372, 0.1111, 0.1698, 0.0522, 0.0914,
        0.1236])
[rfa agg] iter:  0, prev_obj_val: 65.31709289550781, obj_val: 67.59951782226562, abs dis: 2.2824249267578125
[rfa agg] iter: 0, weight: tensor([0.0711, 0.0062, 0.0536, 0.1073, 0.1408, 0.2134, 0.0893, 0.0306, 0.1176,
        0.1701])
[rfa agg] iter:  1, prev_obj_val: 67.59951782226562, obj_val: 67.57931518554688, abs dis: 0.02020263671875
[rfa agg] iter: 1, weight: tensor([0.0816, 0.0066, 0.0607, 0.0965, 0.1234, 0.2288, 0.0820, 0.0336, 0.1388,
        0.1480])
[rfa agg] iter:  2, prev_obj_val: 67.57931518554688, obj_val: 67.57894134521484, abs dis: 0.00037384033203125
[rfa agg] iter: 2, weight: tensor([0.0811, 0.0066, 0.0604, 0.0957, 0.1221, 0.2330, 0.0814, 0.0334, 0.1410,
        0.1454])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 29.3597, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 41.9605, Accuracy: 0/9950 (0.0000%)
saving model
Done in 437.61902475357056 sec.
Server Epoch:72 choose agents : [52, 6, 79, 96, 87, 25, 35, 83, 19, 89].
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1, Avg loss: 0.0597, Accuracy: 262/636 (41.1950%)
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7967, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1, Avg loss: 0.0611, Accuracy: 313/1956 (16.0020%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2, Avg loss: 0.0346, Accuracy: 556/1956 (28.4254%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.2251, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   1, Avg loss: 0.1207, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   2, Avg loss: 0.0956, Accuracy: 4/197 (2.0305%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.8232, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0900, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0594, Accuracy: 96/311 (30.8682%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0607, Accuracy: 250/1131 (22.1043%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0336, Accuracy: 410/1131 (36.2511%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.1910, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   1, Avg loss: 0.0617, Accuracy: 224/690 (32.4638%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   2, Avg loss: 0.0301, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.3953, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   2, Avg loss: 0.0876, Accuracy: 39/271 (14.3911%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.6587, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   1, Avg loss: 0.0670, Accuracy: 337/1953 (17.2555%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   2, Avg loss: 0.0371, Accuracy: 684/1953 (35.0230%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.1673, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0522, Accuracy: 307/1036 (29.6332%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0267, Accuracy: 589/1036 (56.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.4194, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 269/896 (30.0223%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   2, Avg loss: 0.0365, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2852, Accuracy: 57/10000 (0.5700%)
time spent on training: 211.48143100738525
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1956, 197, 311, 1131, 690, 271, 1953, 1036, 896]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 6, 79, 96, 87, 25, 35, 83, 19, 89], weight: tensor([0.0701, 0.2155, 0.0217, 0.0343, 0.1246, 0.0760, 0.0299, 0.2152, 0.1141,
        0.0987])
[rfa agg] iter:  0, prev_obj_val: 84.22957611083984, obj_val: 84.26449584960938, abs dis: 0.03491973876953125
[rfa agg] iter: 0, weight: tensor([0.0533, 0.1133, 0.0098, 0.0168, 0.2559, 0.0660, 0.0146, 0.1147, 0.2275,
        0.1282])
[rfa agg] iter:  1, prev_obj_val: 84.26449584960938, obj_val: 86.79692840576172, abs dis: 2.5324325561523438
[rfa agg] iter: 1, weight: tensor([0.0519, 0.0912, 0.0091, 0.0157, 0.2701, 0.0658, 0.0137, 0.0926, 0.2550,
        0.1350])
[rfa agg] iter:  2, prev_obj_val: 86.79692840576172, obj_val: 86.76101684570312, abs dis: 0.03591156005859375
[rfa agg] iter: 2, weight: tensor([0.0618, 0.0821, 0.0100, 0.0175, 0.2230, 0.0815, 0.0153, 0.0831, 0.2487,
        0.1771])
[rfa agg] iter:  3, prev_obj_val: 86.76101684570312, obj_val: 86.76005554199219, abs dis: 0.0009613037109375
[rfa agg] iter: 3, weight: tensor([0.0621, 0.0819, 0.0100, 0.0175, 0.2149, 0.0816, 0.0153, 0.0830, 0.2505,
        0.1834])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.1368, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 3.1706, Accuracy: 0/9950 (0.0000%)
saving model
Done in 370.39042043685913 sec.
Server Epoch:73 choose agents : [33, 18, 68, 97, 36, 30, 4, 67, 23, 21].
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1037, Accuracy: 3/515 (0.5825%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0629, Accuracy: 116/515 (22.5243%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.8006, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   1, Avg loss: 0.1027, Accuracy: 40/530 (7.5472%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   2, Avg loss: 0.0578, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4268, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   1, Avg loss: 0.0727, Accuracy: 216/1163 (18.5727%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3875, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1, Avg loss: 0.0706, Accuracy: 275/1213 (22.6711%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2, Avg loss: 0.0305, Accuracy: 456/1213 (37.5927%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.8253, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.1041, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0634, Accuracy: 131/408 (32.1078%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1867, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   1, Avg loss: 0.0956, Accuracy: 23/486 (4.7325%)
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   2, Avg loss: 0.0442, Accuracy: 204/486 (41.9753%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.4312, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0704, Accuracy: 246/901 (27.3030%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0353, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5576, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   1, Avg loss: 0.0876, Accuracy: 39/426 (9.1549%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   2, Avg loss: 0.0540, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.7743, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   1, Avg loss: 0.0707, Accuracy: 218/715 (30.4895%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3661, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0612, Accuracy: 318/1949 (16.3161%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0359, Accuracy: 521/1949 (26.7317%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0373, Accuracy: 78/10000 (0.7800%)
time spent on training: 207.16781973838806
[rfa agg] training data poison_ratio: 0.05851191909463039  data num: [515, 530, 1163, 1213, 408, 486, 901, 426, 715, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.018284974717071998
[rfa agg] init. name: [33, 18, 68, 97, 36, 30, 4, 67, 23, 21], weight: tensor([0.0620, 0.0638, 0.1400, 0.1460, 0.0491, 0.0585, 0.1085, 0.0513, 0.0861,
        0.2346])
[rfa agg] iter:  0, prev_obj_val: 72.60079956054688, obj_val: 75.26017761230469, abs dis: 2.6593780517578125
[rfa agg] iter: 0, weight: tensor([0.0524, 0.0560, 0.1918, 0.1954, 0.0340, 0.0459, 0.1882, 0.0352, 0.1103,
        0.0908])
[rfa agg] iter:  1, prev_obj_val: 75.26017761230469, obj_val: 79.01779174804688, abs dis: 3.7576141357421875
[rfa agg] iter: 1, weight: tensor([0.0680, 0.0755, 0.1404, 0.1459, 0.0430, 0.0599, 0.1887, 0.0445, 0.1544,
        0.0798])
[rfa agg] iter:  2, prev_obj_val: 79.01779174804688, obj_val: 80.53071594238281, abs dis: 1.5129241943359375
[rfa agg] iter: 2, weight: tensor([0.0849, 0.0992, 0.1121, 0.1168, 0.0531, 0.0766, 0.1509, 0.0547, 0.1790,
        0.0727])
[rfa agg] iter:  3, prev_obj_val: 80.53071594238281, obj_val: 82.234619140625, abs dis: 1.7039031982421875
[rfa agg] iter: 3, weight: tensor([0.0917, 0.1105, 0.1038, 0.1081, 0.0574, 0.0844, 0.1349, 0.0591, 0.1803,
        0.0698])
[rfa agg] iter:  4, prev_obj_val: 82.234619140625, obj_val: 84.09257507324219, abs dis: 1.8579559326171875
[rfa agg] iter: 4, weight: tensor([0.0983, 0.1228, 0.0969, 0.1009, 0.0624, 0.0934, 0.1228, 0.0640, 0.1712,
        0.0674])
[rfa agg] iter:  5, prev_obj_val: 84.09257507324219, obj_val: 86.11004638671875, abs dis: 2.0174713134765625
[rfa agg] iter: 5, weight: tensor([0.1046, 0.1362, 0.0904, 0.0940, 0.0681, 0.1039, 0.1119, 0.0695, 0.1565,
        0.0648])
[rfa agg] iter:  6, prev_obj_val: 86.11004638671875, obj_val: 84.09001159667969, abs dis: 2.0200347900390625
[rfa agg] iter: 6, weight: tensor([0.1094, 0.1493, 0.0840, 0.0874, 0.0745, 0.1159, 0.1018, 0.0757, 0.1400,
        0.0620])
[rfa agg] iter:  7, prev_obj_val: 84.09001159667969, obj_val: 88.32140350341797, abs dis: 4.231391906738281
[rfa agg] iter: 7, weight: tensor([0.1059, 0.1401, 0.0898, 0.0934, 0.0687, 0.1055, 0.1105, 0.0703, 0.1515,
        0.0644])
[rfa agg] iter:  8, prev_obj_val: 88.32140350341797, obj_val: 84.10610961914062, abs dis: 4.215293884277344
[rfa agg] iter: 8, weight: tensor([0.1117, 0.1575, 0.0784, 0.0816, 0.0815, 0.1284, 0.0934, 0.0824, 0.1257,
        0.0594])
[rfa agg] iter:  9, prev_obj_val: 84.10610961914062, obj_val: 88.31926727294922, abs dis: 4.213157653808594
[rfa agg] iter: 9, weight: tensor([0.1063, 0.1416, 0.0896, 0.0931, 0.0690, 0.1063, 0.1099, 0.0706, 0.1493,
        0.0643])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 23.6622, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 31.8776, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.8151342868805 sec.
Server Epoch:74 choose agents : [28, 44, 36, 74, 4, 77, 86, 13, 63, 93].
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0690, Accuracy: 298/1581 (18.8488%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0377, Accuracy: 519/1581 (32.8273%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6828, Accuracy: 84/10000 (0.8400%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0695, Accuracy: 229/1750 (13.0857%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0389, Accuracy: 566/1750 (32.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2687, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   1, Avg loss: 0.1028, Accuracy: 1/408 (0.2451%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   2, Avg loss: 0.0610, Accuracy: 145/408 (35.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.2414, Accuracy: 46/10000 (0.4600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0517, Accuracy: 353/1552 (22.7448%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0244, Accuracy: 661/1552 (42.5902%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.0734, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0696, Accuracy: 250/901 (27.7469%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0371, Accuracy: 413/901 (45.8380%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.4375, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 294/1340 (21.9403%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 563/1340 (42.0149%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.3342, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   1, Avg loss: 0.0666, Accuracy: 246/1003 (24.5264%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   2, Avg loss: 0.0363, Accuracy: 362/1003 (36.0917%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5902, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   1, Avg loss: 0.0661, Accuracy: 223/1645 (13.5562%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   2, Avg loss: 0.0363, Accuracy: 507/1645 (30.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.5450, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0613, Accuracy: 177/888 (19.9324%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.4628, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0676, Accuracy: 313/1742 (17.9679%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0342, Accuracy: 632/1742 (36.2801%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.1314, Accuracy: 77/10000 (0.7700%)
time spent on training: 266.00107169151306
[rfa agg] training data poison_ratio: 0.2577673692427791  data num: [1581, 1750, 408, 1552, 901, 1340, 1003, 1645, 888, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.08055230288836847
[rfa agg] init. name: [28, 44, 36, 74, 4, 77, 86, 13, 63, 93], weight: tensor([0.1234, 0.1366, 0.0319, 0.1212, 0.0703, 0.1046, 0.0783, 0.1284, 0.0693,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 59.03485107421875, obj_val: 62.329532623291016, abs dis: 3.2946815490722656
[rfa agg] iter: 0, weight: tensor([0.1354, 0.0986, 0.0136, 0.1233, 0.0649, 0.2049, 0.0884, 0.1150, 0.0574,
        0.0986])
[rfa agg] iter:  1, prev_obj_val: 62.329532623291016, obj_val: 60.54804611206055, abs dis: 1.7814865112304688
[rfa agg] iter: 1, weight: tensor([0.1213, 0.0915, 0.0152, 0.1127, 0.0773, 0.2099, 0.1085, 0.1048, 0.0676,
        0.0913])
[rfa agg] iter:  2, prev_obj_val: 60.54804611206055, obj_val: 58.91621398925781, abs dis: 1.6318321228027344
[rfa agg] iter: 2, weight: tensor([0.1261, 0.0933, 0.0142, 0.1163, 0.0702, 0.2206, 0.0972, 0.1076, 0.0615,
        0.0931])
[rfa agg] iter:  3, prev_obj_val: 58.91621398925781, obj_val: 60.54693603515625, abs dis: 1.6307220458984375
[rfa agg] iter: 3, weight: tensor([0.1318, 0.0955, 0.0133, 0.1205, 0.0635, 0.2273, 0.0863, 0.1107, 0.0559,
        0.0953])
[rfa agg] iter:  4, prev_obj_val: 60.54693603515625, obj_val: 58.9157600402832, abs dis: 1.6311759948730469
[rfa agg] iter: 4, weight: tensor([0.1258, 0.0932, 0.0142, 0.1162, 0.0697, 0.2237, 0.0960, 0.1073, 0.0611,
        0.0929])
[rfa agg] iter:  5, prev_obj_val: 58.9157600402832, obj_val: 60.546974182128906, abs dis: 1.6312141418457031
[rfa agg] iter: 5, weight: tensor([0.1316, 0.0954, 0.0133, 0.1204, 0.0634, 0.2280, 0.0862, 0.1106, 0.0558,
        0.0952])
[rfa agg] iter:  6, prev_obj_val: 60.546974182128906, obj_val: 58.91575241088867, abs dis: 1.6312217712402344
[rfa agg] iter: 6, weight: tensor([0.1258, 0.0931, 0.0141, 0.1161, 0.0697, 0.2238, 0.0960, 0.1072, 0.0611,
        0.0929])
[rfa agg] iter:  7, prev_obj_val: 58.91575241088867, obj_val: 60.54697799682617, abs dis: 1.6312255859375
[rfa agg] iter: 7, weight: tensor([0.1316, 0.0954, 0.0133, 0.1204, 0.0634, 0.2281, 0.0862, 0.1106, 0.0558,
        0.0952])
[rfa agg] iter:  8, prev_obj_val: 60.54697799682617, obj_val: 58.915748596191406, abs dis: 1.6312294006347656
[rfa agg] iter: 8, weight: tensor([0.1258, 0.0931, 0.0141, 0.1161, 0.0697, 0.2239, 0.0960, 0.1072, 0.0611,
        0.0929])
[rfa agg] iter:  9, prev_obj_val: 58.915748596191406, obj_val: 60.546974182128906, abs dis: 1.6312255859375
[rfa agg] iter: 9, weight: tensor([0.1316, 0.0954, 0.0133, 0.1204, 0.0634, 0.2281, 0.0862, 0.1106, 0.0558,
        0.0952])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.0938, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 3.3605, Accuracy: 0/9950 (0.0000%)
saving model
Done in 425.61522603034973 sec.
Server Epoch:75 choose agents : [9, 40, 44, 67, 53, 47, 1, 98, 99, 57].
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1, Avg loss: 0.0537, Accuracy: 317/1275 (24.8627%)
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 685/1275 (53.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.2276, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0671, Accuracy: 261/1573 (16.5925%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0385, Accuracy: 518/1573 (32.9307%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2201, Accuracy: 74/10000 (0.7400%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   1, Avg loss: 0.0674, Accuracy: 279/1750 (15.9429%)
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   2, Avg loss: 0.0382, Accuracy: 576/1750 (32.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2634, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   1, Avg loss: 0.0869, Accuracy: 57/426 (13.3803%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   2, Avg loss: 0.0563, Accuracy: 179/426 (42.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5999, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   1, Avg loss: 0.0521, Accuracy: 241/813 (29.6433%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   2, Avg loss: 0.0210, Accuracy: 437/813 (53.7515%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.7755, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   1, Avg loss: 0.1377, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   2, Avg loss: 0.1228, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8412, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0698, Accuracy: 189/928 (20.3664%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0261, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.8005, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   1, Avg loss: 0.1080, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   2, Avg loss: 0.0638, Accuracy: 65/373 (17.4263%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8713, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   1, Avg loss: 0.0600, Accuracy: 196/773 (25.3558%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.3648, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1, Avg loss: 0.0674, Accuracy: 238/1154 (20.6239%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2, Avg loss: 0.0327, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.6065, Accuracy: 62/10000 (0.6200%)
time spent on training: 247.47626638412476
[rfa agg] training data poison_ratio: 0.19023806935536472  data num: [1275, 1573, 1750, 426, 813, 134, 928, 373, 773, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.05944939667355147
[rfa agg] init. name: [9, 40, 44, 67, 53, 47, 1, 98, 99, 57], weight: tensor([0.1386, 0.1710, 0.1902, 0.0463, 0.0884, 0.0146, 0.1009, 0.0405, 0.0840,
        0.1254])
[rfa agg] iter:  0, prev_obj_val: 66.39604949951172, obj_val: 68.29314422607422, abs dis: 1.8970947265625
[rfa agg] iter: 0, weight: tensor([0.1948, 0.1229, 0.1033, 0.0280, 0.1154, 0.0060, 0.1457, 0.0221, 0.1037,
        0.1583])
[rfa agg] iter:  1, prev_obj_val: 68.29314422607422, obj_val: 69.56230926513672, abs dis: 1.2691650390625
[rfa agg] iter: 1, weight: tensor([0.1707, 0.1088, 0.0933, 0.0302, 0.1364, 0.0063, 0.1662, 0.0236, 0.1185,
        0.1458])
[rfa agg] iter:  2, prev_obj_val: 69.56230926513672, obj_val: 69.55414581298828, abs dis: 0.0081634521484375
[rfa agg] iter: 2, weight: tensor([0.1558, 0.1031, 0.0892, 0.0316, 0.1511, 0.0065, 0.1739, 0.0246, 0.1286,
        0.1357])
[rfa agg] iter:  3, prev_obj_val: 69.55414581298828, obj_val: 69.55403900146484, abs dis: 0.0001068115234375
[rfa agg] iter: 3, weight: tensor([0.1545, 0.1028, 0.0889, 0.0315, 0.1524, 0.0065, 0.1751, 0.0245, 0.1295,
        0.1342])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.0640, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 3.1745, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.30728006362915 sec.
Server Epoch:76 choose agents : [93, 69, 79, 90, 4, 59, 86, 13, 22, 68].
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0684, Accuracy: 333/1742 (19.1160%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0346, Accuracy: 626/1742 (35.9357%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8188, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1, Avg loss: 0.0681, Accuracy: 189/590 (32.0339%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 13.0131, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   1, Avg loss: 0.1248, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   2, Avg loss: 0.1070, Accuracy: 4/197 (2.0305%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.0847, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   1, Avg loss: 0.0585, Accuracy: 234/677 (34.5643%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.1644, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0692, Accuracy: 243/901 (26.9700%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 420/901 (46.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4049, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   1, Avg loss: 0.0648, Accuracy: 272/1089 (24.9770%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   2, Avg loss: 0.0316, Accuracy: 473/1089 (43.4343%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6006, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   1, Avg loss: 0.0644, Accuracy: 273/1003 (27.2183%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   2, Avg loss: 0.0362, Accuracy: 357/1003 (35.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5333, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   1, Avg loss: 0.0648, Accuracy: 246/1645 (14.9544%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   2, Avg loss: 0.0358, Accuracy: 532/1645 (32.3404%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2034, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   1, Avg loss: 0.0536, Accuracy: 373/1470 (25.3741%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   2, Avg loss: 0.0258, Accuracy: 788/1470 (53.6054%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.5645, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   1, Avg loss: 0.0744, Accuracy: 219/1163 (18.8306%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   2, Avg loss: 0.0408, Accuracy: 417/1163 (35.8555%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7434, Accuracy: 61/10000 (0.6100%)
time spent on training: 240.95210313796997
[rfa agg] training data poison_ratio: 0.0  data num: [1742, 590, 197, 677, 901, 1089, 1003, 1645, 1470, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [93, 69, 79, 90, 4, 59, 86, 13, 22, 68], weight: tensor([0.1663, 0.0563, 0.0188, 0.0646, 0.0860, 0.1039, 0.0957, 0.1570, 0.1403,
        0.1110])
[rfa agg] iter:  0, prev_obj_val: 61.65361785888672, obj_val: 64.50919342041016, abs dis: 2.8555755615234375
[rfa agg] iter: 0, weight: tensor([0.0983, 0.0375, 0.0073, 0.0480, 0.1071, 0.1016, 0.1526, 0.1122, 0.1492,
        0.1863])
[rfa agg] iter:  1, prev_obj_val: 64.50919342041016, obj_val: 67.46867370605469, abs dis: 2.9594802856445312
[rfa agg] iter: 1, weight: tensor([0.0837, 0.0434, 0.0078, 0.0564, 0.1333, 0.0978, 0.1963, 0.0935, 0.1189,
        0.1689])
[rfa agg] iter:  2, prev_obj_val: 67.46867370605469, obj_val: 67.44216918945312, abs dis: 0.0265045166015625
[rfa agg] iter: 2, weight: tensor([0.0766, 0.0492, 0.0083, 0.0647, 0.1548, 0.0930, 0.2218, 0.0845, 0.1039,
        0.1432])
[rfa agg] iter:  3, prev_obj_val: 67.44216918945312, obj_val: 67.44122314453125, abs dis: 0.000946044921875
[rfa agg] iter: 3, weight: tensor([0.0757, 0.0488, 0.0082, 0.0642, 0.1575, 0.0914, 0.2293, 0.0834, 0.1025,
        0.1392])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.0580, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 3.3186, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.3808798789978 sec.
Server Epoch:77 choose agents : [5, 77, 11, 59, 88, 41, 18, 93, 98, 37].
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   1, Avg loss: 0.0620, Accuracy: 280/1628 (17.1990%)
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 753/1628 (46.2531%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.3412, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   1, Avg loss: 0.0522, Accuracy: 296/1340 (22.0896%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 567/1340 (42.3134%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.0641, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1, Avg loss: 0.0693, Accuracy: 167/712 (23.4551%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 445/712 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 12.1708, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0729, Accuracy: 262/1089 (24.0588%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0316, Accuracy: 452/1089 (41.5060%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.2575, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0776, Accuracy: 98/603 (16.2521%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0491, Accuracy: 274/603 (45.4395%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7618, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   1, Avg loss: 0.0691, Accuracy: 219/719 (30.4590%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   2, Avg loss: 0.0398, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.7760, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   1, Avg loss: 0.0979, Accuracy: 59/530 (11.1321%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   2, Avg loss: 0.0549, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4889, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0683, Accuracy: 344/1742 (19.7474%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0343, Accuracy: 653/1742 (37.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9143, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.1105, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0666, Accuracy: 60/373 (16.0858%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4804, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   1, Avg loss: 0.0502, Accuracy: 379/1129 (33.5695%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 702/1129 (62.1789%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.7094, Accuracy: 104/10000 (1.0400%)
time spent on training: 261.77342319488525
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1340, 712, 1089, 603, 719, 530, 1742, 373, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 77, 11, 59, 88, 41, 18, 93, 98, 37], weight: tensor([0.1650, 0.1358, 0.0722, 0.1104, 0.0611, 0.0729, 0.0537, 0.1766, 0.0378,
        0.1144])
[rfa agg] iter:  0, prev_obj_val: 71.18598175048828, obj_val: 73.68319702148438, abs dis: 2.4972152709960938
[rfa agg] iter: 0, weight: tensor([0.1084, 0.1566, 0.0993, 0.1106, 0.0645, 0.0973, 0.0486, 0.0975, 0.0244,
        0.1928])
[rfa agg] iter:  1, prev_obj_val: 73.68319702148438, obj_val: 75.18647766113281, abs dis: 1.5032806396484375
[rfa agg] iter: 1, weight: tensor([0.0984, 0.1372, 0.1194, 0.1054, 0.0747, 0.1150, 0.0549, 0.0895, 0.0267,
        0.1790])
[rfa agg] iter:  2, prev_obj_val: 75.18647766113281, obj_val: 75.1790542602539, abs dis: 0.00742340087890625
[rfa agg] iter: 2, weight: tensor([0.0940, 0.1278, 0.1323, 0.1012, 0.0813, 0.1261, 0.0589, 0.0860, 0.0280,
        0.1644])
[rfa agg] iter:  3, prev_obj_val: 75.1790542602539, obj_val: 75.17897033691406, abs dis: 8.392333984375e-05
[rfa agg] iter: 3, weight: tensor([0.0938, 0.1273, 0.1337, 0.1005, 0.0816, 0.1274, 0.0589, 0.0858, 0.0279,
        0.1631])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 18.2458, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 22.3104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.1457962989807 sec.
Server Epoch:78 choose agents : [65, 18, 30, 33, 53, 94, 76, 64, 0, 29].
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   1, Avg loss: 0.0614, Accuracy: 327/1475 (22.1695%)
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   2, Avg loss: 0.0342, Accuracy: 563/1475 (38.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4484, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0957, Accuracy: 58/530 (10.9434%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0536, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.8998, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0976, Accuracy: 21/486 (4.3210%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0470, Accuracy: 186/486 (38.2716%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.6303, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   1, Avg loss: 0.1028, Accuracy: 6/515 (1.1650%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   2, Avg loss: 0.0697, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7479, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   1, Avg loss: 0.0552, Accuracy: 214/813 (26.3223%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   2, Avg loss: 0.0214, Accuracy: 435/813 (53.5055%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 13.2419, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1, Avg loss: 0.0702, Accuracy: 269/1662 (16.1853%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2, Avg loss: 0.0366, Accuracy: 573/1662 (34.4765%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.6429, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0876, Accuracy: 13/466 (2.7897%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0467, Accuracy: 173/466 (37.1245%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7840, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0705, Accuracy: 119/953 (12.4869%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0401, Accuracy: 297/953 (31.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.2280, Accuracy: 55/10000 (0.5500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0612, Accuracy: 314/1657 (18.9499%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0374, Accuracy: 473/1657 (28.5456%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4477, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   1, Avg loss: 0.0571, Accuracy: 364/1440 (25.2778%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   2, Avg loss: 0.0287, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.8498, Accuracy: 79/10000 (0.7900%)
time spent on training: 255.40202379226685
[rfa agg] training data poison_ratio: 0.21436430929278782  data num: [1475, 530, 486, 515, 813, 1662, 466, 953, 1657, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0669888466539962
[rfa agg] init. name: [65, 18, 30, 33, 53, 94, 76, 64, 0, 29], weight: tensor([0.1475, 0.0530, 0.0486, 0.0515, 0.0813, 0.1662, 0.0466, 0.0953, 0.1657,
        0.1440])
[rfa agg] iter:  0, prev_obj_val: 71.59541320800781, obj_val: 74.03656005859375, abs dis: 2.4411468505859375
[rfa agg] iter: 0, weight: tensor([0.1204, 0.0462, 0.0378, 0.0434, 0.1299, 0.1155, 0.0361, 0.2167, 0.1151,
        0.1390])
[rfa agg] iter:  1, prev_obj_val: 74.03656005859375, obj_val: 77.1281509399414, abs dis: 3.0915908813476562
[rfa agg] iter: 1, weight: tensor([0.1012, 0.0489, 0.0395, 0.0455, 0.1512, 0.0979, 0.0376, 0.2652, 0.0976,
        0.1154])
[rfa agg] iter:  2, prev_obj_val: 77.1281509399414, obj_val: 78.91407775878906, abs dis: 1.7859268188476562
[rfa agg] iter: 2, weight: tensor([0.0883, 0.0540, 0.0429, 0.0495, 0.1806, 0.0863, 0.0407, 0.2725, 0.0860,
        0.0991])
[rfa agg] iter:  3, prev_obj_val: 78.91407775878906, obj_val: 77.1166000366211, abs dis: 1.7974777221679688
[rfa agg] iter: 3, weight: tensor([0.0839, 0.0581, 0.0458, 0.0528, 0.2028, 0.0825, 0.0434, 0.2550, 0.0822,
        0.0935])
[rfa agg] iter:  4, prev_obj_val: 77.1166000366211, obj_val: 78.91146087646484, abs dis: 1.79486083984375
[rfa agg] iter: 4, weight: tensor([0.0873, 0.0538, 0.0428, 0.0494, 0.1889, 0.0855, 0.0406, 0.2682, 0.0853,
        0.0981])
[rfa agg] iter:  5, prev_obj_val: 78.91146087646484, obj_val: 77.11707305908203, abs dis: 1.7943878173828125
[rfa agg] iter: 5, weight: tensor([0.0838, 0.0581, 0.0458, 0.0528, 0.2045, 0.0824, 0.0433, 0.2536, 0.0822,
        0.0935])
[rfa agg] iter:  6, prev_obj_val: 77.11707305908203, obj_val: 78.9113540649414, abs dis: 1.794281005859375
[rfa agg] iter: 6, weight: tensor([0.0873, 0.0539, 0.0428, 0.0494, 0.1893, 0.0856, 0.0406, 0.2678, 0.0853,
        0.0981])
[rfa agg] iter:  7, prev_obj_val: 78.9113540649414, obj_val: 77.11709594726562, abs dis: 1.7942581176757812
[rfa agg] iter: 7, weight: tensor([0.0838, 0.0581, 0.0458, 0.0528, 0.2046, 0.0824, 0.0433, 0.2535, 0.0822,
        0.0935])
[rfa agg] iter:  8, prev_obj_val: 77.11709594726562, obj_val: 78.91134643554688, abs dis: 1.79425048828125
[rfa agg] iter: 8, weight: tensor([0.0873, 0.0539, 0.0428, 0.0494, 0.1893, 0.0856, 0.0406, 0.2677, 0.0853,
        0.0981])
[rfa agg] iter:  9, prev_obj_val: 78.91134643554688, obj_val: 77.11710357666016, abs dis: 1.7942428588867188
[rfa agg] iter: 9, weight: tensor([0.0838, 0.0581, 0.0458, 0.0528, 0.2046, 0.0825, 0.0433, 0.2535, 0.0822,
        0.0935])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1231, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 3.5575, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.36161851882935 sec.
Server Epoch:79 choose agents : [1, 68, 51, 81, 10, 38, 27, 94, 19, 98].
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0686, Accuracy: 199/928 (21.4440%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 590/928 (63.5776%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.5832, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   1, Avg loss: 0.0750, Accuracy: 208/1163 (17.8848%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   2, Avg loss: 0.0420, Accuracy: 404/1163 (34.7377%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8381, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0645, Accuracy: 187/1049 (17.8265%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 461/1049 (43.9466%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4451, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   1, Avg loss: 0.0912, Accuracy: 76/774 (9.8191%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   2, Avg loss: 0.0446, Accuracy: 345/774 (44.5736%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.9389, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   1, Avg loss: 0.0657, Accuracy: 148/861 (17.1893%)
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   2, Avg loss: 0.0222, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.6760, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   1, Avg loss: 0.0698, Accuracy: 214/1131 (18.9213%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   2, Avg loss: 0.0321, Accuracy: 502/1131 (44.3855%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.2596, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0615, Accuracy: 345/1587 (21.7391%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0373, Accuracy: 474/1587 (29.8677%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6756, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0700, Accuracy: 261/1662 (15.7040%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0375, Accuracy: 509/1662 (30.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9053, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   1, Avg loss: 0.0526, Accuracy: 312/1036 (30.1158%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 644/1036 (62.1622%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 13.0157, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.1109, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0666, Accuracy: 71/373 (19.0349%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5188, Accuracy: 49/10000 (0.4900%)
time spent on training: 238.3388159275055
[rfa agg] training data poison_ratio: 0.0815032184778493  data num: [928, 1163, 1049, 774, 861, 1131, 1587, 1662, 1036, 373]
[rfa agg] considering poison per batch poison_fraction: 0.025469755774327908
[rfa agg] init. name: [1, 68, 51, 81, 10, 38, 27, 94, 19, 98], weight: tensor([0.0878, 0.1101, 0.0993, 0.0733, 0.0815, 0.1071, 0.1502, 0.1573, 0.0981,
        0.0353])
[rfa agg] iter:  0, prev_obj_val: 52.72490310668945, obj_val: 59.34712219238281, abs dis: 6.622219085693359
[rfa agg] iter: 0, weight: tensor([0.1137, 0.1240, 0.1225, 0.0739, 0.1027, 0.1359, 0.0787, 0.0740, 0.1594,
        0.0152])
[rfa agg] iter:  1, prev_obj_val: 59.34712219238281, obj_val: 57.163063049316406, abs dis: 2.1840591430664062
[rfa agg] iter: 1, weight: tensor([0.1368, 0.0990, 0.1129, 0.1053, 0.1473, 0.1127, 0.0688, 0.0657, 0.1322,
        0.0193])
[rfa agg] iter:  2, prev_obj_val: 57.163063049316406, obj_val: 59.29596710205078, abs dis: 2.132904052734375
[rfa agg] iter: 2, weight: tensor([0.1368, 0.1016, 0.1154, 0.0979, 0.1422, 0.1162, 0.0693, 0.0659, 0.1368,
        0.0178])
[rfa agg] iter:  3, prev_obj_val: 59.29596710205078, obj_val: 59.29307556152344, abs dis: 0.00289154052734375
[rfa agg] iter: 3, weight: tensor([0.1389, 0.0973, 0.1118, 0.1070, 0.1524, 0.1110, 0.0681, 0.0650, 0.1294,
        0.0192])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 14.2568, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 17.8367, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.0691783428192 sec.
Server Epoch:80 choose agents : [75, 36, 16, 74, 20, 26, 57, 91, 19, 56].
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0707, Accuracy: 171/776 (22.0361%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0327, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.5321, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   1, Avg loss: 0.1028, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   2, Avg loss: 0.0614, Accuracy: 138/408 (33.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2505, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   1, Avg loss: 0.0759, Accuracy: 179/708 (25.2825%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.0054, Accuracy: 74/10000 (0.7400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0529, Accuracy: 355/1552 (22.8737%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0241, Accuracy: 664/1552 (42.7835%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 12.4943, Accuracy: 91/10000 (0.9100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   1, Avg loss: 0.0698, Accuracy: 184/807 (22.8005%)
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   2, Avg loss: 0.0363, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1151, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   1, Avg loss: 0.0570, Accuracy: 289/1446 (19.9862%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   2, Avg loss: 0.0371, Accuracy: 457/1446 (31.6044%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4147, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   1, Avg loss: 0.0651, Accuracy: 232/1154 (20.1040%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 446/1154 (38.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.5812, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0634, Accuracy: 224/1030 (21.7476%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0287, Accuracy: 559/1030 (54.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.2477, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   1, Avg loss: 0.0547, Accuracy: 333/1036 (32.1429%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 642/1036 (61.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 13.0733, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   1, Avg loss: 0.0938, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   2, Avg loss: 0.0761, Accuracy: 10/186 (5.3763%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6197, Accuracy: 50/10000 (0.5000%)
time spent on training: 234.58534455299377
[rfa agg] training data poison_ratio: 0.2591453367021861  data num: [776, 408, 708, 1552, 807, 1446, 1154, 1030, 1036, 186]
[rfa agg] considering poison per batch poison_fraction: 0.08098291771943315
[rfa agg] init. name: [75, 36, 16, 74, 20, 26, 57, 91, 19, 56], weight: tensor([0.0852, 0.0448, 0.0778, 0.1705, 0.0887, 0.1588, 0.1268, 0.1131, 0.1138,
        0.0204])
[rfa agg] iter:  0, prev_obj_val: 59.492881774902344, obj_val: 59.25882339477539, abs dis: 0.23405838012695312
[rfa agg] iter: 0, weight: tensor([0.1328, 0.0291, 0.0921, 0.0897, 0.1283, 0.1038, 0.1154, 0.1188, 0.1815,
        0.0086])
[rfa agg] iter:  1, prev_obj_val: 59.25882339477539, obj_val: 60.667118072509766, abs dis: 1.408294677734375
[rfa agg] iter: 1, weight: tensor([0.1362, 0.0284, 0.0917, 0.0865, 0.1308, 0.1002, 0.1122, 0.1165, 0.1894,
        0.0084])
[rfa agg] iter:  2, prev_obj_val: 60.667118072509766, obj_val: 62.28679275512695, abs dis: 1.6196746826171875
[rfa agg] iter: 2, weight: tensor([0.1490, 0.0302, 0.0988, 0.0833, 0.1413, 0.0955, 0.1067, 0.1124, 0.1742,
        0.0087])
[rfa agg] iter:  3, prev_obj_val: 62.28679275512695, obj_val: 62.27880096435547, abs dis: 0.007991790771484375
[rfa agg] iter: 3, weight: tensor([0.1623, 0.0321, 0.1066, 0.0802, 0.1519, 0.0911, 0.1012, 0.1076, 0.1579,
        0.0090])
[rfa agg] iter:  4, prev_obj_val: 62.27880096435547, obj_val: 64.12993621826172, abs dis: 1.85113525390625
[rfa agg] iter: 4, weight: tensor([0.1643, 0.0320, 0.1073, 0.0799, 0.1535, 0.0906, 0.1005, 0.1066, 0.1563,
        0.0090])
[rfa agg] iter:  5, prev_obj_val: 64.12993621826172, obj_val: 64.12472534179688, abs dis: 0.00521087646484375
[rfa agg] iter: 5, weight: tensor([0.1741, 0.0343, 0.1147, 0.0773, 0.1611, 0.0870, 0.0961, 0.1025, 0.1435,
        0.0094])
[rfa agg] iter:  6, prev_obj_val: 64.12472534179688, obj_val: 66.21438598632812, abs dis: 2.08966064453125
[rfa agg] iter: 6, weight: tensor([0.1757, 0.0342, 0.1154, 0.0770, 0.1622, 0.0866, 0.0954, 0.1017, 0.1424,
        0.0094])
[rfa agg] iter:  7, prev_obj_val: 66.21438598632812, obj_val: 66.21098327636719, abs dis: 0.0034027099609375
[rfa agg] iter: 7, weight: tensor([0.1817, 0.0370, 0.1228, 0.0752, 0.1671, 0.0839, 0.0920, 0.0983, 0.1321,
        0.0099])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 14.1880, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 15.9751, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.89520144462585 sec.
Server Epoch:81 choose agents : [96, 50, 54, 97, 92, 82, 79, 65, 95, 81].
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0936, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0629, Accuracy: 80/311 (25.7235%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1847, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0690, Accuracy: 105/809 (12.9790%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0307, Accuracy: 325/809 (40.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.8443, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0616, Accuracy: 291/1130 (25.7522%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0316, Accuracy: 424/1130 (37.5221%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0374, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   1, Avg loss: 0.0724, Accuracy: 269/1213 (22.1764%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   2, Avg loss: 0.0306, Accuracy: 464/1213 (38.2523%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0606, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0633, Accuracy: 334/1715 (19.4752%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0340, Accuracy: 594/1715 (34.6356%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7604, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   1, Avg loss: 0.0869, Accuracy: 24/500 (4.8000%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   2, Avg loss: 0.0532, Accuracy: 213/500 (42.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.0337, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   1, Avg loss: 0.1133, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   2, Avg loss: 0.0951, Accuracy: 2/197 (1.0152%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.3507, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   1, Avg loss: 0.0595, Accuracy: 365/1475 (24.7458%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   2, Avg loss: 0.0341, Accuracy: 581/1475 (39.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6119, Accuracy: 87/10000 (0.8700%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0555, Accuracy: 255/599 (42.5710%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0322, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.6405, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0918, Accuracy: 86/774 (11.1111%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0412, Accuracy: 349/774 (45.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.4286, Accuracy: 73/10000 (0.7300%)
time spent on training: 237.68503308296204
[rfa agg] training data poison_ratio: 0.06866903588215063  data num: [311, 809, 1130, 1213, 1715, 500, 197, 1475, 599, 774]
[rfa agg] considering poison per batch poison_fraction: 0.021459073713172072
[rfa agg] init. name: [96, 50, 54, 97, 92, 82, 79, 65, 95, 81], weight: tensor([0.0357, 0.0927, 0.1295, 0.1391, 0.1966, 0.0573, 0.0226, 0.1691, 0.0687,
        0.0887])
[rfa agg] iter:  0, prev_obj_val: 65.86787414550781, obj_val: 66.5315170288086, abs dis: 0.6636428833007812
[rfa agg] iter: 0, weight: tensor([0.0183, 0.1304, 0.2136, 0.1941, 0.1004, 0.0407, 0.0104, 0.1135, 0.0617,
        0.1170])
[rfa agg] iter:  1, prev_obj_val: 66.5315170288086, obj_val: 67.68360900878906, abs dis: 1.1520919799804688
[rfa agg] iter: 1, weight: tensor([0.0187, 0.1451, 0.2096, 0.1817, 0.0935, 0.0424, 0.0106, 0.1051, 0.0654,
        0.1280])
[rfa agg] iter:  2, prev_obj_val: 67.68360900878906, obj_val: 70.43134307861328, abs dis: 2.7477340698242188
[rfa agg] iter: 2, weight: tensor([0.0196, 0.1616, 0.1920, 0.1672, 0.0906, 0.0454, 0.0111, 0.1009, 0.0711,
        0.1405])
[rfa agg] iter:  3, prev_obj_val: 70.43134307861328, obj_val: 72.00737762451172, abs dis: 1.5760345458984375
[rfa agg] iter: 3, weight: tensor([0.0215, 0.1918, 0.1591, 0.1421, 0.0843, 0.0517, 0.0119, 0.0923, 0.0837,
        0.1615])
[rfa agg] iter:  4, prev_obj_val: 72.00737762451172, obj_val: 71.99734497070312, abs dis: 0.01003265380859375
[rfa agg] iter: 4, weight: tensor([0.0223, 0.2079, 0.1429, 0.1294, 0.0804, 0.0549, 0.0123, 0.0873, 0.0909,
        0.1717])
[rfa agg] iter:  5, prev_obj_val: 71.99734497070312, obj_val: 71.99710845947266, abs dis: 0.00023651123046875
[rfa agg] iter: 5, weight: tensor([0.0221, 0.2114, 0.1411, 0.1278, 0.0797, 0.0546, 0.0122, 0.0866, 0.0908,
        0.1736])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 17.2843, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 17.7030, Accuracy: 0/9950 (0.0000%)
saving model
Done in 394.90604972839355 sec.
Server Epoch:82 choose agents : [64, 98, 19, 25, 53, 74, 65, 96, 58, 16].
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0684, Accuracy: 137/953 (14.3757%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.9465, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   1, Avg loss: 0.1114, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   2, Avg loss: 0.0677, Accuracy: 57/373 (15.2815%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3077, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   1, Avg loss: 0.0526, Accuracy: 340/1036 (32.8185%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   2, Avg loss: 0.0269, Accuracy: 623/1036 (60.1351%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.9888, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   1, Avg loss: 0.0668, Accuracy: 196/690 (28.4058%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/690 (65.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.8724, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   1, Avg loss: 0.0534, Accuracy: 241/813 (29.6433%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 433/813 (53.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 13.2050, Accuracy: 56/10000 (0.5600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0508, Accuracy: 383/1552 (24.6778%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0231, Accuracy: 718/1552 (46.2629%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.4208, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 369/1475 (25.0169%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 613/1475 (41.5593%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6080, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   1, Avg loss: 0.0956, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   2, Avg loss: 0.0633, Accuracy: 78/311 (25.0804%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9281, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0769, Accuracy: 197/803 (24.5330%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0421, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.9463, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1, Avg loss: 0.0678, Accuracy: 171/708 (24.1525%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2, Avg loss: 0.0412, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6158, Accuracy: 52/10000 (0.5200%)
time spent on training: 278.3936622142792
[rfa agg] training data poison_ratio: 0.17810420013770945  data num: [953, 373, 1036, 690, 813, 1552, 1475, 311, 803, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0556575625430342
[rfa agg] init. name: [64, 98, 19, 25, 53, 74, 65, 96, 58, 16], weight: tensor([0.1094, 0.0428, 0.1189, 0.0792, 0.0933, 0.1781, 0.1693, 0.0357, 0.0922,
        0.0812])
[rfa agg] iter:  0, prev_obj_val: 58.55260467529297, obj_val: 63.147789001464844, abs dis: 4.595184326171875
[rfa agg] iter: 0, weight: tensor([0.1809, 0.0226, 0.1542, 0.0844, 0.1449, 0.0777, 0.0800, 0.0168, 0.1494,
        0.0891])
[rfa agg] iter:  1, prev_obj_val: 63.147789001464844, obj_val: 63.06041717529297, abs dis: 0.087371826171875
[rfa agg] iter: 1, weight: tensor([0.1408, 0.0272, 0.1071, 0.1160, 0.1741, 0.0634, 0.0646, 0.0197, 0.1792,
        0.1078])
[rfa agg] iter:  2, prev_obj_val: 63.06041717529297, obj_val: 63.05938720703125, abs dis: 0.00102996826171875
[rfa agg] iter: 2, weight: tensor([0.1346, 0.0270, 0.1038, 0.1187, 0.1774, 0.0621, 0.0633, 0.0195, 0.1845,
        0.1091])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 36.3022, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 34.8194, Accuracy: 0/9950 (0.0000%)
saving model
Done in 432.9791262149811 sec.
Server Epoch:83 choose agents : [63, 88, 39, 85, 65, 22, 50, 86, 14, 33].
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   1, Avg loss: 0.0584, Accuracy: 174/888 (19.5946%)
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.6644, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   1, Avg loss: 0.0800, Accuracy: 89/603 (14.7595%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   2, Avg loss: 0.0507, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.9578, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   1, Avg loss: 0.0597, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.2279, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   1, Avg loss: 0.0628, Accuracy: 334/1988 (16.8008%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   2, Avg loss: 0.0386, Accuracy: 578/1988 (29.0744%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8743, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 374/1475 (25.3559%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 604/1475 (40.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4405, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   1, Avg loss: 0.0576, Accuracy: 367/1470 (24.9660%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 811/1470 (55.1701%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.5488, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   1, Avg loss: 0.0664, Accuracy: 136/809 (16.8109%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   2, Avg loss: 0.0295, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.7618, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   1, Avg loss: 0.0642, Accuracy: 258/1003 (25.7228%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4656, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   1, Avg loss: 0.0761, Accuracy: 143/1013 (14.1165%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   2, Avg loss: 0.0397, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8147, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.1047, Accuracy: 2/515 (0.3883%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0669, Accuracy: 107/515 (20.7767%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1198, Accuracy: 57/10000 (0.5700%)
time spent on training: 242.66477298736572
[rfa agg] training data poison_ratio: 0.0  data num: [888, 603, 1013, 1988, 1475, 1470, 809, 1003, 1013, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 88, 39, 85, 65, 22, 50, 86, 14, 33], weight: tensor([0.0824, 0.0560, 0.0940, 0.1845, 0.1369, 0.1364, 0.0751, 0.0931, 0.0940,
        0.0478])
[rfa agg] iter:  0, prev_obj_val: 65.55615234375, obj_val: 67.97103881835938, abs dis: 2.414886474609375
[rfa agg] iter: 0, weight: tensor([0.1001, 0.0391, 0.1638, 0.0681, 0.0991, 0.1172, 0.0805, 0.1585, 0.1450,
        0.0286])
[rfa agg] iter:  1, prev_obj_val: 67.97103881835938, obj_val: 73.12171936035156, abs dis: 5.1506805419921875
[rfa agg] iter: 1, weight: tensor([0.1276, 0.0447, 0.1759, 0.0520, 0.0697, 0.0803, 0.1027, 0.1652, 0.1511,
        0.0309])
[rfa agg] iter:  2, prev_obj_val: 73.12171936035156, obj_val: 71.0795669555664, abs dis: 2.0421524047851562
[rfa agg] iter: 2, weight: tensor([0.1564, 0.0593, 0.1473, 0.0495, 0.0627, 0.0707, 0.1423, 0.1398, 0.1335,
        0.0385])
[rfa agg] iter:  3, prev_obj_val: 71.0795669555664, obj_val: 71.07762908935547, abs dis: 0.0019378662109375
[rfa agg] iter: 3, weight: tensor([0.1555, 0.0531, 0.1545, 0.0494, 0.0636, 0.0721, 0.1323, 0.1453, 0.1389,
        0.0353])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 15.8420, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 15.0953, Accuracy: 0/9950 (0.0000%)
saving model
Done in 401.2214365005493 sec.
Server Epoch:84 choose agents : [46, 69, 35, 2, 38, 61, 48, 80, 0, 84].
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   1, Avg loss: 0.0623, Accuracy: 346/1904 (18.1723%)
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   2, Avg loss: 0.0329, Accuracy: 651/1904 (34.1912%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.4114, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   1, Avg loss: 0.0627, Accuracy: 199/590 (33.7288%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   2, Avg loss: 0.0388, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 13.4972, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1325, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0929, Accuracy: 21/271 (7.7491%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5593, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0780, Accuracy: 110/605 (18.1818%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0441, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.4980, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0645, Accuracy: 280/1131 (24.7569%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0320, Accuracy: 500/1131 (44.2087%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9958, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1365, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1271, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.8835, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   1, Avg loss: 0.0822, Accuracy: 41/631 (6.4976%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   2, Avg loss: 0.0473, Accuracy: 238/631 (37.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1679, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0686, Accuracy: 87/682 (12.7566%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.7654, Accuracy: 63/10000 (0.6300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0641, Accuracy: 285/1657 (17.1998%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0378, Accuracy: 469/1657 (28.3042%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.7662, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   1, Avg loss: 0.0690, Accuracy: 238/1190 (20.0000%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9311, Accuracy: 75/10000 (0.7500%)
time spent on training: 236.7589294910431
[rfa agg] training data poison_ratio: 0.18945803796021038  data num: [1904, 590, 271, 605, 1131, 85, 631, 682, 1657, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.05920563686256575
[rfa agg] init. name: [46, 69, 35, 2, 38, 61, 48, 80, 0, 84], weight: tensor([0.2177, 0.0675, 0.0310, 0.0692, 0.1293, 0.0097, 0.0721, 0.0780, 0.1895,
        0.1361])
[rfa agg] iter:  0, prev_obj_val: 75.12866973876953, obj_val: 76.37024688720703, abs dis: 1.2415771484375
[rfa agg] iter: 0, weight: tensor([0.1133, 0.0568, 0.0159, 0.0576, 0.2419, 0.0038, 0.0611, 0.0746, 0.1382,
        0.2368])
[rfa agg] iter:  1, prev_obj_val: 76.37024688720703, obj_val: 76.36329650878906, abs dis: 0.00695037841796875
[rfa agg] iter: 1, weight: tensor([0.1024, 0.0623, 0.0167, 0.0630, 0.2518, 0.0039, 0.0673, 0.0826, 0.1224,
        0.2276])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 12.7520, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 9.1783, Accuracy: 16/9950 (0.1608%)
saving model
Done in 392.7161455154419 sec.
Server Epoch:85 choose agents : [10, 27, 58, 65, 60, 31, 40, 48, 2, 16].
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   1, Avg loss: 0.0690, Accuracy: 128/861 (14.8664%)
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   2, Avg loss: 0.0239, Accuracy: 395/861 (45.8769%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 11.6817, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   1, Avg loss: 0.0622, Accuracy: 337/1587 (21.2350%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   2, Avg loss: 0.0375, Accuracy: 492/1587 (31.0019%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6585, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0757, Accuracy: 199/803 (24.7821%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0428, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6912, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 387/1475 (26.2373%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2, Avg loss: 0.0352, Accuracy: 571/1475 (38.7119%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6486, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   1, Avg loss: 0.0578, Accuracy: 483/2227 (21.6884%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   2, Avg loss: 0.0315, Accuracy: 913/2227 (40.9969%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0969, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0972, Accuracy: 21/460 (4.5652%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0482, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.9782, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   1, Avg loss: 0.0714, Accuracy: 243/1573 (15.4482%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   2, Avg loss: 0.0397, Accuracy: 531/1573 (33.7572%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.1401, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   1, Avg loss: 0.0819, Accuracy: 35/631 (5.5468%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   2, Avg loss: 0.0476, Accuracy: 238/631 (37.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.8274, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0760, Accuracy: 127/605 (20.9917%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0437, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3642, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   1, Avg loss: 0.0656, Accuracy: 191/708 (26.9774%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   2, Avg loss: 0.0385, Accuracy: 431/708 (60.8757%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.7080, Accuracy: 65/10000 (0.6500%)
time spent on training: 248.7515664100647
[rfa agg] training data poison_ratio: 0.0787740164684355  data num: [861, 1587, 803, 1475, 2227, 460, 1573, 631, 605, 708]
[rfa agg] considering poison per batch poison_fraction: 0.024616880146386095
[rfa agg] init. name: [10, 27, 58, 65, 60, 31, 40, 48, 2, 16], weight: tensor([0.0788, 0.1452, 0.0735, 0.1349, 0.2038, 0.0421, 0.1439, 0.0577, 0.0554,
        0.0648])
[rfa agg] iter:  0, prev_obj_val: 82.14131164550781, obj_val: 83.65182495117188, abs dis: 1.5105133056640625
[rfa agg] iter: 0, weight: tensor([0.0932, 0.1910, 0.0781, 0.1739, 0.1050, 0.0273, 0.1853, 0.0445, 0.0422,
        0.0595])
[rfa agg] iter:  1, prev_obj_val: 83.65182495117188, obj_val: 86.67984008789062, abs dis: 3.02801513671875
[rfa agg] iter: 1, weight: tensor([0.1086, 0.1731, 0.0907, 0.1643, 0.0998, 0.0300, 0.1690, 0.0499, 0.0472,
        0.0674])
[rfa agg] iter:  2, prev_obj_val: 86.67984008789062, obj_val: 87.75111389160156, abs dis: 1.0712738037109375
[rfa agg] iter: 2, weight: tensor([0.1380, 0.1445, 0.1142, 0.1395, 0.0920, 0.0344, 0.1418, 0.0589, 0.0554,
        0.0814])
[rfa agg] iter:  3, prev_obj_val: 87.75111389160156, obj_val: 86.64080047607422, abs dis: 1.1103134155273438
[rfa agg] iter: 3, weight: tensor([0.1514, 0.1338, 0.1239, 0.1292, 0.0880, 0.0357, 0.1317, 0.0618, 0.0581,
        0.0865])
[rfa agg] iter:  4, prev_obj_val: 86.64080047607422, obj_val: 86.6364517211914, abs dis: 0.0043487548828125
[rfa agg] iter: 4, weight: tensor([0.1421, 0.1425, 0.1157, 0.1369, 0.0914, 0.0344, 0.1402, 0.0590, 0.0557,
        0.0821])
[rfa agg] iter:  5, prev_obj_val: 86.6364517211914, obj_val: 87.74911499023438, abs dis: 1.1126632690429688
[rfa agg] iter: 5, weight: tensor([0.1412, 0.1430, 0.1154, 0.1375, 0.0915, 0.0344, 0.1405, 0.0589, 0.0556,
        0.0820])
[rfa agg] iter:  6, prev_obj_val: 87.74911499023438, obj_val: 86.64091491699219, abs dis: 1.1082000732421875
[rfa agg] iter: 6, weight: tensor([0.1517, 0.1337, 0.1240, 0.1291, 0.0879, 0.0357, 0.1316, 0.0618, 0.0581,
        0.0865])
[rfa agg] iter:  7, prev_obj_val: 86.64091491699219, obj_val: 86.63644409179688, abs dis: 0.0044708251953125
[rfa agg] iter: 7, weight: tensor([0.1422, 0.1425, 0.1157, 0.1369, 0.0914, 0.0344, 0.1402, 0.0590, 0.0557,
        0.0821])
[rfa agg] iter:  8, prev_obj_val: 86.63644409179688, obj_val: 87.74911499023438, abs dis: 1.1126708984375
[rfa agg] iter: 8, weight: tensor([0.1412, 0.1430, 0.1154, 0.1375, 0.0915, 0.0344, 0.1405, 0.0589, 0.0556,
        0.0820])
[rfa agg] iter:  9, prev_obj_val: 87.74911499023438, obj_val: 86.64091491699219, abs dis: 1.1082000732421875
[rfa agg] iter: 9, weight: tensor([0.1517, 0.1337, 0.1240, 0.1291, 0.0879, 0.0357, 0.1316, 0.0618, 0.0581,
        0.0865])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 12.9373, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 9.1311, Accuracy: 34/9950 (0.3417%)
saving model
Done in 404.7402470111847 sec.
Server Epoch:86 choose agents : [88, 3, 90, 19, 74, 8, 93, 84, 24, 62].
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1, Avg loss: 0.0780, Accuracy: 101/603 (16.7496%)
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2, Avg loss: 0.0491, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.9274, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0807, Accuracy: 79/781 (10.1152%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0394, Accuracy: 206/781 (26.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.4208, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   1, Avg loss: 0.0593, Accuracy: 237/677 (35.0074%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.3343, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0504, Accuracy: 351/1036 (33.8803%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0270, Accuracy: 651/1036 (62.8378%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.2804, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0507, Accuracy: 369/1552 (23.7758%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0234, Accuracy: 686/1552 (44.2010%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.0859, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   1, Avg loss: 0.0719, Accuracy: 197/1513 (13.0205%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   2, Avg loss: 0.0411, Accuracy: 386/1513 (25.5122%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.8548, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   1, Avg loss: 0.0714, Accuracy: 274/1742 (15.7290%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   2, Avg loss: 0.0359, Accuracy: 606/1742 (34.7876%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3719, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0691, Accuracy: 247/1190 (20.7563%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0346, Accuracy: 442/1190 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1636, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0875, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0463, Accuracy: 114/312 (36.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.8402, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   1, Avg loss: 0.0707, Accuracy: 99/568 (17.4296%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   2, Avg loss: 0.0450, Accuracy: 258/568 (45.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.5165, Accuracy: 62/10000 (0.6200%)
time spent on training: 278.6152775287628
[rfa agg] training data poison_ratio: 0.15560457188690596  data num: [603, 781, 677, 1036, 1552, 1513, 1742, 1190, 312, 568]
[rfa agg] considering poison per batch poison_fraction: 0.04862642871465811
[rfa agg] init. name: [88, 3, 90, 19, 74, 8, 93, 84, 24, 62], weight: tensor([0.0605, 0.0783, 0.0679, 0.1039, 0.1556, 0.1517, 0.1747, 0.1193, 0.0313,
        0.0569])
[rfa agg] iter:  0, prev_obj_val: 67.7457504272461, obj_val: 70.7373275756836, abs dis: 2.9915771484375
[rfa agg] iter: 0, weight: tensor([0.0486, 0.0922, 0.0601, 0.2180, 0.1180, 0.1293, 0.0991, 0.1786, 0.0151,
        0.0410])
[rfa agg] iter:  1, prev_obj_val: 70.7373275756836, obj_val: 70.71271514892578, abs dis: 0.0246124267578125
[rfa agg] iter: 1, weight: tensor([0.0577, 0.1155, 0.0720, 0.2383, 0.0991, 0.1075, 0.0857, 0.1597, 0.0166,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 70.71271514892578, obj_val: 72.15032958984375, abs dis: 1.4376144409179688
[rfa agg] iter: 2, weight: tensor([0.0575, 0.1162, 0.0720, 0.2433, 0.0981, 0.1064, 0.0850, 0.1575, 0.0165,
        0.0475])
[rfa agg] iter:  3, prev_obj_val: 72.15032958984375, obj_val: 75.42752838134766, abs dis: 3.2771987915039062
[rfa agg] iter: 3, weight: tensor([0.0629, 0.1286, 0.0788, 0.2293, 0.0954, 0.1030, 0.0834, 0.1495, 0.0175,
        0.0515])
[rfa agg] iter:  4, prev_obj_val: 75.42752838134766, obj_val: 72.16484069824219, abs dis: 3.2626876831054688
[rfa agg] iter: 4, weight: tensor([0.0758, 0.1565, 0.0951, 0.1919, 0.0900, 0.0964, 0.0800, 0.1338, 0.0196,
        0.0610])
[rfa agg] iter:  5, prev_obj_val: 72.16484069824219, obj_val: 75.4202651977539, abs dis: 3.2554244995117188
[rfa agg] iter: 5, weight: tensor([0.0639, 0.1339, 0.0804, 0.2199, 0.0961, 0.1037, 0.0840, 0.1484, 0.0177,
        0.0522])
[rfa agg] iter:  6, prev_obj_val: 75.4202651977539, obj_val: 72.16571044921875, abs dis: 3.2545547485351562
[rfa agg] iter: 6, weight: tensor([0.0758, 0.1575, 0.0952, 0.1907, 0.0901, 0.0964, 0.0800, 0.1337, 0.0196,
        0.0610])
[rfa agg] iter:  7, prev_obj_val: 72.16571044921875, obj_val: 75.42013549804688, abs dis: 3.254425048828125
[rfa agg] iter: 7, weight: tensor([0.0639, 0.1340, 0.0804, 0.2197, 0.0961, 0.1037, 0.0840, 0.1484, 0.0177,
        0.0522])
[rfa agg] iter:  8, prev_obj_val: 75.42013549804688, obj_val: 72.16571807861328, abs dis: 3.2544174194335938
[rfa agg] iter: 8, weight: tensor([0.0758, 0.1575, 0.0952, 0.1906, 0.0901, 0.0964, 0.0800, 0.1337, 0.0196,
        0.0610])
[rfa agg] iter:  9, prev_obj_val: 72.16571807861328, obj_val: 75.42013549804688, abs dis: 3.2544174194335938
[rfa agg] iter: 9, weight: tensor([0.0639, 0.1340, 0.0804, 0.2197, 0.0961, 0.1037, 0.0840, 0.1484, 0.0177,
        0.0522])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.5101, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 11.0716, Accuracy: 1/9950 (0.0101%)
saving model
Done in 436.08908319473267 sec.
Server Epoch:87 choose agents : [61, 30, 64, 21, 37, 89, 86, 47, 43, 63].
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1469, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1365, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4504, Accuracy: 46/10000 (0.4600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   1, Avg loss: 0.0932, Accuracy: 15/486 (3.0864%)
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   2, Avg loss: 0.0443, Accuracy: 198/486 (40.7407%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.1658, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   1, Avg loss: 0.0694, Accuracy: 112/953 (11.7524%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 286/953 (30.0105%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0075, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1, Avg loss: 0.0622, Accuracy: 287/1949 (14.7255%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2, Avg loss: 0.0364, Accuracy: 542/1949 (27.8091%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.2020, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   1, Avg loss: 0.0551, Accuracy: 322/1129 (28.5208%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   2, Avg loss: 0.0286, Accuracy: 660/1129 (58.4588%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.0991, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   1, Avg loss: 0.0657, Accuracy: 260/896 (29.0179%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   2, Avg loss: 0.0365, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6091, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0645, Accuracy: 266/1003 (26.5204%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0373, Accuracy: 401/1003 (39.9801%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6676, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1404, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1296, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8944, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0712, Accuracy: 263/946 (27.8013%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0380, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9123, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   1, Avg loss: 0.0571, Accuracy: 200/888 (22.5225%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   2, Avg loss: 0.0269, Accuracy: 462/888 (52.0270%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.1323, Accuracy: 75/10000 (0.7500%)
time spent on training: 236.84146881103516
[rfa agg] training data poison_ratio: 0.057385759829968117  data num: [85, 486, 953, 1949, 1129, 896, 1003, 134, 946, 888]
[rfa agg] considering poison per batch poison_fraction: 0.017933049946865037
[rfa agg] init. name: [61, 30, 64, 21, 37, 89, 86, 47, 43, 63], weight: tensor([0.0100, 0.0574, 0.1125, 0.2301, 0.1333, 0.1058, 0.1184, 0.0158, 0.1117,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 61.26969528198242, obj_val: 67.9593505859375, abs dis: 6.689655303955078
[rfa agg] iter: 0, weight: tensor([0.0028, 0.0311, 0.1632, 0.0625, 0.1386, 0.1382, 0.1624, 0.0049, 0.1601,
        0.1362])
[rfa agg] iter:  1, prev_obj_val: 67.9593505859375, obj_val: 67.9092025756836, abs dis: 0.05014801025390625
[rfa agg] iter: 1, weight: tensor([0.0035, 0.0464, 0.1526, 0.0571, 0.1033, 0.1744, 0.1329, 0.0062, 0.1535,
        0.1701])
[rfa agg] iter:  2, prev_obj_val: 67.9092025756836, obj_val: 65.59483337402344, abs dis: 2.3143692016601562
[rfa agg] iter: 2, weight: tensor([0.0035, 0.0462, 0.1505, 0.0564, 0.1010, 0.1794, 0.1300, 0.0062, 0.1518,
        0.1751])
[rfa agg] iter:  3, prev_obj_val: 65.59483337402344, obj_val: 65.59418487548828, abs dis: 0.00064849853515625
[rfa agg] iter: 3, weight: tensor([0.0032, 0.0403, 0.1531, 0.0545, 0.1018, 0.1791, 0.1331, 0.0056, 0.1549,
        0.1745])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1471, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 3.4568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.07478380203247 sec.
Server Epoch:88 choose agents : [90, 31, 58, 73, 91, 48, 27, 50, 35, 61].
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1, Avg loss: 0.0616, Accuracy: 208/677 (30.7238%)
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 12.6865, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0931, Accuracy: 25/460 (5.4348%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0479, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.7993, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   1, Avg loss: 0.0740, Accuracy: 206/803 (25.6538%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   2, Avg loss: 0.0423, Accuracy: 437/803 (54.4209%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8662, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1, Avg loss: 0.0645, Accuracy: 193/938 (20.5757%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2, Avg loss: 0.0387, Accuracy: 352/938 (37.5267%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.0512, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1, Avg loss: 0.0703, Accuracy: 202/1030 (19.6117%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2, Avg loss: 0.0280, Accuracy: 622/1030 (60.3883%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.5359, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0834, Accuracy: 41/631 (6.4976%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0470, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7776, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   1, Avg loss: 0.0621, Accuracy: 333/1587 (20.9830%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   2, Avg loss: 0.0362, Accuracy: 521/1587 (32.8292%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5971, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   1, Avg loss: 0.0637, Accuracy: 137/809 (16.9345%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   2, Avg loss: 0.0311, Accuracy: 322/809 (39.8022%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.6256, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2, Avg loss: 0.0900, Accuracy: 22/271 (8.1181%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5993, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1427, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1325, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9107, Accuracy: 38/10000 (0.3800%)
time spent on training: 224.48568034172058
[rfa agg] training data poison_ratio: 0.0  data num: [677, 460, 803, 938, 1030, 631, 1587, 809, 271, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 31, 58, 73, 91, 48, 27, 50, 35, 61], weight: tensor([0.0929, 0.0631, 0.1101, 0.1287, 0.1413, 0.0865, 0.2177, 0.1110, 0.0372,
        0.0117])
[rfa agg] iter:  0, prev_obj_val: 56.2718620300293, obj_val: 60.25183868408203, abs dis: 3.9799766540527344
[rfa agg] iter: 0, weight: tensor([0.1341, 0.0531, 0.1768, 0.1427, 0.0992, 0.1079, 0.0769, 0.1854, 0.0197,
        0.0041])
[rfa agg] iter:  1, prev_obj_val: 60.25183868408203, obj_val: 60.19785690307617, abs dis: 0.053981781005859375
[rfa agg] iter: 1, weight: tensor([0.1683, 0.0687, 0.1582, 0.1168, 0.0823, 0.1463, 0.0683, 0.1633, 0.0232,
        0.0046])
[rfa agg] iter:  2, prev_obj_val: 60.19785690307617, obj_val: 58.390113830566406, abs dis: 1.8077430725097656
[rfa agg] iter: 2, weight: tensor([0.1743, 0.0691, 0.1564, 0.1142, 0.0805, 0.1513, 0.0674, 0.1591, 0.0231,
        0.0045])
[rfa agg] iter:  3, prev_obj_val: 58.390113830566406, obj_val: 62.323970794677734, abs dis: 3.933856964111328
[rfa agg] iter: 3, weight: tensor([0.1676, 0.0618, 0.1678, 0.1204, 0.0823, 0.1358, 0.0680, 0.1705, 0.0213,
        0.0043])
[rfa agg] iter:  4, prev_obj_val: 62.323970794677734, obj_val: 62.304710388183594, abs dis: 0.019260406494140625
[rfa agg] iter: 4, weight: tensor([0.1761, 0.0777, 0.1467, 0.1096, 0.0794, 0.1639, 0.0675, 0.1490, 0.0253,
        0.0048])
[rfa agg] iter:  5, prev_obj_val: 62.304710388183594, obj_val: 62.30442810058594, abs dis: 0.00028228759765625
[rfa agg] iter: 5, weight: tensor([0.1772, 0.0784, 0.1448, 0.1084, 0.0788, 0.1687, 0.0671, 0.1464, 0.0253,
        0.0048])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1077, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 3.2556, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.4604208469391 sec.
Server Epoch:89 choose agents : [66, 87, 89, 19, 67, 71, 31, 39, 91, 84].
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0727, Accuracy: 150/1402 (10.6990%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0425, Accuracy: 310/1402 (22.1113%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.0248, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   1, Avg loss: 0.0615, Accuracy: 227/1131 (20.0707%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   2, Avg loss: 0.0345, Accuracy: 404/1131 (35.7206%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.7288, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0662, Accuracy: 248/896 (27.6786%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0364, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.9427, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   1, Avg loss: 0.0492, Accuracy: 364/1036 (35.1351%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 644/1036 (62.1622%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 12.7691, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0934, Accuracy: 19/426 (4.4601%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0548, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.0165, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   1, Avg loss: 0.0660, Accuracy: 95/818 (11.6137%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   2, Avg loss: 0.0332, Accuracy: 319/818 (38.9976%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.7426, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   1, Avg loss: 0.0953, Accuracy: 29/460 (6.3043%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   2, Avg loss: 0.0498, Accuracy: 179/460 (38.9130%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.3569, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0548, Accuracy: 261/1013 (25.7651%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0294, Accuracy: 459/1013 (45.3110%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.1548, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   1, Avg loss: 0.0712, Accuracy: 192/1030 (18.6408%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   2, Avg loss: 0.0279, Accuracy: 588/1030 (57.0874%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.6225, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0672, Accuracy: 257/1190 (21.5966%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0345, Accuracy: 423/1190 (35.5462%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.2956, Accuracy: 74/10000 (0.7400%)
time spent on training: 217.10550808906555
[rfa agg] training data poison_ratio: 0.0  data num: [1402, 1131, 896, 1036, 426, 818, 460, 1013, 1030, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [66, 87, 89, 19, 67, 71, 31, 39, 91, 84], weight: tensor([0.1491, 0.1203, 0.0953, 0.1102, 0.0453, 0.0870, 0.0489, 0.1077, 0.1096,
        0.1266])
[rfa agg] iter:  0, prev_obj_val: 50.5625, obj_val: 50.415008544921875, abs dis: 0.147491455078125
[rfa agg] iter: 0, weight: tensor([0.0824, 0.1112, 0.1446, 0.1165, 0.0315, 0.1516, 0.0382, 0.1350, 0.0940,
        0.0949])
[rfa agg] iter:  1, prev_obj_val: 50.415008544921875, obj_val: 50.413612365722656, abs dis: 0.00139617919921875
[rfa agg] iter: 1, weight: tensor([0.0799, 0.1091, 0.1504, 0.1147, 0.0309, 0.1596, 0.0375, 0.1346, 0.0912,
        0.0921])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 14.4727, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 10.5674, Accuracy: 13/9950 (0.1307%)
saving model
Done in 374.10289883613586 sec.
Server Epoch:90 choose agents : [46, 51, 28, 5, 48, 71, 20, 24, 41, 17].
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   1, Avg loss: 0.0650, Accuracy: 324/1904 (17.0168%)
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   2, Avg loss: 0.0331, Accuracy: 644/1904 (33.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5344, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0668, Accuracy: 174/1049 (16.5872%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0333, Accuracy: 460/1049 (43.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.8137, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0726, Accuracy: 300/1581 (18.9753%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0386, Accuracy: 496/1581 (31.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5095, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   1, Avg loss: 0.0624, Accuracy: 311/1628 (19.1032%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   2, Avg loss: 0.0284, Accuracy: 730/1628 (44.8403%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0102, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   1, Avg loss: 0.0815, Accuracy: 52/631 (8.2409%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   2, Avg loss: 0.0461, Accuracy: 233/631 (36.9255%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6645, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0671, Accuracy: 97/818 (11.8582%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 309/818 (37.7751%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0527, Accuracy: 74/10000 (0.7400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   1, Avg loss: 0.0673, Accuracy: 203/807 (25.1549%)
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   2, Avg loss: 0.0342, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8420, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0971, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0525, Accuracy: 101/312 (32.3718%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.5978, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0679, Accuracy: 231/719 (32.1280%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0370, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0004, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   1, Avg loss: 0.0597, Accuracy: 310/1574 (19.6950%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   2, Avg loss: 0.0303, Accuracy: 585/1574 (37.1665%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.8329, Accuracy: 91/10000 (0.9100%)
time spent on training: 272.33604645729065
[rfa agg] training data poison_ratio: 0.07321055973872811  data num: [1904, 1049, 1581, 1628, 631, 818, 807, 312, 719, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.022878299918352538
[rfa agg] init. name: [46, 51, 28, 5, 48, 71, 20, 24, 41, 17], weight: tensor([0.1727, 0.0952, 0.1434, 0.1477, 0.0572, 0.0742, 0.0732, 0.0283, 0.0652,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 72.8651123046875, obj_val: 73.80402374267578, abs dis: 0.9389114379882812
[rfa agg] iter: 0, weight: tensor([0.1130, 0.1577, 0.1492, 0.1410, 0.0461, 0.0822, 0.0806, 0.0146, 0.0620,
        0.1535])
[rfa agg] iter:  1, prev_obj_val: 73.80402374267578, obj_val: 74.91914367675781, abs dis: 1.1151199340820312
[rfa agg] iter: 1, weight: tensor([0.1071, 0.1746, 0.1407, 0.1319, 0.0481, 0.0875, 0.0859, 0.0150, 0.0651,
        0.1443])
[rfa agg] iter:  2, prev_obj_val: 74.91914367675781, obj_val: 74.91386413574219, abs dis: 0.005279541015625
[rfa agg] iter: 2, weight: tensor([0.1026, 0.1848, 0.1325, 0.1244, 0.0505, 0.0936, 0.0919, 0.0155, 0.0689,
        0.1354])
[rfa agg] iter:  3, prev_obj_val: 74.91386413574219, obj_val: 74.91378021240234, abs dis: 8.392333984375e-05
[rfa agg] iter: 3, weight: tensor([0.1023, 0.1870, 0.1318, 0.1238, 0.0504, 0.0936, 0.0919, 0.0154, 0.0689,
        0.1348])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 12.5514, Accuracy: 33/10000 (0.3300%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 8.6003, Accuracy: 37/9950 (0.3719%)
saving model
Done in 428.3925335407257 sec.
Server Epoch:91 choose agents : [26, 43, 41, 42, 36, 81, 31, 76, 8, 57].
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   1, Avg loss: 0.0580, Accuracy: 319/1446 (22.0609%)
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   2, Avg loss: 0.0374, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3522, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0695, Accuracy: 251/946 (26.5328%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0390, Accuracy: 339/946 (35.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1304, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   1, Avg loss: 0.0665, Accuracy: 220/719 (30.5981%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   2, Avg loss: 0.0384, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.1729, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   1, Avg loss: 0.0719, Accuracy: 189/1372 (13.7755%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   2, Avg loss: 0.0363, Accuracy: 465/1372 (33.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.9081, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.1030, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0615, Accuracy: 129/408 (31.6176%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5938, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   1, Avg loss: 0.0860, Accuracy: 80/774 (10.3359%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   2, Avg loss: 0.0412, Accuracy: 345/774 (44.5736%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.0903, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   1, Avg loss: 0.0943, Accuracy: 24/460 (5.2174%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   2, Avg loss: 0.0475, Accuracy: 174/460 (37.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.5613, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   1, Avg loss: 0.0907, Accuracy: 2/466 (0.4292%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   2, Avg loss: 0.0522, Accuracy: 171/466 (36.6953%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5127, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   1, Avg loss: 0.0714, Accuracy: 212/1513 (14.0119%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   2, Avg loss: 0.0400, Accuracy: 409/1513 (27.0324%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5177, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   1, Avg loss: 0.0690, Accuracy: 223/1154 (19.3241%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   2, Avg loss: 0.0300, Accuracy: 416/1154 (36.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.4738, Accuracy: 56/10000 (0.5600%)
time spent on training: 259.1434223651886
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 946, 719, 1372, 408, 774, 460, 466, 1513, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 43, 41, 42, 36, 81, 31, 76, 8, 57], weight: tensor([0.1562, 0.1022, 0.0777, 0.1482, 0.0441, 0.0836, 0.0497, 0.0503, 0.1634,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 63.60710144042969, obj_val: 63.431949615478516, abs dis: 0.17515182495117188
[rfa agg] iter: 0, weight: tensor([0.1127, 0.2073, 0.1055, 0.1177, 0.0318, 0.1253, 0.0401, 0.0408, 0.1059,
        0.1131])
[rfa agg] iter:  1, prev_obj_val: 63.431949615478516, obj_val: 64.75006103515625, abs dis: 1.3181114196777344
[rfa agg] iter: 1, weight: tensor([0.1088, 0.2261, 0.1041, 0.1138, 0.0309, 0.1264, 0.0389, 0.0397, 0.1020,
        0.1093])
[rfa agg] iter:  2, prev_obj_val: 64.75006103515625, obj_val: 69.87223815917969, abs dis: 5.1221771240234375
[rfa agg] iter: 2, weight: tensor([0.1031, 0.2271, 0.1115, 0.1074, 0.0326, 0.1335, 0.0412, 0.0421, 0.0971,
        0.1043])
[rfa agg] iter:  3, prev_obj_val: 69.87223815917969, obj_val: 69.82899475097656, abs dis: 0.043243408203125
[rfa agg] iter: 3, weight: tensor([0.0925, 0.1917, 0.1393, 0.0954, 0.0406, 0.1524, 0.0521, 0.0533, 0.0883,
        0.0944])
[rfa agg] iter:  4, prev_obj_val: 69.82899475097656, obj_val: 67.95291137695312, abs dis: 1.8760833740234375
[rfa agg] iter: 4, weight: tensor([0.0918, 0.1847, 0.1446, 0.0947, 0.0405, 0.1573, 0.0521, 0.0535, 0.0877,
        0.0930])
[rfa agg] iter:  5, prev_obj_val: 67.95291137695312, obj_val: 67.94918823242188, abs dis: 0.00372314453125
[rfa agg] iter: 5, weight: tensor([0.0948, 0.1958, 0.1362, 0.0981, 0.0375, 0.1546, 0.0480, 0.0491, 0.0902,
        0.0957])
[rfa agg] iter:  6, prev_obj_val: 67.94918823242188, obj_val: 69.83193969726562, abs dis: 1.88275146484375
[rfa agg] iter: 6, weight: tensor([0.0949, 0.1981, 0.1347, 0.0982, 0.0375, 0.1535, 0.0479, 0.0491, 0.0902,
        0.0960])
[rfa agg] iter:  7, prev_obj_val: 69.83193969726562, obj_val: 67.95243072509766, abs dis: 1.8795089721679688
[rfa agg] iter: 7, weight: tensor([0.0919, 0.1857, 0.1436, 0.0948, 0.0405, 0.1571, 0.0521, 0.0534, 0.0878,
        0.0932])
[rfa agg] iter:  8, prev_obj_val: 67.95243072509766, obj_val: 67.94918060302734, abs dis: 0.0032501220703125
[rfa agg] iter: 8, weight: tensor([0.0948, 0.1961, 0.1361, 0.0981, 0.0375, 0.1545, 0.0480, 0.0491, 0.0902,
        0.0957])
[rfa agg] iter:  9, prev_obj_val: 67.94918060302734, obj_val: 69.83197021484375, abs dis: 1.8827896118164062
[rfa agg] iter: 9, weight: tensor([0.0949, 0.1982, 0.1347, 0.0982, 0.0375, 0.1535, 0.0479, 0.0491, 0.0902,
        0.0960])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.1213, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 3.2251, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.5293118953705 sec.
Server Epoch:92 choose agents : [38, 36, 76, 12, 77, 96, 67, 3, 53, 25].
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0710, Accuracy: 214/1131 (18.9213%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0338, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8299, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   1, Avg loss: 0.1050, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   2, Avg loss: 0.0624, Accuracy: 128/408 (31.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2512, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 8/466 (1.7167%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 189/466 (40.5579%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.9786, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   1, Avg loss: 0.1167, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   2, Avg loss: 0.0675, Accuracy: 71/338 (21.0059%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0850, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0513, Accuracy: 313/1340 (23.3582%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0289, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.0297, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0985, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0653, Accuracy: 73/311 (23.4727%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1639, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0938, Accuracy: 30/426 (7.0423%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0569, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.9585, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0820, Accuracy: 59/781 (7.5544%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0400, Accuracy: 208/781 (26.6325%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.2974, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   1, Avg loss: 0.0515, Accuracy: 220/813 (27.0603%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   2, Avg loss: 0.0206, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 13.2851, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   1, Avg loss: 0.0663, Accuracy: 188/690 (27.2464%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   2, Avg loss: 0.0304, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.6159, Accuracy: 71/10000 (0.7100%)
time spent on training: 202.8602602481842
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 466, 338, 1340, 311, 426, 781, 813, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 76, 12, 77, 96, 67, 3, 53, 25], weight: tensor([0.1687, 0.0609, 0.0695, 0.0504, 0.1999, 0.0464, 0.0635, 0.1165, 0.1213,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 54.082794189453125, obj_val: 57.33453369140625, abs dis: 3.251739501953125
[rfa agg] iter: 0, weight: tensor([0.1168, 0.0575, 0.0760, 0.0402, 0.0998, 0.0307, 0.0597, 0.1683, 0.1822,
        0.1688])
[rfa agg] iter:  1, prev_obj_val: 57.33453369140625, obj_val: 60.68968963623047, abs dis: 3.3551559448242188
[rfa agg] iter: 1, weight: tensor([0.0984, 0.0754, 0.0994, 0.0511, 0.0875, 0.0374, 0.0786, 0.1407, 0.1512,
        0.1803])
[rfa agg] iter:  2, prev_obj_val: 60.68968963623047, obj_val: 60.64043045043945, abs dis: 0.049259185791015625
[rfa agg] iter: 2, weight: tensor([0.0901, 0.0947, 0.1209, 0.0628, 0.0819, 0.0442, 0.0986, 0.1194, 0.1278,
        0.1596])
[rfa agg] iter:  3, prev_obj_val: 60.64043045043945, obj_val: 58.869449615478516, abs dis: 1.7709808349609375
[rfa agg] iter: 3, weight: tensor([0.0890, 0.0972, 0.1251, 0.0637, 0.0810, 0.0446, 0.1012, 0.1168, 0.1257,
        0.1556])
[rfa agg] iter:  4, prev_obj_val: 58.869449615478516, obj_val: 60.64818572998047, abs dis: 1.7787361145019531
[rfa agg] iter: 4, weight: tensor([0.0929, 0.0879, 0.1165, 0.0580, 0.0837, 0.0415, 0.0915, 0.1252, 0.1356,
        0.1672])
[rfa agg] iter:  5, prev_obj_val: 60.64818572998047, obj_val: 60.6396598815918, abs dis: 0.008525848388671875
[rfa agg] iter: 5, weight: tensor([0.0894, 0.0963, 0.1239, 0.0633, 0.0813, 0.0445, 0.1003, 0.1176, 0.1264,
        0.1570])
[rfa agg] iter:  6, prev_obj_val: 60.6396598815918, obj_val: 58.869956970214844, abs dis: 1.7697029113769531
[rfa agg] iter: 6, weight: tensor([0.0889, 0.0974, 0.1256, 0.0637, 0.0810, 0.0447, 0.1014, 0.1166, 0.1256,
        0.1551])
[rfa agg] iter:  7, prev_obj_val: 58.869956970214844, obj_val: 60.64812088012695, abs dis: 1.7781639099121094
[rfa agg] iter: 7, weight: tensor([0.0929, 0.0879, 0.1166, 0.0580, 0.0836, 0.0415, 0.0916, 0.1252, 0.1356,
        0.1672])
[rfa agg] iter:  8, prev_obj_val: 60.64812088012695, obj_val: 60.6396598815918, abs dis: 0.00846099853515625
[rfa agg] iter: 8, weight: tensor([0.0893, 0.0963, 0.1240, 0.0633, 0.0813, 0.0445, 0.1003, 0.1176, 0.1264,
        0.1570])
[rfa agg] iter:  9, prev_obj_val: 60.6396598815918, obj_val: 58.86996841430664, abs dis: 1.7696914672851562
[rfa agg] iter: 9, weight: tensor([0.0889, 0.0974, 0.1256, 0.0637, 0.0810, 0.0447, 0.1014, 0.1166, 0.1256,
        0.1551])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.1616, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 3.4559, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.30549693107605 sec.
Server Epoch:93 choose agents : [97, 94, 81, 1, 62, 45, 0, 15, 31, 32].
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   1, Avg loss: 0.0664, Accuracy: 257/1213 (21.1871%)
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   2, Avg loss: 0.0299, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.1654, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0732, Accuracy: 222/1662 (13.3574%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0368, Accuracy: 503/1662 (30.2647%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.2739, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   1, Avg loss: 0.0880, Accuracy: 74/774 (9.5607%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   2, Avg loss: 0.0421, Accuracy: 372/774 (48.0620%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.7567, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0731, Accuracy: 198/928 (21.3362%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0286, Accuracy: 531/928 (57.2198%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.1394, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0774, Accuracy: 69/568 (12.1479%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0463, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9584, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0726, Accuracy: 142/669 (21.2257%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0420, Accuracy: 362/669 (54.1106%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9195, Accuracy: 70/10000 (0.7000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   1, Avg loss: 0.0649, Accuracy: 275/1657 (16.5963%)
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   2, Avg loss: 0.0385, Accuracy: 472/1657 (28.4852%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8777, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0616, Accuracy: 287/1154 (24.8700%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0336, Accuracy: 404/1154 (35.0087%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.3427, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   1, Avg loss: 0.0922, Accuracy: 17/460 (3.6957%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   2, Avg loss: 0.0481, Accuracy: 182/460 (39.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4001, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   1, Avg loss: 0.0695, Accuracy: 113/735 (15.3741%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 13.7369, Accuracy: 60/10000 (0.6000%)
time spent on training: 271.6636755466461
[rfa agg] training data poison_ratio: 0.16873727087576373  data num: [1213, 1662, 774, 928, 568, 669, 1657, 1154, 460, 735]
[rfa agg] considering poison per batch poison_fraction: 0.05273039714867617
[rfa agg] init. name: [97, 94, 81, 1, 62, 45, 0, 15, 31, 32], weight: tensor([0.1235, 0.1692, 0.0788, 0.0945, 0.0578, 0.0681, 0.1687, 0.1175, 0.0468,
        0.0748])
[rfa agg] iter:  0, prev_obj_val: 66.14845275878906, obj_val: 66.93445587158203, abs dis: 0.7860031127929688
[rfa agg] iter: 0, weight: tensor([0.1582, 0.0963, 0.1182, 0.1354, 0.0524, 0.0767, 0.0978, 0.1250, 0.0364,
        0.1034])
[rfa agg] iter:  1, prev_obj_val: 66.93445587158203, obj_val: 71.00506591796875, abs dis: 4.070610046386719
[rfa agg] iter: 1, weight: tensor([0.1472, 0.0894, 0.1277, 0.1422, 0.0550, 0.0822, 0.0910, 0.1171, 0.0377,
        0.1106])
[rfa agg] iter:  2, prev_obj_val: 71.00506591796875, obj_val: 70.96268463134766, abs dis: 0.04238128662109375
[rfa agg] iter: 2, weight: tensor([0.1165, 0.0781, 0.1458, 0.1322, 0.0674, 0.1013, 0.0792, 0.0977, 0.0443,
        0.1376])
[rfa agg] iter:  3, prev_obj_val: 70.96268463134766, obj_val: 70.96234130859375, abs dis: 0.00034332275390625
[rfa agg] iter: 3, weight: tensor([0.1143, 0.0773, 0.1486, 0.1307, 0.0674, 0.1023, 0.0784, 0.0959, 0.0442,
        0.1409])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.1753, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 3.4097, Accuracy: 0/9950 (0.0000%)
saving model
Done in 429.7672390937805 sec.
Server Epoch:94 choose agents : [80, 7, 37, 2, 99, 16, 49, 71, 59, 78].
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   1, Avg loss: 0.0634, Accuracy: 122/682 (17.8886%)
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 275/682 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.5681, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   1, Avg loss: 0.0779, Accuracy: 171/891 (19.1919%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   2, Avg loss: 0.0308, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2585, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   1, Avg loss: 0.0586, Accuracy: 307/1129 (27.1922%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   2, Avg loss: 0.0284, Accuracy: 658/1129 (58.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.3067, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0851, Accuracy: 72/605 (11.9008%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0494, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.0682, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   1, Avg loss: 0.0779, Accuracy: 134/773 (17.3351%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.2172, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1, Avg loss: 0.0711, Accuracy: 172/708 (24.2938%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8359, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   1, Avg loss: 0.0903, Accuracy: 5/440 (1.1364%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   2, Avg loss: 0.0533, Accuracy: 116/440 (26.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3346, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   1, Avg loss: 0.0685, Accuracy: 93/818 (11.3692%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   2, Avg loss: 0.0335, Accuracy: 328/818 (40.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2099, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   1, Avg loss: 0.0681, Accuracy: 245/1089 (22.4977%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   2, Avg loss: 0.0322, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.4277, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   1, Avg loss: 0.0982, Accuracy: 0/416 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   2, Avg loss: 0.0544, Accuracy: 149/416 (35.8173%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.5764, Accuracy: 72/10000 (0.7200%)
time spent on training: 199.75717663764954
[rfa agg] training data poison_ratio: 0.0  data num: [682, 891, 1129, 605, 773, 708, 440, 818, 1089, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 7, 37, 2, 99, 16, 49, 71, 59, 78], weight: tensor([0.0903, 0.1180, 0.1495, 0.0801, 0.1024, 0.0938, 0.0583, 0.1083, 0.1442,
        0.0551])
[rfa agg] iter:  0, prev_obj_val: 50.03972244262695, obj_val: 51.5505256652832, abs dis: 1.51080322265625
[rfa agg] iter: 0, weight: tensor([0.1409, 0.1170, 0.0862, 0.1182, 0.1153, 0.1103, 0.0574, 0.1324, 0.0691,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 51.5505256652832, obj_val: 53.82545852661133, abs dis: 2.274932861328125
[rfa agg] iter: 1, weight: tensor([0.1489, 0.1092, 0.0804, 0.1331, 0.1096, 0.1068, 0.0640, 0.1257, 0.0636,
        0.0587])
[rfa agg] iter:  2, prev_obj_val: 53.82545852661133, obj_val: 53.82184982299805, abs dis: 0.00360870361328125
[rfa agg] iter: 2, weight: tensor([0.1460, 0.1049, 0.0792, 0.1392, 0.1051, 0.1040, 0.0727, 0.1191, 0.0636,
        0.0662])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 13.9812, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 6.2819, Accuracy: 280/9950 (2.8141%)
saving model
Done in 352.6539099216461 sec.
Server Epoch:95 choose agents : [58, 24, 20, 10, 29, 56, 51, 25, 5, 3].
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0743, Accuracy: 200/803 (24.9066%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0431, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.6840, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   1, Avg loss: 0.0970, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   2, Avg loss: 0.0547, Accuracy: 86/312 (27.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6257, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1, Avg loss: 0.0675, Accuracy: 210/807 (26.0223%)
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2, Avg loss: 0.0351, Accuracy: 396/807 (49.0706%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.0500, Accuracy: 69/10000 (0.6900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0680, Accuracy: 103/861 (11.9628%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0252, Accuracy: 406/861 (47.1545%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.3904, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0601, Accuracy: 343/1440 (23.8194%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0299, Accuracy: 649/1440 (45.0694%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6249, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   1, Avg loss: 0.0905, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   2, Avg loss: 0.0728, Accuracy: 19/186 (10.2151%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.5676, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   1, Avg loss: 0.0677, Accuracy: 189/1049 (18.0172%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   2, Avg loss: 0.0332, Accuracy: 464/1049 (44.2326%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0911, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   1, Avg loss: 0.0689, Accuracy: 184/690 (26.6667%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   2, Avg loss: 0.0327, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.1330, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   1, Avg loss: 0.0598, Accuracy: 333/1628 (20.4545%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 762/1628 (46.8059%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.4080, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0829, Accuracy: 42/781 (5.3777%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0413, Accuracy: 209/781 (26.7606%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5475, Accuracy: 67/10000 (0.6700%)
time spent on training: 276.97618341445923
[rfa agg] training data poison_ratio: 0.19492812901717893  data num: [803, 312, 807, 861, 1440, 186, 1049, 690, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.060915040317868416
[rfa agg] init. name: [58, 24, 20, 10, 29, 56, 51, 25, 5, 3], weight: tensor([0.0938, 0.0365, 0.0943, 0.1006, 0.1683, 0.0217, 0.1226, 0.0806, 0.1903,
        0.0913])
[rfa agg] iter:  0, prev_obj_val: 60.65969467163086, obj_val: 63.54270935058594, abs dis: 2.883014678955078
[rfa agg] iter: 0, weight: tensor([0.1527, 0.0178, 0.1318, 0.1664, 0.0927, 0.0085, 0.1270, 0.0858, 0.0803,
        0.1369])
[rfa agg] iter:  1, prev_obj_val: 63.54270935058594, obj_val: 65.29151153564453, abs dis: 1.7488021850585938
[rfa agg] iter: 1, weight: tensor([0.1704, 0.0190, 0.1425, 0.1638, 0.0741, 0.0087, 0.1007, 0.1036, 0.0660,
        0.1511])
[rfa agg] iter:  2, prev_obj_val: 65.29151153564453, obj_val: 65.28810119628906, abs dis: 0.00341033935546875
[rfa agg] iter: 2, weight: tensor([0.1722, 0.0203, 0.1440, 0.1556, 0.0715, 0.0092, 0.0944, 0.1151, 0.0644,
        0.1533])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 15.8789, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 8.1161, Accuracy: 74/9950 (0.7437%)
saving model
Done in 435.3908734321594 sec.
Server Epoch:96 choose agents : [84, 4, 1, 11, 43, 2, 62, 12, 31, 82].
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   1, Avg loss: 0.0702, Accuracy: 241/1190 (20.2521%)
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   2, Avg loss: 0.0344, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.9900, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0664, Accuracy: 268/901 (29.7447%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0359, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.4059, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0740, Accuracy: 183/928 (19.7198%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0282, Accuracy: 535/928 (57.6509%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.9031, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0648, Accuracy: 214/712 (30.0562%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 445/712 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.7441, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   1, Avg loss: 0.0712, Accuracy: 235/946 (24.8414%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   2, Avg loss: 0.0397, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0830, Accuracy: 98/605 (16.1983%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0478, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.5395, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   1, Avg loss: 0.0768, Accuracy: 97/568 (17.0775%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   2, Avg loss: 0.0460, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1998, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.1173, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0646, Accuracy: 66/338 (19.5266%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2179, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   1, Avg loss: 0.0956, Accuracy: 24/460 (5.2174%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   2, Avg loss: 0.0501, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.4946, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0904, Accuracy: 13/500 (2.6000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0548, Accuracy: 190/500 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0007, Accuracy: 59/10000 (0.5900%)
time spent on training: 232.13249373435974
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 901, 928, 712, 946, 605, 568, 338, 460, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 4, 1, 11, 43, 2, 62, 12, 31, 82], weight: tensor([0.1665, 0.1260, 0.1298, 0.0996, 0.1323, 0.0846, 0.0795, 0.0473, 0.0644,
        0.0699])
[rfa agg] iter:  0, prev_obj_val: 50.573028564453125, obj_val: 51.72661209106445, abs dis: 1.1535835266113281
[rfa agg] iter: 0, weight: tensor([0.0874, 0.1055, 0.1022, 0.1229, 0.1214, 0.1234, 0.1279, 0.0411, 0.0757,
        0.0924])
[rfa agg] iter:  1, prev_obj_val: 51.72661209106445, obj_val: 55.4434928894043, abs dis: 3.7168807983398438
[rfa agg] iter: 1, weight: tensor([0.0790, 0.0949, 0.0920, 0.1177, 0.1089, 0.1295, 0.1480, 0.0437, 0.0833,
        0.1031])
[rfa agg] iter:  2, prev_obj_val: 55.4434928894043, obj_val: 57.715919494628906, abs dis: 2.2724266052246094
[rfa agg] iter: 2, weight: tensor([0.0724, 0.0840, 0.0823, 0.1032, 0.0947, 0.1249, 0.1669, 0.0512, 0.0960,
        0.1244])
[rfa agg] iter:  3, prev_obj_val: 57.715919494628906, obj_val: 55.414024353027344, abs dis: 2.3018951416015625
[rfa agg] iter: 3, weight: tensor([0.0698, 0.0795, 0.0782, 0.0962, 0.0890, 0.1189, 0.1711, 0.0564, 0.1033,
        0.1378])
[rfa agg] iter:  4, prev_obj_val: 55.414024353027344, obj_val: 55.41156768798828, abs dis: 0.0024566650390625
[rfa agg] iter: 4, weight: tensor([0.0707, 0.0818, 0.0799, 0.1001, 0.0924, 0.1219, 0.1738, 0.0514, 0.0983,
        0.1296])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 13.0663, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 7.9642, Accuracy: 38/9950 (0.3819%)
saving model
Done in 390.5406639575958 sec.
Server Epoch:97 choose agents : [82, 9, 2, 32, 45, 55, 65, 3, 16, 6].
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0906, Accuracy: 15/500 (3.0000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0555, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0385, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   1, Avg loss: 0.0560, Accuracy: 315/1275 (24.7059%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 706/1275 (55.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.0785, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0830, Accuracy: 90/605 (14.8760%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0488, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.2487, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   1, Avg loss: 0.0639, Accuracy: 117/735 (15.9184%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.9654, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   1, Avg loss: 0.0722, Accuracy: 148/669 (22.1226%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   2, Avg loss: 0.0436, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8642, Accuracy: 69/10000 (0.6900%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   1, Avg loss: 0.0674, Accuracy: 188/1071 (17.5537%)
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 505/1071 (47.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.3947, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   1, Avg loss: 0.0581, Accuracy: 396/1475 (26.8475%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   2, Avg loss: 0.0349, Accuracy: 585/1475 (39.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.9198, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0826, Accuracy: 64/781 (8.1946%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0406, Accuracy: 249/781 (31.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.2880, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1, Avg loss: 0.0785, Accuracy: 160/708 (22.5989%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.2556, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   1, Avg loss: 0.0627, Accuracy: 313/1956 (16.0020%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   2, Avg loss: 0.0366, Accuracy: 513/1956 (26.2270%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.4197, Accuracy: 94/10000 (0.9400%)
time spent on training: 315.5454375743866
[rfa agg] training data poison_ratio: 0.10956521739130434  data num: [500, 1275, 605, 735, 669, 1071, 1475, 781, 708, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034239130434782605
[rfa agg] init. name: [82, 9, 2, 32, 45, 55, 65, 3, 16, 6], weight: tensor([0.0512, 0.1304, 0.0619, 0.0752, 0.0684, 0.1096, 0.1509, 0.0799, 0.0724,
        0.2001])
[rfa agg] iter:  0, prev_obj_val: 72.23377990722656, obj_val: 74.58903503417969, abs dis: 2.355255126953125
[rfa agg] iter: 0, weight: tensor([0.0377, 0.1643, 0.0561, 0.0962, 0.0700, 0.1792, 0.1137, 0.1140, 0.0794,
        0.0893])
[rfa agg] iter:  1, prev_obj_val: 74.58903503417969, obj_val: 76.85862731933594, abs dis: 2.26959228515625
[rfa agg] iter: 1, weight: tensor([0.0434, 0.1211, 0.0671, 0.1277, 0.0869, 0.1536, 0.0865, 0.1491, 0.0925,
        0.0722])
[rfa agg] iter:  2, prev_obj_val: 76.85862731933594, obj_val: 76.83273315429688, abs dis: 0.0258941650390625
[rfa agg] iter: 2, weight: tensor([0.0473, 0.1008, 0.0745, 0.1506, 0.0968, 0.1263, 0.0753, 0.1649, 0.0987,
        0.0647])
[rfa agg] iter:  3, prev_obj_val: 76.83273315429688, obj_val: 80.02284240722656, abs dis: 3.1901092529296875
[rfa agg] iter: 3, weight: tensor([0.0471, 0.0995, 0.0746, 0.1533, 0.0964, 0.1236, 0.0746, 0.1674, 0.0991,
        0.0643])
[rfa agg] iter:  4, prev_obj_val: 80.02284240722656, obj_val: 80.00906372070312, abs dis: 0.0137786865234375
[rfa agg] iter: 4, weight: tensor([0.0530, 0.0867, 0.0842, 0.1722, 0.1071, 0.1051, 0.0673, 0.1631, 0.1021,
        0.0592])
[rfa agg] iter:  5, prev_obj_val: 80.00906372070312, obj_val: 80.00891876220703, abs dis: 0.00014495849609375
[rfa agg] iter: 5, weight: tensor([0.0529, 0.0860, 0.0847, 0.1758, 0.1071, 0.1037, 0.0668, 0.1616, 0.1024,
        0.0589])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.3010, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 6.9888, Accuracy: 45/9950 (0.4523%)
saving model
Done in 476.4124231338501 sec.
Server Epoch:98 choose agents : [40, 38, 88, 79, 89, 8, 28, 43, 27, 58].
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   1, Avg loss: 0.0696, Accuracy: 252/1573 (16.0203%)
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   2, Avg loss: 0.0389, Accuracy: 504/1573 (32.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4494, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   1, Avg loss: 0.0713, Accuracy: 210/1131 (18.5676%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   2, Avg loss: 0.0333, Accuracy: 470/1131 (41.5561%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.9996, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0846, Accuracy: 61/603 (10.1161%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0507, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2891, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   1, Avg loss: 0.1275, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   2, Avg loss: 0.0971, Accuracy: 7/197 (3.5533%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1241, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0631, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4499, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   1, Avg loss: 0.0719, Accuracy: 213/1513 (14.0780%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   2, Avg loss: 0.0394, Accuracy: 433/1513 (28.6186%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8220, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   1, Avg loss: 0.0748, Accuracy: 283/1581 (17.9001%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   2, Avg loss: 0.0389, Accuracy: 495/1581 (31.3093%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.5763, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0701, Accuracy: 223/946 (23.5729%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0403, Accuracy: 336/946 (35.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2407, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   1, Avg loss: 0.0636, Accuracy: 372/1587 (23.4405%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   2, Avg loss: 0.0365, Accuracy: 571/1587 (35.9798%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6960, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   1, Avg loss: 0.0744, Accuracy: 206/803 (25.6538%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   2, Avg loss: 0.0402, Accuracy: 435/803 (54.1719%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.0490, Accuracy: 52/10000 (0.5200%)
time spent on training: 260.2873582839966
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 1131, 603, 197, 896, 1513, 1581, 946, 1587, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 38, 88, 79, 89, 8, 28, 43, 27, 58], weight: tensor([0.1452, 0.1044, 0.0557, 0.0182, 0.0827, 0.1397, 0.1460, 0.0873, 0.1465,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 61.94508361816406, obj_val: 65.8536148071289, abs dis: 3.9085311889648438
[rfa agg] iter: 0, weight: tensor([0.1199, 0.1592, 0.0422, 0.0077, 0.1011, 0.1244, 0.1187, 0.1233, 0.1205,
        0.0830])
[rfa agg] iter:  1, prev_obj_val: 65.8536148071289, obj_val: 67.43634796142578, abs dis: 1.582733154296875
[rfa agg] iter: 1, weight: tensor([0.1004, 0.1557, 0.0496, 0.0084, 0.1246, 0.1037, 0.0996, 0.1528, 0.1008,
        0.1045])
[rfa agg] iter:  2, prev_obj_val: 67.43634796142578, obj_val: 69.21710205078125, abs dis: 1.7807540893554688
[rfa agg] iter: 2, weight: tensor([0.0940, 0.1456, 0.0524, 0.0085, 0.1350, 0.0971, 0.0933, 0.1651, 0.0943,
        0.1146])
[rfa agg] iter:  3, prev_obj_val: 69.21710205078125, obj_val: 65.82835388183594, abs dis: 3.3887481689453125
[rfa agg] iter: 3, weight: tensor([0.0887, 0.1354, 0.0558, 0.0087, 0.1443, 0.0916, 0.0882, 0.1727, 0.0890,
        0.1256])
[rfa agg] iter:  4, prev_obj_val: 65.82835388183594, obj_val: 71.21104431152344, abs dis: 5.3826904296875
[rfa agg] iter: 4, weight: tensor([0.0986, 0.1487, 0.0494, 0.0083, 0.1286, 0.1021, 0.0977, 0.1613, 0.0988,
        0.1065])
[rfa agg] iter:  5, prev_obj_val: 71.21104431152344, obj_val: 65.84555053710938, abs dis: 5.3654937744140625
[rfa agg] iter: 5, weight: tensor([0.0849, 0.1284, 0.0599, 0.0090, 0.1506, 0.0875, 0.0845, 0.1735, 0.0853,
        0.1364])
[rfa agg] iter:  6, prev_obj_val: 65.84555053710938, obj_val: 71.20890045166016, abs dis: 5.363349914550781
[rfa agg] iter: 6, weight: tensor([0.0985, 0.1473, 0.0494, 0.0083, 0.1294, 0.1020, 0.0976, 0.1618, 0.0986,
        0.1071])
[rfa agg] iter:  7, prev_obj_val: 71.20890045166016, obj_val: 65.84587097167969, abs dis: 5.363029479980469
[rfa agg] iter: 7, weight: tensor([0.0849, 0.1282, 0.0599, 0.0090, 0.1507, 0.0875, 0.0844, 0.1737, 0.0852,
        0.1365])
[rfa agg] iter:  8, prev_obj_val: 65.84587097167969, obj_val: 71.20885467529297, abs dis: 5.362983703613281
[rfa agg] iter: 8, weight: tensor([0.0985, 0.1473, 0.0494, 0.0083, 0.1294, 0.1020, 0.0976, 0.1619, 0.0986,
        0.1071])
[rfa agg] iter:  9, prev_obj_val: 71.20885467529297, obj_val: 65.84587860107422, abs dis: 5.36297607421875
[rfa agg] iter: 9, weight: tensor([0.0849, 0.1282, 0.0599, 0.0090, 0.1507, 0.0875, 0.0844, 0.1737, 0.0852,
        0.1365])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.9778, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 6.9743, Accuracy: 31/9950 (0.3116%)
saving model
Done in 425.5418996810913 sec.
Server Epoch:99 choose agents : [75, 60, 66, 94, 77, 17, 26, 35, 23, 61].
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   1, Avg loss: 0.0705, Accuracy: 171/776 (22.0361%)
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.3897, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   1, Avg loss: 0.0582, Accuracy: 508/2227 (22.8110%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   2, Avg loss: 0.0321, Accuracy: 918/2227 (41.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.4783, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0725, Accuracy: 178/1402 (12.6961%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0420, Accuracy: 329/1402 (23.4665%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.6153, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   1, Avg loss: 0.0707, Accuracy: 244/1662 (14.6811%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   2, Avg loss: 0.0375, Accuracy: 492/1662 (29.6029%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1822, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0558, Accuracy: 274/1340 (20.4478%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0288, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.0200, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   1, Avg loss: 0.0585, Accuracy: 322/1574 (20.4574%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   2, Avg loss: 0.0304, Accuracy: 594/1574 (37.7382%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.7429, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0596, Accuracy: 321/1446 (22.1992%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0385, Accuracy: 504/1446 (34.8548%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.5032, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.1369, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0938, Accuracy: 5/271 (1.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.8907, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0720, Accuracy: 197/715 (27.5524%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.5668, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1450, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1362, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9698, Accuracy: 54/10000 (0.5400%)
time spent on training: 308.3063807487488
[rfa agg] training data poison_ratio: 0.0  data num: [776, 2227, 1402, 1662, 1340, 1574, 1446, 271, 715, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 60, 66, 94, 77, 17, 26, 35, 23, 61], weight: tensor([0.0675, 0.1937, 0.1219, 0.1445, 0.1165, 0.1369, 0.1258, 0.0236, 0.0622,
        0.0074])
[rfa agg] iter:  0, prev_obj_val: 70.67446899414062, obj_val: 71.77924346923828, abs dis: 1.1047744750976562
[rfa agg] iter: 0, weight: tensor([0.0482, 0.0811, 0.1928, 0.1328, 0.1738, 0.1517, 0.1707, 0.0087, 0.0380,
        0.0022])
[rfa agg] iter:  1, prev_obj_val: 71.77924346923828, obj_val: 71.77320098876953, abs dis: 0.00604248046875
[rfa agg] iter: 1, weight: tensor([0.0505, 0.0770, 0.2008, 0.1253, 0.1845, 0.1425, 0.1692, 0.0089, 0.0391,
        0.0022])
[rfa agg] iter:  2, prev_obj_val: 71.77320098876953, obj_val: 71.77303314208984, abs dis: 0.0001678466796875
[rfa agg] iter: 2, weight: tensor([0.0503, 0.0768, 0.2021, 0.1244, 0.1867, 0.1413, 0.1684, 0.0089, 0.0390,
        0.0022])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1654, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.0669, Accuracy: 0/9950 (0.0000%)
saving model
Done in 468.366596698761 sec.
Server Epoch:100 choose agents : [25, 52, 37, 70, 26, 86, 40, 66, 98, 83].
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   1, Avg loss: 0.0660, Accuracy: 195/690 (28.2609%)
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   2, Avg loss: 0.0312, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.9952, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0610, Accuracy: 228/636 (35.8491%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0344, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.4993, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0597, Accuracy: 304/1129 (26.9265%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0284, Accuracy: 684/1129 (60.5846%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.0090, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   1, Avg loss: 0.0695, Accuracy: 265/1418 (18.6883%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   2, Avg loss: 0.0342, Accuracy: 560/1418 (39.4922%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1477, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   1, Avg loss: 0.0586, Accuracy: 325/1446 (22.4758%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   2, Avg loss: 0.0388, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6102, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0702, Accuracy: 227/1003 (22.6321%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0383, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6906, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0686, Accuracy: 252/1573 (16.0203%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0397, Accuracy: 525/1573 (33.3757%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.3107, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1, Avg loss: 0.0698, Accuracy: 186/1402 (13.2668%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 330/1402 (23.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.8338, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   1, Avg loss: 0.1093, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   2, Avg loss: 0.0656, Accuracy: 64/373 (17.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0439, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   1, Avg loss: 0.0719, Accuracy: 334/1953 (17.1019%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   2, Avg loss: 0.0388, Accuracy: 642/1953 (32.8725%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4528, Accuracy: 91/10000 (0.9100%)
time spent on training: 328.5247759819031
[rfa agg] training data poison_ratio: 0.0  data num: [690, 636, 1129, 1418, 1446, 1003, 1573, 1402, 373, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 52, 37, 70, 26, 86, 40, 66, 98, 83], weight: tensor([0.0594, 0.0547, 0.0971, 0.1220, 0.1244, 0.0863, 0.1353, 0.1206, 0.0321,
        0.1680])
[rfa agg] iter:  0, prev_obj_val: 66.792236328125, obj_val: 67.99301147460938, abs dis: 1.200775146484375
[rfa agg] iter: 0, weight: tensor([0.0441, 0.0356, 0.1455, 0.1297, 0.1361, 0.1251, 0.1180, 0.1666, 0.0150,
        0.0842])
[rfa agg] iter:  1, prev_obj_val: 67.99301147460938, obj_val: 69.5468978881836, abs dis: 1.5538864135742188
[rfa agg] iter: 1, weight: tensor([0.0466, 0.0373, 0.1574, 0.1228, 0.1294, 0.1393, 0.1115, 0.1597, 0.0156,
        0.0804])
[rfa agg] iter:  2, prev_obj_val: 69.5468978881836, obj_val: 71.2661361694336, abs dis: 1.71923828125
[rfa agg] iter: 2, weight: tensor([0.0500, 0.0397, 0.1636, 0.1171, 0.1232, 0.1545, 0.1069, 0.1498, 0.0164,
        0.0787])
[rfa agg] iter:  3, prev_obj_val: 71.2661361694336, obj_val: 69.54396057128906, abs dis: 1.7221755981445312
[rfa agg] iter: 3, weight: tensor([0.0538, 0.0424, 0.1661, 0.1120, 0.1174, 0.1708, 0.1028, 0.1406, 0.0172,
        0.0770])
[rfa agg] iter:  4, prev_obj_val: 69.54396057128906, obj_val: 69.541015625, abs dis: 0.0029449462890625
[rfa agg] iter: 4, weight: tensor([0.0498, 0.0396, 0.1659, 0.1158, 0.1219, 0.1584, 0.1062, 0.1478, 0.0163,
        0.0782])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.2097, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 4.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 490.27393221855164 sec.
Saving all the graphs.
This run has a label: Jun.26_07.39.30. Visdom environment: tiny
