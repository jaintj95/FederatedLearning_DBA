current path: saved_models/model_tiny_Jun.28_13.43.49
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 777/1953 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9260, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 451/1988 (22.6861%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9042, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 170/953 (17.8384%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.4720, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6256, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 483/1130 (42.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 230/1071 (21.4753%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 469/1071 (43.7908%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6580, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0388, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 447/1715 (26.0641%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 731/1715 (42.6239%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2617, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0312, Accuracy: 358/1154 (31.0225%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7668, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 32/416 (7.6923%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5571, Accuracy: 50/10000 (0.5000%)
time spent on training: 134.44767785072327
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6218, Accuracy: 0/9950 (0.0000%)
saving model
Done in 201.66944241523743 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 306/953 (32.1091%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4535, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1135, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 333/946 (35.2008%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.0244, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 315/715 (44.0559%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.6965, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3752, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 15/373 (4.0214%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4448, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 312/1190 (26.2185%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3034, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 372/1581 (23.5294%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 600/1581 (37.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7787, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 376/1956 (19.2229%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1484, Accuracy: 106/10000 (1.0600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 377/1574 (23.9517%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 598/1574 (37.9924%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9935, Accuracy: 81/10000 (0.8100%)
time spent on training: 102.11848282814026
[foolsgold agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.05053164166837888
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 167.9919970035553 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 236/776 (30.4124%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8086, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 346/803 (43.0884%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.9253, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 454/891 (50.9540%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8588, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 309/1190 (25.9664%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 428/1190 (35.9664%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0422, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 313/1662 (18.8327%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 566/1662 (34.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6883, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0588, Accuracy: 296/1645 (17.9939%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8908, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0764, Accuracy: 95/781 (12.1639%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 249/781 (31.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7967, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 275/590 (46.6102%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9744, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 416/1742 (23.8806%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 704/1742 (40.4133%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8159, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 201/861 (23.3449%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 452/861 (52.4971%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7805, Accuracy: 50/10000 (0.5000%)
time spent on training: 95.62541127204895
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3168, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6200, Accuracy: 0/9950 (0.0000%)
saving model
Done in 162.66443300247192 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 338/807 (41.8835%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5255, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0655, Accuracy: 171/953 (17.9433%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 310/953 (32.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2473, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0827, Accuracy: 51/460 (11.0870%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0630, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8435, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0559, Accuracy: 406/1956 (20.7566%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 610/1956 (31.1861%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.1761, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0629, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 341/1573 (21.6783%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 586/1573 (37.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8339, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 483/1049 (46.0439%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9488, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0887, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4358, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0552, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 437/888 (49.2117%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2070, Accuracy: 50/10000 (0.5000%)
time spent on training: 93.58315634727478
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3166, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 160.17389011383057 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3042, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0545, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3448, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 330/1130 (29.2035%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 514/1130 (45.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4731, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0578, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 526/928 (56.6810%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8425, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 526/1049 (50.1430%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.3878, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 438/807 (54.2751%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.6920, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0559, Accuracy: 389/1904 (20.4307%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 666/1904 (34.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4920, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 461/1715 (26.8805%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4016, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9551, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 60/500 (12.0000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6225, Accuracy: 52/10000 (0.5200%)
time spent on training: 113.76430630683899
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3165, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6182, Accuracy: 0/9950 (0.0000%)
saving model
Done in 179.81325483322144 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0604, Accuracy: 326/719 (45.3408%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0302, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.4250, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9189, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 698/1742 (40.0689%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8082, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 317/1662 (19.0734%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 599/1662 (36.0409%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7627, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 236/1071 (22.0355%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 508/1071 (47.4323%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9323, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 418/1988 (21.0262%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 653/1988 (32.8471%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6589, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0572, Accuracy: 270/636 (42.4528%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1314, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0617, Accuracy: 193/735 (26.2585%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 335/735 (45.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4451, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 319/946 (33.7209%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9290, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5481, Accuracy: 50/10000 (0.5000%)
time spent on training: 121.83208394050598
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3164, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6150, Accuracy: 0/9950 (0.0000%)
saving model
Done in 189.94811844825745 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 457/1130 (40.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 573/2227 (25.7297%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1020/2227 (45.8015%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4744, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 205/735 (27.8912%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0401, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.8608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 280/590 (47.4576%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9386, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 274/636 (43.0818%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0323, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2770, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0991, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0851, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3232, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0551, Accuracy: 374/1953 (19.1500%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 714/1953 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.0488, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 361/1275 (28.3137%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 747/1275 (58.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.2626, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 315/677 (46.5288%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9784, Accuracy: 51/10000 (0.5100%)
time spent on training: 99.57476806640625
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3163, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6098, Accuracy: 0/9950 (0.0000%)
saving model
Done in 166.28341817855835 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3336, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0618, Accuracy: 309/715 (43.2168%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6720, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 133/338 (39.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4266, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 508/1657 (30.6578%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9931, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0351, Accuracy: 364/803 (45.3300%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9218, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 393/1581 (24.8577%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 611/1581 (38.6464%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7470, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0691, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7838, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8024, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0286, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6628, Accuracy: 48/10000 (0.4800%)
time spent on training: 96.50824236869812
[foolsgold agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        1.        1.        1.        1.        1.        1.
 0.8328478 0.8328478 1.       ]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3162, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6077, Accuracy: 0/9950 (0.0000%)
saving model
Done in 163.86479210853577 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 384/1129 (34.0124%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 712/1129 (63.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5565, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 307/1190 (25.7983%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8845, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0503, Accuracy: 533/2227 (23.9335%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 996/2227 (44.7238%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2323, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4329, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0589, Accuracy: 292/1131 (25.8179%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7803, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 234/1049 (22.3070%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 488/1049 (46.5205%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2475, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4717, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 465/1715 (27.1137%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 682/1715 (39.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6110, Accuracy: 99/10000 (0.9900%)
time spent on training: 103.81247568130493
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3161, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6064, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.2410809993744 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 142/818 (17.3594%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 336/818 (41.0758%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9632, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 364/1013 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5246, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 252/1071 (23.5294%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 487/1071 (45.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1307, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9727, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 137/603 (22.7197%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0473, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8297, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0817, Accuracy: 66/486 (13.5802%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7472, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3461, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 14/373 (3.7534%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 351/1628 (21.5602%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 818/1628 (50.2457%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.5041, Accuracy: 141/10000 (1.4100%)
time spent on training: 109.49964332580566
[foolsgold agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3160, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6068, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.54224514961243 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0422, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3784, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.5573, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 419/1440 (29.0972%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 672/1440 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7920, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 384/1628 (23.5872%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 809/1628 (49.6929%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1965, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 469/1715 (27.3469%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 684/1715 (39.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3773, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 405/712 (56.8820%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.4991, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 421/1131 (37.2237%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 200/861 (23.2288%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1338, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1446 (35.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1549, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 307/1645 (18.6626%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 587/1645 (35.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9545, Accuracy: 120/10000 (1.2000%)
time spent on training: 109.71687841415405
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3159, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6065, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.99254655838013 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0887, Accuracy: 67/408 (16.4216%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4599, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0710, Accuracy: 139/682 (20.3812%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4008, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 720/1742 (41.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1322, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 55/460 (11.9565%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0404, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0515, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.6948, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 355/1003 (35.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6806, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 141/568 (24.8239%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.6986, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4312, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 419/1949 (21.4982%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 614/1949 (31.5033%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4606, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 329/1645 (20.0000%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 625/1645 (37.9939%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0823, Accuracy: 111/10000 (1.1100%)
time spent on training: 102.95558047294617
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3158, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6061, Accuracy: 0/9950 (0.0000%)
saving model
Done in 169.55901741981506 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3643, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0598, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 365/1418 (25.7405%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7179, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 315/1013 (31.0958%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4829, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 245/1071 (22.8758%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9251, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0553, Accuracy: 431/1956 (22.0348%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 624/1956 (31.9018%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3061, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0668, Accuracy: 271/708 (38.2768%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0343, Accuracy: 431/708 (60.8757%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.8273, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 158/809 (19.5303%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1478, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 430/1904 (22.5840%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 640/1904 (33.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2133, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 310/715 (43.3566%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7371, Accuracy: 50/10000 (0.5000%)
time spent on training: 134.55230498313904
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6056, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.2532079219818 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 283/590 (47.9661%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0294, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 151/953 (15.8447%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 288/953 (30.2204%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.6656, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 377/1475 (25.5593%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 652/1475 (44.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8712, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3042, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 62/515 (12.0388%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.7143, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5562, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.5979, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 595/2227 (26.7176%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1024/2227 (45.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7826, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 770/1953 (39.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5457, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4277, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.36559176445007
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6014, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.92041945457458 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8861, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 134/568 (23.5915%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7273, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 443/1953 (22.6831%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 751/1953 (38.4537%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1558, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 36/416 (8.6538%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5389, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2811, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.4081, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0774, Accuracy: 114/530 (21.5094%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0395, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0004, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 405/1475 (27.4576%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 667/1475 (45.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9987, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0622, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 462/1131 (40.8488%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3684, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 353/1662 (21.2395%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 578/1662 (34.7774%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6334, Accuracy: 104/10000 (1.0400%)
time spent on training: 109.23177170753479
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3153, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.5993, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.56166100502014 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0587, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0410, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 399/1949 (20.4720%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 639/1949 (32.7860%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3536, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 353/1418 (24.8942%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 603/1418 (42.5247%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6323, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 397/1475 (26.9153%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 724/1475 (49.0847%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9775, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1029, Accuracy: 12/197 (6.0914%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0850, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3211, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 341/1628 (20.9459%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 787/1628 (48.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4197, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 399/888 (44.9324%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3868, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 340/803 (42.3412%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.0676, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 189/735 (25.7143%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 315/735 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4171, Accuracy: 45/10000 (0.4500%)
time spent on training: 113.4040756225586
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3151, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.5934, Accuracy: 0/9950 (0.0000%)
saving model
Done in 179.954683303833 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3609, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 368/1581 (23.2764%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 567/1581 (35.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6998, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 458/1587 (28.8595%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 601/1587 (37.8702%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1827, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 275/682 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3564, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 468/1130 (41.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9805, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 137/568 (24.1197%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6999, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 194/735 (26.3946%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7167, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 519/1470 (35.3061%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 839/1470 (57.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1204, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9902, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 343/1372 (25.0000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 526/1372 (38.3382%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8001, Accuracy: 84/10000 (0.8400%)
time spent on training: 121.90434098243713
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3150, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.5896, Accuracy: 0/9950 (0.0000%)
saving model
Done in 188.04118180274963 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 36/466 (7.7253%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5877, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 457/896 (51.0045%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.1788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8793, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0611, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0374, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6911, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 567/928 (61.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5982, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 422/891 (47.3625%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9832, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 186/416 (44.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5607, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 160/809 (19.7775%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 329/809 (40.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4690, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 438/1241 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2211, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 384/1581 (24.2884%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5299, Accuracy: 88/10000 (0.8800%)
time spent on training: 137.2716953754425
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3148, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.5891, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.17570614814758 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1185, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 363/1003 (36.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.7285, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0846, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3673, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0643, Accuracy: 272/708 (38.4181%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7929, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 324/896 (36.1607%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.1787, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 438/1715 (25.5394%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 719/1715 (41.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4917, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 341/807 (42.2553%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 440/807 (54.5229%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5684, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5428, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 234/861 (27.1777%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 447/861 (51.9164%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9120, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5093, Accuracy: 60/10000 (0.6000%)
time spent on training: 117.705735206604
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3147, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.5888, Accuracy: 0/9950 (0.0000%)
saving model
Done in 184.09038591384888 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0635, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9693, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 307/1645 (18.6626%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0481, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.4687, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 409/1956 (20.9100%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 636/1956 (32.5153%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1726, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 253/888 (28.4910%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9121, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 17/440 (3.8636%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0493, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.4759, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0571, Accuracy: 335/1418 (23.6248%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 568/1418 (40.0564%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6306, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 223/1049 (21.2583%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 504/1049 (48.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3839, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.0122, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0495, Accuracy: 371/1275 (29.0980%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 724/1275 (56.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.5135, Accuracy: 87/10000 (0.8700%)
time spent on training: 124.1673195362091
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3145, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.5881, Accuracy: 0/9950 (0.0000%)
saving model
Done in 190.81368350982666 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0668, Accuracy: 272/708 (38.4181%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0345, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.0040, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0580, Accuracy: 297/690 (43.0435%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.3075, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 405/1904 (21.2710%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0320, Accuracy: 658/1904 (34.5588%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.2409, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0500, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.5940, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4426, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0666, Accuracy: 159/938 (16.9510%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 315/938 (33.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0935, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 420/1742 (24.1102%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9631, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 285/953 (29.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7259, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 375/1949 (19.2406%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 642/1949 (32.9400%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1702, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 195/861 (22.6481%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 451/861 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0520, Accuracy: 51/10000 (0.5100%)
time spent on training: 137.07237815856934
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3144, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.3897635936737 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 390/1949 (20.0103%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 665/1949 (34.1201%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5245, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8256, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9727, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 469/1552 (30.2191%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 747/1552 (48.1314%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.0825, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4091, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0680, Accuracy: 174/773 (22.5097%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.8772, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 473/891 (53.0864%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1544, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 32/466 (6.8670%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 278/813 (34.1943%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.5995, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 256/1513 (16.9200%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 498/1513 (32.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3903, Accuracy: 110/10000 (1.1000%)
time spent on training: 159.51555705070496
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3142, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5841, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.26086378097534 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 284/636 (44.6541%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.3523, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 322/1662 (19.3742%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7436, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 280/928 (30.1724%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5615, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6757, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 391/1949 (20.0616%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 610/1949 (31.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2971, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0635, Accuracy: 244/776 (31.4433%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0247, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8966, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0631, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 396/901 (43.9512%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.7735, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 138/568 (24.2958%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7463, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0709, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 301/774 (38.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2772, Accuracy: 63/10000 (0.6300%)
time spent on training: 120.56002950668335
[foolsgold agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3141, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5836, Accuracy: 0/9950 (0.0000%)
saving model
Done in 187.75178003311157 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 466/1190 (39.1597%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9845, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6430, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 327/1645 (19.8784%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 660/1645 (40.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9015, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 52/426 (12.2066%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5958, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 221/605 (36.5289%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.8412, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 204/861 (23.6934%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 439/861 (50.9872%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9003, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 138/809 (17.0581%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 342/809 (42.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3852, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 353/1418 (24.8942%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 629/1418 (44.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7319, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 307/1013 (30.3060%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6939, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0326, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9343, Accuracy: 50/10000 (0.5000%)
time spent on training: 117.65986609458923
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3140, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5833, Accuracy: 0/9950 (0.0000%)
saving model
Done in 184.82508492469788 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 397/1750 (22.6857%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7702, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 326/1446 (22.5450%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1344, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 266/813 (32.7183%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 476/813 (58.5486%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.1050, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 293/1131 (25.9063%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 377/1131 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7418, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9368, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 315/1662 (18.9531%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 584/1662 (35.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7746, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0813, Accuracy: 77/460 (16.7391%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7254, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7959, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0369, Accuracy: 313/774 (40.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.4044, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 88/631 (13.9461%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 224/631 (35.4992%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8579, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.7587423324585
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3139, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5831, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.89093232154846 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0387, Accuracy: 224/682 (32.8446%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3029, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0664, Accuracy: 159/938 (16.9510%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 358/938 (38.1663%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4671, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 482/1552 (31.0567%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 759/1552 (48.9046%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.7840, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0690, Accuracy: 189/669 (28.2511%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8739, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1130 (30.4425%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5679, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 341/1372 (24.8542%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 494/1372 (36.0058%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.2078, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1027, Accuracy: 23/197 (11.6751%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0899, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.9979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 135/809 (16.6873%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 337/809 (41.6564%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2507, Accuracy: 75/10000 (0.7500%)
time spent on training: 132.3801074028015
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3139, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5820, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.29278111457825 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 436/1574 (27.7001%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0238, Accuracy: 855/1574 (54.3202%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0202, Accuracy: 922/1574 (58.5769%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0193, Accuracy: 948/1574 (60.2287%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0189, Accuracy: 963/1574 (61.1817%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0188, Accuracy: 973/1574 (61.8170%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0180, Accuracy: 1004/1574 (63.7865%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0179, Accuracy: 1013/1574 (64.3583%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0173, Accuracy: 1012/1574 (64.2948%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0175, Accuracy: 1006/1574 (63.9136%), train_poison_data_count: 500
Global model norm: 112.054870243611.
Norm before scaling: 112.03125871687553. Distance: 1.2354392280684248
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9688, Accuracy: 95/10000 (0.9500%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.1305, Accuracy: 9886/9950 (99.3568%)
Scaling by  100
Scaled Norm after poisoning: 164.73519826337966, distance: 123.54391773525316
Total norm for 1 adversaries is: 164.73519826337966. distance: 123.54391773525316
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 447/1190 (37.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.8287, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 126/809 (15.5748%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 339/809 (41.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1548, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.2545, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 320/1645 (19.4529%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 611/1645 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8630, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0271, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 360/1372 (26.2391%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 507/1372 (36.9534%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8252, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6070, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6812, Accuracy: 50/10000 (0.5000%)
time spent on training: 242.274493932724
[foolsgold agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.04668517463933181
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3138, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5785, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.7088165283203 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 340/807 (42.1314%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9317, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 740/1715 (43.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4037, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 45/426 (10.5634%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5663, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 95/631 (15.0555%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.8008, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 323/1030 (31.3592%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 628/1030 (60.9709%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4832, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 444/1988 (22.3340%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 651/1988 (32.7465%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6948, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.6503, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 645/1956 (32.9755%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1417, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 422/1953 (21.6078%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 718/1953 (36.7640%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8925, Accuracy: 88/10000 (0.8800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 391/1574 (24.8412%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 684/1574 (43.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8236, Accuracy: 79/10000 (0.7900%)
time spent on training: 180.01518964767456
[foolsgold agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.039205722939582334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3137, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5783, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.62248516082764 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 341/712 (47.8933%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 440/712 (61.7978%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.6597, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0557, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.0839, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 283/813 (34.8093%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.4529, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 412/1131 (36.4279%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.7428, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 680/1475 (46.1017%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1714, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 595/2227 (26.7176%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 997/2227 (44.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3036, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.7737, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0543, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7648, Accuracy: 50/10000 (0.5000%)
time spent on training: 143.6391568183899
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5756, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.90163922309875 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0713, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 210/631 (33.2805%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8282, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 621/1030 (60.2913%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0484, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 353/1402 (25.1783%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1287, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0605, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 313/946 (33.0867%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.9812, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0594, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 357/1657 (21.5450%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4418, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8647, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3254, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0655, Accuracy: 192/773 (24.8383%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0323, Accuracy: 397/773 (51.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6426, Accuracy: 50/10000 (0.5000%)
time spent on training: 132.3013002872467
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3135, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.0738468170166 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9037, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 56/460 (12.1739%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8103, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 319/1662 (19.1937%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 628/1662 (37.7858%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7124, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 522/1657 (31.5027%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9073, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 613/2227 (27.5258%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1053/2227 (47.2833%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3121, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 416/1949 (21.3443%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 621/1949 (31.8625%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3971, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.4326, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0784, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3473, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7481, Accuracy: 47/10000 (0.4700%)
time spent on training: 142.2287244796753
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3134, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5749, Accuracy: 0/9950 (0.0000%)
saving model
Done in 207.77560114860535 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0554, Accuracy: 326/1446 (22.5450%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 516/1446 (35.6846%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1837, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0686, Accuracy: 202/669 (30.1943%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0402, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7902, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 411/1036 (39.6718%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 661/1036 (63.8031%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.1095, Accuracy: 55/10000 (0.5500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 409/1574 (25.9848%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 681/1574 (43.2656%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9707, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 460/1190 (38.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.9427, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 250/1513 (16.5235%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 474/1513 (31.3285%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4553, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2914, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 145/682 (21.2610%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2537, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.9416, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7876, Accuracy: 50/10000 (0.5000%)
time spent on training: 170.31369543075562
[foolsgold agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.04812396047353487
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3133, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5751, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.41377210617065 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4603, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1008, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0864, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3217, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 290/590 (49.1525%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0613, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1130, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 545/1340 (40.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8208, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 515/1071 (48.0859%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8134, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0884, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4776, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.6108, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0675, Accuracy: 196/669 (29.2975%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0415, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8229, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 305/1089 (28.0073%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 438/1089 (40.2204%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.2184, Accuracy: 71/10000 (0.7100%)
time spent on training: 110.53869199752808
[foolsgold agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3132, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5747, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.8869435787201 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7622, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0523, Accuracy: 349/712 (49.0169%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.7089, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 21/440 (4.7727%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0644, Accuracy: 163/818 (19.9267%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 367/818 (44.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3421, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 341/1645 (20.7295%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 639/1645 (38.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2020, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0424, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3825, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 87/631 (13.7876%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8462, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0793, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.7719, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0469, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6661, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 238/1071 (22.2222%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 465/1071 (43.4174%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0371, Accuracy: 71/10000 (0.7100%)
time spent on training: 120.03268504142761
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.92946246 1.         1.         0.92946246
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3132, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5746, Accuracy: 0/9950 (0.0000%)
saving model
Done in 185.0006217956543 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 390/803 (48.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9872, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 354/712 (49.7191%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5275, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.4373, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 406/1402 (28.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1421, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 357/818 (43.6430%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.9027, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0490, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7753, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4537, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0588, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.2379, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 397/1956 (20.2965%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 619/1956 (31.6462%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3639, Accuracy: 118/10000 (1.1800%)
time spent on training: 154.1825442314148
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3131, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5748, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.56246638298035 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 354/712 (49.7191%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 405/712 (56.8820%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.5617, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 565/2227 (25.3705%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1039/2227 (46.6547%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3352, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9840, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6410, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 353/1372 (25.7289%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 505/1372 (36.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7896, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 233/1049 (22.2116%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0308, Accuracy: 521/1049 (49.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4871, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 62/515 (12.0388%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0529, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6996, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 338/1030 (32.8155%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 633/1030 (61.4563%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.4800, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 347/1418 (24.4711%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8099, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0226, Accuracy: 402/861 (46.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8491, Accuracy: 50/10000 (0.5000%)
time spent on training: 141.89053463935852
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3130, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5740, Accuracy: 0/9950 (0.0000%)
saving model
Done in 207.66180896759033 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0597, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7576, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 416/803 (51.8057%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.0382, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 348/1662 (20.9386%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9057, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 504/1049 (48.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3154, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3843, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 599/1340 (44.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5259, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.3094, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 426/1904 (22.3739%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 670/1904 (35.1891%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8493, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 369/1657 (22.2692%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 515/1657 (31.0803%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6902, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 453/1953 (23.1951%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 743/1953 (38.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8140, Accuracy: 112/10000 (1.1200%)
time spent on training: 152.89662051200867
[foolsgold agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3129, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.0289764404297 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0546, Accuracy: 309/1340 (23.0597%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 561/1340 (41.8657%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6453, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0744, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.6403, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 478/1131 (42.2635%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4174, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0580, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0322, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.6242, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.0761, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 423/1241 (34.0854%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.2854, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.6914, Accuracy: 56/10000 (0.5600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 388/1574 (24.6506%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9352, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 436/1131 (38.5500%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5693, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 529/1372 (38.5569%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0065, Accuracy: 80/10000 (0.8000%)
time spent on training: 207.06813788414001
[foolsgold agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.04637267841991138
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3128, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5702, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.35986137390137 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 358/891 (40.1796%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 459/891 (51.5152%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0807, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0591, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.8750, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 325/1446 (22.4758%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 487/1446 (33.6791%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4509, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 363/803 (45.2055%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 379/803 (47.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0026, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0055, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 58/460 (12.6087%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.7724, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 331/1030 (32.1359%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1406, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 394/1475 (26.7119%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 625/1475 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9466, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 346/1418 (24.4006%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 648/1418 (45.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8945, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 336/818 (41.0758%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0107, Accuracy: 68/10000 (0.6800%)
time spent on training: 141.59427785873413
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3126, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.6454918384552 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0519, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 634/1030 (61.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1933, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 360/1275 (28.2353%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 705/1275 (55.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.5008, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0655, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0364, Accuracy: 336/774 (43.4109%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.1893, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2854, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 282/928 (30.3879%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.5632, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 269/888 (30.2928%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 464/888 (52.2523%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3328, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 391/1953 (20.0205%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 765/1953 (39.1705%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8143, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 339/946 (35.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9728, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 185/953 (19.4124%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 319/953 (33.4732%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4850, Accuracy: 66/10000 (0.6600%)
time spent on training: 144.97805166244507
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3125, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5672, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 209.67076683044434 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 464/1190 (38.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1304, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.3411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 429/1129 (37.9982%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4255, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0439, Accuracy: 448/1552 (28.8660%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 769/1552 (49.5490%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9618, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 406/1750 (23.2000%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 684/1750 (39.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6273, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 353/807 (43.7423%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4917, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 153/809 (18.9122%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1306, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 339/1154 (29.3761%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 393/1154 (34.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0032, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5318, Accuracy: 62/10000 (0.6200%)
time spent on training: 185.97456741333008
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3124, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5670, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 252.9132068157196 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 347/1372 (25.2915%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 477/1372 (34.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8947, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 268/1402 (19.1155%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 391/1402 (27.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0533, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 293/1089 (26.9054%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2513, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0602, Accuracy: 388/1750 (22.1714%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 657/1750 (37.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6383, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 692/1742 (39.7245%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7430, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 362/1013 (35.7354%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.5451, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 418/1129 (37.0239%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 738/1129 (65.3676%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6462, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0534, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7725, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 401/1440 (27.8472%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 679/1440 (47.1528%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8223, Accuracy: 64/10000 (0.6400%)
time spent on training: 159.51711440086365
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3123, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5669, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 226.00695157051086 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 459/896 (51.2277%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 339/1340 (25.2985%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 578/1340 (43.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5985, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 393/1440 (27.2917%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 648/1440 (45.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8264, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0626, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9551, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 366/1662 (22.0217%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 639/1662 (38.4477%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6085, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0747, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.7010, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0576, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0056, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 491/1013 (48.4699%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6772, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0801, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0415, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7437, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9347, Accuracy: 50/10000 (0.5000%)
time spent on training: 145.90214323997498
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3122, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5663, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.4638204574585 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4480, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 233/1049 (22.2116%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 540/1049 (51.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.4461, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 430/1742 (24.6843%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 725/1742 (41.6188%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8779, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0738, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7947, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 355/1013 (35.0444%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.6244, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8061, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 269/888 (30.2928%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.1171, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0547, Accuracy: 291/1154 (25.2166%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 500/1154 (43.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4590, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0846, Accuracy: 42/271 (15.4982%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0544, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3628, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
time spent on training: 161.4648778438568
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3121, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5668, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.1894974708557 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 387/1581 (24.4782%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5521, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 238/682 (34.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.2179, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1446 (35.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.2866, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 531/928 (57.2198%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6719, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 393/1742 (22.5603%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 687/1742 (39.4374%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8816, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 269/1071 (25.1167%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 513/1071 (47.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.0665, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.0572, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0814, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.4352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3044, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0639, Accuracy: 247/776 (31.8299%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0317, Accuracy: 385/776 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.8665, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.4099042415619
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3120, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5665, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.50700306892395 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3496, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 288/813 (35.4244%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.8444, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9547, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 523/1552 (33.6985%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 787/1552 (50.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.6683, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0287, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5905, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0615, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.2053, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 485/1131 (42.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2282, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 30/440 (6.8182%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5083, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.3919, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0602, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0368, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8648, Accuracy: 51/10000 (0.5100%)
time spent on training: 137.14769554138184
[foolsgold agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.81584581 0.81584581]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5665, Accuracy: 0/9950 (0.0000%)
saving model
Done in 202.98114371299744 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 394/1475 (26.7119%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 690/1475 (46.7797%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0783, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 50/466 (10.7296%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6581, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 405/1574 (25.7306%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 671/1574 (42.6302%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1092, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 141/818 (17.2372%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.3244, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.7886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 491/1552 (31.6366%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 787/1552 (50.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.2379, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.3865, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5966, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7215, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 133/338 (39.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4419, Accuracy: 50/10000 (0.5000%)
time spent on training: 181.41494250297546
[foolsgold agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.054634566255692546
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3119, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.75451683998108 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0325, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.2857, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.3085, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.7279, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.6041, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 223/861 (25.9001%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7123, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0481, Accuracy: 389/1036 (37.5483%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 656/1036 (63.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2062, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 263/1241 (21.1926%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 374/1241 (30.1370%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0622, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 599/2227 (26.8972%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1041/2227 (46.7445%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6300, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0541, Accuracy: 339/599 (56.5943%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 479/1131 (42.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2989, Accuracy: 83/10000 (0.8300%)
time spent on training: 162.4066722393036
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3118, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.88352918624878 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 406/1574 (25.7942%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 695/1574 (44.1550%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2881, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 296/928 (31.8966%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.5460, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0799, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8299, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 363/1573 (23.0769%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 594/1573 (37.7622%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.3852, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 428/1953 (21.9150%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7433, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 360/1213 (29.6785%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 474/1213 (39.0767%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.5688, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 116/530 (21.8868%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0356, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0362, Accuracy: 464/1163 (39.8968%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8357, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 443/861 (51.4518%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0053, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 412/1949 (21.1390%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 622/1949 (31.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6277, Accuracy: 78/10000 (0.7800%)
time spent on training: 186.82798838615417
[foolsgold agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.040218724448078495
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3118, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5640, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.65837597846985 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 504/1013 (49.7532%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9402, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8070, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.3036, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 232/1049 (22.1163%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 542/1049 (51.6683%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7945, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 416/888 (46.8468%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.2347, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 416/1628 (25.5528%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 826/1628 (50.7371%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2950, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 559/2227 (25.1010%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1024/2227 (45.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2806, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.0740, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 351/1418 (24.7532%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5520, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0606, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.1382, Accuracy: 50/10000 (0.5000%)
time spent on training: 219.63738799095154
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3117, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5632, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 286.7087869644165 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0358, Accuracy: 367/901 (40.7325%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3427, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 429/1949 (22.0113%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 657/1949 (33.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3358, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0811, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0504, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6795, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0581, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 417/1089 (38.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.3046, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0576, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 468/719 (65.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.3221, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 438/712 (61.5169%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.4378, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 180/818 (22.0049%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 372/818 (45.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9308, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 642/1956 (32.8221%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0867, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 441/1715 (25.7143%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 741/1715 (43.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.6328, Accuracy: 95/10000 (0.9500%)
time spent on training: 167.6381757259369
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3117, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5645, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.38635349273682 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 331/896 (36.9420%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 432/896 (48.2143%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3875, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0520, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8409, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 422/1953 (21.6078%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 781/1953 (39.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4580, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 616/2227 (27.6605%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 991/2227 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4290, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0240, Accuracy: 557/1154 (48.2669%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.7685, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0616, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0609, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6278, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0587, Accuracy: 352/1657 (21.2432%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 497/1657 (29.9940%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6227, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7704, Accuracy: 48/10000 (0.4800%)
time spent on training: 164.4791965484619
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3116, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5630, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.52021431922913 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.1209, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 529/1446 (36.5837%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3063, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1239, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3036, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 417/1574 (26.4930%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9811, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 434/1587 (27.3472%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 593/1587 (37.3661%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2503, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8582, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4761, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0251, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0633, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0562, Accuracy: 338/1154 (29.2894%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 436/1154 (37.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7656, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 404/1949 (20.7286%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 619/1949 (31.7599%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3871, Accuracy: 89/10000 (0.8900%)
time spent on training: 246.92614030838013
[foolsgold agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.043621408300815886
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3116, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5639, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.7096211910248 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 431/1129 (38.1754%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 739/1129 (65.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4468, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0378, Accuracy: 400/1163 (34.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.6669, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0585, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7780, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0749, Accuracy: 145/603 (24.0464%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.0143, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 732/1904 (38.4454%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7141, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 768/1953 (39.3241%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8403, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 358/891 (40.1796%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.0916, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 671/1956 (34.3047%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1636, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5564, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 286/813 (35.1784%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.3901, Accuracy: 55/10000 (0.5500%)
time spent on training: 193.6308274269104
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.8921627998352 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 297/1131 (26.2599%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0722, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 50/466 (10.7296%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.6840, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 326/1154 (28.2496%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 439/1154 (38.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 513/1130 (45.3982%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6563, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 180/416 (43.2692%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5782, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 610/2227 (27.3911%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1020/2227 (45.8015%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4826, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 458/712 (64.3258%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.7698, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 502/1446 (34.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0501, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 353/1213 (29.1014%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 502/1213 (41.3850%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7936, Accuracy: 90/10000 (0.9000%)
time spent on training: 170.14209055900574
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5648, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.7041368484497 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 357/1573 (22.6955%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 573/1573 (36.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4491, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 411/1953 (21.0445%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 745/1953 (38.1464%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1780, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 427/1904 (22.4265%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 681/1904 (35.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9000, Accuracy: 109/10000 (1.0900%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 425/1574 (27.0013%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 698/1574 (44.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2153, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8243, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 167/818 (20.4156%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 356/818 (43.5208%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2978, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 636/1750 (36.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6518, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8260, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 314/690 (45.5072%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.3383, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 387/1956 (19.7853%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 664/1956 (33.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4503, Accuracy: 101/10000 (1.0100%)
time spent on training: 247.86604833602905
[foolsgold agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.037035991265717945
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5646, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.66182947158813 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 324/1013 (31.9842%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 511/1013 (50.4442%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6458, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 259/1071 (24.1830%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 528/1071 (49.2997%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.9026, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0745, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 234/781 (29.9616%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.8874, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0798, Accuracy: 73/460 (15.8696%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7548, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 304/938 (32.4094%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1834, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 526/1552 (33.8918%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 749/1552 (48.2603%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.3266, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.7723, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 303/1131 (26.7905%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 404/1131 (35.7206%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5645, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 258/1513 (17.0522%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 516/1513 (34.1044%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3381, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 378/1427 (26.4891%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 565/1427 (39.5936%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.9843, Accuracy: 54/10000 (0.5400%)
time spent on training: 171.2114760875702
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5639, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.94409799575806 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0552, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 79/486 (16.2551%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8147, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9248, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 619/1427 (43.3777%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.8034, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 185/938 (19.7228%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 347/938 (36.9936%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5127, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 399/1036 (38.5135%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 686/1036 (66.2162%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.1678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 341/1446 (23.5823%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 522/1446 (36.0996%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2119, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7182, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 383/735 (52.1088%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8063, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 540/1470 (36.7347%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 854/1470 (58.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1979, Accuracy: 64/10000 (0.6400%)
time spent on training: 212.0382149219513
[foolsgold agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5593, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.4219765663147 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 451/1163 (38.7790%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8705, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6281, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 374/1628 (22.9730%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 778/1628 (47.7887%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1822, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 328/1013 (32.3791%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.8702, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 340/807 (42.1314%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.0557, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 530/1470 (36.0544%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 860/1470 (58.5034%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1051, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 56/311 (18.0064%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3508, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 492/1552 (31.7010%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.3305, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2386, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4483, Accuracy: 50/10000 (0.5000%)
time spent on training: 187.43095302581787
[foolsgold agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5596, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.68261623382568 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 140/809 (17.3053%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 360/809 (44.4994%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1800, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 538/1213 (44.3528%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.4381, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0554, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.4945, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 169/938 (18.0171%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 341/938 (36.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.2278, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.8750, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 582/2227 (26.1338%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.1987, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5055, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 297/813 (36.5314%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 446/813 (54.8585%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8263, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 294/590 (49.8305%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9035, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7634, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.93719506263733
[foolsgold agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5576, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 233.30406546592712 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 430/1953 (22.0174%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 762/1953 (39.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6606, Accuracy: 118/10000 (1.1800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 396/1574 (25.1588%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 720/1574 (45.7433%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9014, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 144/809 (17.7998%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5656, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3940, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 727/1129 (64.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7513, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 401/1628 (24.6314%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 826/1628 (50.7371%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1370, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0283, Accuracy: 510/1130 (45.1327%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4773, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.3563, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 408/712 (57.3034%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.5040, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0629, Accuracy: 366/1163 (31.4703%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 393/1163 (33.7919%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.5295, Accuracy: 60/10000 (0.6000%)
time spent on training: 231.05552649497986
[foolsgold agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.04452969400688032
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5578, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.0761752128601 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 67/500 (13.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7176, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 559/1340 (41.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7189, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 148/682 (21.7009%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 247/682 (36.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.3856, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.6695, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 426/1440 (29.5833%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 661/1440 (45.9028%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0179, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 460/1715 (26.8222%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0301, Accuracy: 740/1715 (43.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6583, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8260, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 432/1163 (37.1453%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.9048, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 305/1089 (28.0073%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 467/1089 (42.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7316, Accuracy: 73/10000 (0.7300%)
time spent on training: 199.86519694328308
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5552, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.70597290992737 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0401, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.1281, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 263/888 (29.6171%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 444/888 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9450, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 426/1129 (37.7325%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1750, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 435/1742 (24.9713%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 687/1742 (39.4374%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.5682, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 464/1130 (41.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4199, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 424/896 (47.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.2087, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0535, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 492/1154 (42.6343%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4003, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 382/803 (47.5716%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0413, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 408/1475 (27.6610%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 640/1475 (43.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2619, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0307, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.9110, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.60110759735107
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3110, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5536, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.49799942970276 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.6540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4621, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 436/888 (49.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.6688, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1232, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1049, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 540/1470 (36.7347%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 871/1470 (59.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1947, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0548, Accuracy: 373/1418 (26.3047%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.5698, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 387/1427 (27.1198%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 558/1427 (39.1030%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.8640, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0349, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8132, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 514/1552 (33.1186%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 780/1552 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.1296, Accuracy: 85/10000 (0.8500%)
time spent on training: 201.4924976825714
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.83427058 1.
 1.         1.         0.83427058 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3109, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5536, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.7951662540436 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 437/1587 (27.5362%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 617/1587 (38.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3062, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.5179, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.8513, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 316/1013 (31.1945%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7964, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 438/1953 (22.4270%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0329, Accuracy: 819/1953 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5047, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 405/1440 (28.1250%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 643/1440 (44.6528%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7910, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0544, Accuracy: 381/1475 (25.8305%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 639/1475 (43.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.9046, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 262/1241 (21.1120%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3396, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 153/682 (22.4340%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.2884, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0563, Accuracy: 225/861 (26.1324%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0210, Accuracy: 442/861 (51.3357%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9369, Accuracy: 57/10000 (0.5700%)
time spent on training: 196.4756474494934
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3108, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5520, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.76752066612244 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.9042, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3042, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 445/1742 (25.5454%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 730/1742 (41.9059%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7280, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0862, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 137/682 (20.0880%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3526, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 458/1715 (26.7055%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 727/1715 (42.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5241, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.4514, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0609, Accuracy: 264/1241 (21.2732%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3420, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 387/1956 (19.7853%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.0978, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 382/1418 (26.9394%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 599/1418 (42.2426%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7479, Accuracy: 106/10000 (1.0600%)
time spent on training: 185.54387021064758
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5517, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.29290461540222 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0354, Accuracy: 370/946 (39.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.0375, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.6992, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0521, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0318, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8711, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 272/1071 (25.3968%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 500/1071 (46.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8276, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 386/1628 (23.7101%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 851/1628 (52.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5500, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 171/938 (18.2303%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 341/938 (36.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.4083, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 467/888 (52.5901%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7433, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 263/1131 (23.2538%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.4855, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 341/1645 (20.7295%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 659/1645 (40.0608%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8407, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0849, Accuracy: 54/466 (11.5880%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0453, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.6763, Accuracy: 50/10000 (0.5000%)
time spent on training: 221.23003363609314
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5504, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.6063151359558 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.2425, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0594, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.7658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 384/803 (47.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0202, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 340/946 (35.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0112, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.6758, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 254/1513 (16.7878%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 491/1513 (32.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.3615, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0629, Accuracy: 283/708 (39.9718%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0359, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.9815, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 358/1003 (35.6929%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9145, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 238/1049 (22.6883%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 521/1049 (49.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.5002, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.6894, Accuracy: 52/10000 (0.5200%)
time spent on training: 165.28133749961853
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5501, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.86315393447876 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 355/807 (43.9901%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5473, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.8246, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 315/946 (33.2981%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 327/946 (34.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0974, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.9235, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.8244, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1002, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0813, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.6136, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0613, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 379/901 (42.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0803, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0623, Accuracy: 372/1163 (31.9862%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 443/1163 (38.0911%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2304, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 731/1552 (47.1005%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.6803, Accuracy: 83/10000 (0.8300%)
time spent on training: 164.10649919509888
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5506, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.52395033836365 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 379/1956 (19.3763%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8147, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 178/938 (18.9765%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.0888, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0612, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0303, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.7479, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0655, Accuracy: 183/773 (23.6740%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 417/773 (53.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 344/1154 (29.8094%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 469/1154 (40.6412%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 239/1513 (15.7964%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 484/1513 (31.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2465, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 424/1036 (40.9266%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 675/1036 (65.1544%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.9538, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3466, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1041, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0296, Accuracy: 720/1475 (48.8136%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.8623, Accuracy: 87/10000 (0.8700%)
time spent on training: 223.63679194450378
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3104, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5486, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.0503852367401 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 101/631 (16.0063%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.9107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0502, Accuracy: 401/1628 (24.6314%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 843/1628 (51.7813%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2371, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0638, Accuracy: 181/938 (19.2964%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0327, Accuracy: 347/938 (36.9936%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.0673, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 426/896 (47.5446%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.3452, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0685, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 266/774 (34.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4723, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.7983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0965, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 335/1340 (25.0000%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 558/1340 (41.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7751, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.1720, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 479/1953 (24.5264%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0329, Accuracy: 839/1953 (42.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5332, Accuracy: 121/10000 (1.2100%)
time spent on training: 186.37543106079102
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 0. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3103, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5433, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.13565969467163 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 85/486 (17.4897%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7937, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0617, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.9695, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 442/888 (49.7748%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3955, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 319/677 (47.1196%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.1629, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0523, Accuracy: 135/515 (26.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7852, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0804, Accuracy: 34/373 (9.1153%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.4540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0728, Accuracy: 126/781 (16.1332%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8923, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 390/1949 (20.0103%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8071, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 408/1036 (39.3822%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0235, Accuracy: 683/1036 (65.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.7739, Accuracy: 53/10000 (0.5300%)
time spent on training: 190.55941128730774
[foolsgold agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5432, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.93546295166016 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 357/1446 (24.6888%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 489/1446 (33.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3493, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0671, Accuracy: 191/773 (24.7089%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0301, Accuracy: 403/773 (52.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.2098, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0786, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.6774, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0506, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1302, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0371, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8268, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 176/818 (21.5159%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.0607, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 144/682 (21.1144%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.3198, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 347/712 (48.7360%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 411/712 (57.7247%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.7132, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 419/803 (52.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.0244, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4127, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.0484743118286
[foolsgold agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5436, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.1491494178772 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 250/1513 (16.5235%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 479/1513 (31.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2203, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 444/1129 (39.3268%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 740/1129 (65.5447%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.3659, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0667, Accuracy: 193/773 (24.9677%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 394/773 (50.9702%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4946, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 157/568 (27.6408%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.7433, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.5466, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 331/946 (34.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.1124, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 361/1657 (21.7864%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 525/1657 (31.6838%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5049, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0505, Accuracy: 343/1030 (33.3010%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0265, Accuracy: 649/1030 (63.0097%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5739, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 456/1715 (26.5889%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 716/1715 (41.7493%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7215, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 289/636 (45.4403%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.6327, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.13625478744507
[foolsgold agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5440, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.1566035747528 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 315/1131 (27.8515%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 449/1131 (39.6994%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6253, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 283/953 (29.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.4386, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 314/938 (33.4755%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.2626, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0324, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 124/781 (15.8771%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 213/781 (27.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.7984, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 493/1130 (43.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6835, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 144/682 (21.1144%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 239/682 (35.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.3982, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 359/712 (50.4213%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 270/888 (30.4054%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 445/888 (50.1126%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2527, Accuracy: 50/10000 (0.5000%)
time spent on training: 240.50944709777832
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3101, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5409, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.2060513496399 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 385/901 (42.7303%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.7892, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 170/818 (20.7824%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 343/818 (41.9315%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.5498, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 363/1275 (28.4706%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 712/1275 (55.8431%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8166, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.4568, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.6144, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.4143, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0367, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.7854, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 303/1131 (26.7905%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 374/1131 (33.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3429, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0504, Accuracy: 344/1030 (33.3981%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0265, Accuracy: 633/1030 (61.4563%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5279, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 607/1427 (42.5368%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.9623, Accuracy: 53/10000 (0.5300%)
time spent on training: 189.46324706077576
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5413, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.62299489974976 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 587/2227 (26.3583%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1025/2227 (46.0260%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4234, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0605, Accuracy: 292/708 (41.2429%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0385, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8814, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0801, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4468, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0781, Accuracy: 92/486 (18.9300%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0429, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8761, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 36/440 (8.1818%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.5312, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.0875, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 367/1418 (25.8815%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.7603, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 452/1089 (41.5060%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2558, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.7285, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 430/1587 (27.0951%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.1101, Accuracy: 69/10000 (0.6900%)
time spent on training: 202.00899410247803
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5408, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.893607378006 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 522/1657 (31.5027%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0295, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 262/888 (29.5045%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 461/888 (51.9144%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.8291, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1191, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1062, Accuracy: 21/134 (15.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 268/776 (34.5361%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.9555, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 497/1213 (40.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6767, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 46/271 (16.9742%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3732, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 316/690 (45.7971%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.6946, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0734, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.9292, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 127/530 (23.9623%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0376, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1070, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0529, Accuracy: 344/1030 (33.3981%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 655/1030 (63.5922%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7253, Accuracy: 73/10000 (0.7300%)
time spent on training: 161.83666443824768
[foolsgold agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5412, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.93884587287903 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 292/590 (49.4915%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.8380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0507, Accuracy: 140/515 (27.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.8988, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 308/1013 (30.4047%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.7824, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0514, Accuracy: 341/599 (56.9282%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.7846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 350/1662 (21.0590%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4609, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 40/312 (12.8205%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3940, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.4148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0552, Accuracy: 436/1988 (21.9316%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6512, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0370, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2180, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 232/1049 (22.1163%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 512/1049 (48.8084%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6019, Accuracy: 83/10000 (0.8300%)
time spent on training: 175.15123987197876
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5415, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.6651372909546 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.2279, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 420/1904 (22.0588%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 703/1904 (36.9223%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6860, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0624, Accuracy: 155/809 (19.1595%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 358/809 (44.2522%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5899, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0576, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.0456, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0623, Accuracy: 366/1003 (36.4905%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.7776, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6661, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0644, Accuracy: 180/938 (19.1898%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 310/938 (33.0490%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5383, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 614/2227 (27.5707%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1039/2227 (46.6547%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5077, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3463, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3016, Accuracy: 57/10000 (0.5700%)
time spent on training: 189.38144373893738
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5394, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.01643705368042 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0590, Accuracy: 307/1089 (28.1910%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2401, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0517, Accuracy: 356/1030 (34.5631%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 655/1030 (63.5922%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3992, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.0803, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.7771, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 35/440 (7.9545%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 334/599 (55.7596%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.9144, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0489, Accuracy: 622/2227 (27.9300%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1046/2227 (46.9690%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.2592, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 346/896 (38.6161%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.2316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 285/813 (35.0554%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 439/813 (53.9975%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.3715, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.7149, Accuracy: 67/10000 (0.6700%)
time spent on training: 182.3758566379547
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5385, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.08316779136658 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 361/803 (44.9564%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 362/803 (45.0809%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.0981, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.6627, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.0870, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.5162, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1038, Accuracy: 22/197 (11.1675%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0855, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3194, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 616/2227 (27.6605%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1042/2227 (46.7894%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2814, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2772, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 417/1904 (21.9013%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 669/1904 (35.1366%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.5707, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 144/682 (21.1144%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 247/682 (36.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3192, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0492, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.4498, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 87/486 (17.9012%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.7978, Accuracy: 44/10000 (0.4400%)
time spent on training: 189.3480212688446
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5370, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.5848617553711 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0307, Accuracy: 516/1372 (37.6093%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7786, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 175/953 (18.3631%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 285/953 (29.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.3861, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0590, Accuracy: 211/735 (28.7075%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.9607, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 296/928 (31.8966%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6656, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 117/271 (43.1734%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3718, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 394/1750 (22.5143%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 660/1750 (37.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.0032, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 513/1552 (33.0541%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 757/1552 (48.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.6435, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 434/1742 (24.9139%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 719/1742 (41.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7456, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0828, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 185/416 (44.4712%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.5926, Accuracy: 51/10000 (0.5100%)
time spent on training: 226.9983949661255
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3097, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.7998995780945 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 374/1213 (30.8326%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 523/1213 (43.1162%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7104, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.5824, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 317/813 (38.9914%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 461/813 (56.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.9772, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0488, Accuracy: 596/2227 (26.7625%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1041/2227 (46.7445%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3259, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 269/1071 (25.1167%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 499/1071 (46.5920%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0767, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 371/1581 (23.4662%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 616/1581 (38.9627%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5273, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0508, Accuracy: 435/1129 (38.5297%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 748/1129 (66.2533%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6296, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 393/1750 (22.4571%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 659/1750 (37.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0674, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9336, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 331/1013 (32.6752%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.7345, Accuracy: 61/10000 (0.6100%)
time spent on training: 253.7428162097931
[foolsgold agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3097, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.26095056533813 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.6713, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0652, Accuracy: 234/605 (38.6777%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0380, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8315, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9560, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 118/530 (22.2642%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.1325, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0497, Accuracy: 340/599 (56.7613%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0311, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 365/891 (40.9652%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 393/891 (44.1077%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 410/1131 (36.2511%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4457, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 47/416 (11.2981%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.5817, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0463, Accuracy: 495/1470 (33.6735%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 853/1470 (58.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4977, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 308/1154 (26.6898%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0245, Accuracy: 530/1154 (45.9272%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.1795, Accuracy: 77/10000 (0.7700%)
time spent on training: 199.43155336380005
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3097, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.95699739456177 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 78/186 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0799, Accuracy: 35/373 (9.3834%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.4613, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 491/1089 (45.0872%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1505, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0474, Accuracy: 404/1036 (38.9961%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 660/1036 (63.7066%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1867, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 587/1427 (41.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.9145, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 823/1953 (42.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9920, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.4782, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0605, Accuracy: 313/946 (33.0867%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0350, Accuracy: 371/946 (39.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0792, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 374/1573 (23.7762%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 599/1573 (38.0801%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6247, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0570, Accuracy: 355/803 (44.2092%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 382/803 (47.5716%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.1516, Accuracy: 56/10000 (0.5600%)
time spent on training: 220.64308643341064
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.06249618530273 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2955, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6616, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 308/813 (37.8844%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 478/813 (58.7946%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.4176, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0602, Accuracy: 385/1163 (33.1040%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0369, Accuracy: 469/1163 (40.3267%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.7706, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 487/1988 (24.4970%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 672/1988 (33.8028%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.7952, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 379/1750 (21.6571%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 676/1750 (38.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3400, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0580, Accuracy: 311/690 (45.0725%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.3363, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 434/1904 (22.7941%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 686/1904 (36.0294%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5258, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0588, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0692, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
time spent on training: 249.51764011383057
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.8257689476013 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3037, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 244/774 (31.5245%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 294/774 (37.9845%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2746, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 471/1953 (24.1167%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 773/1953 (39.5801%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0315, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0752, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1272, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 153/568 (26.9366%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8340, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 434/1402 (30.9558%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5259, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 408/1581 (25.8065%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 619/1581 (39.1524%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7096, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 84/408 (20.5882%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0531, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.5167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0544, Accuracy: 432/1988 (21.7304%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2068, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 48/416 (11.5385%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 189/416 (45.4327%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.6222, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.3643479347229
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5295, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.7934539318085 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 513/1372 (37.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8842, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1192, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1106, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 516/1446 (35.6846%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5666, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 401/1750 (22.9143%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 670/1750 (38.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5060, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 252/1402 (17.9743%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 423/1402 (30.1712%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1735, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 358/1662 (21.5403%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 666/1662 (40.0722%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7688, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 554/1470 (37.6871%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3371, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 257/1131 (22.7233%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 504/1131 (44.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3642, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0549, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 470/1154 (40.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1307, Accuracy: 50/10000 (0.5000%)
time spent on training: 258.66632890701294
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5301, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.01881432533264 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3944, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0555, Accuracy: 381/1573 (24.2212%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 599/1573 (38.0801%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5103, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 259/1131 (22.9001%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 482/1131 (42.6172%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2933, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7069, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0532, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.8048, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0282, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.9250, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 409/1581 (25.8697%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 612/1581 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5646, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0551, Accuracy: 361/1418 (25.4584%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 653/1418 (46.0508%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6973, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0251, Accuracy: 468/891 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.0008, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.3198, Accuracy: 50/10000 (0.5000%)
time spent on training: 221.4105670452118
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5307, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.51219272613525 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0848, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 112/271 (41.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3714, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 80/515 (15.5340%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7508, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0545, Accuracy: 366/1418 (25.8110%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5809, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 219/861 (25.4355%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 459/861 (53.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3047, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 157/818 (19.1932%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 331/818 (40.4645%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.0958, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 414/896 (46.2054%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.2996, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8086, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8637, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 32/440 (7.2727%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0469, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.5148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0632, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0373, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7567, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.5287148952484
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5307, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.263085603714 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 463/677 (68.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2799, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 150/603 (24.8756%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.1166, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.9654, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9519, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0563, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 501/1154 (43.4142%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.9168, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 339/719 (47.1488%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0306, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.3297, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 408/1742 (23.4214%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 705/1742 (40.4707%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.7185, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 333/1645 (20.2432%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 635/1645 (38.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9520, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 391/1581 (24.7312%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 614/1581 (38.8362%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6185, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 399/1440 (27.7083%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 696/1440 (48.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9147, Accuracy: 72/10000 (0.7200%)
time spent on training: 257.9973921775818
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.09815406799316 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 483/1552 (31.1211%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 782/1552 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.2574, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 408/1956 (20.8589%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 650/1956 (33.2311%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0608, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0326, Accuracy: 605/1427 (42.3966%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.9324, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0555, Accuracy: 296/928 (31.8966%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 586/928 (63.1466%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6991, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 491/1715 (28.6297%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 737/1715 (42.9738%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9442, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0611, Accuracy: 232/1013 (22.9023%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 327/1013 (32.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.6903, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0677, Accuracy: 203/669 (30.3438%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.9118, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 402/1402 (28.6733%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.1518, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 472/1130 (41.7699%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6605, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 267/1241 (21.5149%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.0504, Accuracy: 58/10000 (0.5800%)
time spent on training: 275.323716878891
[foolsgold agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3092, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.755090713501 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 296/813 (36.4084%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 482/813 (59.2866%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.1559, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 525/1470 (35.7143%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 850/1470 (57.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.0389, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 358/1662 (21.5403%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 617/1662 (37.1239%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9771, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 359/1213 (29.5960%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 491/1213 (40.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.6045, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 428/1587 (26.9691%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 584/1587 (36.7990%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2424, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 246/1049 (23.4509%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 519/1049 (49.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3869, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1067, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0613, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7539, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 339/901 (37.6249%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 405/901 (44.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.8954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0641, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7958, Accuracy: 61/10000 (0.6100%)
time spent on training: 236.11720418930054
[foolsgold agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.70109064 1.         1.         0.70109064]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3092, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5322, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.11061239242554 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0447, Accuracy: 180/416 (43.2692%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.5942, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0720, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0345, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.7306, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 347/1657 (20.9415%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 527/1657 (31.8045%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6196, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0487, Accuracy: 376/1275 (29.4902%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 739/1275 (57.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.8575, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 367/1573 (23.3312%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 581/1573 (36.9358%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2952, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0559, Accuracy: 302/928 (32.5431%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 589/928 (63.4698%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9393, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0532, Accuracy: 311/1154 (26.9497%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 517/1154 (44.8007%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9124, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 215/861 (24.9710%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0206, Accuracy: 475/861 (55.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8431, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 418/1581 (26.4390%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 605/1581 (38.2669%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9220, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.7914, Accuracy: 50/10000 (0.5000%)
time spent on training: 247.97299194335938
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3092, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5330, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.1742014884949 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.6685, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0585, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3652, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0550, Accuracy: 303/928 (32.6509%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 572/928 (61.6379%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0250, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 424/1440 (29.4444%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 705/1440 (48.9583%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.7181, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0578, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.3511, Accuracy: 55/10000 (0.5500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 410/1574 (26.0483%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 652/1574 (41.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3383, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0486, Accuracy: 620/2227 (27.8401%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5181, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8048, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9562, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 374/1628 (22.9730%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 796/1628 (48.8943%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2669, Accuracy: 119/10000 (1.1900%)
time spent on training: 288.49436616897583
[foolsgold agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.040607198877239334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5317, Accuracy: 0/9950 (0.0000%)
saving model
Done in 355.3655524253845 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 709/1129 (62.7989%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1712, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0842, Accuracy: 48/271 (17.7122%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3743, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.7299, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 180/938 (19.1898%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 343/938 (36.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.2036, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 446/1953 (22.8367%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 781/1953 (39.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5913, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1617, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 355/1446 (24.5505%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 528/1446 (36.5145%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5268, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 392/1573 (24.9205%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 578/1573 (36.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4504, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0552, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4601, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 285/813 (35.0554%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 451/813 (55.4736%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.8756, Accuracy: 50/10000 (0.5000%)
time spent on training: 240.72895550727844
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.88000121 1.         1.         0.88000121 1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.714231967926 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0294, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.9376, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0549, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 507/1071 (47.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6218, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1166, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3038, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0737, Accuracy: 152/603 (25.2073%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.9240, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 172/818 (21.0269%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 360/818 (44.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4644, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 336/1154 (29.1161%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0299, Accuracy: 381/1154 (33.0156%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.9509, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0761, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0591, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 338/735 (45.9864%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0794, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1949 (31.6060%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2841, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3107, Accuracy: 50/10000 (0.5000%)
time spent on training: 202.2352738380432
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.4881799221039 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.7788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 112/631 (17.7496%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.9522, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 402/1427 (28.1710%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.9922, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0548, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 678/1475 (45.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.9074, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 169/312 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3930, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 146/682 (21.4076%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.4620, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0511, Accuracy: 463/1129 (41.0097%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0240, Accuracy: 753/1129 (66.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9135, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1245, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3038, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0524, Accuracy: 345/1030 (33.4951%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0245, Accuracy: 624/1030 (60.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0725, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 559/1340 (41.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7712, Accuracy: 70/10000 (0.7000%)
time spent on training: 220.06496500968933
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5273, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.9396471977234 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 415/1904 (21.7962%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 654/1904 (34.3487%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7572, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 190/953 (19.9370%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.5071, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.0974, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.7882, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 269/1131 (23.7843%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3764, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 335/901 (37.1809%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.6936, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 362/1657 (21.8467%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 554/1657 (33.4339%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7765, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.2413, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0616, Accuracy: 362/1003 (36.0917%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 366/1003 (36.4905%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.6391, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 507/1154 (43.9341%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.5360, Accuracy: 68/10000 (0.6800%)
time spent on training: 272.94085144996643
[foolsgold agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5270, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.36757588386536 sec.
Saving all the graphs.
This run has a label: Jun.28_13.43.49. Visdom environment: tiny
