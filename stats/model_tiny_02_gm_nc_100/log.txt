current path: saved_models/model_tiny_Jun.29_07.52.35
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [84, 86, 65, 96, 55, 56, 28, 93, 16, 79].
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0621, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 354/1003 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.5822, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 367/1475 (24.8814%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 668/1475 (45.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0054, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3424, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0575, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 504/1071 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1223, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3125, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 567/1581 (35.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4297, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   1, Avg loss: 0.0558, Accuracy: 395/1742 (22.6751%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 686/1742 (39.3800%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4962, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0660, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0364, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7450, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   2, Avg loss: 0.0836, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3238, Accuracy: 50/10000 (0.5000%)
time spent on training: 104.38486886024475
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1003, 1475, 311, 1071, 186, 1581, 1742, 708, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 86, 65, 96, 55, 56, 28, 93, 16, 79], weight: tensor([0.1257, 0.1060, 0.1559, 0.0329, 0.1132, 0.0197, 0.1671, 0.1841, 0.0748,
        0.0208])
[rfa agg] iter:  0, prev_obj_val: 53.99895477294922, obj_val: 56.710147857666016, abs dis: 2.711193084716797
[rfa agg] iter: 0, weight: tensor([0.2794, 0.1652, 0.0859, 0.0084, 0.2694, 0.0043, 0.0794, 0.0616, 0.0414,
        0.0049])
[rfa agg] iter:  1, prev_obj_val: 56.710147857666016, obj_val: 58.579524993896484, abs dis: 1.8693771362304688
[rfa agg] iter: 1, weight: tensor([0.1633, 0.2338, 0.0632, 0.0078, 0.3739, 0.0039, 0.0596, 0.0479, 0.0422,
        0.0045])
[rfa agg] iter:  2, prev_obj_val: 58.579524993896484, obj_val: 63.59713363647461, abs dis: 5.017608642578125
[rfa agg] iter: 2, weight: tensor([0.1261, 0.3101, 0.0564, 0.0077, 0.3492, 0.0039, 0.0536, 0.0438, 0.0446,
        0.0045])
[rfa agg] iter:  3, prev_obj_val: 63.59713363647461, obj_val: 66.51737213134766, abs dis: 2.920238494873047
[rfa agg] iter: 3, weight: tensor([0.1137, 0.4045, 0.0606, 0.0103, 0.2237, 0.0051, 0.0583, 0.0490, 0.0688,
        0.0059])
[rfa agg] iter:  4, prev_obj_val: 66.51737213134766, obj_val: 60.84575271606445, abs dis: 5.671619415283203
[rfa agg] iter: 4, weight: tensor([0.1198, 0.3648, 0.0682, 0.0128, 0.2038, 0.0063, 0.0660, 0.0561, 0.0949,
        0.0073])
[rfa agg] iter:  5, prev_obj_val: 60.84575271606445, obj_val: 60.8262939453125, abs dis: 0.019458770751953125
[rfa agg] iter: 5, weight: tensor([0.1037, 0.4721, 0.0511, 0.0078, 0.2189, 0.0039, 0.0489, 0.0405, 0.0485,
        0.0045])
[rfa agg] iter:  6, prev_obj_val: 60.8262939453125, obj_val: 60.82306671142578, abs dis: 0.00322723388671875
[rfa agg] iter: 6, weight: tensor([0.0971, 0.5060, 0.0481, 0.0073, 0.2040, 0.0037, 0.0460, 0.0381, 0.0455,
        0.0042])
[rfa agg] iter:  7, prev_obj_val: 60.82306671142578, obj_val: 60.8220329284668, abs dis: 0.001033782958984375
[rfa agg] iter: 7, weight: tensor([0.0940, 0.5242, 0.0465, 0.0071, 0.1951, 0.0036, 0.0445, 0.0369, 0.0440,
        0.0041])
[rfa agg] iter:  8, prev_obj_val: 60.8220329284668, obj_val: 58.61589050292969, abs dis: 2.2061424255371094
[rfa agg] iter: 8, weight: tensor([0.0921, 0.5347, 0.0457, 0.0070, 0.1899, 0.0035, 0.0437, 0.0362, 0.0432,
        0.0040])
[rfa agg] iter:  9, prev_obj_val: 58.61589050292969, obj_val: 58.57132339477539, abs dis: 0.044567108154296875
[rfa agg] iter: 9, weight: tensor([0.1190, 0.4107, 0.0540, 0.0074, 0.2649, 0.0037, 0.0513, 0.0419, 0.0428,
        0.0043])
			Update norm = 156.4907270615419 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.97869729995728 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 99, 85, 29, 7, 20].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0569, Accuracy: 361/1475 (24.4746%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 655/1475 (44.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9889, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 95/631 (15.0555%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0417, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7517, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 420/1750 (24.0000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 666/1750 (38.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2384, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 298/690 (43.1884%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0293, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2377, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0666, Accuracy: 168/773 (21.7335%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 378/773 (48.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9659, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 456/1988 (22.9376%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 660/1988 (33.1992%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.6074, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 435/1440 (30.2083%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 666/1440 (46.2500%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6276, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 343/891 (38.4961%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 463/891 (51.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8235, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 350/807 (43.3705%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 397/807 (49.1945%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9495, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.96835851669312
[rfa agg] training data poison_ratio: 0.07502091661243841  data num: [1475, 631, 1750, 312, 690, 773, 1988, 1440, 891, 807]
[rfa agg] considering poison per batch poison_fraction: 0.023444036441387005
[rfa agg] init. name: [65, 48, 44, 24, 25, 99, 85, 29, 7, 20], weight: tensor([0.1371, 0.0587, 0.1627, 0.0290, 0.0641, 0.0719, 0.1848, 0.1339, 0.0828,
        0.0750])
[rfa agg] iter:  0, prev_obj_val: 70.65528869628906, obj_val: 70.63668823242188, abs dis: 0.0186004638671875
[rfa agg] iter: 0, weight: tensor([0.1803, 0.0436, 0.1207, 0.0138, 0.0536, 0.0798, 0.0952, 0.2200, 0.1098,
        0.0832])
			Update norm = 177.6931717350163 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.398255109787 sec.
Server Epoch:3 choose agents : [76, 59, 8, 85, 95, 14, 4, 70, 94, 11].
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   1, Avg loss: 0.0870, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6029, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0540, Accuracy: 286/1089 (26.2626%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0294, Accuracy: 414/1089 (38.0165%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6034, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 214/1513 (14.1441%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 473/1513 (31.2624%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4870, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 434/1988 (21.8310%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 674/1988 (33.9034%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8855, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 321/599 (53.5893%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7522, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 321/1013 (31.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6381, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0608, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0347, Accuracy: 417/901 (46.2819%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7802, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 332/1418 (23.4133%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 607/1418 (42.8068%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7276, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 341/1662 (20.5174%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 599/1662 (36.0409%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8052, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 339/712 (47.6124%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.4752, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.01518893241882
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1089, 1513, 1988, 599, 1013, 901, 1418, 1662, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 59, 8, 85, 95, 14, 4, 70, 94, 11], weight: tensor([0.0410, 0.0959, 0.1332, 0.1750, 0.0527, 0.0892, 0.0793, 0.1248, 0.1463,
        0.0627])
[rfa agg] iter:  0, prev_obj_val: 59.37153625488281, obj_val: 65.61709594726562, abs dis: 6.2455596923828125
[rfa agg] iter: 0, weight: tensor([0.0172, 0.2737, 0.1215, 0.0621, 0.0270, 0.1319, 0.0892, 0.1406, 0.0957,
        0.0412])
[rfa agg] iter:  1, prev_obj_val: 65.61709594726562, obj_val: 69.54830169677734, abs dis: 3.9312057495117188
[rfa agg] iter: 1, weight: tensor([0.0173, 0.1919, 0.0637, 0.0406, 0.0290, 0.3257, 0.1585, 0.0686, 0.0552,
        0.0495])
[rfa agg] iter:  2, prev_obj_val: 69.54830169677734, obj_val: 69.52037811279297, abs dis: 0.027923583984375
[rfa agg] iter: 2, weight: tensor([0.0177, 0.1146, 0.0509, 0.0346, 0.0310, 0.3520, 0.2430, 0.0539, 0.0452,
        0.0572])
[rfa agg] iter:  3, prev_obj_val: 69.52037811279297, obj_val: 71.99595642089844, abs dis: 2.4755783081054688
[rfa agg] iter: 3, weight: tensor([0.0173, 0.1101, 0.0497, 0.0338, 0.0303, 0.3482, 0.2579, 0.0526, 0.0442,
        0.0559])
[rfa agg] iter:  4, prev_obj_val: 71.99595642089844, obj_val: 74.7148208618164, abs dis: 2.7188644409179688
[rfa agg] iter: 4, weight: tensor([0.0200, 0.1020, 0.0507, 0.0354, 0.0359, 0.2572, 0.3300, 0.0533, 0.0456,
        0.0699])
[rfa agg] iter:  5, prev_obj_val: 74.7148208618164, obj_val: 74.71085357666016, abs dis: 0.00396728515625
[rfa agg] iter: 5, weight: tensor([0.0238, 0.0986, 0.0533, 0.0381, 0.0441, 0.2027, 0.3434, 0.0557, 0.0483,
        0.0921])
[rfa agg] iter:  6, prev_obj_val: 74.71085357666016, obj_val: 74.71074676513672, abs dis: 0.0001068115234375
[rfa agg] iter: 6, weight: tensor([0.0236, 0.0977, 0.0529, 0.0378, 0.0438, 0.1983, 0.3510, 0.0553, 0.0480,
        0.0916])
			Update norm = 139.54215033010635 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.3080348968506 sec.
Server Epoch:4 choose agents : [21, 65, 32, 76, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 410/1949 (21.0364%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 652/1949 (33.4531%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.7553, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0565, Accuracy: 375/1475 (25.4237%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 672/1475 (45.5593%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9033, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0618, Accuracy: 193/735 (26.2585%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 340/735 (46.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5134, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6594, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 454/891 (50.9540%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.2485, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0423, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3903, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0577, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0334, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3288, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 275/636 (43.2390%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2621, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 316/1645 (19.2097%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 599/1645 (36.4134%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0978, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0391, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5202, Accuracy: 57/10000 (0.5700%)
time spent on training: 130.6977822780609
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 466, 891, 312, 719, 636, 1645, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 65, 32, 76, 7, 24, 41, 52, 13, 64], weight: tensor([0.1993, 0.1508, 0.0751, 0.0476, 0.0911, 0.0319, 0.0735, 0.0650, 0.1682,
        0.0974])
[rfa agg] iter:  0, prev_obj_val: 70.80718994140625, obj_val: 72.06616973876953, abs dis: 1.2589797973632812
[rfa agg] iter: 0, weight: tensor([0.0815, 0.1220, 0.0854, 0.0302, 0.1679, 0.0151, 0.0833, 0.0529, 0.1066,
        0.2552])
[rfa agg] iter:  1, prev_obj_val: 72.06616973876953, obj_val: 77.54871368408203, abs dis: 5.4825439453125
[rfa agg] iter: 1, weight: tensor([0.0382, 0.0511, 0.0752, 0.0207, 0.2255, 0.0097, 0.0731, 0.0395, 0.0468,
        0.4201])
[rfa agg] iter:  2, prev_obj_val: 77.54871368408203, obj_val: 79.38059997558594, abs dis: 1.8318862915039062
[rfa agg] iter: 2, weight: tensor([0.0355, 0.0437, 0.1971, 0.0300, 0.2378, 0.0125, 0.1844, 0.0670, 0.0414,
        0.1507])
[rfa agg] iter:  3, prev_obj_val: 79.38059997558594, obj_val: 84.34476470947266, abs dis: 4.964164733886719
[rfa agg] iter: 3, weight: tensor([0.0300, 0.0364, 0.2755, 0.0290, 0.1563, 0.0116, 0.2531, 0.0697, 0.0347,
        0.1037])
[rfa agg] iter:  4, prev_obj_val: 84.34476470947266, obj_val: 87.40000915527344, abs dis: 3.0552444458007812
[rfa agg] iter: 4, weight: tensor([0.0290, 0.0341, 0.2949, 0.0376, 0.0996, 0.0135, 0.2712, 0.1104, 0.0328,
        0.0768])
[rfa agg] iter:  5, prev_obj_val: 87.40000915527344, obj_val: 87.39238739013672, abs dis: 0.00762176513671875
[rfa agg] iter: 5, weight: tensor([0.0343, 0.0397, 0.2304, 0.0528, 0.1015, 0.0177, 0.2203, 0.1829, 0.0385,
        0.0819])
			Update norm = 109.98538610310918 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.3406822681427 sec.
Server Epoch:5 choose agents : [62, 97, 55, 2, 52, 21, 47, 93, 91, 83].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0698, Accuracy: 131/568 (23.0634%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8031, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 347/1213 (28.6068%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 479/1213 (39.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5161, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8183, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 323/605 (53.3884%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7856, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 280/636 (44.0252%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1751, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 392/1949 (20.1129%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 598/1949 (30.6824%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1824, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1102, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 752/1742 (43.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9910, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 326/1030 (31.6505%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0272, Accuracy: 575/1030 (55.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2529, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 422/1953 (21.6078%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 793/1953 (40.6042%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1631, Accuracy: 111/10000 (1.1100%)
time spent on training: 135.47099328041077
[rfa agg] training data poison_ratio: 0.0  data num: [568, 1213, 1071, 605, 636, 1949, 134, 1742, 1030, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 97, 55, 2, 52, 21, 47, 93, 91, 83], weight: tensor([0.0521, 0.1113, 0.0982, 0.0555, 0.0583, 0.1788, 0.0123, 0.1598, 0.0945,
        0.1792])
[rfa agg] iter:  0, prev_obj_val: 70.56784057617188, obj_val: 71.98682403564453, abs dis: 1.4189834594726562
[rfa agg] iter: 0, weight: tensor([0.0256, 0.2905, 0.1403, 0.0297, 0.0312, 0.1048, 0.0040, 0.1336, 0.1351,
        0.1051])
[rfa agg] iter:  1, prev_obj_val: 71.98682403564453, obj_val: 74.06063842773438, abs dis: 2.0738143920898438
[rfa agg] iter: 1, weight: tensor([0.0185, 0.4593, 0.1558, 0.0218, 0.0230, 0.0527, 0.0027, 0.0628, 0.1504,
        0.0529])
[rfa agg] iter:  2, prev_obj_val: 74.06063842773438, obj_val: 79.30715942382812, abs dis: 5.24652099609375
[rfa agg] iter: 2, weight: tensor([0.0199, 0.3196, 0.2328, 0.0239, 0.0251, 0.0474, 0.0028, 0.0550, 0.2260,
        0.0475])
[rfa agg] iter:  3, prev_obj_val: 79.30715942382812, obj_val: 84.49813842773438, abs dis: 5.19097900390625
[rfa agg] iter: 3, weight: tensor([0.0237, 0.1445, 0.3230, 0.0291, 0.0305, 0.0422, 0.0031, 0.0476, 0.3141,
        0.0423])
[rfa agg] iter:  4, prev_obj_val: 84.49813842773438, obj_val: 81.78133392333984, abs dis: 2.7168045043945312
[rfa agg] iter: 4, weight: tensor([0.0379, 0.1446, 0.2778, 0.0475, 0.0498, 0.0548, 0.0046, 0.0608, 0.2673,
        0.0550])
[rfa agg] iter:  5, prev_obj_val: 81.78133392333984, obj_val: 84.49394226074219, abs dis: 2.7126083374023438
[rfa agg] iter: 5, weight: tensor([0.0297, 0.1404, 0.3067, 0.0368, 0.0387, 0.0478, 0.0037, 0.0534, 0.2949,
        0.0479])
[rfa agg] iter:  6, prev_obj_val: 84.49394226074219, obj_val: 81.78144073486328, abs dis: 2.7125015258789062
[rfa agg] iter: 6, weight: tensor([0.0380, 0.1450, 0.2774, 0.0476, 0.0500, 0.0549, 0.0046, 0.0609, 0.2666,
        0.0551])
[rfa agg] iter:  7, prev_obj_val: 81.78144073486328, obj_val: 84.49394226074219, abs dis: 2.7125015258789062
[rfa agg] iter: 7, weight: tensor([0.0297, 0.1404, 0.3067, 0.0368, 0.0387, 0.0478, 0.0037, 0.0534, 0.2949,
        0.0479])
[rfa agg] iter:  8, prev_obj_val: 84.49394226074219, obj_val: 81.78144073486328, abs dis: 2.7125015258789062
[rfa agg] iter: 8, weight: tensor([0.0380, 0.1450, 0.2774, 0.0476, 0.0500, 0.0549, 0.0046, 0.0609, 0.2666,
        0.0551])
[rfa agg] iter:  9, prev_obj_val: 81.78144073486328, obj_val: 84.49394226074219, abs dis: 2.7125015258789062
[rfa agg] iter: 9, weight: tensor([0.0297, 0.1404, 0.3067, 0.0368, 0.0387, 0.0478, 0.0037, 0.0534, 0.2949,
        0.0479])
			Update norm = 147.92759129258138 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.76664662361145 sec.
Server Epoch:6 choose agents : [42, 85, 94, 95, 56, 86, 53, 33, 44, 96].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 333/1372 (24.2711%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 469/1372 (34.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8162, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 463/1988 (23.2897%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7518, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 327/1662 (19.6751%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8913, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7258, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0616, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 425/1003 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.4771, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.5347, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0518, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.6735, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 383/1750 (21.8857%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 622/1750 (35.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6162, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0545, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3478, Accuracy: 50/10000 (0.5000%)
time spent on training: 133.99240255355835
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1988, 1662, 599, 186, 1003, 813, 515, 1750, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 85, 94, 95, 56, 86, 53, 33, 44, 96], weight: tensor([0.1345, 0.1949, 0.1630, 0.0587, 0.0182, 0.0983, 0.0797, 0.0505, 0.1716,
        0.0305])
[rfa agg] iter:  0, prev_obj_val: 70.74742126464844, obj_val: 72.11707305908203, abs dis: 1.3696517944335938
[rfa agg] iter: 0, weight: tensor([0.3481, 0.0932, 0.1546, 0.0337, 0.0061, 0.1386, 0.0652, 0.0264, 0.1225,
        0.0116])
[rfa agg] iter:  1, prev_obj_val: 72.11707305908203, obj_val: 75.02543640136719, abs dis: 2.9083633422851562
[rfa agg] iter: 1, weight: tensor([0.3122, 0.0937, 0.1497, 0.0372, 0.0066, 0.1649, 0.0735, 0.0289, 0.1208,
        0.0126])
[rfa agg] iter:  2, prev_obj_val: 75.02543640136719, obj_val: 75.0176010131836, abs dis: 0.00783538818359375
[rfa agg] iter: 2, weight: tensor([0.2367, 0.0906, 0.1358, 0.0433, 0.0073, 0.2356, 0.0903, 0.0333, 0.1130,
        0.0141])
			Update norm = 173.33988243837595 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.16180658340454 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 80, 84, 10, 91].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8444, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1160, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3047, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0785, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0539, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6487, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3818, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 340/1418 (23.9774%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7363, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 274/813 (33.7023%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.2306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 139/682 (20.3812%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 270/682 (39.5894%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2474, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 304/1190 (25.5462%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9500, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0580, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 453/861 (52.6132%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1018, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 327/1030 (31.7476%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 640/1030 (62.1359%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1232, Accuracy: 79/10000 (0.7900%)
time spent on training: 130.31017756462097
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 682, 1190, 861, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 61, 33, 24, 70, 53, 80, 84, 10, 91], weight: tensor([0.1343, 0.0107, 0.0646, 0.0391, 0.1778, 0.1019, 0.0855, 0.1492, 0.1079,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 40.10789489746094, obj_val: 43.47333908081055, abs dis: 3.3654441833496094
[rfa agg] iter: 0, weight: tensor([0.1050, 0.0021, 0.0311, 0.0104, 0.0479, 0.1981, 0.0679, 0.0711, 0.3668,
        0.0997])
[rfa agg] iter:  1, prev_obj_val: 43.47333908081055, obj_val: 48.33761215209961, abs dis: 4.8642730712890625
[rfa agg] iter: 1, weight: tensor([0.0789, 0.0022, 0.0381, 0.0115, 0.0425, 0.3638, 0.0976, 0.0588, 0.2314,
        0.0752])
[rfa agg] iter:  2, prev_obj_val: 48.33761215209961, obj_val: 48.31537628173828, abs dis: 0.022235870361328125
[rfa agg] iter: 2, weight: tensor([0.0799, 0.0030, 0.0630, 0.0164, 0.0486, 0.2738, 0.2195, 0.0636, 0.1557,
        0.0764])
[rfa agg] iter:  3, prev_obj_val: 48.31537628173828, obj_val: 48.315284729003906, abs dis: 9.1552734375e-05
[rfa agg] iter: 3, weight: tensor([0.0797, 0.0030, 0.0631, 0.0164, 0.0485, 0.2667, 0.2289, 0.0634, 0.1541,
        0.0762])
			Update norm = 118.34483099585508 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.96525835990906 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 348/1475 (23.5932%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 682/1475 (46.2373%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.9455, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3798, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 293/1645 (17.8116%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 602/1645 (36.5957%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8113, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 541/928 (58.2974%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5005, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0291, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.1290, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 443/1440 (30.7639%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 670/1440 (46.5278%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9447, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 423/1904 (22.2164%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 720/1904 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6944, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 395/1574 (25.0953%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 677/1574 (43.0114%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9592, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 149/338 (44.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4311, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 455/888 (51.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2006, Accuracy: 60/10000 (0.6000%)
time spent on training: 149.5383017063141
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 24, 13, 1, 59, 29, 46, 17, 12, 63], weight: tensor([0.1272, 0.0269, 0.1419, 0.0800, 0.0939, 0.1242, 0.1642, 0.1358, 0.0292,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 53.88245391845703, obj_val: 53.852108001708984, abs dis: 0.030345916748046875
[rfa agg] iter: 0, weight: tensor([0.1474, 0.0085, 0.1112, 0.0750, 0.1951, 0.1877, 0.0779, 0.1271, 0.0099,
        0.0602])
			Update norm = 186.45823091244858 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.32952761650085 sec.
Server Epoch:9 choose agents : [38, 85, 61, 13, 88, 99, 52, 77, 37, 93].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 432/1131 (38.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5223, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 426/1988 (21.4286%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 680/1988 (34.2052%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7902, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3047, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 292/1645 (17.7508%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 602/1645 (36.5957%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8676, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   1, Avg loss: 0.0747, Accuracy: 136/603 (22.5539%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8950, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0689, Accuracy: 170/773 (21.9922%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0303, Accuracy: 401/773 (51.8758%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9842, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0574, Accuracy: 274/636 (43.0818%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.0683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 314/1340 (23.4328%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7206, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 416/1129 (36.8468%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 717/1129 (63.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2742, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 412/1742 (23.6510%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 729/1742 (41.8485%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7096, Accuracy: 71/10000 (0.7100%)
time spent on training: 151.7890362739563
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 1988, 85, 1645, 603, 773, 636, 1340, 1129, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 85, 61, 13, 88, 99, 52, 77, 37, 93], weight: tensor([0.1021, 0.1796, 0.0077, 0.1486, 0.0545, 0.0698, 0.0574, 0.1210, 0.1020,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 60.00812911987305, obj_val: 64.73912048339844, abs dis: 4.730991363525391
[rfa agg] iter: 0, weight: tensor([0.1815, 0.0576, 0.0016, 0.0946, 0.0210, 0.0383, 0.0221, 0.3297, 0.1782,
        0.0754])
[rfa agg] iter:  1, prev_obj_val: 64.73912048339844, obj_val: 69.18518829345703, abs dis: 4.446067810058594
[rfa agg] iter: 1, weight: tensor([0.3522, 0.0365, 0.0013, 0.0526, 0.0193, 0.0393, 0.0203, 0.1117, 0.3220,
        0.0447])
[rfa agg] iter:  2, prev_obj_val: 69.18518829345703, obj_val: 71.82147216796875, abs dis: 2.6362838745117188
[rfa agg] iter: 2, weight: tensor([0.3125, 0.0439, 0.0018, 0.0604, 0.0284, 0.0628, 0.0299, 0.1078, 0.3000,
        0.0524])
[rfa agg] iter:  3, prev_obj_val: 71.82147216796875, obj_val: 71.81846618652344, abs dis: 0.0030059814453125
[rfa agg] iter: 3, weight: tensor([0.2731, 0.0510, 0.0023, 0.0687, 0.0367, 0.0856, 0.0386, 0.1158, 0.2679,
        0.0602])
			Update norm = 156.5441855555485 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.9432487487793 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 89, 31, 57, 97, 99, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 227/1241 (18.2917%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3199, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 322/1154 (27.9029%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 468/1154 (40.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7517, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 368/1750 (21.0286%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 624/1750 (35.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4155, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 324/896 (36.1607%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.3405, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0831, Accuracy: 51/460 (11.0870%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0387, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.6990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 295/1154 (25.5633%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0258, Accuracy: 487/1154 (42.2010%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3633, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 363/1213 (29.9258%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6917, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0685, Accuracy: 172/773 (22.2510%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 366/773 (47.3480%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0555, Accuracy: 389/1956 (19.8875%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2126, Accuracy: 119/10000 (1.1900%)
time spent on training: 150.4768340587616
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1154, 186, 1750, 896, 460, 1154, 1213, 773, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 15, 56, 44, 89, 31, 57, 97, 99, 6], weight: tensor([0.1151, 0.1070, 0.0172, 0.1623, 0.0831, 0.0427, 0.1070, 0.1125, 0.0717,
        0.1814])
[rfa agg] iter:  0, prev_obj_val: 50.67926025390625, obj_val: 56.647647857666016, abs dis: 5.968387603759766
[rfa agg] iter: 0, weight: tensor([0.2219, 0.1998, 0.0021, 0.0392, 0.0309, 0.0076, 0.1939, 0.2495, 0.0226,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 56.647647857666016, obj_val: 59.028717041015625, abs dis: 2.3810691833496094
[rfa agg] iter: 1, weight: tensor([0.1424, 0.2001, 0.0038, 0.0502, 0.0750, 0.0146, 0.1978, 0.2213, 0.0511,
        0.0438])
[rfa agg] iter:  2, prev_obj_val: 59.028717041015625, obj_val: 59.026790618896484, abs dis: 0.001926422119140625
[rfa agg] iter: 2, weight: tensor([0.1385, 0.1846, 0.0046, 0.0554, 0.1004, 0.0178, 0.1839, 0.1999, 0.0663,
        0.0488])
			Update norm = 160.7060046229605 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.44929599761963 sec.
Server Epoch:11 choose agents : [25, 79, 30, 6, 93, 12, 88, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0286, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.2643, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   1, Avg loss: 0.1015, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   2, Avg loss: 0.0839, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3197, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0814, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.7686, Accuracy: 37/10000 (0.3700%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 408/1956 (20.8589%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 645/1956 (32.9755%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9263, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 405/1742 (23.2491%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 704/1742 (40.4133%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5871, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0884, Accuracy: 14/338 (4.1420%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0493, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   1, Avg loss: 0.0747, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.8060, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3834, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 647/1587 (40.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2815, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.5384, Accuracy: 63/10000 (0.6300%)
time spent on training: 147.5340552330017
[rfa agg] training data poison_ratio: 0.0  data num: [690, 197, 486, 1956, 1742, 338, 603, 712, 1587, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 79, 30, 6, 93, 12, 88, 11, 27, 14], weight: tensor([0.0740, 0.0211, 0.0521, 0.2098, 0.1868, 0.0363, 0.0647, 0.0764, 0.1702,
        0.1086])
[rfa agg] iter:  0, prev_obj_val: 78.23331451416016, obj_val: 79.44014739990234, abs dis: 1.2068328857421875
[rfa agg] iter: 0, weight: tensor([0.0693, 0.0101, 0.0349, 0.1179, 0.1380, 0.0203, 0.0534, 0.0822, 0.1828,
        0.2910])
[rfa agg] iter:  1, prev_obj_val: 79.44014739990234, obj_val: 82.94583129882812, abs dis: 3.5056838989257812
[rfa agg] iter: 1, weight: tensor([0.0682, 0.0093, 0.0329, 0.0932, 0.1067, 0.0188, 0.0516, 0.0828, 0.1357,
        0.4008])
[rfa agg] iter:  2, prev_obj_val: 82.94583129882812, obj_val: 84.43193054199219, abs dis: 1.4860992431640625
[rfa agg] iter: 2, weight: tensor([0.0637, 0.0071, 0.0270, 0.0529, 0.0584, 0.0148, 0.0456, 0.0834, 0.0699,
        0.5773])
[rfa agg] iter:  3, prev_obj_val: 84.43193054199219, obj_val: 87.55900573730469, abs dis: 3.1270751953125
[rfa agg] iter: 3, weight: tensor([0.0848, 0.0088, 0.0344, 0.0609, 0.0668, 0.0185, 0.0594, 0.1143, 0.0790,
        0.4732])
[rfa agg] iter:  4, prev_obj_val: 87.55900573730469, obj_val: 87.53021240234375, abs dis: 0.0287933349609375
[rfa agg] iter: 4, weight: tensor([0.1305, 0.0112, 0.0465, 0.0667, 0.0722, 0.0242, 0.0858, 0.1930, 0.0835,
        0.2865])
[rfa agg] iter:  5, prev_obj_val: 87.53021240234375, obj_val: 89.11225128173828, abs dis: 1.5820388793945312
[rfa agg] iter: 5, weight: tensor([0.1316, 0.0112, 0.0467, 0.0668, 0.0722, 0.0243, 0.0864, 0.1970, 0.0837,
        0.2802])
[rfa agg] iter:  6, prev_obj_val: 89.11225128173828, obj_val: 92.37197875976562, abs dis: 3.2597274780273438
[rfa agg] iter: 6, weight: tensor([0.1507, 0.0113, 0.0489, 0.0624, 0.0671, 0.0248, 0.0945, 0.2439, 0.0770,
        0.2193])
[rfa agg] iter:  7, prev_obj_val: 92.37197875976562, obj_val: 98.70069122314453, abs dis: 6.328712463378906
[rfa agg] iter: 7, weight: tensor([0.1815, 0.0094, 0.0445, 0.0442, 0.0470, 0.0214, 0.0974, 0.3829, 0.0530,
        0.1188])
[rfa agg] iter:  8, prev_obj_val: 98.70069122314453, obj_val: 104.46514129638672, abs dis: 5.7644500732421875
[rfa agg] iter: 8, weight: tensor([0.4122, 0.0083, 0.0482, 0.0301, 0.0315, 0.0202, 0.1545, 0.1985, 0.0349,
        0.0616])
[rfa agg] iter:  9, prev_obj_val: 104.46514129638672, obj_val: 104.40869140625, abs dis: 0.05644989013671875
[rfa agg] iter: 9, weight: tensor([0.2320, 0.0110, 0.0809, 0.0331, 0.0344, 0.0288, 0.3615, 0.1212, 0.0376,
        0.0595])
			Update norm = 101.59587913025804 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.60816431045532 sec.
Server Epoch:12 choose agents : [37, 81, 94, 32, 34, 87, 63, 99, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 416/1129 (36.8468%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 727/1129 (64.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4334, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   1, Avg loss: 0.0687, Accuracy: 223/774 (28.8114%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 298/774 (38.5013%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.1724, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 330/1662 (19.8556%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 600/1662 (36.1011%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.9369, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0609, Accuracy: 191/735 (25.9864%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 328/735 (44.6259%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3632, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 379/1427 (26.5592%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 626/1427 (43.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9000, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   1, Avg loss: 0.0591, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 386/1131 (34.1291%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4509, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 261/888 (29.3919%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 467/888 (52.5901%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0242, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9943, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 533/1470 (36.2585%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 818/1470 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0029, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 219/1013 (21.6190%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 351/1013 (34.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6048, Accuracy: 71/10000 (0.7100%)
time spent on training: 153.03699851036072
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 774, 1662, 735, 1427, 1131, 888, 773, 1470, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 81, 94, 32, 34, 87, 63, 99, 22, 14], weight: tensor([0.1026, 0.0704, 0.1511, 0.0668, 0.1297, 0.1028, 0.0807, 0.0703, 0.1336,
        0.0921])
[rfa agg] iter:  0, prev_obj_val: 44.48110580444336, obj_val: 46.205230712890625, abs dis: 1.7241249084472656
[rfa agg] iter: 0, weight: tensor([0.1099, 0.0775, 0.0420, 0.0544, 0.0503, 0.1142, 0.1368, 0.0796, 0.0516,
        0.2838])
[rfa agg] iter:  1, prev_obj_val: 46.205230712890625, obj_val: 48.14850616455078, abs dis: 1.9432754516601562
[rfa agg] iter: 1, weight: tensor([0.0945, 0.0946, 0.0402, 0.0632, 0.0473, 0.0971, 0.1888, 0.0984, 0.0486,
        0.2273])
[rfa agg] iter:  2, prev_obj_val: 48.14850616455078, obj_val: 63.09769058227539, abs dis: 14.94918441772461
[rfa agg] iter: 2, weight: tensor([0.0778, 0.1135, 0.0365, 0.0709, 0.0422, 0.0796, 0.2604, 0.1207, 0.0433,
        0.1551])
[rfa agg] iter:  3, prev_obj_val: 63.09769058227539, obj_val: 63.031890869140625, abs dis: 0.06579971313476562
[rfa agg] iter: 3, weight: tensor([0.0513, 0.1656, 0.0329, 0.2548, 0.0359, 0.0518, 0.1176, 0.1841, 0.0369,
        0.0691])
[rfa agg] iter:  4, prev_obj_val: 63.031890869140625, obj_val: 59.19923400878906, abs dis: 3.8326568603515625
[rfa agg] iter: 4, weight: tensor([0.0483, 0.1586, 0.0310, 0.2955, 0.0338, 0.0488, 0.1091, 0.1753, 0.0347,
        0.0649])
[rfa agg] iter:  5, prev_obj_val: 59.19923400878906, obj_val: 63.039329528808594, abs dis: 3.8400955200195312
[rfa agg] iter: 5, weight: tensor([0.0461, 0.1872, 0.0282, 0.2129, 0.0311, 0.0467, 0.1218, 0.2296, 0.0319,
        0.0646])
[rfa agg] iter:  6, prev_obj_val: 63.039329528808594, obj_val: 63.02995300292969, abs dis: 0.00937652587890625
[rfa agg] iter: 6, weight: tensor([0.0489, 0.1627, 0.0314, 0.2816, 0.0342, 0.0495, 0.1107, 0.1801, 0.0352,
        0.0657])
[rfa agg] iter:  7, prev_obj_val: 63.02995300292969, obj_val: 59.20118713378906, abs dis: 3.828765869140625
[rfa agg] iter: 7, weight: tensor([0.0479, 0.1566, 0.0307, 0.3033, 0.0335, 0.0484, 0.1079, 0.1730, 0.0344,
        0.0643])
[rfa agg] iter:  8, prev_obj_val: 59.20118713378906, obj_val: 63.03904724121094, abs dis: 3.837860107421875
[rfa agg] iter: 8, weight: tensor([0.0461, 0.1866, 0.0282, 0.2143, 0.0311, 0.0467, 0.1217, 0.2288, 0.0319,
        0.0646])
[rfa agg] iter:  9, prev_obj_val: 63.03904724121094, obj_val: 63.02993392944336, abs dis: 0.009113311767578125
[rfa agg] iter: 9, weight: tensor([0.0489, 0.1626, 0.0314, 0.2820, 0.0342, 0.0494, 0.1106, 0.1800, 0.0352,
        0.0657])
			Update norm = 118.80645450821474 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.37189507484436 sec.
Server Epoch:13 choose agents : [36, 76, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0883, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0563, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.4591, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 147/818 (17.9707%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 321/818 (39.2421%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9231, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0554, Accuracy: 338/1154 (29.2894%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8885, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 55/186 (29.5699%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 441/891 (49.4949%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0014, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 348/1574 (22.1093%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 662/1574 (42.0584%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3834, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 467/1049 (44.5186%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4506, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1079, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3862, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.7821807861328
[rfa agg] training data poison_ratio: 0.0  data num: [408, 466, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 76, 71, 15, 56, 7, 17, 51, 47, 24], weight: tensor([0.0584, 0.0666, 0.1170, 0.1650, 0.0266, 0.1274, 0.2251, 0.1500, 0.0192,
        0.0446])
[rfa agg] iter:  0, prev_obj_val: 50.99246597290039, obj_val: 52.832942962646484, abs dis: 1.8404769897460938
[rfa agg] iter: 0, weight: tensor([0.0227, 0.0299, 0.2063, 0.1054, 0.0066, 0.3819, 0.0628, 0.1659, 0.0048,
        0.0136])
[rfa agg] iter:  1, prev_obj_val: 52.832942962646484, obj_val: 56.639198303222656, abs dis: 3.806255340576172
[rfa agg] iter: 1, weight: tensor([0.0211, 0.0284, 0.3198, 0.0704, 0.0058, 0.3925, 0.0465, 0.0990, 0.0042,
        0.0123])
[rfa agg] iter:  2, prev_obj_val: 56.639198303222656, obj_val: 58.9935417175293, abs dis: 2.3543434143066406
[rfa agg] iter: 2, weight: tensor([0.0310, 0.0431, 0.4342, 0.0747, 0.0080, 0.2353, 0.0535, 0.0971, 0.0058,
        0.0173])
[rfa agg] iter:  3, prev_obj_val: 58.9935417175293, obj_val: 58.989505767822266, abs dis: 0.00403594970703125
[rfa agg] iter: 3, weight: tensor([0.0417, 0.0594, 0.3843, 0.0853, 0.0103, 0.2178, 0.0632, 0.1077, 0.0074,
        0.0227])
			Update norm = 118.26086762957559 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.41016721725464 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 83, 61, 84, 99].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 329/1418 (23.2017%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 573/1418 (40.4090%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8033, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 382/1475 (25.8983%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 655/1475 (44.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1445, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 254/1402 (18.1170%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1333, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 132/568 (23.2394%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.7951, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 373/1427 (26.1388%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 569/1427 (39.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0145, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 142/818 (17.3594%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9824, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 408/1953 (20.8909%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 767/1953 (39.2729%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6410, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3047, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 308/1190 (25.8824%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9157, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   2, Avg loss: 0.0332, Accuracy: 365/773 (47.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0349, Accuracy: 51/10000 (0.5100%)
time spent on training: 154.59954047203064
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1475, 1402, 568, 1427, 818, 1953, 85, 1190, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 65, 66, 62, 34, 71, 83, 61, 84, 99], weight: tensor([0.1276, 0.1328, 0.1262, 0.0511, 0.1285, 0.0736, 0.1758, 0.0077, 0.1071,
        0.0696])
[rfa agg] iter:  0, prev_obj_val: 54.74536895751953, obj_val: 50.37275695800781, abs dis: 4.372611999511719
[rfa agg] iter: 0, weight: tensor([0.1088, 0.0935, 0.1371, 0.0211, 0.1104, 0.0521, 0.0552, 0.0018, 0.3708,
        0.0493])
[rfa agg] iter:  1, prev_obj_val: 50.37275695800781, obj_val: 54.596317291259766, abs dis: 4.223560333251953
[rfa agg] iter: 1, weight: tensor([0.1122, 0.0925, 0.1515, 0.0156, 0.1146, 0.0362, 0.0490, 0.0014, 0.3928,
        0.0342])
[rfa agg] iter:  2, prev_obj_val: 54.596317291259766, obj_val: 52.30696487426758, abs dis: 2.2893524169921875
[rfa agg] iter: 2, weight: tensor([0.0972, 0.0835, 0.1225, 0.0189, 0.0987, 0.0466, 0.0494, 0.0016, 0.4377,
        0.0441])
[rfa agg] iter:  3, prev_obj_val: 52.30696487426758, obj_val: 57.097007751464844, abs dis: 4.790042877197266
[rfa agg] iter: 3, weight: tensor([0.0910, 0.0769, 0.1181, 0.0151, 0.0928, 0.0360, 0.0432, 0.0013, 0.4916,
        0.0340])
[rfa agg] iter:  4, prev_obj_val: 57.097007751464844, obj_val: 57.07788848876953, abs dis: 0.0191192626953125
[rfa agg] iter: 4, weight: tensor([0.1025, 0.0896, 0.1258, 0.0233, 0.1041, 0.0596, 0.0555, 0.0019, 0.3812,
        0.0564])
[rfa agg] iter:  5, prev_obj_val: 57.07788848876953, obj_val: 59.641876220703125, abs dis: 2.5639877319335938
[rfa agg] iter: 5, weight: tensor([0.1048, 0.0915, 0.1288, 0.0237, 0.1063, 0.0610, 0.0566, 0.0020, 0.3676,
        0.0577])
[rfa agg] iter:  6, prev_obj_val: 59.641876220703125, obj_val: 57.08158874511719, abs dis: 2.5602874755859375
[rfa agg] iter: 6, weight: tensor([0.1092, 0.0967, 0.1315, 0.0287, 0.1106, 0.0771, 0.0623, 0.0023, 0.3087,
        0.0729])
[rfa agg] iter:  7, prev_obj_val: 57.08158874511719, obj_val: 59.640689849853516, abs dis: 2.559101104736328
[rfa agg] iter: 7, weight: tensor([0.1063, 0.0928, 0.1308, 0.0241, 0.1079, 0.0619, 0.0574, 0.0020, 0.3583,
        0.0586])
[rfa agg] iter:  8, prev_obj_val: 59.640689849853516, obj_val: 57.08167266845703, abs dis: 2.5590171813964844
[rfa agg] iter: 8, weight: tensor([0.1093, 0.0968, 0.1316, 0.0287, 0.1107, 0.0771, 0.0623, 0.0023, 0.3081,
        0.0730])
[rfa agg] iter:  9, prev_obj_val: 57.08167266845703, obj_val: 59.64067840576172, abs dis: 2.5590057373046875
[rfa agg] iter: 9, weight: tensor([0.1064, 0.0929, 0.1308, 0.0241, 0.1079, 0.0619, 0.0574, 0.0020, 0.3582,
        0.0586])
			Update norm = 165.1967813321434 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.3590271472931 sec.
Server Epoch:15 choose agents : [70, 63, 84, 79, 26, 42, 18, 66, 39, 95].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 627/1418 (44.2172%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5421, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 433/888 (48.7613%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0127, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 306/1190 (25.7143%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9178, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   1, Avg loss: 0.0999, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   2, Avg loss: 0.0858, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3234, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2750, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 357/1372 (26.0204%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 516/1372 (37.6093%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9147, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 112/530 (21.1321%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0162, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 412/1402 (29.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2094, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 493/1013 (48.6673%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5092, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 315/599 (52.5876%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   2, Avg loss: 0.0282, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3538, Accuracy: 50/10000 (0.5000%)
time spent on training: 148.4802703857422
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 888, 1190, 197, 1446, 1372, 530, 1402, 1013, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 63, 84, 79, 26, 42, 18, 66, 39, 95], weight: tensor([0.1410, 0.0883, 0.1183, 0.0196, 0.1438, 0.1364, 0.0527, 0.1394, 0.1007,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 43.989593505859375, obj_val: 47.47453308105469, abs dis: 3.4849395751953125
[rfa agg] iter: 0, weight: tensor([0.0842, 0.1029, 0.1879, 0.0054, 0.0856, 0.0973, 0.0238, 0.0997, 0.2826,
        0.0307])
[rfa agg] iter:  1, prev_obj_val: 47.47453308105469, obj_val: 49.62764358520508, abs dis: 2.1531105041503906
[rfa agg] iter: 1, weight: tensor([0.0611, 0.1247, 0.1141, 0.0049, 0.0621, 0.0687, 0.0229, 0.0704, 0.4410,
        0.0301])
[rfa agg] iter:  2, prev_obj_val: 49.62764358520508, obj_val: 57.36823654174805, abs dis: 7.740592956542969
[rfa agg] iter: 2, weight: tensor([0.0581, 0.1591, 0.1000, 0.0052, 0.0591, 0.0647, 0.0251, 0.0663, 0.4290,
        0.0334])
[rfa agg] iter:  3, prev_obj_val: 57.36823654174805, obj_val: 60.22384262084961, abs dis: 2.8556060791015625
[rfa agg] iter: 3, weight: tensor([0.0577, 0.3913, 0.0854, 0.0071, 0.0588, 0.0627, 0.0384, 0.0642, 0.1803,
        0.0540])
[rfa agg] iter:  4, prev_obj_val: 60.22384262084961, obj_val: 60.219783782958984, abs dis: 0.004058837890625
[rfa agg] iter: 4, weight: tensor([0.0550, 0.4355, 0.0786, 0.0075, 0.0560, 0.0594, 0.0428, 0.0608, 0.1428,
        0.0617])
[rfa agg] iter:  5, prev_obj_val: 60.219783782958984, obj_val: 60.219600677490234, abs dis: 0.00018310546875
[rfa agg] iter: 5, weight: tensor([0.0539, 0.4474, 0.0770, 0.0073, 0.0549, 0.0582, 0.0420, 0.0596, 0.1392,
        0.0605])
			Update norm = 131.27477444753046 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.70686173439026 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 80, 6, 64, 96, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3752, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 534/1470 (36.3265%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 852/1470 (57.9592%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1153, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 140/818 (17.1149%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0318, Accuracy: 337/818 (41.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9498, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 415/1402 (29.6006%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.2303, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   1, Avg loss: 0.0714, Accuracy: 140/682 (20.5279%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4135, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 413/1956 (21.1145%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 633/1956 (32.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3166, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3780, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0546, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3431, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 325/1089 (29.8439%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 472/1089 (43.3425%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9835, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0790, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0545, Accuracy: 115/515 (22.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7161, Accuracy: 49/10000 (0.4900%)
time spent on training: 144.53250217437744
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 682, 1956, 953, 311, 1089, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 22, 71, 66, 80, 6, 64, 96, 59, 33], weight: tensor([0.0328, 0.1546, 0.0860, 0.1475, 0.0717, 0.2057, 0.1002, 0.0327, 0.1145,
        0.0542])
[rfa agg] iter:  0, prev_obj_val: 61.3868522644043, obj_val: 65.66465759277344, abs dis: 4.277805328369141
[rfa agg] iter: 0, weight: tensor([0.0099, 0.1053, 0.0718, 0.1224, 0.0417, 0.0579, 0.1452, 0.0099, 0.4119,
        0.0242])
[rfa agg] iter:  1, prev_obj_val: 65.66465759277344, obj_val: 66.8728256225586, abs dis: 1.2081680297851562
[rfa agg] iter: 1, weight: tensor([0.0116, 0.0768, 0.1227, 0.0845, 0.0588, 0.0498, 0.3857, 0.0115, 0.1675,
        0.0310])
[rfa agg] iter:  2, prev_obj_val: 66.8728256225586, obj_val: 70.56999206542969, abs dis: 3.6971664428710938
[rfa agg] iter: 2, weight: tensor([0.0094, 0.0560, 0.1174, 0.0610, 0.0514, 0.0375, 0.5247, 0.0094, 0.1070,
        0.0261])
[rfa agg] iter:  3, prev_obj_val: 70.56999206542969, obj_val: 74.78462219238281, abs dis: 4.214630126953125
[rfa agg] iter: 3, weight: tensor([0.0130, 0.0619, 0.2429, 0.0665, 0.0839, 0.0439, 0.3350, 0.0129, 0.1011,
        0.0388])
[rfa agg] iter:  4, prev_obj_val: 74.78462219238281, obj_val: 77.23492431640625, abs dis: 2.4503021240234375
[rfa agg] iter: 4, weight: tensor([0.0133, 0.0511, 0.4394, 0.0542, 0.1121, 0.0379, 0.1597, 0.0133, 0.0748,
        0.0442])
[rfa agg] iter:  5, prev_obj_val: 77.23492431640625, obj_val: 77.23297882080078, abs dis: 0.00194549560546875
[rfa agg] iter: 5, weight: tensor([0.0145, 0.0498, 0.4324, 0.0525, 0.1472, 0.0378, 0.1302, 0.0144, 0.0697,
        0.0515])
			Update norm = 122.61867656988474 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.420236825943 sec.
Server Epoch:17 choose agents : [36, 29, 28, 81, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0883, Accuracy: 64/408 (15.6863%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0554, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.4763, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 419/1440 (29.0972%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 671/1440 (46.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2227, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 376/1581 (23.7824%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 589/1581 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7796, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 231/774 (29.8450%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 264/774 (34.1085%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0798, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 477/1071 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7545, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 454/888 (51.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0645, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6944, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0575, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.8291, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 403/1628 (24.7543%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 833/1628 (51.1671%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0867, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0630, Accuracy: 292/946 (30.8668%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 330/946 (34.8837%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0339, Accuracy: 57/10000 (0.5700%)
time spent on training: 146.95429015159607
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 774, 1071, 888, 515, 715, 1628, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 29, 28, 81, 55, 63, 33, 23, 5, 43], weight: tensor([0.0409, 0.1445, 0.1586, 0.0777, 0.1075, 0.0891, 0.0517, 0.0717, 0.1634,
        0.0949])
[rfa agg] iter:  0, prev_obj_val: 52.88077926635742, obj_val: 56.842262268066406, abs dis: 3.9614830017089844
[rfa agg] iter: 0, weight: tensor([0.0144, 0.0578, 0.0502, 0.0894, 0.1857, 0.1600, 0.0238, 0.0596, 0.0468,
        0.3124])
[rfa agg] iter:  1, prev_obj_val: 56.842262268066406, obj_val: 70.62065887451172, abs dis: 13.778396606445312
[rfa agg] iter: 1, weight: tensor([0.0146, 0.0405, 0.0364, 0.1522, 0.0876, 0.3207, 0.0258, 0.0813, 0.0344,
        0.2065])
[rfa agg] iter:  2, prev_obj_val: 70.62065887451172, obj_val: 64.13157653808594, abs dis: 6.489082336425781
[rfa agg] iter: 2, weight: tensor([0.0342, 0.0486, 0.0455, 0.1798, 0.0748, 0.1352, 0.0761, 0.2591, 0.0436,
        0.1032])
[rfa agg] iter:  3, prev_obj_val: 64.13157653808594, obj_val: 70.55132293701172, abs dis: 6.419746398925781
[rfa agg] iter: 3, weight: tensor([0.0214, 0.0401, 0.0370, 0.2604, 0.0683, 0.1577, 0.0422, 0.2321, 0.0352,
        0.1056])
[rfa agg] iter:  4, prev_obj_val: 70.55132293701172, obj_val: 67.20077514648438, abs dis: 3.3505477905273438
[rfa agg] iter: 4, weight: tensor([0.0330, 0.0467, 0.0437, 0.1772, 0.0718, 0.1283, 0.0735, 0.2854, 0.0419,
        0.0985])
[rfa agg] iter:  5, prev_obj_val: 67.20077514648438, obj_val: 74.0489730834961, abs dis: 6.848197937011719
[rfa agg] iter: 5, weight: tensor([0.0253, 0.0413, 0.0384, 0.1986, 0.0666, 0.1327, 0.0527, 0.3116, 0.0367,
        0.0963])
[rfa agg] iter:  6, prev_obj_val: 74.0489730834961, obj_val: 67.20683288574219, abs dis: 6.842140197753906
[rfa agg] iter: 6, weight: tensor([0.0424, 0.0515, 0.0485, 0.1568, 0.0759, 0.1241, 0.1030, 0.2516, 0.0466,
        0.0997])
[rfa agg] iter:  7, prev_obj_val: 67.20683288574219, obj_val: 74.04817962646484, abs dis: 6.841346740722656
[rfa agg] iter: 7, weight: tensor([0.0256, 0.0418, 0.0388, 0.2007, 0.0674, 0.1343, 0.0534, 0.3033, 0.0371,
        0.0975])
[rfa agg] iter:  8, prev_obj_val: 74.04817962646484, obj_val: 67.20692443847656, abs dis: 6.841255187988281
[rfa agg] iter: 8, weight: tensor([0.0424, 0.0515, 0.0485, 0.1571, 0.0759, 0.1242, 0.1031, 0.2508, 0.0466,
        0.0998])
[rfa agg] iter:  9, prev_obj_val: 67.20692443847656, obj_val: 74.04815673828125, abs dis: 6.8412322998046875
[rfa agg] iter: 9, weight: tensor([0.0256, 0.0418, 0.0388, 0.2008, 0.0674, 0.1344, 0.0534, 0.3031, 0.0371,
        0.0976])
			Update norm = 110.54196654297182 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.96432042121887 sec.
Server Epoch:18 choose agents : [77, 90, 3, 24, 2, 8, 79, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 320/1340 (23.8806%)
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 537/1340 (40.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4771, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 306/677 (45.1994%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9724, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 103/781 (13.1882%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0372, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9234, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 171/312 (54.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3871, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8469, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 242/1513 (15.9947%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 468/1513 (30.9319%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4412, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   1, Avg loss: 0.1021, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   2, Avg loss: 0.0852, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3230, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 227/1049 (21.6397%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 500/1049 (47.6644%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9402, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0665, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 316/938 (33.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1527, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 398/1440 (27.6389%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 675/1440 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7512, Accuracy: 60/10000 (0.6000%)
time spent on training: 141.49782514572144
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 677, 781, 312, 605, 1513, 197, 1049, 938, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 90, 3, 24, 2, 8, 79, 51, 73, 29], weight: tensor([0.1514, 0.0765, 0.0882, 0.0352, 0.0683, 0.1709, 0.0223, 0.1185, 0.1060,
        0.1627])
[rfa agg] iter:  0, prev_obj_val: 47.69009017944336, obj_val: 49.74565505981445, abs dis: 2.0555648803710938
[rfa agg] iter: 0, weight: tensor([0.0984, 0.0502, 0.0942, 0.0105, 0.0374, 0.0702, 0.0060, 0.2776, 0.2795,
        0.0761])
[rfa agg] iter:  1, prev_obj_val: 49.74565505981445, obj_val: 55.04168701171875, abs dis: 5.296031951904297
[rfa agg] iter: 1, weight: tensor([0.0686, 0.0520, 0.1127, 0.0096, 0.0372, 0.0521, 0.0055, 0.1512, 0.4557,
        0.0556])
[rfa agg] iter:  2, prev_obj_val: 55.04168701171875, obj_val: 57.03238296508789, abs dis: 1.9906959533691406
[rfa agg] iter: 2, weight: tensor([0.0663, 0.0976, 0.3103, 0.0135, 0.0629, 0.0537, 0.0075, 0.1081, 0.2237,
        0.0564])
[rfa agg] iter:  3, prev_obj_val: 57.03238296508789, obj_val: 57.00252914428711, abs dis: 0.02985382080078125
[rfa agg] iter: 3, weight: tensor([0.0545, 0.1059, 0.4343, 0.0125, 0.0642, 0.0450, 0.0070, 0.0835, 0.1461,
        0.0471])
[rfa agg] iter:  4, prev_obj_val: 57.00252914428711, obj_val: 62.06206512451172, abs dis: 5.059535980224609
[rfa agg] iter: 4, weight: tensor([0.0497, 0.0962, 0.4868, 0.0114, 0.0585, 0.0410, 0.0064, 0.0759, 0.1313,
        0.0429])
[rfa agg] iter:  5, prev_obj_val: 62.06206512451172, obj_val: 62.01050567626953, abs dis: 0.0515594482421875
[rfa agg] iter: 5, weight: tensor([0.0583, 0.2201, 0.2826, 0.0171, 0.1111, 0.0495, 0.0094, 0.0809, 0.1194,
        0.0515])
[rfa agg] iter:  6, prev_obj_val: 62.01050567626953, obj_val: 62.01000213623047, abs dis: 0.0005035400390625
[rfa agg] iter: 6, weight: tensor([0.0584, 0.2364, 0.2633, 0.0172, 0.1132, 0.0496, 0.0094, 0.0812, 0.1198,
        0.0515])
			Update norm = 118.35454713750967 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.1596736907959 sec.
Server Epoch:19 choose agents : [7, 87, 36, 17, 90, 93, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 294/1131 (25.9947%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 408/1131 (36.0743%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4193, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0878, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0574, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4843, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 392/1574 (24.9047%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 672/1574 (42.6938%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2800, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 466/677 (68.8331%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9099, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   1, Avg loss: 0.0561, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 705/1742 (40.4707%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6742, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 409/1949 (20.9851%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1933, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 541/2227 (24.2928%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1043/2227 (46.8343%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5032, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 349/712 (49.0169%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.4630, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9556, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.3403182029724
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1131, 408, 1574, 677, 1742, 1949, 2227, 712, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 87, 36, 17, 90, 93, 21, 60, 11, 15], weight: tensor([0.0715, 0.0907, 0.0327, 0.1263, 0.0543, 0.1398, 0.1564, 0.1787, 0.0571,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 70.75603485107422, obj_val: 74.47415161132812, abs dis: 3.7181167602539062
[rfa agg] iter: 0, weight: tensor([0.0531, 0.1328, 0.0130, 0.2393, 0.0295, 0.1372, 0.1030, 0.0821, 0.0341,
        0.1757])
[rfa agg] iter:  1, prev_obj_val: 74.47415161132812, obj_val: 76.70793151855469, abs dis: 2.2337799072265625
[rfa agg] iter: 1, weight: tensor([0.0569, 0.2030, 0.0121, 0.1207, 0.0291, 0.0839, 0.0683, 0.0575, 0.0344,
        0.3340])
[rfa agg] iter:  2, prev_obj_val: 76.70793151855469, obj_val: 84.79647064208984, abs dis: 8.088539123535156
[rfa agg] iter: 2, weight: tensor([0.0479, 0.2438, 0.0093, 0.0711, 0.0231, 0.0527, 0.0443, 0.0381, 0.0277,
        0.4421])
[rfa agg] iter:  3, prev_obj_val: 84.79647064208984, obj_val: 82.3277816772461, abs dis: 2.46868896484375
[rfa agg] iter: 3, weight: tensor([0.1063, 0.3373, 0.0154, 0.0744, 0.0426, 0.0600, 0.0528, 0.0471, 0.0535,
        0.2106])
[rfa agg] iter:  4, prev_obj_val: 82.3277816772461, obj_val: 87.23182678222656, abs dis: 4.904045104980469
[rfa agg] iter: 4, weight: tensor([0.0760, 0.4323, 0.0120, 0.0647, 0.0321, 0.0512, 0.0446, 0.0395, 0.0398,
        0.2078])
[rfa agg] iter:  5, prev_obj_val: 87.23182678222656, obj_val: 87.21311950683594, abs dis: 0.018707275390625
[rfa agg] iter: 5, weight: tensor([0.1377, 0.2974, 0.0179, 0.0773, 0.0512, 0.0633, 0.0562, 0.0505, 0.0654,
        0.1830])
[rfa agg] iter:  6, prev_obj_val: 87.21311950683594, obj_val: 84.73731994628906, abs dis: 2.475799560546875
[rfa agg] iter: 6, weight: tensor([0.1405, 0.2908, 0.0180, 0.0778, 0.0516, 0.0637, 0.0566, 0.0508, 0.0660,
        0.1843])
[rfa agg] iter:  7, prev_obj_val: 84.73731994628906, obj_val: 84.7323226928711, abs dis: 0.00499725341796875
[rfa agg] iter: 7, weight: tensor([0.1065, 0.3520, 0.0153, 0.0736, 0.0422, 0.0593, 0.0522, 0.0465, 0.0530,
        0.1993])
			Update norm = 160.79255608936006 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.9988343715668 sec.
Server Epoch:20 choose agents : [76, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0511, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.5946, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 215/1013 (21.2241%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 342/1013 (33.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5602, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0570, Accuracy: 228/1071 (21.2885%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 513/1071 (47.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0190, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 431/891 (48.3726%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9901, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 167/953 (17.5236%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 317/953 (33.2634%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.3176, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 154/809 (19.0358%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 349/809 (43.1397%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1928, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0655, Accuracy: 144/818 (17.6039%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 320/818 (39.1198%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2590, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0571, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.2509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 324/1089 (29.7521%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0343, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2667, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 198/861 (22.9965%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8030, Accuracy: 50/10000 (0.5000%)
time spent on training: 146.97372007369995
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 14, 55, 7, 64, 50, 71, 52, 59, 10], weight: tensor([0.0541, 0.1177, 0.1244, 0.1035, 0.1107, 0.0940, 0.0950, 0.0739, 0.1265,
        0.1000])
[rfa agg] iter:  0, prev_obj_val: 32.435279846191406, obj_val: 32.404354095458984, abs dis: 0.030925750732421875
[rfa agg] iter: 0, weight: tensor([0.0428, 0.0741, 0.0642, 0.1127, 0.0889, 0.1620, 0.1638, 0.1258, 0.0552,
        0.1104])
			Update norm = 114.50709584999525 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.76792359352112 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 77, 99, 74, 94, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 464/1657 (28.0024%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0300, Accuracy: 782/1657 (47.1937%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0260, Accuracy: 822/1657 (49.6077%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0253, Accuracy: 839/1657 (50.6337%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0251, Accuracy: 841/1657 (50.7544%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0245, Accuracy: 862/1657 (52.0217%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0242, Accuracy: 868/1657 (52.3838%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0236, Accuracy: 870/1657 (52.5045%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0237, Accuracy: 883/1657 (53.2891%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0237, Accuracy: 880/1657 (53.1080%), train_poison_data_count: 520
Global model norm: 112.05632128811386.
Norm before scaling: 112.03036959207758. Distance: 1.24771471931597
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3947, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.2170, Accuracy: 9851/9950 (99.0050%)
Scaling by  100
Scaled Norm after poisoning: 165.4913198724483, distance: 124.77147078509174
Total norm for 1 adversaries is: 165.4913198724483. distance: 124.77147078509174
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 371/1574 (23.5705%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9402, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 324/1446 (22.4066%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 502/1446 (34.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1530, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1271, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1123, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 343/1340 (25.5970%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9823, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 385/773 (49.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.9709, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 473/1552 (30.4768%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 753/1552 (48.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.0220, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1662 (36.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6945, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 386/1475 (26.1695%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 689/1475 (46.7119%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0124, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 502/1470 (34.1497%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 838/1470 (57.0068%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9659, Accuracy: 81/10000 (0.8100%)
time spent on training: 301.0739974975586
[rfa agg] training data poison_ratio: 0.12665290835435297  data num: [1657, 1574, 1446, 134, 1340, 773, 1552, 1662, 1475, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0395790338607353
[rfa agg] init. name: [0, 17, 26, 47, 77, 99, 74, 94, 65, 22], weight: tensor([0.1267, 0.1203, 0.1105, 0.0102, 0.1024, 0.0591, 0.1186, 0.1270, 0.1127,
        0.1124])
[rfa agg] iter:  0, prev_obj_val: 25692.2890625, obj_val: 16482.298828125, abs dis: 9209.990234375
[rfa agg] iter: 0, weight: tensor([0.0206, 0.1351, 0.1240, 0.0113, 0.1147, 0.0659, 0.1332, 0.1427, 0.1265,
        0.1260])
[rfa agg] iter:  1, prev_obj_val: 16482.298828125, obj_val: 14957.9716796875, abs dis: 1524.3271484375
[rfa agg] iter: 1, weight: tensor([0.0030, 0.1384, 0.1262, 0.0109, 0.1160, 0.0650, 0.1364, 0.1467, 0.1292,
        0.1283])
[rfa agg] iter:  2, prev_obj_val: 14957.9716796875, obj_val: 14742.23828125, abs dis: 215.7333984375
[rfa agg] iter: 2, weight: tensor([0.0004, 0.1446, 0.1255, 0.0075, 0.1102, 0.0525, 0.1426, 0.1573, 0.1317,
        0.1276])
[rfa agg] iter:  3, prev_obj_val: 14742.23828125, obj_val: 14739.83203125, abs dis: 2.40625
[rfa agg] iter: 3, weight: tensor([2.5329e-05, 1.7872e-01, 7.8887e-02, 1.1208e-03, 4.7764e-02, 1.1340e-02,
        1.7551e-01, 3.1862e-01, 1.0775e-01, 8.0260e-02])
[rfa agg] iter:  4, prev_obj_val: 14739.83203125, obj_val: 14744.892578125, abs dis: 5.060546875
[rfa agg] iter: 4, weight: tensor([2.2052e-05, 1.0309e-01, 2.1685e-01, 1.1729e-03, 1.3020e-01, 1.4003e-02,
        1.0103e-01, 8.0464e-02, 1.3691e-01, 2.1625e-01])
[rfa agg] iter:  5, prev_obj_val: 14744.892578125, obj_val: 14751.3017578125, abs dis: 6.4091796875
[rfa agg] iter: 5, weight: tensor([2.6016e-05, 8.8545e-02, 1.6959e-01, 1.4565e-03, 2.7854e-01, 1.8445e-02,
        8.7576e-02, 7.3614e-02, 1.1041e-01, 1.7180e-01])
[rfa agg] iter:  6, prev_obj_val: 14751.3017578125, obj_val: 14747.8681640625, abs dis: 3.43359375
[rfa agg] iter: 6, weight: tensor([3.0781e-05, 8.2546e-02, 1.3079e-01, 1.8189e-03, 3.7677e-01, 2.4695e-02,
        8.1613e-02, 7.1767e-02, 9.6917e-02, 1.3305e-01])
[rfa agg] iter:  7, prev_obj_val: 14747.8681640625, obj_val: 14751.2841796875, abs dis: 3.416015625
[rfa agg] iter: 7, weight: tensor([2.4566e-05, 7.3600e-02, 1.2492e-01, 1.4125e-03, 4.3010e-01, 1.8490e-02,
        7.2853e-02, 6.2745e-02, 8.8538e-02, 1.2732e-01])
[rfa agg] iter:  8, prev_obj_val: 14751.2841796875, obj_val: 14754.9296875, abs dis: 3.6455078125
[rfa agg] iter: 8, weight: tensor([2.9164e-05, 7.8054e-02, 1.2272e-01, 1.7232e-03, 4.1240e-01, 2.3386e-02,
        7.7236e-02, 6.7896e-02, 9.1472e-02, 1.2508e-01])
[rfa agg] iter:  9, prev_obj_val: 14754.9296875, obj_val: 14747.8759765625, abs dis: 7.0537109375
[rfa agg] iter: 9, weight: tensor([3.6988e-05, 8.9543e-02, 1.3261e-01, 2.2478e-03, 3.3829e-01, 3.1749e-02,
        8.8532e-02, 7.9186e-02, 1.0278e-01, 1.3503e-01])
			Update norm = 195.3272594423267 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.56067848205566 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 75, 2, 0, 8, 77, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.6283, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 538/1470 (36.5986%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 838/1470 (57.0068%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9655, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0813, Accuracy: 18/440 (4.0909%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 157/440 (35.6818%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4644, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 114/530 (21.5094%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0404, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0789, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 242/776 (31.1856%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.8624, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 221/605 (36.5289%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7257, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 346/1657 (20.8811%)
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   2, Avg loss: 0.0351, Accuracy: 499/1657 (30.1147%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6881, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0609, Accuracy: 225/1513 (14.8711%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 463/1513 (30.6015%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4012, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 317/1340 (23.6567%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 548/1340 (40.8955%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8444, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 458/1130 (40.5310%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4817, Accuracy: 53/10000 (0.5300%)
time spent on training: 183.75746536254883
[rfa agg] training data poison_ratio: 0.16288213899537993  data num: [712, 1470, 440, 530, 776, 605, 1657, 1513, 1340, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.05090066843605623
[rfa agg] init. name: [11, 22, 49, 18, 75, 2, 0, 8, 77, 54], weight: tensor([0.0700, 0.1445, 0.0433, 0.0521, 0.0763, 0.0595, 0.1629, 0.1487, 0.1317,
        0.1111])
[rfa agg] iter:  0, prev_obj_val: 57.4229850769043, obj_val: 57.39086151123047, abs dis: 0.032123565673828125
[rfa agg] iter: 0, weight: tensor([0.0883, 0.1053, 0.0245, 0.0380, 0.1263, 0.0504, 0.0835, 0.0950, 0.1329,
        0.2559])
			Update norm = 152.17244535394704 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.2996463775635 sec.
Server Epoch:23 choose agents : [20, 9, 53, 95, 2, 87, 22, 76, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0609, Accuracy: 225/807 (27.8810%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0342, Accuracy: 386/807 (47.8315%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0276, Accuracy: 467/807 (57.8686%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0247, Accuracy: 530/807 (65.6753%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0244, Accuracy: 517/807 (64.0644%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0221, Accuracy: 529/807 (65.5514%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0216, Accuracy: 529/807 (65.5514%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0207, Accuracy: 528/807 (65.4275%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0205, Accuracy: 548/807 (67.9058%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0213, Accuracy: 519/807 (64.3123%), train_poison_data_count: 260
Global model norm: 112.05632128811386.
Norm before scaling: 112.04550118562325. Distance: 0.8684540168918365
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1105, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.4684, Accuracy: 9596/9950 (96.4422%)
Scaling by  100
Scaled Norm after poisoning: 140.64381818533653, distance: 86.84540581814763
Total norm for 1 adversaries is: 140.64381818533653. distance: 86.84540581814763
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 350/1275 (27.4510%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 635/1275 (49.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.9276, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 282/813 (34.6863%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.1048, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6215, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 221/605 (36.5289%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7671, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 293/1131 (25.9063%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 432/1131 (38.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4363, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 536/1470 (36.4626%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 843/1470 (57.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.0043, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   1, Avg loss: 0.0873, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.6217, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 104/781 (13.3163%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 236/781 (30.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4805, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0517, Accuracy: 363/1628 (22.2973%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 812/1628 (49.8771%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2380, Accuracy: 102/10000 (1.0200%)
time spent on training: 246.01037883758545
[rfa agg] training data poison_ratio: 0.08428198433420366  data num: [807, 1275, 813, 599, 605, 1131, 1470, 466, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.02633812010443864
[rfa agg] init. name: [20, 9, 53, 95, 2, 87, 22, 76, 3, 5], weight: tensor([0.0843, 0.1332, 0.0849, 0.0626, 0.0632, 0.1181, 0.1535, 0.0487, 0.0816,
        0.1700])
[rfa agg] iter:  0, prev_obj_val: 8974.009765625, obj_val: 5291.9453125, abs dis: 3682.064453125
[rfa agg] iter: 0, weight: tensor([0.0084, 0.1447, 0.0911, 0.0668, 0.0674, 0.1279, 0.1677, 0.0517, 0.0875,
        0.1868])
[rfa agg] iter:  1, prev_obj_val: 5291.9453125, obj_val: 4951.970703125, abs dis: 339.974609375
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1490, 0.0833, 0.0583, 0.0589, 0.1271, 0.1828, 0.0438, 0.0800,
        0.2162])
[rfa agg] iter:  2, prev_obj_val: 4951.970703125, obj_val: 4950.73583984375, abs dis: 1.23486328125
[rfa agg] iter: 2, weight: tensor([4.8709e-05, 2.7815e-01, 3.7322e-02, 2.0364e-02, 2.0547e-02, 1.2251e-01,
        3.3199e-01, 1.3485e-02, 3.5813e-02, 1.3977e-01])
[rfa agg] iter:  3, prev_obj_val: 4950.73583984375, obj_val: 4954.85302734375, abs dis: 4.1171875
[rfa agg] iter: 3, weight: tensor([4.4096e-05, 2.6410e-01, 5.1889e-02, 2.4916e-02, 2.5119e-02, 3.7727e-01,
        1.1467e-01, 1.5693e-02, 4.9655e-02, 7.6652e-02])
[rfa agg] iter:  4, prev_obj_val: 4954.85302734375, obj_val: 4960.5517578125, abs dis: 5.69873046875
[rfa agg] iter: 4, weight: tensor([5.8443e-05, 1.6715e-01, 1.0665e-01, 4.2996e-02, 4.3316e-02, 3.2672e-01,
        1.0536e-01, 2.5634e-02, 1.0175e-01, 8.0358e-02])
[rfa agg] iter:  5, prev_obj_val: 4960.5517578125, obj_val: 4963.60009765625, abs dis: 3.04833984375
[rfa agg] iter: 5, weight: tensor([5.8076e-05, 1.0721e-01, 2.2810e-01, 6.1196e-02, 6.1531e-02, 1.4888e-01,
        8.0499e-02, 3.3173e-02, 2.1324e-01, 6.6115e-02])
[rfa agg] iter:  6, prev_obj_val: 4963.60009765625, obj_val: 4967.90625, abs dis: 4.30615234375
[rfa agg] iter: 6, weight: tensor([4.0137e-05, 6.2869e-02, 3.4029e-01, 5.4068e-02, 5.4256e-02, 8.0141e-02,
        4.9837e-02, 2.7045e-02, 2.8939e-01, 4.2060e-02])
[rfa agg] iter:  7, prev_obj_val: 4967.90625, obj_val: 4970.67578125, abs dis: 2.76953125
[rfa agg] iter: 7, weight: tensor([3.7825e-05, 5.1427e-02, 3.4761e-01, 6.9681e-02, 6.9627e-02, 6.2005e-02,
        4.2514e-02, 3.0951e-02, 2.8944e-01, 3.6709e-02])
[rfa agg] iter:  8, prev_obj_val: 4970.67578125, obj_val: 4967.91455078125, abs dis: 2.76123046875
[rfa agg] iter: 8, weight: tensor([4.6849e-05, 5.9776e-02, 2.7549e-01, 1.0558e-01, 1.0503e-01, 7.0499e-02,
        5.0286e-02, 4.2945e-02, 2.4650e-01, 4.3853e-02])
[rfa agg] iter:  9, prev_obj_val: 4967.91455078125, obj_val: 4970.67431640625, abs dis: 2.759765625
[rfa agg] iter: 9, weight: tensor([3.8488e-05, 5.2343e-02, 3.4717e-01, 7.1515e-02, 7.1503e-02, 6.3038e-02,
        4.3267e-02, 3.1578e-02, 2.8219e-01, 3.7354e-02])
			Update norm = 118.66995657600116 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.42679238319397 sec.
Server Epoch:24 choose agents : [63, 82, 85, 83, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 385/888 (43.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9819, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 59/500 (11.8000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6643, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 406/1988 (20.4225%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 650/1988 (32.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5051, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 414/1953 (21.1982%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 752/1953 (38.5049%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0518, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 343/1013 (33.8598%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5898, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0634, Accuracy: 363/1163 (31.2124%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4749, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0761, Accuracy: 102/781 (13.0602%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5182, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4856, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5086, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0653, Accuracy: 131/818 (16.0147%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8009, Accuracy: 57/10000 (0.5700%)
time spent on training: 167.0906171798706
[rfa agg] training data poison_ratio: 0.0  data num: [888, 500, 1988, 1953, 1013, 1163, 781, 712, 1049, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 82, 85, 83, 14, 68, 3, 11, 51, 71], weight: tensor([0.0817, 0.0460, 0.1830, 0.1798, 0.0932, 0.1070, 0.0719, 0.0655, 0.0965,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 65.56510925292969, obj_val: 69.0562973022461, abs dis: 3.4911880493164062
[rfa agg] iter: 0, weight: tensor([0.0708, 0.0162, 0.0462, 0.0488, 0.1540, 0.2671, 0.0502, 0.0383, 0.2557,
        0.0528])
[rfa agg] iter:  1, prev_obj_val: 69.0562973022461, obj_val: 72.1458969116211, abs dis: 3.089599609375
[rfa agg] iter: 1, weight: tensor([0.1924, 0.0201, 0.0332, 0.0347, 0.2231, 0.0811, 0.1022, 0.0649, 0.1395,
        0.1087])
[rfa agg] iter:  2, prev_obj_val: 72.1458969116211, obj_val: 79.76549530029297, abs dis: 7.619598388671875
[rfa agg] iter: 2, weight: tensor([0.2971, 0.0194, 0.0259, 0.0270, 0.1127, 0.0536, 0.1446, 0.0780, 0.0789,
        0.1629])
[rfa agg] iter:  3, prev_obj_val: 79.76549530029297, obj_val: 83.16864776611328, abs dis: 3.4031524658203125
[rfa agg] iter: 3, weight: tensor([0.1302, 0.0258, 0.0241, 0.0249, 0.0668, 0.0418, 0.2025, 0.1809, 0.0539,
        0.2492])
[rfa agg] iter:  4, prev_obj_val: 83.16864776611328, obj_val: 86.91214752197266, abs dis: 3.743499755859375
[rfa agg] iter: 4, weight: tensor([0.1105, 0.0324, 0.0263, 0.0272, 0.0659, 0.0435, 0.1681, 0.2808, 0.0546,
        0.1906])
[rfa agg] iter:  5, prev_obj_val: 86.91214752197266, obj_val: 83.15258026123047, abs dis: 3.7595672607421875
[rfa agg] iter: 5, weight: tensor([0.1082, 0.0442, 0.0309, 0.0319, 0.0707, 0.0489, 0.1485, 0.2946, 0.0599,
        0.1622])
[rfa agg] iter:  6, prev_obj_val: 83.15258026123047, obj_val: 86.91181945800781, abs dis: 3.7592391967773438
[rfa agg] iter: 6, weight: tensor([0.1054, 0.0311, 0.0253, 0.0261, 0.0633, 0.0418, 0.1582, 0.3172, 0.0525,
        0.1789])
[rfa agg] iter:  7, prev_obj_val: 86.91181945800781, obj_val: 83.1523666381836, abs dis: 3.7594528198242188
[rfa agg] iter: 7, weight: tensor([0.1072, 0.0438, 0.0306, 0.0316, 0.0702, 0.0486, 0.1469, 0.3011, 0.0594,
        0.1605])
[rfa agg] iter:  8, prev_obj_val: 83.1523666381836, obj_val: 86.91185760498047, abs dis: 3.759490966796875
[rfa agg] iter: 8, weight: tensor([0.1051, 0.0310, 0.0252, 0.0261, 0.0632, 0.0417, 0.1576, 0.3194, 0.0524,
        0.1783])
[rfa agg] iter:  9, prev_obj_val: 86.91185760498047, obj_val: 83.15235137939453, abs dis: 3.7595062255859375
[rfa agg] iter: 9, weight: tensor([0.1072, 0.0438, 0.0306, 0.0316, 0.0701, 0.0485, 0.1468, 0.3015, 0.0594,
        0.1604])
			Update norm = 118.59563568988321 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.4479856491089 sec.
Server Epoch:25 choose agents : [15, 70, 45, 27, 54, 88, 16, 95, 32, 3].
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 322/1154 (27.9029%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 425/1154 (36.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.2835, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 332/1418 (23.4133%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 595/1418 (41.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7420, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0688, Accuracy: 191/669 (28.5501%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0410, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7417, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 434/1587 (27.3472%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 626/1587 (39.4455%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.9538, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 352/1130 (31.1504%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6176, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 135/603 (22.3881%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7668, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0653, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8976, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0523, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0612, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 323/735 (43.9456%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5503, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 103/781 (13.1882%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 239/781 (30.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.7027, Accuracy: 72/10000 (0.7200%)
time spent on training: 156.90561938285828
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 1418, 669, 1587, 1130, 603, 708, 599, 735, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [15, 70, 45, 27, 54, 88, 16, 95, 32, 3], weight: tensor([0.1230, 0.1511, 0.0713, 0.1691, 0.1204, 0.0643, 0.0754, 0.0638, 0.0783,
        0.0832])
[rfa agg] iter:  0, prev_obj_val: 48.85785675048828, obj_val: 51.02045440673828, abs dis: 2.16259765625
[rfa agg] iter: 0, weight: tensor([0.1063, 0.0705, 0.0796, 0.0642, 0.1323, 0.0564, 0.1145, 0.0559, 0.1209,
        0.1994])
[rfa agg] iter:  1, prev_obj_val: 51.02045440673828, obj_val: 59.06184387207031, abs dis: 8.041389465332031
[rfa agg] iter: 1, weight: tensor([0.0492, 0.0367, 0.0823, 0.0343, 0.0578, 0.0511, 0.1456, 0.0506, 0.1639,
        0.3284])
[rfa agg] iter:  2, prev_obj_val: 59.06184387207031, obj_val: 62.10142135620117, abs dis: 3.0395774841308594
[rfa agg] iter: 2, weight: tensor([0.0348, 0.0287, 0.2405, 0.0276, 0.0390, 0.1236, 0.1383, 0.1191, 0.1560,
        0.0924])
[rfa agg] iter:  3, prev_obj_val: 62.10142135620117, obj_val: 69.66641998291016, abs dis: 7.564998626708984
[rfa agg] iter: 3, weight: tensor([0.0323, 0.0271, 0.2196, 0.0262, 0.0358, 0.1938, 0.1024, 0.1809, 0.1097,
        0.0722])
[rfa agg] iter:  4, prev_obj_val: 69.66641998291016, obj_val: 69.65339660644531, abs dis: 0.01302337646484375
[rfa agg] iter: 4, weight: tensor([0.0365, 0.0316, 0.1268, 0.0309, 0.0399, 0.2581, 0.0822, 0.2414, 0.0864,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 69.65339660644531, obj_val: 69.65327453613281, abs dis: 0.0001220703125
[rfa agg] iter: 5, weight: tensor([0.0357, 0.0310, 0.1221, 0.0302, 0.0391, 0.2645, 0.0802, 0.2482, 0.0844,
        0.0647])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.50572323799133 sec.
Server Epoch:26 choose agents : [16, 82, 49, 81, 57, 74, 75, 46, 55, 43].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0623, Accuracy: 269/708 (37.9944%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7236, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 67/500 (13.4000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0501, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6209, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.5150, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 231/774 (29.8450%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 282/774 (36.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3283, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 299/1154 (25.9099%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.3024, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 495/1552 (31.8943%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.2507, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0658, Accuracy: 235/776 (30.2835%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8684, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 422/1904 (22.1639%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 671/1904 (35.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4588, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 504/1071 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9595, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 361/946 (38.1607%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.9985, Accuracy: 60/10000 (0.6000%)
time spent on training: 159.53786253929138
[rfa agg] training data poison_ratio: 0.0  data num: [708, 500, 440, 774, 1154, 1552, 776, 1904, 1071, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 82, 49, 81, 57, 74, 75, 46, 55, 43], weight: tensor([0.0721, 0.0509, 0.0448, 0.0788, 0.1175, 0.1580, 0.0790, 0.1938, 0.1090,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 57.01454162597656, obj_val: 59.95264434814453, abs dis: 2.9381027221679688
[rfa agg] iter: 0, weight: tensor([0.0570, 0.0203, 0.0159, 0.0813, 0.1200, 0.0561, 0.0823, 0.0444, 0.2691,
        0.2535])
[rfa agg] iter:  1, prev_obj_val: 59.95264434814453, obj_val: 63.215084075927734, abs dis: 3.262439727783203
[rfa agg] iter: 1, weight: tensor([0.0783, 0.0219, 0.0167, 0.1289, 0.0720, 0.0422, 0.1343, 0.0352, 0.1191,
        0.3514])
[rfa agg] iter:  2, prev_obj_val: 63.215084075927734, obj_val: 74.01813507080078, abs dis: 10.803050994873047
[rfa agg] iter: 2, weight: tensor([0.1169, 0.0244, 0.0182, 0.2196, 0.0561, 0.0365, 0.2530, 0.0313, 0.0812,
        0.1627])
[rfa agg] iter:  3, prev_obj_val: 74.01813507080078, obj_val: 70.66387176513672, abs dis: 3.3542633056640625
[rfa agg] iter: 3, weight: tensor([0.3004, 0.0483, 0.0333, 0.1619, 0.0530, 0.0399, 0.1679, 0.0358, 0.0670,
        0.0924])
[rfa agg] iter:  4, prev_obj_val: 70.66387176513672, obj_val: 77.48368835449219, abs dis: 6.819816589355469
[rfa agg] iter: 4, weight: tensor([0.3705, 0.0324, 0.0229, 0.1627, 0.0430, 0.0314, 0.1725, 0.0279, 0.0558,
        0.0810])
[rfa agg] iter:  5, prev_obj_val: 77.48368835449219, obj_val: 73.98358154296875, abs dis: 3.5001068115234375
[rfa agg] iter: 5, weight: tensor([0.2675, 0.0669, 0.0446, 0.1501, 0.0595, 0.0460, 0.1535, 0.0416, 0.0735,
        0.0968])
[rfa agg] iter:  6, prev_obj_val: 73.98358154296875, obj_val: 73.98054504394531, abs dis: 0.0030364990234375
[rfa agg] iter: 6, weight: tensor([0.3291, 0.0468, 0.0322, 0.1546, 0.0512, 0.0385, 0.1595, 0.0345, 0.0646,
        0.0890])
			Update norm = 112.4957247451542 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.4912302494049 sec.
Server Epoch:27 choose agents : [80, 8, 51, 85, 26, 14, 96, 99, 43, 16].
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 146/682 (21.4076%)
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   2, Avg loss: 0.0389, Accuracy: 232/682 (34.0176%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.4258, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 222/1513 (14.6728%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.2240, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 503/1049 (47.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6110, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 461/1988 (23.1891%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 693/1988 (34.8592%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5583, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 319/1446 (22.0609%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 511/1446 (35.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1026, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 360/1013 (35.5380%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.6101, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   2, Avg loss: 0.0546, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3525, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 170/773 (21.9922%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0334, Accuracy: 392/773 (50.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0773, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 352/946 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.9718, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   1, Avg loss: 0.0628, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.9689, Accuracy: 63/10000 (0.6300%)
time spent on training: 160.58532404899597
[rfa agg] training data poison_ratio: 0.0  data num: [682, 1513, 1049, 1988, 1446, 1013, 311, 773, 946, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 8, 51, 85, 26, 14, 96, 99, 43, 16], weight: tensor([0.0654, 0.1451, 0.1006, 0.1906, 0.1387, 0.0971, 0.0298, 0.0741, 0.0907,
        0.0679])
[rfa agg] iter:  0, prev_obj_val: 58.36846923828125, obj_val: 62.77815246582031, abs dis: 4.4096832275390625
[rfa agg] iter: 0, weight: tensor([0.0348, 0.0770, 0.3286, 0.0457, 0.0867, 0.1979, 0.0082, 0.0566, 0.1219,
        0.0426])
[rfa agg] iter:  1, prev_obj_val: 62.77815246582031, obj_val: 66.97555541992188, abs dis: 4.1974029541015625
[rfa agg] iter: 1, weight: tensor([0.0428, 0.0427, 0.1262, 0.0298, 0.0459, 0.2058, 0.0078, 0.0922, 0.3483,
        0.0584])
[rfa agg] iter:  2, prev_obj_val: 66.97555541992188, obj_val: 69.3431396484375, abs dis: 2.367584228515625
[rfa agg] iter: 2, weight: tensor([0.0668, 0.0455, 0.1007, 0.0333, 0.0483, 0.1459, 0.0103, 0.1901, 0.2592,
        0.0999])
[rfa agg] iter:  3, prev_obj_val: 69.3431396484375, obj_val: 69.32870483398438, abs dis: 0.014434814453125
[rfa agg] iter: 3, weight: tensor([0.0783, 0.0427, 0.0861, 0.0319, 0.0451, 0.1165, 0.0107, 0.2852, 0.1769,
        0.1267])
[rfa agg] iter:  4, prev_obj_val: 69.32870483398438, obj_val: 71.87645721435547, abs dis: 2.5477523803710938
[rfa agg] iter: 4, weight: tensor([0.0769, 0.0419, 0.0844, 0.0313, 0.0442, 0.1139, 0.0105, 0.3012, 0.1707,
        0.1250])
[rfa agg] iter:  5, prev_obj_val: 71.87645721435547, obj_val: 81.3551025390625, abs dis: 9.478645324707031
[rfa agg] iter: 5, weight: tensor([0.0854, 0.0362, 0.0675, 0.0277, 0.0381, 0.0870, 0.0101, 0.3749, 0.1197,
        0.1534])
[rfa agg] iter:  6, prev_obj_val: 81.3551025390625, obj_val: 81.26933288574219, abs dis: 0.0857696533203125
[rfa agg] iter: 6, weight: tensor([0.2521, 0.0378, 0.0589, 0.0304, 0.0393, 0.0697, 0.0145, 0.1535, 0.0833,
        0.2606])
[rfa agg] iter:  7, prev_obj_val: 81.26933288574219, obj_val: 81.26801300048828, abs dis: 0.00131988525390625
[rfa agg] iter: 7, weight: tensor([0.2752, 0.0351, 0.0547, 0.0282, 0.0365, 0.0646, 0.0135, 0.1363, 0.0772,
        0.2786])
			Update norm = 112.48230763657901 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.6758608818054 sec.
Server Epoch:28 choose agents : [55, 21, 93, 68, 49, 92, 86, 77, 7, 84].
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0569, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 505/1071 (47.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1221, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0543, Accuracy: 375/1949 (19.2406%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 588/1949 (30.1693%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5264, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 401/1742 (23.0195%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 671/1742 (38.5189%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9780, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0623, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 418/1163 (35.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.6047, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0812, Accuracy: 22/440 (5.0000%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5326, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0526, Accuracy: 455/1715 (26.5306%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 684/1715 (39.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.3672, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   1, Avg loss: 0.0641, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   2, Avg loss: 0.0357, Accuracy: 350/1003 (34.8953%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.6872, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5937, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 407/891 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0315, Accuracy: 59/10000 (0.5900%)
time spent on training: 179.92062187194824
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 1949, 1742, 1163, 440, 1715, 1003, 1340, 891, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 21, 93, 68, 49, 92, 86, 77, 7, 84], weight: tensor([0.0857, 0.1559, 0.1393, 0.0930, 0.0352, 0.1372, 0.0802, 0.1072, 0.0713,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 52.709449768066406, obj_val: 55.83716583251953, abs dis: 3.127716064453125
[rfa agg] iter: 0, weight: tensor([0.1025, 0.0345, 0.0410, 0.2733, 0.0078, 0.0452, 0.0679, 0.1282, 0.0372,
        0.2625])
[rfa agg] iter:  1, prev_obj_val: 55.83716583251953, obj_val: 55.81818389892578, abs dis: 0.01898193359375
[rfa agg] iter: 1, weight: tensor([0.1783, 0.0349, 0.0405, 0.2204, 0.0093, 0.0441, 0.1051, 0.0993, 0.0503,
        0.2179])
[rfa agg] iter:  2, prev_obj_val: 55.81818389892578, obj_val: 55.81800079345703, abs dis: 0.00018310546875
[rfa agg] iter: 2, weight: tensor([0.1863, 0.0349, 0.0405, 0.2156, 0.0093, 0.0442, 0.1060, 0.0993, 0.0504,
        0.2136])
			Update norm = 167.94578622095585 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.3565905094147 sec.
Server Epoch:29 choose agents : [20, 12, 59, 54, 88, 96, 63, 66, 61, 58].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 355/807 (43.9901%)
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7997, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0886, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0496, Accuracy: 128/338 (37.8698%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4557, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 475/1089 (43.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.2481, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0299, Accuracy: 452/1130 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4637, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.9777, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 42/311 (13.5048%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 422/888 (47.5225%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0992, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 249/1402 (17.7603%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 395/1402 (28.1740%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.2761, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   1, Avg loss: 0.1270, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   2, Avg loss: 0.1189, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3068, Accuracy: 38/10000 (0.3800%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0570, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 405/803 (50.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.0618, Accuracy: 52/10000 (0.5200%)
time spent on training: 160.95989084243774
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 338, 1089, 1130, 603, 311, 888, 1402, 85, 803]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 12, 59, 54, 88, 96, 63, 66, 61, 58], weight: tensor([0.1082, 0.0453, 0.1461, 0.1516, 0.0809, 0.0417, 0.1191, 0.1880, 0.0114,
        0.1077])
[rfa agg] iter:  0, prev_obj_val: 40.83503341674805, obj_val: 45.42333984375, abs dis: 4.588306427001953
[rfa agg] iter: 0, weight: tensor([0.2668, 0.0124, 0.0554, 0.0579, 0.0510, 0.0099, 0.1828, 0.0403, 0.0019,
        0.3217])
[rfa agg] iter:  1, prev_obj_val: 45.42333984375, obj_val: 45.41585159301758, abs dis: 0.007488250732421875
[rfa agg] iter: 1, weight: tensor([0.2484, 0.0205, 0.0661, 0.0690, 0.1055, 0.0160, 0.1551, 0.0516, 0.0030,
        0.2648])
			Update norm = 116.6550780144718 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 254.93839812278748 sec.
Server Epoch:30 choose agents : [70, 49, 92, 67, 44, 24, 1, 14, 90, 0].
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 344/1418 (24.2595%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 641/1418 (45.2045%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5327, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0810, Accuracy: 18/440 (4.0909%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0486, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.4965, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 467/1715 (27.2303%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 704/1715 (41.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5900, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 392/1750 (22.4000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 672/1750 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3357, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3980, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0577, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5698, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 314/1013 (30.9970%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7568, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3379, Accuracy: 54/10000 (0.5400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 376/1657 (22.6916%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7540, Accuracy: 73/10000 (0.7300%)
time spent on training: 195.9931721687317
[rfa agg] training data poison_ratio: 0.16031346749226005  data num: [1418, 440, 1715, 426, 1750, 312, 928, 1013, 677, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.05009795859133127
[rfa agg] init. name: [70, 49, 92, 67, 44, 24, 1, 14, 90, 0], weight: tensor([0.1372, 0.0426, 0.1659, 0.0412, 0.1693, 0.0302, 0.0898, 0.0980, 0.0655,
        0.1603])
[rfa agg] iter:  0, prev_obj_val: 65.57852172851562, obj_val: 65.5587387084961, abs dis: 0.01978302001953125
[rfa agg] iter: 0, weight: tensor([0.1767, 0.0219, 0.1151, 0.0212, 0.1052, 0.0132, 0.1478, 0.2218, 0.0516,
        0.1256])
			Update norm = 172.0193768609368 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.675612449646 sec.
Server Epoch:31 choose agents : [70, 30, 32, 95, 1, 61, 22, 99, 68, 97].
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 334/1418 (23.5543%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8491, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0818, Accuracy: 63/486 (12.9630%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7603, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 323/735 (43.9456%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0629, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0492, Accuracy: 335/599 (55.9265%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5966, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1275, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1158, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3070, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 559/1470 (38.0272%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 825/1470 (56.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9536, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   1, Avg loss: 0.0684, Accuracy: 174/773 (22.5097%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 375/773 (48.5123%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1388, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 361/1163 (31.0404%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   2, Avg loss: 0.0368, Accuracy: 459/1163 (39.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.6979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0532, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 474/1213 (39.0767%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8386, Accuracy: 89/10000 (0.8900%)
time spent on training: 161.23670744895935
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 486, 735, 599, 928, 85, 1470, 773, 1163, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 30, 32, 95, 1, 61, 22, 99, 68, 97], weight: tensor([0.1599, 0.0548, 0.0829, 0.0675, 0.1046, 0.0096, 0.1657, 0.0871, 0.1311,
        0.1368])
[rfa agg] iter:  0, prev_obj_val: 45.705970764160156, obj_val: 48.751182556152344, abs dis: 3.0452117919921875
[rfa agg] iter: 0, weight: tensor([0.0629, 0.0247, 0.0850, 0.0424, 0.3792, 0.0023, 0.0653, 0.1296, 0.1020,
        0.1066])
[rfa agg] iter:  1, prev_obj_val: 48.751182556152344, obj_val: 52.59480285644531, abs dis: 3.8436203002929688
[rfa agg] iter: 1, weight: tensor([0.0563, 0.0289, 0.1228, 0.0529, 0.2872, 0.0025, 0.0584, 0.2222, 0.0825,
        0.0863])
[rfa agg] iter:  2, prev_obj_val: 52.59480285644531, obj_val: 52.52414321899414, abs dis: 0.07065963745117188
[rfa agg] iter: 2, weight: tensor([0.0443, 0.0301, 0.1850, 0.0608, 0.1379, 0.0023, 0.0459, 0.3702, 0.0603,
        0.0630])
[rfa agg] iter:  3, prev_obj_val: 52.52414321899414, obj_val: 54.91587829589844, abs dis: 2.391735076904297
[rfa agg] iter: 3, weight: tensor([0.0402, 0.0274, 0.1725, 0.0553, 0.1216, 0.0021, 0.0416, 0.4275, 0.0547,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 54.91587829589844, obj_val: 57.58882522583008, abs dis: 2.6729469299316406
[rfa agg] iter: 4, weight: tensor([0.0406, 0.0322, 0.2558, 0.0695, 0.1060, 0.0023, 0.0421, 0.3416, 0.0537,
        0.0560])
[rfa agg] iter:  5, prev_obj_val: 57.58882522583008, obj_val: 67.10418701171875, abs dis: 9.515361785888672
[rfa agg] iter: 5, weight: tensor([0.0406, 0.0377, 0.3723, 0.0894, 0.0939, 0.0026, 0.0421, 0.2149, 0.0521,
        0.0544])
[rfa agg] iter:  6, prev_obj_val: 67.10418701171875, obj_val: 60.60056686401367, abs dis: 6.503620147705078
[rfa agg] iter: 6, weight: tensor([0.0475, 0.0781, 0.1951, 0.2988, 0.0850, 0.0039, 0.0492, 0.1256, 0.0572,
        0.0596])
[rfa agg] iter:  7, prev_obj_val: 60.60056686401367, obj_val: 57.556053161621094, abs dis: 3.044513702392578
[rfa agg] iter: 7, weight: tensor([0.0448, 0.0497, 0.3393, 0.1382, 0.0937, 0.0031, 0.0465, 0.1698, 0.0562,
        0.0587])
[rfa agg] iter:  8, prev_obj_val: 57.556053161621094, obj_val: 67.11246490478516, abs dis: 9.556411743164062
[rfa agg] iter: 8, weight: tensor([0.0381, 0.0355, 0.4219, 0.0849, 0.0882, 0.0024, 0.0396, 0.1892, 0.0490,
        0.0512])
[rfa agg] iter:  9, prev_obj_val: 67.11246490478516, obj_val: 60.600074768066406, abs dis: 6.51239013671875
[rfa agg] iter: 9, weight: tensor([0.0475, 0.0781, 0.1968, 0.2974, 0.0849, 0.0039, 0.0492, 0.1252, 0.0572,
        0.0597])
			Update norm = 112.33726945842595 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.47562313079834 sec.
Server Epoch:32 choose agents : [31, 27, 46, 19, 20, 85, 9, 91, 81, 59].
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0407, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 443/1587 (27.9143%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 618/1587 (38.9414%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2774, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 430/1904 (22.5840%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 649/1904 (34.0861%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3257, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 390/1036 (37.6448%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 672/1036 (64.8649%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.2334, Accuracy: 62/10000 (0.6200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.5449, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 467/1988 (23.4909%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 651/1988 (32.7465%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4872, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 352/1275 (27.6078%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 704/1275 (55.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.3771, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 340/1030 (33.0097%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 626/1030 (60.7767%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.5334, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   2, Avg loss: 0.0383, Accuracy: 271/774 (35.0129%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2089, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 291/1089 (26.7218%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 486/1089 (44.6281%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1335, Accuracy: 67/10000 (0.6700%)
time spent on training: 198.89164328575134
[rfa agg] training data poison_ratio: 0.06753138075313808  data num: [460, 1587, 1904, 1036, 807, 1988, 1275, 1030, 774, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.02110355648535565
[rfa agg] init. name: [31, 27, 46, 19, 20, 85, 9, 91, 81, 59], weight: tensor([0.0385, 0.1328, 0.1593, 0.0867, 0.0675, 0.1664, 0.1067, 0.0862, 0.0648,
        0.0911])
[rfa agg] iter:  0, prev_obj_val: 59.303768157958984, obj_val: 68.97848510742188, abs dis: 9.67471694946289
[rfa agg] iter: 0, weight: tensor([0.0119, 0.0750, 0.0494, 0.1345, 0.0381, 0.0437, 0.2638, 0.1304, 0.0366,
        0.2166])
[rfa agg] iter:  1, prev_obj_val: 68.97848510742188, obj_val: 71.69479370117188, abs dis: 2.71630859375
[rfa agg] iter: 1, weight: tensor([0.0172, 0.0530, 0.0410, 0.2349, 0.0772, 0.0375, 0.0946, 0.2199, 0.0750,
        0.1498])
[rfa agg] iter:  2, prev_obj_val: 71.69479370117188, obj_val: 74.55402374267578, abs dis: 2.8592300415039062
[rfa agg] iter: 2, weight: tensor([0.0205, 0.0561, 0.0442, 0.2066, 0.1022, 0.0406, 0.0936, 0.1993, 0.0997,
        0.1371])
[rfa agg] iter:  3, prev_obj_val: 74.55402374267578, obj_val: 77.46382141113281, abs dis: 2.9097976684570312
[rfa agg] iter: 3, weight: tensor([0.0238, 0.0576, 0.0462, 0.1753, 0.1343, 0.0426, 0.0914, 0.1712, 0.1319,
        0.1258])
[rfa agg] iter:  4, prev_obj_val: 77.46382141113281, obj_val: 80.42601013183594, abs dis: 2.962188720703125
[rfa agg] iter: 4, weight: tensor([0.0260, 0.0559, 0.0455, 0.1459, 0.1732, 0.0421, 0.0847, 0.1434, 0.1722,
        0.1111])
[rfa agg] iter:  5, prev_obj_val: 80.42601013183594, obj_val: 83.4783935546875, abs dis: 3.0523834228515625
[rfa agg] iter: 5, weight: tensor([0.0267, 0.0505, 0.0417, 0.1167, 0.2199, 0.0387, 0.0738, 0.1151, 0.2240,
        0.0928])
[rfa agg] iter:  6, prev_obj_val: 83.4783935546875, obj_val: 80.42620086669922, abs dis: 3.0521926879882812
[rfa agg] iter: 6, weight: tensor([0.0252, 0.0421, 0.0352, 0.0877, 0.2697, 0.0328, 0.0593, 0.0867, 0.2892,
        0.0721])
[rfa agg] iter:  7, prev_obj_val: 80.42620086669922, obj_val: 83.47662353515625, abs dis: 3.0504226684570312
[rfa agg] iter: 7, weight: tensor([0.0262, 0.0497, 0.0410, 0.1138, 0.2264, 0.0381, 0.0724, 0.1124, 0.2292,
        0.0909])
[rfa agg] iter:  8, prev_obj_val: 83.47662353515625, obj_val: 80.42634582519531, abs dis: 3.0502777099609375
[rfa agg] iter: 8, weight: tensor([0.0252, 0.0420, 0.0351, 0.0874, 0.2706, 0.0327, 0.0591, 0.0865, 0.2895,
        0.0719])
[rfa agg] iter:  9, prev_obj_val: 80.42634582519531, obj_val: 83.47663116455078, abs dis: 3.0502853393554688
[rfa agg] iter: 9, weight: tensor([0.0262, 0.0497, 0.0410, 0.1138, 0.2264, 0.0381, 0.0723, 0.1124, 0.2292,
        0.0909])
			Update norm = 129.39773350990347 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.08886194229126 sec.
Server Epoch:33 choose agents : [49, 13, 80, 70, 48, 78, 56, 37, 83, 46].
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0807, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0486, Accuracy: 154/440 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5152, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 600/1645 (36.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0981, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 141/682 (20.6745%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.3521, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 340/1418 (23.9774%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.4144, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   1, Avg loss: 0.0842, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5444, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3151, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 392/1129 (34.7210%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 715/1129 (63.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5699, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 753/1953 (38.5561%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7918, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   1, Avg loss: 0.0558, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 680/1904 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.4646, Accuracy: 93/10000 (0.9300%)
time spent on training: 180.2724051475525
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1645, 682, 1418, 631, 416, 186, 1129, 1953, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 13, 80, 70, 48, 78, 56, 37, 83, 46], weight: tensor([0.0423, 0.1581, 0.0656, 0.1363, 0.0606, 0.0400, 0.0179, 0.1085, 0.1877,
        0.1830])
[rfa agg] iter:  0, prev_obj_val: 72.75048065185547, obj_val: 72.69111633300781, abs dis: 0.05936431884765625
[rfa agg] iter: 0, weight: tensor([0.0187, 0.1504, 0.0420, 0.2476, 0.0349, 0.0177, 0.0060, 0.2791, 0.0982,
        0.1053])
			Update norm = 185.18686719432887 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.15856289863586 sec.
Server Epoch:34 choose agents : [60, 55, 12, 50, 72, 14, 25, 49, 31, 77].
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 573/2227 (25.7297%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.4181, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 254/1071 (23.7162%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 478/1071 (44.6312%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2170, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0501, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 143/809 (17.6761%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 358/809 (44.2522%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.1282, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 395/1241 (31.8292%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3236, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 340/1013 (33.5637%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4769, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 300/690 (43.4783%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   2, Avg loss: 0.0291, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.5502, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 18/440 (4.0909%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0494, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4971, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   1, Avg loss: 0.0829, Accuracy: 55/460 (11.9565%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   2, Avg loss: 0.0387, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 319/1340 (23.8060%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 549/1340 (40.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.6940, Accuracy: 67/10000 (0.6700%)
time spent on training: 170.5464518070221
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1071, 338, 809, 1241, 1013, 690, 440, 460, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 55, 12, 50, 72, 14, 25, 49, 31, 77], weight: tensor([0.2313, 0.1112, 0.0351, 0.0840, 0.1289, 0.1052, 0.0717, 0.0457, 0.0478,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 66.18643951416016, obj_val: 69.83511352539062, abs dis: 3.6486740112304688
[rfa agg] iter: 0, weight: tensor([0.0425, 0.3486, 0.0098, 0.0594, 0.1548, 0.1960, 0.0353, 0.0140, 0.0162,
        0.1234])
[rfa agg] iter:  1, prev_obj_val: 69.83511352539062, obj_val: 73.4201431274414, abs dis: 3.5850296020507812
[rfa agg] iter: 1, weight: tensor([0.0382, 0.2193, 0.0118, 0.1036, 0.0903, 0.3683, 0.0506, 0.0172, 0.0204,
        0.0804])
[rfa agg] iter:  2, prev_obj_val: 73.4201431274414, obj_val: 75.3138427734375, abs dis: 1.8936996459960938
[rfa agg] iter: 2, weight: tensor([0.0448, 0.1689, 0.0162, 0.2011, 0.0918, 0.2603, 0.0796, 0.0240, 0.0290,
        0.0843])
[rfa agg] iter:  3, prev_obj_val: 75.3138427734375, obj_val: 75.3056411743164, abs dis: 0.00820159912109375
[rfa agg] iter: 3, weight: tensor([0.0438, 0.1425, 0.0173, 0.2849, 0.0845, 0.1989, 0.0925, 0.0258, 0.0314,
        0.0785])
			Update norm = 133.51438797700794 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.02108931541443 sec.
Server Epoch:35 choose agents : [56, 59, 12, 2, 67, 49, 72, 34, 13, 42].
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3154, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0593, Accuracy: 286/1089 (26.2626%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.0350, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0881, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0481, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4596, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0796, Accuracy: 45/426 (10.5634%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5769, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0810, Accuracy: 16/440 (3.6364%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0491, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4929, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   1, Avg loss: 0.0619, Accuracy: 251/1241 (20.2256%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 418/1241 (33.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1451, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 387/1427 (27.1198%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.9134, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 295/1645 (17.9331%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 620/1645 (37.6900%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8343, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 503/1372 (36.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6830, Accuracy: 79/10000 (0.7900%)
time spent on training: 168.23195004463196
[rfa agg] training data poison_ratio: 0.0  data num: [186, 1089, 338, 605, 426, 440, 1241, 1427, 1645, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 59, 12, 2, 67, 49, 72, 34, 13, 42], weight: tensor([0.0212, 0.1242, 0.0385, 0.0690, 0.0486, 0.0502, 0.1415, 0.1627, 0.1876,
        0.1565])
[rfa agg] iter:  0, prev_obj_val: 61.25782012939453, obj_val: 56.61435317993164, abs dis: 4.643466949462891
[rfa agg] iter: 0, weight: tensor([0.0088, 0.2836, 0.0211, 0.0629, 0.0296, 0.0306, 0.1905, 0.1272, 0.1031,
        0.1425])
[rfa agg] iter:  1, prev_obj_val: 56.61435317993164, obj_val: 58.866024017333984, abs dis: 2.2516708374023438
[rfa agg] iter: 1, weight: tensor([0.0064, 0.3603, 0.0150, 0.0423, 0.0209, 0.0216, 0.1954, 0.1156, 0.0895,
        0.1330])
[rfa agg] iter:  2, prev_obj_val: 58.866024017333984, obj_val: 56.598514556884766, abs dis: 2.2675094604492188
[rfa agg] iter: 2, weight: tensor([0.0075, 0.3350, 0.0176, 0.0508, 0.0245, 0.0254, 0.1891, 0.1196, 0.0949,
        0.1356])
[rfa agg] iter:  3, prev_obj_val: 56.598514556884766, obj_val: 56.594451904296875, abs dis: 0.004062652587890625
[rfa agg] iter: 3, weight: tensor([0.0063, 0.3699, 0.0148, 0.0416, 0.0206, 0.0213, 0.1922, 0.1140, 0.0882,
        0.1311])
[rfa agg] iter:  4, prev_obj_val: 56.594451904296875, obj_val: 56.594322204589844, abs dis: 0.00012969970703125
[rfa agg] iter: 4, weight: tensor([0.0063, 0.3764, 0.0147, 0.0412, 0.0204, 0.0210, 0.1901, 0.1128, 0.0874,
        0.1297])
			Update norm = 159.29858462177245 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.6878263950348 sec.
Server Epoch:36 choose agents : [7, 12, 61, 44, 77, 43, 52, 34, 92, 71].
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 439/891 (49.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0879, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0496, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4746, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3066, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 379/1750 (21.6571%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 639/1750 (36.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8739, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 326/1340 (24.3284%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0282, Accuracy: 523/1340 (39.0299%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9502, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 300/946 (31.7125%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 327/946 (34.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0307, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0573, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.1802, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 374/1427 (26.2088%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 599/1427 (41.9762%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.8572, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 469/1715 (27.3469%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 717/1715 (41.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4415, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.3015, Accuracy: 69/10000 (0.6900%)
time spent on training: 188.16023802757263
[rfa agg] training data poison_ratio: 0.0  data num: [891, 338, 85, 1750, 1340, 946, 636, 1427, 1715, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 12, 61, 44, 77, 43, 52, 34, 92, 71], weight: tensor([0.0896, 0.0340, 0.0085, 0.1760, 0.1347, 0.0951, 0.0639, 0.1435, 0.1724,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 59.248680114746094, obj_val: 61.492767333984375, abs dis: 2.2440872192382812
[rfa agg] iter: 0, weight: tensor([0.1166, 0.0150, 0.0028, 0.0932, 0.2295, 0.1629, 0.0423, 0.1499, 0.1013,
        0.0864])
[rfa agg] iter:  1, prev_obj_val: 61.492767333984375, obj_val: 63.8341064453125, abs dis: 2.341339111328125
[rfa agg] iter: 1, weight: tensor([0.1472, 0.0156, 0.0028, 0.0811, 0.1687, 0.2280, 0.0462, 0.1203, 0.0873,
        0.1028])
[rfa agg] iter:  2, prev_obj_val: 63.8341064453125, obj_val: 70.58186340332031, abs dis: 6.7477569580078125
[rfa agg] iter: 2, weight: tensor([0.1749, 0.0140, 0.0025, 0.0608, 0.1108, 0.3325, 0.0440, 0.0846, 0.0650,
        0.1109])
[rfa agg] iter:  3, prev_obj_val: 70.58186340332031, obj_val: 73.08604431152344, abs dis: 2.504180908203125
[rfa agg] iter: 3, weight: tensor([0.3510, 0.0118, 0.0019, 0.0352, 0.0536, 0.2339, 0.0439, 0.0444, 0.0371,
        0.1872])
[rfa agg] iter:  4, prev_obj_val: 73.08604431152344, obj_val: 79.20218658447266, abs dis: 6.116142272949219
[rfa agg] iter: 4, weight: tensor([0.3342, 0.0125, 0.0020, 0.0338, 0.0498, 0.1633, 0.0497, 0.0419, 0.0356,
        0.2771])
[rfa agg] iter:  5, prev_obj_val: 79.20218658447266, obj_val: 75.9385757446289, abs dis: 3.26361083984375
[rfa agg] iter: 5, weight: tensor([0.1980, 0.0182, 0.0028, 0.0402, 0.0559, 0.1303, 0.0866, 0.0482, 0.0421,
        0.3777])
[rfa agg] iter:  6, prev_obj_val: 75.9385757446289, obj_val: 82.60575103759766, abs dis: 6.66717529296875
[rfa agg] iter: 6, weight: tensor([0.1985, 0.0129, 0.0020, 0.0317, 0.0453, 0.1213, 0.0561, 0.0386, 0.0332,
        0.4603])
[rfa agg] iter:  7, prev_obj_val: 82.60575103759766, obj_val: 75.95269012451172, abs dis: 6.6530609130859375
[rfa agg] iter: 7, weight: tensor([0.1793, 0.0236, 0.0035, 0.0466, 0.0633, 0.1310, 0.1271, 0.0552, 0.0487,
        0.3217])
[rfa agg] iter:  8, prev_obj_val: 75.95269012451172, obj_val: 82.60350036621094, abs dis: 6.650810241699219
[rfa agg] iter: 8, weight: tensor([0.2039, 0.0134, 0.0021, 0.0327, 0.0468, 0.1253, 0.0581, 0.0399, 0.0343,
        0.4436])
[rfa agg] iter:  9, prev_obj_val: 82.60350036621094, obj_val: 75.9529037475586, abs dis: 6.650596618652344
[rfa agg] iter: 9, weight: tensor([0.1797, 0.0236, 0.0035, 0.0467, 0.0634, 0.1313, 0.1273, 0.0552, 0.0488,
        0.3206])
			Update norm = 125.09363680359606 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3003, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.3431, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.2440285682678 sec.
Server Epoch:37 choose agents : [11, 33, 59, 95, 52, 25, 78, 26, 47, 1].
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 340/712 (47.7528%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.9132, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 60/515 (11.6505%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0523, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7744, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0315, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5799, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 344/599 (57.4290%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 280/636 (44.0252%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.3085, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0291, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2552, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 24/416 (5.7692%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.5998, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   1, Avg loss: 0.0557, Accuracy: 335/1446 (23.1674%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1389, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1274, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1110, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3138, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 546/928 (58.8362%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5532, Accuracy: 84/10000 (0.8400%)
time spent on training: 155.58751678466797
[rfa agg] training data poison_ratio: 0.0  data num: [712, 515, 1089, 599, 636, 690, 416, 1446, 134, 928]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 33, 59, 95, 52, 25, 78, 26, 47, 1], weight: tensor([0.0994, 0.0719, 0.1520, 0.0836, 0.0888, 0.0963, 0.0581, 0.2018, 0.0187,
        0.1295])
[rfa agg] iter:  0, prev_obj_val: 42.86105728149414, obj_val: 50.58101272583008, abs dis: 7.7199554443359375
[rfa agg] iter: 0, weight: tensor([0.3392, 0.0541, 0.0578, 0.0920, 0.0956, 0.1921, 0.0264, 0.0423, 0.0046,
        0.0959])
[rfa agg] iter:  1, prev_obj_val: 50.58101272583008, obj_val: 53.56340026855469, abs dis: 2.9823875427246094
[rfa agg] iter: 1, weight: tensor([0.0836, 0.1844, 0.0379, 0.2274, 0.2015, 0.1311, 0.0468, 0.0319, 0.0058,
        0.0497])
[rfa agg] iter:  2, prev_obj_val: 53.56340026855469, obj_val: 57.05904006958008, abs dis: 3.4956398010253906
[rfa agg] iter: 2, weight: tensor([0.0725, 0.3052, 0.0376, 0.1674, 0.1654, 0.1045, 0.0607, 0.0323, 0.0065,
        0.0478])
[rfa agg] iter:  3, prev_obj_val: 57.05904006958008, obj_val: 60.7614631652832, abs dis: 3.702423095703125
[rfa agg] iter: 3, weight: tensor([0.0761, 0.2930, 0.0434, 0.1432, 0.1467, 0.1028, 0.0945, 0.0379, 0.0086,
        0.0538])
[rfa agg] iter:  4, prev_obj_val: 60.7614631652832, obj_val: 60.756587982177734, abs dis: 0.00487518310546875
[rfa agg] iter: 4, weight: tensor([0.0813, 0.2180, 0.0502, 0.1339, 0.1391, 0.1049, 0.1558, 0.0446, 0.0113,
        0.0609])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.95759868621826 sec.
Server Epoch:38 choose agents : [84, 78, 4, 39, 42, 59, 73, 34, 20, 88].
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0131, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 36/416 (8.6538%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.6628, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0625, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.7795, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 472/1013 (46.5943%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4831, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 339/1372 (24.7085%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 492/1372 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7421, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 443/1089 (40.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9638, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 312/938 (33.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3202, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 407/1427 (28.5214%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.9306, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0584, Accuracy: 336/807 (41.6357%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0311, Accuracy: 434/807 (53.7794%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.5373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.9494, Accuracy: 51/10000 (0.5100%)
time spent on training: 181.6981658935547
[rfa agg] training data poison_ratio: 0.08271832718327184  data num: [1190, 416, 901, 1013, 1372, 1089, 938, 1427, 807, 603]
[rfa agg] considering poison per batch poison_fraction: 0.025849477244772448
[rfa agg] init. name: [84, 78, 4, 39, 42, 59, 73, 34, 20, 88], weight: tensor([0.1220, 0.0426, 0.0924, 0.1038, 0.1406, 0.1116, 0.0961, 0.1463, 0.0827,
        0.0618])
[rfa agg] iter:  0, prev_obj_val: 37.291664123535156, obj_val: 47.520450592041016, abs dis: 10.22878646850586
[rfa agg] iter: 0, weight: tensor([0.0658, 0.0117, 0.2207, 0.1830, 0.0441, 0.0770, 0.2480, 0.0402, 0.0825,
        0.0271])
[rfa agg] iter:  1, prev_obj_val: 47.520450592041016, obj_val: 44.50831604003906, abs dis: 3.012134552001953
[rfa agg] iter: 1, weight: tensor([0.0645, 0.0225, 0.1385, 0.1081, 0.0499, 0.0698, 0.1453, 0.0468, 0.2902,
        0.0645])
[rfa agg] iter:  2, prev_obj_val: 44.50831604003906, obj_val: 44.5070915222168, abs dis: 0.001224517822265625
[rfa agg] iter: 2, weight: tensor([0.0630, 0.0187, 0.1558, 0.1146, 0.0474, 0.0690, 0.1617, 0.0442, 0.2756,
        0.0501])
			Update norm = 127.91973267566071 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.5283908843994 sec.
Server Epoch:39 choose agents : [43, 8, 17, 27, 59, 44, 32, 92, 66, 71].
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 329/946 (34.7780%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0339, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 254/1513 (16.7878%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4109, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1007, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 458/1587 (28.8595%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 562/1587 (35.4127%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.2261, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 317/1089 (29.1093%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 428/1089 (39.3021%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9398, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 398/1750 (22.7429%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 668/1750 (38.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8482, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0238, Accuracy: 331/735 (45.0340%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9573, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 491/1715 (28.6297%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 696/1715 (40.5831%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4825, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 373/1402 (26.6049%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1265, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 155/818 (18.9487%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9074, Accuracy: 79/10000 (0.7900%)
time spent on training: 208.56246781349182
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1513, 1574, 1587, 1089, 1750, 735, 1715, 1402, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 8, 17, 27, 59, 44, 32, 92, 66, 71], weight: tensor([0.0721, 0.1152, 0.1199, 0.1209, 0.0829, 0.1333, 0.0560, 0.1306, 0.1068,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 48.20558166503906, obj_val: 48.16934585571289, abs dis: 0.036235809326171875
[rfa agg] iter: 0, weight: tensor([0.0638, 0.1254, 0.1060, 0.1066, 0.1566, 0.0742, 0.0313, 0.0829, 0.2136,
        0.0397])
[rfa agg] iter:  1, prev_obj_val: 48.16934585571289, obj_val: 50.191078186035156, abs dis: 2.0217323303222656
[rfa agg] iter: 1, weight: tensor([0.0633, 0.1244, 0.1049, 0.1055, 0.1591, 0.0735, 0.0310, 0.0820, 0.2169,
        0.0393])
[rfa agg] iter:  2, prev_obj_val: 50.191078186035156, obj_val: 50.186466217041016, abs dis: 0.004611968994140625
[rfa agg] iter: 2, weight: tensor([0.0724, 0.1150, 0.0989, 0.0995, 0.2003, 0.0716, 0.0342, 0.0793, 0.1851,
        0.0437])
[rfa agg] iter:  3, prev_obj_val: 50.186466217041016, obj_val: 52.25572204589844, abs dis: 2.069255828857422
[rfa agg] iter: 3, weight: tensor([0.0723, 0.1146, 0.0985, 0.0992, 0.2037, 0.0714, 0.0341, 0.0790, 0.1836,
        0.0436])
[rfa agg] iter:  4, prev_obj_val: 52.25572204589844, obj_val: 56.6773567199707, abs dis: 4.421634674072266
[rfa agg] iter: 4, weight: tensor([0.0807, 0.1034, 0.0903, 0.0909, 0.2542, 0.0673, 0.0364, 0.0740, 0.1556,
        0.0470])
[rfa agg] iter:  5, prev_obj_val: 56.6773567199707, obj_val: 59.12562942504883, abs dis: 2.448272705078125
[rfa agg] iter: 5, weight: tensor([0.1001, 0.0819, 0.0734, 0.0739, 0.3460, 0.0573, 0.0400, 0.0623, 0.1122,
        0.0531])
[rfa agg] iter:  6, prev_obj_val: 59.12562942504883, obj_val: 56.65092468261719, abs dis: 2.4747047424316406
[rfa agg] iter: 6, weight: tensor([0.1186, 0.0761, 0.0689, 0.0694, 0.3493, 0.0549, 0.0438, 0.0594, 0.1005,
        0.0590])
[rfa agg] iter:  7, prev_obj_val: 56.65092468261719, obj_val: 59.1265754699707, abs dis: 2.4756507873535156
[rfa agg] iter: 7, weight: tensor([0.0950, 0.0776, 0.0696, 0.0701, 0.3797, 0.0544, 0.0380, 0.0591, 0.1060,
        0.0504])
[rfa agg] iter:  8, prev_obj_val: 59.1265754699707, obj_val: 56.64989471435547, abs dis: 2.4766807556152344
[rfa agg] iter: 8, weight: tensor([0.1167, 0.0750, 0.0679, 0.0685, 0.3587, 0.0542, 0.0432, 0.0586, 0.0991,
        0.0582])
[rfa agg] iter:  9, prev_obj_val: 56.64989471435547, obj_val: 59.12685775756836, abs dis: 2.4769630432128906
[rfa agg] iter: 9, weight: tensor([0.0945, 0.0772, 0.0692, 0.0697, 0.3832, 0.0541, 0.0378, 0.0588, 0.1054,
        0.0501])
			Update norm = 162.4622912978578 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.46955704689026 sec.
Server Epoch:40 choose agents : [72, 92, 10, 79, 82, 55, 2, 64, 84, 44].
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0373, Accuracy: 385/1241 (31.0234%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.1989, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 401/1715 (23.3819%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 729/1715 (42.5073%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.5755, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 219/861 (25.4355%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 417/861 (48.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7616, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   2, Avg loss: 0.0842, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.6871, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 237/1071 (22.1289%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 493/1071 (46.0317%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9927, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 223/605 (36.8595%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9009, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 177/953 (18.5729%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 316/953 (33.1584%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6678, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 327/1190 (27.4790%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.9906, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 388/1750 (22.1714%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 675/1750 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.4477, Accuracy: 103/10000 (1.0300%)
time spent on training: 182.9110131263733
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1715, 861, 197, 500, 1071, 605, 953, 1190, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 92, 10, 79, 82, 55, 2, 64, 84, 44], weight: tensor([0.1231, 0.1701, 0.0854, 0.0195, 0.0496, 0.1062, 0.0600, 0.0945, 0.1180,
        0.1736])
[rfa agg] iter:  0, prev_obj_val: 53.44613265991211, obj_val: 60.04203796386719, abs dis: 6.595905303955078
[rfa agg] iter: 0, weight: tensor([0.1165, 0.0506, 0.0829, 0.0045, 0.0164, 0.3718, 0.0255, 0.1305, 0.1543,
        0.0471])
[rfa agg] iter:  1, prev_obj_val: 60.04203796386719, obj_val: 62.210391998291016, abs dis: 2.168354034423828
[rfa agg] iter: 1, weight: tensor([0.0717, 0.0419, 0.2040, 0.0052, 0.0209, 0.1510, 0.0351, 0.3462, 0.0846,
        0.0395])
[rfa agg] iter:  2, prev_obj_val: 62.210391998291016, obj_val: 67.85770416259766, abs dis: 5.647312164306641
[rfa agg] iter: 2, weight: tensor([0.0602, 0.0370, 0.2885, 0.0050, 0.0207, 0.1104, 0.0360, 0.3378, 0.0695,
        0.0350])
[rfa agg] iter:  3, prev_obj_val: 67.85770416259766, obj_val: 64.8236312866211, abs dis: 3.0340728759765625
[rfa agg] iter: 3, weight: tensor([0.0640, 0.0429, 0.3837, 0.0069, 0.0305, 0.1009, 0.0574, 0.2008, 0.0719,
        0.0409])
[rfa agg] iter:  4, prev_obj_val: 64.8236312866211, obj_val: 64.81373596191406, abs dis: 0.00989532470703125
[rfa agg] iter: 4, weight: tensor([0.0527, 0.0340, 0.4666, 0.0050, 0.0214, 0.0888, 0.0384, 0.2009, 0.0600,
        0.0322])
[rfa agg] iter:  5, prev_obj_val: 64.81373596191406, obj_val: 71.04963684082031, abs dis: 6.23590087890625
[rfa agg] iter: 5, weight: tensor([0.0495, 0.0319, 0.5005, 0.0047, 0.0201, 0.0833, 0.0361, 0.1872, 0.0564,
        0.0303])
[rfa agg] iter:  6, prev_obj_val: 71.04963684082031, obj_val: 67.837646484375, abs dis: 3.2119903564453125
[rfa agg] iter: 6, weight: tensor([0.0721, 0.0501, 0.3296, 0.0088, 0.0405, 0.1075, 0.0801, 0.1835, 0.0800,
        0.0478])
[rfa agg] iter:  7, prev_obj_val: 67.837646484375, obj_val: 64.82130432128906, abs dis: 3.0163421630859375
[rfa agg] iter: 7, weight: tensor([0.0629, 0.0422, 0.4004, 0.0068, 0.0300, 0.0992, 0.0564, 0.1913, 0.0707,
        0.0401])
[rfa agg] iter:  8, prev_obj_val: 64.82130432128906, obj_val: 71.04476928710938, abs dis: 6.2234649658203125
[rfa agg] iter: 8, weight: tensor([0.0521, 0.0335, 0.4742, 0.0049, 0.0211, 0.0877, 0.0379, 0.1974, 0.0593,
        0.0318])
[rfa agg] iter:  9, prev_obj_val: 71.04476928710938, obj_val: 67.83782958984375, abs dis: 3.206939697265625
[rfa agg] iter: 9, weight: tensor([0.0722, 0.0502, 0.3279, 0.0088, 0.0406, 0.1077, 0.0803, 0.1842, 0.0802,
        0.0479])
			Update norm = 127.91532385967288 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 281.98493003845215 sec.
Server Epoch:41 choose agents : [65, 85, 25, 90, 38, 75, 45, 21, 51, 16].
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 394/1475 (26.7119%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 640/1475 (43.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9770, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 430/1988 (21.6298%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 679/1988 (34.1549%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5093, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4690, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 315/677 (46.5288%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1825, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 496/1131 (43.8550%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4975, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 396/776 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9989, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0682, Accuracy: 197/669 (29.4469%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8360, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 384/1949 (19.7024%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 600/1949 (30.7850%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3894, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   1, Avg loss: 0.0610, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 489/1049 (46.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5596, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   1, Avg loss: 0.0648, Accuracy: 279/708 (39.4068%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.9001, Accuracy: 62/10000 (0.6200%)
time spent on training: 201.58059644699097
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 1988, 690, 677, 1131, 776, 669, 1949, 1049, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 85, 25, 90, 38, 75, 45, 21, 51, 16], weight: tensor([0.1327, 0.1789, 0.0621, 0.0609, 0.1018, 0.0698, 0.0602, 0.1754, 0.0944,
        0.0637])
[rfa agg] iter:  0, prev_obj_val: 69.95306396484375, obj_val: 72.97030639648438, abs dis: 3.017242431640625
[rfa agg] iter: 0, weight: tensor([0.1220, 0.0647, 0.0364, 0.0357, 0.3343, 0.0544, 0.0353, 0.0687, 0.2058,
        0.0426])
[rfa agg] iter:  1, prev_obj_val: 72.97030639648438, obj_val: 79.31712341308594, abs dis: 6.3468170166015625
[rfa agg] iter: 1, weight: tensor([0.0636, 0.0419, 0.0407, 0.0399, 0.2211, 0.0707, 0.0395, 0.0439, 0.3883,
        0.0504])
[rfa agg] iter:  2, prev_obj_val: 79.31712341308594, obj_val: 82.6610336303711, abs dis: 3.3439102172851562
[rfa agg] iter: 2, weight: tensor([0.0642, 0.0473, 0.0803, 0.0787, 0.1309, 0.1896, 0.0780, 0.0492, 0.1711,
        0.1106])
[rfa agg] iter:  3, prev_obj_val: 82.6610336303711, obj_val: 86.70393371582031, abs dis: 4.042900085449219
[rfa agg] iter: 3, weight: tensor([0.0457, 0.0351, 0.0875, 0.0854, 0.0806, 0.3116, 0.0848, 0.0364, 0.0962,
        0.1367])
[rfa agg] iter:  4, prev_obj_val: 86.70393371582031, obj_val: 91.9579086303711, abs dis: 5.253974914550781
[rfa agg] iter: 4, weight: tensor([0.0331, 0.0264, 0.1099, 0.1060, 0.0525, 0.2756, 0.1060, 0.0273, 0.0596,
        0.2034])
[rfa agg] iter:  5, prev_obj_val: 91.9579086303711, obj_val: 95.13170623779297, abs dis: 3.173797607421875
[rfa agg] iter: 5, weight: tensor([0.0262, 0.0216, 0.1932, 0.1780, 0.0383, 0.1083, 0.1840, 0.0223, 0.0421,
        0.1860])
[rfa agg] iter:  6, prev_obj_val: 95.13170623779297, obj_val: 95.11180877685547, abs dis: 0.0198974609375
[rfa agg] iter: 6, weight: tensor([0.0219, 0.0183, 0.2479, 0.2166, 0.0310, 0.0711, 0.2287, 0.0189, 0.0336,
        0.1121])
[rfa agg] iter:  7, prev_obj_val: 95.11180877685547, obj_val: 95.11138153076172, abs dis: 0.00042724609375
[rfa agg] iter: 7, weight: tensor([0.0210, 0.0175, 0.2621, 0.2182, 0.0296, 0.0676, 0.2303, 0.0181, 0.0321,
        0.1035])
			Update norm = 106.56068546842216 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 302.05733942985535 sec.
Server Epoch:42 choose agents : [4, 43, 67, 60, 32, 45, 94, 15, 38, 34].
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0616, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 381/901 (42.2863%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1150, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0622, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 336/946 (35.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.1863, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0793, Accuracy: 43/426 (10.0939%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0432, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.6225, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 591/2227 (26.5379%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1038/2227 (46.6098%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0058, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 357/735 (48.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2324, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 201/669 (30.0448%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8006, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 342/1662 (20.5776%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 613/1662 (36.8833%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7086, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0284, Accuracy: 475/1154 (41.1612%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9578, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 244/1131 (21.5738%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 480/1131 (42.4403%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1653, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.9819, Accuracy: 62/10000 (0.6200%)
time spent on training: 202.44921255111694
[rfa agg] training data poison_ratio: 0.0  data num: [901, 946, 426, 2227, 735, 669, 1662, 1154, 1131, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 43, 67, 60, 32, 45, 94, 15, 38, 34], weight: tensor([0.0799, 0.0839, 0.0378, 0.1975, 0.0652, 0.0593, 0.1474, 0.1023, 0.1003,
        0.1265])
[rfa agg] iter:  0, prev_obj_val: 63.29830551147461, obj_val: 68.09888458251953, abs dis: 4.800579071044922
[rfa agg] iter: 0, weight: tensor([0.0695, 0.0731, 0.0103, 0.0375, 0.0313, 0.0247, 0.0611, 0.2779, 0.3284,
        0.0862])
[rfa agg] iter:  1, prev_obj_val: 68.09888458251953, obj_val: 71.40345001220703, abs dis: 3.3045654296875
[rfa agg] iter: 1, weight: tensor([0.1705, 0.1785, 0.0147, 0.0397, 0.0530, 0.0397, 0.0574, 0.1450, 0.2298,
        0.0716])
[rfa agg] iter:  2, prev_obj_val: 71.40345001220703, obj_val: 73.38794708251953, abs dis: 1.9844970703125
[rfa agg] iter: 2, weight: tensor([0.2686, 0.2834, 0.0138, 0.0316, 0.0569, 0.0406, 0.0436, 0.0882, 0.1210,
        0.0522])
[rfa agg] iter:  3, prev_obj_val: 73.38794708251953, obj_val: 81.64613342285156, abs dis: 8.258186340332031
[rfa agg] iter: 3, weight: tensor([0.3038, 0.3262, 0.0127, 0.0268, 0.0572, 0.0395, 0.0362, 0.0673, 0.0877,
        0.0426])
[rfa agg] iter:  4, prev_obj_val: 81.64613342285156, obj_val: 78.699951171875, abs dis: 2.9461822509765625
[rfa agg] iter: 4, weight: tensor([0.2007, 0.2120, 0.0238, 0.0381, 0.1608, 0.0939, 0.0488, 0.0759, 0.0910,
        0.0550])
[rfa agg] iter:  5, prev_obj_val: 78.699951171875, obj_val: 78.6952896118164, abs dis: 0.00466156005859375
[rfa agg] iter: 5, weight: tensor([0.2393, 0.2521, 0.0200, 0.0352, 0.1162, 0.0721, 0.0458, 0.0750, 0.0920,
        0.0523])
			Update norm = 132.25158759680355 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.2998, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.3079, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 295.96461176872253 sec.
Server Epoch:43 choose agents : [30, 90, 78, 76, 95, 4, 91, 40, 31, 21].
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0814, Accuracy: 65/486 (13.3745%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8758, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 313/677 (46.2334%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1113, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 25/416 (6.0096%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.5892, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   1, Avg loss: 0.0872, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.6727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   1, Avg loss: 0.0477, Accuracy: 356/599 (59.4324%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0153, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0594, Accuracy: 320/901 (35.5161%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0559, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0553, Accuracy: 333/1030 (32.3301%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 629/1030 (61.0680%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1196, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 338/1573 (21.4876%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 579/1573 (36.8086%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2396, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8128, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 391/1949 (20.0616%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 634/1949 (32.5295%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4043, Accuracy: 84/10000 (0.8400%)
time spent on training: 182.72154808044434
[rfa agg] training data poison_ratio: 0.0  data num: [486, 677, 416, 466, 599, 901, 1030, 1573, 460, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 90, 78, 76, 95, 4, 91, 40, 31, 21], weight: tensor([0.0568, 0.0791, 0.0486, 0.0545, 0.0700, 0.1053, 0.1204, 0.1838, 0.0538,
        0.2278])
[rfa agg] iter:  0, prev_obj_val: 71.43793487548828, obj_val: 76.51983642578125, abs dis: 5.081901550292969
[rfa agg] iter: 0, weight: tensor([0.0278, 0.0617, 0.0211, 0.0266, 0.0456, 0.3301, 0.3213, 0.0799, 0.0263,
        0.0595])
[rfa agg] iter:  1, prev_obj_val: 76.51983642578125, obj_val: 81.68829345703125, abs dis: 5.16845703125
[rfa agg] iter: 1, weight: tensor([0.0539, 0.1800, 0.0384, 0.0515, 0.1089, 0.2411, 0.1415, 0.0734, 0.0508,
        0.0606])
[rfa agg] iter:  2, prev_obj_val: 81.68829345703125, obj_val: 93.25738525390625, abs dis: 11.569091796875
[rfa agg] iter: 2, weight: tensor([0.0520, 0.4464, 0.0335, 0.0495, 0.1721, 0.0732, 0.0556, 0.0369, 0.0489,
        0.0320])
[rfa agg] iter:  3, prev_obj_val: 93.25738525390625, obj_val: 99.68556213378906, abs dis: 6.4281768798828125
[rfa agg] iter: 3, weight: tensor([0.2023, 0.0890, 0.0819, 0.1761, 0.1261, 0.0456, 0.0398, 0.0315, 0.1792,
        0.0286])
[rfa agg] iter:  4, prev_obj_val: 99.68556213378906, obj_val: 93.08638000488281, abs dis: 6.59918212890625
[rfa agg] iter: 4, weight: tensor([0.2214, 0.0556, 0.1616, 0.1884, 0.0685, 0.0348, 0.0313, 0.0262, 0.1881,
        0.0241])
[rfa agg] iter:  5, prev_obj_val: 93.08638000488281, obj_val: 93.07881927490234, abs dis: 0.00756072998046875
[rfa agg] iter: 5, weight: tensor([0.2287, 0.0762, 0.0765, 0.1927, 0.1084, 0.0398, 0.0348, 0.0276, 0.1902,
        0.0251])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.85425305366516 sec.
Server Epoch:44 choose agents : [99, 52, 94, 4, 15, 32, 64, 58, 36, 57].
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 165/773 (21.3454%)
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 391/773 (50.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.7111, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 296/636 (46.5409%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.4535, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 322/1662 (19.3742%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.7512, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0653, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0307, Accuracy: 394/901 (43.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.9710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 417/1154 (36.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8412, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8664, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 142/953 (14.9003%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.3617, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0563, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.0539, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.5323, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 306/1154 (26.5165%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0289, Accuracy: 515/1154 (44.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4107, Accuracy: 73/10000 (0.7300%)
time spent on training: 185.54792833328247
[rfa agg] training data poison_ratio: 0.0  data num: [773, 636, 1662, 901, 1154, 735, 953, 803, 408, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [99, 52, 94, 4, 15, 32, 64, 58, 36, 57], weight: tensor([0.0842, 0.0693, 0.1811, 0.0982, 0.1257, 0.0801, 0.1038, 0.0875, 0.0444,
        0.1257])
[rfa agg] iter:  0, prev_obj_val: 41.95962142944336, obj_val: 44.81259536743164, abs dis: 2.8529739379882812
[rfa agg] iter: 0, weight: tensor([0.1632, 0.0397, 0.0353, 0.1699, 0.0580, 0.0892, 0.2019, 0.1703, 0.0148,
        0.0577])
[rfa agg] iter:  1, prev_obj_val: 44.81259536743164, obj_val: 52.9914436340332, abs dis: 8.178848266601562
[rfa agg] iter: 1, weight: tensor([0.2559, 0.0424, 0.0265, 0.0867, 0.0395, 0.1278, 0.0951, 0.2727, 0.0140,
        0.0394])
[rfa agg] iter:  2, prev_obj_val: 52.9914436340332, obj_val: 59.77785110473633, abs dis: 6.786407470703125
[rfa agg] iter: 2, weight: tensor([0.1464, 0.1121, 0.0347, 0.0757, 0.0463, 0.2776, 0.0813, 0.1526, 0.0270,
        0.0462])
[rfa agg] iter:  3, prev_obj_val: 59.77785110473633, obj_val: 56.30620193481445, abs dis: 3.471649169921875
[rfa agg] iter: 3, weight: tensor([0.1124, 0.2606, 0.0401, 0.0736, 0.0506, 0.1744, 0.0786, 0.1167, 0.0425,
        0.0505])
[rfa agg] iter:  4, prev_obj_val: 56.30620193481445, obj_val: 56.29916763305664, abs dis: 0.0070343017578125
[rfa agg] iter: 4, weight: tensor([0.1279, 0.1869, 0.0385, 0.0763, 0.0498, 0.2222, 0.0818, 0.1322, 0.0348,
        0.0497])
			Update norm = 105.42469450246227 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.90284752845764 sec.
Server Epoch:45 choose agents : [29, 81, 27, 2, 94, 56, 14, 99, 62, 76].
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0499, Accuracy: 410/1440 (28.4722%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 661/1440 (45.9028%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5830, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 232/774 (29.9742%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   2, Avg loss: 0.0377, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.3467, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 410/1587 (25.8349%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0344, Accuracy: 581/1587 (36.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1097, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 239/605 (39.5041%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0409, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9328, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 332/1662 (19.9759%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 596/1662 (35.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6505, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3219, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 309/1013 (30.5035%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.5862, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   1, Avg loss: 0.0675, Accuracy: 170/773 (21.9922%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 393/773 (50.8409%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.3661, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 141/568 (24.8239%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0415, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.8713, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7941, Accuracy: 50/10000 (0.5000%)
time spent on training: 178.56641578674316
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 774, 1587, 605, 1662, 186, 1013, 773, 568, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 81, 27, 2, 94, 56, 14, 99, 62, 76], weight: tensor([0.1587, 0.0853, 0.1749, 0.0667, 0.1832, 0.0205, 0.1116, 0.0852, 0.0626,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 59.25364303588867, obj_val: 62.732269287109375, abs dis: 3.478626251220703
[rfa agg] iter: 0, weight: tensor([0.0931, 0.0916, 0.0786, 0.0392, 0.0738, 0.0058, 0.4718, 0.0909, 0.0320,
        0.0231])
[rfa agg] iter:  1, prev_obj_val: 62.732269287109375, obj_val: 63.90492630004883, abs dis: 1.1726570129394531
[rfa agg] iter: 1, weight: tensor([0.0720, 0.1944, 0.0643, 0.0567, 0.0615, 0.0068, 0.2771, 0.1930, 0.0437,
        0.0304])
[rfa agg] iter:  2, prev_obj_val: 63.90492630004883, obj_val: 69.02680206298828, abs dis: 5.121875762939453
[rfa agg] iter: 2, weight: tensor([0.0625, 0.2508, 0.0563, 0.0585, 0.0541, 0.0065, 0.1902, 0.2468, 0.0441,
        0.0302])
[rfa agg] iter:  3, prev_obj_val: 69.02680206298828, obj_val: 71.50636291503906, abs dis: 2.4795608520507812
[rfa agg] iter: 3, weight: tensor([0.0446, 0.3127, 0.0412, 0.0763, 0.0400, 0.0062, 0.0926, 0.3013, 0.0518,
        0.0332])
[rfa agg] iter:  4, prev_obj_val: 71.50636291503906, obj_val: 71.50130462646484, abs dis: 0.00505828857421875
[rfa agg] iter: 4, weight: tensor([0.0513, 0.2620, 0.0478, 0.1131, 0.0465, 0.0079, 0.0977, 0.2563, 0.0724,
        0.0449])
			Update norm = 113.79325671338131 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.082644701004 sec.
Server Epoch:46 choose agents : [97, 54, 16, 75, 96, 90, 39, 50, 12, 17].
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 488/1213 (40.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9010, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5777, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0691, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0331, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8538, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   1, Avg loss: 0.0651, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9069, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0546, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3692, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3326, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 319/1013 (31.4906%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 536/1013 (52.9121%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0186, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 155/809 (19.1595%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 361/809 (44.6230%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2632, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 127/338 (37.5740%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5318, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 403/1574 (25.6036%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 683/1574 (43.3926%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0646, Accuracy: 93/10000 (0.9300%)
time spent on training: 173.29616785049438
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 1130, 708, 776, 311, 677, 1013, 809, 338, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 54, 16, 75, 96, 90, 39, 50, 12, 17], weight: tensor([0.1419, 0.1322, 0.0828, 0.0908, 0.0364, 0.0792, 0.1185, 0.0946, 0.0395,
        0.1841])
[rfa agg] iter:  0, prev_obj_val: 44.32380676269531, obj_val: 52.54667663574219, abs dis: 8.222869873046875
[rfa agg] iter: 0, weight: tensor([0.0630, 0.0714, 0.1200, 0.2506, 0.0104, 0.0761, 0.1109, 0.2454, 0.0129,
        0.0394])
[rfa agg] iter:  1, prev_obj_val: 52.54667663574219, obj_val: 59.096988677978516, abs dis: 6.550312042236328
[rfa agg] iter: 1, weight: tensor([0.0469, 0.0504, 0.2214, 0.1407, 0.0137, 0.2659, 0.0646, 0.1448, 0.0176,
        0.0340])
[rfa agg] iter:  2, prev_obj_val: 59.096988677978516, obj_val: 62.776878356933594, abs dis: 3.679889678955078
[rfa agg] iter: 2, weight: tensor([0.0514, 0.0542, 0.1556, 0.1086, 0.0199, 0.3658, 0.0659, 0.1127, 0.0265,
        0.0392])
[rfa agg] iter:  3, prev_obj_val: 62.776878356933594, obj_val: 52.4954833984375, abs dis: 10.281394958496094
[rfa agg] iter: 3, weight: tensor([0.0619, 0.0648, 0.1532, 0.1162, 0.0277, 0.2922, 0.0771, 0.1209, 0.0378,
        0.0483])
[rfa agg] iter:  4, prev_obj_val: 52.4954833984375, obj_val: 59.094947814941406, abs dis: 6.599464416503906
[rfa agg] iter: 4, weight: tensor([0.0450, 0.0483, 0.2236, 0.1316, 0.0131, 0.2912, 0.0619, 0.1358, 0.0169,
        0.0325])
[rfa agg] iter:  5, prev_obj_val: 59.094947814941406, obj_val: 62.777034759521484, abs dis: 3.682086944580078
[rfa agg] iter: 5, weight: tensor([0.0512, 0.0540, 0.1550, 0.1080, 0.0198, 0.3688, 0.0656, 0.1121, 0.0264,
        0.0390])
[rfa agg] iter:  6, prev_obj_val: 62.777034759521484, obj_val: 52.49549102783203, abs dis: 10.281543731689453
[rfa agg] iter: 6, weight: tensor([0.0619, 0.0648, 0.1531, 0.1162, 0.0277, 0.2923, 0.0771, 0.1209, 0.0378,
        0.0483])
[rfa agg] iter:  7, prev_obj_val: 52.49549102783203, obj_val: 59.094940185546875, abs dis: 6.599449157714844
[rfa agg] iter: 7, weight: tensor([0.0450, 0.0483, 0.2236, 0.1316, 0.0131, 0.2912, 0.0619, 0.1358, 0.0169,
        0.0325])
[rfa agg] iter:  8, prev_obj_val: 59.094940185546875, obj_val: 62.77703857421875, abs dis: 3.682098388671875
[rfa agg] iter: 8, weight: tensor([0.0512, 0.0540, 0.1550, 0.1080, 0.0198, 0.3688, 0.0656, 0.1121, 0.0264,
        0.0390])
[rfa agg] iter:  9, prev_obj_val: 62.77703857421875, obj_val: 52.49549102783203, abs dis: 10.281547546386719
[rfa agg] iter: 9, weight: tensor([0.0619, 0.0648, 0.1531, 0.1162, 0.0277, 0.2923, 0.0771, 0.1209, 0.0378,
        0.0483])
			Update norm = 109.55943824158875 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.4970827102661 sec.
Server Epoch:47 choose agents : [66, 77, 20, 72, 32, 75, 26, 83, 55, 13].
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 265/1402 (18.9016%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 389/1402 (27.7461%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2783, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 331/1340 (24.7015%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 584/1340 (43.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7006, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.7342, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 389/1241 (31.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.5361, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0605, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 352/735 (47.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.8710, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0644, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0770, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 348/1446 (24.0664%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 504/1446 (34.8548%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2301, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 401/1953 (20.5325%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 755/1953 (38.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9940, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 236/1071 (22.0355%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 458/1071 (42.7638%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9505, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 290/1645 (17.6292%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 595/1645 (36.1702%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0377, Accuracy: 110/10000 (1.1000%)
time spent on training: 221.62654948234558
[rfa agg] training data poison_ratio: 0.06499677835051547  data num: [1402, 1340, 807, 1241, 735, 776, 1446, 1953, 1071, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.020311493234536085
[rfa agg] init. name: [66, 77, 20, 72, 32, 75, 26, 83, 55, 13], weight: tensor([0.1129, 0.1079, 0.0650, 0.1000, 0.0592, 0.0625, 0.1165, 0.1573, 0.0863,
        0.1325])
[rfa agg] iter:  0, prev_obj_val: 52.463104248046875, obj_val: 54.4953498840332, abs dis: 2.032245635986328
[rfa agg] iter: 0, weight: tensor([0.1071, 0.1344, 0.0500, 0.1784, 0.0384, 0.0483, 0.0894, 0.0473, 0.2421,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 54.4953498840332, obj_val: 59.22880554199219, abs dis: 4.733455657958984
[rfa agg] iter: 1, weight: tensor([0.0910, 0.1111, 0.0526, 0.1410, 0.0397, 0.0508, 0.0773, 0.0433, 0.3355,
        0.0577])
[rfa agg] iter:  2, prev_obj_val: 59.22880554199219, obj_val: 61.90483856201172, abs dis: 2.6760330200195312
[rfa agg] iter: 2, weight: tensor([0.0772, 0.0900, 0.0685, 0.1060, 0.0497, 0.0663, 0.0677, 0.0415, 0.3797,
        0.0532])
[rfa agg] iter:  3, prev_obj_val: 61.90483856201172, obj_val: 61.8979377746582, abs dis: 0.006900787353515625
[rfa agg] iter: 3, weight: tensor([0.0801, 0.0917, 0.0891, 0.1052, 0.0629, 0.0863, 0.0711, 0.0453, 0.3112,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 61.8979377746582, obj_val: 61.89785385131836, abs dis: 8.392333984375e-05
[rfa agg] iter: 4, weight: tensor([0.0809, 0.0927, 0.0904, 0.1063, 0.0636, 0.0875, 0.0718, 0.0457, 0.3035,
        0.0576])
			Update norm = 148.46076133527674 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.1323277950287 sec.
Server Epoch:48 choose agents : [42, 90, 83, 4, 11, 19, 73, 61, 96, 39].
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 363/1372 (26.4577%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 544/1372 (39.6501%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2761, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4724, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 820/1953 (41.9867%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5078, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0609, Accuracy: 329/901 (36.5150%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9471, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0522, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 453/712 (63.6236%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.7241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 411/1036 (39.6718%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 682/1036 (65.8301%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4583, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0664, Accuracy: 162/938 (17.2708%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0578, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1190, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3109, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 490/1013 (48.3712%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.6222, Accuracy: 59/10000 (0.5900%)
time spent on training: 183.02710962295532
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 677, 1953, 901, 712, 1036, 938, 85, 311, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 90, 83, 4, 11, 19, 73, 61, 96, 39], weight: tensor([0.1525, 0.0752, 0.2170, 0.1001, 0.0791, 0.1151, 0.1042, 0.0094, 0.0346,
        0.1126])
[rfa agg] iter:  0, prev_obj_val: 52.82807159423828, obj_val: 56.936946868896484, abs dis: 4.108875274658203
[rfa agg] iter: 0, weight: tensor([0.0649, 0.0322, 0.0355, 0.1378, 0.0413, 0.2678, 0.1419, 0.0015, 0.0071,
        0.2699])
[rfa agg] iter:  1, prev_obj_val: 56.936946868896484, obj_val: 59.211036682128906, abs dis: 2.274089813232422
[rfa agg] iter: 1, weight: tensor([0.0495, 0.0518, 0.0323, 0.2532, 0.0743, 0.1086, 0.2553, 0.0018, 0.0088,
        0.1645])
[rfa agg] iter:  2, prev_obj_val: 59.211036682128906, obj_val: 61.75174331665039, abs dis: 2.5407066345214844
[rfa agg] iter: 2, weight: tensor([0.0540, 0.0698, 0.0364, 0.2301, 0.1060, 0.1053, 0.2379, 0.0022, 0.0108,
        0.1476])
[rfa agg] iter:  3, prev_obj_val: 61.75174331665039, obj_val: 61.7467155456543, abs dis: 0.00502777099609375
[rfa agg] iter: 3, weight: tensor([0.0578, 0.0944, 0.0402, 0.1939, 0.1549, 0.1037, 0.2013, 0.0026, 0.0130,
        0.1382])
[rfa agg] iter:  4, prev_obj_val: 61.7467155456543, obj_val: 64.37945556640625, abs dis: 2.632740020751953
[rfa agg] iter: 4, weight: tensor([0.0578, 0.0947, 0.0402, 0.1928, 0.1569, 0.1037, 0.2000, 0.0026, 0.0130,
        0.1383])
[rfa agg] iter:  5, prev_obj_val: 64.37945556640625, obj_val: 67.08657836914062, abs dis: 2.707122802734375
[rfa agg] iter: 5, weight: tensor([0.0570, 0.1212, 0.0408, 0.1582, 0.2238, 0.0953, 0.1643, 0.0028, 0.0144,
        0.1222])
[rfa agg] iter:  6, prev_obj_val: 67.08657836914062, obj_val: 67.07328796386719, abs dis: 0.0132904052734375
[rfa agg] iter: 6, weight: tensor([0.0506, 0.1471, 0.0372, 0.1211, 0.3224, 0.0797, 0.1258, 0.0028, 0.0144,
        0.0991])
[rfa agg] iter:  7, prev_obj_val: 67.07328796386719, obj_val: 64.38510131835938, abs dis: 2.6881866455078125
[rfa agg] iter: 7, weight: tensor([0.0493, 0.1438, 0.0362, 0.1174, 0.3409, 0.0775, 0.1219, 0.0027, 0.0140,
        0.0964])
[rfa agg] iter:  8, prev_obj_val: 64.38510131835938, obj_val: 67.08412170410156, abs dis: 2.6990203857421875
[rfa agg] iter: 8, weight: tensor([0.0563, 0.1205, 0.0403, 0.1545, 0.2369, 0.0939, 0.1602, 0.0028, 0.0142,
        0.1205])
[rfa agg] iter:  9, prev_obj_val: 67.08412170410156, obj_val: 67.07322692871094, abs dis: 0.010894775390625
[rfa agg] iter: 9, weight: tensor([0.0505, 0.1466, 0.0371, 0.1206, 0.3246, 0.0794, 0.1253, 0.0028, 0.0143,
        0.0988])
			Update norm = 118.19225929074204 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3011, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.72518396377563 sec.
Server Epoch:49 choose agents : [20, 2, 31, 41, 84, 98, 18, 69, 11, 22].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 355/807 (43.9901%)
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 408/807 (50.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.0013, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0645, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8202, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.9311, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0595, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0310, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.7126, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 422/1190 (35.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.1908, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0820, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.5062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 116/530 (21.8868%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.2564, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 283/590 (47.9661%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0343, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.5802, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   2, Avg loss: 0.0260, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.6494, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 544/1470 (37.0068%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 824/1470 (56.0544%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2662, Accuracy: 83/10000 (0.8300%)
time spent on training: 172.64395093917847
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 605, 460, 719, 1190, 373, 530, 590, 712, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 2, 31, 41, 84, 98, 18, 69, 11, 22], weight: tensor([0.1082, 0.0811, 0.0617, 0.0964, 0.1596, 0.0500, 0.0711, 0.0791, 0.0955,
        0.1972])
[rfa agg] iter:  0, prev_obj_val: 41.914825439453125, obj_val: 47.193904876708984, abs dis: 5.279079437255859
[rfa agg] iter: 0, weight: tensor([0.1646, 0.0738, 0.0291, 0.2510, 0.0432, 0.0158, 0.0442, 0.0724, 0.2716,
        0.0342])
[rfa agg] iter:  1, prev_obj_val: 47.193904876708984, obj_val: 52.36595153808594, abs dis: 5.172046661376953
[rfa agg] iter: 1, weight: tensor([0.0688, 0.2507, 0.0569, 0.0902, 0.0343, 0.0237, 0.1146, 0.2414, 0.0899,
        0.0295])
[rfa agg] iter:  2, prev_obj_val: 52.36595153808594, obj_val: 59.13346862792969, abs dis: 6.76751708984375
[rfa agg] iter: 2, weight: tensor([0.0583, 0.1598, 0.1154, 0.0687, 0.0347, 0.0352, 0.2724, 0.1566, 0.0680,
        0.0308])
[rfa agg] iter:  3, prev_obj_val: 59.13346862792969, obj_val: 59.097721099853516, abs dis: 0.035747528076171875
[rfa agg] iter: 3, weight: tensor([0.0573, 0.1047, 0.2996, 0.0636, 0.0386, 0.0623, 0.1732, 0.1026, 0.0629,
        0.0351])
[rfa agg] iter:  4, prev_obj_val: 59.097721099853516, obj_val: 66.89393615722656, abs dis: 7.796215057373047
[rfa agg] iter: 4, weight: tensor([0.0529, 0.0961, 0.3561, 0.0588, 0.0357, 0.0580, 0.1570, 0.0947, 0.0582,
        0.0325])
[rfa agg] iter:  5, prev_obj_val: 66.89393615722656, obj_val: 66.88475799560547, abs dis: 0.00917816162109375
[rfa agg] iter: 5, weight: tensor([0.0672, 0.0996, 0.2160, 0.0718, 0.0498, 0.1511, 0.1294, 0.0977, 0.0711,
        0.0462])
[rfa agg] iter:  6, prev_obj_val: 66.88475799560547, obj_val: 62.923187255859375, abs dis: 3.9615707397460938
[rfa agg] iter: 6, weight: tensor([0.0674, 0.1001, 0.2113, 0.0720, 0.0499, 0.1540, 0.1296, 0.0979, 0.0713,
        0.0464])
[rfa agg] iter:  7, prev_obj_val: 62.923187255859375, obj_val: 66.88740539550781, abs dis: 3.9642181396484375
[rfa agg] iter: 7, weight: tensor([0.0616, 0.0999, 0.2864, 0.0670, 0.0437, 0.0955, 0.1415, 0.0979, 0.0663,
        0.0401])
[rfa agg] iter:  8, prev_obj_val: 66.88740539550781, obj_val: 66.88475036621094, abs dis: 0.002655029296875
[rfa agg] iter: 8, weight: tensor([0.0674, 0.0999, 0.2136, 0.0720, 0.0499, 0.1521, 0.1296, 0.0979, 0.0713,
        0.0463])
[rfa agg] iter:  9, prev_obj_val: 66.88475036621094, obj_val: 62.923194885253906, abs dis: 3.9615554809570312
[rfa agg] iter: 9, weight: tensor([0.0674, 0.1001, 0.2112, 0.0720, 0.0499, 0.1540, 0.1297, 0.0979, 0.0713,
        0.0464])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3028, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3226, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.71686577796936 sec.
Server Epoch:50 choose agents : [40, 49, 82, 52, 64, 6, 61, 8, 71, 42].
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 378/1573 (24.0305%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 583/1573 (37.0629%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3828, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0807, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5868, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7939, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 152/953 (15.9496%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4752, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 651/1956 (33.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1456, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1157, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3137, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 244/1513 (16.1269%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 445/1513 (29.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4378, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 147/818 (17.9707%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.1340, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 547/1372 (39.8688%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1525, Accuracy: 82/10000 (0.8200%)
time spent on training: 190.12400102615356
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 440, 500, 636, 953, 1956, 85, 1513, 818, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 49, 82, 52, 64, 6, 61, 8, 71, 42], weight: tensor([0.1598, 0.0447, 0.0508, 0.0646, 0.0968, 0.1987, 0.0086, 0.1537, 0.0831,
        0.1393])
[rfa agg] iter:  0, prev_obj_val: 66.71000671386719, obj_val: 69.36588287353516, abs dis: 2.6558761596679688
[rfa agg] iter: 0, weight: tensor([0.1473, 0.0235, 0.0292, 0.0459, 0.1645, 0.0961, 0.0031, 0.1666, 0.0907,
        0.2329])
[rfa agg] iter:  1, prev_obj_val: 69.36588287353516, obj_val: 70.71212005615234, abs dis: 1.3462371826171875
[rfa agg] iter: 1, weight: tensor([0.1287, 0.0258, 0.0325, 0.0522, 0.2289, 0.0895, 0.0034, 0.1424, 0.1110,
        0.1857])
[rfa agg] iter:  2, prev_obj_val: 70.71212005615234, obj_val: 69.36328887939453, abs dis: 1.3488311767578125
[rfa agg] iter: 2, weight: tensor([0.1165, 0.0262, 0.0331, 0.0540, 0.2738, 0.0833, 0.0033, 0.1278, 0.1203,
        0.1616])
[rfa agg] iter:  3, prev_obj_val: 69.36328887939453, obj_val: 70.71204376220703, abs dis: 1.3487548828125
[rfa agg] iter: 3, weight: tensor([0.1284, 0.0258, 0.0324, 0.0521, 0.2305, 0.0893, 0.0033, 0.1421, 0.1110,
        0.1850])
[rfa agg] iter:  4, prev_obj_val: 70.71204376220703, obj_val: 69.36328887939453, abs dis: 1.3487548828125
[rfa agg] iter: 4, weight: tensor([0.1165, 0.0262, 0.0331, 0.0540, 0.2739, 0.0833, 0.0033, 0.1278, 0.1203,
        0.1616])
[rfa agg] iter:  5, prev_obj_val: 69.36328887939453, obj_val: 70.71204376220703, abs dis: 1.3487548828125
[rfa agg] iter: 5, weight: tensor([0.1284, 0.0258, 0.0324, 0.0521, 0.2305, 0.0893, 0.0033, 0.1421, 0.1110,
        0.1850])
[rfa agg] iter:  6, prev_obj_val: 70.71204376220703, obj_val: 69.36328887939453, abs dis: 1.3487548828125
[rfa agg] iter: 6, weight: tensor([0.1165, 0.0262, 0.0331, 0.0540, 0.2739, 0.0833, 0.0033, 0.1278, 0.1203,
        0.1616])
[rfa agg] iter:  7, prev_obj_val: 69.36328887939453, obj_val: 70.71204376220703, abs dis: 1.3487548828125
[rfa agg] iter: 7, weight: tensor([0.1284, 0.0258, 0.0324, 0.0521, 0.2305, 0.0893, 0.0033, 0.1421, 0.1110,
        0.1850])
[rfa agg] iter:  8, prev_obj_val: 70.71204376220703, obj_val: 69.36328887939453, abs dis: 1.3487548828125
[rfa agg] iter: 8, weight: tensor([0.1165, 0.0262, 0.0331, 0.0540, 0.2739, 0.0833, 0.0033, 0.1278, 0.1203,
        0.1616])
[rfa agg] iter:  9, prev_obj_val: 69.36328887939453, obj_val: 70.71204376220703, abs dis: 1.3487548828125
[rfa agg] iter: 9, weight: tensor([0.1284, 0.0258, 0.0324, 0.0521, 0.2305, 0.0893, 0.0033, 0.1421, 0.1110,
        0.1850])
			Update norm = 156.20134242380888 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3028, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3226, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 291.3358995914459 sec.
Server Epoch:51 choose agents : [5, 57, 22, 34, 60, 42, 12, 72, 7, 93].
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0516, Accuracy: 358/1628 (21.9902%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 767/1628 (47.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.9589, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0565, Accuracy: 296/1154 (25.6499%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8728, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 494/1470 (33.6054%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 810/1470 (55.1020%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1845, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 379/1427 (26.5592%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 565/1427 (39.5936%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0620, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0502, Accuracy: 535/2227 (24.0233%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4614, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 336/1372 (24.4898%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9021, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0880, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.5397, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 269/1241 (21.6761%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4600, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 343/891 (38.4961%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2807, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 408/1742 (23.4214%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 725/1742 (41.6188%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.8903, Accuracy: 89/10000 (0.8900%)
time spent on training: 232.94555974006653
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1154, 1470, 1427, 2227, 1372, 338, 1241, 891, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 57, 22, 34, 60, 42, 12, 72, 7, 93], weight: tensor([0.1207, 0.0855, 0.1090, 0.1058, 0.1651, 0.1017, 0.0251, 0.0920, 0.0660,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 46.69867706298828, obj_val: 52.275001525878906, abs dis: 5.576324462890625
[rfa agg] iter: 0, weight: tensor([0.0700, 0.0646, 0.1969, 0.1904, 0.0302, 0.2744, 0.0037, 0.0994, 0.0196,
        0.0508])
[rfa agg] iter:  1, prev_obj_val: 52.275001525878906, obj_val: 57.2113151550293, abs dis: 4.936313629150391
[rfa agg] iter: 1, weight: tensor([0.0637, 0.1387, 0.1223, 0.1195, 0.0335, 0.1801, 0.0051, 0.2571, 0.0297,
        0.0504])
[rfa agg] iter:  2, prev_obj_val: 57.2113151550293, obj_val: 54.52018356323242, abs dis: 2.691131591796875
[rfa agg] iter: 2, weight: tensor([0.0543, 0.2370, 0.0895, 0.0871, 0.0315, 0.1147, 0.0055, 0.3008, 0.0350,
        0.0447])
[rfa agg] iter:  3, prev_obj_val: 54.52018356323242, obj_val: 60.20067596435547, abs dis: 5.680492401123047
[rfa agg] iter: 3, weight: tensor([0.0539, 0.1779, 0.0945, 0.0919, 0.0299, 0.1265, 0.0049, 0.3476, 0.0296,
        0.0436])
[rfa agg] iter:  4, prev_obj_val: 60.20067596435547, obj_val: 63.43393325805664, abs dis: 3.233257293701172
[rfa agg] iter: 4, weight: tensor([0.0548, 0.2998, 0.0853, 0.0829, 0.0331, 0.1045, 0.0062, 0.2461, 0.0416,
        0.0458])
[rfa agg] iter:  5, prev_obj_val: 63.43393325805664, obj_val: 66.89878845214844, abs dis: 3.464855194091797
[rfa agg] iter: 5, weight: tensor([0.0573, 0.3348, 0.0853, 0.0829, 0.0359, 0.1012, 0.0072, 0.1954, 0.0515,
        0.0486])
[rfa agg] iter:  6, prev_obj_val: 66.89878845214844, obj_val: 57.199806213378906, abs dis: 9.698982238769531
[rfa agg] iter: 6, weight: tensor([0.0638, 0.2954, 0.0915, 0.0889, 0.0414, 0.1059, 0.0089, 0.1811, 0.0683,
        0.0548])
[rfa agg] iter:  7, prev_obj_val: 57.199806213378906, obj_val: 63.44106674194336, abs dis: 6.241260528564453
[rfa agg] iter: 7, weight: tensor([0.0535, 0.2726, 0.0880, 0.0855, 0.0310, 0.1119, 0.0054, 0.2735, 0.0345,
        0.0440])
[rfa agg] iter:  8, prev_obj_val: 63.44106674194336, obj_val: 63.42905044555664, abs dis: 0.01201629638671875
[rfa agg] iter: 8, weight: tensor([0.0577, 0.3276, 0.0860, 0.0836, 0.0362, 0.1021, 0.0072, 0.1987, 0.0519,
        0.0490])
[rfa agg] iter:  9, prev_obj_val: 63.42905044555664, obj_val: 63.42856216430664, abs dis: 0.00048828125
[rfa agg] iter: 9, weight: tensor([0.0568, 0.3431, 0.0846, 0.0822, 0.0356, 0.1004, 0.0071, 0.1910, 0.0511,
        0.0482])
			Update norm = 169.5005991877315 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3028, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3226, Accuracy: 0/9950 (0.0000%)
saving model
Done in 332.7350058555603 sec.
Server Epoch:52 choose agents : [90, 34, 84, 61, 58, 18, 42, 1, 32, 31].
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 430/677 (63.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6312, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 434/1427 (30.4135%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 559/1427 (39.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.9719, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.1136, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3136, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0353, Accuracy: 383/803 (47.6961%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.1577, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 114/530 (21.5094%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3491, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 341/1372 (24.8542%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 517/1372 (37.6822%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9172, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 289/928 (31.1422%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 532/928 (57.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9125, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 376/735 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8894, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0777, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8585, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.84010481834412
[rfa agg] training data poison_ratio: 0.0  data num: [677, 1427, 1190, 85, 803, 530, 1372, 928, 735, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 34, 84, 61, 58, 18, 42, 1, 32, 31], weight: tensor([0.0825, 0.1739, 0.1450, 0.0104, 0.0978, 0.0646, 0.1672, 0.1131, 0.0896,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 46.171791076660156, obj_val: 51.727760314941406, abs dis: 5.55596923828125
[rfa agg] iter: 0, weight: tensor([0.0829, 0.0593, 0.0878, 0.0026, 0.2416, 0.0395, 0.0641, 0.2626, 0.1311,
        0.0286])
[rfa agg] iter:  1, prev_obj_val: 51.727760314941406, obj_val: 62.89742660522461, abs dis: 11.169666290283203
[rfa agg] iter: 1, weight: tensor([0.1676, 0.0381, 0.0496, 0.0024, 0.1989, 0.0507, 0.0403, 0.0888, 0.3302,
        0.0333])
[rfa agg] iter:  2, prev_obj_val: 62.89742660522461, obj_val: 56.612060546875, abs dis: 6.285366058349609
[rfa agg] iter: 2, weight: tensor([0.2418, 0.0453, 0.0544, 0.0042, 0.1083, 0.1855, 0.0472, 0.0757, 0.1480,
        0.0895])
[rfa agg] iter:  3, prev_obj_val: 56.612060546875, obj_val: 66.18997192382812, abs dis: 9.577911376953125
[rfa agg] iter: 3, weight: tensor([0.4078, 0.0344, 0.0428, 0.0027, 0.1094, 0.0747, 0.0361, 0.0658, 0.1827,
        0.0436])
[rfa agg] iter:  4, prev_obj_val: 66.18997192382812, obj_val: 69.57625579833984, abs dis: 3.3862838745117188
[rfa agg] iter: 4, weight: tensor([0.1795, 0.0433, 0.0512, 0.0044, 0.0923, 0.2841, 0.0450, 0.0685, 0.1174,
        0.1143])
[rfa agg] iter:  5, prev_obj_val: 69.57625579833984, obj_val: 69.55342864990234, abs dis: 0.0228271484375
[rfa agg] iter: 5, weight: tensor([0.1143, 0.0354, 0.0412, 0.0040, 0.0687, 0.4247, 0.0367, 0.0533, 0.0836,
        0.1380])
[rfa agg] iter:  6, prev_obj_val: 69.55342864990234, obj_val: 69.54998016357422, abs dis: 0.003448486328125
[rfa agg] iter: 6, weight: tensor([0.1014, 0.0316, 0.0368, 0.0036, 0.0612, 0.4856, 0.0327, 0.0475, 0.0744,
        0.1252])
[rfa agg] iter:  7, prev_obj_val: 69.54998016357422, obj_val: 69.54918670654297, abs dis: 0.00079345703125
[rfa agg] iter: 7, weight: tensor([0.0957, 0.0299, 0.0348, 0.0034, 0.0578, 0.5142, 0.0309, 0.0449, 0.0703,
        0.1182])
[rfa agg] iter:  8, prev_obj_val: 69.54918670654297, obj_val: 69.5489730834961, abs dis: 0.000213623046875
[rfa agg] iter: 8, weight: tensor([0.0928, 0.0290, 0.0338, 0.0033, 0.0561, 0.5285, 0.0301, 0.0436, 0.0682,
        0.1146])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.0009138584137 sec.
Server Epoch:53 choose agents : [44, 27, 62, 20, 28, 49, 40, 8, 16, 22].
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 391/1750 (22.3429%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 682/1750 (38.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8384, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 417/1587 (26.2760%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 591/1587 (37.2401%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5939, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0697, Accuracy: 142/568 (25.0000%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.9578, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 408/807 (50.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.1130, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 400/1581 (25.3004%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 598/1581 (37.8242%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9888, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.6557, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 343/1573 (21.8055%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 532/1573 (33.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8256, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0609, Accuracy: 232/1513 (15.3338%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7066, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.9169, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 545/1470 (37.0748%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 835/1470 (56.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1036, Accuracy: 88/10000 (0.8800%)
time spent on training: 223.31614923477173
[rfa agg] training data poison_ratio: 0.06726681670417604  data num: [1750, 1587, 568, 807, 1581, 440, 1573, 1513, 708, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.021020880220055015
[rfa agg] init. name: [44, 27, 62, 20, 28, 49, 40, 8, 16, 22], weight: tensor([0.1459, 0.1323, 0.0473, 0.0673, 0.1318, 0.0367, 0.1311, 0.1261, 0.0590,
        0.1225])
[rfa agg] iter:  0, prev_obj_val: 56.58660888671875, obj_val: 54.052574157714844, abs dis: 2.5340347290039062
[rfa agg] iter: 0, weight: tensor([0.0979, 0.1362, 0.0258, 0.0588, 0.1353, 0.0168, 0.1350, 0.1565, 0.0448,
        0.1929])
[rfa agg] iter:  1, prev_obj_val: 54.052574157714844, obj_val: 54.05229568481445, abs dis: 0.000278472900390625
[rfa agg] iter: 1, weight: tensor([0.0956, 0.1376, 0.0227, 0.0503, 0.1366, 0.0149, 0.1364, 0.1612, 0.0387,
        0.2059])
			Update norm = 181.97467200135299 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.5505721569061 sec.
Server Epoch:54 choose agents : [38, 69, 16, 89, 47, 84, 8, 7, 93, 54].
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 441/1131 (38.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5452, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0547, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0380, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8313, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   1, Avg loss: 0.0617, Accuracy: 322/896 (35.9375%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 421/896 (46.9866%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.4724, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1209, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1071, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3248, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 312/1190 (26.2185%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 473/1190 (39.7479%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2154, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 504/1513 (33.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2061, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 343/891 (38.4961%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 467/891 (52.4130%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2713, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 391/1742 (22.4455%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 704/1742 (40.4133%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5578, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0029, Accuracy: 63/10000 (0.6300%)
time spent on training: 192.73042821884155
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 590, 708, 896, 134, 1190, 1513, 891, 1742, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 69, 16, 89, 47, 84, 8, 7, 93, 54], weight: tensor([0.1140, 0.0594, 0.0713, 0.0903, 0.0135, 0.1199, 0.1524, 0.0898, 0.1755,
        0.1139])
[rfa agg] iter:  0, prev_obj_val: 45.75828170776367, obj_val: 48.58985137939453, abs dis: 2.8315696716308594
[rfa agg] iter: 0, weight: tensor([0.2505, 0.0247, 0.0412, 0.0837, 0.0028, 0.1594, 0.0632, 0.0846, 0.0465,
        0.2434])
[rfa agg] iter:  1, prev_obj_val: 48.58985137939453, obj_val: 51.790897369384766, abs dis: 3.2010459899902344
[rfa agg] iter: 1, weight: tensor([0.1847, 0.0342, 0.0605, 0.1410, 0.0036, 0.1329, 0.0657, 0.1441, 0.0506,
        0.1827])
[rfa agg] iter:  2, prev_obj_val: 51.790897369384766, obj_val: 55.63758087158203, abs dis: 3.8466835021972656
[rfa agg] iter: 2, weight: tensor([0.1193, 0.0383, 0.0745, 0.2189, 0.0036, 0.0951, 0.0548, 0.2333, 0.0438,
        0.1185])
[rfa agg] iter:  3, prev_obj_val: 55.63758087158203, obj_val: 64.4223861694336, abs dis: 8.784805297851562
[rfa agg] iter: 3, weight: tensor([0.0693, 0.0365, 0.0817, 0.2791, 0.0030, 0.0587, 0.0378, 0.3339, 0.0311,
        0.0689])
[rfa agg] iter:  4, prev_obj_val: 64.4223861694336, obj_val: 61.22916030883789, abs dis: 3.193225860595703
[rfa agg] iter: 4, weight: tensor([0.0710, 0.0795, 0.2448, 0.1871, 0.0049, 0.0634, 0.0459, 0.1934, 0.0393,
        0.0707])
[rfa agg] iter:  5, prev_obj_val: 61.22916030883789, obj_val: 58.25945281982422, abs dis: 2.969707489013672
[rfa agg] iter: 5, weight: tensor([0.0719, 0.0623, 0.1889, 0.2208, 0.0043, 0.0634, 0.0443, 0.2347, 0.0375,
        0.0718])
[rfa agg] iter:  6, prev_obj_val: 58.25945281982422, obj_val: 64.39798736572266, abs dis: 6.1385345458984375
[rfa agg] iter: 6, weight: tensor([0.0689, 0.0464, 0.1181, 0.2637, 0.0035, 0.0597, 0.0402, 0.2974, 0.0335,
        0.0686])
[rfa agg] iter:  7, prev_obj_val: 64.39798736572266, obj_val: 58.29240417480469, abs dis: 6.105583190917969
[rfa agg] iter: 7, weight: tensor([0.0705, 0.0791, 0.2524, 0.1850, 0.0048, 0.0629, 0.0455, 0.1907, 0.0390,
        0.0702])
[rfa agg] iter:  8, prev_obj_val: 58.29240417480469, obj_val: 64.39417266845703, abs dis: 6.101768493652344
[rfa agg] iter: 8, weight: tensor([0.0703, 0.0474, 0.1228, 0.2586, 0.0036, 0.0609, 0.0410, 0.2912, 0.0342,
        0.0701])
[rfa agg] iter:  9, prev_obj_val: 64.39417266845703, obj_val: 58.293006896972656, abs dis: 6.101165771484375
[rfa agg] iter: 9, weight: tensor([0.0704, 0.0790, 0.2536, 0.1845, 0.0048, 0.0628, 0.0455, 0.1902, 0.0389,
        0.0701])
			Update norm = 124.93789472799075 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.2867662906647 sec.
Server Epoch:55 choose agents : [88, 77, 16, 55, 79, 13, 61, 12, 27, 98].
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   1, Avg loss: 0.0734, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.1304, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 584/1340 (43.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1693, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9281, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9370, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   1, Avg loss: 0.1041, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   2, Avg loss: 0.0827, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3406, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 602/1645 (36.5957%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0003, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1275, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1196, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3160, Accuracy: 36/10000 (0.3600%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0493, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 444/1587 (27.9773%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 626/1587 (39.4455%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.2000, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5691, Accuracy: 50/10000 (0.5000%)
time spent on training: 177.77287554740906
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1340, 708, 1071, 197, 1645, 85, 338, 1587, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 77, 16, 55, 79, 13, 61, 12, 27, 98], weight: tensor([0.0759, 0.1686, 0.0891, 0.1348, 0.0248, 0.2070, 0.0107, 0.0425, 0.1997,
        0.0469])
[rfa agg] iter:  0, prev_obj_val: 61.71514129638672, obj_val: 65.087158203125, abs dis: 3.3720169067382812
[rfa agg] iter: 0, weight: tensor([0.0444, 0.1405, 0.0748, 0.5251, 0.0075, 0.0830, 0.0028, 0.0154, 0.0894,
        0.0170])
[rfa agg] iter:  1, prev_obj_val: 65.087158203125, obj_val: 63.25613021850586, abs dis: 1.8310279846191406
[rfa agg] iter: 1, weight: tensor([0.0657, 0.1459, 0.1193, 0.4144, 0.0103, 0.0947, 0.0038, 0.0215, 0.1008,
        0.0237])
[rfa agg] iter:  2, prev_obj_val: 63.25613021850586, obj_val: 63.249107360839844, abs dis: 0.007022857666015625
[rfa agg] iter: 2, weight: tensor([0.0524, 0.1389, 0.0915, 0.4898, 0.0086, 0.0862, 0.0032, 0.0177, 0.0922,
        0.0195])
[rfa agg] iter:  3, prev_obj_val: 63.249107360839844, obj_val: 63.24904251098633, abs dis: 6.4849853515625e-05
[rfa agg] iter: 3, weight: tensor([0.0516, 0.1368, 0.0899, 0.4978, 0.0084, 0.0849, 0.0031, 0.0174, 0.0908,
        0.0192])
			Update norm = 146.74649963883294 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.9380340576172 sec.
Server Epoch:56 choose agents : [41, 84, 47, 20, 89, 72, 45, 32, 26, 7].
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0582, Accuracy: 340/719 (47.2879%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.6235, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 436/1190 (36.6387%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2071, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1201, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1090, Accuracy: 12/134 (8.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3283, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   2, Avg loss: 0.0327, Accuracy: 408/807 (50.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.6953, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.3661, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 236/1241 (19.0169%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4340, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0683, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.9762, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 207/735 (28.1633%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1323, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 355/1446 (24.5505%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 502/1446 (34.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3229, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2889, Accuracy: 51/10000 (0.5100%)
time spent on training: 204.29897618293762
[rfa agg] training data poison_ratio: 0.09246104491292392  data num: [719, 1190, 134, 807, 896, 1241, 669, 735, 1446, 891]
[rfa agg] considering poison per batch poison_fraction: 0.028894076535288728
[rfa agg] init. name: [41, 84, 47, 20, 89, 72, 45, 32, 26, 7], weight: tensor([0.0824, 0.1363, 0.0154, 0.0925, 0.1027, 0.1422, 0.0766, 0.0842, 0.1657,
        0.1021])
[rfa agg] iter:  0, prev_obj_val: 37.58510208129883, obj_val: 46.422996520996094, abs dis: 8.837894439697266
[rfa agg] iter: 0, weight: tensor([0.0996, 0.0488, 0.0029, 0.1819, 0.2109, 0.0434, 0.0595, 0.1025, 0.0347,
        0.2158])
[rfa agg] iter:  1, prev_obj_val: 46.422996520996094, obj_val: 46.31435012817383, abs dis: 0.10864639282226562
[rfa agg] iter: 1, weight: tensor([0.2095, 0.0379, 0.0037, 0.1144, 0.0833, 0.0351, 0.1893, 0.2138, 0.0302,
        0.0828])
[rfa agg] iter:  2, prev_obj_val: 46.31435012817383, obj_val: 46.31386947631836, abs dis: 0.00048065185546875
[rfa agg] iter: 2, weight: tensor([0.2148, 0.0357, 0.0035, 0.1072, 0.0775, 0.0330, 0.2031, 0.2197, 0.0285,
        0.0769])
			Update norm = 107.57764728470548 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.85642409324646 sec.
Server Epoch:57 choose agents : [40, 56, 4, 32, 74, 75, 70, 88, 9, 35].
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 344/1573 (21.8690%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 550/1573 (34.9650%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2407, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0683, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3301, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0600, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 411/901 (45.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1730, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 195/735 (26.5306%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 352/735 (47.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5083, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 492/1552 (31.7010%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 750/1552 (48.3247%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.4276, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0654, Accuracy: 242/776 (31.1856%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2639, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 325/1418 (22.9196%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 631/1418 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5581, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   1, Avg loss: 0.0733, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.1826, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 356/1275 (27.9216%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 675/1275 (52.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.5134, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   2, Avg loss: 0.0549, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.4317, Accuracy: 48/10000 (0.4800%)
time spent on training: 211.7413992881775
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 186, 901, 735, 1552, 776, 1418, 603, 1275, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 56, 4, 32, 74, 75, 70, 88, 9, 35], weight: tensor([0.1693, 0.0200, 0.0970, 0.0791, 0.1671, 0.0835, 0.1526, 0.0649, 0.1372,
        0.0292])
[rfa agg] iter:  0, prev_obj_val: 54.609989166259766, obj_val: 56.887447357177734, abs dis: 2.2774581909179688
[rfa agg] iter: 0, weight: tensor([0.1022, 0.0069, 0.2213, 0.0763, 0.1010, 0.0998, 0.1222, 0.0449, 0.2137,
        0.0118])
[rfa agg] iter:  1, prev_obj_val: 56.887447357177734, obj_val: 63.21470260620117, abs dis: 6.3272552490234375
[rfa agg] iter: 1, weight: tensor([0.0794, 0.0065, 0.3468, 0.0828, 0.0784, 0.1145, 0.0918, 0.0456, 0.1431,
        0.0112])
[rfa agg] iter:  2, prev_obj_val: 63.21470260620117, obj_val: 63.18525695800781, abs dis: 0.029445648193359375
[rfa agg] iter: 2, weight: tensor([0.0547, 0.0064, 0.3058, 0.1336, 0.0540, 0.2360, 0.0602, 0.0569, 0.0809,
        0.0115])
[rfa agg] iter:  3, prev_obj_val: 63.18525695800781, obj_val: 65.24087524414062, abs dis: 2.0556182861328125
[rfa agg] iter: 3, weight: tensor([0.0542, 0.0064, 0.2966, 0.1337, 0.0535, 0.2483, 0.0596, 0.0565, 0.0799,
        0.0114])
[rfa agg] iter:  4, prev_obj_val: 65.24087524414062, obj_val: 70.0124740600586, abs dis: 4.771598815917969
[rfa agg] iter: 4, weight: tensor([0.0486, 0.0062, 0.1993, 0.1616, 0.0479, 0.3429, 0.0529, 0.0602, 0.0692,
        0.0113])
[rfa agg] iter:  5, prev_obj_val: 70.0124740600586, obj_val: 72.85335540771484, abs dis: 2.84088134765625
[rfa agg] iter: 5, weight: tensor([0.0391, 0.0060, 0.1084, 0.2987, 0.0386, 0.3312, 0.0419, 0.0723, 0.0526,
        0.0111])
[rfa agg] iter:  6, prev_obj_val: 72.85335540771484, obj_val: 79.46895599365234, abs dis: 6.6156005859375
[rfa agg] iter: 6, weight: tensor([0.0359, 0.0060, 0.0865, 0.4501, 0.0354, 0.2051, 0.0382, 0.0843, 0.0471,
        0.0114])
[rfa agg] iter:  7, prev_obj_val: 79.46895599365234, obj_val: 70.02169799804688, abs dis: 9.447257995605469
[rfa agg] iter: 7, weight: tensor([0.0484, 0.0098, 0.0955, 0.2973, 0.0478, 0.1603, 0.0508, 0.2100, 0.0609,
        0.0192])
[rfa agg] iter:  8, prev_obj_val: 70.02169799804688, obj_val: 76.06568908691406, abs dis: 6.0439910888671875
[rfa agg] iter: 8, weight: tensor([0.0393, 0.0060, 0.1082, 0.3286, 0.0388, 0.2997, 0.0421, 0.0734, 0.0528,
        0.0112])
[rfa agg] iter:  9, prev_obj_val: 76.06568908691406, obj_val: 70.00443267822266, abs dis: 6.061256408691406
[rfa agg] iter: 9, weight: tensor([0.0423, 0.0078, 0.0917, 0.3930, 0.0418, 0.1774, 0.0447, 0.1319, 0.0543,
        0.0150])
			Update norm = 116.15927659495172 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.331906080246 sec.
Server Epoch:58 choose agents : [34, 31, 89, 35, 74, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 396/1427 (27.7505%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 586/1427 (41.0652%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2800, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0769, Accuracy: 88/460 (19.1304%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 447/896 (49.8884%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.5359, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 39/271 (14.3911%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.4208, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 507/1552 (32.6675%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 763/1552 (49.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 11.0048, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 368/1036 (35.5212%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 650/1036 (62.7413%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.9720, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 623/1587 (39.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7215, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0779, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.4925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8250, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8420, Accuracy: 50/10000 (0.5000%)
time spent on training: 210.71475553512573
[rfa agg] training data poison_ratio: 0.0  data num: [1427, 460, 896, 271, 1552, 1036, 1587, 312, 515, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [34, 31, 89, 35, 74, 19, 27, 24, 33, 23], weight: tensor([0.1627, 0.0524, 0.1022, 0.0309, 0.1769, 0.1181, 0.1809, 0.0356, 0.0587,
        0.0815])
[rfa agg] iter:  0, prev_obj_val: 59.591121673583984, obj_val: 61.973602294921875, abs dis: 2.3824806213378906
[rfa agg] iter: 0, weight: tensor([0.0953, 0.0270, 0.1972, 0.0116, 0.0810, 0.3745, 0.0827, 0.0133, 0.0346,
        0.0828])
[rfa agg] iter:  1, prev_obj_val: 61.973602294921875, obj_val: 66.66412353515625, abs dis: 4.690521240234375
[rfa agg] iter: 1, weight: tensor([0.0817, 0.0301, 0.3417, 0.0124, 0.0713, 0.2299, 0.0729, 0.0143, 0.0394,
        0.1062])
[rfa agg] iter:  2, prev_obj_val: 66.66412353515625, obj_val: 73.3774185180664, abs dis: 6.713294982910156
[rfa agg] iter: 2, weight: tensor([0.0573, 0.0318, 0.4639, 0.0121, 0.0516, 0.1113, 0.0527, 0.0140, 0.0434,
        0.1621])
[rfa agg] iter:  3, prev_obj_val: 73.3774185180664, obj_val: 75.8933334350586, abs dis: 2.5159149169921875
[rfa agg] iter: 3, weight: tensor([0.0557, 0.0487, 0.1885, 0.0165, 0.0513, 0.0881, 0.0524, 0.0190, 0.0720,
        0.4079])
[rfa agg] iter:  4, prev_obj_val: 75.8933334350586, obj_val: 75.89096069335938, abs dis: 0.00237274169921875
[rfa agg] iter: 4, weight: tensor([0.0533, 0.0554, 0.1489, 0.0177, 0.0495, 0.0803, 0.0506, 0.0204, 0.0859,
        0.4378])
			Update norm = 107.50658591744508 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.4021553993225 sec.
Server Epoch:59 choose agents : [69, 83, 6, 40, 21, 23, 97, 75, 53, 99].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0574, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.3197, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 422/1953 (21.6078%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9986, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 404/1956 (20.6544%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 605/1956 (30.9305%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3763, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 357/1573 (22.6955%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 555/1573 (35.2829%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7694, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5479, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0625, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9012, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   1, Avg loss: 0.0513, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 494/1213 (40.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9420, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   1, Avg loss: 0.0659, Accuracy: 238/776 (30.6701%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 428/776 (55.1546%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.1360, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 263/813 (32.3493%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 446/813 (54.8585%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.5541, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 186/773 (24.0621%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2870, Accuracy: 52/10000 (0.5200%)
time spent on training: 243.51922273635864
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1953, 1956, 1573, 1949, 715, 1213, 776, 813, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 83, 6, 40, 21, 23, 97, 75, 53, 99], weight: tensor([0.0479, 0.1586, 0.1589, 0.1278, 0.1583, 0.0581, 0.0985, 0.0630, 0.0660,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 74.62468719482422, obj_val: 78.26460266113281, abs dis: 3.6399154663085938
[rfa agg] iter: 0, weight: tensor([0.0267, 0.0802, 0.0803, 0.1402, 0.0800, 0.0403, 0.4004, 0.0500, 0.0522,
        0.0498])
[rfa agg] iter:  1, prev_obj_val: 78.26460266113281, obj_val: 79.97037506103516, abs dis: 1.7057723999023438
[rfa agg] iter: 1, weight: tensor([0.0244, 0.0549, 0.0549, 0.0845, 0.0548, 0.0385, 0.5384, 0.0492, 0.0514,
        0.0490])
[rfa agg] iter:  2, prev_obj_val: 79.97037506103516, obj_val: 83.53211975097656, abs dis: 3.5617446899414062
[rfa agg] iter: 2, weight: tensor([0.0302, 0.0617, 0.0618, 0.0917, 0.0615, 0.0486, 0.4528, 0.0631, 0.0659,
        0.0627])
[rfa agg] iter:  3, prev_obj_val: 83.53211975097656, obj_val: 83.51228332519531, abs dis: 0.01983642578125
[rfa agg] iter: 3, weight: tensor([0.0419, 0.0696, 0.0696, 0.0976, 0.0694, 0.0705, 0.2925, 0.0952, 0.0992,
        0.0945])
[rfa agg] iter:  4, prev_obj_val: 83.51228332519531, obj_val: 85.31121826171875, abs dis: 1.7989349365234375
[rfa agg] iter: 4, weight: tensor([0.0421, 0.0700, 0.0700, 0.0982, 0.0698, 0.0710, 0.2873, 0.0960, 0.1001,
        0.0954])
[rfa agg] iter:  5, prev_obj_val: 85.31121826171875, obj_val: 87.11904907226562, abs dis: 1.807830810546875
[rfa agg] iter: 5, weight: tensor([0.0460, 0.0686, 0.0687, 0.0939, 0.0684, 0.0799, 0.2381, 0.1109, 0.1154,
        0.1101])
[rfa agg] iter:  6, prev_obj_val: 87.11904907226562, obj_val: 83.51930236816406, abs dis: 3.5997467041015625
[rfa agg] iter: 6, weight: tensor([0.0490, 0.0652, 0.0653, 0.0873, 0.0650, 0.0881, 0.1967, 0.1266, 0.1313,
        0.1256])
[rfa agg] iter:  7, prev_obj_val: 83.51930236816406, obj_val: 85.31099700927734, abs dis: 1.7916946411132812
[rfa agg] iter: 7, weight: tensor([0.0423, 0.0702, 0.0703, 0.0986, 0.0700, 0.0714, 0.2838, 0.0966, 0.1007,
        0.0960])
[rfa agg] iter:  8, prev_obj_val: 85.31099700927734, obj_val: 87.11903381347656, abs dis: 1.8080368041992188
[rfa agg] iter: 8, weight: tensor([0.0460, 0.0686, 0.0687, 0.0939, 0.0684, 0.0799, 0.2380, 0.1109, 0.1154,
        0.1101])
[rfa agg] iter:  9, prev_obj_val: 87.11903381347656, obj_val: 83.51930236816406, abs dis: 3.5997314453125
[rfa agg] iter: 9, weight: tensor([0.0490, 0.0652, 0.0653, 0.0873, 0.0650, 0.0881, 0.1967, 0.1266, 0.1313,
        0.1256])
			Update norm = 155.439152333397 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.84477257728577 sec.
Server Epoch:60 choose agents : [51, 98, 53, 74, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 229/1049 (21.8303%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 519/1049 (49.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5611, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 32/373 (8.5791%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5565, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0509, Accuracy: 277/813 (34.0713%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 437/813 (53.7515%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8775, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 492/1552 (31.7010%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 738/1552 (47.5515%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.3632, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 366/1372 (26.6764%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 541/1372 (39.4315%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9162, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1175, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3162, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0883, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0539, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 468/1130 (41.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.4039, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 332/1418 (23.4133%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 624/1418 (44.0056%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0390, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0527, Accuracy: 361/712 (50.7022%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 418/712 (58.7079%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.6910, Accuracy: 50/10000 (0.5000%)
time spent on training: 218.23578310012817
[rfa agg] training data poison_ratio: 0.0  data num: [1049, 373, 813, 1552, 1372, 85, 338, 1130, 1418, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 98, 53, 74, 42, 61, 12, 54, 70, 11], weight: tensor([0.1186, 0.0422, 0.0919, 0.1755, 0.1552, 0.0096, 0.0382, 0.1278, 0.1604,
        0.0805])
[rfa agg] iter:  0, prev_obj_val: 50.579463958740234, obj_val: 54.599422454833984, abs dis: 4.01995849609375
[rfa agg] iter: 0, weight: tensor([0.3218, 0.0154, 0.1096, 0.0714, 0.0942, 0.0025, 0.0140, 0.2148, 0.0836,
        0.0728])
[rfa agg] iter:  1, prev_obj_val: 54.599422454833984, obj_val: 54.5843620300293, abs dis: 0.0150604248046875
[rfa agg] iter: 1, weight: tensor([0.2380, 0.0199, 0.1825, 0.0745, 0.0936, 0.0031, 0.0180, 0.1752, 0.0848,
        0.1104])
[rfa agg] iter:  2, prev_obj_val: 54.5843620300293, obj_val: 56.68950271606445, abs dis: 2.1051406860351562
[rfa agg] iter: 2, weight: tensor([0.2346, 0.0199, 0.1853, 0.0745, 0.0937, 0.0031, 0.0180, 0.1750, 0.0849,
        0.1111])
[rfa agg] iter:  3, prev_obj_val: 56.68950271606445, obj_val: 56.68448257446289, abs dis: 0.0050201416015625
[rfa agg] iter: 3, weight: tensor([0.1935, 0.0211, 0.2389, 0.0713, 0.0880, 0.0032, 0.0191, 0.1522, 0.0803,
        0.1323])
			Update norm = 133.57324769578676 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 316.5205354690552 sec.
Server Epoch:61 choose agents : [84, 20, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.9709, Accuracy: 78/10000 (0.7800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 436/807 (54.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.0689, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 229/1049 (21.8303%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 518/1049 (49.3804%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4900, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6750, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0313, Accuracy: 478/1131 (42.2635%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6208, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 433/1956 (22.1370%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 673/1956 (34.4070%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2221, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 260/1071 (24.2764%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 520/1071 (48.5528%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0819, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 264/813 (32.4723%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 465/813 (57.1956%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.8837, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.5593, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0295, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.2459, Accuracy: 50/10000 (0.5000%)
time spent on training: 241.08493876457214
[rfa agg] training data poison_ratio: 0.08375713544369487  data num: [1190, 807, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[rfa agg] considering poison per batch poison_fraction: 0.02617410482615465
[rfa agg] init. name: [84, 20, 51, 25, 38, 6, 55, 53, 12, 69], weight: tensor([0.1235, 0.0838, 0.1089, 0.0716, 0.1174, 0.2030, 0.1112, 0.0844, 0.0351,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 50.043670654296875, obj_val: 55.604095458984375, abs dis: 5.5604248046875
[rfa agg] iter: 0, weight: tensor([0.1110, 0.0760, 0.2324, 0.0401, 0.1529, 0.0382, 0.2329, 0.0779, 0.0099,
        0.0287])
[rfa agg] iter:  1, prev_obj_val: 55.604095458984375, obj_val: 64.3589859008789, abs dis: 8.754890441894531
[rfa agg] iter: 1, weight: tensor([0.0778, 0.2003, 0.1131, 0.0743, 0.0924, 0.0382, 0.1151, 0.2264, 0.0140,
        0.0484])
[rfa agg] iter:  2, prev_obj_val: 64.3589859008789, obj_val: 64.33992004394531, abs dis: 0.01906585693359375
[rfa agg] iter: 2, weight: tensor([0.0536, 0.2065, 0.0659, 0.1796, 0.0594, 0.0327, 0.0671, 0.2283, 0.0177,
        0.0892])
[rfa agg] iter:  3, prev_obj_val: 64.33992004394531, obj_val: 61.53804016113281, abs dis: 2.8018798828125
[rfa agg] iter: 3, weight: tensor([0.0531, 0.2074, 0.0651, 0.1846, 0.0588, 0.0324, 0.0664, 0.2257, 0.0176,
        0.0888])
[rfa agg] iter:  4, prev_obj_val: 61.53804016113281, obj_val: 67.32083129882812, abs dis: 5.7827911376953125
[rfa agg] iter: 4, weight: tensor([0.0491, 0.2520, 0.0620, 0.1153, 0.0550, 0.0286, 0.0632, 0.2989, 0.0140,
        0.0621])
[rfa agg] iter:  5, prev_obj_val: 67.32083129882812, obj_val: 64.34819793701172, abs dis: 2.9726333618164062
[rfa agg] iter: 5, weight: tensor([0.0515, 0.1605, 0.0617, 0.2673, 0.0565, 0.0328, 0.0629, 0.1685, 0.0199,
        0.1184])
[rfa agg] iter:  6, prev_obj_val: 64.34819793701172, obj_val: 61.53943634033203, abs dis: 2.8087615966796875
[rfa agg] iter: 6, weight: tensor([0.0532, 0.2044, 0.0652, 0.1907, 0.0588, 0.0325, 0.0666, 0.2219, 0.0176,
        0.0891])
[rfa agg] iter:  7, prev_obj_val: 61.53943634033203, obj_val: 67.32067108154297, abs dis: 5.7812347412109375
[rfa agg] iter: 7, weight: tensor([0.0491, 0.2517, 0.0621, 0.1155, 0.0551, 0.0286, 0.0633, 0.2984, 0.0140,
        0.0622])
[rfa agg] iter:  8, prev_obj_val: 67.32067108154297, obj_val: 64.34821319580078, abs dis: 2.9724578857421875
[rfa agg] iter: 8, weight: tensor([0.0515, 0.1605, 0.0617, 0.2673, 0.0565, 0.0328, 0.0629, 0.1685, 0.0199,
        0.1184])
[rfa agg] iter:  9, prev_obj_val: 64.34821319580078, obj_val: 61.53943634033203, abs dis: 2.80877685546875
[rfa agg] iter: 9, weight: tensor([0.0532, 0.2044, 0.0652, 0.1907, 0.0588, 0.0325, 0.0666, 0.2219, 0.0176,
        0.0891])
			Update norm = 116.18102792624964 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.92232942581177 sec.
Server Epoch:62 choose agents : [83, 78, 24, 81, 4, 30, 93, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 398/1953 (20.3789%)
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   2, Avg loss: 0.0347, Accuracy: 678/1953 (34.7158%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1718, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 46/416 (11.0577%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 189/416 (45.4327%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7129, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 172/312 (55.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.4702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0660, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0373, Accuracy: 280/774 (36.1757%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.4439, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 369/901 (40.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0695, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0778, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9284, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 426/1742 (24.4546%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8183, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0531, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.8891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 301/590 (51.0169%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0317, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.5959, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0504, Accuracy: 550/2227 (24.6969%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1018/2227 (45.7117%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.6161, Accuracy: 130/10000 (1.3000%)
time spent on training: 225.66457986831665
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 416, 312, 774, 901, 486, 1742, 515, 590, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 78, 24, 81, 4, 30, 93, 33, 69, 60], weight: tensor([0.1970, 0.0420, 0.0315, 0.0781, 0.0909, 0.0490, 0.1757, 0.0519, 0.0595,
        0.2246])
[rfa agg] iter:  0, prev_obj_val: 95.3706283569336, obj_val: 96.22992706298828, abs dis: 0.8592987060546875
[rfa agg] iter: 0, weight: tensor([0.1809, 0.0301, 0.0196, 0.1003, 0.1578, 0.0379, 0.2251, 0.0437, 0.0548,
        0.1498])
[rfa agg] iter:  1, prev_obj_val: 96.22992706298828, obj_val: 97.09886169433594, abs dis: 0.8689346313476562
[rfa agg] iter: 1, weight: tensor([0.1720, 0.0311, 0.0202, 0.1070, 0.1729, 0.0393, 0.2106, 0.0454, 0.0573,
        0.1442])
[rfa agg] iter:  2, prev_obj_val: 97.09886169433594, obj_val: 98.84549713134766, abs dis: 1.7466354370117188
[rfa agg] iter: 2, weight: tensor([0.1628, 0.0320, 0.0206, 0.1139, 0.1894, 0.0406, 0.1961, 0.0471, 0.0596,
        0.1380])
[rfa agg] iter:  3, prev_obj_val: 98.84549713134766, obj_val: 100.60528564453125, abs dis: 1.7597885131835938
[rfa agg] iter: 3, weight: tensor([0.1426, 0.0331, 0.0211, 0.1278, 0.2296, 0.0423, 0.1672, 0.0495, 0.0634,
        0.1234])
[rfa agg] iter:  4, prev_obj_val: 100.60528564453125, obj_val: 102.39337158203125, abs dis: 1.7880859375
[rfa agg] iter: 4, weight: tensor([0.1197, 0.0328, 0.0206, 0.1411, 0.2859, 0.0423, 0.1371, 0.0501, 0.0650,
        0.1054])
[rfa agg] iter:  5, prev_obj_val: 102.39337158203125, obj_val: 105.42691040039062, abs dis: 3.033538818359375
[rfa agg] iter: 5, weight: tensor([0.0925, 0.0300, 0.0186, 0.1495, 0.3743, 0.0392, 0.1039, 0.0470, 0.0621,
        0.0828])
[rfa agg] iter:  6, prev_obj_val: 105.42691040039062, obj_val: 110.31553649902344, abs dis: 4.8886260986328125
[rfa agg] iter: 6, weight: tensor([0.0476, 0.0202, 0.0121, 0.1432, 0.5751, 0.0270, 0.0523, 0.0332, 0.0457,
        0.0435])
[rfa agg] iter:  7, prev_obj_val: 110.31553649902344, obj_val: 112.05389404296875, abs dis: 1.7383575439453125
[rfa agg] iter: 7, weight: tensor([0.0500, 0.0285, 0.0163, 0.3815, 0.2603, 0.0393, 0.0538, 0.0503, 0.0737,
        0.0465])
[rfa agg] iter:  8, prev_obj_val: 112.05389404296875, obj_val: 114.21182250976562, abs dis: 2.157928466796875
[rfa agg] iter: 8, weight: tensor([0.0380, 0.0241, 0.0136, 0.5543, 0.1487, 0.0338, 0.0406, 0.0442, 0.0672,
        0.0355])
[rfa agg] iter:  9, prev_obj_val: 114.21182250976562, obj_val: 114.2090835571289, abs dis: 0.00273895263671875
[rfa agg] iter: 9, weight: tensor([0.0417, 0.0297, 0.0163, 0.5049, 0.1353, 0.0422, 0.0444, 0.0566, 0.0898,
        0.0392])
			Update norm = 116.07096849153324 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.40045523643494 sec.
Server Epoch:63 choose agents : [18, 64, 38, 94, 55, 90, 58, 59, 66, 76].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0699, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.4969, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 303/953 (31.7943%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5990, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 245/1131 (21.6622%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 438/1131 (38.7268%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4174, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 319/1662 (19.1937%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 636/1662 (38.2671%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6734, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 488/1071 (45.5649%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1130, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   1, Avg loss: 0.0576, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   2, Avg loss: 0.0214, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2210, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0352, Accuracy: 366/803 (45.5791%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.2140, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 487/1089 (44.7199%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6519, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 394/1402 (28.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4726, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8186, Accuracy: 50/10000 (0.5000%)
time spent on training: 231.58512997627258
[rfa agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 1662, 1071, 677, 803, 1089, 1402, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 64, 38, 94, 55, 90, 58, 59, 66, 76], weight: tensor([0.0542, 0.0974, 0.1156, 0.1699, 0.1095, 0.0692, 0.0821, 0.1113, 0.1433,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 45.0872917175293, obj_val: 51.16857147216797, abs dis: 6.081279754638672
[rfa agg] iter: 0, weight: tensor([0.0255, 0.3504, 0.1043, 0.0437, 0.1438, 0.0485, 0.1099, 0.0971, 0.0577,
        0.0192])
[rfa agg] iter:  1, prev_obj_val: 51.16857147216797, obj_val: 59.028038024902344, abs dis: 7.859466552734375
[rfa agg] iter: 1, weight: tensor([0.0382, 0.1940, 0.0806, 0.0435, 0.0977, 0.0859, 0.3026, 0.0762, 0.0538,
        0.0275])
[rfa agg] iter:  2, prev_obj_val: 59.028038024902344, obj_val: 59.01339340209961, abs dis: 0.014644622802734375
[rfa agg] iter: 2, weight: tensor([0.0637, 0.1139, 0.0687, 0.0437, 0.0780, 0.2117, 0.2612, 0.0655, 0.0515,
        0.0423])
			Update norm = 112.01082013861429 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.7918186187744 sec.
Server Epoch:64 choose agents : [77, 13, 57, 64, 48, 23, 71, 35, 32, 75].
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 315/1340 (23.5075%)
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8149, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0586, Accuracy: 305/1645 (18.5410%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 620/1645 (37.6900%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5885, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 543/1154 (47.0537%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.3887, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 179/953 (18.7828%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.4871, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0719, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.0234, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0619, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8946, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0644, Accuracy: 158/818 (19.3154%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 380/818 (46.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.3675, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0862, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0581, Accuracy: 118/271 (43.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4308, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 324/735 (44.0816%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.8227, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0200, Accuracy: 50/10000 (0.5000%)
time spent on training: 216.33088874816895
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1645, 1154, 953, 631, 715, 818, 271, 735, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 13, 57, 64, 48, 23, 71, 35, 32, 75], weight: tensor([0.1483, 0.1820, 0.1277, 0.1054, 0.0698, 0.0791, 0.0905, 0.0300, 0.0813,
        0.0859])
[rfa agg] iter:  0, prev_obj_val: 45.32163619995117, obj_val: 52.029823303222656, abs dis: 6.708187103271484
[rfa agg] iter: 0, weight: tensor([0.0597, 0.0417, 0.0734, 0.3352, 0.0406, 0.0799, 0.1427, 0.0083, 0.0830,
        0.1355])
[rfa agg] iter:  1, prev_obj_val: 52.029823303222656, obj_val: 58.25377655029297, abs dis: 6.2239532470703125
[rfa agg] iter: 1, weight: tensor([0.0342, 0.0271, 0.0377, 0.0724, 0.0691, 0.2131, 0.1535, 0.0088, 0.2364,
        0.1478])
[rfa agg] iter:  2, prev_obj_val: 58.25377655029297, obj_val: 61.7596321105957, abs dis: 3.5058555603027344
[rfa agg] iter: 2, weight: tensor([0.0417, 0.0343, 0.0448, 0.0734, 0.1685, 0.1878, 0.1216, 0.0139, 0.1990,
        0.1149])
[rfa agg] iter:  3, prev_obj_val: 61.7596321105957, obj_val: 65.4214096069336, abs dis: 3.6617774963378906
[rfa agg] iter: 3, weight: tensor([0.0426, 0.0355, 0.0451, 0.0701, 0.2858, 0.1460, 0.1057, 0.0162, 0.1528,
        0.1002])
[rfa agg] iter:  4, prev_obj_val: 65.4214096069336, obj_val: 65.40111541748047, abs dis: 0.020294189453125
[rfa agg] iter: 4, weight: tensor([0.0385, 0.0326, 0.0404, 0.0599, 0.4290, 0.1071, 0.0842, 0.0168, 0.1115,
        0.0800])
[rfa agg] iter:  5, prev_obj_val: 65.40111541748047, obj_val: 69.3913803100586, abs dis: 3.990264892578125
[rfa agg] iter: 5, weight: tensor([0.0348, 0.0294, 0.0365, 0.0541, 0.4858, 0.0961, 0.0758, 0.0152, 0.1002,
        0.0722])
[rfa agg] iter:  6, prev_obj_val: 69.3913803100586, obj_val: 65.40384674072266, abs dis: 3.9875335693359375
[rfa agg] iter: 6, weight: tensor([0.0443, 0.0380, 0.0461, 0.0656, 0.4004, 0.1045, 0.0872, 0.0224, 0.1086,
        0.0830])
[rfa agg] iter:  7, prev_obj_val: 65.40384674072266, obj_val: 65.39811706542969, abs dis: 0.00572967529296875
[rfa agg] iter: 7, weight: tensor([0.0356, 0.0301, 0.0373, 0.0553, 0.4741, 0.0983, 0.0776, 0.0155, 0.1025,
        0.0738])
[rfa agg] iter:  8, prev_obj_val: 65.39811706542969, obj_val: 65.39688873291016, abs dis: 0.00122833251953125
[rfa agg] iter: 8, weight: tensor([0.0334, 0.0282, 0.0351, 0.0519, 0.5066, 0.0921, 0.0727, 0.0146, 0.0961,
        0.0693])
[rfa agg] iter:  9, prev_obj_val: 65.39688873291016, obj_val: 65.39657592773438, abs dis: 0.00031280517578125
[rfa agg] iter: 9, weight: tensor([0.0323, 0.0273, 0.0339, 0.0502, 0.5227, 0.0890, 0.0704, 0.0141, 0.0929,
        0.0670])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.254994392395 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 84, 30, 66, 73, 81, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 383/1581 (24.2252%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 578/1581 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0706, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 408/1129 (36.1382%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 737/1129 (65.2790%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7455, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0881, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.5872, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 462/1154 (40.0347%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4795, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 460/1190 (38.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0977, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 81/486 (16.6667%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.1598, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 357/1402 (25.4636%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2843, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0659, Accuracy: 169/938 (18.0171%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 314/938 (33.4755%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3661, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   1, Avg loss: 0.0682, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   2, Avg loss: 0.0369, Accuracy: 299/774 (38.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.4651, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0520, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 451/712 (63.3427%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7279, Accuracy: 49/10000 (0.4900%)
time spent on training: 231.2649793624878
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1190, 486, 1402, 938, 774, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 37, 12, 15, 84, 30, 66, 73, 81, 11], weight: tensor([0.1629, 0.1163, 0.0348, 0.1189, 0.1226, 0.0501, 0.1445, 0.0967, 0.0798,
        0.0734])
[rfa agg] iter:  0, prev_obj_val: 44.58460998535156, obj_val: 50.48493957519531, abs dis: 5.90032958984375
[rfa agg] iter: 0, weight: tensor([0.0549, 0.1360, 0.0117, 0.1046, 0.1075, 0.0214, 0.0707, 0.3298, 0.0976,
        0.0659])
[rfa agg] iter:  1, prev_obj_val: 50.48493957519531, obj_val: 52.828216552734375, abs dis: 2.3432769775390625
[rfa agg] iter: 1, weight: tensor([0.0492, 0.0935, 0.0144, 0.0777, 0.0798, 0.0277, 0.0597, 0.2773, 0.2065,
        0.1141])
[rfa agg] iter:  2, prev_obj_val: 52.828216552734375, obj_val: 58.2054328918457, abs dis: 5.377216339111328
[rfa agg] iter: 2, weight: tensor([0.0456, 0.0809, 0.0149, 0.0686, 0.0705, 0.0293, 0.0545, 0.1919, 0.3007,
        0.1429])
[rfa agg] iter:  3, prev_obj_val: 58.2054328918457, obj_val: 55.339683532714844, abs dis: 2.8657493591308594
[rfa agg] iter: 3, weight: tensor([0.0396, 0.0630, 0.0162, 0.0550, 0.0566, 0.0336, 0.0461, 0.1133, 0.3111,
        0.2655])
[rfa agg] iter:  4, prev_obj_val: 55.339683532714844, obj_val: 58.19281005859375, abs dis: 2.8531265258789062
[rfa agg] iter: 4, weight: tensor([0.0383, 0.0641, 0.0140, 0.0553, 0.0569, 0.0282, 0.0452, 0.1273, 0.3909,
        0.1800])
[rfa agg] iter:  5, prev_obj_val: 58.19281005859375, obj_val: 58.18266296386719, abs dis: 0.0101470947265625
[rfa agg] iter: 5, weight: tensor([0.0383, 0.0609, 0.0157, 0.0532, 0.0548, 0.0325, 0.0446, 0.1088, 0.3282,
        0.2629])
[rfa agg] iter:  6, prev_obj_val: 58.18266296386719, obj_val: 58.182098388671875, abs dis: 0.0005645751953125
[rfa agg] iter: 6, weight: tensor([0.0382, 0.0608, 0.0156, 0.0531, 0.0546, 0.0324, 0.0445, 0.1084, 0.3115,
        0.2809])
[rfa agg] iter:  7, prev_obj_val: 58.182098388671875, obj_val: 61.3154296875, abs dis: 3.133331298828125
[rfa agg] iter: 7, weight: tensor([0.0382, 0.0608, 0.0156, 0.0531, 0.0546, 0.0324, 0.0445, 0.1084, 0.3071,
        0.2852])
[rfa agg] iter:  8, prev_obj_val: 61.3154296875, obj_val: 64.73821258544922, abs dis: 3.4227828979492188
[rfa agg] iter: 8, weight: tensor([0.0381, 0.0579, 0.0175, 0.0512, 0.0527, 0.0377, 0.0438, 0.0950, 0.2103,
        0.3958])
[rfa agg] iter:  9, prev_obj_val: 64.73821258544922, obj_val: 58.19788360595703, abs dis: 6.5403289794921875
[rfa agg] iter: 9, weight: tensor([0.0433, 0.0634, 0.0225, 0.0565, 0.0582, 0.0507, 0.0493, 0.0969, 0.1751,
        0.3841])
			Update norm = 115.52687981996874 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.36272168159485 sec.
Server Epoch:66 choose agents : [89, 62, 94, 18, 81, 93, 91, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.4016, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 140/568 (24.6479%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0422, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.9248, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 356/1662 (21.4200%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7913, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0712, Accuracy: 132/530 (24.9057%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3858, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   2, Avg loss: 0.0377, Accuracy: 278/774 (35.9173%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.4118, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 405/1742 (23.2491%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1137, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 340/1030 (33.0097%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 593/1030 (57.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.5427, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 181/938 (19.2964%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 321/938 (34.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3318, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2522, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 374/818 (45.7213%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3933, Accuracy: 58/10000 (0.5800%)
time spent on training: 243.19896984100342
[rfa agg] training data poison_ratio: 0.0  data num: [896, 568, 1662, 530, 774, 1742, 1030, 938, 891, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 62, 94, 18, 81, 93, 91, 73, 7, 71], weight: tensor([0.0910, 0.0577, 0.1687, 0.0538, 0.0786, 0.1769, 0.1046, 0.0952, 0.0905,
        0.0831])
[rfa agg] iter:  0, prev_obj_val: 51.37778854370117, obj_val: 52.527523040771484, abs dis: 1.1497344970703125
[rfa agg] iter: 0, weight: tensor([0.1449, 0.0239, 0.0433, 0.0222, 0.0817, 0.0381, 0.1542, 0.2680, 0.1373,
        0.0864])
[rfa agg] iter:  1, prev_obj_val: 52.527523040771484, obj_val: 59.11327362060547, abs dis: 6.585750579833984
[rfa agg] iter: 1, weight: tensor([0.2355, 0.0221, 0.0270, 0.0206, 0.1234, 0.0243, 0.0635, 0.1525, 0.2032,
        0.1279])
[rfa agg] iter:  2, prev_obj_val: 59.11327362060547, obj_val: 72.42993927001953, abs dis: 13.316665649414062
[rfa agg] iter: 2, weight: tensor([0.1361, 0.0397, 0.0305, 0.0370, 0.2259, 0.0278, 0.0552, 0.0893, 0.1301,
        0.2285])
[rfa agg] iter:  3, prev_obj_val: 72.42993927001953, obj_val: 68.98603820800781, abs dis: 3.4439010620117188
[rfa agg] iter: 3, weight: tensor([0.1063, 0.1488, 0.0453, 0.1378, 0.1277, 0.0421, 0.0662, 0.0869, 0.1044,
        0.1345])
[rfa agg] iter:  4, prev_obj_val: 68.98603820800781, obj_val: 62.26679229736328, abs dis: 6.719245910644531
[rfa agg] iter: 4, weight: tensor([0.1174, 0.1112, 0.0447, 0.1033, 0.1491, 0.0413, 0.0683, 0.0931, 0.1152,
        0.1565])
[rfa agg] iter:  5, prev_obj_val: 62.26679229736328, obj_val: 65.59417724609375, abs dis: 3.3273849487304688
[rfa agg] iter: 5, weight: tensor([0.1295, 0.0573, 0.0364, 0.0533, 0.2013, 0.0334, 0.0618, 0.0930, 0.1252,
        0.2089])
[rfa agg] iter:  6, prev_obj_val: 65.59417724609375, obj_val: 62.261474609375, abs dis: 3.33270263671875
[rfa agg] iter: 6, weight: tensor([0.1252, 0.0804, 0.0415, 0.0747, 0.1739, 0.0383, 0.0667, 0.0950, 0.1218,
        0.1824])
[rfa agg] iter:  7, prev_obj_val: 62.261474609375, obj_val: 65.59425354003906, abs dis: 3.3327789306640625
[rfa agg] iter: 7, weight: tensor([0.1293, 0.0570, 0.0363, 0.0531, 0.2019, 0.0333, 0.0617, 0.0927, 0.1247,
        0.2100])
[rfa agg] iter:  8, prev_obj_val: 65.59425354003906, obj_val: 62.261474609375, abs dis: 3.3327789306640625
[rfa agg] iter: 8, weight: tensor([0.1252, 0.0804, 0.0415, 0.0747, 0.1740, 0.0383, 0.0667, 0.0950, 0.1218,
        0.1825])
[rfa agg] iter:  9, prev_obj_val: 62.261474609375, obj_val: 65.59425354003906, abs dis: 3.3327789306640625
[rfa agg] iter: 9, weight: tensor([0.1293, 0.0570, 0.0363, 0.0531, 0.2019, 0.0333, 0.0617, 0.0927, 0.1247,
        0.2100])
			Update norm = 106.85781111774187 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.229615688324 sec.
Server Epoch:67 choose agents : [44, 83, 96, 56, 6, 74, 64, 39, 14, 77].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 388/1750 (22.1714%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 659/1750 (37.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0444, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 804/1953 (41.1674%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0037, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.4154, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3351, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 421/1956 (21.5235%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 645/1956 (32.9755%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2278, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 491/1552 (31.6366%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 761/1552 (49.0335%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.5097, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 335/953 (35.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.5110, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 306/1013 (30.2073%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8179, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 320/1013 (31.5893%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7661, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 329/1340 (24.5522%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.7533, Accuracy: 69/10000 (0.6900%)
time spent on training: 259.62178897857666
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1953, 311, 186, 1956, 1552, 953, 1013, 1013, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 83, 96, 56, 6, 74, 64, 39, 14, 77], weight: tensor([0.1455, 0.1624, 0.0259, 0.0155, 0.1626, 0.1290, 0.0792, 0.0842, 0.0842,
        0.1114])
[rfa agg] iter:  0, prev_obj_val: 60.02492141723633, obj_val: 65.38201904296875, abs dis: 5.357097625732422
[rfa agg] iter: 0, weight: tensor([0.1071, 0.0804, 0.0068, 0.0036, 0.0806, 0.1806, 0.0504, 0.0624, 0.0624,
        0.3657])
[rfa agg] iter:  1, prev_obj_val: 65.38201904296875, obj_val: 65.36927032470703, abs dis: 0.01274871826171875
[rfa agg] iter: 1, weight: tensor([0.0800, 0.0652, 0.0076, 0.0040, 0.0654, 0.1122, 0.0694, 0.0914, 0.0916,
        0.4132])
[rfa agg] iter:  2, prev_obj_val: 65.36927032470703, obj_val: 67.20513153076172, abs dis: 1.8358612060546875
[rfa agg] iter: 2, weight: tensor([0.0790, 0.0644, 0.0075, 0.0040, 0.0645, 0.1104, 0.0686, 0.0903, 0.0905,
        0.4209])
[rfa agg] iter:  3, prev_obj_val: 67.20513153076172, obj_val: 67.1988525390625, abs dis: 0.00627899169921875
[rfa agg] iter: 3, weight: tensor([0.0831, 0.0688, 0.0087, 0.0046, 0.0690, 0.1125, 0.0848, 0.1145, 0.1147,
        0.3393])
			Update norm = 177.03978079622388 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 357.12524914741516 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 83, 9, 17, 87, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 386/1949 (19.8050%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 603/1949 (30.9389%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2241, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0779, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.5192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 320/1089 (29.3848%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 473/1089 (43.4343%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.7739, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 393/1750 (22.4571%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 669/1750 (38.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6016, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 428/1953 (21.9150%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 782/1953 (40.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7277, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 364/1275 (28.5490%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 713/1275 (55.9216%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.7803, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 395/1574 (25.0953%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 646/1574 (41.0419%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1115, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 396/1131 (35.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0020, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.6321, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 262/888 (29.5045%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 436/888 (49.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2974, Accuracy: 54/10000 (0.5400%)
time spent on training: 262.592631816864
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1953, 1275, 1574, 1131, 636, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 24, 59, 44, 83, 9, 17, 87, 52, 63], weight: tensor([0.1552, 0.0248, 0.0867, 0.1394, 0.1555, 0.1015, 0.1253, 0.0901, 0.0506,
        0.0707])
[rfa agg] iter:  0, prev_obj_val: 59.83706283569336, obj_val: 62.417537689208984, abs dis: 2.580474853515625
[rfa agg] iter: 0, weight: tensor([0.0774, 0.0072, 0.1129, 0.1011, 0.0777, 0.2748, 0.1647, 0.1185, 0.0210,
        0.0447])
[rfa agg] iter:  1, prev_obj_val: 62.417537689208984, obj_val: 67.26614379882812, abs dis: 4.848606109619141
[rfa agg] iter: 1, weight: tensor([0.0463, 0.0055, 0.1262, 0.0570, 0.0465, 0.4476, 0.0815, 0.1342, 0.0167,
        0.0386])
[rfa agg] iter:  2, prev_obj_val: 67.26614379882812, obj_val: 71.7770767211914, abs dis: 4.510932922363281
[rfa agg] iter: 2, weight: tensor([0.0416, 0.0062, 0.2402, 0.0490, 0.0417, 0.2122, 0.0641, 0.2732, 0.0199,
        0.0519])
[rfa agg] iter:  3, prev_obj_val: 71.7770767211914, obj_val: 74.62901306152344, abs dis: 2.8519363403320312
[rfa agg] iter: 3, weight: tensor([0.0388, 0.0067, 0.2757, 0.0447, 0.0389, 0.1298, 0.0561, 0.3199, 0.0227,
        0.0667])
[rfa agg] iter:  4, prev_obj_val: 74.62901306152344, obj_val: 71.76424407958984, abs dis: 2.8647689819335938
[rfa agg] iter: 4, weight: tensor([0.0441, 0.0082, 0.2572, 0.0503, 0.0443, 0.1286, 0.0621, 0.2855, 0.0287,
        0.0911])
[rfa agg] iter:  5, prev_obj_val: 71.76424407958984, obj_val: 71.76116943359375, abs dis: 0.00307464599609375
[rfa agg] iter: 5, weight: tensor([0.0383, 0.0066, 0.2793, 0.0441, 0.0384, 0.1268, 0.0554, 0.3225, 0.0224,
        0.0661])
			Update norm = 159.38407449656003 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 357.4714298248291 sec.
Server Epoch:69 choose agents : [21, 31, 44, 89, 70, 80, 83, 5, 69, 75].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 437/1949 (22.4218%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 642/1949 (32.9400%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6094, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0775, Accuracy: 84/460 (18.2609%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0349, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0867, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0586, Accuracy: 395/1750 (22.5714%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 667/1750 (38.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7158, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/896 (47.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.4295, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 654/1418 (46.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8155, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 261/682 (38.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5518, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 430/1953 (22.0174%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 773/1953 (39.5801%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8786, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 378/1628 (23.2187%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 798/1628 (49.0172%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9252, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0553, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0305, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7414, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 255/776 (32.8608%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   2, Avg loss: 0.0302, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1665, Accuracy: 53/10000 (0.5300%)
time spent on training: 258.4029629230499
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 896, 1418, 682, 1953, 1628, 590, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 31, 44, 89, 70, 80, 83, 5, 69, 75], weight: tensor([0.1610, 0.0380, 0.1446, 0.0740, 0.1172, 0.0564, 0.1614, 0.1345, 0.0488,
        0.0641])
[rfa agg] iter:  0, prev_obj_val: 70.26272583007812, obj_val: 68.33589172363281, abs dis: 1.9268341064453125
[rfa agg] iter: 0, weight: tensor([0.0992, 0.0181, 0.1271, 0.0651, 0.3163, 0.0349, 0.0995, 0.1631, 0.0274,
        0.0495])
[rfa agg] iter:  1, prev_obj_val: 68.33589172363281, obj_val: 68.33177185058594, abs dis: 0.004119873046875
[rfa agg] iter: 1, weight: tensor([0.0925, 0.0155, 0.1212, 0.0539, 0.3703, 0.0294, 0.0927, 0.1598, 0.0233,
        0.0413])
			Update norm = 194.71127463182506 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.6222333908081 sec.
Server Epoch:70 choose agents : [7, 74, 76, 0, 16, 9, 19, 97, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2231, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 487/1552 (31.3789%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 762/1552 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.4869, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9151, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   1, Avg loss: 0.0587, Accuracy: 343/1657 (20.7001%)
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   2, Avg loss: 0.0351, Accuracy: 496/1657 (29.9336%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9805, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0597, Accuracy: 283/708 (39.9718%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0390, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9840, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 366/1275 (28.7059%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 686/1275 (53.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.6318, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 394/1036 (38.0309%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 687/1036 (66.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.2717, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 351/1213 (28.9365%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 456/1213 (37.5927%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8066, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0679, Accuracy: 106/631 (16.7987%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0394, Accuracy: 214/631 (33.9144%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 387/1402 (27.6034%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2739, Accuracy: 82/10000 (0.8200%)
time spent on training: 256.68572068214417
[rfa agg] training data poison_ratio: 0.15298679715631058  data num: [891, 1552, 466, 1657, 708, 1275, 1036, 1213, 631, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.04780837411134706
[rfa agg] init. name: [7, 74, 76, 0, 16, 9, 19, 97, 48, 66], weight: tensor([0.0823, 0.1433, 0.0430, 0.1530, 0.0654, 0.1177, 0.0957, 0.1120, 0.0583,
        0.1294])
[rfa agg] iter:  0, prev_obj_val: 47.2890510559082, obj_val: 53.35353088378906, abs dis: 6.064479827880859
[rfa agg] iter: 0, weight: tensor([0.0881, 0.0599, 0.0160, 0.0568, 0.0436, 0.1275, 0.3217, 0.1726, 0.0279,
        0.0859])
[rfa agg] iter:  1, prev_obj_val: 53.35353088378906, obj_val: 55.571571350097656, abs dis: 2.2180404663085938
[rfa agg] iter: 1, weight: tensor([0.1916, 0.0616, 0.0234, 0.0594, 0.0752, 0.1055, 0.2323, 0.1269, 0.0431,
        0.0809])
[rfa agg] iter:  2, prev_obj_val: 55.571571350097656, obj_val: 57.87046813964844, abs dis: 2.2988967895507812
[rfa agg] iter: 2, weight: tensor([0.2621, 0.0585, 0.0250, 0.0567, 0.0873, 0.0952, 0.1809, 0.1118, 0.0473,
        0.0752])
[rfa agg] iter:  3, prev_obj_val: 57.87046813964844, obj_val: 63.03886032104492, abs dis: 5.168392181396484
[rfa agg] iter: 3, weight: tensor([0.3520, 0.0518, 0.0250, 0.0504, 0.0963, 0.0805, 0.1373, 0.0927, 0.0487,
        0.0652])
[rfa agg] iter:  4, prev_obj_val: 63.03886032104492, obj_val: 63.034690856933594, abs dis: 0.004169464111328125
[rfa agg] iter: 4, weight: tensor([0.3751, 0.0462, 0.0288, 0.0453, 0.1479, 0.0667, 0.0983, 0.0746, 0.0607,
        0.0563])
			Update norm = 124.3562564394128 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.3017, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.1702880859375 sec.
Server Epoch:71 choose agents : [49, 6, 74, 90, 82, 24, 33, 78, 18, 84].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0806, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0488, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.6949, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 369/1956 (18.8650%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1956 (31.5951%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2967, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 447/1552 (28.8015%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 745/1552 (48.0026%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.2929, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5296, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.0029, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5170, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0498, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8411, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   1, Avg loss: 0.0822, Accuracy: 44/416 (10.5769%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 179/416 (43.0288%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8293, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0708, Accuracy: 141/530 (26.6038%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4634, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 470/1190 (39.4958%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3927, Accuracy: 62/10000 (0.6200%)
time spent on training: 229.12594866752625
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1956, 1552, 677, 500, 312, 515, 416, 530, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 6, 74, 90, 82, 24, 33, 78, 18, 84], weight: tensor([0.0544, 0.2418, 0.1919, 0.0837, 0.0618, 0.0386, 0.0637, 0.0514, 0.0655,
        0.1471])
[rfa agg] iter:  0, prev_obj_val: 81.61024475097656, obj_val: 83.7293930053711, abs dis: 2.1191482543945312
[rfa agg] iter: 0, weight: tensor([0.0461, 0.1126, 0.1454, 0.1328, 0.0594, 0.0264, 0.0704, 0.0435, 0.0724,
        0.2908])
[rfa agg] iter:  1, prev_obj_val: 83.7293930053711, obj_val: 85.17720794677734, abs dis: 1.44781494140625
[rfa agg] iter: 1, weight: tensor([0.0541, 0.0993, 0.1215, 0.1908, 0.0716, 0.0298, 0.0882, 0.0511, 0.0908,
        0.2028])
[rfa agg] iter:  2, prev_obj_val: 85.17720794677734, obj_val: 88.43461608886719, abs dis: 3.2574081420898438
[rfa agg] iter: 2, weight: tensor([0.0562, 0.0836, 0.0994, 0.2512, 0.0766, 0.0299, 0.0980, 0.0531, 0.1010,
        0.1510])
[rfa agg] iter:  3, prev_obj_val: 88.43461608886719, obj_val: 91.19532012939453, abs dis: 2.7607040405273438
[rfa agg] iter: 3, weight: tensor([0.0415, 0.0373, 0.0422, 0.5099, 0.0627, 0.0197, 0.0937, 0.0392, 0.0975,
        0.0564])
[rfa agg] iter:  4, prev_obj_val: 91.19532012939453, obj_val: 94.55571746826172, abs dis: 3.3603973388671875
[rfa agg] iter: 4, weight: tensor([0.0588, 0.0380, 0.0422, 0.2637, 0.0986, 0.0251, 0.1736, 0.0553, 0.1910,
        0.0537])
[rfa agg] iter:  5, prev_obj_val: 94.55571746826172, obj_val: 99.55906677246094, abs dis: 5.003349304199219
[rfa agg] iter: 5, weight: tensor([0.0594, 0.0248, 0.0270, 0.0919, 0.1271, 0.0214, 0.2443, 0.0556, 0.3156,
        0.0330])
[rfa agg] iter:  6, prev_obj_val: 99.55906677246094, obj_val: 102.57594299316406, abs dis: 3.016876220703125
[rfa agg] iter: 6, weight: tensor([0.1131, 0.0242, 0.0260, 0.0632, 0.3426, 0.0288, 0.1289, 0.1031, 0.1394,
        0.0307])
[rfa agg] iter:  7, prev_obj_val: 102.57594299316406, obj_val: 105.93125915527344, abs dis: 3.355316162109375
[rfa agg] iter: 7, weight: tensor([0.2017, 0.0245, 0.0261, 0.0562, 0.2574, 0.0356, 0.0942, 0.1749, 0.0990,
        0.0304])
[rfa agg] iter:  8, prev_obj_val: 105.93125915527344, obj_val: 109.78353881835938, abs dis: 3.8522796630859375
[rfa agg] iter: 8, weight: tensor([0.3326, 0.0216, 0.0229, 0.0444, 0.1272, 0.0395, 0.0653, 0.2522, 0.0682,
        0.0262])
[rfa agg] iter:  9, prev_obj_val: 109.78353881835938, obj_val: 109.78157043457031, abs dis: 0.0019683837890625
[rfa agg] iter: 9, weight: tensor([0.2774, 0.0290, 0.0304, 0.0540, 0.1177, 0.0699, 0.0722, 0.2397, 0.0753,
        0.0344])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 327.3496148586273 sec.
Server Epoch:72 choose agents : [31, 17, 64, 91, 34, 99, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0766, Accuracy: 89/460 (19.3478%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.1414, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 403/1574 (25.6036%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.5228, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.6563, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 345/1030 (33.4951%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 635/1030 (61.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3506, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0569, Accuracy: 390/1427 (27.3301%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 561/1427 (39.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.1021, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 184/773 (23.8034%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0325, Accuracy: 372/773 (48.1242%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.2377, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.2250, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0553, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 421/888 (47.4099%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2080, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 514/1470 (34.9660%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 838/1470 (57.0068%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3022, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 410/1036 (39.5753%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 654/1036 (63.1274%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.7222, Accuracy: 49/10000 (0.4900%)
time spent on training: 250.87381649017334
[rfa agg] training data poison_ratio: 0.0  data num: [460, 1574, 953, 1030, 1427, 773, 901, 888, 1470, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [31, 17, 64, 91, 34, 99, 4, 63, 22, 19], weight: tensor([0.0438, 0.1497, 0.0907, 0.0980, 0.1357, 0.0735, 0.0857, 0.0845, 0.1398,
        0.0986])
[rfa agg] iter:  0, prev_obj_val: 40.76521301269531, obj_val: 45.64483642578125, abs dis: 4.8796234130859375
[rfa agg] iter: 0, weight: tensor([0.0135, 0.0410, 0.1732, 0.1711, 0.0477, 0.0590, 0.1632, 0.0988, 0.0491,
        0.1832])
[rfa agg] iter:  1, prev_obj_val: 45.64483642578125, obj_val: 51.38300323486328, abs dis: 5.738166809082031
[rfa agg] iter: 1, weight: tensor([0.0145, 0.0307, 0.2157, 0.0796, 0.0343, 0.0937, 0.2004, 0.2149, 0.0353,
        0.0812])
[rfa agg] iter:  2, prev_obj_val: 51.38300323486328, obj_val: 54.80593490600586, abs dis: 3.422931671142578
[rfa agg] iter: 2, weight: tensor([0.0198, 0.0325, 0.1377, 0.0674, 0.0357, 0.2038, 0.1283, 0.2697, 0.0367,
        0.0684])
[rfa agg] iter:  3, prev_obj_val: 54.80593490600586, obj_val: 58.547454833984375, abs dis: 3.7415199279785156
[rfa agg] iter: 3, weight: tensor([0.0238, 0.0341, 0.1166, 0.0651, 0.0371, 0.3071, 0.1088, 0.2030, 0.0382,
        0.0661])
[rfa agg] iter:  4, prev_obj_val: 58.547454833984375, obj_val: 58.54645919799805, abs dis: 0.000995635986328125
[rfa agg] iter: 4, weight: tensor([0.0313, 0.0389, 0.1129, 0.0691, 0.0420, 0.3168, 0.1058, 0.1699, 0.0432,
        0.0700])
			Update norm = 115.06176160816851 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.4929823875427 sec.
Server Epoch:73 choose agents : [27, 0, 34, 96, 4, 72, 81, 12, 59, 88].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 454/1587 (28.6074%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 598/1587 (37.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7455, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 371/1657 (22.3899%)
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 526/1657 (31.7441%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7400, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 390/1427 (27.3301%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 582/1427 (40.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1314, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4177, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0627, Accuracy: 334/901 (37.0699%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 387/901 (42.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1235, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 431/1241 (34.7301%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2759, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 239/774 (30.8786%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 289/774 (37.3385%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.5145, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7089, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0600, Accuracy: 297/1089 (27.2727%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.9445, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 150/603 (24.8756%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1327, Accuracy: 60/10000 (0.6000%)
time spent on training: 251.35084915161133
[rfa agg] training data poison_ratio: 0.1669016921837228  data num: [1587, 1657, 1427, 311, 901, 1241, 774, 338, 1089, 603]
[rfa agg] considering poison per batch poison_fraction: 0.05215677880741337
[rfa agg] init. name: [27, 0, 34, 96, 4, 72, 81, 12, 59, 88], weight: tensor([0.1599, 0.1669, 0.1437, 0.0313, 0.0908, 0.1250, 0.0780, 0.0340, 0.1097,
        0.0607])
[rfa agg] iter:  0, prev_obj_val: 52.93120193481445, obj_val: 56.43671798706055, abs dis: 3.5055160522460938
[rfa agg] iter: 0, weight: tensor([0.0797, 0.0741, 0.0952, 0.0104, 0.1666, 0.1624, 0.0770, 0.0124, 0.2876,
        0.0347])
[rfa agg] iter:  1, prev_obj_val: 56.43671798706055, obj_val: 58.30823516845703, abs dis: 1.8715171813964844
[rfa agg] iter: 1, weight: tensor([0.0720, 0.0677, 0.0830, 0.0116, 0.2806, 0.1251, 0.1025, 0.0138, 0.2028,
        0.0410])
[rfa agg] iter:  2, prev_obj_val: 58.30823516845703, obj_val: 58.28810119628906, abs dis: 0.02013397216796875
[rfa agg] iter: 2, weight: tensor([0.0620, 0.0586, 0.0705, 0.0110, 0.3825, 0.1013, 0.1106, 0.0132, 0.1499,
        0.0405])
[rfa agg] iter:  3, prev_obj_val: 58.28810119628906, obj_val: 62.722843170166016, abs dis: 4.434741973876953
[rfa agg] iter: 3, weight: tensor([0.0595, 0.0563, 0.0677, 0.0106, 0.4086, 0.0972, 0.1062, 0.0127, 0.1423,
        0.0389])
[rfa agg] iter:  4, prev_obj_val: 62.722843170166016, obj_val: 65.29197692871094, abs dis: 2.569133758544922
[rfa agg] iter: 4, weight: tensor([0.0535, 0.0510, 0.0594, 0.0116, 0.4159, 0.0793, 0.1631, 0.0141, 0.1052,
        0.0470])
[rfa agg] iter:  5, prev_obj_val: 65.29197692871094, obj_val: 65.2743148803711, abs dis: 0.01766204833984375
[rfa agg] iter: 5, weight: tensor([0.0566, 0.0543, 0.0622, 0.0135, 0.3083, 0.0808, 0.2465, 0.0165, 0.1029,
        0.0584])
[rfa agg] iter:  6, prev_obj_val: 65.2743148803711, obj_val: 67.9269790649414, abs dis: 2.6526641845703125
[rfa agg] iter: 6, weight: tensor([0.0568, 0.0544, 0.0624, 0.0136, 0.2945, 0.0810, 0.2588, 0.0166, 0.1032,
        0.0587])
[rfa agg] iter:  7, prev_obj_val: 67.9269790649414, obj_val: 67.90764617919922, abs dis: 0.0193328857421875
[rfa agg] iter: 7, weight: tensor([0.0526, 0.0506, 0.0573, 0.0139, 0.2087, 0.0725, 0.3729, 0.0171, 0.0896,
        0.0647])
[rfa agg] iter:  8, prev_obj_val: 67.90764617919922, obj_val: 67.90682220458984, abs dis: 0.000823974609375
[rfa agg] iter: 8, weight: tensor([0.0507, 0.0488, 0.0552, 0.0134, 0.1961, 0.0699, 0.4006, 0.0165, 0.0863,
        0.0624])
			Update norm = 123.63376011682651 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.58848309516907 sec.
Server Epoch:74 choose agents : [9, 38, 0, 63, 50, 44, 1, 92, 93, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 373/1275 (29.2549%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 713/1275 (55.9216%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.7542, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0629, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 500/1131 (44.2087%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5971, Accuracy: 80/10000 (0.8000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 365/1657 (22.0278%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 513/1657 (30.9596%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5736, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 262/888 (29.5045%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9155, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 160/809 (19.7775%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 375/809 (46.3535%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7470, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 374/1750 (21.3714%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 655/1750 (37.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7588, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 575/928 (61.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9032, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0527, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 696/1715 (40.5831%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7275, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 425/1742 (24.3972%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.5439, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 276/813 (33.9483%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 477/813 (58.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.8714, Accuracy: 55/10000 (0.5500%)
time spent on training: 307.7520513534546
[rfa agg] training data poison_ratio: 0.13039030531948378  data num: [1275, 1131, 1657, 888, 809, 1750, 928, 1715, 1742, 813]
[rfa agg] considering poison per batch poison_fraction: 0.040746970412338684
[rfa agg] init. name: [9, 38, 0, 63, 50, 44, 1, 92, 93, 53], weight: tensor([0.1003, 0.0890, 0.1304, 0.0699, 0.0637, 0.1377, 0.0730, 0.1350, 0.1371,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 54.08557891845703, obj_val: 59.7674674987793, abs dis: 5.681888580322266
[rfa agg] iter: 0, weight: tensor([0.3560, 0.1986, 0.0751, 0.0476, 0.0366, 0.0609, 0.0600, 0.0675, 0.0606,
        0.0370])
[rfa agg] iter:  1, prev_obj_val: 59.7674674987793, obj_val: 63.705963134765625, abs dis: 3.938495635986328
[rfa agg] iter: 1, weight: tensor([0.1452, 0.3682, 0.0571, 0.0728, 0.0517, 0.0489, 0.1019, 0.0529, 0.0487,
        0.0525])
[rfa agg] iter:  2, prev_obj_val: 63.705963134765625, obj_val: 70.28797149658203, abs dis: 6.582008361816406
[rfa agg] iter: 2, weight: tensor([0.1169, 0.2350, 0.0576, 0.1127, 0.0739, 0.0503, 0.1742, 0.0540, 0.0501,
        0.0755])
[rfa agg] iter:  3, prev_obj_val: 70.28797149658203, obj_val: 72.8205795288086, abs dis: 2.5326080322265625
[rfa agg] iter: 3, weight: tensor([0.0667, 0.0980, 0.0399, 0.1921, 0.0974, 0.0357, 0.2946, 0.0379, 0.0356,
        0.1021])
[rfa agg] iter:  4, prev_obj_val: 72.8205795288086, obj_val: 78.93277740478516, abs dis: 6.1121978759765625
[rfa agg] iter: 4, weight: tensor([0.0546, 0.0753, 0.0343, 0.2563, 0.1099, 0.0309, 0.2575, 0.0327, 0.0308,
        0.1176])
[rfa agg] iter:  5, prev_obj_val: 78.93277740478516, obj_val: 82.48822021484375, abs dis: 3.5554428100585938
[rfa agg] iter: 5, weight: tensor([0.0444, 0.0566, 0.0302, 0.2593, 0.1788, 0.0276, 0.1270, 0.0290, 0.0274,
        0.2197])
[rfa agg] iter:  6, prev_obj_val: 82.48822021484375, obj_val: 90.75894165039062, abs dis: 8.270721435546875
[rfa agg] iter: 6, weight: tensor([0.0410, 0.0508, 0.0289, 0.1742, 0.2216, 0.0265, 0.0967, 0.0278, 0.0263,
        0.3063])
[rfa agg] iter:  7, prev_obj_val: 90.75894165039062, obj_val: 70.31120300292969, abs dis: 20.447738647460938
[rfa agg] iter: 7, weight: tensor([0.0553, 0.0653, 0.0413, 0.1475, 0.2216, 0.0382, 0.1035, 0.0399, 0.0380,
        0.2495])
[rfa agg] iter:  8, prev_obj_val: 70.31120300292969, obj_val: 70.23308563232422, abs dis: 0.07811737060546875
[rfa agg] iter: 8, weight: tensor([0.0674, 0.0982, 0.0405, 0.1984, 0.1016, 0.0362, 0.2780, 0.0384, 0.0360,
        0.1053])
[rfa agg] iter:  9, prev_obj_val: 70.23308563232422, obj_val: 78.97415924072266, abs dis: 8.741073608398438
[rfa agg] iter: 9, weight: tensor([0.0632, 0.0919, 0.0379, 0.1878, 0.0929, 0.0339, 0.3259, 0.0359, 0.0337,
        0.0970])
			Update norm = 123.77232674223872 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 401.38868713378906 sec.
Server Epoch:75 choose agents : [88, 65, 74, 85, 4, 55, 81, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 156/603 (25.8706%)
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.0742, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0570, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.2629, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 482/1552 (31.0567%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.2535, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 434/1988 (21.8310%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 701/1988 (35.2616%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9615, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0599, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 387/901 (42.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9929, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 537/1071 (50.1401%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8577, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   1, Avg loss: 0.0665, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   2, Avg loss: 0.0373, Accuracy: 280/774 (36.1757%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.7089, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0879, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.6065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0543, Accuracy: 404/1949 (20.7286%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 609/1949 (31.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3349, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 170/953 (17.8384%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 312/953 (32.7387%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.7204, Accuracy: 64/10000 (0.6400%)
time spent on training: 261.4476988315582
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1475, 1552, 1988, 901, 1071, 774, 338, 1949, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 65, 74, 85, 4, 55, 81, 12, 21, 64], weight: tensor([0.0520, 0.1271, 0.1337, 0.1713, 0.0776, 0.0923, 0.0667, 0.0291, 0.1680,
        0.0821])
[rfa agg] iter:  0, prev_obj_val: 67.3656997680664, obj_val: 69.1053466796875, abs dis: 1.7396469116210938
[rfa agg] iter: 0, weight: tensor([0.0300, 0.2101, 0.1764, 0.0902, 0.0847, 0.1558, 0.0539, 0.0122, 0.0968,
        0.0899])
[rfa agg] iter:  1, prev_obj_val: 69.1053466796875, obj_val: 70.00238037109375, abs dis: 0.89703369140625
[rfa agg] iter: 1, weight: tensor([0.0325, 0.1644, 0.1429, 0.0814, 0.1011, 0.2100, 0.0609, 0.0128, 0.0867,
        0.1073])
[rfa agg] iter:  2, prev_obj_val: 70.00238037109375, obj_val: 72.89393615722656, abs dis: 2.8915557861328125
[rfa agg] iter: 2, weight: tensor([0.0328, 0.1418, 0.1254, 0.0748, 0.1083, 0.2469, 0.0630, 0.0127, 0.0794,
        0.1150])
[rfa agg] iter:  3, prev_obj_val: 72.89393615722656, obj_val: 77.30728149414062, abs dis: 4.4133453369140625
[rfa agg] iter: 3, weight: tensor([0.0272, 0.0761, 0.0698, 0.0465, 0.1162, 0.4233, 0.0579, 0.0100, 0.0489,
        0.1241])
[rfa agg] iter:  4, prev_obj_val: 77.30728149414062, obj_val: 81.29374694824219, abs dis: 3.9864654541015625
[rfa agg] iter: 4, weight: tensor([0.0296, 0.0542, 0.0509, 0.0368, 0.2028, 0.2800, 0.0746, 0.0100, 0.0385,
        0.2227])
[rfa agg] iter:  5, prev_obj_val: 81.29374694824219, obj_val: 86.89354705810547, abs dis: 5.599800109863281
[rfa agg] iter: 5, weight: tensor([0.0279, 0.0381, 0.0361, 0.0273, 0.2874, 0.1184, 0.0862, 0.0088, 0.0284,
        0.3414])
[rfa agg] iter:  6, prev_obj_val: 86.89354705810547, obj_val: 83.90362548828125, abs dis: 2.9899215698242188
[rfa agg] iter: 6, weight: tensor([0.0450, 0.0444, 0.0426, 0.0334, 0.2307, 0.1040, 0.1974, 0.0128, 0.0347,
        0.2550])
[rfa agg] iter:  7, prev_obj_val: 83.90362548828125, obj_val: 90.01551055908203, abs dis: 6.111885070800781
[rfa agg] iter: 7, weight: tensor([0.0339, 0.0395, 0.0377, 0.0290, 0.2755, 0.1037, 0.1241, 0.0101, 0.0302,
        0.3162])
[rfa agg] iter:  8, prev_obj_val: 90.01551055908203, obj_val: 81.29280090332031, abs dis: 8.722709655761719
[rfa agg] iter: 8, weight: tensor([0.0539, 0.0446, 0.0430, 0.0343, 0.1766, 0.0949, 0.3122, 0.0143, 0.0355,
        0.1908])
[rfa agg] iter:  9, prev_obj_val: 81.29280090332031, obj_val: 90.03025817871094, abs dis: 8.737457275390625
[rfa agg] iter: 9, weight: tensor([0.0276, 0.0376, 0.0357, 0.0270, 0.2901, 0.1136, 0.0872, 0.0086, 0.0281,
        0.3445])
			Update norm = 123.75083648707188 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.208518743515 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 83, 39, 17, 88, 92, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 384/1628 (23.5872%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 791/1628 (48.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5065, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.1989, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 210/861 (24.3902%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0221, Accuracy: 446/861 (51.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3391, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 251/1071 (23.4360%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 502/1071 (46.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2692, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 444/1953 (22.7343%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 772/1953 (39.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.0661, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 495/1013 (48.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9086, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 409/1574 (25.9848%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 656/1574 (41.6773%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3582, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0737, Accuracy: 149/603 (24.7098%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.0129, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 433/1715 (25.2478%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 731/1715 (42.6239%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.6552, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 42/271 (15.4982%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0585, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.4589, Accuracy: 45/10000 (0.4500%)
time spent on training: 267.8107523918152
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1953, 1013, 1574, 603, 1715, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 72, 10, 55, 83, 39, 17, 88, 92, 35], weight: tensor([0.1365, 0.1040, 0.0722, 0.0898, 0.1637, 0.0849, 0.1319, 0.0505, 0.1438,
        0.0227])
[rfa agg] iter:  0, prev_obj_val: 54.72580337524414, obj_val: 57.739463806152344, abs dis: 3.013660430908203
[rfa agg] iter: 0, weight: tensor([0.1143, 0.3447, 0.0437, 0.0927, 0.0695, 0.0716, 0.1369, 0.0196, 0.1010,
        0.0060])
[rfa agg] iter:  1, prev_obj_val: 57.739463806152344, obj_val: 60.903499603271484, abs dis: 3.1640357971191406
[rfa agg] iter: 1, weight: tensor([0.0723, 0.4628, 0.0452, 0.1152, 0.0494, 0.0825, 0.0824, 0.0185, 0.0662,
        0.0054])
[rfa agg] iter:  2, prev_obj_val: 60.903499603271484, obj_val: 64.28278350830078, abs dis: 3.379283905029297
[rfa agg] iter: 2, weight: tensor([0.0756, 0.2763, 0.0661, 0.2051, 0.0548, 0.1357, 0.0841, 0.0249, 0.0704,
        0.0070])
[rfa agg] iter:  3, prev_obj_val: 64.28278350830078, obj_val: 62.5146598815918, abs dis: 1.7681236267089844
[rfa agg] iter: 3, weight: tensor([0.0598, 0.1507, 0.0754, 0.3240, 0.0454, 0.1909, 0.0654, 0.0252, 0.0565,
        0.0068])
[rfa agg] iter:  4, prev_obj_val: 62.5146598815918, obj_val: 66.17174530029297, abs dis: 3.657085418701172
[rfa agg] iter: 4, weight: tensor([0.0678, 0.1927, 0.0710, 0.2870, 0.0504, 0.1604, 0.0748, 0.0253, 0.0637,
        0.0070])
[rfa agg] iter:  5, prev_obj_val: 66.17174530029297, obj_val: 68.37346649169922, abs dis: 2.20172119140625
[rfa agg] iter: 5, weight: tensor([0.0496, 0.1107, 0.0766, 0.3673, 0.0384, 0.2264, 0.0539, 0.0237, 0.0472,
        0.0062])
[rfa agg] iter:  6, prev_obj_val: 68.37346649169922, obj_val: 70.89417266845703, abs dis: 2.5207061767578125
[rfa agg] iter: 6, weight: tensor([0.0444, 0.0896, 0.0853, 0.3217, 0.0350, 0.3035, 0.0479, 0.0241, 0.0424,
        0.0061])
[rfa agg] iter:  7, prev_obj_val: 70.89417266845703, obj_val: 68.37031555175781, abs dis: 2.5238571166992188
[rfa agg] iter: 7, weight: tensor([0.0417, 0.0780, 0.1026, 0.2191, 0.0334, 0.4086, 0.0447, 0.0257, 0.0400,
        0.0063])
[rfa agg] iter:  8, prev_obj_val: 68.37031555175781, obj_val: 68.3623046875, abs dis: 0.0080108642578125
[rfa agg] iter: 8, weight: tensor([0.0437, 0.0884, 0.0843, 0.2700, 0.0345, 0.3604, 0.0472, 0.0237, 0.0418,
        0.0060])
[rfa agg] iter:  9, prev_obj_val: 68.3623046875, obj_val: 70.8777084350586, abs dis: 2.5154037475585938
[rfa agg] iter: 9, weight: tensor([0.0439, 0.0888, 0.0845, 0.2857, 0.0347, 0.3432, 0.0474, 0.0238, 0.0420,
        0.0061])
			Update norm = 145.77517739227758 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 366.28183674812317 sec.
Server Epoch:77 choose agents : [61, 17, 99, 31, 50, 89, 71, 60, 94, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1190, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3215, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 651/1574 (41.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0393, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   1, Avg loss: 0.0679, Accuracy: 185/773 (23.9327%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4220, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0766, Accuracy: 89/460 (19.3478%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.1127, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 148/809 (18.2942%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 334/809 (41.2855%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.5927, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   1, Avg loss: 0.0595, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   2, Avg loss: 0.0345, Accuracy: 422/896 (47.0982%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.4661, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 375/818 (45.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.3655, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 581/2227 (26.0889%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3554, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 323/1662 (19.4344%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 621/1662 (37.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8315, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 604/1581 (38.2037%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8636, Accuracy: 94/10000 (0.9400%)
time spent on training: 272.2687132358551
[rfa agg] training data poison_ratio: 0.0  data num: [85, 1574, 773, 460, 809, 896, 818, 2227, 1662, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 17, 99, 31, 50, 89, 71, 60, 94, 28], weight: tensor([0.0078, 0.1446, 0.0710, 0.0423, 0.0743, 0.0823, 0.0751, 0.2046, 0.1527,
        0.1452])
[rfa agg] iter:  0, prev_obj_val: 73.13067626953125, obj_val: 75.72718811035156, abs dis: 2.5965118408203125
[rfa agg] iter: 0, weight: tensor([0.0030, 0.1969, 0.0696, 0.0243, 0.0728, 0.0940, 0.0738, 0.0941, 0.1742,
        0.1972])
[rfa agg] iter:  1, prev_obj_val: 75.72718811035156, obj_val: 74.41938018798828, abs dis: 1.3078079223632812
[rfa agg] iter: 1, weight: tensor([0.0033, 0.1715, 0.0842, 0.0275, 0.0880, 0.1168, 0.0893, 0.0917, 0.1556,
        0.1720])
[rfa agg] iter:  2, prev_obj_val: 74.41938018798828, obj_val: 74.4189224243164, abs dis: 0.000457763671875
[rfa agg] iter: 2, weight: tensor([0.0031, 0.1842, 0.0768, 0.0260, 0.0803, 0.1050, 0.0815, 0.0934, 0.1651,
        0.1846])
			Update norm = 176.58348879673036 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3086, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.3114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.96977186203003 sec.
Server Epoch:78 choose agents : [1, 64, 48, 76, 98, 36, 26, 89, 18, 92].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0556, Accuracy: 293/928 (31.5733%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 517/928 (55.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.9304, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 176/953 (18.4680%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.6901, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0681, Accuracy: 111/631 (17.5911%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0399, Accuracy: 231/631 (36.6086%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1554, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8515, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 31/373 (8.3110%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6082, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 72/408 (17.6471%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6154, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 364/1446 (25.1729%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 509/1446 (35.2006%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.2473, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 417/896 (46.5402%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.4808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0696, Accuracy: 141/530 (26.6038%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.6513, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 475/1715 (27.6968%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 719/1715 (41.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5605, Accuracy: 89/10000 (0.8900%)
time spent on training: 229.9874782562256
[rfa agg] training data poison_ratio: 0.0  data num: [928, 953, 631, 466, 373, 408, 1446, 896, 530, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [1, 64, 48, 76, 98, 36, 26, 89, 18, 92], weight: tensor([0.1112, 0.1142, 0.0756, 0.0558, 0.0447, 0.0489, 0.1733, 0.1074, 0.0635,
        0.2055])
[rfa agg] iter:  0, prev_obj_val: 55.30347442626953, obj_val: 59.190528869628906, abs dis: 3.887054443359375
[rfa agg] iter: 0, weight: tensor([0.2440, 0.2962, 0.0381, 0.0196, 0.0120, 0.0149, 0.0464, 0.2650, 0.0263,
        0.0376])
[rfa agg] iter:  1, prev_obj_val: 59.190528869628906, obj_val: 64.708251953125, abs dis: 5.517723083496094
[rfa agg] iter: 1, weight: tensor([0.1757, 0.1853, 0.0834, 0.0375, 0.0215, 0.0274, 0.0584, 0.3083, 0.0529,
        0.0496])
[rfa agg] iter:  2, prev_obj_val: 64.708251953125, obj_val: 70.62372589111328, abs dis: 5.915473937988281
[rfa agg] iter: 2, weight: tensor([0.1296, 0.1343, 0.1955, 0.0656, 0.0337, 0.0449, 0.0629, 0.1754, 0.1026,
        0.0554])
[rfa agg] iter:  3, prev_obj_val: 70.62372589111328, obj_val: 78.72044372558594, abs dis: 8.096717834472656
[rfa agg] iter: 3, weight: tensor([0.0614, 0.0635, 0.4262, 0.0751, 0.0309, 0.0446, 0.0373, 0.0742, 0.1530,
        0.0338])
[rfa agg] iter:  4, prev_obj_val: 78.72044372558594, obj_val: 85.38836669921875, abs dis: 6.6679229736328125
[rfa agg] iter: 4, weight: tensor([0.0505, 0.0521, 0.1467, 0.2279, 0.0518, 0.0902, 0.0355, 0.0576, 0.2545,
        0.0331])
[rfa agg] iter:  5, prev_obj_val: 85.38836669921875, obj_val: 85.37251281738281, abs dis: 0.0158538818359375
[rfa agg] iter: 5, weight: tensor([0.0459, 0.0473, 0.0926, 0.2668, 0.0876, 0.2137, 0.0348, 0.0512, 0.1271,
        0.0329])
[rfa agg] iter:  6, prev_obj_val: 85.37251281738281, obj_val: 81.87123107910156, abs dis: 3.50128173828125
[rfa agg] iter: 6, weight: tensor([0.0447, 0.0461, 0.0901, 0.2697, 0.0863, 0.2246, 0.0339, 0.0498, 0.1226,
        0.0320])
[rfa agg] iter:  7, prev_obj_val: 81.87123107910156, obj_val: 85.37995147705078, abs dis: 3.5087203979492188
[rfa agg] iter: 7, weight: tensor([0.0416, 0.0428, 0.0965, 0.3863, 0.0574, 0.1188, 0.0304, 0.0468, 0.1508,
        0.0285])
[rfa agg] iter:  8, prev_obj_val: 85.37995147705078, obj_val: 85.37252807617188, abs dis: 0.00742340087890625
[rfa agg] iter: 8, weight: tensor([0.0447, 0.0460, 0.0899, 0.2839, 0.0857, 0.2119, 0.0339, 0.0497, 0.1223,
        0.0320])
[rfa agg] iter:  9, prev_obj_val: 85.37252807617188, obj_val: 81.87102508544922, abs dis: 3.5015029907226562
[rfa agg] iter: 9, weight: tensor([0.0447, 0.0460, 0.0899, 0.2715, 0.0862, 0.2240, 0.0339, 0.0497, 0.1223,
        0.0320])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3108, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.3127, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.5490577220917 sec.
Server Epoch:79 choose agents : [70, 34, 15, 96, 95, 25, 53, 86, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 351/1418 (24.7532%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 633/1418 (44.6403%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8060, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 406/1427 (28.4513%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 583/1427 (40.8549%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.0455, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9980, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.4337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0477, Accuracy: 376/599 (62.7713%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.9203, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 276/813 (33.9483%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 450/813 (55.3506%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.0330, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   1, Avg loss: 0.0644, Accuracy: 356/1003 (35.4935%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 384/1003 (38.2851%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.7351, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0684, Accuracy: 149/530 (28.1132%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.7313, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0554, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.5755, Accuracy: 50/10000 (0.5000%)
time spent on training: 218.1780743598938
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 311, 599, 690, 813, 1003, 530, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 34, 15, 96, 95, 25, 53, 86, 18, 52], weight: tensor([0.1652, 0.1663, 0.1345, 0.0362, 0.0698, 0.0804, 0.0947, 0.1169, 0.0618,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 49.28745651245117, obj_val: 51.00213623046875, abs dis: 1.7146797180175781
[rfa agg] iter: 0, weight: tensor([0.0659, 0.0665, 0.0959, 0.0145, 0.0624, 0.0949, 0.2916, 0.1981, 0.0443,
        0.0659])
[rfa agg] iter:  1, prev_obj_val: 51.00213623046875, obj_val: 53.949092864990234, abs dis: 2.9469566345214844
[rfa agg] iter: 1, weight: tensor([0.0408, 0.0411, 0.0551, 0.0112, 0.0568, 0.0959, 0.5070, 0.0945, 0.0379,
        0.0598])
[rfa agg] iter:  2, prev_obj_val: 53.949092864990234, obj_val: 53.90940856933594, abs dis: 0.039684295654296875
[rfa agg] iter: 2, weight: tensor([0.0451, 0.0455, 0.0576, 0.0155, 0.1007, 0.2094, 0.2731, 0.0867, 0.0609,
        0.1054])
[rfa agg] iter:  3, prev_obj_val: 53.90940856933594, obj_val: 55.55331039428711, abs dis: 1.6439018249511719
[rfa agg] iter: 3, weight: tensor([0.0452, 0.0456, 0.0577, 0.0155, 0.1019, 0.2188, 0.2602, 0.0869, 0.0612,
        0.1069])
[rfa agg] iter:  4, prev_obj_val: 55.55331039428711, obj_val: 62.26774978637695, abs dis: 6.714439392089844
[rfa agg] iter: 4, weight: tensor([0.0389, 0.0392, 0.0485, 0.0150, 0.1191, 0.3158, 0.1641, 0.0698, 0.0656,
        0.1239])
[rfa agg] iter:  5, prev_obj_val: 62.26774978637695, obj_val: 62.1844367980957, abs dis: 0.08331298828125
[rfa agg] iter: 5, weight: tensor([0.0264, 0.0267, 0.0311, 0.0149, 0.2754, 0.1551, 0.0649, 0.0404, 0.1123,
        0.2529])
[rfa agg] iter:  6, prev_obj_val: 62.1844367980957, obj_val: 65.42404174804688, abs dis: 3.239604949951172
[rfa agg] iter: 6, weight: tensor([0.0237, 0.0239, 0.0278, 0.0134, 0.3054, 0.1331, 0.0579, 0.0362, 0.1027,
        0.2760])
[rfa agg] iter:  7, prev_obj_val: 65.42404174804688, obj_val: 69.03053283691406, abs dis: 3.6064910888671875
[rfa agg] iter: 7, weight: tensor([0.0277, 0.0280, 0.0320, 0.0180, 0.2445, 0.1145, 0.0606, 0.0406, 0.1932,
        0.2409])
[rfa agg] iter:  8, prev_obj_val: 69.03053283691406, obj_val: 65.42864990234375, abs dis: 3.6018829345703125
[rfa agg] iter: 8, weight: tensor([0.0305, 0.0307, 0.0347, 0.0230, 0.1654, 0.1005, 0.0607, 0.0430, 0.3400,
        0.1716])
[rfa agg] iter:  9, prev_obj_val: 65.42864990234375, obj_val: 65.41561889648438, abs dis: 0.013031005859375
[rfa agg] iter: 9, weight: tensor([0.0278, 0.0280, 0.0321, 0.0181, 0.2262, 0.1143, 0.0608, 0.0407, 0.2240,
        0.2279])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.1515200138092 sec.
Server Epoch:80 choose agents : [90, 47, 51, 91, 87, 77, 74, 61, 97, 76].
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0540, Accuracy: 332/677 (49.0399%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8423, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1211, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1067, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 240/1049 (22.8789%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 514/1049 (48.9990%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5771, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0511, Accuracy: 342/1030 (33.2039%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 592/1030 (57.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6385, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.9401, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 566/1340 (42.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7745, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 501/1552 (32.2809%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 751/1552 (48.3892%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.5779, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1198, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3265, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   1, Avg loss: 0.0508, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 481/1213 (39.6538%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.9635, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0821, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0470, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9959, Accuracy: 50/10000 (0.5000%)
time spent on training: 225.94733452796936
[rfa agg] training data poison_ratio: 0.0  data num: [677, 134, 1049, 1030, 1131, 1340, 1552, 85, 1213, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 47, 51, 91, 87, 77, 74, 61, 97, 76], weight: tensor([0.0780, 0.0154, 0.1209, 0.1187, 0.1303, 0.1544, 0.1789, 0.0098, 0.1398,
        0.0537])
[rfa agg] iter:  0, prev_obj_val: 41.19483184814453, obj_val: 43.92647171020508, abs dis: 2.731639862060547
[rfa agg] iter: 0, weight: tensor([0.0431, 0.0033, 0.2576, 0.2437, 0.1674, 0.0845, 0.0549, 0.0019, 0.1250,
        0.0186])
[rfa agg] iter:  1, prev_obj_val: 43.92647171020508, obj_val: 43.92560577392578, abs dis: 0.000865936279296875
[rfa agg] iter: 1, weight: tensor([0.0564, 0.0040, 0.2394, 0.2319, 0.1627, 0.0908, 0.0613, 0.0024, 0.1277,
        0.0234])
			Update norm = 140.46597953330195 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.08303809165955 sec.
Server Epoch:81 choose agents : [60, 92, 18, 24, 50, 96, 61, 90, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 609/2227 (27.3462%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1049/2227 (47.1037%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.2098, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 439/1715 (25.5977%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 727/1715 (42.3907%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5307, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0674, Accuracy: 168/530 (31.6981%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0359, Accuracy: 277/530 (52.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.7363, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0417, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5938, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 145/809 (17.9234%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 348/809 (43.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.6371, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0798, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0545, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.4595, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1271, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3265, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.4368, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 494/1130 (43.7168%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0333, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 441/1154 (38.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3645, Accuracy: 61/10000 (0.6100%)
time spent on training: 238.14372491836548
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1715, 530, 312, 809, 311, 85, 677, 1130, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 92, 18, 24, 50, 96, 61, 90, 54, 15], weight: tensor([0.2488, 0.1916, 0.0592, 0.0349, 0.0904, 0.0347, 0.0095, 0.0756, 0.1263,
        0.1289])
[rfa agg] iter:  0, prev_obj_val: 77.97312927246094, obj_val: 79.04874420166016, abs dis: 1.0756149291992188
[rfa agg] iter: 0, weight: tensor([0.0600, 0.0949, 0.0211, 0.0090, 0.0517, 0.0090, 0.0020, 0.0332, 0.2610,
        0.4582])
[rfa agg] iter:  1, prev_obj_val: 79.04874420166016, obj_val: 81.75643157958984, abs dis: 2.7076873779296875
[rfa agg] iter: 1, weight: tensor([0.0455, 0.0659, 0.0204, 0.0083, 0.0554, 0.0083, 0.0018, 0.0335, 0.4196,
        0.3412])
[rfa agg] iter:  2, prev_obj_val: 81.75643157958984, obj_val: 81.74433898925781, abs dis: 0.01209259033203125
[rfa agg] iter: 2, weight: tensor([0.0567, 0.0784, 0.0303, 0.0119, 0.0906, 0.0119, 0.0026, 0.0514, 0.4204,
        0.2458])
[rfa agg] iter:  3, prev_obj_val: 81.74433898925781, obj_val: 81.7442398071289, abs dis: 9.918212890625e-05
[rfa agg] iter: 3, weight: tensor([0.0565, 0.0780, 0.0302, 0.0119, 0.0905, 0.0118, 0.0026, 0.0512, 0.4263,
        0.2410])
			Update norm = 153.767618401112 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 333.61576771736145 sec.
Server Epoch:82 choose agents : [59, 83, 37, 80, 61, 21, 47, 81, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0585, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/1089 (44.9954%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.9641, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 416/1953 (21.3006%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 731/1953 (37.4296%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8803, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 423/1129 (37.4668%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 753/1129 (66.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8439, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 146/682 (21.4076%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0389, Accuracy: 219/682 (32.1114%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.6925, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1297, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1207, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3252, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 412/1949 (21.1390%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5350, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1201, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1081, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3382, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0349, Accuracy: 336/774 (43.4109%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.9050, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 323/1645 (19.6353%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 625/1645 (37.9939%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3459, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0768, Accuracy: 84/460 (18.2609%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.1928, Accuracy: 50/10000 (0.5000%)
time spent on training: 255.5746865272522
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1953, 1129, 682, 85, 1949, 134, 774, 1645, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 83, 37, 80, 61, 21, 47, 81, 13, 31], weight: tensor([0.1100, 0.1973, 0.1140, 0.0689, 0.0086, 0.1969, 0.0135, 0.0782, 0.1662,
        0.0465])
[rfa agg] iter:  0, prev_obj_val: 70.3464126586914, obj_val: 72.20095825195312, abs dis: 1.8545455932617188
[rfa agg] iter: 0, weight: tensor([0.2071, 0.1208, 0.2193, 0.0423, 0.0028, 0.1205, 0.0046, 0.0599, 0.2007,
        0.0220])
[rfa agg] iter:  1, prev_obj_val: 72.20095825195312, obj_val: 72.91358947753906, abs dis: 0.7126312255859375
[rfa agg] iter: 1, weight: tensor([0.2810, 0.0829, 0.3075, 0.0392, 0.0024, 0.0828, 0.0040, 0.0579, 0.1228,
        0.0196])
[rfa agg] iter:  2, prev_obj_val: 72.91358947753906, obj_val: 73.8266372680664, abs dis: 0.9130477905273438
[rfa agg] iter: 2, weight: tensor([0.3097, 0.0674, 0.3477, 0.0353, 0.0021, 0.0673, 0.0035, 0.0531, 0.0966,
        0.0174])
[rfa agg] iter:  3, prev_obj_val: 73.8266372680664, obj_val: 79.05239868164062, abs dis: 5.225761413574219
[rfa agg] iter: 3, weight: tensor([0.3282, 0.0541, 0.3889, 0.0314, 0.0018, 0.0540, 0.0030, 0.0482, 0.0753,
        0.0152])
[rfa agg] iter:  4, prev_obj_val: 79.05239868164062, obj_val: 79.0483169555664, abs dis: 0.00408172607421875
[rfa agg] iter: 4, weight: tensor([0.3102, 0.0568, 0.3528, 0.0460, 0.0023, 0.0567, 0.0039, 0.0766, 0.0740,
        0.0208])
[rfa agg] iter:  5, prev_obj_val: 79.0483169555664, obj_val: 76.89583587646484, abs dis: 2.1524810791015625
[rfa agg] iter: 5, weight: tensor([0.3107, 0.0571, 0.3500, 0.0463, 0.0023, 0.0570, 0.0039, 0.0773, 0.0745,
        0.0209])
[rfa agg] iter:  6, prev_obj_val: 76.89583587646484, obj_val: 76.8907470703125, abs dis: 0.00508880615234375
[rfa agg] iter: 6, weight: tensor([0.3284, 0.0500, 0.3889, 0.0361, 0.0019, 0.0499, 0.0032, 0.0583, 0.0665,
        0.0167])
[rfa agg] iter:  7, prev_obj_val: 76.8907470703125, obj_val: 76.89065551757812, abs dis: 9.1552734375e-05
[rfa agg] iter: 7, weight: tensor([0.3265, 0.0494, 0.3947, 0.0356, 0.0019, 0.0492, 0.0032, 0.0575, 0.0656,
        0.0165])
			Update norm = 158.27242386546686 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.1492829322815 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 75, 94, 79].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 300/946 (31.7125%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.2229, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 371/1475 (25.1525%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 662/1475 (44.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1268, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0769, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0524, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9609, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0403, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1649, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7633, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0550, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.0437, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0698, Accuracy: 203/669 (30.3438%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0394, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9831, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   1, Avg loss: 0.0642, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1015, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 649/1662 (39.0493%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1866, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   1, Avg loss: 0.1011, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   2, Avg loss: 0.0882, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3690, Accuracy: 50/10000 (0.5000%)
time spent on training: 231.69795966148376
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 776, 1662, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 65, 33, 2, 36, 57, 45, 75, 94, 79], weight: tensor([0.1125, 0.1754, 0.0613, 0.0720, 0.0485, 0.1373, 0.0796, 0.0923, 0.1977,
        0.0234])
[rfa agg] iter:  0, prev_obj_val: 56.116729736328125, obj_val: 59.45121383666992, abs dis: 3.334484100341797
[rfa agg] iter: 0, weight: tensor([0.4251, 0.0736, 0.0337, 0.0465, 0.0204, 0.1364, 0.0627, 0.1271, 0.0673,
        0.0073])
[rfa agg] iter:  1, prev_obj_val: 59.45121383666992, obj_val: 64.26866912841797, abs dis: 4.817455291748047
[rfa agg] iter: 1, weight: tensor([0.2333, 0.0547, 0.0443, 0.0659, 0.0244, 0.0810, 0.1000, 0.3364, 0.0519,
        0.0081])
[rfa agg] iter:  2, prev_obj_val: 64.26866912841797, obj_val: 66.20709991455078, abs dis: 1.9384307861328125
[rfa agg] iter: 2, weight: tensor([0.1234, 0.0492, 0.0675, 0.1134, 0.0325, 0.0656, 0.2174, 0.2735, 0.0476,
        0.0098])
[rfa agg] iter:  3, prev_obj_val: 66.20709991455078, obj_val: 68.3158950805664, abs dis: 2.108795166015625
[rfa agg] iter: 3, weight: tensor([0.0988, 0.0440, 0.0751, 0.1374, 0.0337, 0.0572, 0.3213, 0.1799, 0.0428,
        0.0097])
[rfa agg] iter:  4, prev_obj_val: 68.3158950805664, obj_val: 73.59700775146484, abs dis: 5.2811126708984375
[rfa agg] iter: 4, weight: tensor([0.0725, 0.0354, 0.0773, 0.1591, 0.0316, 0.0449, 0.4212, 0.1147, 0.0346,
        0.0087])
[rfa agg] iter:  5, prev_obj_val: 73.59700775146484, obj_val: 80.00421905517578, abs dis: 6.4072113037109375
[rfa agg] iter: 5, weight: tensor([0.0629, 0.0354, 0.1482, 0.3264, 0.0451, 0.0430, 0.2087, 0.0844, 0.0349,
        0.0109])
[rfa agg] iter:  6, prev_obj_val: 80.00421905517578, obj_val: 79.9576644897461, abs dis: 0.0465545654296875
[rfa agg] iter: 6, weight: tensor([0.0583, 0.0366, 0.3439, 0.2024, 0.0734, 0.0429, 0.1205, 0.0711, 0.0364,
        0.0144])
[rfa agg] iter:  7, prev_obj_val: 79.9576644897461, obj_val: 83.59133911132812, abs dis: 3.6336746215820312
[rfa agg] iter: 7, weight: tensor([0.0524, 0.0329, 0.4193, 0.1739, 0.0661, 0.0385, 0.1073, 0.0639, 0.0327,
        0.0130])
[rfa agg] iter:  8, prev_obj_val: 83.59133911132812, obj_val: 79.95686340332031, abs dis: 3.6344757080078125
[rfa agg] iter: 8, weight: tensor([0.0608, 0.0399, 0.3506, 0.1564, 0.1075, 0.0461, 0.1092, 0.0716, 0.0399,
        0.0180])
[rfa agg] iter:  9, prev_obj_val: 79.95686340332031, obj_val: 83.59184265136719, abs dis: 3.634979248046875
[rfa agg] iter: 9, weight: tensor([0.0517, 0.0325, 0.4289, 0.1693, 0.0654, 0.0381, 0.1058, 0.0632, 0.0323,
        0.0128])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3158, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.3281, Accuracy: 0/9950 (0.0000%)
saving model
Done in 332.40075039863586 sec.
Server Epoch:84 choose agents : [98, 26, 54, 61, 56, 29, 38, 45, 2, 15].
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1, Avg loss: 0.0790, Accuracy: 37/373 (9.9196%)
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.7193, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 357/1446 (24.6888%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 538/1446 (37.2061%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.3116, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1510, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1208, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3289, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3522, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 424/1440 (29.4444%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 645/1440 (44.7917%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.8349, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 254/1131 (22.4580%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 524/1131 (46.3307%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8082, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0660, Accuracy: 207/669 (30.9417%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0414, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.0262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 243/605 (40.1653%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2276, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 322/1154 (27.9029%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2924, Accuracy: 69/10000 (0.6900%)
time spent on training: 235.261981010437
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 26, 54, 61, 56, 29, 38, 45, 2, 15], weight: tensor([0.0454, 0.1759, 0.1375, 0.0103, 0.0226, 0.1752, 0.1376, 0.0814, 0.0736,
        0.1404])
[rfa agg] iter:  0, prev_obj_val: 49.48057556152344, obj_val: 47.17655944824219, abs dis: 2.30401611328125
[rfa agg] iter: 0, weight: tensor([0.0210, 0.1026, 0.2280, 0.0034, 0.0079, 0.1021, 0.2285, 0.0788, 0.0584,
        0.1694])
[rfa agg] iter:  1, prev_obj_val: 47.17655944824219, obj_val: 49.45293045043945, abs dis: 2.2763710021972656
[rfa agg] iter: 1, weight: tensor([0.0176, 0.0969, 0.2483, 0.0029, 0.0068, 0.0965, 0.2482, 0.0629, 0.0474,
        0.1727])
[rfa agg] iter:  2, prev_obj_val: 49.45293045043945, obj_val: 47.176429748535156, abs dis: 2.276500701904297
[rfa agg] iter: 2, weight: tensor([0.0209, 0.1019, 0.2297, 0.0033, 0.0079, 0.1014, 0.2297, 0.0784, 0.0580,
        0.1688])
[rfa agg] iter:  3, prev_obj_val: 47.176429748535156, obj_val: 49.45294189453125, abs dis: 2.2765121459960938
[rfa agg] iter: 3, weight: tensor([0.0176, 0.0969, 0.2483, 0.0029, 0.0068, 0.0965, 0.2482, 0.0628, 0.0474,
        0.1726])
[rfa agg] iter:  4, prev_obj_val: 49.45294189453125, obj_val: 47.176429748535156, abs dis: 2.2765121459960938
[rfa agg] iter: 4, weight: tensor([0.0209, 0.1019, 0.2297, 0.0033, 0.0079, 0.1014, 0.2297, 0.0784, 0.0580,
        0.1688])
[rfa agg] iter:  5, prev_obj_val: 47.176429748535156, obj_val: 49.45294189453125, abs dis: 2.2765121459960938
[rfa agg] iter: 5, weight: tensor([0.0176, 0.0969, 0.2483, 0.0029, 0.0068, 0.0965, 0.2482, 0.0628, 0.0474,
        0.1726])
[rfa agg] iter:  6, prev_obj_val: 49.45294189453125, obj_val: 47.176429748535156, abs dis: 2.2765121459960938
[rfa agg] iter: 6, weight: tensor([0.0209, 0.1019, 0.2297, 0.0033, 0.0079, 0.1014, 0.2297, 0.0784, 0.0580,
        0.1688])
[rfa agg] iter:  7, prev_obj_val: 47.176429748535156, obj_val: 49.45294189453125, abs dis: 2.2765121459960938
[rfa agg] iter: 7, weight: tensor([0.0176, 0.0969, 0.2483, 0.0029, 0.0068, 0.0965, 0.2482, 0.0628, 0.0474,
        0.1726])
[rfa agg] iter:  8, prev_obj_val: 49.45294189453125, obj_val: 47.176429748535156, abs dis: 2.2765121459960938
[rfa agg] iter: 8, weight: tensor([0.0209, 0.1019, 0.2297, 0.0033, 0.0079, 0.1014, 0.2297, 0.0784, 0.0580,
        0.1688])
[rfa agg] iter:  9, prev_obj_val: 47.176429748535156, obj_val: 49.45294189453125, abs dis: 2.2765121459960938
[rfa agg] iter: 9, weight: tensor([0.0176, 0.0969, 0.2483, 0.0029, 0.0068, 0.0965, 0.2482, 0.0628, 0.0474,
        0.1726])
			Update norm = 140.2225978689776 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3158, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.3281, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.6988389492035 sec.
Server Epoch:85 choose agents : [83, 3, 85, 18, 96, 8, 88, 79, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 449/1953 (22.9903%)
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 805/1953 (41.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8021, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0736, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9993, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2996, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0655, Accuracy: 157/530 (29.6226%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.0330, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   1, Avg loss: 0.0798, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.4787, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 480/1513 (31.7250%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4402, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4326, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1, Avg loss: 0.0995, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2, Avg loss: 0.0845, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0617, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0081, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0589, Accuracy: 337/803 (41.9676%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 399/803 (49.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.1861, Accuracy: 53/10000 (0.5300%)
time spent on training: 258.93991589546204
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 781, 1988, 530, 311, 1513, 603, 197, 715, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 3, 85, 18, 96, 8, 88, 79, 23, 58], weight: tensor([0.2079, 0.0831, 0.2116, 0.0564, 0.0331, 0.1611, 0.0642, 0.0210, 0.0761,
        0.0855])
[rfa agg] iter:  0, prev_obj_val: 84.79176330566406, obj_val: 86.9371109008789, abs dis: 2.1453475952148438
[rfa agg] iter: 0, weight: tensor([0.1482, 0.1045, 0.1388, 0.0441, 0.0187, 0.2890, 0.0554, 0.0111, 0.0829,
        0.1072])
[rfa agg] iter:  1, prev_obj_val: 86.9371109008789, obj_val: 88.38487243652344, abs dis: 1.4477615356445312
[rfa agg] iter: 1, weight: tensor([0.1309, 0.1351, 0.1237, 0.0513, 0.0209, 0.2187, 0.0656, 0.0123, 0.1032,
        0.1384])
[rfa agg] iter:  2, prev_obj_val: 88.38487243652344, obj_val: 89.85122680664062, abs dis: 1.4663543701171875
[rfa agg] iter: 2, weight: tensor([0.1151, 0.1591, 0.1093, 0.0546, 0.0214, 0.1775, 0.0709, 0.0125, 0.1168,
        0.1629])
[rfa agg] iter:  3, prev_obj_val: 89.85122680664062, obj_val: 91.34855651855469, abs dis: 1.4973297119140625
[rfa agg] iter: 3, weight: tensor([0.0961, 0.1883, 0.0917, 0.0557, 0.0209, 0.1391, 0.0739, 0.0121, 0.1299,
        0.1923])
[rfa agg] iter:  4, prev_obj_val: 91.34855651855469, obj_val: 95.12523651123047, abs dis: 3.7766799926757812
[rfa agg] iter: 4, weight: tensor([0.0740, 0.2267, 0.0709, 0.0533, 0.0188, 0.1016, 0.0727, 0.0108, 0.1406,
        0.2304])
[rfa agg] iter:  5, prev_obj_val: 95.12523651123047, obj_val: 101.90482330322266, abs dis: 6.7795867919921875
[rfa agg] iter: 5, weight: tensor([0.0280, 0.3439, 0.0269, 0.0337, 0.0100, 0.0354, 0.0508, 0.0056, 0.1488,
        0.3170])
[rfa agg] iter:  6, prev_obj_val: 101.90482330322266, obj_val: 101.84333038330078, abs dis: 0.061492919921875
[rfa agg] iter: 6, weight: tensor([0.0365, 0.1795, 0.0353, 0.0741, 0.0173, 0.0440, 0.1354, 0.0095, 0.2864,
        0.1820])
[rfa agg] iter:  7, prev_obj_val: 101.84333038330078, obj_val: 99.22090911865234, abs dis: 2.6224212646484375
[rfa agg] iter: 7, weight: tensor([0.0351, 0.1680, 0.0339, 0.0717, 0.0167, 0.0423, 0.1320, 0.0091, 0.3206,
        0.1706])
[rfa agg] iter:  8, prev_obj_val: 99.22090911865234, obj_val: 110.69317626953125, abs dis: 11.472267150878906
[rfa agg] iter: 8, weight: tensor([0.0300, 0.1912, 0.0290, 0.0504, 0.0129, 0.0368, 0.0848, 0.0072, 0.3657,
        0.1920])
[rfa agg] iter:  9, prev_obj_val: 110.69317626953125, obj_val: 107.5487289428711, abs dis: 3.1444473266601562
[rfa agg] iter: 9, weight: tensor([0.0348, 0.0954, 0.0338, 0.1610, 0.0230, 0.0404, 0.3724, 0.0122, 0.1293,
        0.0977])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3180, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.3376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.0582332611084 sec.
Server Epoch:86 choose agents : [57, 99, 60, 19, 35, 84, 81, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 303/1154 (26.2565%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 461/1154 (39.9480%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1225, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0300, Accuracy: 416/773 (53.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5570, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 572/2227 (25.6848%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4948, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 414/1036 (39.9614%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 624/1036 (60.2317%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9628, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 29/271 (10.7011%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0570, Accuracy: 112/271 (41.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.5288, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 310/1190 (26.0504%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3931, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0661, Accuracy: 234/774 (30.2326%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0367, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.5312, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 404/1750 (23.0857%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 669/1750 (38.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.7482, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0583, Accuracy: 341/719 (47.4270%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8671, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0560, Accuracy: 329/1089 (30.2112%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0354, Accuracy: 492/1089 (45.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.5948, Accuracy: 69/10000 (0.6900%)
time spent on training: 274.82473039627075
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 773, 2227, 1036, 271, 1190, 774, 1750, 719, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [57, 99, 60, 19, 35, 84, 81, 44, 41, 59], weight: tensor([0.1051, 0.0704, 0.2028, 0.0943, 0.0247, 0.1083, 0.0705, 0.1593, 0.0655,
        0.0992])
[rfa agg] iter:  0, prev_obj_val: 61.889434814453125, obj_val: 67.36983489990234, abs dis: 5.480400085449219
[rfa agg] iter: 0, weight: tensor([0.2776, 0.0298, 0.0324, 0.1114, 0.0045, 0.2760, 0.0298, 0.0451, 0.0238,
        0.1698])
[rfa agg] iter:  1, prev_obj_val: 67.36983489990234, obj_val: 69.45707702636719, abs dis: 2.0872421264648438
[rfa agg] iter: 1, weight: tensor([0.1283, 0.0627, 0.0351, 0.3088, 0.0069, 0.1323, 0.0627, 0.0443, 0.0458,
        0.1734])
[rfa agg] iter:  2, prev_obj_val: 69.45707702636719, obj_val: 71.76110076904297, abs dis: 2.3040237426757812
[rfa agg] iter: 2, weight: tensor([0.1192, 0.0810, 0.0380, 0.2867, 0.0080, 0.1229, 0.0812, 0.0473, 0.0573,
        0.1584])
[rfa agg] iter:  3, prev_obj_val: 71.76110076904297, obj_val: 76.51383209228516, abs dis: 4.7527313232421875
[rfa agg] iter: 3, weight: tensor([0.1153, 0.1071, 0.0413, 0.2310, 0.0093, 0.1189, 0.1073, 0.0506, 0.0726,
        0.1464])
[rfa agg] iter:  4, prev_obj_val: 76.51383209228516, obj_val: 76.49925994873047, abs dis: 0.0145721435546875
[rfa agg] iter: 4, weight: tensor([0.0938, 0.1726, 0.0405, 0.1497, 0.0106, 0.0967, 0.1732, 0.0483, 0.1028,
        0.1117])
[rfa agg] iter:  5, prev_obj_val: 76.49925994873047, obj_val: 78.94163513183594, abs dis: 2.4423751831054688
[rfa agg] iter: 5, weight: tensor([0.0933, 0.1746, 0.0403, 0.1480, 0.0106, 0.0962, 0.1753, 0.0481, 0.1029,
        0.1107])
[rfa agg] iter:  6, prev_obj_val: 78.94163513183594, obj_val: 81.4738540649414, abs dis: 2.5322189331054688
[rfa agg] iter: 6, weight: tensor([0.0770, 0.2174, 0.0360, 0.1141, 0.0102, 0.0794, 0.2189, 0.0424, 0.1152,
        0.0894])
[rfa agg] iter:  7, prev_obj_val: 81.4738540649414, obj_val: 84.27072143554688, abs dis: 2.7968673706054688
[rfa agg] iter: 7, weight: tensor([0.0583, 0.2672, 0.0292, 0.0816, 0.0090, 0.0601, 0.2716, 0.0340, 0.1228,
        0.0664])
[rfa agg] iter:  8, prev_obj_val: 84.27072143554688, obj_val: 91.27108001708984, abs dis: 7.000358581542969
[rfa agg] iter: 8, weight: tensor([0.0444, 0.2960, 0.0237, 0.0595, 0.0079, 0.0458, 0.3065, 0.0273, 0.1391,
        0.0498])
[rfa agg] iter:  9, prev_obj_val: 91.27108001708984, obj_val: 87.57586669921875, abs dis: 3.6952133178710938
[rfa agg] iter: 9, weight: tensor([0.0485, 0.1974, 0.0288, 0.0609, 0.0115, 0.0500, 0.2002, 0.0325, 0.3172,
        0.0530])
			Update norm = 113.30316598345784 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3180, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.3376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.94841599464417 sec.
Server Epoch:87 choose agents : [85, 29, 54, 69, 86, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 444/1988 (22.3340%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 627/1988 (31.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.2700, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0499, Accuracy: 438/1440 (30.4167%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 675/1440 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6467, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 468/1130 (41.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5130, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0331, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.2395, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 380/1003 (37.8863%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.8123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 202/669 (30.1943%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0394, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.9455, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 349/1446 (24.1355%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 507/1446 (35.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5411, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1200, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1076, Accuracy: 32/134 (23.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0757, Accuracy: 87/515 (16.8932%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1021, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.3933, Accuracy: 54/10000 (0.5400%)
time spent on training: 278.3228566646576
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1440, 1130, 590, 1003, 669, 1446, 134, 515, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 29, 54, 69, 86, 45, 26, 47, 33, 57], weight: tensor([0.1974, 0.1430, 0.1122, 0.0586, 0.0996, 0.0664, 0.1436, 0.0133, 0.0511,
        0.1146])
[rfa agg] iter:  0, prev_obj_val: 55.55808639526367, obj_val: 59.6296272277832, abs dis: 4.071540832519531
[rfa agg] iter: 0, weight: tensor([0.0432, 0.0921, 0.3033, 0.0203, 0.1095, 0.0261, 0.0922, 0.0025, 0.0159,
        0.2948])
[rfa agg] iter:  1, prev_obj_val: 59.6296272277832, obj_val: 65.99137878417969, abs dis: 6.361751556396484
[rfa agg] iter: 1, weight: tensor([0.0440, 0.0788, 0.2941, 0.0279, 0.2387, 0.0368, 0.0790, 0.0032, 0.0213,
        0.1762])
[rfa agg] iter:  2, prev_obj_val: 65.99137878417969, obj_val: 68.54925537109375, abs dis: 2.5578765869140625
[rfa agg] iter: 2, weight: tensor([0.0456, 0.0721, 0.1641, 0.0403, 0.3962, 0.0556, 0.0723, 0.0040, 0.0298,
        0.1201])
[rfa agg] iter:  3, prev_obj_val: 68.54925537109375, obj_val: 65.94049835205078, abs dis: 2.6087570190429688
[rfa agg] iter: 3, weight: tensor([0.0499, 0.0764, 0.1547, 0.0500, 0.3616, 0.0703, 0.0766, 0.0048, 0.0365,
        0.1192])
[rfa agg] iter:  4, prev_obj_val: 65.94049835205078, obj_val: 65.93241119384766, abs dis: 0.008087158203125
[rfa agg] iter: 4, weight: tensor([0.0432, 0.0684, 0.1533, 0.0383, 0.4297, 0.0528, 0.0686, 0.0038, 0.0283,
        0.1135])
[rfa agg] iter:  5, prev_obj_val: 65.93241119384766, obj_val: 63.51214599609375, abs dis: 2.4202651977539062
[rfa agg] iter: 5, weight: tensor([0.0420, 0.0664, 0.1487, 0.0372, 0.4467, 0.0512, 0.0666, 0.0037, 0.0275,
        0.1100])
[rfa agg] iter:  6, prev_obj_val: 63.51214599609375, obj_val: 68.568359375, abs dis: 5.05621337890625
[rfa agg] iter: 6, weight: tensor([0.0362, 0.0593, 0.1501, 0.0285, 0.4983, 0.0386, 0.0595, 0.0030, 0.0213,
        0.1053])
[rfa agg] iter:  7, prev_obj_val: 68.568359375, obj_val: 68.54766082763672, abs dis: 0.02069854736328125
[rfa agg] iter: 7, weight: tensor([0.0492, 0.0751, 0.1517, 0.0492, 0.3729, 0.0690, 0.0754, 0.0047, 0.0359,
        0.1170])
[rfa agg] iter:  8, prev_obj_val: 68.54766082763672, obj_val: 65.9409408569336, abs dis: 2.606719970703125
[rfa agg] iter: 8, weight: tensor([0.0501, 0.0767, 0.1552, 0.0502, 0.3592, 0.0706, 0.0769, 0.0048, 0.0366,
        0.1197])
[rfa agg] iter:  9, prev_obj_val: 65.9409408569336, obj_val: 65.93244934082031, abs dis: 0.00849151611328125
[rfa agg] iter: 9, weight: tensor([0.0433, 0.0685, 0.1535, 0.0384, 0.4291, 0.0528, 0.0687, 0.0038, 0.0284,
        0.1136])
			Update norm = 139.97367916638828 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3180, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.3376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.2297351360321 sec.
Server Epoch:88 choose agents : [62, 82, 84, 18, 63, 67, 29, 37, 86, 79].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 84/500 (16.8000%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.0338, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 476/1190 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3556, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0653, Accuracy: 184/530 (34.7170%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.9041, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 265/888 (29.8423%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9054, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0759, Accuracy: 46/426 (10.7981%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0402, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1433, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0484, Accuracy: 428/1440 (29.7222%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 668/1440 (46.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8326, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 392/1129 (34.7210%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 716/1129 (63.4190%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5121, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8629, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   2, Avg loss: 0.0900, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3708, Accuracy: 50/10000 (0.5000%)
time spent on training: 250.00284457206726
[rfa agg] training data poison_ratio: 0.0  data num: [568, 500, 1190, 530, 888, 426, 1440, 1129, 1003, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 82, 84, 18, 63, 67, 29, 37, 86, 79], weight: tensor([0.0722, 0.0635, 0.1512, 0.0673, 0.1128, 0.0541, 0.1830, 0.1434, 0.1274,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 45.66060256958008, obj_val: 52.61872482299805, abs dis: 6.958122253417969
[rfa agg] iter: 0, weight: tensor([0.0443, 0.0325, 0.0922, 0.0412, 0.4075, 0.0238, 0.0625, 0.1069, 0.1815,
        0.0077])
[rfa agg] iter:  1, prev_obj_val: 52.61872482299805, obj_val: 56.443790435791016, abs dis: 3.8250656127929688
[rfa agg] iter: 1, weight: tensor([0.1060, 0.0707, 0.0967, 0.0986, 0.2443, 0.0484, 0.0747, 0.1059, 0.1406,
        0.0140])
[rfa agg] iter:  2, prev_obj_val: 56.443790435791016, obj_val: 58.3833122253418, abs dis: 1.9395217895507812
[rfa agg] iter: 2, weight: tensor([0.1578, 0.0943, 0.0851, 0.1457, 0.1658, 0.0607, 0.0689, 0.0917, 0.1139,
        0.0161])
[rfa agg] iter:  3, prev_obj_val: 58.3833122253418, obj_val: 62.39934539794922, abs dis: 4.016033172607422
[rfa agg] iter: 3, weight: tensor([0.1932, 0.1047, 0.0745, 0.1767, 0.1326, 0.0645, 0.0615, 0.0797, 0.0965,
        0.0161])
[rfa agg] iter:  4, prev_obj_val: 62.39934539794922, obj_val: 74.4166030883789, abs dis: 12.017257690429688
[rfa agg] iter: 4, weight: tensor([0.3046, 0.1126, 0.0445, 0.2569, 0.0694, 0.0598, 0.0380, 0.0470, 0.0546,
        0.0126])
[rfa agg] iter:  5, prev_obj_val: 74.4166030883789, obj_val: 70.79328918457031, abs dis: 3.6233139038085938
[rfa agg] iter: 5, weight: tensor([0.1382, 0.2657, 0.0387, 0.1265, 0.0508, 0.2405, 0.0348, 0.0401, 0.0440,
        0.0206])
[rfa agg] iter:  6, prev_obj_val: 70.79328918457031, obj_val: 70.7808609008789, abs dis: 0.01242828369140625
[rfa agg] iter: 6, weight: tensor([0.1589, 0.3875, 0.0326, 0.1399, 0.0443, 0.1217, 0.0289, 0.0339, 0.0377,
        0.0146])
[rfa agg] iter:  7, prev_obj_val: 70.7808609008789, obj_val: 70.7795181274414, abs dis: 0.0013427734375
[rfa agg] iter: 7, weight: tensor([0.1490, 0.4275, 0.0306, 0.1309, 0.0416, 0.1123, 0.0272, 0.0318, 0.0354,
        0.0138])
[rfa agg] iter:  8, prev_obj_val: 70.7795181274414, obj_val: 67.57786560058594, abs dis: 3.2016525268554688
[rfa agg] iter: 8, weight: tensor([0.1444, 0.4446, 0.0298, 0.1267, 0.0404, 0.1089, 0.0264, 0.0309, 0.0344,
        0.0134])
[rfa agg] iter:  9, prev_obj_val: 67.57786560058594, obj_val: 67.54757690429688, abs dis: 0.0302886962890625
[rfa agg] iter: 9, weight: tensor([0.2577, 0.2559, 0.0337, 0.2058, 0.0476, 0.0818, 0.0296, 0.0352, 0.0397,
        0.0129])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3204, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.3507, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.1426930427551 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 95, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 311/946 (32.8753%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 328/946 (34.6723%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2216, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0680, Accuracy: 121/631 (19.1759%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 217/631 (34.3899%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3247, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0529, Accuracy: 434/1587 (27.3472%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 629/1587 (39.6345%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3617, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 380/1628 (23.3415%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 781/1628 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7300, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0675, Accuracy: 205/669 (30.6428%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0402, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2210, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0744, Accuracy: 61/426 (14.3192%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0381, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.1064, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1, Avg loss: 0.0476, Accuracy: 391/599 (65.2755%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2, Avg loss: 0.0269, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0452, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 510/1013 (50.3455%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0116, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 292/708 (41.2429%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0971, Accuracy: 53/10000 (0.5300%)
time spent on training: 273.10219049453735
[rfa agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 599, 715, 1013, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 48, 27, 5, 45, 67, 95, 23, 39, 16], weight: tensor([0.1060, 0.0707, 0.1779, 0.1825, 0.0750, 0.0477, 0.0671, 0.0801, 0.1135,
        0.0794])
[rfa agg] iter:  0, prev_obj_val: 53.72844696044922, obj_val: 57.33695602416992, abs dis: 3.608509063720703
[rfa agg] iter: 0, weight: tensor([0.2737, 0.0566, 0.0525, 0.0494, 0.0791, 0.0221, 0.0538, 0.1196, 0.1713,
        0.1219])
[rfa agg] iter:  1, prev_obj_val: 57.33695602416992, obj_val: 61.264007568359375, abs dis: 3.927051544189453
[rfa agg] iter: 1, weight: tensor([0.0779, 0.0748, 0.0307, 0.0292, 0.1373, 0.0213, 0.0708, 0.2289, 0.0627,
        0.2664])
[rfa agg] iter:  2, prev_obj_val: 61.264007568359375, obj_val: 70.52645874023438, abs dis: 9.262451171875
[rfa agg] iter: 2, weight: tensor([0.0582, 0.1284, 0.0284, 0.0272, 0.2574, 0.0264, 0.1219, 0.1466, 0.0501,
        0.1553])
[rfa agg] iter:  3, prev_obj_val: 70.52645874023438, obj_val: 74.33807373046875, abs dis: 3.811614990234375
[rfa agg] iter: 3, weight: tensor([0.0543, 0.2412, 0.0326, 0.0314, 0.1336, 0.0531, 0.2297, 0.0871, 0.0493,
        0.0877])
[rfa agg] iter:  4, prev_obj_val: 74.33807373046875, obj_val: 70.48210906982422, abs dis: 3.8559646606445312
[rfa agg] iter: 4, weight: tensor([0.0614, 0.2149, 0.0389, 0.0375, 0.1249, 0.0810, 0.2044, 0.0900, 0.0564,
        0.0905])
[rfa agg] iter:  5, prev_obj_val: 70.48210906982422, obj_val: 70.47953033447266, abs dis: 0.0025787353515625
[rfa agg] iter: 5, weight: tensor([0.0524, 0.2515, 0.0315, 0.0303, 0.1259, 0.0515, 0.2415, 0.0834, 0.0476,
        0.0844])
[rfa agg] iter:  6, prev_obj_val: 70.47953033447266, obj_val: 74.33916473388672, abs dis: 3.8596343994140625
[rfa agg] iter: 6, weight: tensor([0.0520, 0.2547, 0.0312, 0.0301, 0.1247, 0.0510, 0.2431, 0.0825, 0.0472,
        0.0836])
[rfa agg] iter:  7, prev_obj_val: 74.33916473388672, obj_val: 70.48204803466797, abs dis: 3.85711669921875
[rfa agg] iter: 7, weight: tensor([0.0613, 0.2154, 0.0388, 0.0375, 0.1246, 0.0809, 0.2049, 0.0898, 0.0563,
        0.0904])
[rfa agg] iter:  8, prev_obj_val: 70.48204803466797, obj_val: 70.47953033447266, abs dis: 0.0025177001953125
[rfa agg] iter: 8, weight: tensor([0.0524, 0.2516, 0.0315, 0.0303, 0.1259, 0.0515, 0.2415, 0.0834, 0.0476,
        0.0844])
[rfa agg] iter:  9, prev_obj_val: 70.47953033447266, obj_val: 74.33916473388672, abs dis: 3.8596343994140625
[rfa agg] iter: 9, weight: tensor([0.0520, 0.2547, 0.0312, 0.0301, 0.1247, 0.0510, 0.2431, 0.0825, 0.0472,
        0.0836])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3233, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.3593, Accuracy: 0/9950 (0.0000%)
saving model
Done in 370.6999156475067 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 76, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 315/690 (45.6522%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.9313, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0576, Accuracy: 343/719 (47.7051%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0328, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8470, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 312/1013 (30.7996%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 480/1013 (47.3840%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7756, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0555, Accuracy: 346/1573 (21.9962%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 580/1573 (36.8722%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3934, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0565, Accuracy: 396/1427 (27.7505%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 615/1427 (43.0974%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2018, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   1, Avg loss: 0.0839, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.1615, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 419/1440 (29.0972%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 667/1440 (46.3194%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.0605, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 160/818 (19.5599%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6188, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0585, Accuracy: 276/1513 (18.2419%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5962, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 295/813 (36.2854%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.0022, Accuracy: 49/10000 (0.4900%)
time spent on training: 307.1342680454254
[rfa agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 466, 1440, 818, 1513, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 41, 39, 40, 34, 76, 29, 71, 8, 53], weight: tensor([0.0659, 0.0687, 0.0967, 0.1502, 0.1363, 0.0445, 0.1375, 0.0781, 0.1445,
        0.0776])
[rfa agg] iter:  0, prev_obj_val: 51.83209991455078, obj_val: 53.3602409362793, abs dis: 1.5281410217285156
[rfa agg] iter: 0, weight: tensor([0.0478, 0.0593, 0.3346, 0.0817, 0.0982, 0.0216, 0.0992, 0.0842, 0.0896,
        0.0838])
[rfa agg] iter:  1, prev_obj_val: 53.3602409362793, obj_val: 59.1079216003418, abs dis: 5.7476806640625
[rfa agg] iter: 1, weight: tensor([0.0397, 0.0510, 0.5166, 0.0504, 0.0585, 0.0168, 0.0591, 0.0771, 0.0544,
        0.0765])
[rfa agg] iter:  2, prev_obj_val: 59.1079216003418, obj_val: 62.504005432128906, abs dis: 3.3960838317871094
[rfa agg] iter: 2, weight: tensor([0.0736, 0.1076, 0.1629, 0.0467, 0.0517, 0.0253, 0.0522, 0.2189, 0.0494,
        0.2117])
[rfa agg] iter:  3, prev_obj_val: 62.504005432128906, obj_val: 67.99868774414062, abs dis: 5.494682312011719
[rfa agg] iter: 3, weight: tensor([0.0672, 0.1171, 0.0668, 0.0266, 0.0288, 0.0188, 0.0291, 0.3168, 0.0278,
        0.3010])
[rfa agg] iter:  4, prev_obj_val: 67.99868774414062, obj_val: 71.22042846679688, abs dis: 3.22174072265625
[rfa agg] iter: 4, weight: tensor([0.1502, 0.2500, 0.0635, 0.0308, 0.0330, 0.0295, 0.0333, 0.1901, 0.0321,
        0.1874])
[rfa agg] iter:  5, prev_obj_val: 71.22042846679688, obj_val: 78.58183288574219, abs dis: 7.3614044189453125
[rfa agg] iter: 5, weight: tensor([0.2502, 0.2466, 0.0600, 0.0315, 0.0334, 0.0356, 0.0338, 0.1388, 0.0327,
        0.1375])
[rfa agg] iter:  6, prev_obj_val: 78.58183288574219, obj_val: 78.57013702392578, abs dis: 0.01169586181640625
[rfa agg] iter: 6, weight: tensor([0.3423, 0.1543, 0.0634, 0.0376, 0.0395, 0.0633, 0.0399, 0.1108, 0.0389,
        0.1099])
[rfa agg] iter:  7, prev_obj_val: 78.57013702392578, obj_val: 86.59011840820312, abs dis: 8.019981384277344
[rfa agg] iter: 7, weight: tensor([0.3586, 0.1484, 0.0621, 0.0369, 0.0387, 0.0621, 0.0391, 0.1085, 0.0381,
        0.1075])
[rfa agg] iter:  8, prev_obj_val: 86.59011840820312, obj_val: 71.23241424560547, abs dis: 15.357704162597656
[rfa agg] iter: 8, weight: tensor([0.2170, 0.1356, 0.0757, 0.0495, 0.0515, 0.1431, 0.0520, 0.1127, 0.0509,
        0.1119])
[rfa agg] iter:  9, prev_obj_val: 71.23241424560547, obj_val: 78.57868194580078, abs dis: 7.3462677001953125
[rfa agg] iter: 9, weight: tensor([0.2661, 0.2290, 0.0606, 0.0317, 0.0337, 0.0360, 0.0341, 0.1387, 0.0330,
        0.1370])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3256, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.3676, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.37097215652466 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 90, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0857, Accuracy: 86/408 (21.0784%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0526, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.9275, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 569/1427 (39.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5914, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0621, Accuracy: 173/818 (21.1491%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8528, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0530, Accuracy: 349/712 (49.0169%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 436/712 (61.2360%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.0747, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0600, Accuracy: 277/1241 (22.3207%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3289, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   1, Avg loss: 0.0555, Accuracy: 328/677 (48.4490%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2682, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 436/888 (49.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.1363, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 118/781 (15.1088%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 265/781 (33.9309%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.0831, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 151/809 (18.6650%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 342/809 (42.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2001, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7684, Accuracy: 50/10000 (0.5000%)
time spent on training: 266.0782446861267
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 677, 888, 781, 809, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 34, 71, 11, 72, 90, 63, 3, 50, 24], weight: tensor([0.0505, 0.1768, 0.1013, 0.0882, 0.1537, 0.0839, 0.1100, 0.0967, 0.1002,
        0.0386])
[rfa agg] iter:  0, prev_obj_val: 36.636322021484375, obj_val: 42.401832580566406, abs dis: 5.765510559082031
[rfa agg] iter: 0, weight: tensor([0.0122, 0.0255, 0.2040, 0.1045, 0.0317, 0.0590, 0.1313, 0.2064, 0.2184,
        0.0070])
[rfa agg] iter:  1, prev_obj_val: 42.401832580566406, obj_val: 42.344661712646484, abs dis: 0.057170867919921875
[rfa agg] iter: 1, weight: tensor([0.0224, 0.0307, 0.1264, 0.2116, 0.0361, 0.2291, 0.0857, 0.1197, 0.1264,
        0.0119])
[rfa agg] iter:  2, prev_obj_val: 42.344661712646484, obj_val: 45.283592224121094, abs dis: 2.9389305114746094
[rfa agg] iter: 2, weight: tensor([0.0216, 0.0296, 0.1202, 0.2216, 0.0348, 0.2439, 0.0823, 0.1141, 0.1205,
        0.0115])
[rfa agg] iter:  3, prev_obj_val: 45.283592224121094, obj_val: 48.63945007324219, abs dis: 3.3558578491210938
[rfa agg] iter: 3, weight: tensor([0.0252, 0.0294, 0.0968, 0.1532, 0.0341, 0.3881, 0.0718, 0.0920, 0.0965,
        0.0129])
[rfa agg] iter:  4, prev_obj_val: 48.63945007324219, obj_val: 52.20144271850586, abs dis: 3.561992645263672
[rfa agg] iter: 4, weight: tensor([0.0366, 0.0361, 0.1004, 0.1386, 0.0413, 0.3545, 0.0791, 0.0956, 0.0999,
        0.0179])
[rfa agg] iter:  5, prev_obj_val: 52.20144271850586, obj_val: 52.198421478271484, abs dis: 0.003021240234375
[rfa agg] iter: 5, weight: tensor([0.0557, 0.0454, 0.1105, 0.1406, 0.0513, 0.2648, 0.0909, 0.1053, 0.1097,
        0.0258])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3280, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.3752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.4197416305542 sec.
Server Epoch:92 choose agents : [91, 89, 76, 1, 58, 42, 94, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   1, Avg loss: 0.0512, Accuracy: 345/1030 (33.4951%)
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 571/1030 (55.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0932, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 421/896 (46.9866%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.7079, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0821, Accuracy: 66/466 (14.1631%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0456, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.3490, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 298/928 (32.1121%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 582/928 (62.7155%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4424, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.3938, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 339/1372 (24.7085%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 532/1372 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3829, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 357/1662 (21.4801%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 623/1662 (37.4850%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0443, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 303/1013 (29.9112%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.1558, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 398/1440 (27.6389%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 691/1440 (47.9861%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3550, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0761, Accuracy: 100/486 (20.5761%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.3724, Accuracy: 51/10000 (0.5100%)
time spent on training: 282.7547845840454
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 896, 466, 928, 803, 1372, 1662, 1013, 1440, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 89, 76, 1, 58, 42, 94, 14, 29, 30], weight: tensor([0.1020, 0.0887, 0.0462, 0.0919, 0.0795, 0.1359, 0.1646, 0.1003, 0.1426,
        0.0481])
[rfa agg] iter:  0, prev_obj_val: 45.936954498291016, obj_val: 54.08816909790039, abs dis: 8.151214599609375
[rfa agg] iter: 0, weight: tensor([0.1369, 0.1261, 0.0148, 0.2217, 0.0741, 0.0500, 0.0378, 0.2776, 0.0457,
        0.0155])
[rfa agg] iter:  1, prev_obj_val: 54.08816909790039, obj_val: 60.25651550292969, abs dis: 6.168346405029297
[rfa agg] iter: 1, weight: tensor([0.0757, 0.2577, 0.0224, 0.1490, 0.2478, 0.0428, 0.0354, 0.1054, 0.0403,
        0.0235])
[rfa agg] iter:  2, prev_obj_val: 60.25651550292969, obj_val: 56.9244499206543, abs dis: 3.3320655822753906
[rfa agg] iter: 2, weight: tensor([0.0719, 0.1777, 0.0330, 0.1137, 0.3477, 0.0463, 0.0396, 0.0915, 0.0440,
        0.0346])
[rfa agg] iter:  3, prev_obj_val: 56.9244499206543, obj_val: 60.24476623535156, abs dis: 3.3203163146972656
[rfa agg] iter: 3, weight: tensor([0.0614, 0.1821, 0.0228, 0.1053, 0.4192, 0.0374, 0.0315, 0.0811, 0.0354,
        0.0239])
[rfa agg] iter:  4, prev_obj_val: 60.24476623535156, obj_val: 67.303466796875, abs dis: 7.0587005615234375
[rfa agg] iter: 4, weight: tensor([0.0687, 0.1677, 0.0316, 0.1082, 0.3787, 0.0443, 0.0379, 0.0875, 0.0422,
        0.0331])
[rfa agg] iter:  5, prev_obj_val: 67.303466796875, obj_val: 60.254859924316406, abs dis: 7.048606872558594
[rfa agg] iter: 5, weight: tensor([0.0852, 0.1599, 0.0605, 0.1193, 0.2376, 0.0602, 0.0530, 0.1030, 0.0578,
        0.0636])
[rfa agg] iter:  6, prev_obj_val: 60.254859924316406, obj_val: 56.92436599731445, abs dis: 3.330493927001953
[rfa agg] iter: 6, weight: tensor([0.0721, 0.1746, 0.0331, 0.1138, 0.3498, 0.0464, 0.0397, 0.0917, 0.0441,
        0.0347])
[rfa agg] iter:  7, prev_obj_val: 56.92436599731445, obj_val: 60.24480438232422, abs dis: 3.3204383850097656
[rfa agg] iter: 7, weight: tensor([0.0614, 0.1817, 0.0228, 0.1052, 0.4200, 0.0373, 0.0314, 0.0810, 0.0353,
        0.0238])
[rfa agg] iter:  8, prev_obj_val: 60.24480438232422, obj_val: 67.30348205566406, abs dis: 7.058677673339844
[rfa agg] iter: 8, weight: tensor([0.0687, 0.1676, 0.0316, 0.1082, 0.3789, 0.0443, 0.0379, 0.0875, 0.0421,
        0.0331])
[rfa agg] iter:  9, prev_obj_val: 67.30348205566406, obj_val: 60.25485610961914, abs dis: 7.048625946044922
[rfa agg] iter: 9, weight: tensor([0.0852, 0.1599, 0.0605, 0.1193, 0.2376, 0.0602, 0.0530, 0.1030, 0.0578,
        0.0636])
			Update norm = 112.54989345008283 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3280, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.3752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.5791594982147 sec.
Server Epoch:93 choose agents : [75, 7, 35, 2, 93, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   2, Avg loss: 0.0275, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.1971, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5581, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0882, Accuracy: 26/271 (9.5941%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0566, Accuracy: 123/271 (45.3875%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.5904, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0640, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.3521, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 438/1742 (25.1435%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 703/1742 (40.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4767, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 346/1154 (29.9827%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 465/1154 (40.2946%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9735, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 422/1904 (22.1639%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 701/1904 (36.8172%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7059, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0745, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0390, Accuracy: 178/426 (41.7840%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.2266, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0554, Accuracy: 273/1071 (25.4902%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 506/1071 (47.2456%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6735, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8857, Accuracy: 71/10000 (0.7100%)
time spent on training: 272.74908685684204
[rfa agg] training data poison_ratio: 0.0  data num: [776, 891, 271, 605, 1742, 1154, 1904, 426, 1071, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 7, 35, 2, 93, 15, 46, 67, 55, 73], weight: tensor([0.0794, 0.0911, 0.0277, 0.0619, 0.1782, 0.1180, 0.1947, 0.0436, 0.1095,
        0.0959])
[rfa agg] iter:  0, prev_obj_val: 61.55754852294922, obj_val: 65.09230041503906, abs dis: 3.5347518920898438
[rfa agg] iter: 0, weight: tensor([0.0610, 0.0918, 0.0072, 0.0275, 0.0505, 0.1642, 0.0467, 0.0136, 0.3986,
        0.1388])
[rfa agg] iter:  1, prev_obj_val: 65.09230041503906, obj_val: 66.50831604003906, abs dis: 1.416015625
[rfa agg] iter: 1, weight: tensor([0.1043, 0.1956, 0.0078, 0.0347, 0.0387, 0.0810, 0.0367, 0.0154, 0.1487,
        0.3371])
[rfa agg] iter:  2, prev_obj_val: 66.50831604003906, obj_val: 73.45642852783203, abs dis: 6.948112487792969
[rfa agg] iter: 2, weight: tensor([0.1204, 0.2652, 0.0075, 0.0349, 0.0338, 0.0655, 0.0322, 0.0149, 0.1067,
        0.3189])
[rfa agg] iter:  3, prev_obj_val: 73.45642852783203, obj_val: 70.74323272705078, abs dis: 2.71319580078125
[rfa agg] iter: 3, weight: tensor([0.3140, 0.2347, 0.0107, 0.0622, 0.0366, 0.0598, 0.0353, 0.0223, 0.0827,
        0.1418])
[rfa agg] iter:  4, prev_obj_val: 70.74323272705078, obj_val: 76.34918975830078, abs dis: 5.60595703125
[rfa agg] iter: 4, weight: tensor([0.2783, 0.2894, 0.0088, 0.0470, 0.0332, 0.0570, 0.0319, 0.0181, 0.0823,
        0.1538])
[rfa agg] iter:  5, prev_obj_val: 76.34918975830078, obj_val: 76.33511352539062, abs dis: 0.01407623291015625
[rfa agg] iter: 5, weight: tensor([0.3383, 0.1921, 0.0127, 0.0821, 0.0395, 0.0616, 0.0382, 0.0271, 0.0822,
        0.1262])
[rfa agg] iter:  6, prev_obj_val: 76.33511352539062, obj_val: 73.36500549316406, abs dis: 2.9701080322265625
[rfa agg] iter: 6, weight: tensor([0.3567, 0.1840, 0.0124, 0.0804, 0.0386, 0.0603, 0.0374, 0.0265, 0.0805,
        0.1231])
[rfa agg] iter:  7, prev_obj_val: 73.36500549316406, obj_val: 76.33623504638672, abs dis: 2.9712295532226562
[rfa agg] iter: 7, weight: tensor([0.4019, 0.2010, 0.0095, 0.0552, 0.0325, 0.0531, 0.0314, 0.0198, 0.0734,
        0.1222])
[rfa agg] iter:  8, prev_obj_val: 76.33623504638672, obj_val: 73.36421203613281, abs dis: 2.9720230102539062
[rfa agg] iter: 8, weight: tensor([0.3676, 0.1806, 0.0122, 0.0790, 0.0380, 0.0594, 0.0368, 0.0261, 0.0792,
        0.1210])
[rfa agg] iter:  9, prev_obj_val: 73.36421203613281, obj_val: 76.3364486694336, abs dis: 2.9722366333007812
[rfa agg] iter: 9, weight: tensor([0.4063, 0.1992, 0.0094, 0.0548, 0.0323, 0.0528, 0.0312, 0.0197, 0.0730,
        0.1213])
			Update norm = 112.568607552239 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3280, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.3752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 369.07216358184814 sec.
Server Epoch:94 choose agents : [54, 23, 95, 98, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 355/1130 (31.4159%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 487/1130 (43.0973%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3950, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.9014, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   1, Avg loss: 0.0447, Accuracy: 410/599 (68.4474%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8473, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   1, Avg loss: 0.0788, Accuracy: 41/373 (10.9920%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   2, Avg loss: 0.0471, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8424, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 417/1581 (26.3757%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0328, Accuracy: 639/1581 (40.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.1424, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0544, Accuracy: 308/636 (48.4277%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0302, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.0741, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0660, Accuracy: 122/631 (19.3344%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0397, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.4095, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 41/312 (13.1410%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 156/312 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 382/1628 (23.4644%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 818/1628 (50.2457%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.1934, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 122/781 (15.6210%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 232/781 (29.7055%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2696, Accuracy: 96/10000 (0.9600%)
time spent on training: 251.1358470916748
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 715, 599, 373, 1581, 636, 631, 312, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 23, 95, 98, 28, 52, 48, 24, 5, 3], weight: tensor([0.1347, 0.0853, 0.0714, 0.0445, 0.1885, 0.0758, 0.0752, 0.0372, 0.1941,
        0.0931])
[rfa agg] iter:  0, prev_obj_val: 60.951805114746094, obj_val: 62.05005645751953, abs dis: 1.0982513427734375
[rfa agg] iter: 0, weight: tensor([0.2118, 0.1343, 0.0698, 0.0242, 0.0921, 0.0737, 0.0733, 0.0182, 0.0864,
        0.2162])
[rfa agg] iter:  1, prev_obj_val: 62.05005645751953, obj_val: 64.06278228759766, abs dis: 2.012725830078125
[rfa agg] iter: 1, weight: tensor([0.0718, 0.1816, 0.0632, 0.0171, 0.0422, 0.0665, 0.0662, 0.0125, 0.0401,
        0.4388])
[rfa agg] iter:  2, prev_obj_val: 64.06278228759766, obj_val: 71.51119232177734, abs dis: 7.4484100341796875
[rfa agg] iter: 2, weight: tensor([0.0594, 0.3162, 0.0918, 0.0197, 0.0386, 0.0962, 0.0961, 0.0142, 0.0370,
        0.2309])
[rfa agg] iter:  3, prev_obj_val: 71.51119232177734, obj_val: 81.68318176269531, abs dis: 10.171989440917969
[rfa agg] iter: 3, weight: tensor([0.0329, 0.0805, 0.2454, 0.0217, 0.0246, 0.2474, 0.2491, 0.0145, 0.0238,
        0.0600])
[rfa agg] iter:  4, prev_obj_val: 81.68318176269531, obj_val: 74.48714447021484, abs dis: 7.196037292480469
[rfa agg] iter: 4, weight: tensor([0.0564, 0.0952, 0.1823, 0.0700, 0.0456, 0.1907, 0.1916, 0.0421, 0.0443,
        0.0818])
[rfa agg] iter:  5, prev_obj_val: 74.48714447021484, obj_val: 81.68207550048828, abs dis: 7.1949310302734375
[rfa agg] iter: 5, weight: tensor([0.0363, 0.0753, 0.2430, 0.0291, 0.0279, 0.2345, 0.2478, 0.0189, 0.0270,
        0.0602])
[rfa agg] iter:  6, prev_obj_val: 81.68207550048828, obj_val: 74.48713684082031, abs dis: 7.194938659667969
[rfa agg] iter: 6, weight: tensor([0.0564, 0.0952, 0.1825, 0.0700, 0.0456, 0.1903, 0.1917, 0.0421, 0.0443,
        0.0819])
[rfa agg] iter:  7, prev_obj_val: 74.48713684082031, obj_val: 81.68208312988281, abs dis: 7.1949462890625
[rfa agg] iter: 7, weight: tensor([0.0363, 0.0753, 0.2430, 0.0291, 0.0279, 0.2345, 0.2478, 0.0189, 0.0270,
        0.0602])
[rfa agg] iter:  8, prev_obj_val: 81.68208312988281, obj_val: 74.48713684082031, abs dis: 7.1949462890625
[rfa agg] iter: 8, weight: tensor([0.0564, 0.0952, 0.1825, 0.0700, 0.0456, 0.1903, 0.1917, 0.0421, 0.0443,
        0.0819])
[rfa agg] iter:  9, prev_obj_val: 74.48713684082031, obj_val: 81.68208312988281, abs dis: 7.1949462890625
[rfa agg] iter: 9, weight: tensor([0.0363, 0.0753, 0.2430, 0.0291, 0.0279, 0.2345, 0.2478, 0.0189, 0.0270,
        0.0602])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3313, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.3869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.45505475997925 sec.
Server Epoch:95 choose agents : [79, 4, 1, 10, 41, 2, 58, 11, 29, 77].
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   1, Avg loss: 0.1008, Accuracy: 7/197 (3.5533%)
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   2, Avg loss: 0.0828, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.4211, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 329/901 (36.5150%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 411/901 (45.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8264, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 546/928 (58.8362%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.3633, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0557, Accuracy: 222/861 (25.7840%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 453/861 (52.6132%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7548, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0575, Accuracy: 356/719 (49.5132%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0304, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.3035, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 223/605 (36.8595%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4014, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 341/803 (42.4658%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 389/803 (48.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.3983, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0530, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2517, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 417/1440 (28.9583%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 691/1440 (47.9861%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.6555, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 324/1340 (24.1791%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 543/1340 (40.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5394, Accuracy: 91/10000 (0.9100%)
time spent on training: 270.03505063056946
[rfa agg] training data poison_ratio: 0.0  data num: [197, 901, 928, 861, 719, 605, 803, 712, 1440, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 4, 1, 10, 41, 2, 58, 11, 29, 77], weight: tensor([0.0232, 0.1059, 0.1091, 0.1012, 0.0845, 0.0711, 0.0944, 0.0837, 0.1693,
        0.1575])
[rfa agg] iter:  0, prev_obj_val: 35.62261199951172, obj_val: 45.43190383911133, abs dis: 9.80929183959961
[rfa agg] iter: 0, weight: tensor([0.0044, 0.1554, 0.1625, 0.2572, 0.0754, 0.0335, 0.1575, 0.0758, 0.0357,
        0.0425])
[rfa agg] iter:  1, prev_obj_val: 45.43190383911133, obj_val: 45.31888198852539, abs dis: 0.1130218505859375
[rfa agg] iter: 1, weight: tensor([0.0072, 0.0689, 0.0709, 0.0914, 0.2147, 0.1022, 0.1378, 0.2344, 0.0341,
        0.0384])
[rfa agg] iter:  2, prev_obj_val: 45.31888198852539, obj_val: 52.337886810302734, abs dis: 7.019004821777344
[rfa agg] iter: 2, weight: tensor([0.0067, 0.0646, 0.0664, 0.0847, 0.2301, 0.0966, 0.1297, 0.2530, 0.0321,
        0.0361])
[rfa agg] iter:  3, prev_obj_val: 52.337886810302734, obj_val: 52.30498504638672, abs dis: 0.032901763916015625
[rfa agg] iter: 3, weight: tensor([0.0104, 0.0681, 0.0700, 0.0830, 0.1532, 0.2681, 0.1084, 0.1552, 0.0396,
        0.0439])
[rfa agg] iter:  4, prev_obj_val: 52.30498504638672, obj_val: 56.026947021484375, abs dis: 3.7219619750976562
[rfa agg] iter: 4, weight: tensor([0.0101, 0.0660, 0.0680, 0.0806, 0.1456, 0.2949, 0.1052, 0.1485, 0.0384,
        0.0426])
[rfa agg] iter:  5, prev_obj_val: 56.026947021484375, obj_val: 60.0526123046875, abs dis: 4.025665283203125
[rfa agg] iter: 5, weight: tensor([0.0105, 0.0571, 0.0588, 0.0679, 0.1088, 0.4280, 0.0846, 0.1098, 0.0354,
        0.0389])
[rfa agg] iter:  6, prev_obj_val: 60.0526123046875, obj_val: 60.051513671875, abs dis: 0.0010986328125
[rfa agg] iter: 6, weight: tensor([0.0141, 0.0640, 0.0659, 0.0746, 0.1087, 0.3860, 0.0896, 0.1093, 0.0420,
        0.0459])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3345, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.3970, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.1140384674072 sec.
Server Epoch:96 choose agents : [77, 9, 2, 30, 42, 20, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 357/1340 (26.6418%)
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 540/1340 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3651, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 381/1275 (29.8824%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 742/1275 (58.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.4435, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0600, Accuracy: 254/605 (41.9835%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4368, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0765, Accuracy: 96/486 (19.7531%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.5347, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 346/1372 (25.2187%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 500/1372 (36.4431%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.7357, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   1, Avg loss: 0.0583, Accuracy: 332/807 (41.1400%)
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.5366, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1283, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1201, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3486, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0717, Accuracy: 122/781 (15.6210%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4497, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 349/1154 (30.2426%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 472/1154 (40.9012%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0325, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 397/1956 (20.2965%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 657/1956 (33.5890%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2401, Accuracy: 114/10000 (1.1400%)
time spent on training: 246.07214331626892
[rfa agg] training data poison_ratio: 0.08183754183145725  data num: [1340, 1275, 605, 486, 1372, 807, 85, 781, 1154, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.02557423182233039
[rfa agg] init. name: [77, 9, 2, 30, 42, 20, 61, 3, 15, 6], weight: tensor([0.1359, 0.1293, 0.0614, 0.0493, 0.1391, 0.0818, 0.0086, 0.0792, 0.1170,
        0.1984])
[rfa agg] iter:  0, prev_obj_val: 51.79294204711914, obj_val: 53.33879470825195, abs dis: 1.5458526611328125
[rfa agg] iter: 0, weight: tensor([0.1568, 0.2242, 0.0221, 0.0144, 0.1172, 0.0449, 0.0016, 0.0438, 0.3265,
        0.0485])
[rfa agg] iter:  1, prev_obj_val: 53.33879470825195, obj_val: 53.337928771972656, abs dis: 0.000865936279296875
[rfa agg] iter: 1, weight: tensor([0.1505, 0.2034, 0.0264, 0.0170, 0.1163, 0.0554, 0.0019, 0.0541, 0.3225,
        0.0525])
			Update norm = 161.40298580920057 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3345, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.3970, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.97520637512207 sec.
Server Epoch:97 choose agents : [38, 36, 83, 74, 84, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0313, Accuracy: 454/1131 (40.1415%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9159, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0854, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0527, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.9892, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 443/1953 (22.6831%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 824/1953 (42.1915%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3777, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   1, Avg loss: 0.0440, Accuracy: 481/1552 (30.9923%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 773/1552 (49.8067%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.4620, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0610, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7561, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0579, Accuracy: 290/1513 (19.1672%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 523/1513 (34.5671%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8610, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 444/1587 (27.9773%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 635/1587 (40.0126%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3042, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0552, Accuracy: 355/719 (49.3741%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3065, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0541, Accuracy: 360/1446 (24.8963%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 496/1446 (34.3015%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4778, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 459/1130 (40.6195%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4358, Accuracy: 52/10000 (0.5200%)
time spent on training: 272.7149832248688
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 1953, 1552, 1190, 1513, 1587, 719, 1446, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 83, 74, 84, 8, 27, 41, 26, 54], weight: tensor([0.0896, 0.0323, 0.1546, 0.1229, 0.0942, 0.1198, 0.1257, 0.0569, 0.1145,
        0.0895])
[rfa agg] iter:  0, prev_obj_val: 45.41791534423828, obj_val: 49.707374572753906, abs dis: 4.289459228515625
[rfa agg] iter: 0, weight: tensor([0.1232, 0.0087, 0.0535, 0.0975, 0.1899, 0.1203, 0.0999, 0.0243, 0.1584,
        0.1244])
[rfa agg] iter:  1, prev_obj_val: 49.707374572753906, obj_val: 54.08663558959961, abs dis: 4.379261016845703
[rfa agg] iter: 1, weight: tensor([0.1892, 0.0074, 0.0355, 0.0560, 0.2928, 0.0651, 0.0573, 0.0224, 0.0776,
        0.1967])
[rfa agg] iter:  2, prev_obj_val: 54.08663558959961, obj_val: 60.45294952392578, abs dis: 6.366313934326172
[rfa agg] iter: 2, weight: tensor([0.2733, 0.0071, 0.0286, 0.0419, 0.1801, 0.0474, 0.0429, 0.0227, 0.0543,
        0.3016])
[rfa agg] iter:  3, prev_obj_val: 60.45294952392578, obj_val: 60.44870376586914, abs dis: 0.004245758056640625
[rfa agg] iter: 3, weight: tensor([0.2579, 0.0113, 0.0387, 0.0536, 0.1509, 0.0594, 0.0547, 0.0394, 0.0662,
        0.2678])
			Update norm = 152.465902950463 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3345, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.3970, Accuracy: 0/9950 (0.0000%)
saving model
Done in 366.3570227622986 sec.
Server Epoch:98 choose agents : [70, 56, 62, 89, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 393/1418 (27.7151%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 670/1418 (47.2496%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1348, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0819, Accuracy: 5/186 (2.6882%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3793, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 165/568 (29.0493%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3340, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.5289, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 279/1241 (22.4819%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0356, Accuracy: 427/1241 (34.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4996, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0350, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3571, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0536, Accuracy: 330/690 (47.8261%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0268, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.5620, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0758, Accuracy: 88/515 (17.0874%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0522, Accuracy: 117/515 (22.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.4256, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 535/1470 (36.3946%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 820/1470 (55.7823%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6583, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 312/1154 (27.0364%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 504/1154 (43.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.1017, Accuracy: 76/10000 (0.7600%)
time spent on training: 220.97476387023926
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 896, 1241, 708, 690, 515, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 56, 62, 89, 72, 16, 25, 33, 22, 57], weight: tensor([0.1603, 0.0210, 0.0642, 0.1013, 0.1403, 0.0800, 0.0780, 0.0582, 0.1662,
        0.1305])
[rfa agg] iter:  0, prev_obj_val: 50.71563720703125, obj_val: 55.0062255859375, abs dis: 4.29058837890625
[rfa agg] iter: 0, weight: tensor([0.0663, 0.0065, 0.0411, 0.4053, 0.0893, 0.1087, 0.0771, 0.0372, 0.0687,
        0.0999])
[rfa agg] iter:  1, prev_obj_val: 55.0062255859375, obj_val: 61.19263458251953, abs dis: 6.186408996582031
[rfa agg] iter: 1, weight: tensor([0.0530, 0.0070, 0.0528, 0.3052, 0.0661, 0.2216, 0.1204, 0.0476, 0.0549,
        0.0712])
[rfa agg] iter:  2, prev_obj_val: 61.19263458251953, obj_val: 66.70460510253906, abs dis: 5.511970520019531
[rfa agg] iter: 2, weight: tensor([0.0403, 0.0072, 0.0729, 0.1151, 0.0477, 0.3060, 0.2537, 0.0653, 0.0418,
        0.0500])
[rfa agg] iter:  3, prev_obj_val: 66.70460510253906, obj_val: 73.02839660644531, abs dis: 6.32379150390625
[rfa agg] iter: 3, weight: tensor([0.0408, 0.0089, 0.1294, 0.0906, 0.0470, 0.1606, 0.3172, 0.1146, 0.0423,
        0.0486])
[rfa agg] iter:  4, prev_obj_val: 73.02839660644531, obj_val: 72.99028015136719, abs dis: 0.038116455078125
[rfa agg] iter: 4, weight: tensor([0.0360, 0.0098, 0.2857, 0.0676, 0.0405, 0.0943, 0.1496, 0.2376, 0.0373,
        0.0415])
[rfa agg] iter:  5, prev_obj_val: 72.99028015136719, obj_val: 72.98999786376953, abs dis: 0.00028228759765625
[rfa agg] iter: 5, weight: tensor([0.0343, 0.0093, 0.3008, 0.0644, 0.0386, 0.0894, 0.1396, 0.2484, 0.0356,
        0.0395])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3375, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.4087, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.77345967292786 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 81, 38, 62, 92, 78].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.8252, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0769, Accuracy: 52/440 (11.8182%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.0749, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0887, Accuracy: 22/271 (8.1181%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0572, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.6621, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 282/1402 (20.1141%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 395/1402 (28.1740%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9472, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0521, Accuracy: 335/690 (48.5507%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3330, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   1, Avg loss: 0.0698, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 279/774 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.8289, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 484/1131 (42.7940%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.3369, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0659, Accuracy: 163/568 (28.6972%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.4733, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 452/1715 (26.3557%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 745/1715 (43.4402%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9988, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   1, Avg loss: 0.0808, Accuracy: 56/416 (13.4615%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 189/416 (45.4327%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.2945, Accuracy: 51/10000 (0.5100%)
time spent on training: 204.01428365707397
[rfa agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 774, 1131, 568, 1715, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 49, 35, 66, 25, 81, 38, 62, 92, 78], weight: tensor([0.0404, 0.0570, 0.0351, 0.1816, 0.0894, 0.1003, 0.1465, 0.0736, 0.2222,
        0.0539])
[rfa agg] iter:  0, prev_obj_val: 64.78384399414062, obj_val: 67.81598663330078, abs dis: 3.0321426391601562
[rfa agg] iter: 0, weight: tensor([0.0176, 0.0324, 0.0153, 0.0789, 0.1278, 0.4574, 0.1188, 0.0602, 0.0610,
        0.0306])
[rfa agg] iter:  1, prev_obj_val: 67.81598663330078, obj_val: 72.67578125, abs dis: 4.859794616699219
[rfa agg] iter: 1, weight: tensor([0.0204, 0.0402, 0.0177, 0.0641, 0.2630, 0.3331, 0.0857, 0.0854, 0.0524,
        0.0380])
[rfa agg] iter:  2, prev_obj_val: 72.67578125, obj_val: 76.91563415527344, abs dis: 4.2398529052734375
[rfa agg] iter: 2, weight: tensor([0.0245, 0.0539, 0.0213, 0.0527, 0.4006, 0.1320, 0.0649, 0.1543, 0.0450,
        0.0509])
[rfa agg] iter:  3, prev_obj_val: 76.91563415527344, obj_val: 74.73678588867188, abs dis: 2.1788482666015625
[rfa agg] iter: 3, weight: tensor([0.0305, 0.0763, 0.0264, 0.0494, 0.1952, 0.0963, 0.0584, 0.3525, 0.0432,
        0.0718])
[rfa agg] iter:  4, prev_obj_val: 74.73678588867188, obj_val: 76.88148498535156, abs dis: 2.1446990966796875
[rfa agg] iter: 4, weight: tensor([0.0291, 0.0679, 0.0252, 0.0544, 0.2780, 0.1182, 0.0657, 0.2504, 0.0471,
        0.0640])
[rfa agg] iter:  5, prev_obj_val: 76.88148498535156, obj_val: 76.86898803710938, abs dis: 0.0124969482421875
[rfa agg] iter: 5, weight: tensor([0.0297, 0.0745, 0.0258, 0.0481, 0.1868, 0.0938, 0.0569, 0.3722, 0.0421,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 76.86898803710938, obj_val: 79.14253234863281, abs dis: 2.2735443115234375
[rfa agg] iter: 6, weight: tensor([0.0289, 0.0726, 0.0251, 0.0467, 0.1788, 0.0911, 0.0553, 0.3921, 0.0409,
        0.0684])
[rfa agg] iter:  7, prev_obj_val: 79.14253234863281, obj_val: 87.44420623779297, abs dis: 8.301673889160156
[rfa agg] iter: 7, weight: tensor([0.0248, 0.0688, 0.0215, 0.0344, 0.1056, 0.0611, 0.0399, 0.5488, 0.0304,
        0.0647])
[rfa agg] iter:  8, prev_obj_val: 87.44420623779297, obj_val: 93.94775390625, abs dis: 6.503547668457031
[rfa agg] iter: 8, weight: tensor([0.0490, 0.2691, 0.0425, 0.0384, 0.0771, 0.0557, 0.0427, 0.1490, 0.0350,
        0.2415])
[rfa agg] iter:  9, prev_obj_val: 93.94775390625, obj_val: 93.94512939453125, abs dis: 0.00262451171875
[rfa agg] iter: 9, weight: tensor([0.0783, 0.2936, 0.0674, 0.0348, 0.0585, 0.0457, 0.0378, 0.0865, 0.0322,
        0.2650])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3402, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.4159, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.9826476573944 sec.
Server Epoch:100 choose agents : [47, 65, 85, 24, 39, 5, 1, 53, 87, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1243, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1068, Accuracy: 29/134 (21.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3728, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 372/1475 (25.2203%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 675/1475 (45.7627%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3845, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 446/1988 (22.4346%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 655/1988 (32.9477%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.3152, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0400, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.9122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0530, Accuracy: 306/1013 (30.2073%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0253, Accuracy: 543/1013 (53.6032%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4708, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 822/1628 (50.4914%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.7738, Accuracy: 156/10000 (1.5600%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 582/928 (62.7155%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6798, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0480, Accuracy: 286/813 (35.1784%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 479/813 (58.9176%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.6195, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 431/1131 (38.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.3115, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 356/803 (44.3337%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.5406, Accuracy: 58/10000 (0.5800%)
time spent on training: 242.9016673564911
[rfa agg] training data poison_ratio: 0.0  data num: [134, 1475, 1988, 312, 1013, 1628, 928, 813, 1131, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 65, 85, 24, 39, 5, 1, 53, 87, 58], weight: tensor([0.0131, 0.1443, 0.1944, 0.0305, 0.0991, 0.1592, 0.0908, 0.0795, 0.1106,
        0.0785])
[rfa agg] iter:  0, prev_obj_val: 60.96638488769531, obj_val: 62.02225875854492, abs dis: 1.0558738708496094
[rfa agg] iter: 0, weight: tensor([0.0035, 0.1210, 0.0637, 0.0093, 0.1355, 0.0962, 0.0952, 0.0563, 0.3636,
        0.0557])
[rfa agg] iter:  1, prev_obj_val: 62.02225875854492, obj_val: 65.43978118896484, abs dis: 3.417522430419922
[rfa agg] iter: 1, weight: tensor([0.0028, 0.0675, 0.0411, 0.0075, 0.1766, 0.0572, 0.1060, 0.0537, 0.4345,
        0.0532])
[rfa agg] iter:  2, prev_obj_val: 65.43978118896484, obj_val: 68.98419189453125, abs dis: 3.5444107055664062
[rfa agg] iter: 2, weight: tensor([0.0030, 0.0525, 0.0356, 0.0081, 0.3445, 0.0464, 0.2025, 0.0755, 0.1569,
        0.0750])
[rfa agg] iter:  3, prev_obj_val: 68.98419189453125, obj_val: 71.29136657714844, abs dis: 2.3071746826171875
[rfa agg] iter: 3, weight: tensor([0.0030, 0.0444, 0.0318, 0.0085, 0.2325, 0.0401, 0.3324, 0.1043, 0.0992,
        0.1037])
[rfa agg] iter:  4, prev_obj_val: 71.29136657714844, obj_val: 71.2845687866211, abs dis: 0.00679779052734375
[rfa agg] iter: 4, weight: tensor([0.0033, 0.0438, 0.0322, 0.0093, 0.1711, 0.0400, 0.3314, 0.1397, 0.0892,
        0.1399])
[rfa agg] iter:  5, prev_obj_val: 71.2845687866211, obj_val: 68.9342041015625, abs dis: 2.3503646850585938
[rfa agg] iter: 5, weight: tensor([0.0033, 0.0437, 0.0321, 0.0093, 0.1680, 0.0399, 0.3336, 0.1404, 0.0890,
        0.1407])
[rfa agg] iter:  6, prev_obj_val: 68.9342041015625, obj_val: 76.67922973632812, abs dis: 7.745025634765625
[rfa agg] iter: 6, weight: tensor([0.0028, 0.0416, 0.0298, 0.0080, 0.2001, 0.0376, 0.3907, 0.0986, 0.0927,
        0.0982])
[rfa agg] iter:  7, prev_obj_val: 76.67922973632812, obj_val: 83.1811752319336, abs dis: 6.501945495605469
[rfa agg] iter: 7, weight: tensor([0.0036, 0.0395, 0.0303, 0.0103, 0.1089, 0.0366, 0.1637, 0.2625, 0.0697,
        0.2749])
[rfa agg] iter:  8, prev_obj_val: 83.1811752319336, obj_val: 79.54167938232422, abs dis: 3.639495849609375
[rfa agg] iter: 8, weight: tensor([0.0040, 0.0363, 0.0289, 0.0118, 0.0799, 0.0341, 0.1008, 0.3166, 0.0577,
        0.3299])
[rfa agg] iter:  9, prev_obj_val: 79.54167938232422, obj_val: 83.17215728759766, abs dis: 3.6304779052734375
[rfa agg] iter: 9, weight: tensor([0.0027, 0.0273, 0.0214, 0.0080, 0.0663, 0.0255, 0.0878, 0.3422, 0.0457,
        0.3730])
			Update norm = 112.19066412668882 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3402, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.4159, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.83847880363464 sec.
Saving all the graphs.
This run has a label: Jun.29_07.52.35. Visdom environment: tiny
