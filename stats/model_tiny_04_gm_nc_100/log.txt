current path: saved_models/model_tiny_Jun.30_09.23.44
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [85, 87, 65, 98, 55, 56, 28, 94, 16, 80].
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 434/1988 (21.8310%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 655/1988 (32.9477%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8882, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 292/1131 (25.8179%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 394/1475 (26.7119%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 629/1475 (42.6441%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.7278, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0492, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4313, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0573, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5792, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 354/1581 (22.3909%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 618/1581 (39.0892%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8441, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0560, Accuracy: 317/1662 (19.0734%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 598/1662 (35.9807%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5705, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 267/708 (37.7119%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.8214, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 138/682 (20.2346%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2910, Accuracy: 53/10000 (0.5300%)
time spent on training: 168.79024696350098
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1131, 1475, 373, 1071, 186, 1581, 1662, 708, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 87, 65, 98, 55, 56, 28, 94, 16, 80], weight: tensor([0.1831, 0.1042, 0.1359, 0.0344, 0.0986, 0.0171, 0.1456, 0.1531, 0.0652,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 62.29914855957031, obj_val: 64.55944061279297, abs dis: 2.2602920532226562
[rfa agg] iter: 0, weight: tensor([0.0694, 0.2851, 0.1401, 0.0120, 0.1775, 0.0049, 0.1240, 0.1108, 0.0410,
        0.0350])
[rfa agg] iter:  1, prev_obj_val: 64.55944061279297, obj_val: 67.72817993164062, abs dis: 3.1687393188476562
[rfa agg] iter: 1, weight: tensor([0.0480, 0.4303, 0.0863, 0.0097, 0.2065, 0.0039, 0.0787, 0.0719, 0.0352,
        0.0296])
[rfa agg] iter:  2, prev_obj_val: 67.72817993164062, obj_val: 75.10106658935547, abs dis: 7.372886657714844
[rfa agg] iter: 2, weight: tensor([0.0369, 0.4085, 0.0604, 0.0087, 0.3109, 0.0034, 0.0564, 0.0524, 0.0342,
        0.0281])
[rfa agg] iter:  3, prev_obj_val: 75.10106658935547, obj_val: 69.836669921875, abs dis: 5.264396667480469
[rfa agg] iter: 3, weight: tensor([0.0510, 0.2233, 0.0752, 0.0152, 0.3633, 0.0057, 0.0718, 0.0681, 0.0709,
        0.0555])
[rfa agg] iter:  4, prev_obj_val: 69.836669921875, obj_val: 75.07730865478516, abs dis: 5.240638732910156
[rfa agg] iter: 4, weight: tensor([0.0354, 0.2401, 0.0558, 0.0090, 0.4869, 0.0035, 0.0525, 0.0492, 0.0374,
        0.0302])
[rfa agg] iter:  5, prev_obj_val: 75.07730865478516, obj_val: 69.8310546875, abs dis: 5.246253967285156
[rfa agg] iter: 5, weight: tensor([0.0497, 0.2112, 0.0732, 0.0148, 0.3858, 0.0056, 0.0700, 0.0663, 0.0692,
        0.0541])
[rfa agg] iter:  6, prev_obj_val: 69.8310546875, obj_val: 75.07874298095703, abs dis: 5.247688293457031
[rfa agg] iter: 6, weight: tensor([0.0348, 0.2344, 0.0549, 0.0089, 0.4971, 0.0034, 0.0517, 0.0484, 0.0368,
        0.0297])
[rfa agg] iter:  7, prev_obj_val: 75.07874298095703, obj_val: 69.83080291748047, abs dis: 5.2479400634765625
[rfa agg] iter: 7, weight: tensor([0.0497, 0.2106, 0.0731, 0.0148, 0.3869, 0.0056, 0.0699, 0.0662, 0.0691,
        0.0540])
[rfa agg] iter:  8, prev_obj_val: 69.83080291748047, obj_val: 75.07881164550781, abs dis: 5.248008728027344
[rfa agg] iter: 8, weight: tensor([0.0348, 0.2341, 0.0548, 0.0089, 0.4976, 0.0034, 0.0516, 0.0483, 0.0367,
        0.0297])
[rfa agg] iter:  9, prev_obj_val: 75.07881164550781, obj_val: 69.83079528808594, abs dis: 5.248016357421875
[rfa agg] iter: 9, weight: tensor([0.0497, 0.2106, 0.0731, 0.0148, 0.3869, 0.0056, 0.0699, 0.0662, 0.0691,
        0.0540])
			Update norm = 160.66639179718015 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.2741961479187 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 20, 86, 29, 7, 95].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 647/1475 (43.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8220, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0717, Accuracy: 81/631 (12.8368%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 384/1750 (21.9429%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 652/1750 (37.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6833, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 19/312 (6.0897%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3811, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0577, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2649, Accuracy: 67/10000 (0.6700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.4839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 348/1003 (34.6959%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 414/1440 (28.7500%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 647/1440 (44.9306%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8357, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1575, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 325/599 (54.2571%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6416, Accuracy: 50/10000 (0.5000%)
time spent on training: 136.72697591781616
[rfa agg] training data poison_ratio: 0.14648885184413418  data num: [1475, 631, 1750, 312, 690, 807, 1003, 1440, 891, 599]
[rfa agg] considering poison per batch poison_fraction: 0.04577776620129193
[rfa agg] init. name: [65, 48, 44, 24, 25, 20, 86, 29, 7, 95], weight: tensor([0.1537, 0.0657, 0.1823, 0.0325, 0.0719, 0.0841, 0.1045, 0.1500, 0.0928,
        0.0624])
[rfa agg] iter:  0, prev_obj_val: 58.424259185791016, obj_val: 61.99985885620117, abs dis: 3.5755996704101562
[rfa agg] iter: 0, weight: tensor([0.0808, 0.0399, 0.0628, 0.0111, 0.0516, 0.0929, 0.3926, 0.0908, 0.1394,
        0.0379])
[rfa agg] iter:  1, prev_obj_val: 61.99985885620117, obj_val: 63.28256607055664, abs dis: 1.2827072143554688
[rfa agg] iter: 1, weight: tensor([0.0482, 0.0507, 0.0409, 0.0112, 0.0735, 0.1928, 0.1568, 0.0522, 0.3255,
        0.0482])
[rfa agg] iter:  2, prev_obj_val: 63.28256607055664, obj_val: 69.4581069946289, abs dis: 6.175540924072266
[rfa agg] iter: 2, weight: tensor([0.0416, 0.0523, 0.0358, 0.0107, 0.0793, 0.2567, 0.1117, 0.0448, 0.3175,
        0.0496])
[rfa agg] iter:  3, prev_obj_val: 69.4581069946289, obj_val: 69.40213012695312, abs dis: 0.05597686767578125
[rfa agg] iter: 3, weight: tensor([0.0427, 0.1020, 0.0380, 0.0151, 0.2000, 0.2281, 0.0848, 0.0454, 0.1471,
        0.0967])
[rfa agg] iter:  4, prev_obj_val: 69.40213012695312, obj_val: 71.80184936523438, abs dis: 2.39971923828125
[rfa agg] iter: 4, weight: tensor([0.0420, 0.1020, 0.0374, 0.0149, 0.2102, 0.2269, 0.0837, 0.0447, 0.1408,
        0.0973])
[rfa agg] iter:  5, prev_obj_val: 71.80184936523438, obj_val: 74.35623931884766, abs dis: 2.5543899536132812
[rfa agg] iter: 5, weight: tensor([0.0374, 0.1207, 0.0336, 0.0148, 0.3066, 0.1550, 0.0693, 0.0396, 0.1073,
        0.1156])
[rfa agg] iter:  6, prev_obj_val: 74.35623931884766, obj_val: 77.30609893798828, abs dis: 2.949859619140625
[rfa agg] iter: 6, weight: tensor([0.0293, 0.1351, 0.0266, 0.0130, 0.4113, 0.0978, 0.0511, 0.0310, 0.0738,
        0.1310])
[rfa agg] iter:  7, prev_obj_val: 77.30609893798828, obj_val: 77.2886734008789, abs dis: 0.017425537109375
[rfa agg] iter: 7, weight: tensor([0.0291, 0.2018, 0.0266, 0.0146, 0.2988, 0.0819, 0.0479, 0.0306, 0.0656,
        0.2031])
[rfa agg] iter:  8, prev_obj_val: 77.2886734008789, obj_val: 77.28817749023438, abs dis: 0.00049591064453125
[rfa agg] iter: 8, weight: tensor([0.0289, 0.2138, 0.0265, 0.0145, 0.2783, 0.0812, 0.0477, 0.0305, 0.0652,
        0.2135])
			Update norm = 106.03963089483337 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.7687828540802 sec.
Server Epoch:3 choose agents : [77, 59, 8, 86, 97, 14, 4, 70, 96, 11].
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 314/1340 (23.4328%)
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 604/1340 (45.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6719, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0536, Accuracy: 300/1089 (27.5482%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 439/1089 (40.3122%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7999, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 251/1513 (16.5896%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 497/1513 (32.8486%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2279, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   1, Avg loss: 0.0642, Accuracy: 354/1003 (35.2941%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 403/1003 (40.1795%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6676, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 344/1213 (28.3594%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 508/1213 (41.8796%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5359, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 325/1013 (32.0829%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5590, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 414/901 (45.9489%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 319/1418 (22.4965%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 617/1418 (43.5120%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0862, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 432/712 (60.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.3551, Accuracy: 50/10000 (0.5000%)
time spent on training: 172.49661231040955
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1089, 1513, 1003, 1213, 1013, 901, 1418, 311, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 59, 8, 86, 97, 14, 4, 70, 96, 11], weight: tensor([0.1275, 0.1036, 0.1439, 0.0954, 0.1154, 0.0964, 0.0857, 0.1349, 0.0296,
        0.0677])
[rfa agg] iter:  0, prev_obj_val: 36.10910415649414, obj_val: 42.7963752746582, abs dis: 6.6872711181640625
[rfa agg] iter: 0, weight: tensor([0.0630, 0.1263, 0.0433, 0.2288, 0.1000, 0.2399, 0.1126, 0.0465, 0.0058,
        0.0338])
[rfa agg] iter:  1, prev_obj_val: 42.7963752746582, obj_val: 49.344879150390625, abs dis: 6.548503875732422
[rfa agg] iter: 1, weight: tensor([0.0524, 0.0814, 0.0398, 0.1971, 0.0707, 0.2031, 0.2517, 0.0417, 0.0073,
        0.0547])
[rfa agg] iter:  2, prev_obj_val: 49.344879150390625, obj_val: 45.9383659362793, abs dis: 3.406513214111328
[rfa agg] iter: 2, weight: tensor([0.0621, 0.0859, 0.0494, 0.1551, 0.0784, 0.1571, 0.2406, 0.0512, 0.0111,
        0.1092])
[rfa agg] iter:  3, prev_obj_val: 45.9383659362793, obj_val: 45.93423843383789, abs dis: 0.00412750244140625
[rfa agg] iter: 3, weight: tensor([0.0560, 0.0815, 0.0435, 0.1651, 0.0729, 0.1677, 0.2838, 0.0454, 0.0088,
        0.0753])
[rfa agg] iter:  4, prev_obj_val: 45.93423843383789, obj_val: 45.934146881103516, abs dis: 9.1552734375e-05
[rfa agg] iter: 4, weight: tensor([0.0554, 0.0806, 0.0431, 0.1635, 0.0721, 0.1659, 0.2913, 0.0450, 0.0087,
        0.0743])
			Update norm = 139.59828666794232 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.3507089614868 sec.
Server Epoch:4 choose agents : [21, 65, 32, 77, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 654/1949 (33.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.7152, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0585, Accuracy: 399/1475 (27.0508%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 627/1475 (42.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9307, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 187/735 (25.4422%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7820, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 315/1340 (23.5075%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0282, Accuracy: 526/1340 (39.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5858, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 355/891 (39.8429%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.1219, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 317/719 (44.0890%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0299, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1374, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 270/636 (42.4528%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 604/1645 (36.7173%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2170, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 176/953 (18.4680%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 329/953 (34.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3131, Accuracy: 81/10000 (0.8100%)
time spent on training: 152.84226655960083
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 1340, 891, 312, 719, 636, 1645, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 65, 32, 77, 7, 24, 41, 52, 13, 64], weight: tensor([0.1829, 0.1384, 0.0690, 0.1258, 0.0836, 0.0293, 0.0675, 0.0597, 0.1544,
        0.0894])
[rfa agg] iter:  0, prev_obj_val: 63.35860824584961, obj_val: 65.13217163085938, abs dis: 1.7735633850097656
[rfa agg] iter: 0, weight: tensor([0.0810, 0.1367, 0.0585, 0.2638, 0.1006, 0.0119, 0.0571, 0.0388, 0.1130,
        0.1387])
[rfa agg] iter:  1, prev_obj_val: 65.13217163085938, obj_val: 67.96869659423828, abs dis: 2.8365249633789062
[rfa agg] iter: 1, weight: tensor([0.0751, 0.1166, 0.0690, 0.1959, 0.1275, 0.0129, 0.0673, 0.0439, 0.1000,
        0.1917])
[rfa agg] iter:  2, prev_obj_val: 67.96869659423828, obj_val: 73.7702407836914, abs dis: 5.801544189453125
[rfa agg] iter: 2, weight: tensor([0.0533, 0.0751, 0.0744, 0.1091, 0.1644, 0.0115, 0.0723, 0.0432, 0.0672,
        0.3295])
[rfa agg] iter:  3, prev_obj_val: 73.7702407836914, obj_val: 75.90375518798828, abs dis: 2.133514404296875
[rfa agg] iter: 3, weight: tensor([0.0355, 0.0455, 0.1078, 0.0590, 0.2884, 0.0106, 0.1028, 0.0484, 0.0423,
        0.2597])
[rfa agg] iter:  4, prev_obj_val: 75.90375518798828, obj_val: 73.71943664550781, abs dis: 2.1843185424804688
[rfa agg] iter: 4, weight: tensor([0.0352, 0.0441, 0.1409, 0.0561, 0.2973, 0.0114, 0.1334, 0.0561, 0.0414,
        0.1842])
[rfa agg] iter:  5, prev_obj_val: 73.71943664550781, obj_val: 75.90176391601562, abs dis: 2.1823272705078125
[rfa agg] iter: 5, weight: tensor([0.0339, 0.0433, 0.1031, 0.0562, 0.3381, 0.0101, 0.0991, 0.0462, 0.0403,
        0.2297])
[rfa agg] iter:  6, prev_obj_val: 75.90176391601562, obj_val: 73.71830749511719, abs dis: 2.1834564208984375
[rfa agg] iter: 6, weight: tensor([0.0347, 0.0435, 0.1382, 0.0554, 0.3098, 0.0112, 0.1313, 0.0553, 0.0409,
        0.1796])
[rfa agg] iter:  7, prev_obj_val: 73.71830749511719, obj_val: 75.90199279785156, abs dis: 2.183685302734375
[rfa agg] iter: 7, weight: tensor([0.0337, 0.0431, 0.1024, 0.0559, 0.3427, 0.0100, 0.0986, 0.0459, 0.0401,
        0.2275])
[rfa agg] iter:  8, prev_obj_val: 75.90199279785156, obj_val: 73.71821594238281, abs dis: 2.18377685546875
[rfa agg] iter: 8, weight: tensor([0.0347, 0.0435, 0.1379, 0.0553, 0.3109, 0.0112, 0.1311, 0.0552, 0.0408,
        0.1792])
[rfa agg] iter:  9, prev_obj_val: 73.71821594238281, obj_val: 75.90200805664062, abs dis: 2.1837921142578125
[rfa agg] iter: 9, weight: tensor([0.0337, 0.0431, 0.1024, 0.0559, 0.3431, 0.0100, 0.0985, 0.0459, 0.0401,
        0.2273])
			Update norm = 131.14506221642506 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.1950616836548 sec.
Server Epoch:5 choose agents : [62, 99, 55, 2, 52, 21, 47, 94, 92, 84].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 140/568 (24.6479%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7164, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0694, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 386/773 (49.9353%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2855, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 224/1071 (20.9150%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6989, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1754, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 418/1949 (21.4469%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 657/1949 (33.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3860, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1240, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1072, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 576/1662 (34.6570%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8882, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 465/1715 (27.1137%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 722/1715 (42.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4341, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.8709, Accuracy: 66/10000 (0.6600%)
time spent on training: 156.30286407470703
[rfa agg] training data poison_ratio: 0.0  data num: [568, 773, 1071, 605, 636, 1949, 134, 1662, 1715, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 99, 55, 2, 52, 21, 47, 94, 92, 84], weight: tensor([0.0551, 0.0750, 0.1040, 0.0587, 0.0617, 0.1892, 0.0130, 0.1613, 0.1665,
        0.1155])
[rfa agg] iter:  0, prev_obj_val: 67.18304443359375, obj_val: 69.34563446044922, abs dis: 2.1625900268554688
[rfa agg] iter: 0, weight: tensor([0.0231, 0.0539, 0.2390, 0.0275, 0.0289, 0.0602, 0.0033, 0.0850, 0.0777,
        0.4015])
[rfa agg] iter:  1, prev_obj_val: 69.34563446044922, obj_val: 74.47650146484375, abs dis: 5.130867004394531
[rfa agg] iter: 1, weight: tensor([0.0240, 0.0606, 0.4068, 0.0289, 0.0304, 0.0519, 0.0033, 0.0699, 0.0647,
        0.2596])
[rfa agg] iter:  2, prev_obj_val: 74.47650146484375, obj_val: 78.6201171875, abs dis: 4.14361572265625
[rfa agg] iter: 2, weight: tensor([0.0351, 0.1074, 0.4007, 0.0436, 0.0458, 0.0566, 0.0044, 0.0722, 0.0678,
        0.1664])
[rfa agg] iter:  3, prev_obj_val: 78.6201171875, obj_val: 76.5209732055664, abs dis: 2.0991439819335938
[rfa agg] iter: 3, weight: tensor([0.0488, 0.1842, 0.2678, 0.0622, 0.0652, 0.0633, 0.0057, 0.0783, 0.0741,
        0.1505])
[rfa agg] iter:  4, prev_obj_val: 76.5209732055664, obj_val: 76.51730346679688, abs dis: 0.00366973876953125
[rfa agg] iter: 4, weight: tensor([0.0429, 0.1464, 0.3196, 0.0539, 0.0566, 0.0621, 0.0052, 0.0779, 0.0735,
        0.1619])
			Update norm = 147.844512918133 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.8276391029358 sec.
Server Epoch:6 choose agents : [42, 86, 96, 97, 56, 87, 53, 33, 44, 98].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 360/1372 (26.2391%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 472/1372 (34.4023%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8709, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.5637, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 38/311 (12.2186%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3441, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   1, Avg loss: 0.0535, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 454/1213 (37.4279%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4861, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 58/186 (31.1828%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 285/1131 (25.1989%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 389/1131 (34.3943%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6142, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 278/813 (34.1943%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 419/813 (51.5375%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.3042, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9049, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 401/1750 (22.9143%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 658/1750 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4319, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4272, Accuracy: 50/10000 (0.5000%)
time spent on training: 136.2598934173584
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1003, 311, 1213, 186, 1131, 813, 515, 1750, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 86, 96, 97, 56, 87, 53, 33, 44, 98], weight: tensor([0.1583, 0.1157, 0.0359, 0.1400, 0.0215, 0.1305, 0.0938, 0.0594, 0.2019,
        0.0430])
[rfa agg] iter:  0, prev_obj_val: 54.084407806396484, obj_val: 57.73536682128906, abs dis: 3.650959014892578
[rfa agg] iter: 0, weight: tensor([0.0809, 0.3931, 0.0100, 0.1396, 0.0050, 0.1859, 0.0940, 0.0262, 0.0521,
        0.0132])
[rfa agg] iter:  1, prev_obj_val: 57.73536682128906, obj_val: 57.728240966796875, abs dis: 0.0071258544921875
[rfa agg] iter: 1, weight: tensor([0.0809, 0.3574, 0.0128, 0.1240, 0.0063, 0.1515, 0.1585, 0.0355, 0.0560,
        0.0171])
			Update norm = 143.60172379928105 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.8627643585205 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 81, 85, 10, 92].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 241/1071 (22.5023%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9757, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1278, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3047, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0507, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6935, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 26/312 (8.3333%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0417, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3860, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 326/1418 (22.9901%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 603/1418 (42.5247%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.6322, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 270/813 (33.2103%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 441/813 (54.2435%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.6374, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   2, Avg loss: 0.0382, Accuracy: 276/774 (35.6589%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1973, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 431/1988 (21.6801%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7185, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0577, Accuracy: 198/861 (22.9965%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0226, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7683, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 483/1715 (28.1633%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 684/1715 (39.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3468, Accuracy: 79/10000 (0.7900%)
time spent on training: 190.48937821388245
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 774, 1988, 861, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 61, 33, 24, 70, 53, 81, 85, 10, 92], weight: tensor([0.1121, 0.0089, 0.0539, 0.0327, 0.1485, 0.0851, 0.0810, 0.2081, 0.0901,
        0.1795])
[rfa agg] iter:  0, prev_obj_val: 68.7130355834961, obj_val: 71.1751708984375, abs dis: 2.4621353149414062
[rfa agg] iter: 0, weight: tensor([0.3356, 0.0028, 0.0296, 0.0126, 0.1692, 0.0802, 0.0762, 0.0805, 0.1033,
        0.1100])
[rfa agg] iter:  1, prev_obj_val: 71.1751708984375, obj_val: 72.40496826171875, abs dis: 1.22979736328125
[rfa agg] iter: 1, weight: tensor([0.4847, 0.0021, 0.0256, 0.0100, 0.0810, 0.0846, 0.0802, 0.0479, 0.1228,
        0.0610])
[rfa agg] iter:  2, prev_obj_val: 72.40496826171875, obj_val: 75.1270980834961, abs dis: 2.7221298217773438
[rfa agg] iter: 2, weight: tensor([0.3902, 0.0024, 0.0299, 0.0115, 0.0820, 0.1063, 0.1008, 0.0507, 0.1627,
        0.0635])
[rfa agg] iter:  3, prev_obj_val: 75.1270980834961, obj_val: 76.52665710449219, abs dis: 1.3995590209960938
[rfa agg] iter: 3, weight: tensor([0.2064, 0.0025, 0.0342, 0.0124, 0.0708, 0.1509, 0.1427, 0.0470, 0.2757,
        0.0574])
[rfa agg] iter:  4, prev_obj_val: 76.52665710449219, obj_val: 80.26448822021484, abs dis: 3.7378311157226562
[rfa agg] iter: 4, weight: tensor([0.1372, 0.0022, 0.0312, 0.0109, 0.0557, 0.1626, 0.1534, 0.0381, 0.3628,
        0.0460])
[rfa agg] iter:  5, prev_obj_val: 80.26448822021484, obj_val: 89.2116470336914, abs dis: 8.947158813476562
[rfa agg] iter: 5, weight: tensor([0.0795, 0.0019, 0.0302, 0.0096, 0.0398, 0.2399, 0.2237, 0.0287, 0.3128,
        0.0339])
[rfa agg] iter:  6, prev_obj_val: 89.2116470336914, obj_val: 82.7475814819336, abs dis: 6.4640655517578125
[rfa agg] iter: 6, weight: tensor([0.0849, 0.0032, 0.0671, 0.0175, 0.0517, 0.2696, 0.2536, 0.0400, 0.1665,
        0.0460])
[rfa agg] iter:  7, prev_obj_val: 82.7475814819336, obj_val: 85.80274963378906, abs dis: 3.0551681518554688
[rfa agg] iter: 7, weight: tensor([0.0669, 0.0019, 0.0326, 0.0098, 0.0362, 0.3240, 0.2906, 0.0268, 0.1799,
        0.0314])
[rfa agg] iter:  8, prev_obj_val: 85.80274963378906, obj_val: 85.80197143554688, abs dis: 0.0007781982421875
[rfa agg] iter: 8, weight: tensor([0.0716, 0.0024, 0.0443, 0.0125, 0.0414, 0.3148, 0.2858, 0.0313, 0.1595,
        0.0363])
			Update norm = 122.57259886364285 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.1135504245758 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 401/1475 (27.1864%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 658/1475 (44.6102%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.2901, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 29/312 (9.2949%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3830, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 314/1645 (19.0881%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 645/1645 (39.2097%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0953, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 276/928 (29.7414%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5315, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 307/1089 (28.1910%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 478/1089 (43.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4503, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 422/1440 (29.3056%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 674/1440 (46.8056%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7977, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 426/1904 (22.3739%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 651/1904 (34.1912%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6594, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 395/1574 (25.0953%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 679/1574 (43.1385%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2040, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0495, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2752, Accuracy: 48/10000 (0.4800%)
time spent on training: 137.46638369560242
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 24, 13, 1, 59, 29, 46, 17, 12, 63], weight: tensor([0.1272, 0.0269, 0.1419, 0.0800, 0.0939, 0.1242, 0.1642, 0.1358, 0.0292,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 53.85939025878906, obj_val: 55.5605583190918, abs dis: 1.7011680603027344
[rfa agg] iter: 0, weight: tensor([0.1454, 0.0085, 0.1108, 0.0749, 0.1987, 0.1876, 0.0776, 0.1267, 0.0098,
        0.0601])
[rfa agg] iter:  1, prev_obj_val: 55.5605583190918, obj_val: 55.55581283569336, abs dis: 0.0047454833984375
[rfa agg] iter: 1, weight: tensor([0.1295, 0.0087, 0.1017, 0.0823, 0.2525, 0.1623, 0.0734, 0.1147, 0.0101,
        0.0649])
			Update norm = 182.15482125447573 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 254.93889617919922 sec.
Server Epoch:9 choose agents : [38, 86, 61, 13, 89, 20, 52, 78, 37, 94].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0625, Accuracy: 242/1131 (21.3970%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 493/1131 (43.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2457, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   1, Avg loss: 0.0649, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   2, Avg loss: 0.0354, Accuracy: 368/1003 (36.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1170, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3048, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 316/1645 (19.2097%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 599/1645 (36.4134%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8031, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 317/896 (35.3795%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.2222, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 340/807 (42.1314%)
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8162, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3403, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 32/416 (7.6923%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 157/416 (37.7404%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.5721, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0530, Accuracy: 376/1129 (33.3038%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 745/1129 (65.9876%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4309, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 341/1662 (20.5174%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 588/1662 (35.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7370, Accuracy: 113/10000 (1.1300%)
time spent on training: 174.44046998023987
[rfa agg] training data poison_ratio: 0.08575982996811903  data num: [1131, 1003, 85, 1645, 896, 807, 636, 416, 1129, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.026799946865037196
[rfa agg] init. name: [38, 86, 61, 13, 89, 20, 52, 78, 37, 94], weight: tensor([0.1202, 0.1066, 0.0090, 0.1748, 0.0952, 0.0858, 0.0676, 0.0442, 0.1200,
        0.1766])
[rfa agg] iter:  0, prev_obj_val: 47.98204040527344, obj_val: 51.18001174926758, abs dis: 3.1979713439941406
[rfa agg] iter: 0, weight: tensor([0.2504, 0.2252, 0.0016, 0.0540, 0.0858, 0.0583, 0.0268, 0.0123, 0.2311,
        0.0545])
[rfa agg] iter:  1, prev_obj_val: 51.18001174926758, obj_val: 56.734458923339844, abs dis: 5.554447174072266
[rfa agg] iter: 1, weight: tensor([0.1339, 0.3295, 0.0019, 0.0484, 0.1626, 0.0927, 0.0354, 0.0150, 0.1317,
        0.0489])
[rfa agg] iter:  2, prev_obj_val: 56.734458923339844, obj_val: 59.07832717895508, abs dis: 2.3438682556152344
[rfa agg] iter: 2, weight: tensor([0.0834, 0.1442, 0.0020, 0.0413, 0.3673, 0.1727, 0.0469, 0.0177, 0.0827,
        0.0417])
[rfa agg] iter:  3, prev_obj_val: 59.07832717895508, obj_val: 61.83765411376953, abs dis: 2.759326934814453
[rfa agg] iter: 3, weight: tensor([0.0740, 0.1145, 0.0021, 0.0394, 0.3544, 0.2306, 0.0530, 0.0189, 0.0733,
        0.0398])
[rfa agg] iter:  4, prev_obj_val: 61.83765411376953, obj_val: 59.078941345214844, abs dis: 2.7587127685546875
[rfa agg] iter: 4, weight: tensor([0.0740, 0.1070, 0.0024, 0.0420, 0.2553, 0.3127, 0.0679, 0.0227, 0.0734,
        0.0424])
[rfa agg] iter:  5, prev_obj_val: 59.078941345214844, obj_val: 59.06945037841797, abs dis: 0.009490966796875
[rfa agg] iter: 5, weight: tensor([0.0745, 0.1146, 0.0021, 0.0398, 0.3096, 0.2726, 0.0536, 0.0191, 0.0740,
        0.0402])
[rfa agg] iter:  6, prev_obj_val: 59.06945037841797, obj_val: 59.068424224853516, abs dis: 0.001026153564453125
[rfa agg] iter: 6, weight: tensor([0.0742, 0.1143, 0.0021, 0.0396, 0.3268, 0.2570, 0.0533, 0.0190, 0.0736,
        0.0400])
[rfa agg] iter:  7, prev_obj_val: 59.068424224853516, obj_val: 59.068302154541016, abs dis: 0.0001220703125
[rfa agg] iter: 7, weight: tensor([0.0741, 0.1141, 0.0021, 0.0395, 0.3327, 0.2519, 0.0532, 0.0190, 0.0734,
        0.0399])
			Update norm = 131.05621110328957 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.64945101737976 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 90, 31, 57, 99, 20, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0624, Accuracy: 234/1241 (18.8558%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 421/1241 (33.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3728, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 492/1154 (42.6343%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6762, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 390/1750 (22.2857%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 685/1750 (39.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6642, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 307/677 (45.3471%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 424/677 (62.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9832, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 50/460 (10.8696%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0384, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0564, Accuracy: 290/1154 (25.1300%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0251, Accuracy: 479/1154 (41.5078%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1696, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0677, Accuracy: 185/773 (23.9327%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1520, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.8683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0556, Accuracy: 368/1956 (18.8139%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 630/1956 (32.2086%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.5165, Accuracy: 124/10000 (1.2400%)
time spent on training: 165.80748343467712
[rfa agg] training data poison_ratio: 0.07944477259303012  data num: [1241, 1154, 186, 1750, 677, 460, 1154, 773, 807, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.024826491435321913
[rfa agg] init. name: [72, 15, 56, 44, 90, 31, 57, 99, 20, 6], weight: tensor([0.1222, 0.1136, 0.0183, 0.1723, 0.0666, 0.0453, 0.1136, 0.0761, 0.0794,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 60.98717498779297, obj_val: 62.54579162597656, abs dis: 1.5586166381835938
[rfa agg] iter: 0, weight: tensor([0.1922, 0.2731, 0.0041, 0.0580, 0.0321, 0.0153, 0.2713, 0.0509, 0.0531,
        0.0500])
[rfa agg] iter:  1, prev_obj_val: 62.54579162597656, obj_val: 66.20299530029297, abs dis: 3.6572036743164062
[rfa agg] iter: 1, weight: tensor([0.1806, 0.2544, 0.0048, 0.0628, 0.0392, 0.0182, 0.2549, 0.0639, 0.0667,
        0.0547])
[rfa agg] iter:  2, prev_obj_val: 66.20299530029297, obj_val: 69.9710464477539, abs dis: 3.7680511474609375
[rfa agg] iter: 2, weight: tensor([0.1626, 0.2047, 0.0063, 0.0709, 0.0571, 0.0251, 0.2049, 0.1005, 0.1049,
        0.0630])
[rfa agg] iter:  3, prev_obj_val: 69.9710464477539, obj_val: 71.87800598144531, abs dis: 1.9069595336914062
[rfa agg] iter: 3, weight: tensor([0.1359, 0.1595, 0.0072, 0.0696, 0.0742, 0.0303, 0.1596, 0.1471, 0.1536,
        0.0628])
[rfa agg] iter:  4, prev_obj_val: 71.87800598144531, obj_val: 73.81430053710938, abs dis: 1.9362945556640625
[rfa agg] iter: 4, weight: tensor([0.1196, 0.1369, 0.0073, 0.0653, 0.0814, 0.0317, 0.1369, 0.1767, 0.1846,
        0.0594])
[rfa agg] iter:  5, prev_obj_val: 73.81430053710938, obj_val: 73.81080627441406, abs dis: 0.0034942626953125
[rfa agg] iter: 5, weight: tensor([0.1014, 0.1139, 0.0071, 0.0586, 0.0865, 0.0318, 0.1139, 0.2117, 0.2214,
        0.0537])
			Update norm = 139.36942253414125 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.15174746513367 sec.
Server Epoch:11 choose agents : [25, 80, 30, 6, 94, 12, 89, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3540, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   1, Avg loss: 0.0710, Accuracy: 140/682 (20.5279%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.1839, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0814, Accuracy: 61/486 (12.5514%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.7845, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0559, Accuracy: 403/1956 (20.6033%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 636/1956 (32.5153%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1259, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 298/1662 (17.9302%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 582/1662 (35.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7704, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0878, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0481, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4354, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 323/896 (36.0491%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 460/896 (51.3393%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.1690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 343/712 (48.1742%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3852, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 651/1587 (41.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4099, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 297/1013 (29.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6784, Accuracy: 62/10000 (0.6200%)
time spent on training: 138.14438486099243
[rfa agg] training data poison_ratio: 0.0  data num: [690, 682, 486, 1956, 1662, 338, 896, 712, 1587, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 80, 30, 6, 94, 12, 89, 11, 27, 14], weight: tensor([0.0688, 0.0681, 0.0485, 0.1952, 0.1658, 0.0337, 0.0894, 0.0710, 0.1584,
        0.1011])
[rfa agg] iter:  0, prev_obj_val: 70.60396575927734, obj_val: 73.4361343383789, abs dis: 2.8321685791015625
[rfa agg] iter: 0, weight: tensor([0.0581, 0.0575, 0.0280, 0.0796, 0.1071, 0.0161, 0.1369, 0.0707, 0.1157,
        0.3303])
[rfa agg] iter:  1, prev_obj_val: 73.4361343383789, obj_val: 77.55604553222656, abs dis: 4.119911193847656
[rfa agg] iter: 1, weight: tensor([0.0631, 0.0626, 0.0256, 0.0454, 0.0560, 0.0138, 0.2605, 0.0859, 0.0588,
        0.3284])
[rfa agg] iter:  2, prev_obj_val: 77.55604553222656, obj_val: 81.30265045166016, abs dis: 3.7466049194335938
[rfa agg] iter: 2, weight: tensor([0.0903, 0.0903, 0.0298, 0.0382, 0.0454, 0.0152, 0.3617, 0.1465, 0.0471,
        0.1354])
[rfa agg] iter:  3, prev_obj_val: 81.30265045166016, obj_val: 81.23991394042969, abs dis: 0.06273651123046875
[rfa agg] iter: 3, weight: tensor([0.1367, 0.1379, 0.0349, 0.0348, 0.0405, 0.0168, 0.1838, 0.2793, 0.0418,
        0.0935])
[rfa agg] iter:  4, prev_obj_val: 81.23991394042969, obj_val: 85.7613525390625, abs dis: 4.5214385986328125
[rfa agg] iter: 4, weight: tensor([0.1347, 0.1337, 0.0335, 0.0334, 0.0388, 0.0161, 0.1682, 0.3121, 0.0400,
        0.0894])
[rfa agg] iter:  5, prev_obj_val: 85.7613525390625, obj_val: 91.87076568603516, abs dis: 6.109413146972656
[rfa agg] iter: 5, weight: tensor([0.2278, 0.2262, 0.0350, 0.0260, 0.0297, 0.0155, 0.0888, 0.2630, 0.0304,
        0.0576])
[rfa agg] iter:  6, prev_obj_val: 91.87076568603516, obj_val: 91.85668182373047, abs dis: 0.0140838623046875
[rfa agg] iter: 6, weight: tensor([0.2853, 0.2773, 0.0557, 0.0288, 0.0323, 0.0218, 0.0750, 0.1357, 0.0330,
        0.0550])
			Update norm = 106.05955818695692 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.71669030189514 sec.
Server Epoch:12 choose agents : [37, 82, 96, 32, 34, 88, 63, 20, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 421/1129 (37.2896%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6665, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 60/500 (12.0000%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 168/500 (33.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.5830, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0612, Accuracy: 192/735 (26.1224%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 322/735 (43.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7133, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 580/1427 (40.6447%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7357, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   1, Avg loss: 0.0758, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9015, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 253/888 (28.4910%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8075, Accuracy: 57/10000 (0.5700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0469, Accuracy: 493/1470 (33.5374%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 804/1470 (54.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8257, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 330/1013 (32.5765%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5220, Accuracy: 56/10000 (0.5600%)
time spent on training: 225.48861837387085
[rfa agg] training data poison_ratio: 0.09084768659236744  data num: [1129, 500, 311, 735, 1427, 603, 888, 807, 1470, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.028389902060114824
[rfa agg] init. name: [37, 82, 96, 32, 34, 88, 63, 20, 22, 14], weight: tensor([0.1271, 0.0563, 0.0350, 0.0827, 0.1606, 0.0679, 0.1000, 0.0908, 0.1655,
        0.1140])
[rfa agg] iter:  0, prev_obj_val: 46.413761138916016, obj_val: 49.987186431884766, abs dis: 3.57342529296875
[rfa agg] iter: 0, weight: tensor([0.0710, 0.0263, 0.0105, 0.1287, 0.0438, 0.0495, 0.2747, 0.2377, 0.0451,
        0.1128])
[rfa agg] iter:  1, prev_obj_val: 49.987186431884766, obj_val: 58.02793502807617, abs dis: 8.040748596191406
[rfa agg] iter: 1, weight: tensor([0.0577, 0.0314, 0.0116, 0.2474, 0.0389, 0.0668, 0.1566, 0.2686, 0.0401,
        0.0809])
[rfa agg] iter:  2, prev_obj_val: 58.02793502807617, obj_val: 57.99640655517578, abs dis: 0.031528472900390625
[rfa agg] iter: 2, weight: tensor([0.0607, 0.0612, 0.0190, 0.2433, 0.0453, 0.1912, 0.1097, 0.1467, 0.0466,
        0.0762])
[rfa agg] iter:  3, prev_obj_val: 57.99640655517578, obj_val: 55.06343460083008, abs dis: 2.932971954345703
[rfa agg] iter: 3, weight: tensor([0.0600, 0.0609, 0.0188, 0.2430, 0.0448, 0.2000, 0.1083, 0.1426, 0.0461,
        0.0754])
[rfa agg] iter:  4, prev_obj_val: 55.06343460083008, obj_val: 58.00397872924805, abs dis: 2.9405441284179688
[rfa agg] iter: 4, weight: tensor([0.0567, 0.0463, 0.0154, 0.3271, 0.0411, 0.1258, 0.1126, 0.1593, 0.0423,
        0.0734])
[rfa agg] iter:  5, prev_obj_val: 58.00397872924805, obj_val: 57.996360778808594, abs dis: 0.007617950439453125
[rfa agg] iter: 5, weight: tensor([0.0599, 0.0606, 0.0188, 0.2484, 0.0447, 0.1952, 0.1080, 0.1428, 0.0461,
        0.0753])
[rfa agg] iter:  6, prev_obj_val: 57.996360778808594, obj_val: 55.063419342041016, abs dis: 2.932941436767578
[rfa agg] iter: 6, weight: tensor([0.0600, 0.0609, 0.0188, 0.2433, 0.0448, 0.2002, 0.1082, 0.1424, 0.0461,
        0.0754])
[rfa agg] iter:  7, prev_obj_val: 55.063419342041016, obj_val: 58.00398254394531, abs dis: 2.940563201904297
[rfa agg] iter: 7, weight: tensor([0.0567, 0.0463, 0.0154, 0.3272, 0.0411, 0.1258, 0.1126, 0.1593, 0.0423,
        0.0734])
[rfa agg] iter:  8, prev_obj_val: 58.00398254394531, obj_val: 57.996360778808594, abs dis: 0.00762176513671875
[rfa agg] iter: 8, weight: tensor([0.0599, 0.0606, 0.0188, 0.2484, 0.0447, 0.1952, 0.1080, 0.1428, 0.0461,
        0.0753])
[rfa agg] iter:  9, prev_obj_val: 57.996360778808594, obj_val: 55.063419342041016, abs dis: 2.932941436767578
[rfa agg] iter: 9, weight: tensor([0.0600, 0.0609, 0.0188, 0.2433, 0.0448, 0.2002, 0.1082, 0.1424, 0.0461,
        0.0754])
			Update norm = 114.31191053702584 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.7728981971741 sec.
Server Epoch:13 choose agents : [36, 77, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0557, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.4425, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7891, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 377/818 (46.0880%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.2422, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/1154 (42.4610%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7473, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 467/891 (52.4130%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9724, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 403/1574 (25.6036%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1541, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 227/1049 (21.6397%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 489/1049 (46.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4348, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1090, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3799, Accuracy: 50/10000 (0.5000%)
time spent on training: 127.98183107376099
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1340, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 77, 71, 15, 56, 7, 17, 51, 47, 24], weight: tensor([0.0519, 0.1704, 0.1040, 0.1467, 0.0236, 0.1133, 0.2001, 0.1334, 0.0170,
        0.0397])
[rfa agg] iter:  0, prev_obj_val: 48.947811126708984, obj_val: 51.66134262084961, abs dis: 2.713531494140625
[rfa agg] iter: 0, weight: tensor([0.0210, 0.1054, 0.1386, 0.1401, 0.0064, 0.2359, 0.0725, 0.2626, 0.0046,
        0.0129])
[rfa agg] iter:  1, prev_obj_val: 51.66134262084961, obj_val: 55.406166076660156, abs dis: 3.744823455810547
[rfa agg] iter: 1, weight: tensor([0.0197, 0.0745, 0.1818, 0.0919, 0.0057, 0.4088, 0.0546, 0.1469, 0.0041,
        0.0118])
[rfa agg] iter:  2, prev_obj_val: 55.406166076660156, obj_val: 53.25238037109375, abs dis: 2.1537857055664062
[rfa agg] iter: 2, weight: tensor([0.0191, 0.0547, 0.3084, 0.0638, 0.0053, 0.4019, 0.0421, 0.0898, 0.0038,
        0.0111])
[rfa agg] iter:  3, prev_obj_val: 53.25238037109375, obj_val: 55.4040412902832, abs dis: 2.151660919189453
[rfa agg] iter: 3, weight: tensor([0.0161, 0.0529, 0.1998, 0.0633, 0.0046, 0.5173, 0.0399, 0.0934, 0.0033,
        0.0095])
[rfa agg] iter:  4, prev_obj_val: 55.4040412902832, obj_val: 57.926387786865234, abs dis: 2.5223464965820312
[rfa agg] iter: 4, weight: tensor([0.0185, 0.0530, 0.2957, 0.0618, 0.0051, 0.4239, 0.0408, 0.0866, 0.0037,
        0.0108])
[rfa agg] iter:  5, prev_obj_val: 57.926387786865234, obj_val: 57.861328125, abs dis: 0.06505966186523438
[rfa agg] iter: 5, weight: tensor([0.0215, 0.0533, 0.4588, 0.0609, 0.0057, 0.2595, 0.0420, 0.0820, 0.0041,
        0.0122])
[rfa agg] iter:  6, prev_obj_val: 57.861328125, obj_val: 60.83014678955078, abs dis: 2.9688186645507812
[rfa agg] iter: 6, weight: tensor([0.0188, 0.0465, 0.5407, 0.0532, 0.0050, 0.2132, 0.0367, 0.0717, 0.0036,
        0.0107])
[rfa agg] iter:  7, prev_obj_val: 60.83014678955078, obj_val: 60.82695007324219, abs dis: 0.00319671630859375
[rfa agg] iter: 7, weight: tensor([0.0269, 0.0578, 0.4917, 0.0648, 0.0070, 0.2009, 0.0464, 0.0844, 0.0050,
        0.0150])
[rfa agg] iter:  8, prev_obj_val: 60.82695007324219, obj_val: 60.826881408691406, abs dis: 6.866455078125e-05
[rfa agg] iter: 8, weight: tensor([0.0273, 0.0587, 0.4837, 0.0658, 0.0071, 0.2042, 0.0471, 0.0857, 0.0051,
        0.0152])
			Update norm = 122.63914291530253 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.17439484596252 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 84, 61, 85, 20].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 361/1418 (25.4584%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 631/1418 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7477, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 373/1475 (25.2881%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 696/1475 (47.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3546, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4850, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 147/568 (25.8803%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.7573, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0588, Accuracy: 352/1427 (24.6671%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8656, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 139/818 (16.9927%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 329/818 (40.2200%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2390, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 464/1190 (38.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1639, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3046, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 405/1988 (20.3722%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3439, Accuracy: 81/10000 (0.8100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 432/807 (53.5316%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.7808, Accuracy: 50/10000 (0.5000%)
time spent on training: 238.24027037620544
[rfa agg] training data poison_ratio: 0.07219538378958669  data num: [1418, 1475, 1402, 568, 1427, 818, 1190, 85, 1988, 807]
[rfa agg] considering poison per batch poison_fraction: 0.02256105743424584
[rfa agg] init. name: [70, 65, 66, 62, 34, 71, 84, 61, 85, 20], weight: tensor([0.1269, 0.1320, 0.1254, 0.0508, 0.1277, 0.0732, 0.1065, 0.0076, 0.1778,
        0.0722])
[rfa agg] iter:  0, prev_obj_val: 54.209571838378906, obj_val: 52.08732604980469, abs dis: 2.1222457885742188
[rfa agg] iter: 0, weight: tensor([0.1106, 0.0926, 0.1439, 0.0181, 0.1111, 0.0433, 0.3873, 0.0016, 0.0488,
        0.0425])
[rfa agg] iter:  1, prev_obj_val: 52.08732604980469, obj_val: 56.29697036743164, abs dis: 4.209644317626953
[rfa agg] iter: 1, weight: tensor([0.1113, 0.0911, 0.1510, 0.0154, 0.1118, 0.0357, 0.4021, 0.0014, 0.0452,
        0.0351])
[rfa agg] iter:  2, prev_obj_val: 56.29697036743164, obj_val: 58.781227111816406, abs dis: 2.4842567443847656
[rfa agg] iter: 2, weight: tensor([0.0963, 0.0824, 0.1215, 0.0186, 0.0967, 0.0461, 0.4458, 0.0016, 0.0459,
        0.0451])
[rfa agg] iter:  3, prev_obj_val: 58.781227111816406, obj_val: 58.77490997314453, abs dis: 0.006317138671875
[rfa agg] iter: 3, weight: tensor([0.1035, 0.0901, 0.1272, 0.0234, 0.1040, 0.0602, 0.3781, 0.0019, 0.0527,
        0.0589])
[rfa agg] iter:  4, prev_obj_val: 58.77490997314453, obj_val: 58.774818420410156, abs dis: 9.1552734375e-05
[rfa agg] iter: 4, weight: tensor([0.1048, 0.0912, 0.1289, 0.0237, 0.1054, 0.0609, 0.3702, 0.0019, 0.0533,
        0.0597])
			Update norm = 169.31300179881342 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.43286395072937 sec.
Server Epoch:15 choose agents : [70, 63, 85, 80, 26, 42, 18, 66, 39, 97].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4631, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 253/888 (28.4910%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 430/888 (48.4234%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4567, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 426/1988 (21.4286%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9518, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 141/682 (20.6745%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.1940, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 474/1446 (32.7801%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0945, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0537, Accuracy: 338/1372 (24.6356%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 488/1372 (35.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9760, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 109/530 (20.5660%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0376, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0479, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 409/1402 (29.1726%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1927, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0538, Accuracy: 309/1013 (30.5035%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5418, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 341/1213 (28.1121%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 459/1213 (37.8401%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0749, Accuracy: 91/10000 (0.9100%)
time spent on training: 147.96156430244446
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 888, 1988, 682, 1446, 1372, 530, 1402, 1013, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 63, 85, 80, 26, 42, 18, 66, 39, 97], weight: tensor([0.1186, 0.0743, 0.1663, 0.0571, 0.1210, 0.1148, 0.0443, 0.1173, 0.0848,
        0.1015])
[rfa agg] iter:  0, prev_obj_val: 49.40666580200195, obj_val: 53.037567138671875, abs dis: 3.630901336669922
[rfa agg] iter: 0, weight: tensor([0.0937, 0.0481, 0.0418, 0.0232, 0.0964, 0.1200, 0.0145, 0.1233, 0.0894,
        0.3497])
[rfa agg] iter:  1, prev_obj_val: 53.037567138671875, obj_val: 59.4794807434082, abs dis: 6.441913604736328
[rfa agg] iter: 1, weight: tensor([0.0858, 0.0675, 0.0440, 0.0301, 0.0882, 0.1039, 0.0182, 0.1066, 0.1449,
        0.3109])
[rfa agg] iter:  2, prev_obj_val: 59.4794807434082, obj_val: 59.39895248413086, abs dis: 0.08052825927734375
[rfa agg] iter: 2, weight: tensor([0.0684, 0.1074, 0.0407, 0.0390, 0.0700, 0.0783, 0.0223, 0.0802, 0.3453,
        0.1484])
[rfa agg] iter:  3, prev_obj_val: 59.39895248413086, obj_val: 64.40087890625, abs dis: 5.001926422119141
[rfa agg] iter: 3, weight: tensor([0.0636, 0.1005, 0.0379, 0.0363, 0.0651, 0.0728, 0.0208, 0.0745, 0.3937,
        0.1349])
[rfa agg] iter:  4, prev_obj_val: 64.40087890625, obj_val: 67.2428970336914, abs dis: 2.8420181274414062
[rfa agg] iter: 4, weight: tensor([0.0550, 0.1546, 0.0354, 0.0438, 0.0562, 0.0615, 0.0237, 0.0629, 0.4084,
        0.0985])
[rfa agg] iter:  5, prev_obj_val: 67.2428970336914, obj_val: 70.15121459960938, abs dis: 2.9083175659179688
[rfa agg] iter: 5, weight: tensor([0.0579, 0.2361, 0.0385, 0.0551, 0.0592, 0.0641, 0.0288, 0.0656, 0.2975,
        0.0973])
[rfa agg] iter:  6, prev_obj_val: 70.15121459960938, obj_val: 70.13233947753906, abs dis: 0.0188751220703125
[rfa agg] iter: 6, weight: tensor([0.0538, 0.3528, 0.0369, 0.0617, 0.0550, 0.0591, 0.0309, 0.0604, 0.2036,
        0.0858])
[rfa agg] iter:  7, prev_obj_val: 70.13233947753906, obj_val: 67.24397277832031, abs dis: 2.88836669921875
[rfa agg] iter: 7, weight: tensor([0.0520, 0.3791, 0.0356, 0.0597, 0.0531, 0.0571, 0.0299, 0.0584, 0.1923,
        0.0829])
[rfa agg] iter:  8, prev_obj_val: 67.24397277832031, obj_val: 70.14471435546875, abs dis: 2.9007415771484375
[rfa agg] iter: 8, weight: tensor([0.0580, 0.2607, 0.0386, 0.0552, 0.0593, 0.0642, 0.0289, 0.0657, 0.2721,
        0.0974])
[rfa agg] iter:  9, prev_obj_val: 70.14471435546875, obj_val: 67.23994445800781, abs dis: 2.9047698974609375
[rfa agg] iter: 9, weight: tensor([0.0534, 0.3584, 0.0366, 0.0613, 0.0546, 0.0586, 0.0307, 0.0600, 0.2010,
        0.0852])
			Update norm = 143.7709971078138 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.0595805644989 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 81, 6, 64, 98, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3755, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 485/1470 (32.9932%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0034, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 152/818 (18.5819%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 338/818 (41.3203%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0164, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 383/1402 (27.3181%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0160, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   1, Avg loss: 0.0692, Accuracy: 229/774 (29.5866%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1681, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 411/1956 (21.0123%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 643/1956 (32.8732%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1163, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.2689, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.4292, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0521, Accuracy: 308/1089 (28.2828%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0363, Accuracy: 478/1089 (43.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4665, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 47/515 (9.1262%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0500, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6460, Accuracy: 45/10000 (0.4500%)
time spent on training: 183.14325380325317
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 774, 1956, 953, 373, 1089, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 22, 71, 66, 81, 6, 64, 98, 59, 33], weight: tensor([0.0323, 0.1521, 0.0847, 0.1451, 0.0801, 0.2024, 0.0986, 0.0386, 0.1127,
        0.0533])
[rfa agg] iter:  0, prev_obj_val: 61.0381965637207, obj_val: 64.0350341796875, abs dis: 2.996837615966797
[rfa agg] iter: 0, weight: tensor([0.0112, 0.1052, 0.0877, 0.1200, 0.0831, 0.0608, 0.1882, 0.0147, 0.3012,
        0.0279])
[rfa agg] iter:  1, prev_obj_val: 64.0350341796875, obj_val: 68.64698791503906, abs dis: 4.6119537353515625
[rfa agg] iter: 1, weight: tensor([0.0112, 0.0740, 0.1192, 0.0813, 0.1133, 0.0481, 0.3532, 0.0148, 0.1550,
        0.0299])
[rfa agg] iter:  2, prev_obj_val: 68.64698791503906, obj_val: 72.90385437011719, abs dis: 4.256866455078125
[rfa agg] iter: 2, weight: tensor([0.0114, 0.0541, 0.2230, 0.0580, 0.2133, 0.0383, 0.2657, 0.0153, 0.0870,
        0.0338])
[rfa agg] iter:  3, prev_obj_val: 72.90385437011719, obj_val: 82.19194793701172, abs dis: 9.288093566894531
[rfa agg] iter: 3, weight: tensor([0.0098, 0.0375, 0.3411, 0.0398, 0.3283, 0.0279, 0.1156, 0.0134, 0.0542,
        0.0323])
[rfa agg] iter:  4, prev_obj_val: 82.19194793701172, obj_val: 78.90496063232422, abs dis: 3.2869873046875
[rfa agg] iter: 4, weight: tensor([0.0222, 0.0607, 0.2448, 0.0634, 0.2317, 0.0478, 0.1265, 0.0314, 0.0784,
        0.0931])
[rfa agg] iter:  5, prev_obj_val: 78.90496063232422, obj_val: 75.72477722167969, abs dis: 3.1801834106445312
[rfa agg] iter: 5, weight: tensor([0.0173, 0.0531, 0.2821, 0.0557, 0.2671, 0.0410, 0.1222, 0.0243, 0.0709,
        0.0663])
[rfa agg] iter:  6, prev_obj_val: 75.72477722167969, obj_val: 78.90540313720703, abs dis: 3.1806259155273438
[rfa agg] iter: 6, weight: tensor([0.0123, 0.0422, 0.3289, 0.0445, 0.3111, 0.0320, 0.1098, 0.0171, 0.0585,
        0.0435])
[rfa agg] iter:  7, prev_obj_val: 78.90540313720703, obj_val: 75.7244873046875, abs dis: 3.1809158325195312
[rfa agg] iter: 7, weight: tensor([0.0172, 0.0526, 0.2845, 0.0552, 0.2687, 0.0407, 0.1212, 0.0240, 0.0702,
        0.0655])
[rfa agg] iter:  8, prev_obj_val: 75.7244873046875, obj_val: 78.90541076660156, abs dis: 3.1809234619140625
[rfa agg] iter: 8, weight: tensor([0.0123, 0.0422, 0.3291, 0.0445, 0.3110, 0.0320, 0.1098, 0.0171, 0.0585,
        0.0435])
[rfa agg] iter:  9, prev_obj_val: 78.90541076660156, obj_val: 75.72447967529297, abs dis: 3.1809310913085938
[rfa agg] iter: 9, weight: tensor([0.0172, 0.0526, 0.2846, 0.0552, 0.2687, 0.0407, 0.1212, 0.0240, 0.0702,
        0.0655])
			Update norm = 122.66115037981668 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.51684069633484 sec.
Server Epoch:17 choose agents : [36, 29, 28, 82, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0880, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0563, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.4788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 427/1440 (29.6528%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 648/1440 (45.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7035, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 419/1581 (26.5022%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 563/1581 (35.6104%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7066, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6338, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 504/1071 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3066, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 404/888 (45.4955%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1540, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6689, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0627, Accuracy: 316/715 (44.1958%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6915, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 382/1628 (23.4644%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 829/1628 (50.9214%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2001, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 319/946 (33.7209%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0104, Accuracy: 57/10000 (0.5700%)
time spent on training: 158.79761719703674
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 500, 1071, 888, 515, 715, 1628, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 29, 28, 82, 55, 63, 33, 23, 5, 43], weight: tensor([0.0421, 0.1486, 0.1631, 0.0516, 0.1105, 0.0916, 0.0531, 0.0738, 0.1680,
        0.0976])
[rfa agg] iter:  0, prev_obj_val: 57.091365814208984, obj_val: 62.512081146240234, abs dis: 5.42071533203125
[rfa agg] iter: 0, weight: tensor([0.0150, 0.0531, 0.0467, 0.0210, 0.1450, 0.2006, 0.0252, 0.0687, 0.0437,
        0.3809])
[rfa agg] iter:  1, prev_obj_val: 62.512081146240234, obj_val: 64.84226989746094, abs dis: 2.330188751220703
[rfa agg] iter: 1, weight: tensor([0.0211, 0.0515, 0.0467, 0.0306, 0.1016, 0.3170, 0.0383, 0.1455, 0.0442,
        0.2035])
[rfa agg] iter:  2, prev_obj_val: 64.84226989746094, obj_val: 67.3329086303711, abs dis: 2.4906387329101562
[rfa agg] iter: 2, weight: tensor([0.0245, 0.0526, 0.0482, 0.0361, 0.0959, 0.2715, 0.0463, 0.2152, 0.0457,
        0.1641])
[rfa agg] iter:  3, prev_obj_val: 67.3329086303711, obj_val: 69.9599838256836, abs dis: 2.6270751953125
[rfa agg] iter: 3, weight: tensor([0.0267, 0.0500, 0.0462, 0.0400, 0.0856, 0.1964, 0.0526, 0.3251, 0.0440,
        0.1334])
[rfa agg] iter:  4, prev_obj_val: 69.9599838256836, obj_val: 75.9799575805664, abs dis: 6.0199737548828125
[rfa agg] iter: 4, weight: tensor([0.0265, 0.0433, 0.0402, 0.0406, 0.0700, 0.1372, 0.0551, 0.4470, 0.0384,
        0.1017])
[rfa agg] iter:  5, prev_obj_val: 75.9799575805664, obj_val: 72.88748168945312, abs dis: 3.0924758911132812
[rfa agg] iter: 5, weight: tensor([0.0450, 0.0546, 0.0514, 0.0732, 0.0806, 0.1300, 0.1094, 0.3003, 0.0494,
        0.1061])
[rfa agg] iter:  6, prev_obj_val: 72.88748168945312, obj_val: 69.94527435302734, abs dis: 2.9422073364257812
[rfa agg] iter: 6, weight: tensor([0.0347, 0.0489, 0.0457, 0.0546, 0.0753, 0.1320, 0.0776, 0.3840, 0.0438,
        0.1035])
[rfa agg] iter:  7, prev_obj_val: 69.94527435302734, obj_val: 79.13298034667969, abs dis: 9.187705993652344
[rfa agg] iter: 7, weight: tensor([0.0251, 0.0410, 0.0381, 0.0385, 0.0663, 0.1285, 0.0523, 0.4776, 0.0364,
        0.0962])
[rfa agg] iter:  8, prev_obj_val: 79.13298034667969, obj_val: 75.96834564208984, abs dis: 3.1646347045898438
[rfa agg] iter: 8, weight: tensor([0.0555, 0.0572, 0.0541, 0.0941, 0.0812, 0.1226, 0.1509, 0.2292, 0.0521,
        0.1032])
[rfa agg] iter:  9, prev_obj_val: 75.96834564208984, obj_val: 72.8892822265625, abs dis: 3.0790634155273438
[rfa agg] iter: 9, weight: tensor([0.0460, 0.0554, 0.0522, 0.0750, 0.0818, 0.1322, 0.1134, 0.2862, 0.0501,
        0.1077])
			Update norm = 114.20010962806691 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.28216648101807 sec.
Server Epoch:18 choose agents : [78, 91, 3, 24, 2, 8, 80, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 323/1030 (31.3592%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   2, Avg loss: 0.0278, Accuracy: 632/1030 (61.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9650, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 106/781 (13.5723%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4695, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0418, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3803, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0408, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9314, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 230/1513 (15.2016%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 447/1513 (29.5440%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4338, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.2016, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 488/1049 (46.5205%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5370, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 170/938 (18.1237%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 304/938 (32.4094%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2058, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 418/1440 (29.0278%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 632/1440 (43.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0027, Accuracy: 75/10000 (0.7500%)
time spent on training: 173.72969031333923
[rfa agg] training data poison_ratio: 0.0  data num: [416, 1030, 781, 312, 605, 1513, 682, 1049, 938, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 91, 3, 24, 2, 8, 80, 51, 73, 29], weight: tensor([0.0475, 0.1175, 0.0891, 0.0356, 0.0690, 0.1726, 0.0778, 0.1197, 0.1070,
        0.1643])
[rfa agg] iter:  0, prev_obj_val: 46.95977020263672, obj_val: 51.87030029296875, abs dis: 4.910530090332031
[rfa agg] iter: 0, weight: tensor([0.0191, 0.1327, 0.1583, 0.0112, 0.0460, 0.0551, 0.0664, 0.1356, 0.3170,
        0.0586])
[rfa agg] iter:  1, prev_obj_val: 51.87030029296875, obj_val: 53.89707565307617, abs dis: 2.026775360107422
[rfa agg] iter: 1, weight: tensor([0.0243, 0.0889, 0.3406, 0.0136, 0.0694, 0.0489, 0.1147, 0.0909, 0.1574,
        0.0512])
[rfa agg] iter:  2, prev_obj_val: 53.89707565307617, obj_val: 56.22700500488281, abs dis: 2.3299293518066406
[rfa agg] iter: 2, weight: tensor([0.0263, 0.0788, 0.3511, 0.0144, 0.0814, 0.0464, 0.1477, 0.0806, 0.1250,
        0.0484])
[rfa agg] iter:  3, prev_obj_val: 56.22700500488281, obj_val: 58.642879486083984, abs dis: 2.415874481201172
[rfa agg] iter: 3, weight: tensor([0.0311, 0.0769, 0.2569, 0.0166, 0.1071, 0.0480, 0.2208, 0.0786, 0.1141,
        0.0498])
[rfa agg] iter:  4, prev_obj_val: 58.642879486083984, obj_val: 58.62493133544922, abs dis: 0.017948150634765625
[rfa agg] iter: 4, weight: tensor([0.0327, 0.0665, 0.1722, 0.0169, 0.1304, 0.0437, 0.3303, 0.0680, 0.0940,
        0.0452])
[rfa agg] iter:  5, prev_obj_val: 58.62493133544922, obj_val: 58.62456130981445, abs dis: 0.000370025634765625
[rfa agg] iter: 5, weight: tensor([0.0318, 0.0647, 0.1641, 0.0165, 0.1282, 0.0425, 0.3507, 0.0661, 0.0914,
        0.0440])
			Update norm = 114.1187361369727 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.3594994544983 sec.
Server Epoch:19 choose agents : [7, 88, 36, 17, 91, 94, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3395, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 136/603 (22.5539%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8588, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0882, Accuracy: 65/408 (15.9314%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 691/1574 (43.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.3734, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   1, Avg loss: 0.0526, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   2, Avg loss: 0.0300, Accuracy: 606/1030 (58.8350%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1336, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 603/1662 (36.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2019, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 385/1949 (19.7537%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 614/1949 (31.5033%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1583, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 555/2227 (24.9214%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 1016/2227 (45.6219%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5918, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0583, Accuracy: 347/712 (48.7360%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0260, Accuracy: 404/712 (56.7416%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.4520, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0584, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 378/1154 (32.7556%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8889, Accuracy: 51/10000 (0.5100%)
time spent on training: 202.36507844924927
[rfa agg] training data poison_ratio: 0.0  data num: [891, 603, 408, 1574, 1030, 1662, 1949, 2227, 712, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 88, 36, 17, 91, 94, 21, 60, 11, 15], weight: tensor([0.0730, 0.0494, 0.0334, 0.1289, 0.0844, 0.1361, 0.1596, 0.1824, 0.0583,
        0.0945])
[rfa agg] iter:  0, prev_obj_val: 71.64032745361328, obj_val: 72.59073638916016, abs dis: 0.950408935546875
[rfa agg] iter: 0, weight: tensor([0.0597, 0.0259, 0.0138, 0.1817, 0.1181, 0.1550, 0.0920, 0.0752, 0.0374,
        0.2412])
[rfa agg] iter:  1, prev_obj_val: 72.59073638916016, obj_val: 76.01547241210938, abs dis: 3.4247360229492188
[rfa agg] iter: 1, weight: tensor([0.0607, 0.0257, 0.0135, 0.1541, 0.1269, 0.1338, 0.0829, 0.0687, 0.0374,
        0.2962])
[rfa agg] iter:  2, prev_obj_val: 76.01547241210938, obj_val: 77.52188873291016, abs dis: 1.5064163208007812
[rfa agg] iter: 2, weight: tensor([0.0578, 0.0221, 0.0112, 0.0861, 0.1523, 0.0781, 0.0537, 0.0461, 0.0335,
        0.4592])
[rfa agg] iter:  3, prev_obj_val: 77.52188873291016, obj_val: 79.2994155883789, abs dis: 1.77752685546875
[rfa agg] iter: 3, weight: tensor([0.0613, 0.0225, 0.0113, 0.0763, 0.1791, 0.0700, 0.0496, 0.0430, 0.0347,
        0.4523])
[rfa agg] iter:  4, prev_obj_val: 79.2994155883789, obj_val: 83.20293426513672, abs dis: 3.9035186767578125
[rfa agg] iter: 4, weight: tensor([0.0756, 0.0264, 0.0130, 0.0785, 0.2531, 0.0726, 0.0527, 0.0461, 0.0414,
        0.3405])
[rfa agg] iter:  5, prev_obj_val: 83.20293426513672, obj_val: 81.11759948730469, abs dis: 2.0853347778320312
[rfa agg] iter: 5, weight: tensor([0.0977, 0.0299, 0.0142, 0.0683, 0.3975, 0.0642, 0.0485, 0.0432, 0.0491,
        0.1875])
[rfa agg] iter:  6, prev_obj_val: 81.11759948730469, obj_val: 83.1310806274414, abs dis: 2.0134811401367188
[rfa agg] iter: 6, weight: tensor([0.0814, 0.0267, 0.0129, 0.0695, 0.3980, 0.0649, 0.0481, 0.0424, 0.0427,
        0.2132])
[rfa agg] iter:  7, prev_obj_val: 83.1310806274414, obj_val: 83.1189193725586, abs dis: 0.0121612548828125
[rfa agg] iter: 7, weight: tensor([0.0885, 0.0271, 0.0128, 0.0619, 0.4597, 0.0582, 0.0440, 0.0391, 0.0445,
        0.1641])
[rfa agg] iter:  8, prev_obj_val: 83.1189193725586, obj_val: 87.88399505615234, abs dis: 4.76507568359375
[rfa agg] iter: 8, weight: tensor([0.0839, 0.0257, 0.0122, 0.0587, 0.4901, 0.0552, 0.0417, 0.0371, 0.0421,
        0.1533])
[rfa agg] iter:  9, prev_obj_val: 87.88399505615234, obj_val: 85.41302490234375, abs dis: 2.4709701538085938
[rfa agg] iter: 9, weight: tensor([0.1531, 0.0391, 0.0177, 0.0685, 0.3486, 0.0651, 0.0510, 0.0461, 0.0683,
        0.1425])
			Update norm = 156.37554331440387 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.8573110103607 sec.
Server Epoch:20 choose agents : [77, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 314/1340 (23.4328%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 554/1340 (41.3433%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6795, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 217/1013 (21.4215%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.4479, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 502/1071 (46.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0551, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0546, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 460/891 (51.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0394, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.4013, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 138/809 (17.0581%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 331/809 (40.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1366, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 157/818 (19.1932%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2344, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0568, Accuracy: 283/636 (44.4969%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1537, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 296/1089 (27.1809%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0345, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0581, Accuracy: 207/861 (24.0418%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 466/861 (54.1231%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8864, Accuracy: 50/10000 (0.5000%)
time spent on training: 189.6164357662201
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 14, 55, 7, 64, 50, 71, 52, 59, 10], weight: tensor([0.1413, 0.1068, 0.1130, 0.0940, 0.1005, 0.0853, 0.0863, 0.0671, 0.1149,
        0.0908])
[rfa agg] iter:  0, prev_obj_val: 26.97026252746582, obj_val: 36.18284225463867, abs dis: 9.212579727172852
[rfa agg] iter: 0, weight: tensor([0.0317, 0.0692, 0.0529, 0.1645, 0.1003, 0.1649, 0.1665, 0.0316, 0.0422,
        0.1760])
[rfa agg] iter:  1, prev_obj_val: 36.18284225463867, obj_val: 39.89572525024414, abs dis: 3.7128829956054688
[rfa agg] iter: 1, weight: tensor([0.0416, 0.0696, 0.0591, 0.1165, 0.0863, 0.1872, 0.1913, 0.0830, 0.0502,
        0.1152])
[rfa agg] iter:  2, prev_obj_val: 39.89572525024414, obj_val: 36.17302322387695, abs dis: 3.7227020263671875
[rfa agg] iter: 2, weight: tensor([0.0463, 0.0731, 0.0634, 0.1115, 0.0877, 0.1632, 0.1654, 0.1253, 0.0546,
        0.1096])
[rfa agg] iter:  3, prev_obj_val: 36.17302322387695, obj_val: 39.895687103271484, abs dis: 3.7226638793945312
[rfa agg] iter: 3, weight: tensor([0.0415, 0.0695, 0.0590, 0.1151, 0.0861, 0.1891, 0.1916, 0.0839, 0.0501,
        0.1140])
[rfa agg] iter:  4, prev_obj_val: 39.895687103271484, obj_val: 36.17302703857422, abs dis: 3.7226600646972656
[rfa agg] iter: 4, weight: tensor([0.0463, 0.0731, 0.0633, 0.1115, 0.0877, 0.1632, 0.1654, 0.1254, 0.0546,
        0.1096])
[rfa agg] iter:  5, prev_obj_val: 36.17302703857422, obj_val: 39.895687103271484, abs dis: 3.7226600646972656
[rfa agg] iter: 5, weight: tensor([0.0415, 0.0695, 0.0590, 0.1151, 0.0861, 0.1891, 0.1916, 0.0839, 0.0501,
        0.1140])
[rfa agg] iter:  6, prev_obj_val: 39.895687103271484, obj_val: 36.17302703857422, abs dis: 3.7226600646972656
[rfa agg] iter: 6, weight: tensor([0.0463, 0.0731, 0.0633, 0.1115, 0.0877, 0.1632, 0.1654, 0.1254, 0.0546,
        0.1096])
[rfa agg] iter:  7, prev_obj_val: 36.17302703857422, obj_val: 39.895687103271484, abs dis: 3.7226600646972656
[rfa agg] iter: 7, weight: tensor([0.0415, 0.0695, 0.0590, 0.1151, 0.0861, 0.1891, 0.1916, 0.0839, 0.0501,
        0.1140])
[rfa agg] iter:  8, prev_obj_val: 39.895687103271484, obj_val: 36.17302703857422, abs dis: 3.7226600646972656
[rfa agg] iter: 8, weight: tensor([0.0463, 0.0731, 0.0633, 0.1115, 0.0877, 0.1632, 0.1654, 0.1254, 0.0546,
        0.1096])
[rfa agg] iter:  9, prev_obj_val: 36.17302703857422, obj_val: 39.895687103271484, abs dis: 3.7226600646972656
[rfa agg] iter: 9, weight: tensor([0.0415, 0.0695, 0.0590, 0.1151, 0.0861, 0.1891, 0.1916, 0.0839, 0.0501,
        0.1140])
			Update norm = 114.75413169985427 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.54952359199524 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 78, 74, 75, 96, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0567, Accuracy: 403/1657 (24.3211%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0334, Accuracy: 673/1657 (40.6156%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0275, Accuracy: 807/1657 (48.7025%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0266, Accuracy: 817/1657 (49.3060%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0262, Accuracy: 798/1657 (48.1593%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0257, Accuracy: 845/1657 (50.9958%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0260, Accuracy: 826/1657 (49.8491%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0250, Accuracy: 856/1657 (51.6596%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0248, Accuracy: 867/1657 (52.3235%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0240, Accuracy: 880/1657 (53.1080%), train_poison_data_count: 520
Global model norm: 112.05632128811386.
Norm before scaling: 112.03024319631284. Distance: 1.2435712484602353
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4832, Accuracy: 65/10000 (0.6500%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.5777, Accuracy: 9834/9950 (98.8342%)
Scaling by  100
Scaled Norm after poisoning: 165.17341147828546, distance: 124.35713203939089
Total norm for 2 adversaries is: 165.17341147828546. distance: 124.35713203939089
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 662/1574 (42.0584%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8992, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 317/1446 (21.9225%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2355, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1255, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   1, Avg loss: 0.0842, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.5363, Accuracy: 51/10000 (0.5100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 472/1552 (30.4124%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 753/1552 (48.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.1265, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 244/776 (31.4433%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7565, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 376/1475 (25.4915%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 682/1475 (46.2373%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2426, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 494/1470 (33.6054%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 841/1470 (57.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1294, Accuracy: 72/10000 (0.7200%)
time spent on training: 338.52937746047974
[rfa agg] training data poison_ratio: 0.29682730552215336  data num: [1657, 1574, 1446, 134, 416, 1552, 776, 311, 1475, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.09275853297567292
[rfa agg] init. name: [0, 17, 26, 47, 78, 74, 75, 96, 65, 22], weight: tensor([0.1533, 0.1456, 0.1338, 0.0124, 0.0385, 0.1436, 0.0718, 0.0288, 0.1364,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 30153.65234375, obj_val: 20358.466796875, abs dis: 9795.185546875
[rfa agg] iter: 0, weight: tensor([0.0317, 0.1668, 0.1531, 0.0140, 0.0437, 0.1645, 0.0817, 0.0326, 0.1562,
        0.1556])
[rfa agg] iter:  1, prev_obj_val: 20358.466796875, obj_val: 18272.197265625, abs dis: 2086.26953125
[rfa agg] iter: 1, weight: tensor([0.0059, 0.1724, 0.1576, 0.0139, 0.0436, 0.1700, 0.0826, 0.0325, 0.1612,
        0.1603])
[rfa agg] iter:  2, prev_obj_val: 18272.197265625, obj_val: 17878.271484375, abs dis: 393.92578125
[rfa agg] iter: 2, weight: tensor([0.0010, 0.1796, 0.1604, 0.0116, 0.0378, 0.1771, 0.0757, 0.0276, 0.1660,
        0.1631])
[rfa agg] iter:  3, prev_obj_val: 17878.271484375, obj_val: 17838.23828125, abs dis: 40.033203125
[rfa agg] iter: 3, weight: tensor([1.2518e-04, 2.1815e-01, 1.5637e-01, 4.4973e-03, 1.6276e-02, 2.1510e-01,
        3.9980e-02, 1.1246e-02, 1.7912e-01, 1.5913e-01])
[rfa agg] iter:  4, prev_obj_val: 17838.23828125, obj_val: 17845.3828125, abs dis: 7.14453125
[rfa agg] iter: 4, weight: tensor([2.3110e-05, 1.3036e-01, 2.6012e-01, 1.1990e-03, 4.6914e-03, 1.2880e-01,
        1.3993e-02, 3.1081e-03, 1.8336e-01, 2.7434e-01])
[rfa agg] iter:  5, prev_obj_val: 17845.3828125, obj_val: 17842.6015625, abs dis: 2.78125
[rfa agg] iter: 5, weight: tensor([3.9480e-05, 1.3361e-01, 2.5723e-01, 2.2099e-03, 8.8355e-03, 1.3202e-01,
        2.8055e-02, 5.7845e-03, 1.6749e-01, 2.6473e-01])
[rfa agg] iter:  6, prev_obj_val: 17842.6015625, obj_val: 17845.380859375, abs dis: 2.779296875
[rfa agg] iter: 6, weight: tensor([3.2034e-05, 1.2485e-01, 2.7276e-01, 1.7473e-03, 6.9329e-03, 1.2345e-01,
        2.1521e-02, 4.5581e-03, 1.6222e-01, 2.8193e-01])
			Update norm = 199.62148752388856 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 452.8715193271637 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 76, 2, 74, 8, 78, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0528, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5400, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 511/1470 (34.7619%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 855/1470 (58.1633%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2898, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0812, Accuracy: 22/440 (5.0000%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4825, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0771, Accuracy: 104/530 (19.6226%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0377, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0639, Accuracy: 224/605 (37.0248%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7890, Accuracy: 51/10000 (0.5100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0438, Accuracy: 454/1552 (29.2526%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 771/1552 (49.6778%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.6758, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 216/1513 (14.2763%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 457/1513 (30.2049%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3719, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 30/416 (7.2115%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   2, Avg loss: 0.0475, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.5675, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 456/1130 (40.3540%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5128, Accuracy: 50/10000 (0.5000%)
time spent on training: 188.60743284225464
[rfa agg] training data poison_ratio: 0.17568485397328504  data num: [712, 1470, 440, 530, 466, 605, 1552, 1513, 416, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.054901516866651574
[rfa agg] init. name: [11, 22, 49, 18, 76, 2, 74, 8, 78, 54], weight: tensor([0.0806, 0.1664, 0.0498, 0.0600, 0.0528, 0.0685, 0.1757, 0.1713, 0.0471,
        0.1279])
[rfa agg] iter:  0, prev_obj_val: 64.13166809082031, obj_val: 66.63494873046875, abs dis: 2.5032806396484375
[rfa agg] iter: 0, weight: tensor([0.1567, 0.1239, 0.0371, 0.0595, 0.0449, 0.0811, 0.1050, 0.1136, 0.0350,
        0.2433])
[rfa agg] iter:  1, prev_obj_val: 66.63494873046875, obj_val: 70.55784606933594, abs dis: 3.9228973388671875
[rfa agg] iter: 1, weight: tensor([0.2219, 0.1070, 0.0410, 0.0690, 0.0507, 0.0977, 0.0926, 0.0993, 0.0387,
        0.1821])
[rfa agg] iter:  2, prev_obj_val: 70.55784606933594, obj_val: 73.79751586914062, abs dis: 3.2396697998046875
[rfa agg] iter: 2, weight: tensor([0.4229, 0.0653, 0.0369, 0.0695, 0.0477, 0.1085, 0.0580, 0.0614, 0.0348,
        0.0949])
[rfa agg] iter:  3, prev_obj_val: 73.79751586914062, obj_val: 77.84761047363281, abs dis: 4.0500946044921875
[rfa agg] iter: 3, weight: tensor([0.4307, 0.0511, 0.0385, 0.0823, 0.0521, 0.1455, 0.0460, 0.0484, 0.0363,
        0.0689])
[rfa agg] iter:  4, prev_obj_val: 77.84761047363281, obj_val: 79.96483612060547, abs dis: 2.1172256469726562
[rfa agg] iter: 4, weight: tensor([0.1913, 0.0491, 0.0512, 0.1363, 0.0747, 0.2951, 0.0448, 0.0468, 0.0481,
        0.0625])
[rfa agg] iter:  5, prev_obj_val: 79.96483612060547, obj_val: 91.46309661865234, abs dis: 11.498260498046875
[rfa agg] iter: 5, weight: tensor([0.1175, 0.0390, 0.0493, 0.1593, 0.0766, 0.3908, 0.0357, 0.0373, 0.0462,
        0.0484])
[rfa agg] iter:  6, prev_obj_val: 91.46309661865234, obj_val: 91.33467864990234, abs dis: 0.12841796875
[rfa agg] iter: 6, weight: tensor([0.0640, 0.0356, 0.1307, 0.1682, 0.2674, 0.1076, 0.0332, 0.0344, 0.1179,
        0.0410])
[rfa agg] iter:  7, prev_obj_val: 91.33467864990234, obj_val: 94.85762786865234, abs dis: 3.52294921875
[rfa agg] iter: 7, weight: tensor([0.0551, 0.0308, 0.1222, 0.1513, 0.3440, 0.0907, 0.0288, 0.0298, 0.1118,
        0.0354])
[rfa agg] iter:  8, prev_obj_val: 94.85762786865234, obj_val: 94.84587097167969, abs dis: 0.01175689697265625
[rfa agg] iter: 8, weight: tensor([0.0522, 0.0317, 0.2025, 0.1126, 0.2489, 0.0782, 0.0296, 0.0306, 0.1778,
        0.0358])
[rfa agg] iter:  9, prev_obj_val: 94.84587097167969, obj_val: 98.63282775878906, abs dis: 3.786956787109375
[rfa agg] iter: 9, weight: tensor([0.0512, 0.0311, 0.2126, 0.1103, 0.2368, 0.0768, 0.0291, 0.0301, 0.1867,
        0.0352])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.5360448360443 sec.
Server Epoch:23 choose agents : [20, 9, 53, 97, 2, 88, 22, 77, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0605, Accuracy: 225/807 (27.8810%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0362, Accuracy: 335/807 (41.5118%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0305, Accuracy: 413/807 (51.1772%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0284, Accuracy: 445/807 (55.1425%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0281, Accuracy: 443/807 (54.8947%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0256, Accuracy: 453/807 (56.1338%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0255, Accuracy: 462/807 (57.2491%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0243, Accuracy: 492/807 (60.9665%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0237, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0237, Accuracy: 489/807 (60.5948%), train_poison_data_count: 260
Global model norm: 112.05565023683545.
Norm before scaling: 112.04476470087748. Distance: 0.8610020926557534
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2828, Accuracy: 71/10000 (0.7100%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.7983, Accuracy: 9223/9950 (92.6935%)
Scaling by  100
Scaled Norm after poisoning: 140.18517329767795, distance: 86.1002096034034
Total norm for 1 adversaries is: 140.18517329767795. distance: 86.1002096034034
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 356/1275 (27.9216%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 656/1275 (51.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.2228, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 271/813 (33.3333%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0196, Accuracy: 408/813 (50.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5057, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 360/1213 (29.6785%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7990, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8168, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   1, Avg loss: 0.0756, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.9772, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 514/1470 (34.9660%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0233, Accuracy: 867/1470 (58.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9513, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 539/1340 (40.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6645, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0757, Accuracy: 110/781 (14.0845%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0375, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5174, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 370/1628 (22.7273%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 762/1628 (46.8059%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.0586, Accuracy: 105/10000 (1.0500%)
time spent on training: 253.40829944610596
[rfa agg] training data poison_ratio: 0.07660180351210251  data num: [807, 1275, 813, 1213, 605, 603, 1470, 1340, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.023938063597532033
[rfa agg] init. name: [20, 9, 53, 97, 2, 88, 22, 77, 3, 5], weight: tensor([0.0766, 0.1210, 0.0772, 0.1151, 0.0574, 0.0572, 0.1395, 0.1272, 0.0741,
        0.1545])
[rfa agg] iter:  0, prev_obj_val: 8214.28125, obj_val: 4774.974609375, abs dis: 3439.306640625
[rfa agg] iter: 0, weight: tensor([0.0068, 0.1304, 0.0820, 0.1238, 0.0607, 0.0605, 0.1513, 0.1373, 0.0788,
        0.1685])
[rfa agg] iter:  1, prev_obj_val: 4774.974609375, obj_val: 4491.43505859375, abs dis: 283.53955078125
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1320, 0.0719, 0.1226, 0.0504, 0.0502, 0.1641, 0.1421, 0.0691,
        0.1971])
[rfa agg] iter:  2, prev_obj_val: 4491.43505859375, obj_val: 4496.8125, abs dis: 5.37744140625
[rfa agg] iter: 2, weight: tensor([2.8698e-05, 2.7612e-01, 2.4874e-02, 1.5722e-01, 1.3261e-02, 1.3218e-02,
        1.2745e-01, 2.9637e-01, 2.3833e-02, 6.7613e-02])
[rfa agg] iter:  3, prev_obj_val: 4496.8125, obj_val: 4500.7236328125, abs dis: 3.9111328125
[rfa agg] iter: 3, weight: tensor([4.3161e-05, 2.0657e-01, 5.5683e-02, 3.1176e-01, 2.6132e-02, 2.6053e-02,
        1.0022e-01, 1.5026e-01, 5.3051e-02, 7.0234e-02])
[rfa agg] iter:  4, prev_obj_val: 4500.7236328125, obj_val: 4502.76171875, abs dis: 2.0380859375
[rfa agg] iter: 4, weight: tensor([5.4231e-05, 1.7916e-01, 8.6960e-02, 2.4984e-01, 3.7500e-02, 3.7366e-02,
        1.0559e-01, 1.4241e-01, 8.2549e-02, 7.8569e-02])
[rfa agg] iter:  5, prev_obj_val: 4502.76171875, obj_val: 4506.90869140625, abs dis: 4.14697265625
[rfa agg] iter: 5, weight: tensor([5.8259e-05, 1.6635e-01, 1.0640e-01, 2.1790e-01, 4.3368e-02, 4.3215e-02,
        1.0498e-01, 1.3688e-01, 1.0081e-01, 8.0043e-02])
[rfa agg] iter:  6, prev_obj_val: 4506.90869140625, obj_val: 4509.00048828125, abs dis: 2.091796875
[rfa agg] iter: 6, weight: tensor([6.1248e-05, 1.3749e-01, 1.5351e-01, 1.6691e-01, 5.3749e-02, 5.3558e-02,
        9.5945e-02, 1.1860e-01, 1.4395e-01, 7.6229e-02])
			Update norm = 142.2986653354486 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.7514228820801 sec.
Server Epoch:24 choose agents : [63, 83, 86, 84, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0555, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.3665, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 432/1953 (22.1198%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 800/1953 (40.9626%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8064, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 347/1003 (34.5962%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1822, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 324/1013 (31.9842%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4784, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 366/1163 (31.4703%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0376, Accuracy: 415/1163 (35.6836%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7095, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0754, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5466, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 424/712 (59.5506%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4189, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0608, Accuracy: 223/1049 (21.2583%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 522/1049 (49.7617%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3388, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 151/818 (18.4597%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.0833, Accuracy: 57/10000 (0.5700%)
time spent on training: 236.099956035614
[rfa agg] training data poison_ratio: 0.0  data num: [888, 1953, 1003, 1190, 1013, 1163, 781, 712, 1049, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 83, 86, 84, 14, 68, 3, 11, 51, 71], weight: tensor([0.0840, 0.1848, 0.0949, 0.1126, 0.0958, 0.1100, 0.0739, 0.0674, 0.0992,
        0.0774])
[rfa agg] iter:  0, prev_obj_val: 41.568729400634766, obj_val: 46.25890350341797, abs dis: 4.690174102783203
[rfa agg] iter: 0, weight: tensor([0.0630, 0.0304, 0.1634, 0.1189, 0.1683, 0.1158, 0.0419, 0.0307, 0.2238,
        0.0438])
[rfa agg] iter:  1, prev_obj_val: 46.25890350341797, obj_val: 50.55046081542969, abs dis: 4.291557312011719
[rfa agg] iter: 1, weight: tensor([0.2342, 0.0265, 0.1316, 0.0581, 0.1318, 0.0569, 0.1040, 0.0608, 0.0887,
        0.1074])
[rfa agg] iter:  2, prev_obj_val: 50.55046081542969, obj_val: 60.635379791259766, abs dis: 10.084918975830078
[rfa agg] iter: 2, weight: tensor([0.2376, 0.0221, 0.0752, 0.0423, 0.0761, 0.0413, 0.1811, 0.0846, 0.0570,
        0.1826])
[rfa agg] iter:  3, prev_obj_val: 60.635379791259766, obj_val: 60.59480667114258, abs dis: 0.0405731201171875
[rfa agg] iter: 3, weight: tensor([0.1095, 0.0262, 0.0625, 0.0431, 0.0632, 0.0421, 0.1684, 0.2589, 0.0525,
        0.1738])
[rfa agg] iter:  4, prev_obj_val: 60.59480667114258, obj_val: 64.7456283569336, abs dis: 4.150821685791016
[rfa agg] iter: 4, weight: tensor([0.1028, 0.0249, 0.0593, 0.0409, 0.0600, 0.0399, 0.1595, 0.2993, 0.0498,
        0.1637])
[rfa agg] iter:  5, prev_obj_val: 64.7456283569336, obj_val: 69.0678939819336, abs dis: 4.322265625
[rfa agg] iter: 5, weight: tensor([0.1039, 0.0302, 0.0658, 0.0475, 0.0666, 0.0464, 0.1441, 0.2901, 0.0565,
        0.1491])
[rfa agg] iter:  6, prev_obj_val: 69.0678939819336, obj_val: 53.397518157958984, abs dis: 15.67037582397461
[rfa agg] iter: 6, weight: tensor([0.1103, 0.0371, 0.0751, 0.0562, 0.0759, 0.0549, 0.1411, 0.2372, 0.0655,
        0.1467])
[rfa agg] iter:  7, prev_obj_val: 53.397518157958984, obj_val: 56.77799987792969, abs dis: 3.380481719970703
[rfa agg] iter: 7, weight: tensor([0.1477, 0.0211, 0.0625, 0.0383, 0.0633, 0.0374, 0.2325, 0.1196, 0.0496,
        0.2280])
[rfa agg] iter:  8, prev_obj_val: 56.77799987792969, obj_val: 64.7585220336914, abs dis: 7.980522155761719
[rfa agg] iter: 8, weight: tensor([0.1178, 0.0226, 0.0596, 0.0389, 0.0603, 0.0380, 0.2161, 0.1801, 0.0488,
        0.2177])
[rfa agg] iter:  9, prev_obj_val: 64.7585220336914, obj_val: 64.74510192871094, abs dis: 0.01342010498046875
[rfa agg] iter: 9, weight: tensor([0.1063, 0.0308, 0.0674, 0.0486, 0.0681, 0.0474, 0.1490, 0.2700, 0.0578,
        0.1546])
			Update norm = 112.93698118309166 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.90522742271423 sec.
Server Epoch:25 choose agents : [74, 15, 70, 45, 27, 54, 89, 16, 97, 32].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0479, Accuracy: 414/1552 (26.6753%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 774/1552 (49.8711%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0185, Accuracy: 880/1552 (56.7010%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0176, Accuracy: 927/1552 (59.7294%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0172, Accuracy: 948/1552 (61.0825%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0166, Accuracy: 951/1552 (61.2758%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0162, Accuracy: 988/1552 (63.6598%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0169, Accuracy: 971/1552 (62.5644%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0162, Accuracy: 996/1552 (64.1753%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0163, Accuracy: 992/1552 (63.9175%), train_poison_data_count: 496
Global model norm: 112.05565023683545.
Norm before scaling: 112.03229602022132. Distance: 1.2709536990504433
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.7299, Accuracy: 89/10000 (0.8900%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.3590, Accuracy: 9182/9950 (92.2814%)
Scaling by  100
Scaled Norm after poisoning: 167.40653875745116, distance: 127.09537127070168
Total norm for 1 adversaries is: 167.40653875745116. distance: 127.09537127070168
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 428/1154 (37.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 340/1418 (23.9774%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6664, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0683, Accuracy: 191/669 (28.5501%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0415, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 457/1587 (28.7965%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 640/1587 (40.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1206, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 489/1130 (43.2743%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.4950, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2157, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0638, Accuracy: 273/708 (38.5593%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0367, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.9397, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 349/1213 (28.7716%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 476/1213 (39.2415%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7093, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0609, Accuracy: 190/735 (25.8503%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9684, Accuracy: 52/10000 (0.5200%)
time spent on training: 313.6692566871643
[rfa agg] training data poison_ratio: 0.1403001265593925  data num: [1552, 1154, 1418, 669, 1587, 1130, 896, 708, 1213, 735]
[rfa agg] considering poison per batch poison_fraction: 0.04384378954981016
[rfa agg] init. name: [74, 15, 70, 45, 27, 54, 89, 16, 97, 32], weight: tensor([0.1403, 0.1043, 0.1282, 0.0605, 0.1435, 0.1022, 0.0810, 0.0640, 0.1097,
        0.0664])
[rfa agg] iter:  0, prev_obj_val: 26941.97265625, obj_val: 17744.119140625, abs dis: 9197.853515625
[rfa agg] iter: 0, weight: tensor([0.0259, 0.1182, 0.1456, 0.0682, 0.1632, 0.1157, 0.0915, 0.0723, 0.1243,
        0.0750])
[rfa agg] iter:  1, prev_obj_val: 17744.119140625, obj_val: 16005.0830078125, abs dis: 1739.0361328125
[rfa agg] iter: 1, weight: tensor([0.0043, 0.1210, 0.1506, 0.0685, 0.1696, 0.1181, 0.0925, 0.0727, 0.1272,
        0.0754])
[rfa agg] iter:  2, prev_obj_val: 16005.0830078125, obj_val: 15720.876953125, abs dis: 284.2060546875
[rfa agg] iter: 2, weight: tensor([0.0007, 0.1217, 0.1625, 0.0608, 0.1901, 0.1168, 0.0859, 0.0655, 0.1279,
        0.0680])
[rfa agg] iter:  3, prev_obj_val: 15720.876953125, obj_val: 15710.486328125, abs dis: 10.390625
[rfa agg] iter: 3, weight: tensor([3.8724e-05, 6.4493e-02, 2.4737e-01, 1.5398e-02, 4.8895e-01, 5.3641e-02,
        2.6462e-02, 1.7590e-02, 6.7790e-02, 1.8269e-02])
[rfa agg] iter:  4, prev_obj_val: 15710.486328125, obj_val: 15714.79296875, abs dis: 4.306640625
[rfa agg] iter: 4, weight: tensor([3.7337e-05, 2.3823e-01, 1.3553e-01, 2.2213e-02, 9.4761e-02, 1.5144e-01,
        4.4203e-02, 2.6388e-02, 2.5979e-01, 2.7403e-02])
[rfa agg] iter:  5, prev_obj_val: 15714.79296875, obj_val: 15716.6865234375, abs dis: 1.8935546875
[rfa agg] iter: 5, weight: tensor([4.0497e-05, 1.7574e-01, 7.6019e-02, 3.5986e-02, 6.4205e-02, 2.7649e-01,
        9.2302e-02, 4.5410e-02, 1.8651e-01, 4.7303e-02])
[rfa agg] iter:  6, prev_obj_val: 15716.6865234375, obj_val: 15718.671875, abs dis: 1.9853515625
[rfa agg] iter: 6, weight: tensor([4.5181e-05, 1.5946e-01, 7.8341e-02, 4.3744e-02, 6.7467e-02, 2.4611e-01,
        1.2186e-01, 5.6134e-02, 1.6826e-01, 5.8576e-02])
[rfa agg] iter:  7, prev_obj_val: 15718.671875, obj_val: 15720.69921875, abs dis: 2.02734375
[rfa agg] iter: 7, weight: tensor([4.8541e-05, 1.4480e-01, 7.8315e-02, 5.1619e-02, 6.8517e-02, 2.0647e-01,
        1.5936e-01, 6.7579e-02, 1.5269e-01, 7.0600e-02])
[rfa agg] iter:  8, prev_obj_val: 15720.69921875, obj_val: 15722.7607421875, abs dis: 2.0615234375
[rfa agg] iter: 8, weight: tensor([4.9503e-05, 1.2769e-01, 7.4659e-02, 5.8380e-02, 6.6243e-02, 1.7169e-01,
        2.0641e-01, 7.8321e-02, 1.3460e-01, 8.1953e-02])
[rfa agg] iter:  9, prev_obj_val: 15722.7607421875, obj_val: 15718.6875, abs dis: 4.0732421875
[rfa agg] iter: 9, weight: tensor([4.7712e-05, 1.0828e-01, 6.7539e-02, 6.3127e-02, 6.0686e-02, 1.3946e-01,
        2.6790e-01, 8.7285e-02, 1.1410e-01, 9.1567e-02])
			Update norm = 150.75233854944008 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 431.2107877731323 sec.
Server Epoch:26 choose agents : [16, 3, 83, 49, 82, 57, 75, 76, 46, 55].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0599, Accuracy: 269/708 (37.9944%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0401, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8511, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0376, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6650, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 407/1953 (20.8397%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 761/1953 (38.9657%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9213, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4998, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6234, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0565, Accuracy: 293/1154 (25.3899%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0270, Accuracy: 431/1154 (37.3484%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.6142, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0624, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6484, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 425/1904 (22.3214%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 672/1904 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8193, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 507/1071 (47.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5795, Accuracy: 72/10000 (0.7200%)
time spent on training: 179.53032112121582
[rfa agg] training data poison_ratio: 0.0  data num: [708, 781, 1953, 440, 500, 1154, 776, 466, 1904, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 3, 83, 49, 82, 57, 75, 76, 46, 55], weight: tensor([0.0726, 0.0801, 0.2002, 0.0451, 0.0513, 0.1183, 0.0796, 0.0478, 0.1952,
        0.1098])
[rfa agg] iter:  0, prev_obj_val: 71.84823608398438, obj_val: 74.91688537597656, abs dis: 3.0686492919921875
[rfa agg] iter: 0, weight: tensor([0.0490, 0.0658, 0.0555, 0.0160, 0.0201, 0.2496, 0.0653, 0.0188, 0.0584,
        0.4016])
[rfa agg] iter:  1, prev_obj_val: 74.91688537597656, obj_val: 77.11550903320312, abs dis: 2.1986236572265625
[rfa agg] iter: 1, weight: tensor([0.0895, 0.1346, 0.0572, 0.0234, 0.0301, 0.1455, 0.1338, 0.0280, 0.0596,
        0.2983])
[rfa agg] iter:  2, prev_obj_val: 77.11550903320312, obj_val: 78.25480651855469, abs dis: 1.1392974853515625
[rfa agg] iter: 2, weight: tensor([0.1173, 0.2027, 0.0511, 0.0251, 0.0329, 0.1084, 0.2010, 0.0307, 0.0530,
        0.1778])
[rfa agg] iter:  3, prev_obj_val: 78.25480651855469, obj_val: 81.08391571044922, abs dis: 2.8291091918945312
[rfa agg] iter: 3, weight: tensor([0.1250, 0.2483, 0.0428, 0.0232, 0.0308, 0.0846, 0.2440, 0.0287, 0.0444,
        0.1281])
[rfa agg] iter:  4, prev_obj_val: 81.08391571044922, obj_val: 85.83238983154297, abs dis: 4.74847412109375
[rfa agg] iter: 4, weight: tensor([0.1398, 0.3287, 0.0258, 0.0173, 0.0235, 0.0452, 0.3089, 0.0219, 0.0267,
        0.0622])
[rfa agg] iter:  5, prev_obj_val: 85.83238983154297, obj_val: 91.76907348632812, abs dis: 5.936683654785156
[rfa agg] iter: 5, weight: tensor([0.3147, 0.2099, 0.0308, 0.0260, 0.0367, 0.0490, 0.2040, 0.0342, 0.0317,
        0.0631])
[rfa agg] iter:  6, prev_obj_val: 91.76907348632812, obj_val: 85.78838348388672, abs dis: 5.980690002441406
[rfa agg] iter: 6, weight: tensor([0.2721, 0.1627, 0.0423, 0.0464, 0.0698, 0.0620, 0.1600, 0.0650, 0.0434,
        0.0763])
[rfa agg] iter:  7, prev_obj_val: 85.78838348388672, obj_val: 94.91531372070312, abs dis: 9.126930236816406
[rfa agg] iter: 7, weight: tensor([0.3717, 0.1895, 0.0291, 0.0246, 0.0349, 0.0463, 0.1819, 0.0325, 0.0300,
        0.0597])
[rfa agg] iter:  8, prev_obj_val: 94.91531372070312, obj_val: 94.89447784423828, abs dis: 0.02083587646484375
[rfa agg] iter: 8, weight: tensor([0.2213, 0.1495, 0.0468, 0.0597, 0.0936, 0.0663, 0.1475, 0.0871, 0.0480,
        0.0801])
			Update norm = 104.29658356700855 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.0520348548889 sec.
Server Epoch:27 choose agents : [95, 43, 81, 8, 51, 86, 26, 14, 98, 20].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0662, Accuracy: 179/599 (29.8831%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0248, Accuracy: 354/599 (59.0985%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0237, Accuracy: 379/599 (63.2721%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0247, Accuracy: 429/599 (71.6194%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0240, Accuracy: 443/599 (73.9566%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0216, Accuracy: 460/599 (76.7947%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0203, Accuracy: 473/599 (78.9649%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0205, Accuracy: 482/599 (80.4674%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0183, Accuracy: 483/599 (80.6344%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0204, Accuracy: 487/599 (81.3022%), train_poison_data_count: 200
Global model norm: 112.05565023683545.
Norm before scaling: 112.04816382085428. Distance: 0.8078063964613169
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.4497, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.5784, Accuracy: 7343/9950 (73.7990%)
Scaling by  100
Scaled Norm after poisoning: 137.29163189175077, distance: 80.78064252672945
Total norm for 2 adversaries is: 137.29163189175077. distance: 80.78064252672945
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0625, Accuracy: 300/946 (31.7125%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 364/946 (38.4778%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.9727, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   1, Avg loss: 0.0696, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 276/774 (35.6589%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.2691, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 257/1513 (16.9861%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 462/1513 (30.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3299, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0613, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 510/1049 (48.6177%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4037, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   1, Avg loss: 0.0639, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   2, Avg loss: 0.0356, Accuracy: 358/1003 (35.6929%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.7701, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 502/1446 (34.7165%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.2168, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 358/1013 (35.3406%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.6315, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0487, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4455, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   2, Avg loss: 0.0329, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.6616, Accuracy: 50/10000 (0.5000%)
time spent on training: 277.21978306770325
[rfa agg] training data poison_ratio: 0.1476425496167174  data num: [599, 946, 774, 1513, 1049, 1003, 1446, 1013, 373, 807]
[rfa agg] considering poison per batch poison_fraction: 0.04613829675522419
[rfa agg] init. name: [95, 43, 81, 8, 51, 86, 26, 14, 98, 20], weight: tensor([0.0629, 0.0993, 0.0813, 0.1589, 0.1102, 0.1053, 0.1518, 0.1064, 0.0392,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 5267.85009765625, obj_val: 2978.291748046875, abs dis: 2289.558349609375
[rfa agg] iter: 0, weight: tensor([0.0044, 0.1047, 0.0851, 0.1723, 0.1168, 0.1113, 0.1641, 0.1124, 0.0401,
        0.0887])
[rfa agg] iter:  1, prev_obj_val: 2978.291748046875, obj_val: 2855.465087890625, abs dis: 122.82666015625
[rfa agg] iter: 1, weight: tensor([0.0003, 0.0889, 0.0668, 0.2344, 0.1079, 0.0985, 0.2091, 0.0996, 0.0250,
        0.0696])
[rfa agg] iter:  2, prev_obj_val: 2855.465087890625, obj_val: 2857.813720703125, abs dis: 2.3486328125
[rfa agg] iter: 2, weight: tensor([3.6423e-05, 1.0932e-01, 5.1620e-02, 7.0134e-02, 2.6998e-01, 1.7679e-01,
        7.9000e-02, 1.7986e-01, 9.8039e-03, 5.3463e-02])
[rfa agg] iter:  3, prev_obj_val: 2857.813720703125, obj_val: 2868.271484375, abs dis: 10.457763671875
[rfa agg] iter: 3, weight: tensor([2.7314e-05, 2.6545e-01, 8.3253e-02, 3.8088e-02, 1.1100e-01, 1.8672e-01,
        4.0967e-02, 1.8181e-01, 9.3720e-03, 8.3313e-02])
[rfa agg] iter:  4, prev_obj_val: 2868.271484375, obj_val: 2875.57421875, abs dis: 7.302734375
[rfa agg] iter: 4, weight: tensor([3.2128e-05, 1.2125e-01, 3.0386e-01, 3.6785e-02, 6.8465e-02, 8.7469e-02,
        3.8675e-02, 8.8292e-02, 1.4086e-02, 2.4108e-01])
[rfa agg] iter:  5, prev_obj_val: 2875.57421875, obj_val: 2871.693359375, abs dis: 3.880859375
[rfa agg] iter: 5, weight: tensor([4.4948e-05, 1.1511e-01, 2.5742e-01, 4.7233e-02, 7.7364e-02, 9.2524e-02,
        4.9246e-02, 9.3444e-02, 2.2894e-02, 2.4472e-01])
[rfa agg] iter:  6, prev_obj_val: 2871.693359375, obj_val: 2875.574462890625, abs dis: 3.881103515625
[rfa agg] iter: 6, weight: tensor([3.4950e-05, 1.0597e-01, 3.0084e-01, 3.8306e-02, 6.6540e-02, 8.1760e-02,
        4.0097e-02, 8.2551e-02, 1.6483e-02, 2.6742e-01])
[rfa agg] iter:  7, prev_obj_val: 2875.574462890625, obj_val: 2871.693359375, abs dis: 3.881103515625
[rfa agg] iter: 7, weight: tensor([4.4868e-05, 1.1475e-01, 2.5602e-01, 4.7148e-02, 7.7208e-02, 9.2318e-02,
        4.9157e-02, 9.3226e-02, 2.2854e-02, 2.4727e-01])
[rfa agg] iter:  8, prev_obj_val: 2871.693359375, obj_val: 2875.573974609375, abs dis: 3.880615234375
[rfa agg] iter: 8, weight: tensor([3.4945e-05, 1.0594e-01, 3.0034e-01, 3.8300e-02, 6.6528e-02, 8.1745e-02,
        4.0091e-02, 8.2535e-02, 1.6481e-02, 2.6800e-01])
[rfa agg] iter:  9, prev_obj_val: 2875.573974609375, obj_val: 2871.693359375, abs dis: 3.880615234375
[rfa agg] iter: 9, weight: tensor([4.4867e-05, 1.1475e-01, 2.5596e-01, 4.7147e-02, 7.7206e-02, 9.2317e-02,
        4.9157e-02, 9.3224e-02, 2.2854e-02, 2.4734e-01])
			Update norm = 121.19819689123885 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.8989815711975 sec.
Server Epoch:28 choose agents : [43, 16, 55, 21, 94, 68, 49, 93, 87, 78].
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.9894, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   1, Avg loss: 0.0706, Accuracy: 273/708 (38.5593%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   2, Avg loss: 0.0327, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.8157, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 234/1071 (21.8487%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8389, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 394/1949 (20.2155%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 621/1949 (31.8625%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.9885, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 333/1662 (20.0361%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8825, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 452/1163 (38.8650%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.7084, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 23/440 (5.2273%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5227, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 416/1742 (23.8806%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8506, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 294/1131 (25.9947%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 417/1131 (36.8700%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4545, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 42/416 (10.0962%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 177/416 (42.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5528, Accuracy: 50/10000 (0.5000%)
time spent on training: 190.5783760547638
[rfa agg] training data poison_ratio: 0.0  data num: [946, 708, 1071, 1949, 1662, 1163, 440, 1742, 1131, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 16, 55, 21, 94, 68, 49, 93, 87, 78], weight: tensor([0.0843, 0.0631, 0.0954, 0.1736, 0.1480, 0.1036, 0.0392, 0.1551, 0.1007,
        0.0371])
[rfa agg] iter:  0, prev_obj_val: 60.36820983886719, obj_val: 66.46363067626953, abs dis: 6.095420837402344
[rfa agg] iter: 0, weight: tensor([0.0677, 0.0279, 0.1597, 0.0400, 0.0566, 0.2881, 0.0098, 0.0471, 0.2937,
        0.0093])
[rfa agg] iter:  1, prev_obj_val: 66.46363067626953, obj_val: 68.73054504394531, abs dis: 2.2669143676757812
[rfa agg] iter: 1, weight: tensor([0.1590, 0.0447, 0.3105, 0.0388, 0.0503, 0.1292, 0.0133, 0.0438, 0.1979,
        0.0126])
[rfa agg] iter:  2, prev_obj_val: 68.73054504394531, obj_val: 71.20108795166016, abs dis: 2.4705429077148438
[rfa agg] iter: 2, weight: tensor([0.2299, 0.0536, 0.2732, 0.0401, 0.0511, 0.1149, 0.0150, 0.0448, 0.1631,
        0.0142])
[rfa agg] iter:  3, prev_obj_val: 71.20108795166016, obj_val: 73.82411193847656, abs dis: 2.6230239868164062
[rfa agg] iter: 3, weight: tensor([0.3385, 0.0617, 0.2011, 0.0392, 0.0493, 0.1007, 0.0161, 0.0435, 0.1348,
        0.0152])
[rfa agg] iter:  4, prev_obj_val: 73.82411193847656, obj_val: 73.79788208007812, abs dis: 0.0262298583984375
[rfa agg] iter: 4, weight: tensor([0.4536, 0.0662, 0.1440, 0.0352, 0.0436, 0.0823, 0.0158, 0.0388, 0.1056,
        0.0149])
[rfa agg] iter:  5, prev_obj_val: 73.79788208007812, obj_val: 76.75843048095703, abs dis: 2.9605484008789062
[rfa agg] iter: 5, weight: tensor([0.5060, 0.0601, 0.1288, 0.0320, 0.0396, 0.0747, 0.0144, 0.0353, 0.0956,
        0.0136])
[rfa agg] iter:  6, prev_obj_val: 76.75843048095703, obj_val: 71.18803405761719, abs dis: 5.570396423339844
[rfa agg] iter: 6, weight: tensor([0.4482, 0.0852, 0.1274, 0.0374, 0.0456, 0.0802, 0.0184, 0.0409, 0.0994,
        0.0174])
[rfa agg] iter:  7, prev_obj_val: 71.18803405761719, obj_val: 71.17908477783203, abs dis: 0.00894927978515625
[rfa agg] iter: 7, weight: tensor([0.3935, 0.0576, 0.1782, 0.0366, 0.0459, 0.0937, 0.0150, 0.0406, 0.1248,
        0.0142])
[rfa agg] iter:  8, prev_obj_val: 71.17908477783203, obj_val: 71.17871856689453, abs dis: 0.0003662109375
[rfa agg] iter: 8, weight: tensor([0.3777, 0.0587, 0.1849, 0.0373, 0.0469, 0.0957, 0.0153, 0.0414, 0.1278,
        0.0144])
			Update norm = 146.63649518025858 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.1617691516876 sec.
Server Epoch:29 choose agents : [7, 85, 95, 12, 59, 54, 89, 98, 63, 66].
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.0510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 450/1988 (22.6358%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 660/1988 (33.1992%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7246, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0533, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0880, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4577, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0535, Accuracy: 300/1089 (27.5482%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 501/1089 (46.0055%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1189, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 491/1130 (43.4513%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4740, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 325/896 (36.2723%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 430/896 (47.9911%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2372, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0829, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0495, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4382, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0552, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 424/888 (47.7477%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0868, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 428/1402 (30.5278%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.2222, Accuracy: 75/10000 (0.7500%)
time spent on training: 161.83839583396912
[rfa agg] training data poison_ratio: 0.06243485511778195  data num: [891, 1988, 599, 338, 1089, 1130, 896, 373, 888, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.01951089222430686
[rfa agg] init. name: [7, 85, 95, 12, 59, 54, 89, 98, 63, 66], weight: tensor([0.0929, 0.2072, 0.0624, 0.0352, 0.1135, 0.1178, 0.0934, 0.0389, 0.0926,
        0.1461])
[rfa agg] iter:  0, prev_obj_val: 56.442413330078125, obj_val: 60.56773376464844, abs dis: 4.1253204345703125
[rfa agg] iter: 0, weight: tensor([0.0938, 0.0435, 0.0280, 0.0100, 0.2429, 0.2911, 0.0941, 0.0111, 0.0947,
        0.0907])
[rfa agg] iter:  1, prev_obj_val: 60.56773376464844, obj_val: 67.18606567382812, abs dis: 6.6183319091796875
[rfa agg] iter: 1, weight: tensor([0.2277, 0.0292, 0.0338, 0.0101, 0.0774, 0.0816, 0.2197, 0.0111, 0.2615,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 67.18606567382812, obj_val: 64.28994750976562, abs dis: 2.8961181640625
[rfa agg] iter: 2, weight: tensor([0.2265, 0.0327, 0.0607, 0.0148, 0.0665, 0.0697, 0.2248, 0.0164, 0.2394,
        0.0484])
[rfa agg] iter:  3, prev_obj_val: 64.28994750976562, obj_val: 70.27296447753906, abs dis: 5.9830169677734375
[rfa agg] iter: 3, weight: tensor([0.2440, 0.0257, 0.0402, 0.0106, 0.0562, 0.0591, 0.2415, 0.0117, 0.2717,
        0.0392])
[rfa agg] iter:  4, prev_obj_val: 70.27296447753906, obj_val: 73.42242431640625, abs dis: 3.1494598388671875
[rfa agg] iter: 4, weight: tensor([0.2060, 0.0390, 0.0882, 0.0195, 0.0743, 0.0778, 0.2063, 0.0216, 0.2111,
        0.0562])
[rfa agg] iter:  5, prev_obj_val: 73.42242431640625, obj_val: 70.26676940917969, abs dis: 3.1556549072265625
[rfa agg] iter: 5, weight: tensor([0.1846, 0.0438, 0.1253, 0.0243, 0.0787, 0.0823, 0.1852, 0.0268, 0.1874,
        0.0616])
[rfa agg] iter:  6, prev_obj_val: 70.26676940917969, obj_val: 73.42225646972656, abs dis: 3.155487060546875
[rfa agg] iter: 6, weight: tensor([0.2046, 0.0392, 0.0895, 0.0196, 0.0747, 0.0783, 0.2050, 0.0217, 0.2109,
        0.0565])
[rfa agg] iter:  7, prev_obj_val: 73.42225646972656, obj_val: 70.26677703857422, abs dis: 3.1554794311523438
[rfa agg] iter: 7, weight: tensor([0.1846, 0.0438, 0.1253, 0.0243, 0.0787, 0.0823, 0.1852, 0.0268, 0.1874,
        0.0616])
[rfa agg] iter:  8, prev_obj_val: 70.26677703857422, obj_val: 73.42224884033203, abs dis: 3.1554718017578125
[rfa agg] iter: 8, weight: tensor([0.2046, 0.0392, 0.0895, 0.0196, 0.0747, 0.0783, 0.2050, 0.0217, 0.2109,
        0.0565])
[rfa agg] iter:  9, prev_obj_val: 73.42224884033203, obj_val: 70.26677703857422, abs dis: 3.1554718017578125
[rfa agg] iter: 9, weight: tensor([0.1846, 0.0438, 0.1253, 0.0243, 0.0787, 0.0823, 0.1852, 0.0268, 0.1874,
        0.0616])
			Update norm = 121.10254806748493 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.5891122817993 sec.
Server Epoch:30 choose agents : [61, 58, 70, 49, 93, 67, 44, 24, 1, 14].
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1193, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3069, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 404/803 (50.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.9598, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 325/1418 (22.9196%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 597/1418 (42.1016%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6574, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5291, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 672/1742 (38.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7720, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 43/426 (10.0939%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0423, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 392/1750 (22.4000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 664/1750 (37.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6062, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.4082, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0577, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 536/928 (57.7586%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4915, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 295/1013 (29.1214%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.5132, Accuracy: 67/10000 (0.6700%)
time spent on training: 152.61648869514465
[rfa agg] training data poison_ratio: 0.0  data num: [85, 803, 1418, 440, 1742, 426, 1750, 312, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 58, 70, 49, 93, 67, 44, 24, 1, 14], weight: tensor([0.0095, 0.0901, 0.1590, 0.0493, 0.1954, 0.0478, 0.1963, 0.0350, 0.1041,
        0.1136])
[rfa agg] iter:  0, prev_obj_val: 67.2344741821289, obj_val: 68.29314422607422, abs dis: 1.0586700439453125
[rfa agg] iter: 0, weight: tensor([0.0029, 0.0968, 0.1393, 0.0229, 0.0907, 0.0222, 0.0910, 0.0136, 0.1901,
        0.3306])
[rfa agg] iter:  1, prev_obj_val: 68.29314422607422, obj_val: 70.42777252197266, abs dis: 2.1346282958984375
[rfa agg] iter: 1, weight: tensor([0.0021, 0.0815, 0.0783, 0.0167, 0.0548, 0.0162, 0.0549, 0.0097, 0.1952,
        0.4907])
[rfa agg] iter:  2, prev_obj_val: 70.42777252197266, obj_val: 72.14153289794922, abs dis: 1.7137603759765625
[rfa agg] iter: 2, weight: tensor([0.0018, 0.0902, 0.0552, 0.0151, 0.0410, 0.0146, 0.0411, 0.0087, 0.2771,
        0.4552])
[rfa agg] iter:  3, prev_obj_val: 72.14153289794922, obj_val: 74.16658020019531, abs dis: 2.0250473022460938
[rfa agg] iter: 3, weight: tensor([0.0021, 0.1204, 0.0569, 0.0177, 0.0433, 0.0171, 0.0434, 0.0100, 0.3920,
        0.2972])
[rfa agg] iter:  4, prev_obj_val: 74.16658020019531, obj_val: 74.1600570678711, abs dis: 0.00652313232421875
[rfa agg] iter: 4, weight: tensor([0.0023, 0.1672, 0.0588, 0.0206, 0.0457, 0.0200, 0.0459, 0.0115, 0.4059,
        0.2220])
[rfa agg] iter:  5, prev_obj_val: 74.1600570678711, obj_val: 76.47008514404297, abs dis: 2.310028076171875
[rfa agg] iter: 5, weight: tensor([0.0023, 0.1685, 0.0586, 0.0206, 0.0456, 0.0199, 0.0458, 0.0115, 0.4087,
        0.2185])
[rfa agg] iter:  6, prev_obj_val: 76.47008514404297, obj_val: 78.86467742919922, abs dis: 2.39459228515625
[rfa agg] iter: 6, weight: tensor([0.0028, 0.2567, 0.0634, 0.0252, 0.0503, 0.0244, 0.0505, 0.0138, 0.3185,
        0.1945])
[rfa agg] iter:  7, prev_obj_val: 78.86467742919922, obj_val: 78.8307876586914, abs dis: 0.0338897705078125
[rfa agg] iter: 7, weight: tensor([0.0029, 0.3899, 0.0599, 0.0270, 0.0484, 0.0261, 0.0486, 0.0146, 0.2244,
        0.1581])
[rfa agg] iter:  8, prev_obj_val: 78.8307876586914, obj_val: 78.82887268066406, abs dis: 0.00191497802734375
[rfa agg] iter: 8, weight: tensor([0.0027, 0.4271, 0.0571, 0.0258, 0.0461, 0.0249, 0.0463, 0.0139, 0.2062,
        0.1500])
[rfa agg] iter:  9, prev_obj_val: 78.82887268066406, obj_val: 78.8287582397461, abs dis: 0.00011444091796875
[rfa agg] iter: 9, weight: tensor([0.0027, 0.4363, 0.0563, 0.0254, 0.0455, 0.0246, 0.0457, 0.0137, 0.2019,
        0.1479])
			Update norm = 129.42931378024454 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.37869691848755 sec.
Server Epoch:31 choose agents : [67, 91, 74, 70, 30, 32, 97, 1, 61, 22].
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 46/426 (10.7981%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5853, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   1, Avg loss: 0.0539, Accuracy: 326/1030 (31.6505%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 573/1030 (55.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4109, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0215, Accuracy: 758/1552 (48.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.4501, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 357/1418 (25.1763%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 613/1418 (43.2299%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8289, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0816, Accuracy: 65/486 (13.3745%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8335, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 337/735 (45.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7068, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 536/1213 (44.1880%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5091, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0246, Accuracy: 536/928 (57.7586%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6116, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3062, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 548/1470 (37.2789%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 847/1470 (57.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0900, Accuracy: 74/10000 (0.7400%)
time spent on training: 175.28181147575378
[rfa agg] training data poison_ratio: 0.16611366798672803  data num: [426, 1030, 1552, 1418, 486, 735, 1213, 928, 85, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.051910521245852506
[rfa agg] init. name: [67, 91, 74, 70, 30, 32, 97, 1, 61, 22], weight: tensor([0.0456, 0.1102, 0.1661, 0.1518, 0.0520, 0.0787, 0.1298, 0.0993, 0.0091,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 52.63557434082031, obj_val: 52.50424575805664, abs dis: 0.13132858276367188
[rfa agg] iter: 0, weight: tensor([0.0184, 0.2144, 0.0600, 0.0693, 0.0238, 0.0762, 0.1248, 0.3391, 0.0023,
        0.0718])
[rfa agg] iter:  1, prev_obj_val: 52.50424575805664, obj_val: 57.117164611816406, abs dis: 4.612918853759766
[rfa agg] iter: 1, weight: tensor([0.0170, 0.2025, 0.0554, 0.0640, 0.0220, 0.0703, 0.1157, 0.3847, 0.0021,
        0.0662])
[rfa agg] iter:  2, prev_obj_val: 57.117164611816406, obj_val: 62.564640045166016, abs dis: 5.447475433349609
[rfa agg] iter: 2, weight: tensor([0.0206, 0.1419, 0.0538, 0.0606, 0.0271, 0.1032, 0.0973, 0.4302, 0.0024,
        0.0628])
[rfa agg] iter:  3, prev_obj_val: 62.564640045166016, obj_val: 59.795780181884766, abs dis: 2.76885986328125
[rfa agg] iter: 3, weight: tensor([0.0305, 0.1338, 0.0634, 0.0700, 0.0411, 0.2081, 0.1031, 0.2742, 0.0034,
        0.0725])
[rfa agg] iter:  4, prev_obj_val: 59.795780181884766, obj_val: 59.79047775268555, abs dis: 0.00530242919921875
[rfa agg] iter: 4, weight: tensor([0.0263, 0.1432, 0.0613, 0.0684, 0.0350, 0.1539, 0.1048, 0.3331, 0.0030,
        0.0709])
[rfa agg] iter:  5, prev_obj_val: 59.79047775268555, obj_val: 57.11833190917969, abs dis: 2.6721458435058594
[rfa agg] iter: 5, weight: tensor([0.0261, 0.1422, 0.0609, 0.0679, 0.0348, 0.1516, 0.1041, 0.3391, 0.0030,
        0.0704])
[rfa agg] iter:  6, prev_obj_val: 57.11833190917969, obj_val: 62.56294250488281, abs dis: 5.444610595703125
[rfa agg] iter: 6, weight: tensor([0.0208, 0.1425, 0.0543, 0.0613, 0.0274, 0.1052, 0.0983, 0.4243, 0.0024,
        0.0634])
[rfa agg] iter:  7, prev_obj_val: 62.56294250488281, obj_val: 59.79582595825195, abs dis: 2.7671165466308594
[rfa agg] iter: 7, weight: tensor([0.0305, 0.1339, 0.0634, 0.0700, 0.0411, 0.2083, 0.1031, 0.2739, 0.0034,
        0.0725])
[rfa agg] iter:  8, prev_obj_val: 59.79582595825195, obj_val: 59.79047775268555, abs dis: 0.00534820556640625
[rfa agg] iter: 8, weight: tensor([0.0263, 0.1432, 0.0613, 0.0684, 0.0350, 0.1539, 0.1049, 0.3330, 0.0030,
        0.0709])
[rfa agg] iter:  9, prev_obj_val: 59.79047775268555, obj_val: 57.11833190917969, abs dis: 2.6721458435058594
[rfa agg] iter: 9, weight: tensor([0.0261, 0.1422, 0.0609, 0.0679, 0.0348, 0.1516, 0.1041, 0.3391, 0.0030,
        0.0704])
			Update norm = 137.84496499691238 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.465012550354 sec.
Server Epoch:32 choose agents : [20, 68, 99, 31, 27, 46, 19, 95, 86, 9].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1254, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0617, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 447/1163 (38.4351%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.6520, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   1, Avg loss: 0.0657, Accuracy: 168/773 (21.7335%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 402/773 (52.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1735, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 50/460 (10.8696%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8014, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 415/1587 (26.1500%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 628/1587 (39.5715%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3111, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 435/1904 (22.8466%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 678/1904 (35.6092%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4735, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 394/1036 (38.0309%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 683/1036 (65.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.9558, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 317/599 (52.9215%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6963, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 395/1003 (39.3819%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.9136, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 701/1275 (54.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.2576, Accuracy: 86/10000 (0.8600%)
time spent on training: 181.74278283119202
[rfa agg] training data poison_ratio: 0.13255397379089282  data num: [807, 1163, 773, 460, 1587, 1904, 1036, 599, 1003, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.041423116809654006
[rfa agg] init. name: [20, 68, 99, 31, 27, 46, 19, 95, 86, 9], weight: tensor([0.0761, 0.1096, 0.0729, 0.0434, 0.1496, 0.1795, 0.0977, 0.0565, 0.0946,
        0.1202])
[rfa agg] iter:  0, prev_obj_val: 51.596012115478516, obj_val: 54.266441345214844, abs dis: 2.670429229736328
[rfa agg] iter: 0, weight: tensor([0.0515, 0.1374, 0.0495, 0.0133, 0.0515, 0.0382, 0.3349, 0.0222, 0.1949,
        0.1066])
[rfa agg] iter:  1, prev_obj_val: 54.266441345214844, obj_val: 58.216087341308594, abs dis: 3.94964599609375
[rfa agg] iter: 1, weight: tensor([0.0696, 0.1002, 0.0673, 0.0154, 0.0474, 0.0367, 0.2384, 0.0267, 0.3140,
        0.0842])
[rfa agg] iter:  2, prev_obj_val: 58.216087341308594, obj_val: 60.40372848510742, abs dis: 2.187641143798828
[rfa agg] iter: 2, weight: tensor([0.1217, 0.0933, 0.1179, 0.0215, 0.0522, 0.0418, 0.1607, 0.0391, 0.2688,
        0.0829])
[rfa agg] iter:  3, prev_obj_val: 60.40372848510742, obj_val: 62.66568374633789, abs dis: 2.2619552612304688
[rfa agg] iter: 3, weight: tensor([0.1637, 0.0878, 0.1593, 0.0243, 0.0523, 0.0426, 0.1374, 0.0455, 0.2076,
        0.0795])
[rfa agg] iter:  4, prev_obj_val: 62.66568374633789, obj_val: 70.79789733886719, abs dis: 8.132213592529297
[rfa agg] iter: 4, weight: tensor([0.2135, 0.0765, 0.2103, 0.0254, 0.0481, 0.0397, 0.1117, 0.0492, 0.1553,
        0.0703])
[rfa agg] iter:  5, prev_obj_val: 70.79789733886719, obj_val: 70.77400207519531, abs dis: 0.023895263671875
[rfa agg] iter: 5, weight: tensor([0.2817, 0.0543, 0.2845, 0.0308, 0.0388, 0.0333, 0.0695, 0.0703, 0.0852,
        0.0517])
[rfa agg] iter:  6, prev_obj_val: 70.77400207519531, obj_val: 77.67491149902344, abs dis: 6.900909423828125
[rfa agg] iter: 6, weight: tensor([0.2899, 0.0525, 0.2910, 0.0298, 0.0375, 0.0322, 0.0671, 0.0682, 0.0819,
        0.0500])
[rfa agg] iter:  7, prev_obj_val: 77.67491149902344, obj_val: 70.79023742675781, abs dis: 6.884674072265625
[rfa agg] iter: 7, weight: tensor([0.2070, 0.0645, 0.2005, 0.0536, 0.0492, 0.0431, 0.0780, 0.1503, 0.0914,
        0.0625])
[rfa agg] iter:  8, prev_obj_val: 70.79023742675781, obj_val: 70.77394104003906, abs dis: 0.01629638671875
[rfa agg] iter: 8, weight: tensor([0.2853, 0.0538, 0.2843, 0.0306, 0.0385, 0.0330, 0.0688, 0.0704, 0.0842,
        0.0513])
[rfa agg] iter:  9, prev_obj_val: 70.77394104003906, obj_val: 77.67494201660156, abs dis: 6.9010009765625
[rfa agg] iter: 9, weight: tensor([0.2906, 0.0525, 0.2906, 0.0298, 0.0375, 0.0322, 0.0670, 0.0681, 0.0818,
        0.0500])
			Update norm = 112.85999260006842 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.2515308856964 sec.
Server Epoch:33 choose agents : [27, 92, 82, 59, 49, 13, 81, 70, 48, 79].
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 454/1587 (28.6074%)
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 622/1587 (39.1934%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.4826, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   1, Avg loss: 0.0531, Accuracy: 413/1715 (24.0816%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 712/1715 (41.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7092, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 70/500 (14.0000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 167/500 (33.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.6167, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 274/1089 (25.1607%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 486/1089 (44.6281%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1021, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.5264, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 341/1645 (20.7295%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 635/1645 (38.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8005, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   1, Avg loss: 0.0687, Accuracy: 235/774 (30.3618%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 288/774 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.3507, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 326/1418 (22.9901%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 585/1418 (41.2553%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5770, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0417, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8929, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1031, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3250, Accuracy: 50/10000 (0.5000%)
time spent on training: 185.8738899230957
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 1715, 500, 1089, 440, 1645, 774, 1418, 631, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 92, 82, 59, 49, 13, 81, 70, 48, 79], weight: tensor([0.1588, 0.1716, 0.0500, 0.1089, 0.0440, 0.1646, 0.0774, 0.1419, 0.0631,
        0.0197])
[rfa agg] iter:  0, prev_obj_val: 62.76597595214844, obj_val: 66.39369201660156, abs dis: 3.627716064453125
[rfa agg] iter: 0, weight: tensor([0.1026, 0.0865, 0.0227, 0.4381, 0.0182, 0.0931, 0.0699, 0.1268, 0.0358,
        0.0063])
[rfa agg] iter:  1, prev_obj_val: 66.39369201660156, obj_val: 66.39274597167969, abs dis: 0.000946044921875
[rfa agg] iter: 1, weight: tensor([0.0955, 0.0828, 0.0268, 0.4303, 0.0212, 0.0881, 0.0918, 0.1129, 0.0434,
        0.0073])
			Update norm = 159.36870698360138 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.3714916706085 sec.
Server Epoch:34 choose agents : [56, 37, 48, 84, 46, 60, 55, 12, 50, 72].
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3153, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 392/1129 (34.7210%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 728/1129 (64.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.5980, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0713, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9947, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   1, Avg loss: 0.0552, Accuracy: 422/1904 (22.1639%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 682/1904 (35.8193%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9797, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 559/2227 (25.1010%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 988/2227 (44.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3750, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 273/1071 (25.4902%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 518/1071 (48.3660%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9375, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4419, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 148/809 (18.2942%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 345/809 (42.6452%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3917, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0627, Accuracy: 251/1241 (20.2256%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0391, Accuracy: 61/10000 (0.6100%)
time spent on training: 162.72888255119324
[rfa agg] training data poison_ratio: 0.0  data num: [186, 1129, 631, 1190, 1904, 2227, 1071, 338, 809, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 37, 48, 84, 46, 60, 55, 12, 50, 72], weight: tensor([0.0173, 0.1053, 0.0588, 0.1109, 0.1775, 0.2076, 0.0999, 0.0315, 0.0754,
        0.1157])
[rfa agg] iter:  0, prev_obj_val: 68.01468658447266, obj_val: 70.15426635742188, abs dis: 2.1395797729492188
[rfa agg] iter: 0, weight: tensor([0.0031, 0.1435, 0.0181, 0.2120, 0.0546, 0.0427, 0.0990, 0.0069, 0.0331,
        0.3870])
[rfa agg] iter:  1, prev_obj_val: 70.15426635742188, obj_val: 73.57703399658203, abs dis: 3.4227676391601562
[rfa agg] iter: 1, weight: tensor([0.0032, 0.2751, 0.0208, 0.2105, 0.0420, 0.0347, 0.2080, 0.0074, 0.0422,
        0.1561])
[rfa agg] iter:  2, prev_obj_val: 73.57703399658203, obj_val: 75.877197265625, abs dis: 2.3001632690429688
[rfa agg] iter: 2, weight: tensor([0.0036, 0.2314, 0.0246, 0.1426, 0.0401, 0.0339, 0.3528, 0.0084, 0.0542,
        0.1085])
[rfa agg] iter:  3, prev_obj_val: 75.877197265625, obj_val: 78.48725128173828, abs dis: 2.6100540161132812
[rfa agg] iter: 3, weight: tensor([0.0041, 0.1916, 0.0290, 0.1285, 0.0423, 0.0362, 0.3882, 0.0096, 0.0675,
        0.1029])
[rfa agg] iter:  4, prev_obj_val: 78.48725128173828, obj_val: 78.48391723632812, abs dis: 0.00333404541015625
[rfa agg] iter: 4, weight: tensor([0.0051, 0.1836, 0.0379, 0.1330, 0.0493, 0.0425, 0.3324, 0.0122, 0.0944,
        0.1097])
			Update norm = 150.87511650782577 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3005, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.3675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.4723320007324 sec.
Server Epoch:35 choose agents : [14, 25, 49, 31, 78, 56, 59, 12, 2, 67].
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5730, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0574, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0285, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.2934, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 24/440 (5.4545%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   2, Avg loss: 0.0398, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7624, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 172/416 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5705, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0837, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0682, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3150, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0540, Accuracy: 297/1089 (27.2727%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 467/1089 (42.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0280, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 13/338 (3.8462%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0483, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8378, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 39/426 (9.1549%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0412, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5740, Accuracy: 56/10000 (0.5600%)
time spent on training: 134.67009210586548
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 690, 440, 460, 416, 186, 1089, 338, 605, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 25, 49, 31, 78, 56, 59, 12, 2, 67], weight: tensor([0.1789, 0.1218, 0.0777, 0.0812, 0.0735, 0.0328, 0.1923, 0.0597, 0.1068,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 38.31694793701172, obj_val: 45.06243896484375, abs dis: 6.745491027832031
[rfa agg] iter: 0, weight: tensor([0.0671, 0.1812, 0.0742, 0.1240, 0.0695, 0.0118, 0.0551, 0.0407, 0.3053,
        0.0710])
[rfa agg] iter:  1, prev_obj_val: 45.06243896484375, obj_val: 51.39146041870117, abs dis: 6.329021453857422
[rfa agg] iter: 1, weight: tensor([0.0338, 0.0515, 0.2409, 0.1232, 0.1858, 0.0124, 0.0296, 0.0794, 0.0600,
        0.1833])
[rfa agg] iter:  2, prev_obj_val: 51.39146041870117, obj_val: 47.73199462890625, abs dis: 3.659465789794922
[rfa agg] iter: 2, weight: tensor([0.0395, 0.0534, 0.1653, 0.0883, 0.1511, 0.0208, 0.0353, 0.2354, 0.0582,
        0.1527])
[rfa agg] iter:  3, prev_obj_val: 47.73199462890625, obj_val: 51.378822326660156, abs dis: 3.6468276977539062
[rfa agg] iter: 3, weight: tensor([0.0315, 0.0449, 0.2209, 0.0875, 0.1882, 0.0141, 0.0279, 0.1462, 0.0502,
        0.1885])
[rfa agg] iter:  4, prev_obj_val: 51.378822326660156, obj_val: 44.623531341552734, abs dis: 6.755290985107422
[rfa agg] iter: 4, weight: tensor([0.0386, 0.0522, 0.1617, 0.0861, 0.1481, 0.0204, 0.0345, 0.2518, 0.0568,
        0.1499])
[rfa agg] iter:  5, prev_obj_val: 44.623531341552734, obj_val: 63.613487243652344, abs dis: 18.98995590209961
[rfa agg] iter: 5, weight: tensor([0.0242, 0.0365, 0.2964, 0.0906, 0.2092, 0.0092, 0.0212, 0.0665, 0.0422,
        0.2040])
[rfa agg] iter:  6, prev_obj_val: 63.613487243652344, obj_val: 55.334232330322266, abs dis: 8.279254913330078
[rfa agg] iter: 6, weight: tensor([0.0668, 0.0803, 0.1335, 0.0995, 0.1255, 0.0605, 0.0611, 0.1615, 0.0830,
        0.1282])
[rfa agg] iter:  7, prev_obj_val: 55.334232330322266, obj_val: 55.32973861694336, abs dis: 0.00449371337890625
[rfa agg] iter: 7, weight: tensor([0.0487, 0.0630, 0.1451, 0.0919, 0.1346, 0.0306, 0.0438, 0.2377, 0.0673,
        0.1373])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.2996, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.3131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.516033411026 sec.
Server Epoch:36 choose agents : [49, 72, 34, 13, 42, 7, 12, 61, 44, 78].
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   1, Avg loss: 0.0787, Accuracy: 39/440 (8.8636%)
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.5683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0619, Accuracy: 244/1241 (19.6616%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 384/1241 (30.9428%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.1683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 402/1427 (28.1710%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 583/1427 (40.8549%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.8593, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 315/1645 (19.1489%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 611/1645 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9492, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 332/1372 (24.1983%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7663, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2060, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4795, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1197, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 396/1750 (22.6286%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 678/1750 (38.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9499, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   1, Avg loss: 0.0820, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6153, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.82249331474304
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1241, 1427, 1645, 1372, 891, 338, 85, 1750, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 72, 34, 13, 42, 7, 12, 61, 44, 78], weight: tensor([0.0458, 0.1292, 0.1486, 0.1713, 0.1428, 0.0928, 0.0352, 0.0088, 0.1822,
        0.0433])
[rfa agg] iter:  0, prev_obj_val: 58.22238540649414, obj_val: 58.14620590209961, abs dis: 0.07617950439453125
[rfa agg] iter: 0, weight: tensor([0.0182, 0.3378, 0.1479, 0.1036, 0.1801, 0.0928, 0.0128, 0.0024, 0.0873,
        0.0172])
[rfa agg] iter:  1, prev_obj_val: 58.14620590209961, obj_val: 55.807796478271484, abs dis: 2.338409423828125
[rfa agg] iter: 1, weight: tensor([0.0178, 0.3519, 0.1447, 0.1012, 0.1769, 0.0906, 0.0125, 0.0024, 0.0852,
        0.0168])
[rfa agg] iter:  2, prev_obj_val: 55.807796478271484, obj_val: 55.80266571044922, abs dis: 0.005130767822265625
[rfa agg] iter: 2, weight: tensor([0.0145, 0.4108, 0.1375, 0.0920, 0.1734, 0.0696, 0.0102, 0.0019, 0.0764,
        0.0137])
[rfa agg] iter:  3, prev_obj_val: 55.80266571044922, obj_val: 55.80260467529297, abs dis: 6.103515625e-05
[rfa agg] iter: 3, weight: tensor([0.0143, 0.4175, 0.1359, 0.0910, 0.1714, 0.0687, 0.0101, 0.0019, 0.0755,
        0.0135])
			Update norm = 175.66457516741957 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.2996, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.3131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.97783184051514 sec.
Server Epoch:37 choose agents : [43, 52, 34, 93, 71, 11, 33, 59, 97, 25].
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 327/946 (34.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.9500, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0320, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2589, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 392/1427 (27.4702%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1427 (43.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.9419, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9908, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 148/818 (18.0929%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 319/818 (38.9976%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.0542, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5574, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0791, Accuracy: 61/515 (11.8447%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 439/1089 (40.3122%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6619, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   1, Avg loss: 0.0530, Accuracy: 363/1213 (29.9258%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 453/1213 (37.3454%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7670, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0568, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.3401, Accuracy: 61/10000 (0.6100%)
time spent on training: 162.15350770950317
[rfa agg] training data poison_ratio: 0.0  data num: [946, 636, 1427, 1742, 818, 712, 515, 1089, 1213, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 52, 34, 93, 71, 11, 33, 59, 97, 25], weight: tensor([0.0966, 0.0650, 0.1458, 0.1780, 0.0836, 0.0727, 0.0526, 0.1113, 0.1239,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 51.66207504272461, obj_val: 57.150272369384766, abs dis: 5.488197326660156
[rfa agg] iter: 0, weight: tensor([0.3697, 0.0407, 0.0577, 0.0435, 0.1236, 0.0751, 0.0277, 0.1104, 0.0963,
        0.0553])
[rfa agg] iter:  1, prev_obj_val: 57.150272369384766, obj_val: 61.24140548706055, abs dis: 4.091133117675781
[rfa agg] iter: 1, weight: tensor([0.1339, 0.0598, 0.0419, 0.0341, 0.3038, 0.1721, 0.0372, 0.0625, 0.0589,
        0.0958])
[rfa agg] iter:  2, prev_obj_val: 61.24140548706055, obj_val: 70.03264617919922, abs dis: 8.791240692138672
[rfa agg] iter: 2, weight: tensor([0.0790, 0.0770, 0.0335, 0.0282, 0.1845, 0.3122, 0.0431, 0.0461, 0.0445,
        0.1518])
[rfa agg] iter:  3, prev_obj_val: 70.03264617919922, obj_val: 73.51087951660156, abs dis: 3.4782333374023438
[rfa agg] iter: 3, weight: tensor([0.0610, 0.2080, 0.0336, 0.0293, 0.0935, 0.1336, 0.0910, 0.0423, 0.0419,
        0.2656])
[rfa agg] iter:  4, prev_obj_val: 73.51087951660156, obj_val: 73.49525451660156, abs dis: 0.015625
[rfa agg] iter: 4, weight: tensor([0.0565, 0.2979, 0.0332, 0.0293, 0.0806, 0.1034, 0.1300, 0.0408, 0.0407,
        0.1876])
[rfa agg] iter:  5, prev_obj_val: 73.49525451660156, obj_val: 73.49409484863281, abs dis: 0.00115966796875
[rfa agg] iter: 5, weight: tensor([0.0545, 0.3266, 0.0320, 0.0283, 0.0777, 0.0993, 0.1270, 0.0393, 0.0392,
        0.1762])
[rfa agg] iter:  6, prev_obj_val: 73.49409484863281, obj_val: 77.30762481689453, abs dis: 3.8135299682617188
[rfa agg] iter: 6, weight: tensor([0.0538, 0.3364, 0.0316, 0.0279, 0.0767, 0.0979, 0.1251, 0.0388, 0.0387,
        0.1730])
[rfa agg] iter:  7, prev_obj_val: 77.30762481689453, obj_val: 77.30030059814453, abs dis: 0.00732421875
[rfa agg] iter: 7, weight: tensor([0.0556, 0.2836, 0.0345, 0.0308, 0.0750, 0.0903, 0.2065, 0.0415, 0.0416,
        0.1406])
[rfa agg] iter:  8, prev_obj_val: 77.30030059814453, obj_val: 77.30008697509766, abs dis: 0.000213623046875
[rfa agg] iter: 8, weight: tensor([0.0555, 0.2722, 0.0345, 0.0307, 0.0749, 0.0902, 0.2188, 0.0414, 0.0416,
        0.1402])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.38378500938416 sec.
Server Epoch:38 choose agents : [79, 26, 47, 1, 85, 4, 39, 42, 59, 73].
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   1, Avg loss: 0.1048, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   2, Avg loss: 0.0835, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3330, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 474/1446 (32.7801%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0622, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   1, Avg loss: 0.1191, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   2, Avg loss: 0.1126, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6287, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 448/1988 (22.5352%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 644/1988 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0175, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 323/901 (35.8491%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 391/901 (43.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8691, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 312/1013 (30.7996%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 486/1013 (47.9763%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6323, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 336/1372 (24.4898%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 519/1372 (37.8280%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9469, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0518, Accuracy: 303/1089 (27.8237%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3322, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0665, Accuracy: 162/938 (17.2708%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 309/938 (32.9424%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3194, Accuracy: 58/10000 (0.5800%)
time spent on training: 192.8778989315033
[rfa agg] training data poison_ratio: 0.0  data num: [197, 1446, 134, 928, 1988, 901, 1013, 1372, 1089, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 26, 47, 1, 85, 4, 39, 42, 59, 73], weight: tensor([0.0197, 0.1445, 0.0134, 0.0927, 0.1987, 0.0900, 0.1012, 0.1371, 0.1088,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 51.4818229675293, obj_val: 56.72940444946289, abs dis: 5.247581481933594
[rfa agg] iter: 0, weight: tensor([0.0043, 0.0868, 0.0027, 0.0899, 0.0434, 0.0888, 0.1452, 0.1026, 0.3439,
        0.0924])
[rfa agg] iter:  1, prev_obj_val: 56.72940444946289, obj_val: 62.16552734375, abs dis: 5.436122894287109
[rfa agg] iter: 1, weight: tensor([0.0035, 0.0400, 0.0022, 0.1721, 0.0252, 0.1955, 0.2292, 0.0437, 0.0879,
        0.2006])
[rfa agg] iter:  2, prev_obj_val: 62.16552734375, obj_val: 65.87566375732422, abs dis: 3.7101364135742188
[rfa agg] iter: 2, weight: tensor([0.0042, 0.0387, 0.0026, 0.2016, 0.0260, 0.2315, 0.1416, 0.0417, 0.0689,
        0.2430])
[rfa agg] iter:  3, prev_obj_val: 65.87566375732422, obj_val: 58.94536590576172, abs dis: 6.9302978515625
[rfa agg] iter: 3, weight: tensor([0.0057, 0.0469, 0.0035, 0.2031, 0.0325, 0.2157, 0.1396, 0.0501, 0.0779,
        0.2249])
[rfa agg] iter:  4, prev_obj_val: 58.94536590576172, obj_val: 65.8766860961914, abs dis: 6.9313201904296875
[rfa agg] iter: 4, weight: tensor([0.0034, 0.0341, 0.0021, 0.1979, 0.0222, 0.2371, 0.1543, 0.0370, 0.0658,
        0.2462])
[rfa agg] iter:  5, prev_obj_val: 65.8766860961914, obj_val: 58.94529342651367, abs dis: 6.931392669677734
[rfa agg] iter: 5, weight: tensor([0.0057, 0.0469, 0.0035, 0.2024, 0.0325, 0.2160, 0.1398, 0.0501, 0.0779,
        0.2252])
[rfa agg] iter:  6, prev_obj_val: 58.94529342651367, obj_val: 65.876708984375, abs dis: 6.931415557861328
[rfa agg] iter: 6, weight: tensor([0.0034, 0.0341, 0.0021, 0.1977, 0.0222, 0.2372, 0.1544, 0.0370, 0.0658,
        0.2463])
[rfa agg] iter:  7, prev_obj_val: 65.876708984375, obj_val: 58.94528579711914, abs dis: 6.931423187255859
[rfa agg] iter: 7, weight: tensor([0.0057, 0.0469, 0.0035, 0.2024, 0.0325, 0.2160, 0.1398, 0.0501, 0.0779,
        0.2252])
[rfa agg] iter:  8, prev_obj_val: 58.94528579711914, obj_val: 65.87670135498047, abs dis: 6.931415557861328
[rfa agg] iter: 8, weight: tensor([0.0034, 0.0341, 0.0021, 0.1977, 0.0222, 0.2372, 0.1544, 0.0370, 0.0658,
        0.2463])
[rfa agg] iter:  9, prev_obj_val: 65.87670135498047, obj_val: 58.945289611816406, abs dis: 6.9314117431640625
[rfa agg] iter: 9, weight: tensor([0.0057, 0.0469, 0.0035, 0.2024, 0.0325, 0.2160, 0.1398, 0.0501, 0.0779,
        0.2252])
			Update norm = 139.81502149045002 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.6439781188965 sec.
Server Epoch:39 choose agents : [34, 95, 89, 43, 8, 17, 27, 59, 44, 32].
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 404/1427 (28.3111%)
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   2, Avg loss: 0.0341, Accuracy: 563/1427 (39.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9056, Accuracy: 51/10000 (0.5100%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   1, Avg loss: 0.0533, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.5318, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   1, Avg loss: 0.0623, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 409/896 (45.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.2893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0621, Accuracy: 299/946 (31.6068%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 328/946 (34.6723%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9984, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 220/1513 (14.5406%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 475/1513 (31.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5915, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 410/1574 (26.0483%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 672/1574 (42.6938%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1497, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 625/1587 (39.3825%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3136, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 308/1089 (28.2828%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0292, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5205, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0603, Accuracy: 366/1750 (20.9143%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 662/1750 (37.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6020, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 200/735 (27.2109%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8439, Accuracy: 53/10000 (0.5300%)
time spent on training: 195.83788228034973
[rfa agg] training data poison_ratio: 0.049438758666226476  data num: [1427, 599, 896, 946, 1513, 1574, 1587, 1089, 1750, 735]
[rfa agg] considering poison per batch poison_fraction: 0.015449612083195775
[rfa agg] init. name: [34, 95, 89, 43, 8, 17, 27, 59, 44, 32], weight: tensor([0.1178, 0.0494, 0.0740, 0.0781, 0.1249, 0.1299, 0.1310, 0.0899, 0.1444,
        0.0607])
[rfa agg] iter:  0, prev_obj_val: 51.126747131347656, obj_val: 55.930419921875, abs dis: 4.803672790527344
[rfa agg] iter: 0, weight: tensor([0.1286, 0.0247, 0.0658, 0.0865, 0.1105, 0.0968, 0.0975, 0.2786, 0.0720,
        0.0389])
[rfa agg] iter:  1, prev_obj_val: 55.930419921875, obj_val: 57.925254821777344, abs dis: 1.9948348999023438
[rfa agg] iter: 1, weight: tensor([0.0851, 0.0265, 0.0825, 0.1203, 0.0766, 0.0695, 0.0700, 0.3702, 0.0553,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 57.925254821777344, obj_val: 60.00519561767578, abs dis: 2.0799407958984375
[rfa agg] iter: 2, weight: tensor([0.0827, 0.0300, 0.1007, 0.1553, 0.0754, 0.0690, 0.0695, 0.3103, 0.0559,
        0.0511])
[rfa agg] iter:  3, prev_obj_val: 60.00519561767578, obj_val: 59.99479675292969, abs dis: 0.01039886474609375
[rfa agg] iter: 3, weight: tensor([0.0793, 0.0335, 0.1235, 0.2069, 0.0730, 0.0674, 0.0679, 0.2343, 0.0554,
        0.0587])
[rfa agg] iter:  4, prev_obj_val: 59.99479675292969, obj_val: 59.99473571777344, abs dis: 6.103515625e-05
[rfa agg] iter: 4, weight: tensor([0.0795, 0.0335, 0.1245, 0.2109, 0.0732, 0.0675, 0.0680, 0.2286, 0.0555,
        0.0589])
			Update norm = 152.96792326130011 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.50822496414185 sec.
Server Epoch:40 choose agents : [93, 66, 71, 72, 10, 80, 83, 55, 2, 64].
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 416/1742 (23.8806%)
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7051, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 368/1402 (26.2482%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7077, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 153/818 (18.7042%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 351/818 (42.9095%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6218, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 246/1241 (19.8227%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3040, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 223/861 (25.9001%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 419/861 (48.6643%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0089, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   1, Avg loss: 0.0709, Accuracy: 142/682 (20.8211%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   2, Avg loss: 0.0391, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6782, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 438/1953 (22.4270%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 777/1953 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.5022, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 529/1071 (49.3931%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0101, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9072, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 160/953 (16.7891%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4121, Accuracy: 57/10000 (0.5700%)
time spent on training: 180.15626168251038
[rfa agg] training data poison_ratio: 0.0  data num: [1742, 1402, 818, 1241, 861, 682, 1953, 1071, 605, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [93, 66, 71, 72, 10, 80, 83, 55, 2, 64], weight: tensor([0.1538, 0.1238, 0.0722, 0.1096, 0.0760, 0.0602, 0.1724, 0.0945, 0.0534,
        0.0841])
[rfa agg] iter:  0, prev_obj_val: 57.20478057861328, obj_val: 60.3760986328125, abs dis: 3.1713180541992188
[rfa agg] iter: 0, weight: tensor([0.0652, 0.1390, 0.0526, 0.2583, 0.0672, 0.0323, 0.0556, 0.2099, 0.0253,
        0.0946])
[rfa agg] iter:  1, prev_obj_val: 60.3760986328125, obj_val: 66.77499389648438, abs dis: 6.398895263671875
[rfa agg] iter: 1, weight: tensor([0.0465, 0.0777, 0.0703, 0.1071, 0.0999, 0.0378, 0.0414, 0.3201, 0.0285,
        0.1706])
[rfa agg] iter:  2, prev_obj_val: 66.77499389648438, obj_val: 71.50860595703125, abs dis: 4.733612060546875
[rfa agg] iter: 2, weight: tensor([0.0346, 0.0499, 0.1301, 0.0599, 0.2263, 0.0510, 0.0317, 0.1098, 0.0356,
        0.2712])
[rfa agg] iter:  3, prev_obj_val: 71.50860595703125, obj_val: 80.95048522949219, abs dis: 9.441879272460938
[rfa agg] iter: 3, weight: tensor([0.0311, 0.0426, 0.2471, 0.0491, 0.2612, 0.0677, 0.0289, 0.0761, 0.0440,
        0.1520])
[rfa agg] iter:  4, prev_obj_val: 80.95048522949219, obj_val: 71.51065063476562, abs dis: 9.439834594726562
[rfa agg] iter: 4, weight: tensor([0.0368, 0.0473, 0.2363, 0.0522, 0.1387, 0.1819, 0.0348, 0.0709, 0.0966,
        0.1045])
[rfa agg] iter:  5, prev_obj_val: 71.51065063476562, obj_val: 84.4358139038086, abs dis: 12.925163269042969
[rfa agg] iter: 5, weight: tensor([0.0311, 0.0425, 0.2641, 0.0490, 0.2497, 0.0683, 0.0289, 0.0759, 0.0440,
        0.1467])
[rfa agg] iter:  6, prev_obj_val: 84.4358139038086, obj_val: 74.42752075195312, abs dis: 10.008293151855469
[rfa agg] iter: 6, weight: tensor([0.0366, 0.0462, 0.1760, 0.0504, 0.1157, 0.2547, 0.0347, 0.0664, 0.1266,
        0.0926])
[rfa agg] iter:  7, prev_obj_val: 74.42752075195312, obj_val: 80.9428482055664, abs dis: 6.515327453613281
[rfa agg] iter: 7, weight: tensor([0.0318, 0.0425, 0.3235, 0.0482, 0.1881, 0.0896, 0.0297, 0.0709, 0.0542,
        0.1217])
[rfa agg] iter:  8, prev_obj_val: 80.9428482055664, obj_val: 74.38568878173828, abs dis: 6.557159423828125
[rfa agg] iter: 8, weight: tensor([0.0366, 0.0470, 0.2417, 0.0519, 0.1365, 0.1815, 0.0346, 0.0705, 0.0960,
        0.1037])
[rfa agg] iter:  9, prev_obj_val: 74.38568878173828, obj_val: 77.55902862548828, abs dis: 3.17333984375
[rfa agg] iter: 9, weight: tensor([0.0306, 0.0410, 0.3468, 0.0465, 0.1828, 0.0855, 0.0286, 0.0684, 0.0521,
        0.1177])
			Update norm = 118.35305779346176 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 291.3928732872009 sec.
Server Epoch:41 choose agents : [85, 44, 65, 86, 25, 91, 38, 76, 45, 21].
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0544, Accuracy: 433/1988 (21.7807%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 656/1988 (32.9980%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6944, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0600, Accuracy: 403/1750 (23.0286%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 670/1750 (38.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8007, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 408/1475 (27.6610%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 699/1475 (47.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9998, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 384/1003 (38.2851%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5994, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0558, Accuracy: 315/690 (45.6522%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4205, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   1, Avg loss: 0.0519, Accuracy: 328/1030 (31.8447%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   2, Avg loss: 0.0271, Accuracy: 616/1030 (59.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2923, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 247/1131 (21.8391%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 492/1131 (43.5013%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2720, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 46/466 (9.8712%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.7353, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0685, Accuracy: 193/669 (28.8490%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.7932, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 407/1949 (20.8825%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3256, Accuracy: 84/10000 (0.8400%)
time spent on training: 211.68220925331116
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1750, 1475, 1003, 690, 1030, 1131, 466, 669, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 44, 65, 86, 25, 91, 38, 76, 45, 21], weight: tensor([0.1636, 0.1440, 0.1214, 0.0825, 0.0568, 0.0848, 0.0931, 0.0384, 0.0551,
        0.1604])
[rfa agg] iter:  0, prev_obj_val: 68.00251007080078, obj_val: 69.63396453857422, abs dis: 1.6314544677734375
[rfa agg] iter: 0, weight: tensor([0.0821, 0.1103, 0.1917, 0.1038, 0.0345, 0.1349, 0.2033, 0.0177, 0.0335,
        0.0881])
[rfa agg] iter:  1, prev_obj_val: 69.63396453857422, obj_val: 72.63581848144531, abs dis: 3.0018539428710938
[rfa agg] iter: 1, weight: tensor([0.0666, 0.0858, 0.1344, 0.1159, 0.0340, 0.1616, 0.2810, 0.0170, 0.0329,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 72.63581848144531, obj_val: 78.25047302246094, abs dis: 5.614654541015625
[rfa agg] iter: 2, weight: tensor([0.0375, 0.0461, 0.0641, 0.1191, 0.0259, 0.1998, 0.4306, 0.0123, 0.0251,
        0.0396])
[rfa agg] iter:  3, prev_obj_val: 78.25047302246094, obj_val: 80.65572357177734, abs dis: 2.4052505493164062
[rfa agg] iter: 3, weight: tensor([0.0367, 0.0435, 0.0558, 0.2520, 0.0356, 0.2847, 0.2032, 0.0156, 0.0345,
        0.0385])
[rfa agg] iter:  4, prev_obj_val: 80.65572357177734, obj_val: 83.39705657958984, abs dis: 2.7413330078125
[rfa agg] iter: 4, weight: tensor([0.0369, 0.0432, 0.0543, 0.3375, 0.0405, 0.2359, 0.1568, 0.0172, 0.0392,
        0.0385])
[rfa agg] iter:  5, prev_obj_val: 83.39705657958984, obj_val: 80.63087463378906, abs dis: 2.7661819458007812
[rfa agg] iter: 5, weight: tensor([0.0398, 0.0461, 0.0569, 0.3607, 0.0499, 0.1942, 0.1421, 0.0204, 0.0483,
        0.0415])
[rfa agg] iter:  6, prev_obj_val: 80.63087463378906, obj_val: 80.62909698486328, abs dis: 0.00177764892578125
[rfa agg] iter: 6, weight: tensor([0.0350, 0.0410, 0.0515, 0.3872, 0.0385, 0.2096, 0.1470, 0.0163, 0.0373,
        0.0366])
[rfa agg] iter:  7, prev_obj_val: 80.62909698486328, obj_val: 80.62896728515625, abs dis: 0.00012969970703125
[rfa agg] iter: 7, weight: tensor([0.0346, 0.0406, 0.0510, 0.3939, 0.0380, 0.2074, 0.1453, 0.0162, 0.0368,
        0.0362])
			Update norm = 148.5475184389662 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 325.8534710407257 sec.
Server Epoch:42 choose agents : [51, 16, 4, 43, 67, 60, 32, 45, 96, 15].
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 221/1049 (21.0677%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 532/1049 (50.7150%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5432, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   1, Avg loss: 0.0603, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7571, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0642, Accuracy: 318/901 (35.2941%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 384/901 (42.6193%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.2918, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 376/946 (39.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.0053, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 55/426 (12.9108%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7021, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0503, Accuracy: 553/2227 (24.8316%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2011, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 187/735 (25.4422%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 335/735 (45.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1681, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0686, Accuracy: 194/669 (28.9985%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7733, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3766, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0599, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0284, Accuracy: 439/1154 (38.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6367, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.26895999908447
[rfa agg] training data poison_ratio: 0.0  data num: [1049, 708, 901, 946, 426, 2227, 735, 669, 311, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 16, 4, 43, 67, 60, 32, 45, 96, 15], weight: tensor([0.1149, 0.0776, 0.0987, 0.1037, 0.0467, 0.2440, 0.0805, 0.0733, 0.0341,
        0.1265])
[rfa agg] iter:  0, prev_obj_val: 65.03323364257812, obj_val: 67.89102172851562, abs dis: 2.8577880859375
[rfa agg] iter: 0, weight: tensor([0.2416, 0.0535, 0.2148, 0.2217, 0.0145, 0.0360, 0.0555, 0.0407, 0.0086,
        0.1130])
[rfa agg] iter:  1, prev_obj_val: 67.89102172851562, obj_val: 71.15794372558594, abs dis: 3.2669219970703125
[rfa agg] iter: 1, weight: tensor([0.1076, 0.1044, 0.2345, 0.2401, 0.0192, 0.0337, 0.1089, 0.0686, 0.0108,
        0.0722])
[rfa agg] iter:  2, prev_obj_val: 71.15794372558594, obj_val: 75.06815338134766, abs dis: 3.9102096557617188
[rfa agg] iter: 2, weight: tensor([0.0847, 0.1907, 0.1415, 0.1478, 0.0233, 0.0335, 0.1986, 0.1042, 0.0127,
        0.0630])
[rfa agg] iter:  3, prev_obj_val: 75.06815338134766, obj_val: 80.84367370605469, abs dis: 5.775520324707031
[rfa agg] iter: 3, weight: tensor([0.0511, 0.2760, 0.0722, 0.0756, 0.0208, 0.0240, 0.2906, 0.1384, 0.0108,
        0.0405])
[rfa agg] iter:  4, prev_obj_val: 80.84367370605469, obj_val: 84.25843811035156, abs dis: 3.414764404296875
[rfa agg] iter: 4, weight: tensor([0.0516, 0.1833, 0.0660, 0.0692, 0.0312, 0.0277, 0.1913, 0.3218, 0.0151,
        0.0428])
[rfa agg] iter:  5, prev_obj_val: 84.25843811035156, obj_val: 84.25674438476562, abs dis: 0.0016937255859375
[rfa agg] iter: 5, weight: tensor([0.0567, 0.1548, 0.0700, 0.0734, 0.0422, 0.0323, 0.1606, 0.3424, 0.0196,
        0.0479])
			Update norm = 101.24652771823831 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 278.89683532714844 sec.
Server Epoch:43 choose agents : [38, 34, 30, 91, 79, 77, 97, 4, 92, 40].
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.3664, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 412/1427 (28.8718%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 588/1427 (41.2053%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8929, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0820, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.9138, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0547, Accuracy: 330/1030 (32.0388%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0243, Accuracy: 641/1030 (62.2330%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2822, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   1, Avg loss: 0.1027, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   2, Avg loss: 0.0885, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3324, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 595/1340 (44.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7285, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 360/1213 (29.6785%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 498/1213 (41.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8589, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0605, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 389/901 (43.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9313, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 473/1715 (27.5802%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 732/1715 (42.6822%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0149, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 370/1573 (23.5219%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 537/1573 (34.1386%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2957, Accuracy: 60/10000 (0.6000%)
time spent on training: 226.19776320457458
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 1427, 486, 1030, 197, 1340, 1213, 901, 1715, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 34, 30, 91, 79, 77, 97, 4, 92, 40], weight: tensor([0.1027, 0.1296, 0.0441, 0.0935, 0.0179, 0.1217, 0.1101, 0.0818, 0.1557,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 41.18962097167969, obj_val: 47.262203216552734, abs dis: 6.072582244873047
[rfa agg] iter: 0, weight: tensor([0.2622, 0.0713, 0.0106, 0.1282, 0.0031, 0.1162, 0.2499, 0.0575, 0.0459,
        0.0550])
[rfa agg] iter:  1, prev_obj_val: 47.262203216552734, obj_val: 49.978485107421875, abs dis: 2.7162818908691406
[rfa agg] iter: 1, weight: tensor([0.2388, 0.0605, 0.0139, 0.2540, 0.0039, 0.0842, 0.1442, 0.1063, 0.0440,
        0.0503])
[rfa agg] iter:  2, prev_obj_val: 49.978485107421875, obj_val: 52.98174285888672, abs dis: 3.0032577514648438
[rfa agg] iter: 2, weight: tensor([0.1894, 0.0604, 0.0158, 0.2820, 0.0043, 0.0810, 0.1258, 0.1450, 0.0452,
        0.0511])
[rfa agg] iter:  3, prev_obj_val: 52.98174285888672, obj_val: 52.97168731689453, abs dis: 0.0100555419921875
[rfa agg] iter: 3, weight: tensor([0.1622, 0.0619, 0.0185, 0.2405, 0.0050, 0.0808, 0.1177, 0.2124, 0.0476,
        0.0533])
[rfa agg] iter:  4, prev_obj_val: 52.97168731689453, obj_val: 56.117340087890625, abs dis: 3.1456527709960938
[rfa agg] iter: 4, weight: tensor([0.1616, 0.0619, 0.0185, 0.2335, 0.0050, 0.0808, 0.1176, 0.2204, 0.0475,
        0.0533])
[rfa agg] iter:  5, prev_obj_val: 56.117340087890625, obj_val: 56.09993362426758, abs dis: 0.017406463623046875
[rfa agg] iter: 5, weight: tensor([0.1360, 0.0594, 0.0203, 0.1843, 0.0053, 0.0757, 0.1049, 0.3156, 0.0467,
        0.0519])
[rfa agg] iter:  6, prev_obj_val: 56.09993362426758, obj_val: 56.099098205566406, abs dis: 0.000835418701171875
[rfa agg] iter: 6, weight: tensor([0.1320, 0.0578, 0.0197, 0.1754, 0.0052, 0.0737, 0.1020, 0.3383, 0.0455,
        0.0505])
			Update norm = 144.2606554773338 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3009, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.1908395290375 sec.
Server Epoch:44 choose agents : [31, 21, 20, 52, 96, 4, 15, 32, 64, 58].
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 373/1949 (19.1380%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 654/1949 (33.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.8424, Accuracy: 90/10000 (0.9000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 413/807 (51.1772%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.6703, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0542, Accuracy: 295/636 (46.3836%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0301, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.3586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3724, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0611, Accuracy: 321/901 (35.6271%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 398/901 (44.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8748, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 332/1154 (28.7695%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0329, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8858, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 194/735 (26.3946%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0238, Accuracy: 315/735 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7037, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 306/953 (32.1091%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.3833, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0349, Accuracy: 405/803 (50.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.0124, Accuracy: 50/10000 (0.5000%)
time spent on training: 174.48560285568237
[rfa agg] training data poison_ratio: 0.09266276265931794  data num: [460, 1949, 807, 636, 311, 901, 1154, 735, 953, 803]
[rfa agg] considering poison per batch poison_fraction: 0.028957113331036857
[rfa agg] init. name: [31, 21, 20, 52, 96, 4, 15, 32, 64, 58], weight: tensor([0.0528, 0.2238, 0.0927, 0.0730, 0.0357, 0.1035, 0.1325, 0.0844, 0.1094,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 54.85084533691406, obj_val: 56.578250885009766, abs dis: 1.7274055480957031
[rfa agg] iter: 0, weight: tensor([0.0181, 0.0371, 0.0911, 0.0339, 0.0087, 0.2558, 0.0945, 0.0607, 0.3091,
        0.0910])
[rfa agg] iter:  1, prev_obj_val: 56.578250885009766, obj_val: 63.202274322509766, abs dis: 6.6240234375
[rfa agg] iter: 1, weight: tensor([0.0214, 0.0255, 0.2295, 0.0485, 0.0090, 0.1001, 0.0448, 0.1342, 0.1081,
        0.2787])
[rfa agg] iter:  2, prev_obj_val: 63.202274322509766, obj_val: 66.05486297607422, abs dis: 2.852588653564453
[rfa agg] iter: 2, weight: tensor([0.0411, 0.0319, 0.1562, 0.1227, 0.0150, 0.0802, 0.0488, 0.2586, 0.0854,
        0.1601])
[rfa agg] iter:  3, prev_obj_val: 66.05486297607422, obj_val: 69.05677795410156, abs dis: 3.0019149780273438
[rfa agg] iter: 3, weight: tensor([0.0532, 0.0347, 0.1351, 0.1884, 0.0181, 0.0786, 0.0511, 0.2211, 0.0837,
        0.1361])
[rfa agg] iter:  4, prev_obj_val: 69.05677795410156, obj_val: 72.20208740234375, abs dis: 3.1453094482421875
[rfa agg] iter: 4, weight: tensor([0.0647, 0.0347, 0.1129, 0.2935, 0.0201, 0.0718, 0.0493, 0.1632, 0.0763,
        0.1134])
[rfa agg] iter:  5, prev_obj_val: 72.20208740234375, obj_val: 75.64439392089844, abs dis: 3.4423065185546875
[rfa agg] iter: 5, weight: tensor([0.0740, 0.0314, 0.0884, 0.4125, 0.0205, 0.0603, 0.0432, 0.1170, 0.0640,
        0.0887])
[rfa agg] iter:  6, prev_obj_val: 75.64439392089844, obj_val: 75.6428451538086, abs dis: 0.00154876708984375
[rfa agg] iter: 6, weight: tensor([0.1085, 0.0349, 0.0867, 0.3738, 0.0257, 0.0625, 0.0466, 0.1081, 0.0662,
        0.0870])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3026, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.65577936172485 sec.
Server Epoch:45 choose agents : [36, 57, 29, 82, 27, 2, 96, 56, 14, 20].
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   1, Avg loss: 0.0881, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   2, Avg loss: 0.0565, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.5475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   1, Avg loss: 0.0550, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 513/1154 (44.4541%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3463, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 390/1440 (27.0833%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 624/1440 (43.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9050, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7425, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 456/1587 (28.7335%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 619/1587 (39.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6601, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 236/605 (39.0083%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.0517, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 42/311 (13.5048%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   2, Avg loss: 0.0546, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3775, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3267, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6480, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   1, Avg loss: 0.0559, Accuracy: 354/807 (43.8662%)
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.9092, Accuracy: 50/10000 (0.5000%)
time spent on training: 175.86062145233154
[rfa agg] training data poison_ratio: 0.10073648732992135  data num: [408, 1154, 1440, 500, 1587, 605, 311, 186, 1013, 807]
[rfa agg] considering poison per batch poison_fraction: 0.03148015229060042
[rfa agg] init. name: [36, 57, 29, 82, 27, 2, 96, 56, 14, 20], weight: tensor([0.0509, 0.1441, 0.1798, 0.0624, 0.1981, 0.0755, 0.0388, 0.0232, 0.1265,
        0.1007])
[rfa agg] iter:  0, prev_obj_val: 57.81412124633789, obj_val: 60.561073303222656, abs dis: 2.7469520568847656
[rfa agg] iter: 0, weight: tensor([0.0280, 0.1298, 0.0872, 0.0396, 0.0780, 0.0688, 0.0168, 0.0083, 0.3078,
        0.2358])
[rfa agg] iter:  1, prev_obj_val: 60.561073303222656, obj_val: 62.0909423828125, abs dis: 1.5298690795898438
[rfa agg] iter: 1, weight: tensor([0.0299, 0.0992, 0.0724, 0.0432, 0.0659, 0.0810, 0.0174, 0.0084, 0.1876,
        0.3951])
[rfa agg] iter:  2, prev_obj_val: 62.0909423828125, obj_val: 66.13671875, abs dis: 4.0457763671875
[rfa agg] iter: 2, weight: tensor([0.0273, 0.0770, 0.0582, 0.0402, 0.0535, 0.0795, 0.0156, 0.0074, 0.1318,
        0.5096])
[rfa agg] iter:  3, prev_obj_val: 66.13671875, obj_val: 64.0054702758789, abs dis: 2.1312484741210938
[rfa agg] iter: 3, weight: tensor([0.0417, 0.0845, 0.0676, 0.0637, 0.0631, 0.1461, 0.0227, 0.0105, 0.1277,
        0.3725])
[rfa agg] iter:  4, prev_obj_val: 64.0054702758789, obj_val: 66.12261962890625, abs dis: 2.1171493530273438
[rfa agg] iter: 4, weight: tensor([0.0336, 0.0801, 0.0624, 0.0502, 0.0578, 0.1067, 0.0187, 0.0088, 0.1280,
        0.4537])
[rfa agg] iter:  5, prev_obj_val: 66.12261962890625, obj_val: 64.006591796875, abs dis: 2.11602783203125
[rfa agg] iter: 5, weight: tensor([0.0420, 0.0851, 0.0680, 0.0642, 0.0635, 0.1481, 0.0228, 0.0106, 0.1287,
        0.3670])
[rfa agg] iter:  6, prev_obj_val: 64.006591796875, obj_val: 66.12236785888672, abs dis: 2.1157760620117188
[rfa agg] iter: 6, weight: tensor([0.0336, 0.0803, 0.0625, 0.0504, 0.0579, 0.1070, 0.0188, 0.0088, 0.1283,
        0.4524])
[rfa agg] iter:  7, prev_obj_val: 66.12236785888672, obj_val: 64.00662231445312, abs dis: 2.1157455444335938
[rfa agg] iter: 7, weight: tensor([0.0420, 0.0851, 0.0680, 0.0642, 0.0635, 0.1482, 0.0228, 0.0106, 0.1287,
        0.3669])
[rfa agg] iter:  8, prev_obj_val: 64.00662231445312, obj_val: 66.12236785888672, abs dis: 2.1157455444335938
[rfa agg] iter: 8, weight: tensor([0.0336, 0.0803, 0.0625, 0.0504, 0.0579, 0.1070, 0.0188, 0.0088, 0.1283,
        0.4523])
[rfa agg] iter:  9, prev_obj_val: 66.12236785888672, obj_val: 64.00662231445312, abs dis: 2.1157455444335938
[rfa agg] iter: 9, weight: tensor([0.0420, 0.0851, 0.0680, 0.0642, 0.0635, 0.1482, 0.0228, 0.0106, 0.1287,
        0.3669])
			Update norm = 116.98293395165595 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3026, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.05830216407776 sec.
Server Epoch:46 choose agents : [14, 62, 77, 99, 54, 16, 76, 98, 91, 39].
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 333/1013 (32.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.6549, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 140/568 (24.6479%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8077, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 330/1340 (24.6269%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6962, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   1, Avg loss: 0.0653, Accuracy: 190/773 (24.5796%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 402/773 (52.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8193, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0625, Accuracy: 278/708 (39.2655%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8411, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8353, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   1, Avg loss: 0.0829, Accuracy: 17/373 (4.5576%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 343/1030 (33.3010%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 627/1030 (60.8738%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2935, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 321/1013 (31.6881%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 465/1013 (45.9033%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.4787, Accuracy: 59/10000 (0.5900%)
time spent on training: 175.51422762870789
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 568, 1340, 773, 1130, 708, 466, 373, 1030, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 62, 77, 99, 54, 16, 76, 98, 91, 39], weight: tensor([0.1204, 0.0675, 0.1593, 0.0919, 0.1343, 0.0841, 0.0554, 0.0443, 0.1224,
        0.1204])
[rfa agg] iter:  0, prev_obj_val: 39.974605560302734, obj_val: 44.90943145751953, abs dis: 4.934825897216797
[rfa agg] iter: 0, weight: tensor([0.0878, 0.0495, 0.0486, 0.2838, 0.0628, 0.2616, 0.0317, 0.0176, 0.0692,
        0.0873])
[rfa agg] iter:  1, prev_obj_val: 44.90943145751953, obj_val: 44.892250061035156, abs dis: 0.017181396484375
[rfa agg] iter: 1, weight: tensor([0.0801, 0.0792, 0.0507, 0.1745, 0.0620, 0.3364, 0.0470, 0.0241, 0.0663,
        0.0798])
[rfa agg] iter:  2, prev_obj_val: 44.892250061035156, obj_val: 44.89189147949219, abs dis: 0.00035858154296875
[rfa agg] iter: 2, weight: tensor([0.0783, 0.0777, 0.0495, 0.1670, 0.0606, 0.3546, 0.0460, 0.0236, 0.0648,
        0.0779])
			Update norm = 108.64944165468592 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3026, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.82090163230896 sec.
Server Epoch:47 choose agents : [50, 12, 17, 66, 78, 95, 72, 32, 76, 26].
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   1, Avg loss: 0.0640, Accuracy: 145/809 (17.9234%)
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2267, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0458, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 375/1574 (23.8247%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 677/1574 (43.0114%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1523, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 276/1402 (19.6862%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 387/1402 (27.6034%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4951, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0811, Accuracy: 45/416 (10.8173%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 180/416 (43.2692%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6755, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1566, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0622, Accuracy: 231/1241 (18.6140%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 407/1241 (32.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2113, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 334/735 (45.4422%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0680, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.8376, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 331/1446 (22.8907%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2736, Accuracy: 58/10000 (0.5800%)
time spent on training: 179.30720567703247
[rfa agg] training data poison_ratio: 0.0663638378019056  data num: [809, 338, 1574, 1402, 416, 599, 1241, 735, 466, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.0207386993130955
[rfa agg] init. name: [50, 12, 17, 66, 78, 95, 72, 32, 76, 26], weight: tensor([0.0896, 0.0374, 0.1744, 0.1553, 0.0461, 0.0664, 0.1375, 0.0814, 0.0516,
        0.1602])
[rfa agg] iter:  0, prev_obj_val: 59.81699752807617, obj_val: 63.39787673950195, abs dis: 3.5808792114257812
[rfa agg] iter: 0, weight: tensor([0.2245, 0.0224, 0.0940, 0.1192, 0.0310, 0.0713, 0.1471, 0.1430, 0.0397,
        0.1078])
[rfa agg] iter:  1, prev_obj_val: 63.39787673950195, obj_val: 68.63890838623047, abs dis: 5.241031646728516
[rfa agg] iter: 1, weight: tensor([0.4016, 0.0184, 0.0561, 0.0674, 0.0261, 0.0693, 0.0780, 0.1863, 0.0345,
        0.0623])
[rfa agg] iter:  2, prev_obj_val: 68.63890838623047, obj_val: 79.2513656616211, abs dis: 10.612457275390625
[rfa agg] iter: 2, weight: tensor([0.2354, 0.0179, 0.0390, 0.0451, 0.0265, 0.0918, 0.0499, 0.4152, 0.0369,
        0.0423])
[rfa agg] iter:  3, prev_obj_val: 79.2513656616211, obj_val: 76.30829620361328, abs dis: 2.9430694580078125
[rfa agg] iter: 3, weight: tensor([0.1104, 0.0342, 0.0437, 0.0486, 0.0556, 0.3683, 0.0516, 0.1504, 0.0909,
        0.0463])
[rfa agg] iter:  4, prev_obj_val: 76.30829620361328, obj_val: 71.08767700195312, abs dis: 5.220619201660156
[rfa agg] iter: 4, weight: tensor([0.1224, 0.0291, 0.0427, 0.0479, 0.0459, 0.3668, 0.0513, 0.1775, 0.0710,
        0.0454])
[rfa agg] iter:  5, prev_obj_val: 71.08767700195312, obj_val: 73.643798828125, abs dis: 2.556121826171875
[rfa agg] iter: 5, weight: tensor([0.1876, 0.0234, 0.0448, 0.0512, 0.0352, 0.1484, 0.0560, 0.3547, 0.0504,
        0.0483])
[rfa agg] iter:  6, prev_obj_val: 73.643798828125, obj_val: 71.03630828857422, abs dis: 2.6074905395507812
[rfa agg] iter: 6, weight: tensor([0.1619, 0.0279, 0.0471, 0.0533, 0.0428, 0.2145, 0.0576, 0.2811, 0.0634,
        0.0504])
[rfa agg] iter:  7, prev_obj_val: 71.03630828857422, obj_val: 71.02273559570312, abs dis: 0.01357269287109375
[rfa agg] iter: 7, weight: tensor([0.1832, 0.0225, 0.0432, 0.0493, 0.0338, 0.1395, 0.0539, 0.3796, 0.0485,
        0.0465])
[rfa agg] iter:  8, prev_obj_val: 71.02273559570312, obj_val: 71.02239227294922, abs dis: 0.00034332275390625
[rfa agg] iter: 8, weight: tensor([0.1788, 0.0218, 0.0419, 0.0479, 0.0328, 0.1329, 0.0524, 0.3994, 0.0470,
        0.0451])
			Update norm = 108.56554489828945 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3026, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.80112767219543 sec.
Server Epoch:48 choose agents : [84, 55, 13, 42, 91, 4, 11, 19, 73, 61].
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0576, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7278, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 317/1645 (19.2705%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9020, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 337/1372 (24.5627%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 461/1372 (33.6006%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8744, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 346/1030 (33.5922%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6669, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0632, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 363/901 (40.2886%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8689, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0525, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 418/712 (58.7079%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.6858, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0466, Accuracy: 394/1036 (38.0309%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 654/1036 (63.1274%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.3330, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0670, Accuracy: 158/938 (16.8443%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0510, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1187, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3140, Accuracy: 50/10000 (0.5000%)
time spent on training: 202.38116359710693
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1071, 1645, 1372, 1030, 901, 712, 1036, 938, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 55, 13, 42, 91, 4, 11, 19, 73, 61], weight: tensor([0.1192, 0.1073, 0.1648, 0.1375, 0.1032, 0.0903, 0.0713, 0.1038, 0.0940,
        0.0085])
[rfa agg] iter:  0, prev_obj_val: 35.26139831542969, obj_val: 42.890933990478516, abs dis: 7.629535675048828
[rfa agg] iter: 0, weight: tensor([0.0803, 0.1723, 0.0349, 0.0479, 0.1547, 0.1444, 0.0372, 0.1728, 0.1542,
        0.0013])
[rfa agg] iter:  1, prev_obj_val: 42.890933990478516, obj_val: 46.27909851074219, abs dis: 3.388164520263672
[rfa agg] iter: 1, weight: tensor([0.0647, 0.1021, 0.0357, 0.0453, 0.0962, 0.2343, 0.0683, 0.0996, 0.2521,
        0.0017])
[rfa agg] iter:  2, prev_obj_val: 46.27909851074219, obj_val: 42.837425231933594, abs dis: 3.4416732788085938
[rfa agg] iter: 2, weight: tensor([0.0690, 0.1012, 0.0404, 0.0502, 0.0958, 0.2148, 0.0991, 0.0987, 0.2288,
        0.0020])
[rfa agg] iter:  3, prev_obj_val: 42.837425231933594, obj_val: 46.28034210205078, abs dis: 3.4429168701171875
[rfa agg] iter: 3, weight: tensor([0.0625, 0.0976, 0.0345, 0.0437, 0.0919, 0.2423, 0.0664, 0.0955, 0.2641,
        0.0016])
[rfa agg] iter:  4, prev_obj_val: 46.28034210205078, obj_val: 42.83732986450195, abs dis: 3.443012237548828
[rfa agg] iter: 4, weight: tensor([0.0689, 0.1010, 0.0404, 0.0501, 0.0956, 0.2150, 0.0989, 0.0985, 0.2295,
        0.0020])
[rfa agg] iter:  5, prev_obj_val: 42.83732986450195, obj_val: 46.28034973144531, abs dis: 3.4430198669433594
[rfa agg] iter: 5, weight: tensor([0.0624, 0.0976, 0.0345, 0.0437, 0.0918, 0.2423, 0.0664, 0.0955, 0.2642,
        0.0016])
[rfa agg] iter:  6, prev_obj_val: 46.28034973144531, obj_val: 42.83732986450195, abs dis: 3.4430198669433594
[rfa agg] iter: 6, weight: tensor([0.0689, 0.1010, 0.0403, 0.0501, 0.0956, 0.2150, 0.0989, 0.0985, 0.2295,
        0.0020])
[rfa agg] iter:  7, prev_obj_val: 42.83732986450195, obj_val: 46.28034973144531, abs dis: 3.4430198669433594
[rfa agg] iter: 7, weight: tensor([0.0624, 0.0976, 0.0345, 0.0437, 0.0918, 0.2423, 0.0664, 0.0955, 0.2642,
        0.0016])
[rfa agg] iter:  8, prev_obj_val: 46.28034973144531, obj_val: 42.83732986450195, abs dis: 3.4430198669433594
[rfa agg] iter: 8, weight: tensor([0.0689, 0.1010, 0.0403, 0.0501, 0.0956, 0.2150, 0.0989, 0.0985, 0.2295,
        0.0020])
[rfa agg] iter:  9, prev_obj_val: 42.83732986450195, obj_val: 46.28034973144531, abs dis: 3.4430198669433594
[rfa agg] iter: 9, weight: tensor([0.0624, 0.0976, 0.0345, 0.0437, 0.0918, 0.2423, 0.0664, 0.0955, 0.2642,
        0.0016])
			Update norm = 130.2898961211114 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3026, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.64799761772156 sec.
Server Epoch:49 choose agents : [98, 39, 95, 2, 31, 41, 85, 0, 18, 69].
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 19/373 (5.0938%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0487, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.5253, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 310/1013 (30.6022%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 481/1013 (47.4827%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6554, Accuracy: 58/10000 (0.5800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8850, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0221, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0600, Accuracy: 330/719 (45.8971%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.3585, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   1, Avg loss: 0.0549, Accuracy: 486/1988 (24.4467%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 687/1988 (34.5573%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9064, Accuracy: 79/10000 (0.7900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 513/1657 (30.9596%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1053, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0766, Accuracy: 118/530 (22.2642%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.6730, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 277/590 (46.9492%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0333, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4871, Accuracy: 50/10000 (0.5000%)
time spent on training: 193.42169451713562
[rfa agg] training data poison_ratio: 0.2643543473166159  data num: [373, 1013, 599, 605, 460, 719, 1988, 1657, 530, 590]
[rfa agg] considering poison per batch poison_fraction: 0.08261073353644247
[rfa agg] init. name: [98, 39, 95, 2, 31, 41, 85, 0, 18, 69], weight: tensor([0.0437, 0.1187, 0.0702, 0.0709, 0.0539, 0.0843, 0.2330, 0.1942, 0.0621,
        0.0691])
[rfa agg] iter:  0, prev_obj_val: 78.05706787109375, obj_val: 79.82337951660156, abs dis: 1.7663116455078125
[rfa agg] iter: 0, weight: tensor([0.0176, 0.5546, 0.0456, 0.0461, 0.0269, 0.0785, 0.0638, 0.0866, 0.0351,
        0.0451])
[rfa agg] iter:  1, prev_obj_val: 79.82337951660156, obj_val: 84.44691467285156, abs dis: 4.62353515625
[rfa agg] iter: 1, weight: tensor([0.0267, 0.1701, 0.0974, 0.0988, 0.0461, 0.2806, 0.0530, 0.0645, 0.0660,
        0.0968])
[rfa agg] iter:  2, prev_obj_val: 84.44691467285156, obj_val: 94.9898452758789, abs dis: 10.542930603027344
[rfa agg] iter: 2, weight: tensor([0.0227, 0.0510, 0.1883, 0.2024, 0.0497, 0.1246, 0.0258, 0.0298, 0.0916,
        0.2141])
[rfa agg] iter:  3, prev_obj_val: 94.9898452758789, obj_val: 94.95061492919922, abs dis: 0.0392303466796875
[rfa agg] iter: 3, weight: tensor([0.0458, 0.0431, 0.1188, 0.1208, 0.2012, 0.0644, 0.0271, 0.0303, 0.2277,
        0.1209])
[rfa agg] iter:  4, prev_obj_val: 94.95061492919922, obj_val: 94.95036315917969, abs dis: 0.00025177001953125
[rfa agg] iter: 4, weight: tensor([0.0443, 0.0413, 0.1130, 0.1152, 0.2125, 0.0617, 0.0260, 0.0291, 0.2413,
        0.1155])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.3724641799927 sec.
Server Epoch:50 choose agents : [11, 22, 40, 49, 83, 52, 64, 6, 61, 8].
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 387/712 (54.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.7366, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 509/1470 (34.6259%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 832/1470 (56.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2641, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 364/1573 (23.1405%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 585/1573 (37.1901%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4259, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0784, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.6503, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 763/1953 (39.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2017, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0517, Accuracy: 321/636 (50.4717%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0290, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.3622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4882, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 377/1956 (19.2740%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 669/1956 (34.2025%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1788, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1273, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1160, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3163, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0593, Accuracy: 260/1513 (17.1844%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 486/1513 (32.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5535, Accuracy: 99/10000 (0.9900%)
time spent on training: 219.1357672214508
[rfa agg] training data poison_ratio: 0.0  data num: [712, 1470, 1573, 440, 1953, 636, 953, 1956, 85, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 22, 40, 49, 83, 52, 64, 6, 61, 8], weight: tensor([0.0631, 0.1302, 0.1393, 0.0390, 0.1730, 0.0563, 0.0844, 0.1732, 0.0075,
        0.1340])
[rfa agg] iter:  0, prev_obj_val: 66.19912719726562, obj_val: 66.1628646850586, abs dis: 0.03626251220703125
[rfa agg] iter: 0, weight: tensor([0.0411, 0.2721, 0.1679, 0.0160, 0.0912, 0.0297, 0.0845, 0.0914, 0.0022,
        0.2039])
			Update norm = 186.40828006019476 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 328.80134868621826 sec.
Server Epoch:51 choose agents : [40, 71, 49, 42, 5, 57, 22, 34, 60, 12].
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 358/1573 (22.7591%)
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 575/1573 (36.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7645, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 156/818 (19.0709%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 329/818 (40.2200%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3205, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   1, Avg loss: 0.0784, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0537, Accuracy: 343/1372 (25.0000%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 477/1372 (34.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0153, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 402/1628 (24.6929%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 840/1628 (51.5971%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3214, Accuracy: 148/10000 (1.4800%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 303/1154 (26.2565%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 471/1154 (40.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6996, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0463, Accuracy: 510/1470 (34.6939%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 829/1470 (56.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1801, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 405/1427 (28.3812%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0041, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0502, Accuracy: 550/2227 (24.6969%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1028/2227 (46.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6974, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0857, Accuracy: 28/338 (8.2840%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0488, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.5468, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.87813544273376
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 818, 440, 1372, 1628, 1154, 1470, 1427, 2227, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 71, 49, 42, 5, 57, 22, 34, 60, 12], weight: tensor([0.1264, 0.0657, 0.0353, 0.1102, 0.1308, 0.0927, 0.1181, 0.1146, 0.1789,
        0.0272])
[rfa agg] iter:  0, prev_obj_val: 53.725894927978516, obj_val: 56.00651931762695, abs dis: 2.2806243896484375
[rfa agg] iter: 0, weight: tensor([0.0993, 0.0266, 0.0082, 0.2550, 0.0839, 0.1345, 0.1739, 0.1711, 0.0415,
        0.0059])
[rfa agg] iter:  1, prev_obj_val: 56.00651931762695, obj_val: 53.649723052978516, abs dis: 2.3567962646484375
[rfa agg] iter: 1, weight: tensor([0.0976, 0.0312, 0.0093, 0.2287, 0.0839, 0.1844, 0.1588, 0.1555, 0.0440,
        0.0067])
[rfa agg] iter:  2, prev_obj_val: 53.649723052978516, obj_val: 58.472591400146484, abs dis: 4.822868347167969
[rfa agg] iter: 2, weight: tensor([0.0975, 0.0262, 0.0081, 0.2647, 0.0823, 0.1345, 0.1716, 0.1686, 0.0407,
        0.0058])
[rfa agg] iter:  3, prev_obj_val: 58.472591400146484, obj_val: 58.443668365478516, abs dis: 0.02892303466796875
[rfa agg] iter: 3, weight: tensor([0.0938, 0.0355, 0.0103, 0.1932, 0.0819, 0.2499, 0.1431, 0.1398, 0.0452,
        0.0074])
[rfa agg] iter:  4, prev_obj_val: 58.443668365478516, obj_val: 56.01148986816406, abs dis: 2.432178497314453
[rfa agg] iter: 4, weight: tensor([0.0925, 0.0350, 0.0102, 0.1874, 0.0807, 0.2643, 0.1408, 0.1375, 0.0445,
        0.0072])
[rfa agg] iter:  5, prev_obj_val: 56.01148986816406, obj_val: 56.00125503540039, abs dis: 0.010234832763671875
[rfa agg] iter: 5, weight: tensor([0.0974, 0.0311, 0.0093, 0.2227, 0.0837, 0.1929, 0.1579, 0.1545, 0.0439,
        0.0067])
[rfa agg] iter:  6, prev_obj_val: 56.00125503540039, obj_val: 56.001197814941406, abs dis: 5.7220458984375e-05
[rfa agg] iter: 6, weight: tensor([0.0975, 0.0311, 0.0093, 0.2260, 0.0838, 0.1882, 0.1584, 0.1550, 0.0439,
        0.0067])
			Update norm = 186.43334096936633 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.1463918685913 sec.
Server Epoch:52 choose agents : [72, 7, 94, 91, 34, 85, 61, 58, 18, 42].
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 401/1241 (32.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2395, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 345/891 (38.7205%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3577, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3151, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   2, Avg loss: 0.0282, Accuracy: 622/1030 (60.3883%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2416, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 405/1427 (28.3812%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.0055, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 445/1988 (22.3843%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 687/1988 (34.5573%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3999, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3165, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0584, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0331, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0860, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0731, Accuracy: 126/530 (23.7736%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3248, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0537, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 537/1372 (39.1399%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8759, Accuracy: 90/10000 (0.9000%)
time spent on training: 208.24501490592957
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 891, 1662, 1030, 1427, 1988, 85, 803, 530, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 7, 94, 91, 34, 85, 61, 58, 18, 42], weight: tensor([0.1125, 0.0808, 0.1507, 0.0934, 0.1294, 0.1803, 0.0077, 0.0728, 0.0481,
        0.1244])
[rfa agg] iter:  0, prev_obj_val: 55.041908264160156, obj_val: 54.95261001586914, abs dis: 0.08929824829101562
[rfa agg] iter: 0, weight: tensor([0.3270, 0.0590, 0.0792, 0.1546, 0.1175, 0.0514, 0.0017, 0.0448, 0.0178,
        0.1471])
[rfa agg] iter:  1, prev_obj_val: 54.95261001586914, obj_val: 56.68634033203125, abs dis: 1.7337303161621094
[rfa agg] iter: 1, weight: tensor([0.3478, 0.0570, 0.0764, 0.1515, 0.1133, 0.0496, 0.0016, 0.0432, 0.0172,
        0.1423])
[rfa agg] iter:  2, prev_obj_val: 56.68634033203125, obj_val: 56.67825698852539, abs dis: 0.008083343505859375
[rfa agg] iter: 2, weight: tensor([0.2753, 0.0690, 0.0781, 0.2065, 0.1107, 0.0522, 0.0018, 0.0515, 0.0198,
        0.1349])
[rfa agg] iter:  3, prev_obj_val: 56.67825698852539, obj_val: 58.464717864990234, abs dis: 1.7864608764648438
[rfa agg] iter: 3, weight: tensor([0.2712, 0.0691, 0.0781, 0.2107, 0.1107, 0.0522, 0.0018, 0.0515, 0.0198,
        0.1348])
[rfa agg] iter:  4, prev_obj_val: 58.464717864990234, obj_val: 60.31608581542969, abs dis: 1.8513679504394531
[rfa agg] iter: 4, weight: tensor([0.2136, 0.0785, 0.0744, 0.2795, 0.1015, 0.0512, 0.0019, 0.0574, 0.0212,
        0.1207])
[rfa agg] iter:  5, prev_obj_val: 60.31608581542969, obj_val: 64.62409973144531, abs dis: 4.308013916015625
[rfa agg] iter: 5, weight: tensor([0.1623, 0.0837, 0.0658, 0.3709, 0.0869, 0.0464, 0.0018, 0.0598, 0.0211,
        0.1012])
[rfa agg] iter:  6, prev_obj_val: 64.62409973144531, obj_val: 67.1139144897461, abs dis: 2.4898147583007812
[rfa agg] iter: 6, weight: tensor([0.1175, 0.1136, 0.0589, 0.4080, 0.0737, 0.0434, 0.0020, 0.0759, 0.0238,
        0.0832])
[rfa agg] iter:  7, prev_obj_val: 67.1139144897461, obj_val: 64.62799072265625, abs dis: 2.4859237670898438
[rfa agg] iter: 7, weight: tensor([0.1155, 0.1547, 0.0628, 0.3283, 0.0767, 0.0471, 0.0023, 0.0984, 0.0286,
        0.0856])
[rfa agg] iter:  8, prev_obj_val: 64.62799072265625, obj_val: 64.61846923828125, abs dis: 0.009521484375
[rfa agg] iter: 8, weight: tensor([0.1190, 0.1164, 0.0598, 0.3983, 0.0748, 0.0440, 0.0020, 0.0772, 0.0242,
        0.0844])
[rfa agg] iter:  9, prev_obj_val: 64.61846923828125, obj_val: 64.61788940429688, abs dis: 0.000579833984375
[rfa agg] iter: 9, weight: tensor([0.1156, 0.1124, 0.0581, 0.4161, 0.0727, 0.0428, 0.0019, 0.0749, 0.0235,
        0.0820])
			Update norm = 151.2875469924739 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 324.2299916744232 sec.
Server Epoch:53 choose agents : [1, 32, 31, 44, 27, 62, 95, 28, 49, 40].
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0583, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6227, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 352/735 (47.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3637, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   1, Avg loss: 0.0778, Accuracy: 80/460 (17.3913%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   2, Avg loss: 0.0365, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.9998, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 383/1750 (21.8857%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 671/1750 (38.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5478, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 427/1587 (26.9061%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 609/1587 (38.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3612, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 143/568 (25.1761%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8558, Accuracy: 49/10000 (0.4900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   1, Avg loss: 0.0523, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3026, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 389/1581 (24.6047%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1238, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0784, Accuracy: 39/440 (8.8636%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.6486, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 367/1573 (23.3312%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 572/1573 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5330, Accuracy: 79/10000 (0.7900%)
time spent on training: 208.4541540145874
[rfa agg] training data poison_ratio: 0.05860483318657666  data num: [928, 735, 460, 1750, 1587, 568, 599, 1581, 440, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.018314010370805205
[rfa agg] init. name: [1, 32, 31, 44, 27, 62, 95, 28, 49, 40], weight: tensor([0.0908, 0.0719, 0.0450, 0.1712, 0.1553, 0.0556, 0.0586, 0.1547, 0.0430,
        0.1539])
[rfa agg] iter:  0, prev_obj_val: 69.34811401367188, obj_val: 71.78040313720703, abs dis: 2.4322891235351562
[rfa agg] iter: 0, weight: tensor([0.2310, 0.0878, 0.0320, 0.1099, 0.1389, 0.0441, 0.0526, 0.1382, 0.0277,
        0.1379])
[rfa agg] iter:  1, prev_obj_val: 71.78040313720703, obj_val: 73.02039337158203, abs dis: 1.239990234375
[rfa agg] iter: 1, weight: tensor([0.3270, 0.0957, 0.0320, 0.0900, 0.1101, 0.0447, 0.0544, 0.1096, 0.0274,
        0.1092])
[rfa agg] iter:  2, prev_obj_val: 73.02039337158203, obj_val: 74.3084945678711, abs dis: 1.2881011962890625
[rfa agg] iter: 2, weight: tensor([0.4048, 0.0948, 0.0300, 0.0762, 0.0918, 0.0423, 0.0520, 0.0915, 0.0255,
        0.0911])
[rfa agg] iter:  3, prev_obj_val: 74.3084945678711, obj_val: 77.52869415283203, abs dis: 3.2201995849609375
[rfa agg] iter: 3, weight: tensor([0.5113, 0.0873, 0.0260, 0.0594, 0.0707, 0.0370, 0.0460, 0.0704, 0.0219,
        0.0701])
[rfa agg] iter:  4, prev_obj_val: 77.52869415283203, obj_val: 83.58238983154297, abs dis: 6.0536956787109375
[rfa agg] iter: 4, weight: tensor([0.5227, 0.1093, 0.0275, 0.0506, 0.0588, 0.0400, 0.0513, 0.0586, 0.0228,
        0.0584])
[rfa agg] iter:  5, prev_obj_val: 83.58238983154297, obj_val: 83.48478698730469, abs dis: 0.09760284423828125
[rfa agg] iter: 5, weight: tensor([0.2229, 0.2809, 0.0448, 0.0574, 0.0650, 0.0688, 0.0953, 0.0647, 0.0358,
        0.0644])
[rfa agg] iter:  6, prev_obj_val: 83.48478698730469, obj_val: 81.4753189086914, abs dis: 2.0094680786132812
[rfa agg] iter: 6, weight: tensor([0.2074, 0.3082, 0.0437, 0.0558, 0.0632, 0.0674, 0.0937, 0.0629, 0.0349,
        0.0627])
[rfa agg] iter:  7, prev_obj_val: 81.4753189086914, obj_val: 81.46821594238281, abs dis: 0.00710296630859375
[rfa agg] iter: 7, weight: tensor([0.2753, 0.2330, 0.0419, 0.0607, 0.0693, 0.0631, 0.0849, 0.0690, 0.0340,
        0.0688])
			Update norm = 124.92573575178575 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.46969532966614 sec.
Server Epoch:54 choose agents : [8, 16, 22, 38, 69, 90, 47, 85, 7, 94].
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 236/1513 (15.5981%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4863, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.9944, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 541/1470 (36.8027%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9593, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4085, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0536, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 315/677 (46.5288%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4792, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1230, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1092, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0548, Accuracy: 452/1988 (22.7364%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1339, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 436/891 (48.9338%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2890, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7931, Accuracy: 94/10000 (0.9400%)
time spent on training: 195.88886904716492
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 708, 1470, 1131, 590, 677, 134, 1988, 891, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 16, 22, 38, 69, 90, 47, 85, 7, 94], weight: tensor([0.1406, 0.0658, 0.1366, 0.1051, 0.0548, 0.0629, 0.0124, 0.1847, 0.0828,
        0.1544])
[rfa agg] iter:  0, prev_obj_val: 61.61567306518555, obj_val: 62.630714416503906, abs dis: 1.0150413513183594
[rfa agg] iter: 0, weight: tensor([0.1514, 0.0432, 0.1848, 0.2887, 0.0285, 0.0365, 0.0037, 0.0729, 0.0737,
        0.1166])
[rfa agg] iter:  1, prev_obj_val: 62.630714416503906, obj_val: 63.759029388427734, abs dis: 1.1283149719238281
[rfa agg] iter: 1, weight: tensor([0.1259, 0.0425, 0.1508, 0.3753, 0.0276, 0.0357, 0.0035, 0.0645, 0.0744,
        0.0997])
[rfa agg] iter:  2, prev_obj_val: 63.759029388427734, obj_val: 68.5909423828125, abs dis: 4.831912994384766
[rfa agg] iter: 2, weight: tensor([0.0985, 0.0393, 0.1156, 0.4817, 0.0251, 0.0327, 0.0031, 0.0533, 0.0708,
        0.0799])
[rfa agg] iter:  3, prev_obj_val: 68.5909423828125, obj_val: 68.58300018310547, abs dis: 0.00794219970703125
[rfa agg] iter: 3, weight: tensor([0.0898, 0.0585, 0.1011, 0.4125, 0.0351, 0.0469, 0.0040, 0.0554, 0.1196,
        0.0771])
[rfa agg] iter:  4, prev_obj_val: 68.58300018310547, obj_val: 68.58292388916016, abs dis: 7.62939453125e-05
[rfa agg] iter: 4, weight: tensor([0.0908, 0.0593, 0.1022, 0.4049, 0.0355, 0.0475, 0.0040, 0.0561, 0.1217,
        0.0779])
			Update norm = 155.68612002599974 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.5038890838623 sec.
Server Epoch:55 choose agents : [54, 89, 78, 16, 55, 80, 13, 61, 12, 27].
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6433, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.4316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0812, Accuracy: 49/416 (11.7788%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.7131, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0622, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0399, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9862, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 264/1071 (24.6499%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 480/1071 (44.8179%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9166, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   1, Avg loss: 0.0712, Accuracy: 142/682 (20.8211%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   2, Avg loss: 0.0384, Accuracy: 247/682 (36.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.6214, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 321/1645 (19.5137%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 623/1645 (37.8723%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9562, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 11/85 (12.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3162, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0848, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 153/338 (45.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5470, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 466/1587 (29.3636%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 619/1587 (39.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.2232, Accuracy: 64/10000 (0.6400%)
time spent on training: 193.14626598358154
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 896, 416, 708, 1071, 682, 1645, 85, 338, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 89, 78, 16, 55, 80, 13, 61, 12, 27], weight: tensor([0.1320, 0.1047, 0.0486, 0.0827, 0.1251, 0.0797, 0.1922, 0.0099, 0.0395,
        0.1854])
[rfa agg] iter:  0, prev_obj_val: 56.05668258666992, obj_val: 57.24407196044922, abs dis: 1.1873893737792969
[rfa agg] iter: 0, weight: tensor([0.1526, 0.2954, 0.0220, 0.0974, 0.2117, 0.0716, 0.0634, 0.0027, 0.0159,
        0.0673])
[rfa agg] iter:  1, prev_obj_val: 57.24407196044922, obj_val: 60.55377197265625, abs dis: 3.3097000122070312
[rfa agg] iter: 1, weight: tensor([0.1164, 0.4123, 0.0205, 0.1009, 0.1526, 0.0713, 0.0529, 0.0025, 0.0147,
        0.0559])
[rfa agg] iter:  2, prev_obj_val: 60.55377197265625, obj_val: 60.54637145996094, abs dis: 0.0074005126953125
[rfa agg] iter: 2, weight: tensor([0.0862, 0.4347, 0.0222, 0.1475, 0.1044, 0.0925, 0.0459, 0.0025, 0.0157,
        0.0482])
[rfa agg] iter:  3, prev_obj_val: 60.54637145996094, obj_val: 60.546302795410156, abs dis: 6.866455078125e-05
[rfa agg] iter: 3, weight: tensor([0.0850, 0.4416, 0.0219, 0.1467, 0.1027, 0.0913, 0.0453, 0.0025, 0.0155,
        0.0475])
			Update norm = 124.99578508518798 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.5720407962799 sec.
Server Epoch:56 choose agents : [0, 41, 85, 47, 95, 90, 72, 45, 32, 26].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 348/1657 (21.0018%)
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 491/1657 (29.6319%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7485, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0324, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4605, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 439/1988 (22.0825%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   2, Avg loss: 0.0361, Accuracy: 637/1988 (32.0423%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0788, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1188, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1075, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3276, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0717, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5665, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 260/1241 (20.9508%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 387/1241 (31.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4098, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0675, Accuracy: 192/669 (28.6996%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 193/735 (26.2585%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 315/735 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4853, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 337/1446 (23.3057%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 497/1446 (34.3707%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4708, Accuracy: 69/10000 (0.6900%)
time spent on training: 213.2515001296997
[rfa agg] training data poison_ratio: 0.22868727825646223  data num: [1657, 719, 1988, 134, 599, 677, 1241, 669, 735, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.07146477445514444
[rfa agg] init. name: [0, 41, 85, 47, 95, 90, 72, 45, 32, 26], weight: tensor([0.1680, 0.0729, 0.2015, 0.0136, 0.0607, 0.0686, 0.1258, 0.0678, 0.0745,
        0.1466])
[rfa agg] iter:  0, prev_obj_val: 69.3072738647461, obj_val: 70.49585723876953, abs dis: 1.1885833740234375
[rfa agg] iter: 0, weight: tensor([0.1200, 0.0692, 0.0827, 0.0052, 0.0435, 0.0562, 0.3312, 0.0555, 0.0710,
        0.1656])
[rfa agg] iter:  1, prev_obj_val: 70.49585723876953, obj_val: 72.99977111816406, abs dis: 2.5039138793945312
[rfa agg] iter: 1, weight: tensor([0.1191, 0.0794, 0.0841, 0.0056, 0.0489, 0.0638, 0.2952, 0.0629, 0.0815,
        0.1595])
[rfa agg] iter:  2, prev_obj_val: 72.99977111816406, obj_val: 74.2569580078125, abs dis: 1.2571868896484375
[rfa agg] iter: 2, weight: tensor([0.1132, 0.1023, 0.0835, 0.0064, 0.0598, 0.0798, 0.2270, 0.0787, 0.1054,
        0.1437])
[rfa agg] iter:  3, prev_obj_val: 74.2569580078125, obj_val: 76.80033111572266, abs dis: 2.5433731079101562
[rfa agg] iter: 3, weight: tensor([0.1076, 0.1148, 0.0809, 0.0067, 0.0647, 0.0878, 0.1990, 0.0865, 0.1183,
        0.1336])
[rfa agg] iter:  4, prev_obj_val: 76.80033111572266, obj_val: 76.7964859008789, abs dis: 0.00384521484375
[rfa agg] iter: 4, weight: tensor([0.0923, 0.1423, 0.0718, 0.0068, 0.0731, 0.1032, 0.1509, 0.1015, 0.1475,
        0.1105])
			Update norm = 137.94907489948963 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.9178879261017 sec.
Server Epoch:57 choose agents : [7, 40, 56, 4, 32, 75, 76, 70, 89, 9].
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0268, Accuracy: 431/891 (48.3726%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2604, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 391/1573 (24.8570%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 551/1573 (35.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7758, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3302, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0603, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 386/901 (42.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1558, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 210/735 (28.5714%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.4082, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7833, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 341/1418 (24.0480%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 610/1418 (43.0183%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8094, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.3310, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 360/1275 (28.2353%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 704/1275 (55.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.6731, Accuracy: 101/10000 (1.0100%)
time spent on training: 217.8835847377777
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1573, 186, 901, 735, 776, 466, 1418, 896, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 40, 56, 4, 32, 75, 76, 70, 89, 9], weight: tensor([0.0977, 0.1725, 0.0204, 0.0988, 0.0806, 0.0851, 0.0511, 0.1555, 0.0983,
        0.1398])
[rfa agg] iter:  0, prev_obj_val: 46.00702667236328, obj_val: 57.06420135498047, abs dis: 11.057174682617188
[rfa agg] iter: 0, weight: tensor([0.2106, 0.0364, 0.0039, 0.2312, 0.0694, 0.1132, 0.0174, 0.0404, 0.2215,
        0.0559])
[rfa agg] iter:  1, prev_obj_val: 57.06420135498047, obj_val: 64.14330291748047, abs dis: 7.0791015625
[rfa agg] iter: 1, weight: tensor([0.1225, 0.0358, 0.0060, 0.0871, 0.3218, 0.1824, 0.0339, 0.0380, 0.1255,
        0.0470])
[rfa agg] iter:  2, prev_obj_val: 64.14330291748047, obj_val: 53.842262268066406, abs dis: 10.301040649414062
[rfa agg] iter: 2, weight: tensor([0.1203, 0.0473, 0.0096, 0.0933, 0.2801, 0.1551, 0.0636, 0.0496, 0.1216,
        0.0594])
[rfa agg] iter:  3, prev_obj_val: 53.842262268066406, obj_val: 60.455322265625, abs dis: 6.613059997558594
[rfa agg] iter: 3, weight: tensor([0.1317, 0.0322, 0.0049, 0.0885, 0.2693, 0.2341, 0.0263, 0.0345, 0.1351,
        0.0433])
[rfa agg] iter:  4, prev_obj_val: 60.455322265625, obj_val: 56.93738555908203, abs dis: 3.5179367065429688
[rfa agg] iter: 4, weight: tensor([0.1136, 0.0392, 0.0072, 0.0848, 0.3437, 0.1608, 0.0439, 0.0414, 0.1151,
        0.0503])
[rfa agg] iter:  5, prev_obj_val: 56.93738555908203, obj_val: 64.1502685546875, abs dis: 7.212882995605469
[rfa agg] iter: 5, weight: tensor([0.1041, 0.0309, 0.0052, 0.0744, 0.4136, 0.1632, 0.0293, 0.0328, 0.1060,
        0.0405])
[rfa agg] iter:  6, prev_obj_val: 64.1502685546875, obj_val: 56.946258544921875, abs dis: 7.204010009765625
[rfa agg] iter: 6, weight: tensor([0.1193, 0.0470, 0.0095, 0.0927, 0.2853, 0.1537, 0.0633, 0.0493, 0.1207,
        0.0591])
[rfa agg] iter:  7, prev_obj_val: 56.946258544921875, obj_val: 56.93275451660156, abs dis: 0.0135040283203125
[rfa agg] iter: 7, weight: tensor([0.1073, 0.0318, 0.0053, 0.0766, 0.3961, 0.1680, 0.0302, 0.0337, 0.1093,
        0.0417])
[rfa agg] iter:  8, prev_obj_val: 56.93275451660156, obj_val: 60.44755554199219, abs dis: 3.514801025390625
[rfa agg] iter: 8, weight: tensor([0.1010, 0.0300, 0.0050, 0.0722, 0.4310, 0.1584, 0.0285, 0.0319, 0.1027,
        0.0393])
[rfa agg] iter:  9, prev_obj_val: 60.44755554199219, obj_val: 64.14555358886719, abs dis: 3.697998046875
[rfa agg] iter: 9, weight: tensor([0.1087, 0.0377, 0.0070, 0.0814, 0.3727, 0.1519, 0.0423, 0.0398, 0.1102,
        0.0484])
			Update norm = 103.4466055282265 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.44861912727356 sec.
Server Epoch:58 choose agents : [35, 34, 31, 90, 75, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 30/271 (11.0701%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0571, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.4281, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 388/1427 (27.1899%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 582/1427 (40.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.1344, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0781, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8927, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.6299, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0654, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4566, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 439/1036 (42.3745%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 669/1036 (64.5753%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.3651, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 422/1587 (26.5911%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 615/1587 (38.7524%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8090, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.4636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0763, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9664, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8168, Accuracy: 50/10000 (0.5000%)
time spent on training: 170.9678225517273
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1427, 460, 677, 776, 1036, 1587, 312, 515, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 34, 31, 90, 75, 19, 27, 24, 33, 23], weight: tensor([0.0349, 0.1835, 0.0592, 0.0871, 0.0998, 0.1332, 0.2041, 0.0401, 0.0662,
        0.0919])
[rfa agg] iter:  0, prev_obj_val: 56.32383728027344, obj_val: 60.96956253051758, abs dis: 4.645725250244141
[rfa agg] iter: 0, weight: tensor([0.0148, 0.0782, 0.0378, 0.1094, 0.2894, 0.1652, 0.0714, 0.0171, 0.0505,
        0.1663])
[rfa agg] iter:  1, prev_obj_val: 60.96956253051758, obj_val: 65.29419708251953, abs dis: 4.324634552001953
[rfa agg] iter: 1, weight: tensor([0.0137, 0.0413, 0.0430, 0.2788, 0.1575, 0.0622, 0.0392, 0.0158, 0.0657,
        0.2829])
[rfa agg] iter:  2, prev_obj_val: 65.29419708251953, obj_val: 70.61939239501953, abs dis: 5.3251953125
[rfa agg] iter: 2, weight: tensor([0.0180, 0.0423, 0.0662, 0.3619, 0.1101, 0.0587, 0.0406, 0.0208, 0.1147,
        0.1666])
[rfa agg] iter:  3, prev_obj_val: 70.61939239501953, obj_val: 70.58210754394531, abs dis: 0.03728485107421875
[rfa agg] iter: 3, weight: tensor([0.0256, 0.0460, 0.1233, 0.1900, 0.0941, 0.0598, 0.0446, 0.0296, 0.2661,
        0.1210])
[rfa agg] iter:  4, prev_obj_val: 70.58210754394531, obj_val: 73.42350769042969, abs dis: 2.841400146484375
[rfa agg] iter: 4, weight: tensor([0.0249, 0.0445, 0.1209, 0.1802, 0.0910, 0.0579, 0.0432, 0.0287, 0.2921,
        0.1166])
[rfa agg] iter:  5, prev_obj_val: 73.42350769042969, obj_val: 79.91371154785156, abs dis: 6.490203857421875
[rfa agg] iter: 5, weight: tensor([0.0255, 0.0393, 0.1536, 0.1267, 0.0734, 0.0498, 0.0383, 0.0294, 0.3740,
        0.0899])
[rfa agg] iter:  6, prev_obj_val: 79.91371154785156, obj_val: 79.86111450195312, abs dis: 0.0525970458984375
[rfa agg] iter: 6, weight: tensor([0.0374, 0.0412, 0.3463, 0.0963, 0.0664, 0.0497, 0.0405, 0.0433, 0.2026,
        0.0764])
[rfa agg] iter:  7, prev_obj_val: 79.86111450195312, obj_val: 83.47970581054688, abs dis: 3.61859130859375
[rfa agg] iter: 7, weight: tensor([0.0335, 0.0368, 0.4266, 0.0858, 0.0592, 0.0443, 0.0361, 0.0389, 0.1706,
        0.0682])
[rfa agg] iter:  8, prev_obj_val: 83.47970581054688, obj_val: 79.85868835449219, abs dis: 3.6210174560546875
[rfa agg] iter: 8, weight: tensor([0.0497, 0.0446, 0.3612, 0.0926, 0.0676, 0.0527, 0.0440, 0.0578, 0.1535,
        0.0762])
[rfa agg] iter:  9, prev_obj_val: 79.85868835449219, obj_val: 83.4804458618164, abs dis: 3.6217575073242188
[rfa agg] iter: 9, weight: tensor([0.0328, 0.0359, 0.4430, 0.0837, 0.0577, 0.0433, 0.0352, 0.0380, 0.1638,
        0.0666])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.1509461402893 sec.
Server Epoch:59 choose agents : [69, 84, 6, 40, 21, 23, 99, 76, 53, 20].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.3703, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 314/1190 (26.3866%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 426/1190 (35.7983%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.0221, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 415/1956 (21.2168%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0331, Accuracy: 613/1956 (31.3395%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1923, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 340/1573 (21.6147%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 608/1573 (38.6523%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6001, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 390/1949 (20.0103%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 616/1949 (31.6060%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.4140, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8450, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0674, Accuracy: 179/773 (23.1565%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 387/773 (50.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6175, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.0546, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 279/813 (34.3173%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 418/813 (51.4145%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.2990, Accuracy: 51/10000 (0.5100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2903, Accuracy: 50/10000 (0.5000%)
time spent on training: 247.00340104103088
[rfa agg] training data poison_ratio: 0.07450147710487445  data num: [590, 1190, 1956, 1573, 1949, 715, 773, 466, 813, 807]
[rfa agg] considering poison per batch poison_fraction: 0.023281711595273265
[rfa agg] init. name: [69, 84, 6, 40, 21, 23, 99, 76, 53, 20], weight: tensor([0.0545, 0.1099, 0.1806, 0.1452, 0.1799, 0.0660, 0.0714, 0.0430, 0.0751,
        0.0745])
[rfa agg] iter:  0, prev_obj_val: 72.43036651611328, obj_val: 74.83509826660156, abs dis: 2.4047317504882812
[rfa agg] iter: 0, weight: tensor([0.0266, 0.5164, 0.0662, 0.1053, 0.0659, 0.0413, 0.0520, 0.0172, 0.0548,
        0.0543])
[rfa agg] iter:  1, prev_obj_val: 74.83509826660156, obj_val: 75.82733917236328, abs dis: 0.9922409057617188
[rfa agg] iter: 1, weight: tensor([0.0386, 0.3714, 0.0713, 0.1025, 0.0711, 0.0633, 0.0832, 0.0241, 0.0877,
        0.0866])
[rfa agg] iter:  2, prev_obj_val: 75.82733917236328, obj_val: 78.95069122314453, abs dis: 3.12335205078125
[rfa agg] iter: 2, weight: tensor([0.0441, 0.2974, 0.0733, 0.1026, 0.0730, 0.0742, 0.0995, 0.0271, 0.1051,
        0.1038])
[rfa agg] iter:  3, prev_obj_val: 78.95069122314453, obj_val: 81.09960174560547, abs dis: 2.1489105224609375
[rfa agg] iter: 3, weight: tensor([0.0524, 0.1639, 0.0620, 0.0811, 0.0618, 0.0980, 0.1451, 0.0305, 0.1541,
        0.1511])
[rfa agg] iter:  4, prev_obj_val: 81.09960174560547, obj_val: 87.71829986572266, abs dis: 6.6186981201171875
[rfa agg] iter: 4, weight: tensor([0.0505, 0.1012, 0.0461, 0.0581, 0.0459, 0.1067, 0.1803, 0.0278, 0.1949,
        0.1884])
[rfa agg] iter:  5, prev_obj_val: 87.71829986572266, obj_val: 87.69527435302734, abs dis: 0.0230255126953125
[rfa agg] iter: 5, weight: tensor([0.0503, 0.0400, 0.0233, 0.0277, 0.0232, 0.1756, 0.1972, 0.0226, 0.2318,
        0.2083])
[rfa agg] iter:  6, prev_obj_val: 87.69527435302734, obj_val: 90.65373992919922, abs dis: 2.958465576171875
[rfa agg] iter: 6, weight: tensor([0.0494, 0.0392, 0.0229, 0.0272, 0.0228, 0.1814, 0.1945, 0.0222, 0.2327,
        0.2076])
[rfa agg] iter:  7, prev_obj_val: 90.65373992919922, obj_val: 93.93374633789062, abs dis: 3.2800064086914062
[rfa agg] iter: 7, weight: tensor([0.0711, 0.0428, 0.0261, 0.0307, 0.0260, 0.2638, 0.1607, 0.0292, 0.1797,
        0.1697])
[rfa agg] iter:  8, prev_obj_val: 93.93374633789062, obj_val: 100.99504089355469, abs dis: 7.0612945556640625
[rfa agg] iter: 8, weight: tensor([0.1085, 0.0474, 0.0302, 0.0350, 0.0300, 0.2722, 0.1394, 0.0394, 0.1513,
        0.1466])
[rfa agg] iter:  9, prev_obj_val: 100.99504089355469, obj_val: 97.41409301757812, abs dis: 3.5809478759765625
[rfa agg] iter: 9, weight: tensor([0.2700, 0.0512, 0.0351, 0.0398, 0.0350, 0.1630, 0.1091, 0.0663, 0.1162,
        0.1143])
			Update norm = 102.43028307402552 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.7871947288513 sec.
Server Epoch:60 choose agents : [51, 0, 53, 75, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 219/1049 (20.8770%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 510/1049 (48.6177%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7504, Accuracy: 71/10000 (0.7100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 361/1657 (21.7864%)
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   2, Avg loss: 0.0351, Accuracy: 514/1657 (31.0199%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6782, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 289/813 (35.5474%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 464/813 (57.0726%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.9441, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   1, Avg loss: 0.0661, Accuracy: 242/776 (31.1856%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   2, Avg loss: 0.0279, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.4283, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 350/1372 (25.5102%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.1461, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3189, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0296, Accuracy: 418/1130 (36.9912%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9635, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 331/1418 (23.3427%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 614/1418 (43.3004%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9861, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0551, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.8333, Accuracy: 53/10000 (0.5300%)
time spent on training: 203.00390887260437
[rfa agg] training data poison_ratio: 0.1772192513368984  data num: [1049, 1657, 813, 776, 1372, 85, 338, 1130, 1418, 712]
[rfa agg] considering poison per batch poison_fraction: 0.05538101604278075
[rfa agg] init. name: [51, 0, 53, 75, 42, 61, 12, 54, 70, 11], weight: tensor([0.1122, 0.1772, 0.0870, 0.0830, 0.1467, 0.0091, 0.0361, 0.1209, 0.1517,
        0.0761])
[rfa agg] iter:  0, prev_obj_val: 47.678775787353516, obj_val: 50.9442138671875, abs dis: 3.2654380798339844
[rfa agg] iter: 0, weight: tensor([0.3425, 0.0609, 0.0801, 0.0759, 0.0860, 0.0020, 0.0112, 0.2113, 0.0755,
        0.0546])
[rfa agg] iter:  1, prev_obj_val: 50.9442138671875, obj_val: 52.73896789550781, abs dis: 1.7947540283203125
[rfa agg] iter: 1, weight: tensor([0.2565, 0.0643, 0.1287, 0.1212, 0.0852, 0.0025, 0.0145, 0.1696, 0.0766,
        0.0808])
[rfa agg] iter:  2, prev_obj_val: 52.73896789550781, obj_val: 54.58607864379883, abs dis: 1.8471107482910156
[rfa agg] iter: 2, weight: tensor([0.2044, 0.0629, 0.1628, 0.1527, 0.0812, 0.0027, 0.0157, 0.1481, 0.0737,
        0.0959])
[rfa agg] iter:  3, prev_obj_val: 54.58607864379883, obj_val: 54.58189010620117, abs dis: 0.00418853759765625
[rfa agg] iter: 3, weight: tensor([0.1602, 0.0577, 0.2028, 0.1886, 0.0728, 0.0027, 0.0159, 0.1237, 0.0666,
        0.1090])
[rfa agg] iter:  4, prev_obj_val: 54.58189010620117, obj_val: 56.487518310546875, abs dis: 1.9056282043457031
[rfa agg] iter: 4, weight: tensor([0.1593, 0.0576, 0.2035, 0.1898, 0.0726, 0.0027, 0.0159, 0.1232, 0.0664,
        0.1089])
[rfa agg] iter:  5, prev_obj_val: 56.487518310546875, obj_val: 60.855499267578125, abs dis: 4.36798095703125
[rfa agg] iter: 5, weight: tensor([0.1199, 0.0490, 0.2521, 0.2304, 0.0606, 0.0025, 0.0150, 0.0969, 0.0558,
        0.1179])
[rfa agg] iter:  6, prev_obj_val: 60.855499267578125, obj_val: 63.82651901245117, abs dis: 2.971019744873047
[rfa agg] iter: 6, weight: tensor([0.0604, 0.0299, 0.3538, 0.2904, 0.0357, 0.0018, 0.0113, 0.0519, 0.0332,
        0.1317])
[rfa agg] iter:  7, prev_obj_val: 63.82651901245117, obj_val: 70.9814682006836, abs dis: 7.154949188232422
[rfa agg] iter: 7, weight: tensor([0.0600, 0.0321, 0.3028, 0.2641, 0.0376, 0.0021, 0.0135, 0.0527, 0.0353,
        0.1998])
[rfa agg] iter:  8, prev_obj_val: 70.9814682006836, obj_val: 60.90194320678711, abs dis: 10.079524993896484
[rfa agg] iter: 8, weight: tensor([0.0725, 0.0439, 0.1966, 0.1853, 0.0501, 0.0034, 0.0234, 0.0659, 0.0473,
        0.3117])
[rfa agg] iter:  9, prev_obj_val: 60.90194320678711, obj_val: 67.2620620727539, abs dis: 6.360118865966797
[rfa agg] iter: 9, weight: tensor([0.0632, 0.0314, 0.3219, 0.2931, 0.0374, 0.0019, 0.0119, 0.0544, 0.0349,
        0.1501])
			Update norm = 111.26989376202576 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 320.91881370544434 sec.
Server Epoch:61 choose agents : [85, 95, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 432/1988 (21.7304%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 651/1988 (32.7465%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5048, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 487/1049 (46.4252%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8407, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0557, Accuracy: 312/690 (45.2174%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6934, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 244/1131 (21.5738%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6153, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 371/1956 (18.9673%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0331, Accuracy: 610/1956 (31.1861%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1028, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 237/1071 (22.1289%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 508/1071 (47.4323%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1124, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 285/813 (35.0554%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.9652, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0850, Accuracy: 32/338 (9.4675%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.6199, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0331, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6286, Accuracy: 50/10000 (0.5000%)
time spent on training: 250.95579195022583
[rfa agg] training data poison_ratio: 0.05858190709046455  data num: [1988, 599, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[rfa agg] considering poison per batch poison_fraction: 0.01830684596577017
[rfa agg] init. name: [85, 95, 51, 25, 38, 6, 55, 53, 12, 69], weight: tensor([0.1944, 0.0586, 0.1026, 0.0675, 0.1106, 0.1913, 0.1047, 0.0795, 0.0331,
        0.0577])
[rfa agg] iter:  0, prev_obj_val: 70.31998443603516, obj_val: 72.64917755126953, abs dis: 2.329193115234375
[rfa agg] iter: 0, weight: tensor([0.0484, 0.0231, 0.1968, 0.0302, 0.3659, 0.0514, 0.2043, 0.0484, 0.0089,
        0.0228])
[rfa agg] iter:  1, prev_obj_val: 72.64917755126953, obj_val: 77.81936645507812, abs dis: 5.170188903808594
[rfa agg] iter: 1, weight: tensor([0.0403, 0.0321, 0.2606, 0.0444, 0.1752, 0.0423, 0.2772, 0.0855, 0.0109,
        0.0316])
[rfa agg] iter:  2, prev_obj_val: 77.81936645507812, obj_val: 79.60428619384766, abs dis: 1.7849197387695312
[rfa agg] iter: 2, weight: tensor([0.0482, 0.0555, 0.1710, 0.0822, 0.1338, 0.0503, 0.1761, 0.2111, 0.0168,
        0.0548])
[rfa agg] iter:  3, prev_obj_val: 79.60428619384766, obj_val: 81.4527359008789, abs dis: 1.84844970703125
[rfa agg] iter: 3, weight: tensor([0.0447, 0.0596, 0.1370, 0.0914, 0.1122, 0.0466, 0.1408, 0.2917, 0.0171,
        0.0589])
[rfa agg] iter:  4, prev_obj_val: 81.4527359008789, obj_val: 81.44049835205078, abs dis: 0.012237548828125
[rfa agg] iter: 4, weight: tensor([0.0371, 0.0577, 0.1007, 0.0928, 0.0852, 0.0386, 0.1034, 0.4120, 0.0155,
        0.0571])
[rfa agg] iter:  5, prev_obj_val: 81.44049835205078, obj_val: 83.42433166503906, abs dis: 1.9838333129882812
[rfa agg] iter: 5, weight: tensor([0.0358, 0.0557, 0.0969, 0.0896, 0.0821, 0.0372, 0.0996, 0.4331, 0.0149,
        0.0552])
[rfa agg] iter:  6, prev_obj_val: 83.42433166503906, obj_val: 90.95642852783203, abs dis: 7.532096862792969
[rfa agg] iter: 6, weight: tensor([0.0264, 0.0488, 0.0647, 0.0836, 0.0562, 0.0275, 0.0665, 0.5656, 0.0121,
        0.0485])
[rfa agg] iter:  7, prev_obj_val: 90.95642852783203, obj_val: 88.29996490478516, abs dis: 2.656463623046875
[rfa agg] iter: 7, weight: tensor([0.0332, 0.1203, 0.0645, 0.2961, 0.0590, 0.0344, 0.0661, 0.1830, 0.0208,
        0.1226])
[rfa agg] iter:  8, prev_obj_val: 88.29996490478516, obj_val: 85.79798126220703, abs dis: 2.501983642578125
[rfa agg] iter: 8, weight: tensor([0.0356, 0.1018, 0.0741, 0.2273, 0.0669, 0.0369, 0.0759, 0.2603, 0.0201,
        0.1011])
[rfa agg] iter:  9, prev_obj_val: 85.79798126220703, obj_val: 85.78450775146484, abs dis: 0.0134735107421875
[rfa agg] iter: 9, weight: tensor([0.0337, 0.0763, 0.0757, 0.1450, 0.0671, 0.0350, 0.0775, 0.3968, 0.0171,
        0.0757])
			Update norm = 115.52623315453076 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.92325139045715 sec.
Server Epoch:62 choose agents : [84, 79, 24, 82, 4, 30, 94, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 438/1190 (36.8067%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.1766, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1024, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0881, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 35/312 (11.2179%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0402, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.5009, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.8051, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0632, Accuracy: 323/901 (35.8491%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 378/901 (41.9534%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4371, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0813, Accuracy: 71/486 (14.6091%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.0747, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 622/1662 (37.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8097, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0766, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9431, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0555, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.3471, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0502, Accuracy: 608/2227 (27.3013%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1044/2227 (46.8792%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2620, Accuracy: 131/10000 (1.3100%)
time spent on training: 182.08652710914612
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 197, 312, 500, 901, 486, 1662, 515, 590, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 79, 24, 82, 4, 30, 94, 33, 69, 60], weight: tensor([0.1387, 0.0230, 0.0364, 0.0583, 0.1050, 0.0566, 0.1937, 0.0600, 0.0688,
        0.2596])
[rfa agg] iter:  0, prev_obj_val: 84.427490234375, obj_val: 86.82131958007812, abs dis: 2.393829345703125
[rfa agg] iter: 0, weight: tensor([0.5921, 0.0064, 0.0108, 0.0221, 0.1075, 0.0215, 0.1149, 0.0251, 0.0319,
        0.0678])
[rfa agg] iter:  1, prev_obj_val: 86.82131958007812, obj_val: 88.45123291015625, abs dis: 1.629913330078125
[rfa agg] iter: 1, weight: tensor([0.3648, 0.0095, 0.0163, 0.0348, 0.2550, 0.0338, 0.1154, 0.0402, 0.0526,
        0.0777])
[rfa agg] iter:  2, prev_obj_val: 88.45123291015625, obj_val: 91.86471557617188, abs dis: 3.413482666015625
[rfa agg] iter: 2, weight: tensor([0.2225, 0.0094, 0.0163, 0.0359, 0.4194, 0.0349, 0.0955, 0.0422, 0.0563,
        0.0675])
[rfa agg] iter:  3, prev_obj_val: 91.86471557617188, obj_val: 95.26223754882812, abs dis: 3.39752197265625
[rfa agg] iter: 3, weight: tensor([0.1201, 0.0086, 0.0151, 0.0354, 0.5662, 0.0344, 0.0668, 0.0430, 0.0600,
        0.0503])
[rfa agg] iter:  4, prev_obj_val: 95.26223754882812, obj_val: 95.2395248413086, abs dis: 0.02271270751953125
[rfa agg] iter: 4, weight: tensor([0.1378, 0.0133, 0.0236, 0.0584, 0.3771, 0.0567, 0.0859, 0.0731, 0.1070,
        0.0670])
			Update norm = 124.11511400082385 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.9019937515259 sec.
Server Epoch:63 choose agents : [18, 64, 38, 96, 55, 91, 58, 59, 66, 77].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0730, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5451, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0645, Accuracy: 172/953 (18.0483%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 306/953 (32.1091%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5591, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 505/1131 (44.6508%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7489, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   2, Avg loss: 0.0545, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.4031, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 494/1071 (46.1251%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1764, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0526, Accuracy: 353/1030 (34.2718%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 624/1030 (60.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5116, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.1860, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 441/1089 (40.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.5965, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 243/1402 (17.3324%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 382/1402 (27.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1921, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 578/1340 (43.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7316, Accuracy: 72/10000 (0.7200%)
time spent on training: 247.65241932868958
[rfa agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 311, 1071, 1030, 803, 1089, 1402, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 64, 38, 96, 55, 91, 58, 59, 66, 77], weight: tensor([0.0549, 0.0987, 0.1171, 0.0322, 0.1109, 0.1066, 0.0831, 0.1127, 0.1451,
        0.1387])
[rfa agg] iter:  0, prev_obj_val: 38.15686798095703, obj_val: 40.87074279785156, abs dis: 2.7138748168945312
[rfa agg] iter: 0, weight: tensor([0.0281, 0.2917, 0.0919, 0.0096, 0.1194, 0.1123, 0.1441, 0.0884, 0.0546,
        0.0599])
[rfa agg] iter:  1, prev_obj_val: 40.87074279785156, obj_val: 43.771602630615234, abs dis: 2.900859832763672
[rfa agg] iter: 1, weight: tensor([0.0330, 0.2510, 0.0865, 0.0108, 0.1080, 0.1023, 0.2110, 0.0832, 0.0547,
        0.0595])
[rfa agg] iter:  2, prev_obj_val: 43.771602630615234, obj_val: 43.754180908203125, abs dis: 0.017421722412109375
[rfa agg] iter: 2, weight: tensor([0.0368, 0.1826, 0.0778, 0.0115, 0.0940, 0.0894, 0.3254, 0.0748, 0.0518,
        0.0559])
[rfa agg] iter:  3, prev_obj_val: 43.754180908203125, obj_val: 43.75364303588867, abs dis: 0.000537872314453125
[rfa agg] iter: 3, weight: tensor([0.0358, 0.1742, 0.0755, 0.0111, 0.0914, 0.0867, 0.3479, 0.0727, 0.0503,
        0.0543])
			Update norm = 124.41141112755695 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3066, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.1423969268799 sec.
Server Epoch:64 choose agents : [78, 13, 57, 64, 48, 23, 71, 35, 32, 76].
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   1, Avg loss: 0.0816, Accuracy: 42/416 (10.0962%)
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   2, Avg loss: 0.0443, Accuracy: 187/416 (44.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7905, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 304/1645 (18.4802%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 650/1645 (39.5137%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3489, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0555, Accuracy: 295/1154 (25.5633%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5966, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.5175, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 98/631 (15.5309%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0420, Accuracy: 213/631 (33.7559%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.0698, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0622, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0632, Accuracy: 165/818 (20.1711%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 364/818 (44.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.2477, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0863, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0578, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4432, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0236, Accuracy: 330/735 (44.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.0044, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8852, Accuracy: 50/10000 (0.5000%)
time spent on training: 176.41992497444153
[rfa agg] training data poison_ratio: 0.0  data num: [416, 1645, 1154, 953, 631, 715, 818, 271, 735, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 13, 57, 64, 48, 23, 71, 35, 32, 76], weight: tensor([0.0533, 0.2108, 0.1479, 0.1221, 0.0809, 0.0916, 0.1048, 0.0347, 0.0942,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 48.671443939208984, obj_val: 56.144981384277344, abs dis: 7.473537445068359
[rfa agg] iter: 0, weight: tensor([0.0207, 0.0335, 0.0485, 0.1006, 0.0672, 0.2054, 0.2568, 0.0099, 0.2292,
        0.0282])
[rfa agg] iter:  1, prev_obj_val: 56.144981384277344, obj_val: 64.64387512207031, abs dis: 8.498893737792969
[rfa agg] iter: 1, weight: tensor([0.0418, 0.0380, 0.0484, 0.0749, 0.2881, 0.1532, 0.1140, 0.0174, 0.1597,
        0.0646])
[rfa agg] iter:  2, prev_obj_val: 64.64387512207031, obj_val: 61.55409240722656, abs dis: 3.08978271484375
[rfa agg] iter: 2, weight: tensor([0.0870, 0.0424, 0.0505, 0.0692, 0.2520, 0.1013, 0.0885, 0.0289, 0.1048,
        0.1754])
[rfa agg] iter:  3, prev_obj_val: 61.55409240722656, obj_val: 67.80362701416016, abs dis: 6.249534606933594
[rfa agg] iter: 3, weight: tensor([0.0621, 0.0381, 0.0463, 0.0656, 0.3528, 0.1041, 0.0877, 0.0226, 0.1081,
        0.1127])
[rfa agg] iter:  4, prev_obj_val: 67.80362701416016, obj_val: 64.6353530883789, abs dis: 3.16827392578125
[rfa agg] iter: 4, weight: tensor([0.1124, 0.0409, 0.0478, 0.0635, 0.1773, 0.0868, 0.0784, 0.0327, 0.0898,
        0.2703])
[rfa agg] iter:  5, prev_obj_val: 64.6353530883789, obj_val: 64.62810516357422, abs dis: 0.0072479248046875
[rfa agg] iter: 5, weight: tensor([0.0877, 0.0421, 0.0501, 0.0686, 0.2443, 0.1001, 0.0878, 0.0289, 0.1038,
        0.1865])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3086, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.3164, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.37290382385254 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 85, 30, 66, 73, 82, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 382/1581 (24.1619%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 623/1581 (39.4054%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5787, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0531, Accuracy: 378/1129 (33.4810%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3186, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0847, Accuracy: 30/338 (8.8757%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.5893, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0570, Accuracy: 337/1154 (29.2028%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 484/1154 (41.9411%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6190, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 445/1988 (22.3843%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 646/1988 (32.4950%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7723, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0812, Accuracy: 73/486 (15.0206%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.2081, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5926, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0655, Accuracy: 170/938 (18.1237%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 345/938 (36.7804%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5395, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8531, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0528, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.9243, Accuracy: 49/10000 (0.4900%)
time spent on training: 242.34795022010803
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1988, 486, 1402, 938, 500, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 37, 12, 15, 85, 30, 66, 73, 82, 11], weight: tensor([0.1546, 0.1104, 0.0330, 0.1128, 0.1944, 0.0475, 0.1371, 0.0917, 0.0489,
        0.0696])
[rfa agg] iter:  0, prev_obj_val: 61.69479751586914, obj_val: 64.935791015625, abs dis: 3.2409934997558594
[rfa agg] iter: 0, weight: tensor([0.0738, 0.3288, 0.0103, 0.2242, 0.0483, 0.0180, 0.1074, 0.1253, 0.0185,
        0.0453])
[rfa agg] iter:  1, prev_obj_val: 64.935791015625, obj_val: 66.75202178955078, abs dis: 1.8162307739257812
[rfa agg] iter: 1, weight: tensor([0.0741, 0.2622, 0.0129, 0.1733, 0.0513, 0.0229, 0.1005, 0.2167, 0.0235,
        0.0627])
[rfa agg] iter:  2, prev_obj_val: 66.75202178955078, obj_val: 68.64663696289062, abs dis: 1.8946151733398438
[rfa agg] iter: 2, weight: tensor([0.0703, 0.2063, 0.0136, 0.1473, 0.0499, 0.0244, 0.0928, 0.2999, 0.0251,
        0.0706])
[rfa agg] iter:  3, prev_obj_val: 68.64663696289062, obj_val: 70.69302368164062, abs dis: 2.04638671875
[rfa agg] iter: 3, weight: tensor([0.0608, 0.1542, 0.0130, 0.1166, 0.0441, 0.0237, 0.0783, 0.4115, 0.0244,
        0.0733])
[rfa agg] iter:  4, prev_obj_val: 70.69302368164062, obj_val: 75.69068908691406, abs dis: 4.9976654052734375
[rfa agg] iter: 4, weight: tensor([0.0491, 0.1108, 0.0117, 0.0873, 0.0364, 0.0216, 0.0620, 0.5267, 0.0222,
        0.0721])
[rfa agg] iter:  5, prev_obj_val: 75.69068908691406, obj_val: 70.70184326171875, abs dis: 4.9888458251953125
[rfa agg] iter: 5, weight: tensor([0.0616, 0.1170, 0.0181, 0.0972, 0.0475, 0.0346, 0.0749, 0.3700, 0.0357,
        0.1433])
[rfa agg] iter:  6, prev_obj_val: 70.70184326171875, obj_val: 73.08617401123047, abs dis: 2.3843307495117188
[rfa agg] iter: 6, weight: tensor([0.0501, 0.1127, 0.0119, 0.0890, 0.0371, 0.0220, 0.0632, 0.5175, 0.0227,
        0.0738])
[rfa agg] iter:  7, prev_obj_val: 73.08617401123047, obj_val: 75.68167877197266, abs dis: 2.5955047607421875
[rfa agg] iter: 7, weight: tensor([0.0523, 0.1072, 0.0138, 0.0871, 0.0396, 0.0260, 0.0647, 0.4872, 0.0268,
        0.0953])
[rfa agg] iter:  8, prev_obj_val: 75.68167877197266, obj_val: 70.70289611816406, abs dis: 4.978782653808594
[rfa agg] iter: 8, weight: tensor([0.0619, 0.1175, 0.0182, 0.0976, 0.0476, 0.0348, 0.0752, 0.3668, 0.0359,
        0.1445])
[rfa agg] iter:  9, prev_obj_val: 70.70289611816406, obj_val: 73.08610534667969, abs dis: 2.383209228515625
[rfa agg] iter: 9, weight: tensor([0.0502, 0.1130, 0.0119, 0.0892, 0.0372, 0.0221, 0.0633, 0.5162, 0.0227,
        0.0740])
			Update norm = 132.57833032541555 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3086, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.3164, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.73196148872375 sec.
Server Epoch:66 choose agents : [90, 62, 96, 18, 82, 94, 92, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 318/677 (46.9719%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8240, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 143/568 (25.1761%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.9735, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   1, Avg loss: 0.0798, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   2, Avg loss: 0.0556, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.4155, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0733, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3483, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.8631, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9371, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 436/1715 (25.4227%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.0312, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 163/938 (17.3774%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 331/938 (35.2878%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3522, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3072, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0626, Accuracy: 181/818 (22.1271%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0298, Accuracy: 355/818 (43.3985%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3955, Accuracy: 65/10000 (0.6500%)
time spent on training: 184.38433647155762
[rfa agg] training data poison_ratio: 0.0  data num: [677, 568, 311, 530, 500, 1662, 1715, 938, 891, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 62, 96, 18, 82, 94, 92, 73, 7, 71], weight: tensor([0.0786, 0.0660, 0.0361, 0.0616, 0.0581, 0.1930, 0.1992, 0.1089, 0.1035,
        0.0950])
[rfa agg] iter:  0, prev_obj_val: 60.895294189453125, obj_val: 64.14502716064453, abs dis: 3.2497329711914062
[rfa agg] iter: 0, weight: tensor([0.0542, 0.0305, 0.0100, 0.0285, 0.0231, 0.0488, 0.0462, 0.4191, 0.2134,
        0.1262])
[rfa agg] iter:  1, prev_obj_val: 64.14502716064453, obj_val: 67.51066589355469, abs dis: 3.3656387329101562
[rfa agg] iter: 1, weight: tensor([0.1396, 0.0544, 0.0140, 0.0508, 0.0375, 0.0419, 0.0402, 0.1258, 0.1792,
        0.3168])
[rfa agg] iter:  2, prev_obj_val: 67.51066589355469, obj_val: 71.7137680053711, abs dis: 4.203102111816406
[rfa agg] iter: 2, weight: tensor([0.3088, 0.0780, 0.0167, 0.0729, 0.0497, 0.0404, 0.0390, 0.0928, 0.1193,
        0.1824])
[rfa agg] iter:  3, prev_obj_val: 71.7137680053711, obj_val: 74.16969299316406, abs dis: 2.4559249877929688
[rfa agg] iter: 3, weight: tensor([0.3414, 0.1210, 0.0191, 0.1139, 0.0668, 0.0368, 0.0356, 0.0708, 0.0848,
        0.1096])
[rfa agg] iter:  4, prev_obj_val: 74.16969299316406, obj_val: 76.70414733886719, abs dis: 2.534454345703125
[rfa agg] iter: 4, weight: tensor([0.2247, 0.1792, 0.0221, 0.1701, 0.0870, 0.0376, 0.0365, 0.0673, 0.0787,
        0.0968])
[rfa agg] iter:  5, prev_obj_val: 76.70414733886719, obj_val: 86.48768615722656, abs dis: 9.783538818359375
[rfa agg] iter: 5, weight: tensor([0.1346, 0.2523, 0.0214, 0.2428, 0.0991, 0.0317, 0.0309, 0.0534, 0.0612,
        0.0727])
[rfa agg] iter:  6, prev_obj_val: 86.48768615722656, obj_val: 86.44798278808594, abs dis: 0.039703369140625
[rfa agg] iter: 6, weight: tensor([0.0751, 0.1757, 0.0337, 0.1651, 0.3386, 0.0313, 0.0305, 0.0452, 0.0497,
        0.0550])
[rfa agg] iter:  7, prev_obj_val: 86.44798278808594, obj_val: 86.44367980957031, abs dis: 0.004302978515625
[rfa agg] iter: 7, weight: tensor([0.0665, 0.1556, 0.0302, 0.1448, 0.4147, 0.0278, 0.0272, 0.0402, 0.0442,
        0.0489])
[rfa agg] iter:  8, prev_obj_val: 86.44367980957031, obj_val: 82.82038879394531, abs dis: 3.623291015625
[rfa agg] iter: 8, weight: tensor([0.0631, 0.1473, 0.0287, 0.1366, 0.4455, 0.0264, 0.0258, 0.0382, 0.0420,
        0.0465])
[rfa agg] iter:  9, prev_obj_val: 82.82038879394531, obj_val: 86.45834350585938, abs dis: 3.6379547119140625
[rfa agg] iter: 9, weight: tensor([0.0758, 0.2385, 0.0251, 0.2185, 0.2477, 0.0275, 0.0268, 0.0416, 0.0463,
        0.0521])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.2119300365448 sec.
Server Epoch:67 choose agents : [44, 84, 98, 56, 6, 75, 64, 39, 14, 78].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 376/1750 (21.4857%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 656/1750 (37.4857%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.3643, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 468/1190 (39.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.5195, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 20/373 (5.3619%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.6199, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3433, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 674/1956 (34.4581%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4480, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.0983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8996, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 489/1013 (48.2725%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6989, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8248, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0801, Accuracy: 51/416 (12.2596%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8626, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.87213945388794
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1190, 373, 186, 1956, 776, 953, 1013, 1013, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 84, 98, 56, 6, 75, 64, 39, 14, 78], weight: tensor([0.1818, 0.1236, 0.0387, 0.0193, 0.2032, 0.0806, 0.0990, 0.1052, 0.1052,
        0.0432])
[rfa agg] iter:  0, prev_obj_val: 63.06407165527344, obj_val: 64.49784088134766, abs dis: 1.4337692260742188
[rfa agg] iter: 0, weight: tensor([0.0653, 0.3277, 0.0116, 0.0046, 0.0562, 0.0572, 0.1154, 0.1749, 0.1731,
        0.0141])
[rfa agg] iter:  1, prev_obj_val: 64.49784088134766, obj_val: 70.20172882080078, abs dis: 5.703887939453125
[rfa agg] iter: 1, weight: tensor([0.0344, 0.0915, 0.0088, 0.0034, 0.0308, 0.0586, 0.1799, 0.2913, 0.2905,
        0.0109])
[rfa agg] iter:  2, prev_obj_val: 70.20172882080078, obj_val: 72.86111450195312, abs dis: 2.6593856811523438
[rfa agg] iter: 2, weight: tensor([0.0381, 0.0762, 0.0129, 0.0047, 0.0348, 0.1314, 0.3269, 0.1803, 0.1785,
        0.0162])
[rfa agg] iter:  3, prev_obj_val: 72.86111450195312, obj_val: 70.15750885009766, abs dis: 2.7036056518554688
[rfa agg] iter: 3, weight: tensor([0.0420, 0.0787, 0.0156, 0.0056, 0.0387, 0.2022, 0.2802, 0.1596, 0.1575,
        0.0199])
[rfa agg] iter:  4, prev_obj_val: 70.15750885009766, obj_val: 70.14556121826172, abs dis: 0.0119476318359375
[rfa agg] iter: 4, weight: tensor([0.0370, 0.0740, 0.0125, 0.0046, 0.0338, 0.1325, 0.3490, 0.1728, 0.1680,
        0.0158])
[rfa agg] iter:  5, prev_obj_val: 70.14556121826172, obj_val: 70.1452407836914, abs dis: 0.0003204345703125
[rfa agg] iter: 5, weight: tensor([0.0363, 0.0727, 0.0123, 0.0045, 0.0332, 0.1275, 0.3635, 0.1692, 0.1653,
        0.0155])
			Update norm = 132.08171003208582 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 338.82989382743835 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 84, 9, 17, 88, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 415/1949 (21.2930%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2452, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.5536, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0589, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 491/1089 (45.0872%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.9363, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 397/1750 (22.6857%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 673/1750 (38.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7171, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.1430, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 344/1275 (26.9804%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 668/1275 (52.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.3620, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 366/1574 (23.2529%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2358, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0764, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2869, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0524, Accuracy: 325/636 (51.1006%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0293, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.5699, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 405/888 (45.6081%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3778, Accuracy: 51/10000 (0.5100%)
time spent on training: 221.56122136116028
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1190, 1275, 1574, 603, 636, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 24, 59, 44, 84, 9, 17, 88, 52, 63], weight: tensor([0.1730, 0.0277, 0.0967, 0.1553, 0.1056, 0.1132, 0.1397, 0.0535, 0.0565,
        0.0788])
[rfa agg] iter:  0, prev_obj_val: 57.440128326416016, obj_val: 61.51010513305664, abs dis: 4.069976806640625
[rfa agg] iter: 0, weight: tensor([0.0444, 0.0057, 0.1470, 0.0538, 0.2826, 0.3157, 0.0744, 0.0167, 0.0176,
        0.0421])
[rfa agg] iter:  1, prev_obj_val: 61.51010513305664, obj_val: 65.80399322509766, abs dis: 4.293888092041016
[rfa agg] iter: 1, weight: tensor([0.0444, 0.0071, 0.2712, 0.0517, 0.2721, 0.1770, 0.0663, 0.0223, 0.0235,
        0.0644])
[rfa agg] iter:  2, prev_obj_val: 65.80399322509766, obj_val: 65.7962875366211, abs dis: 0.0077056884765625
[rfa agg] iter: 2, weight: tensor([0.0514, 0.0096, 0.2841, 0.0586, 0.2034, 0.1503, 0.0724, 0.0317, 0.0334,
        0.1050])
[rfa agg] iter:  3, prev_obj_val: 65.7962875366211, obj_val: 68.19210815429688, abs dis: 2.3958206176757812
[rfa agg] iter: 3, weight: tensor([0.0513, 0.0096, 0.2874, 0.0586, 0.2006, 0.1499, 0.0723, 0.0317, 0.0334,
        0.1052])
[rfa agg] iter:  4, prev_obj_val: 68.19210815429688, obj_val: 68.18827056884766, abs dis: 0.00383758544921875
[rfa agg] iter: 4, weight: tensor([0.0552, 0.0111, 0.2505, 0.0624, 0.1842, 0.1448, 0.0758, 0.0379, 0.0399,
        0.1382])
[rfa agg] iter:  5, prev_obj_val: 68.18827056884766, obj_val: 70.63980865478516, abs dis: 2.4515380859375
[rfa agg] iter: 5, weight: tensor([0.0553, 0.0112, 0.2474, 0.0625, 0.1847, 0.1454, 0.0760, 0.0381, 0.0401,
        0.1394])
[rfa agg] iter:  6, prev_obj_val: 70.63980865478516, obj_val: 70.6362075805664, abs dis: 0.00360107421875
[rfa agg] iter: 6, weight: tensor([0.0571, 0.0125, 0.2135, 0.0641, 0.1675, 0.1370, 0.0767, 0.0440, 0.0463,
        0.1813])
			Update norm = 145.31475132664613 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.2108063697815 sec.
Server Epoch:69 choose agents : [21, 31, 44, 90, 70, 81, 84, 5, 69, 76].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 361/1949 (18.5223%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 602/1949 (30.8876%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4962, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0742, Accuracy: 90/460 (19.5652%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0351, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.2393, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0602, Accuracy: 381/1750 (21.7714%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 665/1750 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7339, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0549, Accuracy: 324/677 (47.8582%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8489, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 629/1418 (44.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6014, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   1, Avg loss: 0.0686, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   2, Avg loss: 0.0372, Accuracy: 293/774 (37.8553%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5130, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   1, Avg loss: 0.0611, Accuracy: 322/1190 (27.0588%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1339, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 387/1628 (23.7715%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 771/1628 (47.3587%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.9082, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0563, Accuracy: 299/590 (50.6780%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.5288, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   1, Avg loss: 0.0838, Accuracy: 55/466 (11.8026%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0424, Accuracy: 50/10000 (0.5000%)
time spent on training: 240.41200590133667
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 677, 1418, 774, 1190, 1628, 590, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 31, 44, 90, 70, 81, 84, 5, 69, 76], weight: tensor([0.1788, 0.0422, 0.1605, 0.0621, 0.1301, 0.0710, 0.1092, 0.1493, 0.0541,
        0.0427])
[rfa agg] iter:  0, prev_obj_val: 68.5130386352539, obj_val: 71.87421417236328, abs dis: 3.361175537109375
[rfa agg] iter: 0, weight: tensor([0.0639, 0.0165, 0.0763, 0.0333, 0.1360, 0.0504, 0.4903, 0.0908, 0.0258,
        0.0167])
[rfa agg] iter:  1, prev_obj_val: 71.87421417236328, obj_val: 73.84849548339844, abs dis: 1.9742813110351562
[rfa agg] iter: 1, weight: tensor([0.0662, 0.0203, 0.0770, 0.0426, 0.1231, 0.0675, 0.4611, 0.0892, 0.0325,
        0.0206])
[rfa agg] iter:  2, prev_obj_val: 73.84849548339844, obj_val: 71.8780746459961, abs dis: 1.9704208374023438
[rfa agg] iter: 2, weight: tensor([0.0742, 0.0249, 0.0854, 0.0533, 0.1306, 0.0869, 0.3815, 0.0978, 0.0403,
        0.0252])
[rfa agg] iter:  3, prev_obj_val: 71.8780746459961, obj_val: 73.846923828125, abs dis: 1.9688491821289062
[rfa agg] iter: 3, weight: tensor([0.0676, 0.0208, 0.0787, 0.0435, 0.1259, 0.0691, 0.4490, 0.0912, 0.0332,
        0.0210])
[rfa agg] iter:  4, prev_obj_val: 73.846923828125, obj_val: 71.87816619873047, abs dis: 1.9687576293945312
[rfa agg] iter: 4, weight: tensor([0.0742, 0.0249, 0.0855, 0.0534, 0.1308, 0.0871, 0.3808, 0.0979, 0.0403,
        0.0252])
[rfa agg] iter:  5, prev_obj_val: 71.87816619873047, obj_val: 73.84690856933594, abs dis: 1.9687423706054688
[rfa agg] iter: 5, weight: tensor([0.0676, 0.0208, 0.0787, 0.0435, 0.1259, 0.0691, 0.4490, 0.0912, 0.0332,
        0.0210])
[rfa agg] iter:  6, prev_obj_val: 73.84690856933594, obj_val: 71.87816619873047, abs dis: 1.9687423706054688
[rfa agg] iter: 6, weight: tensor([0.0742, 0.0249, 0.0855, 0.0534, 0.1308, 0.0871, 0.3807, 0.0979, 0.0403,
        0.0252])
[rfa agg] iter:  7, prev_obj_val: 71.87816619873047, obj_val: 73.84690856933594, abs dis: 1.9687423706054688
[rfa agg] iter: 7, weight: tensor([0.0676, 0.0208, 0.0787, 0.0435, 0.1259, 0.0691, 0.4490, 0.0912, 0.0332,
        0.0210])
[rfa agg] iter:  8, prev_obj_val: 73.84690856933594, obj_val: 71.87816619873047, abs dis: 1.9687423706054688
[rfa agg] iter: 8, weight: tensor([0.0742, 0.0249, 0.0855, 0.0534, 0.1308, 0.0871, 0.3807, 0.0979, 0.0403,
        0.0252])
[rfa agg] iter:  9, prev_obj_val: 71.87816619873047, obj_val: 73.84690856933594, abs dis: 1.9687423706054688
[rfa agg] iter: 9, weight: tensor([0.0676, 0.0208, 0.0787, 0.0435, 0.1259, 0.0691, 0.4490, 0.0912, 0.0332,
        0.0210])
			Update norm = 158.59193040828086 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.726309299469 sec.
Server Epoch:70 choose agents : [7, 75, 77, 74, 16, 9, 19, 99, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 461/891 (51.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.5395, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4172, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 330/1340 (24.6269%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 527/1340 (39.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.0955, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 463/1552 (29.8325%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 749/1552 (48.2603%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.3660, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 281/708 (39.6893%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8965, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 365/1275 (28.6275%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 683/1275 (53.5686%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.5452, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0474, Accuracy: 398/1036 (38.4170%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0255, Accuracy: 623/1036 (60.1351%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.5749, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 170/773 (21.9922%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 377/773 (48.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4829, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0698, Accuracy: 107/631 (16.9572%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 260/1402 (18.5449%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4243, Accuracy: 78/10000 (0.7800%)
time spent on training: 221.54762625694275
[rfa agg] training data poison_ratio: 0.14946070878274267  data num: [891, 776, 1340, 1552, 708, 1275, 1036, 773, 631, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.046706471494607084
[rfa agg] init. name: [7, 75, 77, 74, 16, 9, 19, 99, 48, 66], weight: tensor([0.0858, 0.0747, 0.1290, 0.1495, 0.0682, 0.1228, 0.0998, 0.0744, 0.0608,
        0.1350])
[rfa agg] iter:  0, prev_obj_val: 44.882728576660156, obj_val: 49.63300323486328, abs dis: 4.750274658203125
[rfa agg] iter: 0, weight: tensor([0.2294, 0.1182, 0.0714, 0.0499, 0.0739, 0.0811, 0.1562, 0.1155, 0.0403,
        0.0641])
[rfa agg] iter:  1, prev_obj_val: 49.63300323486328, obj_val: 61.825775146484375, abs dis: 12.192771911621094
[rfa agg] iter: 1, weight: tensor([0.2458, 0.2153, 0.0399, 0.0303, 0.0956, 0.0437, 0.0653, 0.1876, 0.0397,
        0.0369])
[rfa agg] iter:  2, prev_obj_val: 61.825775146484375, obj_val: 65.59276580810547, abs dis: 3.7669906616210938
[rfa agg] iter: 2, weight: tensor([0.1082, 0.1512, 0.0439, 0.0359, 0.2517, 0.0466, 0.0583, 0.1444, 0.1183,
        0.0416])
[rfa agg] iter:  3, prev_obj_val: 65.59276580810547, obj_val: 65.58932495117188, abs dis: 0.00344085693359375
[rfa agg] iter: 3, weight: tensor([0.1014, 0.1300, 0.0469, 0.0388, 0.2160, 0.0495, 0.0602, 0.1266, 0.1861,
        0.0446])
			Update norm = 101.44106201386103 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 331.95886611938477 sec.
Server Epoch:71 choose agents : [49, 6, 75, 91, 83, 24, 33, 79, 18, 85].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0782, Accuracy: 42/440 (9.5455%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.7429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 420/1956 (21.4724%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 652/1956 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4886, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2997, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 352/1030 (34.1748%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 603/1030 (58.5437%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6524, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 444/1953 (22.7343%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 813/1953 (41.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0422, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5740, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0752, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0550, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.2142, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1014, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3568, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0711, Accuracy: 135/530 (25.4717%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.8199, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 422/1988 (21.2274%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 642/1988 (32.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2079, Accuracy: 78/10000 (0.7800%)
time spent on training: 231.12990379333496
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1956, 776, 1030, 1953, 312, 515, 197, 530, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 6, 75, 91, 83, 24, 33, 79, 18, 85], weight: tensor([0.0454, 0.2017, 0.0800, 0.1062, 0.2014, 0.0322, 0.0531, 0.0203, 0.0547,
        0.2050])
[rfa agg] iter:  0, prev_obj_val: 91.14666748046875, obj_val: 92.10797882080078, abs dis: 0.9613113403320312
[rfa agg] iter: 0, weight: tensor([0.0295, 0.1831, 0.0907, 0.2340, 0.1827, 0.0183, 0.0403, 0.0109, 0.0414,
        0.1692])
[rfa agg] iter:  1, prev_obj_val: 92.10797882080078, obj_val: 93.08392333984375, abs dis: 0.9759445190429688
[rfa agg] iter: 1, weight: tensor([0.0300, 0.1709, 0.0947, 0.2623, 0.1705, 0.0185, 0.0412, 0.0110, 0.0424,
        0.1586])
[rfa agg] iter:  2, prev_obj_val: 93.08392333984375, obj_val: 94.06517791748047, abs dis: 0.9812545776367188
[rfa agg] iter: 2, weight: tensor([0.0302, 0.1582, 0.0982, 0.2942, 0.1578, 0.0185, 0.0417, 0.0110, 0.0429,
        0.1473])
[rfa agg] iter:  3, prev_obj_val: 94.06517791748047, obj_val: 96.06086730957031, abs dis: 1.9956893920898438
[rfa agg] iter: 3, weight: tensor([0.0299, 0.1443, 0.1008, 0.3325, 0.1440, 0.0183, 0.0417, 0.0108, 0.0429,
        0.1349])
[rfa agg] iter:  4, prev_obj_val: 96.06086730957031, obj_val: 99.45352172851562, abs dis: 3.3926544189453125
[rfa agg] iter: 4, weight: tensor([0.0275, 0.1123, 0.1003, 0.4370, 0.1120, 0.0166, 0.0389, 0.0097, 0.0400,
        0.1056])
[rfa agg] iter:  5, prev_obj_val: 99.45352172851562, obj_val: 101.00967407226562, abs dis: 1.55615234375
[rfa agg] iter: 5, weight: tensor([0.0186, 0.0591, 0.0802, 0.6545, 0.0590, 0.0110, 0.0272, 0.0064, 0.0280,
        0.0561])
			Update norm = 149.7494000405344 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.16058111190796 sec.
Server Epoch:72 choose agents : [31, 17, 64, 92, 34, 20, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0740, Accuracy: 98/460 (21.3043%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.2664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 393/1574 (24.9682%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 682/1574 (43.3291%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.1436, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8232, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 430/1715 (25.0729%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7633, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 395/1427 (27.6804%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0340, Accuracy: 568/1427 (39.8038%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.9147, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 341/807 (42.2553%)
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.1132, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0618, Accuracy: 334/901 (37.0699%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 382/901 (42.3973%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.2813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 412/888 (46.3964%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9561, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 532/1470 (36.1905%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 829/1470 (56.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.5117, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 390/1036 (37.6448%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 699/1036 (67.4710%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6431, Accuracy: 63/10000 (0.6300%)
time spent on training: 237.68589735031128
[rfa agg] training data poison_ratio: 0.07185468791737155  data num: [460, 1574, 953, 1715, 1427, 807, 901, 888, 1470, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.02245458997417861
[rfa agg] init. name: [31, 17, 64, 92, 34, 20, 4, 63, 22, 19], weight: tensor([0.0410, 0.1401, 0.0849, 0.1527, 0.1271, 0.0719, 0.0802, 0.0791, 0.1309,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 48.4493408203125, obj_val: 50.8033561706543, abs dis: 2.354015350341797
[rfa agg] iter: 0, weight: tensor([0.0165, 0.0803, 0.1116, 0.0683, 0.1013, 0.0574, 0.1043, 0.0783, 0.1040,
        0.2779])
[rfa agg] iter:  1, prev_obj_val: 50.8033561706543, obj_val: 55.389434814453125, abs dis: 4.586078643798828
[rfa agg] iter: 1, weight: tensor([0.0145, 0.0495, 0.1566, 0.0438, 0.0586, 0.0602, 0.1417, 0.0906, 0.0602,
        0.3243])
[rfa agg] iter:  2, prev_obj_val: 55.389434814453125, obj_val: 67.25241088867188, abs dis: 11.86297607421875
[rfa agg] iter: 2, weight: tensor([0.0135, 0.0322, 0.3061, 0.0293, 0.0364, 0.0757, 0.2291, 0.1388, 0.0375,
        0.1014])
[rfa agg] iter:  3, prev_obj_val: 67.25241088867188, obj_val: 70.94589233398438, abs dis: 3.6934814453125
[rfa agg] iter: 3, weight: tensor([0.0268, 0.0384, 0.1352, 0.0359, 0.0417, 0.2773, 0.1246, 0.2028, 0.0429,
        0.0744])
[rfa agg] iter:  4, prev_obj_val: 70.94589233398438, obj_val: 60.52044677734375, abs dis: 10.425445556640625
[rfa agg] iter: 4, weight: tensor([0.0330, 0.0410, 0.1200, 0.0385, 0.0442, 0.3185, 0.1120, 0.1737, 0.0455,
        0.0736])
[rfa agg] iter:  5, prev_obj_val: 60.52044677734375, obj_val: 67.1887435913086, abs dis: 6.668296813964844
[rfa agg] iter: 5, weight: tensor([0.0176, 0.0329, 0.1799, 0.0304, 0.0364, 0.1584, 0.1614, 0.2695, 0.0374,
        0.0762])
[rfa agg] iter:  6, prev_obj_val: 67.1887435913086, obj_val: 74.90103912353516, abs dis: 7.7122955322265625
[rfa agg] iter: 6, weight: tensor([0.0258, 0.0369, 0.1281, 0.0345, 0.0401, 0.2952, 0.1185, 0.2083, 0.0413,
        0.0714])
[rfa agg] iter:  7, prev_obj_val: 74.90103912353516, obj_val: 63.67354965209961, abs dis: 11.227489471435547
[rfa agg] iter: 7, weight: tensor([0.0452, 0.0481, 0.1233, 0.0455, 0.0515, 0.2705, 0.1155, 0.1662, 0.0530,
        0.0812])
[rfa agg] iter:  8, prev_obj_val: 63.67354965209961, obj_val: 70.95255279541016, abs dis: 7.279003143310547
[rfa agg] iter: 8, weight: tensor([0.0208, 0.0341, 0.1447, 0.0317, 0.0374, 0.2435, 0.1326, 0.2449, 0.0385,
        0.0717])
[rfa agg] iter:  9, prev_obj_val: 70.95255279541016, obj_val: 60.516719818115234, abs dis: 10.435832977294922
[rfa agg] iter: 9, weight: tensor([0.0333, 0.0413, 0.1211, 0.0389, 0.0446, 0.3108, 0.1130, 0.1769, 0.0458,
        0.0743])
			Update norm = 127.6393654684459 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.0606257915497 sec.
Server Epoch:73 choose agents : [27, 74, 34, 98, 4, 72, 82, 12, 59, 89].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 451/1587 (28.4184%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 645/1587 (40.6427%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.0519, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 499/1552 (32.1521%)
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 796/1552 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.7764, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 569/1427 (39.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.0439, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 19/373 (5.0938%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.6278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0609, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 398/901 (44.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2106, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 264/1241 (21.2732%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 418/1241 (33.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3183, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   1, Avg loss: 0.0740, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.8808, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0851, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0462, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.6788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 290/1089 (26.6299%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 453/1089 (41.5978%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3891, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   1, Avg loss: 0.0616, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4601, Accuracy: 50/10000 (0.5000%)
time spent on training: 254.74065947532654
[rfa agg] training data poison_ratio: 0.1567043618739903  data num: [1587, 1552, 1427, 373, 901, 1241, 500, 338, 1089, 896]
[rfa agg] considering poison per batch poison_fraction: 0.04897011308562197
[rfa agg] init. name: [27, 74, 34, 98, 4, 72, 82, 12, 59, 89], weight: tensor([0.1602, 0.1567, 0.1441, 0.0377, 0.0910, 0.1253, 0.0505, 0.0341, 0.1100,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 52.57170104980469, obj_val: 56.11384963989258, abs dis: 3.5421485900878906
[rfa agg] iter: 0, weight: tensor([0.0730, 0.0713, 0.0854, 0.0139, 0.2129, 0.1358, 0.0230, 0.0126, 0.2379,
        0.1341])
[rfa agg] iter:  1, prev_obj_val: 56.11384963989258, obj_val: 60.492549896240234, abs dis: 4.378700256347656
[rfa agg] iter: 1, weight: tensor([0.0561, 0.0548, 0.0637, 0.0132, 0.3692, 0.0916, 0.0224, 0.0120, 0.1393,
        0.1778])
[rfa agg] iter:  2, prev_obj_val: 60.492549896240234, obj_val: 58.0814323425293, abs dis: 2.4111175537109375
[rfa agg] iter: 2, weight: tensor([0.0444, 0.0433, 0.0491, 0.0129, 0.3703, 0.0657, 0.0225, 0.0117, 0.0883,
        0.2918])
[rfa agg] iter:  3, prev_obj_val: 58.0814323425293, obj_val: 60.485355377197266, abs dis: 2.4039230346679688
[rfa agg] iter: 3, weight: tensor([0.0429, 0.0419, 0.0480, 0.0112, 0.4635, 0.0663, 0.0193, 0.0102, 0.0930,
        0.2037])
[rfa agg] iter:  4, prev_obj_val: 60.485355377197266, obj_val: 60.46950149536133, abs dis: 0.0158538818359375
[rfa agg] iter: 4, weight: tensor([0.0431, 0.0421, 0.0477, 0.0125, 0.3869, 0.0637, 0.0219, 0.0113, 0.0854,
        0.2855])
[rfa agg] iter:  5, prev_obj_val: 60.46950149536133, obj_val: 60.46792221069336, abs dis: 0.00157928466796875
[rfa agg] iter: 5, weight: tensor([0.0432, 0.0422, 0.0479, 0.0125, 0.3608, 0.0640, 0.0220, 0.0114, 0.0856,
        0.3104])
[rfa agg] iter:  6, prev_obj_val: 60.46792221069336, obj_val: 60.46774673461914, abs dis: 0.00017547607421875
[rfa agg] iter: 6, weight: tensor([0.0433, 0.0423, 0.0479, 0.0126, 0.3523, 0.0640, 0.0220, 0.0114, 0.0857,
        0.3186])
			Update norm = 132.04781331017944 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.5743520259857 sec.
Server Epoch:74 choose agents : [9, 38, 74, 63, 50, 44, 1, 93, 94, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0503, Accuracy: 348/1275 (27.2941%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 676/1275 (53.0196%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.5850, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0624, Accuracy: 242/1131 (21.3970%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 482/1131 (42.6172%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7031, Accuracy: 82/10000 (0.8200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 453/1552 (29.1881%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 745/1552 (48.0026%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.2677, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 407/888 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.0816, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0639, Accuracy: 156/809 (19.2831%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 342/809 (42.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0042, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 401/1750 (22.9143%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 686/1750 (39.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9303, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0577, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 573/928 (61.7457%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8300, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1486, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 338/1662 (20.3369%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 581/1662 (34.9579%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8866, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.3904, Accuracy: 52/10000 (0.5200%)
time spent on training: 250.49657440185547
[rfa agg] training data poison_ratio: 0.12366533864541833  data num: [1275, 1131, 1552, 888, 809, 1750, 928, 1742, 1662, 813]
[rfa agg] considering poison per batch poison_fraction: 0.03864541832669323
[rfa agg] init. name: [9, 38, 74, 63, 50, 44, 1, 93, 94, 53], weight: tensor([0.1016, 0.0901, 0.1237, 0.0708, 0.0645, 0.1394, 0.0739, 0.1388, 0.1324,
        0.0648])
[rfa agg] iter:  0, prev_obj_val: 52.839168548583984, obj_val: 54.016685485839844, abs dis: 1.1775169372558594
[rfa agg] iter: 0, weight: tensor([0.2870, 0.2523, 0.0759, 0.0525, 0.0399, 0.0576, 0.0671, 0.0574, 0.0702,
        0.0400])
[rfa agg] iter:  1, prev_obj_val: 54.016685485839844, obj_val: 57.19205093383789, abs dis: 3.175365447998047
[rfa agg] iter: 1, weight: tensor([0.2146, 0.3513, 0.0654, 0.0542, 0.0405, 0.0509, 0.0708, 0.0507, 0.0611,
        0.0406])
[rfa agg] iter:  2, prev_obj_val: 57.19205093383789, obj_val: 63.22718048095703, abs dis: 6.035129547119141
[rfa agg] iter: 2, weight: tensor([0.1369, 0.3921, 0.0575, 0.0699, 0.0499, 0.0466, 0.0964, 0.0464, 0.0545,
        0.0498])
[rfa agg] iter:  3, prev_obj_val: 63.22718048095703, obj_val: 65.28913116455078, abs dis: 2.06195068359375
[rfa agg] iter: 3, weight: tensor([0.1016, 0.1767, 0.0557, 0.1362, 0.0853, 0.0473, 0.2115, 0.0471, 0.0538,
        0.0848])
[rfa agg] iter:  4, prev_obj_val: 65.28913116455078, obj_val: 65.27849578857422, abs dis: 0.0106353759765625
[rfa agg] iter: 4, weight: tensor([0.0815, 0.1259, 0.0475, 0.1596, 0.0914, 0.0408, 0.2759, 0.0406, 0.0461,
        0.0906])
[rfa agg] iter:  5, prev_obj_val: 65.27849578857422, obj_val: 65.27816009521484, abs dis: 0.000335693359375
[rfa agg] iter: 5, weight: tensor([0.0800, 0.1228, 0.0466, 0.1568, 0.0898, 0.0401, 0.2897, 0.0399, 0.0453,
        0.0889])
			Update norm = 140.85576898462483 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.26221799850464 sec.
Server Epoch:75 choose agents : [89, 65, 75, 86, 4, 55, 82, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 334/896 (37.2768%)
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.5937, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 687/1475 (46.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0005, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4723, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   1, Avg loss: 0.0623, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.6497, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0583, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0344, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.2813, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 260/1071 (24.2764%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 488/1071 (45.5649%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9014, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 86/500 (17.2000%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 168/500 (33.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.8813, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0850, Accuracy: 36/338 (10.6509%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.6052, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 395/1949 (20.2668%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 606/1949 (31.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4382, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8763, Accuracy: 73/10000 (0.7300%)
time spent on training: 267.72189450263977
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1475, 776, 1003, 901, 1071, 500, 338, 1949, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 65, 75, 86, 4, 55, 82, 12, 21, 64], weight: tensor([0.0909, 0.1496, 0.0787, 0.1017, 0.0914, 0.1086, 0.0507, 0.0343, 0.1976,
        0.0966])
[rfa agg] iter:  0, prev_obj_val: 52.428016662597656, obj_val: 55.28224563598633, abs dis: 2.854228973388672
[rfa agg] iter: 0, weight: tensor([0.0830, 0.0480, 0.0536, 0.2310, 0.1309, 0.2583, 0.0145, 0.0079, 0.0331,
        0.1397])
[rfa agg] iter:  1, prev_obj_val: 55.28224563598633, obj_val: 63.09747314453125, abs dis: 7.815227508544922
[rfa agg] iter: 1, weight: tensor([0.1653, 0.0321, 0.0968, 0.1239, 0.2128, 0.0858, 0.0160, 0.0083, 0.0246,
        0.2344])
[rfa agg] iter:  2, prev_obj_val: 63.09747314453125, obj_val: 69.92188262939453, abs dis: 6.824409484863281
[rfa agg] iter: 2, weight: tensor([0.1830, 0.0367, 0.3053, 0.0887, 0.1181, 0.0721, 0.0273, 0.0132, 0.0298,
        0.1257])
[rfa agg] iter:  3, prev_obj_val: 69.92188262939453, obj_val: 66.37486267089844, abs dis: 3.5470199584960938
[rfa agg] iter: 3, weight: tensor([0.1610, 0.0478, 0.2679, 0.0956, 0.1140, 0.0825, 0.0482, 0.0219, 0.0401,
        0.1210])
[rfa agg] iter:  4, prev_obj_val: 66.37486267089844, obj_val: 66.37147521972656, abs dis: 0.003387451171875
[rfa agg] iter: 4, weight: tensor([0.1625, 0.0402, 0.3278, 0.0874, 0.1088, 0.0736, 0.0346, 0.0163, 0.0331,
        0.1157])
[rfa agg] iter:  5, prev_obj_val: 66.37147521972656, obj_val: 66.37138366699219, abs dis: 9.1552734375e-05
[rfa agg] iter: 5, weight: tensor([0.1602, 0.0397, 0.3372, 0.0862, 0.1072, 0.0726, 0.0342, 0.0161, 0.0327,
        0.1140])
			Update norm = 114.51071183518161 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.2842330932617 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 84, 39, 17, 89, 93, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 390/1628 (23.9558%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 787/1628 (48.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6876, Accuracy: 146/10000 (1.4600%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 253/1241 (20.3868%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 406/1241 (32.7156%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.2784, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 195/861 (22.6481%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 266/1071 (24.8366%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 512/1071 (47.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2398, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 313/1190 (26.3025%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 432/1190 (36.3025%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.2968, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5746, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0523, Accuracy: 409/1574 (25.9848%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3404, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 432/896 (48.2143%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.4678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 438/1742 (25.1435%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 697/1742 (40.0115%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8454, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 31/271 (11.4391%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0569, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.4606, Accuracy: 47/10000 (0.4700%)
time spent on training: 231.757093667984
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1190, 1013, 1574, 896, 1742, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 72, 10, 55, 84, 39, 17, 89, 93, 35], weight: tensor([0.1417, 0.1080, 0.0750, 0.0932, 0.1036, 0.0882, 0.1370, 0.0780, 0.1516,
        0.0236])
[rfa agg] iter:  0, prev_obj_val: 45.99199676513672, obj_val: 51.76988983154297, abs dis: 5.77789306640625
[rfa agg] iter: 0, weight: tensor([0.0576, 0.1940, 0.0506, 0.1664, 0.2575, 0.1032, 0.0640, 0.0524, 0.0488,
        0.0054])
[rfa agg] iter:  1, prev_obj_val: 51.76988983154297, obj_val: 51.636375427246094, abs dis: 0.133514404296875
[rfa agg] iter: 1, weight: tensor([0.0402, 0.0818, 0.0784, 0.2747, 0.1056, 0.2545, 0.0434, 0.0801, 0.0356,
        0.0055])
[rfa agg] iter:  2, prev_obj_val: 51.636375427246094, obj_val: 62.33985900878906, abs dis: 10.703483581542969
[rfa agg] iter: 2, weight: tensor([0.0371, 0.0750, 0.0726, 0.2918, 0.0947, 0.2771, 0.0400, 0.0739, 0.0328,
        0.0051])
[rfa agg] iter:  3, prev_obj_val: 62.33985900878906, obj_val: 65.48041534423828, abs dis: 3.1405563354492188
[rfa agg] iter: 3, weight: tensor([0.0360, 0.0570, 0.2658, 0.1065, 0.0656, 0.1604, 0.0381, 0.2304, 0.0329,
        0.0073])
[rfa agg] iter:  4, prev_obj_val: 65.48041534423828, obj_val: 73.31912231445312, abs dis: 7.838706970214844
[rfa agg] iter: 4, weight: tensor([0.0290, 0.0440, 0.3557, 0.0742, 0.0498, 0.1025, 0.0306, 0.2812, 0.0266,
        0.0064])
[rfa agg] iter:  5, prev_obj_val: 73.31912231445312, obj_val: 59.29220199584961, abs dis: 14.026920318603516
[rfa agg] iter: 5, weight: tensor([0.0431, 0.0608, 0.2686, 0.0906, 0.0672, 0.1129, 0.0451, 0.2600, 0.0400,
        0.0116])
[rfa agg] iter:  6, prev_obj_val: 59.29220199584961, obj_val: 62.235740661621094, abs dis: 2.9435386657714844
[rfa agg] iter: 6, weight: tensor([0.0386, 0.0642, 0.2000, 0.1303, 0.0750, 0.2117, 0.0410, 0.1971, 0.0350,
        0.0071])
[rfa agg] iter:  7, prev_obj_val: 62.235740661621094, obj_val: 69.25048065185547, abs dis: 7.014739990234375
[rfa agg] iter: 7, weight: tensor([0.0342, 0.0541, 0.2780, 0.0995, 0.0621, 0.1497, 0.0361, 0.2483, 0.0312,
        0.0069])
[rfa agg] iter:  8, prev_obj_val: 69.25048065185547, obj_val: 69.24515533447266, abs dis: 0.0053253173828125
[rfa agg] iter: 8, weight: tensor([0.0343, 0.0501, 0.3173, 0.0790, 0.0560, 0.1030, 0.0361, 0.2840, 0.0317,
        0.0084])
			Update norm = 123.36253657284897 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3106, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.3190, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.0500099658966 sec.
Server Epoch:77 choose agents : [61, 17, 20, 31, 50, 90, 71, 60, 96, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1199, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3243, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 390/1574 (24.7776%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 704/1574 (44.7268%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.1822, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 338/807 (41.8835%)
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0478, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0736, Accuracy: 100/460 (21.7391%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0359, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.2117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 142/809 (17.5525%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 362/809 (44.7466%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6292, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8313, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0621, Accuracy: 181/818 (22.1271%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 338/818 (41.3203%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4782, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 583/2227 (26.1787%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1018/2227 (45.7117%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2692, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   2, Avg loss: 0.0548, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4250, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 391/1581 (24.7312%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 585/1581 (37.0019%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8330, Accuracy: 97/10000 (0.9700%)
time spent on training: 266.74961614608765
[rfa agg] training data poison_ratio: 0.08631939244839021  data num: [85, 1574, 807, 460, 809, 677, 818, 2227, 311, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.02697481014012194
[rfa agg] init. name: [61, 17, 20, 31, 50, 90, 71, 60, 96, 28], weight: tensor([0.0091, 0.1684, 0.0863, 0.0492, 0.0865, 0.0724, 0.0875, 0.2382, 0.0333,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 81.53569030761719, obj_val: 82.85635375976562, abs dis: 1.3206634521484375
[rfa agg] iter: 0, weight: tensor([0.0039, 0.2305, 0.1004, 0.0326, 0.1008, 0.0648, 0.1020, 0.1169, 0.0174,
        0.2306])
[rfa agg] iter:  1, prev_obj_val: 82.85635375976562, obj_val: 84.20817565917969, abs dis: 1.3518218994140625
[rfa agg] iter: 1, weight: tensor([0.0042, 0.1976, 0.1193, 0.0359, 0.1199, 0.0739, 0.1214, 0.1107, 0.0189,
        0.1981])
[rfa agg] iter:  2, prev_obj_val: 84.20817565917969, obj_val: 85.57636260986328, abs dis: 1.3681869506835938
[rfa agg] iter: 2, weight: tensor([0.0043, 0.1654, 0.1401, 0.0383, 0.1408, 0.0822, 0.1427, 0.1007, 0.0197,
        0.1659])
[rfa agg] iter:  3, prev_obj_val: 85.57636260986328, obj_val: 86.97111511230469, abs dis: 1.3947525024414062
[rfa agg] iter: 3, weight: tensor([0.0042, 0.1335, 0.1632, 0.0391, 0.1644, 0.0886, 0.1666, 0.0870, 0.0195,
        0.1339])
[rfa agg] iter:  4, prev_obj_val: 86.97111511230469, obj_val: 88.42985534667969, abs dis: 1.458740234375
[rfa agg] iter: 4, weight: tensor([0.0038, 0.1011, 0.1900, 0.0374, 0.1920, 0.0913, 0.1949, 0.0699, 0.0181,
        0.1014])
[rfa agg] iter:  5, prev_obj_val: 88.42985534667969, obj_val: 93.88050079345703, abs dis: 5.450645446777344
[rfa agg] iter: 5, weight: tensor([0.0031, 0.0678, 0.2216, 0.0320, 0.2264, 0.0865, 0.2306, 0.0492, 0.0148,
        0.0680])
[rfa agg] iter:  6, prev_obj_val: 93.88050079345703, obj_val: 96.6448974609375, abs dis: 2.7643966674804688
[rfa agg] iter: 6, weight: tensor([0.0020, 0.0313, 0.2417, 0.0252, 0.2601, 0.1039, 0.2695, 0.0246, 0.0103,
        0.0314])
[rfa agg] iter:  7, prev_obj_val: 96.6448974609375, obj_val: 102.73023986816406, abs dis: 6.0853424072265625
[rfa agg] iter: 7, weight: tensor([0.0026, 0.0381, 0.2131, 0.0358, 0.2214, 0.1807, 0.2257, 0.0305, 0.0139,
        0.0382])
[rfa agg] iter:  8, prev_obj_val: 102.73023986816406, obj_val: 102.66817474365234, abs dis: 0.06206512451171875
[rfa agg] iter: 8, weight: tensor([0.0032, 0.0389, 0.1325, 0.0520, 0.1346, 0.4136, 0.1363, 0.0321, 0.0177,
        0.0390])
[rfa agg] iter:  9, prev_obj_val: 102.66817474365234, obj_val: 109.69972229003906, abs dis: 7.031547546386719
[rfa agg] iter: 9, weight: tensor([0.0027, 0.0330, 0.1108, 0.0442, 0.1134, 0.5060, 0.1145, 0.0273, 0.0151,
        0.0331])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.2307710647583 sec.
Server Epoch:78 choose agents : [1, 64, 48, 77, 0, 36, 26, 90, 18, 93].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0581, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 550/928 (59.2672%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.9770, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 318/953 (33.3683%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.9075, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0693, Accuracy: 109/631 (17.2742%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.3033, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 574/1340 (42.8358%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8413, Accuracy: 97/10000 (0.9700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 346/1657 (20.8811%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 505/1657 (30.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.9597, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 64/408 (15.6863%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0561, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.6910, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 499/1446 (34.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3587, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   1, Avg loss: 0.0521, Accuracy: 361/677 (53.3235%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 407/677 (60.1182%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7918, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0705, Accuracy: 138/530 (26.0377%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.5784, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 410/1742 (23.5362%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 695/1742 (39.8967%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0796, Accuracy: 90/10000 (0.9000%)
time spent on training: 235.29739427566528
[rfa agg] training data poison_ratio: 0.1606865787432118  data num: [928, 953, 631, 1340, 1657, 408, 1446, 677, 530, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.050214555857253686
[rfa agg] init. name: [1, 64, 48, 77, 0, 36, 26, 90, 18, 93], weight: tensor([0.0900, 0.0924, 0.0612, 0.1299, 0.1607, 0.0396, 0.1402, 0.0657, 0.0514,
        0.1689])
[rfa agg] iter:  0, prev_obj_val: 60.19441223144531, obj_val: 62.087615966796875, abs dis: 1.8932037353515625
[rfa agg] iter: 0, weight: tensor([0.2047, 0.2126, 0.0429, 0.1573, 0.0877, 0.0195, 0.1142, 0.0538, 0.0316,
        0.0756])
[rfa agg] iter:  1, prev_obj_val: 62.087615966796875, obj_val: 64.58566284179688, abs dis: 2.498046875
[rfa agg] iter: 1, weight: tensor([0.2792, 0.2942, 0.0391, 0.0992, 0.0618, 0.0169, 0.0767, 0.0504, 0.0282,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 64.58566284179688, obj_val: 71.32914733886719, abs dis: 6.7434844970703125
[rfa agg] iter: 2, weight: tensor([0.3410, 0.3791, 0.0313, 0.0555, 0.0377, 0.0128, 0.0450, 0.0420, 0.0220,
        0.0336])
[rfa agg] iter:  3, prev_obj_val: 71.32914733886719, obj_val: 73.78241729736328, abs dis: 2.4532699584960938
[rfa agg] iter: 3, weight: tensor([0.2410, 0.2514, 0.0743, 0.0753, 0.0561, 0.0265, 0.0642, 0.1109, 0.0493,
        0.0509])
[rfa agg] iter:  4, prev_obj_val: 73.78241729736328, obj_val: 68.89083862304688, abs dis: 4.891578674316406
[rfa agg] iter: 4, weight: tensor([0.2016, 0.2086, 0.0939, 0.0767, 0.0585, 0.0312, 0.0663, 0.1496, 0.0602,
        0.0534])
[rfa agg] iter:  5, prev_obj_val: 68.89083862304688, obj_val: 73.79094696044922, abs dis: 4.900108337402344
[rfa agg] iter: 5, weight: tensor([0.2786, 0.2928, 0.0577, 0.0707, 0.0512, 0.0216, 0.0594, 0.0826, 0.0391,
        0.0462])
[rfa agg] iter:  6, prev_obj_val: 73.79094696044922, obj_val: 68.89057922363281, abs dis: 4.900367736816406
[rfa agg] iter: 6, weight: tensor([0.2023, 0.2093, 0.0936, 0.0767, 0.0585, 0.0311, 0.0662, 0.1488, 0.0601,
        0.0534])
[rfa agg] iter:  7, prev_obj_val: 68.89057922363281, obj_val: 73.79095458984375, abs dis: 4.9003753662109375
[rfa agg] iter: 7, weight: tensor([0.2787, 0.2928, 0.0577, 0.0707, 0.0512, 0.0216, 0.0594, 0.0826, 0.0391,
        0.0462])
[rfa agg] iter:  8, prev_obj_val: 73.79095458984375, obj_val: 68.89057922363281, abs dis: 4.9003753662109375
[rfa agg] iter: 8, weight: tensor([0.2023, 0.2093, 0.0936, 0.0767, 0.0585, 0.0311, 0.0662, 0.1488, 0.0601,
        0.0534])
[rfa agg] iter:  9, prev_obj_val: 68.89057922363281, obj_val: 73.79095458984375, abs dis: 4.9003753662109375
[rfa agg] iter: 9, weight: tensor([0.2787, 0.2928, 0.0577, 0.0707, 0.0512, 0.0216, 0.0594, 0.0826, 0.0391,
        0.0462])
			Update norm = 118.41790322703531 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.5651545524597 sec.
Server Epoch:79 choose agents : [70, 34, 15, 98, 97, 25, 53, 87, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 347/1418 (24.4711%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 645/1418 (45.4866%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4811, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0563, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 622/1427 (43.5879%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5325, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 389/1154 (33.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6851, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0822, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0485, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.6434, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 367/1213 (30.2556%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 511/1213 (42.1270%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1872, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0554, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.9992, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 282/813 (34.6863%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.2401, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   2, Avg loss: 0.0309, Accuracy: 466/1131 (41.2025%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3438, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0711, Accuracy: 139/530 (26.2264%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0366, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.6519, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0528, Accuracy: 313/636 (49.2138%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0287, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.5359, Accuracy: 50/10000 (0.5000%)
time spent on training: 268.2481846809387
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 373, 1213, 690, 813, 1131, 530, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 34, 15, 98, 97, 25, 53, 87, 18, 52], weight: tensor([0.1511, 0.1521, 0.1230, 0.0397, 0.1292, 0.0735, 0.0866, 0.1205, 0.0565,
        0.0678])
[rfa agg] iter:  0, prev_obj_val: 49.56901931762695, obj_val: 52.75613021850586, abs dis: 3.1871109008789062
[rfa agg] iter: 0, weight: tensor([0.0776, 0.0780, 0.1168, 0.0204, 0.1241, 0.0909, 0.2343, 0.1479, 0.0447,
        0.0652])
[rfa agg] iter:  1, prev_obj_val: 52.75613021850586, obj_val: 56.65414047241211, abs dis: 3.89801025390625
[rfa agg] iter: 1, weight: tensor([0.0546, 0.0549, 0.0758, 0.0182, 0.0803, 0.0986, 0.4182, 0.0913, 0.0428,
        0.0654])
[rfa agg] iter:  2, prev_obj_val: 56.65414047241211, obj_val: 56.651126861572266, abs dis: 0.00301361083984375
[rfa agg] iter: 2, weight: tensor([0.0449, 0.0451, 0.0584, 0.0190, 0.0618, 0.1419, 0.4296, 0.0680, 0.0497,
        0.0816])
			Update norm = 113.98613882288495 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.9325249195099 sec.
Server Epoch:80 choose agents : [91, 47, 51, 92, 88, 78, 75, 61, 99, 77].
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0535, Accuracy: 363/1030 (35.2427%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0249, Accuracy: 645/1030 (62.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4452, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1224, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1086, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3399, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 511/1049 (48.7131%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0329, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 447/1715 (26.0641%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 696/1715 (40.5831%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8334, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   1, Avg loss: 0.0753, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.4187, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   1, Avg loss: 0.0801, Accuracy: 56/416 (13.4615%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9419, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 247/776 (31.8299%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.9805, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1277, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1209, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   1, Avg loss: 0.0687, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 362/773 (46.8305%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7049, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 502/1340 (37.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8212, Accuracy: 87/10000 (0.8700%)
time spent on training: 195.16526436805725
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 134, 1049, 1715, 603, 416, 776, 85, 773, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 47, 51, 92, 88, 78, 75, 61, 99, 77], weight: tensor([0.1300, 0.0169, 0.1324, 0.2165, 0.0761, 0.0525, 0.0980, 0.0107, 0.0976,
        0.1692])
[rfa agg] iter:  0, prev_obj_val: 50.51926803588867, obj_val: 52.98357009887695, abs dis: 2.4643020629882812
[rfa agg] iter: 0, weight: tensor([0.2512, 0.0046, 0.2517, 0.0639, 0.0468, 0.0210, 0.1274, 0.0027, 0.1276,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 52.98357009887695, obj_val: 55.82848358154297, abs dis: 2.8449134826660156
[rfa agg] iter: 1, weight: tensor([0.1736, 0.0051, 0.1760, 0.0604, 0.0586, 0.0244, 0.2029, 0.0030, 0.2060,
        0.0899])
[rfa agg] iter:  2, prev_obj_val: 55.82848358154297, obj_val: 57.61149215698242, abs dis: 1.7830085754394531
[rfa agg] iter: 2, weight: tensor([0.0950, 0.0042, 0.0965, 0.0421, 0.0563, 0.0212, 0.3036, 0.0024, 0.3198,
        0.0588])
[rfa agg] iter:  3, prev_obj_val: 57.61149215698242, obj_val: 62.98588180541992, abs dis: 5.3743896484375
[rfa agg] iter: 3, weight: tensor([0.0663, 0.0035, 0.0673, 0.0323, 0.0520, 0.0182, 0.3426, 0.0020, 0.3718,
        0.0439])
[rfa agg] iter:  4, prev_obj_val: 62.98588180541992, obj_val: 62.97425842285156, abs dis: 0.011623382568359375
[rfa agg] iter: 4, weight: tensor([0.0836, 0.0061, 0.0850, 0.0471, 0.1186, 0.0341, 0.2779, 0.0035, 0.2831,
        0.0611])
			Update norm = 109.61959703760775 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.42318844795227 sec.
Server Epoch:81 choose agents : [60, 93, 18, 24, 50, 98, 61, 91, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 560/2227 (25.1459%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6070, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 415/1742 (23.8232%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 678/1742 (38.9208%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0602, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0713, Accuracy: 135/530 (25.4717%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 262/530 (49.4340%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.7444, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 176/809 (21.7553%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 350/809 (43.2633%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7958, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   1, Avg loss: 0.0822, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.6686, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1268, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1153, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3270, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 350/1030 (33.9806%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 623/1030 (60.4854%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7531, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0898, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 332/1154 (28.7695%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 468/1154 (40.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7814, Accuracy: 53/10000 (0.5300%)
time spent on training: 247.14396977424622
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1742, 530, 312, 809, 373, 85, 1030, 1130, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 93, 18, 24, 50, 98, 61, 91, 54, 15], weight: tensor([0.2371, 0.1855, 0.0564, 0.0332, 0.0861, 0.0397, 0.0091, 0.1097, 0.1203,
        0.1229])
[rfa agg] iter:  0, prev_obj_val: 74.05664825439453, obj_val: 74.22661590576172, abs dis: 0.1699676513671875
[rfa agg] iter: 0, weight: tensor([0.0648, 0.0945, 0.0210, 0.0091, 0.0503, 0.0116, 0.0021, 0.1422, 0.2288,
        0.3758])
[rfa agg] iter:  1, prev_obj_val: 74.22661590576172, obj_val: 77.05577850341797, abs dis: 2.82916259765625
[rfa agg] iter: 1, weight: tensor([0.0342, 0.0454, 0.0154, 0.0063, 0.0419, 0.0081, 0.0014, 0.1911, 0.4019,
        0.2544])
[rfa agg] iter:  2, prev_obj_val: 77.05577850341797, obj_val: 81.25702667236328, abs dis: 4.2012481689453125
[rfa agg] iter: 2, weight: tensor([0.0382, 0.0487, 0.0204, 0.0080, 0.0615, 0.0105, 0.0017, 0.3412, 0.3042,
        0.1656])
[rfa agg] iter:  3, prev_obj_val: 81.25702667236328, obj_val: 81.25077819824219, abs dis: 0.00624847412109375
[rfa agg] iter: 3, weight: tensor([0.0488, 0.0603, 0.0313, 0.0118, 0.1091, 0.0155, 0.0025, 0.3438, 0.2235,
        0.1535])
[rfa agg] iter:  4, prev_obj_val: 81.25077819824219, obj_val: 83.60938262939453, abs dis: 2.3586044311523438
[rfa agg] iter: 4, weight: tensor([0.0487, 0.0602, 0.0313, 0.0118, 0.1093, 0.0155, 0.0025, 0.3460, 0.2214,
        0.1534])
[rfa agg] iter:  5, prev_obj_val: 83.60938262939453, obj_val: 83.60537719726562, abs dis: 0.00400543212890625
[rfa agg] iter: 5, weight: tensor([0.0545, 0.0664, 0.0387, 0.0142, 0.1488, 0.0187, 0.0030, 0.2953, 0.2077,
        0.1527])
[rfa agg] iter:  6, prev_obj_val: 83.60537719726562, obj_val: 86.00759887695312, abs dis: 2.4022216796875
[rfa agg] iter: 6, weight: tensor([0.0547, 0.0666, 0.0388, 0.0142, 0.1500, 0.0188, 0.0030, 0.2920, 0.2086,
        0.1533])
[rfa agg] iter:  7, prev_obj_val: 86.00759887695312, obj_val: 83.6085433959961, abs dis: 2.3990554809570312
[rfa agg] iter: 7, weight: tensor([0.0578, 0.0695, 0.0456, 0.0162, 0.1996, 0.0215, 0.0034, 0.2493, 0.1907,
        0.1465])
[rfa agg] iter:  8, prev_obj_val: 83.6085433959961, obj_val: 86.00729370117188, abs dis: 2.3987503051757812
[rfa agg] iter: 8, weight: tensor([0.0549, 0.0668, 0.0390, 0.0142, 0.1512, 0.0188, 0.0030, 0.2889, 0.2093,
        0.1539])
[rfa agg] iter:  9, prev_obj_val: 86.00729370117188, obj_val: 83.60855865478516, abs dis: 2.3987350463867188
[rfa agg] iter: 9, weight: tensor([0.0578, 0.0695, 0.0456, 0.0162, 0.1997, 0.0215, 0.0034, 0.2492, 0.1907,
        0.1466])
			Update norm = 140.52483238070417 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.20075488090515 sec.
Server Epoch:82 choose agents : [59, 84, 37, 81, 61, 21, 47, 82, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2055, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 475/1190 (39.9160%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2610, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 420/1129 (37.2011%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 747/1129 (66.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1423, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0678, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0362, Accuracy: 294/774 (37.9845%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.5180, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3269, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 382/1949 (19.5998%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 623/1949 (31.9651%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6134, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1201, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1060, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0743, Accuracy: 85/500 (17.0000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.2263, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 314/1645 (19.0881%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 627/1645 (38.1155%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2491, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0740, Accuracy: 96/460 (20.8696%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0339, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3423, Accuracy: 48/10000 (0.4800%)
time spent on training: 209.38251757621765
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1190, 1129, 774, 85, 1949, 134, 500, 1645, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 84, 37, 81, 61, 21, 47, 82, 13, 31], weight: tensor([0.1216, 0.1329, 0.1261, 0.0864, 0.0095, 0.2176, 0.0150, 0.0558, 0.1837,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 58.51201248168945, obj_val: 62.80368423461914, abs dis: 4.2916717529296875
[rfa agg] iter: 0, weight: tensor([0.2561, 0.2980, 0.2760, 0.0383, 0.0014, 0.0428, 0.0024, 0.0131, 0.0599,
        0.0120])
[rfa agg] iter:  1, prev_obj_val: 62.80368423461914, obj_val: 62.782814025878906, abs dis: 0.020870208740234375
[rfa agg] iter: 1, weight: tensor([0.2802, 0.1941, 0.3022, 0.0669, 0.0020, 0.0492, 0.0034, 0.0196, 0.0643,
        0.0180])
[rfa agg] iter:  2, prev_obj_val: 62.782814025878906, obj_val: 60.72417068481445, abs dis: 2.058643341064453
[rfa agg] iter: 2, weight: tensor([0.2846, 0.1883, 0.3056, 0.0664, 0.0020, 0.0488, 0.0033, 0.0194, 0.0637,
        0.0179])
[rfa agg] iter:  3, prev_obj_val: 60.72417068481445, obj_val: 65.06746673583984, abs dis: 4.343296051025391
[rfa agg] iter: 3, weight: tensor([0.3021, 0.1891, 0.3327, 0.0479, 0.0015, 0.0409, 0.0026, 0.0149, 0.0545,
        0.0137])
[rfa agg] iter:  4, prev_obj_val: 65.06746673583984, obj_val: 62.785518646240234, abs dis: 2.2819480895996094
[rfa agg] iter: 4, weight: tensor([0.2628, 0.1860, 0.2789, 0.0899, 0.0024, 0.0563, 0.0041, 0.0246, 0.0723,
        0.0226])
[rfa agg] iter:  5, prev_obj_val: 62.785518646240234, obj_val: 62.78269958496094, abs dis: 0.002819061279296875
[rfa agg] iter: 5, weight: tensor([0.2843, 0.1892, 0.3041, 0.0667, 0.0020, 0.0489, 0.0034, 0.0195, 0.0640,
        0.0180])
[rfa agg] iter:  6, prev_obj_val: 62.78269958496094, obj_val: 60.72412872314453, abs dis: 2.0585708618164062
[rfa agg] iter: 6, weight: tensor([0.2851, 0.1879, 0.3056, 0.0663, 0.0020, 0.0487, 0.0033, 0.0194, 0.0637,
        0.0179])
[rfa agg] iter:  7, prev_obj_val: 60.72412872314453, obj_val: 65.06747436523438, abs dis: 4.343345642089844
[rfa agg] iter: 7, weight: tensor([0.3023, 0.1890, 0.3327, 0.0479, 0.0015, 0.0409, 0.0026, 0.0149, 0.0545,
        0.0137])
[rfa agg] iter:  8, prev_obj_val: 65.06747436523438, obj_val: 62.785518646240234, abs dis: 2.2819557189941406
[rfa agg] iter: 8, weight: tensor([0.2628, 0.1860, 0.2788, 0.0899, 0.0024, 0.0563, 0.0041, 0.0246, 0.0723,
        0.0226])
[rfa agg] iter:  9, prev_obj_val: 62.785518646240234, obj_val: 62.78269577026367, abs dis: 0.0028228759765625
[rfa agg] iter: 9, weight: tensor([0.2843, 0.1892, 0.3041, 0.0667, 0.0020, 0.0489, 0.0034, 0.0195, 0.0640,
        0.0180])
			Update norm = 153.81495071188627 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3128, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.3244, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.8710651397705 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 76, 96, 80].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0621, Accuracy: 299/946 (31.6068%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1661, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 652/1475 (44.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4086, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0747, Accuracy: 90/515 (17.4757%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0508, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.0356, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1120, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 67/408 (16.4216%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.6905, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0571, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 538/1154 (46.6205%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.0157, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 199/669 (29.7459%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0414, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0827, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1879, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   2, Avg loss: 0.0550, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.4443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 250/682 (36.6569%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.8091, Accuracy: 56/10000 (0.5600%)
time spent on training: 223.65891218185425
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 466, 311, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 65, 33, 2, 36, 57, 45, 76, 96, 80], weight: tensor([0.1308, 0.2040, 0.0712, 0.0837, 0.0564, 0.1596, 0.0925, 0.0644, 0.0430,
        0.0943])
[rfa agg] iter:  0, prev_obj_val: 48.79412078857422, obj_val: 50.630306243896484, abs dis: 1.8361854553222656
[rfa agg] iter: 0, weight: tensor([0.1746, 0.0616, 0.0698, 0.1129, 0.0355, 0.0847, 0.1913, 0.0493, 0.0199,
        0.2003])
[rfa agg] iter:  1, prev_obj_val: 50.630306243896484, obj_val: 59.708885192871094, abs dis: 9.07857894897461
[rfa agg] iter: 1, weight: tensor([0.0577, 0.0302, 0.0887, 0.2191, 0.0319, 0.0374, 0.2232, 0.0501, 0.0155,
        0.2462])
[rfa agg] iter:  2, prev_obj_val: 59.708885192871094, obj_val: 62.72235870361328, abs dis: 3.0134735107421875
[rfa agg] iter: 2, weight: tensor([0.0505, 0.0332, 0.2350, 0.1338, 0.0892, 0.0382, 0.0905, 0.2063, 0.0304,
        0.0930])
[rfa agg] iter:  3, prev_obj_val: 62.72235870361328, obj_val: 69.77495574951172, abs dis: 7.0525970458984375
[rfa agg] iter: 3, weight: tensor([0.0451, 0.0309, 0.1578, 0.0984, 0.1230, 0.0351, 0.0727, 0.3285, 0.0339,
        0.0747])
[rfa agg] iter:  4, prev_obj_val: 69.77495574951172, obj_val: 73.66030883789062, abs dis: 3.8853530883789062
[rfa agg] iter: 4, weight: tensor([0.0464, 0.0342, 0.0986, 0.0784, 0.3445, 0.0378, 0.0648, 0.1709, 0.0581,
        0.0664])
[rfa agg] iter:  5, prev_obj_val: 73.66030883789062, obj_val: 73.65933990478516, abs dis: 0.00096893310546875
[rfa agg] iter: 5, weight: tensor([0.0523, 0.0397, 0.0951, 0.0807, 0.3185, 0.0434, 0.0693, 0.1397, 0.0904,
        0.0708])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3151, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.3277, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.7283992767334 sec.
Server Epoch:84 choose agents : [0, 26, 54, 61, 56, 29, 38, 45, 2, 15].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 507/1657 (30.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0920, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 336/1446 (23.2365%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 507/1446 (35.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.3916, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0537, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 482/1130 (42.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5928, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1197, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3297, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0814, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3535, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 447/1440 (31.0417%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 650/1440 (45.1389%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1896, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 476/1131 (42.0866%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8435, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0664, Accuracy: 204/669 (30.4933%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0421, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.1079, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.1634, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 344/1154 (29.8094%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 502/1154 (43.5009%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2432, Accuracy: 68/10000 (0.6800%)
time spent on training: 233.00351476669312
[rfa agg] training data poison_ratio: 0.1743659896874671  data num: [1657, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.05448937177733347
[rfa agg] init. name: [0, 26, 54, 61, 56, 29, 38, 45, 2, 15], weight: tensor([0.1744, 0.1522, 0.1189, 0.0089, 0.0196, 0.1515, 0.1190, 0.0704, 0.0637,
        0.1214])
[rfa agg] iter:  0, prev_obj_val: 44.792545318603516, obj_val: 47.185829162597656, abs dis: 2.3932838439941406
[rfa agg] iter: 0, weight: tensor([0.0510, 0.0684, 0.3000, 0.0014, 0.0034, 0.0679, 0.2962, 0.0269, 0.0211,
        0.1637])
[rfa agg] iter:  1, prev_obj_val: 47.185829162597656, obj_val: 50.004547119140625, abs dis: 2.8187179565429688
[rfa agg] iter: 1, weight: tensor([0.0560, 0.0728, 0.2886, 0.0017, 0.0041, 0.0723, 0.2872, 0.0339, 0.0263,
        0.1571])
[rfa agg] iter:  2, prev_obj_val: 50.004547119140625, obj_val: 47.188236236572266, abs dis: 2.8163108825683594
[rfa agg] iter: 2, weight: tensor([0.0655, 0.0832, 0.2601, 0.0022, 0.0052, 0.0826, 0.2596, 0.0455, 0.0349,
        0.1612])
[rfa agg] iter:  3, prev_obj_val: 47.188236236572266, obj_val: 47.185096740722656, abs dis: 0.003139495849609375
[rfa agg] iter: 3, weight: tensor([0.0564, 0.0735, 0.2867, 0.0017, 0.0041, 0.0730, 0.2855, 0.0341, 0.0265,
        0.1585])
[rfa agg] iter:  4, prev_obj_val: 47.185096740722656, obj_val: 50.004459381103516, abs dis: 2.8193626403808594
[rfa agg] iter: 4, weight: tensor([0.0561, 0.0730, 0.2880, 0.0017, 0.0041, 0.0725, 0.2869, 0.0339, 0.0263,
        0.1573])
[rfa agg] iter:  5, prev_obj_val: 50.004459381103516, obj_val: 47.1882438659668, abs dis: 2.8162155151367188
[rfa agg] iter: 5, weight: tensor([0.0655, 0.0832, 0.2601, 0.0022, 0.0052, 0.0826, 0.2596, 0.0455, 0.0349,
        0.1612])
[rfa agg] iter:  6, prev_obj_val: 47.1882438659668, obj_val: 47.185096740722656, abs dis: 0.003147125244140625
[rfa agg] iter: 6, weight: tensor([0.0564, 0.0735, 0.2867, 0.0017, 0.0041, 0.0730, 0.2855, 0.0341, 0.0265,
        0.1585])
[rfa agg] iter:  7, prev_obj_val: 47.185096740722656, obj_val: 50.004459381103516, abs dis: 2.8193626403808594
[rfa agg] iter: 7, weight: tensor([0.0561, 0.0730, 0.2880, 0.0017, 0.0041, 0.0725, 0.2869, 0.0339, 0.0263,
        0.1573])
[rfa agg] iter:  8, prev_obj_val: 50.004459381103516, obj_val: 47.1882438659668, abs dis: 2.8162155151367188
[rfa agg] iter: 8, weight: tensor([0.0655, 0.0832, 0.2601, 0.0022, 0.0052, 0.0826, 0.2596, 0.0455, 0.0349,
        0.1612])
[rfa agg] iter:  9, prev_obj_val: 47.1882438659668, obj_val: 47.185096740722656, abs dis: 0.003147125244140625
[rfa agg] iter: 9, weight: tensor([0.0564, 0.0735, 0.2867, 0.0017, 0.0041, 0.0730, 0.2855, 0.0341, 0.0265,
        0.1585])
			Update norm = 153.57852480490232 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3151, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.3277, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.0347032546997 sec.
Server Epoch:85 choose agents : [84, 3, 86, 18, 98, 8, 89, 80, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3151, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 254/781 (32.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8529, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9874, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0715, Accuracy: 143/530 (26.9811%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0369, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.7727, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   1, Avg loss: 0.0814, Accuracy: 25/373 (6.7024%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.6926, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0593, Accuracy: 287/1513 (18.9689%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 486/1513 (32.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8103, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6242, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 230/682 (33.7243%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.7650, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.9686, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 428/803 (53.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2499, Accuracy: 58/10000 (0.5800%)
time spent on training: 253.44245290756226
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 781, 1003, 530, 373, 1513, 896, 682, 715, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 3, 86, 18, 98, 8, 89, 80, 23, 58], weight: tensor([0.1402, 0.0920, 0.1182, 0.0625, 0.0440, 0.1783, 0.1056, 0.0804, 0.0843,
        0.0946])
[rfa agg] iter:  0, prev_obj_val: 38.54322814941406, obj_val: 47.31610870361328, abs dis: 8.772880554199219
[rfa agg] iter: 0, weight: tensor([0.0433, 0.2501, 0.0709, 0.0289, 0.0117, 0.0302, 0.1510, 0.0718, 0.1203,
        0.2219])
[rfa agg] iter:  1, prev_obj_val: 47.31610870361328, obj_val: 57.32977294921875, abs dis: 10.013664245605469
[rfa agg] iter: 1, weight: tensor([0.0425, 0.1081, 0.0568, 0.0730, 0.0213, 0.0334, 0.0830, 0.3101, 0.1622,
        0.1096])
[rfa agg] iter:  2, prev_obj_val: 57.32977294921875, obj_val: 57.3007698059082, abs dis: 0.029003143310546875
[rfa agg] iter: 2, weight: tensor([0.0488, 0.0859, 0.0599, 0.2809, 0.0412, 0.0408, 0.0768, 0.1703, 0.1074,
        0.0881])
[rfa agg] iter:  3, prev_obj_val: 57.3007698059082, obj_val: 57.300384521484375, abs dis: 0.000385284423828125
[rfa agg] iter: 3, weight: tensor([0.0472, 0.0830, 0.0579, 0.3076, 0.0399, 0.0394, 0.0742, 0.1623, 0.1036,
        0.0850])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3175, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.3356, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.00814056396484 sec.
Server Epoch:86 choose agents : [57, 20, 60, 19, 35, 85, 82, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 482/1154 (41.7678%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.8883, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 626/2227 (28.1096%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1065/2227 (47.8222%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3150, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 407/1036 (39.2857%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 650/1036 (62.7413%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.7498, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.5357, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 500/1988 (25.1509%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 655/1988 (32.9477%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1715, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.1358, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 398/1750 (22.7429%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 663/1750 (37.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5060, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0612, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 414/719 (57.5800%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.9567, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/1089 (29.3848%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0301, Accuracy: 501/1089 (46.0055%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6994, Accuracy: 70/10000 (0.7000%)
time spent on training: 258.84050393104553
[rfa agg] training data poison_ratio: 0.06992461658435144  data num: [1154, 807, 2227, 1036, 271, 1988, 500, 1750, 719, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.021851442682609825
[rfa agg] init. name: [57, 20, 60, 19, 35, 85, 82, 44, 41, 59], weight: tensor([0.1000, 0.0699, 0.1930, 0.0898, 0.0235, 0.1723, 0.0433, 0.1516, 0.0623,
        0.0944])
[rfa agg] iter:  0, prev_obj_val: 77.12493896484375, obj_val: 78.16407775878906, abs dis: 1.0391387939453125
[rfa agg] iter: 0, weight: tensor([0.2364, 0.0528, 0.0920, 0.1264, 0.0092, 0.1053, 0.0207, 0.1487, 0.0422,
        0.1664])
[rfa agg] iter:  1, prev_obj_val: 78.16407775878906, obj_val: 82.58179473876953, abs dis: 4.417716979980469
[rfa agg] iter: 1, weight: tensor([0.3837, 0.0424, 0.0494, 0.1351, 0.0064, 0.0546, 0.0150, 0.0705, 0.0328,
        0.2101])
[rfa agg] iter:  2, prev_obj_val: 82.58179473876953, obj_val: 86.75648498535156, abs dis: 4.174690246582031
[rfa agg] iter: 2, weight: tensor([0.1968, 0.0500, 0.0362, 0.2828, 0.0062, 0.0389, 0.0149, 0.0472, 0.0368,
        0.2904])
[rfa agg] iter:  3, prev_obj_val: 86.75648498535156, obj_val: 89.25215911865234, abs dis: 2.4956741333007812
[rfa agg] iter: 3, weight: tensor([0.1396, 0.0723, 0.0390, 0.3744, 0.0076, 0.0415, 0.0190, 0.0492, 0.0509,
        0.2064])
[rfa agg] iter:  4, prev_obj_val: 89.25215911865234, obj_val: 84.42868041992188, abs dis: 4.823478698730469
[rfa agg] iter: 4, weight: tensor([0.1375, 0.0975, 0.0443, 0.3326, 0.0093, 0.0469, 0.0236, 0.0549, 0.0666,
        0.1868])
[rfa agg] iter:  5, prev_obj_val: 84.42868041992188, obj_val: 86.72649383544922, abs dis: 2.2978134155273438
[rfa agg] iter: 5, weight: tensor([0.1378, 0.0531, 0.0332, 0.4257, 0.0061, 0.0355, 0.0149, 0.0426, 0.0382,
        0.2129])
[rfa agg] iter:  6, prev_obj_val: 86.72649383544922, obj_val: 89.25587463378906, abs dis: 2.5293807983398438
[rfa agg] iter: 6, weight: tensor([0.1308, 0.0685, 0.0370, 0.4149, 0.0072, 0.0393, 0.0180, 0.0466, 0.0483,
        0.1894])
[rfa agg] iter:  7, prev_obj_val: 89.25587463378906, obj_val: 86.73104858398438, abs dis: 2.5248260498046875
[rfa agg] iter: 7, weight: tensor([0.1366, 0.0970, 0.0441, 0.3372, 0.0093, 0.0467, 0.0235, 0.0547, 0.0662,
        0.1849])
[rfa agg] iter:  8, prev_obj_val: 86.73104858398438, obj_val: 89.25392150878906, abs dis: 2.5228729248046875
[rfa agg] iter: 8, weight: tensor([0.1347, 0.0707, 0.0379, 0.3990, 0.0074, 0.0404, 0.0185, 0.0478, 0.0497,
        0.1938])
[rfa agg] iter:  9, prev_obj_val: 89.25392150878906, obj_val: 86.73124694824219, abs dis: 2.522674560546875
[rfa agg] iter: 9, weight: tensor([0.1370, 0.0972, 0.0441, 0.3355, 0.0093, 0.0468, 0.0235, 0.0548, 0.0664,
        0.1856])
			Update norm = 148.80989471679968 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3175, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.3356, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.8357894420624 sec.
Server Epoch:87 choose agents : [86, 29, 54, 69, 87, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0619, Accuracy: 368/1003 (36.6899%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 343/1003 (34.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.9609, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 417/1440 (28.9583%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 707/1440 (49.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3454, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0537, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3204, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0582, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4851, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 307/1131 (27.1441%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 436/1131 (38.5500%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0116, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 204/669 (30.4933%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.0688, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 352/1446 (24.3430%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 498/1446 (34.4398%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4294, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1034, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3482, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0767, Accuracy: 79/515 (15.3398%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0482, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1219, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 537/1154 (46.5338%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.5213, Accuracy: 80/10000 (0.8000%)
time spent on training: 273.0990881919861
[rfa agg] training data poison_ratio: 0.0  data num: [1003, 1440, 1130, 590, 1131, 669, 1446, 134, 515, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 29, 54, 69, 87, 45, 26, 47, 33, 57], weight: tensor([0.1089, 0.1563, 0.1227, 0.0640, 0.1228, 0.0726, 0.1570, 0.0145, 0.0559,
        0.1253])
[rfa agg] iter:  0, prev_obj_val: 40.76002502441406, obj_val: 47.812843322753906, abs dis: 7.052818298339844
[rfa agg] iter: 0, weight: tensor([0.3718, 0.0601, 0.1548, 0.0288, 0.1531, 0.0390, 0.0603, 0.0030, 0.0216,
        0.1076])
[rfa agg] iter:  1, prev_obj_val: 47.812843322753906, obj_val: 45.28326416015625, abs dis: 2.5295791625976562
[rfa agg] iter: 1, weight: tensor([0.2763, 0.0744, 0.1393, 0.0572, 0.1390, 0.0824, 0.0747, 0.0051, 0.0411,
        0.1106])
[rfa agg] iter:  2, prev_obj_val: 45.28326416015625, obj_val: 42.8387451171875, abs dis: 2.44451904296875
[rfa agg] iter: 2, weight: tensor([0.3256, 0.0691, 0.1411, 0.0452, 0.1405, 0.0636, 0.0694, 0.0043, 0.0330,
        0.1083])
[rfa agg] iter:  3, prev_obj_val: 42.8387451171875, obj_val: 50.38287353515625, abs dis: 7.54412841796875
[rfa agg] iter: 3, weight: tensor([0.4019, 0.0599, 0.1357, 0.0334, 0.1350, 0.0461, 0.0601, 0.0034, 0.0248,
        0.0997])
[rfa agg] iter:  4, prev_obj_val: 50.38287353515625, obj_val: 50.35839080810547, abs dis: 0.02448272705078125
[rfa agg] iter: 4, weight: tensor([0.2353, 0.0773, 0.1346, 0.0704, 0.1344, 0.1049, 0.0776, 0.0059, 0.0496,
        0.1099])
			Update norm = 126.65047868050085 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3175, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.3356, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.3665280342102 sec.
Server Epoch:88 choose agents : [62, 83, 85, 18, 63, 67, 29, 37, 87, 80].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0676, Accuracy: 161/568 (28.3451%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1522, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 408/1953 (20.8909%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 753/1953 (38.5561%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7625, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 466/1988 (23.4406%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 676/1988 (34.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0681, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0682, Accuracy: 155/530 (29.2453%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0365, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.6605, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 392/888 (44.1441%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1058, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0748, Accuracy: 61/426 (14.3192%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0394, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.9637, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 415/1440 (28.8194%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 691/1440 (47.9861%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2626, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 427/1129 (37.8211%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 710/1129 (62.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5599, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0574, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3757, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   1, Avg loss: 0.0685, Accuracy: 152/682 (22.2874%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.0613, Accuracy: 57/10000 (0.5700%)
time spent on training: 236.96592092514038
[rfa agg] training data poison_ratio: 0.0  data num: [568, 1953, 1988, 530, 888, 426, 1440, 1129, 1131, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 83, 85, 18, 63, 67, 29, 37, 87, 80], weight: tensor([0.0529, 0.1819, 0.1852, 0.0494, 0.0827, 0.0397, 0.1341, 0.1052, 0.1054,
        0.0635])
[rfa agg] iter:  0, prev_obj_val: 71.08625030517578, obj_val: 74.23870086669922, abs dis: 3.1524505615234375
[rfa agg] iter: 0, weight: tensor([0.0200, 0.0522, 0.0492, 0.0186, 0.0650, 0.0124, 0.1043, 0.3075, 0.3404,
        0.0303])
[rfa agg] iter:  1, prev_obj_val: 74.23870086669922, obj_val: 81.64586639404297, abs dis: 7.40716552734375
[rfa agg] iter: 1, weight: tensor([0.0245, 0.0482, 0.0458, 0.0228, 0.0978, 0.0147, 0.0816, 0.3046, 0.3210,
        0.0390])
[rfa agg] iter:  2, prev_obj_val: 81.64586639404297, obj_val: 83.49546813964844, abs dis: 1.8496017456054688
[rfa agg] iter: 2, weight: tensor([0.0427, 0.0553, 0.0530, 0.0398, 0.2965, 0.0241, 0.0809, 0.1653, 0.1667,
        0.0756])
[rfa agg] iter:  3, prev_obj_val: 83.49546813964844, obj_val: 87.95012664794922, abs dis: 4.454658508300781
[rfa agg] iter: 3, weight: tensor([0.0402, 0.0463, 0.0444, 0.0375, 0.4241, 0.0222, 0.0659, 0.1217, 0.1227,
        0.0748])
[rfa agg] iter:  4, prev_obj_val: 87.95012664794922, obj_val: 90.50603485107422, abs dis: 2.555908203125
[rfa agg] iter: 4, weight: tensor([0.0471, 0.0420, 0.0404, 0.0438, 0.4622, 0.0246, 0.0568, 0.0920, 0.0926,
        0.0986])
[rfa agg] iter:  5, prev_obj_val: 90.50603485107422, obj_val: 90.4969482421875, abs dis: 0.00908660888671875
[rfa agg] iter: 5, weight: tensor([0.0620, 0.0479, 0.0462, 0.0576, 0.3545, 0.0312, 0.0633, 0.0974, 0.0980,
        0.1419])
[rfa agg] iter:  6, prev_obj_val: 90.4969482421875, obj_val: 87.95586395263672, abs dis: 2.5410842895507812
[rfa agg] iter: 6, weight: tensor([0.0628, 0.0484, 0.0467, 0.0584, 0.3454, 0.0316, 0.0640, 0.0986, 0.0992,
        0.1449])
[rfa agg] iter:  7, prev_obj_val: 87.95586395263672, obj_val: 90.50418090820312, abs dis: 2.5483169555664062
[rfa agg] iter: 7, weight: tensor([0.0482, 0.0429, 0.0413, 0.0449, 0.4491, 0.0251, 0.0580, 0.0940, 0.0946,
        0.1018])
[rfa agg] iter:  8, prev_obj_val: 90.50418090820312, obj_val: 90.49694061279297, abs dis: 0.00724029541015625
[rfa agg] iter: 8, weight: tensor([0.0621, 0.0479, 0.0462, 0.0577, 0.3534, 0.0313, 0.0634, 0.0976, 0.0981,
        0.1422])
[rfa agg] iter:  9, prev_obj_val: 90.49694061279297, obj_val: 87.95587158203125, abs dis: 2.5410690307617188
[rfa agg] iter: 9, weight: tensor([0.0628, 0.0484, 0.0467, 0.0584, 0.3453, 0.0316, 0.0640, 0.0986, 0.0992,
        0.1449])
			Update norm = 122.20281233977391 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3175, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.3356, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.7990701198578 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 97, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 332/946 (35.0951%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3012, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2984, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 450/1587 (28.3554%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 634/1587 (39.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7920, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 410/1628 (25.1843%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 814/1628 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4113, Accuracy: 139/10000 (1.3900%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0670, Accuracy: 207/669 (30.9417%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2457, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0749, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0398, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.1224, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   1, Avg loss: 0.0507, Accuracy: 370/1213 (30.5029%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   2, Avg loss: 0.0283, Accuracy: 438/1213 (36.1088%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1360, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0197, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 510/1013 (50.3455%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0774, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0636, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0448, Accuracy: 56/10000 (0.5600%)
time spent on training: 266.24183654785156
[rfa agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 1213, 715, 1013, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 48, 27, 5, 45, 67, 97, 23, 39, 16], weight: tensor([0.0992, 0.0662, 0.1664, 0.1707, 0.0702, 0.0447, 0.1272, 0.0750, 0.1062,
        0.0742])
[rfa agg] iter:  0, prev_obj_val: 52.35744857788086, obj_val: 55.15748977661133, abs dis: 2.8000411987304688
[rfa agg] iter: 0, weight: tensor([0.3262, 0.0449, 0.0488, 0.0456, 0.0608, 0.0183, 0.0857, 0.0887, 0.1927,
        0.0883])
[rfa agg] iter:  1, prev_obj_val: 55.15748977661133, obj_val: 58.352638244628906, abs dis: 3.195148468017578
[rfa agg] iter: 1, weight: tensor([0.2075, 0.0631, 0.0490, 0.0462, 0.0922, 0.0232, 0.0774, 0.1512, 0.1384,
        0.1518])
[rfa agg] iter:  2, prev_obj_val: 58.352638244628906, obj_val: 68.91194915771484, abs dis: 10.559310913085938
[rfa agg] iter: 2, weight: tensor([0.1024, 0.0693, 0.0357, 0.0339, 0.1168, 0.0217, 0.0521, 0.2404, 0.0798,
        0.2479])
[rfa agg] iter:  3, prev_obj_val: 68.91194915771484, obj_val: 72.40164947509766, abs dis: 3.4897003173828125
[rfa agg] iter: 3, weight: tensor([0.0595, 0.2461, 0.0314, 0.0301, 0.2503, 0.0344, 0.0408, 0.1277, 0.0525,
        0.1273])
[rfa agg] iter:  4, prev_obj_val: 72.40164947509766, obj_val: 72.38013458251953, abs dis: 0.021514892578125
[rfa agg] iter: 4, weight: tensor([0.0529, 0.4001, 0.0300, 0.0288, 0.1706, 0.0395, 0.0380, 0.0967, 0.0475,
        0.0959])
[rfa agg] iter:  5, prev_obj_val: 72.38013458251953, obj_val: 68.88981628417969, abs dis: 3.4903182983398438
[rfa agg] iter: 5, weight: tensor([0.0480, 0.4597, 0.0272, 0.0262, 0.1509, 0.0358, 0.0345, 0.0876, 0.0431,
        0.0868])
[rfa agg] iter:  6, prev_obj_val: 68.88981628417969, obj_val: 76.248779296875, abs dis: 7.3589630126953125
[rfa agg] iter: 6, weight: tensor([0.0561, 0.2897, 0.0297, 0.0285, 0.2389, 0.0326, 0.0386, 0.1187, 0.0496,
        0.1177])
[rfa agg] iter:  7, prev_obj_val: 76.248779296875, obj_val: 80.24191284179688, abs dis: 3.993133544921875
[rfa agg] iter: 7, weight: tensor([0.0616, 0.3498, 0.0371, 0.0357, 0.1535, 0.0600, 0.0461, 0.1005, 0.0561,
        0.0996])
[rfa agg] iter:  8, prev_obj_val: 80.24191284179688, obj_val: 62.76842498779297, abs dis: 17.473487854003906
[rfa agg] iter: 8, weight: tensor([0.0711, 0.2687, 0.0451, 0.0435, 0.1469, 0.0927, 0.0550, 0.1061, 0.0655,
        0.1052])
[rfa agg] iter:  9, prev_obj_val: 62.76842498779297, obj_val: 68.88734436035156, abs dis: 6.118919372558594
[rfa agg] iter: 9, weight: tensor([0.0652, 0.1004, 0.0291, 0.0278, 0.2244, 0.0233, 0.0398, 0.2155, 0.0551,
        0.2194])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.7719657421112 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 77, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0557, Accuracy: 309/690 (44.7826%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.1467, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0600, Accuracy: 338/719 (47.0097%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8410, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0529, Accuracy: 322/1013 (31.7868%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 530/1013 (52.3198%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3441, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 378/1573 (24.0305%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 604/1573 (38.3980%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5773, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0564, Accuracy: 394/1427 (27.6104%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 594/1427 (41.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4647, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 320/1340 (23.8806%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 561/1340 (41.8657%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4211, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 432/1440 (30.0000%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2864, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0620, Accuracy: 182/818 (22.2494%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 339/818 (41.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7315, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 269/1513 (17.7792%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 501/1513 (33.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6467, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 280/813 (34.4403%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 477/813 (58.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.1437, Accuracy: 49/10000 (0.4900%)
time spent on training: 248.87169575691223
[rfa agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 1340, 1440, 818, 1513, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 41, 39, 40, 34, 77, 29, 71, 8, 53], weight: tensor([0.0608, 0.0634, 0.0893, 0.1386, 0.1258, 0.1181, 0.1269, 0.0721, 0.1334,
        0.0717])
[rfa agg] iter:  0, prev_obj_val: 51.80048370361328, obj_val: 57.608272552490234, abs dis: 5.807788848876953
[rfa agg] iter: 0, weight: tensor([0.0433, 0.0555, 0.4080, 0.0550, 0.0638, 0.0835, 0.0645, 0.0837, 0.0593,
        0.0835])
[rfa agg] iter:  1, prev_obj_val: 57.608272552490234, obj_val: 61.91657257080078, abs dis: 4.308300018310547
[rfa agg] iter: 1, weight: tensor([0.0659, 0.0919, 0.2182, 0.0508, 0.0567, 0.0695, 0.0573, 0.1690, 0.0539,
        0.1668])
[rfa agg] iter:  2, prev_obj_val: 61.91657257080078, obj_val: 74.59864044189453, abs dis: 12.68206787109375
[rfa agg] iter: 2, weight: tensor([0.0683, 0.1068, 0.1000, 0.0348, 0.0380, 0.0452, 0.0384, 0.2657, 0.0365,
        0.2662])
[rfa agg] iter:  3, prev_obj_val: 74.59864044189453, obj_val: 74.52850341796875, abs dis: 0.07013702392578125
[rfa agg] iter: 3, weight: tensor([0.2480, 0.2164, 0.0635, 0.0332, 0.0353, 0.0401, 0.0357, 0.1466, 0.0345,
        0.1467])
[rfa agg] iter:  4, prev_obj_val: 74.52850341796875, obj_val: 78.47647094726562, abs dis: 3.947967529296875
[rfa agg] iter: 4, weight: tensor([0.2714, 0.2328, 0.0594, 0.0312, 0.0331, 0.0377, 0.0335, 0.1334, 0.0324,
        0.1351])
[rfa agg] iter:  5, prev_obj_val: 78.47647094726562, obj_val: 78.45887756347656, abs dis: 0.0175933837890625
[rfa agg] iter: 5, weight: tensor([0.4139, 0.1627, 0.0538, 0.0302, 0.0318, 0.0359, 0.0322, 0.1039, 0.0312,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 78.45887756347656, obj_val: 74.54718780517578, abs dis: 3.9116897583007812
[rfa agg] iter: 6, weight: tensor([0.4698, 0.1451, 0.0490, 0.0275, 0.0290, 0.0327, 0.0293, 0.0942, 0.0284,
        0.0949])
[rfa agg] iter:  7, prev_obj_val: 74.54718780517578, obj_val: 74.52772521972656, abs dis: 0.01946258544921875
[rfa agg] iter: 7, weight: tensor([0.3025, 0.2184, 0.0579, 0.0304, 0.0323, 0.0367, 0.0326, 0.1277, 0.0315,
        0.1299])
[rfa agg] iter:  8, prev_obj_val: 74.52772521972656, obj_val: 74.52728271484375, abs dis: 0.0004425048828125
[rfa agg] iter: 8, weight: tensor([0.2782, 0.2326, 0.0588, 0.0309, 0.0328, 0.0373, 0.0331, 0.1312, 0.0320,
        0.1331])
			Update norm = 104.22725321383079 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 362.4465608596802 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 91, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0853, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0528, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8538, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0560, Accuracy: 403/1427 (28.2411%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8088, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0610, Accuracy: 181/818 (22.1271%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 333/818 (40.7090%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5947, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2843, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 371/1241 (29.8952%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3507, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 357/1030 (34.6602%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 653/1030 (63.3981%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.0474, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 271/888 (30.5180%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 414/888 (46.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.3163, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0742, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2127, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 166/809 (20.5192%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 352/809 (43.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8343, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7001, Accuracy: 50/10000 (0.5000%)
time spent on training: 207.46220636367798
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 1030, 888, 781, 809, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 34, 71, 11, 72, 91, 63, 3, 50, 24], weight: tensor([0.0484, 0.1694, 0.0971, 0.0845, 0.1473, 0.1222, 0.1054, 0.0927, 0.0960,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 38.0746955871582, obj_val: 46.18341064453125, abs dis: 8.108715057373047
[rfa agg] iter: 0, weight: tensor([0.0122, 0.0257, 0.2232, 0.1086, 0.0319, 0.0454, 0.1273, 0.1985, 0.2201,
        0.0070])
[rfa agg] iter:  1, prev_obj_val: 46.18341064453125, obj_val: 53.293670654296875, abs dis: 7.110260009765625
[rfa agg] iter: 1, weight: tensor([0.0271, 0.0373, 0.1539, 0.2682, 0.0439, 0.0556, 0.1025, 0.1442, 0.1530,
        0.0144])
[rfa agg] iter:  2, prev_obj_val: 53.293670654296875, obj_val: 49.683441162109375, abs dis: 3.6102294921875
[rfa agg] iter: 2, weight: tensor([0.0521, 0.0516, 0.1440, 0.2042, 0.0591, 0.0711, 0.1125, 0.1370, 0.1429,
        0.0256])
[rfa agg] iter:  3, prev_obj_val: 49.683441162109375, obj_val: 46.15168762207031, abs dis: 3.5317535400390625
[rfa agg] iter: 3, weight: tensor([0.0382, 0.0449, 0.1478, 0.2372, 0.0521, 0.0642, 0.1089, 0.1403, 0.1468,
        0.0196])
[rfa agg] iter:  4, prev_obj_val: 46.15168762207031, obj_val: 56.940086364746094, abs dis: 10.788398742675781
[rfa agg] iter: 4, weight: tensor([0.0265, 0.0364, 0.1481, 0.2900, 0.0428, 0.0543, 0.1002, 0.1400, 0.1476,
        0.0141])
[rfa agg] iter:  5, prev_obj_val: 56.940086364746094, obj_val: 49.685611724853516, abs dis: 7.254474639892578
[rfa agg] iter: 5, weight: tensor([0.0692, 0.0569, 0.1387, 0.1799, 0.0643, 0.0757, 0.1134, 0.1321, 0.1375,
        0.0322])
[rfa agg] iter:  6, prev_obj_val: 49.685611724853516, obj_val: 46.15178680419922, abs dis: 3.533824920654297
[rfa agg] iter: 6, weight: tensor([0.0383, 0.0450, 0.1481, 0.2361, 0.0521, 0.0643, 0.1091, 0.1405, 0.1469,
        0.0196])
[rfa agg] iter:  7, prev_obj_val: 46.15178680419922, obj_val: 56.9400749206543, abs dis: 10.788288116455078
[rfa agg] iter: 7, weight: tensor([0.0265, 0.0364, 0.1481, 0.2898, 0.0428, 0.0543, 0.1002, 0.1401, 0.1476,
        0.0141])
[rfa agg] iter:  8, prev_obj_val: 56.9400749206543, obj_val: 49.685611724853516, abs dis: 7.254463195800781
[rfa agg] iter: 8, weight: tensor([0.0692, 0.0569, 0.1387, 0.1799, 0.0643, 0.0757, 0.1134, 0.1321, 0.1375,
        0.0322])
[rfa agg] iter:  9, prev_obj_val: 49.685611724853516, obj_val: 46.15178680419922, abs dis: 3.533824920654297
[rfa agg] iter: 9, weight: tensor([0.0383, 0.0450, 0.1481, 0.2361, 0.0521, 0.0643, 0.1091, 0.1405, 0.1469,
        0.0196])
			Update norm = 104.21420061284834 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.5601041316986 sec.
Server Epoch:92 choose agents : [92, 90, 77, 1, 58, 42, 96, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 435/1715 (25.3644%)
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 720/1715 (41.9825%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8533, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0508, Accuracy: 359/677 (53.0281%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0213, Accuracy: 445/677 (65.7312%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4069, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 326/1340 (24.3284%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 533/1340 (39.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1284, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0578, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 544/928 (58.6207%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4368, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 399/803 (49.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.2719, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0542, Accuracy: 327/1372 (23.8338%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 486/1372 (35.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2495, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0531, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.4968, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 235/1013 (23.1984%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 371/1013 (36.6239%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.1292, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 419/1440 (29.0972%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 677/1440 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4818, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0794, Accuracy: 89/486 (18.3128%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.3440, Accuracy: 48/10000 (0.4800%)
time spent on training: 229.14390444755554
[rfa agg] training data poison_ratio: 0.0  data num: [1715, 677, 1340, 928, 803, 1372, 311, 1013, 1440, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [92, 90, 77, 1, 58, 42, 96, 14, 29, 30], weight: tensor([0.1701, 0.0671, 0.1329, 0.0920, 0.0796, 0.1360, 0.0308, 0.1004, 0.1428,
        0.0482])
[rfa agg] iter:  0, prev_obj_val: 51.56639099121094, obj_val: 57.96051788330078, abs dis: 6.394126892089844
[rfa agg] iter: 0, weight: tensor([0.0525, 0.0395, 0.0942, 0.1746, 0.0724, 0.0789, 0.0087, 0.3898, 0.0709,
        0.0184])
[rfa agg] iter:  1, prev_obj_val: 57.96051788330078, obj_val: 62.76851272583008, abs dis: 4.807994842529297
[rfa agg] iter: 1, weight: tensor([0.0434, 0.0603, 0.0648, 0.3284, 0.1525, 0.0574, 0.0104, 0.2057, 0.0535,
        0.0236])
[rfa agg] iter:  2, prev_obj_val: 62.76851272583008, obj_val: 65.34834289550781, abs dis: 2.5798301696777344
[rfa agg] iter: 2, weight: tensor([0.0437, 0.0904, 0.0612, 0.1982, 0.3200, 0.0552, 0.0126, 0.1362, 0.0521,
        0.0303])
[rfa agg] iter:  3, prev_obj_val: 65.34834289550781, obj_val: 62.72712707519531, abs dis: 2.6212158203125
[rfa agg] iter: 3, weight: tensor([0.0374, 0.0986, 0.0509, 0.1332, 0.4471, 0.0462, 0.0118, 0.1012, 0.0439,
        0.0295])
[rfa agg] iter:  4, prev_obj_val: 62.72712707519531, obj_val: 65.33356475830078, abs dis: 2.6064376831054688
[rfa agg] iter: 4, weight: tensor([0.0404, 0.0833, 0.0565, 0.1729, 0.3834, 0.0509, 0.0116, 0.1249, 0.0481,
        0.0280])
[rfa agg] iter:  5, prev_obj_val: 65.33356475830078, obj_val: 68.26801300048828, abs dis: 2.9344482421875
[rfa agg] iter: 5, weight: tensor([0.0357, 0.0940, 0.0487, 0.1266, 0.4727, 0.0442, 0.0113, 0.0966, 0.0419,
        0.0282])
[rfa agg] iter:  6, prev_obj_val: 68.26801300048828, obj_val: 62.72750473022461, abs dis: 5.540508270263672
[rfa agg] iter: 6, weight: tensor([0.0396, 0.1379, 0.0526, 0.1182, 0.4124, 0.0481, 0.0138, 0.0955, 0.0459,
        0.0360])
[rfa agg] iter:  7, prev_obj_val: 62.72750473022461, obj_val: 62.72100067138672, abs dis: 0.006504058837890625
[rfa agg] iter: 7, weight: tensor([0.0408, 0.0845, 0.0571, 0.1745, 0.3771, 0.0514, 0.0117, 0.1261, 0.0486,
        0.0283])
[rfa agg] iter:  8, prev_obj_val: 62.72100067138672, obj_val: 62.72091293334961, abs dis: 8.7738037109375e-05
[rfa agg] iter: 8, weight: tensor([0.0412, 0.0851, 0.0576, 0.1788, 0.3683, 0.0519, 0.0118, 0.1277, 0.0490,
        0.0286])
			Update norm = 121.96800137484831 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.23423433303833 sec.
Server Epoch:93 choose agents : [76, 7, 35, 2, 94, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   1, Avg loss: 0.0815, Accuracy: 70/466 (15.0215%)
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.2216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 461/891 (51.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4750, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0875, Accuracy: 25/271 (9.2251%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.5561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 236/605 (39.0083%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.6492, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1662 (37.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1287, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.5760, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 448/1904 (23.5294%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 708/1904 (37.1849%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.2643, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0751, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0400, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.1192, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 258/1071 (24.0896%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 499/1071 (46.5920%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.7390, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5906, Accuracy: 69/10000 (0.6900%)
time spent on training: 222.5149381160736
[rfa agg] training data poison_ratio: 0.0  data num: [466, 891, 271, 605, 1662, 1154, 1904, 426, 1071, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 7, 35, 2, 94, 15, 46, 67, 55, 73], weight: tensor([0.0496, 0.0949, 0.0289, 0.0644, 0.1770, 0.1229, 0.2028, 0.0454, 0.1141,
        0.0999])
[rfa agg] iter:  0, prev_obj_val: 61.72172927856445, obj_val: 64.9896011352539, abs dis: 3.267871856689453
[rfa agg] iter: 0, weight: tensor([0.0188, 0.1168, 0.0081, 0.0319, 0.0599, 0.1499, 0.0484, 0.0154, 0.3547,
        0.1961])
[rfa agg] iter:  1, prev_obj_val: 64.9896011352539, obj_val: 68.74730682373047, abs dis: 3.7577056884765625
[rfa agg] iter: 1, weight: tensor([0.0190, 0.1968, 0.0078, 0.0345, 0.0432, 0.0811, 0.0363, 0.0152, 0.1462,
        0.4199])
[rfa agg] iter:  2, prev_obj_val: 68.74730682373047, obj_val: 73.79508972167969, abs dis: 5.047782897949219
[rfa agg] iter: 2, weight: tensor([0.0239, 0.3787, 0.0093, 0.0463, 0.0428, 0.0705, 0.0368, 0.0188, 0.1062,
        0.2666])
[rfa agg] iter:  3, prev_obj_val: 73.79508972167969, obj_val: 76.51151275634766, abs dis: 2.7164230346679688
[rfa agg] iter: 3, weight: tensor([0.0399, 0.3370, 0.0146, 0.0850, 0.0551, 0.0822, 0.0483, 0.0305, 0.1127,
        0.1947])
[rfa agg] iter:  4, prev_obj_val: 76.51151275634766, obj_val: 73.79275512695312, abs dis: 2.7187576293945312
[rfa agg] iter: 4, weight: tensor([0.0510, 0.2758, 0.0179, 0.1167, 0.0611, 0.0876, 0.0540, 0.0383, 0.1161,
        0.1815])
[rfa agg] iter:  5, prev_obj_val: 73.79275512695312, obj_val: 76.51087188720703, abs dis: 2.7181167602539062
[rfa agg] iter: 5, weight: tensor([0.0404, 0.3294, 0.0147, 0.0864, 0.0557, 0.0832, 0.0488, 0.0309, 0.1142,
        0.1962])
[rfa agg] iter:  6, prev_obj_val: 76.51087188720703, obj_val: 73.79280090332031, abs dis: 2.7180709838867188
[rfa agg] iter: 6, weight: tensor([0.0510, 0.2754, 0.0179, 0.1168, 0.0611, 0.0876, 0.0541, 0.0383, 0.1162,
        0.1816])
[rfa agg] iter:  7, prev_obj_val: 73.79280090332031, obj_val: 76.51087188720703, abs dis: 2.7180709838867188
[rfa agg] iter: 7, weight: tensor([0.0404, 0.3293, 0.0147, 0.0864, 0.0557, 0.0832, 0.0488, 0.0309, 0.1142,
        0.1962])
[rfa agg] iter:  8, prev_obj_val: 76.51087188720703, obj_val: 73.79280090332031, abs dis: 2.7180709838867188
[rfa agg] iter: 8, weight: tensor([0.0510, 0.2754, 0.0179, 0.1168, 0.0611, 0.0876, 0.0541, 0.0383, 0.1162,
        0.1816])
[rfa agg] iter:  9, prev_obj_val: 73.79280090332031, obj_val: 76.51087188720703, abs dis: 2.7180709838867188
[rfa agg] iter: 9, weight: tensor([0.0404, 0.3293, 0.0147, 0.0864, 0.0557, 0.0832, 0.0488, 0.0309, 0.1142,
        0.1962])
			Update norm = 113.11494257778236 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.2379341125488 sec.
Server Epoch:94 choose agents : [54, 23, 97, 0, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0535, Accuracy: 357/1130 (31.5929%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 493/1130 (43.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4426, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0584, Accuracy: 347/715 (48.5315%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.1342, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0503, Accuracy: 372/1213 (30.6678%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 512/1213 (42.2094%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4075, Accuracy: 74/10000 (0.7400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 348/1657 (21.0018%)
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 500/1657 (30.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8753, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 401/1581 (25.3637%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 612/1581 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9669, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0518, Accuracy: 323/636 (50.7862%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0295, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9733, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0692, Accuracy: 109/631 (17.2742%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0405, Accuracy: 232/631 (36.7670%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3289, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.6775, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 385/1628 (23.6486%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 808/1628 (49.6314%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4599, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 106/781 (13.5723%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 236/781 (30.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2376, Accuracy: 69/10000 (0.6900%)
time spent on training: 248.9094262123108
[rfa agg] training data poison_ratio: 0.16112407623492805  data num: [1130, 715, 1213, 1657, 1581, 636, 631, 312, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.05035127382341502
[rfa agg] init. name: [54, 23, 97, 0, 28, 52, 48, 24, 5, 3], weight: tensor([0.1099, 0.0695, 0.1180, 0.1611, 0.1537, 0.0618, 0.0614, 0.0303, 0.1583,
        0.0759])
[rfa agg] iter:  0, prev_obj_val: 57.40792465209961, obj_val: 62.57631301879883, abs dis: 5.168388366699219
[rfa agg] iter: 0, weight: tensor([0.3468, 0.0557, 0.2201, 0.0721, 0.0774, 0.0357, 0.0354, 0.0102, 0.0709,
        0.0758])
[rfa agg] iter:  1, prev_obj_val: 62.57631301879883, obj_val: 62.56005096435547, abs dis: 0.016262054443359375
[rfa agg] iter: 1, weight: tensor([0.2187, 0.0990, 0.1684, 0.0780, 0.0823, 0.0571, 0.0566, 0.0147, 0.0766,
        0.1484])
			Update norm = 139.70977870437343 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3203, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.3441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.9962215423584 sec.
Server Epoch:95 choose agents : [80, 4, 1, 10, 41, 2, 58, 11, 29, 78].
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.8700, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2381, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 565/928 (60.8836%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9926, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 212/861 (24.6225%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 428/861 (49.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.2788, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.9159, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 246/605 (40.6612%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.2286, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.3332, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0532, Accuracy: 354/712 (49.7191%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2347, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 433/1440 (30.0694%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 669/1440 (46.4583%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8505, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0803, Accuracy: 50/416 (12.0192%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0449, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.0051, Accuracy: 51/10000 (0.5100%)
time spent on training: 211.88685154914856
[rfa agg] training data poison_ratio: 0.0  data num: [682, 901, 928, 861, 719, 605, 803, 712, 1440, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 4, 1, 10, 41, 2, 58, 11, 29, 78], weight: tensor([0.0845, 0.1117, 0.1150, 0.1067, 0.0891, 0.0750, 0.0995, 0.0883, 0.1785,
        0.0516])
[rfa agg] iter:  0, prev_obj_val: 32.72690200805664, obj_val: 40.41145324707031, abs dis: 7.684551239013672
[rfa agg] iter: 0, weight: tensor([0.1157, 0.0590, 0.0612, 0.0824, 0.2166, 0.0584, 0.1365, 0.2268, 0.0267,
        0.0168])
[rfa agg] iter:  1, prev_obj_val: 40.41145324707031, obj_val: 51.32262420654297, abs dis: 10.911170959472656
[rfa agg] iter: 1, weight: tensor([0.2305, 0.0546, 0.0563, 0.0668, 0.1243, 0.1925, 0.0866, 0.1242, 0.0319,
        0.0324])
[rfa agg] iter:  2, prev_obj_val: 51.32262420654297, obj_val: 40.35407257080078, abs dis: 10.968551635742188
[rfa agg] iter: 2, weight: tensor([0.1439, 0.0649, 0.0670, 0.0744, 0.1023, 0.2277, 0.0866, 0.1016, 0.0449,
        0.0867])
[rfa agg] iter:  3, prev_obj_val: 40.35407257080078, obj_val: 47.440189361572266, abs dis: 7.086116790771484
[rfa agg] iter: 3, weight: tensor([0.2339, 0.0525, 0.0543, 0.0642, 0.1170, 0.2162, 0.0831, 0.1168, 0.0307,
        0.0313])
[rfa agg] iter:  4, prev_obj_val: 47.440189361572266, obj_val: 51.31774139404297, abs dis: 3.877552032470703
[rfa agg] iter: 4, weight: tensor([0.1535, 0.0580, 0.0599, 0.0677, 0.0997, 0.2853, 0.0809, 0.0990, 0.0382,
        0.0579])
[rfa agg] iter:  5, prev_obj_val: 51.31774139404297, obj_val: 43.72626876831055, abs dis: 7.591472625732422
[rfa agg] iter: 5, weight: tensor([0.1421, 0.0645, 0.0666, 0.0739, 0.1016, 0.2335, 0.0861, 0.1008, 0.0446,
        0.0864])
[rfa agg] iter:  6, prev_obj_val: 43.72626876831055, obj_val: 51.32170867919922, abs dis: 7.595439910888672
[rfa agg] iter: 6, weight: tensor([0.1701, 0.0515, 0.0533, 0.0614, 0.0991, 0.3183, 0.0760, 0.0986, 0.0321,
        0.0395])
[rfa agg] iter:  7, prev_obj_val: 51.32170867919922, obj_val: 43.725990295410156, abs dis: 7.5957183837890625
[rfa agg] iter: 7, weight: tensor([0.1419, 0.0644, 0.0665, 0.0738, 0.1013, 0.2351, 0.0859, 0.1005, 0.0445,
        0.0861])
[rfa agg] iter:  8, prev_obj_val: 43.725990295410156, obj_val: 51.32175064086914, abs dis: 7.595760345458984
[rfa agg] iter: 8, weight: tensor([0.1700, 0.0515, 0.0532, 0.0614, 0.0990, 0.3188, 0.0760, 0.0985, 0.0321,
        0.0395])
[rfa agg] iter:  9, prev_obj_val: 51.32175064086914, obj_val: 43.725990295410156, abs dis: 7.595760345458984
[rfa agg] iter: 9, weight: tensor([0.1419, 0.0644, 0.0665, 0.0738, 0.1013, 0.2351, 0.0859, 0.1005, 0.0445,
        0.0861])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3230, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.3511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.6921880245209 sec.
Server Epoch:96 choose agents : [78, 9, 2, 30, 42, 95, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   1, Avg loss: 0.0800, Accuracy: 60/416 (14.4231%)
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 179/416 (43.0288%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.1555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 352/1275 (27.6078%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 715/1275 (56.0784%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0437, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0604, Accuracy: 259/605 (42.8099%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4403, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 87/486 (17.9012%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0428, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4565, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 334/1372 (24.3440%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0318, Accuracy: 486/1372 (35.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1412, Accuracy: 101/10000 (1.0100%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   1, Avg loss: 0.0511, Accuracy: 346/599 (57.7629%)
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.5325, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1180, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3378, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.0701, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0552, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6170, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 634/1956 (32.4131%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1800, Accuracy: 111/10000 (1.1100%)
time spent on training: 227.11114406585693
[rfa agg] training data poison_ratio: 0.06862183526177111  data num: [416, 1275, 605, 486, 1372, 599, 85, 781, 1154, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.021444323519303473
[rfa agg] init. name: [78, 9, 2, 30, 42, 95, 61, 3, 15, 6], weight: tensor([0.0477, 0.1461, 0.0693, 0.0557, 0.1572, 0.0686, 0.0097, 0.0895, 0.1322,
        0.2241])
[rfa agg] iter:  0, prev_obj_val: 65.27259063720703, obj_val: 66.62705993652344, abs dis: 1.3544692993164062
[rfa agg] iter: 0, weight: tensor([0.0260, 0.2108, 0.0552, 0.0340, 0.1467, 0.0546, 0.0035, 0.1301, 0.2590,
        0.0802])
[rfa agg] iter:  1, prev_obj_val: 66.62705993652344, obj_val: 66.62596893310547, abs dis: 0.00109100341796875
[rfa agg] iter: 1, weight: tensor([0.0287, 0.1945, 0.0624, 0.0377, 0.1406, 0.0618, 0.0038, 0.1577, 0.2321,
        0.0809])
			Update norm = 143.98383834001996 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3230, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.3511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.1473093032837 sec.
Server Epoch:97 choose agents : [38, 36, 84, 75, 85, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 254/1131 (22.4580%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 514/1131 (45.4465%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5572, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0841, Accuracy: 88/408 (21.5686%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0519, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.9853, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 328/1190 (27.5630%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6100, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   1, Avg loss: 0.0656, Accuracy: 251/776 (32.3454%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 392/776 (50.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3534, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 424/1988 (21.3280%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 707/1988 (35.5634%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.1857, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0590, Accuracy: 289/1513 (19.1011%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 483/1513 (31.9233%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5257, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 442/1587 (27.8513%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 624/1587 (39.3195%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4118, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0598, Accuracy: 346/719 (48.1224%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 448/719 (62.3088%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.2380, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4965, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0531, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 509/1130 (45.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.2889, Accuracy: 58/10000 (0.5800%)
time spent on training: 262.7244162559509
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 1190, 776, 1988, 1513, 1587, 719, 1446, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 84, 75, 85, 8, 27, 41, 26, 54], weight: tensor([0.0951, 0.0343, 0.1001, 0.0653, 0.1672, 0.1273, 0.1335, 0.0605, 0.1216,
        0.0951])
[rfa agg] iter:  0, prev_obj_val: 51.09113311767578, obj_val: 53.95342254638672, abs dis: 2.8622894287109375
[rfa agg] iter: 0, weight: tensor([0.2011, 0.0079, 0.2933, 0.0297, 0.0353, 0.0687, 0.0605, 0.0236, 0.0819,
        0.1982])
[rfa agg] iter:  1, prev_obj_val: 53.95342254638672, obj_val: 59.02762222290039, abs dis: 5.074199676513672
[rfa agg] iter: 1, weight: tensor([0.2953, 0.0072, 0.1879, 0.0298, 0.0275, 0.0483, 0.0437, 0.0231, 0.0555,
        0.2819])
[rfa agg] iter:  2, prev_obj_val: 59.02762222290039, obj_val: 61.91725540161133, abs dis: 2.8896331787109375
[rfa agg] iter: 2, weight: tensor([0.2644, 0.0114, 0.1535, 0.0530, 0.0370, 0.0597, 0.0551, 0.0397, 0.0668,
        0.2594])
[rfa agg] iter:  3, prev_obj_val: 61.91725540161133, obj_val: 59.025421142578125, abs dis: 2.891834259033203
[rfa agg] iter: 3, weight: tensor([0.2317, 0.0144, 0.1516, 0.0726, 0.0431, 0.0672, 0.0625, 0.0529, 0.0743,
        0.2296])
[rfa agg] iter:  4, prev_obj_val: 59.025421142578125, obj_val: 61.91697692871094, abs dis: 2.8915557861328125
[rfa agg] iter: 4, weight: tensor([0.2620, 0.0115, 0.1543, 0.0537, 0.0373, 0.0603, 0.0556, 0.0401, 0.0674,
        0.2579])
[rfa agg] iter:  5, prev_obj_val: 61.91697692871094, obj_val: 59.025428771972656, abs dis: 2.8915481567382812
[rfa agg] iter: 5, weight: tensor([0.2316, 0.0144, 0.1516, 0.0726, 0.0431, 0.0673, 0.0625, 0.0529, 0.0743,
        0.2296])
[rfa agg] iter:  6, prev_obj_val: 59.025428771972656, obj_val: 61.91697311401367, abs dis: 2.8915443420410156
[rfa agg] iter: 6, weight: tensor([0.2620, 0.0115, 0.1543, 0.0537, 0.0373, 0.0603, 0.0556, 0.0401, 0.0674,
        0.2579])
[rfa agg] iter:  7, prev_obj_val: 61.91697311401367, obj_val: 59.025428771972656, abs dis: 2.8915443420410156
[rfa agg] iter: 7, weight: tensor([0.2316, 0.0144, 0.1516, 0.0726, 0.0431, 0.0673, 0.0625, 0.0529, 0.0743,
        0.2296])
[rfa agg] iter:  8, prev_obj_val: 59.025428771972656, obj_val: 61.91697311401367, abs dis: 2.8915443420410156
[rfa agg] iter: 8, weight: tensor([0.2620, 0.0115, 0.1543, 0.0537, 0.0373, 0.0603, 0.0556, 0.0401, 0.0674,
        0.2579])
[rfa agg] iter:  9, prev_obj_val: 61.91697311401367, obj_val: 59.025428771972656, abs dis: 2.8915443420410156
[rfa agg] iter: 9, weight: tensor([0.2316, 0.0144, 0.1516, 0.0726, 0.0431, 0.0673, 0.0625, 0.0529, 0.0743,
        0.2296])
			Update norm = 152.89938736388058 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3230, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.3511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.36038303375244 sec.
Server Epoch:98 choose agents : [70, 56, 62, 90, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 333/1418 (23.4838%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 681/1418 (48.0254%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0394, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 79/186 (42.4731%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3621, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2088, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   1, Avg loss: 0.0512, Accuracy: 359/677 (53.0281%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 420/677 (62.0384%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2824, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 225/1241 (18.1305%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 420/1241 (33.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.5698, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0365, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2542, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 311/690 (45.0725%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1860, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0763, Accuracy: 76/515 (14.7573%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0486, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.1343, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 519/1470 (35.3061%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3970, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0538, Accuracy: 303/1154 (26.2565%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 531/1154 (46.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.5242, Accuracy: 79/10000 (0.7900%)
time spent on training: 217.269437789917
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 677, 1241, 708, 690, 515, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 56, 62, 90, 72, 16, 25, 33, 22, 57], weight: tensor([0.1644, 0.0216, 0.0658, 0.0785, 0.1439, 0.0821, 0.0800, 0.0597, 0.1704,
        0.1338])
[rfa agg] iter:  0, prev_obj_val: 53.6451416015625, obj_val: 56.70929718017578, abs dis: 3.0641555786132812
[rfa agg] iter: 0, weight: tensor([0.0986, 0.0096, 0.0610, 0.1133, 0.1323, 0.1627, 0.1155, 0.0553, 0.1023,
        0.1495])
[rfa agg] iter:  1, prev_obj_val: 56.70929718017578, obj_val: 57.780616760253906, abs dis: 1.071319580078125
[rfa agg] iter: 1, weight: tensor([0.0640, 0.0084, 0.0636, 0.1477, 0.0797, 0.2758, 0.1506, 0.0576, 0.0664,
        0.0863])
[rfa agg] iter:  2, prev_obj_val: 57.780616760253906, obj_val: 60.708106994628906, abs dis: 2.927490234375
[rfa agg] iter: 2, weight: tensor([0.0480, 0.0070, 0.0571, 0.1521, 0.0586, 0.3578, 0.1551, 0.0517, 0.0498,
        0.0628])
[rfa agg] iter:  3, prev_obj_val: 60.708106994628906, obj_val: 65.51904296875, abs dis: 4.810935974121094
[rfa agg] iter: 3, weight: tensor([0.0313, 0.0056, 0.0562, 0.2362, 0.0370, 0.2710, 0.2405, 0.0507, 0.0325,
        0.0389])
[rfa agg] iter:  4, prev_obj_val: 65.51904296875, obj_val: 71.79476928710938, abs dis: 6.275726318359375
[rfa agg] iter: 4, weight: tensor([0.0313, 0.0068, 0.0968, 0.2714, 0.0359, 0.1238, 0.2775, 0.0867, 0.0324,
        0.0373])
[rfa agg] iter:  5, prev_obj_val: 71.79476928710938, obj_val: 71.74358367919922, abs dis: 0.05118560791015625
[rfa agg] iter: 5, weight: tensor([0.0348, 0.0094, 0.2449, 0.1436, 0.0391, 0.0915, 0.1468, 0.2138, 0.0361,
        0.0401])
[rfa agg] iter:  6, prev_obj_val: 71.74358367919922, obj_val: 71.74303436279297, abs dis: 0.00054931640625
[rfa agg] iter: 6, weight: tensor([0.0331, 0.0090, 0.2620, 0.1340, 0.0372, 0.0868, 0.1377, 0.2275, 0.0344,
        0.0382])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3259, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.3609, Accuracy: 0/9950 (0.0000%)
saving model
Done in 331.19320845603943 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 82, 38, 62, 93, 79].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.7188, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0772, Accuracy: 43/440 (9.7727%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0462, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.0736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0873, Accuracy: 27/271 (9.9631%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0565, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.6192, Accuracy: 36/10000 (0.3600%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0626, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 384/1402 (27.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1541, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0556, Accuracy: 328/690 (47.5362%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.0518, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0741, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1664, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 256/1131 (22.6348%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 504/1131 (44.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.6940, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0658, Accuracy: 164/568 (28.8732%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1509, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 429/1742 (24.6269%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 696/1742 (39.9541%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3320, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   1, Avg loss: 0.1021, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.4138, Accuracy: 50/10000 (0.5000%)
time spent on training: 197.08254623413086
[rfa agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 500, 1131, 568, 1742, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 49, 35, 66, 25, 82, 38, 62, 93, 79], weight: tensor([0.0430, 0.0607, 0.0374, 0.1933, 0.0951, 0.0689, 0.1559, 0.0783, 0.2402,
        0.0272])
[rfa agg] iter:  0, prev_obj_val: 70.7862319946289, obj_val: 72.33747863769531, abs dis: 1.5512466430664062
[rfa agg] iter: 0, weight: tensor([0.0268, 0.0473, 0.0233, 0.1714, 0.1463, 0.0613, 0.3117, 0.0812, 0.1152,
        0.0154])
[rfa agg] iter:  1, prev_obj_val: 72.33747863769531, obj_val: 73.9363021850586, abs dis: 1.5988235473632812
[rfa agg] iter: 1, weight: tensor([0.0302, 0.0548, 0.0263, 0.1524, 0.1959, 0.0725, 0.2435, 0.0986, 0.1085,
        0.0172])
[rfa agg] iter:  2, prev_obj_val: 73.9363021850586, obj_val: 75.5738754272461, abs dis: 1.6375732421875
[rfa agg] iter: 2, weight: tensor([0.0316, 0.0593, 0.0274, 0.1260, 0.2674, 0.0807, 0.1815, 0.1142, 0.0941,
        0.0177])
[rfa agg] iter:  3, prev_obj_val: 75.5738754272461, obj_val: 78.88671112060547, abs dis: 3.312835693359375
[rfa agg] iter: 3, weight: tensor([0.0288, 0.0567, 0.0250, 0.0904, 0.3914, 0.0802, 0.1208, 0.1207, 0.0703,
        0.0159])
[rfa agg] iter:  4, prev_obj_val: 78.88671112060547, obj_val: 82.20521545410156, abs dis: 3.3185043334960938
[rfa agg] iter: 4, weight: tensor([0.0254, 0.0561, 0.0221, 0.0547, 0.4667, 0.0881, 0.0673, 0.1614, 0.0447,
        0.0136])
[rfa agg] iter:  5, prev_obj_val: 82.20521545410156, obj_val: 82.1465835571289, abs dis: 0.05863189697265625
[rfa agg] iter: 5, weight: tensor([0.0306, 0.0769, 0.0266, 0.0497, 0.1986, 0.1403, 0.0587, 0.3610, 0.0418,
        0.0158])
[rfa agg] iter:  6, prev_obj_val: 82.1465835571289, obj_val: 80.50011444091797, abs dis: 1.6464691162109375
[rfa agg] iter: 6, weight: tensor([0.0290, 0.0732, 0.0252, 0.0471, 0.1820, 0.1351, 0.0556, 0.3982, 0.0396,
        0.0150])
[rfa agg] iter:  7, prev_obj_val: 80.50011444091797, obj_val: 86.20311737060547, abs dis: 5.7030029296875
[rfa agg] iter: 7, weight: tensor([0.0305, 0.0714, 0.0265, 0.0572, 0.2956, 0.1201, 0.0689, 0.2663, 0.0474,
        0.0160])
[rfa agg] iter:  8, prev_obj_val: 86.20311737060547, obj_val: 91.44786071777344, abs dis: 5.244743347167969
[rfa agg] iter: 8, weight: tensor([0.0326, 0.1045, 0.0283, 0.0383, 0.1001, 0.2749, 0.0438, 0.3285, 0.0330,
        0.0160])
[rfa agg] iter:  9, prev_obj_val: 91.44786071777344, obj_val: 97.85321807861328, abs dis: 6.405357360839844
[rfa agg] iter: 9, weight: tensor([0.0458, 0.2689, 0.0397, 0.0359, 0.0723, 0.3076, 0.0399, 0.1376, 0.0316,
        0.0206])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3285, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.3758, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.33514428138733 sec.
Server Epoch:100 choose agents : [47, 65, 86, 24, 39, 5, 1, 53, 88, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1191, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1069, Accuracy: 30/134 (22.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3605, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 407/1475 (27.5932%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 687/1475 (46.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7002, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 358/1003 (35.6929%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.9677, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0761, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.8446, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0526, Accuracy: 320/1013 (31.5893%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1952, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 393/1628 (24.1400%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 815/1628 (50.0614%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.7125, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4892, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 277/813 (34.0713%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 431/813 (53.0135%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.2531, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   1, Avg loss: 0.0751, Accuracy: 127/603 (21.0614%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.5871, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0566, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 428/803 (53.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.3531, Accuracy: 57/10000 (0.5700%)
time spent on training: 219.23308444023132
[rfa agg] training data poison_ratio: 0.0  data num: [134, 1475, 1003, 312, 1013, 1628, 928, 813, 603, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 65, 86, 24, 39, 5, 1, 53, 88, 58], weight: tensor([0.0154, 0.1693, 0.1151, 0.0358, 0.1163, 0.1869, 0.1065, 0.0933, 0.0692,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 46.34102249145508, obj_val: 51.81902313232422, abs dis: 5.478000640869141
[rfa agg] iter: 0, weight: tensor([0.0026, 0.0419, 0.2572, 0.0072, 0.2620, 0.0375, 0.2137, 0.0765, 0.0264,
        0.0749])
[rfa agg] iter:  1, prev_obj_val: 51.81902313232422, obj_val: 59.828006744384766, abs dis: 8.008983612060547
[rfa agg] iter: 1, weight: tensor([0.0035, 0.0385, 0.1062, 0.0101, 0.1081, 0.0358, 0.1498, 0.2662, 0.0464,
        0.2354])
[rfa agg] iter:  2, prev_obj_val: 59.828006744384766, obj_val: 56.629051208496094, abs dis: 3.198955535888672
[rfa agg] iter: 2, weight: tensor([0.0053, 0.0438, 0.0879, 0.0159, 0.0890, 0.0415, 0.1064, 0.2619, 0.1022,
        0.2460])
[rfa agg] iter:  3, prev_obj_val: 56.629051208496094, obj_val: 59.82716751098633, abs dis: 3.1981163024902344
[rfa agg] iter: 3, weight: tensor([0.0038, 0.0348, 0.0760, 0.0113, 0.0768, 0.0328, 0.0951, 0.3211, 0.0636,
        0.2847])
[rfa agg] iter:  4, prev_obj_val: 59.82716751098633, obj_val: 56.62840270996094, abs dis: 3.1987648010253906
[rfa agg] iter: 4, weight: tensor([0.0053, 0.0435, 0.0871, 0.0158, 0.0880, 0.0412, 0.1049, 0.2637, 0.1014,
        0.2493])
[rfa agg] iter:  5, prev_obj_val: 56.62840270996094, obj_val: 59.827213287353516, abs dis: 3.198810577392578
[rfa agg] iter: 5, weight: tensor([0.0038, 0.0348, 0.0759, 0.0113, 0.0767, 0.0327, 0.0950, 0.3211, 0.0636,
        0.2852])
[rfa agg] iter:  6, prev_obj_val: 59.827213287353516, obj_val: 56.62839889526367, abs dis: 3.1988143920898438
[rfa agg] iter: 6, weight: tensor([0.0053, 0.0435, 0.0871, 0.0158, 0.0880, 0.0412, 0.1049, 0.2637, 0.1014,
        0.2493])
[rfa agg] iter:  7, prev_obj_val: 56.62839889526367, obj_val: 59.827213287353516, abs dis: 3.1988143920898438
[rfa agg] iter: 7, weight: tensor([0.0038, 0.0348, 0.0759, 0.0113, 0.0767, 0.0327, 0.0950, 0.3211, 0.0636,
        0.2852])
[rfa agg] iter:  8, prev_obj_val: 59.827213287353516, obj_val: 56.62839889526367, abs dis: 3.1988143920898438
[rfa agg] iter: 8, weight: tensor([0.0053, 0.0435, 0.0871, 0.0158, 0.0880, 0.0412, 0.1049, 0.2637, 0.1014,
        0.2493])
[rfa agg] iter:  9, prev_obj_val: 56.62839889526367, obj_val: 59.827213287353516, abs dis: 3.1988143920898438
[rfa agg] iter: 9, weight: tensor([0.0038, 0.0348, 0.0759, 0.0113, 0.0767, 0.0327, 0.0950, 0.3211, 0.0636,
        0.2852])
			Update norm = 108.12422777903433 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3285, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.3758, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.7349925041199 sec.
Saving all the graphs.
This run has a label: Jun.30_09.23.44. Visdom environment: tiny
