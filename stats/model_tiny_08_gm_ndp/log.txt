current path: saved_models/model_tiny_Jun.27_22.30.43
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 10, 30, 44, 55]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [89, 91, 69, 74, 59, 60, 29, 99, 17, 84].
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 326/896 (36.3839%)
_Train Local_ResNet_18, epoch   1, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   1, Avg loss: 0.0517, Accuracy: 333/1030 (32.3301%)
_Train Local_ResNet_18, epoch   1, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 613/1030 (59.5146%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.4582, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch   1, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8772, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 478/1552 (30.7990%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 758/1552 (48.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.3515, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   1, Avg loss: 0.0537, Accuracy: 307/1089 (28.1910%)
_Train Local_ResNet_18, epoch   1, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 491/1089 (45.0872%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7065, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 551/2227 (24.7418%)
_Train Local_ResNet_18, epoch   1, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2953, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   1, Avg loss: 0.0482, Accuracy: 434/1440 (30.1389%)
_Train Local_ResNet_18, epoch   1, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 654/1440 (45.4167%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9178, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 166/773 (21.4748%)
_Train Local_ResNet_18, epoch   1, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 377/773 (48.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.7570, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 385/1574 (24.4600%)
_Train Local_ResNet_18, epoch   1, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 660/1574 (41.9314%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2024, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 468/1190 (39.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1056, Accuracy: 54/10000 (0.5400%)
time spent on training: 97.93010258674622
[rfa agg] training data poison_ratio: 0.1255561847746946  data num: [896, 1030, 590, 1552, 1089, 2227, 1440, 773, 1574, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.039236307742092066
[rfa agg] init. name: [89, 91, 69, 74, 59, 60, 29, 99, 17, 84], weight: tensor([0.0725, 0.0833, 0.0477, 0.1256, 0.0881, 0.1802, 0.1165, 0.0625, 0.1273,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 56.736717224121094, obj_val: 60.838836669921875, abs dis: 4.102119445800781
[rfa agg] iter: 0, weight: tensor([0.0467, 0.1035, 0.0186, 0.0961, 0.1478, 0.0468, 0.1400, 0.0347, 0.0974,
        0.2685])
[rfa agg] iter:  1, prev_obj_val: 60.838836669921875, obj_val: 67.2209243774414, abs dis: 6.382087707519531
[rfa agg] iter: 1, weight: tensor([0.0555, 0.1885, 0.0187, 0.0558, 0.2458, 0.0333, 0.0712, 0.0389, 0.0566,
        0.2358])
[rfa agg] iter:  2, prev_obj_val: 67.2209243774414, obj_val: 72.58187866210938, abs dis: 5.360954284667969
[rfa agg] iter: 2, weight: tensor([0.0989, 0.2933, 0.0265, 0.0534, 0.1781, 0.0354, 0.0640, 0.0634, 0.0542,
        0.1328])
[rfa agg] iter:  3, prev_obj_val: 72.58187866210938, obj_val: 75.37944793701172, abs dis: 2.7975692749023438
[rfa agg] iter: 3, weight: tensor([0.1780, 0.2124, 0.0368, 0.0563, 0.1385, 0.0395, 0.0656, 0.1020, 0.0571,
        0.1138])
[rfa agg] iter:  4, prev_obj_val: 75.37944793701172, obj_val: 78.25860595703125, abs dis: 2.8791580200195312
[rfa agg] iter: 4, weight: tensor([0.2424, 0.1652, 0.0404, 0.0535, 0.1181, 0.0386, 0.0617, 0.1253, 0.0543,
        0.1005])
[rfa agg] iter:  5, prev_obj_val: 78.25860595703125, obj_val: 75.3791275024414, abs dis: 2.8794784545898438
[rfa agg] iter: 5, weight: tensor([0.3231, 0.1250, 0.0415, 0.0472, 0.0951, 0.0349, 0.0538, 0.1482, 0.0479,
        0.0832])
[rfa agg] iter:  6, prev_obj_val: 75.3791275024414, obj_val: 75.37246704101562, abs dis: 0.00666046142578125
[rfa agg] iter: 6, weight: tensor([0.2562, 0.1601, 0.0399, 0.0528, 0.1158, 0.0380, 0.0608, 0.1240, 0.0536,
        0.0989])
[rfa agg] iter:  7, prev_obj_val: 75.37246704101562, obj_val: 78.2572021484375, abs dis: 2.884735107421875
[rfa agg] iter: 7, weight: tensor([0.2499, 0.1623, 0.0401, 0.0531, 0.1169, 0.0383, 0.0612, 0.1246, 0.0539,
        0.0996])
[rfa agg] iter:  8, prev_obj_val: 78.2572021484375, obj_val: 75.37934112548828, abs dis: 2.8778610229492188
[rfa agg] iter: 8, weight: tensor([0.3246, 0.1247, 0.0414, 0.0471, 0.0949, 0.0348, 0.0537, 0.1478, 0.0478,
        0.0830])
[rfa agg] iter:  9, prev_obj_val: 75.37934112548828, obj_val: 75.37246704101562, abs dis: 0.00687408447265625
[rfa agg] iter: 9, weight: tensor([0.2563, 0.1600, 0.0399, 0.0528, 0.1158, 0.0380, 0.0608, 0.1239, 0.0535,
        0.0989])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3000, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3443, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.876727104187 sec.
Server Epoch:2 choose agents : [69, 51, 47, 25, 26, 30, 90, 31, 7, 55].
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 277/590 (46.9492%)
_Train Local_ResNet_18, epoch   2, local model 69, internal_epoch   2, Avg loss: 0.0296, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.7524, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 228/1049 (21.7350%)
_Train Local_ResNet_18, epoch   2, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 532/1049 (50.7150%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3381, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1211, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3143, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0584, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2189, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   1, Avg loss: 0.0554, Accuracy: 322/1446 (22.2683%)
_Train Local_ResNet_18, epoch   2, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2777, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   1, Avg loss: 0.0817, Accuracy: 66/486 (13.5802%)
_Train Local_ResNet_18, epoch   2, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7622, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 309/677 (45.6425%)
_Train Local_ResNet_18, epoch   2, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2098, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 53/460 (11.5217%)
_Train Local_ResNet_18, epoch   2, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.8144, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 343/891 (38.4961%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8962, Accuracy: 60/10000 (0.6000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 236/1071 (22.0355%)
_Train Local_ResNet_18, epoch   2, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 502/1071 (46.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8411, Accuracy: 78/10000 (0.7800%)
time spent on training: 145.80881667137146
[rfa agg] training data poison_ratio: 0.2077662129703763  data num: [590, 1049, 134, 690, 1446, 486, 677, 460, 891, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06492694155324259
[rfa agg] init. name: [69, 51, 47, 25, 26, 30, 90, 31, 7, 55], weight: tensor([0.0787, 0.1400, 0.0179, 0.0921, 0.1930, 0.0649, 0.0903, 0.0614, 0.1189,
        0.1429])
[rfa agg] iter:  0, prev_obj_val: 43.6734619140625, obj_val: 50.53167724609375, abs dis: 6.85821533203125
[rfa agg] iter: 0, weight: tensor([0.1052, 0.0778, 0.0054, 0.2259, 0.0493, 0.0449, 0.2173, 0.0426, 0.1520,
        0.0796])
[rfa agg] iter:  1, prev_obj_val: 50.53167724609375, obj_val: 53.3965950012207, abs dis: 2.864917755126953
[rfa agg] iter: 1, weight: tensor([0.2939, 0.0451, 0.0055, 0.1913, 0.0336, 0.0695, 0.1833, 0.0659, 0.0659,
        0.0461])
[rfa agg] iter:  2, prev_obj_val: 53.3965950012207, obj_val: 59.77864456176758, abs dis: 6.382049560546875
[rfa agg] iter: 2, weight: tensor([0.2978, 0.0476, 0.0067, 0.1504, 0.0366, 0.1020, 0.1466, 0.0975, 0.0663,
        0.0486])
[rfa agg] iter:  3, prev_obj_val: 59.77864456176758, obj_val: 63.18062210083008, abs dis: 3.4019775390625
[rfa agg] iter: 3, weight: tensor([0.1416, 0.0461, 0.0085, 0.1017, 0.0374, 0.2306, 0.0995, 0.2277, 0.0599,
        0.0471])
[rfa agg] iter:  4, prev_obj_val: 63.18062210083008, obj_val: 63.150672912597656, abs dis: 0.029949188232421875
[rfa agg] iter: 4, weight: tensor([0.0867, 0.0353, 0.0075, 0.0689, 0.0293, 0.3116, 0.0674, 0.3126, 0.0446,
        0.0360])
[rfa agg] iter:  5, prev_obj_val: 63.150672912597656, obj_val: 59.743595123291016, abs dis: 3.4070777893066406
[rfa agg] iter: 5, weight: tensor([0.0768, 0.0314, 0.0067, 0.0612, 0.0261, 0.3330, 0.0599, 0.3331, 0.0397,
        0.0321])
[rfa agg] iter:  6, prev_obj_val: 59.743595123291016, obj_val: 59.725433349609375, abs dis: 0.018161773681640625
[rfa agg] iter: 6, weight: tensor([0.1237, 0.0416, 0.0077, 0.0910, 0.0338, 0.2632, 0.0888, 0.2538, 0.0540,
        0.0425])
[rfa agg] iter:  7, prev_obj_val: 59.725433349609375, obj_val: 59.72520065307617, abs dis: 0.000232696533203125
[rfa agg] iter: 7, weight: tensor([0.1289, 0.0428, 0.0079, 0.0942, 0.0348, 0.2541, 0.0920, 0.2459, 0.0557,
        0.0438])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.2997, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3169, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.2809007167816 sec.
Server Epoch:3 choose agents : [81, 63, 8, 90, 20, 15, 4, 75, 0, 12].
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 240/774 (31.0078%)
_Train Local_ResNet_18, epoch   3, local model 81, internal_epoch   2, Avg loss: 0.0357, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.1907, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch   3, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2712, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0601, Accuracy: 221/1513 (14.6067%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 472/1513 (31.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5682, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 319/677 (47.1196%)
_Train Local_ResNet_18, epoch   3, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 461/677 (68.0945%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2859, Accuracy: 57/10000 (0.5700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch   3, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1575, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0586, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 411/1154 (35.6153%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9378, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0602, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0314, Accuracy: 421/901 (46.7259%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0714, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 423/776 (54.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8384, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 362/1657 (21.8467%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 511/1657 (30.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6256, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch   3, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.5029, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.31979537010193
[rfa agg] training data poison_ratio: 0.25977859778597784  data num: [774, 888, 1513, 677, 807, 1154, 901, 776, 1657, 338]
[rfa agg] considering poison per batch poison_fraction: 0.08118081180811808
[rfa agg] init. name: [81, 63, 8, 90, 20, 15, 4, 75, 0, 12], weight: tensor([0.0816, 0.0936, 0.1595, 0.0714, 0.0851, 0.1217, 0.0950, 0.0818, 0.1747,
        0.0356])
[rfa agg] iter:  0, prev_obj_val: 46.59358596801758, obj_val: 50.840843200683594, abs dis: 4.247257232666016
[rfa agg] iter: 0, weight: tensor([0.0931, 0.1636, 0.0553, 0.0466, 0.0963, 0.1001, 0.2915, 0.0932, 0.0492,
        0.0110])
[rfa agg] iter:  1, prev_obj_val: 50.840843200683594, obj_val: 56.6022834777832, abs dis: 5.761440277099609
[rfa agg] iter: 1, weight: tensor([0.2281, 0.1385, 0.0265, 0.0622, 0.1925, 0.0369, 0.0832, 0.1983, 0.0246,
        0.0092])
[rfa agg] iter:  2, prev_obj_val: 56.6022834777832, obj_val: 60.00334548950195, abs dis: 3.40106201171875
[rfa agg] iter: 2, weight: tensor([0.1803, 0.1122, 0.0337, 0.1536, 0.1773, 0.0439, 0.0777, 0.1747, 0.0317,
        0.0149])
[rfa agg] iter:  3, prev_obj_val: 60.00334548950195, obj_val: 67.4817886352539, abs dis: 7.478443145751953
[rfa agg] iter: 3, weight: tensor([0.1421, 0.1009, 0.0358, 0.2650, 0.1444, 0.0453, 0.0743, 0.1406, 0.0338,
        0.0179])
[rfa agg] iter:  4, prev_obj_val: 67.4817886352539, obj_val: 67.47532653808594, abs dis: 0.00646209716796875
[rfa agg] iter: 4, weight: tensor([0.1095, 0.0902, 0.0407, 0.3511, 0.1129, 0.0492, 0.0717, 0.1092, 0.0389,
        0.0266])
[rfa agg] iter:  5, prev_obj_val: 67.47532653808594, obj_val: 67.47518920898438, abs dis: 0.0001373291015625
[rfa agg] iter: 5, weight: tensor([0.1070, 0.0883, 0.0399, 0.3653, 0.1103, 0.0482, 0.0703, 0.1067, 0.0381,
        0.0261])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3013, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3320, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.15963077545166 sec.
Server Epoch:4 choose agents : [22, 69, 34, 81, 7, 25, 43, 56, 14, 68].
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 532/1470 (36.1905%)
_Train Local_ResNet_18, epoch   4, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 846/1470 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9098, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   1, Avg loss: 0.0587, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch   4, local model 69, internal_epoch   2, Avg loss: 0.0296, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9284, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 377/1427 (26.4191%)
_Train Local_ResNet_18, epoch   4, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 602/1427 (42.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8131, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   1, Avg loss: 0.0679, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch   4, local model 81, internal_epoch   2, Avg loss: 0.0350, Accuracy: 288/774 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3378, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 434/891 (48.7093%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch   4, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8181, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch   4, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 320/946 (33.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1306, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   4, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch   4, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7361, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   1, Avg loss: 0.0631, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch   4, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5808, Accuracy: 57/10000 (0.5700%)
time spent on training: 132.37679839134216
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 590, 1427, 774, 891, 690, 946, 186, 1013, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 69, 34, 81, 7, 25, 43, 56, 14, 68], weight: tensor([0.1607, 0.0645, 0.1560, 0.0846, 0.0974, 0.0754, 0.1034, 0.0203, 0.1107,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 40.00047302246094, obj_val: 47.17353057861328, abs dis: 7.173057556152344
[rfa agg] iter: 0, weight: tensor([0.0444, 0.0284, 0.0432, 0.0869, 0.1656, 0.0414, 0.3124, 0.0037, 0.2046,
        0.0693])
[rfa agg] iter:  1, prev_obj_val: 47.17353057861328, obj_val: 49.7874755859375, abs dis: 2.6139450073242188
[rfa agg] iter: 1, weight: tensor([0.0426, 0.0554, 0.0414, 0.2739, 0.2031, 0.0940, 0.1322, 0.0053, 0.0963,
        0.0559])
[rfa agg] iter:  2, prev_obj_val: 49.7874755859375, obj_val: 55.76799392700195, abs dis: 5.980518341064453
[rfa agg] iter: 2, weight: tensor([0.0431, 0.0699, 0.0419, 0.2907, 0.1642, 0.1292, 0.1123, 0.0059, 0.0879,
        0.0548])
[rfa agg] iter:  3, prev_obj_val: 55.76799392700195, obj_val: 52.70964431762695, abs dis: 3.058349609375
[rfa agg] iter: 3, weight: tensor([0.0438, 0.1213, 0.0426, 0.1637, 0.1170, 0.2837, 0.0910, 0.0073, 0.0766,
        0.0530])
[rfa agg] iter:  4, prev_obj_val: 52.70964431762695, obj_val: 52.70145034790039, abs dis: 0.0081939697265625
[rfa agg] iter: 4, weight: tensor([0.0455, 0.0954, 0.0442, 0.2123, 0.1413, 0.2082, 0.1044, 0.0069, 0.0854,
        0.0564])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3031, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3379, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.76969361305237 sec.
Server Epoch:5 choose agents : [66, 95, 59, 2, 56, 22, 50, 99, 97, 88].
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 392/1402 (27.9601%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1691, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch   5, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   1, Avg loss: 0.0537, Accuracy: 295/1089 (27.0891%)
_Train Local_ResNet_18, epoch   5, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 452/1089 (41.5060%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.3249, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9419, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0823, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 499/1470 (33.9456%)
_Train Local_ResNet_18, epoch   5, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 852/1470 (57.9592%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3538, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 135/809 (16.6873%)
_Train Local_ResNet_18, epoch   5, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4526, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 367/773 (47.4774%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2195, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 361/1213 (29.7609%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 488/1213 (40.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8692, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 131/603 (21.7247%)
_Train Local_ResNet_18, epoch   5, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.0343, Accuracy: 49/10000 (0.4900%)
time spent on training: 136.43236351013184
[rfa agg] training data poison_ratio: 0.06846496742484856  data num: [1402, 599, 1089, 605, 186, 1470, 809, 773, 1213, 603]
[rfa agg] considering poison per batch poison_fraction: 0.021395302320265173
[rfa agg] init. name: [66, 95, 59, 2, 56, 22, 50, 99, 97, 88], weight: tensor([0.1602, 0.0685, 0.1245, 0.0692, 0.0213, 0.1680, 0.0925, 0.0884, 0.1386,
        0.0689])
[rfa agg] iter:  0, prev_obj_val: 45.92033004760742, obj_val: 47.63865661621094, abs dis: 1.7183265686035156
[rfa agg] iter: 0, weight: tensor([0.0930, 0.0556, 0.1612, 0.0561, 0.0072, 0.0855, 0.1757, 0.1705, 0.1392,
        0.0559])
[rfa agg] iter:  1, prev_obj_val: 47.63865661621094, obj_val: 51.87152862548828, abs dis: 4.232872009277344
[rfa agg] iter: 1, weight: tensor([0.0670, 0.0569, 0.1020, 0.0573, 0.0064, 0.0625, 0.2517, 0.2467, 0.0923,
        0.0571])
[rfa agg] iter:  2, prev_obj_val: 51.87152862548828, obj_val: 56.522037506103516, abs dis: 4.650508880615234
[rfa agg] iter: 2, weight: tensor([0.0440, 0.0696, 0.0584, 0.0698, 0.0058, 0.0418, 0.2933, 0.2921, 0.0556,
        0.0696])
[rfa agg] iter:  3, prev_obj_val: 56.522037506103516, obj_val: 58.946563720703125, abs dis: 2.4245262145996094
[rfa agg] iter: 3, weight: tensor([0.0496, 0.1369, 0.0617, 0.1357, 0.0080, 0.0475, 0.1859, 0.1790, 0.0600,
        0.1357])
[rfa agg] iter:  4, prev_obj_val: 58.946563720703125, obj_val: 68.15493774414062, abs dis: 9.2083740234375
[rfa agg] iter: 4, weight: tensor([0.0441, 0.1821, 0.0535, 0.1781, 0.0079, 0.0425, 0.1329, 0.1276, 0.0525,
        0.1788])
[rfa agg] iter:  5, prev_obj_val: 68.15493774414062, obj_val: 72.21846008300781, abs dis: 4.0635223388671875
[rfa agg] iter: 5, weight: tensor([0.0332, 0.2483, 0.0377, 0.2334, 0.0082, 0.0322, 0.0671, 0.0642, 0.0377,
        0.2379])
[rfa agg] iter:  6, prev_obj_val: 72.21846008300781, obj_val: 68.13400268554688, abs dis: 4.0844573974609375
[rfa agg] iter: 6, weight: tensor([0.0432, 0.2184, 0.0484, 0.2142, 0.0120, 0.0421, 0.0798, 0.0763, 0.0487,
        0.2169])
[rfa agg] iter:  7, prev_obj_val: 68.13400268554688, obj_val: 72.21893310546875, abs dis: 4.084930419921875
[rfa agg] iter: 7, weight: tensor([0.0324, 0.2493, 0.0368, 0.2356, 0.0080, 0.0315, 0.0654, 0.0626, 0.0369,
        0.2415])
[rfa agg] iter:  8, prev_obj_val: 72.21893310546875, obj_val: 68.13397979736328, abs dis: 4.084953308105469
[rfa agg] iter: 8, weight: tensor([0.0432, 0.2184, 0.0483, 0.2142, 0.0120, 0.0421, 0.0798, 0.0763, 0.0486,
        0.2170])
[rfa agg] iter:  9, prev_obj_val: 68.13397979736328, obj_val: 72.21894073486328, abs dis: 4.0849609375
[rfa agg] iter: 9, weight: tensor([0.0324, 0.2493, 0.0368, 0.2356, 0.0080, 0.0315, 0.0654, 0.0626, 0.0369,
        0.2416])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3050, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.3480, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.7610366344452 sec.
Server Epoch:6 choose agents : [45, 90, 0, 20, 60, 91, 57, 35, 47, 74].
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 199/669 (29.7459%)
_Train Local_ResNet_18, epoch   6, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9919, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   1, Avg loss: 0.0548, Accuracy: 349/677 (51.5510%)
_Train Local_ResNet_18, epoch   6, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 425/677 (62.7770%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5541, Accuracy: 57/10000 (0.5700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 354/1657 (21.3639%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 527/1657 (31.8045%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9303, Accuracy: 77/10000 (0.7700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 354/807 (43.8662%)
_Train Local_ResNet_18, epoch   6, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.4375, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 590/2227 (26.4930%)
_Train Local_ResNet_18, epoch   6, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1043/2227 (46.8343%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4509, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   1, Avg loss: 0.0495, Accuracy: 342/1030 (33.2039%)
_Train Local_ResNet_18, epoch   6, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 642/1030 (62.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3033, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   1, Avg loss: 0.0564, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch   6, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 457/1154 (39.6014%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.3466, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch   6, local model 35, internal_epoch   2, Avg loss: 0.0543, Accuracy: 111/271 (40.9594%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4336, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   1, Avg loss: 0.1231, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch   6, local model 47, internal_epoch   2, Avg loss: 0.1089, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3255, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 489/1552 (31.5077%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 775/1552 (49.9356%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 11.9594, Accuracy: 85/10000 (0.8500%)
time spent on training: 165.94189357757568
[rfa agg] training data poison_ratio: 0.39457653763018274  data num: [669, 677, 1657, 807, 2227, 1030, 1154, 271, 134, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.12330516800943211
[rfa agg] init. name: [45, 90, 0, 20, 60, 91, 57, 35, 47, 74], weight: tensor([0.0657, 0.0665, 0.1628, 0.0793, 0.2188, 0.1012, 0.1134, 0.0266, 0.0132,
        0.1525])
[rfa agg] iter:  0, prev_obj_val: 70.36311340332031, obj_val: 72.8276138305664, abs dis: 2.4645004272460938
[rfa agg] iter: 0, weight: tensor([0.0354, 0.0358, 0.1498, 0.0538, 0.0772, 0.1432, 0.3217, 0.0088, 0.0038,
        0.1703])
[rfa agg] iter:  1, prev_obj_val: 72.8276138305664, obj_val: 74.04969787597656, abs dis: 1.2220840454101562
[rfa agg] iter: 1, weight: tensor([0.0319, 0.0323, 0.0789, 0.0520, 0.0484, 0.2108, 0.4505, 0.0072, 0.0031,
        0.0850])
[rfa agg] iter:  2, prev_obj_val: 74.04969787597656, obj_val: 78.90681457519531, abs dis: 4.85711669921875
[rfa agg] iter: 2, weight: tensor([0.0354, 0.0359, 0.0767, 0.0591, 0.0488, 0.2864, 0.3648, 0.0077, 0.0033,
        0.0819])
[rfa agg] iter:  3, prev_obj_val: 78.90681457519531, obj_val: 78.82527160644531, abs dis: 0.08154296875
[rfa agg] iter: 3, weight: tensor([0.0477, 0.0485, 0.0689, 0.0882, 0.0477, 0.4375, 0.1761, 0.0093, 0.0039,
        0.0721])
[rfa agg] iter:  4, prev_obj_val: 78.82527160644531, obj_val: 80.93766021728516, abs dis: 2.1123886108398438
[rfa agg] iter: 4, weight: tensor([0.0438, 0.0445, 0.0633, 0.0812, 0.0438, 0.4880, 0.1570, 0.0085, 0.0036,
        0.0662])
[rfa agg] iter:  5, prev_obj_val: 80.93766021728516, obj_val: 80.92817687988281, abs dis: 0.00948333740234375
[rfa agg] iter: 5, weight: tensor([0.0577, 0.0587, 0.0722, 0.1120, 0.0512, 0.3983, 0.1597, 0.0107, 0.0045,
        0.0751])
[rfa agg] iter:  6, prev_obj_val: 80.92817687988281, obj_val: 80.92806243896484, abs dis: 0.00011444091796875
[rfa agg] iter: 6, weight: tensor([0.0585, 0.0596, 0.0732, 0.1142, 0.0519, 0.3886, 0.1625, 0.0109, 0.0045,
        0.0761])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3072, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3503, Accuracy: 0/9950 (0.0000%)
saving model
Done in 331.0477337837219 sec.
Server Epoch:7 choose agents : [59, 65, 35, 25, 75, 57, 85, 89, 11, 97].
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 314/1089 (28.8338%)
_Train Local_ResNet_18, epoch   7, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3853, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 424/1475 (28.7458%)
_Train Local_ResNet_18, epoch   7, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 682/1475 (46.2373%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0304, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0865, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0566, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4436, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0541, Accuracy: 323/690 (46.8116%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8359, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   1, Avg loss: 0.0614, Accuracy: 259/776 (33.3763%)
_Train Local_ResNet_18, epoch   7, local model 75, internal_epoch   2, Avg loss: 0.0323, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 308/1154 (26.6898%)
_Train Local_ResNet_18, epoch   7, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 452/1154 (39.1681%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.5611, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 670/1988 (33.7022%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2149, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 343/896 (38.2812%)
_Train Local_ResNet_18, epoch   7, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3067, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   1, Avg loss: 0.0557, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch   7, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8063, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 372/1213 (30.6678%)
_Train Local_ResNet_18, epoch   7, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 501/1213 (41.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2463, Accuracy: 93/10000 (0.9300%)
time spent on training: 131.65059328079224
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1475, 271, 690, 776, 1154, 1988, 896, 712, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 65, 35, 25, 75, 57, 85, 89, 11, 97], weight: tensor([0.1061, 0.1437, 0.0264, 0.0672, 0.0756, 0.1124, 0.1937, 0.0873, 0.0694,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 55.79273223876953, obj_val: 60.20292663574219, abs dis: 4.410194396972656
[rfa agg] iter: 0, weight: tensor([0.2700, 0.0702, 0.0076, 0.0384, 0.0643, 0.1735, 0.0445, 0.0962, 0.0475,
        0.1879])
[rfa agg] iter:  1, prev_obj_val: 60.20292663574219, obj_val: 61.75736999511719, abs dis: 1.554443359375
[rfa agg] iter: 1, weight: tensor([0.1635, 0.0676, 0.0101, 0.0593, 0.1168, 0.1249, 0.0472, 0.2000, 0.0782,
        0.1325])
[rfa agg] iter:  2, prev_obj_val: 61.75736999511719, obj_val: 65.25682830810547, abs dis: 3.4994583129882812
[rfa agg] iter: 2, weight: tensor([0.1290, 0.0601, 0.0100, 0.0627, 0.1362, 0.1037, 0.0431, 0.2601, 0.0855,
        0.1096])
[rfa agg] iter:  3, prev_obj_val: 65.25682830810547, obj_val: 67.39096069335938, abs dis: 2.1341323852539062
[rfa agg] iter: 3, weight: tensor([0.0766, 0.0422, 0.0086, 0.0643, 0.1881, 0.0653, 0.0318, 0.3573, 0.0970,
        0.0689])
[rfa agg] iter:  4, prev_obj_val: 67.39096069335938, obj_val: 72.69591522216797, abs dis: 5.304954528808594
[rfa agg] iter: 4, weight: tensor([0.0633, 0.0374, 0.0085, 0.0705, 0.2614, 0.0552, 0.0287, 0.3020, 0.1148,
        0.0582])
[rfa agg] iter:  5, prev_obj_val: 72.69591522216797, obj_val: 79.21589660644531, abs dis: 6.519981384277344
[rfa agg] iter: 5, weight: tensor([0.0535, 0.0350, 0.0098, 0.1126, 0.2846, 0.0481, 0.0279, 0.1498, 0.2281,
        0.0507])
[rfa agg] iter:  6, prev_obj_val: 79.21589660644531, obj_val: 86.8697280883789, abs dis: 7.653831481933594
[rfa agg] iter: 6, weight: tensor([0.0499, 0.0354, 0.0124, 0.2506, 0.1468, 0.0459, 0.0292, 0.1026, 0.2788,
        0.0484])
[rfa agg] iter:  7, prev_obj_val: 86.8697280883789, obj_val: 75.78341674804688, abs dis: 11.086311340332031
[rfa agg] iter: 7, weight: tensor([0.0554, 0.0419, 0.0186, 0.3581, 0.1157, 0.0518, 0.0355, 0.0954, 0.1730,
        0.0546])
[rfa agg] iter:  8, prev_obj_val: 75.78341674804688, obj_val: 79.1833267211914, abs dis: 3.3999099731445312
[rfa agg] iter: 8, weight: tensor([0.0485, 0.0332, 0.0104, 0.1690, 0.1758, 0.0442, 0.0269, 0.1101, 0.3354,
        0.0466])
[rfa agg] iter:  9, prev_obj_val: 79.1833267211914, obj_val: 82.88258361816406, abs dis: 3.6992568969726562
[rfa agg] iter: 9, weight: tensor([0.0479, 0.0340, 0.0119, 0.2542, 0.1379, 0.0441, 0.0280, 0.0979, 0.2977,
        0.0465])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.3583, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.1182291507721 sec.
Server Epoch:8 choose agents : [69, 25, 14, 1, 63, 31, 49, 18, 13, 67].
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   1, Avg loss: 0.0525, Accuracy: 299/590 (50.6780%)
_Train Local_ResNet_18, epoch   8, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   1, Avg loss: 0.0530, Accuracy: 334/690 (48.4058%)
_Train Local_ResNet_18, epoch   8, local model 25, internal_epoch   2, Avg loss: 0.0264, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0650, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.8889, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 292/928 (31.4655%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 578/928 (62.2845%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0149, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 359/888 (40.4279%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.0539, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   1, Avg loss: 0.0789, Accuracy: 80/460 (17.3913%)
_Train Local_ResNet_18, epoch   8, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0950, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 32/440 (7.2727%)
_Train Local_ResNet_18, epoch   8, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   1, Avg loss: 0.0771, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch   8, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5655, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 299/1645 (18.1763%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 602/1645 (36.5957%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0507, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 51/426 (11.9718%)
_Train Local_ResNet_18, epoch   8, local model 67, internal_epoch   2, Avg loss: 0.0430, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8226, Accuracy: 52/10000 (0.5200%)
time spent on training: 125.6593918800354
[rfa agg] training data poison_ratio: 0.0  data num: [590, 690, 1013, 928, 888, 460, 440, 530, 1645, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 25, 14, 1, 63, 31, 49, 18, 13, 67], weight: tensor([0.0775, 0.0907, 0.1331, 0.1219, 0.1167, 0.0604, 0.0578, 0.0696, 0.2162,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 49.24008560180664, obj_val: 54.18384552001953, abs dis: 4.943759918212891
[rfa agg] iter: 0, weight: tensor([0.1183, 0.2396, 0.1038, 0.1251, 0.1725, 0.0474, 0.0365, 0.0727, 0.0489,
        0.0352])
[rfa agg] iter:  1, prev_obj_val: 54.18384552001953, obj_val: 64.48451232910156, abs dis: 10.300666809082031
[rfa agg] iter: 1, weight: tensor([0.3419, 0.1774, 0.0487, 0.0534, 0.0636, 0.0641, 0.0420, 0.1388, 0.0298,
        0.0404])
[rfa agg] iter:  2, prev_obj_val: 64.48451232910156, obj_val: 71.4016342163086, abs dis: 6.917121887207031
[rfa agg] iter: 2, weight: tensor([0.0943, 0.0734, 0.0409, 0.0428, 0.0477, 0.2649, 0.1290, 0.1577, 0.0296,
        0.1197])
[rfa agg] iter:  3, prev_obj_val: 71.4016342163086, obj_val: 71.34907531738281, abs dis: 0.05255889892578125
[rfa agg] iter: 3, weight: tensor([0.0554, 0.0486, 0.0320, 0.0329, 0.0359, 0.1215, 0.3244, 0.0739, 0.0247,
        0.2506])
[rfa agg] iter:  4, prev_obj_val: 71.34907531738281, obj_val: 84.36746215820312, abs dis: 13.018386840820312
[rfa agg] iter: 4, weight: tensor([0.0471, 0.0414, 0.0272, 0.0280, 0.0306, 0.1013, 0.3746, 0.0628, 0.0210,
        0.2660])
[rfa agg] iter:  5, prev_obj_val: 84.36746215820312, obj_val: 71.39371490478516, abs dis: 12.973747253417969
[rfa agg] iter: 5, weight: tensor([0.0853, 0.0816, 0.0629, 0.0637, 0.0680, 0.1183, 0.1892, 0.0982, 0.0524,
        0.1804])
[rfa agg] iter:  6, prev_obj_val: 71.39371490478516, obj_val: 75.53952026367188, abs dis: 4.145805358886719
[rfa agg] iter: 6, weight: tensor([0.0547, 0.0480, 0.0316, 0.0325, 0.0355, 0.1168, 0.3296, 0.0729, 0.0243,
        0.2541])
[rfa agg] iter:  7, prev_obj_val: 75.53952026367188, obj_val: 67.73574829101562, abs dis: 7.80377197265625
[rfa agg] iter: 7, weight: tensor([0.0623, 0.0567, 0.0397, 0.0406, 0.0439, 0.1094, 0.2862, 0.0779, 0.0315,
        0.2518])
[rfa agg] iter:  8, prev_obj_val: 67.73574829101562, obj_val: 67.72953033447266, abs dis: 0.00621795654296875
[rfa agg] iter: 8, weight: tensor([0.0699, 0.0585, 0.0358, 0.0371, 0.0408, 0.2016, 0.2265, 0.1020, 0.0268,
        0.2010])
[rfa agg] iter:  9, prev_obj_val: 67.72953033447266, obj_val: 67.72946166992188, abs dis: 6.866455078125e-05
[rfa agg] iter: 9, weight: tensor([0.0699, 0.0586, 0.0358, 0.0371, 0.0409, 0.2112, 0.2213, 0.1022, 0.0268,
        0.1963])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3110, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3695, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.3742575645447 sec.
Server Epoch:9 choose agents : [40, 90, 65, 14, 93, 30, 56, 82, 39, 99].
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 393/1573 (24.9841%)
_Train Local_ResNet_18, epoch   9, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 578/1573 (36.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7075, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0523, Accuracy: 344/677 (50.8124%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 436/677 (64.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0038, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0546, Accuracy: 382/1475 (25.8983%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 693/1475 (46.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1200, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch   9, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9042, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0565, Accuracy: 431/1742 (24.7417%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5005, Accuracy: 84/10000 (0.8400%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 80/486 (16.4609%)
_Train Local_ResNet_18, epoch   9, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1558, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 63/500 (12.6000%)
_Train Local_ResNet_18, epoch   9, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.9042, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch   9, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 468/1013 (46.1994%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8536, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 191/773 (24.7089%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6124, Accuracy: 51/10000 (0.5100%)
time spent on training: 139.4586067199707
[rfa agg] training data poison_ratio: 0.05149396058486968  data num: [1573, 677, 1475, 1013, 1742, 486, 186, 500, 1013, 773]
[rfa agg] considering poison per batch poison_fraction: 0.016091862682771775
[rfa agg] init. name: [40, 90, 65, 14, 93, 30, 56, 82, 39, 99], weight: tensor([0.1667, 0.0717, 0.1563, 0.1073, 0.1846, 0.0515, 0.0197, 0.0530, 0.1073,
        0.0819])
[rfa agg] iter:  0, prev_obj_val: 60.246822357177734, obj_val: 66.19263458251953, abs dis: 5.945812225341797
[rfa agg] iter: 0, weight: tensor([0.0743, 0.0427, 0.0792, 0.3198, 0.0600, 0.0205, 0.0050, 0.0211, 0.3052,
        0.0723])
[rfa agg] iter:  1, prev_obj_val: 66.19263458251953, obj_val: 72.38568115234375, abs dis: 6.193046569824219
[rfa agg] iter: 1, weight: tensor([0.0594, 0.0760, 0.0614, 0.2518, 0.0513, 0.0296, 0.0064, 0.0305, 0.2479,
        0.1857])
[rfa agg] iter:  2, prev_obj_val: 72.38568115234375, obj_val: 74.81280517578125, abs dis: 2.4271240234375
[rfa agg] iter: 2, weight: tensor([0.0458, 0.1144, 0.0468, 0.1162, 0.0406, 0.0338, 0.0065, 0.0348, 0.1157,
        0.4454])
[rfa agg] iter:  3, prev_obj_val: 74.81280517578125, obj_val: 72.29937744140625, abs dis: 2.513427734375
[rfa agg] iter: 3, weight: tensor([0.0449, 0.1515, 0.0457, 0.1016, 0.0401, 0.0383, 0.0069, 0.0394, 0.1013,
        0.4303])
[rfa agg] iter:  4, prev_obj_val: 72.29937744140625, obj_val: 74.81988525390625, abs dis: 2.5205078125
[rfa agg] iter: 4, weight: tensor([0.0379, 0.0949, 0.0387, 0.0954, 0.0336, 0.0280, 0.0054, 0.0288, 0.0950,
        0.5423])
[rfa agg] iter:  5, prev_obj_val: 74.81988525390625, obj_val: 72.29615020751953, abs dis: 2.5237350463867188
[rfa agg] iter: 5, weight: tensor([0.0437, 0.1460, 0.0444, 0.0986, 0.0390, 0.0372, 0.0067, 0.0383, 0.0983,
        0.4477])
[rfa agg] iter:  6, prev_obj_val: 72.29615020751953, obj_val: 77.51844024658203, abs dis: 5.2222900390625
[rfa agg] iter: 6, weight: tensor([0.0373, 0.0933, 0.0380, 0.0938, 0.0331, 0.0275, 0.0053, 0.0283, 0.0934,
        0.5501])
[rfa agg] iter:  7, prev_obj_val: 77.51844024658203, obj_val: 77.47566986083984, abs dis: 0.0427703857421875
[rfa agg] iter: 7, weight: tensor([0.0497, 0.2391, 0.0504, 0.1026, 0.0447, 0.0493, 0.0084, 0.0508, 0.1023,
        0.3026])
[rfa agg] iter:  8, prev_obj_val: 77.47566986083984, obj_val: 77.47543334960938, abs dis: 0.00023651123046875
[rfa agg] iter: 8, weight: tensor([0.0499, 0.2546, 0.0505, 0.1031, 0.0449, 0.0496, 0.0084, 0.0511, 0.1029,
        0.2849])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3132, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.3789, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.5347647666931 sec.
Server Epoch:10 choose agents : [77, 16, 60, 47, 94, 33, 61, 95, 30, 6].
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 345/1340 (25.7463%)
_Train Local_ResNet_18, epoch  10, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 516/1340 (38.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2793, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   1, Avg loss: 0.0609, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  10, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0683, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 623/2227 (27.9749%)
_Train Local_ResNet_18, epoch  10, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1047/2227 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3520, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 47, internal_epoch   2, Avg loss: 0.1085, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3398, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 352/1662 (21.1793%)
_Train Local_ResNet_18, epoch  10, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 617/1662 (37.1239%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2584, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   1, Avg loss: 0.0793, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  10, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0282, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1284, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3264, Accuracy: 46/10000 (0.4600%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0521, Accuracy: 347/599 (57.9299%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0270, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.7113, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 81/486 (16.6667%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.2679, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0538, Accuracy: 416/1956 (21.2679%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 644/1956 (32.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3388, Accuracy: 121/10000 (1.2100%)
time spent on training: 156.38899064064026
[rfa agg] training data poison_ratio: 0.1117174629324547  data num: [1340, 708, 2227, 134, 1662, 515, 85, 599, 486, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034911707166392095
[rfa agg] init. name: [77, 16, 60, 47, 94, 33, 61, 95, 30, 6], weight: tensor([0.1380, 0.0729, 0.2293, 0.0138, 0.1711, 0.0530, 0.0088, 0.0617, 0.0500,
        0.2014])
[rfa agg] iter:  0, prev_obj_val: 81.73802947998047, obj_val: 84.42769622802734, abs dis: 2.689666748046875
[rfa agg] iter: 0, weight: tensor([0.5635, 0.0343, 0.0759, 0.0033, 0.1668, 0.0190, 0.0020, 0.0240, 0.0166,
        0.0946])
[rfa agg] iter:  1, prev_obj_val: 84.42769622802734, obj_val: 86.447265625, abs dis: 2.0195693969726562
[rfa agg] iter: 1, weight: tensor([0.6827, 0.0302, 0.0558, 0.0028, 0.1081, 0.0163, 0.0017, 0.0207, 0.0141,
        0.0675])
[rfa agg] iter:  2, prev_obj_val: 86.447265625, obj_val: 84.40962982177734, abs dis: 2.0376358032226562
[rfa agg] iter: 2, weight: tensor([0.5988, 0.0418, 0.0703, 0.0037, 0.1292, 0.0222, 0.0022, 0.0284, 0.0192,
        0.0841])
[rfa agg] iter:  3, prev_obj_val: 84.40962982177734, obj_val: 84.39073181152344, abs dis: 0.01889801025390625
[rfa agg] iter: 3, weight: tensor([0.6946, 0.0291, 0.0537, 0.0027, 0.1040, 0.0157, 0.0016, 0.0200, 0.0136,
        0.0650])
[rfa agg] iter:  4, prev_obj_val: 84.39073181152344, obj_val: 84.3896484375, abs dis: 0.0010833740234375
[rfa agg] iter: 4, weight: tensor([0.7163, 0.0271, 0.0500, 0.0025, 0.0964, 0.0146, 0.0015, 0.0186, 0.0127,
        0.0604])
[rfa agg] iter:  5, prev_obj_val: 84.3896484375, obj_val: 86.45695495605469, abs dis: 2.0673065185546875
[rfa agg] iter: 5, weight: tensor([0.7211, 0.0266, 0.0491, 0.0025, 0.0947, 0.0144, 0.0015, 0.0183, 0.0125,
        0.0594])
[rfa agg] iter:  6, prev_obj_val: 86.45695495605469, obj_val: 86.43829345703125, abs dis: 0.0186614990234375
[rfa agg] iter: 6, weight: tensor([0.6022, 0.0415, 0.0698, 0.0037, 0.1280, 0.0220, 0.0022, 0.0281, 0.0191,
        0.0834])
[rfa agg] iter:  7, prev_obj_val: 86.43829345703125, obj_val: 84.41215515136719, abs dis: 2.0261383056640625
[rfa agg] iter: 7, weight: tensor([0.5911, 0.0426, 0.0716, 0.0038, 0.1318, 0.0226, 0.0023, 0.0289, 0.0196,
        0.0856])
[rfa agg] iter:  8, prev_obj_val: 84.41215515136719, obj_val: 84.39089965820312, abs dis: 0.0212554931640625
[rfa agg] iter: 8, weight: tensor([0.6927, 0.0293, 0.0541, 0.0027, 0.1046, 0.0158, 0.0016, 0.0201, 0.0137,
        0.0654])
[rfa agg] iter:  9, prev_obj_val: 84.39089965820312, obj_val: 84.38965606689453, abs dis: 0.00124359130859375
[rfa agg] iter: 9, weight: tensor([0.7159, 0.0271, 0.0500, 0.0025, 0.0965, 0.0146, 0.0015, 0.0186, 0.0127,
        0.0605])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3163, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.3888, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.2674219608307 sec.
Server Epoch:11 choose agents : [26, 84, 32, 6, 99, 13, 93, 12, 28, 15].
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4549, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  11, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3098, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8710, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0538, Accuracy: 437/1956 (22.3415%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 666/1956 (34.0491%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.5143, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   1, Avg loss: 0.0594, Accuracy: 244/773 (31.5653%)
_Train Local_ResNet_18, epoch  11, local model 99, internal_epoch   2, Avg loss: 0.0298, Accuracy: 419/773 (54.2044%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9963, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 623/1645 (37.8723%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0497, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 684/1742 (39.2652%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8773, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.6650, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 404/1581 (25.5534%)
_Train Local_ResNet_18, epoch  11, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 578/1581 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6780, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   1, Avg loss: 0.0562, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  11, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 464/1154 (40.2080%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0868, Accuracy: 57/10000 (0.5700%)
time spent on training: 151.01108503341675
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 1190, 735, 1956, 773, 1645, 1742, 338, 1581, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 84, 32, 6, 99, 13, 93, 12, 28, 15], weight: tensor([0.1151, 0.0947, 0.0585, 0.1557, 0.0615, 0.1310, 0.1387, 0.0269, 0.1259,
        0.0919])
[rfa agg] iter:  0, prev_obj_val: 53.56059265136719, obj_val: 58.88908767700195, abs dis: 5.328495025634766
[rfa agg] iter: 0, weight: tensor([0.1734, 0.2144, 0.0275, 0.0591, 0.0327, 0.0939, 0.0735, 0.0074, 0.1098,
        0.2084])
[rfa agg] iter:  1, prev_obj_val: 58.88908767700195, obj_val: 64.25541687011719, abs dis: 5.366329193115234
[rfa agg] iter: 1, weight: tensor([0.0825, 0.3317, 0.0244, 0.0379, 0.0298, 0.0544, 0.0450, 0.0061, 0.0609,
        0.3273])
[rfa agg] iter:  2, prev_obj_val: 64.25541687011719, obj_val: 61.374080657958984, abs dis: 2.881336212158203
[rfa agg] iter: 2, weight: tensor([0.0880, 0.2966, 0.0378, 0.0466, 0.0473, 0.0633, 0.0539, 0.0087, 0.0695,
        0.2883])
[rfa agg] iter:  3, prev_obj_val: 61.374080657958984, obj_val: 64.25457000732422, abs dis: 2.8804893493652344
[rfa agg] iter: 3, weight: tensor([0.0793, 0.3298, 0.0284, 0.0394, 0.0351, 0.0549, 0.0461, 0.0068, 0.0608,
        0.3196])
[rfa agg] iter:  4, prev_obj_val: 64.25457000732422, obj_val: 61.37410354614258, abs dis: 2.8804664611816406
[rfa agg] iter: 4, weight: tensor([0.0881, 0.2971, 0.0378, 0.0466, 0.0473, 0.0633, 0.0539, 0.0087, 0.0695,
        0.2876])
[rfa agg] iter:  5, prev_obj_val: 61.37410354614258, obj_val: 64.25455474853516, abs dis: 2.880451202392578
[rfa agg] iter: 5, weight: tensor([0.0793, 0.3300, 0.0284, 0.0394, 0.0351, 0.0549, 0.0461, 0.0068, 0.0608,
        0.3194])
[rfa agg] iter:  6, prev_obj_val: 64.25455474853516, obj_val: 61.374107360839844, abs dis: 2.8804473876953125
[rfa agg] iter: 6, weight: tensor([0.0881, 0.2971, 0.0378, 0.0466, 0.0473, 0.0633, 0.0539, 0.0087, 0.0695,
        0.2876])
[rfa agg] iter:  7, prev_obj_val: 61.374107360839844, obj_val: 64.25455474853516, abs dis: 2.8804473876953125
[rfa agg] iter: 7, weight: tensor([0.0793, 0.3300, 0.0284, 0.0394, 0.0351, 0.0549, 0.0461, 0.0068, 0.0608,
        0.3194])
[rfa agg] iter:  8, prev_obj_val: 64.25455474853516, obj_val: 61.37409973144531, abs dis: 2.8804550170898438
[rfa agg] iter: 8, weight: tensor([0.0881, 0.2971, 0.0378, 0.0466, 0.0473, 0.0633, 0.0539, 0.0087, 0.0695,
        0.2876])
[rfa agg] iter:  9, prev_obj_val: 61.37409973144531, obj_val: 64.25455474853516, abs dis: 2.8804550170898438
[rfa agg] iter: 9, weight: tensor([0.0793, 0.3300, 0.0284, 0.0394, 0.0351, 0.0549, 0.0461, 0.0068, 0.0608,
        0.3194])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3183, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.3894, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.60186100006104 sec.
Server Epoch:12 choose agents : [39, 86, 0, 34, 36, 92, 67, 30, 23, 15].
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  12, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 533/1013 (52.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0945, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.0405, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   1, Avg loss: 0.0568, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  12, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 527/1657 (31.8045%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4910, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 386/1427 (27.0498%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 610/1427 (42.7470%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8013, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8757, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 436/1715 (25.4227%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 687/1715 (40.0583%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7186, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 70/426 (16.4319%)
_Train Local_ResNet_18, epoch  12, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9346, Accuracy: 55/10000 (0.5500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4359, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   1, Avg loss: 0.0598, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  12, local model 23, internal_epoch   2, Avg loss: 0.0392, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9916, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   1, Avg loss: 0.0539, Accuracy: 340/1154 (29.4627%)
_Train Local_ResNet_18, epoch  12, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 380/1154 (32.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6737, Accuracy: 70/10000 (0.7000%)
time spent on training: 168.7419023513794
[rfa agg] training data poison_ratio: 0.21421431427429027  data num: [1013, 1003, 1657, 1427, 408, 1715, 426, 486, 715, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06694197321071571
[rfa agg] init. name: [39, 86, 0, 34, 36, 92, 67, 30, 23, 15], weight: tensor([0.1013, 0.1003, 0.1656, 0.1426, 0.0408, 0.1714, 0.0426, 0.0486, 0.0715,
        0.1154])
[rfa agg] iter:  0, prev_obj_val: 55.89048767089844, obj_val: 58.22294235229492, abs dis: 2.3324546813964844
[rfa agg] iter: 0, weight: tensor([0.2629, 0.2669, 0.0623, 0.0797, 0.0139, 0.0580, 0.0145, 0.0183, 0.0480,
        0.1755])
[rfa agg] iter:  1, prev_obj_val: 58.22294235229492, obj_val: 65.18182373046875, abs dis: 6.958881378173828
[rfa agg] iter: 1, weight: tensor([0.3430, 0.3678, 0.0392, 0.0478, 0.0107, 0.0368, 0.0112, 0.0144, 0.0415,
        0.0875])
[rfa agg] iter:  2, prev_obj_val: 65.18182373046875, obj_val: 62.63262176513672, abs dis: 2.5492019653320312
[rfa agg] iter: 2, weight: tensor([0.2591, 0.2599, 0.0599, 0.0695, 0.0226, 0.0570, 0.0236, 0.0311, 0.1128,
        0.1045])
[rfa agg] iter:  3, prev_obj_val: 62.63262176513672, obj_val: 67.76116180419922, abs dis: 5.1285400390625
[rfa agg] iter: 3, weight: tensor([0.2957, 0.2970, 0.0530, 0.0624, 0.0180, 0.0502, 0.0188, 0.0245, 0.0815,
        0.0990])
[rfa agg] iter:  4, prev_obj_val: 67.76116180419922, obj_val: 62.64234924316406, abs dis: 5.118812561035156
[rfa agg] iter: 4, weight: tensor([0.2246, 0.2234, 0.0642, 0.0734, 0.0271, 0.0613, 0.0283, 0.0376, 0.1544,
        0.1057])
[rfa agg] iter:  5, prev_obj_val: 62.64234924316406, obj_val: 67.76084899902344, abs dis: 5.118499755859375
[rfa agg] iter: 5, weight: tensor([0.2947, 0.2954, 0.0533, 0.0628, 0.0181, 0.0505, 0.0189, 0.0246, 0.0822,
        0.0996])
[rfa agg] iter:  6, prev_obj_val: 67.76084899902344, obj_val: 62.64236068725586, abs dis: 5.118488311767578
[rfa agg] iter: 6, weight: tensor([0.2245, 0.2233, 0.0642, 0.0734, 0.0271, 0.0613, 0.0283, 0.0376, 0.1544,
        0.1057])
[rfa agg] iter:  7, prev_obj_val: 62.64236068725586, obj_val: 67.76084899902344, abs dis: 5.118488311767578
[rfa agg] iter: 7, weight: tensor([0.2947, 0.2954, 0.0533, 0.0628, 0.0181, 0.0505, 0.0189, 0.0246, 0.0822,
        0.0996])
[rfa agg] iter:  8, prev_obj_val: 67.76084899902344, obj_val: 62.64236068725586, abs dis: 5.118488311767578
[rfa agg] iter: 8, weight: tensor([0.2245, 0.2233, 0.0642, 0.0734, 0.0271, 0.0613, 0.0283, 0.0376, 0.1544,
        0.1057])
[rfa agg] iter:  9, prev_obj_val: 62.64236068725586, obj_val: 67.76084899902344, abs dis: 5.118488311767578
[rfa agg] iter: 9, weight: tensor([0.2947, 0.2954, 0.0533, 0.0628, 0.0181, 0.0505, 0.0189, 0.0246, 0.0822,
        0.0996])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3207, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.4055, Accuracy: 0/9950 (0.0000%)
saving model
Done in 329.0167899131775 sec.
Server Epoch:13 choose agents : [38, 81, 76, 16, 60, 7, 18, 54, 50, 25].
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 250/1131 (22.1043%)
_Train Local_ResNet_18, epoch  13, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 493/1131 (43.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9505, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   1, Avg loss: 0.0643, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  13, local model 81, internal_epoch   2, Avg loss: 0.0368, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.7958, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0472, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2637, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1981, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 595/2227 (26.7176%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1039/2227 (46.6547%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1642, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 451/891 (50.6173%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.5597, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9597, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch  13, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3825, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0623, Accuracy: 167/809 (20.6428%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 346/809 (42.7689%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8547, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   1, Avg loss: 0.0517, Accuracy: 329/690 (47.6812%)
_Train Local_ResNet_18, epoch  13, local model 25, internal_epoch   2, Avg loss: 0.0253, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.3429, Accuracy: 53/10000 (0.5300%)
time spent on training: 135.24124717712402
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 774, 466, 708, 2227, 891, 530, 1130, 809, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 81, 76, 16, 60, 7, 18, 54, 50, 25], weight: tensor([0.1209, 0.0827, 0.0498, 0.0757, 0.2380, 0.0952, 0.0566, 0.1208, 0.0865,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 65.22704315185547, obj_val: 64.60667419433594, abs dis: 0.6203689575195312
[rfa agg] iter: 0, weight: tensor([0.2465, 0.0829, 0.0210, 0.0598, 0.0462, 0.1311, 0.0271, 0.2504, 0.0870,
        0.0479])
[rfa agg] iter:  1, prev_obj_val: 64.60667419433594, obj_val: 70.41417694091797, abs dis: 5.807502746582031
[rfa agg] iter: 1, weight: tensor([0.0946, 0.1351, 0.0214, 0.0819, 0.0325, 0.3087, 0.0287, 0.0948, 0.1443,
        0.0580])
[rfa agg] iter:  2, prev_obj_val: 70.41417694091797, obj_val: 79.09333801269531, abs dis: 8.679161071777344
[rfa agg] iter: 2, weight: tensor([0.0458, 0.1494, 0.0283, 0.2550, 0.0238, 0.1052, 0.0424, 0.0458, 0.1632,
        0.1412])
[rfa agg] iter:  3, prev_obj_val: 79.09333801269531, obj_val: 82.50379943847656, abs dis: 3.41046142578125
[rfa agg] iter: 3, weight: tensor([0.0482, 0.0958, 0.0582, 0.1430, 0.0292, 0.0801, 0.1044, 0.0482, 0.1007,
        0.2922])
[rfa agg] iter:  4, prev_obj_val: 82.50379943847656, obj_val: 82.49736022949219, abs dis: 0.006439208984375
[rfa agg] iter: 4, weight: tensor([0.0513, 0.0915, 0.0815, 0.1237, 0.0325, 0.0799, 0.1651, 0.0513, 0.0958,
        0.2276])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3233, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.4076, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.13047671318054 sec.
Server Epoch:14 choose agents : [75, 69, 70, 66, 36, 76, 88, 65, 89, 30].
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 267/776 (34.4072%)
_Train Local_ResNet_18, epoch  14, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 394/776 (50.7732%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5387, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0540, Accuracy: 313/590 (53.0508%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6016, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 364/1418 (25.6700%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 669/1418 (47.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8019, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 271/1402 (19.3295%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 411/1402 (29.3153%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8605, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 66/408 (16.1765%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0546, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  14, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5145, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   1, Avg loss: 0.0734, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  14, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.4160, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0540, Accuracy: 397/1475 (26.9153%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 693/1475 (46.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1159, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   1, Avg loss: 0.0590, Accuracy: 353/896 (39.3973%)
_Train Local_ResNet_18, epoch  14, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.6264, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   1, Avg loss: 0.0769, Accuracy: 82/486 (16.8724%)
_Train Local_ResNet_18, epoch  14, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5318, Accuracy: 47/10000 (0.4700%)
time spent on training: 150.82081747055054
[rfa agg] training data poison_ratio: 0.05704225352112676  data num: [776, 590, 1418, 1402, 408, 466, 603, 1475, 896, 486]
[rfa agg] considering poison per batch poison_fraction: 0.017825704225352113
[rfa agg] init. name: [75, 69, 70, 66, 36, 76, 88, 65, 89, 30], weight: tensor([0.0911, 0.0692, 0.1664, 0.1646, 0.0479, 0.0547, 0.0708, 0.1731, 0.1052,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 56.628604888916016, obj_val: 59.92049789428711, abs dis: 3.2918930053710938
[rfa agg] iter: 0, weight: tensor([0.2192, 0.0502, 0.0541, 0.0601, 0.0200, 0.0266, 0.0515, 0.0506, 0.4398,
        0.0278])
[rfa agg] iter:  1, prev_obj_val: 59.92049789428711, obj_val: 65.18511199951172, abs dis: 5.264614105224609
[rfa agg] iter: 1, weight: tensor([0.3608, 0.0844, 0.0497, 0.0543, 0.0273, 0.0378, 0.0867, 0.0472, 0.2123,
        0.0396])
[rfa agg] iter:  2, prev_obj_val: 65.18511199951172, obj_val: 66.99848175048828, abs dis: 1.8133697509765625
[rfa agg] iter: 2, weight: tensor([0.1528, 0.2040, 0.0477, 0.0514, 0.0409, 0.0613, 0.2132, 0.0457, 0.1185,
        0.0646])
[rfa agg] iter:  3, prev_obj_val: 66.99848175048828, obj_val: 77.90876770019531, abs dis: 10.910285949707031
[rfa agg] iter: 3, weight: tensor([0.0955, 0.2713, 0.0359, 0.0386, 0.0367, 0.0574, 0.2896, 0.0345, 0.0798,
        0.0607])
[rfa agg] iter:  4, prev_obj_val: 77.90876770019531, obj_val: 81.13152313232422, abs dis: 3.2227554321289062
[rfa agg] iter: 4, weight: tensor([0.0576, 0.1279, 0.0330, 0.0350, 0.0878, 0.1988, 0.1316, 0.0321, 0.0546,
        0.2417])
[rfa agg] iter:  5, prev_obj_val: 81.13152313232422, obj_val: 81.11517333984375, abs dis: 0.01634979248046875
[rfa agg] iter: 5, weight: tensor([0.0391, 0.0728, 0.0240, 0.0254, 0.0964, 0.2424, 0.0746, 0.0234, 0.0377,
        0.3642])
[rfa agg] iter:  6, prev_obj_val: 81.11517333984375, obj_val: 84.91324615478516, abs dis: 3.7980728149414062
[rfa agg] iter: 6, weight: tensor([0.0361, 0.0669, 0.0222, 0.0235, 0.0892, 0.2394, 0.0684, 0.0216, 0.0348,
        0.3980])
[rfa agg] iter:  7, prev_obj_val: 84.91324615478516, obj_val: 81.12316131591797, abs dis: 3.7900848388671875
[rfa agg] iter: 7, weight: tensor([0.0437, 0.0721, 0.0286, 0.0302, 0.1996, 0.2145, 0.0738, 0.0279, 0.0428,
        0.2668])
[rfa agg] iter:  8, prev_obj_val: 81.12316131591797, obj_val: 84.9116439819336, abs dis: 3.788482666015625
[rfa agg] iter: 8, weight: tensor([0.0378, 0.0700, 0.0232, 0.0246, 0.0946, 0.2450, 0.0717, 0.0226, 0.0364,
        0.3742])
[rfa agg] iter:  9, prev_obj_val: 84.9116439819336, obj_val: 81.123291015625, abs dis: 3.7883529663085938
[rfa agg] iter: 9, weight: tensor([0.0438, 0.0722, 0.0286, 0.0302, 0.2003, 0.2156, 0.0738, 0.0279, 0.0429,
        0.2648])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3252, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.4131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.925772190094 sec.
Server Epoch:15 choose agents : [75, 67, 89, 84, 27, 45, 19, 70, 41, 20].
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0619, Accuracy: 267/776 (34.4072%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3275, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   1, Avg loss: 0.0766, Accuracy: 66/426 (15.4930%)
_Train Local_ResNet_18, epoch  15, local model 67, internal_epoch   2, Avg loss: 0.0414, Accuracy: 170/426 (39.9061%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.1241, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 353/896 (39.3973%)
_Train Local_ResNet_18, epoch  15, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0599, Accuracy: 341/1190 (28.6555%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3358, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   1, Avg loss: 0.0543, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  15, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 616/1587 (38.8154%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8866, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   1, Avg loss: 0.0667, Accuracy: 222/669 (33.1839%)
_Train Local_ResNet_18, epoch  15, local model 45, internal_epoch   2, Avg loss: 0.0393, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2208, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 375/1036 (36.1969%)
_Train Local_ResNet_18, epoch  15, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 639/1036 (61.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.9336, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 401/1418 (28.2793%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 676/1418 (47.6728%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1506, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0574, Accuracy: 342/719 (47.5661%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0327, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1193, Accuracy: 59/10000 (0.5900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch  15, local model 20, internal_epoch   2, Avg loss: 0.0307, Accuracy: 443/807 (54.8947%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8045, Accuracy: 58/10000 (0.5800%)
time spent on training: 155.50253057479858
[rfa agg] training data poison_ratio: 0.08473330533389332  data num: [776, 426, 896, 1190, 1587, 669, 1036, 1418, 719, 807]
[rfa agg] considering poison per batch poison_fraction: 0.026479157916841665
[rfa agg] init. name: [75, 67, 89, 84, 27, 45, 19, 70, 41, 20], weight: tensor([0.0815, 0.0447, 0.0941, 0.1249, 0.1666, 0.0702, 0.1088, 0.1489, 0.0755,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 45.1185302734375, obj_val: 53.89289474487305, abs dis: 8.774364471435547
[rfa agg] iter: 0, weight: tensor([0.1385, 0.0167, 0.2840, 0.0766, 0.0445, 0.0553, 0.1160, 0.0489, 0.0813,
        0.1381])
[rfa agg] iter:  1, prev_obj_val: 53.89289474487305, obj_val: 53.799964904785156, abs dis: 0.09292984008789062
[rfa agg] iter: 1, weight: tensor([0.1627, 0.0215, 0.1086, 0.0428, 0.0310, 0.1375, 0.0519, 0.0326, 0.2522,
        0.1591])
[rfa agg] iter:  2, prev_obj_val: 53.799964904785156, obj_val: 64.24320220947266, abs dis: 10.4432373046875
[rfa agg] iter: 2, weight: tensor([0.1562, 0.0202, 0.0993, 0.0401, 0.0290, 0.1329, 0.0486, 0.0306, 0.2907,
        0.1524])
[rfa agg] iter:  3, prev_obj_val: 64.24320220947266, obj_val: 72.1475601196289, abs dis: 7.90435791015625
[rfa agg] iter: 3, weight: tensor([0.1095, 0.0438, 0.0909, 0.0506, 0.0398, 0.2910, 0.0575, 0.0411, 0.1635,
        0.1122])
[rfa agg] iter:  4, prev_obj_val: 72.1475601196289, obj_val: 60.44099044799805, abs dis: 11.70656967163086
[rfa agg] iter: 4, weight: tensor([0.1105, 0.0848, 0.0994, 0.0632, 0.0518, 0.2131, 0.0695, 0.0531, 0.1408,
        0.1139])
[rfa agg] iter:  5, prev_obj_val: 60.44099044799805, obj_val: 64.20603942871094, abs dis: 3.7650489807128906
[rfa agg] iter: 5, weight: tensor([0.1075, 0.0308, 0.0842, 0.0430, 0.0329, 0.3355, 0.0498, 0.0343, 0.1731,
        0.1091])
[rfa agg] iter:  6, prev_obj_val: 64.20603942871094, obj_val: 68.1513442993164, abs dis: 3.9453048706054688
[rfa agg] iter: 6, weight: tensor([0.1043, 0.0419, 0.0867, 0.0483, 0.0380, 0.3280, 0.0549, 0.0393, 0.1521,
        0.1066])
[rfa agg] iter:  7, prev_obj_val: 68.1513442993164, obj_val: 60.432151794433594, abs dis: 7.7191925048828125
[rfa agg] iter: 7, weight: tensor([0.1097, 0.0609, 0.0954, 0.0571, 0.0459, 0.2596, 0.0638, 0.0472, 0.1477,
        0.1127])
[rfa agg] iter:  8, prev_obj_val: 60.432151794433594, obj_val: 64.20614624023438, abs dis: 3.7739944458007812
[rfa agg] iter: 8, weight: tensor([0.1055, 0.0302, 0.0826, 0.0422, 0.0323, 0.3474, 0.0489, 0.0337, 0.1701,
        0.1070])
[rfa agg] iter:  9, prev_obj_val: 64.20614624023438, obj_val: 68.15149688720703, abs dis: 3.9453506469726562
[rfa agg] iter: 9, weight: tensor([0.1040, 0.0418, 0.0865, 0.0482, 0.0379, 0.3300, 0.0547, 0.0392, 0.1515,
        0.1063])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3278, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.4276, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.5355179309845 sec.
Server Epoch:16 choose agents : [25, 23, 76, 70, 85, 6, 68, 74, 63, 35].
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0517, Accuracy: 349/690 (50.5797%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0250, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.4707, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0622, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0372, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9766, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0823, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1966, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 363/1418 (25.5994%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1012, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 455/1988 (22.8873%)
_Train Local_ResNet_18, epoch  16, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 688/1988 (34.6076%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1141, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0533, Accuracy: 416/1956 (21.2679%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0313, Accuracy: 672/1956 (34.3558%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2478, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   1, Avg loss: 0.0623, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  16, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 416/1163 (35.7696%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.2990, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 520/1552 (33.5052%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 784/1552 (50.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.8028, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 270/888 (30.4054%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.1353, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 44/271 (16.2362%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0538, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6871, Accuracy: 43/10000 (0.4300%)
time spent on training: 164.229065656662
[rfa agg] training data poison_ratio: 0.13973170072926983  data num: [690, 715, 466, 1418, 1988, 1956, 1163, 1552, 888, 271]
[rfa agg] considering poison per batch poison_fraction: 0.04366615647789682
[rfa agg] init. name: [25, 23, 76, 70, 85, 6, 68, 74, 63, 35], weight: tensor([0.0621, 0.0644, 0.0420, 0.1277, 0.1790, 0.1761, 0.1047, 0.1397, 0.0799,
        0.0244])
[rfa agg] iter:  0, prev_obj_val: 70.90513610839844, obj_val: 75.74188232421875, abs dis: 4.8367462158203125
[rfa agg] iter: 0, weight: tensor([0.0314, 0.0368, 0.0157, 0.1509, 0.0615, 0.0659, 0.4605, 0.1079, 0.0620,
        0.0073])
[rfa agg] iter:  1, prev_obj_val: 75.74188232421875, obj_val: 77.72520446777344, abs dis: 1.9833221435546875
[rfa agg] iter: 1, weight: tensor([0.0422, 0.0507, 0.0200, 0.1197, 0.0609, 0.0646, 0.4455, 0.0943, 0.0932,
        0.0090])
[rfa agg] iter:  2, prev_obj_val: 77.72520446777344, obj_val: 75.74440002441406, abs dis: 1.980804443359375
[rfa agg] iter: 2, weight: tensor([0.0522, 0.0634, 0.0242, 0.1253, 0.0675, 0.0714, 0.3624, 0.1012, 0.1217,
        0.0107])
[rfa agg] iter:  3, prev_obj_val: 75.74440002441406, obj_val: 77.72425842285156, abs dis: 1.9798583984375
[rfa agg] iter: 3, weight: tensor([0.0429, 0.0515, 0.0203, 0.1214, 0.0617, 0.0655, 0.4369, 0.0957, 0.0950,
        0.0091])
[rfa agg] iter:  4, prev_obj_val: 77.72425842285156, obj_val: 75.74443817138672, abs dis: 1.9798202514648438
[rfa agg] iter: 4, weight: tensor([0.0522, 0.0635, 0.0242, 0.1253, 0.0675, 0.0714, 0.3620, 0.1013, 0.1218,
        0.0107])
[rfa agg] iter:  5, prev_obj_val: 75.74443817138672, obj_val: 77.72425079345703, abs dis: 1.9798126220703125
[rfa agg] iter: 5, weight: tensor([0.0429, 0.0515, 0.0203, 0.1214, 0.0618, 0.0655, 0.4368, 0.0957, 0.0950,
        0.0091])
[rfa agg] iter:  6, prev_obj_val: 77.72425079345703, obj_val: 75.74443817138672, abs dis: 1.9798126220703125
[rfa agg] iter: 6, weight: tensor([0.0522, 0.0635, 0.0242, 0.1253, 0.0675, 0.0714, 0.3620, 0.1013, 0.1218,
        0.0107])
[rfa agg] iter:  7, prev_obj_val: 75.74443817138672, obj_val: 77.72425079345703, abs dis: 1.9798126220703125
[rfa agg] iter: 7, weight: tensor([0.0429, 0.0515, 0.0203, 0.1214, 0.0618, 0.0655, 0.4368, 0.0957, 0.0950,
        0.0091])
[rfa agg] iter:  8, prev_obj_val: 77.72425079345703, obj_val: 75.74443817138672, abs dis: 1.9798126220703125
[rfa agg] iter: 8, weight: tensor([0.0522, 0.0635, 0.0242, 0.1253, 0.0675, 0.0714, 0.3620, 0.1013, 0.1218,
        0.0107])
[rfa agg] iter:  9, prev_obj_val: 75.74443817138672, obj_val: 77.72425079345703, abs dis: 1.9798126220703125
[rfa agg] iter: 9, weight: tensor([0.0429, 0.0515, 0.0203, 0.1214, 0.0618, 0.0655, 0.4368, 0.0957, 0.0950,
        0.0091])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3293, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.4399, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.1556234359741 sec.
Server Epoch:17 choose agents : [38, 31, 29, 86, 59, 67, 35, 24, 5, 46].
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 263/1131 (23.2538%)
_Train Local_ResNet_18, epoch  17, local model 38, internal_epoch   2, Avg loss: 0.0295, Accuracy: 520/1131 (45.9770%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9488, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   1, Avg loss: 0.0762, Accuracy: 90/460 (19.5652%)
_Train Local_ResNet_18, epoch  17, local model 31, internal_epoch   2, Avg loss: 0.0347, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.6734, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 441/1440 (30.6250%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 669/1440 (46.4583%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.5203, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   1, Avg loss: 0.0607, Accuracy: 369/1003 (36.7896%)
_Train Local_ResNet_18, epoch  17, local model 86, internal_epoch   2, Avg loss: 0.0337, Accuracy: 385/1003 (38.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0126, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   1, Avg loss: 0.0595, Accuracy: 327/1089 (30.0275%)
_Train Local_ResNet_18, epoch  17, local model 59, internal_epoch   2, Avg loss: 0.0263, Accuracy: 512/1089 (47.0156%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.6996, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   1, Avg loss: 0.0764, Accuracy: 74/426 (17.3709%)
_Train Local_ResNet_18, epoch  17, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.2585, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6754, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  17, local model 24, internal_epoch   2, Avg loss: 0.0416, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.8383, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 387/1628 (23.7715%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 861/1628 (52.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.9781, Accuracy: 139/10000 (1.3900%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  17, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 737/1904 (38.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7392, Accuracy: 105/10000 (1.0500%)
time spent on training: 142.3610441684723
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 460, 1440, 1003, 1089, 426, 271, 312, 1628, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 31, 29, 86, 59, 67, 35, 24, 5, 46], weight: tensor([0.1170, 0.0476, 0.1490, 0.1038, 0.1127, 0.0441, 0.0280, 0.0323, 0.1685,
        0.1970])
[rfa agg] iter:  0, prev_obj_val: 59.667911529541016, obj_val: 62.83454895019531, abs dis: 3.166637420654297
[rfa agg] iter: 0, weight: tensor([0.3763, 0.0126, 0.0775, 0.1288, 0.2832, 0.0106, 0.0057, 0.0066, 0.0554,
        0.0434])
[rfa agg] iter:  1, prev_obj_val: 62.83454895019531, obj_val: 67.32608032226562, abs dis: 4.4915313720703125
[rfa agg] iter: 1, weight: tensor([0.2926, 0.0157, 0.0727, 0.2416, 0.2495, 0.0131, 0.0069, 0.0080, 0.0552,
        0.0448])
[rfa agg] iter:  2, prev_obj_val: 67.32608032226562, obj_val: 69.98281860351562, abs dis: 2.65673828125
[rfa agg] iter: 2, weight: tensor([0.1691, 0.0181, 0.0645, 0.4656, 0.1568, 0.0150, 0.0078, 0.0090, 0.0513,
        0.0429])
[rfa agg] iter:  3, prev_obj_val: 69.98281860351562, obj_val: 72.95977783203125, abs dis: 2.976959228515625
[rfa agg] iter: 3, weight: tensor([0.1464, 0.0208, 0.0646, 0.4985, 0.1369, 0.0170, 0.0088, 0.0101, 0.0524,
        0.0445])
[rfa agg] iter:  4, prev_obj_val: 72.95977783203125, obj_val: 67.23625946044922, abs dis: 5.723518371582031
[rfa agg] iter: 4, weight: tensor([0.1611, 0.0290, 0.0791, 0.4082, 0.1518, 0.0235, 0.0120, 0.0138, 0.0653,
        0.0561])
[rfa agg] iter:  5, prev_obj_val: 67.23625946044922, obj_val: 67.2049560546875, abs dis: 0.03130340576171875
[rfa agg] iter: 5, weight: tensor([0.1437, 0.0157, 0.0557, 0.5435, 0.1326, 0.0129, 0.0067, 0.0077, 0.0443,
        0.0371])
[rfa agg] iter:  6, prev_obj_val: 67.2049560546875, obj_val: 67.19647216796875, abs dis: 0.00848388671875
[rfa agg] iter: 6, weight: tensor([0.1247, 0.0137, 0.0487, 0.6029, 0.1148, 0.0113, 0.0059, 0.0068, 0.0387,
        0.0325])
[rfa agg] iter:  7, prev_obj_val: 67.19647216796875, obj_val: 69.99308776855469, abs dis: 2.7966156005859375
[rfa agg] iter: 7, weight: tensor([0.1139, 0.0126, 0.0447, 0.6368, 0.1047, 0.0104, 0.0054, 0.0062, 0.0356,
        0.0298])
[rfa agg] iter:  8, prev_obj_val: 69.99308776855469, obj_val: 69.98091125488281, abs dis: 0.012176513671875
[rfa agg] iter: 8, weight: tensor([0.1349, 0.0193, 0.0601, 0.5365, 0.1257, 0.0158, 0.0081, 0.0094, 0.0488,
        0.0414])
[rfa agg] iter:  9, prev_obj_val: 69.98091125488281, obj_val: 69.9803695678711, abs dis: 0.00054168701171875
[rfa agg] iter: 9, weight: tensor([0.1411, 0.0201, 0.0626, 0.5160, 0.1317, 0.0165, 0.0085, 0.0098, 0.0508,
        0.0431])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3321, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.4468, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.9405446052551 sec.
Server Epoch:18 choose agents : [82, 96, 3, 25, 2, 8, 84, 54, 78, 31].
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 63/500 (12.6000%)
_Train Local_ResNet_18, epoch  18, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.5694, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  18, local model 96, internal_epoch   2, Avg loss: 0.0524, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6360, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 130/781 (16.6453%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3388, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   1, Avg loss: 0.0504, Accuracy: 347/690 (50.2899%)
_Train Local_ResNet_18, epoch  18, local model 25, internal_epoch   2, Avg loss: 0.0251, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6763, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 240/605 (39.6694%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.2842, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0591, Accuracy: 293/1513 (19.3655%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0356, Accuracy: 517/1513 (34.1705%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.8908, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   1, Avg loss: 0.0582, Accuracy: 353/1190 (29.6639%)
_Train Local_ResNet_18, epoch  18, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 476/1190 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1027, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 354/1130 (31.3274%)
_Train Local_ResNet_18, epoch  18, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 491/1130 (43.4513%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.3252, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0852, Accuracy: 45/416 (10.8173%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0479, Accuracy: 188/416 (45.1923%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3572, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   1, Avg loss: 0.0776, Accuracy: 79/460 (17.1739%)
_Train Local_ResNet_18, epoch  18, local model 31, internal_epoch   2, Avg loss: 0.0342, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7631, Accuracy: 51/10000 (0.5100%)
time spent on training: 134.66003346443176
[rfa agg] training data poison_ratio: 0.0  data num: [500, 311, 781, 690, 605, 1513, 1190, 1130, 416, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 96, 3, 25, 2, 8, 84, 54, 78, 31], weight: tensor([0.0658, 0.0409, 0.1028, 0.0908, 0.0796, 0.1992, 0.1567, 0.1488, 0.0548,
        0.0606])
[rfa agg] iter:  0, prev_obj_val: 52.6524543762207, obj_val: 58.31386947631836, abs dis: 5.661415100097656
[rfa agg] iter: 0, weight: tensor([0.0529, 0.0189, 0.2751, 0.2424, 0.1221, 0.0537, 0.0719, 0.0792, 0.0353,
        0.0485])
[rfa agg] iter:  1, prev_obj_val: 58.31386947631836, obj_val: 65.5225830078125, abs dis: 7.208713531494141
[rfa agg] iter: 1, weight: tensor([0.0839, 0.0215, 0.0890, 0.2094, 0.3411, 0.0374, 0.0456, 0.0486, 0.0474,
        0.0761])
[rfa agg] iter:  2, prev_obj_val: 65.5225830078125, obj_val: 71.52495574951172, abs dis: 6.002372741699219
[rfa agg] iter: 2, weight: tensor([0.2417, 0.0319, 0.0623, 0.0978, 0.1402, 0.0353, 0.0409, 0.0428, 0.0951,
        0.2120])
[rfa agg] iter:  3, prev_obj_val: 71.52495574951172, obj_val: 71.51522827148438, abs dis: 0.00972747802734375
[rfa agg] iter: 3, weight: tensor([0.2516, 0.0402, 0.0463, 0.0637, 0.0773, 0.0301, 0.0339, 0.0352, 0.2017,
        0.2199])
[rfa agg] iter:  4, prev_obj_val: 71.51522827148438, obj_val: 75.15475463867188, abs dis: 3.6395263671875
[rfa agg] iter: 4, weight: tensor([0.2488, 0.0396, 0.0455, 0.0626, 0.0758, 0.0296, 0.0333, 0.0346, 0.2086,
        0.2217])
[rfa agg] iter:  5, prev_obj_val: 75.15475463867188, obj_val: 71.52739715576172, abs dis: 3.6273574829101562
[rfa agg] iter: 5, weight: tensor([0.1619, 0.0532, 0.0454, 0.0597, 0.0692, 0.0312, 0.0346, 0.0359, 0.3616,
        0.1474])
[rfa agg] iter:  6, prev_obj_val: 71.52739715576172, obj_val: 71.51536560058594, abs dis: 0.01203155517578125
[rfa agg] iter: 6, weight: tensor([0.2356, 0.0398, 0.0457, 0.0628, 0.0761, 0.0297, 0.0334, 0.0347, 0.2265,
        0.2158])
[rfa agg] iter:  7, prev_obj_val: 71.51536560058594, obj_val: 75.15426635742188, abs dis: 3.6389007568359375
[rfa agg] iter: 7, weight: tensor([0.2462, 0.0396, 0.0455, 0.0625, 0.0757, 0.0296, 0.0333, 0.0346, 0.2113,
        0.2217])
[rfa agg] iter:  8, prev_obj_val: 75.15426635742188, obj_val: 71.52751922607422, abs dis: 3.6267471313476562
[rfa agg] iter: 8, weight: tensor([0.1616, 0.0532, 0.0453, 0.0596, 0.0691, 0.0311, 0.0346, 0.0358, 0.3626,
        0.1472])
[rfa agg] iter:  9, prev_obj_val: 71.52751922607422, obj_val: 71.51536560058594, abs dis: 0.01215362548828125
[rfa agg] iter: 9, weight: tensor([0.2355, 0.0398, 0.0457, 0.0628, 0.0761, 0.0297, 0.0334, 0.0347, 0.2266,
        0.2158])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3341, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.4567, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.3309602737427 sec.
Server Epoch:19 choose agents : [7, 92, 38, 18, 96, 99, 22, 64, 12, 16].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 369/891 (41.4141%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 419/891 (47.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 463/1715 (26.9971%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 733/1715 (42.7405%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9961, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   1, Avg loss: 0.0596, Accuracy: 273/1131 (24.1379%)
_Train Local_ResNet_18, epoch  19, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 516/1131 (45.6233%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8814, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0736, Accuracy: 136/530 (25.6604%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3524, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch  19, local model 96, internal_epoch   2, Avg loss: 0.0521, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.6271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   1, Avg loss: 0.0601, Accuracy: 210/773 (27.1669%)
_Train Local_ResNet_18, epoch  19, local model 99, internal_epoch   2, Avg loss: 0.0293, Accuracy: 425/773 (54.9806%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.0560, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 530/1470 (36.0544%)
_Train Local_ResNet_18, epoch  19, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 863/1470 (58.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.3570, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   1, Avg loss: 0.0655, Accuracy: 170/953 (17.8384%)
_Train Local_ResNet_18, epoch  19, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1459, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  19, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.9366, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0605, Accuracy: 290/708 (40.9605%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2567, Accuracy: 70/10000 (0.7000%)
time spent on training: 150.2818706035614
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1715, 1131, 530, 311, 773, 1470, 953, 338, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 92, 38, 18, 96, 99, 22, 64, 12, 16], weight: tensor([0.1010, 0.1944, 0.1282, 0.0601, 0.0353, 0.0876, 0.1667, 0.1080, 0.0383,
        0.0803])
[rfa agg] iter:  0, prev_obj_val: 51.70306396484375, obj_val: 56.840999603271484, abs dis: 5.137935638427734
[rfa agg] iter: 0, weight: tensor([0.2041, 0.0410, 0.1042, 0.0252, 0.0089, 0.1050, 0.0525, 0.3821, 0.0108,
        0.0663])
[rfa agg] iter:  1, prev_obj_val: 56.840999603271484, obj_val: 64.70710754394531, abs dis: 7.866107940673828
[rfa agg] iter: 1, weight: tensor([0.2021, 0.0334, 0.0610, 0.0357, 0.0106, 0.3189, 0.0400, 0.1269, 0.0132,
        0.1580])
[rfa agg] iter:  2, prev_obj_val: 64.70710754394531, obj_val: 64.66495513916016, abs dis: 0.04215240478515625
[rfa agg] iter: 2, weight: tensor([0.1270, 0.0407, 0.0636, 0.0757, 0.0176, 0.1802, 0.0470, 0.0988, 0.0226,
        0.3269])
[rfa agg] iter:  3, prev_obj_val: 64.66495513916016, obj_val: 61.66676330566406, abs dis: 2.9981918334960938
[rfa agg] iter: 3, weight: tensor([0.1207, 0.0389, 0.0608, 0.0725, 0.0168, 0.1683, 0.0449, 0.0941, 0.0216,
        0.3613])
[rfa agg] iter:  4, prev_obj_val: 61.66676330566406, obj_val: 67.8482666015625, abs dis: 6.1815032958984375
[rfa agg] iter: 4, weight: tensor([0.1145, 0.0312, 0.0510, 0.0473, 0.0121, 0.1793, 0.0364, 0.0846, 0.0154,
        0.4283])
[rfa agg] iter:  5, prev_obj_val: 67.8482666015625, obj_val: 64.66824340820312, abs dis: 3.180023193359375
[rfa agg] iter: 5, weight: tensor([0.1250, 0.0464, 0.0695, 0.1092, 0.0224, 0.1598, 0.0529, 0.1017, 0.0292,
        0.2840])
[rfa agg] iter:  6, prev_obj_val: 64.66824340820312, obj_val: 61.66739273071289, abs dis: 3.0008506774902344
[rfa agg] iter: 6, weight: tensor([0.1219, 0.0393, 0.0613, 0.0733, 0.0170, 0.1695, 0.0453, 0.0950, 0.0218,
        0.3558])
[rfa agg] iter:  7, prev_obj_val: 61.66739273071289, obj_val: 67.84796905517578, abs dis: 6.180576324462891
[rfa agg] iter: 7, weight: tensor([0.1149, 0.0313, 0.0512, 0.0475, 0.0122, 0.1801, 0.0365, 0.0849, 0.0154,
        0.4261])
[rfa agg] iter:  8, prev_obj_val: 67.84796905517578, obj_val: 64.66825866699219, abs dis: 3.1797103881835938
[rfa agg] iter: 8, weight: tensor([0.1250, 0.0464, 0.0695, 0.1092, 0.0224, 0.1599, 0.0529, 0.1017, 0.0292,
        0.2839])
[rfa agg] iter:  9, prev_obj_val: 64.66825866699219, obj_val: 61.667396545410156, abs dis: 3.0008621215820312
[rfa agg] iter: 9, weight: tensor([0.1219, 0.0393, 0.0613, 0.0733, 0.0170, 0.1695, 0.0453, 0.0950, 0.0218,
        0.3557])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3362, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.4444, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.5862009525299 sec.
Server Epoch:20 choose agents : [81, 15, 59, 7, 68, 53, 76, 56, 63, 11].
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   1, Avg loss: 0.0646, Accuracy: 260/774 (33.5917%)
_Train Local_ResNet_18, epoch  20, local model 81, internal_epoch   2, Avg loss: 0.0338, Accuracy: 346/774 (44.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.8989, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0530, Accuracy: 354/1154 (30.6759%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0265, Accuracy: 548/1154 (47.4870%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8134, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0506, Accuracy: 328/1089 (30.1194%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 12.2214, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0522, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 412/891 (46.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0189, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   1, Avg loss: 0.0589, Accuracy: 390/1163 (33.5340%)
_Train Local_ResNet_18, epoch  20, local model 68, internal_epoch   2, Avg loss: 0.0353, Accuracy: 480/1163 (41.2726%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2582, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch  20, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 474/813 (58.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 11.3083, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0831, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0457, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.6259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   1, Avg loss: 0.0840, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  20, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 272/888 (30.6306%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 449/888 (50.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.2837, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0551, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7607, Accuracy: 56/10000 (0.5600%)
time spent on training: 147.44721364974976
[rfa agg] training data poison_ratio: 0.0  data num: [774, 1154, 1089, 891, 1163, 813, 466, 186, 888, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [81, 15, 59, 7, 68, 53, 76, 56, 63, 11], weight: tensor([0.0951, 0.1418, 0.1338, 0.1095, 0.1429, 0.0999, 0.0573, 0.0229, 0.1091,
        0.0875])
[rfa agg] iter:  0, prev_obj_val: 30.66337776184082, obj_val: 42.784969329833984, abs dis: 12.121591567993164
[rfa agg] iter: 0, weight: tensor([0.2222, 0.0364, 0.0406, 0.1337, 0.0368, 0.2557, 0.0177, 0.0036, 0.1387,
        0.1146])
[rfa agg] iter:  1, prev_obj_val: 42.784969329833984, obj_val: 35.7980842590332, abs dis: 6.986885070800781
[rfa agg] iter: 1, weight: tensor([0.1447, 0.0558, 0.0596, 0.1124, 0.0563, 0.1543, 0.0593, 0.0090, 0.1126,
        0.2360])
[rfa agg] iter:  2, prev_obj_val: 35.7980842590332, obj_val: 42.7679328918457, abs dis: 6.9698486328125
[rfa agg] iter: 2, weight: tensor([0.1563, 0.0388, 0.0421, 0.0985, 0.0392, 0.1701, 0.0274, 0.0049, 0.1000,
        0.3228])
[rfa agg] iter:  3, prev_obj_val: 42.7679328918457, obj_val: 39.17078399658203, abs dis: 3.597148895263672
[rfa agg] iter: 3, weight: tensor([0.1422, 0.0551, 0.0588, 0.1103, 0.0556, 0.1511, 0.0586, 0.0089, 0.1111,
        0.2482])
[rfa agg] iter:  4, prev_obj_val: 39.17078399658203, obj_val: 46.43067169189453, abs dis: 7.2598876953125
[rfa agg] iter: 4, weight: tensor([0.1451, 0.0465, 0.0500, 0.1035, 0.0469, 0.1552, 0.0400, 0.0066, 0.1044,
        0.3018])
[rfa agg] iter:  5, prev_obj_val: 46.43067169189453, obj_val: 39.17707061767578, abs dis: 7.25360107421875
[rfa agg] iter: 5, weight: tensor([0.1373, 0.0617, 0.0654, 0.1134, 0.0622, 0.1452, 0.0829, 0.0113, 0.1139,
        0.2066])
[rfa agg] iter:  6, prev_obj_val: 39.17707061767578, obj_val: 46.430118560791016, abs dis: 7.253047943115234
[rfa agg] iter: 6, weight: tensor([0.1463, 0.0468, 0.0504, 0.1044, 0.0473, 0.1563, 0.0403, 0.0067, 0.1052,
        0.2961])
[rfa agg] iter:  7, prev_obj_val: 46.430118560791016, obj_val: 39.17708969116211, abs dis: 7.253028869628906
[rfa agg] iter: 7, weight: tensor([0.1373, 0.0617, 0.0654, 0.1134, 0.0622, 0.1453, 0.0829, 0.0113, 0.1139,
        0.2065])
[rfa agg] iter:  8, prev_obj_val: 39.17708969116211, obj_val: 46.43011474609375, abs dis: 7.253025054931641
[rfa agg] iter: 8, weight: tensor([0.1463, 0.0468, 0.0504, 0.1044, 0.0473, 0.1563, 0.0403, 0.0067, 0.1052,
        0.2961])
[rfa agg] iter:  9, prev_obj_val: 46.43011474609375, obj_val: 39.17708969116211, abs dis: 7.253025054931641
[rfa agg] iter: 9, weight: tensor([0.1373, 0.0617, 0.0654, 0.1134, 0.0622, 0.1453, 0.0829, 0.0113, 0.1139,
        0.2065])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3387, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.4474, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.99171710014343 sec.
Server Epoch:21 choose agents : [0, 18, 27, 50, 82, 44, 79, 20, 69, 23].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0564, Accuracy: 390/1657 (23.5365%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0339, Accuracy: 598/1657 (36.0893%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0299, Accuracy: 689/1657 (41.5812%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0293, Accuracy: 723/1657 (43.6331%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0286, Accuracy: 744/1657 (44.9004%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0275, Accuracy: 794/1657 (47.9179%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0269, Accuracy: 805/1657 (48.5818%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0264, Accuracy: 821/1657 (49.5474%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0257, Accuracy: 844/1657 (50.9354%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0262, Accuracy: 840/1657 (50.6940%), train_poison_data_count: 520
Global model norm: 112.03288004392951.
Norm before scaling: 112.00676597866756. Distance: 1.2073588497678442
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6323, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.8765, Accuracy: 9320/9950 (93.6683%)
Scaling by  100
Scaled Norm after poisoning: 162.47384404881913, distance: 120.73587844443755
Total norm for 3 adversaries is: 162.47384404881913. distance: 120.73587844443755
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   1, Avg loss: 0.0742, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  21, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5287, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0544, Accuracy: 429/1587 (27.0321%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 609/1587 (38.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7606, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   1, Avg loss: 0.0615, Accuracy: 162/809 (20.0247%)
_Train Local_ResNet_18, epoch  21, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 340/809 (42.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6462, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  21, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.3323, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 402/1750 (22.9714%)
_Train Local_ResNet_18, epoch  21, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 716/1750 (40.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8664, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  21, local model 79, internal_epoch   2, Avg loss: 0.0841, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4159, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 408/807 (50.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3631, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   1, Avg loss: 0.0529, Accuracy: 310/590 (52.5424%)
_Train Local_ResNet_18, epoch  21, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5651, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  21, local model 23, internal_epoch   2, Avg loss: 0.0378, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.0353, Accuracy: 50/10000 (0.5000%)
time spent on training: 291.3996653556824
[rfa agg] training data poison_ratio: 0.4609494640122512  data num: [1657, 530, 1587, 809, 500, 1750, 197, 807, 590, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1440467075038285
[rfa agg] init. name: [0, 18, 27, 50, 82, 44, 79, 20, 69, 23], weight: tensor([0.1813, 0.0580, 0.1736, 0.0885, 0.0547, 0.1914, 0.0215, 0.0883, 0.0645,
        0.0782])
[rfa agg] iter:  0, prev_obj_val: 34451.375, obj_val: 24492.3359375, abs dis: 9959.0390625
[rfa agg] iter: 0, weight: tensor([0.0467, 0.0672, 0.2027, 0.1028, 0.0634, 0.2239, 0.0249, 0.1026, 0.0749,
        0.0908])
[rfa agg] iter:  1, prev_obj_val: 24492.3359375, obj_val: 21826.5234375, abs dis: 2665.8125
[rfa agg] iter: 1, weight: tensor([0.0107, 0.0690, 0.2122, 0.1061, 0.0650, 0.2352, 0.0254, 0.1058, 0.0770,
        0.0936])
[rfa agg] iter:  2, prev_obj_val: 21826.5234375, obj_val: 21210.751953125, abs dis: 615.771484375
[rfa agg] iter: 2, weight: tensor([0.0023, 0.0661, 0.2224, 0.1038, 0.0619, 0.2511, 0.0238, 0.1035, 0.0741,
        0.0911])
[rfa agg] iter:  3, prev_obj_val: 21210.751953125, obj_val: 21100.07421875, abs dis: 110.677734375
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0495, 0.2586, 0.0846, 0.0455, 0.3313, 0.0162, 0.0844, 0.0567,
        0.0726])
[rfa agg] iter:  4, prev_obj_val: 21100.07421875, obj_val: 21101.560546875, abs dis: 1.486328125
[rfa agg] iter: 4, weight: tensor([7.6830e-05, 2.1977e-02, 5.6530e-01, 4.6128e-02, 1.9391e-02, 2.3135e-01,
        6.0756e-03, 4.6105e-02, 2.6265e-02, 3.7330e-02])
[rfa agg] iter:  5, prev_obj_val: 21101.560546875, obj_val: 21102.7734375, abs dis: 1.212890625
[rfa agg] iter: 5, weight: tensor([1.1382e-04, 3.7745e-02, 4.0071e-01, 8.4062e-02, 3.2958e-02, 2.3779e-01,
        1.0027e-02, 8.4135e-02, 4.5641e-02, 6.6817e-02])
[rfa agg] iter:  6, prev_obj_val: 21102.7734375, obj_val: 21104.015625, abs dis: 1.2421875
[rfa agg] iter: 6, weight: tensor([1.2623e-04, 4.7575e-02, 3.1149e-01, 1.1297e-01, 4.1126e-02, 2.1520e-01,
        1.2165e-02, 1.1319e-01, 5.8208e-02, 8.7951e-02])
[rfa agg] iter:  7, prev_obj_val: 21104.015625, obj_val: 21105.720703125, abs dis: 1.705078125
[rfa agg] iter: 7, weight: tensor([1.2617e-04, 5.5053e-02, 2.3996e-01, 1.4303e-01, 4.6972e-02, 1.8143e-01,
        1.3418e-02, 1.4357e-01, 6.8417e-02, 1.0802e-01])
[rfa agg] iter:  8, prev_obj_val: 21105.720703125, obj_val: 21107.55859375, abs dis: 1.837890625
[rfa agg] iter: 8, weight: tensor([1.0827e-04, 5.9805e-02, 1.5777e-01, 1.8931e-01, 4.9764e-02, 1.2878e-01,
        1.3357e-02, 1.9134e-01, 7.6665e-02, 1.3310e-01])
[rfa agg] iter:  9, prev_obj_val: 21107.55859375, obj_val: 21113.35546875, abs dis: 5.796875
[rfa agg] iter: 9, weight: tensor([6.9682e-05, 5.2381e-02, 8.2274e-02, 2.5479e-01, 4.1815e-02, 7.0644e-02,
        1.0232e-02, 2.6659e-01, 7.0949e-02, 1.5026e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3411, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.4621, Accuracy: 0/9950 (0.0000%)
saving model
Done in 457.986967086792 sec.
Server Epoch:22 choose agents : [12, 23, 52, 19, 80, 2, 44, 8, 82, 58].
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0490, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.1035, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 332/715 (46.4336%)
_Train Local_ResNet_18, epoch  22, local model 23, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0724, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   1, Avg loss: 0.0583, Accuracy: 280/636 (44.0252%)
_Train Local_ResNet_18, epoch  22, local model 52, internal_epoch   2, Avg loss: 0.0300, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.7386, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 399/1036 (38.5135%)
_Train Local_ResNet_18, epoch  22, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 645/1036 (62.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.9797, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0369, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2457, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 243/605 (40.1653%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.4997, Accuracy: 72/10000 (0.7200%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 405/1750 (23.1429%)
_Train Local_ResNet_18, epoch  22, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 692/1750 (39.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9180, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0589, Accuracy: 282/1513 (18.6385%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 499/1513 (32.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8303, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   1, Avg loss: 0.0742, Accuracy: 85/500 (17.0000%)
_Train Local_ResNet_18, epoch  22, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5308, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0599, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.4948, Accuracy: 51/10000 (0.5100%)
time spent on training: 154.12738227844238
[rfa agg] training data poison_ratio: 0.20401025880158546  data num: [338, 715, 636, 1036, 682, 605, 1750, 1513, 500, 803]
[rfa agg] considering poison per batch poison_fraction: 0.06375320587549546
[rfa agg] init. name: [12, 23, 52, 19, 80, 2, 44, 8, 82, 58], weight: tensor([0.0394, 0.0834, 0.0741, 0.1208, 0.0795, 0.0705, 0.2040, 0.1764, 0.0583,
        0.0936])
[rfa agg] iter:  0, prev_obj_val: 60.62031936645508, obj_val: 61.86872100830078, abs dis: 1.2484016418457031
[rfa agg] iter: 0, weight: tensor([0.0194, 0.1189, 0.0653, 0.2545, 0.0874, 0.0622, 0.0696, 0.0867, 0.0369,
        0.1990])
[rfa agg] iter:  1, prev_obj_val: 61.86872100830078, obj_val: 68.26131439208984, abs dis: 6.3925933837890625
[rfa agg] iter: 1, weight: tensor([0.0151, 0.2177, 0.0713, 0.0664, 0.1240, 0.0681, 0.0327, 0.0380, 0.0321,
        0.3345])
[rfa agg] iter:  2, prev_obj_val: 68.26131439208984, obj_val: 73.92008209228516, abs dis: 5.6587677001953125
[rfa agg] iter: 2, weight: tensor([0.0195, 0.1117, 0.2030, 0.0412, 0.2421, 0.1940, 0.0260, 0.0290, 0.0512,
        0.0823])
[rfa agg] iter:  3, prev_obj_val: 73.92008209228516, obj_val: 80.93000793457031, abs dis: 7.009925842285156
[rfa agg] iter: 3, weight: tensor([0.0283, 0.0806, 0.2559, 0.0406, 0.1275, 0.2473, 0.0279, 0.0307, 0.0943,
        0.0668])
[rfa agg] iter:  4, prev_obj_val: 80.93000793457031, obj_val: 84.57957458496094, abs dis: 3.649566650390625
[rfa agg] iter: 4, weight: tensor([0.0509, 0.0759, 0.1535, 0.0463, 0.1014, 0.1465, 0.0342, 0.0371, 0.2868,
        0.0674])
[rfa agg] iter:  5, prev_obj_val: 84.57957458496094, obj_val: 88.54544830322266, abs dis: 3.9658737182617188
[rfa agg] iter: 5, weight: tensor([0.0534, 0.0563, 0.0984, 0.0369, 0.0719, 0.0940, 0.0281, 0.0303, 0.4794,
        0.0513])
[rfa agg] iter:  6, prev_obj_val: 88.54544830322266, obj_val: 80.91200256347656, abs dis: 7.633445739746094
[rfa agg] iter: 6, weight: tensor([0.0916, 0.0656, 0.1038, 0.0457, 0.0809, 0.0992, 0.0358, 0.0384, 0.3778,
        0.0611])
[rfa agg] iter:  7, prev_obj_val: 80.91200256347656, obj_val: 84.57524108886719, abs dis: 3.663238525390625
[rfa agg] iter: 7, weight: tensor([0.0492, 0.0730, 0.1447, 0.0446, 0.0980, 0.1391, 0.0329, 0.0358, 0.3177,
        0.0651])
[rfa agg] iter:  8, prev_obj_val: 84.57524108886719, obj_val: 88.54608917236328, abs dis: 3.9708480834960938
[rfa agg] iter: 8, weight: tensor([0.0522, 0.0551, 0.0961, 0.0361, 0.0704, 0.0919, 0.0275, 0.0297, 0.4909,
        0.0502])
[rfa agg] iter:  9, prev_obj_val: 88.54608917236328, obj_val: 80.91204833984375, abs dis: 7.634040832519531
[rfa agg] iter: 9, weight: tensor([0.0915, 0.0655, 0.1036, 0.0456, 0.0808, 0.0991, 0.0358, 0.0384, 0.3788,
        0.0610])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3429, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.4766, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.81193709373474 sec.
Server Epoch:23 choose agents : [20, 9, 57, 74, 2, 92, 23, 81, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0588, Accuracy: 239/807 (29.6159%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0337, Accuracy: 355/807 (43.9901%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0284, Accuracy: 404/807 (50.0620%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0279, Accuracy: 386/807 (47.8315%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0272, Accuracy: 417/807 (51.6729%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0254, Accuracy: 444/807 (55.0186%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0258, Accuracy: 438/807 (54.2751%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0243, Accuracy: 443/807 (54.8947%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0243, Accuracy: 452/807 (56.0099%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0241, Accuracy: 461/807 (57.1252%), train_poison_data_count: 260
Global model norm: 112.0310015687622.
Norm before scaling: 112.02038388726402. Distance: 0.8401038188582802
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4448, Accuracy: 82/10000 (0.8200%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9070, Accuracy: 8930/9950 (89.7487%)
Scaling by  100
Scaled Norm after poisoning: 138.92605665874922, distance: 84.01037824188003
Total norm for 2 adversaries is: 138.92605665874922. distance: 84.01037824188003
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 706/1275 (55.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.6387, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   1, Avg loss: 0.0533, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch  23, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 518/1154 (44.8873%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5545, Accuracy: 69/10000 (0.6900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0423, Accuracy: 517/1552 (33.3119%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 807/1552 (51.9974%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.5849, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0615, Accuracy: 258/605 (42.6446%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5323, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 470/1715 (27.4052%)
_Train Local_ResNet_18, epoch  23, local model 92, internal_epoch   2, Avg loss: 0.0298, Accuracy: 777/1715 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9730, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   1, Avg loss: 0.0611, Accuracy: 342/715 (47.8322%)
_Train Local_ResNet_18, epoch  23, local model 23, internal_epoch   2, Avg loss: 0.0373, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.9580, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0642, Accuracy: 259/774 (33.4625%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0339, Accuracy: 328/774 (42.3773%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0337, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0723, Accuracy: 127/781 (16.2612%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 222/781 (28.4251%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2570, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 402/1628 (24.6929%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 837/1628 (51.4128%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8443, Accuracy: 143/10000 (1.4300%)
time spent on training: 273.6031496524811
[rfa agg] training data poison_ratio: 0.21433763401780848  data num: [807, 1275, 1154, 1552, 605, 1715, 715, 774, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.06698051063056515
[rfa agg] init. name: [20, 9, 57, 74, 2, 92, 23, 81, 3, 5], weight: tensor([0.0733, 0.1158, 0.1049, 0.1410, 0.0550, 0.1558, 0.0650, 0.0703, 0.0710,
        0.1479])
[rfa agg] iter:  0, prev_obj_val: 7856.77490234375, obj_val: 4536.068359375, abs dis: 3320.70654296875
[rfa agg] iter: 0, weight: tensor([0.0062, 0.1241, 0.1121, 0.1526, 0.0577, 0.1694, 0.0684, 0.0742, 0.0749,
        0.1605])
[rfa agg] iter:  1, prev_obj_val: 4536.068359375, obj_val: 4294.263671875, abs dis: 241.8046875
[rfa agg] iter: 1, weight: tensor([0.0004, 0.1202, 0.1060, 0.1684, 0.0452, 0.1981, 0.0557, 0.0616, 0.0622,
        0.1822])
[rfa agg] iter:  2, prev_obj_val: 4294.263671875, obj_val: 4297.72705078125, abs dis: 3.46337890625
[rfa agg] iter: 2, weight: tensor([4.8548e-05, 2.8524e-01, 1.6890e-01, 1.6750e-01, 2.0476e-02, 1.1966e-01,
        2.9243e-02, 3.5335e-02, 3.5682e-02, 1.3790e-01])
[rfa agg] iter:  3, prev_obj_val: 4297.72705078125, obj_val: 4305.44775390625, abs dis: 7.720703125
[rfa agg] iter: 3, weight: tensor([3.5839e-05, 2.9667e-01, 3.7976e-01, 7.3658e-02, 1.9303e-02, 6.1160e-02,
        2.9218e-02, 3.6786e-02, 3.7176e-02, 6.6229e-02])
[rfa agg] iter:  4, prev_obj_val: 4305.44775390625, obj_val: 4307.525390625, abs dis: 2.07763671875
[rfa agg] iter: 4, weight: tensor([5.8994e-05, 1.9536e-01, 2.5944e-01, 9.1227e-02, 4.0773e-02, 8.0741e-02,
        6.6891e-02, 8.9645e-02, 9.0794e-02, 8.5064e-02])
[rfa agg] iter:  5, prev_obj_val: 4307.525390625, obj_val: 4309.63623046875, abs dis: 2.11083984375
[rfa agg] iter: 5, weight: tensor([6.2363e-05, 1.7799e-01, 2.2140e-01, 9.0921e-02, 4.6433e-02, 8.1399e-02,
        7.8589e-02, 1.0824e-01, 1.0965e-01, 8.5324e-02])
[rfa agg] iter:  6, prev_obj_val: 4309.63623046875, obj_val: 4305.43115234375, abs dis: 4.205078125
[rfa agg] iter: 6, weight: tensor([6.3688e-05, 1.5995e-01, 1.9037e-01, 8.7768e-02, 5.1346e-02, 7.9403e-02,
        9.0079e-02, 1.2818e-01, 1.2999e-01, 8.2843e-02])
[rfa agg] iter:  7, prev_obj_val: 4305.43115234375, obj_val: 4307.52392578125, abs dis: 2.0927734375
[rfa agg] iter: 7, weight: tensor([5.9322e-05, 1.9556e-01, 2.5448e-01, 9.1821e-02, 4.1046e-02, 8.1264e-02,
        6.7521e-02, 9.0786e-02, 9.1857e-02, 8.5608e-02])
[rfa agg] iter:  8, prev_obj_val: 4307.52392578125, obj_val: 4309.63623046875, abs dis: 2.1123046875
[rfa agg] iter: 8, weight: tensor([6.2367e-05, 1.7802e-01, 2.2129e-01, 9.0929e-02, 4.6437e-02, 8.1406e-02,
        7.8599e-02, 1.0826e-01, 1.0967e-01, 8.5331e-02])
[rfa agg] iter:  9, prev_obj_val: 4309.63623046875, obj_val: 4305.43115234375, abs dis: 4.205078125
[rfa agg] iter: 9, weight: tensor([6.3688e-05, 1.5995e-01, 1.9037e-01, 8.7768e-02, 5.1346e-02, 7.9403e-02,
        9.0079e-02, 1.2818e-01, 1.2999e-01, 8.2843e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3442, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.4899, Accuracy: 0/9950 (0.0000%)
saving model
Done in 432.8714120388031 sec.
Server Epoch:24 choose agents : [67, 87, 90, 88, 15, 72, 3, 12, 54, 76].
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0762, Accuracy: 73/426 (17.1362%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0400, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5518, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 303/1131 (26.7905%)
_Train Local_ResNet_18, epoch  24, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4483, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   1, Avg loss: 0.0517, Accuracy: 348/677 (51.4032%)
_Train Local_ResNet_18, epoch  24, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.0250, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   1, Avg loss: 0.0723, Accuracy: 156/603 (25.8706%)
_Train Local_ResNet_18, epoch  24, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3236, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   1, Avg loss: 0.0547, Accuracy: 355/1154 (30.7626%)
_Train Local_ResNet_18, epoch  24, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 385/1154 (33.3622%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.6087, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 274/1241 (22.0790%)
_Train Local_ResNet_18, epoch  24, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 447/1241 (36.0193%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6242, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0714, Accuracy: 127/781 (16.2612%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7420, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   1, Avg loss: 0.0848, Accuracy: 30/338 (8.8757%)
_Train Local_ResNet_18, epoch  24, local model 12, internal_epoch   2, Avg loss: 0.0447, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.4324, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 357/1130 (31.5929%)
_Train Local_ResNet_18, epoch  24, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 451/1130 (39.9115%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6964, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0809, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0462, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6370, Accuracy: 50/10000 (0.5000%)
time spent on training: 144.65696263313293
[rfa agg] training data poison_ratio: 0.0  data num: [426, 1131, 677, 603, 1154, 1241, 781, 338, 1130, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [67, 87, 90, 88, 15, 72, 3, 12, 54, 76], weight: tensor([0.0536, 0.1423, 0.0852, 0.0759, 0.1452, 0.1562, 0.0983, 0.0425, 0.1422,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 44.38505554199219, obj_val: 51.70795440673828, abs dis: 7.322898864746094
[rfa agg] iter: 0, weight: tensor([0.0301, 0.0794, 0.1666, 0.0917, 0.0685, 0.0641, 0.3600, 0.0202, 0.0794,
        0.0401])
[rfa agg] iter:  1, prev_obj_val: 51.70795440673828, obj_val: 60.04493713378906, abs dis: 8.336982727050781
[rfa agg] iter: 1, weight: tensor([0.0407, 0.0505, 0.3232, 0.2559, 0.0454, 0.0438, 0.1034, 0.0252, 0.0505,
        0.0615])
[rfa agg] iter:  2, prev_obj_val: 60.04493713378906, obj_val: 66.33077239990234, abs dis: 6.285835266113281
[rfa agg] iter: 2, weight: tensor([0.0913, 0.0546, 0.1454, 0.2388, 0.0501, 0.0491, 0.0840, 0.0487, 0.0546,
        0.1834])
[rfa agg] iter:  3, prev_obj_val: 66.33077239990234, obj_val: 66.29378509521484, abs dis: 0.0369873046875
[rfa agg] iter: 3, weight: tensor([0.1447, 0.0407, 0.0806, 0.1060, 0.0377, 0.0372, 0.0558, 0.0598, 0.0406,
        0.3969])
[rfa agg] iter:  4, prev_obj_val: 66.29378509521484, obj_val: 69.80294799804688, abs dis: 3.5091629028320312
[rfa agg] iter: 4, weight: tensor([0.1250, 0.0351, 0.0694, 0.0903, 0.0325, 0.0321, 0.0481, 0.0515, 0.0350,
        0.4810])
[rfa agg] iter:  5, prev_obj_val: 69.80294799804688, obj_val: 73.46759033203125, abs dis: 3.664642333984375
[rfa agg] iter: 5, weight: tensor([0.2522, 0.0396, 0.0708, 0.0867, 0.0369, 0.0365, 0.0520, 0.0802, 0.0396,
        0.3054])
[rfa agg] iter:  6, prev_obj_val: 73.46759033203125, obj_val: 66.34110260009766, abs dis: 7.126487731933594
[rfa agg] iter: 6, weight: tensor([0.4622, 0.0335, 0.0549, 0.0645, 0.0313, 0.0311, 0.0422, 0.1031, 0.0334,
        0.1438])
[rfa agg] iter:  7, prev_obj_val: 66.34110260009766, obj_val: 66.29402160644531, abs dis: 0.04708099365234375
[rfa agg] iter: 7, weight: tensor([0.1502, 0.0406, 0.0803, 0.1048, 0.0376, 0.0371, 0.0557, 0.0598, 0.0406,
        0.3933])
[rfa agg] iter:  8, prev_obj_val: 66.29402160644531, obj_val: 69.80278015136719, abs dis: 3.508758544921875
[rfa agg] iter: 8, weight: tensor([0.1254, 0.0351, 0.0696, 0.0905, 0.0326, 0.0321, 0.0482, 0.0517, 0.0351,
        0.4797])
[rfa agg] iter:  9, prev_obj_val: 69.80278015136719, obj_val: 73.46755981445312, abs dis: 3.6647796630859375
[rfa agg] iter: 9, weight: tensor([0.2523, 0.0396, 0.0708, 0.0867, 0.0369, 0.0365, 0.0520, 0.0802, 0.0396,
        0.3053])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3456, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5001, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.56793308258057 sec.
Server Epoch:25 choose agents : [74, 16, 75, 48, 28, 58, 93, 17, 20, 34].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0471, Accuracy: 404/1552 (26.0309%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 692/1552 (44.5876%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0201, Accuracy: 823/1552 (53.0284%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0190, Accuracy: 913/1552 (58.8273%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0184, Accuracy: 969/1552 (62.4356%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0177, Accuracy: 965/1552 (62.1778%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0177, Accuracy: 967/1552 (62.3067%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0170, Accuracy: 1007/1552 (64.8840%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0171, Accuracy: 980/1552 (63.1443%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0167, Accuracy: 995/1552 (64.1108%), train_poison_data_count: 496
Global model norm: 112.0288223237663.
Norm before scaling: 112.0055758586933. Distance: 1.2496427025364834
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.9471, Accuracy: 80/10000 (0.8000%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.7306, Accuracy: 8184/9950 (82.2513%)
Scaling by  100
Scaled Norm after poisoning: 165.80029049469425, distance: 124.96426833049118
Total norm for 2 adversaries is: 165.80029049469425. distance: 124.96426833049118
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0585, Accuracy: 306/708 (43.2203%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.6229, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   1, Avg loss: 0.0608, Accuracy: 275/776 (35.4381%)
_Train Local_ResNet_18, epoch  25, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6009, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0723, Accuracy: 109/631 (17.2742%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.6759, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch  25, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 605/1581 (38.2669%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8805, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   1, Avg loss: 0.0592, Accuracy: 355/803 (44.2092%)
_Train Local_ResNet_18, epoch  25, local model 58, internal_epoch   2, Avg loss: 0.0354, Accuracy: 356/803 (44.3337%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.6770, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  25, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 725/1742 (41.6188%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.5220, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 430/1574 (27.3189%)
_Train Local_ResNet_18, epoch  25, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 698/1574 (44.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3695, Accuracy: 111/10000 (1.1100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   1, Avg loss: 0.0551, Accuracy: 366/807 (45.3532%)
_Train Local_ResNet_18, epoch  25, local model 20, internal_epoch   2, Avg loss: 0.0303, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2991, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   1, Avg loss: 0.0564, Accuracy: 391/1427 (27.4001%)
_Train Local_ResNet_18, epoch  25, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6584, Accuracy: 82/10000 (0.8200%)
time spent on training: 295.5947802066803
[rfa agg] training data poison_ratio: 0.20334453926385657  data num: [1552, 708, 776, 631, 1581, 803, 1742, 1574, 807, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.06354516851995518
[rfa agg] init. name: [74, 16, 75, 48, 28, 58, 93, 17, 20, 34], weight: tensor([0.1338, 0.0610, 0.0669, 0.0544, 0.1363, 0.0692, 0.1502, 0.1357, 0.0696,
        0.1230])
[rfa agg] iter:  0, prev_obj_val: 25851.369140625, obj_val: 16820.158203125, abs dis: 9031.2109375
[rfa agg] iter: 0, weight: tensor([0.0232, 0.0685, 0.0751, 0.0609, 0.1541, 0.0777, 0.1701, 0.1534, 0.0781,
        0.1389])
[rfa agg] iter:  1, prev_obj_val: 16820.158203125, obj_val: 15211.826171875, abs dis: 1608.33203125
[rfa agg] iter: 1, weight: tensor([0.0036, 0.0681, 0.0749, 0.0603, 0.1591, 0.0776, 0.1772, 0.1584, 0.0779,
        0.1426])
[rfa agg] iter:  2, prev_obj_val: 15211.826171875, obj_val: 14973.04296875, abs dis: 238.783203125
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0573, 0.0641, 0.0492, 0.1718, 0.0663, 0.2056, 0.1711, 0.0667,
        0.1473])
[rfa agg] iter:  3, prev_obj_val: 14973.04296875, obj_val: 14976.9501953125, abs dis: 3.9072265625
[rfa agg] iter: 3, weight: tensor([2.6012e-05, 1.1826e-02, 1.4084e-02, 9.0906e-03, 3.3146e-01, 1.4569e-02,
        1.0115e-01, 3.3395e-01, 1.4639e-02, 1.6922e-01])
[rfa agg] iter:  4, prev_obj_val: 14976.9501953125, obj_val: 14981.380859375, abs dis: 4.4306640625
[rfa agg] iter: 4, weight: tensor([4.6090e-05, 2.6156e-02, 3.1825e-02, 1.9447e-02, 1.9002e-01, 3.2917e-02,
        1.0599e-01, 1.8938e-01, 3.3079e-02, 3.7115e-01])
[rfa agg] iter:  5, prev_obj_val: 14981.380859375, obj_val: 14982.9375, abs dis: 1.556640625
[rfa agg] iter: 5, weight: tensor([6.4573e-05, 4.3089e-02, 5.3451e-02, 3.1135e-02, 1.7886e-01, 5.5264e-02,
        1.1956e-01, 1.7823e-01, 5.5522e-02, 2.8482e-01])
[rfa agg] iter:  6, prev_obj_val: 14982.9375, obj_val: 14986.0830078125, abs dis: 3.1455078125
[rfa agg] iter: 6, weight: tensor([6.9553e-05, 4.9314e-02, 6.1683e-02, 3.5215e-02, 1.7420e-01, 6.3774e-02,
        1.2092e-01, 1.7355e-01, 6.4064e-02, 2.5721e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3468, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5154, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.35951685905457 sec.
Server Epoch:26 choose agents : [17, 3, 87, 52, 86, 61, 79, 80, 49, 59].
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   1, Avg loss: 0.0503, Accuracy: 429/1574 (27.2554%)
_Train Local_ResNet_18, epoch  26, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 733/1574 (46.5693%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6821, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0706, Accuracy: 141/781 (18.0538%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0351, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8161, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 307/1131 (27.1441%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 406/1131 (35.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.4663, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 288/636 (45.2830%)
_Train Local_ResNet_18, epoch  26, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5103, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0578, Accuracy: 390/1003 (38.8833%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0331, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6553, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  26, local model 61, internal_epoch   2, Avg loss: 0.1159, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3573, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1001, Accuracy: 25/197 (12.6904%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0798, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 241/682 (35.3372%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5914, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0776, Accuracy: 65/440 (14.7727%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0462, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3196, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   1, Avg loss: 0.0508, Accuracy: 343/1089 (31.4968%)
_Train Local_ResNet_18, epoch  26, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 500/1089 (45.9137%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.0489, Accuracy: 89/10000 (0.8900%)
time spent on training: 145.57697534561157
[rfa agg] training data poison_ratio: 0.0  data num: [1574, 781, 1131, 636, 1003, 85, 197, 682, 440, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [17, 3, 87, 52, 86, 61, 79, 80, 49, 59], weight: tensor([0.2066, 0.1025, 0.1485, 0.0835, 0.1317, 0.0112, 0.0259, 0.0895, 0.0578,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 47.2558708190918, obj_val: 48.41293716430664, abs dis: 1.1570663452148438
[rfa agg] iter: 0, weight: tensor([0.0623, 0.2886, 0.1211, 0.0683, 0.2079, 0.0031, 0.0086, 0.0973, 0.0274,
        0.1154])
[rfa agg] iter:  1, prev_obj_val: 48.41293716430664, obj_val: 51.6097412109375, abs dis: 3.1968040466308594
[rfa agg] iter: 1, weight: tensor([0.0514, 0.4154, 0.0933, 0.0672, 0.1473, 0.0028, 0.0078, 0.1002, 0.0255,
        0.0890])
[rfa agg] iter:  2, prev_obj_val: 51.6097412109375, obj_val: 53.65020751953125, abs dis: 2.04046630859375
[rfa agg] iter: 2, weight: tensor([0.0449, 0.4331, 0.0727, 0.0875, 0.1009, 0.0029, 0.0083, 0.1516, 0.0285,
        0.0696])
[rfa agg] iter:  3, prev_obj_val: 53.65020751953125, obj_val: 55.750755310058594, abs dis: 2.1005477905273438
[rfa agg] iter: 3, weight: tensor([0.0487, 0.2938, 0.0753, 0.1209, 0.0998, 0.0034, 0.0099, 0.2408, 0.0353,
        0.0720])
[rfa agg] iter:  4, prev_obj_val: 55.750755310058594, obj_val: 58.0237922668457, abs dis: 2.2730369567871094
[rfa agg] iter: 4, weight: tensor([0.0436, 0.1858, 0.0647, 0.1450, 0.0826, 0.0033, 0.0098, 0.3667, 0.0365,
        0.0619])
[rfa agg] iter:  5, prev_obj_val: 58.0237922668457, obj_val: 63.827239990234375, abs dis: 5.803447723388672
[rfa agg] iter: 5, weight: tensor([0.0334, 0.1120, 0.0478, 0.1580, 0.0592, 0.0028, 0.0084, 0.5002, 0.0326,
        0.0458])
[rfa agg] iter:  6, prev_obj_val: 63.827239990234375, obj_val: 63.73570251464844, abs dis: 0.0915374755859375
[rfa agg] iter: 6, weight: tensor([0.0406, 0.0988, 0.0545, 0.3652, 0.0643, 0.0041, 0.0127, 0.2513, 0.0562,
        0.0523])
[rfa agg] iter:  7, prev_obj_val: 63.73570251464844, obj_val: 67.09182739257812, abs dis: 3.3561248779296875
[rfa agg] iter: 7, weight: tensor([0.0359, 0.0872, 0.0481, 0.4540, 0.0569, 0.0036, 0.0112, 0.2070, 0.0498,
        0.0462])
[rfa agg] iter:  8, prev_obj_val: 67.09182739257812, obj_val: 60.76167297363281, abs dis: 6.3301544189453125
[rfa agg] iter: 8, weight: tensor([0.0429, 0.0928, 0.0561, 0.4162, 0.0650, 0.0048, 0.0151, 0.1797, 0.0735,
        0.0538])
[rfa agg] iter:  9, prev_obj_val: 60.76167297363281, obj_val: 70.62705993652344, abs dis: 9.865386962890625
[rfa agg] iter: 9, weight: tensor([0.0373, 0.1040, 0.0516, 0.3316, 0.0623, 0.0034, 0.0104, 0.3070, 0.0430,
        0.0495])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3476, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5221, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.983952999115 sec.
Server Epoch:27 choose agents : [95, 46, 85, 8, 54, 90, 27, 15, 74, 44].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0656, Accuracy: 207/599 (34.5576%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0255, Accuracy: 313/599 (52.2538%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0260, Accuracy: 338/599 (56.4274%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0256, Accuracy: 394/599 (65.7763%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0223, Accuracy: 404/599 (67.4457%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0217, Accuracy: 411/599 (68.6144%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0225, Accuracy: 417/599 (69.6160%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0207, Accuracy: 444/599 (74.1235%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0216, Accuracy: 434/599 (72.4541%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0215, Accuracy: 431/599 (71.9533%), train_poison_data_count: 200
Global model norm: 112.02611564245856.
Norm before scaling: 112.01849212574234. Distance: 0.7898532191462635
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.4833, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6510, Accuracy: 6605/9950 (66.3819%)
Scaling by  100
Scaled Norm after poisoning: 136.21780726331266, distance: 78.98532547647696
Total norm for 3 adversaries is: 136.21780726331266. distance: 78.98532547647696
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   1, Avg loss: 0.0541, Accuracy: 425/1904 (22.3214%)
_Train Local_ResNet_18, epoch  27, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 697/1904 (36.6071%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.6639, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 436/1988 (21.9316%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 695/1988 (34.9598%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1101, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0579, Accuracy: 314/1513 (20.7535%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 497/1513 (32.8486%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7436, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0530, Accuracy: 352/1130 (31.1504%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.4432, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   1, Avg loss: 0.0512, Accuracy: 352/677 (51.9941%)
_Train Local_ResNet_18, epoch  27, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.3265, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 425/1587 (26.7801%)
_Train Local_ResNet_18, epoch  27, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 605/1587 (38.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9323, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0539, Accuracy: 357/1154 (30.9359%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 496/1154 (42.9809%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.1467, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   1, Avg loss: 0.0422, Accuracy: 540/1552 (34.7938%)
_Train Local_ResNet_18, epoch  27, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 802/1552 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.5816, Accuracy: 100/10000 (1.0000%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0586, Accuracy: 393/1750 (22.4571%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0341, Accuracy: 708/1750 (40.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6854, Accuracy: 107/10000 (1.0700%)
time spent on training: 312.8617389202118
[rfa agg] training data poison_ratio: 0.2815793272701025  data num: [599, 1904, 1988, 1513, 1130, 677, 1587, 1154, 1552, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.08799353977190702
[rfa agg] init. name: [95, 46, 85, 8, 54, 90, 27, 15, 74, 44], weight: tensor([0.0432, 0.1374, 0.1435, 0.1092, 0.0816, 0.0489, 0.1146, 0.0833, 0.1120,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 3667.248046875, obj_val: 1985.157958984375, abs dis: 1682.090087890625
[rfa agg] iter: 0, weight: tensor([0.0020, 0.1466, 0.1545, 0.1132, 0.0822, 0.0478, 0.1193, 0.0844, 0.1167,
        0.1334])
[rfa agg] iter:  1, prev_obj_val: 1985.157958984375, obj_val: 1962.9517822265625, abs dis: 22.2061767578125
[rfa agg] iter: 1, weight: tensor([3.4014e-05, 2.0187e-01, 4.6889e-01, 4.9797e-02, 2.1942e-02, 8.8801e-03,
        5.9274e-02, 2.4046e-02, 5.7928e-02, 1.0734e-01])
[rfa agg] iter:  2, prev_obj_val: 1962.9517822265625, obj_val: 1961.8223876953125, abs dis: 1.12939453125
[rfa agg] iter: 2, weight: tensor([2.7829e-05, 1.3914e-01, 9.1008e-02, 1.0688e-01, 2.8820e-02, 9.7648e-03,
        1.6322e-01, 3.3004e-02, 1.6023e-01, 2.6790e-01])
[rfa agg] iter:  3, prev_obj_val: 1961.8223876953125, obj_val: 1969.005859375, abs dis: 7.1834716796875
[rfa agg] iter: 3, weight: tensor([2.1257e-05, 7.3140e-02, 5.3154e-02, 1.4377e-01, 2.6380e-02, 8.2347e-03,
        2.8884e-01, 3.0917e-02, 2.5767e-01, 1.1787e-01])
[rfa agg] iter:  4, prev_obj_val: 1969.005859375, obj_val: 1971.352294921875, abs dis: 2.346435546875
[rfa agg] iter: 4, weight: tensor([3.1006e-05, 6.9382e-02, 5.6441e-02, 2.6680e-01, 5.7088e-02, 1.4514e-02,
        1.9164e-01, 7.1608e-02, 1.8389e-01, 8.8607e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3480, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5322, Accuracy: 0/9950 (0.0000%)
saving model
Done in 472.2540419101715 sec.
Server Epoch:28 choose agents : [46, 17, 59, 22, 99, 72, 52, 98, 91, 82].
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   1, Avg loss: 0.0540, Accuracy: 428/1904 (22.4790%)
_Train Local_ResNet_18, epoch  28, local model 46, internal_epoch   2, Avg loss: 0.0305, Accuracy: 713/1904 (37.4475%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3431, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0495, Accuracy: 454/1574 (28.8437%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0263, Accuracy: 717/1574 (45.5527%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0907, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   1, Avg loss: 0.0506, Accuracy: 327/1089 (30.0275%)
_Train Local_ResNet_18, epoch  28, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 475/1089 (43.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0968, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 539/1470 (36.6667%)
_Train Local_ResNet_18, epoch  28, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 845/1470 (57.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.9808, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   1, Avg loss: 0.0594, Accuracy: 235/773 (30.4010%)
_Train Local_ResNet_18, epoch  28, local model 99, internal_epoch   2, Avg loss: 0.0287, Accuracy: 442/773 (57.1798%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0404, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   1, Avg loss: 0.0607, Accuracy: 270/1241 (21.7566%)
_Train Local_ResNet_18, epoch  28, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9515, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   1, Avg loss: 0.0539, Accuracy: 305/636 (47.9560%)
_Train Local_ResNet_18, epoch  28, local model 52, internal_epoch   2, Avg loss: 0.0287, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0802, Accuracy: 46/373 (12.3324%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.1841, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0478, Accuracy: 380/1030 (36.8932%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0237, Accuracy: 649/1030 (63.0097%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.3181, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0730, Accuracy: 102/500 (20.4000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 192/500 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.7539, Accuracy: 64/10000 (0.6400%)
time spent on training: 172.29686784744263
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 1574, 1089, 1470, 773, 1241, 636, 373, 1030, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 17, 59, 22, 99, 72, 52, 98, 91, 82], weight: tensor([0.1798, 0.1486, 0.1028, 0.1388, 0.0730, 0.1172, 0.0601, 0.0352, 0.0973,
        0.0472])
[rfa agg] iter:  0, prev_obj_val: 56.50969696044922, obj_val: 60.306427001953125, abs dis: 3.7967300415039062
[rfa agg] iter: 0, weight: tensor([0.0454, 0.0624, 0.3040, 0.0789, 0.0507, 0.1409, 0.0253, 0.0097, 0.2670,
        0.0157])
[rfa agg] iter:  1, prev_obj_val: 60.306427001953125, obj_val: 65.06336212158203, abs dis: 4.756935119628906
[rfa agg] iter: 1, weight: tensor([0.0477, 0.0625, 0.2186, 0.0758, 0.0728, 0.1167, 0.0329, 0.0120, 0.3411,
        0.0199])
[rfa agg] iter:  2, prev_obj_val: 65.06336212158203, obj_val: 65.0525131225586, abs dis: 0.0108489990234375
[rfa agg] iter: 2, weight: tensor([0.0571, 0.0720, 0.1790, 0.0847, 0.1279, 0.1179, 0.0499, 0.0171, 0.2654,
        0.0290])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3492, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5449, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.0054495334625 sec.
Server Epoch:29 choose agents : [10, 7, 89, 13, 63, 58, 93, 74, 67, 70].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0632, Accuracy: 176/861 (20.4413%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0274, Accuracy: 321/861 (37.2822%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0226, Accuracy: 414/861 (48.0836%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0216, Accuracy: 414/861 (48.0836%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0212, Accuracy: 415/861 (48.1998%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0213, Accuracy: 432/861 (50.1742%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0208, Accuracy: 431/861 (50.0581%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0203, Accuracy: 446/861 (51.8002%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0198, Accuracy: 468/861 (54.3554%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0200, Accuracy: 455/861 (52.8455%), train_poison_data_count: 280
Global model norm: 112.02246740330709.
Norm before scaling: 112.01238945145755. Distance: 1.039047413193016
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.1267, Accuracy: 108/10000 (1.0800%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.9187, Accuracy: 8856/9950 (89.0050%)
Scaling by  100
Scaled Norm after poisoning: 151.6957790282907, distance: 103.90474622971993
Total norm for 2 adversaries is: 151.6957790282907. distance: 103.90474622971993
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0508, Accuracy: 372/891 (41.7508%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0246, Accuracy: 471/891 (52.8620%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5861, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 356/896 (39.7321%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 419/896 (46.7634%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.8770, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   1, Avg loss: 0.0559, Accuracy: 378/1645 (22.9787%)
_Train Local_ResNet_18, epoch  29, local model 13, internal_epoch   2, Avg loss: 0.0316, Accuracy: 677/1645 (41.1550%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5296, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 267/888 (30.0676%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.8673, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.6644, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 440/1742 (25.2583%)
_Train Local_ResNet_18, epoch  29, local model 93, internal_epoch   2, Avg loss: 0.0310, Accuracy: 752/1742 (43.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9807, Accuracy: 92/10000 (0.9200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0409, Accuracy: 517/1552 (33.3119%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 822/1552 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.9061, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   1, Avg loss: 0.0735, Accuracy: 75/426 (17.6056%)
_Train Local_ResNet_18, epoch  29, local model 67, internal_epoch   2, Avg loss: 0.0391, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5624, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 415/1418 (29.2666%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1234, Accuracy: 108/10000 (1.0800%)
time spent on training: 282.3010895252228
[rfa agg] training data poison_ratio: 0.21695738176586946  data num: [861, 891, 896, 1645, 888, 803, 1742, 1552, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06779918180183421
[rfa agg] init. name: [10, 7, 89, 13, 63, 58, 93, 74, 67, 70], weight: tensor([0.0774, 0.0801, 0.0806, 0.1479, 0.0798, 0.0722, 0.1566, 0.1395, 0.0383,
        0.1275])
[rfa agg] iter:  0, prev_obj_val: 8893.9921875, obj_val: 5182.001953125, abs dis: 3711.990234375
[rfa agg] iter: 0, weight: tensor([0.0069, 0.0851, 0.0856, 0.1607, 0.0848, 0.0766, 0.1708, 0.1514, 0.0402,
        0.1378])
[rfa agg] iter:  1, prev_obj_val: 5182.001953125, obj_val: 4877.205078125, abs dis: 304.796875
[rfa agg] iter: 1, weight: tensor([0.0005, 0.0742, 0.0746, 0.1771, 0.0740, 0.0657, 0.1972, 0.1631, 0.0313,
        0.1423])
[rfa agg] iter:  2, prev_obj_val: 4877.205078125, obj_val: 4879.7587890625, abs dis: 2.5537109375
[rfa agg] iter: 2, weight: tensor([3.3128e-05, 2.3833e-02, 2.3966e-02, 1.9837e-01, 2.3749e-02, 1.9553e-02,
        1.1408e-01, 3.0480e-01, 6.7236e-03, 2.8489e-01])
[rfa agg] iter:  3, prev_obj_val: 4879.7587890625, obj_val: 4882.20849609375, abs dis: 2.44970703125
[rfa agg] iter: 3, weight: tensor([4.4881e-05, 4.0229e-02, 4.0480e-02, 1.4514e-01, 4.0070e-02, 3.2313e-02,
        1.0406e-01, 1.8198e-01, 1.0322e-02, 4.0536e-01])
[rfa agg] iter:  4, prev_obj_val: 4882.20849609375, obj_val: 4886.09423828125, abs dis: 3.8857421875
[rfa agg] iter: 4, weight: tensor([5.7870e-05, 5.9202e-02, 5.9569e-02, 1.5094e-01, 5.8982e-02, 4.6840e-02,
        1.1543e-01, 1.7730e-01, 1.4261e-02, 3.1743e-01])
[rfa agg] iter:  5, prev_obj_val: 4886.09423828125, obj_val: 4888.7275390625, abs dis: 2.63330078125
[rfa agg] iter: 5, weight: tensor([6.9835e-05, 9.0585e-02, 9.1158e-02, 1.4151e-01, 9.0222e-02, 6.9455e-02,
        1.1522e-01, 1.5761e-01, 1.9278e-02, 2.2489e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3497, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 454.7308795452118 sec.
Server Epoch:30 choose agents : [65, 62, 75, 52, 98, 71, 47, 25, 1, 15].
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 420/1475 (28.4746%)
_Train Local_ResNet_18, epoch  30, local model 65, internal_epoch   2, Avg loss: 0.0292, Accuracy: 713/1475 (48.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8318, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   1, Avg loss: 0.0704, Accuracy: 142/568 (25.0000%)
_Train Local_ResNet_18, epoch  30, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6125, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   1, Avg loss: 0.0626, Accuracy: 274/776 (35.3093%)
_Train Local_ResNet_18, epoch  30, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4840, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0535, Accuracy: 306/636 (48.1132%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0287, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3824, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 44/373 (11.7962%)
_Train Local_ResNet_18, epoch  30, local model 98, internal_epoch   2, Avg loss: 0.0472, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.2820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 175/818 (21.3936%)
_Train Local_ResNet_18, epoch  30, local model 71, internal_epoch   2, Avg loss: 0.0297, Accuracy: 379/818 (46.3325%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3493, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  30, local model 47, internal_epoch   2, Avg loss: 0.1052, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3735, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   1, Avg loss: 0.0510, Accuracy: 349/690 (50.5797%)
_Train Local_ResNet_18, epoch  30, local model 25, internal_epoch   2, Avg loss: 0.0258, Accuracy: 467/690 (67.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.5445, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0549, Accuracy: 303/928 (32.6509%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0227, Accuracy: 620/928 (66.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.1840, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0536, Accuracy: 358/1154 (31.0225%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0264, Accuracy: 541/1154 (46.8804%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.8419, Accuracy: 65/10000 (0.6500%)
time spent on training: 148.57991862297058
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 568, 776, 636, 373, 818, 134, 690, 928, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 62, 75, 52, 98, 71, 47, 25, 1, 15], weight: tensor([0.1953, 0.0752, 0.1028, 0.0842, 0.0494, 0.1083, 0.0177, 0.0914, 0.1229,
        0.1528])
[rfa agg] iter:  0, prev_obj_val: 43.51233673095703, obj_val: 53.289710998535156, abs dis: 9.777374267578125
[rfa agg] iter: 0, weight: tensor([0.0357, 0.0447, 0.2662, 0.0686, 0.0160, 0.2974, 0.0039, 0.1188, 0.0993,
        0.0493])
[rfa agg] iter:  1, prev_obj_val: 53.289710998535156, obj_val: 56.14594650268555, abs dis: 2.8562355041503906
[rfa agg] iter: 1, weight: tensor([0.0335, 0.1573, 0.0812, 0.3183, 0.0296, 0.0860, 0.0061, 0.1886, 0.0586,
        0.0408])
[rfa agg] iter:  2, prev_obj_val: 56.14594650268555, obj_val: 59.42384338378906, abs dis: 3.2778968811035156
[rfa agg] iter: 2, weight: tensor([0.0324, 0.2520, 0.0695, 0.3010, 0.0338, 0.0737, 0.0066, 0.1389, 0.0534,
        0.0387])
[rfa agg] iter:  3, prev_obj_val: 59.42384338378906, obj_val: 63.03717803955078, abs dis: 3.6133346557617188
[rfa agg] iter: 3, weight: tensor([0.0322, 0.4044, 0.0628, 0.1889, 0.0405, 0.0665, 0.0073, 0.1093, 0.0503,
        0.0378])
[rfa agg] iter:  4, prev_obj_val: 63.03717803955078, obj_val: 66.83037567138672, abs dis: 3.7931976318359375
[rfa agg] iter: 4, weight: tensor([0.0386, 0.3761, 0.0693, 0.1614, 0.0599, 0.0733, 0.0099, 0.1094, 0.0576,
        0.0446])
[rfa agg] iter:  5, prev_obj_val: 66.83037567138672, obj_val: 50.62220764160156, abs dis: 16.208168029785156
[rfa agg] iter: 5, weight: tensor([0.0479, 0.2778, 0.0802, 0.1592, 0.0954, 0.0846, 0.0139, 0.1177, 0.0686,
        0.0545])
[rfa agg] iter:  6, prev_obj_val: 50.62220764160156, obj_val: 56.162200927734375, abs dis: 5.5399932861328125
[rfa agg] iter: 6, weight: tensor([0.0329, 0.1103, 0.0908, 0.2557, 0.0250, 0.0964, 0.0054, 0.2812, 0.0614,
        0.0409])
[rfa agg] iter:  7, prev_obj_val: 56.162200927734375, obj_val: 63.05158996582031, abs dis: 6.8893890380859375
[rfa agg] iter: 7, weight: tensor([0.0329, 0.2505, 0.0707, 0.2932, 0.0344, 0.0750, 0.0067, 0.1430, 0.0543,
        0.0393])
[rfa agg] iter:  8, prev_obj_val: 63.05158996582031, obj_val: 66.82893371582031, abs dis: 3.77734375
[rfa agg] iter: 8, weight: tensor([0.0399, 0.3514, 0.0717, 0.1699, 0.0620, 0.0758, 0.0102, 0.1134, 0.0596,
        0.0461])
[rfa agg] iter:  9, prev_obj_val: 66.82893371582031, obj_val: 53.200897216796875, abs dis: 13.628036499023438
[rfa agg] iter: 9, weight: tensor([0.0480, 0.2768, 0.0802, 0.1596, 0.0956, 0.0847, 0.0139, 0.1179, 0.0687,
        0.0546])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3507, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5562, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.2521529197693 sec.
Server Epoch:31 choose agents : [30, 71, 96, 55, 75, 32, 34, 20, 1, 65].
poison local model 30 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0786, Accuracy: 51/486 (10.4938%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 180/486 (37.0370%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   3, Avg loss: 0.0350, Accuracy: 164/486 (33.7449%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   4, Avg loss: 0.0354, Accuracy: 177/486 (36.4198%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   5, Avg loss: 0.0325, Accuracy: 185/486 (38.0658%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   6, Avg loss: 0.0318, Accuracy: 193/486 (39.7119%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   7, Avg loss: 0.0319, Accuracy: 194/486 (39.9177%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   8, Avg loss: 0.0312, Accuracy: 220/486 (45.2675%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch   9, Avg loss: 0.0312, Accuracy: 213/486 (43.8272%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 30, internal_epoch  10, Avg loss: 0.0315, Accuracy: 213/486 (43.8272%), train_poison_data_count: 160
Global model norm: 112.01994364146725.
Norm before scaling: 112.01473030225758. Distance: 0.6897700934654755
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.4924, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.9751, Accuracy: 7330/9950 (73.6683%)
Scaling by  100
Scaled Norm after poisoning: 130.92726690323144, distance: 68.97701156907277
Total norm for 3 adversaries is: 130.92726690323144. distance: 68.97701156907277
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   1, Avg loss: 0.0617, Accuracy: 201/818 (24.5721%)
_Train Local_ResNet_18, epoch  31, local model 71, internal_epoch   2, Avg loss: 0.0294, Accuracy: 393/818 (48.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4667, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0800, Accuracy: 39/311 (12.5402%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.9437, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 262/1071 (24.4631%)
_Train Local_ResNet_18, epoch  31, local model 55, internal_epoch   2, Avg loss: 0.0285, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9672, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   1, Avg loss: 0.0617, Accuracy: 272/776 (35.0515%)
_Train Local_ResNet_18, epoch  31, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 433/776 (55.7990%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9368, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 207/735 (28.1633%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 349/735 (47.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.2252, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   1, Avg loss: 0.0558, Accuracy: 413/1427 (28.9418%)
_Train Local_ResNet_18, epoch  31, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 606/1427 (42.4667%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0200, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   1, Avg loss: 0.0545, Accuracy: 353/807 (43.7423%)
_Train Local_ResNet_18, epoch  31, local model 20, internal_epoch   2, Avg loss: 0.0300, Accuracy: 445/807 (55.1425%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5799, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0545, Accuracy: 319/928 (34.3750%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 611/928 (65.8405%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.2387, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 402/1475 (27.2542%)
_Train Local_ResNet_18, epoch  31, local model 65, internal_epoch   2, Avg loss: 0.0299, Accuracy: 723/1475 (49.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9525, Accuracy: 84/10000 (0.8400%)
time spent on training: 277.2187674045563
[rfa agg] training data poison_ratio: 0.26760244509848313  data num: [486, 818, 311, 1071, 776, 735, 1427, 807, 928, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.08362576409327598
[rfa agg] init. name: [30, 71, 96, 55, 75, 32, 34, 20, 1, 65], weight: tensor([0.0550, 0.0926, 0.0352, 0.1212, 0.0878, 0.0832, 0.1615, 0.0914, 0.1050,
        0.1670])
[rfa agg] iter:  0, prev_obj_val: 3691.863037109375, obj_val: 2052.14892578125, abs dis: 1639.714111328125
[rfa agg] iter: 0, weight: tensor([0.0033, 0.0958, 0.0352, 0.1278, 0.0909, 0.0857, 0.1751, 0.0946, 0.1097,
        0.1818])
[rfa agg] iter:  1, prev_obj_val: 2052.14892578125, obj_val: 2003.3443603515625, abs dis: 48.8045654296875
[rfa agg] iter: 1, weight: tensor([1.2882e-04, 5.5510e-02, 1.3929e-02, 9.7770e-02, 5.2661e-02, 4.6854e-02,
        2.6981e-01, 5.4737e-02, 7.2230e-02, 3.3637e-01])
[rfa agg] iter:  2, prev_obj_val: 2003.3443603515625, obj_val: 2000.0452880859375, abs dis: 3.299072265625
[rfa agg] iter: 2, weight: tensor([6.5107e-05, 7.2125e-02, 1.1835e-02, 2.5841e-01, 6.8521e-02, 5.5625e-02,
        1.8652e-01, 7.0927e-02, 1.2080e-01, 1.5518e-01])
[rfa agg] iter:  3, prev_obj_val: 2000.0452880859375, obj_val: 2004.7144775390625, abs dis: 4.669189453125
[rfa agg] iter: 3, weight: tensor([3.5782e-05, 1.1413e-01, 9.1125e-03, 1.4798e-01, 1.0802e-01, 6.9813e-02,
        5.2057e-02, 1.0975e-01, 3.4134e-01, 4.7761e-02])
[rfa agg] iter:  4, prev_obj_val: 2004.7144775390625, obj_val: 2014.363037109375, abs dis: 9.6485595703125
[rfa agg] iter: 4, weight: tensor([2.3451e-05, 2.5857e-01, 7.4649e-03, 5.0492e-02, 2.2215e-01, 1.1367e-01,
        2.7326e-02, 2.0872e-01, 8.5927e-02, 2.5655e-02])
[rfa agg] iter:  5, prev_obj_val: 2014.363037109375, obj_val: 2010.5567626953125, abs dis: 3.8062744140625
[rfa agg] iter: 5, weight: tensor([3.9078e-05, 1.6554e-01, 1.5307e-02, 6.1727e-02, 1.5418e-01, 2.8546e-01,
        3.9665e-02, 1.5730e-01, 8.3101e-02, 3.7676e-02])
[rfa agg] iter:  6, prev_obj_val: 2010.5567626953125, obj_val: 2010.55322265625, abs dis: 0.0035400390625
[rfa agg] iter: 6, weight: tensor([2.8820e-05, 1.6866e-01, 1.0491e-02, 4.9963e-02, 1.5466e-01, 3.3015e-01,
        3.0569e-02, 1.5580e-01, 7.0743e-02, 2.8932e-02])
[rfa agg] iter:  7, prev_obj_val: 2010.55322265625, obj_val: 2014.3282470703125, abs dis: 3.7750244140625
[rfa agg] iter: 7, weight: tensor([2.8267e-05, 1.6508e-01, 1.0289e-02, 4.8983e-02, 1.5093e-01, 3.4472e-01,
        2.9979e-02, 1.5233e-01, 6.9277e-02, 2.8373e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3517, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3220, Accuracy: 0/9950 (0.0000%)
saving model
Done in 448.9374554157257 sec.
Server Epoch:32 choose agents : [65, 23, 30, 72, 95, 33, 28, 49, 21, 55].
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   1, Avg loss: 0.0533, Accuracy: 433/1475 (29.3559%)
_Train Local_ResNet_18, epoch  32, local model 65, internal_epoch   2, Avg loss: 0.0296, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.9039, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0374, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2226, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   1, Avg loss: 0.0737, Accuracy: 108/486 (22.2222%)
_Train Local_ResNet_18, epoch  32, local model 30, internal_epoch   2, Avg loss: 0.0380, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5252, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 282/1241 (22.7236%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0358, Accuracy: 445/1241 (35.8582%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9959, Accuracy: 62/10000 (0.6200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.5664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 85/515 (16.5049%)
_Train Local_ResNet_18, epoch  32, local model 33, internal_epoch   2, Avg loss: 0.0486, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.6930, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch  32, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 627/1581 (39.6584%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9815, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0776, Accuracy: 54/440 (12.2727%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.4406, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   1, Avg loss: 0.0529, Accuracy: 414/1949 (21.2417%)
_Train Local_ResNet_18, epoch  32, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 646/1949 (33.1452%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.7522, Accuracy: 84/10000 (0.8400%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 266/1071 (24.8366%)
_Train Local_ResNet_18, epoch  32, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 512/1071 (47.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.0008, Accuracy: 78/10000 (0.7800%)
time spent on training: 203.63717913627625
[rfa agg] training data poison_ratio: 0.21405877680698968  data num: [1475, 715, 486, 1241, 599, 515, 1581, 440, 1949, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.06689336775218427
[rfa agg] init. name: [65, 23, 30, 72, 95, 33, 28, 49, 21, 55], weight: tensor([0.1464, 0.0710, 0.0483, 0.1232, 0.0595, 0.0511, 0.1570, 0.0437, 0.1935,
        0.1063])
[rfa agg] iter:  0, prev_obj_val: 67.52412414550781, obj_val: 72.8907241821289, abs dis: 5.366600036621094
[rfa agg] iter: 0, weight: tensor([0.0825, 0.0560, 0.0214, 0.1601, 0.0337, 0.0254, 0.0779, 0.0174, 0.0551,
        0.4705])
[rfa agg] iter:  1, prev_obj_val: 72.8907241821289, obj_val: 72.88040161132812, abs dis: 0.01032257080078125
[rfa agg] iter: 1, weight: tensor([0.0898, 0.1044, 0.0338, 0.1425, 0.0565, 0.0412, 0.0867, 0.0270, 0.0657,
        0.3525])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3519, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 358.607794046402 sec.
Server Epoch:33 choose agents : [44, 90, 9, 28, 97, 86, 63, 52, 14, 85].
poison local model 44 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0569, Accuracy: 449/1750 (25.6571%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0337, Accuracy: 679/1750 (38.8000%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   3, Avg loss: 0.0300, Accuracy: 775/1750 (44.2857%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   4, Avg loss: 0.0283, Accuracy: 872/1750 (49.8286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   5, Avg loss: 0.0272, Accuracy: 929/1750 (53.0857%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   6, Avg loss: 0.0265, Accuracy: 935/1750 (53.4286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   7, Avg loss: 0.0262, Accuracy: 959/1750 (54.8000%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   8, Avg loss: 0.0256, Accuracy: 989/1750 (56.5143%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch   9, Avg loss: 0.0250, Accuracy: 994/1750 (56.8000%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 44, internal_epoch  10, Avg loss: 0.0253, Accuracy: 983/1750 (56.1714%), train_poison_data_count: 560
Global model norm: 112.01741546379071.
Norm before scaling: 111.98862944513608. Distance: 1.2343946527775658
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3569, Accuracy: 117/10000 (1.1700%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.4072, Accuracy: 9751/9950 (98.0000%)
Scaling by  100
Scaled Norm after poisoning: 164.28105086063638, distance: 123.43946596535689
Total norm for 1 adversaries is: 164.28105086063638. distance: 123.43946596535689
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   1, Avg loss: 0.0515, Accuracy: 344/677 (50.8124%)
_Train Local_ResNet_18, epoch  33, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.7099, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   1, Avg loss: 0.0477, Accuracy: 376/1275 (29.4902%)
_Train Local_ResNet_18, epoch  33, local model 9, internal_epoch   2, Avg loss: 0.0186, Accuracy: 709/1275 (55.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.1270, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   1, Avg loss: 0.0548, Accuracy: 412/1581 (26.0595%)
_Train Local_ResNet_18, epoch  33, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 634/1581 (40.1012%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8344, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  33, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 537/1213 (44.2704%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.9886, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   1, Avg loss: 0.0583, Accuracy: 378/1003 (37.6869%)
_Train Local_ResNet_18, epoch  33, local model 86, internal_epoch   2, Avg loss: 0.0325, Accuracy: 406/1003 (40.4786%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   1, Avg loss: 0.0529, Accuracy: 277/888 (31.1937%)
_Train Local_ResNet_18, epoch  33, local model 63, internal_epoch   2, Avg loss: 0.0247, Accuracy: 463/888 (52.1396%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.6786, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   1, Avg loss: 0.0515, Accuracy: 329/636 (51.7296%)
_Train Local_ResNet_18, epoch  33, local model 52, internal_epoch   2, Avg loss: 0.0294, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8549, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0607, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0342, Accuracy: 348/1013 (34.3534%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1919, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 440/1988 (22.1328%)
_Train Local_ResNet_18, epoch  33, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 690/1988 (34.7082%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.1384, Accuracy: 85/10000 (0.8500%)
time spent on training: 309.8401186466217
[rfa agg] training data poison_ratio: 0.145542248835662  data num: [1750, 677, 1275, 1581, 1213, 1003, 888, 636, 1013, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.045481952761144376
[rfa agg] init. name: [44, 90, 9, 28, 97, 86, 63, 52, 14, 85], weight: tensor([0.1455, 0.0563, 0.1060, 0.1315, 0.1009, 0.0834, 0.0739, 0.0529, 0.0842,
        0.1653])
[rfa agg] iter:  0, prev_obj_val: 31087.337890625, obj_val: 20684.90625, abs dis: 10402.431640625
[rfa agg] iter: 0, weight: tensor([0.0282, 0.0637, 0.1206, 0.1499, 0.1147, 0.0947, 0.0837, 0.0599, 0.0956,
        0.1891])
[rfa agg] iter:  1, prev_obj_val: 20684.90625, obj_val: 18617.767578125, abs dis: 2067.138671875
[rfa agg] iter: 1, weight: tensor([0.0049, 0.0640, 0.1233, 0.1549, 0.1170, 0.0960, 0.0846, 0.0600, 0.0970,
        0.1983])
[rfa agg] iter:  2, prev_obj_val: 18617.767578125, obj_val: 18265.8515625, abs dis: 351.916015625
[rfa agg] iter: 2, weight: tensor([0.0008, 0.0569, 0.1217, 0.1631, 0.1140, 0.0903, 0.0777, 0.0528, 0.0912,
        0.2315])
[rfa agg] iter:  3, prev_obj_val: 18265.8515625, obj_val: 18249.892578125, abs dis: 15.958984375
[rfa agg] iter: 3, weight: tensor([7.2854e-05, 2.0714e-02, 7.3921e-02, 1.8161e-01, 6.3954e-02, 4.1589e-02,
        3.2248e-02, 1.8484e-02, 4.2030e-02, 5.2538e-01])
[rfa agg] iter:  4, prev_obj_val: 18249.892578125, obj_val: 18245.529296875, abs dis: 4.36328125
[rfa agg] iter: 4, weight: tensor([4.4572e-05, 1.7185e-02, 8.9020e-02, 5.9903e-01, 7.0990e-02, 3.9418e-02,
        2.8642e-02, 1.5067e-02, 3.9858e-02, 1.0075e-01])
[rfa agg] iter:  5, prev_obj_val: 18245.529296875, obj_val: 18245.37109375, abs dis: 0.158203125
[rfa agg] iter: 5, weight: tensor([5.1667e-05, 2.6543e-02, 3.0318e-01, 1.8536e-01, 1.8665e-01, 7.4081e-02,
        4.8578e-02, 2.2769e-02, 7.5125e-02, 7.7659e-02])
[rfa agg] iter:  6, prev_obj_val: 18245.37109375, obj_val: 18250.326171875, abs dis: 4.955078125
[rfa agg] iter: 6, weight: tensor([3.0865e-05, 2.0812e-02, 2.6736e-01, 6.4474e-02, 3.8908e-01, 7.8933e-02,
        4.3376e-02, 1.7378e-02, 8.0985e-02, 3.7570e-02])
[rfa agg] iter:  7, prev_obj_val: 18250.326171875, obj_val: 18258.53515625, abs dis: 8.208984375
[rfa agg] iter: 7, weight: tensor([3.7131e-05, 3.3324e-02, 1.2281e-01, 5.8273e-02, 1.7290e-01, 2.1644e-01,
        8.5289e-02, 2.6825e-02, 2.4490e-01, 3.9202e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3543, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3277, Accuracy: 0/9950 (0.0000%)
saving model
Done in 472.1059970855713 sec.
Server Epoch:34 choose agents : [75, 51, 83, 60, 39, 88, 49, 64, 59, 13].
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   1, Avg loss: 0.0611, Accuracy: 287/776 (36.9845%)
_Train Local_ResNet_18, epoch  34, local model 75, internal_epoch   2, Avg loss: 0.0276, Accuracy: 396/776 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0818, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   1, Avg loss: 0.0586, Accuracy: 252/1049 (24.0229%)
_Train Local_ResNet_18, epoch  34, local model 51, internal_epoch   2, Avg loss: 0.0287, Accuracy: 534/1049 (50.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0925, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 441/1953 (22.5806%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 805/1953 (41.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7822, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 649/2227 (29.1423%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1065/2227 (47.8222%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1364, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   1, Avg loss: 0.0501, Accuracy: 326/1013 (32.1816%)
_Train Local_ResNet_18, epoch  34, local model 39, internal_epoch   2, Avg loss: 0.0252, Accuracy: 520/1013 (51.3327%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7907, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   1, Avg loss: 0.0711, Accuracy: 159/603 (26.3682%)
_Train Local_ResNet_18, epoch  34, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9785, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0778, Accuracy: 52/440 (11.8182%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0461, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.3073, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 209/953 (21.9307%)
_Train Local_ResNet_18, epoch  34, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 337/953 (35.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3431, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   1, Avg loss: 0.0506, Accuracy: 337/1089 (30.9458%)
_Train Local_ResNet_18, epoch  34, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 489/1089 (44.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.8241, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0551, Accuracy: 380/1645 (23.1003%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0310, Accuracy: 667/1645 (40.5471%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.2995, Accuracy: 116/10000 (1.1600%)
time spent on training: 182.41426968574524
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1049, 1953, 2227, 1013, 603, 440, 953, 1089, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 51, 83, 60, 39, 88, 49, 64, 59, 13], weight: tensor([0.0661, 0.0893, 0.1662, 0.1896, 0.0862, 0.0513, 0.0375, 0.0811, 0.0927,
        0.1400])
[rfa agg] iter:  0, prev_obj_val: 73.80084228515625, obj_val: 74.12956237792969, abs dis: 0.3287200927734375
[rfa agg] iter: 0, weight: tensor([0.0534, 0.1411, 0.1073, 0.0876, 0.1103, 0.0302, 0.0173, 0.0870, 0.1870,
        0.1788])
[rfa agg] iter:  1, prev_obj_val: 74.12956237792969, obj_val: 77.52214813232422, abs dis: 3.3925857543945312
[rfa agg] iter: 1, weight: tensor([0.0474, 0.2043, 0.0527, 0.0455, 0.1304, 0.0239, 0.0129, 0.0902, 0.3191,
        0.0737])
[rfa agg] iter:  2, prev_obj_val: 77.52214813232422, obj_val: 79.12874603271484, abs dis: 1.606597900390625
[rfa agg] iter: 2, weight: tensor([0.0537, 0.2581, 0.0331, 0.0296, 0.2553, 0.0227, 0.0114, 0.1391, 0.1545,
        0.0424])
[rfa agg] iter:  3, prev_obj_val: 79.12874603271484, obj_val: 89.392578125, abs dis: 10.263832092285156
[rfa agg] iter: 3, weight: tensor([0.0577, 0.1896, 0.0296, 0.0266, 0.3396, 0.0227, 0.0111, 0.1772, 0.1087,
        0.0373])
[rfa agg] iter:  4, prev_obj_val: 89.392578125, obj_val: 86.37461853027344, abs dis: 3.0179595947265625
[rfa agg] iter: 4, weight: tensor([0.2129, 0.1084, 0.0369, 0.0341, 0.1565, 0.0478, 0.0202, 0.2550, 0.0842,
        0.0440])
[rfa agg] iter:  5, prev_obj_val: 86.37461853027344, obj_val: 86.36634826660156, abs dis: 0.008270263671875
[rfa agg] iter: 5, weight: tensor([0.1352, 0.1080, 0.0324, 0.0297, 0.1663, 0.0364, 0.0160, 0.3558, 0.0810,
        0.0391])
[rfa agg] iter:  6, prev_obj_val: 86.36634826660156, obj_val: 89.34573364257812, abs dis: 2.9793853759765625
[rfa agg] iter: 6, weight: tensor([0.1312, 0.1057, 0.0317, 0.0291, 0.1629, 0.0357, 0.0157, 0.3703, 0.0793,
        0.0383])
[rfa agg] iter:  7, prev_obj_val: 89.34573364257812, obj_val: 89.33878326416016, abs dis: 0.00695037841796875
[rfa agg] iter: 7, weight: tensor([0.2151, 0.1048, 0.0360, 0.0332, 0.1489, 0.0468, 0.0197, 0.2708, 0.0820,
        0.0429])
[rfa agg] iter:  8, prev_obj_val: 89.33878326416016, obj_val: 92.39436340332031, abs dis: 3.0555801391601562
[rfa agg] iter: 8, weight: tensor([0.2201, 0.1050, 0.0360, 0.0333, 0.1491, 0.0468, 0.0197, 0.2649, 0.0821,
        0.0429])
[rfa agg] iter:  9, prev_obj_val: 92.39436340332031, obj_val: 86.39849090576172, abs dis: 5.995872497558594
[rfa agg] iter: 9, weight: tensor([0.3502, 0.0899, 0.0345, 0.0321, 0.1205, 0.0527, 0.0209, 0.1858, 0.0727,
        0.0407])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3539, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.2672, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.3689796924591 sec.
Server Epoch:35 choose agents : [55, 53, 77, 15, 26, 52, 33, 82, 60, 63].
poison local model 55 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 249/1071 (23.2493%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   2, Avg loss: 0.0306, Accuracy: 401/1071 (37.4416%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   3, Avg loss: 0.0266, Accuracy: 499/1071 (46.5920%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   4, Avg loss: 0.0258, Accuracy: 524/1071 (48.9262%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   5, Avg loss: 0.0249, Accuracy: 522/1071 (48.7395%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   6, Avg loss: 0.0245, Accuracy: 548/1071 (51.1671%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   7, Avg loss: 0.0247, Accuracy: 542/1071 (50.6069%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   8, Avg loss: 0.0244, Accuracy: 530/1071 (49.4865%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch   9, Avg loss: 0.0229, Accuracy: 598/1071 (55.8357%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 55, internal_epoch  10, Avg loss: 0.0233, Accuracy: 566/1071 (52.8478%), train_poison_data_count: 340
Global model norm: 112.01480440660511.
Norm before scaling: 111.99962942879543. Distance: 0.9901950986397624
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4283, Accuracy: 86/10000 (0.8600%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.8080, Accuracy: 9258/9950 (93.0452%)
Scaling by  100
Scaled Norm after poisoning: 148.034683699885, distance: 99.01950466795671
Total norm for 1 adversaries is: 148.034683699885. distance: 99.01950466795671
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   1, Avg loss: 0.0467, Accuracy: 328/813 (40.3444%)
_Train Local_ResNet_18, epoch  35, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 506/813 (62.2386%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 11.7846, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   1, Avg loss: 0.0487, Accuracy: 369/1340 (27.5373%)
_Train Local_ResNet_18, epoch  35, local model 77, internal_epoch   2, Avg loss: 0.0259, Accuracy: 593/1340 (44.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.4740, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   1, Avg loss: 0.0538, Accuracy: 347/1154 (30.0693%)
_Train Local_ResNet_18, epoch  35, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 542/1154 (46.9671%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.3603, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 333/1446 (23.0290%)
_Train Local_ResNet_18, epoch  35, local model 26, internal_epoch   2, Avg loss: 0.0339, Accuracy: 508/1446 (35.1314%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7946, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   1, Avg loss: 0.0521, Accuracy: 314/636 (49.3711%)
_Train Local_ResNet_18, epoch  35, local model 52, internal_epoch   2, Avg loss: 0.0279, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7091, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 85/515 (16.5049%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0505, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   1, Avg loss: 0.0736, Accuracy: 86/500 (17.2000%)
_Train Local_ResNet_18, epoch  35, local model 82, internal_epoch   2, Avg loss: 0.0469, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.0490, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 636/2227 (28.5586%)
_Train Local_ResNet_18, epoch  35, local model 60, internal_epoch   2, Avg loss: 0.0272, Accuracy: 1069/2227 (48.0018%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6529, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   1, Avg loss: 0.0517, Accuracy: 297/888 (33.4459%)
_Train Local_ResNet_18, epoch  35, local model 63, internal_epoch   2, Avg loss: 0.0249, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.5126, Accuracy: 69/10000 (0.6900%)
time spent on training: 287.56558895111084
[rfa agg] training data poison_ratio: 0.10113314447592069  data num: [1071, 813, 1340, 1154, 1446, 636, 515, 500, 2227, 888]
[rfa agg] considering poison per batch poison_fraction: 0.03160410764872521
[rfa agg] init. name: [55, 53, 77, 15, 26, 52, 33, 82, 60, 63], weight: tensor([0.1011, 0.0768, 0.1265, 0.1090, 0.1365, 0.0601, 0.0486, 0.0472, 0.2103,
        0.0839])
[rfa agg] iter:  0, prev_obj_val: 13771.734375, obj_val: 8402.2265625, abs dis: 5369.5078125
[rfa agg] iter: 0, weight: tensor([0.0125, 0.0836, 0.1390, 0.1194, 0.1504, 0.0651, 0.0527, 0.0511, 0.2349,
        0.0914])
[rfa agg] iter:  1, prev_obj_val: 8402.2265625, obj_val: 7757.56298828125, abs dis: 644.66357421875
[rfa agg] iter: 1, weight: tensor([0.0014, 0.0785, 0.1395, 0.1179, 0.1536, 0.0598, 0.0480, 0.0462, 0.2686,
        0.0866])
[rfa agg] iter:  2, prev_obj_val: 7757.56298828125, obj_val: 7737.60107421875, abs dis: 19.9619140625
[rfa agg] iter: 2, weight: tensor([1.1236e-04, 4.0106e-02, 1.1852e-01, 8.5165e-02, 1.5953e-01, 2.6893e-02,
        2.0788e-02, 1.9309e-02, 4.8320e-01, 4.6371e-02])
[rfa agg] iter:  3, prev_obj_val: 7737.60107421875, obj_val: 7729.89404296875, abs dis: 7.70703125
[rfa agg] iter: 3, weight: tensor([7.7222e-05, 4.1310e-02, 1.9783e-01, 1.1558e-01, 3.9673e-01, 2.5864e-02,
        1.9643e-02, 1.7955e-02, 1.3582e-01, 4.9189e-02])
[rfa agg] iter:  4, prev_obj_val: 7729.89404296875, obj_val: 7732.41552734375, abs dis: 2.521484375
[rfa agg] iter: 4, weight: tensor([3.9153e-05, 3.1392e-02, 4.6509e-01, 1.5911e-01, 2.1308e-01, 1.7874e-02,
        1.3276e-02, 1.1907e-02, 4.9164e-02, 3.9060e-02])
[rfa agg] iter:  5, prev_obj_val: 7732.41552734375, obj_val: 7738.12890625, abs dis: 5.71337890625
[rfa agg] iter: 5, weight: tensor([4.5538e-05, 4.8548e-02, 2.3201e-01, 4.1886e-01, 1.2710e-01, 2.5379e-02,
        1.8507e-02, 1.6360e-02, 5.0048e-02, 6.3137e-02])
[rfa agg] iter:  6, prev_obj_val: 7738.12890625, obj_val: 7739.71826171875, abs dis: 1.58935546875
[rfa agg] iter: 6, weight: tensor([6.5288e-05, 1.0366e-01, 1.6931e-01, 2.8393e-01, 1.2290e-01, 4.6727e-02,
        3.3135e-02, 2.8662e-02, 6.3839e-02, 1.4776e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3556, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.2593, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.8411777019501 sec.
Server Epoch:36 choose agents : [13, 2, 71, 52, 77, 36, 14, 45, 7, 65].
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0549, Accuracy: 383/1645 (23.2827%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0315, Accuracy: 668/1645 (40.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2671, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0616, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0407, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9129, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0600, Accuracy: 199/818 (24.3276%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0290, Accuracy: 394/818 (48.1663%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.4321, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0531, Accuracy: 315/636 (49.5283%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0275, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5399, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0481, Accuracy: 401/1340 (29.9254%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0251, Accuracy: 638/1340 (47.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0529, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   1, Avg loss: 0.0843, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  36, local model 36, internal_epoch   2, Avg loss: 0.0495, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.5213, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0583, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0333, Accuracy: 414/1013 (40.8687%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8062, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   1, Avg loss: 0.0637, Accuracy: 233/669 (34.8281%)
_Train Local_ResNet_18, epoch  36, local model 45, internal_epoch   2, Avg loss: 0.0376, Accuracy: 362/669 (54.1106%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.3917, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0512, Accuracy: 371/891 (41.6386%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.9962, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   1, Avg loss: 0.0519, Accuracy: 418/1475 (28.3390%)
_Train Local_ResNet_18, epoch  36, local model 65, internal_epoch   2, Avg loss: 0.0286, Accuracy: 733/1475 (49.6949%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2962, Accuracy: 104/10000 (1.0400%)
time spent on training: 166.4103479385376
[rfa agg] training data poison_ratio: 0.0  data num: [1645, 605, 818, 636, 1340, 408, 1013, 669, 891, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [13, 2, 71, 52, 77, 36, 14, 45, 7, 65], weight: tensor([0.1732, 0.0637, 0.0861, 0.0669, 0.1411, 0.0429, 0.1066, 0.0704, 0.0938,
        0.1553])
[rfa agg] iter:  0, prev_obj_val: 51.94928741455078, obj_val: 55.6411247253418, abs dis: 3.6918373107910156
[rfa agg] iter: 0, weight: tensor([0.0494, 0.0345, 0.1002, 0.0364, 0.0764, 0.0152, 0.4164, 0.0466, 0.1703,
        0.0546])
[rfa agg] iter:  1, prev_obj_val: 55.6411247253418, obj_val: 63.85028839111328, abs dis: 8.209163665771484
[rfa agg] iter: 1, weight: tensor([0.0364, 0.0469, 0.2796, 0.0496, 0.0492, 0.0174, 0.1110, 0.0718, 0.2994,
        0.0387])
[rfa agg] iter:  2, prev_obj_val: 63.85028839111328, obj_val: 69.11847686767578, abs dis: 5.2681884765625
[rfa agg] iter: 2, weight: tensor([0.0363, 0.1179, 0.1662, 0.1263, 0.0451, 0.0290, 0.0716, 0.2579, 0.1121,
        0.0377])
[rfa agg] iter:  3, prev_obj_val: 69.11847686767578, obj_val: 75.98685455322266, abs dis: 6.868377685546875
[rfa agg] iter: 3, weight: tensor([0.0282, 0.1979, 0.0850, 0.2297, 0.0339, 0.0308, 0.0488, 0.2499, 0.0667,
        0.0290])
[rfa agg] iter:  4, prev_obj_val: 75.98685455322266, obj_val: 83.94804382324219, abs dis: 7.961189270019531
[rfa agg] iter: 4, weight: tensor([0.0315, 0.2450, 0.0729, 0.2860, 0.0368, 0.0509, 0.0491, 0.1337, 0.0620,
        0.0321])
[rfa agg] iter:  5, prev_obj_val: 83.94804382324219, obj_val: 69.1180419921875, abs dis: 14.830001831054688
[rfa agg] iter: 5, weight: tensor([0.0452, 0.1818, 0.0868, 0.1949, 0.0515, 0.1262, 0.0649, 0.1255, 0.0775,
        0.0457])
[rfa agg] iter:  6, prev_obj_val: 69.1180419921875, obj_val: 72.29367065429688, abs dis: 3.175628662109375
[rfa agg] iter: 6, weight: tensor([0.0283, 0.2079, 0.0850, 0.2369, 0.0339, 0.0309, 0.0489, 0.2323, 0.0668,
        0.0290])
[rfa agg] iter:  7, prev_obj_val: 72.29367065429688, obj_val: 72.28173065185547, abs dis: 0.01194000244140625
[rfa agg] iter: 7, weight: tensor([0.0255, 0.2536, 0.0664, 0.3211, 0.0302, 0.0335, 0.0417, 0.1473, 0.0546,
        0.0261])
[rfa agg] iter:  8, prev_obj_val: 72.28173065185547, obj_val: 72.28142547607422, abs dis: 0.00030517578125
[rfa agg] iter: 8, weight: tensor([0.0246, 0.2554, 0.0641, 0.3380, 0.0291, 0.0323, 0.0403, 0.1385, 0.0527,
        0.0252])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3571, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.2611, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.704692363739 sec.
Server Epoch:37 choose agents : [47, 82, 46, 56, 36, 98, 76, 12, 35, 63].
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1162, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1038, Accuracy: 31/134 (23.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3812, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   1, Avg loss: 0.0739, Accuracy: 88/500 (17.6000%)
_Train Local_ResNet_18, epoch  37, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3441, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0541, Accuracy: 437/1904 (22.9517%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0300, Accuracy: 752/1904 (39.4958%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1376, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   1, Avg loss: 0.0845, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 56, internal_epoch   2, Avg loss: 0.0685, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.4203, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   1, Avg loss: 0.0838, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  37, local model 36, internal_epoch   2, Avg loss: 0.0505, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   1, Avg loss: 0.0787, Accuracy: 47/373 (12.6005%)
_Train Local_ResNet_18, epoch  37, local model 98, internal_epoch   2, Avg loss: 0.0451, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.6515, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   1, Avg loss: 0.0797, Accuracy: 78/466 (16.7382%)
_Train Local_ResNet_18, epoch  37, local model 76, internal_epoch   2, Avg loss: 0.0442, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.0329, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   1, Avg loss: 0.0858, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  37, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.6250, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   1, Avg loss: 0.0891, Accuracy: 20/271 (7.3801%)
_Train Local_ResNet_18, epoch  37, local model 35, internal_epoch   2, Avg loss: 0.0578, Accuracy: 121/271 (44.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.1348, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   1, Avg loss: 0.0496, Accuracy: 311/888 (35.0225%)
_Train Local_ResNet_18, epoch  37, local model 63, internal_epoch   2, Avg loss: 0.0241, Accuracy: 508/888 (57.2072%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.9110, Accuracy: 84/10000 (0.8400%)
time spent on training: 140.50944542884827
[rfa agg] training data poison_ratio: 0.0  data num: [134, 500, 1904, 186, 408, 373, 466, 338, 271, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 82, 46, 56, 36, 98, 76, 12, 35, 63], weight: tensor([0.0245, 0.0914, 0.3482, 0.0340, 0.0746, 0.0682, 0.0852, 0.0618, 0.0496,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 83.81570434570312, obj_val: 83.92160034179688, abs dis: 0.10589599609375
[rfa agg] iter: 0, weight: tensor([0.0083, 0.0590, 0.0752, 0.0116, 0.0408, 0.0324, 0.0549, 0.0294, 0.0208,
        0.6676])
[rfa agg] iter:  1, prev_obj_val: 83.92160034179688, obj_val: 84.57624816894531, abs dis: 0.6546478271484375
[rfa agg] iter: 1, weight: tensor([0.0161, 0.1573, 0.0965, 0.0224, 0.0976, 0.0715, 0.1458, 0.0649, 0.0434,
        0.2845])
[rfa agg] iter:  2, prev_obj_val: 84.57624816894531, obj_val: 90.2948989868164, abs dis: 5.718650817871094
[rfa agg] iter: 2, weight: tensor([0.0105, 0.3238, 0.0381, 0.0146, 0.1142, 0.0636, 0.2751, 0.0577, 0.0332,
        0.0693])
[rfa agg] iter:  3, prev_obj_val: 90.2948989868164, obj_val: 96.03209686279297, abs dis: 5.7371978759765625
[rfa agg] iter: 3, weight: tensor([0.0131, 0.1115, 0.0277, 0.0182, 0.2290, 0.2050, 0.1024, 0.1922, 0.0606,
        0.0404])
[rfa agg] iter:  4, prev_obj_val: 96.03209686279297, obj_val: 99.56655883789062, abs dis: 3.5344619750976562
[rfa agg] iter: 4, weight: tensor([0.0199, 0.0737, 0.0290, 0.0277, 0.1002, 0.2432, 0.0682, 0.2247, 0.1746,
        0.0389])
[rfa agg] iter:  5, prev_obj_val: 99.56655883789062, obj_val: 99.54789733886719, abs dis: 0.0186614990234375
[rfa agg] iter: 5, weight: tensor([0.0258, 0.0642, 0.0296, 0.0359, 0.0785, 0.1398, 0.0595, 0.1277, 0.4009,
        0.0382])
[rfa agg] iter:  6, prev_obj_val: 99.54789733886719, obj_val: 111.27617645263672, abs dis: 11.728279113769531
[rfa agg] iter: 6, weight: tensor([0.0222, 0.0552, 0.0254, 0.0309, 0.0674, 0.1185, 0.0512, 0.1091, 0.4870,
        0.0329])
[rfa agg] iter:  7, prev_obj_val: 111.27617645263672, obj_val: 99.56965637207031, abs dis: 11.706520080566406
[rfa agg] iter: 7, weight: tensor([0.1541, 0.0726, 0.0471, 0.2242, 0.0762, 0.0970, 0.0675, 0.0881, 0.1179,
        0.0554])
[rfa agg] iter:  8, prev_obj_val: 99.56965637207031, obj_val: 99.54743194580078, abs dis: 0.02222442626953125
[rfa agg] iter: 8, weight: tensor([0.0255, 0.0634, 0.0292, 0.0356, 0.0774, 0.1355, 0.0588, 0.1251, 0.4118,
        0.0378])
[rfa agg] iter:  9, prev_obj_val: 99.54743194580078, obj_val: 111.27650451660156, abs dis: 11.729072570800781
[rfa agg] iter: 9, weight: tensor([0.0220, 0.0547, 0.0252, 0.0307, 0.0668, 0.1173, 0.0507, 0.1080, 0.4918,
        0.0326])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3583, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.2733, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.87274169921875 sec.
Server Epoch:38 choose agents : [20, 56, 26, 83, 27, 50, 1, 89, 4, 41].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0557, Accuracy: 339/807 (42.0074%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0304, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9759, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0846, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0690, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.4195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0541, Accuracy: 349/1446 (24.1355%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0334, Accuracy: 542/1446 (37.4827%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4637, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 456/1953 (23.3487%)
_Train Local_ResNet_18, epoch  38, local model 83, internal_epoch   2, Avg loss: 0.0327, Accuracy: 834/1953 (42.7035%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9013, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 434/1587 (27.3472%)
_Train Local_ResNet_18, epoch  38, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 599/1587 (37.7442%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3691, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   1, Avg loss: 0.0598, Accuracy: 181/809 (22.3733%)
_Train Local_ResNet_18, epoch  38, local model 50, internal_epoch   2, Avg loss: 0.0248, Accuracy: 415/809 (51.2979%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.4025, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0542, Accuracy: 311/928 (33.5129%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0227, Accuracy: 615/928 (66.2716%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.3798, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 352/896 (39.2857%)
_Train Local_ResNet_18, epoch  38, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1898, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0592, Accuracy: 341/901 (37.8468%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 386/901 (42.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4914, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0585, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0325, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2062, Accuracy: 66/10000 (0.6600%)
time spent on training: 187.2126247882843
[rfa agg] training data poison_ratio: 0.07887021110242377  data num: [807, 186, 1446, 1953, 1587, 809, 928, 896, 901, 719]
[rfa agg] considering poison per batch poison_fraction: 0.02464694096950743
[rfa agg] init. name: [20, 56, 26, 83, 27, 50, 1, 89, 4, 41], weight: tensor([0.0789, 0.0182, 0.1413, 0.1909, 0.1551, 0.0791, 0.0907, 0.0876, 0.0881,
        0.0703])
[rfa agg] iter:  0, prev_obj_val: 59.88676834106445, obj_val: 59.76612091064453, abs dis: 0.12064743041992188
[rfa agg] iter: 0, weight: tensor([0.0860, 0.0062, 0.1263, 0.0700, 0.1020, 0.0861, 0.1715, 0.1216, 0.1674,
        0.0628])
[rfa agg] iter:  1, prev_obj_val: 59.76612091064453, obj_val: 63.14116668701172, abs dis: 3.3750457763671875
[rfa agg] iter: 1, weight: tensor([0.0832, 0.0045, 0.0652, 0.0412, 0.0557, 0.0833, 0.2384, 0.1348, 0.2377,
        0.0560])
[rfa agg] iter:  2, prev_obj_val: 63.14116668701172, obj_val: 71.07905578613281, abs dis: 7.937889099121094
[rfa agg] iter: 2, weight: tensor([0.1330, 0.0034, 0.0321, 0.0230, 0.0289, 0.1308, 0.1542, 0.2738, 0.1537,
        0.0671])
[rfa agg] iter:  3, prev_obj_val: 71.07905578613281, obj_val: 74.65645599365234, abs dis: 3.5774002075195312
[rfa agg] iter: 3, weight: tensor([0.2250, 0.0045, 0.0314, 0.0241, 0.0290, 0.2182, 0.0813, 0.1281, 0.0797,
        0.1789])
[rfa agg] iter:  4, prev_obj_val: 74.65645599365234, obj_val: 74.64047241210938, abs dis: 0.01598358154296875
[rfa agg] iter: 4, weight: tensor([0.1825, 0.0053, 0.0335, 0.0262, 0.0311, 0.1787, 0.0763, 0.1080, 0.0745,
        0.2839])
[rfa agg] iter:  5, prev_obj_val: 74.64047241210938, obj_val: 74.63910675048828, abs dis: 0.00136566162109375
[rfa agg] iter: 5, weight: tensor([0.1743, 0.0051, 0.0324, 0.0253, 0.0301, 0.1694, 0.0736, 0.1039, 0.0718,
        0.3142])
[rfa agg] iter:  6, prev_obj_val: 74.63910675048828, obj_val: 74.63896179199219, abs dis: 0.00014495849609375
[rfa agg] iter: 6, weight: tensor([0.1716, 0.0050, 0.0320, 0.0250, 0.0297, 0.1665, 0.0727, 0.1025, 0.0708,
        0.3242])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3577, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.2904, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.9144518375397 sec.
Server Epoch:39 choose agents : [45, 63, 78, 36, 55, 93, 46, 8, 18, 28].
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   1, Avg loss: 0.0633, Accuracy: 240/669 (35.8744%)
_Train Local_ResNet_18, epoch  39, local model 45, internal_epoch   2, Avg loss: 0.0372, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.4127, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0500, Accuracy: 301/888 (33.8964%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0243, Accuracy: 486/888 (54.7297%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.7375, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   1, Avg loss: 0.0802, Accuracy: 65/416 (15.6250%)
_Train Local_ResNet_18, epoch  39, local model 78, internal_epoch   2, Avg loss: 0.0441, Accuracy: 223/416 (53.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1126, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   1, Avg loss: 0.0837, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  39, local model 36, internal_epoch   2, Avg loss: 0.0497, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.6430, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   1, Avg loss: 0.0534, Accuracy: 289/1071 (26.9841%)
_Train Local_ResNet_18, epoch  39, local model 55, internal_epoch   2, Avg loss: 0.0283, Accuracy: 526/1071 (49.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.9980, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   1, Avg loss: 0.0531, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  39, local model 93, internal_epoch   2, Avg loss: 0.0311, Accuracy: 733/1742 (42.0781%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4480, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0536, Accuracy: 421/1904 (22.1113%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0304, Accuracy: 723/1904 (37.9727%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0259, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0565, Accuracy: 346/1513 (22.8685%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0346, Accuracy: 548/1513 (36.2194%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9299, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   1, Avg loss: 0.0743, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  39, local model 18, internal_epoch   2, Avg loss: 0.0411, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1481, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   1, Avg loss: 0.0543, Accuracy: 411/1581 (25.9962%)
_Train Local_ResNet_18, epoch  39, local model 28, internal_epoch   2, Avg loss: 0.0321, Accuracy: 667/1581 (42.1885%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9090, Accuracy: 103/10000 (1.0300%)
time spent on training: 189.11532044410706
[rfa agg] training data poison_ratio: 0.09988808058198097  data num: [669, 888, 416, 408, 1071, 1742, 1904, 1513, 530, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.03121502518186905
[rfa agg] init. name: [45, 63, 78, 36, 55, 93, 46, 8, 18, 28], weight: tensor([0.0624, 0.0828, 0.0388, 0.0381, 0.0999, 0.1625, 0.1776, 0.1411, 0.0494,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 67.87054443359375, obj_val: 70.1870346069336, abs dis: 2.3164901733398438
[rfa agg] iter: 0, weight: tensor([0.0461, 0.0974, 0.0192, 0.0188, 0.2782, 0.1065, 0.0955, 0.1649, 0.0293,
        0.1442])
[rfa agg] iter:  1, prev_obj_val: 70.1870346069336, obj_val: 72.77667999267578, abs dis: 2.5896453857421875
[rfa agg] iter: 1, weight: tensor([0.0437, 0.1007, 0.0174, 0.0170, 0.4243, 0.0797, 0.0727, 0.1147, 0.0270,
        0.1029])
[rfa agg] iter:  2, prev_obj_val: 72.77667999267578, obj_val: 76.57243347167969, abs dis: 3.7957534790039062
[rfa agg] iter: 2, weight: tensor([0.0309, 0.0807, 0.0116, 0.0114, 0.6475, 0.0440, 0.0408, 0.0598, 0.0184,
        0.0548])
[rfa agg] iter:  3, prev_obj_val: 76.57243347167969, obj_val: 78.57112121582031, abs dis: 1.998687744140625
[rfa agg] iter: 3, weight: tensor([0.0554, 0.1746, 0.0193, 0.0189, 0.4316, 0.0605, 0.0567, 0.0785, 0.0315,
        0.0730])
[rfa agg] iter:  4, prev_obj_val: 78.57112121582031, obj_val: 80.60952758789062, abs dis: 2.0384063720703125
[rfa agg] iter: 4, weight: tensor([0.0677, 0.2531, 0.0225, 0.0221, 0.3152, 0.0640, 0.0603, 0.0815, 0.0374,
        0.0763])
[rfa agg] iter:  5, prev_obj_val: 80.60952758789062, obj_val: 82.68183898925781, abs dis: 2.0723114013671875
[rfa agg] iter: 5, weight: tensor([0.0736, 0.3503, 0.0231, 0.0227, 0.2304, 0.0595, 0.0564, 0.0745, 0.0392,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 82.68183898925781, obj_val: 87.47100067138672, abs dis: 4.789161682128906
[rfa agg] iter: 6, weight: tensor([0.0699, 0.4912, 0.0206, 0.0202, 0.1546, 0.0478, 0.0455, 0.0589, 0.0356,
        0.0557])
[rfa agg] iter:  7, prev_obj_val: 87.47100067138672, obj_val: 87.4685287475586, abs dis: 0.002471923828125
[rfa agg] iter: 7, weight: tensor([0.0934, 0.5254, 0.0230, 0.0225, 0.1081, 0.0431, 0.0414, 0.0516, 0.0421,
        0.0493])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3622, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3125, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.3336503505707 sec.
Server Epoch:40 choose agents : [63, 47, 34, 98, 70, 76, 77, 11, 84, 87].
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0459, Accuracy: 338/888 (38.0631%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0234, Accuracy: 501/888 (56.4189%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.0429, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1165, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1035, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3894, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   1, Avg loss: 0.0560, Accuracy: 384/1427 (26.9096%)
_Train Local_ResNet_18, epoch  40, local model 34, internal_epoch   2, Avg loss: 0.0321, Accuracy: 624/1427 (43.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4660, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   1, Avg loss: 0.0778, Accuracy: 53/373 (14.2091%)
_Train Local_ResNet_18, epoch  40, local model 98, internal_epoch   2, Avg loss: 0.0442, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 430/1418 (30.3244%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 693/1418 (48.8717%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.9748, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   1, Avg loss: 0.0783, Accuracy: 82/466 (17.5966%)
_Train Local_ResNet_18, epoch  40, local model 76, internal_epoch   2, Avg loss: 0.0460, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6659, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   1, Avg loss: 0.0476, Accuracy: 388/1340 (28.9552%)
_Train Local_ResNet_18, epoch  40, local model 77, internal_epoch   2, Avg loss: 0.0251, Accuracy: 625/1340 (46.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.2400, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   1, Avg loss: 0.0565, Accuracy: 317/712 (44.5225%)
_Train Local_ResNet_18, epoch  40, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 372/712 (52.2472%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.0998, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0586, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0301, Accuracy: 499/1190 (41.9328%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2050, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 308/1131 (27.2325%)
_Train Local_ResNet_18, epoch  40, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 415/1131 (36.6932%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1978, Accuracy: 52/10000 (0.5200%)
time spent on training: 182.42588877677917
[rfa agg] training data poison_ratio: 0.0  data num: [888, 134, 1427, 373, 1418, 466, 1340, 712, 1190, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 47, 34, 98, 70, 76, 77, 11, 84, 87], weight: tensor([0.0978, 0.0148, 0.1572, 0.0411, 0.1562, 0.0513, 0.1476, 0.0784, 0.1311,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 48.13376998901367, obj_val: 52.03587341308594, abs dis: 3.9021034240722656
[rfa agg] iter: 0, weight: tensor([0.2439, 0.0048, 0.0842, 0.0175, 0.0838, 0.0276, 0.1077, 0.0892, 0.1469,
        0.1944])
[rfa agg] iter:  1, prev_obj_val: 52.03587341308594, obj_val: 54.1357421875, abs dis: 2.0998687744140625
[rfa agg] iter: 1, weight: tensor([0.4475, 0.0042, 0.0607, 0.0160, 0.0604, 0.0260, 0.0745, 0.1004, 0.0945,
        0.1158])
[rfa agg] iter:  2, prev_obj_val: 54.1357421875, obj_val: 56.72874450683594, abs dis: 2.5930023193359375
[rfa agg] iter: 2, weight: tensor([0.6136, 0.0032, 0.0408, 0.0121, 0.0406, 0.0200, 0.0493, 0.0878, 0.0606,
        0.0722])
[rfa agg] iter:  3, prev_obj_val: 56.72874450683594, obj_val: 56.719818115234375, abs dis: 0.0089263916015625
[rfa agg] iter: 3, weight: tensor([0.5098, 0.0041, 0.0483, 0.0161, 0.0481, 0.0273, 0.0575, 0.1397, 0.0689,
        0.0802])
[rfa agg] iter:  4, prev_obj_val: 56.719818115234375, obj_val: 59.50290298461914, abs dis: 2.7830848693847656
[rfa agg] iter: 4, weight: tensor([0.4937, 0.0042, 0.0497, 0.0165, 0.0495, 0.0281, 0.0591, 0.1457, 0.0709,
        0.0826])
[rfa agg] iter:  5, prev_obj_val: 59.50290298461914, obj_val: 59.48643493652344, abs dis: 0.016468048095703125
[rfa agg] iter: 5, weight: tensor([0.3399, 0.0054, 0.0574, 0.0215, 0.0571, 0.0375, 0.0674, 0.2443, 0.0791,
        0.0905])
[rfa agg] iter:  6, prev_obj_val: 59.48643493652344, obj_val: 56.736656188964844, abs dis: 2.7497787475585938
[rfa agg] iter: 6, weight: tensor([0.3286, 0.0054, 0.0575, 0.0216, 0.0572, 0.0376, 0.0675, 0.2545, 0.0794,
        0.0908])
[rfa agg] iter:  7, prev_obj_val: 56.736656188964844, obj_val: 59.4977912902832, abs dis: 2.7611351013183594
[rfa agg] iter: 7, weight: tensor([0.4617, 0.0045, 0.0525, 0.0174, 0.0522, 0.0296, 0.0624, 0.1574, 0.0749,
        0.0873])
[rfa agg] iter:  8, prev_obj_val: 59.4977912902832, obj_val: 59.48640441894531, abs dis: 0.011386871337890625
[rfa agg] iter: 8, weight: tensor([0.3378, 0.0054, 0.0574, 0.0215, 0.0571, 0.0375, 0.0674, 0.2460, 0.0792,
        0.0906])
[rfa agg] iter:  9, prev_obj_val: 59.48640441894531, obj_val: 56.736698150634766, abs dis: 2.749706268310547
[rfa agg] iter: 9, weight: tensor([0.3284, 0.0054, 0.0575, 0.0216, 0.0572, 0.0376, 0.0675, 0.2547, 0.0794,
        0.0908])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3667, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3327, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 346.62263584136963 sec.
Server Epoch:41 choose agents : [59, 2, 68, 89, 47, 69, 90, 26, 96, 40].
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   1, Avg loss: 0.0559, Accuracy: 341/1089 (31.3131%)
_Train Local_ResNet_18, epoch  41, local model 59, internal_epoch   2, Avg loss: 0.0266, Accuracy: 501/1089 (46.0055%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.5117, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0616, Accuracy: 224/605 (37.0248%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7893, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   1, Avg loss: 0.0596, Accuracy: 368/1163 (31.6423%)
_Train Local_ResNet_18, epoch  41, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 450/1163 (38.6930%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6645, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 427/896 (47.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1958, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   1, Avg loss: 0.1173, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  41, local model 47, internal_epoch   2, Avg loss: 0.1029, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3979, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   1, Avg loss: 0.0533, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  41, local model 69, internal_epoch   2, Avg loss: 0.0326, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.4735, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0527, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 436/677 (64.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9708, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   1, Avg loss: 0.0539, Accuracy: 342/1446 (23.6515%)
_Train Local_ResNet_18, epoch  41, local model 26, internal_epoch   2, Avg loss: 0.0337, Accuracy: 528/1446 (36.5145%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7552, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0796, Accuracy: 24/311 (7.7170%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0525, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.0636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 353/1573 (22.4412%)
_Train Local_ResNet_18, epoch  41, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 616/1573 (39.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0785, Accuracy: 85/10000 (0.8500%)
time spent on training: 167.40917563438416
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 605, 1163, 896, 134, 590, 677, 1446, 311, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 2, 68, 89, 47, 69, 90, 26, 96, 40], weight: tensor([0.1284, 0.0713, 0.1371, 0.1056, 0.0158, 0.0695, 0.0798, 0.1704, 0.0367,
        0.1854])
[rfa agg] iter:  0, prev_obj_val: 53.06334686279297, obj_val: 55.471595764160156, abs dis: 2.4082489013671875
[rfa agg] iter: 0, weight: tensor([0.1551, 0.0564, 0.1341, 0.3424, 0.0052, 0.0550, 0.0788, 0.0845, 0.0146,
        0.0737])
[rfa agg] iter:  1, prev_obj_val: 55.471595764160156, obj_val: 61.13176345825195, abs dis: 5.660167694091797
[rfa agg] iter: 1, weight: tensor([0.0865, 0.0500, 0.0769, 0.5468, 0.0041, 0.0488, 0.0743, 0.0535, 0.0116,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 61.13176345825195, obj_val: 61.082725524902344, abs dis: 0.049037933349609375
[rfa agg] iter: 2, weight: tensor([0.0891, 0.1085, 0.0825, 0.2703, 0.0066, 0.1063, 0.1953, 0.0638, 0.0193,
        0.0584])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3645, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3437, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 329.25670051574707 sec.
Server Epoch:42 choose agents : [80, 48, 22, 54, 17, 4, 46, 71, 64, 34].
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   1, Avg loss: 0.0675, Accuracy: 154/682 (22.5806%)
_Train Local_ResNet_18, epoch  42, local model 80, internal_epoch   2, Avg loss: 0.0368, Accuracy: 231/682 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9336, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   1, Avg loss: 0.0719, Accuracy: 99/631 (15.6894%)
_Train Local_ResNet_18, epoch  42, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 244/631 (38.6688%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6427, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 559/1470 (38.0272%)
_Train Local_ResNet_18, epoch  42, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 904/1470 (61.4966%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.1713, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  42, local model 54, internal_epoch   2, Avg loss: 0.0277, Accuracy: 494/1130 (43.7168%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.5629, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 419/1574 (26.6201%)
_Train Local_ResNet_18, epoch  42, local model 17, internal_epoch   2, Avg loss: 0.0264, Accuracy: 719/1574 (45.6798%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7183, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0603, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/901 (47.3918%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9208, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   1, Avg loss: 0.0534, Accuracy: 420/1904 (22.0588%)
_Train Local_ResNet_18, epoch  42, local model 46, internal_epoch   2, Avg loss: 0.0302, Accuracy: 742/1904 (38.9706%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3006, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   1, Avg loss: 0.0573, Accuracy: 235/818 (28.7286%)
_Train Local_ResNet_18, epoch  42, local model 71, internal_epoch   2, Avg loss: 0.0282, Accuracy: 419/818 (51.2225%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7790, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 175/953 (18.3631%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0369, Accuracy: 336/953 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4465, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0565, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0322, Accuracy: 586/1427 (41.0652%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9975, Accuracy: 75/10000 (0.7500%)
time spent on training: 189.78038001060486
[rfa agg] training data poison_ratio: 0.0  data num: [682, 631, 1470, 1130, 1574, 901, 1904, 818, 953, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 48, 22, 54, 17, 4, 46, 71, 64, 34], weight: tensor([0.0594, 0.0549, 0.1279, 0.0983, 0.1370, 0.0784, 0.1657, 0.0712, 0.0829,
        0.1242])
[rfa agg] iter:  0, prev_obj_val: 55.05403137207031, obj_val: 60.59036636352539, abs dis: 5.536334991455078
[rfa agg] iter: 0, weight: tensor([0.0332, 0.0266, 0.0837, 0.3777, 0.0661, 0.1098, 0.0482, 0.0571, 0.1163,
        0.0814])
[rfa agg] iter:  1, prev_obj_val: 60.59036636352539, obj_val: 62.28486633300781, abs dis: 1.6944999694824219
[rfa agg] iter: 1, weight: tensor([0.0390, 0.0295, 0.0504, 0.1146, 0.0427, 0.2784, 0.0339, 0.0818, 0.2807,
        0.0489])
[rfa agg] iter:  2, prev_obj_val: 62.28486633300781, obj_val: 70.18798828125, abs dis: 7.9031219482421875
[rfa agg] iter: 2, weight: tensor([0.0338, 0.0251, 0.0365, 0.0731, 0.0313, 0.3274, 0.0253, 0.0776, 0.3344,
        0.0354])
[rfa agg] iter:  3, prev_obj_val: 70.18798828125, obj_val: 64.69540405273438, abs dis: 5.492584228515625
[rfa agg] iter: 3, weight: tensor([0.0788, 0.0527, 0.0458, 0.0736, 0.0406, 0.1685, 0.0343, 0.2834, 0.1779,
        0.0445])
[rfa agg] iter:  4, prev_obj_val: 64.69540405273438, obj_val: 73.14019775390625, abs dis: 8.444793701171875
[rfa agg] iter: 4, weight: tensor([0.0476, 0.0343, 0.0424, 0.0778, 0.0369, 0.2760, 0.0303, 0.1277, 0.2857,
        0.0412])
[rfa agg] iter:  5, prev_obj_val: 73.14019775390625, obj_val: 79.68983459472656, abs dis: 6.5496368408203125
[rfa agg] iter: 5, weight: tensor([0.0950, 0.0596, 0.0424, 0.0647, 0.0379, 0.1258, 0.0324, 0.3684, 0.1328,
        0.0411])
[rfa agg] iter:  6, prev_obj_val: 79.68983459472656, obj_val: 70.12542724609375, abs dis: 9.564407348632812
[rfa agg] iter: 6, weight: tensor([0.2088, 0.1022, 0.0452, 0.0634, 0.0410, 0.0995, 0.0358, 0.2552, 0.1050,
        0.0439])
[rfa agg] iter:  7, prev_obj_val: 70.12542724609375, obj_val: 79.6921157836914, abs dis: 9.566688537597656
[rfa agg] iter: 7, weight: tensor([0.0758, 0.0501, 0.0434, 0.0697, 0.0384, 0.1540, 0.0324, 0.3320, 0.1620,
        0.0421])
[rfa agg] iter:  8, prev_obj_val: 79.6921157836914, obj_val: 67.36296081542969, abs dis: 12.329154968261719
[rfa agg] iter: 8, weight: tensor([0.2083, 0.1026, 0.0454, 0.0637, 0.0412, 0.1001, 0.0360, 0.2529, 0.1057,
        0.0441])
[rfa agg] iter:  9, prev_obj_val: 67.36296081542969, obj_val: 67.327880859375, abs dis: 0.0350799560546875
[rfa agg] iter: 9, weight: tensor([0.0644, 0.0446, 0.0464, 0.0793, 0.0407, 0.2125, 0.0339, 0.2105, 0.2227,
        0.0451])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3632, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.2698, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 356.35565876960754 sec.
Server Epoch:43 choose agents : [48, 64, 0, 16, 40, 36, 32, 96, 83, 81].
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 106/631 (16.7987%)
_Train Local_ResNet_18, epoch  43, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5008, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   1, Avg loss: 0.0621, Accuracy: 182/953 (19.0976%)
_Train Local_ResNet_18, epoch  43, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 330/953 (34.6275%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6344, Accuracy: 74/10000 (0.7400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   1, Avg loss: 0.0567, Accuracy: 375/1657 (22.6313%)
_Train Local_ResNet_18, epoch  43, local model 0, internal_epoch   2, Avg loss: 0.0336, Accuracy: 576/1657 (34.7616%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0964, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   1, Avg loss: 0.0650, Accuracy: 268/708 (37.8531%)
_Train Local_ResNet_18, epoch  43, local model 16, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5899, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 375/1573 (23.8398%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0341, Accuracy: 591/1573 (37.5715%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7176, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   1, Avg loss: 0.0840, Accuracy: 58/408 (14.2157%)
_Train Local_ResNet_18, epoch  43, local model 36, internal_epoch   2, Avg loss: 0.0491, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6875, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   1, Avg loss: 0.0572, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  43, local model 32, internal_epoch   2, Avg loss: 0.0215, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.5704, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 17/311 (5.4662%)
_Train Local_ResNet_18, epoch  43, local model 96, internal_epoch   2, Avg loss: 0.0528, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.0655, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 431/1953 (22.0686%)
_Train Local_ResNet_18, epoch  43, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 776/1953 (39.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2977, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   1, Avg loss: 0.0640, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  43, local model 81, internal_epoch   2, Avg loss: 0.0336, Accuracy: 326/774 (42.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8480, Accuracy: 86/10000 (0.8600%)
time spent on training: 203.29273509979248
[rfa agg] training data poison_ratio: 0.17077192620838916  data num: [631, 953, 1657, 708, 1573, 408, 735, 311, 1953, 774]
[rfa agg] considering poison per batch poison_fraction: 0.05336622694012161
[rfa agg] init. name: [48, 64, 0, 16, 40, 36, 32, 96, 83, 81], weight: tensor([0.0650, 0.0982, 0.1708, 0.0730, 0.1621, 0.0420, 0.0757, 0.0321, 0.2013,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 73.1796875, obj_val: 74.1694107055664, abs dis: 0.9897232055664062
[rfa agg] iter: 0, weight: tensor([0.0562, 0.2457, 0.1299, 0.0856, 0.1400, 0.0260, 0.0891, 0.0167, 0.0968,
        0.1140])
[rfa agg] iter:  1, prev_obj_val: 74.1694107055664, obj_val: 75.1119613647461, abs dis: 0.9425506591796875
[rfa agg] iter: 1, weight: tensor([0.0504, 0.3957, 0.0794, 0.0840, 0.0838, 0.0218, 0.0876, 0.0136, 0.0626,
        0.1211])
[rfa agg] iter:  2, prev_obj_val: 75.1119613647461, obj_val: 78.64459991455078, abs dis: 3.5326385498046875
[rfa agg] iter: 2, weight: tensor([0.0353, 0.5851, 0.0423, 0.0649, 0.0442, 0.0144, 0.0678, 0.0088, 0.0344,
        0.1029])
[rfa agg] iter:  3, prev_obj_val: 78.64459991455078, obj_val: 79.94374084472656, abs dis: 1.2991409301757812
[rfa agg] iter: 3, weight: tensor([0.0595, 0.2084, 0.0442, 0.1418, 0.0457, 0.0210, 0.1511, 0.0122, 0.0373,
        0.2787])
[rfa agg] iter:  4, prev_obj_val: 79.94374084472656, obj_val: 86.78573608398438, abs dis: 6.8419952392578125
[rfa agg] iter: 4, weight: tensor([0.0544, 0.1204, 0.0336, 0.1584, 0.0345, 0.0179, 0.1723, 0.0103, 0.0286,
        0.3695])
[rfa agg] iter:  5, prev_obj_val: 86.78573608398438, obj_val: 89.83715057373047, abs dis: 3.0514144897460938
[rfa agg] iter: 5, weight: tensor([0.1098, 0.0761, 0.0325, 0.2504, 0.0331, 0.0257, 0.2902, 0.0136, 0.0285,
        0.1402])
[rfa agg] iter:  6, prev_obj_val: 89.83715057373047, obj_val: 89.8311996459961, abs dis: 0.005950927734375
[rfa agg] iter: 6, weight: tensor([0.1857, 0.0807, 0.0378, 0.2143, 0.0385, 0.0348, 0.2306, 0.0177, 0.0335,
        0.1264])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3614, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.0736, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.69991636276245 sec.
Server Epoch:44 choose agents : [20, 4, 97, 32, 42, 33, 22, 30, 56, 0].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0552, Accuracy: 315/807 (39.0335%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0302, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.7999, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 404/901 (44.8391%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   1, Avg loss: 0.0516, Accuracy: 354/1213 (29.1838%)
_Train Local_ResNet_18, epoch  44, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 554/1213 (45.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.5306, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0550, Accuracy: 221/735 (30.0680%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 389/735 (52.9252%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.1950, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   1, Avg loss: 0.0545, Accuracy: 305/1372 (22.2303%)
_Train Local_ResNet_18, epoch  44, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 521/1372 (37.9738%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.3305, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   1, Avg loss: 0.0791, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  44, local model 33, internal_epoch   2, Avg loss: 0.0505, Accuracy: 148/515 (28.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7508, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 559/1470 (38.0272%)
_Train Local_ResNet_18, epoch  44, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 861/1470 (58.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.5280, Accuracy: 95/10000 (0.9500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   1, Avg loss: 0.0741, Accuracy: 90/486 (18.5185%)
_Train Local_ResNet_18, epoch  44, local model 30, internal_epoch   2, Avg loss: 0.0387, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0201, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 72/186 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4283, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   1, Avg loss: 0.0567, Accuracy: 356/1657 (21.4846%)
_Train Local_ResNet_18, epoch  44, local model 0, internal_epoch   2, Avg loss: 0.0334, Accuracy: 555/1657 (33.4943%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3574, Accuracy: 80/10000 (0.8000%)
time spent on training: 224.5727415084839
[rfa agg] training data poison_ratio: 0.3157782059516164  data num: [807, 901, 1213, 735, 1372, 515, 1470, 486, 186, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.09868068935988011
[rfa agg] init. name: [20, 4, 97, 32, 42, 33, 22, 30, 56, 0], weight: tensor([0.0864, 0.0964, 0.1298, 0.0787, 0.1469, 0.0551, 0.1574, 0.0520, 0.0199,
        0.1774])
[rfa agg] iter:  0, prev_obj_val: 54.480560302734375, obj_val: 57.23890686035156, abs dis: 2.7583465576171875
[rfa agg] iter: 0, weight: tensor([0.1234, 0.3691, 0.1355, 0.0832, 0.0841, 0.0317, 0.0780, 0.0260, 0.0060,
        0.0631])
[rfa agg] iter:  1, prev_obj_val: 57.23890686035156, obj_val: 61.00621032714844, abs dis: 3.767303466796875
[rfa agg] iter: 1, weight: tensor([0.1645, 0.4085, 0.0919, 0.0990, 0.0630, 0.0323, 0.0595, 0.0259, 0.0056,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 61.00621032714844, obj_val: 65.45829010009766, abs dis: 4.452079772949219
[rfa agg] iter: 2, weight: tensor([0.3143, 0.2041, 0.0786, 0.1628, 0.0580, 0.0409, 0.0555, 0.0318, 0.0064,
        0.0477])
[rfa agg] iter:  3, prev_obj_val: 65.45829010009766, obj_val: 68.15886688232422, abs dis: 2.7005767822265625
[rfa agg] iter: 3, weight: tensor([0.3206, 0.1086, 0.0581, 0.2999, 0.0452, 0.0456, 0.0437, 0.0337, 0.0061,
        0.0384])
[rfa agg] iter:  4, prev_obj_val: 68.15886688232422, obj_val: 77.76084899902344, abs dis: 9.601982116699219
[rfa agg] iter: 4, weight: tensor([0.2083, 0.0876, 0.0520, 0.4413, 0.0413, 0.0509, 0.0402, 0.0365, 0.0062,
        0.0357])
[rfa agg] iter:  5, prev_obj_val: 77.76084899902344, obj_val: 74.45453643798828, abs dis: 3.3063125610351562
[rfa agg] iter: 5, weight: tensor([0.1550, 0.0984, 0.0709, 0.2373, 0.0595, 0.1594, 0.0585, 0.0953, 0.0124,
        0.0533])
[rfa agg] iter:  6, prev_obj_val: 74.45453643798828, obj_val: 65.45608520507812, abs dis: 8.998451232910156
[rfa agg] iter: 6, weight: tensor([0.1721, 0.1003, 0.0685, 0.3003, 0.0565, 0.1135, 0.0554, 0.0728, 0.0106,
        0.0501])
[rfa agg] iter:  7, prev_obj_val: 65.45608520507812, obj_val: 71.21888732910156, abs dis: 5.7628021240234375
[rfa agg] iter: 7, weight: tensor([0.2846, 0.1068, 0.0576, 0.3398, 0.0448, 0.0453, 0.0434, 0.0335, 0.0061,
        0.0381])
[rfa agg] iter:  8, prev_obj_val: 71.21888732910156, obj_val: 68.12603759765625, abs dis: 3.0928497314453125
[rfa agg] iter: 8, weight: tensor([0.1824, 0.0925, 0.0593, 0.3961, 0.0480, 0.0739, 0.0469, 0.0507, 0.0081,
        0.0421])
[rfa agg] iter:  9, prev_obj_val: 68.12603759765625, obj_val: 74.46817779541016, abs dis: 6.342140197753906
[rfa agg] iter: 9, weight: tensor([0.1781, 0.0793, 0.0471, 0.5044, 0.0374, 0.0462, 0.0364, 0.0330, 0.0057,
        0.0323])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3634, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 4.7023, Accuracy: 162/9950 (1.6281%)
saving model
Done in 386.38581442832947 sec.
Server Epoch:45 choose agents : [4, 16, 34, 68, 62, 38, 61, 31, 86, 28].
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0585, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.0859, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   1, Avg loss: 0.0604, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  45, local model 16, internal_epoch   2, Avg loss: 0.0345, Accuracy: 433/708 (61.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6983, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   1, Avg loss: 0.0559, Accuracy: 367/1427 (25.7183%)
_Train Local_ResNet_18, epoch  45, local model 34, internal_epoch   2, Avg loss: 0.0319, Accuracy: 618/1427 (43.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6415, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0604, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0352, Accuracy: 468/1163 (40.2408%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2300, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 156/568 (27.4648%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0399, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0958, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0580, Accuracy: 287/1131 (25.3758%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0278, Accuracy: 561/1131 (49.6021%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3423, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3666, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   1, Avg loss: 0.0770, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  45, local model 31, internal_epoch   2, Avg loss: 0.0344, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3675, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0576, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0326, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9799, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0541, Accuracy: 403/1581 (25.4902%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0319, Accuracy: 656/1581 (41.4927%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8535, Accuracy: 97/10000 (0.9700%)
time spent on training: 177.69720482826233
[rfa agg] training data poison_ratio: 0.0  data num: [901, 708, 1427, 1163, 568, 1131, 85, 460, 1003, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 16, 34, 68, 62, 38, 61, 31, 86, 28], weight: tensor([0.0998, 0.0784, 0.1581, 0.1288, 0.0629, 0.1253, 0.0094, 0.0510, 0.1111,
        0.1751])
[rfa agg] iter:  0, prev_obj_val: 47.02912139892578, obj_val: 51.71192169189453, abs dis: 4.68280029296875
[rfa agg] iter: 0, weight: tensor([0.3364, 0.0697, 0.0534, 0.0860, 0.0284, 0.1096, 0.0020, 0.0197, 0.2475,
        0.0474])
[rfa agg] iter:  1, prev_obj_val: 51.71192169189453, obj_val: 56.94646453857422, abs dis: 5.2345428466796875
[rfa agg] iter: 1, weight: tensor([0.2983, 0.1301, 0.0608, 0.0884, 0.0436, 0.1066, 0.0027, 0.0294, 0.1849,
        0.0553])
[rfa agg] iter:  2, prev_obj_val: 56.94646453857422, obj_val: 56.92738342285156, abs dis: 0.01908111572265625
[rfa agg] iter: 2, weight: tensor([0.1873, 0.2663, 0.0618, 0.0836, 0.0613, 0.0971, 0.0034, 0.0398, 0.1422,
        0.0572])
[rfa agg] iter:  3, prev_obj_val: 56.92738342285156, obj_val: 56.92732620239258, abs dis: 5.7220458984375e-05
[rfa agg] iter: 3, weight: tensor([0.1829, 0.2760, 0.0612, 0.0828, 0.0608, 0.0962, 0.0033, 0.0395, 0.1406,
        0.0567])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3644, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.7248, Accuracy: 146/9950 (1.4673%)
saving model
Done in 340.59945464134216 sec.
Server Epoch:46 choose agents : [2, 0, 60, 15, 30, 66, 81, 95, 58, 17].
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0614, Accuracy: 223/605 (36.8595%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0374, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9562, Accuracy: 78/10000 (0.7800%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   1, Avg loss: 0.0571, Accuracy: 336/1657 (20.2776%)
_Train Local_ResNet_18, epoch  46, local model 0, internal_epoch   2, Avg loss: 0.0331, Accuracy: 575/1657 (34.7013%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0879, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   1, Avg loss: 0.0483, Accuracy: 701/2227 (31.4773%)
_Train Local_ResNet_18, epoch  46, local model 60, internal_epoch   2, Avg loss: 0.0267, Accuracy: 1085/2227 (48.7203%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4997, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0532, Accuracy: 354/1154 (30.6759%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 428/1154 (37.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.6968, Accuracy: 82/10000 (0.8200%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0737, Accuracy: 88/486 (18.1070%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0387, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2608, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   1, Avg loss: 0.0608, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  46, local model 66, internal_epoch   2, Avg loss: 0.0376, Accuracy: 421/1402 (30.0285%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9113, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   1, Avg loss: 0.0650, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  46, local model 81, internal_epoch   2, Avg loss: 0.0323, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0660, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 319/599 (53.2554%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.7168, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   1, Avg loss: 0.0592, Accuracy: 322/803 (40.0996%)
_Train Local_ResNet_18, epoch  46, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 384/803 (47.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.1101, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0492, Accuracy: 437/1574 (27.7637%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0255, Accuracy: 735/1574 (46.6963%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.3328, Accuracy: 104/10000 (1.0400%)
time spent on training: 241.1074481010437
[rfa agg] training data poison_ratio: 0.24306355819519546  data num: [605, 1657, 2227, 1154, 486, 1402, 774, 599, 803, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.07595736193599859
[rfa agg] init. name: [2, 0, 60, 15, 30, 66, 81, 95, 58, 17], weight: tensor([0.0536, 0.1469, 0.1974, 0.1023, 0.0431, 0.1243, 0.0686, 0.0531, 0.0712,
        0.1395])
[rfa agg] iter:  0, prev_obj_val: 69.70671081542969, obj_val: 71.08324432373047, abs dis: 1.3765335083007812
[rfa agg] iter: 0, weight: tensor([0.0227, 0.0797, 0.0472, 0.4829, 0.0150, 0.1531, 0.0435, 0.0225, 0.0451,
        0.0882])
[rfa agg] iter:  1, prev_obj_val: 71.08324432373047, obj_val: 72.8774185180664, abs dis: 1.7941741943359375
[rfa agg] iter: 1, weight: tensor([0.0226, 0.0699, 0.0429, 0.5365, 0.0147, 0.1239, 0.0444, 0.0224, 0.0462,
        0.0764])
[rfa agg] iter:  2, prev_obj_val: 72.8774185180664, obj_val: 74.7022476196289, abs dis: 1.8248291015625
[rfa agg] iter: 2, weight: tensor([0.0304, 0.0830, 0.0528, 0.4302, 0.0196, 0.1379, 0.0618, 0.0301, 0.0643,
        0.0899])
[rfa agg] iter:  3, prev_obj_val: 74.7022476196289, obj_val: 74.69758605957031, abs dis: 0.00466156005859375
[rfa agg] iter: 3, weight: tensor([0.0379, 0.0913, 0.0599, 0.3436, 0.0241, 0.1442, 0.0800, 0.0375, 0.0833,
        0.0982])
[rfa agg] iter:  4, prev_obj_val: 74.69758605957031, obj_val: 76.54741668701172, abs dis: 1.8498306274414062
[rfa agg] iter: 4, weight: tensor([0.0381, 0.0918, 0.0602, 0.3400, 0.0242, 0.1451, 0.0805, 0.0377, 0.0837,
        0.0987])
[rfa agg] iter:  5, prev_obj_val: 76.54741668701172, obj_val: 78.40674591064453, abs dis: 1.8593292236328125
[rfa agg] iter: 5, weight: tensor([0.0442, 0.0941, 0.0634, 0.2845, 0.0277, 0.1420, 0.0980, 0.0438, 0.1019,
        0.1004])
[rfa agg] iter:  6, prev_obj_val: 78.40674591064453, obj_val: 80.27515411376953, abs dis: 1.868408203125
[rfa agg] iter: 6, weight: tensor([0.0497, 0.0932, 0.0645, 0.2404, 0.0306, 0.1353, 0.1167, 0.0493, 0.1214,
        0.0989])
[rfa agg] iter:  7, prev_obj_val: 80.27515411376953, obj_val: 80.2742919921875, abs dis: 0.00086212158203125
[rfa agg] iter: 7, weight: tensor([0.0546, 0.0897, 0.0636, 0.2043, 0.0330, 0.1259, 0.1373, 0.0541, 0.1429,
        0.0947])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3624, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.7277, Accuracy: 163/9950 (1.6382%)
saving model
Done in 408.18139600753784 sec.
Server Epoch:47 choose agents : [80, 74, 96, 95, 41, 53, 13, 18, 70, 82].
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0672, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0371, Accuracy: 226/682 (33.1378%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1955, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0419, Accuracy: 473/1552 (30.4768%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 804/1552 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.1993, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   1, Avg loss: 0.0805, Accuracy: 20/311 (6.4309%)
_Train Local_ResNet_18, epoch  47, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.0344, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 321/599 (53.5893%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0317, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.2337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   1, Avg loss: 0.0585, Accuracy: 323/719 (44.9235%)
_Train Local_ResNet_18, epoch  47, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0975, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   1, Avg loss: 0.0475, Accuracy: 291/813 (35.7934%)
_Train Local_ResNet_18, epoch  47, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 482/813 (59.2866%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.6240, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0539, Accuracy: 403/1645 (24.4985%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 710/1645 (43.1611%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3107, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 109/530 (20.5660%)
_Train Local_ResNet_18, epoch  47, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9301, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   1, Avg loss: 0.0541, Accuracy: 430/1418 (30.3244%)
_Train Local_ResNet_18, epoch  47, local model 70, internal_epoch   2, Avg loss: 0.0292, Accuracy: 703/1418 (49.5769%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3599, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0726, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0471, Accuracy: 198/500 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4092, Accuracy: 72/10000 (0.7200%)
time spent on training: 200.83160138130188
[rfa agg] training data poison_ratio: 0.24529592884023263  data num: [682, 1552, 311, 599, 719, 813, 1645, 530, 1418, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0766549777625727
[rfa agg] init. name: [80, 74, 96, 95, 41, 53, 13, 18, 70, 82], weight: tensor([0.0778, 0.1770, 0.0355, 0.0683, 0.0820, 0.0927, 0.1876, 0.0604, 0.1617,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 65.91580200195312, obj_val: 67.2778549194336, abs dis: 1.3620529174804688
[rfa agg] iter: 0, weight: tensor([0.1068, 0.0979, 0.0196, 0.0754, 0.1473, 0.2466, 0.0942, 0.0556, 0.1116,
        0.0450])
[rfa agg] iter:  1, prev_obj_val: 67.2778549194336, obj_val: 73.06581115722656, abs dis: 5.787956237792969
[rfa agg] iter: 1, weight: tensor([0.0939, 0.0367, 0.0110, 0.0560, 0.1711, 0.4895, 0.0359, 0.0374, 0.0402,
        0.0283])
[rfa agg] iter:  2, prev_obj_val: 73.06581115722656, obj_val: 80.81322479248047, abs dis: 7.747413635253906
[rfa agg] iter: 2, weight: tensor([0.3436, 0.0310, 0.0145, 0.1493, 0.1678, 0.1124, 0.0306, 0.0717, 0.0330,
        0.0461])
[rfa agg] iter:  3, prev_obj_val: 80.81322479248047, obj_val: 83.9600830078125, abs dis: 3.1468582153320312
[rfa agg] iter: 3, weight: tensor([0.1339, 0.0303, 0.0209, 0.2721, 0.0848, 0.0695, 0.0301, 0.2303, 0.0318,
        0.0965])
[rfa agg] iter:  4, prev_obj_val: 83.9600830078125, obj_val: 83.93997955322266, abs dis: 0.02010345458984375
[rfa agg] iter: 4, weight: tensor([0.0937, 0.0274, 0.0219, 0.1595, 0.0662, 0.0569, 0.0273, 0.3886, 0.0286,
        0.1301])
[rfa agg] iter:  5, prev_obj_val: 83.93997955322266, obj_val: 87.46683502197266, abs dis: 3.52685546875
[rfa agg] iter: 5, weight: tensor([0.0846, 0.0248, 0.0198, 0.1415, 0.0598, 0.0515, 0.0247, 0.4492, 0.0259,
        0.1181])
[rfa agg] iter:  6, prev_obj_val: 87.46683502197266, obj_val: 91.1697998046875, abs dis: 3.7029647827148438
[rfa agg] iter: 6, weight: tensor([0.0864, 0.0304, 0.0286, 0.1240, 0.0652, 0.0579, 0.0303, 0.3010, 0.0316,
        0.2447])
[rfa agg] iter:  7, prev_obj_val: 91.1697998046875, obj_val: 91.14510345458984, abs dis: 0.02469635009765625
[rfa agg] iter: 7, weight: tensor([0.0718, 0.0292, 0.0330, 0.0937, 0.0567, 0.0517, 0.0292, 0.1603, 0.0302,
        0.4442])
[rfa agg] iter:  8, prev_obj_val: 91.14510345458984, obj_val: 87.4769515991211, abs dis: 3.66815185546875
[rfa agg] iter: 8, weight: tensor([0.0617, 0.0251, 0.0283, 0.0805, 0.0487, 0.0445, 0.0251, 0.1342, 0.0260,
        0.5259])
[rfa agg] iter:  9, prev_obj_val: 87.4769515991211, obj_val: 91.16102600097656, abs dis: 3.6840744018554688
[rfa agg] iter: 9, weight: tensor([0.0861, 0.0303, 0.0285, 0.1229, 0.0648, 0.0578, 0.0302, 0.2537, 0.0314,
        0.2943])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3610, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.7466, Accuracy: 138/9950 (1.3869%)
saving model
Done in 368.1647970676422 sec.
Server Epoch:48 choose agents : [55, 77, 34, 80, 27, 88, 59, 14, 45, 96].
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0537, Accuracy: 282/1071 (26.3305%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0275, Accuracy: 545/1071 (50.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6690, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   1, Avg loss: 0.0486, Accuracy: 368/1340 (27.4627%)
_Train Local_ResNet_18, epoch  48, local model 77, internal_epoch   2, Avg loss: 0.0254, Accuracy: 622/1340 (46.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.2200, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   1, Avg loss: 0.0553, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  48, local model 34, internal_epoch   2, Avg loss: 0.0321, Accuracy: 610/1427 (42.7470%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4553, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   1, Avg loss: 0.0661, Accuracy: 158/682 (23.1672%)
_Train Local_ResNet_18, epoch  48, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 254/682 (37.2434%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0383, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0549, Accuracy: 419/1587 (26.4020%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0328, Accuracy: 638/1587 (40.2016%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.6148, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0721, Accuracy: 152/603 (25.2073%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0443, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8087, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   1, Avg loss: 0.0567, Accuracy: 332/1089 (30.4867%)
_Train Local_ResNet_18, epoch  48, local model 59, internal_epoch   2, Avg loss: 0.0253, Accuracy: 529/1089 (48.5767%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4723, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   1, Avg loss: 0.0591, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  48, local model 14, internal_epoch   2, Avg loss: 0.0331, Accuracy: 385/1013 (38.0059%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.7193, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   1, Avg loss: 0.0637, Accuracy: 218/669 (32.5859%)
_Train Local_ResNet_18, epoch  48, local model 45, internal_epoch   2, Avg loss: 0.0373, Accuracy: 363/669 (54.2601%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9033, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 18/311 (5.7878%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.1269, Accuracy: 50/10000 (0.5000%)
time spent on training: 208.05114150047302
[rfa agg] training data poison_ratio: 0.109375  data num: [1071, 1340, 1427, 682, 1587, 603, 1089, 1013, 669, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0341796875
[rfa agg] init. name: [55, 77, 34, 80, 27, 88, 59, 14, 45, 96], weight: tensor([0.1094, 0.1368, 0.1457, 0.0696, 0.1621, 0.0616, 0.1112, 0.1035, 0.0683,
        0.0318])
[rfa agg] iter:  0, prev_obj_val: 45.156829833984375, obj_val: 49.32158660888672, abs dis: 4.164756774902344
[rfa agg] iter: 0, weight: tensor([0.2173, 0.0652, 0.0496, 0.0333, 0.0431, 0.0246, 0.1176, 0.4099, 0.0325,
        0.0069])
[rfa agg] iter:  1, prev_obj_val: 49.32158660888672, obj_val: 51.64632797241211, abs dis: 2.3247413635253906
[rfa agg] iter: 1, weight: tensor([0.1810, 0.0781, 0.0623, 0.0595, 0.0558, 0.0423, 0.1201, 0.3318, 0.0581,
        0.0110])
[rfa agg] iter:  2, prev_obj_val: 51.64632797241211, obj_val: 51.644039154052734, abs dis: 0.002288818359375
[rfa agg] iter: 2, weight: tensor([0.1713, 0.0843, 0.0686, 0.0792, 0.0620, 0.0548, 0.1224, 0.2667, 0.0772,
        0.0135])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3598, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 4.7786, Accuracy: 149/9950 (1.4975%)
saving model
Done in 367.8868384361267 sec.
Server Epoch:49 choose agents : [88, 4, 12, 21, 78, 65, 74, 41, 55, 2].
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   1, Avg loss: 0.0713, Accuracy: 151/603 (25.0415%)
_Train Local_ResNet_18, epoch  49, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0560, Accuracy: 348/901 (38.6238%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0329, Accuracy: 430/901 (47.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.1057, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   1, Avg loss: 0.0864, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  49, local model 12, internal_epoch   2, Avg loss: 0.0484, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.0507, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 670/1949 (34.3766%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6935, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   1, Avg loss: 0.0800, Accuracy: 56/416 (13.4615%)
_Train Local_ResNet_18, epoch  49, local model 78, internal_epoch   2, Avg loss: 0.0445, Accuracy: 224/416 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.2878, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0520, Accuracy: 441/1475 (29.8983%)
_Train Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0290, Accuracy: 688/1475 (46.6441%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6049, Accuracy: 102/10000 (1.0200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   1, Avg loss: 0.0414, Accuracy: 545/1552 (35.1160%)
_Train Local_ResNet_18, epoch  49, local model 74, internal_epoch   2, Avg loss: 0.0201, Accuracy: 815/1552 (52.5129%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.2618, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0592, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0288, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1775, Accuracy: 64/10000 (0.6400%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   1, Avg loss: 0.0525, Accuracy: 330/1071 (30.8123%)
_Train Local_ResNet_18, epoch  49, local model 55, internal_epoch   2, Avg loss: 0.0276, Accuracy: 522/1071 (48.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.7906, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0606, Accuracy: 243/605 (40.1653%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0378, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8642, Accuracy: 74/10000 (0.7400%)
time spent on training: 216.03621912002563
[rfa agg] training data poison_ratio: 0.2724062727178316  data num: [603, 901, 338, 1949, 416, 1475, 1552, 719, 1071, 605]
[rfa agg] considering poison per batch poison_fraction: 0.08512696022432237
[rfa agg] init. name: [88, 4, 12, 21, 78, 65, 74, 41, 55, 2], weight: tensor([0.0626, 0.0936, 0.0351, 0.2024, 0.0432, 0.1532, 0.1612, 0.0747, 0.1112,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 67.3373794555664, obj_val: 70.82861328125, abs dis: 3.4912338256835938
[rfa agg] iter: 0, weight: tensor([0.0334, 0.1446, 0.0122, 0.0599, 0.0165, 0.0932, 0.0856, 0.0538, 0.4673,
        0.0335])
[rfa agg] iter:  1, prev_obj_val: 70.82861328125, obj_val: 75.73011016845703, abs dis: 4.901496887207031
[rfa agg] iter: 1, weight: tensor([0.0405, 0.3896, 0.0132, 0.0466, 0.0182, 0.0639, 0.0604, 0.0741, 0.2529,
        0.0406])
[rfa agg] iter:  2, prev_obj_val: 75.73011016845703, obj_val: 73.8093032836914, abs dis: 1.920806884765625
[rfa agg] iter: 2, weight: tensor([0.0650, 0.3550, 0.0183, 0.0497, 0.0258, 0.0636, 0.0611, 0.1452, 0.1513,
        0.0650])
[rfa agg] iter:  3, prev_obj_val: 73.8093032836914, obj_val: 79.71306610107422, abs dis: 5.9037628173828125
[rfa agg] iter: 3, weight: tensor([0.0477, 0.4746, 0.0142, 0.0422, 0.0198, 0.0552, 0.0527, 0.0990, 0.1468,
        0.0478])
[rfa agg] iter:  4, prev_obj_val: 79.71306610107422, obj_val: 81.7064208984375, abs dis: 1.9933547973632812
[rfa agg] iter: 4, weight: tensor([0.0917, 0.2049, 0.0223, 0.0500, 0.0320, 0.0617, 0.0597, 0.2643, 0.1217,
        0.0917])
[rfa agg] iter:  5, prev_obj_val: 81.7064208984375, obj_val: 86.32215118408203, abs dis: 4.615730285644531
[rfa agg] iter: 5, weight: tensor([0.0965, 0.1428, 0.0211, 0.0427, 0.0306, 0.0518, 0.0503, 0.3730, 0.0952,
        0.0959])
[rfa agg] iter:  6, prev_obj_val: 86.32215118408203, obj_val: 88.93558502197266, abs dis: 2.613433837890625
[rfa agg] iter: 6, weight: tensor([0.1427, 0.0939, 0.0227, 0.0370, 0.0340, 0.0435, 0.0425, 0.3732, 0.0714,
        0.1390])
[rfa agg] iter:  7, prev_obj_val: 88.93558502197266, obj_val: 86.33069610595703, abs dis: 2.604888916015625
[rfa agg] iter: 7, weight: tensor([0.2121, 0.0851, 0.0258, 0.0373, 0.0395, 0.0433, 0.0423, 0.2459, 0.0677,
        0.2010])
[rfa agg] iter:  8, prev_obj_val: 86.33069610595703, obj_val: 88.93148803710938, abs dis: 2.6007919311523438
[rfa agg] iter: 8, weight: tensor([0.1487, 0.0967, 0.0234, 0.0381, 0.0351, 0.0448, 0.0437, 0.3503, 0.0735,
        0.1459])
[rfa agg] iter:  9, prev_obj_val: 88.93148803710938, obj_val: 86.33101654052734, abs dis: 2.6004714965820312
[rfa agg] iter: 9, weight: tensor([0.2128, 0.0852, 0.0258, 0.0373, 0.0395, 0.0433, 0.0423, 0.2441, 0.0677,
        0.2020])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3587, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.7856, Accuracy: 151/9950 (1.5176%)
saving model
Done in 382.6313388347626 sec.
Server Epoch:50 choose agents : [33, 43, 89, 10, 19, 73, 12, 23, 42, 52].
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 79/515 (15.3398%)
_Train Local_ResNet_18, epoch  50, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 165/515 (32.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4685, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   1, Avg loss: 0.0601, Accuracy: 290/946 (30.6554%)
_Train Local_ResNet_18, epoch  50, local model 43, internal_epoch   2, Avg loss: 0.0348, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5731, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   1, Avg loss: 0.0569, Accuracy: 351/896 (39.1741%)
_Train Local_ResNet_18, epoch  50, local model 89, internal_epoch   2, Avg loss: 0.0311, Accuracy: 471/896 (52.5670%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3013, Accuracy: 61/10000 (0.6100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   1, Avg loss: 0.0586, Accuracy: 220/861 (25.5517%)
_Train Local_ResNet_18, epoch  50, local model 10, internal_epoch   2, Avg loss: 0.0202, Accuracy: 476/861 (55.2846%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.3940, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   1, Avg loss: 0.0482, Accuracy: 412/1036 (39.7683%)
_Train Local_ResNet_18, epoch  50, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 683/1036 (65.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 12.5234, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   1, Avg loss: 0.0626, Accuracy: 199/938 (21.2154%)
_Train Local_ResNet_18, epoch  50, local model 73, internal_epoch   2, Avg loss: 0.0321, Accuracy: 354/938 (37.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9573, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  50, local model 12, internal_epoch   2, Avg loss: 0.0449, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.8814, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   1, Avg loss: 0.0637, Accuracy: 302/715 (42.2378%)
_Train Local_ResNet_18, epoch  50, local model 23, internal_epoch   2, Avg loss: 0.0357, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.1796, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0542, Accuracy: 304/1372 (22.1574%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0307, Accuracy: 519/1372 (37.8280%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6384, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0515, Accuracy: 306/636 (48.1132%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0271, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0235, Accuracy: 54/10000 (0.5400%)
time spent on training: 187.47988080978394
[rfa agg] training data poison_ratio: 0.10432569974554708  data num: [515, 946, 896, 861, 1036, 938, 338, 715, 1372, 636]
[rfa agg] considering poison per batch poison_fraction: 0.032601781170483464
[rfa agg] init. name: [33, 43, 89, 10, 19, 73, 12, 23, 42, 52], weight: tensor([0.0624, 0.1146, 0.1086, 0.1043, 0.1255, 0.1137, 0.0410, 0.0866, 0.1662,
        0.0771])
[rfa agg] iter:  0, prev_obj_val: 32.42165756225586, obj_val: 39.26522445678711, abs dis: 6.84356689453125
[rfa agg] iter: 0, weight: tensor([0.0341, 0.1209, 0.2045, 0.1914, 0.0684, 0.1188, 0.0129, 0.1526, 0.0406,
        0.0558])
[rfa agg] iter:  1, prev_obj_val: 39.26522445678711, obj_val: 41.981407165527344, abs dis: 2.7161827087402344
[rfa agg] iter: 1, weight: tensor([0.0666, 0.0882, 0.1162, 0.1109, 0.0620, 0.0873, 0.0203, 0.2725, 0.0431,
        0.1328])
[rfa agg] iter:  2, prev_obj_val: 41.981407165527344, obj_val: 44.81877517700195, abs dis: 2.8373680114746094
[rfa agg] iter: 2, weight: tensor([0.0870, 0.0821, 0.1030, 0.0985, 0.0604, 0.0813, 0.0237, 0.2169, 0.0437,
        0.2034])
[rfa agg] iter:  3, prev_obj_val: 44.81877517700195, obj_val: 47.80596923828125, abs dis: 2.987194061279297
[rfa agg] iter: 3, weight: tensor([0.1075, 0.0695, 0.0842, 0.0806, 0.0529, 0.0688, 0.0250, 0.1470, 0.0397,
        0.3247])
[rfa agg] iter:  4, prev_obj_val: 47.80596923828125, obj_val: 51.20652389526367, abs dis: 3.400554656982422
[rfa agg] iter: 4, weight: tensor([0.1219, 0.0507, 0.0598, 0.0572, 0.0398, 0.0502, 0.0227, 0.0916, 0.0308,
        0.4754])
[rfa agg] iter:  5, prev_obj_val: 51.20652389526367, obj_val: 54.830360412597656, abs dis: 3.6238365173339844
[rfa agg] iter: 5, weight: tensor([0.2181, 0.0545, 0.0629, 0.0603, 0.0439, 0.0540, 0.0307, 0.0880, 0.0349,
        0.3526])
[rfa agg] iter:  6, prev_obj_val: 54.830360412597656, obj_val: 58.719093322753906, abs dis: 3.88873291015625
[rfa agg] iter: 6, weight: tensor([0.3665, 0.0541, 0.0614, 0.0588, 0.0445, 0.0536, 0.0386, 0.0800, 0.0363,
        0.2062])
[rfa agg] iter:  7, prev_obj_val: 58.719093322753906, obj_val: 58.718414306640625, abs dis: 0.00067901611328125
[rfa agg] iter: 7, weight: tensor([0.3443, 0.0606, 0.0678, 0.0650, 0.0509, 0.0601, 0.0560, 0.0836, 0.0424,
        0.1693])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3574, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 4.7732, Accuracy: 198/9950 (1.9899%)
saving model
Saving model on epoch 50
Done in 354.6394748687744 sec.
Server Epoch:51 choose agents : [87, 56, 68, 6, 65, 8, 42, 76, 52, 45].
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  51, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 437/1131 (38.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3149, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0842, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.4270, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   1, Avg loss: 0.0591, Accuracy: 374/1163 (32.1582%)
_Train Local_ResNet_18, epoch  51, local model 68, internal_epoch   2, Avg loss: 0.0357, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7885, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0528, Accuracy: 424/1956 (21.6769%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0299, Accuracy: 722/1956 (36.9121%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3512, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   1, Avg loss: 0.0526, Accuracy: 427/1475 (28.9492%)
_Train Local_ResNet_18, epoch  51, local model 65, internal_epoch   2, Avg loss: 0.0302, Accuracy: 721/1475 (48.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7158, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0572, Accuracy: 320/1513 (21.1500%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0345, Accuracy: 534/1513 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2649, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0542, Accuracy: 313/1372 (22.8134%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 530/1372 (38.6297%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8807, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0804, Accuracy: 70/466 (15.0215%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0448, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   1, Avg loss: 0.0507, Accuracy: 316/636 (49.6855%)
_Train Local_ResNet_18, epoch  51, local model 52, internal_epoch   2, Avg loss: 0.0266, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7389, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   1, Avg loss: 0.0636, Accuracy: 225/669 (33.6323%)
_Train Local_ResNet_18, epoch  51, local model 45, internal_epoch   2, Avg loss: 0.0369, Accuracy: 360/669 (53.8117%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.4250, Accuracy: 87/10000 (0.8700%)
time spent on training: 209.8940281867981
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 186, 1163, 1956, 1475, 1513, 1372, 466, 636, 669]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 56, 68, 6, 65, 8, 42, 76, 52, 45], weight: tensor([0.1070, 0.0176, 0.1101, 0.1851, 0.1396, 0.1432, 0.1298, 0.0441, 0.0602,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 56.2114372253418, obj_val: 58.031089782714844, abs dis: 1.8196525573730469
[rfa agg] iter: 0, weight: tensor([0.3363, 0.0031, 0.3300, 0.0403, 0.0682, 0.0703, 0.0981, 0.0115, 0.0193,
        0.0229])
[rfa agg] iter:  1, prev_obj_val: 58.031089782714844, obj_val: 63.14986038208008, abs dis: 5.118770599365234
[rfa agg] iter: 1, weight: tensor([0.4887, 0.0029, 0.2325, 0.0346, 0.0558, 0.0575, 0.0770, 0.0107, 0.0183,
        0.0219])
[rfa agg] iter:  2, prev_obj_val: 63.14986038208008, obj_val: 65.88406372070312, abs dis: 2.734203338623047
[rfa agg] iter: 2, weight: tensor([0.3888, 0.0049, 0.2043, 0.0517, 0.0772, 0.0795, 0.0999, 0.0192, 0.0336,
        0.0410])
[rfa agg] iter:  3, prev_obj_val: 65.88406372070312, obj_val: 63.14329528808594, abs dis: 2.7407684326171875
[rfa agg] iter: 3, weight: tensor([0.3225, 0.0062, 0.2013, 0.0603, 0.0873, 0.0898, 0.1102, 0.0245, 0.0437,
        0.0541])
[rfa agg] iter:  4, prev_obj_val: 63.14329528808594, obj_val: 65.88340759277344, abs dis: 2.7401123046875
[rfa agg] iter: 4, weight: tensor([0.3783, 0.0050, 0.2078, 0.0525, 0.0785, 0.0808, 0.1017, 0.0195, 0.0341,
        0.0417])
[rfa agg] iter:  5, prev_obj_val: 65.88340759277344, obj_val: 63.14332962036133, abs dis: 2.7400779724121094
[rfa agg] iter: 5, weight: tensor([0.3221, 0.0062, 0.2015, 0.0604, 0.0874, 0.0899, 0.1103, 0.0245, 0.0437,
        0.0541])
[rfa agg] iter:  6, prev_obj_val: 63.14332962036133, obj_val: 65.88340759277344, abs dis: 2.7400779724121094
[rfa agg] iter: 6, weight: tensor([0.3782, 0.0050, 0.2078, 0.0525, 0.0785, 0.0808, 0.1017, 0.0195, 0.0341,
        0.0418])
[rfa agg] iter:  7, prev_obj_val: 65.88340759277344, obj_val: 63.14332962036133, abs dis: 2.7400779724121094
[rfa agg] iter: 7, weight: tensor([0.3221, 0.0062, 0.2015, 0.0604, 0.0874, 0.0899, 0.1103, 0.0245, 0.0437,
        0.0541])
[rfa agg] iter:  8, prev_obj_val: 63.14332962036133, obj_val: 65.88340759277344, abs dis: 2.7400779724121094
[rfa agg] iter: 8, weight: tensor([0.3782, 0.0050, 0.2078, 0.0525, 0.0785, 0.0808, 0.1017, 0.0195, 0.0341,
        0.0418])
[rfa agg] iter:  9, prev_obj_val: 65.88340759277344, obj_val: 63.14332962036133, abs dis: 2.7400779724121094
[rfa agg] iter: 9, weight: tensor([0.3221, 0.0062, 0.2015, 0.0604, 0.0874, 0.0899, 0.1103, 0.0245, 0.0437,
        0.0541])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3555, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.7715, Accuracy: 290/9950 (2.9146%)
saving model
Done in 372.3973264694214 sec.
Server Epoch:52 choose agents : [5, 61, 23, 36, 64, 45, 13, 77, 7, 99].
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   1, Avg loss: 0.0488, Accuracy: 423/1628 (25.9828%)
_Train Local_ResNet_18, epoch  52, local model 5, internal_epoch   2, Avg loss: 0.0239, Accuracy: 901/1628 (55.3440%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4163, Accuracy: 148/10000 (1.4800%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3589, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   1, Avg loss: 0.0595, Accuracy: 302/715 (42.2378%)
_Train Local_ResNet_18, epoch  52, local model 23, internal_epoch   2, Avg loss: 0.0367, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.2815, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   1, Avg loss: 0.0826, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  52, local model 36, internal_epoch   2, Avg loss: 0.0487, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.9412, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   1, Avg loss: 0.0614, Accuracy: 196/953 (20.5666%)
_Train Local_ResNet_18, epoch  52, local model 64, internal_epoch   2, Avg loss: 0.0367, Accuracy: 323/953 (33.8930%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9095, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   1, Avg loss: 0.0644, Accuracy: 213/669 (31.8386%)
_Train Local_ResNet_18, epoch  52, local model 45, internal_epoch   2, Avg loss: 0.0363, Accuracy: 363/669 (54.2601%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6117, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0536, Accuracy: 404/1645 (24.5593%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 694/1645 (42.1884%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2644, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   1, Avg loss: 0.0481, Accuracy: 371/1340 (27.6866%)
_Train Local_ResNet_18, epoch  52, local model 77, internal_epoch   2, Avg loss: 0.0258, Accuracy: 581/1340 (43.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8902, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 424/891 (47.5870%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.7843, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   1, Avg loss: 0.0572, Accuracy: 245/773 (31.6947%)
_Train Local_ResNet_18, epoch  52, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 444/773 (57.4386%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4813, Accuracy: 77/10000 (0.7700%)
time spent on training: 198.13173985481262
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 85, 715, 408, 953, 669, 1645, 1340, 891, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 61, 23, 36, 64, 45, 13, 77, 7, 99], weight: tensor([0.1788, 0.0093, 0.0785, 0.0448, 0.1046, 0.0735, 0.1806, 0.1471, 0.0978,
        0.0849])
[rfa agg] iter:  0, prev_obj_val: 55.04802703857422, obj_val: 56.45880126953125, abs dis: 1.4107742309570312
[rfa agg] iter: 0, weight: tensor([0.0808, 0.0028, 0.0743, 0.0203, 0.2785, 0.0573, 0.0816, 0.1380, 0.1640,
        0.1026])
[rfa agg] iter:  1, prev_obj_val: 56.45880126953125, obj_val: 59.33345413208008, abs dis: 2.874652862548828
[rfa agg] iter: 1, weight: tensor([0.0343, 0.0017, 0.0672, 0.0132, 0.3383, 0.0459, 0.0347, 0.0496, 0.2993,
        0.1158])
[rfa agg] iter:  2, prev_obj_val: 59.33345413208008, obj_val: 63.81300354003906, abs dis: 4.479549407958984
[rfa agg] iter: 2, weight: tensor([0.0313, 0.0018, 0.1052, 0.0151, 0.1475, 0.0628, 0.0316, 0.0426, 0.3266,
        0.2356])
[rfa agg] iter:  3, prev_obj_val: 63.81300354003906, obj_val: 69.6688232421875, abs dis: 5.8558197021484375
[rfa agg] iter: 3, weight: tensor([0.0317, 0.0021, 0.2335, 0.0195, 0.0983, 0.1101, 0.0320, 0.0412, 0.1513,
        0.2803])
[rfa agg] iter:  4, prev_obj_val: 69.6688232421875, obj_val: 76.79341888427734, abs dis: 7.124595642089844
[rfa agg] iter: 4, weight: tensor([0.0324, 0.0026, 0.2783, 0.0261, 0.0778, 0.2672, 0.0327, 0.0406, 0.1011,
        0.1412])
[rfa agg] iter:  5, prev_obj_val: 76.79341888427734, obj_val: 69.64606475830078, abs dis: 7.1473541259765625
[rfa agg] iter: 5, weight: tensor([0.0389, 0.0037, 0.1679, 0.0430, 0.0779, 0.3775, 0.0393, 0.0471, 0.0934,
        0.1114])
[rfa agg] iter:  6, prev_obj_val: 69.64606475830078, obj_val: 73.03057098388672, abs dis: 3.3845062255859375
[rfa agg] iter: 6, weight: tensor([0.0312, 0.0025, 0.2619, 0.0252, 0.0749, 0.3040, 0.0316, 0.0391, 0.0971,
        0.1326])
[rfa agg] iter:  7, prev_obj_val: 73.03057098388672, obj_val: 76.78296661376953, abs dis: 3.7523956298828125
[rfa agg] iter: 7, weight: tensor([0.0297, 0.0026, 0.1747, 0.0278, 0.0646, 0.4527, 0.0300, 0.0365, 0.0801,
        0.1012])
[rfa agg] iter:  8, prev_obj_val: 76.78296661376953, obj_val: 80.69581604003906, abs dis: 3.9128494262695312
[rfa agg] iter: 8, weight: tensor([0.0374, 0.0036, 0.1589, 0.0413, 0.0749, 0.4042, 0.0378, 0.0453, 0.0897,
        0.1069])
[rfa agg] iter:  9, prev_obj_val: 80.69581604003906, obj_val: 73.02970886230469, abs dis: 7.666107177734375
[rfa agg] iter: 9, weight: tensor([0.0481, 0.0050, 0.1627, 0.0639, 0.0897, 0.3002, 0.0486, 0.0575, 0.1046,
        0.1195])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3549, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.7555, Accuracy: 335/9950 (3.3668%)
saving model
Done in 361.8915283679962 sec.
Server Epoch:53 choose agents : [96, 36, 89, 65, 62, 19, 45, 1, 34, 33].
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   1, Avg loss: 0.0796, Accuracy: 31/311 (9.9678%)
_Train Local_ResNet_18, epoch  53, local model 96, internal_epoch   2, Avg loss: 0.0524, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.2839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   1, Avg loss: 0.0821, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  53, local model 36, internal_epoch   2, Avg loss: 0.0481, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.1211, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   1, Avg loss: 0.0566, Accuracy: 355/896 (39.6205%)
_Train Local_ResNet_18, epoch  53, local model 89, internal_epoch   2, Avg loss: 0.0316, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.1512, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   1, Avg loss: 0.0527, Accuracy: 451/1475 (30.5763%)
_Train Local_ResNet_18, epoch  53, local model 65, internal_epoch   2, Avg loss: 0.0282, Accuracy: 721/1475 (48.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8236, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3094, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 406/1036 (39.1892%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 679/1036 (65.5405%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.1419, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   1, Avg loss: 0.0617, Accuracy: 242/669 (36.1734%)
_Train Local_ResNet_18, epoch  53, local model 45, internal_epoch   2, Avg loss: 0.0370, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.7488, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0544, Accuracy: 311/928 (33.5129%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0226, Accuracy: 613/928 (66.0560%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9609, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   1, Avg loss: 0.0550, Accuracy: 433/1427 (30.3434%)
_Train Local_ResNet_18, epoch  53, local model 34, internal_epoch   2, Avg loss: 0.0322, Accuracy: 617/1427 (43.2376%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6141, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 96/515 (18.6408%)
_Train Local_ResNet_18, epoch  53, local model 33, internal_epoch   2, Avg loss: 0.0492, Accuracy: 141/515 (27.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.8236, Accuracy: 75/10000 (0.7500%)
time spent on training: 185.02033615112305
[rfa agg] training data poison_ratio: 0.0  data num: [311, 408, 896, 1475, 568, 1036, 669, 928, 1427, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 36, 89, 65, 62, 19, 45, 1, 34, 33], weight: tensor([0.0378, 0.0496, 0.1088, 0.1792, 0.0690, 0.1258, 0.0813, 0.1127, 0.1733,
        0.0626])
[rfa agg] iter:  0, prev_obj_val: 49.92303466796875, obj_val: 56.31532287597656, abs dis: 6.3922882080078125
[rfa agg] iter: 0, weight: tensor([0.0112, 0.0189, 0.3900, 0.0476, 0.0367, 0.1085, 0.0707, 0.2320, 0.0512,
        0.0332])
[rfa agg] iter:  1, prev_obj_val: 56.31532287597656, obj_val: 58.086055755615234, abs dis: 1.7707328796386719
[rfa agg] iter: 1, weight: tensor([0.0199, 0.0364, 0.1937, 0.0548, 0.0837, 0.0916, 0.2525, 0.1342, 0.0579,
        0.0754])
[rfa agg] iter:  2, prev_obj_val: 58.086055755615234, obj_val: 60.030521392822266, abs dis: 1.9444656372070312
[rfa agg] iter: 2, weight: tensor([0.0187, 0.0354, 0.1358, 0.0461, 0.0879, 0.0732, 0.3738, 0.1016, 0.0485,
        0.0790])
[rfa agg] iter:  3, prev_obj_val: 60.030521392822266, obj_val: 64.85829162597656, abs dis: 4.827770233154297
[rfa agg] iter: 3, weight: tensor([0.0160, 0.0314, 0.0899, 0.0350, 0.0859, 0.0530, 0.5048, 0.0705, 0.0367,
        0.0769])
[rfa agg] iter:  4, prev_obj_val: 64.85829162597656, obj_val: 70.13787078857422, abs dis: 5.279579162597656
[rfa agg] iter: 4, weight: tensor([0.0242, 0.0525, 0.0859, 0.0410, 0.2013, 0.0575, 0.2488, 0.0716, 0.0428,
        0.1744])
[rfa agg] iter:  5, prev_obj_val: 70.13787078857422, obj_val: 70.0646743774414, abs dis: 0.0731964111328125
[rfa agg] iter: 5, weight: tensor([0.0189, 0.0487, 0.0432, 0.0239, 0.4121, 0.0314, 0.0790, 0.0373, 0.0247,
        0.2809])
[rfa agg] iter:  6, prev_obj_val: 70.0646743774414, obj_val: 84.5903091430664, abs dis: 14.525634765625
[rfa agg] iter: 6, weight: tensor([0.0150, 0.0388, 0.0343, 0.0190, 0.4766, 0.0250, 0.0619, 0.0296, 0.0197,
        0.2801])
[rfa agg] iter:  7, prev_obj_val: 84.5903091430664, obj_val: 80.78059387207031, abs dis: 3.8097152709960938
[rfa agg] iter: 7, weight: tensor([0.0628, 0.4349, 0.0523, 0.0356, 0.1161, 0.0424, 0.0679, 0.0474, 0.0366,
        0.1042])
[rfa agg] iter:  8, prev_obj_val: 80.78059387207031, obj_val: 84.53047180175781, abs dis: 3.7498779296875
[rfa agg] iter: 8, weight: tensor([0.0536, 0.3236, 0.0594, 0.0387, 0.1604, 0.0471, 0.0817, 0.0533, 0.0398,
        0.1424])
[rfa agg] iter:  9, prev_obj_val: 84.53047180175781, obj_val: 80.78620147705078, abs dis: 3.7442703247070312
[rfa agg] iter: 9, weight: tensor([0.0529, 0.5277, 0.0438, 0.0298, 0.0965, 0.0355, 0.0569, 0.0397, 0.0306,
        0.0866])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3552, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 4.7528, Accuracy: 306/9950 (3.0754%)
saving model
Done in 350.2243001461029 sec.
Server Epoch:54 choose agents : [47, 28, 66, 55, 29, 52, 42, 8, 17, 23].
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1162, Accuracy: 4/134 (2.9851%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1025, Accuracy: 32/134 (23.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.4043, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0534, Accuracy: 454/1581 (28.7160%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 626/1581 (39.5952%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8695, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0599, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0369, Accuracy: 426/1402 (30.3852%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8441, Accuracy: 75/10000 (0.7500%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   1, Avg loss: 0.0511, Accuracy: 325/1071 (30.3455%)
_Train Local_ResNet_18, epoch  54, local model 55, internal_epoch   2, Avg loss: 0.0277, Accuracy: 531/1071 (49.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.8980, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   1, Avg loss: 0.0505, Accuracy: 420/1440 (29.1667%)
_Train Local_ResNet_18, epoch  54, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 707/1440 (49.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5440, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0501, Accuracy: 323/636 (50.7862%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0269, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1560, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   1, Avg loss: 0.0543, Accuracy: 331/1372 (24.1254%)
_Train Local_ResNet_18, epoch  54, local model 42, internal_epoch   2, Avg loss: 0.0304, Accuracy: 538/1372 (39.2128%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6895, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0567, Accuracy: 331/1513 (21.8771%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0345, Accuracy: 561/1513 (37.0787%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0856, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   1, Avg loss: 0.0492, Accuracy: 477/1574 (30.3050%)
_Train Local_ResNet_18, epoch  54, local model 17, internal_epoch   2, Avg loss: 0.0253, Accuracy: 720/1574 (45.7433%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6372, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 312/715 (43.6364%)
_Train Local_ResNet_18, epoch  54, local model 23, internal_epoch   2, Avg loss: 0.0368, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.1801, Accuracy: 78/10000 (0.7800%)
time spent on training: 223.23911881446838
[rfa agg] training data poison_ratio: 0.09363525091799266  data num: [134, 1581, 1402, 1071, 1440, 636, 1372, 1513, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.029261015911872704
[rfa agg] init. name: [47, 28, 66, 55, 29, 52, 42, 8, 17, 23], weight: tensor([0.0117, 0.1382, 0.1226, 0.0936, 0.1259, 0.0556, 0.1200, 0.1323, 0.1376,
        0.0625])
[rfa agg] iter:  0, prev_obj_val: 44.208412170410156, obj_val: 44.196876525878906, abs dis: 0.01153564453125
[rfa agg] iter: 0, weight: tensor([0.0031, 0.0953, 0.1651, 0.1822, 0.1282, 0.0257, 0.1599, 0.1084, 0.0950,
        0.0370])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3541, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 4.7852, Accuracy: 187/9950 (1.8794%)
saving model
Done in 384.99052023887634 sec.
Server Epoch:55 choose agents : [40, 73, 17, 94, 50, 89, 8, 7, 99, 58].
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   1, Avg loss: 0.0559, Accuracy: 378/1573 (24.0305%)
_Train Local_ResNet_18, epoch  55, local model 40, internal_epoch   2, Avg loss: 0.0338, Accuracy: 627/1573 (39.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7983, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0627, Accuracy: 201/938 (21.4286%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0321, Accuracy: 361/938 (38.4861%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.6286, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   1, Avg loss: 0.0485, Accuracy: 440/1574 (27.9543%)
_Train Local_ResNet_18, epoch  55, local model 17, internal_epoch   2, Avg loss: 0.0253, Accuracy: 746/1574 (47.3952%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8751, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 357/1662 (21.4801%)
_Train Local_ResNet_18, epoch  55, local model 94, internal_epoch   2, Avg loss: 0.0318, Accuracy: 649/1662 (39.0493%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4805, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   1, Avg loss: 0.0596, Accuracy: 190/809 (23.4858%)
_Train Local_ResNet_18, epoch  55, local model 50, internal_epoch   2, Avg loss: 0.0249, Accuracy: 405/809 (50.0618%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3697, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0569, Accuracy: 360/896 (40.1786%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0319, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.3261, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   1, Avg loss: 0.0559, Accuracy: 339/1513 (22.4058%)
_Train Local_ResNet_18, epoch  55, local model 8, internal_epoch   2, Avg loss: 0.0345, Accuracy: 556/1513 (36.7482%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7327, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   1, Avg loss: 0.0516, Accuracy: 360/891 (40.4040%)
_Train Local_ResNet_18, epoch  55, local model 7, internal_epoch   2, Avg loss: 0.0241, Accuracy: 474/891 (53.1987%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.6845, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0585, Accuracy: 246/773 (31.8241%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 399/773 (51.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.8584, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0591, Accuracy: 326/803 (40.5978%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.2510, Accuracy: 74/10000 (0.7400%)
time spent on training: 232.21558475494385
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 938, 1574, 1662, 809, 896, 1513, 891, 773, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 73, 17, 94, 50, 89, 8, 7, 99, 58], weight: tensor([0.1376, 0.0821, 0.1377, 0.1454, 0.0708, 0.0784, 0.1323, 0.0779, 0.0676,
        0.0702])
[rfa agg] iter:  0, prev_obj_val: 53.346126556396484, obj_val: 54.36306381225586, abs dis: 1.016937255859375
[rfa agg] iter: 0, weight: tensor([0.0813, 0.1854, 0.0815, 0.0766, 0.0831, 0.1208, 0.0890, 0.1204, 0.0795,
        0.0824])
[rfa agg] iter:  1, prev_obj_val: 54.36306381225586, obj_val: 60.96438217163086, abs dis: 6.601318359375
[rfa agg] iter: 1, weight: tensor([0.0551, 0.2609, 0.0552, 0.0525, 0.0836, 0.1353, 0.0594, 0.1349, 0.0800,
        0.0830])
[rfa agg] iter:  2, prev_obj_val: 60.96438217163086, obj_val: 60.908023834228516, abs dis: 0.05635833740234375
[rfa agg] iter: 2, weight: tensor([0.0214, 0.0933, 0.0214, 0.0208, 0.1550, 0.1795, 0.0225, 0.1788, 0.1506,
        0.1566])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3539, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 4.7516, Accuracy: 291/9950 (2.9246%)
saving model
Done in 391.77135825157166 sec.
Server Epoch:56 choose agents : [93, 82, 17, 59, 84, 14, 65, 13, 28, 10].
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   1, Avg loss: 0.0540, Accuracy: 469/1742 (26.9231%)
_Train Local_ResNet_18, epoch  56, local model 93, internal_epoch   2, Avg loss: 0.0308, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6657, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0712, Accuracy: 101/500 (20.2000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0471, Accuracy: 214/500 (42.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3149, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0486, Accuracy: 476/1574 (30.2414%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0252, Accuracy: 746/1574 (47.3952%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8087, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   1, Avg loss: 0.0500, Accuracy: 351/1089 (32.2314%)
_Train Local_ResNet_18, epoch  56, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 499/1089 (45.8219%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 15.1076, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0591, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0307, Accuracy: 474/1190 (39.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2011, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   1, Avg loss: 0.0579, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  56, local model 14, internal_epoch   2, Avg loss: 0.0321, Accuracy: 408/1013 (40.2764%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.9786, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0516, Accuracy: 423/1475 (28.6780%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0283, Accuracy: 754/1475 (51.1186%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8693, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0534, Accuracy: 405/1645 (24.6201%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 705/1645 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3857, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   1, Avg loss: 0.0536, Accuracy: 425/1581 (26.8817%)
_Train Local_ResNet_18, epoch  56, local model 28, internal_epoch   2, Avg loss: 0.0318, Accuracy: 670/1581 (42.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6525, Accuracy: 102/10000 (1.0200%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  56, local model 10, internal_epoch   2, Avg loss: 0.0201, Accuracy: 472/861 (54.8200%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.1438, Accuracy: 106/10000 (1.0600%)
time spent on training: 249.95690870285034
[rfa agg] training data poison_ratio: 0.06795580110497237  data num: [1742, 500, 1574, 1089, 1190, 1013, 1475, 1645, 1581, 861]
[rfa agg] considering poison per batch poison_fraction: 0.021236187845303865
[rfa agg] init. name: [93, 82, 17, 59, 84, 14, 65, 13, 28, 10], weight: tensor([0.1375, 0.0395, 0.1242, 0.0860, 0.0939, 0.0800, 0.1164, 0.1298, 0.1248,
        0.0680])
[rfa agg] iter:  0, prev_obj_val: 47.62356185913086, obj_val: 53.137508392333984, abs dis: 5.513946533203125
[rfa agg] iter: 0, weight: tensor([0.0569, 0.0121, 0.0790, 0.1623, 0.3283, 0.0795, 0.0894, 0.0701, 0.0791,
        0.0433])
[rfa agg] iter:  1, prev_obj_val: 53.137508392333984, obj_val: 64.00474548339844, abs dis: 10.867237091064453
[rfa agg] iter: 1, weight: tensor([0.0447, 0.0129, 0.0574, 0.2778, 0.2574, 0.1231, 0.0623, 0.0526, 0.0576,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 64.00474548339844, obj_val: 60.9397087097168, abs dis: 3.0650367736816406
[rfa agg] iter: 2, weight: tensor([0.0396, 0.0171, 0.0476, 0.1369, 0.1055, 0.4033, 0.0500, 0.0448, 0.0478,
        0.1073])
[rfa agg] iter:  3, prev_obj_val: 60.9397087097168, obj_val: 60.93824005126953, abs dis: 0.001468658447265625
[rfa agg] iter: 3, weight: tensor([0.0390, 0.0152, 0.0476, 0.1543, 0.1160, 0.4002, 0.0503, 0.0446, 0.0477,
        0.0851])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3531, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 4.7608, Accuracy: 264/9950 (2.6533%)
saving model
Done in 412.5182740688324 sec.
Server Epoch:57 choose agents : [43, 89, 50, 55, 94, 77, 48, 34, 27, 7].
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 289/946 (30.5497%)
_Train Local_ResNet_18, epoch  57, local model 43, internal_epoch   2, Avg loss: 0.0345, Accuracy: 343/946 (36.2579%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6986, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0550, Accuracy: 367/896 (40.9598%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0314, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   1, Avg loss: 0.0583, Accuracy: 188/809 (23.2386%)
_Train Local_ResNet_18, epoch  57, local model 50, internal_epoch   2, Avg loss: 0.0256, Accuracy: 386/809 (47.7132%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4760, Accuracy: 109/10000 (1.0900%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0517, Accuracy: 343/1071 (32.0261%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0270, Accuracy: 544/1071 (50.7937%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8098, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 369/1662 (22.2022%)
_Train Local_ResNet_18, epoch  57, local model 94, internal_epoch   2, Avg loss: 0.0317, Accuracy: 675/1662 (40.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.7576, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   1, Avg loss: 0.0489, Accuracy: 363/1340 (27.0896%)
_Train Local_ResNet_18, epoch  57, local model 77, internal_epoch   2, Avg loss: 0.0256, Accuracy: 591/1340 (44.1045%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.4664, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0699, Accuracy: 145/631 (22.9794%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0398, Accuracy: 253/631 (40.0951%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3572, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0547, Accuracy: 428/1427 (29.9930%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0319, Accuracy: 619/1427 (43.3777%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0569, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   1, Avg loss: 0.0544, Accuracy: 443/1587 (27.9143%)
_Train Local_ResNet_18, epoch  57, local model 27, internal_epoch   2, Avg loss: 0.0325, Accuracy: 650/1587 (40.9578%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7928, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0511, Accuracy: 372/891 (41.7508%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8033, Accuracy: 66/10000 (0.6600%)
time spent on training: 247.2240331172943
[rfa agg] training data poison_ratio: 0.09511545293072825  data num: [946, 896, 809, 1071, 1662, 1340, 631, 1427, 1587, 891]
[rfa agg] considering poison per batch poison_fraction: 0.029723579040852578
[rfa agg] init. name: [43, 89, 50, 55, 94, 77, 48, 34, 27, 7], weight: tensor([0.0840, 0.0796, 0.0718, 0.0951, 0.1476, 0.1190, 0.0560, 0.1267, 0.1409,
        0.0791])
[rfa agg] iter:  0, prev_obj_val: 45.97300720214844, obj_val: 50.67354965209961, abs dis: 4.700542449951172
[rfa agg] iter: 0, weight: tensor([0.1223, 0.0789, 0.0541, 0.3862, 0.0498, 0.0886, 0.0243, 0.0638, 0.0534,
        0.0786])
[rfa agg] iter:  1, prev_obj_val: 50.67354965209961, obj_val: 57.574928283691406, abs dis: 6.901378631591797
[rfa agg] iter: 1, weight: tensor([0.3059, 0.1588, 0.0831, 0.1124, 0.0326, 0.0478, 0.0272, 0.0384, 0.0343,
        0.1595])
[rfa agg] iter:  2, prev_obj_val: 57.574928283691406, obj_val: 60.870540618896484, abs dis: 3.295612335205078
[rfa agg] iter: 2, weight: tensor([0.1209, 0.2273, 0.2007, 0.0601, 0.0267, 0.0357, 0.0358, 0.0301, 0.0277,
        0.2350])
[rfa agg] iter:  3, prev_obj_val: 60.870540618896484, obj_val: 68.40711212158203, abs dis: 7.536571502685547
[rfa agg] iter: 3, weight: tensor([0.1004, 0.1732, 0.3226, 0.0582, 0.0283, 0.0369, 0.0458, 0.0315, 0.0292,
        0.1739])
[rfa agg] iter:  4, prev_obj_val: 68.40711212158203, obj_val: 52.39861297607422, abs dis: 16.008499145507812
[rfa agg] iter: 4, weight: tensor([0.1052, 0.1462, 0.2503, 0.0722, 0.0404, 0.0505, 0.1039, 0.0441, 0.0415,
        0.1457])
[rfa agg] iter:  5, prev_obj_val: 52.39861297607422, obj_val: 60.90515899658203, abs dis: 8.506546020507812
[rfa agg] iter: 5, weight: tensor([0.2295, 0.2200, 0.0984, 0.0788, 0.0277, 0.0392, 0.0268, 0.0321, 0.0290,
        0.2185])
[rfa agg] iter:  6, prev_obj_val: 60.90515899658203, obj_val: 60.850948333740234, abs dis: 0.054210662841796875
[rfa agg] iter: 6, weight: tensor([0.1053, 0.1792, 0.2963, 0.0605, 0.0294, 0.0383, 0.0475, 0.0327, 0.0304,
        0.1805])
[rfa agg] iter:  7, prev_obj_val: 60.850948333740234, obj_val: 68.40934753417969, abs dis: 7.558399200439453
[rfa agg] iter: 7, weight: tensor([0.0959, 0.1633, 0.3570, 0.0558, 0.0271, 0.0353, 0.0439, 0.0302, 0.0280,
        0.1635])
[rfa agg] iter:  8, prev_obj_val: 68.40934753417969, obj_val: 52.3992805480957, abs dis: 16.010066986083984
[rfa agg] iter: 8, weight: tensor([0.1050, 0.1457, 0.2521, 0.0720, 0.0403, 0.0504, 0.1037, 0.0440, 0.0415,
        0.1452])
[rfa agg] iter:  9, prev_obj_val: 52.3992805480957, obj_val: 60.90513610839844, abs dis: 8.505855560302734
[rfa agg] iter: 9, weight: tensor([0.2295, 0.2199, 0.0985, 0.0789, 0.0277, 0.0392, 0.0268, 0.0321, 0.0290,
        0.2184])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3535, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 4.7895, Accuracy: 141/9950 (1.4171%)
saving model
Done in 409.3234124183655 sec.
Server Epoch:58 choose agents : [42, 60, 4, 34, 79, 80, 75, 93, 9, 37].
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 322/1372 (23.4694%)
_Train Local_ResNet_18, epoch  58, local model 42, internal_epoch   2, Avg loss: 0.0301, Accuracy: 565/1372 (41.1808%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9213, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   1, Avg loss: 0.0482, Accuracy: 690/2227 (30.9834%)
_Train Local_ResNet_18, epoch  58, local model 60, internal_epoch   2, Avg loss: 0.0265, Accuracy: 1070/2227 (48.0467%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3112, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0565, Accuracy: 353/901 (39.1787%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.2079, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0547, Accuracy: 430/1427 (30.1331%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0316, Accuracy: 625/1427 (43.7982%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.8737, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   1, Avg loss: 0.1031, Accuracy: 12/197 (6.0914%)
_Train Local_ResNet_18, epoch  58, local model 79, internal_epoch   2, Avg loss: 0.0846, Accuracy: 64/197 (32.4873%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.5566, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   1, Avg loss: 0.0654, Accuracy: 159/682 (23.3138%)
_Train Local_ResNet_18, epoch  58, local model 80, internal_epoch   2, Avg loss: 0.0363, Accuracy: 271/682 (39.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3416, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0592, Accuracy: 297/776 (38.2732%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0271, Accuracy: 428/776 (55.1546%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.6492, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   1, Avg loss: 0.0537, Accuracy: 454/1742 (26.0620%)
_Train Local_ResNet_18, epoch  58, local model 93, internal_epoch   2, Avg loss: 0.0302, Accuracy: 763/1742 (43.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3082, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   1, Avg loss: 0.0481, Accuracy: 382/1275 (29.9608%)
_Train Local_ResNet_18, epoch  58, local model 9, internal_epoch   2, Avg loss: 0.0177, Accuracy: 786/1275 (61.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.9023, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 468/1129 (41.4526%)
_Train Local_ResNet_18, epoch  58, local model 37, internal_epoch   2, Avg loss: 0.0234, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.1660, Accuracy: 103/10000 (1.0300%)
time spent on training: 222.74085640907288
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 2227, 901, 1427, 197, 682, 776, 1742, 1275, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 60, 4, 34, 79, 80, 75, 93, 9, 37], weight: tensor([0.1170, 0.1899, 0.0768, 0.1217, 0.0168, 0.0582, 0.0662, 0.1485, 0.1087,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 57.572906494140625, obj_val: 62.14231491088867, abs dis: 4.569408416748047
[rfa agg] iter: 0, weight: tensor([0.2730, 0.0419, 0.0393, 0.1725, 0.0031, 0.0180, 0.0256, 0.0653, 0.2665,
        0.0948])
[rfa agg] iter:  1, prev_obj_val: 62.14231491088867, obj_val: 67.93244171142578, abs dis: 5.790126800537109
[rfa agg] iter: 1, weight: tensor([0.1296, 0.0405, 0.0641, 0.1017, 0.0038, 0.0248, 0.0375, 0.0562, 0.3090,
        0.2328])
[rfa agg] iter:  2, prev_obj_val: 67.93244171142578, obj_val: 70.27342224121094, abs dis: 2.3409805297851562
[rfa agg] iter: 2, weight: tensor([0.0955, 0.0406, 0.1084, 0.0817, 0.0047, 0.0333, 0.0545, 0.0528, 0.1579,
        0.3706])
[rfa agg] iter:  3, prev_obj_val: 70.27342224121094, obj_val: 70.26962280273438, abs dis: 0.0037994384765625
[rfa agg] iter: 3, weight: tensor([0.0940, 0.0431, 0.1442, 0.0819, 0.0053, 0.0394, 0.0668, 0.0550, 0.1432,
        0.3271])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3490, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.7943, Accuracy: 155/9950 (1.5578%)
saving model
Done in 390.80432653427124 sec.
Server Epoch:59 choose agents : [36, 33, 94, 37, 79, 21, 28, 25, 35, 24].
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0786, Accuracy: 106/408 (25.9804%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0469, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2423, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   1, Avg loss: 0.0772, Accuracy: 96/515 (18.6408%)
_Train Local_ResNet_18, epoch  59, local model 33, internal_epoch   2, Avg loss: 0.0503, Accuracy: 147/515 (28.5437%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8921, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 360/1662 (21.6606%)
_Train Local_ResNet_18, epoch  59, local model 94, internal_epoch   2, Avg loss: 0.0317, Accuracy: 658/1662 (39.5909%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5023, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   1, Avg loss: 0.0489, Accuracy: 484/1129 (42.8698%)
_Train Local_ResNet_18, epoch  59, local model 37, internal_epoch   2, Avg loss: 0.0230, Accuracy: 754/1129 (66.7848%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.9993, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   1, Avg loss: 0.1004, Accuracy: 11/197 (5.5838%)
_Train Local_ResNet_18, epoch  59, local model 79, internal_epoch   2, Avg loss: 0.0813, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.5096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 359/1949 (18.4197%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 657/1949 (33.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5721, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   1, Avg loss: 0.0542, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  59, local model 28, internal_epoch   2, Avg loss: 0.0320, Accuracy: 648/1581 (40.9867%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6747, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   1, Avg loss: 0.0536, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  59, local model 25, internal_epoch   2, Avg loss: 0.0246, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.2069, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   1, Avg loss: 0.0877, Accuracy: 22/271 (8.1181%)
_Train Local_ResNet_18, epoch  59, local model 35, internal_epoch   2, Avg loss: 0.0558, Accuracy: 139/271 (51.2915%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.4646, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   1, Avg loss: 0.0798, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  59, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 174/312 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.5806, Accuracy: 52/10000 (0.5200%)
time spent on training: 197.97664737701416
[rfa agg] training data poison_ratio: 0.0  data num: [408, 515, 1662, 1129, 197, 1949, 1581, 690, 271, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 33, 94, 37, 79, 21, 28, 25, 35, 24], weight: tensor([0.0468, 0.0591, 0.1907, 0.1296, 0.0226, 0.2237, 0.1814, 0.0792, 0.0311,
        0.0358])
[rfa agg] iter:  0, prev_obj_val: 75.98292541503906, obj_val: 76.8729476928711, abs dis: 0.8900222778320312
[rfa agg] iter: 0, weight: tensor([0.0183, 0.0280, 0.1138, 0.5581, 0.0070, 0.0804, 0.1248, 0.0473, 0.0104,
        0.0119])
[rfa agg] iter:  1, prev_obj_val: 76.8729476928711, obj_val: 80.492919921875, abs dis: 3.6199722290039062
[rfa agg] iter: 1, weight: tensor([0.0114, 0.0175, 0.0635, 0.7447, 0.0043, 0.0460, 0.0688, 0.0301, 0.0064,
        0.0074])
[rfa agg] iter:  2, prev_obj_val: 80.492919921875, obj_val: 78.54187774658203, abs dis: 1.9510421752929688
[rfa agg] iter: 2, weight: tensor([0.0215, 0.0339, 0.0970, 0.5770, 0.0080, 0.0734, 0.1035, 0.0601, 0.0119,
        0.0137])
[rfa agg] iter:  3, prev_obj_val: 78.54187774658203, obj_val: 78.52507781982422, abs dis: 0.0167999267578125
[rfa agg] iter: 3, weight: tensor([0.0155, 0.0241, 0.0775, 0.6756, 0.0058, 0.0574, 0.0834, 0.0420, 0.0086,
        0.0099])
[rfa agg] iter:  4, prev_obj_val: 78.52507781982422, obj_val: 80.47860717773438, abs dis: 1.9535293579101562
[rfa agg] iter: 4, weight: tensor([0.0145, 0.0225, 0.0724, 0.6970, 0.0054, 0.0537, 0.0779, 0.0393, 0.0081,
        0.0093])
[rfa agg] iter:  5, prev_obj_val: 80.47860717773438, obj_val: 78.54278564453125, abs dis: 1.935821533203125
[rfa agg] iter: 5, weight: tensor([0.0217, 0.0341, 0.0978, 0.5736, 0.0081, 0.0739, 0.1044, 0.0606, 0.0120,
        0.0138])
[rfa agg] iter:  6, prev_obj_val: 78.54278564453125, obj_val: 78.52513885498047, abs dis: 0.01764678955078125
[rfa agg] iter: 6, weight: tensor([0.0155, 0.0241, 0.0777, 0.6749, 0.0058, 0.0576, 0.0836, 0.0421, 0.0087,
        0.0100])
[rfa agg] iter:  7, prev_obj_val: 78.52513885498047, obj_val: 80.47856140136719, abs dis: 1.9534225463867188
[rfa agg] iter: 7, weight: tensor([0.0145, 0.0225, 0.0725, 0.6969, 0.0054, 0.0537, 0.0779, 0.0393, 0.0081,
        0.0093])
[rfa agg] iter:  8, prev_obj_val: 80.47856140136719, obj_val: 78.54279327392578, abs dis: 1.9357681274414062
[rfa agg] iter: 8, weight: tensor([0.0217, 0.0341, 0.0978, 0.5736, 0.0081, 0.0739, 0.1044, 0.0606, 0.0120,
        0.0138])
[rfa agg] iter:  9, prev_obj_val: 78.54279327392578, obj_val: 78.52513122558594, abs dis: 0.01766204833984375
[rfa agg] iter: 9, weight: tensor([0.0155, 0.0241, 0.0777, 0.6749, 0.0058, 0.0576, 0.0836, 0.0421, 0.0087,
        0.0100])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3461, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.8169, Accuracy: 122/9950 (1.2261%)
saving model
Done in 364.3371708393097 sec.
Server Epoch:60 choose agents : [73, 88, 6, 42, 22, 24, 95, 80, 57, 30].
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0620, Accuracy: 195/938 (20.7889%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0320, Accuracy: 354/938 (37.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.3726, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0712, Accuracy: 152/603 (25.2073%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0437, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.3879, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   1, Avg loss: 0.0525, Accuracy: 428/1956 (21.8814%)
_Train Local_ResNet_18, epoch  60, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 722/1956 (36.9121%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.4870, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 553/1372 (40.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.8604, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 558/1470 (37.9592%)
_Train Local_ResNet_18, epoch  60, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 900/1470 (61.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.9948, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0801, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 185/312 (59.2949%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5619, Accuracy: 58/10000 (0.5800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 324/599 (54.0902%)
_Train Local_ResNet_18, epoch  60, local model 95, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.0110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   1, Avg loss: 0.0659, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  60, local model 80, internal_epoch   2, Avg loss: 0.0359, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0761, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  60, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 546/1154 (47.3137%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.5612, Accuracy: 85/10000 (0.8500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   1, Avg loss: 0.0715, Accuracy: 117/486 (24.0741%)
_Train Local_ResNet_18, epoch  60, local model 30, internal_epoch   2, Avg loss: 0.0368, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0639, Accuracy: 63/10000 (0.6300%)
time spent on training: 236.88967967033386
[rfa agg] training data poison_ratio: 0.11335144170497284  data num: [938, 603, 1956, 1372, 1470, 312, 599, 682, 1154, 486]
[rfa agg] considering poison per batch poison_fraction: 0.035422325532804014
[rfa agg] init. name: [73, 88, 6, 42, 22, 24, 95, 80, 57, 30], weight: tensor([0.0980, 0.0630, 0.2043, 0.1433, 0.1536, 0.0326, 0.0626, 0.0712, 0.1206,
        0.0508])
[rfa agg] iter:  0, prev_obj_val: 63.932044982910156, obj_val: 67.24859619140625, abs dis: 3.3165512084960938
[rfa agg] iter: 0, weight: tensor([0.2225, 0.0429, 0.0696, 0.1354, 0.1213, 0.0130, 0.0426, 0.0565, 0.2692,
        0.0269])
[rfa agg] iter:  1, prev_obj_val: 67.24859619140625, obj_val: 72.11970520019531, abs dis: 4.8711090087890625
[rfa agg] iter: 1, weight: tensor([0.4819, 0.0430, 0.0495, 0.0825, 0.0767, 0.0117, 0.0426, 0.0592, 0.1276,
        0.0255])
[rfa agg] iter:  2, prev_obj_val: 72.11970520019531, obj_val: 72.11520385742188, abs dis: 0.0045013427734375
[rfa agg] iter: 2, weight: tensor([0.4014, 0.0682, 0.0524, 0.0779, 0.0742, 0.0158, 0.0676, 0.1018, 0.1040,
        0.0368])
[rfa agg] iter:  3, prev_obj_val: 72.11520385742188, obj_val: 74.055419921875, abs dis: 1.940216064453125
[rfa agg] iter: 3, weight: tensor([0.3973, 0.0687, 0.0527, 0.0783, 0.0746, 0.0159, 0.0681, 0.1027, 0.1046,
        0.0371])
[rfa agg] iter:  4, prev_obj_val: 74.055419921875, obj_val: 76.00414276123047, abs dis: 1.9487228393554688
[rfa agg] iter: 4, weight: tensor([0.3061, 0.0867, 0.0567, 0.0817, 0.0783, 0.0186, 0.0860, 0.1355, 0.1055,
        0.0448])
[rfa agg] iter:  5, prev_obj_val: 76.00414276123047, obj_val: 76.001708984375, abs dis: 0.00243377685546875
[rfa agg] iter: 5, weight: tensor([0.2380, 0.1037, 0.0566, 0.0793, 0.0765, 0.0203, 0.1028, 0.1726, 0.0995,
        0.0506])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3440, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 4.6928, Accuracy: 488/9950 (4.9045%)
saving model
Saving model on epoch 60
Done in 402.8240919113159 sec.
Server Epoch:61 choose agents : [54, 10, 57, 79, 45, 65, 13, 58, 75, 12].
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.2947, Accuracy: 77/10000 (0.7700%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   1, Avg loss: 0.0572, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  61, local model 10, internal_epoch   2, Avg loss: 0.0199, Accuracy: 447/861 (51.9164%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.8769, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   1, Avg loss: 0.0560, Accuracy: 321/1154 (27.8163%)
_Train Local_ResNet_18, epoch  61, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.4484, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 68/197 (34.5178%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.6690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   1, Avg loss: 0.0616, Accuracy: 242/669 (36.1734%)
_Train Local_ResNet_18, epoch  61, local model 45, internal_epoch   2, Avg loss: 0.0361, Accuracy: 362/669 (54.1106%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6856, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   1, Avg loss: 0.0511, Accuracy: 461/1475 (31.2542%)
_Train Local_ResNet_18, epoch  61, local model 65, internal_epoch   2, Avg loss: 0.0283, Accuracy: 773/1475 (52.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7954, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   1, Avg loss: 0.0536, Accuracy: 391/1645 (23.7690%)
_Train Local_ResNet_18, epoch  61, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 730/1645 (44.3769%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1156, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   1, Avg loss: 0.0593, Accuracy: 331/803 (41.2204%)
_Train Local_ResNet_18, epoch  61, local model 58, internal_epoch   2, Avg loss: 0.0328, Accuracy: 420/803 (52.3039%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.1040, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   1, Avg loss: 0.0584, Accuracy: 300/776 (38.6598%)
_Train Local_ResNet_18, epoch  61, local model 75, internal_epoch   2, Avg loss: 0.0267, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8118, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0856, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8368, Accuracy: 51/10000 (0.5100%)
time spent on training: 212.87611484527588
[rfa agg] training data poison_ratio: 0.09515915119363395  data num: [1130, 861, 1154, 197, 669, 1475, 1645, 803, 776, 338]
[rfa agg] considering poison per batch poison_fraction: 0.02973723474801061
[rfa agg] init. name: [54, 10, 57, 79, 45, 65, 13, 58, 75, 12], weight: tensor([0.1249, 0.0952, 0.1275, 0.0218, 0.0739, 0.1630, 0.1818, 0.0887, 0.0858,
        0.0374])
[rfa agg] iter:  0, prev_obj_val: 50.4525032043457, obj_val: 51.32198715209961, abs dis: 0.8694839477539062
[rfa agg] iter: 0, weight: tensor([0.1790, 0.2163, 0.1329, 0.0071, 0.0608, 0.0712, 0.0646, 0.1285, 0.1249,
        0.0147])
[rfa agg] iter:  1, prev_obj_val: 51.32198715209961, obj_val: 57.19229507446289, abs dis: 5.870307922363281
[rfa agg] iter: 1, weight: tensor([0.1369, 0.2756, 0.1056, 0.0067, 0.0616, 0.0607, 0.0556, 0.1436, 0.1397,
        0.0140])
[rfa agg] iter:  2, prev_obj_val: 57.19229507446289, obj_val: 63.065738677978516, abs dis: 5.873443603515625
[rfa agg] iter: 2, weight: tensor([0.0483, 0.1631, 0.0411, 0.0047, 0.0687, 0.0288, 0.0272, 0.2961, 0.3116,
        0.0104])
[rfa agg] iter:  3, prev_obj_val: 63.065738677978516, obj_val: 63.050010681152344, abs dis: 0.015727996826171875
[rfa agg] iter: 3, weight: tensor([0.0608, 0.1336, 0.0533, 0.0080, 0.1814, 0.0398, 0.0382, 0.2354, 0.2311,
        0.0183])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3432, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 4.7006, Accuracy: 470/9950 (4.7236%)
saving model
Done in 377.12515234947205 sec.
Server Epoch:62 choose agents : [89, 55, 54, 26, 40, 6, 59, 57, 13, 73].
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   1, Avg loss: 0.0553, Accuracy: 366/896 (40.8482%)
_Train Local_ResNet_18, epoch  62, local model 89, internal_epoch   2, Avg loss: 0.0316, Accuracy: 457/896 (51.0045%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.2670, Accuracy: 57/10000 (0.5700%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   1, Avg loss: 0.0498, Accuracy: 360/1071 (33.6134%)
_Train Local_ResNet_18, epoch  62, local model 55, internal_epoch   2, Avg loss: 0.0268, Accuracy: 580/1071 (54.1550%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1453, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch  62, local model 54, internal_epoch   2, Avg loss: 0.0276, Accuracy: 518/1130 (45.8407%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6607, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 381/1446 (26.3485%)
_Train Local_ResNet_18, epoch  62, local model 26, internal_epoch   2, Avg loss: 0.0331, Accuracy: 551/1446 (38.1051%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8090, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 376/1573 (23.9034%)
_Train Local_ResNet_18, epoch  62, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 648/1573 (41.1952%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9864, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 437/1956 (22.3415%)
_Train Local_ResNet_18, epoch  62, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 752/1956 (38.4458%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5698, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0503, Accuracy: 385/1089 (35.3535%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0253, Accuracy: 524/1089 (48.1175%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6795, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 315/1154 (27.2964%)
_Train Local_ResNet_18, epoch  62, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 494/1154 (42.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.6618, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0535, Accuracy: 377/1645 (22.9179%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 720/1645 (43.7690%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3149, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   1, Avg loss: 0.0601, Accuracy: 213/938 (22.7079%)
_Train Local_ResNet_18, epoch  62, local model 73, internal_epoch   2, Avg loss: 0.0321, Accuracy: 364/938 (38.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.2863, Accuracy: 65/10000 (0.6500%)
time spent on training: 262.25641775131226
[rfa agg] training data poison_ratio: 0.08303612963250116  data num: [896, 1071, 1130, 1446, 1573, 1956, 1089, 1154, 1645, 938]
[rfa agg] considering poison per batch poison_fraction: 0.025948790510156614
[rfa agg] init. name: [89, 55, 54, 26, 40, 6, 59, 57, 13, 73], weight: tensor([0.0695, 0.0830, 0.0876, 0.1121, 0.1220, 0.1517, 0.0844, 0.0895, 0.1275,
        0.0727])
[rfa agg] iter:  0, prev_obj_val: 44.35296630859375, obj_val: 47.47800827026367, abs dis: 3.125041961669922
[rfa agg] iter: 0, weight: tensor([0.0398, 0.0929, 0.1424, 0.1245, 0.0833, 0.0476, 0.1307, 0.2161, 0.0729,
        0.0498])
[rfa agg] iter:  1, prev_obj_val: 47.47800827026367, obj_val: 57.664363861083984, abs dis: 10.186355590820312
[rfa agg] iter: 1, weight: tensor([0.0380, 0.1465, 0.2703, 0.0492, 0.0385, 0.0259, 0.1954, 0.1483, 0.0353,
        0.0525])
[rfa agg] iter:  2, prev_obj_val: 57.664363861083984, obj_val: 57.61727523803711, abs dis: 0.047088623046875
[rfa agg] iter: 2, weight: tensor([0.1012, 0.2101, 0.1309, 0.0497, 0.0422, 0.0316, 0.1207, 0.0886, 0.0398,
        0.1853])
[rfa agg] iter:  3, prev_obj_val: 57.61727523803711, obj_val: 57.61717224121094, abs dis: 0.000102996826171875
[rfa agg] iter: 3, weight: tensor([0.1008, 0.2149, 0.1274, 0.0489, 0.0415, 0.0311, 0.1171, 0.0868, 0.0391,
        0.1922])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3421, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.6133, Accuracy: 972/9950 (9.7688%)
saving model
Done in 422.07203674316406 sec.
Server Epoch:63 choose agents : [88, 83, 25, 86, 4, 32, 99, 35, 73, 64].
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   1, Avg loss: 0.0704, Accuracy: 159/603 (26.3682%)
_Train Local_ResNet_18, epoch  63, local model 88, internal_epoch   2, Avg loss: 0.0435, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9494, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 441/1953 (22.5806%)
_Train Local_ResNet_18, epoch  63, local model 83, internal_epoch   2, Avg loss: 0.0318, Accuracy: 842/1953 (43.1132%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1301, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0522, Accuracy: 315/690 (45.6522%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0241, Accuracy: 474/690 (68.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5177, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   1, Avg loss: 0.0586, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  63, local model 86, internal_epoch   2, Avg loss: 0.0324, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6244, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0562, Accuracy: 355/901 (39.4007%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 443/901 (49.1676%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.0005, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   1, Avg loss: 0.0514, Accuracy: 250/735 (34.0136%)
_Train Local_ResNet_18, epoch  63, local model 32, internal_epoch   2, Avg loss: 0.0198, Accuracy: 416/735 (56.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.1086, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0583, Accuracy: 247/773 (31.9534%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0291, Accuracy: 449/773 (58.0854%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.7527, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0894, Accuracy: 16/271 (5.9041%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0533, Accuracy: 130/271 (47.9705%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.2941, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   1, Avg loss: 0.0586, Accuracy: 220/938 (23.4542%)
_Train Local_ResNet_18, epoch  63, local model 73, internal_epoch   2, Avg loss: 0.0312, Accuracy: 364/938 (38.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9878, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0607, Accuracy: 192/953 (20.1469%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0356, Accuracy: 329/953 (34.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.0405, Accuracy: 88/10000 (0.8800%)
time spent on training: 195.066579580307
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1953, 690, 1003, 901, 735, 773, 271, 938, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 83, 25, 86, 4, 32, 99, 35, 73, 64], weight: tensor([0.0684, 0.2214, 0.0782, 0.1137, 0.1022, 0.0833, 0.0876, 0.0307, 0.1063,
        0.1080])
[rfa agg] iter:  0, prev_obj_val: 48.1060791015625, obj_val: 51.68068313598633, abs dis: 3.574604034423828
[rfa agg] iter: 0, weight: tensor([0.0201, 0.0232, 0.0280, 0.2334, 0.1686, 0.0382, 0.0553, 0.0048, 0.2135,
        0.2149])
[rfa agg] iter:  1, prev_obj_val: 51.68068313598633, obj_val: 58.47032928466797, abs dis: 6.789646148681641
[rfa agg] iter: 1, weight: tensor([0.0480, 0.0263, 0.0797, 0.0796, 0.1024, 0.1515, 0.2843, 0.0082, 0.1091,
        0.1109])
[rfa agg] iter:  2, prev_obj_val: 58.47032928466797, obj_val: 61.400489807128906, abs dis: 2.9301605224609375
[rfa agg] iter: 2, weight: tensor([0.0984, 0.0256, 0.2326, 0.0565, 0.0642, 0.2508, 0.1253, 0.0106, 0.0674,
        0.0686])
[rfa agg] iter:  3, prev_obj_val: 61.400489807128906, obj_val: 72.40957641601562, abs dis: 11.009086608886719
[rfa agg] iter: 3, weight: tensor([0.1345, 0.0238, 0.3616, 0.0485, 0.0537, 0.1630, 0.0902, 0.0110, 0.0564,
        0.0573])
[rfa agg] iter:  4, prev_obj_val: 72.40957641601562, obj_val: 72.37655639648438, abs dis: 0.03302001953125
[rfa agg] iter: 4, weight: tensor([0.3387, 0.0341, 0.1675, 0.0577, 0.0609, 0.1084, 0.0818, 0.0226, 0.0636,
        0.0647])
[rfa agg] iter:  5, prev_obj_val: 72.37655639648438, obj_val: 68.37511444091797, abs dis: 4.001441955566406
[rfa agg] iter: 5, weight: tensor([0.3674, 0.0328, 0.1574, 0.0556, 0.0586, 0.1041, 0.0788, 0.0217, 0.0613,
        0.0623])
[rfa agg] iter:  6, prev_obj_val: 68.37511444091797, obj_val: 68.36550903320312, abs dis: 0.00960540771484375
[rfa agg] iter: 6, weight: tensor([0.4855, 0.0229, 0.1508, 0.0410, 0.0438, 0.0877, 0.0624, 0.0133, 0.0459,
        0.0467])
[rfa agg] iter:  7, prev_obj_val: 68.36550903320312, obj_val: 72.38419342041016, abs dis: 4.018684387207031
[rfa agg] iter: 7, weight: tensor([0.5348, 0.0208, 0.1358, 0.0372, 0.0397, 0.0793, 0.0565, 0.0121, 0.0416,
        0.0423])
[rfa agg] iter:  8, prev_obj_val: 72.38419342041016, obj_val: 76.50880432128906, abs dis: 4.124610900878906
[rfa agg] iter: 8, weight: tensor([0.3864, 0.0320, 0.1518, 0.0541, 0.0570, 0.1010, 0.0766, 0.0211, 0.0595,
        0.0606])
[rfa agg] iter:  9, prev_obj_val: 76.50880432128906, obj_val: 61.42479705810547, abs dis: 15.084007263183594
[rfa agg] iter: 9, weight: tensor([0.2747, 0.0421, 0.1585, 0.0678, 0.0706, 0.1146, 0.0908, 0.0320, 0.0738,
        0.0750])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3424, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 4.4776, Accuracy: 2327/9950 (23.3869%)
saving model
Done in 361.52564883232117 sec.
Server Epoch:64 choose agents : [19, 68, 40, 0, 59, 96, 62, 63, 70, 81].
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   1, Avg loss: 0.0477, Accuracy: 384/1036 (37.0656%)
_Train Local_ResNet_18, epoch  64, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 731/1036 (70.5598%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.8534, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   1, Avg loss: 0.0589, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  64, local model 68, internal_epoch   2, Avg loss: 0.0355, Accuracy: 500/1163 (42.9923%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.6945, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   1, Avg loss: 0.0560, Accuracy: 348/1573 (22.1233%)
_Train Local_ResNet_18, epoch  64, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 604/1573 (38.3980%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4798, Accuracy: 84/10000 (0.8400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch  64, local model 0, internal_epoch   2, Avg loss: 0.0332, Accuracy: 571/1657 (34.4599%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1667, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 358/1089 (32.8742%)
_Train Local_ResNet_18, epoch  64, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 483/1089 (44.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.7430, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 28/311 (9.0032%)
_Train Local_ResNet_18, epoch  64, local model 96, internal_epoch   2, Avg loss: 0.0514, Accuracy: 138/311 (44.3730%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.3039, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 166/568 (29.2254%)
_Train Local_ResNet_18, epoch  64, local model 62, internal_epoch   2, Avg loss: 0.0386, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0391, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0492, Accuracy: 294/888 (33.1081%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 473/888 (53.2658%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.0320, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 451/1418 (31.8054%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0282, Accuracy: 716/1418 (50.4937%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5057, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0609, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0337, Accuracy: 344/774 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3080, Accuracy: 79/10000 (0.7900%)
time spent on training: 265.54669857025146
[rfa agg] training data poison_ratio: 0.15815596067576596  data num: [1036, 1163, 1573, 1657, 1089, 311, 568, 888, 1418, 774]
[rfa agg] considering poison per batch poison_fraction: 0.04942373771117686
[rfa agg] init. name: [19, 68, 40, 0, 59, 96, 62, 63, 70, 81], weight: tensor([0.0989, 0.1110, 0.1501, 0.1582, 0.1039, 0.0297, 0.0542, 0.0848, 0.1353,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 47.27211380004883, obj_val: 51.122642517089844, abs dis: 3.8505287170410156
[rfa agg] iter: 0, weight: tensor([0.3746, 0.1411, 0.0507, 0.0476, 0.1752, 0.0067, 0.0184, 0.0753, 0.0608,
        0.0496])
[rfa agg] iter:  1, prev_obj_val: 51.122642517089844, obj_val: 55.607173919677734, abs dis: 4.484531402587891
[rfa agg] iter: 1, weight: tensor([0.2982, 0.1217, 0.0562, 0.0534, 0.1525, 0.0091, 0.0262, 0.1363, 0.0650,
        0.0815])
[rfa agg] iter:  2, prev_obj_val: 55.607173919677734, obj_val: 60.42938232421875, abs dis: 4.822208404541016
[rfa agg] iter: 2, weight: tensor([0.1749, 0.1000, 0.0548, 0.0525, 0.1182, 0.0109, 0.0330, 0.2650, 0.0617,
        0.1290])
[rfa agg] iter:  3, prev_obj_val: 60.42938232421875, obj_val: 66.48157501220703, abs dis: 6.052192687988281
[rfa agg] iter: 3, weight: tensor([0.0888, 0.0604, 0.0374, 0.0361, 0.0683, 0.0091, 0.0297, 0.4558, 0.0412,
        0.1733])
[rfa agg] iter:  4, prev_obj_val: 66.48157501220703, obj_val: 73.52481842041016, abs dis: 7.043243408203125
[rfa agg] iter: 4, weight: tensor([0.0768, 0.0578, 0.0393, 0.0383, 0.0634, 0.0117, 0.0424, 0.2499, 0.0425,
        0.3778])
[rfa agg] iter:  5, prev_obj_val: 73.52481842041016, obj_val: 63.28882598876953, abs dis: 10.235992431640625
[rfa agg] iter: 5, weight: tensor([0.0899, 0.0723, 0.0528, 0.0517, 0.0777, 0.0194, 0.0820, 0.1876, 0.0563,
        0.3103])
[rfa agg] iter:  6, prev_obj_val: 63.28882598876953, obj_val: 66.4293441772461, abs dis: 3.1405181884765625
[rfa agg] iter: 6, weight: tensor([0.0806, 0.0580, 0.0377, 0.0366, 0.0644, 0.0101, 0.0348, 0.3244, 0.0412,
        0.3122])
[rfa agg] iter:  7, prev_obj_val: 66.4293441772461, obj_val: 66.40634155273438, abs dis: 0.02300262451171875
[rfa agg] iter: 7, weight: tensor([0.0712, 0.0536, 0.0364, 0.0354, 0.0587, 0.0108, 0.0393, 0.2225, 0.0394,
        0.4326])
[rfa agg] iter:  8, prev_obj_val: 66.40634155273438, obj_val: 73.53461456298828, abs dis: 7.128273010253906
[rfa agg] iter: 8, weight: tensor([0.0649, 0.0488, 0.0332, 0.0323, 0.0535, 0.0099, 0.0358, 0.1953, 0.0359,
        0.4904])
[rfa agg] iter:  9, prev_obj_val: 73.53461456298828, obj_val: 63.28934097290039, abs dis: 10.24527359008789
[rfa agg] iter: 9, weight: tensor([0.0893, 0.0718, 0.0525, 0.0514, 0.0770, 0.0193, 0.0813, 0.1847, 0.0559,
        0.3169])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3416, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.5133, Accuracy: 1893/9950 (19.0251%)
saving model
Done in 429.1725924015045 sec.
Server Epoch:65 choose agents : [82, 14, 61, 68, 51, 24, 76, 37, 34, 80].
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0721, Accuracy: 103/500 (20.6000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0459, Accuracy: 207/500 (41.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2702, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0564, Accuracy: 253/1013 (24.9753%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0318, Accuracy: 418/1013 (41.2636%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5430, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1274, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1199, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3457, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0589, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0340, Accuracy: 518/1163 (44.5400%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5154, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   1, Avg loss: 0.0570, Accuracy: 269/1049 (25.6435%)
_Train Local_ResNet_18, epoch  65, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 555/1049 (52.9075%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5935, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   1, Avg loss: 0.0802, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch  65, local model 24, internal_epoch   2, Avg loss: 0.0417, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7407, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0805, Accuracy: 82/466 (17.5966%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0453, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2314, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0447, Accuracy: 575/1129 (50.9300%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 798/1129 (70.6820%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7236, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   1, Avg loss: 0.0550, Accuracy: 401/1427 (28.1009%)
_Train Local_ResNet_18, epoch  65, local model 34, internal_epoch   2, Avg loss: 0.0314, Accuracy: 623/1427 (43.6580%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5999, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0636, Accuracy: 180/682 (26.3930%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0354, Accuracy: 282/682 (41.3490%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.9376, Accuracy: 73/10000 (0.7300%)
time spent on training: 198.7135579586029
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1013, 85, 1163, 1049, 312, 466, 1129, 1427, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 14, 61, 68, 51, 24, 76, 37, 34, 80], weight: tensor([0.0639, 0.1294, 0.0109, 0.1486, 0.1340, 0.0399, 0.0595, 0.1443, 0.1823,
        0.0871])
[rfa agg] iter:  0, prev_obj_val: 46.426307678222656, obj_val: 48.47697067260742, abs dis: 2.0506629943847656
[rfa agg] iter: 0, weight: tensor([0.0438, 0.2522, 0.0037, 0.1212, 0.1743, 0.0182, 0.0408, 0.1448, 0.0832,
        0.1178])
[rfa agg] iter:  1, prev_obj_val: 48.47697067260742, obj_val: 50.567806243896484, abs dis: 2.0908355712890625
[rfa agg] iter: 1, weight: tensor([0.0511, 0.2222, 0.0042, 0.1182, 0.1627, 0.0207, 0.0476, 0.1388, 0.0843,
        0.1502])
[rfa agg] iter:  2, prev_obj_val: 50.567806243896484, obj_val: 50.566619873046875, abs dis: 0.001186370849609375
[rfa agg] iter: 2, weight: tensor([0.0582, 0.1934, 0.0045, 0.1124, 0.1487, 0.0228, 0.0542, 0.1299, 0.0831,
        0.1927])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3417, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 4.5476, Accuracy: 1524/9950 (15.3166%)
saving model
Done in 364.2962167263031 sec.
Server Epoch:66 choose agents : [29, 39, 13, 16, 89, 32, 70, 78, 86, 12].
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   1, Avg loss: 0.0504, Accuracy: 411/1440 (28.5417%)
_Train Local_ResNet_18, epoch  66, local model 29, internal_epoch   2, Avg loss: 0.0266, Accuracy: 731/1440 (50.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7094, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   1, Avg loss: 0.0511, Accuracy: 320/1013 (31.5893%)
_Train Local_ResNet_18, epoch  66, local model 39, internal_epoch   2, Avg loss: 0.0252, Accuracy: 524/1013 (51.7275%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8436, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   1, Avg loss: 0.0528, Accuracy: 434/1645 (26.3830%)
_Train Local_ResNet_18, epoch  66, local model 13, internal_epoch   2, Avg loss: 0.0301, Accuracy: 743/1645 (45.1672%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.0165, Accuracy: 145/10000 (1.4500%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   1, Avg loss: 0.0591, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  66, local model 16, internal_epoch   2, Avg loss: 0.0347, Accuracy: 438/708 (61.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6364, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0545, Accuracy: 368/896 (41.0714%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0312, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2425, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   1, Avg loss: 0.0502, Accuracy: 263/735 (35.7823%)
_Train Local_ResNet_18, epoch  66, local model 32, internal_epoch   2, Avg loss: 0.0204, Accuracy: 377/735 (51.2925%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 11.7396, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 474/1418 (33.4274%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0286, Accuracy: 711/1418 (50.1410%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1528, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0785, Accuracy: 73/416 (17.5481%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0412, Accuracy: 237/416 (56.9712%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2423, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0576, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0320, Accuracy: 385/1003 (38.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8565, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   1, Avg loss: 0.0863, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  66, local model 12, internal_epoch   2, Avg loss: 0.0462, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.0100, Accuracy: 51/10000 (0.5100%)
time spent on training: 218.5653579235077
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 1013, 1645, 708, 896, 735, 1418, 416, 1003, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 39, 13, 16, 89, 32, 70, 78, 86, 12], weight: tensor([0.1498, 0.1054, 0.1711, 0.0737, 0.0932, 0.0765, 0.1475, 0.0433, 0.1043,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 51.582435607910156, obj_val: 57.12539291381836, abs dis: 5.542957305908203
[rfa agg] iter: 0, weight: tensor([0.0518, 0.2436, 0.0431, 0.0669, 0.2048, 0.0696, 0.0509, 0.0150, 0.2435,
        0.0108])
[rfa agg] iter:  1, prev_obj_val: 57.12539291381836, obj_val: 59.43562316894531, abs dis: 2.310230255126953
[rfa agg] iter: 1, weight: tensor([0.0464, 0.1211, 0.0403, 0.1347, 0.3162, 0.1417, 0.0457, 0.0196, 0.1204,
        0.0138])
[rfa agg] iter:  2, prev_obj_val: 59.43562316894531, obj_val: 59.425697326660156, abs dis: 0.00992584228515625
[rfa agg] iter: 2, weight: tensor([0.0445, 0.1018, 0.0391, 0.1914, 0.2393, 0.2024, 0.0438, 0.0214, 0.1013,
        0.0149])
[rfa agg] iter:  3, prev_obj_val: 59.425697326660156, obj_val: 59.425628662109375, abs dis: 6.866455078125e-05
[rfa agg] iter: 3, weight: tensor([0.0444, 0.1016, 0.0390, 0.1954, 0.2321, 0.2063, 0.0437, 0.0214, 0.1012,
        0.0149])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3434, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.4201, Accuracy: 2993/9950 (30.0804%)
saving model
Done in 382.49410915374756 sec.
Server Epoch:67 choose agents : [94, 66, 0, 19, 86, 99, 97, 78, 7, 76].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 395/1662 (23.7665%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0313, Accuracy: 697/1662 (41.9374%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5032, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   1, Avg loss: 0.0591, Accuracy: 281/1402 (20.0428%)
_Train Local_ResNet_18, epoch  67, local model 66, internal_epoch   2, Avg loss: 0.0365, Accuracy: 458/1402 (32.6676%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1499, Accuracy: 77/10000 (0.7700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   1, Avg loss: 0.0564, Accuracy: 347/1657 (20.9415%)
_Train Local_ResNet_18, epoch  67, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 593/1657 (35.7876%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0054, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 385/1036 (37.1622%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 713/1036 (68.8224%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 12.4969, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0571, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0320, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   1, Avg loss: 0.0558, Accuracy: 251/773 (32.4709%)
_Train Local_ResNet_18, epoch  67, local model 99, internal_epoch   2, Avg loss: 0.0270, Accuracy: 445/773 (57.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8593, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 347/1213 (28.6068%)
_Train Local_ResNet_18, epoch  67, local model 97, internal_epoch   2, Avg loss: 0.0267, Accuracy: 549/1213 (45.2597%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.6801, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0782, Accuracy: 76/416 (18.2692%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0424, Accuracy: 231/416 (55.5288%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.3834, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   1, Avg loss: 0.0502, Accuracy: 367/891 (41.1897%)
_Train Local_ResNet_18, epoch  67, local model 7, internal_epoch   2, Avg loss: 0.0238, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5814, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0811, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0454, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.2237, Accuracy: 51/10000 (0.5100%)
time spent on training: 246.62693977355957
[rfa agg] training data poison_ratio: 0.1575244795132617  data num: [1662, 1402, 1657, 1036, 1003, 773, 1213, 416, 891, 466]
[rfa agg] considering poison per batch poison_fraction: 0.04922639984789429
[rfa agg] init. name: [94, 66, 0, 19, 86, 99, 97, 78, 7, 76], weight: tensor([0.1580, 0.1333, 0.1575, 0.0985, 0.0954, 0.0735, 0.1153, 0.0395, 0.0847,
        0.0443])
[rfa agg] iter:  0, prev_obj_val: 47.513916015625, obj_val: 50.273929595947266, abs dis: 2.7600135803222656
[rfa agg] iter: 0, weight: tensor([0.0464, 0.0700, 0.0462, 0.3409, 0.2069, 0.0481, 0.1448, 0.0105, 0.0732,
        0.0130])
[rfa agg] iter:  1, prev_obj_val: 50.273929595947266, obj_val: 54.478302001953125, abs dis: 4.204372406005859
[rfa agg] iter: 1, weight: tensor([0.0392, 0.0549, 0.0391, 0.2145, 0.3747, 0.0593, 0.0933, 0.0109, 0.1003,
        0.0138])
[rfa agg] iter:  2, prev_obj_val: 54.478302001953125, obj_val: 56.788230895996094, abs dis: 2.3099288940429688
[rfa agg] iter: 2, weight: tensor([0.0440, 0.0582, 0.0439, 0.1435, 0.2636, 0.1058, 0.0872, 0.0152, 0.2193,
        0.0194])
[rfa agg] iter:  3, prev_obj_val: 56.788230895996094, obj_val: 59.28038787841797, abs dis: 2.492156982421875
[rfa agg] iter: 3, weight: tensor([0.0404, 0.0522, 0.0403, 0.1118, 0.1757, 0.1313, 0.0747, 0.0155, 0.3379,
        0.0201])
[rfa agg] iter:  4, prev_obj_val: 59.28038787841797, obj_val: 68.85305786132812, abs dis: 9.572669982910156
[rfa agg] iter: 4, weight: tensor([0.0328, 0.0415, 0.0327, 0.0797, 0.1136, 0.1518, 0.0571, 0.0141, 0.4582,
        0.0184])
[rfa agg] iter:  5, prev_obj_val: 68.85305786132812, obj_val: 65.3207778930664, abs dis: 3.5322799682617188
[rfa agg] iter: 5, weight: tensor([0.0448, 0.0536, 0.0447, 0.0827, 0.1025, 0.3292, 0.0676, 0.0275, 0.2099,
        0.0375])
[rfa agg] iter:  6, prev_obj_val: 65.3207778930664, obj_val: 72.4189224243164, abs dis: 7.09814453125
[rfa agg] iter: 6, weight: tensor([0.0349, 0.0425, 0.0348, 0.0696, 0.0891, 0.4195, 0.0550, 0.0189, 0.2102,
        0.0254])
[rfa agg] iter:  7, prev_obj_val: 72.4189224243164, obj_val: 68.79008483886719, abs dis: 3.6288375854492188
[rfa agg] iter: 7, weight: tensor([0.0509, 0.0600, 0.0507, 0.0878, 0.1058, 0.3031, 0.0740, 0.0355, 0.1827,
        0.0495])
[rfa agg] iter:  8, prev_obj_val: 68.79008483886719, obj_val: 62.18550491333008, abs dis: 6.604579925537109
[rfa agg] iter: 8, weight: tensor([0.0425, 0.0509, 0.0423, 0.0784, 0.0971, 0.3724, 0.0641, 0.0260, 0.1907,
        0.0356])
[rfa agg] iter:  9, prev_obj_val: 62.18550491333008, obj_val: 68.79785919189453, abs dis: 6.612354278564453
[rfa agg] iter: 9, weight: tensor([0.0357, 0.0442, 0.0355, 0.0776, 0.1036, 0.3025, 0.0588, 0.0172, 0.3024,
        0.0227])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3436, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.4568, Accuracy: 2387/9950 (23.9899%)
saving model
Done in 413.2749991416931 sec.
Server Epoch:68 choose agents : [47, 88, 74, 60, 6, 79, 68, 41, 15, 82].
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  68, local model 47, internal_epoch   2, Avg loss: 0.1001, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.4599, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0690, Accuracy: 153/603 (25.3731%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0416, Accuracy: 274/603 (45.4395%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2351, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 565/1552 (36.4046%)
_Train Local_ResNet_18, epoch  68, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.0257, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0483, Accuracy: 732/2227 (32.8693%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0262, Accuracy: 1127/2227 (50.6062%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3071, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 444/1956 (22.6994%)
_Train Local_ResNet_18, epoch  68, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 728/1956 (37.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4732, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   1, Avg loss: 0.1035, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  68, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.5547, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   1, Avg loss: 0.0596, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  68, local model 68, internal_epoch   2, Avg loss: 0.0337, Accuracy: 532/1163 (45.7438%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7617, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 316/719 (43.9499%)
_Train Local_ResNet_18, epoch  68, local model 41, internal_epoch   2, Avg loss: 0.0290, Accuracy: 446/719 (62.0306%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5713, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 357/1154 (30.9359%)
_Train Local_ResNet_18, epoch  68, local model 15, internal_epoch   2, Avg loss: 0.0260, Accuracy: 530/1154 (45.9272%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.9502, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0716, Accuracy: 85/500 (17.0000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 210/500 (42.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6347, Accuracy: 73/10000 (0.7300%)
time spent on training: 269.8869230747223
[rfa agg] training data poison_ratio: 0.15208231259186672  data num: [134, 603, 1552, 2227, 1956, 197, 1163, 719, 1154, 500]
[rfa agg] considering poison per batch poison_fraction: 0.047525722684958346
[rfa agg] init. name: [47, 88, 74, 60, 6, 79, 68, 41, 15, 82], weight: tensor([0.0131, 0.0591, 0.1521, 0.2182, 0.1917, 0.0193, 0.1140, 0.0705, 0.1131,
        0.0490])
[rfa agg] iter:  0, prev_obj_val: 76.2630386352539, obj_val: 78.1309814453125, abs dis: 1.8679428100585938
[rfa agg] iter: 0, weight: tensor([0.0039, 0.0282, 0.2323, 0.0887, 0.1105, 0.0061, 0.2387, 0.0407, 0.2309,
        0.0200])
[rfa agg] iter:  1, prev_obj_val: 78.1309814453125, obj_val: 82.03736114501953, abs dis: 3.9063796997070312
[rfa agg] iter: 1, weight: tensor([0.0030, 0.0226, 0.1151, 0.0555, 0.0664, 0.0046, 0.3547, 0.0336, 0.3289,
        0.0156])
[rfa agg] iter:  2, prev_obj_val: 82.03736114501953, obj_val: 86.78068542480469, abs dis: 4.743324279785156
[rfa agg] iter: 2, weight: tensor([0.0025, 0.0204, 0.0683, 0.0389, 0.0451, 0.0039, 0.4118, 0.0317, 0.3636,
        0.0137])
[rfa agg] iter:  3, prev_obj_val: 86.78068542480469, obj_val: 82.04170227050781, abs dis: 4.738983154296875
[rfa agg] iter: 3, weight: tensor([0.0043, 0.0370, 0.0947, 0.0586, 0.0666, 0.0067, 0.3308, 0.0597, 0.3175,
        0.0242])
[rfa agg] iter:  4, prev_obj_val: 82.04170227050781, obj_val: 86.7805404663086, abs dis: 4.738838195800781
[rfa agg] iter: 4, weight: tensor([0.0025, 0.0205, 0.0686, 0.0391, 0.0453, 0.0039, 0.4113, 0.0319, 0.3630,
        0.0138])
[rfa agg] iter:  5, prev_obj_val: 86.7805404663086, obj_val: 82.04170989990234, abs dis: 4.73883056640625
[rfa agg] iter: 5, weight: tensor([0.0043, 0.0370, 0.0947, 0.0586, 0.0667, 0.0067, 0.3308, 0.0597, 0.3174,
        0.0242])
[rfa agg] iter:  6, prev_obj_val: 82.04170989990234, obj_val: 86.78053283691406, abs dis: 4.738822937011719
[rfa agg] iter: 6, weight: tensor([0.0025, 0.0205, 0.0686, 0.0391, 0.0453, 0.0039, 0.4113, 0.0319, 0.3630,
        0.0138])
[rfa agg] iter:  7, prev_obj_val: 86.78053283691406, obj_val: 82.04170989990234, abs dis: 4.738822937011719
[rfa agg] iter: 7, weight: tensor([0.0043, 0.0370, 0.0947, 0.0586, 0.0667, 0.0067, 0.3308, 0.0597, 0.3174,
        0.0242])
[rfa agg] iter:  8, prev_obj_val: 82.04170989990234, obj_val: 86.7805404663086, abs dis: 4.73883056640625
[rfa agg] iter: 8, weight: tensor([0.0025, 0.0205, 0.0686, 0.0391, 0.0453, 0.0039, 0.4113, 0.0319, 0.3630,
        0.0138])
[rfa agg] iter:  9, prev_obj_val: 86.7805404663086, obj_val: 82.04170989990234, abs dis: 4.73883056640625
[rfa agg] iter: 9, weight: tensor([0.0043, 0.0370, 0.0947, 0.0586, 0.0667, 0.0067, 0.3308, 0.0597, 0.3174,
        0.0242])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3403, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.4730, Accuracy: 2406/9950 (24.1809%)
saving model
Done in 431.3984706401825 sec.
Server Epoch:69 choose agents : [22, 25, 63, 47, 88, 9, 18, 92, 56, 67].
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 579/1470 (39.3878%)
_Train Local_ResNet_18, epoch  69, local model 22, internal_epoch   2, Avg loss: 0.0233, Accuracy: 882/1470 (60.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.9088, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   1, Avg loss: 0.0514, Accuracy: 320/690 (46.3768%)
_Train Local_ResNet_18, epoch  69, local model 25, internal_epoch   2, Avg loss: 0.0232, Accuracy: 469/690 (67.9710%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.5733, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   1, Avg loss: 0.0481, Accuracy: 318/888 (35.8108%)
_Train Local_ResNet_18, epoch  69, local model 63, internal_epoch   2, Avg loss: 0.0236, Accuracy: 482/888 (54.2793%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.0310, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   1, Avg loss: 0.1188, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  69, local model 47, internal_epoch   2, Avg loss: 0.1041, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3757, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0698, Accuracy: 159/603 (26.3682%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0422, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7171, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   1, Avg loss: 0.0469, Accuracy: 387/1275 (30.3529%)
_Train Local_ResNet_18, epoch  69, local model 9, internal_epoch   2, Avg loss: 0.0176, Accuracy: 774/1275 (60.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.1879, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   1, Avg loss: 0.0740, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  69, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 283/530 (53.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6348, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 468/1715 (27.2886%)
_Train Local_ResNet_18, epoch  69, local model 92, internal_epoch   2, Avg loss: 0.0285, Accuracy: 842/1715 (49.0962%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1920, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   1, Avg loss: 0.0857, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  69, local model 56, internal_epoch   2, Avg loss: 0.0700, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.4199, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   1, Avg loss: 0.0722, Accuracy: 100/426 (23.4742%)
_Train Local_ResNet_18, epoch  69, local model 67, internal_epoch   2, Avg loss: 0.0385, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4421, Accuracy: 58/10000 (0.5800%)
time spent on training: 202.8284502029419
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 690, 888, 134, 603, 1275, 530, 1715, 186, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 25, 63, 47, 88, 9, 18, 92, 56, 67], weight: tensor([0.1857, 0.0872, 0.1122, 0.0169, 0.0762, 0.1610, 0.0669, 0.2166, 0.0235,
        0.0538])
[rfa agg] iter:  0, prev_obj_val: 62.8687629699707, obj_val: 64.05219268798828, abs dis: 1.1834297180175781
[rfa agg] iter: 0, weight: tensor([0.1226, 0.0955, 0.3454, 0.0067, 0.0687, 0.1756, 0.0511, 0.0936, 0.0094,
        0.0315])
[rfa agg] iter:  1, prev_obj_val: 64.05219268798828, obj_val: 67.69452667236328, abs dis: 3.642333984375
[rfa agg] iter: 1, weight: tensor([0.0721, 0.0814, 0.5616, 0.0049, 0.0558, 0.0962, 0.0402, 0.0573, 0.0068,
        0.0238])
[rfa agg] iter:  2, prev_obj_val: 67.69452667236328, obj_val: 69.24787139892578, abs dis: 1.5533447265625
[rfa agg] iter: 2, weight: tensor([0.0708, 0.1597, 0.4136, 0.0065, 0.0959, 0.0875, 0.0635, 0.0592, 0.0090,
        0.0343])
[rfa agg] iter:  3, prev_obj_val: 69.24787139892578, obj_val: 70.82449340820312, abs dis: 1.5766220092773438
[rfa agg] iter: 3, weight: tensor([0.0722, 0.2242, 0.2975, 0.0073, 0.1228, 0.0874, 0.0775, 0.0611, 0.0101,
        0.0400])
[rfa agg] iter:  4, prev_obj_val: 70.82449340820312, obj_val: 74.22757720947266, abs dis: 3.4030838012695312
[rfa agg] iter: 4, weight: tensor([0.0649, 0.3032, 0.2115, 0.0073, 0.1438, 0.0773, 0.0850, 0.0556, 0.0101,
        0.0414])
[rfa agg] iter:  5, prev_obj_val: 74.22757720947266, obj_val: 78.92231750488281, abs dis: 4.694740295410156
[rfa agg] iter: 5, weight: tensor([0.0376, 0.5003, 0.0899, 0.0052, 0.1717, 0.0434, 0.0793, 0.0329, 0.0071,
        0.0326])
[rfa agg] iter:  6, prev_obj_val: 78.92231750488281, obj_val: 84.88569641113281, abs dis: 5.96337890625
[rfa agg] iter: 6, weight: tensor([0.0345, 0.2021, 0.0671, 0.0058, 0.4254, 0.0388, 0.1443, 0.0308, 0.0081,
        0.0430])
[rfa agg] iter:  7, prev_obj_val: 84.88569641113281, obj_val: 84.828857421875, abs dis: 0.0568389892578125
[rfa agg] iter: 7, weight: tensor([0.0365, 0.1168, 0.0614, 0.0078, 0.2026, 0.0402, 0.4178, 0.0331, 0.0108,
        0.0730])
[rfa agg] iter:  8, prev_obj_val: 84.828857421875, obj_val: 84.82029724121094, abs dis: 0.0085601806640625
[rfa agg] iter: 8, weight: tensor([0.0302, 0.0961, 0.0508, 0.0064, 0.1624, 0.0333, 0.5241, 0.0274, 0.0089,
        0.0603])
[rfa agg] iter:  9, prev_obj_val: 84.82029724121094, obj_val: 88.31282806396484, abs dis: 3.4925308227539062
[rfa agg] iter: 9, weight: tensor([0.0271, 0.0859, 0.0456, 0.0058, 0.1440, 0.0299, 0.5753, 0.0246, 0.0080,
        0.0540])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3392, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 4.5006, Accuracy: 2193/9950 (22.0402%)
saving model
Done in 381.46609115600586 sec.
Server Epoch:70 choose agents : [22, 33, 47, 94, 75, 85, 88, 5, 73, 80].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 597/1470 (40.6122%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 932/1470 (63.4014%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5157, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   1, Avg loss: 0.0795, Accuracy: 90/515 (17.4757%)
_Train Local_ResNet_18, epoch  70, local model 33, internal_epoch   2, Avg loss: 0.0482, Accuracy: 158/515 (30.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2033, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1174, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1038, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3835, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 379/1662 (22.8039%)
_Train Local_ResNet_18, epoch  70, local model 94, internal_epoch   2, Avg loss: 0.0312, Accuracy: 702/1662 (42.2383%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3709, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0570, Accuracy: 309/776 (39.8196%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0248, Accuracy: 445/776 (57.3454%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0700, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   1, Avg loss: 0.0555, Accuracy: 499/1988 (25.1006%)
_Train Local_ResNet_18, epoch  70, local model 85, internal_epoch   2, Avg loss: 0.0339, Accuracy: 733/1988 (36.8712%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3751, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0675, Accuracy: 165/603 (27.3632%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0425, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4072, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   1, Avg loss: 0.0478, Accuracy: 425/1628 (26.1057%)
_Train Local_ResNet_18, epoch  70, local model 5, internal_epoch   2, Avg loss: 0.0233, Accuracy: 910/1628 (55.8968%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.9088, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0584, Accuracy: 221/938 (23.5608%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0315, Accuracy: 362/938 (38.5928%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1376, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   1, Avg loss: 0.0623, Accuracy: 188/682 (27.5660%)
_Train Local_ResNet_18, epoch  70, local model 80, internal_epoch   2, Avg loss: 0.0349, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1169, Accuracy: 82/10000 (0.8200%)
time spent on training: 238.0991051197052
[rfa agg] training data poison_ratio: 0.0  data num: [1470, 515, 134, 1662, 776, 1988, 603, 1628, 938, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 33, 47, 94, 75, 85, 88, 5, 73, 80], weight: tensor([0.1414, 0.0495, 0.0129, 0.1599, 0.0746, 0.1912, 0.0580, 0.1566, 0.0902,
        0.0656])
[rfa agg] iter:  0, prev_obj_val: 69.07106018066406, obj_val: 70.37528228759766, abs dis: 1.3042221069335938
[rfa agg] iter: 0, weight: tensor([0.2563, 0.0307, 0.0051, 0.1591, 0.0743, 0.0995, 0.0397, 0.1559, 0.1293,
        0.0502])
[rfa agg] iter:  1, prev_obj_val: 70.37528228759766, obj_val: 71.69831085205078, abs dis: 1.323028564453125
[rfa agg] iter: 1, weight: tensor([0.2331, 0.0331, 0.0054, 0.1519, 0.0826, 0.0982, 0.0431, 0.1489, 0.1491,
        0.0547])
[rfa agg] iter:  2, prev_obj_val: 71.69831085205078, obj_val: 71.69763946533203, abs dis: 0.00067138671875
[rfa agg] iter: 2, weight: tensor([0.2103, 0.0353, 0.0056, 0.1437, 0.0911, 0.0958, 0.0462, 0.1408, 0.1721,
        0.0591])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3369, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.4470, Accuracy: 2927/9950 (29.4171%)
saving model
Done in 407.6745648384094 sec.
Server Epoch:71 choose agents : [7, 79, 81, 44, 17, 9, 21, 95, 51, 70].
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1, Avg loss: 0.0492, Accuracy: 382/891 (42.8732%)
_Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2, Avg loss: 0.0237, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.2273, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1047, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0878, Accuracy: 48/197 (24.3655%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.4944, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0615, Accuracy: 261/774 (33.7209%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0323, Accuracy: 329/774 (42.5065%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0115, Accuracy: 80/10000 (0.8000%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   1, Avg loss: 0.0573, Accuracy: 446/1750 (25.4857%)
_Train Local_ResNet_18, epoch  71, local model 44, internal_epoch   2, Avg loss: 0.0336, Accuracy: 753/1750 (43.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7743, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   1, Avg loss: 0.0492, Accuracy: 462/1574 (29.3520%)
_Train Local_ResNet_18, epoch  71, local model 17, internal_epoch   2, Avg loss: 0.0245, Accuracy: 749/1574 (47.5858%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.2050, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   1, Avg loss: 0.0467, Accuracy: 391/1275 (30.6667%)
_Train Local_ResNet_18, epoch  71, local model 9, internal_epoch   2, Avg loss: 0.0179, Accuracy: 760/1275 (59.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.1616, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 422/1949 (21.6521%)
_Train Local_ResNet_18, epoch  71, local model 21, internal_epoch   2, Avg loss: 0.0318, Accuracy: 658/1949 (33.7609%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5031, Accuracy: 69/10000 (0.6900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  71, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.9567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   1, Avg loss: 0.0564, Accuracy: 282/1049 (26.8827%)
_Train Local_ResNet_18, epoch  71, local model 51, internal_epoch   2, Avg loss: 0.0266, Accuracy: 578/1049 (55.1001%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5227, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   1, Avg loss: 0.0539, Accuracy: 460/1418 (32.4401%)
_Train Local_ResNet_18, epoch  71, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 686/1418 (48.3780%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.9373, Accuracy: 113/10000 (1.1300%)
time spent on training: 279.8990933895111
[rfa agg] training data poison_ratio: 0.20468804461484838  data num: [891, 197, 774, 1750, 1574, 1275, 1949, 599, 1049, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06396501394214012
[rfa agg] init. name: [7, 79, 81, 44, 17, 9, 21, 95, 51, 70], weight: tensor([0.0776, 0.0172, 0.0674, 0.1525, 0.1372, 0.1111, 0.1698, 0.0522, 0.0914,
        0.1236])
[rfa agg] iter:  0, prev_obj_val: 56.411705017089844, obj_val: 61.0361213684082, abs dis: 4.624416351318359
[rfa agg] iter: 0, weight: tensor([0.0427, 0.0036, 0.0319, 0.0630, 0.0902, 0.4740, 0.0511, 0.0173, 0.0958,
        0.1304])
[rfa agg] iter:  1, prev_obj_val: 61.0361213684082, obj_val: 61.00182342529297, abs dis: 0.034297943115234375
[rfa agg] iter: 1, weight: tensor([0.0720, 0.0050, 0.0517, 0.0679, 0.0890, 0.3017, 0.0575, 0.0260, 0.2149,
        0.1142])
[rfa agg] iter:  2, prev_obj_val: 61.00182342529297, obj_val: 62.77136993408203, abs dis: 1.7695465087890625
[rfa agg] iter: 2, weight: tensor([0.0721, 0.0050, 0.0518, 0.0679, 0.0890, 0.2924, 0.0575, 0.0260, 0.2240,
        0.1142])
[rfa agg] iter:  3, prev_obj_val: 62.77136993408203, obj_val: 62.762603759765625, abs dis: 0.00876617431640625
[rfa agg] iter: 3, weight: tensor([0.0809, 0.0052, 0.0570, 0.0648, 0.0831, 0.2268, 0.0555, 0.0278, 0.2954,
        0.1036])
[rfa agg] iter:  4, prev_obj_val: 62.762603759765625, obj_val: 64.59911346435547, abs dis: 1.8365097045898438
[rfa agg] iter: 4, weight: tensor([0.0802, 0.0052, 0.0565, 0.0642, 0.0823, 0.2225, 0.0550, 0.0275, 0.3042,
        0.1026])
[rfa agg] iter:  5, prev_obj_val: 64.59911346435547, obj_val: 64.58547973632812, abs dis: 0.01363372802734375
[rfa agg] iter: 5, weight: tensor([0.0847, 0.0050, 0.0583, 0.0570, 0.0716, 0.1689, 0.0494, 0.0273, 0.3907,
        0.0872])
[rfa agg] iter:  6, prev_obj_val: 64.58547973632812, obj_val: 66.5741958618164, abs dis: 1.9887161254882812
[rfa agg] iter: 6, weight: tensor([0.0817, 0.0048, 0.0563, 0.0551, 0.0692, 0.1621, 0.0477, 0.0264, 0.4125,
        0.0842])
[rfa agg] iter:  7, prev_obj_val: 66.5741958618164, obj_val: 71.33189392089844, abs dis: 4.757698059082031
[rfa agg] iter: 7, weight: tensor([0.0856, 0.0046, 0.0574, 0.0478, 0.0591, 0.1244, 0.0419, 0.0257, 0.4831,
        0.0704])
[rfa agg] iter:  8, prev_obj_val: 71.33189392089844, obj_val: 68.86090850830078, abs dis: 2.4709854125976562
[rfa agg] iter: 8, weight: tensor([0.1520, 0.0062, 0.0945, 0.0551, 0.0661, 0.1186, 0.0492, 0.0376, 0.3447,
        0.0761])
[rfa agg] iter:  9, prev_obj_val: 68.86090850830078, obj_val: 73.84225463867188, abs dis: 4.981346130371094
[rfa agg] iter: 9, weight: tensor([0.1176, 0.0055, 0.0754, 0.0528, 0.0642, 0.1239, 0.0466, 0.0319, 0.4071,
        0.0751])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3328, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.4893, Accuracy: 2556/9950 (25.6884%)
saving model
Done in 459.9416837692261 sec.
Server Epoch:72 choose agents : [52, 6, 79, 96, 87, 25, 35, 83, 19, 89].
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1, Avg loss: 0.0529, Accuracy: 286/636 (44.9686%)
_Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2, Avg loss: 0.0275, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6086, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1, Avg loss: 0.0518, Accuracy: 451/1956 (23.0573%)
_Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2, Avg loss: 0.0300, Accuracy: 701/1956 (35.8384%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4073, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   1, Avg loss: 0.1058, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  72, local model 79, internal_epoch   2, Avg loss: 0.0869, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.4742, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 26/311 (8.3601%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0509, Accuracy: 142/311 (45.6592%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.1303, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0566, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 419/1131 (37.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3970, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   1, Avg loss: 0.0517, Accuracy: 326/690 (47.2464%)
_Train Local_ResNet_18, epoch  72, local model 25, internal_epoch   2, Avg loss: 0.0229, Accuracy: 473/690 (68.5507%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.2828, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   1, Avg loss: 0.0884, Accuracy: 14/271 (5.1661%)
_Train Local_ResNet_18, epoch  72, local model 35, internal_epoch   2, Avg loss: 0.0548, Accuracy: 133/271 (49.0775%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.4224, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 462/1953 (23.6559%)
_Train Local_ResNet_18, epoch  72, local model 83, internal_epoch   2, Avg loss: 0.0319, Accuracy: 803/1953 (41.1162%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.5503, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0477, Accuracy: 403/1036 (38.8996%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 694/1036 (66.9884%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.9443, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   1, Avg loss: 0.0535, Accuracy: 374/896 (41.7411%)
_Train Local_ResNet_18, epoch  72, local model 89, internal_epoch   2, Avg loss: 0.0312, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.3222, Accuracy: 61/10000 (0.6100%)
time spent on training: 222.2671082019806
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1956, 197, 311, 1131, 690, 271, 1953, 1036, 896]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 6, 79, 96, 87, 25, 35, 83, 19, 89], weight: tensor([0.0701, 0.2155, 0.0217, 0.0343, 0.1246, 0.0760, 0.0299, 0.2152, 0.1141,
        0.0987])
[rfa agg] iter:  0, prev_obj_val: 76.00946044921875, obj_val: 79.20142364501953, abs dis: 3.1919631958007812
[rfa agg] iter: 0, weight: tensor([0.0282, 0.0590, 0.0051, 0.0087, 0.4914, 0.0346, 0.0076, 0.0589, 0.2325,
        0.0741])
[rfa agg] iter:  1, prev_obj_val: 79.20142364501953, obj_val: 80.6267318725586, abs dis: 1.4253082275390625
[rfa agg] iter: 1, weight: tensor([0.0439, 0.0543, 0.0068, 0.0118, 0.2312, 0.0571, 0.0103, 0.0542, 0.3557,
        0.1748])
[rfa agg] iter:  2, prev_obj_val: 80.6267318725586, obj_val: 82.14424133300781, abs dis: 1.5175094604492188
[rfa agg] iter: 2, weight: tensor([0.0515, 0.0566, 0.0077, 0.0133, 0.1974, 0.0682, 0.0116, 0.0565, 0.2922,
        0.2451])
[rfa agg] iter:  3, prev_obj_val: 82.14424133300781, obj_val: 83.71006774902344, abs dis: 1.565826416015625
[rfa agg] iter: 3, weight: tensor([0.0560, 0.0543, 0.0080, 0.0138, 0.1642, 0.0757, 0.0121, 0.0542, 0.2212,
        0.3405])
[rfa agg] iter:  4, prev_obj_val: 83.71006774902344, obj_val: 85.42547607421875, abs dis: 1.7154083251953125
[rfa agg] iter: 4, weight: tensor([0.0537, 0.0455, 0.0072, 0.0126, 0.1223, 0.0745, 0.0110, 0.0455, 0.1544,
        0.4733])
[rfa agg] iter:  5, prev_obj_val: 85.42547607421875, obj_val: 87.58418273925781, abs dis: 2.1587066650390625
[rfa agg] iter: 5, weight: tensor([0.0456, 0.0335, 0.0057, 0.0101, 0.0813, 0.0652, 0.0088, 0.0334, 0.0979,
        0.6185])
[rfa agg] iter:  6, prev_obj_val: 87.58418273925781, obj_val: 85.40597534179688, abs dis: 2.1782073974609375
[rfa agg] iter: 6, weight: tensor([0.0630, 0.0396, 0.0073, 0.0130, 0.0880, 0.0935, 0.0113, 0.0395, 0.1024,
        0.5424])
[rfa agg] iter:  7, prev_obj_val: 85.40597534179688, obj_val: 89.96328735351562, abs dis: 4.55731201171875
[rfa agg] iter: 7, weight: tensor([0.0418, 0.0307, 0.0053, 0.0092, 0.0744, 0.0598, 0.0080, 0.0307, 0.0895,
        0.6506])
[rfa agg] iter:  8, prev_obj_val: 89.96328735351562, obj_val: 87.58927917480469, abs dis: 2.3740081787109375
[rfa agg] iter: 8, weight: tensor([0.0942, 0.0498, 0.0100, 0.0178, 0.1027, 0.1471, 0.0155, 0.0497, 0.1166,
        0.3964])
[rfa agg] iter:  9, prev_obj_val: 87.58927917480469, obj_val: 89.92253112792969, abs dis: 2.333251953125
[rfa agg] iter: 9, weight: tensor([0.0692, 0.0433, 0.0080, 0.0142, 0.0964, 0.1038, 0.0124, 0.0432, 0.1124,
        0.4972])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3329, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.5223, Accuracy: 2080/9950 (20.9045%)
saving model
Done in 396.24248576164246 sec.
Server Epoch:73 choose agents : [33, 18, 68, 97, 36, 30, 4, 67, 23, 21].
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 97/515 (18.8350%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0515, Accuracy: 157/515 (30.4854%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2473, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   1, Avg loss: 0.0674, Accuracy: 164/530 (30.9434%)
_Train Local_ResNet_18, epoch  73, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5316, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   1, Avg loss: 0.0566, Accuracy: 394/1163 (33.8779%)
_Train Local_ResNet_18, epoch  73, local model 68, internal_epoch   2, Avg loss: 0.0349, Accuracy: 510/1163 (43.8521%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3716, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1, Avg loss: 0.0514, Accuracy: 359/1213 (29.5960%)
_Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2, Avg loss: 0.0264, Accuracy: 593/1213 (48.8871%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0231, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0795, Accuracy: 82/408 (20.0980%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0460, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3026, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   1, Avg loss: 0.0705, Accuracy: 106/486 (21.8107%)
_Train Local_ResNet_18, epoch  73, local model 30, internal_epoch   2, Avg loss: 0.0373, Accuracy: 222/486 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5180, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0570, Accuracy: 346/901 (38.4018%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0304, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.6036, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   1, Avg loss: 0.0713, Accuracy: 89/426 (20.8920%)
_Train Local_ResNet_18, epoch  73, local model 67, internal_epoch   2, Avg loss: 0.0373, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3624, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 297/715 (41.5385%)
_Train Local_ResNet_18, epoch  73, local model 23, internal_epoch   2, Avg loss: 0.0355, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1866, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 427/1949 (21.9087%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 648/1949 (33.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6424, Accuracy: 85/10000 (0.8500%)
time spent on training: 257.8100335597992
[rfa agg] training data poison_ratio: 0.05851191909463039  data num: [515, 530, 1163, 1213, 408, 486, 901, 426, 715, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.018284974717071998
[rfa agg] init. name: [33, 18, 68, 97, 36, 30, 4, 67, 23, 21], weight: tensor([0.0620, 0.0638, 0.1400, 0.1460, 0.0491, 0.0585, 0.1085, 0.0513, 0.0861,
        0.2346])
[rfa agg] iter:  0, prev_obj_val: 64.26824188232422, obj_val: 67.67455291748047, abs dis: 3.40631103515625
[rfa agg] iter: 0, weight: tensor([0.0344, 0.0354, 0.1417, 0.1484, 0.0209, 0.0282, 0.4271, 0.0218, 0.0873,
        0.0548])
[rfa agg] iter:  1, prev_obj_val: 67.67455291748047, obj_val: 68.81069946289062, abs dis: 1.1361465454101562
[rfa agg] iter: 1, weight: tensor([0.0570, 0.0589, 0.1056, 0.1104, 0.0316, 0.0444, 0.2880, 0.0330, 0.2151,
        0.0561])
[rfa agg] iter:  2, prev_obj_val: 68.81069946289062, obj_val: 71.38420104980469, abs dis: 2.5735015869140625
[rfa agg] iter: 2, weight: tensor([0.0624, 0.0646, 0.0944, 0.0986, 0.0333, 0.0476, 0.2117, 0.0348, 0.2995,
        0.0531])
[rfa agg] iter:  3, prev_obj_val: 71.38420104980469, obj_val: 74.93844604492188, abs dis: 3.5542449951171875
[rfa agg] iter: 3, weight: tensor([0.0620, 0.0646, 0.0611, 0.0638, 0.0301, 0.0447, 0.1083, 0.0314, 0.4962,
        0.0379])
[rfa agg] iter:  4, prev_obj_val: 74.93844604492188, obj_val: 76.82743835449219, abs dis: 1.8889923095703125
[rfa agg] iter: 4, weight: tensor([0.1128, 0.1197, 0.0672, 0.0702, 0.0472, 0.0744, 0.1026, 0.0492, 0.3116,
        0.0452])
[rfa agg] iter:  5, prev_obj_val: 76.82743835449219, obj_val: 82.99858856201172, abs dis: 6.171150207519531
[rfa agg] iter: 5, weight: tensor([0.1506, 0.1614, 0.0645, 0.0674, 0.0550, 0.0910, 0.0935, 0.0573, 0.2143,
        0.0450])
[rfa agg] iter:  6, prev_obj_val: 82.99858856201172, obj_val: 88.83273315429688, abs dis: 5.834144592285156
[rfa agg] iter: 6, weight: tensor([0.2366, 0.3596, 0.0297, 0.0310, 0.0517, 0.1170, 0.0381, 0.0537, 0.0600,
        0.0227])
[rfa agg] iter:  7, prev_obj_val: 88.83273315429688, obj_val: 88.78607940673828, abs dis: 0.04665374755859375
[rfa agg] iter: 7, weight: tensor([0.1238, 0.1353, 0.0280, 0.0293, 0.1040, 0.3689, 0.0340, 0.1074, 0.0469,
        0.0225])
[rfa agg] iter:  8, prev_obj_val: 88.78607940673828, obj_val: 100.24215698242188, abs dis: 11.456077575683594
[rfa agg] iter: 8, weight: tensor([0.1030, 0.1119, 0.0238, 0.0248, 0.0888, 0.4684, 0.0288, 0.0917, 0.0397,
        0.0191])
[rfa agg] iter:  9, prev_obj_val: 100.24215698242188, obj_val: 95.93392944335938, abs dis: 4.3082275390625
[rfa agg] iter: 9, weight: tensor([0.0758, 0.0788, 0.0349, 0.0364, 0.2665, 0.1208, 0.0397, 0.2687, 0.0485,
        0.0299])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3339, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 4.5484, Accuracy: 1704/9950 (17.1256%)
saving model
Done in 428.7677125930786 sec.
Server Epoch:74 choose agents : [28, 44, 36, 74, 4, 77, 86, 13, 63, 93].
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0542, Accuracy: 413/1581 (26.1227%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0314, Accuracy: 686/1581 (43.3903%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8684, Accuracy: 109/10000 (1.0900%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0576, Accuracy: 409/1750 (23.3714%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0334, Accuracy: 712/1750 (40.6857%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6457, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   1, Avg loss: 0.0768, Accuracy: 101/408 (24.7549%)
_Train Local_ResNet_18, epoch  74, local model 36, internal_epoch   2, Avg loss: 0.0463, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.0794, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0421, Accuracy: 532/1552 (34.2784%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0202, Accuracy: 814/1552 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.5094, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0545, Accuracy: 344/901 (38.1798%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0294, Accuracy: 456/901 (50.6104%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3049, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   1, Avg loss: 0.0482, Accuracy: 355/1340 (26.4925%)
_Train Local_ResNet_18, epoch  74, local model 77, internal_epoch   2, Avg loss: 0.0249, Accuracy: 634/1340 (47.3134%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9743, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   1, Avg loss: 0.0571, Accuracy: 363/1003 (36.1914%)
_Train Local_ResNet_18, epoch  74, local model 86, internal_epoch   2, Avg loss: 0.0312, Accuracy: 413/1003 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6766, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   1, Avg loss: 0.0532, Accuracy: 409/1645 (24.8632%)
_Train Local_ResNet_18, epoch  74, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 759/1645 (46.1398%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1477, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0486, Accuracy: 316/888 (35.5856%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0236, Accuracy: 480/888 (54.0541%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.4425, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 439/1742 (25.2009%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0296, Accuracy: 779/1742 (44.7187%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0608, Accuracy: 97/10000 (0.9700%)
time spent on training: 321.3830120563507
[rfa agg] training data poison_ratio: 0.2577673692427791  data num: [1581, 1750, 408, 1552, 901, 1340, 1003, 1645, 888, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.08055230288836847
[rfa agg] init. name: [28, 44, 36, 74, 4, 77, 86, 13, 63, 93], weight: tensor([0.1234, 0.1366, 0.0319, 0.1212, 0.0703, 0.1046, 0.0783, 0.1284, 0.0693,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 50.370765686035156, obj_val: 52.34919357299805, abs dis: 1.9784278869628906
[rfa agg] iter: 0, weight: tensor([0.1048, 0.0704, 0.0092, 0.1030, 0.0493, 0.3961, 0.0666, 0.0894, 0.0412,
        0.0700])
[rfa agg] iter:  1, prev_obj_val: 52.34919357299805, obj_val: 56.725547790527344, abs dis: 4.376354217529297
[rfa agg] iter: 1, weight: tensor([0.1015, 0.0708, 0.0102, 0.0997, 0.0580, 0.3738, 0.0797, 0.0880, 0.0479,
        0.0705])
[rfa agg] iter:  2, prev_obj_val: 56.725547790527344, obj_val: 54.51800537109375, abs dis: 2.2075424194335938
[rfa agg] iter: 2, weight: tensor([0.1032, 0.0766, 0.0134, 0.1014, 0.0875, 0.2531, 0.1269, 0.0920, 0.0696,
        0.0762])
[rfa agg] iter:  3, prev_obj_val: 54.51800537109375, obj_val: 52.35416793823242, abs dis: 2.163837432861328
[rfa agg] iter: 3, weight: tensor([0.1056, 0.0761, 0.0121, 0.1037, 0.0735, 0.2968, 0.1039, 0.0929, 0.0596,
        0.0757])
[rfa agg] iter:  4, prev_obj_val: 52.35416793823242, obj_val: 50.24983215332031, abs dis: 2.1043357849121094
[rfa agg] iter: 4, weight: tensor([0.1032, 0.0720, 0.0104, 0.1014, 0.0591, 0.3626, 0.0813, 0.0895, 0.0487,
        0.0717])
[rfa agg] iter:  5, prev_obj_val: 50.24983215332031, obj_val: 52.355323791503906, abs dis: 2.1054916381835938
[rfa agg] iter: 5, weight: tensor([0.0948, 0.0637, 0.0083, 0.0931, 0.0446, 0.4541, 0.0601, 0.0808, 0.0373,
        0.0633])
[rfa agg] iter:  6, prev_obj_val: 52.355323791503906, obj_val: 56.726924896240234, abs dis: 4.371601104736328
[rfa agg] iter: 6, weight: tensor([0.1005, 0.0702, 0.0101, 0.0987, 0.0574, 0.3799, 0.0788, 0.0872, 0.0474,
        0.0698])
[rfa agg] iter:  7, prev_obj_val: 56.726924896240234, obj_val: 54.517982482910156, abs dis: 2.208942413330078
[rfa agg] iter: 7, weight: tensor([0.1032, 0.0766, 0.0134, 0.1013, 0.0875, 0.2533, 0.1269, 0.0920, 0.0696,
        0.0762])
[rfa agg] iter:  8, prev_obj_val: 54.517982482910156, obj_val: 52.35416793823242, abs dis: 2.1638145446777344
[rfa agg] iter: 8, weight: tensor([0.1056, 0.0761, 0.0121, 0.1037, 0.0735, 0.2968, 0.1039, 0.0929, 0.0596,
        0.0757])
[rfa agg] iter:  9, prev_obj_val: 52.35416793823242, obj_val: 50.24983215332031, abs dis: 2.1043357849121094
[rfa agg] iter: 9, weight: tensor([0.1032, 0.0720, 0.0104, 0.1014, 0.0591, 0.3626, 0.0813, 0.0895, 0.0487,
        0.0717])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3329, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 4.5877, Accuracy: 1243/9950 (12.4925%)
saving model
Done in 496.3516044616699 sec.
Server Epoch:75 choose agents : [9, 40, 44, 67, 53, 47, 1, 98, 99, 57].
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1, Avg loss: 0.0457, Accuracy: 422/1275 (33.0980%)
_Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2, Avg loss: 0.0169, Accuracy: 811/1275 (63.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.0201, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0563, Accuracy: 378/1573 (24.0305%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0335, Accuracy: 614/1573 (39.0337%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9634, Accuracy: 80/10000 (0.8000%)
poison local model 44 index 6 
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   1, Avg loss: 0.0562, Accuracy: 472/1750 (26.9714%)
_Train Local_ResNet_18, epoch  75, local model 44, internal_epoch   2, Avg loss: 0.0337, Accuracy: 710/1750 (40.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5451, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   1, Avg loss: 0.0691, Accuracy: 96/426 (22.5352%)
_Train Local_ResNet_18, epoch  75, local model 67, internal_epoch   2, Avg loss: 0.0366, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6298, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 303/813 (37.2694%)
_Train Local_ResNet_18, epoch  75, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 491/813 (60.3936%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.8829, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   1, Avg loss: 0.1175, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  75, local model 47, internal_epoch   2, Avg loss: 0.1049, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3674, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0524, Accuracy: 355/928 (38.2543%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0210, Accuracy: 636/928 (68.5345%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7348, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   1, Avg loss: 0.0764, Accuracy: 72/373 (19.3029%)
_Train Local_ResNet_18, epoch  75, local model 98, internal_epoch   2, Avg loss: 0.0445, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8631, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   1, Avg loss: 0.0539, Accuracy: 294/773 (38.0336%)
_Train Local_ResNet_18, epoch  75, local model 99, internal_epoch   2, Avg loss: 0.0262, Accuracy: 457/773 (59.1203%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.8980, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1, Avg loss: 0.0527, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 570/1154 (49.3934%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.9099, Accuracy: 66/10000 (0.6600%)
time spent on training: 275.99952363967896
[rfa agg] training data poison_ratio: 0.19023806935536472  data num: [1275, 1573, 1750, 426, 813, 134, 928, 373, 773, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.05944939667355147
[rfa agg] init. name: [9, 40, 44, 67, 53, 47, 1, 98, 99, 57], weight: tensor([0.1386, 0.1710, 0.1902, 0.0463, 0.0884, 0.0146, 0.1009, 0.0405, 0.0840,
        0.1254])
[rfa agg] iter:  0, prev_obj_val: 55.52980422973633, obj_val: 56.595394134521484, abs dis: 1.0655899047851562
[rfa agg] iter: 0, weight: tensor([0.1874, 0.0888, 0.0721, 0.0193, 0.0909, 0.0043, 0.1975, 0.0154, 0.0869,
        0.2373])
[rfa agg] iter:  1, prev_obj_val: 56.595394134521484, obj_val: 58.947593688964844, abs dis: 2.3521995544433594
[rfa agg] iter: 1, weight: tensor([0.1601, 0.0824, 0.0681, 0.0201, 0.1020, 0.0045, 0.2526, 0.0159, 0.0977,
        0.1966])
[rfa agg] iter:  2, prev_obj_val: 58.947593688964844, obj_val: 64.08663940429688, abs dis: 5.139045715332031
[rfa agg] iter: 2, weight: tensor([0.1008, 0.0593, 0.0503, 0.0180, 0.1128, 0.0039, 0.4169, 0.0141, 0.1086,
        0.1153])
[rfa agg] iter:  3, prev_obj_val: 64.08663940429688, obj_val: 68.60006713867188, abs dis: 4.513427734375
[rfa agg] iter: 3, weight: tensor([0.0705, 0.0476, 0.0417, 0.0203, 0.2210, 0.0041, 0.2797, 0.0156, 0.2238,
        0.0757])
[rfa agg] iter:  4, prev_obj_val: 68.60006713867188, obj_val: 71.62281036376953, abs dis: 3.0227432250976562
[rfa agg] iter: 4, weight: tensor([0.0428, 0.0309, 0.0276, 0.0167, 0.3259, 0.0032, 0.1052, 0.0126, 0.3903,
        0.0449])
[rfa agg] iter:  5, prev_obj_val: 71.62281036376953, obj_val: 75.04720306396484, abs dis: 3.4243927001953125
[rfa agg] iter: 5, weight: tensor([0.0483, 0.0358, 0.0322, 0.0220, 0.3335, 0.0040, 0.1015, 0.0164, 0.3561,
        0.0501])
[rfa agg] iter:  6, prev_obj_val: 75.04720306396484, obj_val: 71.62677764892578, abs dis: 3.4204254150390625
[rfa agg] iter: 6, weight: tensor([0.0642, 0.0489, 0.0442, 0.0343, 0.2973, 0.0060, 0.1215, 0.0251, 0.2922,
        0.0661])
[rfa agg] iter:  7, prev_obj_val: 71.62677764892578, obj_val: 75.04669189453125, abs dis: 3.4199142456054688
[rfa agg] iter: 7, weight: tensor([0.0493, 0.0366, 0.0329, 0.0225, 0.3350, 0.0041, 0.1040, 0.0167, 0.3477,
        0.0512])
[rfa agg] iter:  8, prev_obj_val: 75.04669189453125, obj_val: 71.62678527832031, abs dis: 3.4199066162109375
[rfa agg] iter: 8, weight: tensor([0.0643, 0.0489, 0.0443, 0.0343, 0.2976, 0.0060, 0.1216, 0.0251, 0.2919,
        0.0661])
[rfa agg] iter:  9, prev_obj_val: 71.62678527832031, obj_val: 75.04670715332031, abs dis: 3.419921875
[rfa agg] iter: 9, weight: tensor([0.0493, 0.0366, 0.0329, 0.0225, 0.3351, 0.0041, 0.1040, 0.0167, 0.3476,
        0.0512])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3325, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 4.6196, Accuracy: 936/9950 (9.4070%)
saving model
Done in 448.4570586681366 sec.
Server Epoch:76 choose agents : [93, 69, 79, 90, 4, 59, 86, 13, 22, 68].
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0531, Accuracy: 467/1742 (26.8083%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 787/1742 (45.1780%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2136, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1, Avg loss: 0.0595, Accuracy: 286/590 (48.4746%)
_Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.9928, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   1, Avg loss: 0.1054, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch  76, local model 79, internal_epoch   2, Avg loss: 0.0844, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.4698, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   1, Avg loss: 0.0537, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  76, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.7686, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0571, Accuracy: 345/901 (38.2908%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0303, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   1, Avg loss: 0.0500, Accuracy: 342/1089 (31.4050%)
_Train Local_ResNet_18, epoch  76, local model 59, internal_epoch   2, Avg loss: 0.0301, Accuracy: 533/1089 (48.9440%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 18.4125, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   1, Avg loss: 0.0568, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  76, local model 86, internal_epoch   2, Avg loss: 0.0313, Accuracy: 420/1003 (41.8744%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7322, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   1, Avg loss: 0.0528, Accuracy: 427/1645 (25.9574%)
_Train Local_ResNet_18, epoch  76, local model 13, internal_epoch   2, Avg loss: 0.0297, Accuracy: 767/1645 (46.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1427, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   1, Avg loss: 0.0434, Accuracy: 588/1470 (40.0000%)
_Train Local_ResNet_18, epoch  76, local model 22, internal_epoch   2, Avg loss: 0.0227, Accuracy: 920/1470 (62.5850%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0797, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   1, Avg loss: 0.0580, Accuracy: 390/1163 (33.5340%)
_Train Local_ResNet_18, epoch  76, local model 68, internal_epoch   2, Avg loss: 0.0331, Accuracy: 531/1163 (45.6578%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.6104, Accuracy: 69/10000 (0.6900%)
time spent on training: 268.4721076488495
[rfa agg] training data poison_ratio: 0.0  data num: [1742, 590, 197, 677, 901, 1089, 1003, 1645, 1470, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [93, 69, 79, 90, 4, 59, 86, 13, 22, 68], weight: tensor([0.1663, 0.0563, 0.0188, 0.0646, 0.0860, 0.1039, 0.0957, 0.1570, 0.1403,
        0.1110])
[rfa agg] iter:  0, prev_obj_val: 48.48528289794922, obj_val: 55.559600830078125, abs dis: 7.074317932128906
[rfa agg] iter: 0, weight: tensor([0.0476, 0.0181, 0.0035, 0.0235, 0.0657, 0.2491, 0.1001, 0.0568, 0.0839,
        0.3518])
[rfa agg] iter:  1, prev_obj_val: 55.559600830078125, obj_val: 60.188961029052734, abs dis: 4.629360198974609
[rfa agg] iter: 1, weight: tensor([0.0402, 0.0272, 0.0046, 0.0374, 0.1971, 0.1388, 0.3453, 0.0455, 0.0579,
        0.1059])
[rfa agg] iter:  2, prev_obj_val: 60.188961029052734, obj_val: 57.60942077636719, abs dis: 2.579540252685547
[rfa agg] iter: 2, weight: tensor([0.0370, 0.0325, 0.0050, 0.0464, 0.3698, 0.0956, 0.2427, 0.0413, 0.0506,
        0.0791])
[rfa agg] iter:  3, prev_obj_val: 57.60942077636719, obj_val: 63.056392669677734, abs dis: 5.446971893310547
[rfa agg] iter: 3, weight: tensor([0.0352, 0.0271, 0.0043, 0.0378, 0.3160, 0.1020, 0.3067, 0.0395, 0.0493,
        0.0822])
[rfa agg] iter:  4, prev_obj_val: 63.056392669677734, obj_val: 60.1348762512207, abs dis: 2.9215164184570312
[rfa agg] iter: 4, weight: tensor([0.0410, 0.0415, 0.0060, 0.0607, 0.3764, 0.0952, 0.1978, 0.0454, 0.0548,
        0.0811])
[rfa agg] iter:  5, prev_obj_val: 60.1348762512207, obj_val: 66.15032958984375, abs dis: 6.015453338623047
[rfa agg] iter: 5, weight: tensor([0.0334, 0.0294, 0.0045, 0.0419, 0.4443, 0.0859, 0.2062, 0.0373, 0.0457,
        0.0714])
[rfa agg] iter:  6, prev_obj_val: 66.15032958984375, obj_val: 66.13720703125, abs dis: 0.01312255859375
[rfa agg] iter: 6, weight: tensor([0.0478, 0.0564, 0.0076, 0.0851, 0.3157, 0.1015, 0.1822, 0.0526, 0.0626,
        0.0885])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3322, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 4.6353, Accuracy: 864/9950 (8.6834%)
saving model
Done in 438.5422365665436 sec.
Server Epoch:77 choose agents : [5, 77, 11, 59, 88, 41, 18, 93, 98, 37].
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   1, Avg loss: 0.0468, Accuracy: 474/1628 (29.1155%)
_Train Local_ResNet_18, epoch  77, local model 5, internal_epoch   2, Avg loss: 0.0232, Accuracy: 910/1628 (55.8968%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.0512, Accuracy: 156/10000 (1.5600%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   1, Avg loss: 0.0461, Accuracy: 406/1340 (30.2985%)
_Train Local_ResNet_18, epoch  77, local model 77, internal_epoch   2, Avg loss: 0.0244, Accuracy: 614/1340 (45.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.2339, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1, Avg loss: 0.0543, Accuracy: 295/712 (41.4326%)
_Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 440/712 (61.7978%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6442, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0495, Accuracy: 365/1089 (33.5170%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0244, Accuracy: 590/1089 (54.1781%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8150, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0669, Accuracy: 179/603 (29.6849%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0426, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9072, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   1, Avg loss: 0.0573, Accuracy: 321/719 (44.6453%)
_Train Local_ResNet_18, epoch  77, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2892, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   1, Avg loss: 0.0681, Accuracy: 152/530 (28.6792%)
_Train Local_ResNet_18, epoch  77, local model 18, internal_epoch   2, Avg loss: 0.0333, Accuracy: 290/530 (54.7170%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.5450, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0533, Accuracy: 456/1742 (26.1768%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 755/1742 (43.3410%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6414, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0766, Accuracy: 58/373 (15.5496%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0441, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.8588, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   1, Avg loss: 0.0450, Accuracy: 552/1129 (48.8928%)
_Train Local_ResNet_18, epoch  77, local model 37, internal_epoch   2, Avg loss: 0.0209, Accuracy: 792/1129 (70.1506%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.3470, Accuracy: 116/10000 (1.1600%)
time spent on training: 239.13336730003357
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1340, 712, 1089, 603, 719, 530, 1742, 373, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 77, 11, 59, 88, 41, 18, 93, 98, 37], weight: tensor([0.1650, 0.1358, 0.0722, 0.1104, 0.0611, 0.0729, 0.0537, 0.1766, 0.0378,
        0.1144])
[rfa agg] iter:  0, prev_obj_val: 59.7606201171875, obj_val: 65.01769256591797, abs dis: 5.257072448730469
[rfa agg] iter: 0, weight: tensor([0.0760, 0.1238, 0.0826, 0.2311, 0.0469, 0.0826, 0.0354, 0.0679, 0.0175,
        0.2364])
[rfa agg] iter:  1, prev_obj_val: 65.01769256591797, obj_val: 68.62101745605469, abs dis: 3.6033248901367188
[rfa agg] iter: 1, weight: tensor([0.0737, 0.1068, 0.1450, 0.1584, 0.0694, 0.1428, 0.0501, 0.0673, 0.0229,
        0.1637])
[rfa agg] iter:  2, prev_obj_val: 68.62101745605469, obj_val: 68.61017608642578, abs dis: 0.01084136962890625
[rfa agg] iter: 2, weight: tensor([0.0610, 0.0833, 0.2116, 0.1115, 0.0799, 0.2028, 0.0549, 0.0563, 0.0233,
        0.1153])
[rfa agg] iter:  3, prev_obj_val: 68.61017608642578, obj_val: 70.45215606689453, abs dis: 1.84197998046875
[rfa agg] iter: 3, weight: tensor([0.0606, 0.0828, 0.2127, 0.1106, 0.0796, 0.2056, 0.0546, 0.0560, 0.0232,
        0.1144])
[rfa agg] iter:  4, prev_obj_val: 70.45215606689453, obj_val: 74.52971649169922, abs dis: 4.0775604248046875
[rfa agg] iter: 4, weight: tensor([0.0503, 0.0670, 0.2626, 0.0862, 0.0798, 0.2438, 0.0529, 0.0467, 0.0214,
        0.0892])
[rfa agg] iter:  5, prev_obj_val: 74.52971649169922, obj_val: 83.3721923828125, abs dis: 8.842475891113281
[rfa agg] iter: 5, weight: tensor([0.0275, 0.0352, 0.4132, 0.0425, 0.0696, 0.2861, 0.0414, 0.0258, 0.0147,
        0.0440])
[rfa agg] iter:  6, prev_obj_val: 83.3721923828125, obj_val: 90.07209777832031, abs dis: 6.6999053955078125
[rfa agg] iter: 6, weight: tensor([0.0373, 0.0452, 0.1647, 0.0512, 0.3051, 0.1602, 0.1185, 0.0354, 0.0293,
        0.0530])
[rfa agg] iter:  7, prev_obj_val: 90.07209777832031, obj_val: 90.06089782714844, abs dis: 0.011199951171875
[rfa agg] iter: 7, weight: tensor([0.0330, 0.0390, 0.0940, 0.0427, 0.3287, 0.0937, 0.2576, 0.0315, 0.0355,
        0.0442])
[rfa agg] iter:  8, prev_obj_val: 90.06089782714844, obj_val: 90.06079864501953, abs dis: 9.918212890625e-05
[rfa agg] iter: 8, weight: tensor([0.0324, 0.0383, 0.0921, 0.0419, 0.3227, 0.0916, 0.2717, 0.0310, 0.0349,
        0.0434])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3329, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 4.6573, Accuracy: 661/9950 (6.6432%)
saving model
Done in 418.1171250343323 sec.
Server Epoch:78 choose agents : [65, 18, 30, 33, 53, 94, 76, 64, 0, 29].
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   1, Avg loss: 0.0518, Accuracy: 463/1475 (31.3898%)
_Train Local_ResNet_18, epoch  78, local model 65, internal_epoch   2, Avg loss: 0.0283, Accuracy: 729/1475 (49.4237%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5281, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0641, Accuracy: 186/530 (35.0943%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0357, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.8082, Accuracy: 75/10000 (0.7500%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0694, Accuracy: 109/486 (22.4280%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0362, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4114, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 83/515 (16.1165%)
_Train Local_ResNet_18, epoch  78, local model 33, internal_epoch   2, Avg loss: 0.0528, Accuracy: 166/515 (32.2330%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5248, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   1, Avg loss: 0.0454, Accuracy: 324/813 (39.8524%)
_Train Local_ResNet_18, epoch  78, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 501/813 (61.6236%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 12.4823, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 400/1662 (24.0674%)
_Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2, Avg loss: 0.0311, Accuracy: 696/1662 (41.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0611, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0786, Accuracy: 77/466 (16.5236%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0441, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8548, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0617, Accuracy: 211/953 (22.1406%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0356, Accuracy: 338/953 (35.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6073, Accuracy: 77/10000 (0.7700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0557, Accuracy: 352/1657 (21.2432%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 583/1657 (35.1841%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0467, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   1, Avg loss: 0.0505, Accuracy: 418/1440 (29.0278%)
_Train Local_ResNet_18, epoch  78, local model 29, internal_epoch   2, Avg loss: 0.0261, Accuracy: 769/1440 (53.4028%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7437, Accuracy: 94/10000 (0.9400%)
time spent on training: 275.4837718009949
[rfa agg] training data poison_ratio: 0.21436430929278782  data num: [1475, 530, 486, 515, 813, 1662, 466, 953, 1657, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0669888466539962
[rfa agg] init. name: [65, 18, 30, 33, 53, 94, 76, 64, 0, 29], weight: tensor([0.1475, 0.0530, 0.0486, 0.0515, 0.0813, 0.1662, 0.0466, 0.0953, 0.1657,
        0.1440])
[rfa agg] iter:  0, prev_obj_val: 64.97406768798828, obj_val: 68.58694458007812, abs dis: 3.6128768920898438
[rfa agg] iter: 0, weight: tensor([0.1068, 0.0386, 0.0312, 0.0375, 0.1252, 0.0954, 0.0300, 0.3198, 0.0952,
        0.1204])
[rfa agg] iter:  1, prev_obj_val: 68.58694458007812, obj_val: 70.27925872802734, abs dis: 1.6923141479492188
[rfa agg] iter: 1, weight: tensor([0.0480, 0.0260, 0.0204, 0.0252, 0.1157, 0.0444, 0.0196, 0.6034, 0.0444,
        0.0529])
[rfa agg] iter:  2, prev_obj_val: 70.27925872802734, obj_val: 72.22364044189453, abs dis: 1.9443817138671875
[rfa agg] iter: 2, weight: tensor([0.0490, 0.0305, 0.0237, 0.0295, 0.1614, 0.0458, 0.0227, 0.5380, 0.0457,
        0.0536])
[rfa agg] iter:  3, prev_obj_val: 72.22364044189453, obj_val: 78.81117248535156, abs dis: 6.587532043457031
[rfa agg] iter: 3, weight: tensor([0.0568, 0.0408, 0.0313, 0.0396, 0.2789, 0.0535, 0.0300, 0.3540, 0.0534,
        0.0617])
[rfa agg] iter:  4, prev_obj_val: 78.81117248535156, obj_val: 78.78224182128906, abs dis: 0.0289306640625
[rfa agg] iter: 4, weight: tensor([0.0489, 0.0574, 0.0411, 0.0555, 0.4675, 0.0470, 0.0394, 0.1440, 0.0469,
        0.0523])
[rfa agg] iter:  5, prev_obj_val: 78.78224182128906, obj_val: 81.43111419677734, abs dis: 2.6488723754882812
[rfa agg] iter: 5, weight: tensor([0.0464, 0.0545, 0.0390, 0.0527, 0.4959, 0.0446, 0.0373, 0.1353, 0.0445,
        0.0497])
[rfa agg] iter:  6, prev_obj_val: 81.43111419677734, obj_val: 84.09060668945312, abs dis: 2.6594924926757812
[rfa agg] iter: 6, weight: tensor([0.0567, 0.0808, 0.0559, 0.0779, 0.3603, 0.0549, 0.0535, 0.1448, 0.0548,
        0.0605])
[rfa agg] iter:  7, prev_obj_val: 84.09060668945312, obj_val: 78.80438995361328, abs dis: 5.286216735839844
[rfa agg] iter: 7, weight: tensor([0.0605, 0.1074, 0.0709, 0.1033, 0.2699, 0.0589, 0.0678, 0.1385, 0.0587,
        0.0643])
[rfa agg] iter:  8, prev_obj_val: 78.80438995361328, obj_val: 76.276611328125, abs dis: 2.5277786254882812
[rfa agg] iter: 8, weight: tensor([0.0491, 0.0578, 0.0413, 0.0559, 0.4662, 0.0472, 0.0396, 0.1431, 0.0471,
        0.0526])
[rfa agg] iter:  9, prev_obj_val: 76.276611328125, obj_val: 84.13330841064453, abs dis: 7.856697082519531
[rfa agg] iter: 9, weight: tensor([0.0338, 0.0334, 0.0245, 0.0323, 0.6348, 0.0323, 0.0235, 0.1166, 0.0323,
        0.0364])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3358, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 4.6182, Accuracy: 687/9950 (6.9045%)
saving model
Done in 442.3479034900665 sec.
Server Epoch:79 choose agents : [1, 68, 51, 81, 10, 38, 27, 94, 19, 98].
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0516, Accuracy: 352/928 (37.9310%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0215, Accuracy: 647/928 (69.7198%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.7500, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   1, Avg loss: 0.0568, Accuracy: 387/1163 (33.2760%)
_Train Local_ResNet_18, epoch  79, local model 68, internal_epoch   2, Avg loss: 0.0335, Accuracy: 554/1163 (47.6354%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6233, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0544, Accuracy: 276/1049 (26.3108%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0262, Accuracy: 590/1049 (56.2440%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4437, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   1, Avg loss: 0.0626, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch  79, local model 81, internal_epoch   2, Avg loss: 0.0319, Accuracy: 318/774 (41.0853%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0782, Accuracy: 73/10000 (0.7300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   1, Avg loss: 0.0550, Accuracy: 246/861 (28.5714%)
_Train Local_ResNet_18, epoch  79, local model 10, internal_epoch   2, Avg loss: 0.0188, Accuracy: 484/861 (56.2137%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.1063, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   1, Avg loss: 0.0551, Accuracy: 354/1131 (31.2997%)
_Train Local_ResNet_18, epoch  79, local model 38, internal_epoch   2, Avg loss: 0.0273, Accuracy: 537/1131 (47.4801%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4536, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0552, Accuracy: 422/1587 (26.5911%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0320, Accuracy: 635/1587 (40.0126%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8844, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 396/1662 (23.8267%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0309, Accuracy: 706/1662 (42.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3238, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 423/1036 (40.8301%)
_Train Local_ResNet_18, epoch  79, local model 19, internal_epoch   2, Avg loss: 0.0226, Accuracy: 723/1036 (69.7876%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 12.1407, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0765, Accuracy: 52/373 (13.9410%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0446, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.9610, Accuracy: 50/10000 (0.5000%)
time spent on training: 270.327246427536
[rfa agg] training data poison_ratio: 0.0815032184778493  data num: [928, 1163, 1049, 774, 861, 1131, 1587, 1662, 1036, 373]
[rfa agg] considering poison per batch poison_fraction: 0.025469755774327908
[rfa agg] init. name: [1, 68, 51, 81, 10, 38, 27, 94, 19, 98], weight: tensor([0.0878, 0.1101, 0.0993, 0.0733, 0.0815, 0.1071, 0.1502, 0.1573, 0.0981,
        0.0353])
[rfa agg] iter:  0, prev_obj_val: 39.71894454956055, obj_val: 48.07837677001953, abs dis: 8.359432220458984
[rfa agg] iter: 0, weight: tensor([0.1175, 0.0954, 0.2032, 0.0464, 0.0704, 0.1437, 0.0396, 0.0372, 0.2391,
        0.0076])
[rfa agg] iter:  1, prev_obj_val: 48.07837677001953, obj_val: 54.154884338378906, abs dis: 6.076507568359375
[rfa agg] iter: 1, weight: tensor([0.2557, 0.0610, 0.0951, 0.1119, 0.2237, 0.0759, 0.0361, 0.0345, 0.0957,
        0.0105])
[rfa agg] iter:  2, prev_obj_val: 54.154884338378906, obj_val: 54.11844253540039, abs dis: 0.036441802978515625
[rfa agg] iter: 2, weight: tensor([0.1468, 0.0539, 0.0746, 0.2352, 0.2691, 0.0638, 0.0354, 0.0342, 0.0743,
        0.0128])
[rfa agg] iter:  3, prev_obj_val: 54.11844253540039, obj_val: 57.66761016845703, abs dis: 3.5491676330566406
[rfa agg] iter: 3, weight: tensor([0.1376, 0.0521, 0.0718, 0.2516, 0.2738, 0.0617, 0.0342, 0.0330, 0.0718,
        0.0123])
[rfa agg] iter:  4, prev_obj_val: 57.66761016845703, obj_val: 57.64723587036133, abs dis: 0.020374298095703125
[rfa agg] iter: 4, weight: tensor([0.1149, 0.0510, 0.0675, 0.3614, 0.1958, 0.0593, 0.0349, 0.0338, 0.0673,
        0.0141])
[rfa agg] iter:  5, prev_obj_val: 57.64723587036133, obj_val: 57.644500732421875, abs dis: 0.002735137939453125
[rfa agg] iter: 5, weight: tensor([0.1076, 0.0480, 0.0634, 0.4056, 0.1784, 0.0558, 0.0329, 0.0318, 0.0634,
        0.0133])
[rfa agg] iter:  6, prev_obj_val: 57.644500732421875, obj_val: 57.644012451171875, abs dis: 0.00048828125
[rfa agg] iter: 6, weight: tensor([0.1043, 0.0466, 0.0616, 0.4241, 0.1718, 0.0542, 0.0320, 0.0309, 0.0616,
        0.0129])
[rfa agg] iter:  7, prev_obj_val: 57.644012451171875, obj_val: 57.64391326904297, abs dis: 9.918212890625e-05
[rfa agg] iter: 7, weight: tensor([0.1028, 0.0460, 0.0608, 0.4323, 0.1690, 0.0535, 0.0316, 0.0305, 0.0608,
        0.0127])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3342, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 4.6434, Accuracy: 632/9950 (6.3518%)
saving model
Done in 442.33542943000793 sec.
Server Epoch:80 choose agents : [75, 36, 16, 74, 20, 26, 57, 91, 19, 56].
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0588, Accuracy: 300/776 (38.6598%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0267, Accuracy: 450/776 (57.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.3753, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   1, Avg loss: 0.0784, Accuracy: 76/408 (18.6275%)
_Train Local_ResNet_18, epoch  80, local model 36, internal_epoch   2, Avg loss: 0.0463, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1962, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 293/708 (41.3842%)
_Train Local_ResNet_18, epoch  80, local model 16, internal_epoch   2, Avg loss: 0.0318, Accuracy: 440/708 (62.1469%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5137, Accuracy: 85/10000 (0.8500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0413, Accuracy: 608/1552 (39.1753%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0201, Accuracy: 857/1552 (55.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.3573, Accuracy: 99/10000 (0.9900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   1, Avg loss: 0.0578, Accuracy: 290/807 (35.9356%)
_Train Local_ResNet_18, epoch  80, local model 20, internal_epoch   2, Avg loss: 0.0299, Accuracy: 445/807 (55.1425%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4083, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  80, local model 26, internal_epoch   2, Avg loss: 0.0326, Accuracy: 569/1446 (39.3499%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8415, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  80, local model 57, internal_epoch   2, Avg loss: 0.0230, Accuracy: 555/1154 (48.0936%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.7308, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0475, Accuracy: 445/1030 (43.2039%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0240, Accuracy: 660/1030 (64.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.9866, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 428/1036 (41.3127%)
_Train Local_ResNet_18, epoch  80, local model 19, internal_epoch   2, Avg loss: 0.0226, Accuracy: 697/1036 (67.2780%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.8605, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   1, Avg loss: 0.0855, Accuracy: 7/186 (3.7634%)
_Train Local_ResNet_18, epoch  80, local model 56, internal_epoch   2, Avg loss: 0.0689, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.4131, Accuracy: 50/10000 (0.5000%)
time spent on training: 313.6177816390991
[rfa agg] training data poison_ratio: 0.2591453367021861  data num: [776, 408, 708, 1552, 807, 1446, 1154, 1030, 1036, 186]
[rfa agg] considering poison per batch poison_fraction: 0.08098291771943315
[rfa agg] init. name: [75, 36, 16, 74, 20, 26, 57, 91, 19, 56], weight: tensor([0.0852, 0.0448, 0.0778, 0.1705, 0.0887, 0.1588, 0.1268, 0.1131, 0.1138,
        0.0204])
[rfa agg] iter:  0, prev_obj_val: 46.57496643066406, obj_val: 49.83259963989258, abs dis: 3.2576332092285156
[rfa agg] iter: 0, weight: tensor([0.1425, 0.0195, 0.0882, 0.0592, 0.1452, 0.0689, 0.1083, 0.1758, 0.1863,
        0.0059])
[rfa agg] iter:  1, prev_obj_val: 49.83259963989258, obj_val: 59.712852478027344, abs dis: 9.880252838134766
[rfa agg] iter: 1, weight: tensor([0.2296, 0.0197, 0.1138, 0.0476, 0.2276, 0.0542, 0.0772, 0.1109, 0.1138,
        0.0057])
[rfa agg] iter:  2, prev_obj_val: 59.712852478027344, obj_val: 59.659202575683594, abs dis: 0.05364990234375
[rfa agg] iter: 2, weight: tensor([0.2029, 0.0238, 0.3247, 0.0348, 0.2026, 0.0383, 0.0479, 0.0591, 0.0599,
        0.0060])
[rfa agg] iter:  3, prev_obj_val: 59.659202575683594, obj_val: 67.02243041992188, abs dis: 7.363227844238281
[rfa agg] iter: 3, weight: tensor([0.1832, 0.0217, 0.3880, 0.0318, 0.1823, 0.0350, 0.0438, 0.0539, 0.0547,
        0.0055])
[rfa agg] iter:  4, prev_obj_val: 67.02243041992188, obj_val: 59.66508483886719, abs dis: 7.3573455810546875
[rfa agg] iter: 4, weight: tensor([0.1666, 0.0452, 0.2886, 0.0493, 0.1708, 0.0536, 0.0639, 0.0753, 0.0763,
        0.0104])
[rfa agg] iter:  5, prev_obj_val: 59.66508483886719, obj_val: 67.02183532714844, abs dis: 7.35675048828125
[rfa agg] iter: 5, weight: tensor([0.1850, 0.0220, 0.3817, 0.0323, 0.1835, 0.0355, 0.0444, 0.0547, 0.0555,
        0.0056])
[rfa agg] iter:  6, prev_obj_val: 67.02183532714844, obj_val: 59.665138244628906, abs dis: 7.356697082519531
[rfa agg] iter: 6, weight: tensor([0.1667, 0.0452, 0.2882, 0.0493, 0.1709, 0.0536, 0.0640, 0.0754, 0.0763,
        0.0104])
[rfa agg] iter:  7, prev_obj_val: 59.665138244628906, obj_val: 67.0218276977539, abs dis: 7.356689453125
[rfa agg] iter: 7, weight: tensor([0.1850, 0.0220, 0.3815, 0.0323, 0.1835, 0.0355, 0.0444, 0.0547, 0.0555,
        0.0056])
[rfa agg] iter:  8, prev_obj_val: 67.0218276977539, obj_val: 59.66514205932617, abs dis: 7.356685638427734
[rfa agg] iter: 8, weight: tensor([0.1667, 0.0452, 0.2882, 0.0493, 0.1709, 0.0536, 0.0640, 0.0754, 0.0763,
        0.0104])
[rfa agg] iter:  9, prev_obj_val: 59.66514205932617, obj_val: 67.0218276977539, abs dis: 7.356685638427734
[rfa agg] iter: 9, weight: tensor([0.1850, 0.0220, 0.3815, 0.0323, 0.1835, 0.0355, 0.0444, 0.0547, 0.0555,
        0.0056])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3344, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.6742, Accuracy: 479/9950 (4.8141%)
saving model
Done in 477.6401891708374 sec.
Server Epoch:81 choose agents : [96, 50, 54, 97, 92, 82, 79, 65, 95, 81].
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0800, Accuracy: 17/311 (5.4662%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0517, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.2284, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0585, Accuracy: 201/809 (24.8455%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0237, Accuracy: 435/809 (53.7701%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.1872, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 484/1130 (42.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0121, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   1, Avg loss: 0.0506, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  81, local model 97, internal_epoch   2, Avg loss: 0.0263, Accuracy: 579/1213 (47.7329%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2641, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 481/1715 (28.0466%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0285, Accuracy: 811/1715 (47.2886%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8611, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   1, Avg loss: 0.0734, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  81, local model 82, internal_epoch   2, Avg loss: 0.0466, Accuracy: 213/500 (42.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7151, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   1, Avg loss: 0.1050, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  81, local model 79, internal_epoch   2, Avg loss: 0.0831, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   1, Avg loss: 0.0540, Accuracy: 441/1475 (29.8983%)
_Train Local_ResNet_18, epoch  81, local model 65, internal_epoch   2, Avg loss: 0.0280, Accuracy: 769/1475 (52.1356%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7948, Accuracy: 102/10000 (1.0200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0550, Accuracy: 309/599 (51.5860%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0321, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 11.5586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0571, Accuracy: 279/774 (36.0465%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0316, Accuracy: 352/774 (45.4780%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3288, Accuracy: 76/10000 (0.7600%)
time spent on training: 272.7441132068634
[rfa agg] training data poison_ratio: 0.06866903588215063  data num: [311, 809, 1130, 1213, 1715, 500, 197, 1475, 599, 774]
[rfa agg] considering poison per batch poison_fraction: 0.021459073713172072
[rfa agg] init. name: [96, 50, 54, 97, 92, 82, 79, 65, 95, 81], weight: tensor([0.0357, 0.0927, 0.1295, 0.1391, 0.1966, 0.0573, 0.0226, 0.1691, 0.0687,
        0.0887])
[rfa agg] iter:  0, prev_obj_val: 56.59342575073242, obj_val: 57.73264694213867, abs dis: 1.13922119140625
[rfa agg] iter: 0, weight: tensor([0.0142, 0.1330, 0.2666, 0.1989, 0.0783, 0.0314, 0.0083, 0.0921, 0.0500,
        0.1273])
[rfa agg] iter:  1, prev_obj_val: 57.73264694213867, obj_val: 57.73098373413086, abs dis: 0.0016632080078125
[rfa agg] iter: 1, weight: tensor([0.0152, 0.1624, 0.2265, 0.1760, 0.0766, 0.0343, 0.0088, 0.0887, 0.0558,
        0.1556])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3325, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 4.6683, Accuracy: 582/9950 (5.8492%)
saving model
Done in 437.024995803833 sec.
Server Epoch:82 choose agents : [64, 98, 19, 25, 53, 74, 65, 96, 58, 16].
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0611, Accuracy: 202/953 (21.1962%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0356, Accuracy: 359/953 (37.6705%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6150, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   1, Avg loss: 0.0766, Accuracy: 53/373 (14.2091%)
_Train Local_ResNet_18, epoch  82, local model 98, internal_epoch   2, Avg loss: 0.0444, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.8872, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   1, Avg loss: 0.0460, Accuracy: 424/1036 (40.9266%)
_Train Local_ResNet_18, epoch  82, local model 19, internal_epoch   2, Avg loss: 0.0228, Accuracy: 714/1036 (68.9189%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.5499, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   1, Avg loss: 0.0512, Accuracy: 319/690 (46.2319%)
_Train Local_ResNet_18, epoch  82, local model 25, internal_epoch   2, Avg loss: 0.0227, Accuracy: 472/690 (68.4058%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5484, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   1, Avg loss: 0.0396, Accuracy: 405/813 (49.8155%)
_Train Local_ResNet_18, epoch  82, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 517/813 (63.5916%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.3133, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0416, Accuracy: 596/1552 (38.4021%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0194, Accuracy: 847/1552 (54.5747%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.1153, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   1, Avg loss: 0.0503, Accuracy: 463/1475 (31.3898%)
_Train Local_ResNet_18, epoch  82, local model 65, internal_epoch   2, Avg loss: 0.0266, Accuracy: 805/1475 (54.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7133, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 22/311 (7.0740%)
_Train Local_ResNet_18, epoch  82, local model 96, internal_epoch   2, Avg loss: 0.0517, Accuracy: 143/311 (45.9807%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.4263, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0591, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 380/803 (47.3225%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7241, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 296/708 (41.8079%)
_Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2, Avg loss: 0.0310, Accuracy: 438/708 (61.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6338, Accuracy: 85/10000 (0.8500%)
time spent on training: 288.61723470687866
[rfa agg] training data poison_ratio: 0.17810420013770945  data num: [953, 373, 1036, 690, 813, 1552, 1475, 311, 803, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0556575625430342
[rfa agg] init. name: [64, 98, 19, 25, 53, 74, 65, 96, 58, 16], weight: tensor([0.1094, 0.0428, 0.1189, 0.0792, 0.0933, 0.1781, 0.1693, 0.0357, 0.0922,
        0.0812])
[rfa agg] iter:  0, prev_obj_val: 48.135643005371094, obj_val: 52.597354888916016, abs dis: 4.461711883544922
[rfa agg] iter: 0, weight: tensor([0.3437, 0.0128, 0.1161, 0.0569, 0.1452, 0.0430, 0.0451, 0.0095, 0.1473,
        0.0805])
[rfa agg] iter:  1, prev_obj_val: 52.597354888916016, obj_val: 57.76800537109375, abs dis: 5.170650482177734
[rfa agg] iter: 1, weight: tensor([0.0832, 0.0127, 0.0504, 0.0948, 0.2384, 0.0274, 0.0283, 0.0092, 0.2497,
        0.2059])
[rfa agg] iter:  2, prev_obj_val: 57.76800537109375, obj_val: 60.8890380859375, abs dis: 3.12103271484375
[rfa agg] iter: 2, weight: tensor([0.0709, 0.0179, 0.0493, 0.2421, 0.1353, 0.0303, 0.0310, 0.0126, 0.1360,
        0.2746])
[rfa agg] iter:  3, prev_obj_val: 60.8890380859375, obj_val: 68.08081817626953, abs dis: 7.191780090332031
[rfa agg] iter: 3, weight: tensor([0.0637, 0.0201, 0.0464, 0.4072, 0.1055, 0.0300, 0.0306, 0.0140, 0.1057,
        0.1767])
[rfa agg] iter:  4, prev_obj_val: 68.08081817626953, obj_val: 57.74263000488281, abs dis: 10.338188171386719
[rfa agg] iter: 4, weight: tensor([0.0851, 0.0417, 0.0662, 0.2928, 0.1192, 0.0465, 0.0473, 0.0279, 0.1187,
        0.1546])
[rfa agg] iter:  5, prev_obj_val: 57.74263000488281, obj_val: 57.732093811035156, abs dis: 0.01053619384765625
[rfa agg] iter: 5, weight: tensor([0.0691, 0.0174, 0.0481, 0.2743, 0.1293, 0.0296, 0.0303, 0.0123, 0.1310,
        0.2586])
[rfa agg] iter:  6, prev_obj_val: 57.732093811035156, obj_val: 60.88408660888672, abs dis: 3.1519927978515625
[rfa agg] iter: 6, weight: tensor([0.0683, 0.0173, 0.0476, 0.2646, 0.1281, 0.0293, 0.0300, 0.0122, 0.1299,
        0.2727])
[rfa agg] iter:  7, prev_obj_val: 60.88408660888672, obj_val: 64.39043426513672, abs dis: 3.50634765625
[rfa agg] iter: 7, weight: tensor([0.0630, 0.0199, 0.0459, 0.4146, 0.1041, 0.0296, 0.0303, 0.0139, 0.1044,
        0.1744])
[rfa agg] iter:  8, prev_obj_val: 64.39043426513672, obj_val: 68.07868957519531, abs dis: 3.6882553100585938
[rfa agg] iter: 8, weight: tensor([0.0715, 0.0281, 0.0540, 0.3861, 0.1074, 0.0364, 0.0372, 0.0192, 0.1073,
        0.1527])
[rfa agg] iter:  9, prev_obj_val: 68.07868957519531, obj_val: 57.74262619018555, abs dis: 10.336063385009766
[rfa agg] iter: 9, weight: tensor([0.0851, 0.0418, 0.0663, 0.2923, 0.1194, 0.0465, 0.0473, 0.0279, 0.1188,
        0.1545])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3331, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 4.6485, Accuracy: 519/9950 (5.2161%)
saving model
Done in 453.98733592033386 sec.
Server Epoch:83 choose agents : [63, 88, 39, 85, 65, 22, 50, 86, 14, 33].
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   1, Avg loss: 0.0507, Accuracy: 282/888 (31.7568%)
_Train Local_ResNet_18, epoch  83, local model 63, internal_epoch   2, Avg loss: 0.0240, Accuracy: 467/888 (52.5901%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.1784, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   1, Avg loss: 0.0655, Accuracy: 186/603 (30.8458%)
_Train Local_ResNet_18, epoch  83, local model 88, internal_epoch   2, Avg loss: 0.0414, Accuracy: 291/603 (48.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7865, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   1, Avg loss: 0.0507, Accuracy: 320/1013 (31.5893%)
_Train Local_ResNet_18, epoch  83, local model 39, internal_epoch   2, Avg loss: 0.0246, Accuracy: 564/1013 (55.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6922, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 483/1988 (24.2958%)
_Train Local_ResNet_18, epoch  83, local model 85, internal_epoch   2, Avg loss: 0.0343, Accuracy: 745/1988 (37.4748%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.2596, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0511, Accuracy: 479/1475 (32.4746%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0283, Accuracy: 776/1475 (52.6102%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8765, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   1, Avg loss: 0.0431, Accuracy: 603/1470 (41.0204%)
_Train Local_ResNet_18, epoch  83, local model 22, internal_epoch   2, Avg loss: 0.0229, Accuracy: 900/1470 (61.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.6042, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   1, Avg loss: 0.0567, Accuracy: 215/809 (26.5760%)
_Train Local_ResNet_18, epoch  83, local model 50, internal_epoch   2, Avg loss: 0.0243, Accuracy: 411/809 (50.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.5725, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   1, Avg loss: 0.0570, Accuracy: 366/1003 (36.4905%)
_Train Local_ResNet_18, epoch  83, local model 86, internal_epoch   2, Avg loss: 0.0323, Accuracy: 397/1003 (39.5813%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7534, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   1, Avg loss: 0.0559, Accuracy: 246/1013 (24.2843%)
_Train Local_ResNet_18, epoch  83, local model 14, internal_epoch   2, Avg loss: 0.0308, Accuracy: 423/1013 (41.7572%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4885, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0804, Accuracy: 77/515 (14.9515%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 161/515 (31.2621%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.2032, Accuracy: 72/10000 (0.7200%)
time spent on training: 266.30742025375366
[rfa agg] training data poison_ratio: 0.0  data num: [888, 603, 1013, 1988, 1475, 1470, 809, 1003, 1013, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 88, 39, 85, 65, 22, 50, 86, 14, 33], weight: tensor([0.0824, 0.0560, 0.0940, 0.1845, 0.1369, 0.1364, 0.0751, 0.0931, 0.0940,
        0.0478])
[rfa agg] iter:  0, prev_obj_val: 56.05887222290039, obj_val: 59.342872619628906, abs dis: 3.2840003967285156
[rfa agg] iter: 0, weight: tensor([0.0827, 0.0266, 0.2012, 0.0453, 0.0744, 0.0875, 0.0587, 0.1990, 0.2046,
        0.0200])
[rfa agg] iter:  1, prev_obj_val: 59.342872619628906, obj_val: 66.43916320800781, abs dis: 7.096290588378906
[rfa agg] iter: 1, weight: tensor([0.1742, 0.0273, 0.1944, 0.0266, 0.0371, 0.0416, 0.0864, 0.1919, 0.2010,
        0.0195])
[rfa agg] iter:  2, prev_obj_val: 66.43916320800781, obj_val: 69.37727355957031, abs dis: 2.9381103515625
[rfa agg] iter: 2, weight: tensor([0.3053, 0.0425, 0.0977, 0.0267, 0.0348, 0.0383, 0.2313, 0.0967, 0.0984,
        0.0283])
[rfa agg] iter:  3, prev_obj_val: 69.37727355957031, obj_val: 76.08982849121094, abs dis: 6.712554931640625
[rfa agg] iter: 3, weight: tensor([0.2102, 0.0515, 0.0852, 0.0271, 0.0346, 0.0380, 0.3501, 0.0845, 0.0857,
        0.0331])
[rfa agg] iter:  4, prev_obj_val: 76.08982849121094, obj_val: 72.64483642578125, abs dis: 3.4449920654296875
[rfa agg] iter: 4, weight: tensor([0.1580, 0.1080, 0.0916, 0.0365, 0.0451, 0.0490, 0.2664, 0.0909, 0.0921,
        0.0622])
[rfa agg] iter:  5, prev_obj_val: 72.64483642578125, obj_val: 79.58467864990234, abs dis: 6.939842224121094
[rfa agg] iter: 5, weight: tensor([0.1720, 0.0733, 0.0874, 0.0314, 0.0394, 0.0430, 0.3338, 0.0867, 0.0879,
        0.0450])
[rfa agg] iter:  6, prev_obj_val: 79.58467864990234, obj_val: 76.08556365966797, abs dis: 3.499114990234375
[rfa agg] iter: 6, weight: tensor([0.1416, 0.1568, 0.0906, 0.0395, 0.0480, 0.0520, 0.2084, 0.0898, 0.0909,
        0.0823])
[rfa agg] iter:  7, prev_obj_val: 76.08556365966797, obj_val: 72.64568328857422, abs dis: 3.43988037109375
[rfa agg] iter: 7, weight: tensor([0.1594, 0.1099, 0.0926, 0.0369, 0.0455, 0.0495, 0.2583, 0.0919, 0.0930,
        0.0630])
[rfa agg] iter:  8, prev_obj_val: 72.64568328857422, obj_val: 79.5844955444336, abs dis: 6.938812255859375
[rfa agg] iter: 8, weight: tensor([0.1724, 0.0735, 0.0876, 0.0315, 0.0395, 0.0431, 0.3324, 0.0869, 0.0881,
        0.0450])
[rfa agg] iter:  9, prev_obj_val: 79.5844955444336, obj_val: 76.08556365966797, abs dis: 3.498931884765625
[rfa agg] iter: 9, weight: tensor([0.1416, 0.1569, 0.0906, 0.0395, 0.0480, 0.0520, 0.2084, 0.0898, 0.0910,
        0.0823])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3341, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.6644, Accuracy: 478/9950 (4.8040%)
saving model
Done in 455.71097898483276 sec.
Server Epoch:84 choose agents : [46, 69, 35, 2, 38, 61, 48, 80, 0, 84].
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   1, Avg loss: 0.0529, Accuracy: 462/1904 (24.2647%)
_Train Local_ResNet_18, epoch  84, local model 46, internal_epoch   2, Avg loss: 0.0289, Accuracy: 804/1904 (42.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3757, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   1, Avg loss: 0.0568, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  84, local model 69, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 11.1342, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0886, Accuracy: 21/271 (7.7491%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 117/271 (43.1734%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.4334, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0649, Accuracy: 208/605 (34.3802%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0373, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.8197, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0543, Accuracy: 340/1131 (30.0619%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0268, Accuracy: 570/1131 (50.3979%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.6385, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1175, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3400, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 116/631 (18.3835%)
_Train Local_ResNet_18, epoch  84, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 272/631 (43.1062%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5029, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0617, Accuracy: 201/682 (29.4721%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0350, Accuracy: 281/682 (41.2023%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3481, Accuracy: 84/10000 (0.8400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0556, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0320, Accuracy: 597/1657 (36.0290%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1293, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   1, Avg loss: 0.0584, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  84, local model 84, internal_epoch   2, Avg loss: 0.0289, Accuracy: 515/1190 (43.2773%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1793, Accuracy: 108/10000 (1.0800%)
time spent on training: 250.42464661598206
[rfa agg] training data poison_ratio: 0.18945803796021038  data num: [1904, 590, 271, 605, 1131, 85, 631, 682, 1657, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.05920563686256575
[rfa agg] init. name: [46, 69, 35, 2, 38, 61, 48, 80, 0, 84], weight: tensor([0.2177, 0.0675, 0.0310, 0.0692, 0.1293, 0.0097, 0.0721, 0.0780, 0.1895,
        0.1361])
[rfa agg] iter:  0, prev_obj_val: 65.4405746459961, obj_val: 71.10523223876953, abs dis: 5.6646575927734375
[rfa agg] iter: 0, weight: tensor([0.0576, 0.0297, 0.0082, 0.0305, 0.4645, 0.0021, 0.0318, 0.0396, 0.0737,
        0.2622])
[rfa agg] iter:  1, prev_obj_val: 71.10523223876953, obj_val: 69.56927490234375, abs dis: 1.5359573364257812
[rfa agg] iter: 1, weight: tensor([0.0831, 0.0674, 0.0163, 0.0692, 0.2818, 0.0040, 0.0722, 0.0950, 0.0997,
        0.2111])
[rfa agg] iter:  2, prev_obj_val: 69.56927490234375, obj_val: 69.56785583496094, abs dis: 0.0014190673828125
[rfa agg] iter: 2, weight: tensor([0.0800, 0.0577, 0.0145, 0.0592, 0.3184, 0.0036, 0.0618, 0.0800, 0.0975,
        0.2272])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3311, Accuracy: 100/10000 (1.0000%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 4.7003, Accuracy: 427/9950 (4.2915%)
saving model
Done in 416.44227480888367 sec.
Server Epoch:85 choose agents : [10, 27, 58, 65, 60, 31, 40, 48, 2, 16].
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   1, Avg loss: 0.0530, Accuracy: 271/861 (31.4750%)
_Train Local_ResNet_18, epoch  85, local model 10, internal_epoch   2, Avg loss: 0.0185, Accuracy: 507/861 (58.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.3154, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   1, Avg loss: 0.0557, Accuracy: 433/1587 (27.2842%)
_Train Local_ResNet_18, epoch  85, local model 27, internal_epoch   2, Avg loss: 0.0319, Accuracy: 656/1587 (41.3359%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7163, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 315/803 (39.2279%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2311, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1, Avg loss: 0.0506, Accuracy: 460/1475 (31.1864%)
_Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2, Avg loss: 0.0262, Accuracy: 787/1475 (53.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0961, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   1, Avg loss: 0.0475, Accuracy: 709/2227 (31.8366%)
_Train Local_ResNet_18, epoch  85, local model 60, internal_epoch   2, Avg loss: 0.0261, Accuracy: 1115/2227 (50.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0986, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0791, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0343, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2369, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   1, Avg loss: 0.0560, Accuracy: 380/1573 (24.1577%)
_Train Local_ResNet_18, epoch  85, local model 40, internal_epoch   2, Avg loss: 0.0332, Accuracy: 618/1573 (39.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8496, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 148/631 (23.4548%)
_Train Local_ResNet_18, epoch  85, local model 48, internal_epoch   2, Avg loss: 0.0399, Accuracy: 283/631 (44.8494%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3586, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0368, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.0133, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   1, Avg loss: 0.0599, Accuracy: 301/708 (42.5141%)
_Train Local_ResNet_18, epoch  85, local model 16, internal_epoch   2, Avg loss: 0.0315, Accuracy: 417/708 (58.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6821, Accuracy: 64/10000 (0.6400%)
time spent on training: 294.3712868690491
[rfa agg] training data poison_ratio: 0.0787740164684355  data num: [861, 1587, 803, 1475, 2227, 460, 1573, 631, 605, 708]
[rfa agg] considering poison per batch poison_fraction: 0.024616880146386095
[rfa agg] init. name: [10, 27, 58, 65, 60, 31, 40, 48, 2, 16], weight: tensor([0.0788, 0.1452, 0.0735, 0.1349, 0.2038, 0.0421, 0.1439, 0.0577, 0.0554,
        0.0648])
[rfa agg] iter:  0, prev_obj_val: 73.62532806396484, obj_val: 75.853271484375, abs dis: 2.2279434204101562
[rfa agg] iter: 0, weight: tensor([0.0872, 0.1918, 0.0699, 0.2182, 0.0906, 0.0234, 0.1898, 0.0385, 0.0369,
        0.0538])
[rfa agg] iter:  1, prev_obj_val: 75.853271484375, obj_val: 76.981689453125, abs dis: 1.12841796875
[rfa agg] iter: 1, weight: tensor([0.1112, 0.1710, 0.0868, 0.1890, 0.0905, 0.0272, 0.1694, 0.0456, 0.0437,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 76.981689453125, obj_val: 79.25282287597656, abs dis: 2.2711334228515625
[rfa agg] iter: 2, weight: tensor([0.1252, 0.1602, 0.0960, 0.1746, 0.0890, 0.0289, 0.1587, 0.0490, 0.0469,
        0.0715])
[rfa agg] iter:  3, prev_obj_val: 79.25282287597656, obj_val: 80.39256286621094, abs dis: 1.139739990234375
[rfa agg] iter: 3, weight: tensor([0.1583, 0.1376, 0.1159, 0.1466, 0.0830, 0.0316, 0.1363, 0.0549, 0.0526,
        0.0833])
[rfa agg] iter:  4, prev_obj_val: 80.39256286621094, obj_val: 79.25186157226562, abs dis: 1.1407012939453125
[rfa agg] iter: 4, weight: tensor([0.1789, 0.1255, 0.1267, 0.1326, 0.0785, 0.0324, 0.1244, 0.0572, 0.0548,
        0.0890])
[rfa agg] iter:  5, prev_obj_val: 79.25186157226562, obj_val: 79.25147247314453, abs dis: 0.00038909912109375
[rfa agg] iter: 5, weight: tensor([0.1585, 0.1375, 0.1159, 0.1465, 0.0830, 0.0316, 0.1362, 0.0549, 0.0526,
        0.0834])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3272, Accuracy: 104/10000 (1.0400%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6395, Accuracy: 759/9950 (7.6281%)
saving model
Done in 463.10201501846313 sec.
Server Epoch:86 choose agents : [88, 3, 90, 19, 74, 8, 93, 84, 24, 62].
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1, Avg loss: 0.0648, Accuracy: 180/603 (29.8507%)
_Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/603 (43.7811%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8422, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0665, Accuracy: 141/781 (18.0538%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0321, Accuracy: 287/781 (36.7478%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6773, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   1, Avg loss: 0.0549, Accuracy: 301/677 (44.4609%)
_Train Local_ResNet_18, epoch  86, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 438/677 (64.6972%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.4295, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0455, Accuracy: 472/1036 (45.5598%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0223, Accuracy: 709/1036 (68.4363%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.6724, Accuracy: 80/10000 (0.8000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0414, Accuracy: 589/1552 (37.9510%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 861/1552 (55.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.8408, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   1, Avg loss: 0.0566, Accuracy: 341/1513 (22.5380%)
_Train Local_ResNet_18, epoch  86, local model 8, internal_epoch   2, Avg loss: 0.0339, Accuracy: 568/1513 (37.5413%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6885, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   1, Avg loss: 0.0526, Accuracy: 466/1742 (26.7509%)
_Train Local_ResNet_18, epoch  86, local model 93, internal_epoch   2, Avg loss: 0.0298, Accuracy: 757/1742 (43.4558%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5082, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0573, Accuracy: 338/1190 (28.4034%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0292, Accuracy: 523/1190 (43.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1949, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0816, Accuracy: 17/312 (5.4487%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 199/312 (63.7821%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.6594, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 159/568 (27.9930%)
_Train Local_ResNet_18, epoch  86, local model 62, internal_epoch   2, Avg loss: 0.0391, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3694, Accuracy: 63/10000 (0.6300%)
time spent on training: 288.54845237731934
[rfa agg] training data poison_ratio: 0.15560457188690596  data num: [603, 781, 677, 1036, 1552, 1513, 1742, 1190, 312, 568]
[rfa agg] considering poison per batch poison_fraction: 0.04862642871465811
[rfa agg] init. name: [88, 3, 90, 19, 74, 8, 93, 84, 24, 62], weight: tensor([0.0605, 0.0783, 0.0679, 0.1039, 0.1556, 0.1517, 0.1747, 0.1193, 0.0313,
        0.0569])
[rfa agg] iter:  0, prev_obj_val: 57.398353576660156, obj_val: 61.71597671508789, abs dis: 4.317623138427734
[rfa agg] iter: 0, weight: tensor([0.0263, 0.0565, 0.0340, 0.4250, 0.0676, 0.0758, 0.0542, 0.2305, 0.0082,
        0.0219])
[rfa agg] iter:  1, prev_obj_val: 61.71597671508789, obj_val: 63.5072135925293, abs dis: 1.7912368774414062
[rfa agg] iter: 1, weight: tensor([0.0410, 0.1045, 0.0551, 0.3894, 0.0705, 0.0771, 0.0594, 0.1581, 0.0116,
        0.0332])
[rfa agg] iter:  2, prev_obj_val: 63.5072135925293, obj_val: 67.14820098876953, abs dis: 3.6409873962402344
[rfa agg] iter: 2, weight: tensor([0.0507, 0.1413, 0.0693, 0.3079, 0.0756, 0.0822, 0.0645, 0.1541, 0.0138,
        0.0405])
[rfa agg] iter:  3, prev_obj_val: 67.14820098876953, obj_val: 68.98040008544922, abs dis: 1.8321990966796875
[rfa agg] iter: 3, weight: tensor([0.0648, 0.2388, 0.0931, 0.1981, 0.0719, 0.0773, 0.0627, 0.1270, 0.0160,
        0.0501])
[rfa agg] iter:  4, prev_obj_val: 68.98040008544922, obj_val: 67.14237976074219, abs dis: 1.8380203247070312
[rfa agg] iter: 4, weight: tensor([0.0673, 0.3201, 0.1003, 0.1528, 0.0634, 0.0679, 0.0559, 0.1059, 0.0156,
        0.0509])
[rfa agg] iter:  5, prev_obj_val: 67.14237976074219, obj_val: 68.9800033569336, abs dis: 1.8376235961914062
[rfa agg] iter: 5, weight: tensor([0.0646, 0.2441, 0.0930, 0.1953, 0.0715, 0.0770, 0.0624, 0.1263, 0.0159,
        0.0499])
[rfa agg] iter:  6, prev_obj_val: 68.9800033569336, obj_val: 67.14239501953125, abs dis: 1.8376083374023438
[rfa agg] iter: 6, weight: tensor([0.0673, 0.3204, 0.1002, 0.1527, 0.0634, 0.0679, 0.0559, 0.1059, 0.0156,
        0.0509])
[rfa agg] iter:  7, prev_obj_val: 67.14239501953125, obj_val: 68.9800033569336, abs dis: 1.8376083374023438
[rfa agg] iter: 7, weight: tensor([0.0646, 0.2441, 0.0930, 0.1953, 0.0715, 0.0770, 0.0624, 0.1263, 0.0159,
        0.0499])
[rfa agg] iter:  8, prev_obj_val: 68.9800033569336, obj_val: 67.14239501953125, abs dis: 1.8376083374023438
[rfa agg] iter: 8, weight: tensor([0.0673, 0.3204, 0.1002, 0.1527, 0.0634, 0.0679, 0.0559, 0.1059, 0.0156,
        0.0509])
[rfa agg] iter:  9, prev_obj_val: 67.14239501953125, obj_val: 68.9800033569336, abs dis: 1.8376083374023438
[rfa agg] iter: 9, weight: tensor([0.0646, 0.2441, 0.0930, 0.1953, 0.0715, 0.0770, 0.0624, 0.1263, 0.0159,
        0.0499])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3239, Accuracy: 103/10000 (1.0300%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 4.6747, Accuracy: 670/9950 (6.7337%)
saving model
Done in 456.4410135746002 sec.
Server Epoch:87 choose agents : [61, 30, 64, 21, 37, 89, 86, 47, 43, 63].
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3314, Accuracy: 89/10000 (0.8900%)
poison local model 30 index 5 
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   1, Avg loss: 0.0698, Accuracy: 115/486 (23.6626%)
_Train Local_ResNet_18, epoch  87, local model 30, internal_epoch   2, Avg loss: 0.0368, Accuracy: 220/486 (45.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.8507, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   1, Avg loss: 0.0602, Accuracy: 195/953 (20.4617%)
_Train Local_ResNet_18, epoch  87, local model 64, internal_epoch   2, Avg loss: 0.0352, Accuracy: 343/953 (35.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6481, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1, Avg loss: 0.0529, Accuracy: 427/1949 (21.9087%)
_Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2, Avg loss: 0.0316, Accuracy: 688/1949 (35.3002%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4475, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   1, Avg loss: 0.0450, Accuracy: 578/1129 (51.1957%)
_Train Local_ResNet_18, epoch  87, local model 37, internal_epoch   2, Avg loss: 0.0213, Accuracy: 790/1129 (69.9734%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9821, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   1, Avg loss: 0.0539, Accuracy: 378/896 (42.1875%)
_Train Local_ResNet_18, epoch  87, local model 89, internal_epoch   2, Avg loss: 0.0300, Accuracy: 485/896 (54.1295%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2043, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0566, Accuracy: 365/1003 (36.3908%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0312, Accuracy: 422/1003 (42.0738%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9616, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1175, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1041, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3745, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0605, Accuracy: 284/946 (30.0211%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0324, Accuracy: 377/946 (39.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4874, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   1, Avg loss: 0.0488, Accuracy: 299/888 (33.6712%)
_Train Local_ResNet_18, epoch  87, local model 63, internal_epoch   2, Avg loss: 0.0232, Accuracy: 487/888 (54.8423%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.9876, Accuracy: 80/10000 (0.8000%)
time spent on training: 286.44944405555725
[rfa agg] training data poison_ratio: 0.057385759829968117  data num: [85, 486, 953, 1949, 1129, 896, 1003, 134, 946, 888]
[rfa agg] considering poison per batch poison_fraction: 0.017933049946865037
[rfa agg] init. name: [61, 30, 64, 21, 37, 89, 86, 47, 43, 63], weight: tensor([0.0100, 0.0574, 0.1125, 0.2301, 0.1333, 0.1058, 0.1184, 0.0158, 0.1117,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 47.44754409790039, obj_val: 54.29574966430664, abs dis: 6.84820556640625
[rfa agg] iter: 0, weight: tensor([0.0012, 0.0119, 0.2426, 0.0231, 0.0775, 0.1013, 0.2258, 0.0020, 0.2133,
        0.1013])
[rfa agg] iter:  1, prev_obj_val: 54.29574966430664, obj_val: 54.22770309448242, abs dis: 0.06804656982421875
[rfa agg] iter: 1, weight: tensor([0.0017, 0.0204, 0.1415, 0.0257, 0.0567, 0.2533, 0.0909, 0.0030, 0.1369,
        0.2700])
[rfa agg] iter:  2, prev_obj_val: 54.22770309448242, obj_val: 61.30649948120117, abs dis: 7.07879638671875
[rfa agg] iter: 2, weight: tensor([0.0016, 0.0196, 0.1347, 0.0247, 0.0543, 0.2643, 0.0864, 0.0028, 0.1300,
        0.2817])
[rfa agg] iter:  3, prev_obj_val: 61.30649948120117, obj_val: 54.23393249511719, abs dis: 7.072566986083984
[rfa agg] iter: 3, weight: tensor([0.0031, 0.0416, 0.1450, 0.0407, 0.0781, 0.2167, 0.1091, 0.0055, 0.1423,
        0.2179])
[rfa agg] iter:  4, prev_obj_val: 54.23393249511719, obj_val: 61.30623245239258, abs dis: 7.072299957275391
[rfa agg] iter: 4, weight: tensor([0.0017, 0.0197, 0.1360, 0.0249, 0.0548, 0.2631, 0.0873, 0.0029, 0.1313,
        0.2784])
[rfa agg] iter:  5, prev_obj_val: 61.30623245239258, obj_val: 54.23393630981445, abs dis: 7.072296142578125
[rfa agg] iter: 5, weight: tensor([0.0031, 0.0416, 0.1450, 0.0407, 0.0781, 0.2167, 0.1091, 0.0055, 0.1423,
        0.2179])
[rfa agg] iter:  6, prev_obj_val: 54.23393630981445, obj_val: 61.30622482299805, abs dis: 7.072288513183594
[rfa agg] iter: 6, weight: tensor([0.0017, 0.0197, 0.1360, 0.0249, 0.0548, 0.2631, 0.0873, 0.0029, 0.1313,
        0.2784])
[rfa agg] iter:  7, prev_obj_val: 61.30622482299805, obj_val: 54.23393630981445, abs dis: 7.072288513183594
[rfa agg] iter: 7, weight: tensor([0.0031, 0.0416, 0.1450, 0.0407, 0.0781, 0.2167, 0.1091, 0.0055, 0.1423,
        0.2179])
[rfa agg] iter:  8, prev_obj_val: 54.23393630981445, obj_val: 61.30622482299805, abs dis: 7.072288513183594
[rfa agg] iter: 8, weight: tensor([0.0017, 0.0197, 0.1360, 0.0249, 0.0548, 0.2631, 0.0873, 0.0029, 0.1313,
        0.2784])
[rfa agg] iter:  9, prev_obj_val: 61.30622482299805, obj_val: 54.23393630981445, abs dis: 7.072288513183594
[rfa agg] iter: 9, weight: tensor([0.0031, 0.0416, 0.1450, 0.0407, 0.0781, 0.2167, 0.1091, 0.0055, 0.1423,
        0.2179])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3257, Accuracy: 112/10000 (1.1200%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 4.6462, Accuracy: 761/9950 (7.6482%)
saving model
Done in 459.0878586769104 sec.
Server Epoch:88 choose agents : [90, 31, 58, 73, 91, 48, 27, 50, 35, 61].
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1, Avg loss: 0.0538, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2, Avg loss: 0.0208, Accuracy: 472/677 (69.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.7248, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0792, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0351, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6764, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   1, Avg loss: 0.0593, Accuracy: 320/803 (39.8506%)
_Train Local_ResNet_18, epoch  88, local model 58, internal_epoch   2, Avg loss: 0.0319, Accuracy: 421/803 (52.4284%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2236, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1, Avg loss: 0.0584, Accuracy: 230/938 (24.5203%)
_Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2, Avg loss: 0.0311, Accuracy: 369/938 (39.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1619, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1, Avg loss: 0.0477, Accuracy: 453/1030 (43.9806%)
_Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2, Avg loss: 0.0246, Accuracy: 687/1030 (66.6990%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.8374, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0698, Accuracy: 141/631 (22.3455%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0398, Accuracy: 274/631 (43.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5056, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   1, Avg loss: 0.0550, Accuracy: 445/1587 (28.0403%)
_Train Local_ResNet_18, epoch  88, local model 27, internal_epoch   2, Avg loss: 0.0319, Accuracy: 653/1587 (41.1468%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3770, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   1, Avg loss: 0.0557, Accuracy: 227/809 (28.0593%)
_Train Local_ResNet_18, epoch  88, local model 50, internal_epoch   2, Avg loss: 0.0242, Accuracy: 411/809 (50.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.4969, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1, Avg loss: 0.0877, Accuracy: 28/271 (10.3321%)
_Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 122/271 (45.0185%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.3881, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3314, Accuracy: 94/10000 (0.9400%)
time spent on training: 223.36715412139893
[rfa agg] training data poison_ratio: 0.0  data num: [677, 460, 803, 938, 1030, 631, 1587, 809, 271, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 31, 58, 73, 91, 48, 27, 50, 35, 61], weight: tensor([0.0929, 0.0631, 0.1101, 0.1287, 0.1413, 0.0865, 0.2177, 0.1110, 0.0372,
        0.0117])
[rfa agg] iter:  0, prev_obj_val: 43.96980667114258, obj_val: 49.562110900878906, abs dis: 5.592304229736328
[rfa agg] iter: 0, weight: tensor([0.1139, 0.0269, 0.2887, 0.0966, 0.0593, 0.0654, 0.0335, 0.3041, 0.0095,
        0.0021])
[rfa agg] iter:  1, prev_obj_val: 49.562110900878906, obj_val: 58.077293395996094, abs dis: 8.515182495117188
[rfa agg] iter: 1, weight: tensor([0.4187, 0.0424, 0.1099, 0.0649, 0.0474, 0.1587, 0.0317, 0.1111, 0.0126,
        0.0026])
[rfa agg] iter:  2, prev_obj_val: 58.077293395996094, obj_val: 61.46809387207031, abs dis: 3.3908004760742188
[rfa agg] iter: 2, weight: tensor([0.1679, 0.1112, 0.0858, 0.0641, 0.0515, 0.3674, 0.0387, 0.0865, 0.0227,
        0.0043])
[rfa agg] iter:  3, prev_obj_val: 61.46809387207031, obj_val: 54.79838562011719, abs dis: 6.669708251953125
[rfa agg] iter: 3, weight: tensor([0.1493, 0.1922, 0.0894, 0.0699, 0.0574, 0.2713, 0.0445, 0.0901, 0.0303,
        0.0055])
[rfa agg] iter:  4, prev_obj_val: 54.79838562011719, obj_val: 64.96157836914062, abs dis: 10.163192749023438
[rfa agg] iter: 4, weight: tensor([0.1696, 0.0610, 0.0711, 0.0502, 0.0392, 0.4914, 0.0285, 0.0716, 0.0146,
        0.0029])
[rfa agg] iter:  5, prev_obj_val: 64.96157836914062, obj_val: 61.46887969970703, abs dis: 3.4926986694335938
[rfa agg] iter: 5, weight: tensor([0.1222, 0.3198, 0.0809, 0.0656, 0.0550, 0.1897, 0.0439, 0.0816, 0.0352,
        0.0060])
[rfa agg] iter:  6, prev_obj_val: 61.46887969970703, obj_val: 54.80002975463867, abs dis: 6.668849945068359
[rfa agg] iter: 6, weight: tensor([0.1491, 0.1982, 0.0896, 0.0700, 0.0575, 0.2651, 0.0446, 0.0902, 0.0304,
        0.0055])
[rfa agg] iter:  7, prev_obj_val: 54.80002975463867, obj_val: 64.96127319335938, abs dis: 10.161243438720703
[rfa agg] iter: 7, weight: tensor([0.1702, 0.0612, 0.0713, 0.0504, 0.0394, 0.4895, 0.0286, 0.0719, 0.0146,
        0.0029])
[rfa agg] iter:  8, prev_obj_val: 64.96127319335938, obj_val: 61.4688835144043, abs dis: 3.492389678955078
[rfa agg] iter: 8, weight: tensor([0.1222, 0.3199, 0.0809, 0.0656, 0.0550, 0.1897, 0.0439, 0.0816, 0.0352,
        0.0060])
[rfa agg] iter:  9, prev_obj_val: 61.4688835144043, obj_val: 54.80002975463867, abs dis: 6.668853759765625
[rfa agg] iter: 9, weight: tensor([0.1491, 0.1982, 0.0896, 0.0700, 0.0575, 0.2651, 0.0446, 0.0902, 0.0304,
        0.0055])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3237, Accuracy: 109/10000 (1.0900%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 4.6334, Accuracy: 928/9950 (9.3266%)
saving model
Done in 395.30982089042664 sec.
Server Epoch:89 choose agents : [66, 87, 89, 19, 67, 71, 31, 39, 91, 84].
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0592, Accuracy: 287/1402 (20.4708%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0361, Accuracy: 462/1402 (32.9529%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9979, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   1, Avg loss: 0.0557, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  89, local model 87, internal_epoch   2, Avg loss: 0.0295, Accuracy: 465/1131 (41.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4080, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0528, Accuracy: 380/896 (42.4107%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0297, Accuracy: 480/896 (53.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1822, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   1, Avg loss: 0.0445, Accuracy: 461/1036 (44.4981%)
_Train Local_ResNet_18, epoch  89, local model 19, internal_epoch   2, Avg loss: 0.0223, Accuracy: 721/1036 (69.5946%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.9239, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0706, Accuracy: 103/426 (24.1784%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0360, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6123, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   1, Avg loss: 0.0590, Accuracy: 222/818 (27.1394%)
_Train Local_ResNet_18, epoch  89, local model 71, internal_epoch   2, Avg loss: 0.0269, Accuracy: 439/818 (53.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1719, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   1, Avg loss: 0.0756, Accuracy: 86/460 (18.6957%)
_Train Local_ResNet_18, epoch  89, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5822, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0507, Accuracy: 333/1013 (32.8727%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0246, Accuracy: 561/1013 (55.3801%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1817, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   1, Avg loss: 0.0481, Accuracy: 456/1030 (44.2718%)
_Train Local_ResNet_18, epoch  89, local model 91, internal_epoch   2, Avg loss: 0.0240, Accuracy: 692/1030 (67.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.6880, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0552, Accuracy: 350/1190 (29.4118%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0284, Accuracy: 527/1190 (44.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0107, Accuracy: 115/10000 (1.1500%)
time spent on training: 261.8196008205414
[rfa agg] training data poison_ratio: 0.0  data num: [1402, 1131, 896, 1036, 426, 818, 460, 1013, 1030, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [66, 87, 89, 19, 67, 71, 31, 39, 91, 84], weight: tensor([0.1491, 0.1203, 0.0953, 0.1102, 0.0453, 0.0870, 0.0489, 0.1077, 0.1096,
        0.1266])
[rfa agg] iter:  0, prev_obj_val: 38.485679626464844, obj_val: 44.68744659423828, abs dis: 6.2017669677734375
[rfa agg] iter: 0, weight: tensor([0.0425, 0.0644, 0.2855, 0.0748, 0.0169, 0.2639, 0.0215, 0.1017, 0.0734,
        0.0553])
[rfa agg] iter:  1, prev_obj_val: 44.68744659423828, obj_val: 41.3470573425293, abs dis: 3.3403892517089844
[rfa agg] iter: 1, weight: tensor([0.0472, 0.0656, 0.1805, 0.0729, 0.0248, 0.3550, 0.0326, 0.0915, 0.0717,
        0.0583])
[rfa agg] iter:  2, prev_obj_val: 41.3470573425293, obj_val: 44.672821044921875, abs dis: 3.325763702392578
[rfa agg] iter: 2, weight: tensor([0.0377, 0.0546, 0.1847, 0.0619, 0.0172, 0.4325, 0.0223, 0.0805, 0.0608,
        0.0478])
[rfa agg] iter:  3, prev_obj_val: 44.672821044921875, obj_val: 44.67116165161133, abs dis: 0.001659393310546875
[rfa agg] iter: 3, weight: tensor([0.0451, 0.0627, 0.1683, 0.0696, 0.0237, 0.3879, 0.0312, 0.0874, 0.0685,
        0.0557])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3242, Accuracy: 106/10000 (1.0600%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 4.6683, Accuracy: 800/9950 (8.0402%)
saving model
Done in 430.1768751144409 sec.
Server Epoch:90 choose agents : [46, 51, 28, 5, 48, 71, 20, 24, 41, 17].
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   1, Avg loss: 0.0526, Accuracy: 455/1904 (23.8971%)
_Train Local_ResNet_18, epoch  90, local model 46, internal_epoch   2, Avg loss: 0.0285, Accuracy: 811/1904 (42.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2518, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0538, Accuracy: 337/1049 (32.1258%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0255, Accuracy: 597/1049 (56.9113%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4695, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0538, Accuracy: 433/1581 (27.3877%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 669/1581 (42.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9223, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   1, Avg loss: 0.0474, Accuracy: 474/1628 (29.1155%)
_Train Local_ResNet_18, epoch  90, local model 5, internal_epoch   2, Avg loss: 0.0228, Accuracy: 930/1628 (57.1253%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2335, Accuracy: 168/10000 (1.6800%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   1, Avg loss: 0.0675, Accuracy: 161/631 (25.5151%)
_Train Local_ResNet_18, epoch  90, local model 48, internal_epoch   2, Avg loss: 0.0387, Accuracy: 285/631 (45.1664%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4641, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0550, Accuracy: 260/818 (31.7848%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0260, Accuracy: 443/818 (54.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.3665, Accuracy: 92/10000 (0.9200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   1, Avg loss: 0.0586, Accuracy: 288/807 (35.6877%)
_Train Local_ResNet_18, epoch  90, local model 20, internal_epoch   2, Avg loss: 0.0290, Accuracy: 439/807 (54.3990%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5392, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0819, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0424, Accuracy: 199/312 (63.7821%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.6776, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0578, Accuracy: 321/719 (44.6453%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 446/719 (62.0306%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4486, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   1, Avg loss: 0.0486, Accuracy: 494/1574 (31.3850%)
_Train Local_ResNet_18, epoch  90, local model 17, internal_epoch   2, Avg loss: 0.0241, Accuracy: 750/1574 (47.6493%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5215, Accuracy: 121/10000 (1.2100%)
time spent on training: 293.97587609291077
[rfa agg] training data poison_ratio: 0.07321055973872811  data num: [1904, 1049, 1581, 1628, 631, 818, 807, 312, 719, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.022878299918352538
[rfa agg] init. name: [46, 51, 28, 5, 48, 71, 20, 24, 41, 17], weight: tensor([0.1727, 0.0952, 0.1434, 0.1477, 0.0572, 0.0742, 0.0732, 0.0283, 0.0652,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 64.00237274169922, obj_val: 65.98258209228516, abs dis: 1.9802093505859375
[rfa agg] iter: 0, weight: tensor([0.0931, 0.2500, 0.1408, 0.1249, 0.0378, 0.0733, 0.0721, 0.0120, 0.0552,
        0.1407])
[rfa agg] iter:  1, prev_obj_val: 65.98258209228516, obj_val: 69.79688262939453, abs dis: 3.814300537109375
[rfa agg] iter: 1, weight: tensor([0.0738, 0.3686, 0.1047, 0.0945, 0.0367, 0.0759, 0.0746, 0.0112, 0.0556,
        0.1044])
[rfa agg] iter:  2, prev_obj_val: 69.79688262939453, obj_val: 71.49188995361328, abs dis: 1.69500732421875
[rfa agg] iter: 2, weight: tensor([0.0541, 0.4547, 0.0712, 0.0657, 0.0372, 0.0885, 0.0866, 0.0104, 0.0607,
        0.0709])
[rfa agg] iter:  3, prev_obj_val: 71.49188995361328, obj_val: 76.88066101074219, abs dis: 5.388771057128906
[rfa agg] iter: 3, weight: tensor([0.0572, 0.3748, 0.0738, 0.0684, 0.0441, 0.1122, 0.1096, 0.0120, 0.0745,
        0.0735])
[rfa agg] iter:  4, prev_obj_val: 76.88066101074219, obj_val: 75.01805877685547, abs dis: 1.8626022338867188
[rfa agg] iter: 4, weight: tensor([0.0511, 0.1681, 0.0625, 0.0588, 0.0578, 0.2097, 0.2005, 0.0137, 0.1155,
        0.0623])
[rfa agg] iter:  5, prev_obj_val: 75.01805877685547, obj_val: 75.01509094238281, abs dis: 0.00296783447265625
[rfa agg] iter: 5, weight: tensor([0.0566, 0.2115, 0.0704, 0.0660, 0.0561, 0.1773, 0.1729, 0.0139, 0.1053,
        0.0702])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3225, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 4.7001, Accuracy: 681/9950 (6.8442%)
saving model
Done in 465.0567388534546 sec.
Server Epoch:91 choose agents : [26, 43, 41, 42, 36, 81, 31, 76, 8, 57].
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 370/1446 (25.5878%)
_Train Local_ResNet_18, epoch  91, local model 26, internal_epoch   2, Avg loss: 0.0328, Accuracy: 540/1446 (37.3444%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.6744, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0604, Accuracy: 289/946 (30.5497%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0320, Accuracy: 376/946 (39.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5782, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   1, Avg loss: 0.0576, Accuracy: 326/719 (45.3408%)
_Train Local_ResNet_18, epoch  91, local model 41, internal_epoch   2, Avg loss: 0.0301, Accuracy: 445/719 (61.8915%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.0901, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 356/1372 (25.9475%)
_Train Local_ResNet_18, epoch  91, local model 42, internal_epoch   2, Avg loss: 0.0296, Accuracy: 550/1372 (40.0875%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7312, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0794, Accuracy: 67/408 (16.4216%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0455, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.0706, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   1, Avg loss: 0.0572, Accuracy: 298/774 (38.5013%)
_Train Local_ResNet_18, epoch  91, local model 81, internal_epoch   2, Avg loss: 0.0300, Accuracy: 364/774 (47.0284%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3637, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   1, Avg loss: 0.0767, Accuracy: 86/460 (18.6957%)
_Train Local_ResNet_18, epoch  91, local model 31, internal_epoch   2, Avg loss: 0.0335, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3447, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   1, Avg loss: 0.0773, Accuracy: 74/466 (15.8798%)
_Train Local_ResNet_18, epoch  91, local model 76, internal_epoch   2, Avg loss: 0.0427, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8483, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   1, Avg loss: 0.0558, Accuracy: 332/1513 (21.9432%)
_Train Local_ResNet_18, epoch  91, local model 8, internal_epoch   2, Avg loss: 0.0339, Accuracy: 581/1513 (38.4005%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9726, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   1, Avg loss: 0.0521, Accuracy: 322/1154 (27.9029%)
_Train Local_ResNet_18, epoch  91, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 504/1154 (43.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.0149, Accuracy: 66/10000 (0.6600%)
time spent on training: 285.28119444847107
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 946, 719, 1372, 408, 774, 460, 466, 1513, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 43, 41, 42, 36, 81, 31, 76, 8, 57], weight: tensor([0.1562, 0.1022, 0.0777, 0.1482, 0.0441, 0.0836, 0.0497, 0.0503, 0.1634,
        0.1246])
[rfa agg] iter:  0, prev_obj_val: 51.90185546875, obj_val: 56.8778076171875, abs dis: 4.9759521484375
[rfa agg] iter: 0, weight: tensor([0.0535, 0.5211, 0.0699, 0.0579, 0.0151, 0.1096, 0.0195, 0.0197, 0.0498,
        0.0840])
[rfa agg] iter:  1, prev_obj_val: 56.8778076171875, obj_val: 61.06539535522461, abs dis: 4.187587738037109
[rfa agg] iter: 1, weight: tensor([0.0524, 0.2138, 0.1536, 0.0555, 0.0216, 0.3240, 0.0288, 0.0291, 0.0496,
        0.0716])
[rfa agg] iter:  2, prev_obj_val: 61.06539535522461, obj_val: 69.72674560546875, abs dis: 8.66135025024414
[rfa agg] iter: 2, weight: tensor([0.0406, 0.1098, 0.2970, 0.0426, 0.0219, 0.3367, 0.0301, 0.0304, 0.0389,
        0.0521])
[rfa agg] iter:  3, prev_obj_val: 69.72674560546875, obj_val: 63.64309310913086, abs dis: 6.083652496337891
[rfa agg] iter: 3, weight: tensor([0.0551, 0.1073, 0.3026, 0.0570, 0.0465, 0.1731, 0.0693, 0.0701, 0.0533,
        0.0657])
[rfa agg] iter:  4, prev_obj_val: 63.64309310913086, obj_val: 72.88561248779297, abs dis: 9.24251937866211
[rfa agg] iter: 4, weight: tensor([0.0363, 0.0858, 0.4863, 0.0378, 0.0225, 0.1876, 0.0316, 0.0320, 0.0348,
        0.0453])
[rfa agg] iter:  5, prev_obj_val: 72.88561248779297, obj_val: 69.71549224853516, abs dis: 3.1701202392578125
[rfa agg] iter: 5, weight: tensor([0.0595, 0.1075, 0.2421, 0.0614, 0.0596, 0.1558, 0.0930, 0.0939, 0.0577,
        0.0696])
[rfa agg] iter:  6, prev_obj_val: 69.71549224853516, obj_val: 63.643341064453125, abs dis: 6.072151184082031
[rfa agg] iter: 6, weight: tensor([0.0553, 0.1078, 0.3022, 0.0572, 0.0467, 0.1713, 0.0697, 0.0705, 0.0534,
        0.0659])
[rfa agg] iter:  7, prev_obj_val: 63.643341064453125, obj_val: 72.88560485839844, abs dis: 9.242263793945312
[rfa agg] iter: 7, weight: tensor([0.0363, 0.0859, 0.4862, 0.0379, 0.0225, 0.1876, 0.0316, 0.0320, 0.0348,
        0.0453])
[rfa agg] iter:  8, prev_obj_val: 72.88560485839844, obj_val: 69.71549224853516, abs dis: 3.1701126098632812
[rfa agg] iter: 8, weight: tensor([0.0595, 0.1075, 0.2421, 0.0614, 0.0596, 0.1558, 0.0930, 0.0939, 0.0577,
        0.0696])
[rfa agg] iter:  9, prev_obj_val: 69.71549224853516, obj_val: 63.643341064453125, abs dis: 6.072151184082031
[rfa agg] iter: 9, weight: tensor([0.0553, 0.1078, 0.3022, 0.0572, 0.0467, 0.1713, 0.0697, 0.0705, 0.0534,
        0.0659])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3212, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 4.7316, Accuracy: 609/9950 (6.1206%)
saving model
Done in 453.639226436615 sec.
Server Epoch:92 choose agents : [38, 36, 76, 12, 77, 96, 67, 3, 53, 25].
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0535, Accuracy: 394/1131 (34.8364%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0265, Accuracy: 541/1131 (47.8338%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1601, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   1, Avg loss: 0.0785, Accuracy: 65/408 (15.9314%)
_Train Local_ResNet_18, epoch  92, local model 36, internal_epoch   2, Avg loss: 0.0440, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2187, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0785, Accuracy: 79/466 (16.9528%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0408, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3951, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   1, Avg loss: 0.0850, Accuracy: 40/338 (11.8343%)
_Train Local_ResNet_18, epoch  92, local model 12, internal_epoch   2, Avg loss: 0.0441, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.9632, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0469, Accuracy: 401/1340 (29.9254%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0241, Accuracy: 629/1340 (46.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.2058, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0801, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0520, Accuracy: 140/311 (45.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.2967, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0703, Accuracy: 104/426 (24.4131%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0379, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.7265, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0648, Accuracy: 154/781 (19.7183%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0317, Accuracy: 285/781 (36.4917%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4643, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   1, Avg loss: 0.0411, Accuracy: 384/813 (47.2325%)
_Train Local_ResNet_18, epoch  92, local model 53, internal_epoch   2, Avg loss: 0.0177, Accuracy: 526/813 (64.6986%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.7135, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   1, Avg loss: 0.0500, Accuracy: 324/690 (46.9565%)
_Train Local_ResNet_18, epoch  92, local model 25, internal_epoch   2, Avg loss: 0.0222, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5681, Accuracy: 87/10000 (0.8700%)
time spent on training: 243.0917031764984
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 466, 338, 1340, 311, 426, 781, 813, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 76, 12, 77, 96, 67, 3, 53, 25], weight: tensor([0.1687, 0.0609, 0.0695, 0.0504, 0.1999, 0.0464, 0.0635, 0.1165, 0.1213,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 43.35789108276367, obj_val: 49.6822395324707, abs dis: 6.324348449707031
[rfa agg] iter: 0, weight: tensor([0.0648, 0.0338, 0.0494, 0.0230, 0.0526, 0.0179, 0.0353, 0.1841, 0.1906,
        0.3484])
[rfa agg] iter:  1, prev_obj_val: 49.6822395324707, obj_val: 51.53764724731445, abs dis: 1.85540771484375
[rfa agg] iter: 1, weight: tensor([0.0685, 0.0833, 0.1531, 0.0496, 0.0600, 0.0356, 0.0868, 0.1140, 0.1187,
        0.2303])
[rfa agg] iter:  2, prev_obj_val: 51.53764724731445, obj_val: 55.46363830566406, abs dis: 3.9259910583496094
[rfa agg] iter: 2, weight: tensor([0.0626, 0.1005, 0.2159, 0.0560, 0.0556, 0.0387, 0.1048, 0.0967, 0.1007,
        0.1685])
[rfa agg] iter:  3, prev_obj_val: 55.46363830566406, obj_val: 63.924530029296875, abs dis: 8.460891723632812
[rfa agg] iter: 3, weight: tensor([0.0366, 0.1259, 0.4091, 0.0543, 0.0334, 0.0334, 0.1307, 0.0504, 0.0525,
        0.0737])
[rfa agg] iter:  4, prev_obj_val: 63.924530029296875, obj_val: 60.49644088745117, abs dis: 3.428089141845703
[rfa agg] iter: 4, weight: tensor([0.0323, 0.2203, 0.1005, 0.1896, 0.0303, 0.0665, 0.2300, 0.0394, 0.0410,
        0.0501])
[rfa agg] iter:  5, prev_obj_val: 60.49644088745117, obj_val: 79.97236633300781, abs dis: 19.47592544555664
[rfa agg] iter: 5, weight: tensor([0.0215, 0.3372, 0.0896, 0.0691, 0.0200, 0.0323, 0.3391, 0.0271, 0.0283,
        0.0358])
[rfa agg] iter:  6, prev_obj_val: 79.97236633300781, obj_val: 63.88844299316406, abs dis: 16.08392333984375
[rfa agg] iter: 6, weight: tensor([0.0498, 0.0967, 0.0786, 0.1321, 0.0483, 0.3193, 0.1010, 0.0546, 0.0568,
        0.0630])
[rfa agg] iter:  7, prev_obj_val: 63.88844299316406, obj_val: 63.86969757080078, abs dis: 0.01874542236328125
[rfa agg] iter: 7, weight: tensor([0.0314, 0.2267, 0.0953, 0.1947, 0.0295, 0.0657, 0.2298, 0.0383, 0.0399,
        0.0487])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3222, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 4.7590, Accuracy: 448/9950 (4.5025%)
saving model
Done in 419.92583894729614 sec.
Server Epoch:93 choose agents : [97, 94, 81, 1, 62, 45, 0, 15, 31, 32].
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   1, Avg loss: 0.0496, Accuracy: 385/1213 (31.7395%)
_Train Local_ResNet_18, epoch  93, local model 97, internal_epoch   2, Avg loss: 0.0267, Accuracy: 582/1213 (47.9802%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8005, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 429/1662 (25.8123%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0305, Accuracy: 711/1662 (42.7798%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1161, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   1, Avg loss: 0.0559, Accuracy: 302/774 (39.0181%)
_Train Local_ResNet_18, epoch  93, local model 81, internal_epoch   2, Avg loss: 0.0303, Accuracy: 343/774 (44.3152%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4953, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0519, Accuracy: 347/928 (37.3922%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0207, Accuracy: 656/928 (70.6897%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0219, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 155/568 (27.2887%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0380, Accuracy: 268/568 (47.1831%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.1370, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0598, Accuracy: 258/669 (38.5650%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0353, Accuracy: 375/669 (56.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.8182, Accuracy: 89/10000 (0.8900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   1, Avg loss: 0.0550, Accuracy: 393/1657 (23.7176%)
_Train Local_ResNet_18, epoch  93, local model 0, internal_epoch   2, Avg loss: 0.0320, Accuracy: 592/1657 (35.7272%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3058, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0537, Accuracy: 369/1154 (31.9757%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0268, Accuracy: 552/1154 (47.8336%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.7204, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   1, Avg loss: 0.0762, Accuracy: 90/460 (19.5652%)
_Train Local_ResNet_18, epoch  93, local model 31, internal_epoch   2, Avg loss: 0.0340, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.5105, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   1, Avg loss: 0.0522, Accuracy: 276/735 (37.5510%)
_Train Local_ResNet_18, epoch  93, local model 32, internal_epoch   2, Avg loss: 0.0194, Accuracy: 423/735 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.7105, Accuracy: 76/10000 (0.7600%)
time spent on training: 328.2235996723175
[rfa agg] training data poison_ratio: 0.16873727087576373  data num: [1213, 1662, 774, 928, 568, 669, 1657, 1154, 460, 735]
[rfa agg] considering poison per batch poison_fraction: 0.05273039714867617
[rfa agg] init. name: [97, 94, 81, 1, 62, 45, 0, 15, 31, 32], weight: tensor([0.1235, 0.1692, 0.0788, 0.0945, 0.0578, 0.0681, 0.1687, 0.1175, 0.0468,
        0.0748])
[rfa agg] iter:  0, prev_obj_val: 53.76988220214844, obj_val: 60.89571762084961, abs dis: 7.125835418701172
[rfa agg] iter: 0, weight: tensor([0.1222, 0.0566, 0.1074, 0.3615, 0.0312, 0.0528, 0.0565, 0.1155, 0.0219,
        0.0744])
[rfa agg] iter:  1, prev_obj_val: 60.89571762084961, obj_val: 68.03060913085938, abs dis: 7.134891510009766
[rfa agg] iter: 1, weight: tensor([0.0589, 0.0374, 0.3328, 0.1313, 0.0412, 0.0942, 0.0373, 0.0559, 0.0268,
        0.1841])
[rfa agg] iter:  2, prev_obj_val: 68.03060913085938, obj_val: 71.02063751220703, abs dis: 2.9900283813476562
[rfa agg] iter: 2, weight: tensor([0.0452, 0.0321, 0.1384, 0.0727, 0.0625, 0.2443, 0.0320, 0.0429, 0.0365,
        0.2934])
[rfa agg] iter:  3, prev_obj_val: 71.02063751220703, obj_val: 77.81658172607422, abs dis: 6.7959442138671875
[rfa agg] iter: 3, weight: tensor([0.0425, 0.0311, 0.1046, 0.0641, 0.0778, 0.3764, 0.0311, 0.0404, 0.0427,
        0.1893])
[rfa agg] iter:  4, prev_obj_val: 77.81658172607422, obj_val: 71.0190658569336, abs dis: 6.797515869140625
[rfa agg] iter: 4, weight: tensor([0.0513, 0.0396, 0.0965, 0.0701, 0.1956, 0.2372, 0.0395, 0.0488, 0.0857,
        0.1357])
[rfa agg] iter:  5, prev_obj_val: 71.0190658569336, obj_val: 77.8178939819336, abs dis: 6.798828125
[rfa agg] iter: 5, weight: tensor([0.0420, 0.0308, 0.1031, 0.0634, 0.0775, 0.3887, 0.0307, 0.0399, 0.0423,
        0.1815])
[rfa agg] iter:  6, prev_obj_val: 77.8178939819336, obj_val: 71.01893615722656, abs dis: 6.798957824707031
[rfa agg] iter: 6, weight: tensor([0.0513, 0.0396, 0.0965, 0.0701, 0.1954, 0.2378, 0.0395, 0.0487, 0.0856,
        0.1355])
[rfa agg] iter:  7, prev_obj_val: 71.01893615722656, obj_val: 77.81792449951172, abs dis: 6.798988342285156
[rfa agg] iter: 7, weight: tensor([0.0420, 0.0308, 0.1030, 0.0634, 0.0775, 0.3890, 0.0307, 0.0399, 0.0423,
        0.1814])
[rfa agg] iter:  8, prev_obj_val: 77.81792449951172, obj_val: 71.01893615722656, abs dis: 6.798988342285156
[rfa agg] iter: 8, weight: tensor([0.0513, 0.0396, 0.0965, 0.0701, 0.1954, 0.2378, 0.0395, 0.0487, 0.0856,
        0.1355])
[rfa agg] iter:  9, prev_obj_val: 71.01893615722656, obj_val: 77.81793212890625, abs dis: 6.7989959716796875
[rfa agg] iter: 9, weight: tensor([0.0420, 0.0308, 0.1030, 0.0634, 0.0775, 0.3890, 0.0307, 0.0399, 0.0423,
        0.1814])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3227, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 4.6367, Accuracy: 1065/9950 (10.7035%)
saving model
Done in 497.4350354671478 sec.
Server Epoch:94 choose agents : [80, 7, 37, 2, 99, 16, 49, 71, 59, 78].
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   1, Avg loss: 0.0620, Accuracy: 190/682 (27.8592%)
_Train Local_ResNet_18, epoch  94, local model 80, internal_epoch   2, Avg loss: 0.0350, Accuracy: 281/682 (41.2023%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.1990, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   1, Avg loss: 0.0514, Accuracy: 360/891 (40.4040%)
_Train Local_ResNet_18, epoch  94, local model 7, internal_epoch   2, Avg loss: 0.0235, Accuracy: 473/891 (53.0864%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8851, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   1, Avg loss: 0.0453, Accuracy: 563/1129 (49.8671%)
_Train Local_ResNet_18, epoch  94, local model 37, internal_epoch   2, Avg loss: 0.0216, Accuracy: 776/1129 (68.7334%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8312, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0617, Accuracy: 226/605 (37.3554%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0375, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.1028, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   1, Avg loss: 0.0538, Accuracy: 316/773 (40.8797%)
_Train Local_ResNet_18, epoch  94, local model 99, internal_epoch   2, Avg loss: 0.0249, Accuracy: 455/773 (58.8616%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.6672, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1, Avg loss: 0.0579, Accuracy: 299/708 (42.2316%)
_Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2, Avg loss: 0.0317, Accuracy: 436/708 (61.5819%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7205, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   1, Avg loss: 0.0775, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  94, local model 49, internal_epoch   2, Avg loss: 0.0461, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.6671, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   1, Avg loss: 0.0544, Accuracy: 272/818 (33.2518%)
_Train Local_ResNet_18, epoch  94, local model 71, internal_epoch   2, Avg loss: 0.0262, Accuracy: 439/818 (53.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.1522, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   1, Avg loss: 0.0549, Accuracy: 369/1089 (33.8843%)
_Train Local_ResNet_18, epoch  94, local model 59, internal_epoch   2, Avg loss: 0.0248, Accuracy: 528/1089 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.8101, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   1, Avg loss: 0.0802, Accuracy: 67/416 (16.1058%)
_Train Local_ResNet_18, epoch  94, local model 78, internal_epoch   2, Avg loss: 0.0418, Accuracy: 245/416 (58.8942%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3664, Accuracy: 82/10000 (0.8200%)
time spent on training: 232.51350808143616
[rfa agg] training data poison_ratio: 0.0  data num: [682, 891, 1129, 605, 773, 708, 440, 818, 1089, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 7, 37, 2, 99, 16, 49, 71, 59, 78], weight: tensor([0.0903, 0.1180, 0.1495, 0.0801, 0.1024, 0.0938, 0.0583, 0.1083, 0.1442,
        0.0551])
[rfa agg] iter:  0, prev_obj_val: 34.548683166503906, obj_val: 43.8329963684082, abs dis: 9.284313201904297
[rfa agg] iter: 0, weight: tensor([0.2519, 0.0691, 0.0412, 0.2401, 0.0828, 0.1206, 0.0344, 0.0878, 0.0396,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 43.8329963684082, obj_val: 40.449615478515625, abs dis: 3.383380889892578
[rfa agg] iter: 1, weight: tensor([0.1410, 0.0746, 0.0526, 0.2399, 0.0808, 0.0980, 0.0912, 0.0855, 0.0506,
        0.0858])
[rfa agg] iter:  2, prev_obj_val: 40.449615478515625, obj_val: 47.25250244140625, abs dis: 6.802886962890625
[rfa agg] iter: 2, weight: tensor([0.1481, 0.0669, 0.0450, 0.3337, 0.0744, 0.0944, 0.0594, 0.0787, 0.0433,
        0.0560])
[rfa agg] iter:  3, prev_obj_val: 47.25250244140625, obj_val: 47.24314498901367, abs dis: 0.009357452392578125
[rfa agg] iter: 3, weight: tensor([0.1244, 0.0747, 0.0548, 0.1830, 0.0790, 0.0927, 0.1317, 0.0836, 0.0527,
        0.1234])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3231, Accuracy: 105/10000 (1.0500%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.6603, Accuracy: 855/9950 (8.5930%)
saving model
Done in 395.7495024204254 sec.
Server Epoch:95 choose agents : [58, 24, 20, 10, 29, 56, 51, 25, 5, 3].
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 327/803 (40.7223%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0331, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.1250, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   1, Avg loss: 0.0820, Accuracy: 19/312 (6.0897%)
_Train Local_ResNet_18, epoch  95, local model 24, internal_epoch   2, Avg loss: 0.0418, Accuracy: 198/312 (63.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.6718, Accuracy: 62/10000 (0.6200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 302/807 (37.4226%)
_Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2, Avg loss: 0.0300, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.3117, Accuracy: 79/10000 (0.7900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0525, Accuracy: 270/861 (31.3589%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0180, Accuracy: 518/861 (60.1626%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0214, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0510, Accuracy: 423/1440 (29.3750%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 754/1440 (52.3611%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7603, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   1, Avg loss: 0.0849, Accuracy: 3/186 (1.6129%)
_Train Local_ResNet_18, epoch  95, local model 56, internal_epoch   2, Avg loss: 0.0691, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.4113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   1, Avg loss: 0.0520, Accuracy: 377/1049 (35.9390%)
_Train Local_ResNet_18, epoch  95, local model 51, internal_epoch   2, Avg loss: 0.0256, Accuracy: 593/1049 (56.5300%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2717, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   1, Avg loss: 0.0506, Accuracy: 328/690 (47.5362%)
_Train Local_ResNet_18, epoch  95, local model 25, internal_epoch   2, Avg loss: 0.0218, Accuracy: 473/690 (68.5507%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6110, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   1, Avg loss: 0.0466, Accuracy: 482/1628 (29.6069%)
_Train Local_ResNet_18, epoch  95, local model 5, internal_epoch   2, Avg loss: 0.0232, Accuracy: 899/1628 (55.2211%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5036, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0639, Accuracy: 155/781 (19.8464%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0319, Accuracy: 298/781 (38.1562%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4919, Accuracy: 111/10000 (1.1100%)
time spent on training: 288.03343057632446
[rfa agg] training data poison_ratio: 0.19492812901717893  data num: [803, 312, 807, 861, 1440, 186, 1049, 690, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.060915040317868416
[rfa agg] init. name: [58, 24, 20, 10, 29, 56, 51, 25, 5, 3], weight: tensor([0.0938, 0.0365, 0.0943, 0.1006, 0.1683, 0.0217, 0.1226, 0.0806, 0.1903,
        0.0913])
[rfa agg] iter:  0, prev_obj_val: 48.12041091918945, obj_val: 52.78339767456055, abs dis: 4.662986755371094
[rfa agg] iter: 0, weight: tensor([0.1439, 0.0095, 0.1393, 0.3001, 0.0490, 0.0047, 0.1138, 0.0565, 0.0410,
        0.1423])
[rfa agg] iter:  1, prev_obj_val: 52.78339767456055, obj_val: 55.67668151855469, abs dis: 2.8932838439941406
[rfa agg] iter: 1, weight: tensor([0.2262, 0.0091, 0.2028, 0.1195, 0.0300, 0.0043, 0.0500, 0.0947, 0.0264,
        0.2370])
[rfa agg] iter:  2, prev_obj_val: 55.67668151855469, obj_val: 58.816184997558594, abs dis: 3.1395034790039062
[rfa agg] iter: 2, weight: tensor([0.1944, 0.0123, 0.1857, 0.1132, 0.0359, 0.0057, 0.0566, 0.1693, 0.0319,
        0.1951])
[rfa agg] iter:  3, prev_obj_val: 58.816184997558594, obj_val: 69.70050811767578, abs dis: 10.884323120117188
[rfa agg] iter: 3, weight: tensor([0.1510, 0.0144, 0.1479, 0.1005, 0.0375, 0.0066, 0.0564, 0.3028, 0.0337,
        0.1493])
[rfa agg] iter:  4, prev_obj_val: 69.70050811767578, obj_val: 58.80644226074219, abs dis: 10.894065856933594
[rfa agg] iter: 4, weight: tensor([0.1261, 0.0298, 0.1256, 0.1019, 0.0530, 0.0127, 0.0711, 0.3078, 0.0487,
        0.1232])
[rfa agg] iter:  5, prev_obj_val: 58.80644226074219, obj_val: 65.83533477783203, abs dis: 7.028892517089844
[rfa agg] iter: 5, weight: tensor([0.1472, 0.0141, 0.1433, 0.0984, 0.0368, 0.0064, 0.0553, 0.3196, 0.0330,
        0.1457])
[rfa agg] iter:  6, prev_obj_val: 65.83533477783203, obj_val: 73.606201171875, abs dis: 7.770866394042969
[rfa agg] iter: 6, weight: tensor([0.1148, 0.0208, 0.1140, 0.0887, 0.0421, 0.0091, 0.0585, 0.4012, 0.0384,
        0.1124])
[rfa agg] iter:  7, prev_obj_val: 73.606201171875, obj_val: 58.80997848510742, abs dis: 14.796222686767578
[rfa agg] iter: 7, weight: tensor([0.1291, 0.0394, 0.1289, 0.1081, 0.0607, 0.0163, 0.0791, 0.2561, 0.0562,
        0.1260])
[rfa agg] iter:  8, prev_obj_val: 58.80997848510742, obj_val: 69.70048522949219, abs dis: 10.890506744384766
[rfa agg] iter: 8, weight: tensor([0.1487, 0.0143, 0.1448, 0.0993, 0.0371, 0.0065, 0.0558, 0.3130, 0.0333,
        0.1471])
[rfa agg] iter:  9, prev_obj_val: 69.70048522949219, obj_val: 58.806434631347656, abs dis: 10.894050598144531
[rfa agg] iter: 9, weight: tensor([0.1260, 0.0298, 0.1256, 0.1019, 0.0530, 0.0127, 0.0711, 0.3082, 0.0487,
        0.1231])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3222, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.6913, Accuracy: 663/9950 (6.6633%)
saving model
Done in 457.85027170181274 sec.
Server Epoch:96 choose agents : [84, 4, 1, 11, 43, 2, 62, 12, 31, 82].
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   1, Avg loss: 0.0546, Accuracy: 348/1190 (29.2437%)
_Train Local_ResNet_18, epoch  96, local model 84, internal_epoch   2, Avg loss: 0.0283, Accuracy: 528/1190 (44.3697%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1920, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0600, Accuracy: 341/901 (37.8468%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 390/901 (43.2852%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.3768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0510, Accuracy: 368/928 (39.6552%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0208, Accuracy: 638/928 (68.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.5005, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 302/712 (42.4157%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0242, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6536, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   1, Avg loss: 0.0603, Accuracy: 281/946 (29.7040%)
_Train Local_ResNet_18, epoch  96, local model 43, internal_epoch   2, Avg loss: 0.0316, Accuracy: 419/946 (44.2918%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4026, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0354, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9456, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 162/568 (28.5211%)
_Train Local_ResNet_18, epoch  96, local model 62, internal_epoch   2, Avg loss: 0.0381, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.2680, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0836, Accuracy: 52/338 (15.3846%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0429, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.8941, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   1, Avg loss: 0.0756, Accuracy: 87/460 (18.9130%)
_Train Local_ResNet_18, epoch  96, local model 31, internal_epoch   2, Avg loss: 0.0341, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1085, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0741, Accuracy: 97/500 (19.4000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0464, Accuracy: 214/500 (42.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4581, Accuracy: 75/10000 (0.7500%)
time spent on training: 253.59479904174805
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 901, 928, 712, 946, 605, 568, 338, 460, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 4, 1, 11, 43, 2, 62, 12, 31, 82], weight: tensor([0.1665, 0.1260, 0.1298, 0.0996, 0.1323, 0.0846, 0.0795, 0.0473, 0.0644,
        0.0699])
[rfa agg] iter:  0, prev_obj_val: 36.526920318603516, obj_val: 38.03925704956055, abs dis: 1.5123367309570312
[rfa agg] iter: 0, weight: tensor([0.0483, 0.0685, 0.0702, 0.1553, 0.0723, 0.3012, 0.1270, 0.0259, 0.0629,
        0.0682])
[rfa agg] iter:  1, prev_obj_val: 38.03925704956055, obj_val: 45.03557586669922, abs dis: 6.996318817138672
[rfa agg] iter: 1, weight: tensor([0.0354, 0.0480, 0.0491, 0.0930, 0.0506, 0.4316, 0.1432, 0.0227, 0.0608,
        0.0656])
[rfa agg] iter:  2, prev_obj_val: 45.03557586669922, obj_val: 44.947837829589844, abs dis: 0.087738037109375
[rfa agg] iter: 2, weight: tensor([0.0312, 0.0380, 0.0390, 0.0555, 0.0400, 0.1092, 0.2462, 0.0370, 0.2023,
        0.2016])
[rfa agg] iter:  3, prev_obj_val: 44.947837829589844, obj_val: 48.015716552734375, abs dis: 3.0678787231445312
[rfa agg] iter: 3, weight: tensor([0.0293, 0.0358, 0.0367, 0.0522, 0.0376, 0.0997, 0.2569, 0.0348, 0.2046,
        0.2123])
[rfa agg] iter:  4, prev_obj_val: 48.015716552734375, obj_val: 63.893375396728516, abs dis: 15.87765884399414
[rfa agg] iter: 4, weight: tensor([0.0231, 0.0275, 0.0282, 0.0379, 0.0289, 0.0631, 0.1175, 0.0359, 0.3281,
        0.3099])
[rfa agg] iter:  5, prev_obj_val: 63.893375396728516, obj_val: 55.74879837036133, abs dis: 8.144577026367188
[rfa agg] iter: 5, weight: tensor([0.0378, 0.0414, 0.0425, 0.0490, 0.0435, 0.0622, 0.0780, 0.4488, 0.0945,
        0.1024])
[rfa agg] iter:  6, prev_obj_val: 55.74879837036133, obj_val: 51.76024627685547, abs dis: 3.9885520935058594
[rfa agg] iter: 6, weight: tensor([0.0430, 0.0488, 0.0502, 0.0616, 0.0513, 0.0867, 0.1216, 0.1449, 0.1885,
        0.2033])
[rfa agg] iter:  7, prev_obj_val: 51.76024627685547, obj_val: 48.00419235229492, abs dis: 3.756053924560547
[rfa agg] iter: 7, weight: tensor([0.0337, 0.0391, 0.0401, 0.0513, 0.0411, 0.0777, 0.1209, 0.0725, 0.2552,
        0.2685])
[rfa agg] iter:  8, prev_obj_val: 48.00419235229492, obj_val: 59.77576446533203, abs dis: 11.77157211303711
[rfa agg] iter: 8, weight: tensor([0.0224, 0.0266, 0.0273, 0.0366, 0.0280, 0.0610, 0.1122, 0.0347, 0.3297,
        0.3215])
[rfa agg] iter:  9, prev_obj_val: 59.77576446533203, obj_val: 55.737579345703125, abs dis: 4.038185119628906
[rfa agg] iter: 9, weight: tensor([0.0442, 0.0492, 0.0506, 0.0600, 0.0517, 0.0797, 0.1049, 0.2669, 0.1406,
        0.1522])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3220, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 4.7080, Accuracy: 602/9950 (6.0503%)
saving model
Done in 419.6329011917114 sec.
Server Epoch:97 choose agents : [82, 9, 2, 32, 45, 55, 65, 3, 16, 6].
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0727, Accuracy: 107/500 (21.4000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0461, Accuracy: 220/500 (44.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4444, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   1, Avg loss: 0.0459, Accuracy: 408/1275 (32.0000%)
_Train Local_ResNet_18, epoch  97, local model 9, internal_epoch   2, Avg loss: 0.0170, Accuracy: 786/1275 (61.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.2322, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0612, Accuracy: 225/605 (37.1901%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0367, Accuracy: 333/605 (55.0413%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3040, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   1, Avg loss: 0.0502, Accuracy: 286/735 (38.9116%)
_Train Local_ResNet_18, epoch  97, local model 32, internal_epoch   2, Avg loss: 0.0197, Accuracy: 409/735 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.7552, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   1, Avg loss: 0.0574, Accuracy: 287/669 (42.8999%)
_Train Local_ResNet_18, epoch  97, local model 45, internal_epoch   2, Avg loss: 0.0337, Accuracy: 375/669 (56.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.8376, Accuracy: 94/10000 (0.9400%)
poison local model 55 index 7 
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   1, Avg loss: 0.0501, Accuracy: 367/1071 (34.2670%)
_Train Local_ResNet_18, epoch  97, local model 55, internal_epoch   2, Avg loss: 0.0270, Accuracy: 573/1071 (53.5014%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0291, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   1, Avg loss: 0.0519, Accuracy: 488/1475 (33.0847%)
_Train Local_ResNet_18, epoch  97, local model 65, internal_epoch   2, Avg loss: 0.0276, Accuracy: 765/1475 (51.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.0416, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0629, Accuracy: 182/781 (23.3035%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0315, Accuracy: 297/781 (38.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7599, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1, Avg loss: 0.0578, Accuracy: 304/708 (42.9379%)
_Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2, Avg loss: 0.0305, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3978, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   1, Avg loss: 0.0512, Accuracy: 469/1956 (23.9775%)
_Train Local_ResNet_18, epoch  97, local model 6, internal_epoch   2, Avg loss: 0.0294, Accuracy: 751/1956 (38.3947%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4570, Accuracy: 132/10000 (1.3200%)
time spent on training: 309.1966369152069
[rfa agg] training data poison_ratio: 0.10956521739130434  data num: [500, 1275, 605, 735, 669, 1071, 1475, 781, 708, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.034239130434782605
[rfa agg] init. name: [82, 9, 2, 32, 45, 55, 65, 3, 16, 6], weight: tensor([0.0512, 0.1304, 0.0619, 0.0752, 0.0684, 0.1096, 0.1509, 0.0799, 0.0724,
        0.2001])
[rfa agg] iter:  0, prev_obj_val: 60.71733093261719, obj_val: 62.87257385253906, abs dis: 2.155242919921875
[rfa agg] iter: 0, weight: tensor([0.0223, 0.1352, 0.0352, 0.0615, 0.0459, 0.4322, 0.0740, 0.0835, 0.0591,
        0.0511])
[rfa agg] iter:  1, prev_obj_val: 62.87257385253906, obj_val: 65.4028549194336, abs dis: 2.5302810668945312
[rfa agg] iter: 1, weight: tensor([0.0315, 0.1116, 0.0531, 0.1066, 0.0732, 0.2304, 0.0720, 0.1653, 0.1022,
        0.0540])
[rfa agg] iter:  2, prev_obj_val: 65.4028549194336, obj_val: 67.88528442382812, abs dis: 2.4824295043945312
[rfa agg] iter: 2, weight: tensor([0.0277, 0.0596, 0.0522, 0.1423, 0.0797, 0.0920, 0.0427, 0.3350, 0.1348,
        0.0341])
[rfa agg] iter:  3, prev_obj_val: 67.88528442382812, obj_val: 78.4810562133789, abs dis: 10.595771789550781
[rfa agg] iter: 3, weight: tensor([0.0237, 0.0363, 0.0509, 0.2313, 0.0885, 0.0504, 0.0274, 0.2645, 0.2043,
        0.0227])
[rfa agg] iter:  4, prev_obj_val: 78.4810562133789, obj_val: 81.95308685302734, abs dis: 3.4720306396484375
[rfa agg] iter: 4, weight: tensor([0.0544, 0.0370, 0.2364, 0.1305, 0.2312, 0.0452, 0.0301, 0.0851, 0.1236,
        0.0264])
[rfa agg] iter:  5, prev_obj_val: 81.95308685302734, obj_val: 81.93367767333984, abs dis: 0.0194091796875
[rfa agg] iter: 5, weight: tensor([0.0667, 0.0347, 0.3801, 0.0980, 0.1613, 0.0416, 0.0287, 0.0700, 0.0934,
        0.0254])
[rfa agg] iter:  6, prev_obj_val: 81.93367767333984, obj_val: 81.93079376220703, abs dis: 0.0028839111328125
[rfa agg] iter: 6, weight: tensor([0.0611, 0.0318, 0.4375, 0.0896, 0.1432, 0.0380, 0.0263, 0.0641, 0.0852,
        0.0233])
[rfa agg] iter:  7, prev_obj_val: 81.93079376220703, obj_val: 85.76766967773438, abs dis: 3.8368759155273438
[rfa agg] iter: 7, weight: tensor([0.0585, 0.0304, 0.4629, 0.0858, 0.1357, 0.0364, 0.0251, 0.0613, 0.0815,
        0.0223])
[rfa agg] iter:  8, prev_obj_val: 85.76766967773438, obj_val: 89.72098541259766, abs dis: 3.9533157348632812
[rfa agg] iter: 8, weight: tensor([0.1063, 0.0402, 0.3451, 0.0960, 0.1364, 0.0472, 0.0337, 0.0732, 0.0917,
        0.0302])
[rfa agg] iter:  9, prev_obj_val: 89.72098541259766, obj_val: 81.94949340820312, abs dis: 7.771492004394531
[rfa agg] iter: 9, weight: tensor([0.1883, 0.0471, 0.2321, 0.0987, 0.1302, 0.0543, 0.0399, 0.0788, 0.0945,
        0.0362])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3228, Accuracy: 113/10000 (1.1300%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 4.6409, Accuracy: 855/9950 (8.5930%)
saving model
Done in 483.8042085170746 sec.
Server Epoch:98 choose agents : [40, 38, 88, 79, 89, 8, 28, 43, 27, 58].
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   1, Avg loss: 0.0563, Accuracy: 366/1573 (23.2676%)
_Train Local_ResNet_18, epoch  98, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 635/1573 (40.3687%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6337, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   1, Avg loss: 0.0529, Accuracy: 393/1131 (34.7480%)
_Train Local_ResNet_18, epoch  98, local model 38, internal_epoch   2, Avg loss: 0.0262, Accuracy: 543/1131 (48.0106%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1244, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0674, Accuracy: 161/603 (26.6998%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0405, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4171, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   1, Avg loss: 0.1055, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  98, local model 79, internal_epoch   2, Avg loss: 0.0836, Accuracy: 69/197 (35.0254%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4671, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0527, Accuracy: 383/896 (42.7455%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0302, Accuracy: 472/896 (52.6786%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2176, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   1, Avg loss: 0.0559, Accuracy: 365/1513 (24.1243%)
_Train Local_ResNet_18, epoch  98, local model 8, internal_epoch   2, Avg loss: 0.0338, Accuracy: 551/1513 (36.4177%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0450, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   1, Avg loss: 0.0534, Accuracy: 458/1581 (28.9690%)
_Train Local_ResNet_18, epoch  98, local model 28, internal_epoch   2, Avg loss: 0.0309, Accuracy: 664/1581 (41.9987%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.5762, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0604, Accuracy: 280/946 (29.5983%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0319, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.4048, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   1, Avg loss: 0.0556, Accuracy: 414/1587 (26.0870%)
_Train Local_ResNet_18, epoch  98, local model 27, internal_epoch   2, Avg loss: 0.0314, Accuracy: 671/1587 (42.2810%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6978, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 336/803 (41.8431%)
_Train Local_ResNet_18, epoch  98, local model 58, internal_epoch   2, Avg loss: 0.0324, Accuracy: 430/803 (53.5492%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3992, Accuracy: 74/10000 (0.7400%)
time spent on training: 329.9865357875824
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 1131, 603, 197, 896, 1513, 1581, 946, 1587, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 38, 88, 79, 89, 8, 28, 43, 27, 58], weight: tensor([0.1452, 0.1044, 0.0557, 0.0182, 0.0827, 0.1397, 0.1460, 0.0873, 0.1465,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 50.846214294433594, obj_val: 56.88204574584961, abs dis: 6.035831451416016
[rfa agg] iter: 0, weight: tensor([0.0712, 0.4571, 0.0240, 0.0045, 0.0705, 0.0797, 0.0716, 0.0986, 0.0719,
        0.0509])
[rfa agg] iter:  1, prev_obj_val: 56.88204574584961, obj_val: 56.79288101196289, abs dis: 0.08916473388671875
[rfa agg] iter: 1, weight: tensor([0.0611, 0.1932, 0.0351, 0.0058, 0.1474, 0.0661, 0.0614, 0.2760, 0.0617,
        0.0921])
[rfa agg] iter:  2, prev_obj_val: 56.79288101196289, obj_val: 58.469852447509766, abs dis: 1.676971435546875
[rfa agg] iter: 2, weight: tensor([0.0597, 0.1824, 0.0344, 0.0056, 0.1475, 0.0646, 0.0601, 0.2947, 0.0603,
        0.0907])
[rfa agg] iter:  3, prev_obj_val: 58.469852447509766, obj_val: 60.29375076293945, abs dis: 1.8238983154296875
[rfa agg] iter: 3, weight: tensor([0.0469, 0.1234, 0.0311, 0.0049, 0.1582, 0.0504, 0.0472, 0.4006, 0.0474,
        0.0898])
[rfa agg] iter:  4, prev_obj_val: 60.29375076293945, obj_val: 68.14985656738281, abs dis: 7.856105804443359
[rfa agg] iter: 4, weight: tensor([0.0324, 0.0752, 0.0248, 0.0037, 0.1602, 0.0346, 0.0325, 0.5234, 0.0327,
        0.0806])
[rfa agg] iter:  5, prev_obj_val: 68.14985656738281, obj_val: 74.88362121582031, abs dis: 6.7337646484375
[rfa agg] iter: 5, weight: tensor([0.0349, 0.0632, 0.0437, 0.0053, 0.2968, 0.0368, 0.0351, 0.1586, 0.0353,
        0.2902])
[rfa agg] iter:  6, prev_obj_val: 74.88362121582031, obj_val: 78.6270751953125, abs dis: 3.7434539794921875
[rfa agg] iter: 6, weight: tensor([0.0391, 0.0633, 0.0740, 0.0072, 0.1779, 0.0409, 0.0393, 0.1155, 0.0395,
        0.4033])
[rfa agg] iter:  7, prev_obj_val: 78.6270751953125, obj_val: 71.27117156982422, abs dis: 7.355903625488281
[rfa agg] iter: 7, weight: tensor([0.0481, 0.0744, 0.1176, 0.0098, 0.1724, 0.0501, 0.0484, 0.1238, 0.0486,
        0.3069])
[rfa agg] iter:  8, prev_obj_val: 71.27117156982422, obj_val: 78.63595581054688, abs dis: 7.364784240722656
[rfa agg] iter: 8, weight: tensor([0.0285, 0.0487, 0.0435, 0.0048, 0.1718, 0.0299, 0.0287, 0.0999, 0.0288,
        0.5155])
[rfa agg] iter:  9, prev_obj_val: 78.63595581054688, obj_val: 68.0694351196289, abs dis: 10.566520690917969
[rfa agg] iter: 9, weight: tensor([0.0480, 0.0741, 0.1170, 0.0098, 0.1716, 0.0499, 0.0482, 0.1232, 0.0484,
        0.3099])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3228, Accuracy: 102/10000 (1.0200%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 4.6752, Accuracy: 691/9950 (6.9447%)
saving model
Done in 501.04052734375 sec.
Server Epoch:99 choose agents : [75, 60, 66, 94, 77, 17, 26, 35, 23, 61].
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   1, Avg loss: 0.0599, Accuracy: 291/776 (37.5000%)
_Train Local_ResNet_18, epoch  99, local model 75, internal_epoch   2, Avg loss: 0.0257, Accuracy: 428/776 (55.1546%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.5616, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 740/2227 (33.2286%)
_Train Local_ResNet_18, epoch  99, local model 60, internal_epoch   2, Avg loss: 0.0260, Accuracy: 1090/2227 (48.9448%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0206, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0594, Accuracy: 282/1402 (20.1141%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0364, Accuracy: 443/1402 (31.5977%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9876, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 415/1662 (24.9699%)
_Train Local_ResNet_18, epoch  99, local model 94, internal_epoch   2, Avg loss: 0.0305, Accuracy: 705/1662 (42.4188%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.2653, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0464, Accuracy: 434/1340 (32.3881%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0245, Accuracy: 637/1340 (47.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0399, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   1, Avg loss: 0.0487, Accuracy: 485/1574 (30.8132%)
_Train Local_ResNet_18, epoch  99, local model 17, internal_epoch   2, Avg loss: 0.0239, Accuracy: 820/1574 (52.0966%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0366, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 348/1446 (24.0664%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0326, Accuracy: 565/1446 (39.0733%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8908, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0891, Accuracy: 20/271 (7.3801%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0543, Accuracy: 129/271 (47.6015%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.4457, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0641, Accuracy: 293/715 (40.9790%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0353, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.3789, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3277, Accuracy: 96/10000 (0.9600%)
time spent on training: 293.63855266571045
[rfa agg] training data poison_ratio: 0.0  data num: [776, 2227, 1402, 1662, 1340, 1574, 1446, 271, 715, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 60, 66, 94, 77, 17, 26, 35, 23, 61], weight: tensor([0.0675, 0.1937, 0.1219, 0.1445, 0.1165, 0.1369, 0.1258, 0.0236, 0.0622,
        0.0074])
[rfa agg] iter:  0, prev_obj_val: 55.02901077270508, obj_val: 60.23769760131836, abs dis: 5.208686828613281
[rfa agg] iter: 0, weight: tensor([0.0220, 0.0362, 0.2642, 0.0748, 0.3401, 0.0883, 0.1514, 0.0039, 0.0180,
        0.0010])
[rfa agg] iter:  1, prev_obj_val: 60.23769760131836, obj_val: 60.2351188659668, abs dis: 0.0025787353515625
[rfa agg] iter: 1, weight: tensor([0.0345, 0.0464, 0.2086, 0.0858, 0.3468, 0.0974, 0.1454, 0.0057, 0.0278,
        0.0015])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3229, Accuracy: 115/10000 (1.1500%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.6954, Accuracy: 532/9950 (5.3467%)
saving model
Done in 463.8335223197937 sec.
Server Epoch:100 choose agents : [25, 52, 37, 70, 26, 86, 40, 66, 98, 83].
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   1, Avg loss: 0.0476, Accuracy: 367/690 (53.1884%)
_Train Local_ResNet_18, epoch 100, local model 25, internal_epoch   2, Avg loss: 0.0215, Accuracy: 477/690 (69.1304%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3404, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0531, Accuracy: 294/636 (46.2264%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0271, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5045, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0446, Accuracy: 583/1129 (51.6386%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0211, Accuracy: 778/1129 (68.9105%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.7356, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   1, Avg loss: 0.0536, Accuracy: 488/1418 (34.4147%)
_Train Local_ResNet_18, epoch 100, local model 70, internal_epoch   2, Avg loss: 0.0283, Accuracy: 708/1418 (49.9295%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2928, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   1, Avg loss: 0.0539, Accuracy: 348/1446 (24.0664%)
_Train Local_ResNet_18, epoch 100, local model 26, internal_epoch   2, Avg loss: 0.0319, Accuracy: 559/1446 (38.6584%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.6135, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0569, Accuracy: 367/1003 (36.5902%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0321, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1160, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 397/1573 (25.2384%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 595/1573 (37.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7564, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1, Avg loss: 0.0583, Accuracy: 277/1402 (19.7575%)
_Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2, Avg loss: 0.0360, Accuracy: 448/1402 (31.9544%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8999, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   1, Avg loss: 0.0772, Accuracy: 55/373 (14.7453%)
_Train Local_ResNet_18, epoch 100, local model 98, internal_epoch   2, Avg loss: 0.0446, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.9612, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 467/1953 (23.9119%)
_Train Local_ResNet_18, epoch 100, local model 83, internal_epoch   2, Avg loss: 0.0314, Accuracy: 860/1953 (44.0348%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9032, Accuracy: 134/10000 (1.3400%)
time spent on training: 349.6615662574768
[rfa agg] training data poison_ratio: 0.0  data num: [690, 636, 1129, 1418, 1446, 1003, 1573, 1402, 373, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 52, 37, 70, 26, 86, 40, 66, 98, 83], weight: tensor([0.0594, 0.0547, 0.0971, 0.1220, 0.1244, 0.0863, 0.1353, 0.1206, 0.0321,
        0.1680])
[rfa agg] iter:  0, prev_obj_val: 53.781402587890625, obj_val: 59.25843811035156, abs dis: 5.4770355224609375
[rfa agg] iter: 0, weight: tensor([0.0298, 0.0244, 0.2760, 0.1201, 0.1225, 0.1130, 0.0900, 0.1578, 0.0099,
        0.0563])
[rfa agg] iter:  1, prev_obj_val: 59.25843811035156, obj_val: 61.5349006652832, abs dis: 2.2764625549316406
[rfa agg] iter: 1, weight: tensor([0.0331, 0.0265, 0.3730, 0.0799, 0.0813, 0.1889, 0.0653, 0.0966, 0.0102,
        0.0453])
[rfa agg] iter:  2, prev_obj_val: 61.5349006652832, obj_val: 66.51020050048828, abs dis: 4.975299835205078
[rfa agg] iter: 2, weight: tensor([0.0375, 0.0296, 0.3017, 0.0767, 0.0779, 0.2653, 0.0639, 0.0908, 0.0111,
        0.0456])
[rfa agg] iter:  3, prev_obj_val: 66.51020050048828, obj_val: 69.32347106933594, abs dis: 2.8132705688476562
[rfa agg] iter: 3, weight: tensor([0.0413, 0.0318, 0.1582, 0.0607, 0.0618, 0.4734, 0.0524, 0.0700, 0.0112,
        0.0392])
[rfa agg] iter:  4, prev_obj_val: 69.32347106933594, obj_val: 69.3222885131836, abs dis: 0.00118255615234375
[rfa agg] iter: 4, weight: tensor([0.0484, 0.0366, 0.1337, 0.0598, 0.0610, 0.4871, 0.0525, 0.0683, 0.0125,
        0.0401])
[rfa agg] iter:  5, prev_obj_val: 69.3222885131836, obj_val: 72.39981079101562, abs dis: 3.0775222778320312
[rfa agg] iter: 5, weight: tensor([0.0479, 0.0362, 0.1318, 0.0592, 0.0604, 0.4926, 0.0520, 0.0677, 0.0124,
        0.0397])
[rfa agg] iter:  6, prev_obj_val: 72.39981079101562, obj_val: 61.55167007446289, abs dis: 10.848140716552734
[rfa agg] iter: 6, weight: tensor([0.0693, 0.0512, 0.1448, 0.0716, 0.0731, 0.3789, 0.0637, 0.0810, 0.0168,
        0.0496])
[rfa agg] iter:  7, prev_obj_val: 61.55167007446289, obj_val: 63.906959533691406, abs dis: 2.3552894592285156
[rfa agg] iter: 7, weight: tensor([0.0378, 0.0299, 0.2649, 0.0771, 0.0787, 0.2984, 0.0645, 0.0917, 0.0112,
        0.0459])
[rfa agg] iter:  8, prev_obj_val: 63.906959533691406, obj_val: 66.44074249267578, abs dis: 2.533782958984375
[rfa agg] iter: 8, weight: tensor([0.0388, 0.0303, 0.2043, 0.0674, 0.0686, 0.4015, 0.0573, 0.0788, 0.0111,
        0.0419])
[rfa agg] iter:  9, prev_obj_val: 66.44074249267578, obj_val: 69.3233413696289, abs dis: 2.882598876953125
[rfa agg] iter: 9, weight: tensor([0.0365, 0.0281, 0.1363, 0.0535, 0.0546, 0.5384, 0.0463, 0.0618, 0.0099,
        0.0346])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3226, Accuracy: 110/10000 (1.1000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 4.7373, Accuracy: 367/9950 (3.6884%)
saving model
Done in 520.5994815826416 sec.
Saving all the graphs.
This run has a label: Jun.27_22.30.43. Visdom environment: tiny
