current path: saved_models/model_tiny_Jun.27_22.34.36
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 396/1129 (35.0753%)
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 714/1129 (63.2418%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0101, Accuracy: 91/10000 (0.9100%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 385/1750 (22.0000%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0359, Accuracy: 634/1750 (36.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6621, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0559, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 575/1662 (34.5969%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8238, Accuracy: 113/10000 (1.1300%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 523/1552 (33.6985%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 751/1552 (48.3892%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.2237, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 55/500 (11.0000%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.6287, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 397/1953 (20.3277%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 747/1953 (38.2488%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7688, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0629, Accuracy: 318/719 (44.2281%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 437/719 (60.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1735, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 703/1475 (47.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8148, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 332/1446 (22.9599%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 522/1446 (36.0996%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2907, Accuracy: 62/10000 (0.6200%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 169/312 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3883, Accuracy: 50/10000 (0.5000%)
time spent on training: 165.8836269378662
[rfa agg] training data poison_ratio: 0.49751960313650184  data num: [1129, 1750, 1662, 1552, 500, 1953, 719, 1475, 1446, 312]
[rfa agg] considering poison per batch poison_fraction: 0.31094975196031366
[rfa agg] init. name: [37, 44, 94, 74, 82, 83, 41, 65, 26, 24], weight: tensor([0.0903, 0.1400, 0.1330, 0.1242, 0.0400, 0.1563, 0.0575, 0.1180, 0.1157,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 54.701045989990234, obj_val: 54.663814544677734, abs dis: 0.0372314453125
[rfa agg] iter: 0, weight: tensor([0.1293, 0.0899, 0.1187, 0.1366, 0.0139, 0.0705, 0.0288, 0.1661, 0.2390,
        0.0070])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3002, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3361, Accuracy: 0/9950 (0.0000%)
saving model
Done in 597.3301296234131 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 565/1662 (33.9952%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7404, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 378/818 (46.2103%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3073, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 246/1402 (17.5464%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 380/1402 (27.1041%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9173, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3764, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0625, Accuracy: 242/1131 (21.3970%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0315, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5130, Accuracy: 72/10000 (0.7200%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 312/1190 (26.2185%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9917, Accuracy: 57/10000 (0.5700%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 347/1372 (25.2915%)
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 540/1372 (39.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9614, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 356/946 (37.6321%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9885, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0578, Accuracy: 349/712 (49.0169%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4900, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0305, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1133, Accuracy: 50/10000 (0.5000%)
time spent on training: 165.47731375694275
[rfa agg] training data poison_ratio: 0.3128773631594576  data num: [1662, 818, 1402, 271, 1131, 1190, 1372, 946, 712, 599]
[rfa agg] considering poison per batch poison_fraction: 0.19554835197466097
[rfa agg] init. name: [94, 71, 66, 35, 38, 84, 42, 43, 11, 95], weight: tensor([0.1645, 0.0810, 0.1388, 0.0268, 0.1119, 0.1178, 0.1358, 0.0936, 0.0705,
        0.0593])
[rfa agg] iter:  0, prev_obj_val: 45.522335052490234, obj_val: 50.34085464477539, abs dis: 4.818519592285156
[rfa agg] iter: 0, weight: tensor([0.0618, 0.0811, 0.0891, 0.0083, 0.2317, 0.1566, 0.0876, 0.1958, 0.0556,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 50.34085464477539, obj_val: 54.628963470458984, abs dis: 4.288108825683594
[rfa agg] iter: 1, weight: tensor([0.0469, 0.1183, 0.0618, 0.0083, 0.1142, 0.0902, 0.0607, 0.3903, 0.0722,
        0.0369])
[rfa agg] iter:  2, prev_obj_val: 54.628963470458984, obj_val: 59.573829650878906, abs dis: 4.944866180419922
[rfa agg] iter: 2, weight: tensor([0.0464, 0.2156, 0.0584, 0.0100, 0.0929, 0.0783, 0.0573, 0.2783, 0.1133,
        0.0495])
[rfa agg] iter:  3, prev_obj_val: 59.573829650878906, obj_val: 56.97767639160156, abs dis: 2.5961532592773438
[rfa agg] iter: 3, weight: tensor([0.0383, 0.3590, 0.0466, 0.0100, 0.0671, 0.0588, 0.0457, 0.1354, 0.1808,
        0.0584])
[rfa agg] iter:  4, prev_obj_val: 56.97767639160156, obj_val: 56.97450637817383, abs dis: 0.003170013427734375
[rfa agg] iter: 4, weight: tensor([0.0412, 0.3432, 0.0509, 0.0097, 0.0767, 0.0660, 0.0499, 0.1734, 0.1369,
        0.0522])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.2999, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3040, Accuracy: 0/9950 (0.0000%)
saving model
Done in 579.876157283783 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 394/1154 (34.1421%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 138/603 (22.8856%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.9218, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 598/1645 (36.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0159, Accuracy: 109/10000 (1.0900%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 369/1372 (26.8950%)
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 482/1372 (35.1312%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6818, Accuracy: 74/10000 (0.7400%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 251/1241 (20.2256%)
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 446/1241 (35.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0822, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 533/1470 (36.2585%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 843/1470 (57.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3599, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 370/1956 (18.9162%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 652/1956 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2174, Accuracy: 103/10000 (1.0300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 549/1657 (33.1322%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5216, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0590, Accuracy: 277/590 (46.9492%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 375/1574 (23.8247%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 659/1574 (41.8679%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3666, Accuracy: 98/10000 (0.9800%)
time spent on training: 196.01495265960693
[rfa agg] training data poison_ratio: 0.4534760971195898  data num: [1154, 603, 1645, 1372, 1241, 1470, 1956, 1657, 590, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.28342256069974364
[rfa agg] init. name: [15, 88, 13, 42, 72, 22, 6, 0, 69, 17], weight: tensor([0.0870, 0.0455, 0.1240, 0.1035, 0.0936, 0.1108, 0.1475, 0.1249, 0.0445,
        0.1187])
[rfa agg] iter:  0, prev_obj_val: 46.24440002441406, obj_val: 54.076416015625, abs dis: 7.8320159912109375
[rfa agg] iter: 0, weight: tensor([0.1517, 0.0131, 0.0672, 0.1813, 0.2613, 0.1246, 0.0423, 0.0677, 0.0128,
        0.0781])
[rfa agg] iter:  1, prev_obj_val: 54.076416015625, obj_val: 57.30167770385742, abs dis: 3.225261688232422
[rfa agg] iter: 1, weight: tensor([0.3335, 0.0159, 0.0554, 0.1050, 0.2333, 0.0850, 0.0387, 0.0558, 0.0156,
        0.0617])
[rfa agg] iter:  2, prev_obj_val: 57.30167770385742, obj_val: 57.297645568847656, abs dis: 0.004032135009765625
[rfa agg] iter: 2, weight: tensor([0.3709, 0.0185, 0.0570, 0.0995, 0.1912, 0.0836, 0.0409, 0.0574, 0.0181,
        0.0628])
[rfa agg] iter:  3, prev_obj_val: 57.297645568847656, obj_val: 57.29747772216797, abs dis: 0.0001678466796875
[rfa agg] iter: 3, weight: tensor([0.3812, 0.0183, 0.0563, 0.0983, 0.1863, 0.0825, 0.0404, 0.0567, 0.0179,
        0.0620])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3016, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3162, Accuracy: 0/9950 (0.0000%)
saving model
Done in 618.9900593757629 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 59/460 (12.8261%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8961, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 346/1662 (20.8183%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2159, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1251, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1112, Accuracy: 12/134 (8.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3217, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0549, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 393/1154 (34.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8988, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7188, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 43/271 (15.8672%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0569, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3981, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 134/568 (23.5915%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0416, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.9108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 329/1340 (24.5522%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6510, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 403/1949 (20.6773%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 627/1949 (32.1703%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2503, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0566, Accuracy: 395/1742 (22.6751%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 677/1742 (38.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8468, Accuracy: 88/10000 (0.8800%)
time spent on training: 146.6460428237915
[rfa agg] training data poison_ratio: 0.11549239391513211  data num: [460, 1662, 134, 1154, 712, 271, 568, 1340, 1949, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.07218274619695757
[rfa agg] init. name: [31, 94, 47, 15, 11, 35, 62, 77, 21, 93], weight: tensor([0.0460, 0.1663, 0.0134, 0.1155, 0.0713, 0.0271, 0.0568, 0.1341, 0.1951,
        0.1743])
[rfa agg] iter:  0, prev_obj_val: 65.2788314819336, obj_val: 66.69529724121094, abs dis: 1.4164657592773438
[rfa agg] iter: 0, weight: tensor([0.0141, 0.1008, 0.0029, 0.3138, 0.0326, 0.0066, 0.0190, 0.3659, 0.0649,
        0.0795])
[rfa agg] iter:  1, prev_obj_val: 66.69529724121094, obj_val: 70.60963439941406, abs dis: 3.914337158203125
[rfa agg] iter: 1, weight: tensor([0.0136, 0.0863, 0.0027, 0.4368, 0.0322, 0.0063, 0.0184, 0.2769, 0.0575,
        0.0693])
[rfa agg] iter:  2, prev_obj_val: 70.60963439941406, obj_val: 70.58523559570312, abs dis: 0.0243988037109375
[rfa agg] iter: 2, weight: tensor([0.0157, 0.0792, 0.0031, 0.5289, 0.0392, 0.0072, 0.0215, 0.1837, 0.0559,
        0.0656])
[rfa agg] iter:  3, prev_obj_val: 70.58523559570312, obj_val: 70.58358001708984, abs dis: 0.00165557861328125
[rfa agg] iter: 3, weight: tensor([0.0148, 0.0746, 0.0029, 0.5585, 0.0369, 0.0068, 0.0202, 0.1707, 0.0527,
        0.0618])
[rfa agg] iter:  4, prev_obj_val: 70.58358001708984, obj_val: 70.58345031738281, abs dis: 0.00012969970703125
[rfa agg] iter: 4, weight: tensor([0.0146, 0.0733, 0.0029, 0.5665, 0.0363, 0.0067, 0.0199, 0.1672, 0.0518,
        0.0608])
[rfa agg] iter:  5, prev_obj_val: 70.58345031738281, obj_val: 73.0118179321289, abs dis: 2.4283676147460938
[rfa agg] iter: 5, weight: tensor([0.0145, 0.0730, 0.0028, 0.5687, 0.0361, 0.0066, 0.0198, 0.1663, 0.0516,
        0.0605])
[rfa agg] iter:  6, prev_obj_val: 73.0118179321289, obj_val: 70.5941162109375, abs dis: 2.4177017211914062
[rfa agg] iter: 6, weight: tensor([0.0203, 0.0911, 0.0039, 0.4653, 0.0519, 0.0092, 0.0278, 0.1881, 0.0660,
        0.0765])
[rfa agg] iter:  7, prev_obj_val: 70.5941162109375, obj_val: 70.5842056274414, abs dis: 0.00991058349609375
[rfa agg] iter: 7, weight: tensor([0.0153, 0.0772, 0.0030, 0.5429, 0.0382, 0.0070, 0.0209, 0.1771, 0.0545,
        0.0639])
[rfa agg] iter:  8, prev_obj_val: 70.5842056274414, obj_val: 70.58350372314453, abs dis: 0.000701904296875
[rfa agg] iter: 8, weight: tensor([0.0147, 0.0740, 0.0029, 0.5623, 0.0366, 0.0067, 0.0201, 0.1690, 0.0523,
        0.0613])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3036, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3227, Accuracy: 0/9950 (0.0000%)
saving model
Done in 577.9991564750671 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 340/1030 (33.0097%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0262, Accuracy: 651/1030 (63.2039%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5891, Accuracy: 80/10000 (0.8000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0849, Accuracy: 31/416 (7.4519%)
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7415, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8325, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.0626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0528, Accuracy: 329/1340 (24.5522%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 536/1340 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0157, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 58/460 (12.6087%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0386, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 335/1418 (23.6248%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 660/1418 (46.5444%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9469, Accuracy: 86/10000 (0.8600%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0544, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 716/1475 (48.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0932, Accuracy: 98/10000 (0.9800%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 582/2227 (26.1338%)
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1021/2227 (45.8464%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2404, Accuracy: 117/10000 (1.1700%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0882, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5805, Accuracy: 50/10000 (0.5000%)
time spent on training: 183.57331228256226
[rfa agg] training data poison_ratio: 0.4581435367952222  data num: [1030, 416, 500, 605, 1340, 460, 1418, 1475, 2227, 408]
[rfa agg] considering poison per batch poison_fraction: 0.28633971049701384
[rfa agg] init. name: [91, 78, 82, 2, 77, 31, 70, 65, 60, 36], weight: tensor([0.1043, 0.0421, 0.0506, 0.0612, 0.1356, 0.0466, 0.1435, 0.1493, 0.2254,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 74.1406478881836, obj_val: 75.50071716308594, abs dis: 1.3600692749023438
[rfa agg] iter: 0, weight: tensor([0.2697, 0.0182, 0.0240, 0.0358, 0.2559, 0.0220, 0.1559, 0.1328, 0.0680,
        0.0178])
[rfa agg] iter:  1, prev_obj_val: 75.50071716308594, obj_val: 78.68331146240234, abs dis: 3.1825942993164062
[rfa agg] iter: 1, weight: tensor([0.3521, 0.0184, 0.0243, 0.0367, 0.2104, 0.0223, 0.1361, 0.1179, 0.0638,
        0.0180])
[rfa agg] iter:  2, prev_obj_val: 78.68331146240234, obj_val: 82.73443603515625, abs dis: 4.051124572753906
[rfa agg] iter: 2, weight: tensor([0.4958, 0.0179, 0.0239, 0.0371, 0.1414, 0.0220, 0.1010, 0.0900, 0.0534,
        0.0176])
[rfa agg] iter:  3, prev_obj_val: 82.73443603515625, obj_val: 80.58687591552734, abs dis: 2.1475601196289062
[rfa agg] iter: 3, weight: tensor([0.4414, 0.0239, 0.0324, 0.0519, 0.1367, 0.0297, 0.1044, 0.0950, 0.0610,
        0.0235])
[rfa agg] iter:  4, prev_obj_val: 80.58687591552734, obj_val: 80.57716369628906, abs dis: 0.00971221923828125
[rfa agg] iter: 4, weight: tensor([0.5039, 0.0194, 0.0261, 0.0412, 0.1297, 0.0240, 0.0962, 0.0867, 0.0537,
        0.0191])
[rfa agg] iter:  5, prev_obj_val: 80.57716369628906, obj_val: 82.74014282226562, abs dis: 2.1629791259765625
[rfa agg] iter: 5, weight: tensor([0.5238, 0.0187, 0.0251, 0.0395, 0.1243, 0.0231, 0.0924, 0.0833, 0.0516,
        0.0183])
[rfa agg] iter:  6, prev_obj_val: 82.74014282226562, obj_val: 80.58578491210938, abs dis: 2.15435791015625
[rfa agg] iter: 6, weight: tensor([0.4462, 0.0237, 0.0321, 0.0515, 0.1354, 0.0295, 0.1035, 0.0942, 0.0605,
        0.0233])
[rfa agg] iter:  7, prev_obj_val: 80.58578491210938, obj_val: 80.57703399658203, abs dis: 0.00875091552734375
[rfa agg] iter: 7, weight: tensor([0.5054, 0.0194, 0.0260, 0.0410, 0.1293, 0.0239, 0.0959, 0.0864, 0.0535,
        0.0190])
[rfa agg] iter:  8, prev_obj_val: 80.57703399658203, obj_val: 82.74026489257812, abs dis: 2.1632308959960938
[rfa agg] iter: 8, weight: tensor([0.5243, 0.0187, 0.0251, 0.0395, 0.1242, 0.0230, 0.0923, 0.0832, 0.0515,
        0.0183])
[rfa agg] iter:  9, prev_obj_val: 82.74026489257812, obj_val: 80.58576202392578, abs dis: 2.1545028686523438
[rfa agg] iter: 9, weight: tensor([0.4463, 0.0237, 0.0321, 0.0515, 0.1354, 0.0295, 0.1035, 0.0942, 0.0605,
        0.0233])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3059, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.3161, Accuracy: 0/9950 (0.0000%)
saving model
Done in 633.8149480819702 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.7980, Accuracy: 57/10000 (0.5700%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 358/1372 (26.0933%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 525/1372 (38.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0604, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0564, Accuracy: 287/590 (48.6441%)
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4070, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0361, Accuracy: 421/1241 (33.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2642, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 430/1953 (22.0174%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 779/1953 (39.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8475, Accuracy: 92/10000 (0.9200%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 377/1750 (21.5429%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 629/1750 (35.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0808, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.1007, Accuracy: 4/197 (2.0305%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0792, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 147/809 (18.1706%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 340/809 (42.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6377, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 266/1402 (18.9729%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 379/1402 (27.0328%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4673, Accuracy: 75/10000 (0.7500%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0416, Accuracy: 498/1552 (32.0876%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 756/1552 (48.7113%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 11.2676, Accuracy: 85/10000 (0.8500%)
time spent on training: 202.71653032302856
[rfa agg] training data poison_ratio: 0.5534286200442402  data num: [888, 1372, 590, 1241, 1953, 1750, 197, 809, 1402, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.34589288752765013
[rfa agg] init. name: [63, 42, 69, 72, 83, 44, 79, 50, 66, 74], weight: tensor([0.0755, 0.1167, 0.0502, 0.1056, 0.1662, 0.1489, 0.0168, 0.0688, 0.1193,
        0.1320])
[rfa agg] iter:  0, prev_obj_val: 50.68315887451172, obj_val: 53.98194122314453, abs dis: 3.2987823486328125
[rfa agg] iter: 0, weight: tensor([0.0316, 0.2504, 0.0134, 0.2261, 0.0486, 0.0619, 0.0029, 0.0251, 0.2461,
        0.0940])
[rfa agg] iter:  1, prev_obj_val: 53.98194122314453, obj_val: 56.074283599853516, abs dis: 2.0923423767089844
[rfa agg] iter: 1, weight: tensor([0.0390, 0.1692, 0.0156, 0.3873, 0.0469, 0.0575, 0.0033, 0.0304, 0.1705,
        0.0804])
[rfa agg] iter:  2, prev_obj_val: 56.074283599853516, obj_val: 60.944183349609375, abs dis: 4.869899749755859
[rfa agg] iter: 2, weight: tensor([0.0452, 0.1458, 0.0175, 0.4228, 0.0477, 0.0576, 0.0036, 0.0348, 0.1473,
        0.0780])
[rfa agg] iter:  3, prev_obj_val: 60.944183349609375, obj_val: 58.46312713623047, abs dis: 2.4810562133789062
[rfa agg] iter: 3, weight: tensor([0.0771, 0.1501, 0.0274, 0.3031, 0.0616, 0.0725, 0.0054, 0.0574, 0.1523,
        0.0931])
[rfa agg] iter:  4, prev_obj_val: 58.46312713623047, obj_val: 60.93090057373047, abs dis: 2.4677734375
[rfa agg] iter: 4, weight: tensor([0.0611, 0.1523, 0.0227, 0.3471, 0.0563, 0.0671, 0.0045, 0.0463, 0.1543,
        0.0884])
[rfa agg] iter:  5, prev_obj_val: 60.93090057373047, obj_val: 60.92824172973633, abs dis: 0.002658843994140625
[rfa agg] iter: 5, weight: tensor([0.0776, 0.1511, 0.0275, 0.2989, 0.0619, 0.0728, 0.0054, 0.0577, 0.1534,
        0.0937])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3087, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3305, Accuracy: 0/9950 (0.0000%)
saving model
Done in 635.5354800224304 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.9452, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0584, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8774, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0620, Accuracy: 154/809 (19.0358%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0266, Accuracy: 383/809 (47.3424%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4430, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0863, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4664, Accuracy: 43/10000 (0.4300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 359/1657 (21.6657%)
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8486, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1006, Accuracy: 5/197 (2.5381%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3570, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.6651, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0509, Accuracy: 431/1129 (38.1754%)
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0236, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9714, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0616, Accuracy: 271/708 (38.2768%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.9420, Accuracy: 57/10000 (0.5700%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 594/2227 (26.6727%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 998/2227 (44.8137%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4126, Accuracy: 119/10000 (1.1900%)
time spent on training: 184.20599341392517
[rfa agg] training data poison_ratio: 0.6433164128595601  data num: [500, 677, 809, 271, 1657, 197, 690, 1129, 708, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.4020727580372251
[rfa agg] init. name: [82, 90, 50, 35, 0, 79, 25, 37, 16, 60], weight: tensor([0.0564, 0.0764, 0.0913, 0.0306, 0.1869, 0.0222, 0.0778, 0.1274, 0.0799,
        0.2512])
[rfa agg] iter:  0, prev_obj_val: 82.59657287597656, obj_val: 83.90744018554688, abs dis: 1.3108673095703125
[rfa agg] iter: 0, weight: tensor([0.0274, 0.0540, 0.0926, 0.0113, 0.1011, 0.0076, 0.0551, 0.5184, 0.0664,
        0.0663])
[rfa agg] iter:  1, prev_obj_val: 83.90744018554688, obj_val: 85.05036926269531, abs dis: 1.1429290771484375
[rfa agg] iter: 1, weight: tensor([0.0381, 0.0820, 0.1590, 0.0150, 0.1010, 0.0100, 0.0837, 0.3339, 0.1057,
        0.0717])
[rfa agg] iter:  2, prev_obj_val: 85.05036926269531, obj_val: 86.99952697753906, abs dis: 1.94915771484375
[rfa agg] iter: 2, weight: tensor([0.0421, 0.0988, 0.2257, 0.0160, 0.0888, 0.0105, 0.1010, 0.2163, 0.1350,
        0.0658])
[rfa agg] iter:  3, prev_obj_val: 86.99952697753906, obj_val: 90.77069854736328, abs dis: 3.7711715698242188
[rfa agg] iter: 3, weight: tensor([0.0348, 0.1011, 0.3909, 0.0122, 0.0509, 0.0079, 0.1037, 0.0949, 0.1635,
        0.0399])
[rfa agg] iter:  4, prev_obj_val: 90.77069854736328, obj_val: 101.47429656982422, abs dis: 10.703598022460938
[rfa agg] iter: 4, weight: tensor([0.0354, 0.1626, 0.2093, 0.0110, 0.0338, 0.0070, 0.1697, 0.0532, 0.2903,
        0.0277])
[rfa agg] iter:  5, prev_obj_val: 101.47429656982422, obj_val: 95.07196807861328, abs dis: 6.4023284912109375
[rfa agg] iter: 5, weight: tensor([0.0979, 0.2375, 0.1077, 0.0217, 0.0422, 0.0131, 0.2477, 0.0571, 0.1390,
        0.0363])
[rfa agg] iter:  6, prev_obj_val: 95.07196807861328, obj_val: 98.0994873046875, abs dis: 3.0275192260742188
[rfa agg] iter: 6, weight: tensor([0.0377, 0.2991, 0.0877, 0.0103, 0.0253, 0.0064, 0.3406, 0.0367, 0.1350,
        0.0213])
[rfa agg] iter:  7, prev_obj_val: 98.0994873046875, obj_val: 101.44721984863281, abs dis: 3.3477325439453125
[rfa agg] iter: 7, weight: tensor([0.0578, 0.2858, 0.0921, 0.0144, 0.0316, 0.0088, 0.3111, 0.0442, 0.1272,
        0.0269])
[rfa agg] iter:  8, prev_obj_val: 101.44721984863281, obj_val: 95.07032012939453, abs dis: 6.376899719238281
[rfa agg] iter: 8, weight: tensor([0.0964, 0.2433, 0.1052, 0.0214, 0.0414, 0.0129, 0.2534, 0.0561, 0.1342,
        0.0357])
[rfa agg] iter:  9, prev_obj_val: 95.07032012939453, obj_val: 98.09951782226562, abs dis: 3.0291976928710938
[rfa agg] iter: 9, weight: tensor([0.0375, 0.3000, 0.0873, 0.0102, 0.0252, 0.0064, 0.3414, 0.0365, 0.1342,
        0.0212])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3109, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.3335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 629.9624464511871 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 338/1662 (20.3369%)
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 636/1662 (38.2671%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9023, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0871, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0539, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4986, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 415/1949 (21.2930%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 600/1949 (30.7850%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2633, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0583, Accuracy: 281/928 (30.2802%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 578/928 (62.2845%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7293, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.1247, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.1865, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0362, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.2971, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 411/1587 (25.8979%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 625/1587 (39.3825%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.3153, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 390/1036 (37.6448%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 662/1036 (63.8996%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 10.2612, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 418/1715 (24.3732%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 703/1715 (40.9913%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5708, Accuracy: 92/10000 (0.9200%)
time spent on training: 148.7081582546234
[rfa agg] training data poison_ratio: 0.0  data num: [1662, 271, 1949, 928, 603, 946, 1163, 1587, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [94, 35, 21, 1, 88, 43, 68, 27, 19, 92], weight: tensor([0.1401, 0.0228, 0.1643, 0.0782, 0.0508, 0.0798, 0.0981, 0.1338, 0.0874,
        0.1446])
[rfa agg] iter:  0, prev_obj_val: 57.58283996582031, obj_val: 58.371803283691406, abs dis: 0.7889633178710938
[rfa agg] iter: 0, weight: tensor([0.1055, 0.0069, 0.0677, 0.0702, 0.0231, 0.0718, 0.3135, 0.1203, 0.1279,
        0.0931])
[rfa agg] iter:  1, prev_obj_val: 58.371803283691406, obj_val: 62.346405029296875, abs dis: 3.9746017456054688
[rfa agg] iter: 1, weight: tensor([0.0818, 0.0060, 0.0543, 0.0653, 0.0204, 0.0668, 0.4130, 0.0920, 0.1272,
        0.0730])
[rfa agg] iter:  2, prev_obj_val: 62.346405029296875, obj_val: 65.86225891113281, abs dis: 3.5158538818359375
[rfa agg] iter: 2, weight: tensor([0.0639, 0.0064, 0.0462, 0.0914, 0.0232, 0.0941, 0.3024, 0.0696, 0.2441,
        0.0586])
[rfa agg] iter:  3, prev_obj_val: 65.86225891113281, obj_val: 70.36138153076172, abs dis: 4.499122619628906
[rfa agg] iter: 3, weight: tensor([0.0501, 0.0061, 0.0378, 0.1159, 0.0234, 0.1202, 0.1480, 0.0538, 0.3982,
        0.0465])
[rfa agg] iter:  4, prev_obj_val: 70.36138153076172, obj_val: 70.32923126220703, abs dis: 0.0321502685546875
[rfa agg] iter: 4, weight: tensor([0.0473, 0.0070, 0.0370, 0.2028, 0.0285, 0.2156, 0.1056, 0.0502, 0.2616,
        0.0443])
[rfa agg] iter:  5, prev_obj_val: 70.32923126220703, obj_val: 72.8515625, abs dis: 2.5223312377929688
[rfa agg] iter: 5, weight: tensor([0.0470, 0.0070, 0.0368, 0.2111, 0.0284, 0.2233, 0.1047, 0.0499, 0.2478,
        0.0441])
[rfa agg] iter:  6, prev_obj_val: 72.8515625, obj_val: 70.34033966064453, abs dis: 2.5112228393554688
[rfa agg] iter: 6, weight: tensor([0.0409, 0.0067, 0.0324, 0.2687, 0.0281, 0.2947, 0.0829, 0.0431, 0.1641,
        0.0385])
[rfa agg] iter:  7, prev_obj_val: 70.34033966064453, obj_val: 72.84898376464844, abs dis: 2.5086441040039062
[rfa agg] iter: 7, weight: tensor([0.0470, 0.0070, 0.0367, 0.2165, 0.0283, 0.2289, 0.1043, 0.0498, 0.2374,
        0.0440])
[rfa agg] iter:  8, prev_obj_val: 72.84898376464844, obj_val: 70.34056854248047, abs dis: 2.5084152221679688
[rfa agg] iter: 8, weight: tensor([0.0408, 0.0066, 0.0324, 0.2694, 0.0281, 0.2953, 0.0827, 0.0430, 0.1633,
        0.0384])
[rfa agg] iter:  9, prev_obj_val: 70.34056854248047, obj_val: 72.84896087646484, abs dis: 2.508392333984375
[rfa agg] iter: 9, weight: tensor([0.0470, 0.0070, 0.0367, 0.2165, 0.0283, 0.2289, 0.1043, 0.0498, 0.2373,
        0.0440])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3130, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3357, Accuracy: 0/9950 (0.0000%)
saving model
Done in 583.6690125465393 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.1687, Accuracy: 63/10000 (0.6300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0516, Accuracy: 376/1372 (27.4052%)
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 521/1372 (37.9738%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3479, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0546, Accuracy: 335/677 (49.4830%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2673, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 388/1949 (19.9076%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 628/1949 (32.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2195, Accuracy: 90/10000 (0.9000%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 30/440 (6.8182%)
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.7329, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 426/1190 (35.7983%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5825, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0512, Accuracy: 345/1340 (25.7463%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 533/1340 (39.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9127, Accuracy: 88/10000 (0.8800%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6806, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3465, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 412/1475 (27.9322%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0301, Accuracy: 705/1475 (47.7966%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8542, Accuracy: 80/10000 (0.8000%)
time spent on training: 202.3096137046814
[rfa agg] training data poison_ratio: 0.48550373315233203  data num: [1154, 1372, 677, 1949, 440, 1190, 1340, 530, 186, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.3034398332202075
[rfa agg] init. name: [57, 42, 90, 21, 49, 84, 77, 18, 56, 65], weight: tensor([0.1119, 0.1330, 0.0656, 0.1890, 0.0427, 0.1154, 0.1299, 0.0514, 0.0180,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 56.09428405761719, obj_val: 58.64577865600586, abs dis: 2.551494598388672
[rfa agg] iter: 0, weight: tensor([0.2711, 0.1091, 0.0315, 0.0488, 0.0130, 0.2855, 0.1388, 0.0192, 0.0040,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 58.64577865600586, obj_val: 58.64501190185547, abs dis: 0.000766754150390625
[rfa agg] iter: 1, weight: tensor([0.2566, 0.1131, 0.0393, 0.0546, 0.0159, 0.2675, 0.1398, 0.0236, 0.0048,
        0.0847])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3157, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.3263, Accuracy: 0/9950 (0.0000%)
saving model
Done in 628.1980533599854 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0517, Accuracy: 387/1628 (23.7715%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 806/1628 (49.5086%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8455, Accuracy: 152/10000 (1.5200%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0594, Accuracy: 312/715 (43.6364%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0061, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 434/1953 (22.2222%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 771/1953 (39.4777%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2220, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0604, Accuracy: 268/1402 (19.1155%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 391/1402 (27.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6217, Accuracy: 70/10000 (0.7000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0564, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0571, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 432/1904 (22.6891%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0309, Accuracy: 727/1904 (38.1828%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9821, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0636, Accuracy: 345/1003 (34.3968%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0355, Accuracy: 348/1003 (34.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9273, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 42/416 (10.0962%)
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9589, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0603, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 465/1190 (39.0756%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4515, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0609, Accuracy: 243/1513 (16.0608%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 494/1513 (32.6504%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8132, Accuracy: 109/10000 (1.0900%)
time spent on training: 202.91403651237488
[rfa agg] training data poison_ratio: 0.3395052123852497  data num: [1628, 715, 1953, 1402, 1130, 1904, 1003, 416, 1190, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.21219075774078108
[rfa agg] init. name: [5, 23, 83, 66, 54, 46, 86, 78, 84, 8], weight: tensor([0.1267, 0.0556, 0.1519, 0.1091, 0.0879, 0.1481, 0.0780, 0.0324, 0.0926,
        0.1177])
[rfa agg] iter:  0, prev_obj_val: 53.87476348876953, obj_val: 56.71574020385742, abs dis: 2.8409767150878906
[rfa agg] iter: 0, weight: tensor([0.0887, 0.0255, 0.0564, 0.2359, 0.1291, 0.0607, 0.0665, 0.0094, 0.2010,
        0.1268])
[rfa agg] iter:  1, prev_obj_val: 56.71574020385742, obj_val: 60.387489318847656, abs dis: 3.6717491149902344
[rfa agg] iter: 1, weight: tensor([0.0671, 0.0257, 0.0460, 0.1441, 0.1773, 0.0490, 0.0754, 0.0090, 0.3172,
        0.0893])
[rfa agg] iter:  2, prev_obj_val: 60.387489318847656, obj_val: 62.70930099487305, abs dis: 2.3218116760253906
[rfa agg] iter: 2, weight: tensor([0.0512, 0.0260, 0.0372, 0.0921, 0.2750, 0.0393, 0.0901, 0.0086, 0.3159,
        0.0646])
[rfa agg] iter:  3, prev_obj_val: 62.70930099487305, obj_val: 68.23407745361328, abs dis: 5.524776458740234
[rfa agg] iter: 3, weight: tensor([0.0486, 0.0284, 0.0361, 0.0819, 0.3586, 0.0380, 0.1101, 0.0091, 0.2293,
        0.0599])
[rfa agg] iter:  4, prev_obj_val: 68.23407745361328, obj_val: 65.35348510742188, abs dis: 2.8805923461914062
[rfa agg] iter: 4, weight: tensor([0.0533, 0.0417, 0.0413, 0.0816, 0.2800, 0.0433, 0.2205, 0.0123, 0.1625,
        0.0635])
[rfa agg] iter:  5, prev_obj_val: 65.35348510742188, obj_val: 68.21894836425781, abs dis: 2.8654632568359375
[rfa agg] iter: 5, weight: tensor([0.0510, 0.0344, 0.0387, 0.0817, 0.3391, 0.0407, 0.1592, 0.0106, 0.1830,
        0.0617])
[rfa agg] iter:  6, prev_obj_val: 68.21894836425781, obj_val: 68.20873260498047, abs dis: 0.01021575927734375
[rfa agg] iter: 6, weight: tensor([0.0532, 0.0416, 0.0412, 0.0814, 0.2772, 0.0432, 0.2256, 0.0123, 0.1610,
        0.0633])
[rfa agg] iter:  7, prev_obj_val: 68.20873260498047, obj_val: 68.20855712890625, abs dis: 0.00017547607421875
[rfa agg] iter: 7, weight: tensor([0.0532, 0.0416, 0.0412, 0.0814, 0.2684, 0.0432, 0.2345, 0.0123, 0.1609,
        0.0633])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3180, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.3385, Accuracy: 0/9950 (0.0000%)
saving model
Done in 646.2524313926697 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 263/1131 (23.2538%)
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7837, Accuracy: 92/10000 (0.9200%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.6793, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0689, Accuracy: 198/669 (29.5964%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.0082, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 480/1513 (31.7250%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.5911, Accuracy: 102/10000 (1.0200%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 415/1475 (28.1356%)
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0297, Accuracy: 708/1475 (48.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2044, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0454, Accuracy: 422/1036 (40.7336%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 682/1036 (65.8301%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 10.0651, Accuracy: 71/10000 (0.7100%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.8793, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 405/1574 (25.7306%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 715/1574 (45.4257%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.5011, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 385/1573 (24.4755%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 552/1573 (35.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7014, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 474/1470 (32.2449%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 888/1470 (60.4082%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4003, Accuracy: 84/10000 (0.8400%)
time spent on training: 180.53620386123657
[rfa agg] training data poison_ratio: 0.19896363798802824  data num: [1131, 312, 669, 1513, 1475, 1036, 440, 1574, 1573, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.12435227374251764
[rfa agg] init. name: [38, 24, 45, 8, 65, 19, 49, 17, 40, 22], weight: tensor([0.1010, 0.0279, 0.0598, 0.1352, 0.1318, 0.0926, 0.0393, 0.1406, 0.1405,
        0.1313])
[rfa agg] iter:  0, prev_obj_val: 45.62541580200195, obj_val: 47.23902893066406, abs dis: 1.6136131286621094
[rfa agg] iter: 0, weight: tensor([0.2347, 0.0077, 0.0280, 0.1176, 0.1135, 0.1392, 0.0126, 0.1011, 0.1006,
        0.1451])
[rfa agg] iter:  1, prev_obj_val: 47.23902893066406, obj_val: 50.8871955871582, abs dis: 3.6481666564941406
[rfa agg] iter: 1, weight: tensor([0.3053, 0.0074, 0.0278, 0.0994, 0.0960, 0.1587, 0.0122, 0.0868, 0.0864,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 50.8871955871582, obj_val: 58.83792495727539, abs dis: 7.9507293701171875
[rfa agg] iter: 2, weight: tensor([0.4397, 0.0062, 0.0246, 0.0644, 0.0624, 0.2024, 0.0103, 0.0577, 0.0575,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 58.83792495727539, obj_val: 53.18658447265625, abs dis: 5.651340484619141
[rfa agg] iter: 3, weight: tensor([0.2424, 0.0093, 0.0412, 0.0684, 0.0664, 0.3539, 0.0158, 0.0630, 0.0629,
        0.0766])
[rfa agg] iter:  4, prev_obj_val: 53.18658447265625, obj_val: 58.77629089355469, abs dis: 5.5897064208984375
[rfa agg] iter: 4, weight: tensor([0.3264, 0.0066, 0.0271, 0.0609, 0.0590, 0.3291, 0.0111, 0.0552, 0.0550,
        0.0697])
[rfa agg] iter:  5, prev_obj_val: 58.77629089355469, obj_val: 50.94508743286133, abs dis: 7.831203460693359
[rfa agg] iter: 5, weight: tensor([0.2245, 0.0089, 0.0395, 0.0655, 0.0636, 0.3891, 0.0151, 0.0604, 0.0602,
        0.0733])
[rfa agg] iter:  6, prev_obj_val: 50.94508743286133, obj_val: 50.859375, abs dis: 0.08571243286132812
[rfa agg] iter: 6, weight: tensor([0.3854, 0.0065, 0.0258, 0.0676, 0.0655, 0.2386, 0.0109, 0.0607, 0.0604,
        0.0786])
[rfa agg] iter:  7, prev_obj_val: 50.859375, obj_val: 58.846858978271484, abs dis: 7.987483978271484
[rfa agg] iter: 7, weight: tensor([0.4593, 0.0059, 0.0235, 0.0615, 0.0596, 0.1986, 0.0099, 0.0552, 0.0550,
        0.0714])
[rfa agg] iter:  8, prev_obj_val: 58.846858978271484, obj_val: 55.79859161376953, abs dis: 3.048267364501953
[rfa agg] iter: 8, weight: tensor([0.2439, 0.0093, 0.0413, 0.0686, 0.0666, 0.3515, 0.0158, 0.0632, 0.0630,
        0.0767])
[rfa agg] iter:  9, prev_obj_val: 55.79859161376953, obj_val: 58.75945281982422, abs dis: 2.9608612060546875
[rfa agg] iter: 9, weight: tensor([0.2440, 0.0071, 0.0301, 0.0581, 0.0564, 0.4205, 0.0119, 0.0532, 0.0530,
        0.0658])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3207, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.3390, Accuracy: 0/9950 (0.0000%)
saving model
Done in 618.968478679657 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3600, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0826, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.3008, Accuracy: 47/10000 (0.4700%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 294/590 (49.8305%)
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0641, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1082, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3499, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 231/1049 (22.0210%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 557/1049 (53.0982%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7825, Accuracy: 89/10000 (0.8900%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 114/631 (18.0666%)
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.2506, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 426/1715 (24.8397%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 678/1715 (39.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1236, Accuracy: 84/10000 (0.8400%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0587, Accuracy: 343/1190 (28.8235%)
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6906, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 193/735 (26.2585%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 355/735 (48.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6337, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 557/1470 (37.8912%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 873/1470 (59.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.9137, Accuracy: 110/10000 (1.1000%)
time spent on training: 190.22466850280762
[rfa agg] training data poison_ratio: 0.35389689714146105  data num: [186, 486, 590, 134, 1049, 631, 1715, 1190, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.22118556071341317
[rfa agg] init. name: [56, 30, 69, 47, 51, 48, 92, 84, 32, 22], weight: tensor([0.0227, 0.0594, 0.0721, 0.0164, 0.1281, 0.0771, 0.2095, 0.1454, 0.0898,
        0.1796])
[rfa agg] iter:  0, prev_obj_val: 58.008609771728516, obj_val: 59.20263671875, abs dis: 1.1940269470214844
[rfa agg] iter: 0, weight: tensor([0.0074, 0.0315, 0.0508, 0.0053, 0.3734, 0.0544, 0.0807, 0.1946, 0.0938,
        0.1081])
[rfa agg] iter:  1, prev_obj_val: 59.20263671875, obj_val: 62.001495361328125, abs dis: 2.798858642578125
[rfa agg] iter: 1, weight: tensor([0.0082, 0.0357, 0.0588, 0.0059, 0.3452, 0.0630, 0.0820, 0.1806, 0.1133,
        0.1072])
[rfa agg] iter:  2, prev_obj_val: 62.001495361328125, obj_val: 63.41705322265625, abs dis: 1.415557861328125
[rfa agg] iter: 2, weight: tensor([0.0100, 0.0460, 0.0800, 0.0072, 0.2475, 0.0858, 0.0844, 0.1595, 0.1737,
        0.1060])
[rfa agg] iter:  3, prev_obj_val: 63.41705322265625, obj_val: 64.86054992675781, abs dis: 1.4434967041015625
[rfa agg] iter: 3, weight: tensor([0.0104, 0.0498, 0.0898, 0.0075, 0.2069, 0.0962, 0.0810, 0.1439, 0.2144,
        0.1001])
[rfa agg] iter:  4, prev_obj_val: 64.86054992675781, obj_val: 66.3272705078125, abs dis: 1.4667205810546875
[rfa agg] iter: 4, weight: tensor([0.0104, 0.0519, 0.0978, 0.0075, 0.1709, 0.1049, 0.0746, 0.1255, 0.2657,
        0.0907])
[rfa agg] iter:  5, prev_obj_val: 66.3272705078125, obj_val: 67.83834838867188, abs dis: 1.511077880859375
[rfa agg] iter: 5, weight: tensor([0.0099, 0.0515, 0.1024, 0.0071, 0.1357, 0.1100, 0.0650, 0.1041, 0.3366,
        0.0778])
[rfa agg] iter:  6, prev_obj_val: 67.83834838867188, obj_val: 73.80152893066406, abs dis: 5.9631805419921875
[rfa agg] iter: 6, weight: tensor([0.0085, 0.0468, 0.0997, 0.0061, 0.0993, 0.1075, 0.0514, 0.0789, 0.4411,
        0.0607])
[rfa agg] iter:  7, prev_obj_val: 73.80152893066406, obj_val: 73.7669677734375, abs dis: 0.0345611572265625
[rfa agg] iter: 7, weight: tensor([0.0094, 0.0648, 0.1997, 0.0068, 0.0700, 0.2228, 0.0434, 0.0599, 0.2736,
        0.0496])
[rfa agg] iter:  8, prev_obj_val: 73.7669677734375, obj_val: 71.56495666503906, abs dis: 2.2020111083984375
[rfa agg] iter: 8, weight: tensor([0.0093, 0.0646, 0.2084, 0.0067, 0.0695, 0.2307, 0.0431, 0.0595, 0.2589,
        0.0492])
[rfa agg] iter:  9, prev_obj_val: 71.56495666503906, obj_val: 73.78099060058594, abs dis: 2.216033935546875
[rfa agg] iter: 9, weight: tensor([0.0087, 0.0551, 0.1481, 0.0063, 0.0750, 0.1610, 0.0442, 0.0629, 0.3879,
        0.0509])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3228, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.1862, Accuracy: 0/9950 (0.0000%)
saving model
Done in 620.6293096542358 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0508, Accuracy: 276/813 (33.9483%)
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 450/813 (55.3506%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 10.4437, Accuracy: 53/10000 (0.5300%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0520, Accuracy: 376/1154 (32.5823%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 462/1154 (40.0347%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2321, Accuracy: 66/10000 (0.6600%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 248/781 (31.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4682, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 312/715 (43.6364%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9857, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 733/1953 (37.5320%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4082, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0551, Accuracy: 342/712 (48.0337%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0657, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0545, Accuracy: 429/1587 (27.0321%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 608/1587 (38.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1768, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2986, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 379/1418 (26.7278%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 629/1418 (44.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0535, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 50/271 (18.4502%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0571, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6337, Accuracy: 45/10000 (0.4500%)
time spent on training: 171.8378689289093
[rfa agg] training data poison_ratio: 0.196048632218845  data num: [813, 1154, 781, 715, 1953, 712, 1587, 466, 1418, 271]
[rfa agg] considering poison per batch poison_fraction: 0.12253039513677813
[rfa agg] init. name: [53, 15, 3, 23, 83, 11, 27, 76, 70, 35], weight: tensor([0.0824, 0.1169, 0.0791, 0.0724, 0.1979, 0.0721, 0.1608, 0.0472, 0.1437,
        0.0275])
[rfa agg] iter:  0, prev_obj_val: 63.706302642822266, obj_val: 65.64950561523438, abs dis: 1.9432029724121094
[rfa agg] iter: 0, weight: tensor([0.0758, 0.3989, 0.0730, 0.0558, 0.0708, 0.0557, 0.1064, 0.0220, 0.1318,
        0.0098])
[rfa agg] iter:  1, prev_obj_val: 65.64950561523438, obj_val: 68.84163665771484, abs dis: 3.1921310424804688
[rfa agg] iter: 1, weight: tensor([0.1065, 0.2948, 0.1026, 0.0756, 0.0746, 0.0754, 0.1057, 0.0277, 0.1251,
        0.0121])
[rfa agg] iter:  2, prev_obj_val: 68.84163665771484, obj_val: 69.91441345214844, abs dis: 1.0727767944335938
[rfa agg] iter: 2, weight: tensor([0.1631, 0.1700, 0.1578, 0.1049, 0.0663, 0.1051, 0.0877, 0.0326, 0.0989,
        0.0136])
[rfa agg] iter:  3, prev_obj_val: 69.91441345214844, obj_val: 75.1128158569336, abs dis: 5.198402404785156
[rfa agg] iter: 3, weight: tensor([0.1867, 0.1377, 0.1810, 0.1130, 0.0595, 0.1133, 0.0773, 0.0324, 0.0860,
        0.0132])
[rfa agg] iter:  4, prev_obj_val: 75.1128158569336, obj_val: 80.0460205078125, abs dis: 4.933204650878906
[rfa agg] iter: 4, weight: tensor([0.2737, 0.0449, 0.2854, 0.1354, 0.0256, 0.1407, 0.0311, 0.0219, 0.0333,
        0.0080])
[rfa agg] iter:  5, prev_obj_val: 80.0460205078125, obj_val: 83.28121185302734, abs dis: 3.2351913452148438
[rfa agg] iter: 5, weight: tensor([0.1688, 0.0400, 0.1657, 0.2359, 0.0252, 0.2654, 0.0299, 0.0283, 0.0315,
        0.0095])
[rfa agg] iter:  6, prev_obj_val: 83.28121185302734, obj_val: 86.87462615966797, abs dis: 3.593414306640625
[rfa agg] iter: 6, weight: tensor([0.1427, 0.0444, 0.1386, 0.2515, 0.0291, 0.2735, 0.0341, 0.0383, 0.0358,
        0.0121])
[rfa agg] iter:  7, prev_obj_val: 86.87462615966797, obj_val: 79.99603271484375, abs dis: 6.878593444824219
[rfa agg] iter: 7, weight: tensor([0.1446, 0.0542, 0.1399, 0.2275, 0.0369, 0.2348, 0.0428, 0.0579, 0.0446,
        0.0170])
[rfa agg] iter:  8, prev_obj_val: 79.99603271484375, obj_val: 86.87598419189453, abs dis: 6.879951477050781
[rfa agg] iter: 8, weight: tensor([0.1535, 0.0380, 0.1506, 0.2551, 0.0239, 0.2849, 0.0283, 0.0269, 0.0299,
        0.0090])
[rfa agg] iter:  9, prev_obj_val: 86.87598419189453, obj_val: 79.99600982666016, abs dis: 6.879974365234375
[rfa agg] iter: 9, weight: tensor([0.1447, 0.0541, 0.1399, 0.2271, 0.0369, 0.2351, 0.0428, 0.0578, 0.0445,
        0.0170])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3248, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.1852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 613.9569227695465 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 352/1657 (21.2432%)
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 502/1657 (30.2957%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8456, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 387/1662 (23.2852%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0090, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0803, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.5328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0489, Accuracy: 388/1030 (37.6699%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0243, Accuracy: 662/1030 (64.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4205, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 552/1049 (52.6215%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8709, Accuracy: 88/10000 (0.8800%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0717, Accuracy: 128/781 (16.3892%)
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0876, Accuracy: 76/10000 (0.7600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 72/408 (17.6471%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.9532, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0548, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2224, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0504, Accuracy: 436/1129 (38.6182%)
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 743/1129 (65.8105%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4980, Accuracy: 116/10000 (1.1600%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0591, Accuracy: 335/1190 (28.1513%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0309, Accuracy: 487/1190 (40.9244%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7804, Accuracy: 64/10000 (0.6400%)
time spent on training: 202.99506735801697
[rfa agg] training data poison_ratio: 0.5220335556903174  data num: [1657, 1662, 311, 1030, 1049, 781, 408, 677, 1129, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.32627097230644836
[rfa agg] init. name: [0, 94, 96, 91, 51, 3, 36, 90, 37, 84], weight: tensor([0.1675, 0.1680, 0.0314, 0.1041, 0.1060, 0.0789, 0.0412, 0.0684, 0.1141,
        0.1203])
[rfa agg] iter:  0, prev_obj_val: 48.076942443847656, obj_val: 54.684593200683594, abs dis: 6.6076507568359375
[rfa agg] iter: 0, weight: tensor([0.0463, 0.0465, 0.0072, 0.2276, 0.2858, 0.0583, 0.0114, 0.0326, 0.1647,
        0.1197])
[rfa agg] iter:  1, prev_obj_val: 54.684593200683594, obj_val: 52.295284271240234, abs dis: 2.3893089294433594
[rfa agg] iter: 1, weight: tensor([0.0595, 0.0597, 0.0123, 0.1854, 0.1967, 0.1436, 0.0202, 0.0661, 0.1412,
        0.1152])
[rfa agg] iter:  2, prev_obj_val: 52.295284271240234, obj_val: 54.669219970703125, abs dis: 2.3739356994628906
[rfa agg] iter: 2, weight: tensor([0.0563, 0.0565, 0.0106, 0.2063, 0.2239, 0.1078, 0.0172, 0.0534, 0.1496,
        0.1183])
[rfa agg] iter:  3, prev_obj_val: 54.669219970703125, obj_val: 52.29551696777344, abs dis: 2.3737030029296875
[rfa agg] iter: 3, weight: tensor([0.0596, 0.0598, 0.0123, 0.1847, 0.1954, 0.1452, 0.0202, 0.0662, 0.1413,
        0.1154])
[rfa agg] iter:  4, prev_obj_val: 52.29551696777344, obj_val: 54.669212341308594, abs dis: 2.3736953735351562
[rfa agg] iter: 4, weight: tensor([0.0564, 0.0565, 0.0106, 0.2062, 0.2239, 0.1079, 0.0172, 0.0534, 0.1496,
        0.1184])
[rfa agg] iter:  5, prev_obj_val: 54.669212341308594, obj_val: 52.29551696777344, abs dis: 2.3736953735351562
[rfa agg] iter: 5, weight: tensor([0.0596, 0.0598, 0.0123, 0.1847, 0.1954, 0.1452, 0.0202, 0.0662, 0.1413,
        0.1154])
[rfa agg] iter:  6, prev_obj_val: 52.29551696777344, obj_val: 54.669212341308594, abs dis: 2.3736953735351562
[rfa agg] iter: 6, weight: tensor([0.0564, 0.0565, 0.0106, 0.2062, 0.2239, 0.1079, 0.0172, 0.0534, 0.1496,
        0.1184])
[rfa agg] iter:  7, prev_obj_val: 54.669212341308594, obj_val: 52.29551696777344, abs dis: 2.3736953735351562
[rfa agg] iter: 7, weight: tensor([0.0596, 0.0598, 0.0123, 0.1847, 0.1954, 0.1452, 0.0202, 0.0662, 0.1413,
        0.1154])
[rfa agg] iter:  8, prev_obj_val: 52.29551696777344, obj_val: 54.669212341308594, abs dis: 2.3736953735351562
[rfa agg] iter: 8, weight: tensor([0.0564, 0.0565, 0.0106, 0.2062, 0.2239, 0.1079, 0.0172, 0.0534, 0.1496,
        0.1184])
[rfa agg] iter:  9, prev_obj_val: 54.669212341308594, obj_val: 52.29551696777344, abs dis: 2.3736953735351562
[rfa agg] iter: 9, weight: tensor([0.0596, 0.0598, 0.0123, 0.1847, 0.1954, 0.1452, 0.0202, 0.0662, 0.1413,
        0.1154])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3270, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.1861, Accuracy: 0/9950 (0.0000%)
saving model
Done in 643.1126296520233 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 344/1657 (20.7604%)
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 530/1657 (31.9855%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0584, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 461/1715 (26.8805%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 736/1715 (42.9155%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1748, Accuracy: 89/10000 (0.8900%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0492, Accuracy: 471/1129 (41.7183%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0232, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.0719, Accuracy: 115/10000 (1.1500%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.8734, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 299/1013 (29.5163%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 500/1013 (49.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9490, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0533, Accuracy: 280/888 (31.5315%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 439/888 (49.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.7719, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 590/1581 (37.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7054, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0809, Accuracy: 36/311 (11.5756%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5655, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0605, Accuracy: 336/803 (41.8431%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 390/803 (48.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3608, Accuracy: 58/10000 (0.5800%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0585, Accuracy: 259/1241 (20.8703%)
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 435/1241 (35.0524%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4943, Accuracy: 73/10000 (0.7300%)
time spent on training: 205.96771788597107
[rfa agg] training data poison_ratio: 0.40741784037558687  data num: [1657, 1715, 1129, 312, 1013, 888, 1581, 311, 803, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.2546361502347418
[rfa agg] init. name: [0, 92, 37, 24, 39, 63, 28, 96, 58, 72], weight: tensor([0.1556, 0.1610, 0.1060, 0.0293, 0.0951, 0.0834, 0.1485, 0.0292, 0.0754,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 52.02275848388672, obj_val: 54.74749755859375, abs dis: 2.7247390747070312
[rfa agg] iter: 0, weight: tensor([0.0645, 0.0596, 0.3452, 0.0075, 0.1485, 0.0686, 0.0703, 0.0075, 0.0499,
        0.1783])
[rfa agg] iter:  1, prev_obj_val: 54.74749755859375, obj_val: 58.3355827331543, abs dis: 3.588085174560547
[rfa agg] iter: 1, weight: tensor([0.0571, 0.0534, 0.2825, 0.0081, 0.2544, 0.0898, 0.0612, 0.0081, 0.0614,
        0.1241])
[rfa agg] iter:  2, prev_obj_val: 58.3355827331543, obj_val: 60.524288177490234, abs dis: 2.1887054443359375
[rfa agg] iter: 2, weight: tensor([0.0453, 0.0428, 0.1443, 0.0078, 0.4349, 0.1148, 0.0480, 0.0078, 0.0709,
        0.0834])
[rfa agg] iter:  3, prev_obj_val: 60.524288177490234, obj_val: 58.262107849121094, abs dis: 2.2621803283691406
[rfa agg] iter: 3, weight: tensor([0.0443, 0.0420, 0.1193, 0.0084, 0.4176, 0.1508, 0.0468, 0.0084, 0.0860,
        0.0765])
[rfa agg] iter:  4, prev_obj_val: 58.262107849121094, obj_val: 60.53023147583008, abs dis: 2.2681236267089844
[rfa agg] iter: 4, weight: tensor([0.0398, 0.0375, 0.1224, 0.0068, 0.5076, 0.1015, 0.0421, 0.0068, 0.0623,
        0.0731])
[rfa agg] iter:  5, prev_obj_val: 60.53023147583008, obj_val: 60.522010803222656, abs dis: 0.008220672607421875
[rfa agg] iter: 5, weight: tensor([0.0433, 0.0410, 0.1160, 0.0082, 0.4332, 0.1463, 0.0457, 0.0082, 0.0837,
        0.0746])
[rfa agg] iter:  6, prev_obj_val: 60.522010803222656, obj_val: 58.26218795776367, abs dis: 2.2598228454589844
[rfa agg] iter: 6, weight: tensor([0.0443, 0.0420, 0.1187, 0.0084, 0.4176, 0.1516, 0.0467, 0.0084, 0.0860,
        0.0764])
[rfa agg] iter:  7, prev_obj_val: 58.26218795776367, obj_val: 60.53023147583008, abs dis: 2.2680435180664062
[rfa agg] iter: 7, weight: tensor([0.0398, 0.0375, 0.1224, 0.0068, 0.5076, 0.1015, 0.0421, 0.0068, 0.0623,
        0.0731])
[rfa agg] iter:  8, prev_obj_val: 60.53023147583008, obj_val: 60.522010803222656, abs dis: 0.008220672607421875
[rfa agg] iter: 8, weight: tensor([0.0433, 0.0410, 0.1160, 0.0082, 0.4332, 0.1463, 0.0457, 0.0082, 0.0837,
        0.0746])
[rfa agg] iter:  9, prev_obj_val: 60.522010803222656, obj_val: 58.26218795776367, abs dis: 2.2598228454589844
[rfa agg] iter: 9, weight: tensor([0.0443, 0.0420, 0.1187, 0.0084, 0.4176, 0.1516, 0.0467, 0.0084, 0.0860,
        0.0764])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3295, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.1952, Accuracy: 0/9950 (0.0000%)
saving model
Done in 636.0476961135864 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 51/271 (18.8192%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6773, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0568, Accuracy: 207/735 (28.1633%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.2415, Accuracy: 69/10000 (0.6900%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0696, Accuracy: 123/781 (15.7490%)
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0339, Accuracy: 255/781 (32.6504%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.4470, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0802, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.5631, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0544, Accuracy: 320/690 (46.3768%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0259, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3129, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 275/1513 (18.1758%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 490/1513 (32.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9207, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 406/1742 (23.3065%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 736/1742 (42.2503%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2004, Accuracy: 78/10000 (0.7800%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 483/1552 (31.1211%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 805/1552 (51.8686%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.9783, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.5716, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0612, Accuracy: 168/809 (20.7664%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0262, Accuracy: 379/809 (46.8480%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.5855, Accuracy: 76/10000 (0.7600%)
time spent on training: 183.80436754226685
[rfa agg] training data poison_ratio: 0.3356278450094371  data num: [271, 735, 781, 311, 690, 1513, 1742, 1552, 603, 809]
[rfa agg] considering poison per batch poison_fraction: 0.2097674031308982
[rfa agg] init. name: [35, 32, 3, 96, 25, 8, 93, 74, 88, 50], weight: tensor([0.0301, 0.0816, 0.0867, 0.0345, 0.0766, 0.1680, 0.1934, 0.1723, 0.0669,
        0.0898])
[rfa agg] iter:  0, prev_obj_val: 67.82848358154297, obj_val: 68.77860260009766, abs dis: 0.9501190185546875
[rfa agg] iter: 0, weight: tensor([0.0167, 0.1146, 0.1551, 0.0192, 0.0884, 0.1425, 0.1073, 0.1291, 0.0657,
        0.1612])
[rfa agg] iter:  1, prev_obj_val: 68.77860260009766, obj_val: 69.5065689086914, abs dis: 0.72796630859375
[rfa agg] iter: 1, weight: tensor([0.0150, 0.1329, 0.2060, 0.0172, 0.0944, 0.0929, 0.0741, 0.0858, 0.0666,
        0.2150])
[rfa agg] iter:  2, prev_obj_val: 69.5065689086914, obj_val: 74.324951171875, abs dis: 4.818382263183594
[rfa agg] iter: 2, weight: tensor([0.0116, 0.1359, 0.2594, 0.0134, 0.0870, 0.0583, 0.0480, 0.0545, 0.0579,
        0.2740])
[rfa agg] iter:  3, prev_obj_val: 74.324951171875, obj_val: 79.40923309326172, abs dis: 5.084281921386719
[rfa agg] iter: 3, weight: tensor([0.0100, 0.3037, 0.1759, 0.0114, 0.1474, 0.0324, 0.0280, 0.0307, 0.0752,
        0.1852])
[rfa agg] iter:  4, prev_obj_val: 79.40923309326172, obj_val: 85.8318862915039, abs dis: 6.4226531982421875
[rfa agg] iter: 4, weight: tensor([0.0127, 0.1871, 0.1054, 0.0146, 0.3290, 0.0328, 0.0289, 0.0312, 0.1488,
        0.1096])
[rfa agg] iter:  5, prev_obj_val: 85.8318862915039, obj_val: 85.77459716796875, abs dis: 0.05728912353515625
[rfa agg] iter: 5, weight: tensor([0.0176, 0.1163, 0.0833, 0.0202, 0.2047, 0.0353, 0.0316, 0.0338, 0.3706,
        0.0864])
[rfa agg] iter:  6, prev_obj_val: 85.77459716796875, obj_val: 89.45417022705078, abs dis: 3.6795730590820312
[rfa agg] iter: 6, weight: tensor([0.0154, 0.1001, 0.0727, 0.0177, 0.1697, 0.0308, 0.0276, 0.0295, 0.4613,
        0.0753])
[rfa agg] iter:  7, prev_obj_val: 89.45417022705078, obj_val: 85.7712173461914, abs dis: 3.682952880859375
[rfa agg] iter: 7, weight: tensor([0.0230, 0.1094, 0.0845, 0.0264, 0.1632, 0.0400, 0.0361, 0.0384, 0.3916,
        0.0874])
[rfa agg] iter:  8, prev_obj_val: 85.7712173461914, obj_val: 89.45510864257812, abs dis: 3.6838912963867188
[rfa agg] iter: 8, weight: tensor([0.0150, 0.0971, 0.0707, 0.0172, 0.1625, 0.0299, 0.0268, 0.0287, 0.4790,
        0.0732])
[rfa agg] iter:  9, prev_obj_val: 89.45510864257812, obj_val: 85.77099609375, abs dis: 3.684112548828125
[rfa agg] iter: 9, weight: tensor([0.0229, 0.1089, 0.0842, 0.0263, 0.1623, 0.0399, 0.0360, 0.0383, 0.3940,
        0.0871])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3314, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.1421, Accuracy: 0/9950 (0.0000%)
saving model
Done in 623.5819866657257 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 290/813 (35.6704%)
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 483/813 (59.4096%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 10.8954, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 316/946 (33.4038%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 335/946 (35.4123%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4290, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0595, Accuracy: 331/719 (46.0362%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6688, Accuracy: 60/10000 (0.6000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0806, Accuracy: 71/486 (14.6091%)
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.6392, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.5225, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 766/1715 (44.6647%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7376, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0605, Accuracy: 167/809 (20.6428%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0268, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.5320, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 376/1427 (26.3490%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 612/1427 (42.8872%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4760, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0547, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9522, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4708, Accuracy: 57/10000 (0.5700%)
time spent on training: 160.73720741271973
[rfa agg] training data poison_ratio: 0.052489469705151746  data num: [813, 946, 719, 486, 500, 1715, 809, 1427, 891, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03280591856571984
[rfa agg] init. name: [53, 43, 41, 30, 82, 92, 50, 34, 7, 64], weight: tensor([0.0878, 0.1022, 0.0777, 0.0525, 0.0540, 0.1852, 0.0874, 0.1541, 0.0962,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 45.90106964111328, obj_val: 51.34471130371094, abs dis: 5.443641662597656
[rfa agg] iter: 0, weight: tensor([0.0856, 0.2833, 0.0522, 0.0156, 0.0161, 0.0322, 0.0844, 0.0400, 0.1576,
        0.2330])
[rfa agg] iter:  1, prev_obj_val: 51.34471130371094, obj_val: 57.09494400024414, abs dis: 5.750232696533203
[rfa agg] iter: 1, weight: tensor([0.2239, 0.0874, 0.1724, 0.0255, 0.0262, 0.0281, 0.1928, 0.0322, 0.1248,
        0.0867])
[rfa agg] iter:  2, prev_obj_val: 57.09494400024414, obj_val: 63.83181381225586, abs dis: 6.736869812011719
[rfa agg] iter: 2, weight: tensor([0.1563, 0.0827, 0.2625, 0.0430, 0.0441, 0.0345, 0.1495, 0.0386, 0.1062,
        0.0826])
[rfa agg] iter:  3, prev_obj_val: 63.83181381225586, obj_val: 60.41537094116211, abs dis: 3.41644287109375
[rfa agg] iter: 3, weight: tensor([0.1347, 0.0889, 0.1902, 0.0819, 0.0836, 0.0445, 0.1320, 0.0488, 0.1065,
        0.0890])
[rfa agg] iter:  4, prev_obj_val: 60.41537094116211, obj_val: 60.413970947265625, abs dis: 0.001399993896484375
[rfa agg] iter: 4, weight: tensor([0.1445, 0.0874, 0.2248, 0.0603, 0.0617, 0.0402, 0.1410, 0.0445, 0.1081,
        0.0874])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3330, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.1209, Accuracy: 0/9950 (0.0000%)
saving model
Done in 603.1878542900085 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0782, Accuracy: 110/530 (20.7547%)
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3293, Accuracy: 66/10000 (0.6600%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.5610, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0626, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 395/901 (43.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9703, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 51/271 (18.8192%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0543, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7468, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0653, Accuracy: 220/605 (36.3636%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3732, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0564, Accuracy: 338/1645 (20.5471%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0318, Accuracy: 684/1645 (41.5805%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4913, Accuracy: 114/10000 (1.1400%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 41/312 (13.1410%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0829, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0463, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.5046, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 339/1275 (26.5882%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 678/1275 (53.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.6276, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0596, Accuracy: 322/946 (34.0381%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0350, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.6168, Accuracy: 62/10000 (0.6200%)
time spent on training: 190.81531310081482
[rfa agg] training data poison_ratio: 0.39740713039142356  data num: [530, 1071, 901, 271, 605, 1645, 312, 466, 1275, 946]
[rfa agg] considering poison per batch poison_fraction: 0.24837945649463972
[rfa agg] init. name: [18, 55, 4, 35, 2, 13, 24, 76, 9, 43], weight: tensor([0.0661, 0.1335, 0.1123, 0.0338, 0.0754, 0.2051, 0.0389, 0.0581, 0.1589,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 51.61170196533203, obj_val: 55.39811325073242, abs dis: 3.7864112854003906
[rfa agg] iter: 0, weight: tensor([0.0409, 0.1346, 0.2778, 0.0117, 0.0579, 0.0530, 0.0134, 0.0300, 0.0817,
        0.2991])
[rfa agg] iter:  1, prev_obj_val: 55.39811325073242, obj_val: 55.39089584350586, abs dis: 0.0072174072265625
[rfa agg] iter: 1, weight: tensor([0.0673, 0.1349, 0.2212, 0.0173, 0.1004, 0.0647, 0.0200, 0.0475, 0.0926,
        0.2341])
[rfa agg] iter:  2, prev_obj_val: 55.39089584350586, obj_val: 57.38917541503906, abs dis: 1.9982795715332031
[rfa agg] iter: 2, weight: tensor([0.0675, 0.1353, 0.2203, 0.0174, 0.1010, 0.0648, 0.0200, 0.0476, 0.0928,
        0.2332])
[rfa agg] iter:  3, prev_obj_val: 57.38917541503906, obj_val: 59.40325927734375, abs dis: 2.0140838623046875
[rfa agg] iter: 3, weight: tensor([0.0830, 0.1300, 0.1932, 0.0200, 0.1293, 0.0673, 0.0230, 0.0569, 0.0935,
        0.2039])
[rfa agg] iter:  4, prev_obj_val: 59.40325927734375, obj_val: 57.38916778564453, abs dis: 2.0140914916992188
[rfa agg] iter: 4, weight: tensor([0.0996, 0.1211, 0.1675, 0.0221, 0.1644, 0.0669, 0.0254, 0.0660, 0.0905,
        0.1765])
[rfa agg] iter:  5, prev_obj_val: 57.38916778564453, obj_val: 59.40318298339844, abs dis: 2.0140151977539062
[rfa agg] iter: 5, weight: tensor([0.0831, 0.1301, 0.1925, 0.0200, 0.1302, 0.0673, 0.0230, 0.0570, 0.0936,
        0.2032])
[rfa agg] iter:  6, prev_obj_val: 59.40318298339844, obj_val: 57.38916778564453, abs dis: 2.0140151977539062
[rfa agg] iter: 6, weight: tensor([0.0996, 0.1211, 0.1675, 0.0221, 0.1644, 0.0669, 0.0254, 0.0660, 0.0905,
        0.1765])
[rfa agg] iter:  7, prev_obj_val: 57.38916778564453, obj_val: 59.40318298339844, abs dis: 2.0140151977539062
[rfa agg] iter: 7, weight: tensor([0.0831, 0.1301, 0.1925, 0.0200, 0.1302, 0.0673, 0.0230, 0.0570, 0.0936,
        0.2032])
[rfa agg] iter:  8, prev_obj_val: 59.40318298339844, obj_val: 57.38916778564453, abs dis: 2.0140151977539062
[rfa agg] iter: 8, weight: tensor([0.0996, 0.1211, 0.1675, 0.0221, 0.1644, 0.0669, 0.0254, 0.0660, 0.0905,
        0.1765])
[rfa agg] iter:  9, prev_obj_val: 57.38916778564453, obj_val: 59.40318298339844, abs dis: 2.0140151977539062
[rfa agg] iter: 9, weight: tensor([0.0831, 0.1301, 0.1925, 0.0200, 0.1302, 0.0673, 0.0230, 0.0570, 0.0936,
        0.2032])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3346, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.1281, Accuracy: 0/9950 (0.0000%)
saving model
Done in 624.4154949188232 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0249, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7833, Accuracy: 64/10000 (0.6400%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0698, Accuracy: 126/631 (19.9683%)
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5076, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0479, Accuracy: 318/813 (39.1144%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 467/813 (57.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.5486, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 437/1587 (27.5362%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 626/1587 (39.4455%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4028, Accuracy: 71/10000 (0.7100%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 276/1071 (25.7703%)
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 517/1071 (48.2726%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4830, Accuracy: 82/10000 (0.8200%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0529, Accuracy: 424/1475 (28.7458%)
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 689/1475 (46.7119%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4074, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0804, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.6172, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 421/896 (46.9866%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.8299, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 422/1574 (26.8107%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 697/1574 (44.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4936, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0373, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.0969, Accuracy: 50/10000 (0.5000%)
time spent on training: 192.34472942352295
[rfa agg] training data poison_ratio: 0.3198107509563117  data num: [712, 631, 813, 1587, 1071, 1475, 460, 896, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1998817193476948
[rfa agg] init. name: [11, 48, 53, 27, 55, 65, 31, 89, 17, 23], weight: tensor([0.0717, 0.0635, 0.0818, 0.1598, 0.1078, 0.1485, 0.0463, 0.0902, 0.1584,
        0.0720])
[rfa agg] iter:  0, prev_obj_val: 54.360923767089844, obj_val: 58.121829986572266, abs dis: 3.760906219482422
[rfa agg] iter: 0, weight: tensor([0.0788, 0.0448, 0.1235, 0.0658, 0.2435, 0.0680, 0.0242, 0.2074, 0.0653,
        0.0788])
[rfa agg] iter:  1, prev_obj_val: 58.121829986572266, obj_val: 70.70511627197266, abs dis: 12.58328628540039
[rfa agg] iter: 1, weight: tensor([0.1135, 0.0458, 0.2500, 0.0360, 0.0782, 0.0364, 0.0217, 0.2717, 0.0357,
        0.1110])
[rfa agg] iter:  2, prev_obj_val: 70.70511627197266, obj_val: 77.73831939697266, abs dis: 7.033203125
[rfa agg] iter: 2, weight: tensor([0.1979, 0.1620, 0.1300, 0.0376, 0.0586, 0.0375, 0.0501, 0.0973, 0.0373,
        0.1917])
[rfa agg] iter:  3, prev_obj_val: 77.73831939697266, obj_val: 81.53865051269531, abs dis: 3.8003311157226562
[rfa agg] iter: 3, weight: tensor([0.1238, 0.3262, 0.0964, 0.0384, 0.0551, 0.0381, 0.0808, 0.0800, 0.0381,
        0.1231])
[rfa agg] iter:  4, prev_obj_val: 81.53865051269531, obj_val: 77.70059204101562, abs dis: 3.8380584716796875
[rfa agg] iter: 4, weight: tensor([0.1077, 0.3302, 0.0894, 0.0400, 0.0555, 0.0397, 0.1136, 0.0767, 0.0397,
        0.1074])
[rfa agg] iter:  5, prev_obj_val: 77.70059204101562, obj_val: 77.69725799560547, abs dis: 0.00333404541015625
[rfa agg] iter: 5, weight: tensor([0.1124, 0.3843, 0.0883, 0.0352, 0.0506, 0.0350, 0.0744, 0.0732, 0.0349,
        0.1117])
[rfa agg] iter:  6, prev_obj_val: 77.69725799560547, obj_val: 77.69681549072266, abs dis: 0.0004425048828125
[rfa agg] iter: 6, weight: tensor([0.1090, 0.4022, 0.0858, 0.0342, 0.0491, 0.0340, 0.0721, 0.0711, 0.0339,
        0.1084])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3367, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.1241, Accuracy: 0/9950 (0.0000%)
saving model
Done in 621.2931678295135 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0527, Accuracy: 397/1154 (34.4021%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 418/1154 (36.2218%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.9150, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 500/1470 (34.0136%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 875/1470 (59.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.0149, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5640, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 358/712 (50.2809%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0244, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5136, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0537, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0310, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3017, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6017, Accuracy: 76/10000 (0.7600%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0687, Accuracy: 132/781 (16.9014%)
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0346, Accuracy: 255/781 (32.6504%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6103, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0500, Accuracy: 368/1340 (27.4627%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0262, Accuracy: 617/1340 (46.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.7603, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0723, Accuracy: 160/603 (26.5340%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.6717, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0630, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.8357, Accuracy: 59/10000 (0.5900%)
time spent on training: 184.7613983154297
[rfa agg] training data poison_ratio: 0.19773145309625997  data num: [1154, 1470, 500, 712, 1742, 776, 781, 1340, 603, 708]
[rfa agg] considering poison per batch poison_fraction: 0.12358215818516248
[rfa agg] init. name: [15, 22, 82, 11, 93, 75, 3, 77, 88, 16], weight: tensor([0.1179, 0.1502, 0.0511, 0.0728, 0.1780, 0.0793, 0.0798, 0.1369, 0.0616,
        0.0723])
[rfa agg] iter:  0, prev_obj_val: 55.54945373535156, obj_val: 58.83082962036133, abs dis: 3.2813758850097656
[rfa agg] iter: 0, weight: tensor([0.1535, 0.0942, 0.0322, 0.0967, 0.0673, 0.1454, 0.1458, 0.1166, 0.0527,
        0.0955])
[rfa agg] iter:  1, prev_obj_val: 58.83082962036133, obj_val: 74.04429626464844, abs dis: 15.21346664428711
[rfa agg] iter: 1, weight: tensor([0.0549, 0.0409, 0.0241, 0.1167, 0.0318, 0.2670, 0.2609, 0.0471, 0.0451,
        0.1114])
[rfa agg] iter:  2, prev_obj_val: 74.04429626464844, obj_val: 77.55223083496094, abs dis: 3.5079345703125
[rfa agg] iter: 2, weight: tensor([0.0456, 0.0397, 0.0664, 0.1495, 0.0336, 0.1029, 0.1033, 0.0430, 0.2739,
        0.1422])
[rfa agg] iter:  3, prev_obj_val: 77.55223083496094, obj_val: 74.00885009765625, abs dis: 3.5433807373046875
[rfa agg] iter: 3, weight: tensor([0.0387, 0.0343, 0.0740, 0.1038, 0.0294, 0.0771, 0.0776, 0.0369, 0.4269,
        0.1013])
[rfa agg] iter:  4, prev_obj_val: 74.00885009765625, obj_val: 74.0011215209961, abs dis: 0.00772857666015625
[rfa agg] iter: 4, weight: tensor([0.0429, 0.0373, 0.0626, 0.1391, 0.0316, 0.0960, 0.0967, 0.0405, 0.3188,
        0.1344])
[rfa agg] iter:  5, prev_obj_val: 74.0011215209961, obj_val: 74.0009994506836, abs dis: 0.0001220703125
[rfa agg] iter: 5, weight: tensor([0.0436, 0.0380, 0.0637, 0.1429, 0.0322, 0.0978, 0.0984, 0.0412, 0.3043,
        0.1379])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3389, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.1336, Accuracy: 0/9950 (0.0000%)
saving model
Done in 611.2374603748322 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0463, Accuracy: 895/1657 (54.0133%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1008/1657 (60.8328%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0245, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0235, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0233, Accuracy: 1039/1657 (62.7037%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0228, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0226, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0217, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0218, Accuracy: 1043/1657 (62.9451%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0213, Accuracy: 1046/1657 (63.1261%), train_poison_data_count: 1040
Global model norm: 112.02866977502902.
Norm before scaling: 111.99908882860387. Distance: 1.0052850064830587
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4604, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.4797, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 147.96167815730195, distance: 100.52851060924209
Total norm for 5 adversaries is: 147.96167815730195. distance: 100.52851060924209
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 623/1587 (39.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6194, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0511, Accuracy: 334/1013 (32.9714%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0251, Accuracy: 518/1013 (51.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0186, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 411/1418 (28.9845%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1828, Accuracy: 118/10000 (1.1800%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 323/807 (40.0248%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0329, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5042, Accuracy: 62/10000 (0.6200%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0555, Accuracy: 443/1988 (22.2837%)
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 679/1988 (34.1549%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7572, Accuracy: 80/10000 (0.8000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.0897, Accuracy: 13/338 (3.8462%)
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.9903, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0583, Accuracy: 296/1241 (23.8517%)
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0358, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7078, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0536, Accuracy: 377/1662 (22.6835%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0323, Accuracy: 633/1662 (38.0866%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3479, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0565, Accuracy: 213/735 (28.9796%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0208, Accuracy: 409/735 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.5387, Accuracy: 63/10000 (0.6300%)
time spent on training: 339.0839583873749
[rfa agg] training data poison_ratio: 0.48457335690181585  data num: [1657, 1587, 1013, 1418, 807, 1988, 338, 1241, 1662, 735]
[rfa agg] considering poison per batch poison_fraction: 0.30285834806363493
[rfa agg] init. name: [0, 27, 39, 70, 20, 85, 12, 72, 94, 32], weight: tensor([0.1331, 0.1275, 0.0814, 0.1139, 0.0648, 0.1597, 0.0272, 0.0997, 0.1335,
        0.0591])
[rfa agg] iter:  0, prev_obj_val: 26776.859375, obj_val: 17394.90234375, abs dis: 9381.95703125
[rfa agg] iter: 0, weight: tensor([0.0230, 0.1439, 0.0914, 0.1285, 0.0727, 0.1810, 0.0303, 0.1122, 0.1508,
        0.0662])
[rfa agg] iter:  1, prev_obj_val: 17394.90234375, obj_val: 15744.3466796875, abs dis: 1650.5556640625
[rfa agg] iter: 1, weight: tensor([0.0036, 0.1478, 0.0915, 0.1312, 0.0722, 0.1897, 0.0296, 0.1136, 0.1553,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 15744.3466796875, obj_val: 15501.9853515625, abs dis: 242.361328125
[rfa agg] iter: 2, weight: tensor([0.0005, 0.1526, 0.0801, 0.1301, 0.0602, 0.2299, 0.0223, 0.1065, 0.1638,
        0.0538])
[rfa agg] iter:  3, prev_obj_val: 15501.9853515625, obj_val: 15496.4501953125, abs dis: 5.53515625
[rfa agg] iter: 3, weight: tensor([4.8028e-05, 2.2267e-01, 3.3041e-02, 1.1638e-01, 2.0885e-02, 1.6225e-01,
        5.9090e-03, 6.1803e-02, 3.5920e-01, 1.7812e-02])
[rfa agg] iter:  4, prev_obj_val: 15496.4501953125, obj_val: 15498.7470703125, abs dis: 2.296875
[rfa agg] iter: 4, weight: tensor([3.3373e-05, 3.0538e-01, 3.2891e-02, 2.7323e-01, 1.9094e-02, 6.4340e-02,
        4.9042e-03, 7.8916e-02, 2.0524e-01, 1.5973e-02])
[rfa agg] iter:  5, prev_obj_val: 15498.7470703125, obj_val: 15503.03515625, abs dis: 4.2880859375
[rfa agg] iter: 5, weight: tensor([3.5084e-05, 1.6606e-01, 4.2467e-02, 4.3152e-01, 2.3216e-02, 5.7023e-02,
        5.6246e-03, 1.2824e-01, 1.2663e-01, 1.9180e-02])
[rfa agg] iter:  6, prev_obj_val: 15503.03515625, obj_val: 15508.3828125, abs dis: 5.34765625
[rfa agg] iter: 6, weight: tensor([4.3734e-05, 1.3203e-01, 6.8464e-02, 2.3404e-01, 3.4307e-02, 6.1512e-02,
        7.7123e-03, 3.2216e-01, 1.1186e-01, 2.7871e-02])
[rfa agg] iter:  7, prev_obj_val: 15508.3828125, obj_val: 15508.3447265625, abs dis: 0.0380859375
[rfa agg] iter: 7, weight: tensor([4.0825e-05, 9.0851e-02, 9.0113e-02, 1.2680e-01, 3.9270e-02, 5.0624e-02,
        7.9992e-03, 4.8220e-01, 8.0920e-02, 3.1186e-02])
[rfa agg] iter:  8, prev_obj_val: 15508.3447265625, obj_val: 15513.013671875, abs dis: 4.6689453125
[rfa agg] iter: 8, weight: tensor([3.7838e-05, 8.4042e-02, 8.3323e-02, 1.1666e-01, 3.6362e-02, 4.6911e-02,
        7.4128e-03, 5.2146e-01, 7.4899e-02, 2.8893e-02])
[rfa agg] iter:  9, prev_obj_val: 15513.013671875, obj_val: 15510.6474609375, abs dis: 2.3662109375
[rfa agg] iter: 9, weight: tensor([5.3784e-05, 1.0155e-01, 1.6102e-01, 1.3033e-01, 6.0762e-02, 6.1785e-02,
        1.1377e-02, 3.3331e-01, 9.2517e-02, 4.7291e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3410, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.1120, Accuracy: 0/9950 (0.0000%)
saving model
Done in 778.3119571208954 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0505, Accuracy: 418/1574 (26.5565%)
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.1261, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0550, Accuracy: 232/735 (31.5646%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0217, Accuracy: 358/735 (48.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3058, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 181/938 (19.2964%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 327/938 (34.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7052, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0329, Accuracy: 613/1581 (38.7729%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.3576, Accuracy: 87/10000 (0.8700%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0890, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0651, Accuracy: 225/605 (37.1901%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3435, Accuracy: 55/10000 (0.5500%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 429/1988 (21.5795%)
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 692/1988 (34.8089%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0397, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0559, Accuracy: 363/1645 (22.0669%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0315, Accuracy: 666/1645 (40.4863%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2619, Accuracy: 112/10000 (1.1200%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 121/530 (22.8302%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0371, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5448, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0685, Accuracy: 170/682 (24.9267%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0364, Accuracy: 272/682 (39.8827%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6161, Accuracy: 56/10000 (0.5600%)
time spent on training: 212.44085383415222
[rfa agg] training data poison_ratio: 0.2690278824415976  data num: [1574, 735, 938, 1581, 338, 605, 1988, 1645, 530, 682]
[rfa agg] considering poison per batch poison_fraction: 0.16814242652599848
[rfa agg] init. name: [17, 32, 73, 28, 12, 2, 85, 13, 18, 80], weight: tensor([0.1483, 0.0692, 0.0884, 0.1489, 0.0318, 0.0570, 0.1873, 0.1550, 0.0499,
        0.0642])
[rfa agg] iter:  0, prev_obj_val: 72.75117492675781, obj_val: 75.2229995727539, abs dis: 2.4718246459960938
[rfa agg] iter: 0, weight: tensor([0.1764, 0.0711, 0.1561, 0.1772, 0.0177, 0.0456, 0.1037, 0.1583, 0.0360,
        0.0578])
[rfa agg] iter:  1, prev_obj_val: 75.2229995727539, obj_val: 75.2207260131836, abs dis: 0.0022735595703125
[rfa agg] iter: 1, weight: tensor([0.1511, 0.0825, 0.2048, 0.1518, 0.0191, 0.0510, 0.0959, 0.1382, 0.0398,
        0.0657])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3424, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 4.9716, Accuracy: 7/9950 (0.0704%)
saving model
Done in 651.3864908218384 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0535, Accuracy: 389/781 (49.8079%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 491/781 (62.8681%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Avg loss: 0.0269, Accuracy: 468/781 (59.9232%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Avg loss: 0.0242, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Avg loss: 0.0236, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Avg loss: 0.0237, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Avg loss: 0.0231, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Avg loss: 0.0227, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Avg loss: 0.0226, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Avg loss: 0.0227, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Global model norm: 112.02517853143551.
Norm before scaling: 112.01302152958601. Distance: 0.7306322944870881
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2644, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.4370, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 132.52196162334755, distance: 73.06322845017526
Total norm for 4 adversaries is: 132.52196162334755. distance: 73.06322845017526
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8880, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.0842, Accuracy: 54/197 (27.4112%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.4484, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0423, Accuracy: 473/1552 (30.4768%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 818/1552 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.9678, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0648, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4186, Accuracy: 60/10000 (0.6000%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.0781, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0469, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2587, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0539, Accuracy: 232/735 (31.5646%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0215, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.6551, Accuracy: 63/10000 (0.6300%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 129/530 (24.3396%)
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0415, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7949, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 339/901 (37.6249%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0312, Accuracy: 383/901 (42.5083%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.7147, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0544, Accuracy: 355/891 (39.8429%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 473/891 (53.0864%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8111, Accuracy: 62/10000 (0.6200%)
time spent on training: 283.07829880714417
[rfa agg] training data poison_ratio: 0.43204708960104643  data num: [781, 1013, 197, 1552, 605, 440, 735, 530, 901, 891]
[rfa agg] considering poison per batch poison_fraction: 0.270029431000654
[rfa agg] init. name: [3, 14, 79, 74, 2, 49, 32, 18, 4, 7], weight: tensor([0.1022, 0.1325, 0.0258, 0.2030, 0.0791, 0.0576, 0.0961, 0.0693, 0.1179,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 10629.572265625, obj_val: 6494.10498046875, abs dis: 4135.46728515625
[rfa agg] iter: 0, weight: tensor([0.0127, 0.1459, 0.0279, 0.2266, 0.0863, 0.0625, 0.1052, 0.0755, 0.1295,
        0.1279])
[rfa agg] iter:  1, prev_obj_val: 6494.10498046875, obj_val: 5985.7685546875, abs dis: 508.33642578125
[rfa agg] iter: 1, weight: tensor([0.0014, 0.1479, 0.0250, 0.2558, 0.0821, 0.0577, 0.1022, 0.0711, 0.1299,
        0.1269])
[rfa agg] iter:  2, prev_obj_val: 5985.7685546875, obj_val: 5967.32666015625, abs dis: 18.44189453125
[rfa agg] iter: 2, weight: tensor([1.0881e-04, 1.5132e-01, 9.8741e-03, 4.4844e-01, 4.5460e-02, 2.6460e-02,
        6.6140e-02, 3.6766e-02, 1.1538e-01, 1.0005e-01])
[rfa agg] iter:  3, prev_obj_val: 5967.32666015625, obj_val: 5968.30322265625, abs dis: 0.9765625
[rfa agg] iter: 3, weight: tensor([4.8716e-05, 4.2510e-01, 6.3662e-03, 7.3649e-02, 3.7450e-02, 1.8688e-02,
        6.4785e-02, 2.8456e-02, 2.0984e-01, 1.3561e-01])
[rfa agg] iter:  4, prev_obj_val: 5968.30322265625, obj_val: 5973.58203125, abs dis: 5.27880859375
[rfa agg] iter: 4, weight: tensor([4.6818e-05, 1.2979e-01, 8.4973e-03, 5.0094e-02, 7.6922e-02, 2.8413e-02,
        2.2408e-01, 5.0966e-02, 1.6402e-01, 2.6717e-01])
[rfa agg] iter:  5, prev_obj_val: 5973.58203125, obj_val: 5980.8408203125, abs dis: 7.2587890625
[rfa agg] iter: 5, weight: tensor([4.7249e-05, 8.7368e-02, 1.0291e-02, 4.4986e-02, 1.4968e-01, 3.8196e-02,
        3.5398e-01, 8.1649e-02, 9.8310e-02, 1.3549e-01])
[rfa agg] iter:  6, prev_obj_val: 5980.8408203125, obj_val: 5990.45068359375, abs dis: 9.60986328125
[rfa agg] iter: 6, weight: tensor([4.1230e-05, 5.7458e-02, 1.1217e-02, 3.5357e-02, 4.2436e-01, 4.9743e-02,
        1.2207e-01, 1.6397e-01, 6.0748e-02, 7.5035e-02])
[rfa agg] iter:  7, prev_obj_val: 5990.45068359375, obj_val: 5990.419921875, abs dis: 0.03076171875
[rfa agg] iter: 7, weight: tensor([5.3294e-05, 5.9564e-02, 1.9304e-02, 4.1580e-02, 1.7511e-01, 1.2460e-01,
        9.1368e-02, 3.5649e-01, 6.0808e-02, 7.1122e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3435, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 4.9242, Accuracy: 28/9950 (0.2814%)
saving model
Done in 712.9913210868835 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 442/1715 (25.7726%)
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 763/1715 (44.4898%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1835, Accuracy: 97/10000 (0.9700%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.0801, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0511, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5056, Accuracy: 70/10000 (0.7000%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0514, Accuracy: 361/1372 (26.3120%)
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 552/1372 (40.2332%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.7009, Accuracy: 88/10000 (0.8800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 80/408 (19.6078%)
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0534, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.3329, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 580/1470 (39.4558%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 884/1470 (60.1361%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.0137, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.0839, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.9854, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0580, Accuracy: 340/901 (37.7358%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 433/901 (48.0577%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8227, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0502, Accuracy: 438/1574 (27.8272%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 691/1574 (43.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.4391, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0834, Accuracy: 60/466 (12.8755%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0463, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9283, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0676, Accuracy: 134/781 (17.1575%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0338, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7390, Accuracy: 98/10000 (0.9800%)
time spent on training: 211.85906767845154
[rfa agg] training data poison_ratio: 0.3212532637075718  data num: [1715, 515, 1372, 408, 1470, 373, 901, 1574, 466, 781]
[rfa agg] considering poison per batch poison_fraction: 0.20078328981723237
[rfa agg] init. name: [92, 33, 42, 36, 22, 98, 4, 17, 76, 3], weight: tensor([0.1791, 0.0538, 0.1433, 0.0426, 0.1535, 0.0390, 0.0941, 0.1644, 0.0487,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 62.95806884765625, obj_val: 65.49254608154297, abs dis: 2.5344772338867188
[rfa agg] iter: 0, weight: tensor([0.1016, 0.0382, 0.1612, 0.0242, 0.1442, 0.0201, 0.2489, 0.1161, 0.0307,
        0.1147])
[rfa agg] iter:  1, prev_obj_val: 65.49254608154297, obj_val: 66.80517578125, abs dis: 1.3126296997070312
[rfa agg] iter: 1, weight: tensor([0.0781, 0.0368, 0.1141, 0.0228, 0.1047, 0.0187, 0.3798, 0.0874, 0.0292,
        0.1283])
[rfa agg] iter:  2, prev_obj_val: 66.80517578125, obj_val: 70.14977264404297, abs dis: 3.3445968627929688
[rfa agg] iter: 2, weight: tensor([0.0598, 0.0317, 0.0844, 0.0193, 0.0782, 0.0158, 0.4975, 0.0663, 0.0249,
        0.1221])
[rfa agg] iter:  3, prev_obj_val: 70.14977264404297, obj_val: 76.68228149414062, abs dis: 6.532508850097656
[rfa agg] iter: 3, weight: tensor([0.0497, 0.0338, 0.0662, 0.0197, 0.0625, 0.0159, 0.4984, 0.0542, 0.0260,
        0.1736])
[rfa agg] iter:  4, prev_obj_val: 76.68228149414062, obj_val: 79.1473617553711, abs dis: 2.4650802612304688
[rfa agg] iter: 4, weight: tensor([0.0474, 0.0492, 0.0589, 0.0263, 0.0567, 0.0206, 0.1710, 0.0507, 0.0359,
        0.4835])
[rfa agg] iter:  5, prev_obj_val: 79.1473617553711, obj_val: 76.51399993896484, abs dis: 2.63336181640625
[rfa agg] iter: 5, weight: tensor([0.0466, 0.0571, 0.0568, 0.0292, 0.0550, 0.0226, 0.1368, 0.0495, 0.0406,
        0.5058])
[rfa agg] iter:  6, prev_obj_val: 76.51399993896484, obj_val: 84.75391387939453, abs dis: 8.239913940429688
[rfa agg] iter: 6, weight: tensor([0.0331, 0.0344, 0.0412, 0.0184, 0.0396, 0.0144, 0.1145, 0.0354, 0.0251,
        0.6439])
[rfa agg] iter:  7, prev_obj_val: 84.75391387939453, obj_val: 76.56871795654297, abs dis: 8.185195922851562
[rfa agg] iter: 7, weight: tensor([0.0636, 0.1141, 0.0750, 0.0518, 0.0733, 0.0388, 0.1447, 0.0669, 0.0756,
        0.2962])
[rfa agg] iter:  8, prev_obj_val: 76.56871795654297, obj_val: 76.50382995605469, abs dis: 0.06488800048828125
[rfa agg] iter: 8, weight: tensor([0.0406, 0.0423, 0.0504, 0.0225, 0.0486, 0.0176, 0.1410, 0.0434, 0.0308,
        0.5629])
[rfa agg] iter:  9, prev_obj_val: 76.50382995605469, obj_val: 81.94892883300781, abs dis: 5.445098876953125
[rfa agg] iter: 9, weight: tensor([0.0308, 0.0320, 0.0383, 0.0171, 0.0369, 0.0134, 0.1064, 0.0329, 0.0234,
        0.6689])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3466, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 4.9247, Accuracy: 10/9950 (0.1005%)
saving model
Done in 650.393913269043 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Avg loss: 0.0451, Accuracy: 914/1628 (56.1425%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Avg loss: 0.0227, Accuracy: 1027/1628 (63.0835%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Avg loss: 0.0208, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Avg loss: 0.0200, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Avg loss: 0.0194, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Avg loss: 0.0189, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Avg loss: 0.0186, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Avg loss: 0.0180, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Avg loss: 0.0184, Accuracy: 1031/1628 (63.3292%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Avg loss: 0.0186, Accuracy: 1030/1628 (63.2678%), train_poison_data_count: 1028
Global model norm: 112.02336966705876.
Norm before scaling: 111.99464185704377. Distance: 1.0447357867666833
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1892, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.4341, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 150.70211330012927, distance: 104.47357340046572
Total norm for 4 adversaries is: 150.70211330012927. distance: 104.47357340046572
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0626, Accuracy: 332/715 (46.4336%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0362, Accuracy: 441/715 (61.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2154, Accuracy: 57/10000 (0.5700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 349/1657 (21.0622%)
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0340, Accuracy: 543/1657 (32.7701%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9794, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0769, Accuracy: 73/426 (17.1362%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0404, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.5911, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 370/1573 (23.5219%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 584/1573 (37.1265%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7885, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 167/682 (24.4868%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6572, Accuracy: 64/10000 (0.6400%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 366/1130 (32.3894%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 516/1130 (45.6637%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.1363, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 348/1446 (24.0664%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 514/1446 (35.5463%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5048, Accuracy: 58/10000 (0.5800%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0420, Accuracy: 530/1552 (34.1495%)
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 805/1552 (51.8686%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.5440, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1195, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1044, Accuracy: 27/134 (20.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3732, Accuracy: 50/10000 (0.5000%)
time spent on training: 334.89883685112
[rfa agg] training data poison_ratio: 0.5452800877273143  data num: [1628, 715, 1657, 426, 1573, 682, 1130, 1446, 1552, 134]
[rfa agg] considering poison per batch poison_fraction: 0.34080005482957143
[rfa agg] init. name: [5, 23, 0, 67, 40, 80, 54, 26, 74, 47], weight: tensor([0.1488, 0.0653, 0.1514, 0.0389, 0.1437, 0.0623, 0.1033, 0.1321, 0.1418,
        0.0122])
[rfa agg] iter:  0, prev_obj_val: 29392.884765625, obj_val: 19672.64453125, abs dis: 9720.240234375
[rfa agg] iter: 0, weight: tensor([0.0296, 0.0741, 0.1731, 0.0441, 0.1642, 0.0707, 0.1175, 0.1508, 0.1620,
        0.0138])
[rfa agg] iter:  1, prev_obj_val: 19672.64453125, obj_val: 17690.3046875, abs dis: 1982.33984375
[rfa agg] iter: 1, weight: tensor([0.0053, 0.0746, 0.1793, 0.0439, 0.1698, 0.0710, 0.1197, 0.1552, 0.1675,
        0.0137])
[rfa agg] iter:  2, prev_obj_val: 17690.3046875, obj_val: 17332.54296875, abs dis: 357.76171875
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0672, 0.1911, 0.0375, 0.1785, 0.0632, 0.1153, 0.1590, 0.1761,
        0.0112])
[rfa agg] iter:  3, prev_obj_val: 17332.54296875, obj_val: 17308.28515625, abs dis: 24.2578125
[rfa agg] iter: 3, weight: tensor([9.6552e-05, 2.9698e-02, 2.7864e-01, 1.3937e-02, 2.1654e-01, 2.6881e-02,
        6.9396e-02, 1.4720e-01, 2.1387e-01, 3.7469e-03])
[rfa agg] iter:  4, prev_obj_val: 17308.28515625, obj_val: 17310.001953125, abs dis: 1.716796875
[rfa agg] iter: 4, weight: tensor([4.3386e-05, 2.4629e-02, 1.4064e-01, 9.8096e-03, 1.7287e-01, 2.1385e-02,
        9.5524e-02, 3.6178e-01, 1.7088e-01, 2.4375e-03])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3472, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 4.9526, Accuracy: 8/9950 (0.0804%)
saving model
Done in 765.740749835968 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0537, Accuracy: 356/1446 (24.6196%)
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0341, Accuracy: 516/1446 (35.6846%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7820, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0611, Accuracy: 347/901 (38.5128%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0327, Accuracy: 368/901 (40.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6733, Accuracy: 50/10000 (0.5000%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0528, Accuracy: 139/515 (26.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8520, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0632, Accuracy: 192/938 (20.4691%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0326, Accuracy: 347/938 (36.9936%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6018, Accuracy: 61/10000 (0.6100%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.0781, Accuracy: 85/486 (17.4897%)
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0389, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4972, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0609, Accuracy: 358/1003 (35.6929%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0336, Accuracy: 387/1003 (38.5842%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9216, Accuracy: 53/10000 (0.5300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 250/861 (29.0360%)
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0202, Accuracy: 493/861 (57.2590%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.0095, Accuracy: 91/10000 (0.9100%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.0910, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0506, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.2215, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0355, Accuracy: 463/1163 (39.8108%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5176, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6406, Accuracy: 61/10000 (0.6100%)
time spent on training: 194.33378291130066
[rfa agg] training data poison_ratio: 0.2699055330634278  data num: [1446, 901, 515, 938, 486, 1003, 861, 338, 1163, 500]
[rfa agg] considering poison per batch poison_fraction: 0.16869095816464236
[rfa agg] init. name: [26, 4, 33, 73, 30, 86, 10, 12, 68, 82], weight: tensor([0.1774, 0.1105, 0.0632, 0.1151, 0.0596, 0.1231, 0.1056, 0.0415, 0.1427,
        0.0613])
[rfa agg] iter:  0, prev_obj_val: 45.117305755615234, obj_val: 47.482032775878906, abs dis: 2.364727020263672
[rfa agg] iter: 0, weight: tensor([0.0611, 0.1520, 0.0643, 0.1619, 0.0478, 0.1254, 0.2362, 0.0231, 0.0792,
        0.0491])
[rfa agg] iter:  1, prev_obj_val: 47.482032775878906, obj_val: 52.332923889160156, abs dis: 4.85089111328125
[rfa agg] iter: 1, weight: tensor([0.0646, 0.1433, 0.0827, 0.1513, 0.0596, 0.1223, 0.2057, 0.0277, 0.0816,
        0.0612])
[rfa agg] iter:  2, prev_obj_val: 52.332923889160156, obj_val: 52.328941345214844, abs dis: 0.0039825439453125
[rfa agg] iter: 2, weight: tensor([0.0654, 0.1203, 0.1334, 0.1263, 0.0873, 0.1084, 0.1539, 0.0367, 0.0789,
        0.0894])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3476, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 4.8999, Accuracy: 40/9950 (0.4020%)
saving model
Done in 633.1891272068024 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0467, Accuracy: 695/1275 (54.5098%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0215, Accuracy: 730/1275 (57.2549%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Avg loss: 0.0184, Accuracy: 801/1275 (62.8235%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Avg loss: 0.0176, Accuracy: 799/1275 (62.6667%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Avg loss: 0.0172, Accuracy: 801/1275 (62.8235%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Avg loss: 0.0170, Accuracy: 804/1275 (63.0588%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Avg loss: 0.0171, Accuracy: 805/1275 (63.1373%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Avg loss: 0.0166, Accuracy: 805/1275 (63.1373%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Avg loss: 0.0162, Accuracy: 803/1275 (62.9804%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Avg loss: 0.0165, Accuracy: 809/1275 (63.4510%), train_poison_data_count: 800
Global model norm: 112.02032286319746.
Norm before scaling: 111.9997209817953. Distance: 0.9701626537552162
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5331, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.3857, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 146.30502437117462, distance: 97.0162679657386
Total norm for 5 adversaries is: 146.30502437117462. distance: 97.0162679657386
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 333/953 (34.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4174, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.0777, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0384, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0994, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0554, Accuracy: 374/1645 (22.7356%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0311, Accuracy: 688/1645 (41.8237%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7502, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.0829, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0464, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.6318, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0577, Accuracy: 410/1750 (23.4286%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 709/1750 (40.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8683, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0506, Accuracy: 340/1013 (33.5637%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0246, Accuracy: 538/1013 (53.1096%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2448, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 525/1470 (35.7143%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0231, Accuracy: 897/1470 (61.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2428, Accuracy: 108/10000 (1.0800%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 188/416 (45.1923%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.6038, Accuracy: 57/10000 (0.5700%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 456/1988 (22.9376%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 728/1988 (36.6197%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0583, Accuracy: 92/10000 (0.9200%)
time spent on training: 331.40104150772095
[rfa agg] training data poison_ratio: 0.5160530448438317  data num: [1275, 953, 486, 1645, 466, 1750, 1013, 1470, 416, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3225331530273948
[rfa agg] init. name: [9, 64, 30, 13, 76, 44, 39, 22, 78, 85], weight: tensor([0.1112, 0.0831, 0.0424, 0.1435, 0.0407, 0.1527, 0.0884, 0.1282, 0.0363,
        0.1734])
[rfa agg] iter:  0, prev_obj_val: 17625.869140625, obj_val: 10977.037109375, abs dis: 6648.83203125
[rfa agg] iter: 0, weight: tensor([0.0154, 0.0915, 0.0464, 0.1595, 0.0445, 0.1700, 0.0973, 0.1421, 0.0396,
        0.1938])
[rfa agg] iter:  1, prev_obj_val: 10977.037109375, obj_val: 10045.2919921875, abs dis: 931.7451171875
[rfa agg] iter: 1, weight: tensor([0.0019, 0.0887, 0.0433, 0.1644, 0.0415, 0.1773, 0.0948, 0.1440, 0.0368,
        0.2072])
[rfa agg] iter:  2, prev_obj_val: 10045.2919921875, obj_val: 9977.287109375, abs dis: 68.0048828125
[rfa agg] iter: 2, weight: tensor([1.7056e-04, 5.1798e-02, 2.0555e-02, 1.6201e-01, 1.9708e-02, 2.0199e-01,
        5.7404e-02, 1.1854e-01, 1.7053e-02, 3.5077e-01])
[rfa agg] iter:  3, prev_obj_val: 9977.287109375, obj_val: 9979.9951171875, abs dis: 2.7080078125
[rfa agg] iter: 3, weight: tensor([3.8505e-05, 2.7238e-02, 8.3610e-03, 4.6382e-01, 8.0151e-03, 1.9605e-01,
        3.1988e-02, 1.6616e-01, 6.7690e-03, 9.1554e-02])
[rfa agg] iter:  4, prev_obj_val: 9979.9951171875, obj_val: 9980.8037109375, abs dis: 0.80859375
[rfa agg] iter: 4, weight: tensor([4.3736e-05, 3.8135e-02, 1.0720e-02, 2.1899e-01, 1.0278e-02, 1.2994e-01,
        4.5882e-02, 4.5799e-01, 8.6199e-03, 7.9401e-02])
[rfa agg] iter:  5, prev_obj_val: 9980.8037109375, obj_val: 9985.810546875, abs dis: 5.0068359375
[rfa agg] iter: 5, weight: tensor([3.2764e-05, 3.0358e-02, 8.2999e-03, 1.3436e-01, 7.9557e-03, 8.7672e-02,
        3.6772e-02, 6.3162e-01, 6.6599e-03, 5.6270e-02])
[rfa agg] iter:  6, prev_obj_val: 9985.810546875, obj_val: 9987.5986328125, abs dis: 1.7880859375
[rfa agg] iter: 6, weight: tensor([5.8589e-05, 6.6553e-02, 1.6486e-02, 1.6295e-01, 1.5799e-02, 1.2140e-01,
        8.2998e-02, 4.3425e-01, 1.3137e-02, 8.6366e-02])
[rfa agg] iter:  7, prev_obj_val: 9987.5986328125, obj_val: 9985.77734375, abs dis: 1.8212890625
[rfa agg] iter: 7, weight: tensor([6.6748e-05, 8.2161e-02, 1.9511e-02, 1.6880e-01, 1.8699e-02, 1.2905e-01,
        1.0416e-01, 3.6802e-01, 1.5506e-02, 9.4030e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3488, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 4.8914, Accuracy: 34/9950 (0.3417%)
saving model
Done in 763.5996670722961 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0634, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0369, Accuracy: 317/953 (33.2634%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0874, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0539, Accuracy: 366/1446 (25.3112%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0338, Accuracy: 537/1446 (37.1369%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6386, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 182/500 (36.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.8267, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.0798, Accuracy: 71/460 (15.4348%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9936, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0532, Accuracy: 423/1475 (28.6780%)
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0295, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5001, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0829, Accuracy: 31/373 (8.3110%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0492, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.1357, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0623, Accuracy: 198/938 (21.1087%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3324, Accuracy: 80/10000 (0.8000%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1189, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3550, Accuracy: 61/10000 (0.6100%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0569, Accuracy: 430/1750 (24.5714%)
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 698/1750 (39.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7158, Accuracy: 121/10000 (1.2100%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.0730, Accuracy: 144/530 (27.1698%)
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8453, Accuracy: 61/10000 (0.6100%)
time spent on training: 196.62773609161377
[rfa agg] training data poison_ratio: 0.4512338425381904  data num: [953, 1446, 500, 460, 1475, 373, 938, 85, 1750, 530]
[rfa agg] considering poison per batch poison_fraction: 0.282021151586369
[rfa agg] init. name: [64, 26, 82, 31, 65, 98, 73, 61, 44, 18], weight: tensor([0.1120, 0.1699, 0.0588, 0.0541, 0.1733, 0.0438, 0.1102, 0.0100, 0.2056,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 64.45936584472656, obj_val: 68.42052459716797, abs dis: 3.9611587524414062
[rfa agg] iter: 0, weight: tensor([0.2973, 0.1150, 0.0306, 0.0282, 0.1016, 0.0185, 0.2897, 0.0031, 0.0792,
        0.0368])
[rfa agg] iter:  1, prev_obj_val: 68.42052459716797, obj_val: 70.59403991699219, abs dis: 2.1735153198242188
[rfa agg] iter: 1, weight: tensor([0.3897, 0.0539, 0.0245, 0.0225, 0.0492, 0.0140, 0.3722, 0.0022, 0.0413,
        0.0306])
[rfa agg] iter:  2, prev_obj_val: 70.59403991699219, obj_val: 72.914794921875, abs dis: 2.3207550048828125
[rfa agg] iter: 2, weight: tensor([0.3489, 0.0666, 0.0346, 0.0318, 0.0611, 0.0194, 0.3387, 0.0030, 0.0520,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 72.914794921875, obj_val: 70.59403991699219, abs dis: 2.3207550048828125
[rfa agg] iter: 3, weight: tensor([0.3074, 0.0782, 0.0467, 0.0430, 0.0721, 0.0256, 0.3006, 0.0038, 0.0622,
        0.0603])
[rfa agg] iter:  4, prev_obj_val: 70.59403991699219, obj_val: 72.91459655761719, abs dis: 2.320556640625
[rfa agg] iter: 4, weight: tensor([0.3471, 0.0673, 0.0350, 0.0322, 0.0617, 0.0196, 0.3373, 0.0030, 0.0525,
        0.0444])
[rfa agg] iter:  5, prev_obj_val: 72.91459655761719, obj_val: 70.59403991699219, abs dis: 2.320556640625
[rfa agg] iter: 5, weight: tensor([0.3073, 0.0782, 0.0467, 0.0430, 0.0721, 0.0256, 0.3006, 0.0038, 0.0622,
        0.0603])
[rfa agg] iter:  6, prev_obj_val: 70.59403991699219, obj_val: 72.91459655761719, abs dis: 2.320556640625
[rfa agg] iter: 6, weight: tensor([0.3471, 0.0673, 0.0350, 0.0322, 0.0617, 0.0196, 0.3373, 0.0030, 0.0525,
        0.0444])
[rfa agg] iter:  7, prev_obj_val: 72.91459655761719, obj_val: 70.59403991699219, abs dis: 2.320556640625
[rfa agg] iter: 7, weight: tensor([0.3073, 0.0782, 0.0467, 0.0430, 0.0721, 0.0256, 0.3006, 0.0038, 0.0622,
        0.0603])
[rfa agg] iter:  8, prev_obj_val: 70.59403991699219, obj_val: 72.91459655761719, abs dis: 2.320556640625
[rfa agg] iter: 8, weight: tensor([0.3471, 0.0673, 0.0350, 0.0322, 0.0617, 0.0196, 0.3373, 0.0030, 0.0525,
        0.0444])
[rfa agg] iter:  9, prev_obj_val: 72.91459655761719, obj_val: 70.59403991699219, abs dis: 2.320556640625
[rfa agg] iter: 9, weight: tensor([0.3073, 0.0782, 0.0467, 0.0430, 0.0721, 0.0256, 0.3006, 0.0038, 0.0622,
        0.0603])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3497, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 4.6298, Accuracy: 1397/9950 (14.0402%)
saving model
Done in 641.9422404766083 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0484, Accuracy: 481/861 (55.8653%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0275, Accuracy: 503/861 (58.4204%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0192, Accuracy: 553/861 (64.2276%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0180, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0184, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0179, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0181, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0174, Accuracy: 552/861 (64.1115%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0176, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0169, Accuracy: 553/861 (64.2276%), train_poison_data_count: 549
Global model norm: 112.01702315524413.
Norm before scaling: 112.00417647067898. Distance: 0.7853217258966437
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8652, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.4178, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 135.51973161222685, distance: 78.53217953588357
Total norm for 4 adversaries is: 135.51973161222685. distance: 78.53217953588357
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0522, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.4422, Accuracy: 73/10000 (0.7300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0519, Accuracy: 370/1372 (26.9679%)
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 542/1372 (39.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3708, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0439, Accuracy: 447/1036 (43.1467%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 684/1036 (66.0232%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.4304, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0697, Accuracy: 170/603 (28.1924%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0431, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7999, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0371, Accuracy: 236/682 (34.6041%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6450, Accuracy: 65/10000 (0.6500%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0526, Accuracy: 363/1130 (32.1239%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 495/1130 (43.8053%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.1767, Accuracy: 61/10000 (0.6100%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 52/416 (12.5000%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 188/416 (45.1923%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5591, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 527/1715 (30.7289%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0296, Accuracy: 813/1715 (47.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9018, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0809, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.8341, Accuracy: 50/10000 (0.5000%)
time spent on training: 293.48899960517883
[rfa agg] training data poison_ratio: 0.42758542656709664  data num: [861, 712, 1372, 1036, 603, 682, 1130, 416, 1715, 311]
[rfa agg] considering poison per batch poison_fraction: 0.2672408916044354
[rfa agg] init. name: [10, 11, 42, 19, 88, 80, 54, 78, 92, 96], weight: tensor([0.0974, 0.0806, 0.1552, 0.1172, 0.0682, 0.0772, 0.1279, 0.0471, 0.1940,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 10959.2431640625, obj_val: 6645.1572265625, abs dis: 4314.0859375
[rfa agg] iter: 0, weight: tensor([0.0115, 0.0875, 0.1711, 0.1282, 0.0739, 0.0837, 0.1401, 0.0507, 0.2155,
        0.0378])
[rfa agg] iter:  1, prev_obj_val: 6645.1572265625, obj_val: 6141.2197265625, abs dis: 503.9375
[rfa agg] iter: 1, weight: tensor([0.0012, 0.0825, 0.1805, 0.1276, 0.0682, 0.0781, 0.1410, 0.0455, 0.2421,
        0.0332])
[rfa agg] iter:  2, prev_obj_val: 6141.2197265625, obj_val: 6131.51806640625, abs dis: 9.70166015625
[rfa agg] iter: 2, weight: tensor([7.2616e-05, 3.4858e-02, 3.6493e-01, 8.6578e-02, 2.5318e-02, 3.0835e-02,
        1.0974e-01, 1.4391e-02, 3.2365e-01, 9.6279e-03])
[rfa agg] iter:  3, prev_obj_val: 6131.51806640625, obj_val: 6131.931640625, abs dis: 0.41357421875
[rfa agg] iter: 3, weight: tensor([5.9524e-05, 4.5566e-02, 2.5263e-01, 1.8970e-01, 3.0537e-02, 3.8587e-02,
        3.0684e-01, 1.6041e-02, 1.0969e-01, 1.0343e-02])
[rfa agg] iter:  4, prev_obj_val: 6131.931640625, obj_val: 6136.32958984375, abs dis: 4.39794921875
[rfa agg] iter: 4, weight: tensor([3.8103e-05, 4.3547e-02, 8.3511e-02, 4.5586e-01, 2.6506e-02, 3.4913e-02,
        2.8205e-01, 1.2833e-02, 5.2738e-02, 8.0015e-03])
[rfa agg] iter:  5, prev_obj_val: 6136.32958984375, obj_val: 6137.98193359375, abs dis: 1.65234375
[rfa agg] iter: 5, weight: tensor([6.2193e-05, 1.0033e-01, 1.0514e-01, 3.3115e-01, 5.4904e-02, 7.5510e-02,
        2.1844e-01, 2.4621e-02, 7.4916e-02, 1.4921e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3507, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 4.6397, Accuracy: 1342/9950 (13.4874%)
saving model
Done in 719.3349418640137 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0209, Accuracy: 481/677 (71.0487%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.3739, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0307, Accuracy: 398/1131 (35.1901%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4218, Accuracy: 60/10000 (0.6000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0554, Accuracy: 386/1657 (23.2951%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0331, Accuracy: 578/1657 (34.8823%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0758, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0608, Accuracy: 211/938 (22.4947%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0322, Accuracy: 347/938 (36.9936%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.7979, Accuracy: 62/10000 (0.6200%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1186, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3573, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 352/1213 (29.0190%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0263, Accuracy: 566/1213 (46.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.4047, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0596, Accuracy: 280/1402 (19.9715%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 413/1402 (29.4579%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8160, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.0889, Accuracy: 27/271 (9.9631%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0576, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8557, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0555, Accuracy: 302/928 (32.5431%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0222, Accuracy: 615/928 (66.2716%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.3642, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0429, Accuracy: 592/1470 (40.2721%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0225, Accuracy: 898/1470 (61.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.3533, Accuracy: 97/10000 (0.9700%)
time spent on training: 210.67120242118835
[rfa agg] training data poison_ratio: 0.17826442898076136  data num: [677, 1131, 1657, 938, 85, 1213, 1402, 271, 928, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.11141526811297585
[rfa agg] init. name: [90, 87, 0, 73, 61, 97, 66, 35, 1, 22], weight: tensor([0.0693, 0.1157, 0.1696, 0.0960, 0.0087, 0.1241, 0.1435, 0.0277, 0.0950,
        0.1504])
[rfa agg] iter:  0, prev_obj_val: 45.51582336425781, obj_val: 49.35253143310547, abs dis: 3.8367080688476562
[rfa agg] iter: 0, weight: tensor([0.0408, 0.2187, 0.0580, 0.1859, 0.0020, 0.1525, 0.0841, 0.0079, 0.1757,
        0.0746])
[rfa agg] iter:  1, prev_obj_val: 49.35253143310547, obj_val: 54.56006622314453, abs dis: 5.2075347900390625
[rfa agg] iter: 1, weight: tensor([0.0421, 0.1223, 0.0444, 0.3057, 0.0018, 0.0948, 0.0603, 0.0073, 0.2666,
        0.0548])
[rfa agg] iter:  2, prev_obj_val: 54.56006622314453, obj_val: 51.64349365234375, abs dis: 2.9165725708007812
[rfa agg] iter: 2, weight: tensor([0.0546, 0.0900, 0.0412, 0.3357, 0.0019, 0.0755, 0.0531, 0.0082, 0.2905,
        0.0492])
[rfa agg] iter:  3, prev_obj_val: 51.64349365234375, obj_val: 54.5574951171875, abs dis: 2.91400146484375
[rfa agg] iter: 3, weight: tensor([0.0401, 0.0868, 0.0360, 0.3693, 0.0016, 0.0707, 0.0476, 0.0065, 0.2977,
        0.0437])
[rfa agg] iter:  4, prev_obj_val: 54.5574951171875, obj_val: 51.64293670654297, abs dis: 2.9145584106445312
[rfa agg] iter: 4, weight: tensor([0.0537, 0.0883, 0.0405, 0.3426, 0.0019, 0.0742, 0.0523, 0.0080, 0.2901,
        0.0484])
[rfa agg] iter:  5, prev_obj_val: 51.64293670654297, obj_val: 54.5576057434082, abs dis: 2.9146690368652344
[rfa agg] iter: 5, weight: tensor([0.0401, 0.0866, 0.0359, 0.3716, 0.0016, 0.0705, 0.0475, 0.0065, 0.2961,
        0.0436])
[rfa agg] iter:  6, prev_obj_val: 54.5576057434082, obj_val: 51.64289855957031, abs dis: 2.9147071838378906
[rfa agg] iter: 6, weight: tensor([0.0537, 0.0883, 0.0405, 0.3434, 0.0019, 0.0742, 0.0523, 0.0080, 0.2894,
        0.0484])
[rfa agg] iter:  7, prev_obj_val: 51.64289855957031, obj_val: 54.55762481689453, abs dis: 2.9147262573242188
[rfa agg] iter: 7, weight: tensor([0.0400, 0.0866, 0.0359, 0.3721, 0.0016, 0.0705, 0.0475, 0.0065, 0.2958,
        0.0436])
[rfa agg] iter:  8, prev_obj_val: 54.55762481689453, obj_val: 51.642887115478516, abs dis: 2.9147377014160156
[rfa agg] iter: 8, weight: tensor([0.0537, 0.0883, 0.0405, 0.3435, 0.0019, 0.0742, 0.0523, 0.0080, 0.2893,
        0.0484])
[rfa agg] iter:  9, prev_obj_val: 51.642887115478516, obj_val: 54.5576286315918, abs dis: 2.9147415161132812
[rfa agg] iter: 9, weight: tensor([0.0400, 0.0866, 0.0359, 0.3721, 0.0016, 0.0705, 0.0475, 0.0065, 0.2957,
        0.0436])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3505, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 4.4738, Accuracy: 4122/9950 (41.4271%)
saving model
Done in 638.4308168888092 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Avg loss: 0.0702, Accuracy: 171/338 (50.5917%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Avg loss: 0.0385, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Avg loss: 0.0408, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Avg loss: 0.0401, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Avg loss: 0.0374, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Avg loss: 0.0343, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Avg loss: 0.0307, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Avg loss: 0.0286, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Avg loss: 0.0267, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Avg loss: 0.0277, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 112.0143859343522.
Norm before scaling: 112.0102316406296. Distance: 0.4705203639375706
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.0352, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.2344, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.02078043408495, distance: 47.052038076042734
Total norm for 5 adversaries is: 121.02078043408495. distance: 47.052038076042734
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0513, Accuracy: 360/1213 (29.6785%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 529/1213 (43.6109%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.1630, Accuracy: 101/10000 (1.0100%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 660/2227 (29.6363%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0270, Accuracy: 1056/2227 (47.4181%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2429, Accuracy: 124/10000 (1.2400%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0554, Accuracy: 316/599 (52.7546%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.4546, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0562, Accuracy: 386/1657 (23.2951%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0336, Accuracy: 567/1657 (34.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5283, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 203/669 (30.3438%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0381, Accuracy: 357/669 (53.3632%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.6728, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1224, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1081, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3746, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0413, Accuracy: 569/1552 (36.6624%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0200, Accuracy: 808/1552 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.3187, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0536, Accuracy: 313/928 (33.7284%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0224, Accuracy: 632/928 (68.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.1135, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0544, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.3897, Accuracy: 59/10000 (0.5900%)
time spent on training: 329.68191146850586
[rfa agg] training data poison_ratio: 0.6376826095657394  data num: [338, 1213, 2227, 599, 1657, 669, 134, 1552, 928, 677]
[rfa agg] considering poison per batch poison_fraction: 0.39855163097858715
[rfa agg] init. name: [12, 97, 60, 95, 0, 45, 47, 74, 1, 90], weight: tensor([0.0338, 0.1214, 0.2228, 0.0599, 0.1658, 0.0669, 0.0134, 0.1553, 0.0929,
        0.0677])
[rfa agg] iter:  0, prev_obj_val: 1717.852783203125, obj_val: 966.6354370117188, abs dis: 751.2173461914062
[rfa agg] iter: 0, weight: tensor([0.0012, 0.1201, 0.2616, 0.0545, 0.1761, 0.0614, 0.0115, 0.1632, 0.0884,
        0.0621])
[rfa agg] iter:  1, prev_obj_val: 966.6354370117188, obj_val: 968.1491088867188, abs dis: 1.513671875
[rfa agg] iter: 1, weight: tensor([3.2232e-05, 5.2506e-02, 6.6252e-02, 1.0955e-02, 4.2187e-01, 1.3074e-02,
        1.6893e-03, 3.9541e-01, 2.4982e-02, 1.3232e-02])
[rfa agg] iter:  2, prev_obj_val: 968.1491088867188, obj_val: 971.6581420898438, abs dis: 3.509033203125
[rfa agg] iter: 2, weight: tensor([6.1018e-05, 1.7948e-01, 9.5345e-02, 2.5702e-02, 2.4882e-01, 3.1170e-02,
        3.6916e-03, 3.1844e-01, 6.5750e-02, 3.1536e-02])
[rfa agg] iter:  3, prev_obj_val: 971.6581420898438, obj_val: 974.809326171875, abs dis: 3.15118408203125
[rfa agg] iter: 3, weight: tensor([5.4725e-05, 4.5649e-01, 7.1467e-02, 2.8825e-02, 1.3181e-01, 3.5724e-02,
        3.8012e-03, 1.4794e-01, 8.7743e-02, 3.6144e-02])
[rfa agg] iter:  4, prev_obj_val: 974.809326171875, obj_val: 976.50048828125, abs dis: 1.691162109375
[rfa agg] iter: 4, weight: tensor([4.0526e-05, 6.0595e-01, 4.8157e-02, 2.5101e-02, 7.8288e-02, 3.1717e-02,
        3.0886e-03, 8.4380e-02, 9.1195e-02, 3.2083e-02])
[rfa agg] iter:  5, prev_obj_val: 976.50048828125, obj_val: 980.0365600585938, abs dis: 3.53607177734375
[rfa agg] iter: 5, weight: tensor([5.0156e-05, 5.0349e-01, 5.7852e-02, 3.2973e-02, 9.0827e-02, 4.2000e-02,
        3.9497e-03, 9.6934e-02, 1.2944e-01, 4.2475e-02])
[rfa agg] iter:  6, prev_obj_val: 980.0365600585938, obj_val: 980.0059204101562, abs dis: 0.0306396484375
[rfa agg] iter: 6, weight: tensor([6.2080e-05, 3.2364e-01, 6.7678e-02, 4.6624e-02, 1.0020e-01, 6.0582e-02,
        5.2400e-03, 1.0539e-01, 2.2931e-01, 6.1273e-02])
[rfa agg] iter:  7, prev_obj_val: 980.0059204101562, obj_val: 978.2440185546875, abs dis: 1.76190185546875
[rfa agg] iter: 7, weight: tensor([6.2113e-05, 3.1633e-01, 6.7729e-02, 4.6690e-02, 1.0027e-01, 6.0698e-02,
        5.2442e-03, 1.0549e-01, 2.3605e-01, 6.1433e-02])
[rfa agg] iter:  8, prev_obj_val: 978.2440185546875, obj_val: 978.238037109375, abs dis: 0.0059814453125
[rfa agg] iter: 8, weight: tensor([5.9176e-05, 3.8687e-01, 6.6351e-02, 4.1536e-02, 1.0105e-01, 5.3428e-02,
        4.8234e-03, 1.0706e-01, 1.8474e-01, 5.4075e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3499, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 4.4846, Accuracy: 4220/9950 (42.4121%)
saving model
Done in 765.1420221328735 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0545, Accuracy: 331/677 (48.8922%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0212, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.3898, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0527, Accuracy: 241/735 (32.7891%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 370/735 (50.3401%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.2443, Accuracy: 72/10000 (0.7200%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0590, Accuracy: 340/1190 (28.5714%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0304, Accuracy: 471/1190 (39.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.1300, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0836, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2033, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 45/416 (10.8173%)
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0447, Accuracy: 200/416 (48.0769%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.7892, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 432/1904 (22.6891%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0306, Accuracy: 694/1904 (36.4496%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.4354, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 405/1573 (25.7470%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 608/1573 (38.6523%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6753, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0611, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0360, Accuracy: 452/1163 (38.8650%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6280, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0501, Accuracy: 406/1440 (28.1944%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 694/1440 (48.1944%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.0174, Accuracy: 84/10000 (0.8400%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0534, Accuracy: 322/599 (53.7563%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0287, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.6819, Accuracy: 50/10000 (0.5000%)
time spent on training: 217.5046467781067
[rfa agg] training data poison_ratio: 0.21896722939424032  data num: [677, 735, 1190, 373, 416, 1904, 1573, 1163, 1440, 599]
[rfa agg] considering poison per batch poison_fraction: 0.1368545183714002
[rfa agg] init. name: [90, 32, 84, 98, 78, 46, 40, 68, 29, 95], weight: tensor([0.0672, 0.0730, 0.1182, 0.0370, 0.0413, 0.1891, 0.1562, 0.1155, 0.1430,
        0.0595])
[rfa agg] iter:  0, prev_obj_val: 61.723533630371094, obj_val: 63.532955169677734, abs dis: 1.8094215393066406
[rfa agg] iter: 0, weight: tensor([0.0438, 0.0560, 0.2825, 0.0137, 0.0167, 0.0643, 0.0883, 0.2912, 0.1097,
        0.0337])
[rfa agg] iter:  1, prev_obj_val: 63.532955169677734, obj_val: 63.53175354003906, abs dis: 0.001201629638671875
[rfa agg] iter: 1, weight: tensor([0.0532, 0.0689, 0.2638, 0.0161, 0.0197, 0.0693, 0.0928, 0.2630, 0.1128,
        0.0404])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3486, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 4.4662, Accuracy: 4868/9950 (48.9246%)
saving model
Done in 647.6726195812225 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0455, Accuracy: 678/1154 (58.7522%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0248, Accuracy: 686/1154 (59.4454%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0210, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0206, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0209, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0202, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0199, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0200, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0197, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0193, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Global model norm: 112.01111656605785.
Norm before scaling: 111.99149835199545. Distance: 0.8469950122889066
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1180, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.4077, Accuracy: 9938/9950 (99.8794%)
Scaling by  100
Scaled Norm after poisoning: 138.5981855265429, distance: 84.69950041820643
Total norm for 5 adversaries is: 138.5981855265429. distance: 84.69950041820643
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0565, Accuracy: 424/1750 (24.2286%)
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 707/1750 (40.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7732, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0344, Accuracy: 373/1013 (36.8213%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0445, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0533, Accuracy: 405/1573 (25.7470%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 606/1573 (38.5251%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8805, Accuracy: 86/10000 (0.8600%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1189, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3553, Accuracy: 46/10000 (0.4600%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 76/515 (14.7573%)
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0479, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.9731, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0699, Accuracy: 175/603 (29.0216%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0429, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.8890, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0572, Accuracy: 239/938 (25.4797%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0315, Accuracy: 384/938 (40.9382%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.9964, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 416/1949 (21.3443%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 622/1949 (31.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6517, Accuracy: 71/10000 (0.7100%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0781, Accuracy: 86/486 (17.6955%)
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0375, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8640, Accuracy: 62/10000 (0.6200%)
time spent on training: 320.92351508140564
[rfa agg] training data poison_ratio: 0.3963838664812239  data num: [1154, 1750, 1013, 1573, 85, 515, 603, 938, 1949, 486]
[rfa agg] considering poison per batch poison_fraction: 0.24773991655076494
[rfa agg] init. name: [15, 44, 14, 40, 61, 33, 88, 73, 21, 30], weight: tensor([0.1146, 0.1739, 0.1006, 0.1563, 0.0084, 0.0512, 0.0599, 0.0932, 0.1936,
        0.0483])
[rfa agg] iter:  0, prev_obj_val: 17194.759765625, obj_val: 10779.875, abs dis: 6414.884765625
[rfa agg] iter: 0, weight: tensor([0.0165, 0.1942, 0.1112, 0.1741, 0.0092, 0.0562, 0.0658, 0.1029, 0.2169,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 10779.875, obj_val: 9845.921875, abs dis: 933.953125
[rfa agg] iter: 1, weight: tensor([0.0021, 0.2037, 0.1090, 0.1794, 0.0084, 0.0531, 0.0625, 0.1003, 0.2315,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 9845.921875, obj_val: 9774.8779296875, abs dis: 71.0439453125
[rfa agg] iter: 2, weight: tensor([2.0354e-04, 2.4270e-01, 7.0396e-02, 1.7462e-01, 3.7322e-03, 2.7715e-02,
        3.3533e-02, 6.2568e-02, 3.5920e-01, 2.5337e-02])
[rfa agg] iter:  3, prev_obj_val: 9774.8779296875, obj_val: 9777.9130859375, abs dis: 3.03515625
[rfa agg] iter: 3, weight: tensor([4.8562e-05, 1.9347e-01, 4.7300e-02, 5.5834e-01, 1.5060e-03, 1.3233e-02,
        1.6564e-02, 3.9170e-02, 1.1864e-01, 1.1734e-02])
[rfa agg] iter:  4, prev_obj_val: 9777.9130859375, obj_val: 9777.900390625, abs dis: 0.0126953125
[rfa agg] iter: 4, weight: tensor([7.0658e-05, 1.9901e-01, 8.3261e-02, 4.4104e-01, 2.3478e-03, 2.1310e-02,
        2.6873e-02, 6.7495e-02, 1.3981e-01, 1.8777e-02])
[rfa agg] iter:  5, prev_obj_val: 9777.900390625, obj_val: 9779.0947265625, abs dis: 1.1943359375
[rfa agg] iter: 5, weight: tensor([7.1112e-05, 2.0085e-01, 8.3927e-02, 4.3649e-01, 2.3631e-03, 2.1452e-02,
        2.7053e-02, 6.8008e-02, 1.4088e-01, 1.8902e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3487, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 4.4565, Accuracy: 5261/9950 (52.8744%)
saving model
Done in 758.2657685279846 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0556, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0335, Accuracy: 545/1657 (32.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.8856, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0618, Accuracy: 200/818 (24.4499%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0289, Accuracy: 403/818 (49.2665%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7345, Accuracy: 87/10000 (0.8700%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0583, Accuracy: 298/807 (36.9269%)
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 430/807 (53.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.5490, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 444/1953 (22.7343%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0324, Accuracy: 810/1953 (41.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1262, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4157, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 54/408 (13.2353%)
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0533, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.5038, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0604, Accuracy: 385/1163 (33.1040%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0358, Accuracy: 433/1163 (37.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3168, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0325, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3878, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0138, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0422, Accuracy: 412/1036 (39.7683%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0227, Accuracy: 688/1036 (66.4093%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 12.3118, Accuracy: 53/10000 (0.5300%)
time spent on training: 231.78608298301697
[rfa agg] training data poison_ratio: 0.30475382003395585  data num: [1657, 818, 807, 1953, 186, 408, 1163, 896, 500, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.1904711375212224
[rfa agg] init. name: [0, 71, 20, 83, 56, 36, 68, 89, 82, 19], weight: tensor([0.1758, 0.0868, 0.0856, 0.2072, 0.0197, 0.0433, 0.1234, 0.0951, 0.0531,
        0.1099])
[rfa agg] iter:  0, prev_obj_val: 62.805633544921875, obj_val: 65.43866729736328, abs dis: 2.6330337524414062
[rfa agg] iter: 0, weight: tensor([0.0579, 0.0635, 0.0624, 0.0439, 0.0042, 0.0129, 0.1703, 0.0913, 0.0175,
        0.4760])
[rfa agg] iter:  1, prev_obj_val: 65.43866729736328, obj_val: 67.67826080322266, abs dis: 2.239593505859375
[rfa agg] iter: 1, weight: tensor([0.0617, 0.1234, 0.1188, 0.0493, 0.0058, 0.0188, 0.1274, 0.2072, 0.0261,
        0.2614])
[rfa agg] iter:  2, prev_obj_val: 67.67826080322266, obj_val: 70.87222290039062, abs dis: 3.1939620971679688
[rfa agg] iter: 2, weight: tensor([0.0463, 0.1598, 0.1520, 0.0380, 0.0052, 0.0175, 0.0820, 0.3446, 0.0247,
        0.1300])
[rfa agg] iter:  3, prev_obj_val: 70.87222290039062, obj_val: 75.99343872070312, abs dis: 5.1212158203125
[rfa agg] iter: 3, weight: tensor([0.0337, 0.2408, 0.2222, 0.0284, 0.0045, 0.0160, 0.0534, 0.3039, 0.0231,
        0.0740])
[rfa agg] iter:  4, prev_obj_val: 75.99343872070312, obj_val: 79.1695327758789, abs dis: 3.1760940551757812
[rfa agg] iter: 4, weight: tensor([0.0369, 0.3009, 0.2811, 0.0317, 0.0059, 0.0223, 0.0535, 0.1661, 0.0332,
        0.0684])
[rfa agg] iter:  5, prev_obj_val: 79.1695327758789, obj_val: 75.96556854248047, abs dis: 3.2039642333984375
[rfa agg] iter: 5, weight: tensor([0.0450, 0.2705, 0.2584, 0.0391, 0.0079, 0.0310, 0.0629, 0.1598, 0.0472,
        0.0782])
[rfa agg] iter:  6, prev_obj_val: 75.96556854248047, obj_val: 79.17039489746094, abs dis: 3.2048263549804688
[rfa agg] iter: 6, weight: tensor([0.0360, 0.3115, 0.2855, 0.0310, 0.0057, 0.0217, 0.0521, 0.1572, 0.0324,
        0.0668])
[rfa agg] iter:  7, prev_obj_val: 79.17039489746094, obj_val: 75.96549987792969, abs dis: 3.20489501953125
[rfa agg] iter: 7, weight: tensor([0.0450, 0.2712, 0.2585, 0.0391, 0.0079, 0.0309, 0.0628, 0.1594, 0.0471,
        0.0781])
[rfa agg] iter:  8, prev_obj_val: 75.96549987792969, obj_val: 79.17040252685547, abs dis: 3.2049026489257812
[rfa agg] iter: 8, weight: tensor([0.0360, 0.3116, 0.2855, 0.0310, 0.0057, 0.0217, 0.0521, 0.1571, 0.0324,
        0.0668])
[rfa agg] iter:  9, prev_obj_val: 79.17040252685547, obj_val: 75.96549987792969, abs dis: 3.2049026489257812
[rfa agg] iter: 9, weight: tensor([0.0450, 0.2712, 0.2585, 0.0391, 0.0079, 0.0309, 0.0628, 0.1594, 0.0471,
        0.0781])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3488, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 4.4790, Accuracy: 4879/9950 (49.0352%)
saving model
Done in 664.0736074447632 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Avg loss: 0.0558, Accuracy: 293/530 (55.2830%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Avg loss: 0.0370, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Avg loss: 0.0266, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Avg loss: 0.0249, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Avg loss: 0.0244, Accuracy: 336/530 (63.3962%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Avg loss: 0.0233, Accuracy: 337/530 (63.5849%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Avg loss: 0.0234, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Avg loss: 0.0216, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Avg loss: 0.0231, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Avg loss: 0.0226, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Global model norm: 112.00787325842322.
Norm before scaling: 112.00060163063857. Distance: 0.6013365977809092
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6922, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.3455, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 126.3438041058504, distance: 60.133662561387986
Total norm for 3 adversaries is: 126.3438041058504. distance: 60.133662561387986
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4238, Accuracy: 79/10000 (0.7900%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0491, Accuracy: 373/1628 (22.9115%)
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0246, Accuracy: 905/1628 (55.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.7651, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0427, Accuracy: 594/1470 (40.4082%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0222, Accuracy: 904/1470 (61.4966%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.1449, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0590, Accuracy: 270/1131 (23.8727%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0292, Accuracy: 501/1131 (44.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4743, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0566, Accuracy: 262/938 (27.9318%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0317, Accuracy: 363/938 (38.6994%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.9110, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 403/1904 (21.1660%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0306, Accuracy: 741/1904 (38.9181%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1032, Accuracy: 113/10000 (1.1300%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0584, Accuracy: 320/807 (39.6530%)
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0313, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.4474, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 451/1953 (23.0927%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0326, Accuracy: 828/1953 (42.3963%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2296, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0689, Accuracy: 176/603 (29.1874%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0429, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1763, Accuracy: 61/10000 (0.6100%)
time spent on training: 336.7329001426697
[rfa agg] training data poison_ratio: 0.25255536626916525  data num: [530, 776, 1628, 1470, 1131, 938, 1904, 807, 1953, 603]
[rfa agg] considering poison per batch poison_fraction: 0.1578471039182283
[rfa agg] init. name: [18, 75, 5, 22, 38, 73, 46, 20, 83, 88], weight: tensor([0.0451, 0.0661, 0.1387, 0.1252, 0.0963, 0.0799, 0.1622, 0.0687, 0.1664,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 3433.81640625, obj_val: 1874.60595703125, abs dis: 1559.21044921875
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0658, 0.1471, 0.1308, 0.0982, 0.0803, 0.1756, 0.0684, 0.1811,
        0.0504])
[rfa agg] iter:  1, prev_obj_val: 1874.60595703125, obj_val: 1864.455322265625, abs dis: 10.150634765625
[rfa agg] iter: 1, weight: tensor([2.6046e-05, 9.7321e-03, 7.8301e-02, 4.2709e-02, 1.9830e-02, 1.3276e-02,
        3.7855e-01, 1.0118e-02, 4.4100e-01, 6.4585e-03])
[rfa agg] iter:  2, prev_obj_val: 1864.455322265625, obj_val: 1862.8309326171875, abs dis: 1.6243896484375
[rfa agg] iter: 2, weight: tensor([3.9551e-05, 1.8467e-02, 4.0008e-01, 1.1794e-01, 4.1669e-02, 2.6014e-02,
        2.0423e-01, 1.9191e-02, 1.6055e-01, 1.1828e-02])
[rfa agg] iter:  3, prev_obj_val: 1862.8309326171875, obj_val: 1866.1710205078125, abs dis: 3.340087890625
[rfa agg] iter: 3, weight: tensor([3.9012e-05, 2.4275e-02, 2.0953e-01, 4.4269e-01, 6.6682e-02, 3.6172e-02,
        9.5516e-02, 2.5222e-02, 8.5182e-02, 1.4698e-02])
[rfa agg] iter:  4, prev_obj_val: 1866.1710205078125, obj_val: 1869.822021484375, abs dis: 3.6510009765625
[rfa agg] iter: 4, weight: tensor([4.9617e-05, 3.8090e-02, 1.4951e-01, 3.8183e-01, 1.3019e-01, 5.9979e-02,
        9.3126e-02, 3.9572e-02, 8.5703e-02, 2.1946e-02])
[rfa agg] iter:  5, prev_obj_val: 1869.822021484375, obj_val: 1872.3154296875, abs dis: 2.493408203125
[rfa agg] iter: 5, weight: tensor([5.6385e-05, 5.2510e-02, 1.2820e-01, 2.2817e-01, 2.4509e-01, 8.8264e-02,
        9.0212e-02, 5.4522e-02, 8.4292e-02, 2.8684e-02])
[rfa agg] iter:  6, prev_obj_val: 1872.3154296875, obj_val: 1875.1136474609375, abs dis: 2.7982177734375
[rfa agg] iter: 6, weight: tensor([4.9500e-05, 5.3752e-02, 9.6707e-02, 1.5061e-01, 3.7870e-01, 9.6429e-02,
        7.2097e-02, 5.5765e-02, 6.7914e-02, 2.7982e-02])
[rfa agg] iter:  7, prev_obj_val: 1875.1136474609375, obj_val: 1878.9615478515625, abs dis: 3.847900390625
[rfa agg] iter: 7, weight: tensor([3.5123e-05, 4.5643e-02, 6.0101e-02, 8.5814e-02, 5.5742e-01, 8.9934e-02,
        4.6925e-02, 4.7294e-02, 4.4509e-02, 2.2324e-02])
[rfa agg] iter:  8, prev_obj_val: 1878.9615478515625, obj_val: 1881.0126953125, abs dis: 2.0511474609375
[rfa agg] iter: 8, weight: tensor([4.4555e-05, 7.1819e-02, 6.7791e-02, 9.0889e-02, 3.9274e-01, 1.6275e-01,
        5.4963e-02, 7.4255e-02, 5.2444e-02, 3.2306e-02])
[rfa agg] iter:  9, prev_obj_val: 1881.0126953125, obj_val: 1881.0010986328125, abs dis: 0.0115966796875
[rfa agg] iter: 9, weight: tensor([4.7847e-05, 8.8062e-02, 6.9057e-02, 9.0469e-02, 2.8509e-01, 2.2773e-01,
        5.6883e-02, 9.0869e-02, 5.4404e-02, 3.7389e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3496, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 4.3799, Accuracy: 6043/9950 (60.7337%)
saving model
Done in 755.3680114746094 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0425, Accuracy: 471/1036 (45.4633%)
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 703/1036 (67.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.5935, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0650, Accuracy: 206/605 (34.0496%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0378, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0579, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0496, Accuracy: 371/1213 (30.5853%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0263, Accuracy: 540/1213 (44.5177%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0821, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0557, Accuracy: 259/938 (27.6119%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0310, Accuracy: 380/938 (40.5117%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.2659, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0487, Accuracy: 428/1628 (26.2899%)
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0244, Accuracy: 894/1628 (54.9140%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.3832, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0563, Accuracy: 282/1049 (26.8827%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0283, Accuracy: 543/1049 (51.7636%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2763, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0522, Accuracy: 457/1949 (23.4479%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 646/1949 (33.1452%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7247, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0532, Accuracy: 269/888 (30.2928%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0246, Accuracy: 481/888 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.1036, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0244, Accuracy: 444/712 (62.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5470, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0530, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0212, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.2436, Accuracy: 61/10000 (0.6100%)
time spent on training: 218.60303497314453
[rfa agg] training data poison_ratio: 0.1522206638616176  data num: [1036, 605, 1213, 938, 1628, 1049, 1949, 888, 712, 677]
[rfa agg] considering poison per batch poison_fraction: 0.09513791491351099
[rfa agg] init. name: [19, 2, 97, 73, 5, 51, 21, 63, 11, 90], weight: tensor([0.0969, 0.0566, 0.1134, 0.0877, 0.1522, 0.0981, 0.1822, 0.0830, 0.0666,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 52.685245513916016, obj_val: 59.108123779296875, abs dis: 6.422878265380859
[rfa agg] iter: 0, weight: tensor([0.2886, 0.0198, 0.1768, 0.0886, 0.0469, 0.2260, 0.0354, 0.0609, 0.0316,
        0.0255])
[rfa agg] iter:  1, prev_obj_val: 59.108123779296875, obj_val: 66.39188385009766, abs dis: 7.283760070800781
[rfa agg] iter: 1, weight: tensor([0.1017, 0.0337, 0.0674, 0.2748, 0.0357, 0.0999, 0.0298, 0.2393, 0.0693,
        0.0483])
[rfa agg] iter:  2, prev_obj_val: 66.39188385009766, obj_val: 66.36882781982422, abs dis: 0.0230560302734375
[rfa agg] iter: 2, weight: tensor([0.0781, 0.0606, 0.0613, 0.1387, 0.0382, 0.0778, 0.0331, 0.2319, 0.1810,
        0.0991])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3519, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 4.3299, Accuracy: 6088/9950 (61.1859%)
saving model
Done in 650.0898406505585 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Avg loss: 0.0453, Accuracy: 483/807 (59.8513%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Avg loss: 0.0281, Accuracy: 453/807 (56.1338%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Avg loss: 0.0232, Accuracy: 516/807 (63.9405%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Avg loss: 0.0221, Accuracy: 517/807 (64.0644%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Avg loss: 0.0220, Accuracy: 515/807 (63.8166%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Avg loss: 0.0213, Accuracy: 516/807 (63.9405%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Avg loss: 0.0215, Accuracy: 517/807 (64.0644%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Avg loss: 0.0209, Accuracy: 521/807 (64.5601%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Avg loss: 0.0201, Accuracy: 522/807 (64.6840%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Avg loss: 0.0204, Accuracy: 520/807 (64.4362%), train_poison_data_count: 519
Global model norm: 112.00520094648508.
Norm before scaling: 111.99271478119682. Distance: 0.6680335520938292
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5443, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 0.3869, Accuracy: 9927/9950 (99.7688%)
Scaling by  100
Scaled Norm after poisoning: 129.16579552797637, distance: 66.80335677615685
Total norm for 4 adversaries is: 129.16579552797637. distance: 66.80335677615685
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0609, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0376, Accuracy: 438/1402 (31.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2538, Accuracy: 67/10000 (0.6700%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0718, Accuracy: 139/530 (26.2264%)
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 294/530 (55.4717%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2925, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0609, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0361, Accuracy: 324/953 (33.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8195, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0507, Accuracy: 361/1340 (26.9403%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0264, Accuracy: 602/1340 (44.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.5404, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0565, Accuracy: 278/1049 (26.5014%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0277, Accuracy: 555/1049 (52.9075%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.5475, Accuracy: 94/10000 (0.9400%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0537, Accuracy: 422/1475 (28.6102%)
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0292, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8790, Accuracy: 111/10000 (1.1100%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0633, Accuracy: 155/781 (19.8464%)
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0330, Accuracy: 273/781 (34.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3807, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0499, Accuracy: 439/1574 (27.8907%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0260, Accuracy: 742/1574 (47.1410%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4437, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0601, Accuracy: 179/809 (22.1261%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0252, Accuracy: 399/809 (49.3201%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.5466, Accuracy: 121/10000 (1.2100%)
time spent on training: 354.03820419311523
[rfa agg] training data poison_ratio: 0.3351679104477612  data num: [807, 1402, 530, 953, 1340, 1049, 1475, 781, 1574, 809]
[rfa agg] considering poison per batch poison_fraction: 0.20947994402985073
[rfa agg] init. name: [20, 66, 18, 64, 77, 51, 65, 3, 17, 50], weight: tensor([0.0753, 0.1308, 0.0494, 0.0889, 0.1250, 0.0979, 0.1376, 0.0729, 0.1468,
        0.0755])
[rfa agg] iter:  0, prev_obj_val: 8047.24462890625, obj_val: 4665.93603515625, abs dis: 3381.30859375
[rfa agg] iter: 0, weight: tensor([0.0065, 0.1413, 0.0520, 0.0947, 0.1348, 0.1046, 0.1493, 0.0773, 0.1596,
        0.0800])
[rfa agg] iter:  1, prev_obj_val: 4665.93603515625, obj_val: 4400.4248046875, abs dis: 265.51123046875
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1495, 0.0418, 0.0854, 0.1391, 0.0985, 0.1662, 0.0670, 0.1826,
        0.0694])
[rfa agg] iter:  2, prev_obj_val: 4400.4248046875, obj_val: 4405.66796875, abs dis: 5.2431640625
[rfa agg] iter: 2, weight: tensor([3.9607e-05, 2.0597e-01, 1.5305e-02, 5.9761e-02, 3.2916e-01, 1.0545e-01,
        1.1366e-01, 3.5316e-02, 9.8782e-02, 3.6557e-02])
[rfa agg] iter:  3, prev_obj_val: 4405.66796875, obj_val: 4412.3251953125, abs dis: 6.6572265625
[rfa agg] iter: 3, weight: tensor([4.4348e-05, 1.0926e-01, 2.2160e-02, 1.2885e-01, 1.3420e-01, 3.2747e-01,
        7.9752e-02, 6.1039e-02, 7.4154e-02, 6.3075e-02])
[rfa agg] iter:  4, prev_obj_val: 4412.3251953125, obj_val: 4416.82763671875, abs dis: 4.50244140625
[rfa agg] iter: 4, weight: tensor([4.0366e-05, 6.9291e-02, 2.6330e-02, 3.1730e-01, 7.8152e-02, 2.0257e-01,
        5.5820e-02, 9.7352e-02, 5.3463e-02, 9.9677e-02])
[rfa agg] iter:  5, prev_obj_val: 4416.82763671875, obj_val: 4419.47119140625, abs dis: 2.6435546875
[rfa agg] iter: 5, weight: tensor([3.7541e-05, 5.6001e-02, 2.8918e-02, 3.5554e-01, 6.1725e-02, 1.1884e-01,
        4.6498e-02, 1.4253e-01, 4.5033e-02, 1.4488e-01])
[rfa agg] iter:  6, prev_obj_val: 4419.47119140625, obj_val: 4419.455078125, abs dis: 0.01611328125
[rfa agg] iter: 6, weight: tensor([3.8675e-05, 5.4142e-02, 3.2747e-02, 2.5584e-01, 5.9113e-02, 1.0293e-01,
        4.5529e-02, 2.0148e-01, 4.4304e-02, 2.0387e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3542, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 4.2605, Accuracy: 7017/9950 (70.5226%)
saving model
Done in 783.736649274826 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0694, Accuracy: 162/603 (26.8657%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0431, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5580, Accuracy: 53/10000 (0.5300%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0563, Accuracy: 321/1241 (25.8662%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 492/1241 (39.6454%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5859, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0507, Accuracy: 361/1340 (26.9403%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 533/1340 (39.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.9532, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0573, Accuracy: 289/1131 (25.5526%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0283, Accuracy: 527/1131 (46.5959%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2616, Accuracy: 112/10000 (1.1200%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0579, Accuracy: 304/807 (37.6704%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0308, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3583, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0503, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0245, Accuracy: 551/1013 (54.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5786, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0545, Accuracy: 435/1418 (30.6770%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0281, Accuracy: 718/1418 (50.6347%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3650, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0522, Accuracy: 324/928 (34.9138%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0227, Accuracy: 616/928 (66.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.7500, Accuracy: 111/10000 (1.1100%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0485, Accuracy: 505/1129 (44.7298%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0221, Accuracy: 780/1129 (69.0877%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.2178, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0535, Accuracy: 425/1956 (21.7280%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0304, Accuracy: 710/1956 (36.2986%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4750, Accuracy: 129/10000 (1.2900%)
time spent on training: 255.71088123321533
[rfa agg] training data poison_ratio: 0.2746844198512883  data num: [603, 1241, 1340, 1131, 807, 1013, 1418, 928, 1129, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.17167776240705518
[rfa agg] init. name: [88, 72, 77, 38, 20, 39, 70, 1, 37, 6], weight: tensor([0.0521, 0.1073, 0.1159, 0.0978, 0.0698, 0.0876, 0.1226, 0.0802, 0.0976,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 44.13093566894531, obj_val: 52.12018585205078, abs dis: 7.989250183105469
[rfa agg] iter: 0, weight: tensor([0.0170, 0.0990, 0.0791, 0.2622, 0.0375, 0.1300, 0.0540, 0.0747, 0.2160,
        0.0306])
[rfa agg] iter:  1, prev_obj_val: 52.12018585205078, obj_val: 57.89365005493164, abs dis: 5.773464202880859
[rfa agg] iter: 1, weight: tensor([0.0257, 0.0637, 0.0567, 0.1034, 0.0724, 0.2875, 0.0443, 0.2160, 0.1007,
        0.0297])
[rfa agg] iter:  2, prev_obj_val: 57.89365005493164, obj_val: 54.79738998413086, abs dis: 3.0962600708007812
[rfa agg] iter: 2, weight: tensor([0.0366, 0.0614, 0.0564, 0.0872, 0.1320, 0.1750, 0.0458, 0.2872, 0.0858,
        0.0327])
[rfa agg] iter:  3, prev_obj_val: 54.79738998413086, obj_val: 57.875709533691406, abs dis: 3.078319549560547
[rfa agg] iter: 3, weight: tensor([0.0282, 0.0576, 0.0522, 0.0861, 0.0895, 0.2007, 0.0416, 0.3308, 0.0844,
        0.0288])
[rfa agg] iter:  4, prev_obj_val: 57.875709533691406, obj_val: 57.872867584228516, abs dis: 0.002841949462890625
[rfa agg] iter: 4, weight: tensor([0.0356, 0.0596, 0.0548, 0.0846, 0.1282, 0.1665, 0.0445, 0.3112, 0.0832,
        0.0318])
[rfa agg] iter:  5, prev_obj_val: 57.872867584228516, obj_val: 54.79566955566406, abs dis: 3.077198028564453
[rfa agg] iter: 5, weight: tensor([0.0357, 0.0599, 0.0550, 0.0849, 0.1301, 0.1665, 0.0447, 0.3078, 0.0836,
        0.0319])
[rfa agg] iter:  6, prev_obj_val: 54.79566955566406, obj_val: 54.791404724121094, abs dis: 0.00426483154296875
[rfa agg] iter: 6, weight: tensor([0.0280, 0.0571, 0.0518, 0.0854, 0.0887, 0.1979, 0.0412, 0.3378, 0.0836,
        0.0286])
[rfa agg] iter:  7, prev_obj_val: 54.791404724121094, obj_val: 57.87664031982422, abs dis: 3.085235595703125
[rfa agg] iter: 7, weight: tensor([0.0276, 0.0562, 0.0510, 0.0841, 0.0868, 0.1963, 0.0406, 0.3467, 0.0824,
        0.0282])
[rfa agg] iter:  8, prev_obj_val: 57.87664031982422, obj_val: 57.87290954589844, abs dis: 0.00373077392578125
[rfa agg] iter: 8, weight: tensor([0.0354, 0.0593, 0.0546, 0.0842, 0.1275, 0.1656, 0.0443, 0.3146, 0.0829,
        0.0316])
[rfa agg] iter:  9, prev_obj_val: 57.87290954589844, obj_val: 54.79560852050781, abs dis: 3.077301025390625
[rfa agg] iter: 9, weight: tensor([0.0357, 0.0598, 0.0550, 0.0848, 0.1299, 0.1663, 0.0446, 0.3085, 0.0835,
        0.0319])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3541, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 4.3014, Accuracy: 6312/9950 (63.4372%)
saving model
Done in 718.4050569534302 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Avg loss: 0.0663, Accuracy: 156/312 (50.0000%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Avg loss: 0.0372, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Avg loss: 0.0347, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Avg loss: 0.0336, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Avg loss: 0.0317, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Avg loss: 0.0293, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Avg loss: 0.0260, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Avg loss: 0.0247, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Avg loss: 0.0237, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Avg loss: 0.0243, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Global model norm: 112.00266807647932.
Norm before scaling: 111.99987356996212. Distance: 0.4335442763962931
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9032, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 0.3237, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 119.76152247539692, distance: 43.35442820880584
Total norm for 3 adversaries is: 119.76152247539692. distance: 43.35442820880584
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0602, Accuracy: 324/803 (40.3487%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9520, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0507, Accuracy: 283/888 (31.8694%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0242, Accuracy: 498/888 (56.0811%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.8848, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0682, Accuracy: 165/603 (27.3632%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0431, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.2917, Accuracy: 53/10000 (0.5300%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0486, Accuracy: 382/1275 (29.9608%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0182, Accuracy: 741/1275 (58.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.3846, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0544, Accuracy: 347/1049 (33.0791%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0277, Accuracy: 550/1049 (52.4309%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3544, Accuracy: 116/10000 (1.1600%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0521, Accuracy: 358/1130 (31.6814%)
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0277, Accuracy: 503/1130 (44.5133%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.6473, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0596, Accuracy: 211/953 (22.1406%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0356, Accuracy: 340/953 (35.6768%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6827, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0527, Accuracy: 436/1645 (26.5046%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0305, Accuracy: 723/1645 (43.9514%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.9802, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 457/1587 (28.7965%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 620/1587 (39.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2315, Accuracy: 69/10000 (0.6900%)
time spent on training: 326.5381646156311
[rfa agg] training data poison_ratio: 0.2652025378233285  data num: [312, 803, 888, 603, 1275, 1049, 1130, 953, 1645, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.1657515861395803
[rfa agg] init. name: [24, 58, 63, 88, 9, 51, 54, 64, 13, 27], weight: tensor([0.0305, 0.0784, 0.0867, 0.0589, 0.1245, 0.1024, 0.1103, 0.0930, 0.1606,
        0.1549])
[rfa agg] iter:  0, prev_obj_val: 1288.9404296875, obj_val: 716.0366821289062, abs dis: 572.9037475585938
[rfa agg] iter: 0, weight: tensor([0.0009, 0.0742, 0.0831, 0.0537, 0.1293, 0.1021, 0.1115, 0.0904, 0.1819,
        0.1729])
[rfa agg] iter:  1, prev_obj_val: 716.0366821289062, obj_val: 718.3750610351562, abs dis: 2.33837890625
[rfa agg] iter: 1, weight: tensor([3.6912e-05, 3.6062e-02, 4.7030e-02, 1.8593e-02, 3.8353e-01, 1.1519e-01,
        1.8067e-01, 6.1445e-02, 7.3511e-02, 8.3932e-02])
[rfa agg] iter:  2, prev_obj_val: 718.3750610351562, obj_val: 723.2953491210938, abs dis: 4.9202880859375
[rfa agg] iter: 2, weight: tensor([3.5418e-05, 6.3330e-02, 9.5752e-02, 2.6018e-02, 1.0119e-01, 2.7625e-01,
        1.7508e-01, 1.6147e-01, 4.8493e-02, 5.2371e-02])
[rfa agg] iter:  3, prev_obj_val: 723.2953491210938, obj_val: 731.0865478515625, abs dis: 7.79119873046875
[rfa agg] iter: 3, weight: tensor([3.1035e-05, 9.3450e-02, 1.7653e-01, 2.9554e-02, 6.2179e-02, 1.2057e-01,
        8.8279e-02, 3.5352e-01, 3.6798e-02, 3.9096e-02])
[rfa agg] iter:  4, prev_obj_val: 731.0865478515625, obj_val: 737.9968872070312, abs dis: 6.91033935546875
[rfa agg] iter: 4, weight: tensor([3.2487e-05, 2.5838e-01, 2.8295e-01, 4.3940e-02, 5.0381e-02, 7.4814e-02,
        6.3235e-02, 1.5668e-01, 3.3946e-02, 3.5640e-02])
[rfa agg] iter:  5, prev_obj_val: 737.9968872070312, obj_val: 731.0269165039062, abs dis: 6.969970703125
[rfa agg] iter: 5, weight: tensor([3.9975e-05, 3.5927e-01, 1.7800e-01, 7.5155e-02, 5.3837e-02, 7.2383e-02,
        6.4287e-02, 1.1793e-01, 3.8712e-02, 4.0378e-02])
[rfa agg] iter:  6, prev_obj_val: 731.0269165039062, obj_val: 737.992431640625, abs dis: 6.96551513671875
[rfa agg] iter: 6, weight: tensor([3.0593e-05, 2.9728e-01, 2.7620e-01, 4.1579e-02, 4.7415e-02, 6.9976e-02,
        5.9604e-02, 1.4240e-01, 3.1961e-02, 3.3561e-02])
[rfa agg] iter:  7, prev_obj_val: 737.992431640625, obj_val: 734.3089599609375, abs dis: 3.6834716796875
[rfa agg] iter: 7, weight: tensor([3.9618e-05, 3.6536e-01, 1.7617e-01, 7.4517e-02, 5.3353e-02, 7.1697e-02,
        6.3711e-02, 1.1677e-01, 3.8365e-02, 4.0017e-02])
[rfa agg] iter:  8, prev_obj_val: 734.3089599609375, obj_val: 737.98486328125, abs dis: 3.6759033203125
[rfa agg] iter: 8, weight: tensor([2.9757e-05, 4.4845e-01, 1.8020e-01, 4.7018e-02, 4.2886e-02, 6.0154e-02,
        5.2452e-02, 1.0761e-01, 2.9907e-02, 3.1297e-02])
[rfa agg] iter:  9, prev_obj_val: 737.98486328125, obj_val: 734.3059692382812, abs dis: 3.67889404296875
[rfa agg] iter: 9, weight: tensor([3.8180e-05, 3.9180e-01, 1.6672e-01, 7.1896e-02, 5.1403e-02, 6.8987e-02,
        6.1393e-02, 1.1224e-01, 3.6962e-02, 3.8561e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3552, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 4.2907, Accuracy: 5776/9950 (58.0503%)
saving model
Done in 797.1896226406097 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0524, Accuracy: 409/1573 (26.0013%)
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0334, Accuracy: 639/1573 (40.6230%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3601, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0682, Accuracy: 178/603 (29.5191%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0445, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.4978, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0597, Accuracy: 255/1402 (18.1883%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0376, Accuracy: 433/1402 (30.8845%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1062, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1228, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1086, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3695, Accuracy: 55/10000 (0.5500%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1191, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3591, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.0818, Accuracy: 23/311 (7.3955%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.8953, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0624, Accuracy: 155/781 (19.8464%)
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0322, Accuracy: 289/781 (37.0038%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0548, Accuracy: 105/10000 (1.0500%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0482, Accuracy: 445/1628 (27.3342%)
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0242, Accuracy: 871/1628 (53.5012%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.0343, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0341, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4167, Accuracy: 66/10000 (0.6600%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0781, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0402, Accuracy: 174/312 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4924, Accuracy: 50/10000 (0.5000%)
time spent on training: 261.7087321281433
[rfa agg] training data poison_ratio: 0.372296669762505  data num: [1573, 603, 1402, 134, 85, 311, 781, 1628, 708, 312]
[rfa agg] considering poison per batch poison_fraction: 0.2326854186015656
[rfa agg] init. name: [40, 88, 66, 47, 61, 96, 3, 5, 16, 24], weight: tensor([0.2087, 0.0800, 0.1860, 0.0178, 0.0113, 0.0413, 0.1036, 0.2160, 0.0939,
        0.0414])
[rfa agg] iter:  0, prev_obj_val: 66.53392028808594, obj_val: 67.5108871459961, abs dis: 0.9769668579101562
[rfa agg] iter: 0, weight: tensor([0.1718, 0.0754, 0.2434, 0.0084, 0.0050, 0.0227, 0.1696, 0.1578, 0.1230,
        0.0228])
[rfa agg] iter:  1, prev_obj_val: 67.5108871459961, obj_val: 67.51024627685547, abs dis: 0.000640869140625
[rfa agg] iter: 1, weight: tensor([0.1608, 0.0807, 0.2207, 0.0087, 0.0051, 0.0236, 0.1925, 0.1486, 0.1357,
        0.0237])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3556, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 4.3293, Accuracy: 4793/9950 (48.1709%)
saving model
Saving model on epoch 40
Done in 710.8209948539734 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0493, Accuracy: 389/690 (56.3768%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 366/690 (53.0435%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Avg loss: 0.0215, Accuracy: 357/690 (51.7391%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Avg loss: 0.0202, Accuracy: 444/690 (64.3478%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Avg loss: 0.0205, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Avg loss: 0.0185, Accuracy: 441/690 (63.9130%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Avg loss: 0.0179, Accuracy: 444/690 (64.3478%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Avg loss: 0.0177, Accuracy: 432/690 (62.6087%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Avg loss: 0.0181, Accuracy: 442/690 (64.0580%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Avg loss: 0.0176, Accuracy: 439/690 (63.6232%), train_poison_data_count: 440
Global model norm: 112.0000435965317.
Norm before scaling: 111.99049119093772. Distance: 0.6846933512783699
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3613, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.3793, Accuracy: 9858/9950 (99.0754%)
Scaling by  100
Scaled Norm after poisoning: 130.27324048898146, distance: 68.46933834183554
Total norm for 4 adversaries is: 130.27324048898146. distance: 68.46933834183554
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 57/408 (13.9706%)
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0518, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.8883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 67/500 (13.4000%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 202/500 (40.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1298, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0659, Accuracy: 201/605 (33.2231%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0379, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7699, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0533, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0306, Accuracy: 737/1742 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4148, Accuracy: 89/10000 (0.8900%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 376/1372 (27.4052%)
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0296, Accuracy: 590/1372 (43.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0434, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0593, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0374, Accuracy: 438/1402 (31.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6418, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 377/1662 (22.6835%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0316, Accuracy: 673/1662 (40.4934%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1814, Accuracy: 129/10000 (1.2900%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0558, Accuracy: 415/1750 (23.7143%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0341, Accuracy: 706/1750 (40.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6034, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0564, Accuracy: 309/1131 (27.3210%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0284, Accuracy: 526/1131 (46.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3088, Accuracy: 106/10000 (1.0600%)
time spent on training: 378.8672077655792
[rfa agg] training data poison_ratio: 0.37471141893091814  data num: [690, 408, 500, 605, 1742, 1372, 1402, 1662, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.23419463683182384
[rfa agg] init. name: [25, 36, 82, 2, 93, 42, 66, 94, 44, 38], weight: tensor([0.0613, 0.0362, 0.0444, 0.0537, 0.1547, 0.1218, 0.1245, 0.1476, 0.1554,
        0.1004])
[rfa agg] iter:  0, prev_obj_val: 5613.97119140625, obj_val: 3165.154296875, abs dis: 2448.81689453125
[rfa agg] iter: 0, weight: tensor([0.0042, 0.0367, 0.0451, 0.0549, 0.1669, 0.1291, 0.1319, 0.1583, 0.1677,
        0.1051])
[rfa agg] iter:  1, prev_obj_val: 3165.154296875, obj_val: 3045.233154296875, abs dis: 119.921142578125
[rfa agg] iter: 1, weight: tensor([0.0002, 0.0206, 0.0259, 0.0333, 0.2103, 0.1184, 0.1210, 0.1771, 0.2111,
        0.0820])
[rfa agg] iter:  2, prev_obj_val: 3045.233154296875, obj_val: 3047.523193359375, abs dis: 2.2900390625
[rfa agg] iter: 2, weight: tensor([2.8818e-05, 6.0180e-03, 7.8838e-03, 1.1059e-02, 7.1650e-02, 3.3596e-01,
        3.3350e-01, 1.0562e-01, 7.1750e-02, 5.6536e-02])
[rfa agg] iter:  3, prev_obj_val: 3047.523193359375, obj_val: 3051.87158203125, abs dis: 4.348388671875
[rfa agg] iter: 3, weight: tensor([2.6423e-05, 5.8977e-03, 7.7626e-03, 1.1018e-02, 5.5614e-02, 3.5891e-01,
        3.6359e-01, 7.5858e-02, 5.5723e-02, 6.5599e-02])
[rfa agg] iter:  4, prev_obj_val: 3051.87158203125, obj_val: 3049.616943359375, abs dis: 2.254638671875
[rfa agg] iter: 4, weight: tensor([4.1675e-05, 9.9909e-03, 1.3222e-02, 1.9028e-02, 7.6214e-02, 2.8010e-01,
        2.8601e-01, 9.8488e-02, 7.6414e-02, 1.4049e-01])
[rfa agg] iter:  5, prev_obj_val: 3049.616943359375, obj_val: 3054.17236328125, abs dis: 4.555419921875
[rfa agg] iter: 5, weight: tensor([3.4823e-05, 8.0514e-03, 1.0626e-02, 1.5182e-02, 6.8195e-02, 3.1656e-01,
        3.2203e-01, 9.0409e-02, 6.8357e-02, 1.0056e-01])
[rfa agg] iter:  6, prev_obj_val: 3054.17236328125, obj_val: 3056.50048828125, abs dis: 2.328125
[rfa agg] iter: 6, weight: tensor([4.6987e-05, 1.1699e-02, 1.5530e-02, 2.2527e-02, 8.0681e-02, 2.4395e-01,
        2.4905e-01, 1.0213e-01, 8.0912e-02, 1.9348e-01])
[rfa agg] iter:  7, prev_obj_val: 3056.50048828125, obj_val: 3054.16064453125, abs dis: 2.33984375
[rfa agg] iter: 7, weight: tensor([4.9522e-05, 1.2825e-02, 1.7082e-02, 2.4994e-02, 8.0130e-02, 2.0812e-01,
        2.1235e-01, 9.9625e-02, 8.0379e-02, 2.6444e-01])
[rfa agg] iter:  8, prev_obj_val: 3054.16064453125, obj_val: 3054.156005859375, abs dis: 0.004638671875
[rfa agg] iter: 8, weight: tensor([4.7031e-05, 1.1711e-02, 1.5548e-02, 2.2553e-02, 8.0783e-02, 2.4088e-01,
        2.4538e-01, 1.0233e-01, 8.1022e-02, 1.9974e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3556, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 4.3719, Accuracy: 3615/9950 (36.3317%)
saving model
Saving model on epoch 41
Done in 832.1431927680969 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 299/1071 (27.9178%)
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0281, Accuracy: 532/1071 (49.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.2845, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0533, Accuracy: 332/1154 (28.7695%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 11.3798, Accuracy: 63/10000 (0.6300%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.0910, Accuracy: 11/338 (3.2544%)
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7138, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0760, Accuracy: 67/426 (15.7277%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0400, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.0918, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 70/460 (15.2174%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5799, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.0839, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0458, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5194, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0541, Accuracy: 362/1446 (25.0346%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0336, Accuracy: 553/1446 (38.2434%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6360, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0539, Accuracy: 410/1956 (20.9611%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0308, Accuracy: 704/1956 (35.9918%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3383, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0595, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0358, Accuracy: 329/953 (34.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4851, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0495, Accuracy: 351/1213 (28.9365%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 572/1213 (47.1558%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9685, Accuracy: 96/10000 (0.9600%)
time spent on training: 244.41308879852295
[rfa agg] training data poison_ratio: 0.14858167246651904  data num: [1071, 1154, 338, 426, 460, 466, 1446, 1956, 953, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0928635452915744
[rfa agg] init. name: [55, 57, 12, 67, 31, 76, 26, 6, 64, 97], weight: tensor([0.1129, 0.1217, 0.0356, 0.0449, 0.0485, 0.0491, 0.1525, 0.2063, 0.1005,
        0.1279])
[rfa agg] iter:  0, prev_obj_val: 58.67505645751953, obj_val: 60.409576416015625, abs dis: 1.7345199584960938
[rfa agg] iter: 0, weight: tensor([0.3727, 0.1357, 0.0101, 0.0140, 0.0169, 0.0171, 0.0692, 0.0422, 0.1792,
        0.1429])
[rfa agg] iter:  1, prev_obj_val: 60.409576416015625, obj_val: 64.58560180664062, abs dis: 4.176025390625
[rfa agg] iter: 1, weight: tensor([0.3119, 0.1218, 0.0112, 0.0156, 0.0190, 0.0192, 0.0679, 0.0431, 0.2626,
        0.1278])
[rfa agg] iter:  2, prev_obj_val: 64.58560180664062, obj_val: 67.08202362060547, abs dis: 2.4964218139648438
[rfa agg] iter: 2, weight: tensor([0.1594, 0.0873, 0.0116, 0.0165, 0.0203, 0.0206, 0.0558, 0.0379, 0.4989,
        0.0916])
[rfa agg] iter:  3, prev_obj_val: 67.08202362060547, obj_val: 67.08161926269531, abs dis: 0.00040435791015625
[rfa agg] iter: 3, weight: tensor([0.1394, 0.0853, 0.0135, 0.0192, 0.0239, 0.0242, 0.0574, 0.0402, 0.5075,
        0.0893])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3577, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 4.2134, Accuracy: 5618/9950 (56.4623%)
saving model
Saving model on epoch 42
Done in 707.2123351097107 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0565, Accuracy: 270/486 (55.5556%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0384, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Avg loss: 0.0319, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Avg loss: 0.0282, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Avg loss: 0.0258, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Avg loss: 0.0235, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Avg loss: 0.0226, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Avg loss: 0.0231, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Avg loss: 0.0236, Accuracy: 317/486 (65.2263%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Avg loss: 0.0211, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Global model norm: 111.99687844422272.
Norm before scaling: 111.99056095130294. Distance: 0.5579508302706522
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1777, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 0.4415, Accuracy: 9918/9950 (99.6784%)
Scaling by  100
Scaled Norm after poisoning: 124.4340822295584, distance: 55.79508319371654
Total norm for 3 adversaries is: 124.4340822295584. distance: 55.79508319371654
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 321/896 (35.8259%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0311, Accuracy: 469/896 (52.3438%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1668, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1234, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1075, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3744, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0756, Accuracy: 64/426 (15.0235%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0397, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9609, Accuracy: 52/10000 (0.5200%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0557, Accuracy: 337/1241 (27.1555%)
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0348, Accuracy: 475/1241 (38.2756%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7486, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 307/715 (42.9371%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0362, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.3879, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0518, Accuracy: 315/1154 (27.2964%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 11.3686, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0542, Accuracy: 330/1049 (31.4585%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0272, Accuracy: 559/1049 (53.2888%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.5432, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 192/669 (28.6996%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0384, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6365, Accuracy: 90/10000 (0.9000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 644/2227 (28.9178%)
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1053/2227 (47.2833%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1157, Accuracy: 124/10000 (1.2400%)
time spent on training: 327.3574562072754
[rfa agg] training data poison_ratio: 0.43947982660886964  data num: [486, 896, 134, 426, 1241, 715, 1154, 1049, 669, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.27467489163054354
[rfa agg] init. name: [30, 89, 47, 67, 72, 23, 57, 51, 45, 60], weight: tensor([0.0540, 0.0996, 0.0149, 0.0473, 0.1379, 0.0795, 0.1283, 0.1166, 0.0744,
        0.2475])
[rfa agg] iter:  0, prev_obj_val: 3614.621826171875, obj_val: 2024.9000244140625, abs dis: 1589.7218017578125
[rfa agg] iter: 0, weight: tensor([0.0032, 0.1016, 0.0145, 0.0468, 0.1447, 0.0804, 0.1339, 0.1206, 0.0748,
        0.2794])
[rfa agg] iter:  1, prev_obj_val: 2024.9000244140625, obj_val: 2003.671875, abs dis: 21.2281494140625
[rfa agg] iter: 1, weight: tensor([1.2579e-04, 5.4083e-02, 4.9161e-03, 1.8231e-02, 1.1553e-01, 3.8626e-02,
        9.8442e-02, 7.6830e-02, 3.4347e-02, 5.5887e-01])
[rfa agg] iter:  2, prev_obj_val: 2003.671875, obj_val: 1986.4730224609375, abs dis: 17.1988525390625
[rfa agg] iter: 2, weight: tensor([1.2249e-04, 8.1299e-02, 6.0996e-03, 2.3693e-02, 2.4404e-01, 5.4936e-02,
        1.8882e-01, 1.3037e-01, 4.7777e-02, 2.2285e-01])
[rfa agg] iter:  3, prev_obj_val: 1986.4730224609375, obj_val: 1986.7923583984375, abs dis: 0.3193359375
[rfa agg] iter: 3, weight: tensor([3.6824e-05, 4.8592e-02, 2.4486e-03, 1.0270e-02, 4.0595e-01, 2.8562e-02,
        3.1809e-01, 1.1912e-01, 2.3660e-02, 4.3267e-02])
[rfa agg] iter:  4, prev_obj_val: 1986.7923583984375, obj_val: 1989.5218505859375, abs dis: 2.7294921875
[rfa agg] iter: 4, weight: tensor([4.3229e-05, 7.7312e-02, 3.1623e-03, 1.3697e-02, 2.0865e-01, 4.1676e-02,
        3.1545e-01, 2.6005e-01, 3.3658e-02, 4.6299e-02])
[rfa agg] iter:  5, prev_obj_val: 1989.5218505859375, obj_val: 1992.5338134765625, abs dis: 3.011962890625
[rfa agg] iter: 5, weight: tensor([4.5774e-05, 1.2723e-01, 3.7218e-03, 1.6795e-02, 1.2910e-01, 5.8527e-02,
        1.6484e-01, 4.0935e-01, 4.5290e-02, 4.5088e-02])
[rfa agg] iter:  6, prev_obj_val: 1992.5338134765625, obj_val: 1994.1527099609375, abs dis: 1.618896484375
[rfa agg] iter: 6, weight: tensor([5.3444e-05, 2.3084e-01, 4.6934e-03, 2.1910e-02, 1.1810e-01, 8.7137e-02,
        1.3886e-01, 2.8397e-01, 6.4460e-02, 4.9969e-02])
[rfa agg] iter:  7, prev_obj_val: 1994.1527099609375, obj_val: 1995.848876953125, abs dis: 1.6961669921875
[rfa agg] iter: 7, weight: tensor([5.2317e-05, 3.1829e-01, 4.7873e-03, 2.2796e-02, 1.0461e-01, 9.9096e-02,
        1.2002e-01, 2.1174e-01, 7.0901e-02, 4.7703e-02])
[rfa agg] iter:  8, prev_obj_val: 1995.848876953125, obj_val: 1997.7078857421875, abs dis: 1.8590087890625
[rfa agg] iter: 8, weight: tensor([4.5607e-05, 4.3458e-01, 4.3554e-03, 2.1197e-02, 8.3154e-02, 1.0257e-01,
        9.3521e-02, 1.4961e-01, 7.0389e-02, 4.0578e-02])
[rfa agg] iter:  9, prev_obj_val: 1997.7078857421875, obj_val: 1999.9927978515625, abs dis: 2.284912109375
[rfa agg] iter: 9, weight: tensor([3.6171e-05, 5.5564e-01, 3.6113e-03, 1.8005e-02, 6.0552e-02, 9.9469e-02,
        6.6962e-02, 9.9656e-02, 6.4649e-02, 3.1420e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3560, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 4.2316, Accuracy: 5588/9950 (56.1608%)
saving model
Done in 790.2032778263092 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0581, Accuracy: 301/807 (37.2986%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0308, Accuracy: 407/807 (50.4337%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.7217, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0668, Accuracy: 197/669 (29.4469%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0369, Accuracy: 363/669 (54.2601%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8252, Accuracy: 85/10000 (0.8500%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0551, Accuracy: 348/1154 (30.1560%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.8253, Accuracy: 71/10000 (0.7100%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0555, Accuracy: 325/1241 (26.1886%)
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0352, Accuracy: 489/1241 (39.4037%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0406, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0530, Accuracy: 411/1956 (21.0123%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0300, Accuracy: 745/1956 (38.0879%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.6051, Accuracy: 114/10000 (1.1400%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0483, Accuracy: 681/2227 (30.5793%)
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0270, Accuracy: 1081/2227 (48.5406%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4880, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0543, Accuracy: 309/1089 (28.3747%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 560/1089 (51.4233%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.3336, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 404/1904 (21.2185%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0300, Accuracy: 742/1904 (38.9706%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3234, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9052, Accuracy: 56/10000 (0.5600%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0583, Accuracy: 336/1190 (28.2353%)
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0298, Accuracy: 499/1190 (41.9328%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.1192, Accuracy: 81/10000 (0.8100%)
time spent on training: 366.49673986434937
[rfa agg] training data poison_ratio: 0.521304245097267  data num: [807, 669, 1154, 1241, 1956, 2227, 1089, 1904, 460, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.3258151531857919
[rfa agg] init. name: [20, 45, 15, 72, 6, 60, 59, 46, 31, 84], weight: tensor([0.0636, 0.0527, 0.0909, 0.0977, 0.1541, 0.1754, 0.0858, 0.1500, 0.0362,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 68.71361541748047, obj_val: 70.95232391357422, abs dis: 2.23870849609375
[rfa agg] iter: 0, weight: tensor([0.0349, 0.0235, 0.1590, 0.2778, 0.0757, 0.0608, 0.1099, 0.0822, 0.0126,
        0.1638])
[rfa agg] iter:  1, prev_obj_val: 70.95232391357422, obj_val: 77.70609283447266, abs dis: 6.7537689208984375
[rfa agg] iter: 1, weight: tensor([0.0258, 0.0161, 0.2441, 0.2092, 0.0315, 0.0269, 0.1490, 0.0334, 0.0081,
        0.2558])
[rfa agg] iter:  2, prev_obj_val: 77.70609283447266, obj_val: 75.01329803466797, abs dis: 2.6927947998046875
[rfa agg] iter: 2, weight: tensor([0.0490, 0.0284, 0.1857, 0.1332, 0.0401, 0.0353, 0.2807, 0.0422, 0.0134,
        0.1920])
[rfa agg] iter:  3, prev_obj_val: 75.01329803466797, obj_val: 75.01072692871094, abs dis: 0.00257110595703125
[rfa agg] iter: 3, weight: tensor([0.0360, 0.0215, 0.1962, 0.1321, 0.0340, 0.0296, 0.3061, 0.0358, 0.0104,
        0.1984])
[rfa agg] iter:  4, prev_obj_val: 75.01072692871094, obj_val: 75.01055145263672, abs dis: 0.00017547607421875
[rfa agg] iter: 4, weight: tensor([0.0356, 0.0213, 0.1946, 0.1304, 0.0336, 0.0293, 0.3141, 0.0354, 0.0103,
        0.1955])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3526, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 4.2617, Accuracy: 5535/9950 (55.6281%)
saving model
Done in 821.593512058258 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Avg loss: 0.0560, Accuracy: 276/515 (53.5922%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Avg loss: 0.0431, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Avg loss: 0.0342, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Avg loss: 0.0319, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Avg loss: 0.0300, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Avg loss: 0.0295, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Avg loss: 0.0279, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Avg loss: 0.0290, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Avg loss: 0.0286, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Avg loss: 0.0282, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Global model norm: 111.99398351585678.
Norm before scaling: 111.98635781173303. Distance: 0.5196008850698003
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.7336, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.4501, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 122.65704617575992, distance: 51.96008646968844
Total norm for 2 adversaries is: 122.65704617575992. distance: 51.96008646968844
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0508, Accuracy: 367/1340 (27.3881%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0255, Accuracy: 611/1340 (45.5970%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.2660, Accuracy: 100/10000 (1.0000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0552, Accuracy: 347/1241 (27.9613%)
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0347, Accuracy: 463/1241 (37.3086%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1504, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0536, Accuracy: 403/1956 (20.6033%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0304, Accuracy: 697/1956 (35.6339%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2506, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 309/715 (43.2168%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0349, Accuracy: 442/715 (61.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.3064, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1084, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3760, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 419/1742 (24.0528%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 761/1742 (43.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.4998, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0567, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.4988, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 297/813 (36.5314%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 467/813 (57.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 12.3585, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0606, Accuracy: 347/1003 (34.5962%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/1003 (44.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.3927, Accuracy: 50/10000 (0.5000%)
time spent on training: 354.19986295700073
[rfa agg] training data poison_ratio: 0.16581680830972614  data num: [515, 1340, 1241, 1956, 715, 134, 1742, 1131, 813, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.10363550519357884
[rfa agg] init. name: [33, 77, 72, 6, 23, 47, 93, 87, 53, 86], weight: tensor([0.0486, 0.1265, 0.1172, 0.1847, 0.0675, 0.0127, 0.1645, 0.1068, 0.0768,
        0.0947])
[rfa agg] iter:  0, prev_obj_val: 3687.205078125, obj_val: 2025.396728515625, abs dis: 1661.808349609375
[rfa agg] iter: 0, weight: tensor([0.0026, 0.1321, 0.1218, 0.2022, 0.0677, 0.0122, 0.1775, 0.1100, 0.0773,
        0.0967])
[rfa agg] iter:  1, prev_obj_val: 2025.396728515625, obj_val: 2006.4168701171875, abs dis: 18.9798583984375
[rfa agg] iter: 1, weight: tensor([3.6039e-05, 4.1789e-02, 3.5198e-02, 6.7358e-01, 1.1759e-02, 1.4967e-03,
        1.7396e-01, 2.7173e-02, 1.4118e-02, 2.0884e-02])
[rfa agg] iter:  2, prev_obj_val: 2006.4168701171875, obj_val: 1999.8970947265625, abs dis: 6.519775390625
[rfa agg] iter: 2, weight: tensor([5.8165e-05, 1.3258e-01, 1.0318e-01, 1.9712e-01, 2.5742e-02, 2.9426e-03,
        3.8555e-01, 7.0912e-02, 3.1524e-02, 5.0402e-02])
[rfa agg] iter:  3, prev_obj_val: 1999.8970947265625, obj_val: 2000.3028564453125, abs dis: 0.40576171875
[rfa agg] iter: 3, weight: tensor([4.8705e-05, 3.3313e-01, 1.9951e-01, 9.6878e-02, 2.8738e-02, 2.9091e-03,
        1.3316e-01, 1.0474e-01, 3.6144e-02, 6.4736e-02])
[rfa agg] iter:  4, prev_obj_val: 2000.3028564453125, obj_val: 2005.025146484375, abs dis: 4.7222900390625
[rfa agg] iter: 4, weight: tensor([3.2953e-05, 1.8450e-01, 2.9063e-01, 4.6588e-02, 2.9065e-02, 2.4005e-03,
        5.5217e-02, 2.6074e-01, 3.8616e-02, 9.2208e-02])
[rfa agg] iter:  5, prev_obj_val: 2005.025146484375, obj_val: 2009.44482421875, abs dis: 4.419677734375
[rfa agg] iter: 5, weight: tensor([3.2805e-05, 1.0711e-01, 1.3755e-01, 4.1262e-02, 3.6690e-02, 2.6377e-03,
        4.7163e-02, 4.0970e-01, 5.1051e-02, 1.6680e-01])
[rfa agg] iter:  6, prev_obj_val: 2009.44482421875, obj_val: 2011.8271484375, abs dis: 2.38232421875
[rfa agg] iter: 6, weight: tensor([3.6700e-05, 9.3721e-02, 1.1061e-01, 4.2998e-02, 4.9923e-02, 3.1701e-03,
        4.8217e-02, 2.2986e-01, 7.3033e-02, 3.4843e-01])
[rfa agg] iter:  7, prev_obj_val: 2011.8271484375, obj_val: 2011.79052734375, abs dis: 0.03662109375
[rfa agg] iter: 7, weight: tensor([3.2390e-05, 7.4643e-02, 8.5776e-02, 3.6693e-02, 4.9301e-02, 2.9058e-03,
        4.0802e-02, 1.5196e-01, 7.4918e-02, 4.8297e-01])
[rfa agg] iter:  8, prev_obj_val: 2011.79052734375, obj_val: 2011.782470703125, abs dis: 0.008056640625
[rfa agg] iter: 8, weight: tensor([2.8686e-05, 6.6012e-02, 7.5745e-02, 3.2492e-02, 4.3550e-02, 2.5734e-03,
        3.6130e-02, 1.3255e-01, 6.6225e-02, 5.4469e-01])
[rfa agg] iter:  9, prev_obj_val: 2011.782470703125, obj_val: 2020.669189453125, abs dis: 8.88671875
[rfa agg] iter: 9, weight: tensor([2.6740e-05, 6.1479e-02, 7.0488e-02, 3.0284e-02, 4.0525e-02, 2.3985e-03,
        3.3673e-02, 1.2276e-01, 6.1617e-02, 5.7674e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3505, Accuracy: 77/10000 (0.7700%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.3040, Accuracy: 5222/9950 (52.4824%)
saving model
Done in 821.3955013751984 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0338, Accuracy: 373/946 (39.4292%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2620, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0785, Accuracy: 82/486 (16.8724%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0368, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9318, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0525, Accuracy: 409/1573 (26.0013%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0332, Accuracy: 624/1573 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8295, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 208/605 (34.3802%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.7647, Accuracy: 71/10000 (0.7100%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0581, Accuracy: 274/590 (46.4407%)
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.5633, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 428/1953 (21.9150%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0324, Accuracy: 807/1953 (41.3210%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9268, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0429, Accuracy: 595/1470 (40.4762%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0223, Accuracy: 897/1470 (61.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.2732, Accuracy: 104/10000 (1.0400%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0564, Accuracy: 349/1190 (29.3277%)
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0297, Accuracy: 484/1190 (40.6723%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.3491, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0504, Accuracy: 368/1030 (35.7282%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0230, Accuracy: 693/1030 (67.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.6011, Accuracy: 110/10000 (1.1000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0525, Accuracy: 367/1154 (31.8024%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0270, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7810, Accuracy: 91/10000 (0.9100%)
time spent on training: 316.7685480117798
[rfa agg] training data poison_ratio: 0.3109939074292989  data num: [946, 486, 1573, 605, 590, 1953, 1470, 1190, 1030, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.1943711921433118
[rfa agg] init. name: [43, 30, 40, 2, 69, 83, 22, 84, 91, 15], weight: tensor([0.0860, 0.0442, 0.1430, 0.0550, 0.0537, 0.1776, 0.1337, 0.1082, 0.0937,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 51.667808532714844, obj_val: 55.09698486328125, abs dis: 3.4291763305664062
[rfa agg] iter: 0, weight: tensor([0.0569, 0.0108, 0.0633, 0.0163, 0.0159, 0.0395, 0.0874, 0.3236, 0.1136,
        0.2727])
[rfa agg] iter:  1, prev_obj_val: 55.09698486328125, obj_val: 58.71011734008789, abs dis: 3.6131324768066406
[rfa agg] iter: 1, weight: tensor([0.1029, 0.0145, 0.0591, 0.0228, 0.0222, 0.0410, 0.0747, 0.2033, 0.2722,
        0.1873])
[rfa agg] iter:  2, prev_obj_val: 58.71011734008789, obj_val: 60.89626693725586, abs dis: 2.1861495971679688
[rfa agg] iter: 2, weight: tensor([0.1696, 0.0170, 0.0548, 0.0276, 0.0269, 0.0400, 0.0666, 0.1351, 0.3348,
        0.1277])
[rfa agg] iter:  3, prev_obj_val: 60.89626693725586, obj_val: 63.198585510253906, abs dis: 2.302318572998047
[rfa agg] iter: 3, weight: tensor([0.2491, 0.0193, 0.0553, 0.0319, 0.0311, 0.0414, 0.0662, 0.1215, 0.2690,
        0.1153])
[rfa agg] iter:  4, prev_obj_val: 63.198585510253906, obj_val: 68.47969818115234, abs dis: 5.2811126708984375
[rfa agg] iter: 4, weight: tensor([0.3755, 0.0200, 0.0509, 0.0338, 0.0329, 0.0388, 0.0600, 0.1020, 0.1887,
        0.0975])
[rfa agg] iter:  5, prev_obj_val: 68.47969818115234, obj_val: 68.46955108642578, abs dis: 0.0101470947265625
[rfa agg] iter: 5, weight: tensor([0.4492, 0.0245, 0.0491, 0.0439, 0.0427, 0.0389, 0.0565, 0.0853, 0.1280,
        0.0821])
[rfa agg] iter:  6, prev_obj_val: 68.46955108642578, obj_val: 65.62344360351562, abs dis: 2.8461074829101562
[rfa agg] iter: 6, weight: tensor([0.4679, 0.0237, 0.0475, 0.0425, 0.0413, 0.0376, 0.0547, 0.0825, 0.1228,
        0.0794])
[rfa agg] iter:  7, prev_obj_val: 65.62344360351562, obj_val: 74.5561752319336, abs dis: 8.932731628417969
[rfa agg] iter: 7, weight: tensor([0.5731, 0.0164, 0.0371, 0.0285, 0.0277, 0.0289, 0.0433, 0.0687, 0.1103,
        0.0660])
[rfa agg] iter:  8, prev_obj_val: 74.5561752319336, obj_val: 68.48563385009766, abs dis: 6.0705413818359375
[rfa agg] iter: 8, weight: tensor([0.2877, 0.0410, 0.0636, 0.0794, 0.0772, 0.0520, 0.0718, 0.0994, 0.1321,
        0.0960])
[rfa agg] iter:  9, prev_obj_val: 68.48563385009766, obj_val: 68.46975708007812, abs dis: 0.01587677001953125
[rfa agg] iter: 9, weight: tensor([0.4418, 0.0249, 0.0498, 0.0445, 0.0433, 0.0394, 0.0573, 0.0865, 0.1292,
        0.0833])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3495, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.3495, Accuracy: 4186/9950 (42.0704%)
saving model
Done in 773.6479141712189 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Avg loss: 0.0632, Accuracy: 211/408 (51.7157%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Avg loss: 0.0396, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Avg loss: 0.0406, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Avg loss: 0.0382, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Avg loss: 0.0344, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Avg loss: 0.0318, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Avg loss: 0.0296, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Avg loss: 0.0273, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Avg loss: 0.0262, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Avg loss: 0.0281, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Global model norm: 111.99114519265575.
Norm before scaling: 111.9857125024773. Distance: 0.48834951305058527
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.9097, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 0.3387, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.57822841693327, distance: 48.83495202273163
Total norm for 5 adversaries is: 121.57822841693327. distance: 48.83495202273163
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0642, Accuracy: 240/774 (31.0078%)
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0349, Accuracy: 338/774 (43.6693%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7832, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0671, Accuracy: 154/682 (22.5806%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0363, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.6812, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 335/1446 (23.1674%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0332, Accuracy: 549/1446 (37.9668%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7004, Accuracy: 64/10000 (0.6400%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0917, Accuracy: 9/338 (2.6627%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0501, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.6661, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 51/416 (12.2596%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0449, Accuracy: 208/416 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.2615, Accuracy: 75/10000 (0.7500%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 708/2227 (31.7916%)
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1083/2227 (48.6304%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2991, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0589, Accuracy: 328/803 (40.8468%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.9709, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0662, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0276, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1823, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0436, Accuracy: 459/1036 (44.3050%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0229, Accuracy: 706/1036 (68.1467%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.5088, Accuracy: 76/10000 (0.7600%)
time spent on training: 371.93673753738403
[rfa agg] training data poison_ratio: 0.46743768246126205  data num: [408, 774, 682, 1446, 338, 416, 2227, 803, 776, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.2921485515382888
[rfa agg] init. name: [36, 81, 80, 26, 12, 78, 60, 58, 75, 19], weight: tensor([0.0458, 0.0869, 0.0766, 0.1624, 0.0380, 0.0467, 0.2501, 0.0902, 0.0871,
        0.1163])
[rfa agg] iter:  0, prev_obj_val: 2700.3017578125, obj_val: 1515.5478515625, abs dis: 1184.75390625
[rfa agg] iter: 0, weight: tensor([0.0023, 0.0865, 0.0753, 0.1721, 0.0362, 0.0449, 0.2875, 0.0898, 0.0867,
        0.1187])
[rfa agg] iter:  1, prev_obj_val: 1515.5478515625, obj_val: 1500.976806640625, abs dis: 14.571044921875
[rfa agg] iter: 1, weight: tensor([1.1427e-04, 5.5700e-02, 4.2770e-02, 3.9159e-01, 1.6038e-02, 2.0749e-02,
        2.5368e-01, 5.7777e-02, 5.5844e-02, 1.0574e-01])
[rfa agg] iter:  2, prev_obj_val: 1500.976806640625, obj_val: 1499.0277099609375, abs dis: 1.9490966796875
[rfa agg] iter: 2, weight: tensor([8.1384e-05, 7.1254e-02, 4.9682e-02, 3.8989e-01, 1.6169e-02, 2.1369e-02,
        1.0642e-01, 7.3850e-02, 7.1403e-02, 1.9988e-01])
[rfa agg] iter:  3, prev_obj_val: 1499.0277099609375, obj_val: 1501.9703369140625, abs dis: 2.942626953125
[rfa agg] iter: 3, weight: tensor([4.5615e-05, 7.4068e-02, 4.3984e-02, 9.3412e-02, 1.1954e-02, 1.6175e-02,
        4.8106e-02, 7.6611e-02, 7.4244e-02, 5.6140e-01])
[rfa agg] iter:  4, prev_obj_val: 1501.9703369140625, obj_val: 1503.474365234375, abs dis: 1.5040283203125
[rfa agg] iter: 4, weight: tensor([4.9402e-05, 1.9327e-01, 8.0627e-02, 7.1387e-02, 1.6750e-02, 2.3333e-02,
        4.5783e-02, 1.9842e-01, 1.9730e-01, 1.7308e-01])
[rfa agg] iter:  5, prev_obj_val: 1503.474365234375, obj_val: 1513.0284423828125, abs dis: 9.5540771484375
[rfa agg] iter: 5, weight: tensor([2.8702e-05, 2.5080e-01, 6.4770e-02, 3.7162e-02, 1.1040e-02, 1.5650e-02,
        2.5377e-02, 2.6147e-01, 2.6251e-01, 7.1193e-02])
[rfa agg] iter:  6, prev_obj_val: 1513.0284423828125, obj_val: 1509.9947509765625, abs dis: 3.03369140625
[rfa agg] iter: 6, weight: tensor([4.1209e-05, 1.7148e-01, 2.7845e-01, 4.4146e-02, 2.1593e-02, 3.2328e-02,
        3.3359e-02, 1.7944e-01, 1.7348e-01, 6.5671e-02])
[rfa agg] iter:  7, prev_obj_val: 1509.9947509765625, obj_val: 1509.9833984375, abs dis: 0.0113525390625
[rfa agg] iter: 7, weight: tensor([3.6354e-05, 2.0756e-01, 1.8781e-01, 4.0715e-02, 1.7472e-02, 2.5737e-02,
        3.0063e-02, 2.1576e-01, 2.1118e-01, 6.3658e-02])
[rfa agg] iter:  8, prev_obj_val: 1509.9833984375, obj_val: 1512.9874267578125, abs dis: 3.0040283203125
[rfa agg] iter: 8, weight: tensor([3.6196e-05, 2.0960e-01, 1.8094e-01, 4.0531e-02, 1.7396e-02, 2.5614e-02,
        2.9932e-02, 2.1924e-01, 2.1336e-01, 6.3349e-02])
[rfa agg] iter:  9, prev_obj_val: 1512.9874267578125, obj_val: 1512.9698486328125, abs dis: 0.017578125
[rfa agg] iter: 9, weight: tensor([4.0244e-05, 1.6668e-01, 2.9859e-01, 4.3123e-02, 2.1094e-02, 3.1606e-02,
        3.2578e-02, 1.7371e-01, 1.6840e-01, 6.4172e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3479, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.3596, Accuracy: 4223/9950 (42.4422%)
saving model
Done in 824.3205804824829 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0551, Accuracy: 410/1587 (25.8349%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0324, Accuracy: 615/1587 (38.7524%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8570, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0817, Accuracy: 26/311 (8.3601%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.0405, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0727, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 281/530 (53.0189%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8995, Accuracy: 68/10000 (0.6800%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0567, Accuracy: 304/599 (50.7513%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.5480, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0477, Accuracy: 455/1628 (27.9484%)
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0240, Accuracy: 893/1628 (54.8526%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2004, Accuracy: 151/10000 (1.5100%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1231, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1052, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3670, Accuracy: 59/10000 (0.5900%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.0917, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0483, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.5795, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0495, Accuracy: 342/1013 (33.7611%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0244, Accuracy: 550/1013 (54.2942%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8610, Accuracy: 85/10000 (0.8500%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 62/408 (15.1961%)
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0500, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.8118, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 206/500 (41.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2870, Accuracy: 77/10000 (0.7700%)
time spent on training: 297.7133662700653
[rfa agg] training data poison_ratio: 0.4970204313280363  data num: [1587, 311, 530, 599, 1628, 134, 338, 1013, 408, 500]
[rfa agg] considering poison per batch poison_fraction: 0.3106377695800227
[rfa agg] init. name: [27, 96, 18, 95, 5, 47, 12, 39, 36, 82], weight: tensor([0.2252, 0.0441, 0.0752, 0.0850, 0.2310, 0.0190, 0.0480, 0.1437, 0.0579,
        0.0709])
[rfa agg] iter:  0, prev_obj_val: 70.8653564453125, obj_val: 72.4991226196289, abs dis: 1.6337661743164062
[rfa agg] iter: 0, weight: tensor([0.1021, 0.0200, 0.0567, 0.0767, 0.0952, 0.0072, 0.0242, 0.5391, 0.0328,
        0.0459])
[rfa agg] iter:  1, prev_obj_val: 72.4991226196289, obj_val: 74.26399230957031, abs dis: 1.7648696899414062
[rfa agg] iter: 1, weight: tensor([0.1141, 0.0274, 0.0835, 0.1173, 0.1073, 0.0097, 0.0334, 0.3955, 0.0461,
        0.0658])
[rfa agg] iter:  2, prev_obj_val: 74.26399230957031, obj_val: 76.04969787597656, abs dis: 1.78570556640625
[rfa agg] iter: 2, weight: tensor([0.1113, 0.0327, 0.1108, 0.1654, 0.1054, 0.0113, 0.0406, 0.2814, 0.0571,
        0.0839])
[rfa agg] iter:  3, prev_obj_val: 76.04969787597656, obj_val: 78.8340835571289, abs dis: 2.7843856811523438
[rfa agg] iter: 3, weight: tensor([0.0956, 0.0348, 0.1369, 0.2276, 0.0911, 0.0117, 0.0441, 0.1969, 0.0638,
        0.0975])
[rfa agg] iter:  4, prev_obj_val: 78.8340835571289, obj_val: 85.42047882080078, abs dis: 6.586395263671875
[rfa agg] iter: 4, weight: tensor([0.0527, 0.0272, 0.1630, 0.4225, 0.0506, 0.0086, 0.0361, 0.0883, 0.0558,
        0.0952])
[rfa agg] iter:  5, prev_obj_val: 85.42047882080078, obj_val: 90.6053466796875, abs dis: 5.184867858886719
[rfa agg] iter: 5, weight: tensor([0.0345, 0.0317, 0.2789, 0.1399, 0.0334, 0.0087, 0.0481, 0.0483, 0.0935,
        0.2829])
[rfa agg] iter:  6, prev_obj_val: 90.6053466796875, obj_val: 93.63298797607422, abs dis: 3.0276412963867188
[rfa agg] iter: 6, weight: tensor([0.0326, 0.0444, 0.1240, 0.0845, 0.0316, 0.0107, 0.0797, 0.0427, 0.2357,
        0.3141])
[rfa agg] iter:  7, prev_obj_val: 93.63298797607422, obj_val: 93.61136627197266, abs dis: 0.0216217041015625
[rfa agg] iter: 7, weight: tensor([0.0286, 0.0499, 0.0843, 0.0638, 0.0278, 0.0109, 0.1058, 0.0364, 0.4351,
        0.1573])
[rfa agg] iter:  8, prev_obj_val: 93.61136627197266, obj_val: 90.61256408691406, abs dis: 2.9988021850585938
[rfa agg] iter: 8, weight: tensor([0.0246, 0.0430, 0.0725, 0.0549, 0.0239, 0.0094, 0.0911, 0.0314, 0.5158,
        0.1333])
[rfa agg] iter:  9, prev_obj_val: 90.61256408691406, obj_val: 96.99244689941406, abs dis: 6.3798828125
[rfa agg] iter: 9, weight: tensor([0.0319, 0.0435, 0.1196, 0.0823, 0.0310, 0.0105, 0.0779, 0.0418, 0.2689,
        0.2925])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3458, Accuracy: 76/10000 (0.7600%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 4.3841, Accuracy: 4044/9950 (40.6432%)
saving model
Done in 757.4756135940552 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Avg loss: 0.0442, Accuracy: 665/1129 (58.9017%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Avg loss: 0.0217, Accuracy: 661/1129 (58.5474%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Avg loss: 0.0195, Accuracy: 716/1129 (63.4190%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Avg loss: 0.0185, Accuracy: 707/1129 (62.6218%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Avg loss: 0.0179, Accuracy: 718/1129 (63.5961%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Avg loss: 0.0181, Accuracy: 708/1129 (62.7104%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Avg loss: 0.0176, Accuracy: 718/1129 (63.5961%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Avg loss: 0.0179, Accuracy: 711/1129 (62.9761%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Avg loss: 0.0180, Accuracy: 706/1129 (62.5332%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Avg loss: 0.0179, Accuracy: 712/1129 (63.0647%), train_poison_data_count: 720
Global model norm: 111.98950146107447.
Norm before scaling: 111.97075162179631. Distance: 0.8107610947975809
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9708, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.4182, Accuracy: 9853/9950 (99.0251%)
Scaling by  100
Scaled Norm after poisoning: 136.48956147128982, distance: 81.07611501411036
Total norm for 4 adversaries is: 136.48956147128982. distance: 81.07611501411036
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 409/1949 (20.9851%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0321, Accuracy: 662/1949 (33.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3437, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0508, Accuracy: 288/888 (32.4324%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 482/888 (54.2793%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.4067, Accuracy: 78/10000 (0.7800%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0481, Accuracy: 713/2227 (32.0162%)
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1064/2227 (47.7773%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6009, Accuracy: 116/10000 (1.1600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0826, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0483, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.9632, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0528, Accuracy: 412/1956 (21.0634%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 707/1956 (36.1452%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3329, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0496, Accuracy: 443/1574 (28.1449%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0254, Accuracy: 748/1574 (47.5222%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8378, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0503, Accuracy: 394/1440 (27.3611%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0269, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.7405, Accuracy: 90/10000 (0.9000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0478, Accuracy: 390/1275 (30.5882%)
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0178, Accuracy: 779/1275 (61.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.0354, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0547, Accuracy: 315/677 (46.5288%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.3947, Accuracy: 63/10000 (0.6300%)
time spent on training: 427.6595153808594
[rfa agg] training data poison_ratio: 0.3726244176588035  data num: [1129, 1949, 888, 2227, 408, 1956, 1574, 1440, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.2328902610367522
[rfa agg] init. name: [37, 21, 63, 60, 36, 6, 17, 29, 9, 90], weight: tensor([0.0835, 0.1441, 0.0657, 0.1647, 0.0302, 0.1446, 0.1164, 0.1065, 0.0943,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 12258.314453125, obj_val: 7232.4384765625, abs dis: 5025.8759765625
[rfa agg] iter: 0, weight: tensor([0.0082, 0.1570, 0.0699, 0.1804, 0.0318, 0.1576, 0.1258, 0.1148, 0.1012,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 7232.4384765625, obj_val: 6754.6279296875, abs dis: 477.810546875
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1676, 0.0607, 0.2038, 0.0257, 0.1682, 0.1241, 0.1104, 0.0940,
        0.0447])
[rfa agg] iter:  2, prev_obj_val: 6754.6279296875, obj_val: 6754.61767578125, abs dis: 0.01025390625
[rfa agg] iter: 2, weight: tensor([2.6731e-05, 3.7365e-01, 1.1416e-02, 1.0244e-01, 3.6862e-03, 3.7521e-01,
        6.0079e-02, 4.0409e-02, 2.5715e-02, 7.3696e-03])
[rfa agg] iter:  3, prev_obj_val: 6754.61767578125, obj_val: 6755.81103515625, abs dis: 1.193359375
[rfa agg] iter: 3, weight: tensor([4.1331e-05, 2.9609e-01, 1.9399e-02, 1.1937e-01, 6.0876e-03, 2.9798e-01,
        1.2502e-01, 7.7403e-02, 4.6260e-02, 1.2342e-02])
[rfa agg] iter:  4, prev_obj_val: 6755.81103515625, obj_val: 6757.7021484375, abs dis: 1.89111328125
[rfa agg] iter: 4, weight: tensor([4.8336e-05, 1.8285e-01, 2.6176e-02, 1.0582e-01, 7.8334e-03, 1.8371e-01,
        2.7433e-01, 1.3357e-01, 6.9413e-02, 1.6241e-02])
[rfa agg] iter:  5, prev_obj_val: 6757.7021484375, obj_val: 6763.2822265625, abs dis: 5.580078125
[rfa agg] iter: 5, weight: tensor([3.0764e-05, 7.8362e-02, 1.9689e-02, 5.4114e-02, 5.5412e-03, 7.8708e-02,
        5.3214e-01, 1.5806e-01, 6.1539e-02, 1.1815e-02])
[rfa agg] iter:  6, prev_obj_val: 6763.2822265625, obj_val: 6765.041015625, abs dis: 1.7587890625
[rfa agg] iter: 6, weight: tensor([3.6335e-05, 6.9621e-02, 2.8388e-02, 5.3346e-02, 7.3627e-03, 6.9940e-02,
        2.2161e-01, 4.1541e-01, 1.1801e-01, 1.6273e-02])
[rfa agg] iter:  7, prev_obj_val: 6765.041015625, obj_val: 6769.53271484375, abs dis: 4.49169921875
[rfa agg] iter: 7, weight: tensor([3.4508e-05, 6.2376e-02, 2.8557e-02, 4.8636e-02, 7.2184e-03, 6.2568e-02,
        1.6437e-01, 4.7763e-01, 1.3248e-01, 1.6125e-02])
[rfa agg] iter:  8, prev_obj_val: 6769.53271484375, obj_val: 6767.236328125, abs dis: 2.29638671875
[rfa agg] iter: 8, weight: tensor([4.4156e-05, 7.1535e-02, 4.1368e-02, 5.7659e-02, 9.8728e-03, 7.1745e-02,
        1.5313e-01, 3.1407e-01, 2.5799e-01, 2.2589e-02])
[rfa agg] iter:  9, prev_obj_val: 6767.236328125, obj_val: 6767.22900390625, abs dis: 0.00732421875
[rfa agg] iter: 9, weight: tensor([4.1243e-05, 7.0505e-02, 3.6254e-02, 5.5932e-02, 8.9159e-03, 7.0736e-02,
        1.6601e-01, 3.7406e-01, 1.9739e-01, 2.0151e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3414, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.3978, Accuracy: 4004/9950 (40.2412%)
saving model
Done in 894.5484027862549 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 572/1552 (36.8557%)
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 836/1552 (53.8660%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.2122, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 337/803 (41.9676%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 381/803 (47.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8553, Accuracy: 60/10000 (0.6000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0539, Accuracy: 315/599 (52.5876%)
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.8538, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0642, Accuracy: 213/605 (35.2066%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.8776, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0537, Accuracy: 424/1904 (22.2689%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0297, Accuracy: 739/1904 (38.8130%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2333, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.0705, Accuracy: 141/568 (24.8239%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.1099, Accuracy: 66/10000 (0.6600%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0485, Accuracy: 501/1129 (44.3756%)
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0214, Accuracy: 788/1129 (69.7963%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.2236, Accuracy: 117/10000 (1.1700%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0626, Accuracy: 255/774 (32.9457%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0321, Accuracy: 332/774 (42.8941%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7925, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0327, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8039, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0637, Accuracy: 235/773 (30.4010%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0293, Accuracy: 438/773 (56.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1662, Accuracy: 65/10000 (0.6500%)
time spent on training: 324.8441548347473
[rfa agg] training data poison_ratio: 0.3940513219284603  data num: [1552, 803, 599, 605, 1904, 568, 1129, 774, 1581, 773]
[rfa agg] considering poison per batch poison_fraction: 0.2462820762052877
[rfa agg] init. name: [74, 58, 95, 2, 46, 62, 37, 81, 28, 99], weight: tensor([0.1509, 0.0781, 0.0582, 0.0588, 0.1851, 0.0552, 0.1097, 0.0752, 0.1537,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 64.421630859375, obj_val: 66.96674346923828, abs dis: 2.5451126098632812
[rfa agg] iter: 0, weight: tensor([0.0883, 0.0906, 0.0390, 0.0394, 0.0668, 0.0324, 0.3804, 0.0865, 0.0898,
        0.0869])
[rfa agg] iter:  1, prev_obj_val: 66.96674346923828, obj_val: 70.93682098388672, abs dis: 3.9700775146484375
[rfa agg] iter: 1, weight: tensor([0.0776, 0.1474, 0.0516, 0.0520, 0.0625, 0.0415, 0.2086, 0.1392, 0.0790,
        0.1407])
[rfa agg] iter:  2, prev_obj_val: 70.93682098388672, obj_val: 83.15043640136719, abs dis: 12.213615417480469
[rfa agg] iter: 2, weight: tensor([0.0345, 0.2685, 0.0433, 0.0435, 0.0295, 0.0321, 0.0632, 0.2150, 0.0351,
        0.2354])
[rfa agg] iter:  3, prev_obj_val: 83.15043640136719, obj_val: 86.08918762207031, abs dis: 2.938751220703125
[rfa agg] iter: 3, weight: tensor([0.0378, 0.1336, 0.1797, 0.1750, 0.0342, 0.0945, 0.0546, 0.1253, 0.0385,
        0.1267])
[rfa agg] iter:  4, prev_obj_val: 86.08918762207031, obj_val: 89.27013397216797, abs dis: 3.1809463500976562
[rfa agg] iter: 4, weight: tensor([0.0307, 0.0905, 0.2568, 0.2437, 0.0280, 0.1050, 0.0429, 0.0852, 0.0313,
        0.0860])
[rfa agg] iter:  5, prev_obj_val: 89.27013397216797, obj_val: 89.26182556152344, abs dis: 0.00830841064453125
[rfa agg] iter: 5, weight: tensor([0.0229, 0.0583, 0.3265, 0.2902, 0.0210, 0.1161, 0.0310, 0.0552, 0.0233,
        0.0555])
[rfa agg] iter:  6, prev_obj_val: 89.26182556152344, obj_val: 92.97118377685547, abs dis: 3.7093582153320312
[rfa agg] iter: 6, weight: tensor([0.0219, 0.0559, 0.3379, 0.2953, 0.0202, 0.1110, 0.0297, 0.0527, 0.0223,
        0.0531])
[rfa agg] iter:  7, prev_obj_val: 92.97118377685547, obj_val: 89.27092742919922, abs dis: 3.70025634765625
[rfa agg] iter: 7, weight: tensor([0.0261, 0.0593, 0.2515, 0.2391, 0.0243, 0.2258, 0.0345, 0.0562, 0.0266,
        0.0565])
[rfa agg] iter:  8, prev_obj_val: 89.27092742919922, obj_val: 89.26187896728516, abs dis: 0.0090484619140625
[rfa agg] iter: 8, weight: tensor([0.0228, 0.0582, 0.3222, 0.2935, 0.0210, 0.1179, 0.0309, 0.0550, 0.0232,
        0.0554])
[rfa agg] iter:  9, prev_obj_val: 89.26187896728516, obj_val: 89.26170349121094, abs dis: 0.00017547607421875
[rfa agg] iter: 9, weight: tensor([0.0219, 0.0559, 0.3358, 0.2971, 0.0202, 0.1111, 0.0297, 0.0528, 0.0223,
        0.0532])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3400, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 4.4242, Accuracy: 3831/9950 (38.5025%)
saving model
Saving model on epoch 50
Done in 788.4520225524902 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0431, Accuracy: 806/1372 (58.7464%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0235, Accuracy: 843/1372 (61.4431%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Avg loss: 0.0221, Accuracy: 869/1372 (63.3382%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Avg loss: 0.0217, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Avg loss: 0.0214, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Avg loss: 0.0216, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Avg loss: 0.0209, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Avg loss: 0.0212, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Avg loss: 0.0212, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Avg loss: 0.0207, Accuracy: 869/1372 (63.3382%), train_poison_data_count: 868
Global model norm: 111.9865060579287.
Norm before scaling: 111.96291064176118. Distance: 0.8641947405371031
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1780, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.4011, Accuracy: 9940/9950 (99.8995%)
Scaling by  100
Scaled Norm after poisoning: 139.3067167372952, distance: 86.41947514069818
Total norm for 2 adversaries is: 139.3067167372952. distance: 86.41947514069818
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0488, Accuracy: 458/1574 (29.0978%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0252, Accuracy: 721/1574 (45.8069%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6404, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0539, Accuracy: 243/735 (33.0612%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0195, Accuracy: 391/735 (53.1973%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.5893, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 326/1089 (29.9357%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 503/1089 (46.1892%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 12.2019, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0559, Accuracy: 260/938 (27.7186%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0313, Accuracy: 353/938 (37.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.6165, Accuracy: 61/10000 (0.6100%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0796, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 160/515 (31.0680%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.1403, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0511, Accuracy: 354/1340 (26.4179%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0253, Accuracy: 621/1340 (46.3433%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.3627, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0298, Accuracy: 777/1742 (44.6039%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3904, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0580, Accuracy: 312/1513 (20.6213%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0350, Accuracy: 548/1513 (36.2194%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9453, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0560, Accuracy: 318/677 (46.9719%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.1740, Accuracy: 64/10000 (0.6400%)
time spent on training: 411.0946888923645
[rfa agg] training data poison_ratio: 0.16415832970856895  data num: [1372, 1574, 735, 1089, 938, 515, 1340, 1742, 1513, 677]
[rfa agg] considering poison per batch poison_fraction: 0.10259895606785559
[rfa agg] init. name: [42, 17, 32, 59, 73, 33, 77, 93, 8, 90], weight: tensor([0.1194, 0.1369, 0.0639, 0.0947, 0.0816, 0.0448, 0.1166, 0.1515, 0.1316,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 20625.29296875, obj_val: 13046.4091796875, abs dis: 7578.8837890625
[rfa agg] iter: 0, weight: tensor([0.0180, 0.1532, 0.0708, 0.1054, 0.0906, 0.0495, 0.1300, 0.1700, 0.1472,
        0.0652])
[rfa agg] iter:  1, prev_obj_val: 13046.4091796875, obj_val: 11882.1025390625, abs dis: 1164.306640625
[rfa agg] iter: 1, weight: tensor([0.0024, 0.1587, 0.0693, 0.1059, 0.0898, 0.0479, 0.1323, 0.1784, 0.1517,
        0.0636])
[rfa agg] iter:  2, prev_obj_val: 11882.1025390625, obj_val: 11760.7685546875, abs dis: 121.333984375
[rfa agg] iter: 2, weight: tensor([0.0003, 0.1808, 0.0502, 0.0914, 0.0706, 0.0321, 0.1272, 0.2375, 0.1651,
        0.0448])
[rfa agg] iter:  3, prev_obj_val: 11760.7685546875, obj_val: 11763.5908203125, abs dis: 2.822265625
[rfa agg] iter: 3, weight: tensor([3.7688e-05, 2.1801e-01, 2.0118e-02, 6.4097e-02, 3.5213e-02, 1.1079e-02,
        1.8916e-01, 1.0396e-01, 3.4134e-01, 1.6991e-02])
[rfa agg] iter:  4, prev_obj_val: 11763.5908203125, obj_val: 11766.1279296875, abs dis: 2.537109375
[rfa agg] iter: 4, weight: tensor([3.8783e-05, 1.0667e-01, 2.6764e-02, 1.2222e-01, 5.2382e-02, 1.3871e-02,
        4.5295e-01, 7.1590e-02, 1.3145e-01, 2.2065e-02])
[rfa agg] iter:  5, prev_obj_val: 11766.1279296875, obj_val: 11769.0751953125, abs dis: 2.947265625
[rfa agg] iter: 5, weight: tensor([4.6430e-05, 1.0468e-01, 3.6295e-02, 2.2023e-01, 7.6435e-02, 1.8178e-02,
        3.1680e-01, 7.5722e-02, 1.2208e-01, 2.9514e-02])
[rfa agg] iter:  6, prev_obj_val: 11769.0751953125, obj_val: 11776.935546875, abs dis: 7.8603515625
[rfa agg] iter: 6, weight: tensor([4.5280e-05, 8.6808e-02, 4.0801e-02, 3.7156e-01, 9.5136e-02, 1.9585e-02,
        1.8917e-01, 6.6158e-02, 9.8131e-02, 3.2597e-02])
[rfa agg] iter:  7, prev_obj_val: 11776.935546875, obj_val: 11774.740234375, abs dis: 2.1953125
[rfa agg] iter: 7, weight: tensor([5.2334e-05, 7.7043e-02, 6.7656e-02, 2.7178e-01, 2.3363e-01, 2.8598e-02,
        1.2317e-01, 6.3245e-02, 8.3686e-02, 5.1139e-02])
[rfa agg] iter:  8, prev_obj_val: 11774.740234375, obj_val: 11776.9189453125, abs dis: 2.1787109375
[rfa agg] iter: 8, weight: tensor([5.0230e-05, 7.8516e-02, 5.8682e-02, 3.2954e-01, 1.8029e-01, 2.5778e-02,
        1.3256e-01, 6.3460e-02, 8.6000e-02, 4.5124e-02])
[rfa agg] iter:  9, prev_obj_val: 11776.9189453125, obj_val: 11774.740234375, abs dis: 2.1787109375
[rfa agg] iter: 9, weight: tensor([5.2256e-05, 7.6937e-02, 6.7645e-02, 2.6767e-01, 2.3832e-01, 2.8575e-02,
        1.2294e-01, 6.3162e-02, 8.3587e-02, 5.1116e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3403, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.2656, Accuracy: 6262/9950 (62.9347%)
saving model
Done in 880.1456613540649 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0538, Accuracy: 394/1645 (23.9514%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0301, Accuracy: 730/1645 (44.3769%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4240, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0493, Accuracy: 357/1089 (32.7824%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0258, Accuracy: 549/1089 (50.4132%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.9765, Accuracy: 88/10000 (0.8800%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0617, Accuracy: 185/781 (23.6876%)
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0309, Accuracy: 295/781 (37.7721%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3051, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0547, Accuracy: 267/938 (28.4648%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0310, Accuracy: 375/938 (39.9787%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.6219, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0500, Accuracy: 298/888 (33.5586%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0237, Accuracy: 505/888 (56.8694%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.1727, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0555, Accuracy: 336/891 (37.7104%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 433/891 (48.5971%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.8215, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0569, Accuracy: 365/1003 (36.3908%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0322, Accuracy: 396/1003 (39.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.7367, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0531, Accuracy: 270/735 (36.7347%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0194, Accuracy: 421/735 (57.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.8909, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0538, Accuracy: 343/1049 (32.6978%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 570/1049 (54.3375%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4567, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0548, Accuracy: 357/896 (39.8438%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0316, Accuracy: 457/896 (51.0045%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3900, Accuracy: 57/10000 (0.5700%)
time spent on training: 284.4587514400482
[rfa agg] training data poison_ratio: 0.07876954109934443  data num: [1645, 1089, 781, 938, 888, 891, 1003, 735, 1049, 896]
[rfa agg] considering poison per batch poison_fraction: 0.04923096318709027
[rfa agg] init. name: [13, 59, 3, 73, 63, 7, 86, 32, 51, 89], weight: tensor([0.1659, 0.1098, 0.0788, 0.0946, 0.0896, 0.0899, 0.1012, 0.0741, 0.1058,
        0.0904])
[rfa agg] iter:  0, prev_obj_val: 31.708940505981445, obj_val: 36.863399505615234, abs dis: 5.154458999633789
[rfa agg] iter: 0, weight: tensor([0.0198, 0.0383, 0.0975, 0.1089, 0.2143, 0.1580, 0.0689, 0.0515, 0.0479,
        0.1948])
[rfa agg] iter:  1, prev_obj_val: 36.863399505615234, obj_val: 48.27494430541992, abs dis: 11.411544799804688
[rfa agg] iter: 1, weight: tensor([0.0225, 0.0380, 0.2367, 0.0786, 0.1389, 0.1271, 0.0582, 0.1165, 0.0451,
        0.1385])
[rfa agg] iter:  2, prev_obj_val: 48.27494430541992, obj_val: 52.61243438720703, abs dis: 4.337490081787109
[rfa agg] iter: 2, weight: tensor([0.0318, 0.0465, 0.1393, 0.0737, 0.0972, 0.0957, 0.0620, 0.3033, 0.0526,
        0.0979])
[rfa agg] iter:  3, prev_obj_val: 52.61243438720703, obj_val: 48.25806427001953, abs dis: 4.3543701171875
[rfa agg] iter: 3, weight: tensor([0.0391, 0.0549, 0.1347, 0.0823, 0.1035, 0.1026, 0.0710, 0.2462, 0.0614,
        0.1042])
[rfa agg] iter:  4, prev_obj_val: 48.25806427001953, obj_val: 52.61305236816406, abs dis: 4.354988098144531
[rfa agg] iter: 4, weight: tensor([0.0313, 0.0457, 0.1355, 0.0724, 0.0954, 0.0940, 0.0609, 0.3171, 0.0517,
        0.0959])
[rfa agg] iter:  5, prev_obj_val: 52.61305236816406, obj_val: 48.258033752441406, abs dis: 4.355018615722656
[rfa agg] iter: 5, weight: tensor([0.0390, 0.0549, 0.1346, 0.0822, 0.1035, 0.1026, 0.0710, 0.2467, 0.0614,
        0.1041])
[rfa agg] iter:  6, prev_obj_val: 48.258033752441406, obj_val: 52.613059997558594, abs dis: 4.3550262451171875
[rfa agg] iter: 6, weight: tensor([0.0313, 0.0457, 0.1355, 0.0724, 0.0954, 0.0940, 0.0609, 0.3172, 0.0517,
        0.0959])
[rfa agg] iter:  7, prev_obj_val: 52.613059997558594, obj_val: 48.258033752441406, abs dis: 4.3550262451171875
[rfa agg] iter: 7, weight: tensor([0.0390, 0.0549, 0.1346, 0.0822, 0.1035, 0.1026, 0.0710, 0.2467, 0.0614,
        0.1041])
[rfa agg] iter:  8, prev_obj_val: 48.258033752441406, obj_val: 52.613059997558594, abs dis: 4.3550262451171875
[rfa agg] iter: 8, weight: tensor([0.0313, 0.0457, 0.1355, 0.0724, 0.0954, 0.0940, 0.0609, 0.3172, 0.0517,
        0.0959])
[rfa agg] iter:  9, prev_obj_val: 52.613059997558594, obj_val: 48.258033752441406, abs dis: 4.3550262451171875
[rfa agg] iter: 9, weight: tensor([0.0390, 0.0549, 0.1346, 0.0822, 0.1035, 0.1026, 0.0710, 0.2467, 0.0614,
        0.1041])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3435, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.0758, Accuracy: 8052/9950 (80.9246%)
saving model
Done in 743.7945358753204 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0425, Accuracy: 1059/1750 (60.5143%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0258, Accuracy: 1098/1750 (62.7429%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Avg loss: 0.0242, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Avg loss: 0.0236, Accuracy: 1096/1750 (62.6286%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Avg loss: 0.0231, Accuracy: 1099/1750 (62.8000%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Avg loss: 0.0230, Accuracy: 1105/1750 (63.1429%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Avg loss: 0.0224, Accuracy: 1106/1750 (63.2000%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Avg loss: 0.0226, Accuracy: 1106/1750 (63.2000%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Avg loss: 0.0222, Accuracy: 1107/1750 (63.2571%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Avg loss: 0.0221, Accuracy: 1108/1750 (63.3143%), train_poison_data_count: 1102
Global model norm: 111.98393352257055.
Norm before scaling: 111.95201172684438. Distance: 0.9599078795321756
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5225, Accuracy: 54/10000 (0.5400%)
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: 0.4024, Accuracy: 9927/9950 (99.7688%)
Scaling by  100
Scaled Norm after poisoning: 144.73310566349357, distance: 95.99078324896615
Total norm for 5 adversaries is: 144.73310566349357. distance: 95.99078324896615
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0498, Accuracy: 285/888 (32.0946%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 474/888 (53.3784%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.1578, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0435, Accuracy: 435/1036 (41.9884%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 691/1036 (66.6988%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.2527, Accuracy: 72/10000 (0.7200%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0470, Accuracy: 454/1628 (27.8870%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0236, Accuracy: 918/1628 (56.3882%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.5905, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0517, Accuracy: 318/712 (44.6629%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0240, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.8640, Accuracy: 70/10000 (0.7000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 277/590 (46.9492%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 11.7557, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0479, Accuracy: 671/2227 (30.1302%)
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0264, Accuracy: 1084/2227 (48.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4540, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0544, Accuracy: 320/1049 (30.5052%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0270, Accuracy: 556/1049 (53.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3539, Accuracy: 117/10000 (1.1700%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0485, Accuracy: 492/1129 (43.5784%)
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0214, Accuracy: 773/1129 (68.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.5189, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0552, Accuracy: 303/677 (44.7563%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.6212, Accuracy: 60/10000 (0.6000%)
time spent on training: 416.8655710220337
[rfa agg] training data poison_ratio: 0.626732842717782  data num: [1750, 888, 1036, 1628, 712, 590, 2227, 1049, 1129, 677]
[rfa agg] considering poison per batch poison_fraction: 0.3917080266986137
[rfa agg] init. name: [44, 63, 19, 5, 11, 69, 60, 51, 37, 90], weight: tensor([0.1498, 0.0760, 0.0887, 0.1393, 0.0609, 0.0505, 0.1906, 0.0898, 0.0966,
        0.0579])
[rfa agg] iter:  0, prev_obj_val: 31833.998046875, obj_val: 21342.169921875, abs dis: 10491.828125
[rfa agg] iter: 0, weight: tensor([0.0301, 0.0864, 0.1009, 0.1593, 0.0692, 0.0573, 0.2188, 0.1022, 0.1100,
        0.0658])
[rfa agg] iter:  1, prev_obj_val: 21342.169921875, obj_val: 19186.822265625, abs dis: 2155.34765625
[rfa agg] iter: 1, weight: tensor([0.0054, 0.0874, 0.1026, 0.1648, 0.0697, 0.0575, 0.2305, 0.1039, 0.1121,
        0.0661])
[rfa agg] iter:  2, prev_obj_val: 19186.822265625, obj_val: 18804.1328125, abs dis: 382.689453125
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0802, 0.0971, 0.1725, 0.0627, 0.0508, 0.2714, 0.0983, 0.1072,
        0.0589])
[rfa agg] iter:  3, prev_obj_val: 18804.1328125, obj_val: 18787.6640625, abs dis: 16.46875
[rfa agg] iter: 3, weight: tensor([8.7119e-05, 3.3354e-02, 4.6415e-02, 1.7263e-01, 2.4137e-02, 1.8226e-02,
        5.8228e-01, 4.6957e-02, 5.4029e-02, 2.1887e-02])
[rfa agg] iter:  4, prev_obj_val: 18787.6640625, obj_val: 18784.318359375, abs dis: 3.345703125
[rfa agg] iter: 4, weight: tensor([5.7035e-05, 3.2265e-02, 4.9390e-02, 6.3093e-01, 2.2318e-02, 1.6264e-02,
        1.1908e-01, 4.9877e-02, 5.9947e-02, 1.9862e-02])
[rfa agg] iter:  5, prev_obj_val: 18784.318359375, obj_val: 18783.490234375, abs dis: 0.828125
[rfa agg] iter: 5, weight: tensor([8.1626e-05, 6.7804e-02, 1.2104e-01, 3.0147e-01, 4.4077e-02, 3.0707e-02,
        1.1559e-01, 1.2176e-01, 1.5917e-01, 3.8303e-02])
[rfa agg] iter:  6, prev_obj_val: 18783.490234375, obj_val: 18784.224609375, abs dis: 0.734375
[rfa agg] iter: 6, weight: tensor([6.3499e-05, 7.4613e-02, 1.6946e-01, 1.3674e-01, 4.4995e-02, 2.9865e-02,
        7.5101e-02, 1.6868e-01, 2.6240e-01, 3.8081e-02])
[rfa agg] iter:  7, prev_obj_val: 18784.224609375, obj_val: 18788.9765625, abs dis: 4.751953125
[rfa agg] iter: 7, weight: tensor([2.9373e-05, 5.8492e-02, 2.6634e-01, 4.4727e-02, 3.0178e-02, 1.8392e-02,
        2.9801e-02, 2.3583e-01, 2.9185e-01, 2.4351e-02])
[rfa agg] iter:  8, prev_obj_val: 18788.9765625, obj_val: 18793.337890625, abs dis: 4.361328125
[rfa agg] iter: 8, weight: tensor([3.8336e-05, 1.2823e-01, 2.5627e-01, 4.9648e-02, 5.3778e-02, 2.9936e-02,
        3.5832e-02, 2.4330e-01, 1.6178e-01, 4.1182e-02])
[rfa agg] iter:  9, prev_obj_val: 18793.337890625, obj_val: 18798.052734375, abs dis: 4.71484375
[rfa agg] iter: 9, weight: tensor([4.3792e-05, 2.6140e-01, 1.7161e-01, 5.1613e-02, 8.1230e-02, 4.0996e-02,
        3.8899e-02, 1.6907e-01, 1.2647e-01, 5.8673e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3432, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 4.1044, Accuracy: 7192/9950 (72.2814%)
saving model
Done in 877.695955991745 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0564, Accuracy: 300/1131 (26.5252%)
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0303, Accuracy: 422/1131 (37.3121%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5019, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0532, Accuracy: 309/677 (45.6425%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.6875, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0321, Accuracy: 642/1581 (40.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8702, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0477, Accuracy: 310/888 (34.9099%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0235, Accuracy: 493/888 (55.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.3223, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0490, Accuracy: 350/928 (37.7155%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0217, Accuracy: 642/928 (69.1810%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.4080, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1242, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1041, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3728, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0537, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0297, Accuracy: 755/1904 (39.6534%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1027, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0575, Accuracy: 303/1402 (21.6120%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0368, Accuracy: 448/1402 (31.9544%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0092, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0518, Accuracy: 412/1573 (26.1920%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0331, Accuracy: 651/1573 (41.3859%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3474, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0505, Accuracy: 390/1030 (37.8641%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0232, Accuracy: 672/1030 (65.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.4021, Accuracy: 107/10000 (1.0700%)
time spent on training: 319.3192298412323
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 677, 1581, 888, 928, 134, 1904, 1402, 1573, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 90, 28, 63, 1, 47, 46, 66, 40, 91], weight: tensor([0.1006, 0.0602, 0.1406, 0.0789, 0.0825, 0.0119, 0.1693, 0.1246, 0.1398,
        0.0916])
[rfa agg] iter:  0, prev_obj_val: 50.16982650756836, obj_val: 52.61762237548828, abs dis: 2.447795867919922
[rfa agg] iter: 0, weight: tensor([0.2467, 0.0283, 0.1011, 0.0571, 0.0722, 0.0029, 0.0643, 0.1891, 0.1004,
        0.1379])
[rfa agg] iter:  1, prev_obj_val: 52.61762237548828, obj_val: 55.819427490234375, abs dis: 3.2018051147460938
[rfa agg] iter: 1, weight: tensor([0.4666, 0.0219, 0.0508, 0.0496, 0.0676, 0.0020, 0.0358, 0.0779, 0.0505,
        0.1773])
[rfa agg] iter:  2, prev_obj_val: 55.819427490234375, obj_val: 57.843204498291016, abs dis: 2.0237770080566406
[rfa agg] iter: 2, weight: tensor([0.2678, 0.0286, 0.0500, 0.0734, 0.1092, 0.0024, 0.0372, 0.0703, 0.0497,
        0.3112])
[rfa agg] iter:  3, prev_obj_val: 57.843204498291016, obj_val: 62.58730697631836, abs dis: 4.744102478027344
[rfa agg] iter: 3, weight: tensor([0.1906, 0.0331, 0.0500, 0.0924, 0.1476, 0.0027, 0.0380, 0.0680, 0.0497,
        0.3279])
[rfa agg] iter:  4, prev_obj_val: 62.58730697631836, obj_val: 65.13056182861328, abs dis: 2.543254852294922
[rfa agg] iter: 4, weight: tensor([0.1274, 0.0433, 0.0481, 0.1556, 0.2926, 0.0031, 0.0380, 0.0620, 0.0478,
        0.1822])
[rfa agg] iter:  5, prev_obj_val: 65.13056182861328, obj_val: 65.11139678955078, abs dis: 0.0191650390625
[rfa agg] iter: 5, weight: tensor([0.0944, 0.0429, 0.0403, 0.1922, 0.3819, 0.0029, 0.0324, 0.0509, 0.0401,
        0.1221])
[rfa agg] iter:  6, prev_obj_val: 65.11139678955078, obj_val: 71.29894256591797, abs dis: 6.1875457763671875
[rfa agg] iter: 6, weight: tensor([0.0892, 0.0406, 0.0382, 0.1828, 0.4157, 0.0027, 0.0307, 0.0481, 0.0379,
        0.1141])
[rfa agg] iter:  7, prev_obj_val: 71.29894256591797, obj_val: 74.77476501464844, abs dis: 3.4758224487304688
[rfa agg] iter: 7, weight: tensor([0.0767, 0.0609, 0.0394, 0.3821, 0.2274, 0.0033, 0.0327, 0.0479, 0.0392,
        0.0905])
[rfa agg] iter:  8, prev_obj_val: 74.77476501464844, obj_val: 68.04753112792969, abs dis: 6.72723388671875
[rfa agg] iter: 8, weight: tensor([0.0767, 0.0817, 0.0423, 0.4058, 0.1735, 0.0039, 0.0355, 0.0506, 0.0421,
        0.0878])
[rfa agg] iter:  9, prev_obj_val: 68.04753112792969, obj_val: 74.78158569335938, abs dis: 6.7340545654296875
[rfa agg] iter: 9, weight: tensor([0.0812, 0.0489, 0.0384, 0.3460, 0.2667, 0.0030, 0.0313, 0.0475, 0.0382,
        0.0989])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3465, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 4.1592, Accuracy: 4935/9950 (49.5980%)
saving model
Done in 788.2641687393188 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Avg loss: 0.0517, Accuracy: 355/631 (56.2599%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Avg loss: 0.0367, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Avg loss: 0.0268, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Avg loss: 0.0254, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Avg loss: 0.0256, Accuracy: 399/631 (63.2330%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Avg loss: 0.0255, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Avg loss: 0.0253, Accuracy: 401/631 (63.5499%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Avg loss: 0.0256, Accuracy: 401/631 (63.5499%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Avg loss: 0.0240, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Avg loss: 0.0243, Accuracy: 401/631 (63.5499%), train_poison_data_count: 400
Global model norm: 111.9813740092521.
Norm before scaling: 111.97279245423863. Distance: 0.5751175625491602
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0877, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: 0.4282, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 124.98914405984425, distance: 57.51176000664994
Total norm for 2 adversaries is: 124.98914405984425. distance: 57.51176000664994
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0599, Accuracy: 289/719 (40.1947%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0301, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1467, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0541, Accuracy: 251/938 (26.7591%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0305, Accuracy: 399/938 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.2851, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0492, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0250, Accuracy: 511/1089 (46.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.8970, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0527, Accuracy: 423/1645 (25.7143%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 746/1645 (45.3495%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3305, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0540, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0331, Accuracy: 548/1446 (37.8976%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7083, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0504, Accuracy: 253/735 (34.4218%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0199, Accuracy: 367/735 (49.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.5818, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0523, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.8262, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 204/773 (26.3907%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0279, Accuracy: 452/773 (58.4735%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.0061, Accuracy: 97/10000 (0.9700%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0538, Accuracy: 289/1071 (26.9841%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0280, Accuracy: 571/1071 (53.3147%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.2189, Accuracy: 89/10000 (0.8900%)
time spent on training: 416.07054328918457
[rfa agg] training data poison_ratio: 0.16684638760905793  data num: [631, 719, 938, 1089, 1645, 1446, 735, 1154, 773, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.1042789922556612
[rfa agg] init. name: [48, 41, 73, 59, 13, 26, 32, 57, 99, 55], weight: tensor([0.0619, 0.0705, 0.0920, 0.1068, 0.1613, 0.1418, 0.0721, 0.1131, 0.0758,
        0.1050])
[rfa agg] iter:  0, prev_obj_val: 5146.84326171875, obj_val: 2905.1865234375, abs dis: 2241.65673828125
[rfa agg] iter: 0, weight: tensor([0.0043, 0.0732, 0.0965, 0.1131, 0.1754, 0.1527, 0.0749, 0.1202, 0.0790,
        0.1108])
[rfa agg] iter:  1, prev_obj_val: 2905.1865234375, obj_val: 2792.10302734375, abs dis: 113.08349609375
[rfa agg] iter: 1, weight: tensor([2.3426e-04, 5.1927e-02, 7.6772e-02, 1.0276e-01, 2.6264e-01, 1.8351e-01,
        5.3085e-02, 1.1480e-01, 5.8107e-02, 9.6176e-02])
[rfa agg] iter:  2, prev_obj_val: 2792.10302734375, obj_val: 2797.677734375, abs dis: 5.57470703125
[rfa agg] iter: 2, weight: tensor([3.4449e-05, 2.7761e-02, 6.2715e-02, 2.0938e-01, 6.3498e-02, 9.6904e-02,
        2.8403e-02, 3.4182e-01, 3.4750e-02, 1.3473e-01])
[rfa agg] iter:  3, prev_obj_val: 2797.677734375, obj_val: 2801.652587890625, abs dis: 3.974853515625
[rfa agg] iter: 3, weight: tensor([3.7454e-05, 5.9155e-02, 2.8860e-01, 1.2175e-01, 4.6120e-02, 5.6702e-02,
        6.0936e-02, 9.5822e-02, 8.7323e-02, 1.8356e-01])
[rfa agg] iter:  4, prev_obj_val: 2801.652587890625, obj_val: 2806.6904296875, abs dis: 5.037841796875
[rfa agg] iter: 4, weight: tensor([3.5855e-05, 7.7905e-02, 3.4834e-01, 8.4997e-02, 4.0363e-02, 4.8004e-02,
        8.0572e-02, 7.1177e-02, 1.3215e-01, 1.1645e-01])
[rfa agg] iter:  5, prev_obj_val: 2806.6904296875, obj_val: 2809.3837890625, abs dis: 2.693359375
[rfa agg] iter: 5, weight: tensor([3.7108e-05, 1.2542e-01, 1.7323e-01, 6.9280e-02, 3.8461e-02, 4.4496e-02,
        1.3181e-01, 6.0644e-02, 2.6906e-01, 8.7568e-02])
[rfa agg] iter:  6, prev_obj_val: 2809.3837890625, obj_val: 2816.006103515625, abs dis: 6.622314453125
[rfa agg] iter: 6, weight: tensor([3.1564e-05, 1.4674e-01, 1.1096e-01, 5.3255e-02, 3.1464e-02, 3.5966e-02,
        1.5705e-01, 4.7433e-02, 3.5155e-01, 6.5557e-02])
[rfa agg] iter:  7, prev_obj_val: 2816.006103515625, obj_val: 2815.946533203125, abs dis: 0.0595703125
[rfa agg] iter: 7, weight: tensor([3.1136e-05, 2.5471e-01, 7.4769e-02, 4.4019e-02, 2.8835e-02, 3.2270e-02,
        3.0179e-01, 4.0229e-02, 1.7129e-01, 5.2060e-02])
[rfa agg] iter:  8, prev_obj_val: 2815.946533203125, obj_val: 2819.9580078125, abs dis: 4.011474609375
[rfa agg] iter: 8, weight: tensor([2.8847e-05, 2.6740e-01, 6.9138e-02, 4.0787e-02, 2.6715e-02, 2.9900e-02,
        3.3112e-01, 3.7274e-02, 1.4942e-01, 4.8221e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3485, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 3.9331, Accuracy: 7752/9950 (77.9095%)
saving model
Done in 854.2354972362518 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 428/1418 (30.1834%)
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0292, Accuracy: 699/1418 (49.2948%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2216, Accuracy: 114/10000 (1.1400%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0472, Accuracy: 483/1129 (42.7812%)
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0210, Accuracy: 772/1129 (68.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.1615, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0530, Accuracy: 381/1645 (23.1611%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 734/1645 (44.6201%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2361, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 305/712 (42.8371%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0240, Accuracy: 427/712 (59.9719%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.0669, Accuracy: 72/10000 (0.7200%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0530, Accuracy: 442/1475 (29.9661%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0282, Accuracy: 755/1475 (51.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9380, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0657, Accuracy: 152/682 (22.2874%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0359, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0381, Accuracy: 83/10000 (0.8300%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.0776, Accuracy: 51/440 (11.5909%)
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0464, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.5629, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 282/530 (53.2075%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.5259, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 351/1446 (24.2739%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0325, Accuracy: 568/1446 (39.2808%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7607, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0738, Accuracy: 80/500 (16.0000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 216/500 (43.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6011, Accuracy: 71/10000 (0.7100%)
time spent on training: 278.30977606773376
[rfa agg] training data poison_ratio: 0.3582239150045104  data num: [1418, 1129, 1645, 712, 1475, 682, 440, 530, 1446, 500]
[rfa agg] considering poison per batch poison_fraction: 0.223889946877819
[rfa agg] init. name: [70, 37, 13, 11, 65, 80, 49, 18, 26, 82], weight: tensor([0.1421, 0.1132, 0.1649, 0.0714, 0.1478, 0.0684, 0.0441, 0.0531, 0.1449,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 60.08672332763672, obj_val: 61.89311218261719, abs dis: 1.8063888549804688
[rfa agg] iter: 0, weight: tensor([0.1137, 0.3387, 0.0905, 0.0822, 0.1023, 0.0647, 0.0243, 0.0370, 0.1158,
        0.0308])
[rfa agg] iter:  1, prev_obj_val: 61.89311218261719, obj_val: 63.76469802856445, abs dis: 1.8715858459472656
[rfa agg] iter: 1, weight: tensor([0.1126, 0.2999, 0.0917, 0.0985, 0.1024, 0.0757, 0.0273, 0.0423, 0.1146,
        0.0349])
[rfa agg] iter:  2, prev_obj_val: 63.76469802856445, obj_val: 65.6455078125, abs dis: 1.8808097839355469
[rfa agg] iter: 2, weight: tensor([0.1111, 0.2569, 0.0922, 0.1185, 0.1018, 0.0886, 0.0305, 0.0480, 0.1131,
        0.0393])
[rfa agg] iter:  3, prev_obj_val: 65.6455078125, obj_val: 67.53453826904297, abs dis: 1.8890304565429688
[rfa agg] iter: 3, weight: tensor([0.1070, 0.2216, 0.0904, 0.1414, 0.0988, 0.1021, 0.0333, 0.0534, 0.1089,
        0.0432])
[rfa agg] iter:  4, prev_obj_val: 67.53453826904297, obj_val: 67.53365325927734, abs dis: 0.000885009765625
[rfa agg] iter: 4, weight: tensor([0.1008, 0.1911, 0.0865, 0.1686, 0.0937, 0.1164, 0.0355, 0.0582, 0.1027,
        0.0465])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3463, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 3.9587, Accuracy: 7612/9950 (76.5025%)
saving model
Done in 713.1082334518433 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Avg loss: 0.0567, Accuracy: 253/440 (57.5000%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Avg loss: 0.0384, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Avg loss: 0.0385, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Avg loss: 0.0340, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Avg loss: 0.0313, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Avg loss: 0.0295, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Avg loss: 0.0283, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Avg loss: 0.0279, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Avg loss: 0.0272, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Avg loss: 0.0272, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Global model norm: 111.97890600744856.
Norm before scaling: 111.9736602328311. Distance: 0.45934370868531377
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.7418, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: 0.4873, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 120.46016911722315, distance: 45.93436957871252
Total norm for 4 adversaries is: 120.46016911722315. distance: 45.93436957871252
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0781, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 201/312 (64.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.6553, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0525, Accuracy: 422/1949 (21.6521%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0319, Accuracy: 666/1949 (34.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.4723, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0539, Accuracy: 297/677 (43.8700%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.2223, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0410, Accuracy: 471/1036 (45.4633%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0221, Accuracy: 740/1036 (71.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 13.1273, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0527, Accuracy: 408/1573 (25.9377%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0332, Accuracy: 624/1573 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8158, Accuracy: 75/10000 (0.7500%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0569, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0297, Accuracy: 483/1190 (40.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3676, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0702, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0399, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3028, Accuracy: 57/10000 (0.5700%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0466, Accuracy: 511/1129 (45.2613%)
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0207, Accuracy: 784/1129 (69.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8671, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0544, Accuracy: 454/1418 (32.0169%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0286, Accuracy: 698/1418 (49.2243%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3261, Accuracy: 104/10000 (1.0400%)
time spent on training: 363.1305184364319
[rfa agg] training data poison_ratio: 0.29838709677419356  data num: [440, 312, 1949, 677, 1036, 1573, 1190, 568, 1129, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.18649193548387097
[rfa agg] init. name: [49, 24, 21, 90, 19, 40, 84, 62, 37, 70], weight: tensor([0.0428, 0.0303, 0.1894, 0.0658, 0.1007, 0.1528, 0.1156, 0.0552, 0.1097,
        0.1378])
[rfa agg] iter:  0, prev_obj_val: 2524.8291015625, obj_val: 1388.9942626953125, abs dis: 1135.8348388671875
[rfa agg] iter: 0, weight: tensor([0.0019, 0.0284, 0.2114, 0.0640, 0.1019, 0.1634, 0.1186, 0.0530, 0.1118,
        0.1453])
[rfa agg] iter:  1, prev_obj_val: 1388.9942626953125, obj_val: 1380.6246337890625, abs dis: 8.36962890625
[rfa agg] iter: 1, weight: tensor([4.8686e-05, 5.7107e-03, 1.4773e-01, 1.7335e-02, 4.4143e-02, 4.7734e-01,
        6.4842e-02, 1.2840e-02, 5.3861e-02, 1.7616e-01])
[rfa agg] iter:  2, prev_obj_val: 1380.6246337890625, obj_val: 1381.44189453125, abs dis: 0.8172607421875
[rfa agg] iter: 2, weight: tensor([4.5250e-05, 6.5622e-03, 7.7055e-02, 2.1966e-02, 7.3344e-02, 1.8499e-01,
        1.3522e-01, 1.5615e-02, 9.7507e-02, 3.8769e-01])
[rfa agg] iter:  3, prev_obj_val: 1381.44189453125, obj_val: 1383.4627685546875, abs dis: 2.0208740234375
[rfa agg] iter: 3, weight: tensor([4.4496e-05, 7.3168e-03, 6.2113e-02, 2.6393e-02, 1.1830e-01, 1.0931e-01,
        3.1658e-01, 1.8153e-02, 1.7830e-01, 1.6348e-01])
[rfa agg] iter:  4, prev_obj_val: 1383.4627685546875, obj_val: 1389.1888427734375, abs dis: 5.72607421875
[rfa agg] iter: 4, weight: tensor([3.1362e-05, 5.7315e-03, 3.8572e-02, 2.2295e-02, 1.5480e-01, 5.9559e-02,
        3.5289e-01, 1.4811e-02, 2.7424e-01, 7.7075e-02])
[rfa agg] iter:  5, prev_obj_val: 1389.1888427734375, obj_val: 1394.7357177734375, abs dis: 5.546875
[rfa agg] iter: 5, weight: tensor([3.4943e-05, 7.1844e-03, 3.8403e-02, 3.0960e-02, 3.8514e-01, 5.4049e-02,
        1.5641e-01, 1.9579e-02, 2.4353e-01, 6.4714e-02])
[rfa agg] iter:  6, prev_obj_val: 1394.7357177734375, obj_val: 1389.0611572265625, abs dis: 5.674560546875
[rfa agg] iter: 6, weight: tensor([4.9179e-05, 1.1036e-02, 5.0489e-02, 5.2226e-02, 3.5731e-01, 6.7757e-02,
        1.4861e-01, 3.1500e-02, 2.0268e-01, 7.8339e-02])
[rfa agg] iter:  7, prev_obj_val: 1389.0611572265625, obj_val: 1391.7747802734375, abs dis: 2.713623046875
[rfa agg] iter: 7, weight: tensor([3.0195e-05, 6.2110e-03, 3.3197e-02, 2.6806e-02, 4.8009e-01, 4.6746e-02,
        1.3087e-01, 1.6936e-02, 2.0314e-01, 5.5985e-02])
[rfa agg] iter:  8, prev_obj_val: 1391.7747802734375, obj_val: 1394.7379150390625, abs dis: 2.963134765625
[rfa agg] iter: 8, weight: tensor([3.7080e-05, 7.9584e-03, 3.9368e-02, 3.5846e-02, 4.5598e-01, 5.4052e-02,
        1.3169e-01, 2.2173e-02, 1.8937e-01, 6.3516e-02])
[rfa agg] iter:  9, prev_obj_val: 1394.7379150390625, obj_val: 1389.0594482421875, abs dis: 5.678466796875
[rfa agg] iter: 9, weight: tensor([4.8787e-05, 1.0948e-02, 5.0089e-02, 5.1816e-02, 3.6534e-01, 6.7223e-02,
        1.4703e-01, 3.1254e-02, 1.9853e-01, 7.7716e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3447, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 4.0146, Accuracy: 7025/9950 (70.6030%)
saving model
Done in 807.5481865406036 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0505, Accuracy: 313/599 (52.2538%)
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 11.6910, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0536, Accuracy: 334/1130 (29.5575%)
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0275, Accuracy: 489/1130 (43.2743%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.1341, Accuracy: 61/10000 (0.6100%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0462, Accuracy: 473/1628 (29.0541%)
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0231, Accuracy: 958/1628 (58.8452%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.8825, Accuracy: 146/10000 (1.4600%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0731, Accuracy: 81/426 (19.0141%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0390, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3609, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1204, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1058, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3809, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0497, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0239, Accuracy: 589/1013 (58.1441%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.8223, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0517, Accuracy: 314/712 (44.1011%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.8670, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0491, Accuracy: 360/1089 (33.0579%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0257, Accuracy: 556/1089 (51.0560%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.1775, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0531, Accuracy: 472/1953 (24.1679%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0320, Accuracy: 826/1953 (42.2939%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.9282, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0532, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 742/1956 (37.9346%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3384, Accuracy: 122/10000 (1.2200%)
time spent on training: 252.01122093200684
[rfa agg] training data poison_ratio: 0.31550751879699246  data num: [599, 1130, 1628, 426, 134, 1013, 712, 1089, 1953, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.1971921992481203
[rfa agg] init. name: [95, 54, 5, 67, 47, 39, 11, 59, 83, 6], weight: tensor([0.0563, 0.1062, 0.1530, 0.0400, 0.0126, 0.0952, 0.0669, 0.1023, 0.1836,
        0.1838])
[rfa agg] iter:  0, prev_obj_val: 68.51748657226562, obj_val: 69.53570556640625, abs dis: 1.018218994140625
[rfa agg] iter: 0, weight: tensor([0.0289, 0.2555, 0.1298, 0.0158, 0.0038, 0.1205, 0.0429, 0.2316, 0.0855,
        0.0856])
[rfa agg] iter:  1, prev_obj_val: 69.53570556640625, obj_val: 75.65864562988281, abs dis: 6.1229400634765625
[rfa agg] iter: 1, weight: tensor([0.0197, 0.3878, 0.0603, 0.0104, 0.0024, 0.1091, 0.0305, 0.2925, 0.0436,
        0.0437])
[rfa agg] iter:  2, prev_obj_val: 75.65864562988281, obj_val: 77.78218841552734, abs dis: 2.1235427856445312
[rfa agg] iter: 2, weight: tensor([0.0286, 0.2203, 0.0533, 0.0140, 0.0031, 0.3513, 0.0489, 0.1965, 0.0420,
        0.0420])
[rfa agg] iter:  3, prev_obj_val: 77.78218841552734, obj_val: 77.73019409179688, abs dis: 0.05199432373046875
[rfa agg] iter: 3, weight: tensor([0.0268, 0.1453, 0.0437, 0.0128, 0.0028, 0.5194, 0.0475, 0.1316, 0.0351,
        0.0351])
[rfa agg] iter:  4, prev_obj_val: 77.73019409179688, obj_val: 86.01759338378906, abs dis: 8.287399291992188
[rfa agg] iter: 4, weight: tensor([0.0224, 0.1205, 0.0366, 0.0107, 0.0023, 0.6014, 0.0397, 0.1078, 0.0293,
        0.0294])
[rfa agg] iter:  5, prev_obj_val: 86.01759338378906, obj_val: 77.78297424316406, abs dis: 8.234619140625
[rfa agg] iter: 5, weight: tensor([0.0620, 0.1487, 0.0663, 0.0266, 0.0055, 0.3108, 0.1298, 0.1391, 0.0556,
        0.0556])
[rfa agg] iter:  6, prev_obj_val: 77.78297424316406, obj_val: 77.72887420654297, abs dis: 0.05410003662109375
[rfa agg] iter: 6, weight: tensor([0.0266, 0.1433, 0.0433, 0.0126, 0.0028, 0.5257, 0.0472, 0.1290, 0.0348,
        0.0348])
[rfa agg] iter:  7, prev_obj_val: 77.72887420654297, obj_val: 86.01858520507812, abs dis: 8.289710998535156
[rfa agg] iter: 7, weight: tensor([0.0222, 0.1194, 0.0363, 0.0106, 0.0023, 0.6049, 0.0394, 0.1067, 0.0291,
        0.0291])
[rfa agg] iter:  8, prev_obj_val: 86.01858520507812, obj_val: 77.78295135498047, abs dis: 8.235633850097656
[rfa agg] iter: 8, weight: tensor([0.0620, 0.1486, 0.0663, 0.0266, 0.0055, 0.3109, 0.1298, 0.1390, 0.0556,
        0.0556])
[rfa agg] iter:  9, prev_obj_val: 77.78295135498047, obj_val: 77.72887420654297, abs dis: 0.0540771484375
[rfa agg] iter: 9, weight: tensor([0.0266, 0.1433, 0.0433, 0.0126, 0.0028, 0.5257, 0.0472, 0.1290, 0.0348,
        0.0348])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3454, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.0666, Accuracy: 6661/9950 (66.9447%)
saving model
Done in 689.3715572357178 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Avg loss: 0.0437, Accuracy: 696/1130 (61.5929%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Avg loss: 0.0238, Accuracy: 683/1130 (60.4425%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Avg loss: 0.0211, Accuracy: 719/1130 (63.6283%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Avg loss: 0.0207, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Avg loss: 0.0199, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Avg loss: 0.0206, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Avg loss: 0.0196, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Avg loss: 0.0201, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Avg loss: 0.0197, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Avg loss: 0.0197, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Global model norm: 111.97596264796074.
Norm before scaling: 111.95745913627194. Distance: 0.7997092165575298
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1006, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: 0.4337, Accuracy: 9941/9950 (99.9095%)
Scaling by  100
Scaled Norm after poisoning: 135.85143827449895, distance: 79.97091756538748
Total norm for 5 adversaries is: 135.85143827449895. distance: 79.97091756538748
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1214, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1062, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3850, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 232/861 (26.9454%)
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0195, Accuracy: 493/861 (57.2590%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.4991, Accuracy: 101/10000 (1.0100%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.0900, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.6950, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0553, Accuracy: 380/1657 (22.9330%)
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 559/1657 (33.7357%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1134, Accuracy: 89/10000 (0.8900%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0763, Accuracy: 55/440 (12.5000%)
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.7237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 211/1013 (20.8292%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0334, Accuracy: 394/1013 (38.8944%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3496, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 253/636 (39.7799%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0293, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3257, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0527, Accuracy: 360/1049 (34.3184%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0260, Accuracy: 599/1049 (57.1020%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2910, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0539, Accuracy: 418/1904 (21.9538%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0292, Accuracy: 796/1904 (41.8067%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9605, Accuracy: 111/10000 (1.1100%)
time spent on training: 385.0096044540405
[rfa agg] training data poison_ratio: 0.48308229644182493  data num: [1130, 134, 861, 338, 1657, 440, 1013, 636, 1049, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.3019264352761406
[rfa agg] init. name: [54, 47, 10, 12, 0, 49, 14, 52, 51, 46], weight: tensor([0.1233, 0.0146, 0.0940, 0.0369, 0.1809, 0.0480, 0.1106, 0.0694, 0.1145,
        0.2078])
[rfa agg] iter:  0, prev_obj_val: 17355.359375, obj_val: 11061.65625, abs dis: 6293.703125
[rfa agg] iter: 0, weight: tensor([0.0194, 0.0161, 0.1046, 0.0408, 0.2035, 0.0531, 0.1233, 0.0770, 0.1278,
        0.2346])
[rfa agg] iter:  1, prev_obj_val: 11061.65625, obj_val: 10057.7412109375, abs dis: 1003.9150390625
[rfa agg] iter: 1, weight: tensor([0.0027, 0.0151, 0.1032, 0.0388, 0.2131, 0.0507, 0.1228, 0.0746, 0.1279,
        0.2510])
[rfa agg] iter:  2, prev_obj_val: 10057.7412109375, obj_val: 9965.7314453125, abs dis: 92.009765625
[rfa agg] iter: 2, weight: tensor([3.0125e-04, 8.2053e-03, 7.3409e-02, 2.2421e-02, 2.4700e-01, 3.0021e-02,
        9.3021e-02, 4.7455e-02, 1.0012e-01, 3.7805e-01])
[rfa agg] iter:  3, prev_obj_val: 9965.7314453125, obj_val: 9966.015625, abs dis: 0.2841796875
[rfa agg] iter: 3, weight: tensor([9.5468e-05, 5.0799e-03, 7.2250e-02, 1.5072e-02, 4.0463e-01, 2.0846e-02,
        1.0923e-01, 3.7045e-02, 1.3042e-01, 2.0533e-01])
[rfa agg] iter:  4, prev_obj_val: 9966.015625, obj_val: 9966.6689453125, abs dis: 0.6533203125
[rfa agg] iter: 4, weight: tensor([1.0263e-04, 5.9041e-03, 9.3054e-02, 1.7771e-02, 2.9766e-01, 2.4727e-02,
        1.4907e-01, 4.5001e-02, 1.8508e-01, 1.8164e-01])
[rfa agg] iter:  5, prev_obj_val: 9966.6689453125, obj_val: 9967.8837890625, abs dis: 1.21484375
[rfa agg] iter: 5, weight: tensor([8.2718e-05, 5.5035e-03, 1.1186e-01, 1.7080e-02, 1.5488e-01, 2.4083e-02,
        2.1705e-01, 4.6311e-02, 3.0973e-01, 1.1342e-01])
[rfa agg] iter:  6, prev_obj_val: 9967.8837890625, obj_val: 9971.876953125, abs dis: 3.9931640625
[rfa agg] iter: 6, weight: tensor([4.3416e-05, 3.3014e-03, 9.6009e-02, 1.0594e-02, 6.3279e-02, 1.5162e-02,
        2.9287e-01, 3.1192e-02, 4.3713e-01, 5.0413e-02])
[rfa agg] iter:  7, prev_obj_val: 9971.876953125, obj_val: 9975.939453125, abs dis: 4.0625
[rfa agg] iter: 7, weight: tensor([4.4839e-05, 3.8174e-03, 1.7955e-01, 1.2659e-02, 5.6037e-02, 1.8398e-02,
        4.1562e-01, 4.0805e-02, 2.2637e-01, 4.6690e-02])
[rfa agg] iter:  8, prev_obj_val: 9975.939453125, obj_val: 9978.1884765625, abs dis: 2.2490234375
[rfa agg] iter: 8, weight: tensor([4.9277e-05, 4.5624e-03, 3.9275e-01, 1.5559e-02, 5.6294e-02, 2.2937e-02,
        2.5138e-01, 5.4806e-02, 1.5363e-01, 4.8034e-02])
[rfa agg] iter:  9, prev_obj_val: 9978.1884765625, obj_val: 9978.140625, abs dis: 0.0478515625
[rfa agg] iter: 9, weight: tensor([4.1208e-05, 3.9890e-03, 5.5868e-01, 1.3822e-02, 4.5121e-02, 2.0554e-02,
        1.5896e-01, 5.1404e-02, 1.0851e-01, 3.8919e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3426, Accuracy: 94/10000 (0.9400%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.1175, Accuracy: 6283/9950 (63.1457%)
saving model
Done in 823.9736304283142 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0277, Accuracy: 489/1130 (43.2743%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4385, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0578, Accuracy: 256/636 (40.2516%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0292, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.3962, Accuracy: 53/10000 (0.5300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0512, Accuracy: 255/861 (29.6167%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0187, Accuracy: 505/861 (58.6527%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.7094, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0506, Accuracy: 379/1440 (26.3194%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0257, Accuracy: 718/1440 (49.8611%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.8160, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0520, Accuracy: 430/1573 (27.3363%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0333, Accuracy: 630/1573 (40.0509%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7582, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.0909, Accuracy: 7/271 (2.5830%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0552, Accuracy: 127/271 (46.8635%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.3845, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0598, Accuracy: 189/809 (23.3622%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0245, Accuracy: 416/809 (51.4215%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.2637, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 399/1427 (27.9608%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0320, Accuracy: 616/1427 (43.1675%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7548, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0640, Accuracy: 231/773 (29.8836%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0286, Accuracy: 430/773 (55.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4586, Accuracy: 84/10000 (0.8400%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.0843, Accuracy: 48/408 (11.7647%)
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0482, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.0176, Accuracy: 56/10000 (0.5600%)
time spent on training: 245.49942874908447
[rfa agg] training data poison_ratio: 0.2571826758147513  data num: [1130, 636, 861, 1440, 1573, 271, 809, 1427, 773, 408]
[rfa agg] considering poison per batch poison_fraction: 0.16073917238421956
[rfa agg] init. name: [54, 52, 10, 29, 40, 35, 50, 34, 99, 36], weight: tensor([0.1211, 0.0682, 0.0923, 0.1544, 0.1686, 0.0291, 0.0867, 0.1530, 0.0829,
        0.0437])
[rfa agg] iter:  0, prev_obj_val: 50.920467376708984, obj_val: 53.57224655151367, abs dis: 2.6517791748046875
[rfa agg] iter: 0, weight: tensor([0.3034, 0.0435, 0.1477, 0.0982, 0.0822, 0.0105, 0.1017, 0.0972, 0.0965,
        0.0191])
[rfa agg] iter:  1, prev_obj_val: 53.57224655151367, obj_val: 57.28199768066406, abs dis: 3.7097511291503906
[rfa agg] iter: 1, weight: tensor([0.1452, 0.0496, 0.2780, 0.0703, 0.0615, 0.0106, 0.1526, 0.0696, 0.1425,
        0.0200])
[rfa agg] iter:  2, prev_obj_val: 57.28199768066406, obj_val: 65.06240844726562, abs dis: 7.7804107666015625
[rfa agg] iter: 2, weight: tensor([0.0594, 0.0430, 0.2780, 0.0362, 0.0327, 0.0076, 0.2717, 0.0359, 0.2204,
        0.0150])
[rfa agg] iter:  3, prev_obj_val: 65.06240844726562, obj_val: 59.29554748535156, abs dis: 5.7668609619140625
[rfa agg] iter: 3, weight: tensor([0.0666, 0.1086, 0.1484, 0.0465, 0.0431, 0.0138, 0.2636, 0.0461, 0.2343,
        0.0290])
[rfa agg] iter:  4, prev_obj_val: 59.29554748535156, obj_val: 65.05764770507812, abs dis: 5.7621002197265625
[rfa agg] iter: 4, weight: tensor([0.0465, 0.0434, 0.1519, 0.0299, 0.0272, 0.0070, 0.3784, 0.0296, 0.2720,
        0.0141])
[rfa agg] iter:  5, prev_obj_val: 65.05764770507812, obj_val: 59.29484939575195, abs dis: 5.762798309326172
[rfa agg] iter: 5, weight: tensor([0.0661, 0.1078, 0.1455, 0.0462, 0.0427, 0.0137, 0.2666, 0.0458, 0.2368,
        0.0288])
[rfa agg] iter:  6, prev_obj_val: 59.29484939575195, obj_val: 65.05769348144531, abs dis: 5.762844085693359
[rfa agg] iter: 6, weight: tensor([0.0464, 0.0434, 0.1515, 0.0298, 0.0272, 0.0070, 0.3787, 0.0295, 0.2723,
        0.0141])
[rfa agg] iter:  7, prev_obj_val: 65.05769348144531, obj_val: 59.29484558105469, abs dis: 5.762847900390625
[rfa agg] iter: 7, weight: tensor([0.0661, 0.1078, 0.1455, 0.0462, 0.0427, 0.0137, 0.2666, 0.0458, 0.2368,
        0.0288])
[rfa agg] iter:  8, prev_obj_val: 59.29484558105469, obj_val: 65.05770111083984, abs dis: 5.762855529785156
[rfa agg] iter: 8, weight: tensor([0.0464, 0.0434, 0.1515, 0.0298, 0.0272, 0.0070, 0.3787, 0.0295, 0.2724,
        0.0141])
[rfa agg] iter:  9, prev_obj_val: 65.05770111083984, obj_val: 59.29484558105469, abs dis: 5.762855529785156
[rfa agg] iter: 9, weight: tensor([0.0661, 0.1078, 0.1455, 0.0462, 0.0427, 0.0137, 0.2666, 0.0458, 0.2368,
        0.0288])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3407, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 4.1714, Accuracy: 5583/9950 (56.1106%)
saving model
Saving model on epoch 60
Done in 688.0580141544342 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0468, Accuracy: 633/1071 (59.1036%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0236, Accuracy: 655/1071 (61.1578%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Avg loss: 0.0216, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Avg loss: 0.0206, Accuracy: 678/1071 (63.3053%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Avg loss: 0.0200, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Avg loss: 0.0198, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Avg loss: 0.0200, Accuracy: 677/1071 (63.2120%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Avg loss: 0.0192, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Avg loss: 0.0191, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Avg loss: 0.0195, Accuracy: 678/1071 (63.3053%), train_poison_data_count: 680
Global model norm: 111.9737300036821.
Norm before scaling: 111.95639061008309. Distance: 0.8115207199253159
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1542, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: 0.4247, Accuracy: 9921/9950 (99.7085%)
Scaling by  100
Scaled Norm after poisoning: 136.63792253616856, distance: 81.15206838476146
Total norm for 5 adversaries is: 136.63792253616856. distance: 81.15206838476146
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0579, Accuracy: 301/1513 (19.8942%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0347, Accuracy: 560/1513 (37.0126%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0400, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0489, Accuracy: 367/1089 (33.7006%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0263, Accuracy: 480/1089 (44.0771%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.5442, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1609, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0576, Accuracy: 372/1427 (26.0687%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0312, Accuracy: 642/1427 (44.9895%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9631, Accuracy: 76/10000 (0.7600%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0634, Accuracy: 238/774 (30.7494%)
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0321, Accuracy: 341/774 (44.0568%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1242, Accuracy: 79/10000 (0.7900%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0884, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.9970, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1082, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0907, Accuracy: 43/197 (21.8274%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4705, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.0834, Accuracy: 52/408 (12.7451%)
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0482, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.0880, Accuracy: 54/10000 (0.5400%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 480/1988 (24.1449%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0337, Accuracy: 739/1988 (37.1730%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1372, Accuracy: 92/10000 (0.9200%)
time spent on training: 377.17572832107544
[rfa agg] training data poison_ratio: 0.494225580140313  data num: [1071, 1513, 1089, 460, 1427, 774, 338, 197, 408, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3088909875876956
[rfa agg] init. name: [55, 8, 59, 31, 34, 81, 12, 79, 36, 85], weight: tensor([0.1156, 0.1633, 0.1175, 0.0496, 0.1540, 0.0835, 0.0365, 0.0213, 0.0440,
        0.2146])
[rfa agg] iter:  0, prev_obj_val: 15493.1435546875, obj_val: 9723.455078125, abs dis: 5769.6884765625
[rfa agg] iter: 0, weight: tensor([0.0168, 0.1821, 0.1303, 0.0545, 0.1716, 0.0921, 0.0399, 0.0232, 0.0483,
        0.2413])
[rfa agg] iter:  1, prev_obj_val: 9723.455078125, obj_val: 8881.296875, abs dis: 842.158203125
[rfa agg] iter: 1, weight: tensor([0.0022, 0.1876, 0.1294, 0.0510, 0.1757, 0.0888, 0.0370, 0.0213, 0.0450,
        0.2620])
[rfa agg] iter:  2, prev_obj_val: 8881.296875, obj_val: 8824.4306640625, abs dis: 56.8662109375
[rfa agg] iter: 2, weight: tensor([1.8088e-04, 1.5979e-01, 7.9629e-02, 2.2282e-02, 1.4043e-01, 4.5137e-02,
        1.5334e-02, 8.4039e-03, 1.9116e-02, 5.0970e-01])
[rfa agg] iter:  3, prev_obj_val: 8824.4306640625, obj_val: 8821.2734375, abs dis: 3.1572265625
[rfa agg] iter: 3, weight: tensor([6.5212e-05, 4.2397e-01, 7.3548e-02, 1.3550e-02, 2.7483e-01, 3.1879e-02,
        8.9372e-03, 4.7254e-03, 1.1370e-02, 1.5713e-01])
[rfa agg] iter:  4, prev_obj_val: 8821.2734375, obj_val: 8823.5341796875, abs dis: 2.2607421875
[rfa agg] iter: 4, weight: tensor([4.0918e-05, 2.9861e-01, 7.4556e-02, 1.0263e-02, 5.0430e-01, 2.6307e-02,
        6.6299e-03, 3.4471e-03, 8.5174e-03, 6.7322e-02])
[rfa agg] iter:  5, prev_obj_val: 8823.5341796875, obj_val: 8824.80859375, abs dis: 1.2744140625
[rfa agg] iter: 5, weight: tensor([5.9226e-05, 2.6915e-01, 1.3453e-01, 1.5955e-02, 4.2093e-01, 4.2526e-02,
        1.0216e-02, 5.2748e-03, 1.3179e-02, 8.8181e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3375, Accuracy: 107/10000 (1.0700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 4.2339, Accuracy: 5102/9950 (51.2764%)
saving model
Done in 803.9874451160431 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.0830, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0431, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9805, Accuracy: 52/10000 (0.5200%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0594, Accuracy: 244/774 (31.5245%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0334, Accuracy: 330/774 (42.6357%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1459, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1100, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0874, Accuracy: 35/197 (17.7665%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.4258, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0495, Accuracy: 298/861 (34.6109%)
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0182, Accuracy: 530/861 (61.5563%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.3703, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0476, Accuracy: 323/888 (36.3739%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0231, Accuracy: 508/888 (57.2072%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.9363, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0534, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.5329, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0411, Accuracy: 529/1036 (51.0618%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0227, Accuracy: 733/1036 (70.7529%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.8654, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0648, Accuracy: 166/682 (24.3402%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0357, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.4915, Accuracy: 69/10000 (0.6900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0558, Accuracy: 357/1657 (21.5450%)
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0325, Accuracy: 564/1657 (34.0374%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1071, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0490, Accuracy: 453/1574 (28.7802%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0246, Accuracy: 756/1574 (48.0305%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.9203, Accuracy: 109/10000 (1.0900%)
time spent on training: 245.1656801700592
[rfa agg] training data poison_ratio: 0.37358147980027234  data num: [466, 774, 197, 861, 888, 677, 1036, 682, 1657, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.23348842487517021
[rfa agg] init. name: [76, 81, 79, 10, 63, 90, 19, 80, 0, 17], weight: tensor([0.0529, 0.0878, 0.0224, 0.0977, 0.1008, 0.0768, 0.1176, 0.0774, 0.1880,
        0.1786])
[rfa agg] iter:  0, prev_obj_val: 52.116764068603516, obj_val: 57.03314971923828, abs dis: 4.916385650634766
[rfa agg] iter: 0, weight: tensor([0.0160, 0.1375, 0.0041, 0.3062, 0.3165, 0.0461, 0.0692, 0.0464, 0.0286,
        0.0296])
[rfa agg] iter:  1, prev_obj_val: 57.03314971923828, obj_val: 61.817474365234375, abs dis: 4.784324645996094
[rfa agg] iter: 1, weight: tensor([0.0289, 0.2790, 0.0065, 0.1544, 0.1591, 0.1201, 0.0634, 0.1191, 0.0343,
        0.0352])
[rfa agg] iter:  2, prev_obj_val: 61.817474365234375, obj_val: 71.61259460449219, abs dis: 9.795120239257812
[rfa agg] iter: 2, weight: tensor([0.0358, 0.1334, 0.0071, 0.0914, 0.0941, 0.2675, 0.0504, 0.2578, 0.0309,
        0.0315])
[rfa agg] iter:  3, prev_obj_val: 71.61259460449219, obj_val: 64.51893615722656, abs dis: 7.093658447265625
[rfa agg] iter: 3, weight: tensor([0.0885, 0.0991, 0.0128, 0.0833, 0.0859, 0.2467, 0.0574, 0.2449, 0.0404,
        0.0409])
[rfa agg] iter:  4, prev_obj_val: 64.51893615722656, obj_val: 67.92170715332031, abs dis: 3.40277099609375
[rfa agg] iter: 4, weight: tensor([0.0318, 0.0770, 0.0058, 0.0585, 0.0604, 0.3594, 0.0354, 0.3255, 0.0229,
        0.0233])
[rfa agg] iter:  5, prev_obj_val: 67.92170715332031, obj_val: 75.36914825439453, abs dis: 7.447441101074219
[rfa agg] iter: 5, weight: tensor([0.0515, 0.0847, 0.0085, 0.0683, 0.0706, 0.3117, 0.0445, 0.2996, 0.0301,
        0.0305])
[rfa agg] iter:  6, prev_obj_val: 75.36914825439453, obj_val: 64.53555297851562, abs dis: 10.833595275878906
[rfa agg] iter: 6, weight: tensor([0.1374, 0.1013, 0.0166, 0.0882, 0.0911, 0.2038, 0.0638, 0.2040, 0.0466,
        0.0472])
[rfa agg] iter:  7, prev_obj_val: 64.53555297851562, obj_val: 67.92133331298828, abs dis: 3.3857803344726562
[rfa agg] iter: 7, weight: tensor([0.0328, 0.0794, 0.0060, 0.0603, 0.0622, 0.3568, 0.0365, 0.3187, 0.0235,
        0.0240])
[rfa agg] iter:  8, prev_obj_val: 67.92133331298828, obj_val: 75.3691177368164, abs dis: 7.447784423828125
[rfa agg] iter: 8, weight: tensor([0.0515, 0.0848, 0.0085, 0.0684, 0.0706, 0.3120, 0.0445, 0.2989, 0.0301,
        0.0306])
[rfa agg] iter:  9, prev_obj_val: 75.3691177368164, obj_val: 64.53555297851562, abs dis: 10.833564758300781
[rfa agg] iter: 9, weight: tensor([0.1374, 0.1013, 0.0166, 0.0882, 0.0911, 0.2038, 0.0638, 0.2039, 0.0466,
        0.0472])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3369, Accuracy: 104/10000 (1.0400%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.2739, Accuracy: 4324/9950 (43.4573%)
saving model
Done in 683.3072683811188 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Avg loss: 0.0388, Accuracy: 1355/2227 (60.8442%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Avg loss: 0.0216, Accuracy: 1418/2227 (63.6731%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Avg loss: 0.0197, Accuracy: 1431/2227 (64.2568%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Avg loss: 0.0199, Accuracy: 1437/2227 (64.5263%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Avg loss: 0.0193, Accuracy: 1440/2227 (64.6610%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Avg loss: 0.0192, Accuracy: 1432/2227 (64.3018%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Avg loss: 0.0186, Accuracy: 1439/2227 (64.6161%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Avg loss: 0.0181, Accuracy: 1438/2227 (64.5712%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Avg loss: 0.0184, Accuracy: 1451/2227 (65.1549%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Avg loss: 0.0185, Accuracy: 1453/2227 (65.2447%), train_poison_data_count: 1400
Global model norm: 111.97084319840813.
Norm before scaling: 111.93015836477004. Distance: 1.1039230809747576
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2123, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: 0.3440, Accuracy: 9937/9950 (99.8693%)
Scaling by  100
Scaled Norm after poisoning: 153.91939347431173, distance: 110.39230912551155
Total norm for 2 adversaries is: 153.91939347431173. distance: 110.39230912551155
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0460, Accuracy: 559/1129 (49.5128%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 761/1129 (67.4048%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9891, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0820, Accuracy: 62/466 (13.3047%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0452, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.8313, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0538, Accuracy: 359/1131 (31.7418%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0266, Accuracy: 567/1131 (50.1326%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3495, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0520, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0238, Accuracy: 570/1154 (49.3934%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.4967, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0564, Accuracy: 337/1513 (22.2736%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0341, Accuracy: 532/1513 (35.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3082, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 213/500 (42.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6474, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1088, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.0905, Accuracy: 49/197 (24.8731%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.4760, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0397, Accuracy: 533/1036 (51.4479%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0221, Accuracy: 734/1036 (70.8494%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.5113, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0592, Accuracy: 244/773 (31.5653%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 429/773 (55.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.3681, Accuracy: 75/10000 (0.7500%)
time spent on training: 384.5565667152405
[rfa agg] training data poison_ratio: 0.3314240568832708  data num: [2227, 1129, 466, 1131, 1154, 1513, 500, 197, 1036, 773]
[rfa agg] considering poison per batch poison_fraction: 0.20714003555204424
[rfa agg] init. name: [60, 37, 76, 38, 57, 8, 82, 79, 19, 99], weight: tensor([0.2199, 0.1115, 0.0460, 0.1117, 0.1140, 0.1494, 0.0494, 0.0195, 0.1023,
        0.0763])
[rfa agg] iter:  0, prev_obj_val: 53644.91015625, obj_val: 40823.8984375, abs dis: 12821.01171875
[rfa agg] iter: 0, weight: tensor([0.0736, 0.1324, 0.0545, 0.1327, 0.1354, 0.1778, 0.0585, 0.0230, 0.1215,
        0.0906])
[rfa agg] iter:  1, prev_obj_val: 40823.8984375, obj_val: 36294.7109375, abs dis: 4529.1875
[rfa agg] iter: 1, weight: tensor([0.0219, 0.1399, 0.0573, 0.1401, 0.1431, 0.1884, 0.0615, 0.0241, 0.1283,
        0.0954])
[rfa agg] iter:  2, prev_obj_val: 36294.7109375, obj_val: 34924.44921875, abs dis: 1370.26171875
[rfa agg] iter: 2, weight: tensor([0.0062, 0.1424, 0.0572, 0.1426, 0.1459, 0.1938, 0.0614, 0.0240, 0.1303,
        0.0962])
[rfa agg] iter:  3, prev_obj_val: 34924.44921875, obj_val: 34531.21484375, abs dis: 393.234375
[rfa agg] iter: 3, weight: tensor([0.0017, 0.1436, 0.0541, 0.1438, 0.1482, 0.2040, 0.0581, 0.0221, 0.1305,
        0.0939])
[rfa agg] iter:  4, prev_obj_val: 34531.21484375, obj_val: 34425.546875, abs dis: 105.66796875
[rfa agg] iter: 4, weight: tensor([0.0004, 0.1430, 0.0431, 0.1433, 0.1518, 0.2464, 0.0462, 0.0164, 0.1266,
        0.0827])
[rfa agg] iter:  5, prev_obj_val: 34425.546875, obj_val: 34417.70703125, abs dis: 7.83984375
[rfa agg] iter: 5, weight: tensor([4.8057e-05, 7.6431e-02, 1.1332e-02, 7.6932e-02, 9.5013e-02, 6.3696e-01,
        1.2156e-02, 3.8088e-03, 5.9628e-02, 2.7693e-02])
[rfa agg] iter:  6, prev_obj_val: 34417.70703125, obj_val: 34417.40234375, abs dis: 0.3046875
[rfa agg] iter: 6, weight: tensor([4.6759e-05, 1.8424e-01, 1.4226e-02, 1.8864e-01, 2.9447e-01, 1.3827e-01,
        1.5255e-02, 4.5141e-03, 1.2020e-01, 4.0130e-02])
[rfa agg] iter:  7, prev_obj_val: 34417.40234375, obj_val: 34423.9453125, abs dis: 6.54296875
[rfa agg] iter: 7, weight: tensor([2.7099e-05, 2.3833e-01, 1.0417e-02, 2.8456e-01, 1.4747e-01, 4.9090e-02,
        1.1171e-02, 3.1020e-03, 2.1985e-01, 3.5994e-02])
[rfa agg] iter:  8, prev_obj_val: 34423.9453125, obj_val: 34426.55859375, abs dis: 2.61328125
[rfa agg] iter: 8, weight: tensor([4.5237e-05, 1.8542e-01, 2.0641e-02, 1.9267e-01, 1.3111e-01, 6.6714e-02,
        2.2134e-02, 5.8255e-03, 2.8677e-01, 8.8663e-02])
[rfa agg] iter:  9, prev_obj_val: 34426.55859375, obj_val: 34423.92578125, abs dis: 2.6328125
[rfa agg] iter: 9, weight: tensor([5.2444e-05, 1.7502e-01, 2.5525e-02, 1.8003e-01, 1.3169e-01, 7.2866e-02,
        2.7378e-02, 7.0482e-03, 2.5789e-01, 1.2249e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3368, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 4.3147, Accuracy: 3486/9950 (35.0352%)
saving model
Done in 816.5417263507843 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.0823, Accuracy: 53/408 (12.9902%)
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0467, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0277, Accuracy: 61/10000 (0.6100%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0601, Accuracy: 276/807 (34.2007%)
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0300, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.4509, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0910, Accuracy: 5/271 (1.8450%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 137/271 (50.5535%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2521, Accuracy: 67/10000 (0.6700%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0771, Accuracy: 83/486 (17.0782%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0389, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3342, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0521, Accuracy: 435/1956 (22.2393%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0294, Accuracy: 746/1956 (38.1391%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2425, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0646, Accuracy: 206/669 (30.7922%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0389, Accuracy: 366/669 (54.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.9626, Accuracy: 85/10000 (0.8500%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0521, Accuracy: 451/1475 (30.5763%)
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0279, Accuracy: 775/1475 (52.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7652, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0582, Accuracy: 212/809 (26.2052%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0244, Accuracy: 422/809 (52.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.9722, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0591, Accuracy: 259/773 (33.5058%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 438/773 (56.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.8205, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0568, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0306, Accuracy: 479/896 (53.4598%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.2776, Accuracy: 60/10000 (0.6000%)
time spent on training: 269.380806684494
[rfa agg] training data poison_ratio: 0.37146198830409355  data num: [408, 807, 271, 486, 1956, 669, 1475, 809, 773, 896]
[rfa agg] considering poison per batch poison_fraction: 0.23216374269005846
[rfa agg] init. name: [36, 20, 35, 30, 6, 45, 65, 50, 99, 89], weight: tensor([0.0477, 0.0944, 0.0317, 0.0568, 0.2288, 0.0782, 0.1725, 0.0946, 0.0904,
        0.1048])
[rfa agg] iter:  0, prev_obj_val: 66.58000946044922, obj_val: 69.36146545410156, abs dis: 2.7814559936523438
[rfa agg] iter: 0, weight: tensor([0.0234, 0.1524, 0.0126, 0.0316, 0.0616, 0.0719, 0.0842, 0.1536, 0.1462,
        0.2625])
[rfa agg] iter:  1, prev_obj_val: 69.36146545410156, obj_val: 74.51493835449219, abs dis: 5.153472900390625
[rfa agg] iter: 1, weight: tensor([0.0231, 0.1949, 0.0110, 0.0342, 0.0292, 0.1618, 0.0347, 0.2000, 0.1888,
        0.1223])
[rfa agg] iter:  2, prev_obj_val: 74.51493835449219, obj_val: 77.47917175292969, abs dis: 2.9642333984375
[rfa agg] iter: 2, weight: tensor([0.0318, 0.1215, 0.0141, 0.0502, 0.0307, 0.3850, 0.0355, 0.1227, 0.1170,
        0.0915])
[rfa agg] iter:  3, prev_obj_val: 77.47917175292969, obj_val: 80.65403747558594, abs dis: 3.17486572265625
[rfa agg] iter: 3, weight: tensor([0.0414, 0.1117, 0.0176, 0.0685, 0.0342, 0.3768, 0.0390, 0.1128, 0.1080,
        0.0899])
[rfa agg] iter:  4, prev_obj_val: 80.65403747558594, obj_val: 77.48356628417969, abs dis: 3.17047119140625
[rfa agg] iter: 4, weight: tensor([0.0599, 0.1168, 0.0241, 0.1055, 0.0414, 0.2770, 0.0467, 0.1177, 0.1126,
        0.0982])
[rfa agg] iter:  5, prev_obj_val: 77.48356628417969, obj_val: 80.6528549194336, abs dis: 3.1692886352539062
[rfa agg] iter: 5, weight: tensor([0.0424, 0.1144, 0.0180, 0.0702, 0.0349, 0.3625, 0.0399, 0.1154, 0.1104,
        0.0920])
[rfa agg] iter:  6, prev_obj_val: 80.6528549194336, obj_val: 77.48362731933594, abs dis: 3.1692276000976562
[rfa agg] iter: 6, weight: tensor([0.0600, 0.1170, 0.0241, 0.1056, 0.0415, 0.2763, 0.0468, 0.1178, 0.1127,
        0.0983])
[rfa agg] iter:  7, prev_obj_val: 77.48362731933594, obj_val: 80.65286254882812, abs dis: 3.1692352294921875
[rfa agg] iter: 7, weight: tensor([0.0424, 0.1144, 0.0180, 0.0702, 0.0349, 0.3624, 0.0399, 0.1154, 0.1104,
        0.0921])
[rfa agg] iter:  8, prev_obj_val: 80.65286254882812, obj_val: 77.48362731933594, abs dis: 3.1692352294921875
[rfa agg] iter: 8, weight: tensor([0.0600, 0.1170, 0.0241, 0.1056, 0.0415, 0.2763, 0.0468, 0.1178, 0.1127,
        0.0983])
[rfa agg] iter:  9, prev_obj_val: 77.48362731933594, obj_val: 80.65286254882812, abs dis: 3.1692352294921875
[rfa agg] iter: 9, weight: tensor([0.0424, 0.1144, 0.0180, 0.0702, 0.0349, 0.3624, 0.0399, 0.1154, 0.1104,
        0.0921])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3343, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.3376, Accuracy: 3374/9950 (33.9095%)
saving model
Done in 703.5203804969788 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1057, Accuracy: 18/85 (21.1765%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.0857, Accuracy: 58/85 (68.2353%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Avg loss: 0.0609, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Avg loss: 0.0569, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Avg loss: 0.0529, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Avg loss: 0.0487, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Avg loss: 0.0442, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Avg loss: 0.0403, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Avg loss: 0.0387, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Avg loss: 0.0393, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 111.96851015185028.
Norm before scaling: 111.96807406298905. Distance: 0.2381088461740813
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.0490, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: 0.6291, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 114.40584027514723, distance: 23.810882593528795
Total norm for 3 adversaries is: 114.40584027514723. distance: 23.810882593528795
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0555, Accuracy: 387/1581 (24.4782%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0319, Accuracy: 642/1581 (40.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8943, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0534, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0294, Accuracy: 790/1742 (45.3502%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4096, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0518, Accuracy: 308/1154 (26.6898%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.9376, Accuracy: 64/10000 (0.6400%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0557, Accuracy: 333/1241 (26.8332%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0345, Accuracy: 490/1241 (39.4843%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0099, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0747, Accuracy: 86/500 (17.2000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0467, Accuracy: 231/500 (46.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8125, Accuracy: 67/10000 (0.6700%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0546, Accuracy: 313/1071 (29.2250%)
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0277, Accuracy: 545/1071 (50.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.9509, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0557, Accuracy: 297/1131 (26.2599%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0299, Accuracy: 428/1131 (37.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4746, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0697, Accuracy: 158/603 (26.2023%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0424, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.6144, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.0815, Accuracy: 19/311 (6.1093%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.1234, Accuracy: 50/10000 (0.5000%)
time spent on training: 324.1619989871979
[rfa agg] training data poison_ratio: 0.254485614184096  data num: [85, 1581, 1742, 1154, 1241, 500, 1071, 1131, 603, 311]
[rfa agg] considering poison per batch poison_fraction: 0.15905350886505998
[rfa agg] init. name: [61, 28, 93, 57, 72, 82, 55, 87, 88, 96], weight: tensor([0.0090, 0.1679, 0.1849, 0.1225, 0.1318, 0.0531, 0.1137, 0.1201, 0.0640,
        0.0330])
[rfa agg] iter:  0, prev_obj_val: 143.5884552001953, obj_val: 128.8979034423828, abs dis: 14.6905517578125
[rfa agg] iter: 0, weight: tensor([3.3514e-05, 3.4666e-01, 3.9799e-01, 5.8722e-02, 7.2547e-02, 1.0382e-02,
        4.3181e-02, 5.0886e-02, 1.4038e-02, 5.5582e-03])
[rfa agg] iter:  1, prev_obj_val: 128.8979034423828, obj_val: 123.57583618164062, abs dis: 5.3220672607421875
[rfa agg] iter: 1, weight: tensor([3.8516e-05, 2.7051e-01, 1.3965e-01, 1.4236e-01, 2.0759e-01, 1.5285e-02,
        8.5546e-02, 1.0976e-01, 2.1375e-02, 7.8791e-03])
[rfa agg] iter:  2, prev_obj_val: 123.57583618164062, obj_val: 129.60829162597656, abs dis: 6.0324554443359375
[rfa agg] iter: 2, weight: tensor([1.8939e-05, 5.7303e-02, 4.2209e-02, 3.3719e-01, 2.2054e-01, 9.9406e-03,
        1.0985e-01, 2.0344e-01, 1.4643e-02, 4.8598e-03])
[rfa agg] iter:  3, prev_obj_val: 129.60829162597656, obj_val: 132.1556396484375, abs dis: 2.5473480224609375
[rfa agg] iter: 3, weight: tensor([2.2590e-05, 5.1388e-02, 4.1312e-02, 1.4462e-01, 1.0532e-01, 1.4510e-02,
        3.6539e-01, 2.4818e-01, 2.2480e-02, 6.7742e-03])
[rfa agg] iter:  4, prev_obj_val: 132.1556396484375, obj_val: 135.1167449951172, abs dis: 2.9611053466796875
[rfa agg] iter: 4, weight: tensor([2.4967e-05, 5.3528e-02, 4.3713e-02, 1.2766e-01, 9.9932e-02, 1.6986e-02,
        4.2228e-01, 2.0130e-01, 2.6757e-02, 7.8179e-03])
[rfa agg] iter:  5, prev_obj_val: 135.1167449951172, obj_val: 129.44561767578125, abs dis: 5.6711273193359375
[rfa agg] iter: 5, weight: tensor([3.2105e-05, 6.5072e-02, 5.3907e-02, 1.3849e-01, 1.1306e-01, 2.3211e-02,
        3.5899e-01, 1.9946e-01, 3.7265e-02, 1.0514e-02])
[rfa agg] iter:  6, prev_obj_val: 129.44561767578125, obj_val: 135.12127685546875, abs dis: 5.6756591796875
[rfa agg] iter: 6, weight: tensor([1.9497e-05, 4.4368e-02, 3.5664e-02, 1.2172e-01, 9.0229e-02, 1.2524e-02,
        4.5661e-01, 2.1361e-01, 1.9402e-02, 5.8481e-03])
[rfa agg] iter:  7, prev_obj_val: 135.12127685546875, obj_val: 129.44509887695312, abs dis: 5.676177978515625
[rfa agg] iter: 7, weight: tensor([3.2017e-05, 6.4885e-02, 5.3756e-02, 1.3794e-01, 1.1266e-01, 2.3144e-02,
        3.6116e-01, 1.9879e-01, 3.7154e-02, 1.0485e-02])
[rfa agg] iter:  8, prev_obj_val: 129.44509887695312, obj_val: 135.1214141845703, abs dis: 5.6763153076171875
[rfa agg] iter: 8, weight: tensor([1.9469e-05, 4.4304e-02, 3.5613e-02, 1.2153e-01, 9.0092e-02, 1.2506e-02,
        4.5751e-01, 2.1320e-01, 1.9374e-02, 5.8397e-03])
[rfa agg] iter:  9, prev_obj_val: 135.1214141845703, obj_val: 129.44508361816406, abs dis: 5.67633056640625
[rfa agg] iter: 9, weight: tensor([3.2014e-05, 6.4880e-02, 5.3751e-02, 1.3792e-01, 1.1264e-01, 2.3142e-02,
        3.6124e-01, 1.9875e-01, 3.7151e-02, 1.0484e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3321, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 4.3822, Accuracy: 3050/9950 (30.6533%)
saving model
Done in 752.4988188743591 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0545, Accuracy: 362/1154 (31.3692%)
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0262, Accuracy: 553/1154 (47.9203%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.8383, Accuracy: 113/10000 (1.1300%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0686, Accuracy: 151/530 (28.4906%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0348, Accuracy: 283/530 (53.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4675, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0526, Accuracy: 418/1949 (21.4469%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0315, Accuracy: 662/1949 (33.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7669, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0575, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0320, Accuracy: 396/1003 (39.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5880, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0522, Accuracy: 444/1742 (25.4879%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0297, Accuracy: 770/1742 (44.2021%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.5644, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0586, Accuracy: 236/818 (28.8509%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0272, Accuracy: 425/818 (51.9560%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0903, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0541, Accuracy: 405/1427 (28.3812%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0307, Accuracy: 652/1427 (45.6903%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1318, Accuracy: 74/10000 (0.7400%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0606, Accuracy: 181/781 (23.1754%)
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0318, Accuracy: 302/781 (38.6684%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8847, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 268/636 (42.1384%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0284, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.3491, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1176, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1043, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3660, Accuracy: 53/10000 (0.5300%)
time spent on training: 300.27171659469604
[rfa agg] training data poison_ratio: 0.24228425398073522  data num: [1154, 530, 1949, 1003, 1742, 818, 1427, 781, 636, 134]
[rfa agg] considering poison per batch poison_fraction: 0.15142765873795952
[rfa agg] init. name: [15, 18, 21, 86, 93, 71, 34, 3, 52, 47], weight: tensor([0.1134, 0.0521, 0.1916, 0.0986, 0.1712, 0.0804, 0.1403, 0.0768, 0.0625,
        0.0132])
[rfa agg] iter:  0, prev_obj_val: 63.86082077026367, obj_val: 66.78191375732422, abs dis: 2.921092987060547
[rfa agg] iter: 0, weight: tensor([0.4566, 0.0207, 0.0577, 0.1432, 0.0678, 0.0548, 0.1158, 0.0524, 0.0277,
        0.0032])
[rfa agg] iter:  1, prev_obj_val: 66.78191375732422, obj_val: 69.12125396728516, abs dis: 2.3393402099609375
[rfa agg] iter: 1, weight: tensor([0.2280, 0.0269, 0.0564, 0.3281, 0.0642, 0.0819, 0.0957, 0.0783, 0.0367,
        0.0039])
[rfa agg] iter:  2, prev_obj_val: 69.12125396728516, obj_val: 72.63819122314453, abs dis: 3.516937255859375
[rfa agg] iter: 2, weight: tensor([0.1089, 0.0219, 0.0377, 0.5453, 0.0421, 0.0775, 0.0588, 0.0742, 0.0306,
        0.0030])
[rfa agg] iter:  3, prev_obj_val: 72.63819122314453, obj_val: 76.4884262084961, abs dis: 3.8502349853515625
[rfa agg] iter: 3, weight: tensor([0.1067, 0.0333, 0.0460, 0.3578, 0.0505, 0.1461, 0.0671, 0.1407, 0.0476,
        0.0042])
[rfa agg] iter:  4, prev_obj_val: 76.4884262084961, obj_val: 78.47018432617188, abs dis: 1.9817581176757812
[rfa agg] iter: 4, weight: tensor([0.0821, 0.0380, 0.0412, 0.1754, 0.0447, 0.2532, 0.0569, 0.2474, 0.0566,
        0.0044])
[rfa agg] iter:  5, prev_obj_val: 78.47018432617188, obj_val: 86.90470886230469, abs dis: 8.434524536132812
[rfa agg] iter: 5, weight: tensor([0.0575, 0.0325, 0.0308, 0.1077, 0.0332, 0.3227, 0.0415, 0.3208, 0.0497,
        0.0035])
[rfa agg] iter:  6, prev_obj_val: 86.90470886230469, obj_val: 80.75914001464844, abs dis: 6.14556884765625
[rfa agg] iter: 6, weight: tensor([0.0604, 0.0644, 0.0378, 0.0911, 0.0401, 0.2751, 0.0477, 0.2657, 0.1124,
        0.0055])
[rfa agg] iter:  7, prev_obj_val: 80.75914001464844, obj_val: 86.91150665283203, abs dis: 6.152366638183594
[rfa agg] iter: 7, weight: tensor([0.0399, 0.0276, 0.0226, 0.0681, 0.0243, 0.3688, 0.0297, 0.3725, 0.0437,
        0.0028])
[rfa agg] iter:  8, prev_obj_val: 86.91150665283203, obj_val: 80.75877380371094, abs dis: 6.152732849121094
[rfa agg] iter: 8, weight: tensor([0.0601, 0.0641, 0.0376, 0.0906, 0.0399, 0.2764, 0.0475, 0.2663, 0.1119,
        0.0055])
[rfa agg] iter:  9, prev_obj_val: 80.75877380371094, obj_val: 86.91152954101562, abs dis: 6.1527557373046875
[rfa agg] iter: 9, weight: tensor([0.0399, 0.0276, 0.0226, 0.0681, 0.0242, 0.3691, 0.0297, 0.3724, 0.0436,
        0.0028])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3352, Accuracy: 110/10000 (1.1000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.4292, Accuracy: 2125/9950 (21.3568%)
saving model
Done in 733.4641876220703 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Avg loss: 0.0433, Accuracy: 875/1475 (59.3220%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Avg loss: 0.0232, Accuracy: 915/1475 (62.0339%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Avg loss: 0.0200, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Avg loss: 0.0207, Accuracy: 936/1475 (63.4576%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Avg loss: 0.0202, Accuracy: 941/1475 (63.7966%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Avg loss: 0.0198, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Avg loss: 0.0200, Accuracy: 933/1475 (63.2542%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Avg loss: 0.0195, Accuracy: 953/1475 (64.6102%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Avg loss: 0.0191, Accuracy: 948/1475 (64.2712%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Avg loss: 0.0193, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 923
Global model norm: 111.96597209085446.
Norm before scaling: 111.93931025197314. Distance: 0.9147866469885284
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.9499, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: 0.4293, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 142.21208578651112, distance: 91.47866255649456
Total norm for 4 adversaries is: 142.21208578651112. distance: 91.47866255649456
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8726, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0575, Accuracy: 308/719 (42.8373%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5215, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.4303, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0398, Accuracy: 552/1036 (53.2819%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0217, Accuracy: 729/1036 (70.3668%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 12.3725, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0613, Accuracy: 291/715 (40.6993%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0353, Accuracy: 441/715 (61.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.4965, Accuracy: 79/10000 (0.7900%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0444, Accuracy: 544/1129 (48.1842%)
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0209, Accuracy: 782/1129 (69.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.0074, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0623, Accuracy: 244/669 (36.4723%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0363, Accuracy: 366/669 (54.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.6653, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0818, Accuracy: 14/311 (4.5016%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.1822, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0467, Accuracy: 398/1275 (31.2157%)
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0171, Accuracy: 792/1275 (62.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.5737, Accuracy: 135/10000 (1.3500%)
time spent on training: 332.9350996017456
[rfa agg] training data poison_ratio: 0.5369922322679231  data num: [1475, 338, 719, 186, 1036, 715, 1129, 669, 311, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.335620145167452
[rfa agg] init. name: [65, 12, 41, 56, 19, 23, 37, 45, 96, 9], weight: tensor([0.1878, 0.0430, 0.0916, 0.0237, 0.1319, 0.0910, 0.1438, 0.0852, 0.0396,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 32696.103515625, obj_val: 23520.685546875, abs dis: 9175.41796875
[rfa agg] iter: 0, weight: tensor([0.0507, 0.0501, 0.1069, 0.0275, 0.1544, 0.1063, 0.1683, 0.0994, 0.0461,
        0.1902])
[rfa agg] iter:  1, prev_obj_val: 23520.685546875, obj_val: 20935.0546875, abs dis: 2585.630859375
[rfa agg] iter: 1, weight: tensor([0.0122, 0.0516, 0.1109, 0.0283, 0.1611, 0.1103, 0.1759, 0.1030, 0.0474,
        0.1993])
[rfa agg] iter:  2, prev_obj_val: 20935.0546875, obj_val: 20309.6328125, abs dis: 625.421875
[rfa agg] iter: 2, weight: tensor([0.0028, 0.0498, 0.1104, 0.0269, 0.1647, 0.1098, 0.1808, 0.1020, 0.0456,
        0.2072])
[rfa agg] iter:  3, prev_obj_val: 20309.6328125, obj_val: 20170.814453125, abs dis: 138.818359375
[rfa agg] iter: 3, weight: tensor([0.0006, 0.0407, 0.1020, 0.0208, 0.1728, 0.1015, 0.1951, 0.0922, 0.0365,
        0.2377])
[rfa agg] iter:  4, prev_obj_val: 20170.814453125, obj_val: 20164.0859375, abs dis: 6.728515625
[rfa agg] iter: 4, weight: tensor([4.7835e-05, 9.0513e-03, 3.2745e-02, 4.1281e-03, 1.1238e-01, 3.2569e-02,
        1.6323e-01, 2.7307e-02, 7.7913e-03, 6.1075e-01])
[rfa agg] iter:  5, prev_obj_val: 20164.0859375, obj_val: 20166.810546875, abs dis: 2.724609375
[rfa agg] iter: 5, weight: tensor([4.9166e-05, 1.2835e-02, 6.2617e-02, 5.4983e-03, 4.0955e-01, 6.2386e-02,
        2.4334e-01, 4.8168e-02, 1.0786e-02, 1.4477e-01])
[rfa agg] iter:  6, prev_obj_val: 20166.810546875, obj_val: 20167.8828125, abs dis: 1.072265625
[rfa agg] iter: 6, weight: tensor([6.7706e-05, 2.0626e-02, 1.2750e-01, 8.5211e-03, 2.7328e-01, 1.2675e-01,
        1.9679e-01, 9.0695e-02, 1.7084e-02, 1.3869e-01])
[rfa agg] iter:  7, prev_obj_val: 20167.8828125, obj_val: 20170.150390625, abs dis: 2.267578125
[rfa agg] iter: 7, weight: tensor([6.9539e-05, 2.2436e-02, 1.5647e-01, 9.1338e-03, 2.2606e-01, 1.5575e-01,
        1.7529e-01, 1.0647e-01, 1.8476e-02, 1.2985e-01])
[rfa agg] iter:  8, prev_obj_val: 20170.150390625, obj_val: 20172.626953125, abs dis: 2.4765625
[rfa agg] iter: 8, weight: tensor([6.2630e-05, 2.2896e-02, 2.2280e-01, 9.0100e-03, 1.4767e-01, 2.2239e-01,
        1.2457e-01, 1.3279e-01, 1.8596e-02, 9.9213e-02])
[rfa agg] iter:  9, prev_obj_val: 20172.626953125, obj_val: 20176.541015625, abs dis: 3.9140625
[rfa agg] iter: 9, weight: tensor([4.1337e-05, 1.7431e-02, 3.0667e-01, 6.5726e-03, 7.6241e-02, 3.1336e-01,
        6.7700e-02, 1.4125e-01, 1.3910e-02, 5.6826e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3327, Accuracy: 110/10000 (1.1000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.4651, Accuracy: 1879/9950 (18.8844%)
saving model
Done in 777.7810895442963 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.0753, Accuracy: 104/486 (21.3992%)
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0366, Accuracy: 222/486 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9981, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0488, Accuracy: 467/1574 (29.6696%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0246, Accuracy: 766/1574 (48.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9274, Accuracy: 110/10000 (1.1000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0513, Accuracy: 352/1130 (31.1504%)
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0269, Accuracy: 523/1130 (46.2832%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.1485, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0491, Accuracy: 407/1030 (39.5146%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0270, Accuracy: 662/1030 (64.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.1802, Accuracy: 108/10000 (1.0800%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0590, Accuracy: 271/590 (45.9322%)
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.4483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0550, Accuracy: 422/1581 (26.6920%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0316, Accuracy: 650/1581 (41.1132%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8532, Accuracy: 102/10000 (1.0200%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0528, Accuracy: 485/1475 (32.8814%)
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0274, Accuracy: 751/1475 (50.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.9108, Accuracy: 117/10000 (1.1700%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 703/2227 (31.5671%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0266, Accuracy: 1067/2227 (47.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4188, Accuracy: 121/10000 (1.2100%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0459, Accuracy: 412/1275 (32.3137%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0167, Accuracy: 825/1275 (64.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 11.4075, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0519, Accuracy: 318/712 (44.6629%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0234, Accuracy: 458/712 (64.3258%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.9450, Accuracy: 77/10000 (0.7700%)
time spent on training: 361.6275358200073
[rfa agg] training data poison_ratio: 0.5946192052980133  data num: [486, 1574, 1130, 1030, 590, 1581, 1475, 2227, 1275, 712]
[rfa agg] considering poison per batch poison_fraction: 0.37163700331125826
[rfa agg] init. name: [30, 17, 54, 91, 69, 28, 65, 60, 9, 11], weight: tensor([0.0402, 0.1303, 0.0935, 0.0853, 0.0488, 0.1309, 0.1221, 0.1844, 0.1055,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 60.19371795654297, obj_val: 65.17221069335938, abs dis: 4.978492736816406
[rfa agg] iter: 0, weight: tensor([0.0112, 0.0750, 0.1776, 0.1018, 0.0164, 0.0753, 0.0844, 0.0380, 0.3951,
        0.0251])
[rfa agg] iter:  1, prev_obj_val: 65.17221069335938, obj_val: 72.65345001220703, abs dis: 7.481239318847656
[rfa agg] iter: 1, weight: tensor([0.0124, 0.0568, 0.3843, 0.1879, 0.0187, 0.0570, 0.0616, 0.0333, 0.1579,
        0.0300])
[rfa agg] iter:  2, prev_obj_val: 72.65345001220703, obj_val: 69.8008804321289, abs dis: 2.852569580078125
[rfa agg] iter: 2, weight: tensor([0.0189, 0.0609, 0.2327, 0.3229, 0.0298, 0.0611, 0.0642, 0.0397, 0.1181,
        0.0517])
[rfa agg] iter:  3, prev_obj_val: 69.8008804321289, obj_val: 75.5873794555664, abs dis: 5.7864990234375
[rfa agg] iter: 3, weight: tensor([0.0146, 0.0529, 0.2450, 0.3723, 0.0227, 0.0531, 0.0562, 0.0334, 0.1118,
        0.0381])
[rfa agg] iter:  4, prev_obj_val: 75.5873794555664, obj_val: 69.80331420898438, abs dis: 5.784065246582031
[rfa agg] iter: 4, weight: tensor([0.0227, 0.0653, 0.1979, 0.3163, 0.0366, 0.0655, 0.0684, 0.0439, 0.1176,
        0.0656])
[rfa agg] iter:  5, prev_obj_val: 69.80331420898438, obj_val: 75.58745574951172, abs dis: 5.784141540527344
[rfa agg] iter: 5, weight: tensor([0.0146, 0.0530, 0.2430, 0.3738, 0.0227, 0.0531, 0.0563, 0.0334, 0.1120,
        0.0382])
[rfa agg] iter:  6, prev_obj_val: 75.58745574951172, obj_val: 69.80328369140625, abs dis: 5.784172058105469
[rfa agg] iter: 6, weight: tensor([0.0227, 0.0653, 0.1978, 0.3166, 0.0366, 0.0655, 0.0684, 0.0439, 0.1176,
        0.0656])
[rfa agg] iter:  7, prev_obj_val: 69.80328369140625, obj_val: 75.58746337890625, abs dis: 5.7841796875
[rfa agg] iter: 7, weight: tensor([0.0146, 0.0530, 0.2429, 0.3739, 0.0227, 0.0531, 0.0563, 0.0334, 0.1119,
        0.0382])
[rfa agg] iter:  8, prev_obj_val: 75.58746337890625, obj_val: 69.80328369140625, abs dis: 5.7841796875
[rfa agg] iter: 8, weight: tensor([0.0227, 0.0653, 0.1978, 0.3166, 0.0366, 0.0655, 0.0684, 0.0439, 0.1176,
        0.0656])
[rfa agg] iter:  9, prev_obj_val: 69.80328369140625, obj_val: 75.58747100830078, abs dis: 5.784187316894531
[rfa agg] iter: 9, weight: tensor([0.0146, 0.0530, 0.2429, 0.3739, 0.0227, 0.0531, 0.0563, 0.0334, 0.1119,
        0.0382])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3304, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.4699, Accuracy: 1958/9950 (19.6784%)
saving model
Done in 792.762754201889 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0530, Accuracy: 306/590 (51.8644%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0271, Accuracy: 346/590 (58.6441%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Avg loss: 0.0259, Accuracy: 223/590 (37.7966%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Avg loss: 0.0197, Accuracy: 361/590 (61.1864%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Avg loss: 0.0222, Accuracy: 375/590 (63.5593%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Avg loss: 0.0212, Accuracy: 372/590 (63.0508%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Avg loss: 0.0208, Accuracy: 371/590 (62.8814%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Avg loss: 0.0195, Accuracy: 370/590 (62.7119%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Avg loss: 0.0198, Accuracy: 371/590 (62.8814%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Avg loss: 0.0192, Accuracy: 371/590 (62.8814%), train_poison_data_count: 374
Global model norm: 111.96338600045776.
Norm before scaling: 111.95524792997647. Distance: 0.6994253098543037
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.2522, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: 0.3401, Accuracy: 9840/9950 (98.8945%)
Scaling by  100
Scaled Norm after poisoning: 131.135485758051, distance: 69.94253011960069
Total norm for 5 adversaries is: 131.135485758051. distance: 69.94253011960069
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0584, Accuracy: 229/781 (29.3214%)
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0304, Accuracy: 312/781 (39.9488%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6958, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0585, Accuracy: 274/1402 (19.5435%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0368, Accuracy: 404/1402 (28.8160%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4602, Accuracy: 68/10000 (0.6800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.0809, Accuracy: 64/408 (15.6863%)
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0457, Accuracy: 155/408 (37.9902%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0539, Accuracy: 58/10000 (0.5800%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.0814, Accuracy: 61/416 (14.6635%)
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0423, Accuracy: 232/416 (55.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2586, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 462/1953 (23.6559%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0314, Accuracy: 868/1953 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8857, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0569, Accuracy: 327/1513 (21.6127%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0338, Accuracy: 548/1513 (36.2194%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7853, Accuracy: 101/10000 (1.0100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0496, Accuracy: 322/861 (37.3984%)
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0179, Accuracy: 517/861 (60.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.4921, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0526, Accuracy: 446/1742 (25.6028%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0294, Accuracy: 766/1742 (43.9724%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4883, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0594, Accuracy: 310/803 (38.6052%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0330, Accuracy: 376/803 (46.8244%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2748, Accuracy: 71/10000 (0.7100%)
time spent on training: 375.04726004600525
[rfa agg] training data poison_ratio: 0.29190944693858056  data num: [590, 781, 1402, 408, 416, 1953, 1513, 861, 1742, 803]
[rfa agg] considering poison per batch poison_fraction: 0.18244340433661285
[rfa agg] init. name: [69, 3, 66, 36, 78, 83, 8, 10, 93, 58], weight: tensor([0.0564, 0.0746, 0.1339, 0.0390, 0.0397, 0.1866, 0.1445, 0.0822, 0.1664,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 4710.1875, obj_val: 2634.860107421875, abs dis: 2075.327392578125
[rfa agg] iter: 0, weight: tensor([0.0035, 0.0763, 0.1414, 0.0390, 0.0398, 0.2036, 0.1537, 0.0844, 0.1796,
        0.0785])
[rfa agg] iter:  1, prev_obj_val: 2634.860107421875, obj_val: 2564.2646484375, abs dis: 70.595458984375
[rfa agg] iter: 1, weight: tensor([1.4651e-04, 3.9268e-02, 1.1131e-01, 1.6484e-02, 1.6807e-02, 3.6752e-01,
        1.3789e-01, 4.5135e-02, 2.2505e-01, 4.0384e-02])
[rfa agg] iter:  2, prev_obj_val: 2564.2646484375, obj_val: 2567.2587890625, abs dis: 2.994140625
[rfa agg] iter: 2, weight: tensor([3.3943e-05, 2.0275e-02, 1.8378e-01, 6.8676e-03, 7.0017e-03, 7.9539e-02,
        5.3494e-01, 2.4590e-02, 1.2210e-01, 2.0870e-02])
[rfa agg] iter:  3, prev_obj_val: 2567.2587890625, obj_val: 2568.5810546875, abs dis: 1.322265625
[rfa agg] iter: 3, weight: tensor([4.1514e-05, 3.2052e-02, 5.0139e-01, 9.8484e-03, 1.0039e-02, 7.1633e-02,
        2.0905e-01, 4.0026e-02, 9.2912e-02, 3.3001e-02])
[rfa agg] iter:  4, prev_obj_val: 2568.5810546875, obj_val: 2570.195068359375, abs dis: 1.614013671875
[rfa agg] iter: 4, weight: tensor([4.6122e-05, 3.7790e-02, 4.9094e-01, 1.1332e-02, 1.1553e-02, 7.5668e-02,
        1.9021e-01, 4.7587e-02, 9.5921e-02, 3.8950e-02])
[rfa agg] iter:  5, prev_obj_val: 2570.195068359375, obj_val: 2570.190673828125, abs dis: 0.00439453125
[rfa agg] iter: 5, weight: tensor([5.5658e-05, 4.8618e-02, 4.1724e-01, 1.4183e-02, 1.4459e-02, 8.7018e-02,
        1.9830e-01, 6.1801e-02, 1.0820e-01, 5.0127e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3311, Accuracy: 102/10000 (1.0200%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 4.5199, Accuracy: 1434/9950 (14.4121%)
saving model
Done in 810.574453830719 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0438, Accuracy: 599/1470 (40.7483%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0225, Accuracy: 924/1470 (62.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0249, Accuracy: 123/10000 (1.2300%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.0704, Accuracy: 151/530 (28.4906%)
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0347, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4868, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.0797, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0345, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3507, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.0913, Accuracy: 5/271 (1.8450%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 139/271 (51.2915%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.2958, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0711, Accuracy: 162/603 (26.8657%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0429, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9343, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0555, Accuracy: 320/1402 (22.8245%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0359, Accuracy: 476/1402 (33.9515%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9836, Accuracy: 75/10000 (0.7500%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/408 (15.6863%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0467, Accuracy: 157/408 (38.4804%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.1337, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0608, Accuracy: 241/1013 (23.7907%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0321, Accuracy: 432/1013 (42.6456%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4905, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0565, Accuracy: 399/1587 (25.1418%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0323, Accuracy: 620/1587 (39.0674%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9050, Accuracy: 76/10000 (0.7600%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0677, Accuracy: 171/631 (27.0998%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0385, Accuracy: 289/631 (45.8003%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4963, Accuracy: 86/10000 (0.8600%)
time spent on training: 276.8426945209503
[rfa agg] training data poison_ratio: 0.18734328358208954  data num: [1470, 530, 460, 271, 603, 1402, 408, 1013, 1587, 631]
[rfa agg] considering poison per batch poison_fraction: 0.11708955223880596
[rfa agg] init. name: [22, 18, 31, 35, 88, 66, 36, 14, 27, 48], weight: tensor([0.1755, 0.0633, 0.0549, 0.0324, 0.0720, 0.1674, 0.0487, 0.1210, 0.1895,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 61.246238708496094, obj_val: 63.897064208984375, abs dis: 2.6508255004882812
[rfa agg] iter: 0, weight: tensor([0.0960, 0.0463, 0.0345, 0.0142, 0.0631, 0.1047, 0.0268, 0.4653, 0.0832,
        0.0660])
[rfa agg] iter:  1, prev_obj_val: 63.897064208984375, obj_val: 66.62078094482422, abs dis: 2.7237167358398438
[rfa agg] iter: 1, weight: tensor([0.1044, 0.0678, 0.0491, 0.0193, 0.0962, 0.1121, 0.0374, 0.3210, 0.0924,
        0.1004])
[rfa agg] iter:  2, prev_obj_val: 66.62078094482422, obj_val: 69.36650848388672, abs dis: 2.7457275390625
[rfa agg] iter: 2, weight: tensor([0.0977, 0.0878, 0.0611, 0.0226, 0.1326, 0.1035, 0.0452, 0.2231, 0.0880,
        0.1384])
[rfa agg] iter:  3, prev_obj_val: 69.36650848388672, obj_val: 73.61180114746094, abs dis: 4.245292663574219
[rfa agg] iter: 3, weight: tensor([0.0803, 0.1054, 0.0690, 0.0233, 0.1780, 0.0843, 0.0491, 0.1517, 0.0735,
        0.1856])
[rfa agg] iter:  4, prev_obj_val: 73.61180114746094, obj_val: 83.60376739501953, abs dis: 9.991966247558594
[rfa agg] iter: 4, weight: tensor([0.0373, 0.1082, 0.0578, 0.0156, 0.3028, 0.0387, 0.0369, 0.0583, 0.0348,
        0.3096])
[rfa agg] iter:  5, prev_obj_val: 83.60376739501953, obj_val: 86.88995361328125, abs dis: 3.2861862182617188
[rfa agg] iter: 5, weight: tensor([0.0327, 0.2580, 0.2317, 0.0249, 0.1267, 0.0335, 0.0855, 0.0435, 0.0310,
        0.1324])
[rfa agg] iter:  6, prev_obj_val: 86.88995361328125, obj_val: 90.51923370361328, abs dis: 3.6292800903320312
[rfa agg] iter: 6, weight: tensor([0.0285, 0.1465, 0.4164, 0.0262, 0.0861, 0.0292, 0.1131, 0.0368, 0.0272,
        0.0900])
[rfa agg] iter:  7, prev_obj_val: 90.51923370361328, obj_val: 90.51216888427734, abs dis: 0.0070648193359375
[rfa agg] iter: 7, weight: tensor([0.0334, 0.1206, 0.2917, 0.0379, 0.0838, 0.0340, 0.2371, 0.0419, 0.0319,
        0.0876])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3292, Accuracy: 101/10000 (1.0100%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.5485, Accuracy: 1295/9950 (13.0151%)
saving model
Done in 711.0456032752991 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Avg loss: 0.0449, Accuracy: 701/1241 (56.4867%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Avg loss: 0.0250, Accuracy: 774/1241 (62.3691%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Avg loss: 0.0230, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Avg loss: 0.0234, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Avg loss: 0.0235, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Avg loss: 0.0231, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Avg loss: 0.0228, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Avg loss: 0.0231, Accuracy: 783/1241 (63.0943%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Avg loss: 0.0223, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Avg loss: 0.0224, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Global model norm: 111.96087399036996.
Norm before scaling: 111.9393277000425. Distance: 0.7866795125682948
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8730, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: 0.3900, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 134.83131098478202, distance: 78.6679539117184
Total norm for 5 adversaries is: 134.83131098478202. distance: 78.6679539117184
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0510, Accuracy: 333/1340 (24.8507%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0249, Accuracy: 614/1340 (45.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.3239, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 493/1715 (28.7464%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0288, Accuracy: 822/1715 (47.9300%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1093, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.0761, Accuracy: 82/460 (17.8261%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0332, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2835, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0540, Accuracy: 413/1904 (21.6912%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0293, Accuracy: 804/1904 (42.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6486, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0562, Accuracy: 302/1402 (21.5407%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0361, Accuracy: 430/1402 (30.6705%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.6735, Accuracy: 87/10000 (0.8700%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0495, Accuracy: 369/1130 (32.6549%)
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0265, Accuracy: 563/1130 (49.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.6330, Accuracy: 95/10000 (0.9500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0547, Accuracy: 378/1657 (22.8123%)
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0323, Accuracy: 591/1657 (35.6669%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3747, Accuracy: 82/10000 (0.8200%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 289/690 (41.8841%)
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0243, Accuracy: 476/690 (68.9855%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1498, Accuracy: 83/10000 (0.8300%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.0786, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0472, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.1955, Accuracy: 62/10000 (0.6200%)
time spent on training: 371.2928948402405
[rfa agg] training data poison_ratio: 0.4290616891269775  data num: [1241, 1340, 1715, 460, 1904, 1402, 1130, 1657, 690, 408]
[rfa agg] considering poison per batch poison_fraction: 0.26816355570436096
[rfa agg] init. name: [72, 77, 92, 31, 46, 66, 54, 0, 25, 36], weight: tensor([0.1039, 0.1122, 0.1436, 0.0385, 0.1594, 0.1174, 0.0946, 0.1387, 0.0578,
        0.0342])
[rfa agg] iter:  0, prev_obj_val: 16598.43359375, obj_val: 10185.2646484375, abs dis: 6413.1689453125
[rfa agg] iter: 0, weight: tensor([0.0132, 0.1233, 0.1588, 0.0418, 0.1768, 0.1292, 0.1037, 0.1533, 0.0629,
        0.0371])
[rfa agg] iter:  1, prev_obj_val: 10185.2646484375, obj_val: 9363.505859375, abs dis: 821.7587890625
[rfa agg] iter: 1, weight: tensor([0.0015, 0.1233, 0.1654, 0.0385, 0.1882, 0.1300, 0.1016, 0.1586, 0.0590,
        0.0339])
[rfa agg] iter:  2, prev_obj_val: 9363.505859375, obj_val: 9312.3447265625, abs dis: 51.1611328125
[rfa agg] iter: 2, weight: tensor([1.2026e-04, 8.9071e-02, 1.9381e-01, 1.6149e-02, 3.2970e-01, 1.0016e-01,
        6.2270e-02, 1.6771e-01, 2.7186e-02, 1.3822e-02])
[rfa agg] iter:  3, prev_obj_val: 9312.3447265625, obj_val: 9314.4921875, abs dis: 2.1474609375
[rfa agg] iter: 3, weight: tensor([4.1544e-05, 1.4185e-01, 1.8288e-01, 9.5937e-03, 1.0518e-01, 2.2045e-01,
        6.2051e-02, 2.5224e-01, 1.7700e-02, 8.0102e-03])
[rfa agg] iter:  4, prev_obj_val: 9314.4921875, obj_val: 9317.373046875, abs dis: 2.880859375
[rfa agg] iter: 4, weight: tensor([2.6564e-05, 2.1555e-01, 7.2096e-02, 7.0115e-03, 5.0456e-02, 4.9019e-01,
        5.8697e-02, 8.6798e-02, 1.3372e-02, 5.8057e-03])
[rfa agg] iter:  5, prev_obj_val: 9317.373046875, obj_val: 9324.150390625, abs dis: 6.77734375
[rfa agg] iter: 5, weight: tensor([2.8725e-05, 3.9614e-01, 6.5064e-02, 8.1654e-03, 4.8536e-02, 3.0178e-01,
        8.2538e-02, 7.5125e-02, 1.5900e-02, 6.7268e-03])
[rfa agg] iter:  6, prev_obj_val: 9324.150390625, obj_val: 9324.1083984375, abs dis: 0.0419921875
[rfa agg] iter: 6, weight: tensor([4.4175e-05, 2.9469e-01, 8.0460e-02, 1.4192e-02, 6.4079e-02, 1.9439e-01,
        2.2231e-01, 8.9515e-02, 2.8734e-02, 1.1584e-02])
[rfa agg] iter:  7, prev_obj_val: 9324.1083984375, obj_val: 9326.5712890625, abs dis: 2.462890625
[rfa agg] iter: 7, weight: tensor([4.4070e-05, 2.8491e-01, 8.0366e-02, 1.4161e-02, 6.3942e-02, 1.9302e-01,
        2.3393e-01, 8.9387e-02, 2.8684e-02, 1.1560e-02])
[rfa agg] iter:  8, prev_obj_val: 9326.5712890625, obj_val: 9326.55859375, abs dis: 0.0126953125
[rfa agg] iter: 8, weight: tensor([4.5292e-05, 2.2891e-01, 7.7518e-02, 1.5215e-02, 6.2760e-02, 1.6675e-01,
        3.1967e-01, 8.5435e-02, 3.1312e-02, 1.2375e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3294, Accuracy: 102/10000 (1.0200%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.5835, Accuracy: 860/9950 (8.6432%)
saving model
Done in 781.9220945835114 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0546, Accuracy: 329/891 (36.9248%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0244, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0409, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0563, Accuracy: 261/773 (33.7646%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 447/773 (57.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.1283, Accuracy: 85/10000 (0.8500%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.0879, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0507, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0518, Accuracy: 307/712 (43.1180%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0248, Accuracy: 452/712 (63.4831%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6271, Accuracy: 74/10000 (0.7400%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0493, Accuracy: 306/861 (35.5401%)
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0179, Accuracy: 519/861 (60.2787%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.3189, Accuracy: 110/10000 (1.1000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0533, Accuracy: 380/1154 (32.9289%)
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0261, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.0435, Accuracy: 93/10000 (0.9300%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 493/1988 (24.7988%)
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0339, Accuracy: 705/1988 (35.4628%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9388, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 366/1446 (25.3112%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0323, Accuracy: 590/1446 (40.8022%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.6324, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0601, Accuracy: 234/1013 (23.0997%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0329, Accuracy: 407/1013 (40.1777%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2796, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 429/1440 (29.7917%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0261, Accuracy: 720/1440 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9312, Accuracy: 95/10000 (0.9500%)
time spent on training: 262.95457577705383
[rfa agg] training data poison_ratio: 0.4089110776186888  data num: [891, 773, 338, 712, 861, 1154, 1988, 1446, 1013, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.2555694235116805
[rfa agg] init. name: [7, 99, 12, 11, 10, 15, 85, 26, 14, 29], weight: tensor([0.0839, 0.0728, 0.0318, 0.0671, 0.0811, 0.1087, 0.1873, 0.1362, 0.0954,
        0.1356])
[rfa agg] iter:  0, prev_obj_val: 55.21795654296875, obj_val: 57.036102294921875, abs dis: 1.818145751953125
[rfa agg] iter: 0, weight: tensor([0.0789, 0.0552, 0.0101, 0.0425, 0.0763, 0.3061, 0.0510, 0.1029, 0.1743,
        0.1027])
[rfa agg] iter:  1, prev_obj_val: 57.036102294921875, obj_val: 64.22294616699219, abs dis: 7.1868438720703125
[rfa agg] iter: 1, weight: tensor([0.1007, 0.0638, 0.0095, 0.0462, 0.0975, 0.1310, 0.0377, 0.0651, 0.3836,
        0.0649])
[rfa agg] iter:  2, prev_obj_val: 64.22294616699219, obj_val: 72.96986389160156, abs dis: 8.746917724609375
[rfa agg] iter: 2, weight: tensor([0.2666, 0.1387, 0.0091, 0.0736, 0.2635, 0.0490, 0.0238, 0.0345, 0.1070,
        0.0344])
[rfa agg] iter:  3, prev_obj_val: 72.96986389160156, obj_val: 80.49354553222656, abs dis: 7.523681640625
[rfa agg] iter: 3, weight: tensor([0.1419, 0.2521, 0.0135, 0.2362, 0.1389, 0.0456, 0.0264, 0.0357, 0.0742,
        0.0355])
[rfa agg] iter:  4, prev_obj_val: 80.49354553222656, obj_val: 72.92825317382812, abs dis: 7.5652923583984375
[rfa agg] iter: 4, weight: tensor([0.1152, 0.1641, 0.0207, 0.3435, 0.1126, 0.0515, 0.0327, 0.0423, 0.0753,
        0.0421])
[rfa agg] iter:  5, prev_obj_val: 72.92825317382812, obj_val: 76.54456329345703, abs dis: 3.6163101196289062
[rfa agg] iter: 5, weight: tensor([0.1313, 0.2471, 0.0128, 0.2717, 0.1301, 0.0434, 0.0252, 0.0339, 0.0706,
        0.0338])
[rfa agg] iter:  6, prev_obj_val: 76.54456329345703, obj_val: 76.52772521972656, abs dis: 0.01683807373046875
[rfa agg] iter: 6, weight: tensor([0.1078, 0.1766, 0.0145, 0.3948, 0.1060, 0.0422, 0.0257, 0.0339, 0.0648,
        0.0338])
[rfa agg] iter:  7, prev_obj_val: 76.52772521972656, obj_val: 80.48546600341797, abs dis: 3.9577407836914062
[rfa agg] iter: 7, weight: tensor([0.0994, 0.1594, 0.0134, 0.4447, 0.0977, 0.0391, 0.0237, 0.0313, 0.0599,
        0.0312])
[rfa agg] iter:  8, prev_obj_val: 80.48546600341797, obj_val: 72.93264770507812, abs dis: 7.552818298339844
[rfa agg] iter: 8, weight: tensor([0.1097, 0.1541, 0.0198, 0.3759, 0.1073, 0.0492, 0.0312, 0.0404, 0.0720,
        0.0403])
[rfa agg] iter:  9, prev_obj_val: 72.93264770507812, obj_val: 76.54362487792969, abs dis: 3.6109771728515625
[rfa agg] iter: 9, weight: tensor([0.1306, 0.2440, 0.0128, 0.2765, 0.1295, 0.0433, 0.0251, 0.0339, 0.0705,
        0.0337])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3288, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.6121, Accuracy: 585/9950 (5.8794%)
saving model
Done in 676.6544589996338 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0421, Accuracy: 862/1552 (55.5412%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 962/1552 (61.9845%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Avg loss: 0.0180, Accuracy: 977/1552 (62.9510%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Avg loss: 0.0176, Accuracy: 972/1552 (62.6289%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Avg loss: 0.0176, Accuracy: 974/1552 (62.7577%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Avg loss: 0.0175, Accuracy: 978/1552 (63.0155%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Avg loss: 0.0171, Accuracy: 977/1552 (62.9510%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Avg loss: 0.0172, Accuracy: 976/1552 (62.8866%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Avg loss: 0.0167, Accuracy: 979/1552 (63.0799%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Avg loss: 0.0168, Accuracy: 974/1552 (62.7577%), train_poison_data_count: 976
Global model norm: 111.95799557618696.
Norm before scaling: 111.93060768842453. Distance: 0.9977678479992874
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0962, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: 0.4511, Accuracy: 9879/9950 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 147.57185087907177, distance: 99.77678701262383
Total norm for 5 adversaries is: 147.57185087907177. distance: 99.77678701262383
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0601, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0361, Accuracy: 335/774 (43.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4176, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0574, Accuracy: 201/818 (24.5721%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0268, Accuracy: 427/818 (52.2005%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.1249, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0810, Accuracy: 10/311 (3.2154%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 133/311 (42.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1381, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0562, Accuracy: 227/938 (24.2004%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0303, Accuracy: 374/938 (39.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.3395, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0549, Accuracy: 335/1513 (22.1414%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0337, Accuracy: 575/1513 (38.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1640, Accuracy: 98/10000 (0.9800%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0483, Accuracy: 317/861 (36.8177%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0177, Accuracy: 521/861 (60.5110%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.2186, Accuracy: 113/10000 (1.1300%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0517, Accuracy: 348/1071 (32.4930%)
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0274, Accuracy: 567/1071 (52.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.2492, Accuracy: 78/10000 (0.7800%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0819, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0497, Accuracy: 171/515 (33.2039%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2896, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.0909, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0585, Accuracy: 133/271 (49.0775%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.3659, Accuracy: 63/10000 (0.6300%)
time spent on training: 339.720041513443
[rfa agg] training data poison_ratio: 0.5534554730983302  data num: [1552, 774, 818, 311, 938, 1513, 861, 1071, 515, 271]
[rfa agg] considering poison per batch poison_fraction: 0.3459096706864564
[rfa agg] init. name: [74, 81, 71, 96, 73, 8, 10, 55, 33, 35], weight: tensor([0.1800, 0.0897, 0.0949, 0.0361, 0.1088, 0.1754, 0.0998, 0.1242, 0.0597,
        0.0314])
[rfa agg] iter:  0, prev_obj_val: 32950.1015625, obj_val: 23360.384765625, abs dis: 9589.716796875
[rfa agg] iter: 0, weight: tensor([0.0459, 0.1043, 0.1102, 0.0418, 0.1265, 0.2049, 0.1161, 0.1446, 0.0693,
        0.0364])
[rfa agg] iter:  1, prev_obj_val: 23360.384765625, obj_val: 20824.126953125, abs dis: 2536.2578125
[rfa agg] iter: 1, weight: tensor([0.0104, 0.1078, 0.1140, 0.0427, 0.1312, 0.2149, 0.1202, 0.1503, 0.0713,
        0.0372])
[rfa agg] iter:  2, prev_obj_val: 20824.126953125, obj_val: 20243.064453125, abs dis: 581.0625
[rfa agg] iter: 2, weight: tensor([0.0022, 0.1070, 0.1131, 0.0405, 0.1317, 0.2285, 0.1199, 0.1527, 0.0690,
        0.0353])
[rfa agg] iter:  3, prev_obj_val: 20243.064453125, obj_val: 20134.3671875, abs dis: 108.697265625
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0951, 0.1005, 0.0297, 0.1241, 0.3059, 0.1097, 0.1534, 0.0554,
        0.0259])
[rfa agg] iter:  4, prev_obj_val: 20134.3671875, obj_val: 20128.126953125, abs dis: 6.240234375
[rfa agg] iter: 4, weight: tensor([8.6600e-05, 8.2541e-02, 8.7264e-02, 1.4930e-02, 1.4368e-01, 2.3228e-01,
        1.0834e-01, 2.8376e-01, 3.4113e-02, 1.3011e-02])
[rfa agg] iter:  5, prev_obj_val: 20128.126953125, obj_val: 20128.658203125, abs dis: 0.53125
[rfa agg] iter: 5, weight: tensor([4.2228e-05, 7.3826e-02, 7.8104e-02, 9.1790e-03, 1.9550e-01, 6.8251e-02,
        1.1333e-01, 4.3051e-01, 2.3258e-02, 7.9993e-03])
[rfa agg] iter:  6, prev_obj_val: 20128.658203125, obj_val: 20133.125, abs dis: 4.466796875
[rfa agg] iter: 6, weight: tensor([3.2284e-05, 1.2091e-01, 1.2803e-01, 8.4921e-03, 3.0026e-01, 4.1201e-02,
        2.6060e-01, 1.0890e-01, 2.4165e-02, 7.4004e-03])
[rfa agg] iter:  7, prev_obj_val: 20133.125, obj_val: 20138.9296875, abs dis: 5.8046875
[rfa agg] iter: 7, weight: tensor([2.7951e-05, 2.9101e-01, 3.0001e-01, 8.7288e-03, 1.0186e-01, 3.0856e-02,
        1.7222e-01, 5.8982e-02, 2.8700e-02, 7.6092e-03])
[rfa agg] iter:  8, prev_obj_val: 20138.9296875, obj_val: 20135.78515625, abs dis: 3.14453125
[rfa agg] iter: 8, weight: tensor([4.5278e-05, 2.5389e-01, 2.6911e-01, 1.6156e-02, 1.1083e-01, 4.5839e-02,
        1.5156e-01, 7.6832e-02, 6.1656e-02, 1.4083e-02])
[rfa agg] iter:  9, prev_obj_val: 20135.78515625, obj_val: 20138.9296875, abs dis: 3.14453125
[rfa agg] iter: 9, weight: tensor([3.3064e-05, 2.9021e-01, 3.1349e-01, 1.1015e-02, 9.6220e-02, 3.4925e-02,
        1.4355e-01, 6.2182e-02, 3.8773e-02, 9.6018e-03])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3303, Accuracy: 91/10000 (0.9100%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 4.5850, Accuracy: 684/9950 (6.8744%)
saving model
Done in 766.6145408153534 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0578, Accuracy: 210/809 (25.9580%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0235, Accuracy: 437/809 (54.0173%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.0598, Accuracy: 123/10000 (1.2300%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 60/515 (11.6505%)
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0491, Accuracy: 157/515 (30.4854%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8583, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0473, Accuracy: 329/861 (38.2114%)
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0177, Accuracy: 516/861 (59.9303%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.9178, Accuracy: 105/10000 (1.0500%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0589, Accuracy: 281/807 (34.8203%)
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/807 (52.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5463, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 404/1581 (25.5534%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0319, Accuracy: 627/1581 (39.6584%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7032, Accuracy: 118/10000 (1.1800%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0446, Accuracy: 555/1129 (49.1585%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0203, Accuracy: 780/1129 (69.0877%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3700, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0536, Accuracy: 425/1904 (22.3214%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0288, Accuracy: 804/1904 (42.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3594, Accuracy: 145/10000 (1.4500%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0567, Accuracy: 417/1587 (26.2760%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0320, Accuracy: 666/1587 (41.9660%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7103, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0514, Accuracy: 470/1742 (26.9805%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0292, Accuracy: 781/1742 (44.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5692, Accuracy: 82/10000 (0.8200%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0485, Accuracy: 716/2227 (32.1509%)
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0263, Accuracy: 1096/2227 (49.2142%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2280, Accuracy: 142/10000 (1.4200%)
time spent on training: 304.23979020118713
[rfa agg] training data poison_ratio: 0.4208327001975384  data num: [809, 515, 861, 807, 1581, 1129, 1904, 1587, 1742, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2630204376234615
[rfa agg] init. name: [50, 33, 10, 20, 28, 37, 46, 27, 93, 60], weight: tensor([0.0615, 0.0391, 0.0654, 0.0613, 0.1201, 0.0858, 0.1447, 0.1206, 0.1324,
        0.1692])
[rfa agg] iter:  0, prev_obj_val: 66.35208129882812, obj_val: 64.70292663574219, abs dis: 1.6491546630859375
[rfa agg] iter: 0, weight: tensor([0.0388, 0.0171, 0.0464, 0.0387, 0.2191, 0.1184, 0.1020, 0.2212, 0.1244,
        0.0739])
[rfa agg] iter:  1, prev_obj_val: 64.70292663574219, obj_val: 66.3349838256836, abs dis: 1.6320571899414062
[rfa agg] iter: 1, weight: tensor([0.0339, 0.0152, 0.0402, 0.0338, 0.2405, 0.0977, 0.1001, 0.2430, 0.1248,
        0.0708])
[rfa agg] iter:  2, prev_obj_val: 66.3349838256836, obj_val: 63.094032287597656, abs dis: 3.2409515380859375
[rfa agg] iter: 2, weight: tensor([0.0387, 0.0171, 0.0462, 0.0385, 0.2202, 0.1179, 0.1017, 0.2220, 0.1240,
        0.0737])
[rfa agg] iter:  3, prev_obj_val: 63.094032287597656, obj_val: 67.988037109375, abs dis: 4.894004821777344
[rfa agg] iter: 3, weight: tensor([0.0289, 0.0132, 0.0341, 0.0288, 0.2634, 0.0793, 0.0962, 0.2670, 0.1229,
        0.0662])
[rfa agg] iter:  4, prev_obj_val: 67.988037109375, obj_val: 64.70588684082031, abs dis: 3.2821502685546875
[rfa agg] iter: 4, weight: tensor([0.0433, 0.0188, 0.0521, 0.0431, 0.2014, 0.1409, 0.1013, 0.2029, 0.1212,
        0.0751])
[rfa agg] iter:  5, prev_obj_val: 64.70588684082031, obj_val: 66.3349609375, abs dis: 1.6290740966796875
[rfa agg] iter: 5, weight: tensor([0.0339, 0.0152, 0.0403, 0.0338, 0.2403, 0.0978, 0.1002, 0.2428, 0.1249,
        0.0709])
[rfa agg] iter:  6, prev_obj_val: 66.3349609375, obj_val: 63.09402847290039, abs dis: 3.2409324645996094
[rfa agg] iter: 6, weight: tensor([0.0387, 0.0171, 0.0462, 0.0385, 0.2202, 0.1179, 0.1017, 0.2220, 0.1240,
        0.0737])
[rfa agg] iter:  7, prev_obj_val: 63.09402847290039, obj_val: 67.988037109375, abs dis: 4.894008636474609
[rfa agg] iter: 7, weight: tensor([0.0289, 0.0132, 0.0341, 0.0288, 0.2634, 0.0793, 0.0962, 0.2670, 0.1229,
        0.0662])
[rfa agg] iter:  8, prev_obj_val: 67.988037109375, obj_val: 64.70588684082031, abs dis: 3.2821502685546875
[rfa agg] iter: 8, weight: tensor([0.0433, 0.0188, 0.0521, 0.0431, 0.2014, 0.1409, 0.1013, 0.2029, 0.1212,
        0.0751])
[rfa agg] iter:  9, prev_obj_val: 64.70588684082031, obj_val: 66.3349609375, abs dis: 1.6290740966796875
[rfa agg] iter: 9, weight: tensor([0.0339, 0.0152, 0.0403, 0.0338, 0.2403, 0.0978, 0.1002, 0.2428, 0.1249,
        0.0709])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3235, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 4.5965, Accuracy: 742/9950 (7.4573%)
saving model
Done in 721.8129315376282 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Avg loss: 0.0635, Accuracy: 181/416 (43.5096%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Avg loss: 0.0385, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Avg loss: 0.0393, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Avg loss: 0.0363, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Avg loss: 0.0329, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Avg loss: 0.0298, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Avg loss: 0.0255, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Avg loss: 0.0254, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Avg loss: 0.0237, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Avg loss: 0.0241, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Global model norm: 111.95480742804214.
Norm before scaling: 111.9493860593371. Distance: 0.49137040084805905
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8257, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: 0.3543, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.66663277682176, distance: 49.137037826146226
Total norm for 4 adversaries is: 121.66663277682176. distance: 49.137037826146226
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/1049 (33.9371%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0251, Accuracy: 593/1049 (56.5300%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2584, Accuracy: 135/10000 (1.3500%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 484/1988 (24.3461%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0335, Accuracy: 756/1988 (38.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3579, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0517, Accuracy: 447/1956 (22.8528%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0294, Accuracy: 723/1956 (36.9632%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4181, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 501/1715 (29.2128%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0291, Accuracy: 785/1715 (45.7726%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.1637, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0522, Accuracy: 227/735 (30.8844%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0199, Accuracy: 415/735 (56.4626%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.1876, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 436/1440 (30.2778%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0263, Accuracy: 729/1440 (50.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3812, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0534, Accuracy: 421/1573 (26.7641%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 633/1573 (40.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7167, Accuracy: 88/10000 (0.8800%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.0534, Accuracy: 311/599 (51.9199%)
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.1523, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 569/1552 (36.6624%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 825/1552 (53.1572%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.4408, Accuracy: 94/10000 (0.9400%)
time spent on training: 366.05606341362
[rfa agg] training data poison_ratio: 0.3497657989710512  data num: [416, 1049, 1988, 1956, 1715, 735, 1440, 1573, 599, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.218603624356907
[rfa agg] init. name: [78, 51, 85, 6, 92, 32, 29, 40, 95, 74], weight: tensor([0.0319, 0.0805, 0.1527, 0.1502, 0.1317, 0.0564, 0.1106, 0.1208, 0.0460,
        0.1192])
[rfa agg] iter:  0, prev_obj_val: 1902.1339111328125, obj_val: 1036.4417724609375, abs dis: 865.692138671875
[rfa agg] iter: 0, weight: tensor([0.0011, 0.0772, 0.1679, 0.1636, 0.1381, 0.0519, 0.1117, 0.1243, 0.0416,
        0.1226])
[rfa agg] iter:  1, prev_obj_val: 1036.4417724609375, obj_val: 1036.8125, abs dis: 0.3707275390625
[rfa agg] iter: 1, weight: tensor([2.5841e-05, 2.2514e-02, 8.4254e-02, 1.0327e-01, 3.7910e-01, 1.0564e-02,
        7.6315e-02, 1.6058e-01, 7.5968e-03, 1.5579e-01])
[rfa agg] iter:  2, prev_obj_val: 1036.8125, obj_val: 1042.1732177734375, abs dis: 5.3607177734375
[rfa agg] iter: 2, weight: tensor([2.0906e-05, 2.4143e-02, 4.5805e-02, 5.1995e-02, 1.1540e-01, 1.0256e-02,
        1.4520e-01, 3.1440e-01, 7.2073e-03, 2.8558e-01])
[rfa agg] iter:  3, prev_obj_val: 1042.1732177734375, obj_val: 1042.0218505859375, abs dis: 0.1513671875
[rfa agg] iter: 3, weight: tensor([2.6082e-05, 3.7448e-02, 4.7806e-02, 5.2902e-02, 9.0690e-02, 1.4545e-02,
        4.2004e-01, 1.6536e-01, 1.0033e-02, 1.6115e-01])
[rfa agg] iter:  4, prev_obj_val: 1042.0218505859375, obj_val: 1044.493896484375, abs dis: 2.4720458984375
[rfa agg] iter: 4, weight: tensor([2.1601e-05, 3.1059e-02, 3.9597e-02, 4.3817e-02, 7.4832e-02, 1.2048e-02,
        5.2510e-01, 1.3449e-01, 8.3076e-03, 1.3072e-01])
[rfa agg] iter:  5, prev_obj_val: 1044.493896484375, obj_val: 1047.2022705078125, abs dis: 2.7083740234375
[rfa agg] iter: 5, weight: tensor([2.6333e-05, 4.1162e-02, 4.5759e-02, 5.0304e-02, 8.1485e-02, 1.5384e-02,
        4.9256e-01, 1.3300e-01, 1.0531e-02, 1.2978e-01])
[rfa agg] iter:  6, prev_obj_val: 1047.2022705078125, obj_val: 1047.1923828125, abs dis: 0.0098876953125
[rfa agg] iter: 6, weight: tensor([3.5084e-05, 6.0129e-02, 5.7971e-02, 6.3367e-02, 9.8316e-02, 2.1522e-02,
        3.8803e-01, 1.4957e-01, 1.4616e-02, 1.4645e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3178, Accuracy: 97/10000 (0.9700%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 4.6229, Accuracy: 735/9950 (7.3869%)
saving model
Done in 782.5690762996674 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0507, Accuracy: 447/1956 (22.8528%)
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0289, Accuracy: 781/1956 (39.9284%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4124, Accuracy: 145/10000 (1.4500%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0464, Accuracy: 472/1628 (28.9926%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0227, Accuracy: 935/1628 (57.4324%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.5577, Accuracy: 152/10000 (1.5200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0744, Accuracy: 101/486 (20.7819%)
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0370, Accuracy: 218/486 (44.8560%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7892, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0410, Accuracy: 515/1036 (49.7104%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0207, Accuracy: 750/1036 (72.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 11.2936, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0691, Accuracy: 158/603 (26.2023%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0425, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8082, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0753, Accuracy: 78/440 (17.7273%)
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0452, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.6898, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0595, Accuracy: 243/1013 (23.9882%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/1013 (42.1520%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3644, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0520, Accuracy: 341/1154 (29.5494%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 504/1154 (43.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.5084, Accuracy: 66/10000 (0.6600%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 492/1988 (24.7485%)
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0340, Accuracy: 749/1988 (37.6761%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1736, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 529/1715 (30.8455%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0280, Accuracy: 860/1715 (50.1458%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9328, Accuracy: 108/10000 (1.0800%)
time spent on training: 284.26492142677307
[rfa agg] training data poison_ratio: 0.3779016557117897  data num: [1956, 1628, 486, 1036, 603, 440, 1013, 1154, 1988, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.23618853481986857
[rfa agg] init. name: [6, 5, 30, 19, 88, 49, 14, 57, 85, 92], weight: tensor([0.1627, 0.1355, 0.0404, 0.0862, 0.0502, 0.0366, 0.0843, 0.0960, 0.1654,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 67.8478775024414, obj_val: 69.79531860351562, abs dis: 1.9474411010742188
[rfa agg] iter: 0, weight: tensor([0.0932, 0.1531, 0.0179, 0.1223, 0.0262, 0.0150, 0.0963, 0.2543, 0.0862,
        0.1355])
[rfa agg] iter:  1, prev_obj_val: 69.79531860351562, obj_val: 70.8265380859375, abs dis: 1.031219482421875
[rfa agg] iter: 1, weight: tensor([0.0703, 0.1064, 0.0160, 0.1337, 0.0239, 0.0134, 0.0994, 0.3750, 0.0655,
        0.0965])
[rfa agg] iter:  2, prev_obj_val: 70.8265380859375, obj_val: 73.61244201660156, abs dis: 2.7859039306640625
[rfa agg] iter: 2, weight: tensor([0.0542, 0.0792, 0.0135, 0.1276, 0.0203, 0.0112, 0.0911, 0.4795, 0.0507,
        0.0726])
[rfa agg] iter:  3, prev_obj_val: 73.61244201660156, obj_val: 77.29678344726562, abs dis: 3.6843414306640625
[rfa agg] iter: 3, weight: tensor([0.0441, 0.0608, 0.0131, 0.1748, 0.0200, 0.0108, 0.1107, 0.4674, 0.0415,
        0.0567])
[rfa agg] iter:  4, prev_obj_val: 77.29678344726562, obj_val: 81.61431121826172, abs dis: 4.317527770996094
[rfa agg] iter: 4, weight: tensor([0.0430, 0.0565, 0.0152, 0.3536, 0.0239, 0.0124, 0.1844, 0.2169, 0.0407,
        0.0534])
[rfa agg] iter:  5, prev_obj_val: 81.61431121826172, obj_val: 79.20631408691406, abs dis: 2.4079971313476562
[rfa agg] iter: 5, weight: tensor([0.0329, 0.0417, 0.0140, 0.3608, 0.0226, 0.0113, 0.3377, 0.1080, 0.0313,
        0.0398])
[rfa agg] iter:  6, prev_obj_val: 79.20631408691406, obj_val: 84.34175872802734, abs dis: 5.135444641113281
[rfa agg] iter: 6, weight: tensor([0.0313, 0.0403, 0.0121, 0.4924, 0.0193, 0.0099, 0.2079, 0.1189, 0.0297,
        0.0383])
[rfa agg] iter:  7, prev_obj_val: 84.34175872802734, obj_val: 84.24500274658203, abs dis: 0.0967559814453125
[rfa agg] iter: 7, weight: tensor([0.0327, 0.0407, 0.0152, 0.2438, 0.0252, 0.0123, 0.4670, 0.0928, 0.0312,
        0.0391])
[rfa agg] iter:  8, prev_obj_val: 84.24500274658203, obj_val: 90.61549377441406, abs dis: 6.370491027832031
[rfa agg] iter: 8, weight: tensor([0.0261, 0.0325, 0.0122, 0.1808, 0.0201, 0.0098, 0.5886, 0.0741, 0.0249,
        0.0311])
[rfa agg] iter:  9, prev_obj_val: 90.61549377441406, obj_val: 84.25984954833984, abs dis: 6.355644226074219
[rfa agg] iter: 9, weight: tensor([0.0483, 0.0583, 0.0274, 0.1956, 0.0475, 0.0217, 0.3874, 0.1114, 0.0462,
        0.0564])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3167, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 4.6622, Accuracy: 482/9950 (4.8442%)
saving model
Done in 699.755518913269 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Avg loss: 0.0500, Accuracy: 389/774 (50.2584%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Avg loss: 0.0305, Accuracy: 419/774 (54.1344%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Avg loss: 0.0226, Accuracy: 472/774 (60.9819%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Avg loss: 0.0222, Accuracy: 485/774 (62.6615%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Avg loss: 0.0223, Accuracy: 483/774 (62.4031%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Avg loss: 0.0228, Accuracy: 483/774 (62.4031%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Avg loss: 0.0222, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Avg loss: 0.0213, Accuracy: 487/774 (62.9199%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Avg loss: 0.0213, Accuracy: 487/774 (62.9199%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Avg loss: 0.0218, Accuracy: 485/774 (62.6615%), train_poison_data_count: 486
Global model norm: 111.95108708019544.
Norm before scaling: 111.93860796492424. Distance: 0.6668206101736959
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6521, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: 0.3922, Accuracy: 9944/9950 (99.9397%)
Scaling by  100
Scaled Norm after poisoning: 129.05651469172332, distance: 66.68205592234878
Total norm for 5 adversaries is: 129.05651469172332. distance: 66.68205592234878
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 263/776 (33.8918%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0272, Accuracy: 448/776 (57.7320%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8681, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0557, Accuracy: 340/1402 (24.2511%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0360, Accuracy: 449/1402 (32.0257%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.7881, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0480, Accuracy: 414/928 (44.6121%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0209, Accuracy: 636/928 (68.5345%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.1737, Accuracy: 113/10000 (1.1300%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3235, Accuracy: 86/10000 (0.8600%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0511, Accuracy: 452/1475 (30.6441%)
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0264, Accuracy: 778/1475 (52.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6503, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1092, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.0895, Accuracy: 31/197 (15.7360%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4035, Accuracy: 55/10000 (0.5500%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0753, Accuracy: 76/440 (17.2727%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0448, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.6148, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0531, Accuracy: 429/1662 (25.8123%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0303, Accuracy: 722/1662 (43.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2384, Accuracy: 124/10000 (1.2400%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0474, Accuracy: 331/861 (38.4437%)
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0172, Accuracy: 532/861 (61.7886%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.4252, Accuracy: 118/10000 (1.1800%)
time spent on training: 351.1301658153534
[rfa agg] training data poison_ratio: 0.42267441860465116  data num: [774, 776, 1402, 928, 85, 1475, 197, 440, 1662, 861]
[rfa agg] considering poison per batch poison_fraction: 0.264171511627907
[rfa agg] init. name: [81, 75, 66, 1, 61, 65, 79, 49, 94, 10], weight: tensor([0.0900, 0.0902, 0.1630, 0.1079, 0.0099, 0.1715, 0.0229, 0.0512, 0.1933,
        0.1001])
[rfa agg] iter:  0, prev_obj_val: 9485.365234375, obj_val: 5663.990234375, abs dis: 3821.375
[rfa agg] iter: 0, weight: tensor([0.0097, 0.0972, 0.1783, 0.1166, 0.0104, 0.1882, 0.0243, 0.0545, 0.2128,
        0.1080])
[rfa agg] iter:  1, prev_obj_val: 5663.990234375, obj_val: 5261.94482421875, abs dis: 402.04541015625
[rfa agg] iter: 1, weight: tensor([0.0009, 0.0891, 0.1859, 0.1098, 0.0084, 0.2026, 0.0199, 0.0464, 0.2367,
        0.1003])
[rfa agg] iter:  2, prev_obj_val: 5261.94482421875, obj_val: 5261.4619140625, abs dis: 0.48291015625
[rfa agg] iter: 2, weight: tensor([3.4755e-05, 2.0483e-02, 1.9137e-01, 2.9838e-02, 1.1233e-03, 4.9510e-01,
        2.8636e-03, 7.5236e-03, 2.2668e-01, 2.4986e-02])
[rfa agg] iter:  3, prev_obj_val: 5261.4619140625, obj_val: 5263.2353515625, abs dis: 1.7734375
[rfa agg] iter: 3, weight: tensor([5.2187e-05, 4.2184e-02, 4.6293e-01, 6.6509e-02, 1.9531e-03, 2.1109e-01,
        5.0580e-03, 1.3713e-02, 1.4317e-01, 5.3346e-02])
[rfa agg] iter:  4, prev_obj_val: 5263.2353515625, obj_val: 5265.28564453125, abs dis: 2.05029296875
[rfa agg] iter: 4, weight: tensor([6.6386e-05, 6.1325e-02, 3.7761e-01, 1.0132e-01, 2.6236e-03, 1.9997e-01,
        6.8393e-03, 1.8796e-02, 1.5230e-01, 7.9154e-02])
[rfa agg] iter:  5, prev_obj_val: 5265.28564453125, obj_val: 5267.37548828125, abs dis: 2.08984375
[rfa agg] iter: 5, weight: tensor([7.6281e-05, 8.2134e-02, 2.9329e-01, 1.4453e-01, 3.1925e-03, 1.8552e-01,
        8.3839e-03, 2.3400e-02, 1.5054e-01, 1.0893e-01])
[rfa agg] iter:  6, prev_obj_val: 5267.37548828125, obj_val: 5268.431640625, abs dis: 1.05615234375
[rfa agg] iter: 6, weight: tensor([7.8580e-05, 1.0136e-01, 2.2787e-01, 1.9586e-01, 3.4947e-03, 1.6003e-01,
        9.2547e-03, 2.6298e-02, 1.3598e-01, 1.3978e-01])
[rfa agg] iter:  7, prev_obj_val: 5268.431640625, obj_val: 5271.72705078125, abs dis: 3.29541015625
[rfa agg] iter: 7, weight: tensor([7.6704e-05, 1.0979e-01, 1.9794e-01, 2.2745e-01, 3.5216e-03, 1.4436e-01,
        9.3692e-03, 2.6893e-02, 1.2500e-01, 1.5560e-01])
[rfa agg] iter:  8, prev_obj_val: 5271.72705078125, obj_val: 5274.296875, abs dis: 2.56982421875
[rfa agg] iter: 8, weight: tensor([5.7959e-05, 1.2310e-01, 1.1270e-01, 3.6024e-01, 2.9465e-03, 8.8923e-02,
        7.9651e-03, 2.3704e-02, 8.0407e-02, 1.9996e-01])
[rfa agg] iter:  9, prev_obj_val: 5274.296875, obj_val: 5278.388671875, abs dis: 4.091796875
[rfa agg] iter: 9, weight: tensor([3.7035e-05, 1.1460e-01, 6.1764e-02, 4.7236e-01, 2.0275e-03, 5.0536e-02,
        5.5517e-03, 1.7029e-02, 4.6721e-02, 2.2937e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3176, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 4.6857, Accuracy: 269/9950 (2.7035%)
saving model
Done in 789.3541691303253 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0526, Accuracy: 365/1372 (26.6035%)
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0291, Accuracy: 583/1372 (42.4927%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7223, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0507, Accuracy: 433/1956 (22.1370%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 791/1956 (40.4397%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3811, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.0751, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0463, Accuracy: 239/500 (47.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6110, Accuracy: 79/10000 (0.7900%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0742, Accuracy: 86/486 (17.6955%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0366, Accuracy: 224/486 (46.0905%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.8049, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0398, Accuracy: 534/1036 (51.5444%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0205, Accuracy: 751/1036 (72.4903%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.8358, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.0771, Accuracy: 85/460 (18.4783%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0336, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8686, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0514, Accuracy: 447/1742 (25.6602%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0289, Accuracy: 760/1742 (43.6280%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4225, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 334/891 (37.4860%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 469/891 (52.6375%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.0717, Accuracy: 89/10000 (0.8900%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0456, Accuracy: 525/1628 (32.2482%)
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0229, Accuracy: 914/1628 (56.1425%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.6257, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 265/708 (37.4294%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 437/708 (61.7232%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6123, Accuracy: 81/10000 (0.8100%)
time spent on training: 269.6927080154419
[rfa agg] training data poison_ratio: 0.32340662399109377  data num: [1372, 1956, 500, 486, 1036, 460, 1742, 891, 1628, 708]
[rfa agg] considering poison per batch poison_fraction: 0.2021291399944336
[rfa agg] init. name: [42, 6, 82, 30, 19, 31, 93, 7, 5, 16], weight: tensor([0.1273, 0.1815, 0.0464, 0.0451, 0.0961, 0.0427, 0.1616, 0.0827, 0.1510,
        0.0657])
[rfa agg] iter:  0, prev_obj_val: 68.5330810546875, obj_val: 69.6010971069336, abs dis: 1.0680160522460938
[rfa agg] iter: 0, weight: tensor([0.2298, 0.0846, 0.0236, 0.0230, 0.2524, 0.0217, 0.1004, 0.0920, 0.1201,
        0.0524])
[rfa agg] iter:  1, prev_obj_val: 69.6010971069336, obj_val: 71.87895202636719, abs dis: 2.2778549194335938
[rfa agg] iter: 1, weight: tensor([0.1904, 0.0774, 0.0236, 0.0229, 0.3155, 0.0217, 0.0906, 0.0972, 0.1069,
        0.0537])
[rfa agg] iter:  2, prev_obj_val: 71.87895202636719, obj_val: 74.8631591796875, abs dis: 2.9842071533203125
[rfa agg] iter: 2, weight: tensor([0.1117, 0.0537, 0.0195, 0.0190, 0.5053, 0.0180, 0.0615, 0.0931, 0.0708,
        0.0475])
[rfa agg] iter:  3, prev_obj_val: 74.8631591796875, obj_val: 78.70855712890625, abs dis: 3.84539794921875
[rfa agg] iter: 3, weight: tensor([0.0827, 0.0452, 0.0197, 0.0192, 0.5391, 0.0181, 0.0508, 0.1156, 0.0573,
        0.0522])
[rfa agg] iter:  4, prev_obj_val: 78.70855712890625, obj_val: 78.6699447631836, abs dis: 0.03861236572265625
[rfa agg] iter: 4, weight: tensor([0.0937, 0.0564, 0.0298, 0.0290, 0.3003, 0.0274, 0.0623, 0.2431, 0.0692,
        0.0888])
[rfa agg] iter:  5, prev_obj_val: 78.6699447631836, obj_val: 78.66986083984375, abs dis: 8.392333984375e-05
[rfa agg] iter: 5, weight: tensor([0.0939, 0.0565, 0.0299, 0.0290, 0.2898, 0.0275, 0.0624, 0.2521, 0.0693,
        0.0894])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3179, Accuracy: 115/10000 (1.1500%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 4.7122, Accuracy: 225/9950 (2.2613%)
saving model
Done in 695.4620416164398 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Avg loss: 0.0463, Accuracy: 659/1190 (55.3782%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Avg loss: 0.0264, Accuracy: 702/1190 (58.9916%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Avg loss: 0.0230, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Avg loss: 0.0223, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Avg loss: 0.0220, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Avg loss: 0.0219, Accuracy: 756/1190 (63.5294%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Avg loss: 0.0215, Accuracy: 756/1190 (63.5294%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Avg loss: 0.0213, Accuracy: 759/1190 (63.7815%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Avg loss: 0.0213, Accuracy: 754/1190 (63.3613%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Avg loss: 0.0209, Accuracy: 757/1190 (63.6134%), train_poison_data_count: 758
Global model norm: 111.94847883764433.
Norm before scaling: 111.92805568059109. Distance: 0.8032256245195915
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4945, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: 0.4105, Accuracy: 9937/9950 (99.8693%)
Scaling by  100
Scaled Norm after poisoning: 135.87678960412995, distance: 80.32256442288649
Total norm for 5 adversaries is: 135.87678960412995. distance: 80.32256442288649
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0747, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0460, Accuracy: 244/500 (48.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5358, Accuracy: 80/10000 (0.8000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.0812, Accuracy: 50/408 (12.2549%)
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0469, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.0310, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 307/803 (38.2316%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 402/803 (50.0623%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.3401, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0552, Accuracy: 440/1587 (27.7253%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0320, Accuracy: 632/1587 (39.8236%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9229, Accuracy: 63/10000 (0.6300%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.0749, Accuracy: 77/440 (17.5000%)
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0449, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.8189, Accuracy: 51/10000 (0.5100%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1285, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3254, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 269/636 (42.2956%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0284, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9006, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0537, Accuracy: 307/677 (45.3471%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.6894, Accuracy: 68/10000 (0.6800%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 495/1988 (24.8994%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 731/1988 (36.7706%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0780, Accuracy: 95/10000 (0.9500%)
time spent on training: 341.04073119163513
[rfa agg] training data poison_ratio: 0.49446716382006256  data num: [1190, 500, 408, 803, 1587, 440, 85, 636, 677, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3090419773875391
[rfa agg] init. name: [84, 82, 36, 58, 27, 49, 61, 52, 90, 85], weight: tensor([0.1431, 0.0601, 0.0491, 0.0966, 0.1909, 0.0529, 0.0102, 0.0765, 0.0814,
        0.2391])
[rfa agg] iter:  0, prev_obj_val: 20783.6875, obj_val: 13760.94140625, abs dis: 7022.74609375
[rfa agg] iter: 0, weight: tensor([0.0271, 0.0677, 0.0552, 0.1091, 0.2176, 0.0595, 0.0115, 0.0863, 0.0919,
        0.2741])
[rfa agg] iter:  1, prev_obj_val: 13760.94140625, obj_val: 12401.123046875, abs dis: 1359.818359375
[rfa agg] iter: 1, weight: tensor([0.0046, 0.0668, 0.0543, 0.1093, 0.2265, 0.0585, 0.0111, 0.0856, 0.0915,
        0.2919])
[rfa agg] iter:  2, prev_obj_val: 12401.123046875, obj_val: 12207.0634765625, abs dis: 194.0595703125
[rfa agg] iter: 2, weight: tensor([0.0007, 0.0516, 0.0413, 0.0916, 0.2422, 0.0446, 0.0079, 0.0682, 0.0741,
        0.3778])
[rfa agg] iter:  3, prev_obj_val: 12207.0634765625, obj_val: 12207.248046875, abs dis: 0.1845703125
[rfa agg] iter: 3, weight: tensor([6.9626e-05, 1.5390e-02, 1.1899e-02, 3.4204e-02, 6.9419e-01, 1.2831e-02,
        1.9630e-03, 2.2018e-02, 2.5002e-02, 1.8244e-01])
[rfa agg] iter:  4, prev_obj_val: 12207.248046875, obj_val: 12209.8193359375, abs dis: 2.5712890625
[rfa agg] iter: 4, weight: tensor([9.8247e-05, 2.6050e-02, 1.9933e-02, 6.2672e-02, 6.1266e-01, 2.1494e-02,
        3.1657e-03, 3.8211e-02, 4.4061e-02, 1.7166e-01])
[rfa agg] iter:  5, prev_obj_val: 12209.8193359375, obj_val: 12211.755859375, abs dis: 1.9365234375
[rfa agg] iter: 5, weight: tensor([1.3892e-04, 4.2501e-02, 3.2214e-02, 1.1070e-01, 4.3705e-01, 3.4736e-02,
        4.9484e-03, 6.3841e-02, 7.4746e-02, 1.9912e-01])
[rfa agg] iter:  6, prev_obj_val: 12211.755859375, obj_val: 12213.0546875, abs dis: 1.298828125
[rfa agg] iter: 6, weight: tensor([1.5098e-04, 5.2230e-02, 3.9225e-02, 1.4804e-01, 3.4548e-01, 4.2296e-02,
        5.8408e-03, 8.0351e-02, 9.5597e-02, 1.9078e-01])
[rfa agg] iter:  7, prev_obj_val: 12213.0546875, obj_val: 12215.013671875, abs dis: 1.958984375
[rfa agg] iter: 7, weight: tensor([1.5183e-04, 5.7530e-02, 4.2880e-02, 1.7585e-01, 2.9412e-01, 4.6238e-02,
        6.2305e-03, 9.0303e-02, 1.0895e-01, 1.7775e-01])
[rfa agg] iter:  8, prev_obj_val: 12215.013671875, obj_val: 12216.3232421875, abs dis: 1.3095703125
[rfa agg] iter: 8, weight: tensor([1.4287e-04, 6.3146e-02, 4.6401e-02, 2.2690e-01, 2.2514e-01, 5.0034e-02,
        6.4500e-03, 1.0311e-01, 1.2806e-01, 1.5062e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3148, Accuracy: 114/10000 (1.1400%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 4.7284, Accuracy: 227/9950 (2.2814%)
saving model
Done in 773.1622705459595 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0526, Accuracy: 462/1904 (24.2647%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0284, Accuracy: 819/1904 (43.0147%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1647, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0264, Accuracy: 461/776 (59.4072%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0995, Accuracy: 111/10000 (1.1100%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0483, Accuracy: 383/1130 (33.8938%)
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0262, Accuracy: 554/1130 (49.0265%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.6542, Accuracy: 71/10000 (0.7100%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0591, Accuracy: 207/781 (26.5045%)
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0321, Accuracy: 310/781 (39.6927%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6448, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0583, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0312, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1592, Accuracy: 60/10000 (0.6000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0592, Accuracy: 264/590 (44.7458%)
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0318, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.9722, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0569, Accuracy: 318/719 (44.2281%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0316, Accuracy: 442/719 (61.4743%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4586, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0446, Accuracy: 439/928 (47.3060%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0195, Accuracy: 660/928 (71.1207%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.3347, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0513, Accuracy: 464/1742 (26.6361%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0286, Accuracy: 800/1742 (45.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5251, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0556, Accuracy: 232/818 (28.3619%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0261, Accuracy: 433/818 (52.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.0753, Accuracy: 99/10000 (0.9900%)
time spent on training: 263.5796675682068
[rfa agg] training data poison_ratio: 0.24319330999611047  data num: [1904, 776, 1130, 781, 896, 590, 719, 928, 1742, 818]
[rfa agg] considering poison per batch poison_fraction: 0.15199581874756904
[rfa agg] init. name: [46, 75, 54, 3, 89, 69, 41, 1, 93, 71], weight: tensor([0.1851, 0.0755, 0.1099, 0.0759, 0.0871, 0.0574, 0.0699, 0.0902, 0.1694,
        0.0795])
[rfa agg] iter:  0, prev_obj_val: 58.46782302856445, obj_val: 58.428497314453125, abs dis: 0.039325714111328125
[rfa agg] iter: 0, weight: tensor([0.0511, 0.0793, 0.2444, 0.0798, 0.1255, 0.0328, 0.0574, 0.1911, 0.0549,
        0.0837])
[rfa agg] iter:  1, prev_obj_val: 58.428497314453125, obj_val: 71.65983581542969, abs dis: 13.231338500976562
[rfa agg] iter: 1, weight: tensor([0.0276, 0.1077, 0.0714, 0.1089, 0.2365, 0.0293, 0.0629, 0.2115, 0.0290,
        0.1152])
[rfa agg] iter:  2, prev_obj_val: 71.65983581542969, obj_val: 75.45834350585938, abs dis: 3.7985076904296875
[rfa agg] iter: 2, weight: tensor([0.0272, 0.1277, 0.0457, 0.1285, 0.0920, 0.0986, 0.2475, 0.0683, 0.0279,
        0.1365])
[rfa agg] iter:  3, prev_obj_val: 75.45834350585938, obj_val: 71.60775756835938, abs dis: 3.8505859375
[rfa agg] iter: 3, weight: tensor([0.0311, 0.1167, 0.0499, 0.1175, 0.0906, 0.1652, 0.2035, 0.0703, 0.0318,
        0.1233])
[rfa agg] iter:  4, prev_obj_val: 71.60775756835938, obj_val: 75.45939636230469, abs dis: 3.8516387939453125
[rfa agg] iter: 4, weight: tensor([0.0265, 0.1253, 0.0445, 0.1264, 0.0891, 0.0971, 0.2650, 0.0660, 0.0272,
        0.1330])
[rfa agg] iter:  5, prev_obj_val: 75.45939636230469, obj_val: 71.60768127441406, abs dis: 3.851715087890625
[rfa agg] iter: 5, weight: tensor([0.0311, 0.1166, 0.0499, 0.1174, 0.0905, 0.1649, 0.2042, 0.0703, 0.0318,
        0.1232])
[rfa agg] iter:  6, prev_obj_val: 71.60768127441406, obj_val: 75.45941162109375, abs dis: 3.8517303466796875
[rfa agg] iter: 6, weight: tensor([0.0265, 0.1253, 0.0445, 0.1264, 0.0891, 0.0971, 0.2651, 0.0660, 0.0272,
        0.1330])
[rfa agg] iter:  7, prev_obj_val: 75.45941162109375, obj_val: 71.60768127441406, abs dis: 3.8517303466796875
[rfa agg] iter: 7, weight: tensor([0.0311, 0.1166, 0.0499, 0.1174, 0.0905, 0.1649, 0.2042, 0.0703, 0.0318,
        0.1232])
[rfa agg] iter:  8, prev_obj_val: 71.60768127441406, obj_val: 75.45941162109375, abs dis: 3.8517303466796875
[rfa agg] iter: 8, weight: tensor([0.0265, 0.1253, 0.0445, 0.1264, 0.0891, 0.0971, 0.2651, 0.0660, 0.0272,
        0.1330])
[rfa agg] iter:  9, prev_obj_val: 75.45941162109375, obj_val: 71.60768127441406, abs dis: 3.8517303466796875
[rfa agg] iter: 9, weight: tensor([0.0311, 0.1166, 0.0499, 0.1174, 0.0905, 0.1649, 0.2042, 0.0703, 0.0318,
        0.1232])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3145, Accuracy: 113/10000 (1.1300%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.7532, Accuracy: 178/9950 (1.7889%)
saving model
Done in 695.5453493595123 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Avg loss: 0.0427, Accuracy: 1121/1988 (56.3883%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Avg loss: 0.0251, Accuracy: 1236/1988 (62.1730%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Avg loss: 0.0238, Accuracy: 1245/1988 (62.6258%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Avg loss: 0.0239, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Avg loss: 0.0235, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Avg loss: 0.0233, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Avg loss: 0.0228, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Avg loss: 0.0225, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Avg loss: 0.0226, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Avg loss: 0.0231, Accuracy: 1241/1988 (62.4245%), train_poison_data_count: 1244
Global model norm: 111.9460624516892.
Norm before scaling: 111.90845344800812. Distance: 1.0175833967368844
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0540, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: 0.3946, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 148.12566587403074, distance: 101.75834482826212
Total norm for 6 adversaries is: 148.12566587403074. distance: 101.75834482826212
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0545, Accuracy: 349/1154 (30.2426%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0255, Accuracy: 562/1154 (48.7002%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0555, Accuracy: 106/10000 (1.0600%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0600, Accuracy: 264/774 (34.1085%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0324, Accuracy: 351/774 (45.3488%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.2430, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0508, Accuracy: 283/813 (34.8093%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 505/813 (62.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.6668, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0487, Accuracy: 327/1013 (32.2804%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0232, Accuracy: 564/1013 (55.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2995, Accuracy: 84/10000 (0.8400%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0485, Accuracy: 387/1130 (34.2478%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0267, Accuracy: 524/1130 (46.3717%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6437, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0541, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 656/1581 (41.4927%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7882, Accuracy: 106/10000 (1.0600%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1205, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3200, Accuracy: 116/10000 (1.1600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0546, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0319, Accuracy: 594/1657 (35.8479%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1890, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0513, Accuracy: 376/1049 (35.8437%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0258, Accuracy: 578/1049 (55.1001%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.2498, Accuracy: 130/10000 (1.3000%)
time spent on training: 405.40681552886963
[rfa agg] training data poison_ratio: 0.6036997509782995  data num: [1988, 1154, 774, 813, 1013, 1130, 1581, 85, 1657, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.37731234436143724
[rfa agg] init. name: [85, 15, 81, 53, 39, 54, 28, 61, 0, 51], weight: tensor([0.1768, 0.1026, 0.0688, 0.0723, 0.0901, 0.1005, 0.1406, 0.0076, 0.1474,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 41591.19921875, obj_val: 29331.3125, abs dis: 12259.88671875
[rfa agg] iter: 0, weight: tensor([0.0440, 0.1192, 0.0798, 0.0838, 0.1045, 0.1166, 0.1636, 0.0087, 0.1715,
        0.1082])
[rfa agg] iter:  1, prev_obj_val: 29331.3125, obj_val: 26163.005859375, abs dis: 3168.306640625
[rfa agg] iter: 1, weight: tensor([0.0098, 0.1234, 0.0821, 0.0862, 0.1078, 0.1206, 0.1705, 0.0089, 0.1789,
        0.1118])
[rfa agg] iter:  2, prev_obj_val: 26163.005859375, obj_val: 25451.9296875, abs dis: 711.076171875
[rfa agg] iter: 2, weight: tensor([0.0021, 0.1239, 0.0800, 0.0841, 0.1067, 0.1206, 0.1767, 0.0082, 0.1864,
        0.1112])
[rfa agg] iter:  3, prev_obj_val: 25451.9296875, obj_val: 25308.5234375, abs dis: 143.40625
[rfa agg] iter: 3, weight: tensor([0.0004, 0.1198, 0.0675, 0.0709, 0.0960, 0.1137, 0.2027, 0.0057, 0.2211,
        0.1024])
[rfa agg] iter:  4, prev_obj_val: 25308.5234375, obj_val: 25305.771484375, abs dis: 2.751953125
[rfa agg] iter: 4, weight: tensor([2.9727e-05, 4.5418e-02, 1.5381e-02, 1.6162e-02, 2.6811e-02, 3.8360e-02,
        5.1159e-01, 8.8264e-04, 3.1428e-01, 3.1086e-02])
[rfa agg] iter:  5, prev_obj_val: 25305.771484375, obj_val: 25304.587890625, abs dis: 1.18359375
[rfa agg] iter: 5, weight: tensor([5.8791e-05, 1.7126e-01, 4.0454e-02, 4.2538e-02, 7.9052e-02, 1.3033e-01,
        2.4537e-01, 2.0072e-03, 1.9208e-01, 9.6857e-02])
[rfa agg] iter:  6, prev_obj_val: 25304.587890625, obj_val: 25309.04296875, abs dis: 4.455078125
[rfa agg] iter: 6, weight: tensor([3.7775e-05, 3.5057e-01, 3.5931e-02, 3.7794e-02, 8.6156e-02, 2.0630e-01,
        8.6582e-02, 1.4744e-03, 7.6813e-02, 1.1834e-01])
[rfa agg] iter:  7, prev_obj_val: 25309.04296875, obj_val: 25310.947265625, abs dis: 1.904296875
[rfa agg] iter: 7, weight: tensor([3.0404e-05, 1.3383e-01, 4.6494e-02, 4.8981e-02, 1.9782e-01, 2.2944e-01,
        4.8024e-02, 1.3845e-03, 4.4760e-02, 2.4924e-01])
[rfa agg] iter:  8, prev_obj_val: 25310.947265625, obj_val: 25316.12109375, abs dis: 5.173828125
[rfa agg] iter: 8, weight: tensor([2.9115e-05, 1.0148e-01, 5.0675e-02, 5.3357e-02, 2.9601e-01, 1.6133e-01,
        4.3318e-02, 1.3716e-03, 4.0632e-02, 2.5179e-01])
[rfa agg] iter:  9, prev_obj_val: 25316.12109375, obj_val: 25313.298828125, abs dis: 2.822265625
[rfa agg] iter: 9, weight: tensor([3.3885e-05, 8.6634e-02, 8.0999e-02, 8.5375e-02, 3.7199e-01, 1.1826e-01,
        4.5156e-02, 1.7144e-03, 4.2822e-02, 1.6702e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3154, Accuracy: 113/10000 (1.1300%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 4.7878, Accuracy: 134/9950 (1.3467%)
saving model
Done in 822.7558000087738 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 301/715 (42.0979%)
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0350, Accuracy: 443/715 (61.9580%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.6598, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 531/1552 (34.2139%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0192, Accuracy: 853/1552 (54.9613%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.1708, Accuracy: 88/10000 (0.8800%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0561, Accuracy: 352/1241 (28.3642%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0340, Accuracy: 483/1241 (38.9202%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7333, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0530, Accuracy: 370/1131 (32.7144%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0267, Accuracy: 551/1131 (48.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1873, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1099, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0899, Accuracy: 35/197 (17.7665%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.4338, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0560, Accuracy: 462/1750 (26.4000%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0328, Accuracy: 766/1750 (43.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6858, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0536, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0316, Accuracy: 659/1581 (41.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9779, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0498, Accuracy: 349/1340 (26.0448%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0241, Accuracy: 646/1340 (48.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.3170, Accuracy: 98/10000 (0.9800%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0517, Accuracy: 335/1071 (31.2792%)
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0273, Accuracy: 562/1071 (52.4743%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.8785, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0541, Accuracy: 470/1418 (33.1453%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0281, Accuracy: 723/1418 (50.9873%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1049, Accuracy: 119/10000 (1.1900%)
time spent on training: 304.85795283317566
[rfa agg] training data poison_ratio: 0.4679893297765922  data num: [715, 1552, 1241, 1131, 197, 1750, 1581, 1340, 1071, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.2924933311103701
[rfa agg] init. name: [23, 74, 72, 38, 79, 44, 28, 77, 55, 70], weight: tensor([0.0596, 0.1294, 0.1035, 0.0943, 0.0164, 0.1459, 0.1318, 0.1117, 0.0893,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 38.45247268676758, obj_val: 42.21599197387695, abs dis: 3.763519287109375
[rfa agg] iter: 0, weight: tensor([0.0176, 0.0608, 0.3402, 0.1057, 0.0024, 0.0431, 0.0618, 0.2094, 0.0686,
        0.0904])
[rfa agg] iter:  1, prev_obj_val: 42.21599197387695, obj_val: 46.79670715332031, abs dis: 4.580715179443359
[rfa agg] iter: 1, weight: tensor([0.0236, 0.0595, 0.2559, 0.2094, 0.0031, 0.0449, 0.0606, 0.1476, 0.1148,
        0.0806])
[rfa agg] iter:  2, prev_obj_val: 46.79670715332031, obj_val: 49.50633239746094, abs dis: 2.709625244140625
[rfa agg] iter: 2, weight: tensor([0.0253, 0.0470, 0.1268, 0.3778, 0.0030, 0.0372, 0.0478, 0.0926, 0.1827,
        0.0597])
[rfa agg] iter:  3, prev_obj_val: 49.50633239746094, obj_val: 52.62103271484375, abs dis: 3.1147003173828125
[rfa agg] iter: 3, weight: tensor([0.0271, 0.0432, 0.0998, 0.3456, 0.0031, 0.0349, 0.0440, 0.0783, 0.2706,
        0.0535])
[rfa agg] iter:  4, prev_obj_val: 52.62103271484375, obj_val: 52.58859634399414, abs dis: 0.032436370849609375
[rfa agg] iter: 4, weight: tensor([0.0316, 0.0429, 0.0890, 0.2260, 0.0034, 0.0353, 0.0437, 0.0729, 0.4032,
        0.0520])
[rfa agg] iter:  5, prev_obj_val: 52.58859634399414, obj_val: 56.07321548461914, abs dis: 3.484619140625
[rfa agg] iter: 5, weight: tensor([0.0292, 0.0397, 0.0822, 0.2008, 0.0031, 0.0326, 0.0404, 0.0673, 0.4567,
        0.0481])
[rfa agg] iter:  6, prev_obj_val: 56.07321548461914, obj_val: 52.58791732788086, abs dis: 3.4852981567382812
[rfa agg] iter: 6, weight: tensor([0.0408, 0.0472, 0.0896, 0.1813, 0.0041, 0.0394, 0.0480, 0.0758, 0.4178,
        0.0561])
[rfa agg] iter:  7, prev_obj_val: 52.58791732788086, obj_val: 56.07366180419922, abs dis: 3.4857444763183594
[rfa agg] iter: 7, weight: tensor([0.0289, 0.0394, 0.0815, 0.1965, 0.0031, 0.0323, 0.0401, 0.0668, 0.4638,
        0.0477])
[rfa agg] iter:  8, prev_obj_val: 56.07366180419922, obj_val: 52.58776092529297, abs dis: 3.48590087890625
[rfa agg] iter: 8, weight: tensor([0.0407, 0.0471, 0.0894, 0.1808, 0.0041, 0.0393, 0.0479, 0.0756, 0.4193,
        0.0559])
[rfa agg] iter:  9, prev_obj_val: 52.58776092529297, obj_val: 56.073726654052734, abs dis: 3.4859657287597656
[rfa agg] iter: 9, weight: tensor([0.0289, 0.0393, 0.0814, 0.1962, 0.0031, 0.0323, 0.0400, 0.0667, 0.4644,
        0.0476])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3125, Accuracy: 127/10000 (1.2700%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 4.8182, Accuracy: 128/9950 (1.2864%)
saving model
Done in 739.6530904769897 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 276/599 (46.0768%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Avg loss: 0.0244, Accuracy: 334/599 (55.7596%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Avg loss: 0.0217, Accuracy: 244/599 (40.7346%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Avg loss: 0.0224, Accuracy: 372/599 (62.1035%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Avg loss: 0.0201, Accuracy: 383/599 (63.9399%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Avg loss: 0.0191, Accuracy: 384/599 (64.1068%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Avg loss: 0.0187, Accuracy: 382/599 (63.7730%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Avg loss: 0.0190, Accuracy: 381/599 (63.6060%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Avg loss: 0.0207, Accuracy: 379/599 (63.2721%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Avg loss: 0.0168, Accuracy: 382/599 (63.7730%), train_poison_data_count: 383
Global model norm: 111.94315312358322.
Norm before scaling: 111.93537564287932. Distance: 0.7507132476591022
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.3670, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: 0.3535, Accuracy: 9886/9950 (99.3568%)
Scaling by  100
Scaled Norm after poisoning: 133.9275690438679, distance: 75.07132350825613
Total norm for 7 adversaries is: 133.9275690438679. distance: 75.07132350825613
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0811, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0431, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.3374, Accuracy: 58/10000 (0.5800%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 704/2227 (31.6120%)
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0263, Accuracy: 1070/2227 (48.0467%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4751, Accuracy: 140/10000 (1.4000%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0684, Accuracy: 147/631 (23.2964%)
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0381, Accuracy: 295/631 (46.7512%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5080, Accuracy: 86/10000 (0.8600%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0687, Accuracy: 163/530 (30.7547%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0351, Accuracy: 293/530 (55.2830%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8682, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0471, Accuracy: 347/861 (40.3020%)
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0178, Accuracy: 514/861 (59.6980%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.2393, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0533, Accuracy: 307/677 (45.3471%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.3177, Accuracy: 69/10000 (0.6900%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0787, Accuracy: 67/416 (16.1058%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0400, Accuracy: 223/416 (53.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4382, Accuracy: 68/10000 (0.6800%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0517, Accuracy: 385/1154 (33.3622%)
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0244, Accuracy: 612/1154 (53.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.5896, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0579, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0314, Accuracy: 468/896 (52.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1224, Accuracy: 63/10000 (0.6300%)
time spent on training: 368.35989928245544
[rfa agg] training data poison_ratio: 0.7588979543573371  data num: [599, 466, 2227, 631, 530, 861, 677, 416, 1154, 896]
[rfa agg] considering poison per batch poison_fraction: 0.4743112214733357
[rfa agg] init. name: [95, 76, 60, 48, 18, 10, 90, 78, 15, 89], weight: tensor([0.0708, 0.0551, 0.2633, 0.0746, 0.0627, 0.1018, 0.0801, 0.0492, 0.1365,
        0.1059])
[rfa agg] iter:  0, prev_obj_val: 5842.841796875, obj_val: 3359.09375, abs dis: 2483.748046875
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0571, 0.2950, 0.0778, 0.0651, 0.1073, 0.0837, 0.0508, 0.1459,
        0.1117])
[rfa agg] iter:  1, prev_obj_val: 3359.09375, obj_val: 3247.435302734375, abs dis: 111.658447265625
[rfa agg] iter: 1, weight: tensor([3.1324e-04, 3.2195e-02, 5.4773e-01, 4.6050e-02, 3.7618e-02, 7.0803e-02,
        5.0840e-02, 2.7993e-02, 1.1277e-01, 7.3682e-02])
[rfa agg] iter:  2, prev_obj_val: 3247.435302734375, obj_val: 3231.24267578125, abs dis: 16.192626953125
[rfa agg] iter: 2, weight: tensor([1.5733e-04, 3.6881e-02, 2.7689e-01, 5.6808e-02, 4.4635e-02, 1.0681e-01,
        6.5459e-02, 3.1040e-02, 2.7013e-01, 1.1119e-01])
[rfa agg] iter:  3, prev_obj_val: 3231.24267578125, obj_val: 3229.6171875, abs dis: 1.62548828125
[rfa agg] iter: 3, weight: tensor([5.5355e-05, 2.0405e-02, 6.2066e-02, 3.4112e-02, 2.5636e-02, 8.6972e-02,
        4.1466e-02, 1.6635e-02, 6.2202e-01, 9.0632e-02])
[rfa agg] iter:  4, prev_obj_val: 3229.6171875, obj_val: 3231.932373046875, abs dis: 2.315185546875
[rfa agg] iter: 4, weight: tensor([6.2314e-05, 3.2076e-02, 5.9126e-02, 5.9121e-02, 4.2050e-02, 2.6012e-01,
        7.7294e-02, 2.5314e-02, 1.7022e-01, 2.7462e-01])
[rfa agg] iter:  5, prev_obj_val: 3231.932373046875, obj_val: 3238.451416015625, abs dis: 6.51904296875
[rfa agg] iter: 5, weight: tensor([4.5335e-05, 3.5004e-02, 3.8170e-02, 7.8394e-02, 4.9613e-02, 2.8037e-01,
        1.2490e-01, 2.6084e-02, 7.2070e-02, 2.9535e-01])
[rfa agg] iter:  6, prev_obj_val: 3238.451416015625, obj_val: 3243.037841796875, abs dis: 4.58642578125
[rfa agg] iter: 6, weight: tensor([3.3883e-05, 4.3283e-02, 2.6165e-02, 1.6066e-01, 7.2606e-02, 7.9634e-02,
        4.6504e-01, 2.9129e-02, 4.0506e-02, 8.2937e-02])
[rfa agg] iter:  7, prev_obj_val: 3243.037841796875, obj_val: 3252.344482421875, abs dis: 9.306640625
[rfa agg] iter: 7, weight: tensor([3.2995e-05, 6.2477e-02, 2.4467e-02, 4.0727e-01, 1.3270e-01, 5.8431e-02,
        1.8112e-01, 3.7631e-02, 3.5107e-02, 6.0760e-02])
[rfa agg] iter:  8, prev_obj_val: 3252.344482421875, obj_val: 3259.85107421875, abs dis: 7.506591796875
[rfa agg] iter: 8, weight: tensor([4.0567e-05, 2.3025e-01, 2.8390e-02, 1.3984e-01, 2.7702e-01, 5.2545e-02,
        9.0483e-02, 8.9709e-02, 3.7049e-02, 5.4672e-02])
[rfa agg] iter:  9, prev_obj_val: 3259.85107421875, obj_val: 3255.929443359375, abs dis: 3.921630859375
[rfa agg] iter: 9, weight: tensor([4.6041e-05, 2.8609e-01, 3.1057e-02, 9.5662e-02, 1.3212e-01, 5.0595e-02,
        7.3777e-02, 2.3962e-01, 3.8413e-02, 5.2617e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3093, Accuracy: 132/10000 (1.3200%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.8208, Accuracy: 139/9950 (1.3970%)
saving model
Done in 788.4594550132751 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1189, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3144, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0531, Accuracy: 438/1581 (27.7040%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 684/1581 (43.2638%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9873, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0911, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0552, Accuracy: 133/271 (49.0775%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.3715, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0608, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 430/776 (55.4124%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.4430, Accuracy: 109/10000 (1.0900%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 557/1552 (35.8892%)
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0193, Accuracy: 874/1552 (56.3144%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 11.8762, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0513, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0200, Accuracy: 477/677 (70.4579%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.7060, Accuracy: 68/10000 (0.6800%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0483, Accuracy: 365/1071 (34.0803%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0267, Accuracy: 563/1071 (52.5677%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.6358, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0644, Accuracy: 156/682 (22.8739%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0345, Accuracy: 280/682 (41.0557%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3345, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 295/715 (41.2587%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0345, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2122, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0692, Accuracy: 161/603 (26.6998%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0421, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5758, Accuracy: 53/10000 (0.5300%)
time spent on training: 246.6435363292694
[rfa agg] training data poison_ratio: 0.33795082990141023  data num: [85, 1581, 271, 776, 1552, 677, 1071, 682, 715, 603]
[rfa agg] considering poison per batch poison_fraction: 0.2112192686883814
[rfa agg] init. name: [61, 28, 35, 75, 74, 90, 55, 80, 23, 88], weight: tensor([0.0106, 0.1973, 0.0338, 0.0968, 0.1937, 0.0845, 0.1337, 0.0851, 0.0892,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 55.87794876098633, obj_val: 56.955345153808594, abs dis: 1.0773963928222656
[rfa agg] iter: 0, weight: tensor([0.0034, 0.0745, 0.0141, 0.2377, 0.0732, 0.0947, 0.2043, 0.0957, 0.1363,
        0.0661])
[rfa agg] iter:  1, prev_obj_val: 56.955345153808594, obj_val: 59.222084045410156, abs dis: 2.2667388916015625
[rfa agg] iter: 1, weight: tensor([0.0022, 0.0372, 0.0096, 0.4270, 0.0366, 0.0925, 0.0748, 0.0943, 0.1695,
        0.0564])
[rfa agg] iter:  2, prev_obj_val: 59.222084045410156, obj_val: 69.49185180664062, abs dis: 10.269767761230469
[rfa agg] iter: 2, weight: tensor([0.0022, 0.0315, 0.0100, 0.1889, 0.0310, 0.1532, 0.0550, 0.1613, 0.2904,
        0.0765])
[rfa agg] iter:  3, prev_obj_val: 69.49185180664062, obj_val: 73.27035522460938, abs dis: 3.77850341796875
[rfa agg] iter: 3, weight: tensor([0.0028, 0.0281, 0.0144, 0.0680, 0.0276, 0.1612, 0.0406, 0.1678, 0.0923,
        0.3973])
[rfa agg] iter:  4, prev_obj_val: 73.27035522460938, obj_val: 73.2697982788086, abs dis: 0.00055694580078125
[rfa agg] iter: 4, weight: tensor([0.0040, 0.0355, 0.0210, 0.0763, 0.0349, 0.1503, 0.0495, 0.1540, 0.0965,
        0.3781])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3087, Accuracy: 121/10000 (1.2100%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 4.8413, Accuracy: 118/9950 (1.1859%)
saving model
Done in 663.9994678497314 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.0772, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0448, Accuracy: 157/408 (38.4804%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2029, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.4318, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 293/690 (42.4638%)
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0232, Accuracy: 470/690 (68.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.4725, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0505, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0210, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.6027, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0761, Accuracy: 86/460 (18.6957%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0347, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2648, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0529, Accuracy: 494/1418 (34.8378%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0292, Accuracy: 684/1418 (48.2370%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0448, Accuracy: 121/10000 (1.2100%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0726, Accuracy: 111/486 (22.8395%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0360, Accuracy: 222/486 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4818, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0521, Accuracy: 430/1949 (22.0626%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0311, Accuracy: 700/1949 (35.9159%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5295, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0529, Accuracy: 447/1904 (23.4769%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0285, Accuracy: 797/1904 (41.8592%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.1476, Accuracy: 162/10000 (1.6200%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0592, Accuracy: 212/953 (22.2455%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0352, Accuracy: 344/953 (36.0965%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7202, Accuracy: 78/10000 (0.7800%)
time spent on training: 257.21083188056946
[rfa agg] training data poison_ratio: 0.17347497535866827  data num: [408, 186, 690, 677, 460, 1418, 486, 1949, 1904, 953]
[rfa agg] considering poison per batch poison_fraction: 0.10842185959916767
[rfa agg] init. name: [36, 56, 25, 90, 31, 70, 30, 21, 46, 64], weight: tensor([0.0447, 0.0204, 0.0756, 0.0741, 0.0504, 0.1553, 0.0532, 0.2134, 0.2085,
        0.1044])
[rfa agg] iter:  0, prev_obj_val: 82.35305786132812, obj_val: 84.41395568847656, abs dis: 2.0608978271484375
[rfa agg] iter: 0, weight: tensor([0.0291, 0.0099, 0.0754, 0.0740, 0.0359, 0.2543, 0.0380, 0.1277, 0.1356,
        0.2201])
[rfa agg] iter:  1, prev_obj_val: 84.41395568847656, obj_val: 86.58202362060547, abs dis: 2.1680679321289062
[rfa agg] iter: 1, weight: tensor([0.0299, 0.0097, 0.0840, 0.0824, 0.0374, 0.1720, 0.0395, 0.1018, 0.1072,
        0.3360])
[rfa agg] iter:  2, prev_obj_val: 86.58202362060547, obj_val: 90.43943786621094, abs dis: 3.8574142456054688
[rfa agg] iter: 2, weight: tensor([0.0206, 0.0064, 0.0654, 0.0642, 0.0263, 0.0806, 0.0278, 0.0538, 0.0562,
        0.5987])
[rfa agg] iter:  3, prev_obj_val: 90.43943786621094, obj_val: 93.67103576660156, abs dis: 3.231597900390625
[rfa agg] iter: 3, weight: tensor([0.0292, 0.0085, 0.1134, 0.1117, 0.0384, 0.0787, 0.0406, 0.0575, 0.0597,
        0.4623])
[rfa agg] iter:  4, prev_obj_val: 93.67103576660156, obj_val: 96.93773651123047, abs dis: 3.2667007446289062
[rfa agg] iter: 4, weight: tensor([0.0384, 0.0105, 0.1886, 0.1864, 0.0518, 0.0798, 0.0547, 0.0611, 0.0632,
        0.2654])
[rfa agg] iter:  5, prev_obj_val: 96.93773651123047, obj_val: 100.56053161621094, abs dis: 3.6227951049804688
[rfa agg] iter: 5, weight: tensor([0.0362, 0.0092, 0.2805, 0.2802, 0.0508, 0.0571, 0.0538, 0.0456, 0.0470,
        0.1396])
[rfa agg] iter:  6, prev_obj_val: 100.56053161621094, obj_val: 103.19020080566406, abs dis: 2.629669189453125
[rfa agg] iter: 6, weight: tensor([0.0212, 0.0049, 0.3786, 0.4149, 0.0317, 0.0246, 0.0336, 0.0203, 0.0209,
        0.0493])
[rfa agg] iter:  7, prev_obj_val: 103.19020080566406, obj_val: 112.0108871459961, abs dis: 8.820686340332031
[rfa agg] iter: 7, weight: tensor([0.0348, 0.0074, 0.3421, 0.3491, 0.0544, 0.0340, 0.0575, 0.0285, 0.0293,
        0.0630])
[rfa agg] iter:  8, prev_obj_val: 112.0108871459961, obj_val: 103.22093963623047, abs dis: 8.789947509765625
[rfa agg] iter: 8, weight: tensor([0.0903, 0.0140, 0.1533, 0.1509, 0.1902, 0.0456, 0.2036, 0.0399, 0.0409,
        0.0713])
[rfa agg] iter:  9, prev_obj_val: 103.22093963623047, obj_val: 112.00867462158203, abs dis: 8.787734985351562
[rfa agg] iter: 9, weight: tensor([0.0368, 0.0079, 0.3278, 0.3452, 0.0577, 0.0359, 0.0612, 0.0301, 0.0309,
        0.0666])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3066, Accuracy: 115/10000 (1.1500%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.8355, Accuracy: 135/9950 (1.3568%)
saving model
Done in 674.817973613739 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0534, Accuracy: 450/1662 (27.0758%)
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0299, Accuracy: 724/1662 (43.5620%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1720, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0579, Accuracy: 225/809 (27.8121%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0234, Accuracy: 402/809 (49.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9138, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0643, Accuracy: 199/605 (32.8926%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.0818, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 286/813 (35.1784%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 502/813 (61.7466%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.7003, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0579, Accuracy: 336/1003 (33.4995%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0312, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6685, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.0748, Accuracy: 75/426 (17.6056%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0388, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3391, Accuracy: 61/10000 (0.6100%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0432, Accuracy: 161/338 (47.6331%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.0081, Accuracy: 56/10000 (0.5600%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0581, Accuracy: 272/590 (46.1017%)
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0332, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.4437, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0805, Accuracy: 29/312 (9.2949%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 194/312 (62.1795%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.0849, Accuracy: 61/10000 (0.6100%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0574, Accuracy: 256/774 (33.0749%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0331, Accuracy: 360/774 (46.5116%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.7804, Accuracy: 84/10000 (0.8400%)
time spent on training: 245.0683557987213
[rfa agg] training data poison_ratio: 0.2746863066012002  data num: [1662, 809, 605, 813, 1003, 426, 338, 590, 312, 774]
[rfa agg] considering poison per batch poison_fraction: 0.17167894162575012
[rfa agg] init. name: [94, 50, 2, 53, 86, 67, 12, 69, 24, 81], weight: tensor([0.2267, 0.1103, 0.0825, 0.1109, 0.1368, 0.0581, 0.0461, 0.0805, 0.0426,
        0.1056])
[rfa agg] iter:  0, prev_obj_val: 49.09300994873047, obj_val: 54.580501556396484, abs dis: 5.487491607666016
[rfa agg] iter: 0, weight: tensor([0.0411, 0.1807, 0.1375, 0.1830, 0.0792, 0.0339, 0.0220, 0.1340, 0.0172,
        0.1714])
[rfa agg] iter:  1, prev_obj_val: 54.580501556396484, obj_val: 63.446048736572266, abs dis: 8.865547180175781
[rfa agg] iter: 1, weight: tensor([0.0264, 0.0675, 0.3199, 0.0680, 0.0423, 0.0359, 0.0214, 0.3382, 0.0159,
        0.0645])
[rfa agg] iter:  2, prev_obj_val: 63.446048736572266, obj_val: 63.432621002197266, abs dis: 0.013427734375
[rfa agg] iter: 2, weight: tensor([0.0469, 0.0879, 0.1927, 0.0886, 0.0658, 0.1354, 0.0662, 0.1887, 0.0438,
        0.0841])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3042, Accuracy: 117/10000 (1.1700%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 4.8562, Accuracy: 130/9950 (1.3065%)
saving model
Done in 680.5151278972626 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0462, Accuracy: 367/1013 (36.2290%)
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0229, Accuracy: 571/1013 (56.3672%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.8401, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0621, Accuracy: 170/682 (24.9267%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0345, Accuracy: 275/682 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4278, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0470, Accuracy: 348/677 (51.4032%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0208, Accuracy: 432/677 (63.8109%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.3586, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 458/1953 (23.4511%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0311, Accuracy: 889/1953 (45.5197%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9387, Accuracy: 150/10000 (1.5000%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0582, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0318, Accuracy: 361/946 (38.1607%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5913, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0502, Accuracy: 347/1154 (30.0693%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 522/1154 (45.2340%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.9886, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0736, Accuracy: 73/426 (17.1362%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0373, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4013, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0649, Accuracy: 209/605 (34.5455%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0365, Accuracy: 332/605 (54.8760%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.9763, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 301/715 (42.0979%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0343, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.3594, Accuracy: 78/10000 (0.7800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.0776, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0461, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2417, Accuracy: 63/10000 (0.6300%)
time spent on training: 240.94495296478271
[rfa agg] training data poison_ratio: 0.04755799044177643  data num: [1013, 682, 677, 1953, 946, 1154, 426, 605, 715, 408]
[rfa agg] considering poison per batch poison_fraction: 0.02972374402611027
[rfa agg] init. name: [39, 80, 90, 83, 43, 57, 67, 2, 23, 36], weight: tensor([0.1181, 0.0795, 0.0789, 0.2276, 0.1103, 0.1345, 0.0497, 0.0705, 0.0833,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 57.664554595947266, obj_val: 59.464515686035156, abs dis: 1.7999610900878906
[rfa agg] iter: 0, weight: tensor([0.2364, 0.0483, 0.0480, 0.0349, 0.4215, 0.0802, 0.0152, 0.0344, 0.0665,
        0.0146])
[rfa agg] iter:  1, prev_obj_val: 59.464515686035156, obj_val: 61.139976501464844, abs dis: 1.6754608154296875
[rfa agg] iter: 1, weight: tensor([0.1520, 0.1033, 0.1028, 0.0432, 0.2347, 0.0800, 0.0254, 0.0664, 0.1679,
        0.0243])
[rfa agg] iter:  2, prev_obj_val: 61.139976501464844, obj_val: 63.599876403808594, abs dis: 2.45989990234375
[rfa agg] iter: 2, weight: tensor([0.0914, 0.1388, 0.1387, 0.0338, 0.1187, 0.0564, 0.0248, 0.0765, 0.2971,
        0.0238])
[rfa agg] iter:  3, prev_obj_val: 63.599876403808594, obj_val: 71.06002044677734, abs dis: 7.46014404296875
[rfa agg] iter: 3, weight: tensor([0.0514, 0.2284, 0.2324, 0.0231, 0.0614, 0.0352, 0.0217, 0.0892, 0.2363,
        0.0208])
[rfa agg] iter:  4, prev_obj_val: 71.06002044677734, obj_val: 74.40354919433594, abs dis: 3.3435287475585938
[rfa agg] iter: 4, weight: tensor([0.0436, 0.1637, 0.1636, 0.0241, 0.0488, 0.0331, 0.0365, 0.3617, 0.0898,
        0.0350])
[rfa agg] iter:  5, prev_obj_val: 74.40354919433594, obj_val: 77.9448471069336, abs dis: 3.5412979125976562
[rfa agg] iter: 5, weight: tensor([0.0507, 0.1427, 0.1421, 0.0297, 0.0559, 0.0395, 0.0551, 0.3408, 0.0908,
        0.0528])
[rfa agg] iter:  6, prev_obj_val: 77.9448471069336, obj_val: 74.40557098388672, abs dis: 3.539276123046875
[rfa agg] iter: 6, weight: tensor([0.0602, 0.1391, 0.1384, 0.0371, 0.0656, 0.0480, 0.0876, 0.2424, 0.0976,
        0.0840])
[rfa agg] iter:  7, prev_obj_val: 74.40557098388672, obj_val: 77.94448852539062, abs dis: 3.5389175415039062
[rfa agg] iter: 7, weight: tensor([0.0513, 0.1443, 0.1440, 0.0301, 0.0566, 0.0400, 0.0559, 0.3322, 0.0920,
        0.0536])
[rfa agg] iter:  8, prev_obj_val: 77.94448852539062, obj_val: 74.40557861328125, abs dis: 3.538909912109375
[rfa agg] iter: 8, weight: tensor([0.0602, 0.1392, 0.1385, 0.0371, 0.0656, 0.0480, 0.0876, 0.2422, 0.0976,
        0.0840])
[rfa agg] iter:  9, prev_obj_val: 74.40557861328125, obj_val: 77.94449615478516, abs dis: 3.5389175415039062
[rfa agg] iter: 9, weight: tensor([0.0513, 0.1443, 0.1440, 0.0301, 0.0566, 0.0400, 0.0559, 0.3321, 0.0920,
        0.0536])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3047, Accuracy: 124/10000 (1.2400%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 4.8783, Accuracy: 121/9950 (1.2161%)
saving model
Done in 668.5321338176727 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0590, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1045, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0520, Accuracy: 369/1372 (26.8950%)
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0289, Accuracy: 604/1372 (44.0233%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6333, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0520, Accuracy: 464/1581 (29.3485%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0312, Accuracy: 694/1581 (43.8963%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.9532, Accuracy: 106/10000 (1.0600%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0422, Accuracy: 594/1552 (38.2732%)
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0190, Accuracy: 823/1552 (53.0284%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.1769, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0531, Accuracy: 398/1645 (24.1945%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0297, Accuracy: 700/1645 (42.5532%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2204, Accuracy: 137/10000 (1.3700%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.0759, Accuracy: 67/440 (15.2273%)
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0444, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.6945, Accuracy: 52/10000 (0.5200%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0805, Accuracy: 22/312 (7.0513%)
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0398, Accuracy: 194/312 (62.1795%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8594, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0547, Accuracy: 407/1427 (28.5214%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0308, Accuracy: 647/1427 (45.3399%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4726, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0541, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0296, Accuracy: 430/1131 (38.0195%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4678, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0571, Accuracy: 346/1003 (34.4965%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0318, Accuracy: 412/1003 (41.0768%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7680, Accuracy: 59/10000 (0.5900%)
time spent on training: 305.31089425086975
[rfa agg] training data poison_ratio: 0.3234776487152411  data num: [901, 1372, 1581, 1552, 1645, 440, 312, 1427, 1131, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.20217353044702568
[rfa agg] init. name: [4, 42, 28, 74, 13, 49, 24, 34, 87, 86], weight: tensor([0.0793, 0.1207, 0.1391, 0.1366, 0.1448, 0.0387, 0.0275, 0.1256, 0.0995,
        0.0883])
[rfa agg] iter:  0, prev_obj_val: 49.36131286621094, obj_val: 53.72018814086914, abs dis: 4.358875274658203
[rfa agg] iter: 0, weight: tensor([0.0782, 0.0906, 0.0602, 0.0592, 0.0549, 0.0107, 0.0064, 0.0756, 0.4353,
        0.1288])
[rfa agg] iter:  1, prev_obj_val: 53.72018814086914, obj_val: 58.753204345703125, abs dis: 5.033016204833984
[rfa agg] iter: 1, weight: tensor([0.1210, 0.0788, 0.0570, 0.0561, 0.0529, 0.0128, 0.0076, 0.0685, 0.3004,
        0.2450])
[rfa agg] iter:  2, prev_obj_val: 58.753204345703125, obj_val: 56.100379943847656, abs dis: 2.6528244018554688
[rfa agg] iter: 2, weight: tensor([0.1728, 0.0546, 0.0421, 0.0414, 0.0395, 0.0118, 0.0068, 0.0488, 0.1311,
        0.4511])
[rfa agg] iter:  3, prev_obj_val: 56.100379943847656, obj_val: 56.0958137512207, abs dis: 0.004566192626953125
[rfa agg] iter: 3, weight: tensor([0.1394, 0.0634, 0.0474, 0.0467, 0.0442, 0.0119, 0.0070, 0.0558, 0.1737,
        0.4105])
[rfa agg] iter:  4, prev_obj_val: 56.0958137512207, obj_val: 58.685176849365234, abs dis: 2.5893630981445312
[rfa agg] iter: 4, weight: tensor([0.1398, 0.0640, 0.0479, 0.0471, 0.0447, 0.0120, 0.0070, 0.0564, 0.1775,
        0.4035])
[rfa agg] iter:  5, prev_obj_val: 58.685176849365234, obj_val: 65.06157684326172, abs dis: 6.376399993896484
[rfa agg] iter: 5, weight: tensor([0.1541, 0.0481, 0.0370, 0.0364, 0.0347, 0.0104, 0.0060, 0.0429, 0.1135,
        0.5169])
[rfa agg] iter:  6, prev_obj_val: 65.06157684326172, obj_val: 61.70108413696289, abs dis: 3.360492706298828
[rfa agg] iter: 6, weight: tensor([0.3545, 0.0562, 0.0454, 0.0447, 0.0430, 0.0159, 0.0090, 0.0511, 0.1055,
        0.2747])
[rfa agg] iter:  7, prev_obj_val: 61.70108413696289, obj_val: 56.12675857543945, abs dis: 5.5743255615234375
[rfa agg] iter: 7, weight: tensor([0.3051, 0.0523, 0.0414, 0.0407, 0.0390, 0.0129, 0.0074, 0.0472, 0.1080,
        0.3461])
[rfa agg] iter:  8, prev_obj_val: 56.12675857543945, obj_val: 58.687599182128906, abs dis: 2.560840606689453
[rfa agg] iter: 8, weight: tensor([0.1483, 0.0655, 0.0490, 0.0482, 0.0457, 0.0123, 0.0072, 0.0576, 0.1781,
        0.3882])
[rfa agg] iter:  9, prev_obj_val: 58.687599182128906, obj_val: 65.05929565429688, abs dis: 6.371696472167969
[rfa agg] iter: 9, weight: tensor([0.1566, 0.0487, 0.0375, 0.0369, 0.0352, 0.0105, 0.0061, 0.0434, 0.1149,
        0.5104])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3044, Accuracy: 115/10000 (1.1500%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 4.9086, Accuracy: 92/9950 (0.9246%)
saving model
Done in 723.5893933773041 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0564, Accuracy: 335/1190 (28.1513%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0287, Accuracy: 533/1190 (44.7899%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0884, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0583, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0311, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1382, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0474, Accuracy: 457/1440 (31.7361%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0252, Accuracy: 761/1440 (52.8472%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.1240, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0549, Accuracy: 274/636 (43.0818%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0270, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4809, Accuracy: 64/10000 (0.6400%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0454, Accuracy: 546/1129 (48.3614%)
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0202, Accuracy: 781/1129 (69.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6464, Accuracy: 114/10000 (1.1400%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0725, Accuracy: 112/486 (23.0453%)
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0359, Accuracy: 225/486 (46.2963%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7155, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0567, Accuracy: 322/1402 (22.9672%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0357, Accuracy: 468/1402 (33.3809%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8009, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0707, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0385, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2042, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0674, Accuracy: 174/603 (28.8557%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0417, Accuracy: 276/603 (45.7711%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6896, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0523, Accuracy: 396/1372 (28.8630%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0284, Accuracy: 611/1372 (44.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6105, Accuracy: 98/10000 (0.9800%)
time spent on training: 288.0516164302826
[rfa agg] training data poison_ratio: 0.42964410615099774  data num: [1190, 896, 1440, 636, 1129, 486, 1402, 568, 603, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.2685275663443736
[rfa agg] init. name: [84, 89, 29, 52, 37, 30, 66, 62, 88, 42], weight: tensor([0.1224, 0.0922, 0.1481, 0.0654, 0.1161, 0.0500, 0.1442, 0.0584, 0.0620,
        0.1411])
[rfa agg] iter:  0, prev_obj_val: 47.817169189453125, obj_val: 50.93639373779297, abs dis: 3.1192245483398438
[rfa agg] iter: 0, weight: tensor([0.1454, 0.2384, 0.0837, 0.0503, 0.1819, 0.0283, 0.0940, 0.0382, 0.0478,
        0.0920])
[rfa agg] iter:  1, prev_obj_val: 50.93639373779297, obj_val: 57.02888870239258, abs dis: 6.092494964599609
[rfa agg] iter: 1, weight: tensor([0.0972, 0.4191, 0.0629, 0.0522, 0.1155, 0.0278, 0.0694, 0.0383, 0.0496,
        0.0679])
[rfa agg] iter:  2, prev_obj_val: 57.02888870239258, obj_val: 61.69926834106445, abs dis: 4.670379638671875
[rfa agg] iter: 2, weight: tensor([0.0845, 0.3504, 0.0618, 0.0892, 0.0947, 0.0416, 0.0668, 0.0605, 0.0851,
        0.0654])
[rfa agg] iter:  3, prev_obj_val: 61.69926834106445, obj_val: 66.43299865722656, abs dis: 4.733730316162109
[rfa agg] iter: 3, weight: tensor([0.0804, 0.2070, 0.0622, 0.1451, 0.0880, 0.0575, 0.0666, 0.0889, 0.1392,
        0.0652])
[rfa agg] iter:  4, prev_obj_val: 66.43299865722656, obj_val: 64.04647064208984, abs dis: 2.3865280151367188
[rfa agg] iter: 4, weight: tensor([0.0587, 0.1161, 0.0475, 0.2225, 0.0631, 0.0637, 0.0504, 0.1098, 0.2189,
        0.0493])
[rfa agg] iter:  5, prev_obj_val: 64.04647064208984, obj_val: 68.86711120605469, abs dis: 4.820640563964844
[rfa agg] iter: 5, weight: tensor([0.0711, 0.1561, 0.0563, 0.1821, 0.0771, 0.0623, 0.0600, 0.1009, 0.1753,
        0.0588])
[rfa agg] iter:  6, prev_obj_val: 68.86711120605469, obj_val: 78.30027770996094, abs dis: 9.43316650390625
[rfa agg] iter: 6, weight: tensor([0.0425, 0.0769, 0.0351, 0.2733, 0.0454, 0.0587, 0.0371, 0.1109, 0.2837,
        0.0363])
[rfa agg] iter:  7, prev_obj_val: 78.30027770996094, obj_val: 71.5479736328125, abs dis: 6.7523040771484375
[rfa agg] iter: 7, weight: tensor([0.0323, 0.0483, 0.0279, 0.1578, 0.0338, 0.1254, 0.0293, 0.3624, 0.1541,
        0.0287])
[rfa agg] iter:  8, prev_obj_val: 71.5479736328125, obj_val: 71.5029525756836, abs dis: 0.04502105712890625
[rfa agg] iter: 8, weight: tensor([0.0301, 0.0503, 0.0252, 0.2803, 0.0319, 0.0549, 0.0266, 0.1244, 0.3502,
        0.0261])
[rfa agg] iter:  9, prev_obj_val: 71.5029525756836, obj_val: 74.74026489257812, abs dis: 3.2373123168945312
[rfa agg] iter: 9, weight: tensor([0.0273, 0.0458, 0.0230, 0.2925, 0.0290, 0.0498, 0.0242, 0.1087, 0.3760,
        0.0237])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3045, Accuracy: 108/10000 (1.0800%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 4.9260, Accuracy: 75/9950 (0.7538%)
saving model
Done in 719.5463361740112 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0590, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0314, Accuracy: 383/946 (40.4863%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4933, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0598, Accuracy: 189/682 (27.7126%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0342, Accuracy: 280/682 (41.0557%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1580, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0593, Accuracy: 253/773 (32.7296%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0269, Accuracy: 446/773 (57.6973%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8474, Accuracy: 97/10000 (0.9700%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0552, Accuracy: 484/1750 (27.6571%)
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0328, Accuracy: 757/1750 (43.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6922, Accuracy: 136/10000 (1.3600%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0724, Accuracy: 86/426 (20.1878%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0378, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5403, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0456, Accuracy: 399/1013 (39.3880%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0227, Accuracy: 596/1013 (58.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5894, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0526, Accuracy: 496/1418 (34.9788%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0282, Accuracy: 746/1418 (52.6093%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1969, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0574, Accuracy: 224/809 (27.6885%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0235, Accuracy: 425/809 (52.5340%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.2759, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0540, Accuracy: 374/1003 (37.2881%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0309, Accuracy: 413/1003 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7024, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0460, Accuracy: 480/1030 (46.6019%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 684/1030 (66.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2314, Accuracy: 107/10000 (1.0700%)
time spent on training: 261.1836881637573
[rfa agg] training data poison_ratio: 0.17766497461928935  data num: [946, 682, 773, 1750, 426, 1013, 1418, 809, 1003, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.11104060913705584
[rfa agg] init. name: [43, 80, 99, 44, 67, 39, 70, 50, 86, 91], weight: tensor([0.0960, 0.0692, 0.0785, 0.1777, 0.0432, 0.1028, 0.1440, 0.0821, 0.1018,
        0.1046])
[rfa agg] iter:  0, prev_obj_val: 43.13416290283203, obj_val: 50.015411376953125, abs dis: 6.881248474121094
[rfa agg] iter: 0, weight: tensor([0.2170, 0.0274, 0.0547, 0.0255, 0.0091, 0.2316, 0.0343, 0.0574, 0.2348,
        0.1082])
[rfa agg] iter:  1, prev_obj_val: 50.015411376953125, obj_val: 58.69640350341797, abs dis: 8.680992126464844
[rfa agg] iter: 1, weight: tensor([0.1381, 0.0620, 0.2280, 0.0281, 0.0152, 0.0919, 0.0346, 0.2442, 0.0915,
        0.0664])
[rfa agg] iter:  2, prev_obj_val: 58.69640350341797, obj_val: 62.12970733642578, abs dis: 3.4333038330078125
[rfa agg] iter: 2, weight: tensor([0.0925, 0.1779, 0.2058, 0.0326, 0.0253, 0.0745, 0.0384, 0.2184, 0.0741,
        0.0605])
[rfa agg] iter:  3, prev_obj_val: 62.12970733642578, obj_val: 65.693115234375, abs dis: 3.5634078979492188
[rfa agg] iter: 3, weight: tensor([0.0836, 0.3050, 0.1524, 0.0332, 0.0296, 0.0698, 0.0385, 0.1608, 0.0693,
        0.0579])
[rfa agg] iter:  4, prev_obj_val: 65.693115234375, obj_val: 73.60327911376953, abs dis: 7.910163879394531
[rfa agg] iter: 4, weight: tensor([0.0658, 0.4681, 0.1044, 0.0289, 0.0298, 0.0564, 0.0331, 0.1099, 0.0560,
        0.0477])
[rfa agg] iter:  5, prev_obj_val: 73.60327911376953, obj_val: 58.70502853393555, abs dis: 14.898250579833984
[rfa agg] iter: 5, weight: tensor([0.0861, 0.2984, 0.1156, 0.0445, 0.0646, 0.0768, 0.0499, 0.1213, 0.0762,
        0.0668])
[rfa agg] iter:  6, prev_obj_val: 58.70502853393555, obj_val: 58.689109802246094, abs dis: 0.015918731689453125
[rfa agg] iter: 6, weight: tensor([0.0927, 0.1892, 0.1993, 0.0327, 0.0254, 0.0748, 0.0385, 0.2124, 0.0743,
        0.0606])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3055, Accuracy: 114/10000 (1.1400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 4.9517, Accuracy: 53/9950 (0.5327%)
saving model
Done in 686.9670329093933 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0774, Accuracy: 93/515 (18.0583%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0485, Accuracy: 188/515 (36.5049%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7675, Accuracy: 65/10000 (0.6500%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0443, Accuracy: 574/1129 (50.8415%)
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0206, Accuracy: 778/1129 (68.9105%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.4269, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0531, Accuracy: 443/1581 (28.0202%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0309, Accuracy: 686/1581 (43.3903%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8176, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 508/1715 (29.6210%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0279, Accuracy: 870/1715 (50.7289%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4985, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0506, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 601/1213 (49.5466%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.2407, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0583, Accuracy: 297/946 (31.3953%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0316, Accuracy: 375/946 (39.6406%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5130, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.0811, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0651, Accuracy: 79/186 (42.4731%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.4221, Accuracy: 51/10000 (0.5100%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0559, Accuracy: 451/1750 (25.7714%)
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0326, Accuracy: 747/1750 (42.6857%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3256, Accuracy: 136/10000 (1.3600%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0805, Accuracy: 23/312 (7.3718%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 196/312 (62.8205%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.9490, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0599, Accuracy: 207/953 (21.7209%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0353, Accuracy: 364/953 (38.1952%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.0037, Accuracy: 81/10000 (0.8100%)
time spent on training: 314.4652416706085
[rfa agg] training data poison_ratio: 0.3598058252427184  data num: [515, 1129, 1581, 1715, 1213, 946, 186, 1750, 312, 953]
[rfa agg] considering poison per batch poison_fraction: 0.224878640776699
[rfa agg] init. name: [33, 37, 28, 92, 97, 43, 56, 44, 24, 64], weight: tensor([0.0500, 0.1096, 0.1535, 0.1665, 0.1178, 0.0918, 0.0181, 0.1699, 0.0303,
        0.0925])
[rfa agg] iter:  0, prev_obj_val: 57.14988708496094, obj_val: 60.69936752319336, abs dis: 3.549480438232422
[rfa agg] iter: 0, weight: tensor([0.0190, 0.3329, 0.0660, 0.0567, 0.2286, 0.1158, 0.0040, 0.0523, 0.0079,
        0.1168])
[rfa agg] iter:  1, prev_obj_val: 60.69936752319336, obj_val: 62.620872497558594, abs dis: 1.9215049743652344
[rfa agg] iter: 1, weight: tensor([0.0234, 0.2336, 0.0633, 0.0558, 0.1605, 0.1994, 0.0047, 0.0520, 0.0093,
        0.1981])
[rfa agg] iter:  2, prev_obj_val: 62.620872497558594, obj_val: 70.10910034179688, abs dis: 7.488227844238281
[rfa agg] iter: 2, weight: tensor([0.0231, 0.1653, 0.0551, 0.0490, 0.1242, 0.2635, 0.0045, 0.0459, 0.0089,
        0.2604])
[rfa agg] iter:  3, prev_obj_val: 70.10910034179688, obj_val: 77.04947662353516, abs dis: 6.940376281738281
[rfa agg] iter: 3, weight: tensor([0.0243, 0.0816, 0.0391, 0.0357, 0.0694, 0.3565, 0.0042, 0.0337, 0.0086,
        0.3470])
[rfa agg] iter:  4, prev_obj_val: 77.04947662353516, obj_val: 64.6329574584961, abs dis: 12.416519165039062
[rfa agg] iter: 4, weight: tensor([0.0508, 0.1098, 0.0614, 0.0568, 0.0978, 0.2720, 0.0079, 0.0540, 0.0164,
        0.2730])
[rfa agg] iter:  5, prev_obj_val: 64.6329574584961, obj_val: 66.97798156738281, abs dis: 2.3450241088867188
[rfa agg] iter: 5, weight: tensor([0.0193, 0.1032, 0.0404, 0.0363, 0.0827, 0.3379, 0.0036, 0.0341, 0.0072,
        0.3353])
[rfa agg] iter:  6, prev_obj_val: 66.97798156738281, obj_val: 70.08203125, abs dis: 3.1040496826171875
[rfa agg] iter: 6, weight: tensor([0.0155, 0.0652, 0.0286, 0.0259, 0.0541, 0.3972, 0.0028, 0.0244, 0.0057,
        0.3804])
[rfa agg] iter:  7, prev_obj_val: 70.08203125, obj_val: 77.05107879638672, abs dis: 6.969047546386719
[rfa agg] iter: 7, weight: tensor([0.0230, 0.0767, 0.0371, 0.0338, 0.0656, 0.3631, 0.0040, 0.0320, 0.0081,
        0.3566])
[rfa agg] iter:  8, prev_obj_val: 77.05107879638672, obj_val: 64.6329345703125, abs dis: 12.418144226074219
[rfa agg] iter: 8, weight: tensor([0.0508, 0.1098, 0.0614, 0.0568, 0.0978, 0.2720, 0.0079, 0.0539, 0.0164,
        0.2731])
[rfa agg] iter:  9, prev_obj_val: 64.6329345703125, obj_val: 66.97798156738281, abs dis: 2.3450469970703125
[rfa agg] iter: 9, weight: tensor([0.0193, 0.1032, 0.0404, 0.0363, 0.0827, 0.3379, 0.0036, 0.0341, 0.0072,
        0.3354])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3071, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 4.8408, Accuracy: 113/9950 (1.1357%)
saving model
Done in 748.0285749435425 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0553, Accuracy: 263/818 (32.1516%)
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0255, Accuracy: 475/818 (58.0685%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.1526, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0535, Accuracy: 453/1573 (28.7985%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0323, Accuracy: 688/1573 (43.7381%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6489, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0519, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0247, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4035, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0718, Accuracy: 81/426 (19.0141%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0380, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4815, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0506, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0255, Accuracy: 598/1213 (49.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3711, Accuracy: 107/10000 (1.0700%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0550, Accuracy: 364/1241 (29.3312%)
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0343, Accuracy: 499/1241 (40.2095%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3755, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0545, Accuracy: 406/1427 (28.4513%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0302, Accuracy: 686/1427 (48.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9053, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0592, Accuracy: 312/803 (38.8543%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0324, Accuracy: 404/803 (50.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3630, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 356/1446 (24.6196%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0322, Accuracy: 567/1446 (39.2116%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6656, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0527, Accuracy: 388/1131 (34.3059%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0257, Accuracy: 613/1131 (54.1998%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0897, Accuracy: 147/10000 (1.4700%)
time spent on training: 292.376797914505
[rfa agg] training data poison_ratio: 0.11313702251800528  data num: [818, 1573, 891, 426, 1213, 1241, 1427, 803, 1446, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0707106390737533
[rfa agg] init. name: [71, 40, 7, 67, 97, 72, 34, 58, 26, 38], weight: tensor([0.0746, 0.1434, 0.0812, 0.0388, 0.1106, 0.1131, 0.1301, 0.0732, 0.1318,
        0.1031])
[rfa agg] iter:  0, prev_obj_val: 43.87215805053711, obj_val: 43.84466552734375, abs dis: 0.027492523193359375
[rfa agg] iter: 0, weight: tensor([0.0778, 0.0623, 0.1158, 0.0151, 0.1583, 0.1169, 0.0738, 0.0766, 0.0747,
        0.2288])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3053, Accuracy: 115/10000 (1.1500%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 4.8670, Accuracy: 115/9950 (1.1558%)
saving model
Done in 711.44704246521 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0700, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0389, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4325, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0581, Accuracy: 309/803 (38.4807%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0322, Accuracy: 390/803 (48.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5203, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0494, Accuracy: 395/1089 (36.2718%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0238, Accuracy: 573/1089 (52.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.2264, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0507, Accuracy: 364/1049 (34.6997%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0250, Accuracy: 607/1049 (57.8646%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.2652, Accuracy: 139/10000 (1.3900%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0562, Accuracy: 361/1154 (31.2825%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0256, Accuracy: 559/1154 (48.4402%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1945, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0566, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0310, Accuracy: 406/946 (42.9175%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4737, Accuracy: 68/10000 (0.6800%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0599, Accuracy: 219/781 (28.0410%)
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0314, Accuracy: 320/781 (40.9731%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4798, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0521, Accuracy: 452/1645 (27.4772%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0296, Accuracy: 735/1645 (44.6809%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0934, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1084, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.0864, Accuracy: 40/197 (20.3046%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.4532, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 304/813 (37.3924%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 491/813 (60.3936%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 13.3293, Accuracy: 55/10000 (0.5500%)
time spent on training: 273.0938823223114
[rfa agg] training data poison_ratio: 0.21393034825870647  data num: [568, 803, 1089, 1049, 1154, 946, 781, 1645, 197, 813]
[rfa agg] considering poison per batch poison_fraction: 0.13370646766169153
[rfa agg] init. name: [62, 58, 59, 51, 15, 43, 3, 13, 79, 53], weight: tensor([0.0628, 0.0888, 0.1204, 0.1160, 0.1276, 0.1046, 0.0863, 0.1819, 0.0218,
        0.0899])
[rfa agg] iter:  0, prev_obj_val: 39.45109939575195, obj_val: 45.27305603027344, abs dis: 5.821956634521484
[rfa agg] iter: 0, weight: tensor([0.0237, 0.0965, 0.0865, 0.1159, 0.0706, 0.3737, 0.0933, 0.0374, 0.0045,
        0.0979])
[rfa agg] iter:  1, prev_obj_val: 45.27305603027344, obj_val: 51.533443450927734, abs dis: 6.260387420654297
[rfa agg] iter: 1, weight: tensor([0.0258, 0.2536, 0.0391, 0.0462, 0.0347, 0.0844, 0.2383, 0.0231, 0.0040,
        0.2507])
[rfa agg] iter:  2, prev_obj_val: 51.533443450927734, obj_val: 55.13106918334961, abs dis: 3.597625732421875
[rfa agg] iter: 2, weight: tensor([0.0559, 0.2189, 0.0532, 0.0608, 0.0486, 0.0920, 0.2066, 0.0349, 0.0073,
        0.2215])
[rfa agg] iter:  3, prev_obj_val: 55.13106918334961, obj_val: 45.0909423828125, abs dis: 10.04012680053711
[rfa agg] iter: 3, weight: tensor([0.0846, 0.1927, 0.0623, 0.0703, 0.0574, 0.1002, 0.1849, 0.0426, 0.0099,
        0.1952])
[rfa agg] iter:  4, prev_obj_val: 45.0909423828125, obj_val: 45.05645751953125, abs dis: 0.03448486328125
[rfa agg] iter: 4, weight: tensor([0.0226, 0.2694, 0.0341, 0.0403, 0.0304, 0.0724, 0.2323, 0.0202, 0.0035,
        0.2748])
[rfa agg] iter:  5, prev_obj_val: 45.05645751953125, obj_val: 51.539310455322266, abs dis: 6.482852935791016
[rfa agg] iter: 5, weight: tensor([0.0213, 0.2811, 0.0320, 0.0378, 0.0285, 0.0678, 0.2223, 0.0190, 0.0033,
        0.2868])
[rfa agg] iter:  6, prev_obj_val: 51.539310455322266, obj_val: 55.13111877441406, abs dis: 3.591808319091797
[rfa agg] iter: 6, weight: tensor([0.0558, 0.2202, 0.0531, 0.0607, 0.0485, 0.0917, 0.2046, 0.0349, 0.0073,
        0.2232])
[rfa agg] iter:  7, prev_obj_val: 55.13111877441406, obj_val: 45.09093475341797, abs dis: 10.040184020996094
[rfa agg] iter: 7, weight: tensor([0.0846, 0.1927, 0.0623, 0.0703, 0.0574, 0.1002, 0.1848, 0.0426, 0.0099,
        0.1952])
[rfa agg] iter:  8, prev_obj_val: 45.09093475341797, obj_val: 45.056453704833984, abs dis: 0.034481048583984375
[rfa agg] iter: 8, weight: tensor([0.0226, 0.2694, 0.0341, 0.0403, 0.0304, 0.0724, 0.2323, 0.0202, 0.0035,
        0.2748])
[rfa agg] iter:  9, prev_obj_val: 45.056453704833984, obj_val: 51.53931427001953, abs dis: 6.482860565185547
[rfa agg] iter: 9, weight: tensor([0.0213, 0.2811, 0.0320, 0.0378, 0.0285, 0.0678, 0.2223, 0.0190, 0.0033,
        0.2868])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3066, Accuracy: 107/10000 (1.0700%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 4.8926, Accuracy: 61/9950 (0.6131%)
saving model
Done in 686.9836127758026 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0503, Accuracy: 395/1049 (37.6549%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0255, Accuracy: 605/1049 (57.6740%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4696, Accuracy: 120/10000 (1.2000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0575, Accuracy: 226/781 (28.9373%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0306, Accuracy: 315/781 (40.3329%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3874, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0490, Accuracy: 486/1574 (30.8767%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0245, Accuracy: 774/1574 (49.1741%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7489, Accuracy: 136/10000 (1.3600%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0452, Accuracy: 576/1628 (35.3808%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0224, Accuracy: 937/1628 (57.5553%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.1149, Accuracy: 89/10000 (0.8900%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0486, Accuracy: 377/1071 (35.2007%)
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0262, Accuracy: 573/1071 (53.5014%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2331, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 523/1715 (30.4956%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0279, Accuracy: 857/1715 (49.9708%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8566, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0603, Accuracy: 321/901 (35.6271%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0301, Accuracy: 427/901 (47.3918%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.5946, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0604, Accuracy: 266/776 (34.2784%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0262, Accuracy: 446/776 (57.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6041, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0914, Accuracy: 6/271 (2.2140%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 136/271 (50.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.2226, Accuracy: 68/10000 (0.6800%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0481, Accuracy: 713/2227 (32.0162%)
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0259, Accuracy: 1111/2227 (49.8877%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2292, Accuracy: 151/10000 (1.5100%)
time spent on training: 356.6225743293762
[rfa agg] training data poison_ratio: 0.47586091886934045  data num: [1049, 781, 1574, 1628, 1071, 1715, 901, 776, 271, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2974130742933378
[rfa agg] init. name: [51, 3, 17, 5, 55, 92, 4, 75, 35, 60], weight: tensor([0.0875, 0.0651, 0.1312, 0.1357, 0.0893, 0.1430, 0.0751, 0.0647, 0.0226,
        0.1857])
[rfa agg] iter:  0, prev_obj_val: 65.92967987060547, obj_val: 67.66248321533203, abs dis: 1.7328033447265625
[rfa agg] iter: 0, weight: tensor([0.1423, 0.0512, 0.1700, 0.1443, 0.1475, 0.1292, 0.0802, 0.0509, 0.0086,
        0.0757])
[rfa agg] iter:  1, prev_obj_val: 67.66248321533203, obj_val: 70.45181274414062, abs dis: 2.7893295288085938
[rfa agg] iter: 1, weight: tensor([0.1815, 0.0553, 0.1311, 0.1149, 0.1905, 0.1052, 0.0915, 0.0550, 0.0086,
        0.0663])
[rfa agg] iter:  2, prev_obj_val: 70.45181274414062, obj_val: 74.84114074707031, abs dis: 4.3893280029296875
[rfa agg] iter: 2, weight: tensor([0.2567, 0.0511, 0.0736, 0.0666, 0.2926, 0.0625, 0.0962, 0.0507, 0.0069,
        0.0431])
[rfa agg] iter:  3, prev_obj_val: 74.84114074707031, obj_val: 74.8345947265625, abs dis: 0.0065460205078125
[rfa agg] iter: 3, weight: tensor([0.2654, 0.0536, 0.0450, 0.0416, 0.3349, 0.0397, 0.1314, 0.0532, 0.0057,
        0.0294])
[rfa agg] iter:  4, prev_obj_val: 74.8345947265625, obj_val: 77.10417175292969, abs dis: 2.2695770263671875
[rfa agg] iter: 4, weight: tensor([0.2613, 0.0529, 0.0444, 0.0411, 0.3434, 0.0393, 0.1303, 0.0525, 0.0057,
        0.0290])
[rfa agg] iter:  5, prev_obj_val: 77.10417175292969, obj_val: 79.50798797607422, abs dis: 2.4038162231445312
[rfa agg] iter: 5, weight: tensor([0.2231, 0.0704, 0.0482, 0.0449, 0.2595, 0.0430, 0.2017, 0.0699, 0.0068,
        0.0324])
[rfa agg] iter:  6, prev_obj_val: 79.50798797607422, obj_val: 77.10454559326172, abs dis: 2.4034423828125
[rfa agg] iter: 6, weight: tensor([0.1688, 0.0848, 0.0461, 0.0432, 0.1855, 0.0416, 0.3067, 0.0841, 0.0072,
        0.0319])
[rfa agg] iter:  7, prev_obj_val: 77.10454559326172, obj_val: 79.5025634765625, abs dis: 2.3980178833007812
[rfa agg] iter: 7, weight: tensor([0.2113, 0.0711, 0.0484, 0.0451, 0.2511, 0.0432, 0.2198, 0.0705, 0.0069,
        0.0326])
[rfa agg] iter:  8, prev_obj_val: 79.5025634765625, obj_val: 77.10537719726562, abs dis: 2.397186279296875
[rfa agg] iter: 8, weight: tensor([0.1672, 0.0844, 0.0459, 0.0430, 0.1845, 0.0414, 0.3108, 0.0838, 0.0072,
        0.0317])
[rfa agg] iter:  9, prev_obj_val: 77.10537719726562, obj_val: 79.50247192382812, abs dis: 2.3970947265625
[rfa agg] iter: 9, weight: tensor([0.2110, 0.0711, 0.0484, 0.0451, 0.2510, 0.0432, 0.2202, 0.0705, 0.0069,
        0.0326])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3063, Accuracy: 111/10000 (1.1100%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.9042, Accuracy: 50/9950 (0.5025%)
saving model
Done in 792.0137686729431 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0486, Accuracy: 373/1130 (33.0088%)
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0261, Accuracy: 536/1130 (47.4336%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.4659, Accuracy: 76/10000 (0.7600%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0524, Accuracy: 381/1154 (33.0156%)
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0255, Accuracy: 583/1154 (50.5199%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.4870, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0465, Accuracy: 428/928 (46.1207%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0196, Accuracy: 660/928 (71.1207%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.2243, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0530, Accuracy: 327/1131 (28.9125%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0286, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2800, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0500, Accuracy: 288/888 (32.4324%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0234, Accuracy: 486/888 (54.7297%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.1813, Accuracy: 94/10000 (0.9400%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 276/590 (46.7797%)
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0330, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.6040, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 707/2227 (31.7467%)
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0261, Accuracy: 1084/2227 (48.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2777, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0442, Accuracy: 654/1470 (44.4898%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0221, Accuracy: 936/1470 (63.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.1525, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0562, Accuracy: 315/946 (33.2981%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0312, Accuracy: 370/946 (39.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.5773, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0600, Accuracy: 262/669 (39.1629%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0361, Accuracy: 375/669 (56.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.8584, Accuracy: 88/10000 (0.8800%)
time spent on training: 340.8441352844238
[rfa agg] training data poison_ratio: 0.4581873708793677  data num: [1130, 1154, 928, 1131, 888, 590, 2227, 1470, 946, 669]
[rfa agg] considering poison per batch poison_fraction: 0.2863671067996048
[rfa agg] init. name: [54, 15, 1, 87, 63, 69, 60, 22, 43, 45], weight: tensor([0.1015, 0.1037, 0.0834, 0.1016, 0.0798, 0.0530, 0.2000, 0.1320, 0.0850,
        0.0601])
[rfa agg] iter:  0, prev_obj_val: 54.00423812866211, obj_val: 56.6363410949707, abs dis: 2.6321029663085938
[rfa agg] iter: 0, weight: tensor([0.2532, 0.2387, 0.0487, 0.2566, 0.0369, 0.0131, 0.0254, 0.0607, 0.0502,
        0.0167])
[rfa agg] iter:  1, prev_obj_val: 56.6363410949707, obj_val: 61.02708053588867, abs dis: 4.390739440917969
[rfa agg] iter: 1, weight: tensor([0.1809, 0.1156, 0.1382, 0.1822, 0.0892, 0.0234, 0.0311, 0.0580, 0.1503,
        0.0312])
[rfa agg] iter:  2, prev_obj_val: 61.02708053588867, obj_val: 69.19677734375, abs dis: 8.169696807861328
[rfa agg] iter: 2, weight: tensor([0.0702, 0.0540, 0.2247, 0.0704, 0.1492, 0.0224, 0.0212, 0.0348, 0.3215,
        0.0315])
[rfa agg] iter:  3, prev_obj_val: 69.19677734375, obj_val: 72.52979278564453, abs dis: 3.3330154418945312
[rfa agg] iter: 3, weight: tensor([0.0652, 0.0546, 0.1459, 0.0654, 0.3311, 0.0438, 0.0272, 0.0405, 0.1577,
        0.0684])
[rfa agg] iter:  4, prev_obj_val: 72.52979278564453, obj_val: 66.00293731689453, abs dis: 6.52685546875
[rfa agg] iter: 4, weight: tensor([0.0717, 0.0611, 0.1388, 0.0719, 0.2658, 0.0621, 0.0324, 0.0470, 0.1460,
        0.1031])
[rfa agg] iter:  5, prev_obj_val: 66.00293731689453, obj_val: 79.41070556640625, abs dis: 13.407768249511719
[rfa agg] iter: 5, weight: tensor([0.0546, 0.0447, 0.1443, 0.0547, 0.4156, 0.0287, 0.0208, 0.0319, 0.1618,
        0.0430])
[rfa agg] iter:  6, prev_obj_val: 79.41070556640625, obj_val: 72.53632354736328, abs dis: 6.874382019042969
[rfa agg] iter: 6, weight: tensor([0.0699, 0.0612, 0.1119, 0.0700, 0.1637, 0.1066, 0.0362, 0.0498, 0.1159,
        0.2147])
[rfa agg] iter:  7, prev_obj_val: 72.53632354736328, obj_val: 66.0043716430664, abs dis: 6.531951904296875
[rfa agg] iter: 7, weight: tensor([0.0724, 0.0616, 0.1399, 0.0725, 0.2589, 0.0628, 0.0327, 0.0473, 0.1469,
        0.1051])
[rfa agg] iter:  8, prev_obj_val: 66.0043716430664, obj_val: 79.41035461425781, abs dis: 13.405982971191406
[rfa agg] iter: 8, weight: tensor([0.0548, 0.0449, 0.1449, 0.0549, 0.4132, 0.0288, 0.0208, 0.0320, 0.1625,
        0.0432])
[rfa agg] iter:  9, prev_obj_val: 79.41035461425781, obj_val: 72.53633117675781, abs dis: 6.8740234375
[rfa agg] iter: 9, weight: tensor([0.0699, 0.0612, 0.1119, 0.0700, 0.1637, 0.1066, 0.0362, 0.0498, 0.1159,
        0.2148])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3062, Accuracy: 134/10000 (1.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.9126, Accuracy: 49/9950 (0.4925%)
saving model
Done in 767.2793707847595 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 32/338 (9.4675%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9945, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 290/712 (40.7303%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0210, Accuracy: 481/712 (67.5562%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.2127, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0531, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0264, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5952, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0615, Accuracy: 208/605 (34.3802%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0375, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.0287, Accuracy: 81/10000 (0.8100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0520, Accuracy: 478/1475 (32.4068%)
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0296, Accuracy: 783/1475 (53.0847%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.9514, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0583, Accuracy: 298/715 (41.6783%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0351, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6547, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 338/1163 (29.0628%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0344, Accuracy: 494/1163 (42.4764%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.2663, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0497, Accuracy: 369/1213 (30.4204%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0255, Accuracy: 612/1213 (50.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6027, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0723, Accuracy: 99/500 (19.8000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0452, Accuracy: 231/500 (46.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.5231, Accuracy: 88/10000 (0.8800%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0460, Accuracy: 413/1275 (32.3922%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 811/1275 (63.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.2345, Accuracy: 129/10000 (1.2900%)
time spent on training: 285.75072503089905
[rfa agg] training data poison_ratio: 0.3577386468952734  data num: [338, 712, 636, 605, 1475, 715, 1163, 1213, 500, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.22358665430954588
[rfa agg] init. name: [12, 11, 52, 2, 65, 23, 68, 97, 82, 9], weight: tensor([0.0392, 0.0825, 0.0737, 0.0701, 0.1709, 0.0828, 0.1347, 0.1405, 0.0579,
        0.1477])
[rfa agg] iter:  0, prev_obj_val: 50.88282775878906, obj_val: 55.90643310546875, abs dis: 5.0236053466796875
[rfa agg] iter: 0, weight: tensor([0.0212, 0.2085, 0.0843, 0.0805, 0.0659, 0.2035, 0.0988, 0.1030, 0.0427,
        0.0917])
[rfa agg] iter:  1, prev_obj_val: 55.90643310546875, obj_val: 63.14038848876953, abs dis: 7.233955383300781
[rfa agg] iter: 1, weight: tensor([0.0175, 0.2855, 0.1139, 0.1095, 0.0336, 0.2665, 0.0441, 0.0460, 0.0405,
        0.0427])
[rfa agg] iter:  2, prev_obj_val: 63.14038848876953, obj_val: 63.02183532714844, abs dis: 0.11855316162109375
[rfa agg] iter: 2, weight: tensor([0.0212, 0.0872, 0.3094, 0.3088, 0.0265, 0.0871, 0.0325, 0.0338, 0.0616,
        0.0320])
[rfa agg] iter:  3, prev_obj_val: 63.02183532714844, obj_val: 69.79170989990234, abs dis: 6.769874572753906
[rfa agg] iter: 3, weight: tensor([0.0176, 0.0710, 0.3365, 0.3489, 0.0219, 0.0713, 0.0269, 0.0280, 0.0514,
        0.0265])
[rfa agg] iter:  4, prev_obj_val: 69.79170989990234, obj_val: 69.77950286865234, abs dis: 0.01220703125
[rfa agg] iter: 4, weight: tensor([0.0420, 0.0872, 0.2230, 0.2146, 0.0368, 0.0876, 0.0436, 0.0454, 0.1762,
        0.0434])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3053, Accuracy: 132/10000 (1.3200%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 4.9152, Accuracy: 52/9950 (0.5226%)
saving model
Done in 710.6264145374298 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0604, Accuracy: 186/682 (27.2727%)
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0345, Accuracy: 283/682 (41.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6214, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0544, Accuracy: 409/1427 (28.6615%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 635/1427 (44.4989%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9523, Accuracy: 88/10000 (0.8800%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0552, Accuracy: 362/1241 (29.1700%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0342, Accuracy: 509/1241 (41.0153%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.1585, Accuracy: 77/10000 (0.7700%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0621, Accuracy: 255/774 (32.9457%)
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0311, Accuracy: 355/774 (45.8656%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9851, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 307/719 (42.6982%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0304, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9644, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0487, Accuracy: 374/1340 (27.9104%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0242, Accuracy: 636/1340 (47.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.2235, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0550, Accuracy: 263/818 (32.1516%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0261, Accuracy: 429/818 (52.4450%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.3058, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0915, Accuracy: 5/271 (1.8450%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 147/271 (54.2435%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.3903, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 339/891 (38.0471%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0237, Accuracy: 479/891 (53.7598%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0803, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0299, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.9726, Accuracy: 50/10000 (0.5000%)
time spent on training: 280.735310792923
[rfa agg] training data poison_ratio: 0.2223080317740512  data num: [682, 1427, 1241, 774, 719, 1340, 818, 271, 891, 901]
[rfa agg] considering poison per batch poison_fraction: 0.138942519858782
[rfa agg] init. name: [80, 34, 72, 81, 41, 77, 71, 35, 7, 4], weight: tensor([0.0752, 0.1574, 0.1369, 0.0854, 0.0793, 0.1478, 0.0902, 0.0299, 0.0983,
        0.0994])
[rfa agg] iter:  0, prev_obj_val: 38.977447509765625, obj_val: 53.637264251708984, abs dis: 14.65981674194336
[rfa agg] iter: 0, weight: tensor([0.0502, 0.0354, 0.0461, 0.1431, 0.0771, 0.0427, 0.1537, 0.0067, 0.2857,
        0.1594])
[rfa agg] iter:  1, prev_obj_val: 53.637264251708984, obj_val: 53.524620056152344, abs dis: 0.11264419555664062
[rfa agg] iter: 1, weight: tensor([0.3645, 0.0323, 0.0375, 0.0998, 0.1705, 0.0364, 0.1067, 0.0123, 0.0797,
        0.0604])
[rfa agg] iter:  2, prev_obj_val: 53.524620056152344, obj_val: 53.515132904052734, abs dis: 0.009487152099609375
[rfa agg] iter: 2, weight: tensor([0.4695, 0.0268, 0.0311, 0.0830, 0.1455, 0.0302, 0.0882, 0.0102, 0.0654,
        0.0501])
[rfa agg] iter:  3, prev_obj_val: 53.515132904052734, obj_val: 53.5130615234375, abs dis: 0.002071380615234375
[rfa agg] iter: 3, weight: tensor([0.5156, 0.0246, 0.0285, 0.0759, 0.1320, 0.0277, 0.0806, 0.0093, 0.0599,
        0.0459])
[rfa agg] iter:  4, prev_obj_val: 53.5130615234375, obj_val: 57.50476837158203, abs dis: 3.9917068481445312
[rfa agg] iter: 4, weight: tensor([0.5388, 0.0234, 0.0272, 0.0723, 0.1253, 0.0264, 0.0768, 0.0089, 0.0571,
        0.0438])
[rfa agg] iter:  5, prev_obj_val: 57.50476837158203, obj_val: 57.49480438232422, abs dis: 0.0099639892578125
[rfa agg] iter: 5, weight: tensor([0.3892, 0.0360, 0.0412, 0.0943, 0.1424, 0.0402, 0.1000, 0.0155, 0.0788,
        0.0624])
[rfa agg] iter:  6, prev_obj_val: 57.49480438232422, obj_val: 57.49469757080078, abs dis: 0.0001068115234375
[rfa agg] iter: 6, weight: tensor([0.3737, 0.0368, 0.0421, 0.0967, 0.1465, 0.0411, 0.1026, 0.0159, 0.0807,
        0.0639])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3062, Accuracy: 119/10000 (1.1900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 4.9385, Accuracy: 39/9950 (0.3920%)
saving model
Done in 699.2816348075867 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0809, Accuracy: 22/312 (7.0513%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0399, Accuracy: 195/312 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.9258, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0511, Accuracy: 446/1956 (22.8016%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 757/1956 (38.7014%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3604, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0453, Accuracy: 440/928 (47.4138%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0199, Accuracy: 666/928 (71.7672%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8986, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 270/708 (38.1356%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0361, Accuracy: 439/708 (62.0056%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3130, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 147/568 (25.8803%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0393, Accuracy: 268/568 (47.1831%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3332, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0597, Accuracy: 222/605 (36.6942%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0380, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1405, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0523, Accuracy: 336/1131 (29.7082%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0285, Accuracy: 489/1131 (43.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4209, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0485, Accuracy: 452/1574 (28.7166%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0240, Accuracy: 768/1574 (48.7929%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.7012, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0557, Accuracy: 316/946 (33.4038%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0298, Accuracy: 412/946 (43.5518%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7796, Accuracy: 63/10000 (0.6300%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0701, Accuracy: 146/530 (27.5472%)
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0352, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6333, Accuracy: 73/10000 (0.7300%)
time spent on training: 285.26182985305786
[rfa agg] training data poison_ratio: 0.09094836897818104  data num: [312, 1956, 928, 708, 568, 605, 1131, 1574, 946, 530]
[rfa agg] considering poison per batch poison_fraction: 0.05684273061136315
[rfa agg] init. name: [24, 6, 1, 16, 62, 2, 87, 17, 43, 18], weight: tensor([0.0337, 0.2113, 0.1002, 0.0765, 0.0614, 0.0653, 0.1222, 0.1700, 0.1022,
        0.0572])
[rfa agg] iter:  0, prev_obj_val: 63.53350067138672, obj_val: 63.99305725097656, abs dis: 0.45955657958984375
[rfa agg] iter: 0, weight: tensor([0.0084, 0.0485, 0.1173, 0.0429, 0.0224, 0.0270, 0.5199, 0.0700, 0.1228,
        0.0209])
[rfa agg] iter:  1, prev_obj_val: 63.99305725097656, obj_val: 69.09796142578125, abs dis: 5.1049041748046875
[rfa agg] iter: 1, weight: tensor([0.0089, 0.0378, 0.2780, 0.0600, 0.0262, 0.0329, 0.1351, 0.0496, 0.3470,
        0.0244])
[rfa agg] iter:  2, prev_obj_val: 69.09796142578125, obj_val: 72.75091552734375, abs dis: 3.6529541015625
[rfa agg] iter: 2, weight: tensor([0.0144, 0.0438, 0.2184, 0.1748, 0.0493, 0.0670, 0.0980, 0.0536, 0.2345,
        0.0460])
[rfa agg] iter:  3, prev_obj_val: 72.75091552734375, obj_val: 79.56423950195312, abs dis: 6.813323974609375
[rfa agg] iter: 3, weight: tensor([0.0148, 0.0377, 0.1268, 0.3743, 0.0576, 0.0847, 0.0732, 0.0449, 0.1323,
        0.0536])
[rfa agg] iter:  4, prev_obj_val: 79.56423950195312, obj_val: 79.54977416992188, abs dis: 0.01446533203125
[rfa agg] iter: 4, weight: tensor([0.0197, 0.0371, 0.0862, 0.2548, 0.1058, 0.2059, 0.0612, 0.0426, 0.0889,
        0.0978])
[rfa agg] iter:  5, prev_obj_val: 79.54977416992188, obj_val: 82.09098052978516, abs dis: 2.5412063598632812
[rfa agg] iter: 5, weight: tensor([0.0197, 0.0370, 0.0857, 0.2491, 0.1059, 0.2123, 0.0610, 0.0425, 0.0887,
        0.0981])
[rfa agg] iter:  6, prev_obj_val: 82.09098052978516, obj_val: 82.08202362060547, abs dis: 0.0089569091796875
[rfa agg] iter: 6, weight: tensor([0.0193, 0.0325, 0.0690, 0.1556, 0.1258, 0.3222, 0.0513, 0.0370, 0.0712,
        0.1160])
[rfa agg] iter:  7, prev_obj_val: 82.08202362060547, obj_val: 84.73834228515625, abs dis: 2.6563186645507812
[rfa agg] iter: 7, weight: tensor([0.0189, 0.0319, 0.0676, 0.1510, 0.1234, 0.3366, 0.0503, 0.0363, 0.0698,
        0.1141])
[rfa agg] iter:  8, prev_obj_val: 84.73834228515625, obj_val: 84.72297668457031, abs dis: 0.0153656005859375
[rfa agg] iter: 8, weight: tensor([0.0156, 0.0233, 0.0457, 0.0863, 0.1343, 0.4634, 0.0353, 0.0262, 0.0471,
        0.1229])
[rfa agg] iter:  9, prev_obj_val: 84.72297668457031, obj_val: 87.76984405517578, abs dis: 3.0468673706054688
[rfa agg] iter: 9, weight: tensor([0.0139, 0.0207, 0.0406, 0.0764, 0.1188, 0.5237, 0.0314, 0.0233, 0.0419,
        0.1093])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3069, Accuracy: 126/10000 (1.2600%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 4.9647, Accuracy: 32/9950 (0.3216%)
saving model
Done in 707.3983292579651 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0678, Accuracy: 160/530 (30.1887%)
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0352, Accuracy: 294/530 (55.4717%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8289, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0574, Accuracy: 283/1013 (27.9368%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0316, Accuracy: 425/1013 (41.9546%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1597, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0586, Accuracy: 244/605 (40.3306%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0347, Accuracy: 331/605 (54.7107%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.2258, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0592, Accuracy: 250/669 (37.3692%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0348, Accuracy: 375/669 (56.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.8131, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0488, Accuracy: 308/888 (34.6847%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0229, Accuracy: 501/888 (56.4189%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.9828, Accuracy: 101/10000 (1.0100%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0565, Accuracy: 299/599 (49.9165%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.5477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0484, Accuracy: 333/677 (49.1876%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 410/677 (60.5613%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.6680, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0575, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0293, Accuracy: 449/901 (49.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.5088, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0565, Accuracy: 308/715 (43.0769%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0364, Accuracy: 436/715 (60.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.4878, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0557, Accuracy: 357/1513 (23.5955%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0332, Accuracy: 570/1513 (37.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7794, Accuracy: 132/10000 (1.3200%)
time spent on training: 269.6058692932129
[rfa agg] training data poison_ratio: 0.13921085080147966  data num: [530, 1013, 605, 669, 888, 599, 677, 901, 715, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.08700678175092479
[rfa agg] init. name: [18, 14, 2, 45, 63, 95, 90, 4, 23, 8], weight: tensor([0.0654, 0.1249, 0.0746, 0.0825, 0.1095, 0.0739, 0.0835, 0.1111, 0.0882,
        0.1866])
[rfa agg] iter:  0, prev_obj_val: 36.432861328125, obj_val: 43.7542610168457, abs dis: 7.321399688720703
[rfa agg] iter: 0, weight: tensor([0.0428, 0.0614, 0.0719, 0.1428, 0.1044, 0.0706, 0.1486, 0.0711, 0.2555,
        0.0308])
[rfa agg] iter:  1, prev_obj_val: 43.7542610168457, obj_val: 51.02053451538086, abs dis: 7.266273498535156
[rfa agg] iter: 1, weight: tensor([0.0963, 0.0332, 0.2491, 0.1190, 0.0435, 0.2142, 0.1198, 0.0352, 0.0684,
        0.0213])
[rfa agg] iter:  2, prev_obj_val: 51.02053451538086, obj_val: 55.25830841064453, abs dis: 4.237773895263672
[rfa agg] iter: 2, weight: tensor([0.3518, 0.0363, 0.1428, 0.0814, 0.0444, 0.1386, 0.0833, 0.0375, 0.0586,
        0.0254])
[rfa agg] iter:  3, prev_obj_val: 55.25830841064453, obj_val: 59.65930938720703, abs dis: 4.4010009765625
[rfa agg] iter: 3, weight: tensor([0.3151, 0.0455, 0.1311, 0.0883, 0.0542, 0.1287, 0.0900, 0.0464, 0.0677,
        0.0329])
[rfa agg] iter:  4, prev_obj_val: 59.65930938720703, obj_val: 50.996612548828125, abs dis: 8.662696838378906
[rfa agg] iter: 4, weight: tensor([0.2305, 0.0571, 0.1338, 0.0993, 0.0666, 0.1317, 0.1009, 0.0578, 0.0797,
        0.0427])
[rfa agg] iter:  5, prev_obj_val: 50.996612548828125, obj_val: 50.97977066040039, abs dis: 0.016841888427734375
[rfa agg] iter: 5, weight: tensor([0.3933, 0.0343, 0.1324, 0.0768, 0.0419, 0.1283, 0.0785, 0.0354, 0.0553,
        0.0239])
[rfa agg] iter:  6, prev_obj_val: 50.97977066040039, obj_val: 55.2628173828125, abs dis: 4.283046722412109
[rfa agg] iter: 6, weight: tensor([0.4516, 0.0310, 0.1194, 0.0694, 0.0379, 0.1162, 0.0710, 0.0320, 0.0499,
        0.0217])
[rfa agg] iter:  7, prev_obj_val: 55.2628173828125, obj_val: 59.659584045410156, abs dis: 4.396766662597656
[rfa agg] iter: 7, weight: tensor([0.3227, 0.0450, 0.1294, 0.0874, 0.0537, 0.1271, 0.0891, 0.0460, 0.0670,
        0.0326])
[rfa agg] iter:  8, prev_obj_val: 59.659584045410156, obj_val: 50.99658966064453, abs dis: 8.662994384765625
[rfa agg] iter: 8, weight: tensor([0.2307, 0.0571, 0.1337, 0.0992, 0.0666, 0.1317, 0.1009, 0.0578, 0.0797,
        0.0427])
[rfa agg] iter:  9, prev_obj_val: 50.99658966064453, obj_val: 50.97977066040039, abs dis: 0.016819000244140625
[rfa agg] iter: 9, weight: tensor([0.3934, 0.0343, 0.1323, 0.0768, 0.0419, 0.1283, 0.0785, 0.0354, 0.0553,
        0.0239])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3065, Accuracy: 120/10000 (1.2000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.9814, Accuracy: 31/9950 (0.3116%)
saving model
Done in 702.8711333274841 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0511, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 547/1154 (47.4003%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.8421, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0463, Accuracy: 302/813 (37.1464%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 489/813 (60.1476%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 12.9602, Accuracy: 64/10000 (0.6400%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0756, Accuracy: 86/408 (21.0784%)
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0426, Accuracy: 164/408 (40.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.2708, Accuracy: 65/10000 (0.6500%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0479, Accuracy: 340/861 (39.4890%)
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0168, Accuracy: 538/861 (62.4855%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.6515, Accuracy: 109/10000 (1.0900%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0437, Accuracy: 579/1129 (51.2843%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0200, Accuracy: 817/1129 (72.3649%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1058, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0524, Accuracy: 434/1645 (26.3830%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0296, Accuracy: 744/1645 (45.2280%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1295, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0540, Accuracy: 429/1573 (27.2727%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0324, Accuracy: 679/1573 (43.1659%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.6005, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 150/568 (26.4085%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.2909, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0474, Accuracy: 392/1013 (38.6969%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0228, Accuracy: 578/1013 (57.0582%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.9318, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0580, Accuracy: 201/682 (29.4721%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0343, Accuracy: 276/682 (40.4692%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4241, Accuracy: 82/10000 (0.8200%)
time spent on training: 321.3778178691864
[rfa agg] training data poison_ratio: 0.2435506804793825  data num: [1154, 813, 408, 861, 1129, 1645, 1573, 568, 1013, 682]
[rfa agg] considering poison per batch poison_fraction: 0.15221917529961407
[rfa agg] init. name: [57, 53, 36, 10, 37, 13, 40, 62, 39, 80], weight: tensor([0.1172, 0.0826, 0.0414, 0.0874, 0.1147, 0.1671, 0.1598, 0.0577, 0.1029,
        0.0693])
[rfa agg] iter:  0, prev_obj_val: 48.03135681152344, obj_val: 51.944366455078125, abs dis: 3.9130096435546875
[rfa agg] iter: 0, weight: tensor([0.1010, 0.0726, 0.0124, 0.1112, 0.1398, 0.0448, 0.0475, 0.0221, 0.4118,
        0.0370])
[rfa agg] iter:  1, prev_obj_val: 51.944366455078125, obj_val: 55.591922760009766, abs dis: 3.6475563049316406
[rfa agg] iter: 1, weight: tensor([0.0737, 0.1461, 0.0159, 0.3107, 0.0917, 0.0418, 0.0438, 0.0302, 0.1900,
        0.0562])
[rfa agg] iter:  2, prev_obj_val: 55.591922760009766, obj_val: 60.632843017578125, abs dis: 5.040920257568359
[rfa agg] iter: 2, weight: tensor([0.0537, 0.2740, 0.0163, 0.3185, 0.0638, 0.0341, 0.0354, 0.0326, 0.1025,
        0.0690])
[rfa agg] iter:  3, prev_obj_val: 60.632843017578125, obj_val: 66.48274230957031, abs dis: 5.8498992919921875
[rfa agg] iter: 3, weight: tensor([0.0539, 0.3513, 0.0227, 0.1669, 0.0621, 0.0373, 0.0385, 0.0494, 0.0873,
        0.1306])
[rfa agg] iter:  4, prev_obj_val: 66.48274230957031, obj_val: 60.639957427978516, abs dis: 5.842784881591797
[rfa agg] iter: 4, weight: tensor([0.0529, 0.1808, 0.0313, 0.1157, 0.0595, 0.0392, 0.0402, 0.0776, 0.0770,
        0.3257])
[rfa agg] iter:  5, prev_obj_val: 60.639957427978516, obj_val: 66.481689453125, abs dis: 5.841732025146484
[rfa agg] iter: 5, weight: tensor([0.0541, 0.3489, 0.0228, 0.1632, 0.0623, 0.0375, 0.0387, 0.0497, 0.0875,
        0.1354])
[rfa agg] iter:  6, prev_obj_val: 66.481689453125, obj_val: 60.64009094238281, abs dis: 5.8415985107421875
[rfa agg] iter: 6, weight: tensor([0.0528, 0.1806, 0.0313, 0.1156, 0.0594, 0.0392, 0.0402, 0.0776, 0.0770,
        0.3263])
[rfa agg] iter:  7, prev_obj_val: 60.64009094238281, obj_val: 66.48168182373047, abs dis: 5.841590881347656
[rfa agg] iter: 7, weight: tensor([0.0541, 0.3488, 0.0228, 0.1632, 0.0623, 0.0375, 0.0387, 0.0497, 0.0875,
        0.1354])
[rfa agg] iter:  8, prev_obj_val: 66.48168182373047, obj_val: 60.64009094238281, abs dis: 5.841590881347656
[rfa agg] iter: 8, weight: tensor([0.0528, 0.1806, 0.0313, 0.1156, 0.0594, 0.0392, 0.0402, 0.0776, 0.0770,
        0.3263])
[rfa agg] iter:  9, prev_obj_val: 60.64009094238281, obj_val: 66.48168182373047, abs dis: 5.841590881347656
[rfa agg] iter: 9, weight: tensor([0.0541, 0.3488, 0.0228, 0.1632, 0.0623, 0.0375, 0.0387, 0.0497, 0.0875,
        0.1354])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3087, Accuracy: 120/10000 (1.2000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.0032, Accuracy: 16/9950 (0.1608%)
saving model
Done in 746.9427492618561 sec.
Saving all the graphs.
This run has a label: Jun.27_22.34.36. Visdom environment: tiny
