current path: saved_models/model_tiny_Jun.19_19.02.37
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 421/1953 (21.5566%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 749/1953 (38.3513%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.7469, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 469/1988 (23.5915%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9953, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 162/953 (16.9990%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 320/953 (33.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2906, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 462/1071 (43.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7740, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 446/1587 (28.1033%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 629/1587 (39.6345%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2582, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 443/1715 (25.8309%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 705/1715 (41.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5940, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 380/1154 (32.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2562, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5507, Accuracy: 50/10000 (0.5000%)
time spent on training: 86.78517532348633
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 85, 64, 95, 54, 55, 27, 92, 15, 78], weight: tensor([0.1554, 0.1582, 0.0758, 0.0477, 0.0899, 0.0852, 0.1263, 0.1365, 0.0918,
        0.0331])
[rfa agg] iter:  0, prev_obj_val: 62.20138931274414, obj_val: 65.63113403320312, abs dis: 3.4297447204589844
[rfa agg] iter:  0, weight: tensor([0.0803, 0.0743, 0.0649, 0.0225, 0.1475, 0.1074, 0.1597, 0.1168, 0.2143,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 65.63113403320312, obj_val: 73.30477905273438, abs dis: 7.67364501953125
[rfa agg] iter:  1, weight: tensor([0.0422, 0.0397, 0.0604, 0.0173, 0.2169, 0.1254, 0.0682, 0.0555, 0.3654,
        0.0090])
[rfa agg] iter:  2, prev_obj_val: 73.30477905273438, obj_val: 73.17507934570312, abs dis: 0.12969970703125
[rfa agg] iter:  2, weight: tensor([0.0377, 0.0358, 0.1160, 0.0230, 0.2322, 0.2961, 0.0533, 0.0462, 0.1485,
        0.0112])
[rfa agg] iter:  3, prev_obj_val: 73.17507934570312, obj_val: 73.16697692871094, abs dis: 0.0081024169921875
[rfa agg] iter:  3, weight: tensor([0.0347, 0.0330, 0.1094, 0.0212, 0.2136, 0.3546, 0.0491, 0.0426, 0.1313,
        0.0103])
[rfa agg] iter:  4, prev_obj_val: 73.16697692871094, obj_val: 73.16571044921875, abs dis: 0.0012664794921875
[rfa agg] iter:  4, weight: tensor([0.0338, 0.0321, 0.1065, 0.0207, 0.2039, 0.3768, 0.0478, 0.0414, 0.1270,
        0.0100])
[rfa agg] iter:  5, prev_obj_val: 73.16571044921875, obj_val: 70.79834747314453, abs dis: 2.3673629760742188
[rfa agg] iter:  5, weight: tensor([0.0334, 0.0317, 0.1052, 0.0204, 0.1998, 0.3861, 0.0472, 0.0409, 0.1253,
        0.0099])
[rfa agg] iter:  6, prev_obj_val: 70.79834747314453, obj_val: 73.17748260498047, abs dis: 2.3791351318359375
[rfa agg] iter:  6, weight: tensor([0.0346, 0.0327, 0.0865, 0.0190, 0.2572, 0.3115, 0.0502, 0.0430, 0.1558,
        0.0094])
[rfa agg] iter:  7, prev_obj_val: 73.17748260498047, obj_val: 73.16710662841797, abs dis: 0.0103759765625
[rfa agg] iter:  7, weight: tensor([0.0347, 0.0329, 0.1086, 0.0212, 0.2157, 0.3539, 0.0490, 0.0425, 0.1312,
        0.0103])
[rfa agg] iter:  8, prev_obj_val: 73.16710662841797, obj_val: 73.16572570800781, abs dis: 0.00138092041015625
[rfa agg] iter:  8, weight: tensor([0.0338, 0.0321, 0.1065, 0.0207, 0.2043, 0.3762, 0.0478, 0.0415, 0.1271,
        0.0100])
[rfa agg] iter:  9, prev_obj_val: 73.16572570800781, obj_val: 70.79825592041016, abs dis: 2.3674697875976562
[rfa agg] iter:  9, weight: tensor([0.0334, 0.0317, 0.1052, 0.0204, 0.1999, 0.3859, 0.0472, 0.0410, 0.1254,
        0.0099])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3069, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3493, Accuracy: 0/9950 (0.0000%)
saving model
Done in 186.8841733932495 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 153/953 (16.0546%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0387, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5379, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1239, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1122, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3245, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0597, Accuracy: 297/946 (31.3953%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 335/946 (35.4123%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.1125, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 299/715 (41.8182%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0408, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0786, Accuracy: 19/312 (6.0897%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 156/312 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0836, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.5065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3103, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 390/1581 (24.6679%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 562/1581 (35.5471%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6668, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0565, Accuracy: 381/1956 (19.4785%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 628/1956 (32.1063%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0145, Accuracy: 113/10000 (1.1300%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 384/1574 (24.3964%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 658/1574 (41.8043%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.2146, Accuracy: 89/10000 (0.8900%)
time spent on training: 119.73827004432678
[rfa agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.05053164166837888
[rfa agg] init. name: [64, 47, 43, 23, 24, 98, 84, 28, 6, 17], weight: tensor([0.0979, 0.0138, 0.0972, 0.0735, 0.0321, 0.0383, 0.1223, 0.1624, 0.2009,
        0.1617])
[rfa agg] iter:  0, prev_obj_val: 63.78335189819336, obj_val: 64.69941711425781, abs dis: 0.9160652160644531
[rfa agg] iter:  0, weight: tensor([0.1191, 0.0038, 0.1181, 0.0487, 0.0103, 0.0133, 0.4017, 0.1076, 0.0699,
        0.1075])
[rfa agg] iter:  1, prev_obj_val: 64.69941711425781, obj_val: 67.2697982788086, abs dis: 2.5703811645507812
[rfa agg] iter:  1, weight: tensor([0.1327, 0.0038, 0.1312, 0.0509, 0.0103, 0.0134, 0.3986, 0.0970, 0.0651,
        0.0967])
[rfa agg] iter:  2, prev_obj_val: 67.2697982788086, obj_val: 68.55062103271484, abs dis: 1.28082275390625
[rfa agg] iter:  2, weight: tensor([0.2032, 0.0044, 0.2000, 0.0647, 0.0119, 0.0156, 0.2546, 0.0907, 0.0645,
        0.0904])
[rfa agg] iter:  3, prev_obj_val: 68.55062103271484, obj_val: 71.42811584472656, abs dis: 2.8774948120117188
[rfa agg] iter:  3, weight: tensor([0.2492, 0.0042, 0.2447, 0.0670, 0.0116, 0.0152, 0.1903, 0.0799, 0.0582,
        0.0796])
[rfa agg] iter:  4, prev_obj_val: 71.42811584472656, obj_val: 73.19879150390625, abs dis: 1.7706756591796875
[rfa agg] iter:  4, weight: tensor([0.3514, 0.0031, 0.3355, 0.0583, 0.0087, 0.0115, 0.0960, 0.0491, 0.0374,
        0.0489])
[rfa agg] iter:  5, prev_obj_val: 73.19879150390625, obj_val: 75.7183837890625, abs dis: 2.51959228515625
[rfa agg] iter:  5, weight: tensor([0.4021, 0.0024, 0.3695, 0.0501, 0.0068, 0.0091, 0.0630, 0.0349, 0.0271,
        0.0348])
[rfa agg] iter:  6, prev_obj_val: 75.7183837890625, obj_val: 73.19054412841797, abs dis: 2.5278396606445312
[rfa agg] iter:  6, weight: tensor([0.3713, 0.0031, 0.3496, 0.0721, 0.0088, 0.0118, 0.0693, 0.0409, 0.0323,
        0.0408])
[rfa agg] iter:  7, prev_obj_val: 73.19054412841797, obj_val: 75.71894836425781, abs dis: 2.5284042358398438
[rfa agg] iter:  7, weight: tensor([0.4076, 0.0024, 0.3690, 0.0491, 0.0067, 0.0089, 0.0614, 0.0342, 0.0265,
        0.0341])
[rfa agg] iter:  8, prev_obj_val: 75.71894836425781, obj_val: 73.19048309326172, abs dis: 2.5284652709960938
[rfa agg] iter:  8, weight: tensor([0.3724, 0.0031, 0.3488, 0.0720, 0.0088, 0.0118, 0.0692, 0.0408, 0.0323,
        0.0407])
[rfa agg] iter:  9, prev_obj_val: 73.19048309326172, obj_val: 75.71896362304688, abs dis: 2.5284805297851562
[rfa agg] iter:  9, weight: tensor([0.4082, 0.0024, 0.3685, 0.0491, 0.0067, 0.0089, 0.0614, 0.0342, 0.0265,
        0.0341])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3073, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.2896, Accuracy: 0/9950 (0.0000%)
saving model
Done in 216.5775022506714 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0623, Accuracy: 261/776 (33.6340%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 382/803 (47.5716%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.4569, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0516, Accuracy: 360/891 (40.4040%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0182, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 443/1190 (37.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1241, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 361/1662 (21.7208%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 589/1662 (35.4392%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8581, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 317/1645 (19.2705%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 621/1645 (37.7508%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1261, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0744, Accuracy: 136/781 (17.4136%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 223/781 (28.5531%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3693, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0595, Accuracy: 256/590 (43.3898%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0333, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0433, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0565, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0178, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0559, Accuracy: 215/861 (24.9710%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 472/861 (54.8200%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.4436, Accuracy: 54/10000 (0.5400%)
time spent on training: 113.27189350128174
[rfa agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 58, 7, 84, 94, 13, 3, 69, 93, 10], weight: tensor([0.0709, 0.0734, 0.0814, 0.1088, 0.1519, 0.1504, 0.0714, 0.0539, 0.1592,
        0.0787])
[rfa agg] iter:  0, prev_obj_val: 58.3192253112793, obj_val: 60.23912811279297, abs dis: 1.9199028015136719
[rfa agg] iter:  0, weight: tensor([0.0850, 0.0879, 0.1272, 0.2221, 0.0818, 0.0808, 0.0850, 0.0373, 0.0703,
        0.1227])
[rfa agg] iter:  1, prev_obj_val: 60.23912811279297, obj_val: 70.61498260498047, abs dis: 10.3758544921875
[rfa agg] iter:  1, weight: tensor([0.1060, 0.1102, 0.1850, 0.1157, 0.0563, 0.0556, 0.1059, 0.0380, 0.0496,
        0.1776])
[rfa agg] iter:  2, prev_obj_val: 70.61498260498047, obj_val: 70.5394287109375, abs dis: 0.07555389404296875
[rfa agg] iter:  2, weight: tensor([0.1993, 0.2151, 0.1189, 0.0402, 0.0275, 0.0272, 0.1821, 0.0504, 0.0251,
        0.1142])
[rfa agg] iter:  3, prev_obj_val: 70.5394287109375, obj_val: 78.05098724365234, abs dis: 7.511558532714844
[rfa agg] iter:  3, weight: tensor([0.2045, 0.2251, 0.1114, 0.0382, 0.0261, 0.0259, 0.1894, 0.0484, 0.0239,
        0.1071])
[rfa agg] iter:  4, prev_obj_val: 78.05098724365234, obj_val: 67.33103942871094, abs dis: 10.719947814941406
[rfa agg] iter:  4, weight: tensor([0.1612, 0.1694, 0.1145, 0.0528, 0.0386, 0.0382, 0.1589, 0.1203, 0.0356,
        0.1104])
[rfa agg] iter:  5, prev_obj_val: 67.33103942871094, obj_val: 70.53974151611328, abs dis: 3.2087020874023438
[rfa agg] iter:  5, weight: tensor([0.2050, 0.2350, 0.1210, 0.0339, 0.0223, 0.0220, 0.1912, 0.0336, 0.0203,
        0.1156])
[rfa agg] iter:  6, prev_obj_val: 70.53974151611328, obj_val: 78.05110931396484, abs dis: 7.5113677978515625
[rfa agg] iter:  6, weight: tensor([0.2041, 0.2272, 0.1111, 0.0381, 0.0261, 0.0258, 0.1889, 0.0482, 0.0238,
        0.1067])
[rfa agg] iter:  7, prev_obj_val: 78.05110931396484, obj_val: 67.3310317993164, abs dis: 10.720077514648438
[rfa agg] iter:  7, weight: tensor([0.1611, 0.1694, 0.1145, 0.0528, 0.0386, 0.0382, 0.1589, 0.1203, 0.0356,
        0.1104])
[rfa agg] iter:  8, prev_obj_val: 67.3310317993164, obj_val: 70.53973388671875, abs dis: 3.2087020874023438
[rfa agg] iter:  8, weight: tensor([0.2050, 0.2350, 0.1210, 0.0339, 0.0223, 0.0220, 0.1912, 0.0336, 0.0203,
        0.1156])
[rfa agg] iter:  9, prev_obj_val: 70.53973388671875, obj_val: 78.05110931396484, abs dis: 7.511375427246094
[rfa agg] iter:  9, weight: tensor([0.2041, 0.2272, 0.1111, 0.0381, 0.0261, 0.0258, 0.1889, 0.0482, 0.0238,
        0.1067])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3268, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.64348483085632 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0591, Accuracy: 326/807 (40.3965%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0387, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0604, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6958, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 39/460 (8.4783%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5859, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 255/776 (32.8608%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5506, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0572, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0332, Accuracy: 604/1956 (30.8793%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.5956, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0681, Accuracy: 266/715 (37.2028%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1673, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0568, Accuracy: 329/1573 (20.9154%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 528/1573 (33.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8234, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0618, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 458/1049 (43.6606%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8005, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0890, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7757, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 245/888 (27.5901%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.7284, Accuracy: 73/10000 (0.7300%)
time spent on training: 111.57009863853455
[rfa agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 64, 31, 75, 6, 23, 40, 51, 12, 63], weight: tensor([0.0848, 0.1002, 0.0483, 0.0816, 0.2056, 0.0751, 0.1653, 0.1102, 0.0355,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 59.841861724853516, obj_val: 60.27731704711914, abs dis: 0.435455322265625
[rfa agg] iter:  0, weight: tensor([0.0809, 0.1993, 0.0194, 0.0778, 0.0486, 0.0563, 0.0663, 0.3183, 0.0115,
        0.1215])
[rfa agg] iter:  1, prev_obj_val: 60.27731704711914, obj_val: 67.11564636230469, abs dis: 6.838329315185547
[rfa agg] iter:  1, weight: tensor([0.1196, 0.2607, 0.0181, 0.1154, 0.0305, 0.0692, 0.0384, 0.1029, 0.0102,
        0.2351])
[rfa agg] iter:  2, prev_obj_val: 67.11564636230469, obj_val: 76.90576934814453, abs dis: 9.790122985839844
[rfa agg] iter:  2, weight: tensor([0.2201, 0.0941, 0.0257, 0.2130, 0.0270, 0.1793, 0.0321, 0.0580, 0.0131,
        0.1378])
[rfa agg] iter:  3, prev_obj_val: 76.90576934814453, obj_val: 73.36266326904297, abs dis: 3.5431060791015625
[rfa agg] iter:  3, weight: tensor([0.1572, 0.0964, 0.0610, 0.1511, 0.0403, 0.2310, 0.0462, 0.0709, 0.0272,
        0.1186])
[rfa agg] iter:  4, prev_obj_val: 73.36266326904297, obj_val: 70.0230484008789, abs dis: 3.3396148681640625
[rfa agg] iter:  4, weight: tensor([0.1630, 0.0900, 0.0435, 0.1566, 0.0340, 0.2745, 0.0394, 0.0634, 0.0204,
        0.1153])
[rfa agg] iter:  5, prev_obj_val: 70.0230484008789, obj_val: 76.89755249023438, abs dis: 6.874504089355469
[rfa agg] iter:  5, weight: tensor([0.1778, 0.0849, 0.0312, 0.1708, 0.0285, 0.2864, 0.0334, 0.0568, 0.0153,
        0.1148])
[rfa agg] iter:  6, prev_obj_val: 76.89755249023438, obj_val: 73.36180877685547, abs dis: 3.5357437133789062
[rfa agg] iter:  6, weight: tensor([0.1544, 0.0954, 0.0604, 0.1484, 0.0399, 0.2412, 0.0458, 0.0703, 0.0269,
        0.1172])
[rfa agg] iter:  7, prev_obj_val: 73.36180877685547, obj_val: 70.02301788330078, abs dis: 3.3387908935546875
[rfa agg] iter:  7, weight: tensor([0.1624, 0.0898, 0.0434, 0.1561, 0.0339, 0.2764, 0.0393, 0.0633, 0.0204,
        0.1150])
[rfa agg] iter:  8, prev_obj_val: 70.02301788330078, obj_val: 76.89759826660156, abs dis: 6.874580383300781
[rfa agg] iter:  8, weight: tensor([0.1776, 0.0849, 0.0312, 0.1706, 0.0285, 0.2870, 0.0334, 0.0567, 0.0153,
        0.1147])
[rfa agg] iter:  9, prev_obj_val: 76.89759826660156, obj_val: 73.36180114746094, abs dis: 3.535797119140625
[rfa agg] iter:  9, weight: tensor([0.1544, 0.0954, 0.0604, 0.1484, 0.0399, 0.2412, 0.0458, 0.0703, 0.0269,
        0.1172])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3664, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3923, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.82015657424927 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3819, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0808, Accuracy: 25/311 (8.0386%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0556, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5506, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0560, Accuracy: 327/1130 (28.9381%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 468/1130 (41.4159%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9372, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0577, Accuracy: 277/928 (29.8491%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 559/928 (60.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0096, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0612, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 503/1049 (47.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8777, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0578, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 408/807 (50.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5329, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0582, Accuracy: 398/1904 (20.9034%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 663/1904 (34.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8624, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0557, Accuracy: 372/1715 (21.6910%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 674/1715 (39.3003%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9501, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0593, Accuracy: 278/677 (41.0635%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.4084, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0735, Accuracy: 92/500 (18.4000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 184/500 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9815, Accuracy: 49/10000 (0.4900%)
time spent on training: 112.05126142501831
[rfa agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 96, 54, 1, 51, 20, 46, 92, 90, 82], weight: tensor([0.0093, 0.0342, 0.1241, 0.1019, 0.1152, 0.0886, 0.2091, 0.1883, 0.0743,
        0.0549])
[rfa agg] iter:  0, prev_obj_val: 62.43187713623047, obj_val: 64.49388122558594, abs dis: 2.0620040893554688
[rfa agg] iter:  0, weight: tensor([0.0019, 0.0085, 0.3379, 0.1188, 0.3045, 0.0605, 0.0523, 0.0619, 0.0357,
        0.0181])
[rfa agg] iter:  1, prev_obj_val: 64.49388122558594, obj_val: 67.19076538085938, abs dis: 2.6968841552734375
[rfa agg] iter:  1, weight: tensor([0.0022, 0.0102, 0.1901, 0.2378, 0.2896, 0.0932, 0.0493, 0.0564, 0.0486,
        0.0226])
[rfa agg] iter:  2, prev_obj_val: 67.19076538085938, obj_val: 70.97099304199219, abs dis: 3.7802276611328125
[rfa agg] iter:  2, weight: tensor([0.0022, 0.0108, 0.1253, 0.3852, 0.1704, 0.1288, 0.0444, 0.0499, 0.0582,
        0.0248])
[rfa agg] iter:  3, prev_obj_val: 70.97099304199219, obj_val: 73.10624694824219, abs dis: 2.13525390625
[rfa agg] iter:  3, weight: tensor([0.0027, 0.0132, 0.1061, 0.3004, 0.1298, 0.2337, 0.0462, 0.0511, 0.0848,
        0.0320])
[rfa agg] iter:  4, prev_obj_val: 73.10624694824219, obj_val: 75.41392517089844, abs dis: 2.30767822265625
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0139, 0.0941, 0.2128, 0.1114, 0.3374, 0.0443, 0.0488, 0.0999,
        0.0346])
[rfa agg] iter:  5, prev_obj_val: 75.41392517089844, obj_val: 75.3899154663086, abs dis: 0.02400970458984375
[rfa agg] iter:  5, weight: tensor([0.0026, 0.0135, 0.0782, 0.1508, 0.0902, 0.4345, 0.0395, 0.0432, 0.1125,
        0.0348])
[rfa agg] iter:  6, prev_obj_val: 75.3899154663086, obj_val: 75.38582611083984, abs dis: 0.00408935546875
[rfa agg] iter:  6, weight: tensor([0.0024, 0.0125, 0.0724, 0.1377, 0.0835, 0.4780, 0.0367, 0.0401, 0.1043,
        0.0323])
[rfa agg] iter:  7, prev_obj_val: 75.38582611083984, obj_val: 78.04488372802734, abs dis: 2.6590576171875
[rfa agg] iter:  7, weight: tensor([0.0024, 0.0121, 0.0697, 0.1319, 0.0803, 0.4986, 0.0353, 0.0386, 0.1001,
        0.0311])
[rfa agg] iter:  8, prev_obj_val: 78.04488372802734, obj_val: 78.03536224365234, abs dis: 0.009521484375
[rfa agg] iter:  8, weight: tensor([0.0029, 0.0150, 0.0742, 0.1274, 0.0838, 0.4249, 0.0400, 0.0435, 0.1481,
        0.0401])
[rfa agg] iter:  9, prev_obj_val: 78.03536224365234, obj_val: 80.87410736083984, abs dis: 2.8387451171875
[rfa agg] iter:  9, weight: tensor([0.0029, 0.0154, 0.0762, 0.1310, 0.0861, 0.4070, 0.0411, 0.0446, 0.1545,
        0.0413])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4549, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.8506, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.1150782108307 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0617, Accuracy: 273/719 (37.9694%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0331, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2543, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0648, Accuracy: 281/1190 (23.6134%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 416/1190 (34.9580%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8079, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0566, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 683/1742 (39.2078%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8992, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 596/1662 (35.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0092, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 265/1071 (24.7432%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 526/1071 (49.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.8267, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0550, Accuracy: 444/1988 (22.3340%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9652, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0585, Accuracy: 259/636 (40.7233%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0329, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0585, Accuracy: 171/735 (23.2653%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 380/735 (51.7007%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.2065, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0596, Accuracy: 289/946 (30.5497%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.5220, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0529, Accuracy: 290/599 (48.4140%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.4652, Accuracy: 50/10000 (0.5000%)
time spent on training: 119.15935397148132
[rfa agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 84, 93, 94, 55, 85, 52, 32, 43, 95], weight: tensor([0.0637, 0.1054, 0.1543, 0.1472, 0.0949, 0.1761, 0.0563, 0.0651, 0.0838,
        0.0531])
[rfa agg] iter:  0, prev_obj_val: 65.2245101928711, obj_val: 68.32615661621094, abs dis: 3.1016464233398438
[rfa agg] iter:  0, weight: tensor([0.0373, 0.3962, 0.0798, 0.0989, 0.1560, 0.0622, 0.0262, 0.0382, 0.0806,
        0.0247])
[rfa agg] iter:  1, prev_obj_val: 68.32615661621094, obj_val: 71.01551818847656, abs dis: 2.689361572265625
[rfa agg] iter:  1, weight: tensor([0.0473, 0.1879, 0.0528, 0.0614, 0.3585, 0.0443, 0.0302, 0.0484, 0.1409,
        0.0284])
[rfa agg] iter:  2, prev_obj_val: 71.01551818847656, obj_val: 78.76248168945312, abs dis: 7.7469635009765625
[rfa agg] iter:  2, weight: tensor([0.0600, 0.1299, 0.0498, 0.0568, 0.2977, 0.0427, 0.0361, 0.0616, 0.2315,
        0.0339])
[rfa agg] iter:  3, prev_obj_val: 78.76248168945312, obj_val: 78.71611785888672, abs dis: 0.04636383056640625
[rfa agg] iter:  3, weight: tensor([0.1229, 0.0891, 0.0474, 0.0526, 0.1318, 0.0421, 0.0591, 0.1276, 0.2717,
        0.0557])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5753, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.4351, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.09075474739075 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 309/1130 (27.3451%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4666, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0510, Accuracy: 596/2227 (26.7625%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4234, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0563, Accuracy: 172/735 (23.4014%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.2337, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 282/715 (39.4406%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0419, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.0665, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 241/590 (40.8475%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.1006, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0577, Accuracy: 250/636 (39.3082%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4407, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0993, Accuracy: 9/197 (4.5685%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0829, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0557, Accuracy: 399/1953 (20.4301%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 750/1953 (38.4025%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8049, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0514, Accuracy: 345/1275 (27.0588%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 656/1275 (51.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.8045, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0614, Accuracy: 267/677 (39.4387%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.6265, Accuracy: 52/10000 (0.5200%)
time spent on training: 117.60169219970703
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 60, 32, 23, 69, 52, 79, 83, 9, 90], weight: tensor([0.1115, 0.2197, 0.0725, 0.0705, 0.0582, 0.0628, 0.0194, 0.1927, 0.1258,
        0.0668])
[rfa agg] iter:  0, prev_obj_val: 81.67594909667969, obj_val: 86.0781478881836, abs dis: 4.402198791503906
[rfa agg] iter:  0, weight: tensor([0.2172, 0.0651, 0.0402, 0.0391, 0.0259, 0.0279, 0.0054, 0.0777, 0.4686,
        0.0330])
[rfa agg] iter:  1, prev_obj_val: 86.0781478881836, obj_val: 87.23051452636719, abs dis: 1.1523666381835938
[rfa agg] iter:  1, weight: tensor([0.3275, 0.0647, 0.0859, 0.0834, 0.0483, 0.0521, 0.0084, 0.0723, 0.1922,
        0.0653])
[rfa agg] iter:  2, prev_obj_val: 87.23051452636719, obj_val: 88.53726959228516, abs dis: 1.3067550659179688
[rfa agg] iter:  2, weight: tensor([0.2930, 0.0656, 0.1008, 0.0980, 0.0546, 0.0588, 0.0091, 0.0728, 0.1724,
        0.0749])
[rfa agg] iter:  3, prev_obj_val: 88.53726959228516, obj_val: 91.2076187133789, abs dis: 2.67034912109375
[rfa agg] iter:  3, weight: tensor([0.2472, 0.0659, 0.1180, 0.1147, 0.0613, 0.0660, 0.0097, 0.0726, 0.1590,
        0.0855])
[rfa agg] iter:  4, prev_obj_val: 91.2076187133789, obj_val: 91.19837951660156, abs dis: 0.00923919677734375
[rfa agg] iter:  4, weight: tensor([0.1745, 0.0605, 0.1559, 0.1514, 0.0720, 0.0775, 0.0103, 0.0659, 0.1268,
        0.1052])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6805, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 4.9083, Accuracy: 0/9950 (0.0000%)
saving model
Done in 213.9688422679901 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0596, Accuracy: 208/953 (21.8258%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 297/953 (31.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.1095, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0647, Accuracy: 261/715 (36.5035%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0607, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0849, Accuracy: 9/338 (2.6627%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0471, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0603, Accuracy: 361/1657 (21.7864%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0358, Accuracy: 480/1657 (28.9680%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8464, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 316/803 (39.3524%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0333, Accuracy: 427/803 (53.1756%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5789, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0600, Accuracy: 339/1581 (21.4421%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0347, Accuracy: 549/1581 (34.7249%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9423, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0767, Accuracy: 133/669 (19.8804%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5985, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 262/708 (37.0056%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0425, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3597, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0561, Accuracy: 283/712 (39.7472%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 418/712 (58.7079%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0411, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0706, Accuracy: 126/568 (22.1831%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0421, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4682, Accuracy: 56/10000 (0.5600%)
time spent on training: 114.74712133407593
[rfa agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 23, 12, 0, 58, 28, 45, 16, 11, 62], weight: tensor([0.1095, 0.0821, 0.0388, 0.1904, 0.0923, 0.1816, 0.0769, 0.0813, 0.0818,
        0.0653])
[rfa agg] iter:  0, prev_obj_val: 53.80056381225586, obj_val: 58.2631950378418, abs dis: 4.4626312255859375
[rfa agg] iter:  0, weight: tensor([0.2367, 0.1106, 0.0145, 0.0478, 0.2033, 0.0498, 0.0735, 0.1121, 0.1128,
        0.0389])
[rfa agg] iter:  1, prev_obj_val: 58.2631950378418, obj_val: 63.9424934387207, abs dis: 5.679298400878906
[rfa agg] iter:  1, weight: tensor([0.0672, 0.1662, 0.0151, 0.0289, 0.1194, 0.0296, 0.1540, 0.1862, 0.1787,
        0.0547])
[rfa agg] iter:  2, prev_obj_val: 63.9424934387207, obj_val: 67.2424545288086, abs dis: 3.2999610900878906
[rfa agg] iter:  2, weight: tensor([0.0684, 0.1360, 0.0239, 0.0353, 0.1004, 0.0359, 0.2122, 0.1404, 0.1373,
        0.1102])
[rfa agg] iter:  3, prev_obj_val: 67.2424545288086, obj_val: 67.23736572265625, abs dis: 0.00508880615234375
[rfa agg] iter:  3, weight: tensor([0.0698, 0.1213, 0.0301, 0.0385, 0.0954, 0.0392, 0.1920, 0.1227, 0.1218,
        0.1694])
[rfa agg] iter:  4, prev_obj_val: 67.23736572265625, obj_val: 70.7019271850586, abs dis: 3.4645614624023438
[rfa agg] iter:  4, weight: tensor([0.0696, 0.1206, 0.0301, 0.0384, 0.0950, 0.0390, 0.1906, 0.1219, 0.1213,
        0.1735])
[rfa agg] iter:  5, prev_obj_val: 70.7019271850586, obj_val: 67.24603271484375, abs dis: 3.4558944702148438
[rfa agg] iter:  5, weight: tensor([0.0670, 0.1053, 0.0358, 0.0393, 0.0870, 0.0399, 0.1528, 0.1057, 0.1056,
        0.2615])
[rfa agg] iter:  6, prev_obj_val: 67.24603271484375, obj_val: 70.70075225830078, abs dis: 3.4547195434570312
[rfa agg] iter:  6, weight: tensor([0.0695, 0.1198, 0.0301, 0.0383, 0.0946, 0.0390, 0.1872, 0.1210, 0.1208,
        0.1798])
[rfa agg] iter:  7, prev_obj_val: 70.70075225830078, obj_val: 67.24620056152344, abs dis: 3.4545516967773438
[rfa agg] iter:  7, weight: tensor([0.0670, 0.1052, 0.0358, 0.0393, 0.0869, 0.0399, 0.1525, 0.1056, 0.1054,
        0.2625])
[rfa agg] iter:  8, prev_obj_val: 67.24620056152344, obj_val: 70.70073699951172, abs dis: 3.4545364379882812
[rfa agg] iter:  8, weight: tensor([0.0695, 0.1198, 0.0301, 0.0383, 0.0946, 0.0390, 0.1872, 0.1210, 0.1208,
        0.1798])
[rfa agg] iter:  9, prev_obj_val: 70.70073699951172, obj_val: 67.24620056152344, abs dis: 3.4545364379882812
[rfa agg] iter:  9, weight: tensor([0.0670, 0.1052, 0.0358, 0.0393, 0.0869, 0.0399, 0.1525, 0.1056, 0.1054,
        0.2626])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9816, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3069, Accuracy: 0/9950 (0.0000%)
saving model
Done in 213.88817071914673 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0537, Accuracy: 365/1129 (32.3295%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 748/1129 (66.2533%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.0051, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0679, Accuracy: 249/1190 (20.9244%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 425/1190 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9488, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0507, Accuracy: 596/2227 (26.7625%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 1012/2227 (45.4423%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5436, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0835, Accuracy: 11/338 (3.2544%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0452, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3959, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0587, Accuracy: 290/1131 (25.6410%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0325, Accuracy: 396/1131 (35.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2704, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 150/373 (40.2145%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3964, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0633, Accuracy: 182/1049 (17.3499%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 531/1049 (50.6196%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2280, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0873, Accuracy: 21/466 (4.5064%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.5983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0927, Accuracy: 23/408 (5.6373%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0572, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4634, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0534, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 688/1715 (40.1166%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.4142, Accuracy: 85/10000 (0.8500%)
time spent on training: 119.62637758255005
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 84, 60, 12, 87, 98, 51, 76, 36, 92], weight: tensor([0.1126, 0.1187, 0.2221, 0.0337, 0.1128, 0.0372, 0.1046, 0.0465, 0.0407,
        0.1711])
[rfa agg] iter:  0, prev_obj_val: 68.79576873779297, obj_val: 69.38009643554688, abs dis: 0.5843276977539062
[rfa agg] iter:  0, weight: tensor([0.2040, 0.2947, 0.0506, 0.0088, 0.1970, 0.0097, 0.1304, 0.0142, 0.0115,
        0.0793])
[rfa agg] iter:  1, prev_obj_val: 69.38009643554688, obj_val: 72.69294738769531, abs dis: 3.3128509521484375
[rfa agg] iter:  1, weight: tensor([0.2668, 0.2165, 0.0343, 0.0073, 0.2321, 0.0081, 0.1638, 0.0121, 0.0097,
        0.0493])
[rfa agg] iter:  2, prev_obj_val: 72.69294738769531, obj_val: 77.6073226928711, abs dis: 4.914375305175781
[rfa agg] iter:  2, weight: tensor([0.2398, 0.1576, 0.0378, 0.0093, 0.2190, 0.0103, 0.2463, 0.0157, 0.0124,
        0.0519])
[rfa agg] iter:  3, prev_obj_val: 77.6073226928711, obj_val: 72.65323638916016, abs dis: 4.9540863037109375
[rfa agg] iter:  3, weight: tensor([0.2009, 0.1482, 0.0474, 0.0135, 0.1949, 0.0149, 0.2764, 0.0233, 0.0181,
        0.0625])
[rfa agg] iter:  4, prev_obj_val: 72.65323638916016, obj_val: 74.98269653320312, abs dis: 2.3294601440429688
[rfa agg] iter:  4, weight: tensor([0.2226, 0.1501, 0.0369, 0.0091, 0.2099, 0.0100, 0.2831, 0.0153, 0.0121,
        0.0507])
[rfa agg] iter:  5, prev_obj_val: 74.98269653320312, obj_val: 74.98072814941406, abs dis: 0.0019683837890625
[rfa agg] iter:  5, weight: tensor([0.2071, 0.1456, 0.0412, 0.0109, 0.1986, 0.0120, 0.2958, 0.0186, 0.0146,
        0.0554])
[rfa agg] iter:  6, prev_obj_val: 74.98072814941406, obj_val: 74.98063659667969, abs dis: 9.1552734375e-05
[rfa agg] iter:  6, weight: tensor([0.2050, 0.1449, 0.0411, 0.0109, 0.1971, 0.0120, 0.3006, 0.0185, 0.0145,
        0.0553])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3019, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 6.0350, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.29995703697205 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0657, Accuracy: 118/818 (14.4254%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 362/818 (44.2543%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1753, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0606, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 366/1013 (36.1303%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5404, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0598, Accuracy: 256/1071 (23.9029%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.7895, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0632, Accuracy: 287/946 (30.3383%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 330/946 (34.8837%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6191, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0785, Accuracy: 103/603 (17.0813%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0479, Accuracy: 277/603 (45.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.8258, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0771, Accuracy: 63/486 (12.9630%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0392, Accuracy: 218/486 (44.8560%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6855, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0754, Accuracy: 9/186 (4.8387%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0596, Accuracy: 82/186 (44.0860%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0882, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0607, Accuracy: 128/311 (41.1576%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0640, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 149/373 (39.9464%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5405, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0536, Accuracy: 382/1628 (23.4644%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 829/1628 (50.9214%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.5838, Accuracy: 144/10000 (1.4400%)
time spent on training: 112.90388917922974
[rfa agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 14, 55, 43, 88, 30, 56, 96, 98, 5], weight: tensor([0.1100, 0.1362, 0.1440, 0.1272, 0.0811, 0.0654, 0.0250, 0.0418, 0.0502,
        0.2190])
[rfa agg] iter:  0, prev_obj_val: 52.15885925292969, obj_val: 57.65066146850586, abs dis: 5.491802215576172
[rfa agg] iter:  0, weight: tensor([0.3398, 0.1393, 0.1120, 0.1826, 0.0842, 0.0413, 0.0078, 0.0164, 0.0226,
        0.0540])
[rfa agg] iter:  1, prev_obj_val: 57.65066146850586, obj_val: 57.61726379394531, abs dis: 0.033397674560546875
[rfa agg] iter:  1, weight: tensor([0.2580, 0.1170, 0.1012, 0.1383, 0.1850, 0.0709, 0.0110, 0.0244, 0.0348,
        0.0593])
[rfa agg] iter:  2, prev_obj_val: 57.61726379394531, obj_val: 57.61713409423828, abs dis: 0.00012969970703125
[rfa agg] iter:  2, weight: tensor([0.2509, 0.1167, 0.1012, 0.1378, 0.1923, 0.0714, 0.0110, 0.0245, 0.0350,
        0.0592])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.2884, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 7.6241, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.76048755645752 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0842, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0440, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7000, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0875, Accuracy: 21/416 (5.0481%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7060, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0472, Accuracy: 392/1440 (27.2222%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 680/1440 (47.2222%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.5457, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 389/1628 (23.8943%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0248, Accuracy: 863/1628 (53.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9992, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0535, Accuracy: 431/1715 (25.1312%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9686, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 280/712 (39.3258%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 385/712 (54.0730%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8923, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0597, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 371/1131 (32.8028%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.6886, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0615, Accuracy: 175/861 (20.3252%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 433/861 (50.2904%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 10.1940, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0561, Accuracy: 301/1446 (20.8160%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 498/1446 (34.4398%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8400, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0597, Accuracy: 316/1645 (19.2097%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 616/1645 (37.4468%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8369, Accuracy: 113/10000 (1.1300%)
time spent on training: 126.6693787574768
[rfa agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 78, 29, 5, 92, 11, 87, 10, 26, 13], weight: tensor([0.0276, 0.0368, 0.1274, 0.1440, 0.1517, 0.0630, 0.1000, 0.0762, 0.1279,
        0.1455])
[rfa agg] iter:  0, prev_obj_val: 55.46290969848633, obj_val: 61.529518127441406, abs dis: 6.066608428955078
[rfa agg] iter:  0, weight: tensor([0.0091, 0.0142, 0.1424, 0.0938, 0.0870, 0.0415, 0.3046, 0.0695, 0.1422,
        0.0956])
[rfa agg] iter:  1, prev_obj_val: 61.529518127441406, obj_val: 61.48906707763672, abs dis: 0.0404510498046875
[rfa agg] iter:  1, weight: tensor([0.0095, 0.0151, 0.0984, 0.0723, 0.0684, 0.0487, 0.4254, 0.0901, 0.0985,
        0.0736])
[rfa agg] iter:  2, prev_obj_val: 61.48906707763672, obj_val: 59.18241882324219, abs dis: 2.3066482543945312
[rfa agg] iter:  2, weight: tensor([0.0089, 0.0141, 0.0921, 0.0677, 0.0640, 0.0457, 0.4619, 0.0846, 0.0920,
        0.0690])
[rfa agg] iter:  3, prev_obj_val: 59.18241882324219, obj_val: 59.172176361083984, abs dis: 0.010242462158203125
[rfa agg] iter:  3, weight: tensor([0.0074, 0.0117, 0.0875, 0.0623, 0.0586, 0.0365, 0.5200, 0.0650, 0.0874,
        0.0636])
[rfa agg] iter:  4, prev_obj_val: 59.172176361083984, obj_val: 64.01380920410156, abs dis: 4.841632843017578
[rfa agg] iter:  4, weight: tensor([0.0070, 0.0111, 0.0824, 0.0588, 0.0552, 0.0344, 0.5478, 0.0611, 0.0823,
        0.0600])
[rfa agg] iter:  5, prev_obj_val: 64.01380920410156, obj_val: 61.49321365356445, abs dis: 2.5205955505371094
[rfa agg] iter:  5, weight: tensor([0.0105, 0.0168, 0.0957, 0.0725, 0.0689, 0.0565, 0.4006, 0.1090, 0.0958,
        0.0738])
[rfa agg] iter:  6, prev_obj_val: 61.49321365356445, obj_val: 59.18402862548828, abs dis: 2.309185028076172
[rfa agg] iter:  6, weight: tensor([0.0090, 0.0143, 0.0932, 0.0685, 0.0648, 0.0463, 0.4551, 0.0858, 0.0932,
        0.0698])
[rfa agg] iter:  7, prev_obj_val: 59.18402862548828, obj_val: 59.17256164550781, abs dis: 0.01146697998046875
[rfa agg] iter:  7, weight: tensor([0.0075, 0.0118, 0.0881, 0.0628, 0.0590, 0.0368, 0.5168, 0.0654, 0.0880,
        0.0640])
[rfa agg] iter:  8, prev_obj_val: 59.17256164550781, obj_val: 64.01307678222656, abs dis: 4.84051513671875
[rfa agg] iter:  8, weight: tensor([0.0070, 0.0111, 0.0827, 0.0590, 0.0554, 0.0345, 0.5461, 0.0613, 0.0826,
        0.0602])
[rfa agg] iter:  9, prev_obj_val: 64.01307678222656, obj_val: 61.493255615234375, abs dis: 2.5198211669921875
[rfa agg] iter:  9, weight: tensor([0.0105, 0.0168, 0.0958, 0.0725, 0.0689, 0.0565, 0.4004, 0.1090, 0.0958,
        0.0739])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4760, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 9.5560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.9135239124298 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0898, Accuracy: 11/408 (2.6961%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1457, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0817, Accuracy: 72/682 (10.5572%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0408, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0435, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0577, Accuracy: 386/1742 (22.1584%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 679/1742 (38.9782%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6227, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0841, Accuracy: 39/460 (8.4783%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0404, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6641, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0846, Accuracy: 17/515 (3.3010%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1071, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0685, Accuracy: 306/1003 (30.5085%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7711, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0667, Accuracy: 128/568 (22.5352%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1705, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 10/373 (2.6810%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7412, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0559, Accuracy: 361/1949 (18.5223%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 584/1949 (29.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.7650, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 335/1645 (20.3647%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 590/1645 (35.8663%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3740, Accuracy: 125/10000 (1.2500%)
time spent on training: 121.66848874092102
[rfa agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 80, 93, 31, 33, 86, 62, 98, 21, 13], weight: tensor([0.0437, 0.0730, 0.1864, 0.0492, 0.0551, 0.1073, 0.0608, 0.0399, 0.2086,
        0.1760])
[rfa agg] iter:  0, prev_obj_val: 83.48223114013672, obj_val: 85.5824203491211, abs dis: 2.100189208984375
[rfa agg] iter:  0, weight: tensor([0.0286, 0.0750, 0.1335, 0.0355, 0.0441, 0.3389, 0.0487, 0.0239, 0.1158,
        0.1561])
[rfa agg] iter:  1, prev_obj_val: 85.5824203491211, obj_val: 89.19755554199219, abs dis: 3.6151351928710938
[rfa agg] iter:  1, weight: tensor([0.0228, 0.0655, 0.0804, 0.0288, 0.0364, 0.5439, 0.0402, 0.0188, 0.0718,
        0.0913])
[rfa agg] iter:  2, prev_obj_val: 89.19755554199219, obj_val: 90.73827362060547, abs dis: 1.5407180786132812
[rfa agg] iter:  2, weight: tensor([0.0284, 0.0934, 0.0751, 0.0366, 0.0475, 0.4912, 0.0527, 0.0230, 0.0687,
        0.0834])
[rfa agg] iter:  3, prev_obj_val: 90.73827362060547, obj_val: 92.29259490966797, abs dis: 1.5543212890625
[rfa agg] iter:  3, weight: tensor([0.0345, 0.1213, 0.0826, 0.0449, 0.0591, 0.3972, 0.0655, 0.0278, 0.0760,
        0.0911])
[rfa agg] iter:  4, prev_obj_val: 92.29259490966797, obj_val: 93.86587524414062, abs dis: 1.5732803344726562
[rfa agg] iter:  4, weight: tensor([0.0395, 0.1503, 0.0851, 0.0520, 0.0692, 0.3234, 0.0769, 0.0315, 0.0788,
        0.0934])
[rfa agg] iter:  5, prev_obj_val: 93.86587524414062, obj_val: 97.0737533569336, abs dis: 3.2078781127929688
[rfa agg] iter:  5, weight: tensor([0.0432, 0.1815, 0.0836, 0.0576, 0.0780, 0.2663, 0.0867, 0.0341, 0.0778,
        0.0913])
[rfa agg] iter:  6, prev_obj_val: 97.0737533569336, obj_val: 97.05751037597656, abs dis: 0.01624298095703125
[rfa agg] iter:  6, weight: tensor([0.0469, 0.2615, 0.0723, 0.0645, 0.0912, 0.1794, 0.1019, 0.0362, 0.0680,
        0.0782])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.3887, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 8.2611, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.18295907974243 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0991, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0646, Accuracy: 95/271 (35.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4323, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0581, Accuracy: 265/776 (34.1495%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 428/776 (55.1546%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2089, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0593, Accuracy: 286/1418 (20.1693%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3482, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0595, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 355/1013 (35.0444%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0168, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0602, Accuracy: 214/1071 (19.9813%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 512/1071 (47.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.0655, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0609, Accuracy: 333/1956 (17.0245%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 606/1956 (30.9816%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7937, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0735, Accuracy: 213/708 (30.0847%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0332, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.3547, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0749, Accuracy: 102/809 (12.6082%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 340/809 (42.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4679, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0579, Accuracy: 402/1904 (21.1134%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0307, Accuracy: 733/1904 (38.4979%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3522, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0647, Accuracy: 286/715 (40.0000%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0400, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1065, Accuracy: 50/10000 (0.5000%)
time spent on training: 127.93795394897461
[rfa agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 75, 70, 14, 55, 6, 16, 50, 46, 23], weight: tensor([0.0255, 0.0729, 0.1333, 0.0952, 0.1006, 0.1838, 0.0665, 0.0760, 0.1789,
        0.0672])
[rfa agg] iter:  0, prev_obj_val: 67.44398498535156, obj_val: 69.86376190185547, abs dis: 2.4197769165039062
[rfa agg] iter:  0, weight: tensor([0.0096, 0.0672, 0.1457, 0.1798, 0.2670, 0.0757, 0.0522, 0.0703, 0.0800,
        0.0524])
[rfa agg] iter:  1, prev_obj_val: 69.86376190185547, obj_val: 72.7381362915039, abs dis: 2.8743743896484375
[rfa agg] iter:  1, weight: tensor([0.0080, 0.0801, 0.0656, 0.3121, 0.2508, 0.0429, 0.0563, 0.0835, 0.0447,
        0.0560])
[rfa agg] iter:  2, prev_obj_val: 72.7381362915039, obj_val: 78.31127166748047, abs dis: 5.5731353759765625
[rfa agg] iter:  2, weight: tensor([0.0094, 0.1203, 0.0620, 0.2683, 0.1697, 0.0434, 0.0788, 0.1255, 0.0450,
        0.0776])
[rfa agg] iter:  3, prev_obj_val: 78.31127166748047, obj_val: 80.51502990722656, abs dis: 2.2037582397460938
[rfa agg] iter:  3, weight: tensor([0.0097, 0.2077, 0.0464, 0.1195, 0.0918, 0.0351, 0.1207, 0.2192, 0.0362,
        0.1138])
[rfa agg] iter:  4, prev_obj_val: 80.51502990722656, obj_val: 90.12574768066406, abs dis: 9.6107177734375
[rfa agg] iter:  4, weight: tensor([0.0090, 0.2288, 0.0386, 0.0870, 0.0707, 0.0298, 0.1349, 0.2462, 0.0307,
        0.1242])
[rfa agg] iter:  5, prev_obj_val: 90.12574768066406, obj_val: 80.55068969726562, abs dis: 9.575057983398438
[rfa agg] iter:  5, weight: tensor([0.0140, 0.1560, 0.0431, 0.0768, 0.0671, 0.0353, 0.2160, 0.1644, 0.0362,
        0.1911])
[rfa agg] iter:  6, prev_obj_val: 80.55068969726562, obj_val: 86.5035629272461, abs dis: 5.952873229980469
[rfa agg] iter:  6, weight: tensor([0.0093, 0.2157, 0.0395, 0.0887, 0.0722, 0.0305, 0.1463, 0.2319, 0.0315,
        0.1346])
[rfa agg] iter:  7, prev_obj_val: 86.5035629272461, obj_val: 86.47872161865234, abs dis: 0.02484130859375
[rfa agg] iter:  7, weight: tensor([0.0113, 0.1733, 0.0389, 0.0741, 0.0634, 0.0313, 0.2106, 0.1840, 0.0321,
        0.1810])
[rfa agg] iter:  8, prev_obj_val: 86.47872161865234, obj_val: 86.47770690917969, abs dis: 0.00101470947265625
[rfa agg] iter:  8, weight: tensor([0.0111, 0.1649, 0.0382, 0.0727, 0.0623, 0.0307, 0.2250, 0.1747, 0.0316,
        0.1889])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.6181, Accuracy: 68/10000 (0.6800%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 8.1586, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.9138946533203 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0584, Accuracy: 240/590 (40.6780%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.6646, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0623, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3191, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0596, Accuracy: 354/1475 (24.0000%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 599/1475 (40.6102%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0809, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1296, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1200, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.3800, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0830, Accuracy: 38/515 (7.3786%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5007, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0591, Accuracy: 309/1418 (21.7913%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 625/1418 (44.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3276, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0739, Accuracy: 91/500 (18.2000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1657, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0504, Accuracy: 598/2227 (26.8523%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 979/2227 (43.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7214, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0563, Accuracy: 420/1953 (21.5054%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 762/1953 (39.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0936, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0795, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2881, Accuracy: 50/10000 (0.5000%)
time spent on training: 127.16904735565186
[rfa agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 64, 65, 61, 33, 70, 82, 60, 83, 98], weight: tensor([0.0585, 0.0945, 0.1462, 0.0084, 0.0510, 0.1405, 0.0496, 0.2207, 0.1936,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 80.14913177490234, obj_val: 81.52620697021484, abs dis: 1.3770751953125
[rfa agg] iter:  0, weight: tensor([0.0279, 0.0792, 0.2680, 0.0023, 0.0224, 0.3656, 0.0202, 0.0899, 0.1114,
        0.0131])
[rfa agg] iter:  1, prev_obj_val: 81.52620697021484, obj_val: 81.52529907226562, abs dis: 0.00090789794921875
[rfa agg] iter:  1, weight: tensor([0.0309, 0.0902, 0.2556, 0.0025, 0.0247, 0.3560, 0.0222, 0.0917, 0.1119,
        0.0143])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.3924, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 8.2214, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.47881627082825 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0555, Accuracy: 253/590 (42.8814%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.2210, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0664, Accuracy: 129/568 (22.7113%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2841, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0568, Accuracy: 384/1953 (19.6621%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 765/1953 (39.1705%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8990, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0855, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0487, Accuracy: 164/416 (39.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0013, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0630, Accuracy: 251/690 (36.3768%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0312, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8333, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0662, Accuracy: 256/719 (35.6050%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0359, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7016, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0729, Accuracy: 108/530 (20.3774%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5104, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0586, Accuracy: 370/1475 (25.0847%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 613/1475 (41.5593%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9019, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0640, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 445/1131 (39.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1739, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 319/1662 (19.1937%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 596/1662 (35.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.6073, Accuracy: 112/10000 (1.1200%)
time spent on training: 126.91728210449219
[rfa agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 62, 83, 78, 25, 41, 18, 65, 38, 94], weight: tensor([0.0606, 0.0584, 0.2006, 0.0427, 0.0709, 0.0739, 0.0544, 0.1515, 0.1162,
        0.1707])
[rfa agg] iter:  0, prev_obj_val: 72.938720703125, obj_val: 75.99984741210938, abs dis: 3.061126708984375
[rfa agg] iter:  0, weight: tensor([0.0444, 0.0378, 0.0821, 0.0224, 0.0598, 0.0724, 0.0352, 0.1261, 0.4098,
        0.1101])
[rfa agg] iter:  1, prev_obj_val: 75.99984741210938, obj_val: 78.41482543945312, abs dis: 2.41497802734375
[rfa agg] iter:  1, weight: tensor([0.0609, 0.0505, 0.0819, 0.0288, 0.0853, 0.1064, 0.0471, 0.1145, 0.3207,
        0.1039])
[rfa agg] iter:  2, prev_obj_val: 78.41482543945312, obj_val: 78.39376831054688, abs dis: 0.02105712890625
[rfa agg] iter:  2, weight: tensor([0.0760, 0.0613, 0.0801, 0.0337, 0.1104, 0.1437, 0.0572, 0.1065, 0.2325,
        0.0988])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.9799, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 6.8293, Accuracy: 1/9950 (0.0101%)
saving model
Done in 221.4541997909546 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 282/715 (39.4406%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0564, Accuracy: 344/1949 (17.6501%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 579/1949 (29.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.5783, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 351/1418 (24.7532%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 639/1418 (45.0635%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4292, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 377/1475 (25.5593%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 603/1475 (40.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0347, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1037, Accuracy: 4/197 (2.0305%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0821, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1754, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0247, Accuracy: 836/1628 (51.3514%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.5148, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 201/888 (22.6351%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 405/888 (45.6081%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.5098, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0568, Accuracy: 255/599 (42.5710%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.4905, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0592, Accuracy: 327/803 (40.7223%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 368/803 (45.8281%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9892, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0561, Accuracy: 174/735 (23.6735%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0211, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.2346, Accuracy: 68/10000 (0.6800%)
time spent on training: 131.87478828430176
[rfa agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 21, 70, 65, 79, 5, 63, 95, 58, 32], weight: tensor([0.0687, 0.1873, 0.1363, 0.1417, 0.0189, 0.1564, 0.0853, 0.0576, 0.0772,
        0.0706])
[rfa agg] iter:  0, prev_obj_val: 66.44682312011719, obj_val: 67.45703125, abs dis: 1.0102081298828125
[rfa agg] iter:  0, weight: tensor([0.0632, 0.1013, 0.2094, 0.1773, 0.0081, 0.1424, 0.1089, 0.0414, 0.0828,
        0.0652])
[rfa agg] iter:  1, prev_obj_val: 67.45703125, obj_val: 69.58763122558594, abs dis: 2.1305999755859375
[rfa agg] iter:  1, weight: tensor([0.0690, 0.0987, 0.1932, 0.1656, 0.0085, 0.1356, 0.1223, 0.0444, 0.0915,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 69.58763122558594, obj_val: 70.66572570800781, abs dis: 1.078094482421875
[rfa agg] iter:  2, weight: tensor([0.0808, 0.0913, 0.1597, 0.1410, 0.0091, 0.1199, 0.1542, 0.0500, 0.1107,
        0.0834])
[rfa agg] iter:  3, prev_obj_val: 70.66572570800781, obj_val: 70.6636962890625, abs dis: 0.0020294189453125
[rfa agg] iter:  3, weight: tensor([0.0864, 0.0859, 0.1432, 0.1281, 0.0092, 0.1106, 0.1739, 0.0522, 0.1211,
        0.0893])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.1860, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 6.4424, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.350102186203 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0989, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0638, Accuracy: 86/271 (31.7343%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4754, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0586, Accuracy: 331/1581 (20.9361%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0349, Accuracy: 520/1581 (32.8906%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0519, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0548, Accuracy: 366/1587 (23.0624%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 603/1587 (37.9962%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2084, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0859, Accuracy: 56/682 (8.2111%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0400, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3249, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0585, Accuracy: 294/1130 (26.0177%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0298, Accuracy: 443/1130 (39.2035%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.9846, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0644, Accuracy: 146/568 (25.7042%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0392, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.3254, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0541, Accuracy: 180/735 (24.4898%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 370/735 (50.3401%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 10.7150, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0545, Accuracy: 452/1470 (30.7483%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0246, Accuracy: 783/1470 (53.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.1518, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0584, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.6505, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0515, Accuracy: 320/1372 (23.3236%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0320, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.8619, Accuracy: 94/10000 (0.9400%)
time spent on training: 131.22760105133057
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 28, 27, 80, 54, 62, 32, 22, 4, 42], weight: tensor([0.0263, 0.1535, 0.1541, 0.0662, 0.1097, 0.0552, 0.0714, 0.1428, 0.0875,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 57.370967864990234, obj_val: 57.27569580078125, abs dis: 0.09527206420898438
[rfa agg] iter:  0, weight: tensor([0.0111, 0.0805, 0.0806, 0.0619, 0.2150, 0.0371, 0.0821, 0.0949, 0.2347,
        0.1021])
[rfa agg] iter:  1, prev_obj_val: 57.27569580078125, obj_val: 61.07955551147461, abs dis: 3.8038597106933594
[rfa agg] iter:  1, weight: tensor([0.0108, 0.0781, 0.0781, 0.0600, 0.2143, 0.0360, 0.0797, 0.0920, 0.2520,
        0.0990])
[rfa agg] iter:  2, prev_obj_val: 61.07955551147461, obj_val: 63.20657730102539, abs dis: 2.1270217895507812
[rfa agg] iter:  2, weight: tensor([0.0116, 0.0689, 0.0690, 0.0722, 0.1525, 0.0409, 0.1010, 0.0792, 0.3210,
        0.0838])
[rfa agg] iter:  3, prev_obj_val: 63.20657730102539, obj_val: 65.52483367919922, abs dis: 2.318256378173828
[rfa agg] iter:  3, weight: tensor([0.0121, 0.0655, 0.0656, 0.0814, 0.1315, 0.0443, 0.1186, 0.0745, 0.3281,
        0.0782])
[rfa agg] iter:  4, prev_obj_val: 65.52483367919922, obj_val: 63.209861755371094, abs dis: 2.314971923828125
[rfa agg] iter:  4, weight: tensor([0.0134, 0.0657, 0.0658, 0.0981, 0.1224, 0.0509, 0.1499, 0.0739, 0.2827,
        0.0772])
[rfa agg] iter:  5, prev_obj_val: 63.209861755371094, obj_val: 65.52333068847656, abs dis: 2.3134689331054688
[rfa agg] iter:  5, weight: tensor([0.0123, 0.0661, 0.0662, 0.0827, 0.1322, 0.0448, 0.1212, 0.0751, 0.3205,
        0.0789])
[rfa agg] iter:  6, prev_obj_val: 65.52333068847656, obj_val: 63.2100944519043, abs dis: 2.3132362365722656
[rfa agg] iter:  6, weight: tensor([0.0134, 0.0658, 0.0659, 0.0983, 0.1226, 0.0510, 0.1503, 0.0740, 0.2815,
        0.0773])
[rfa agg] iter:  7, prev_obj_val: 63.2100944519043, obj_val: 65.52327728271484, abs dis: 2.313182830810547
[rfa agg] iter:  7, weight: tensor([0.0123, 0.0661, 0.0662, 0.0827, 0.1323, 0.0448, 0.1212, 0.0752, 0.3202,
        0.0789])
[rfa agg] iter:  8, prev_obj_val: 65.52327728271484, obj_val: 63.21010971069336, abs dis: 2.3131675720214844
[rfa agg] iter:  8, weight: tensor([0.0134, 0.0658, 0.0659, 0.0983, 0.1226, 0.0510, 0.1503, 0.0740, 0.2814,
        0.0773])
[rfa agg] iter:  9, prev_obj_val: 63.21010971069336, obj_val: 65.52326965332031, abs dis: 2.313159942626953
[rfa agg] iter:  9, weight: tensor([0.0123, 0.0661, 0.0662, 0.0827, 0.1323, 0.0448, 0.1213, 0.0752, 0.3202,
        0.0789])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 11.4933, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 7.1038, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.73379826545715 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0512, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1499, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 279/896 (31.1384%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 468/896 (52.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3851, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 179/605 (29.5868%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2740, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0654, Accuracy: 278/715 (38.8811%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0371, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3734, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 297/928 (32.0043%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 572/928 (61.6379%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0211, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0501, Accuracy: 382/891 (42.8732%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4740, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0882, Accuracy: 12/416 (2.8846%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 183/416 (43.9904%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4888, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0772, Accuracy: 97/809 (11.9901%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0291, Accuracy: 348/809 (43.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1127, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0635, Accuracy: 209/1241 (16.8413%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0378, Accuracy: 367/1241 (29.5729%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2879, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0589, Accuracy: 329/1581 (20.8096%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0353, Accuracy: 526/1581 (33.2701%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2009, Accuracy: 90/10000 (0.9000%)
time spent on training: 125.76781296730042
[rfa agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 89, 2, 23, 1, 7, 78, 50, 72, 28], weight: tensor([0.0545, 0.1048, 0.0708, 0.0836, 0.1086, 0.1042, 0.0487, 0.0946, 0.1452,
        0.1850])
[rfa agg] iter:  0, prev_obj_val: 44.0357666015625, obj_val: 47.63874816894531, abs dis: 3.6029815673828125
[rfa agg] iter:  0, weight: tensor([0.0267, 0.1718, 0.0558, 0.1329, 0.1062, 0.1621, 0.0199, 0.2345, 0.0514,
        0.0388])
[rfa agg] iter:  1, prev_obj_val: 47.63874816894531, obj_val: 52.72821807861328, abs dis: 5.089469909667969
[rfa agg] iter:  1, weight: tensor([0.0368, 0.1314, 0.0871, 0.2051, 0.0900, 0.1274, 0.0265, 0.2052, 0.0505,
        0.0401])
[rfa agg] iter:  2, prev_obj_val: 52.72821807861328, obj_val: 52.70567321777344, abs dis: 0.02254486083984375
[rfa agg] iter:  2, weight: tensor([0.0567, 0.1104, 0.1616, 0.1952, 0.0847, 0.1084, 0.0387, 0.1465, 0.0536,
        0.0443])
[rfa agg] iter:  3, prev_obj_val: 52.70567321777344, obj_val: 55.55023193359375, abs dis: 2.8445587158203125
[rfa agg] iter:  3, weight: tensor([0.0567, 0.1092, 0.1693, 0.1941, 0.0841, 0.1070, 0.0386, 0.1439, 0.0532,
        0.0440])
[rfa agg] iter:  4, prev_obj_val: 55.55023193359375, obj_val: 55.538734436035156, abs dis: 0.01149749755859375
[rfa agg] iter:  4, weight: tensor([0.0691, 0.0996, 0.2269, 0.1604, 0.0793, 0.0979, 0.0454, 0.1243, 0.0527,
        0.0444])
[rfa agg] iter:  5, prev_obj_val: 55.538734436035156, obj_val: 55.53839111328125, abs dis: 0.00034332275390625
[rfa agg] iter:  5, weight: tensor([0.0686, 0.0981, 0.2394, 0.1562, 0.0783, 0.0963, 0.0450, 0.1223, 0.0521,
        0.0438])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 11.4470, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 7.2098, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.90429186820984 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0608, Accuracy: 359/1956 (18.3538%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 607/1956 (31.0327%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4105, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0692, Accuracy: 298/1003 (29.7109%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0370, Accuracy: 375/1003 (37.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5146, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0990, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0625, Accuracy: 93/271 (34.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.6453, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0650, Accuracy: 236/708 (33.3333%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0353, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3435, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0624, Accuracy: 271/896 (30.2455%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0345, Accuracy: 473/896 (52.7902%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6516, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0558, Accuracy: 428/1715 (24.9563%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0316, Accuracy: 666/1715 (38.8338%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4831, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0589, Accuracy: 322/807 (39.9009%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0328, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.3437, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0551, Accuracy: 273/1089 (25.0689%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0345, Accuracy: 458/1089 (42.0569%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 10.7488, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0607, Accuracy: 159/861 (18.4669%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.9593, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0594, Accuracy: 195/1013 (19.2498%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 366/1013 (36.1303%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2800, Accuracy: 68/10000 (0.6800%)
time spent on training: 134.41743111610413
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 86, 35, 16, 89, 92, 20, 59, 10, 14], weight: tensor([0.1896, 0.0972, 0.0263, 0.0686, 0.0868, 0.1662, 0.0782, 0.1055, 0.0834,
        0.0982])
[rfa agg] iter:  0, prev_obj_val: 58.312225341796875, obj_val: 58.8216552734375, abs dis: 0.509429931640625
[rfa agg] iter:  0, weight: tensor([0.0537, 0.1891, 0.0079, 0.0463, 0.0891, 0.0660, 0.0642, 0.2061, 0.0857,
        0.1919])
[rfa agg] iter:  1, prev_obj_val: 58.8216552734375, obj_val: 59.93596267700195, abs dis: 1.1143074035644531
[rfa agg] iter:  1, weight: tensor([0.0345, 0.2199, 0.0069, 0.0516, 0.1214, 0.0403, 0.0787, 0.1000, 0.1196,
        0.2270])
[rfa agg] iter:  2, prev_obj_val: 59.93596267700195, obj_val: 59.92308807373047, abs dis: 0.012874603271484375
[rfa agg] iter:  2, weight: tensor([0.0334, 0.1877, 0.0072, 0.0593, 0.1520, 0.0386, 0.0940, 0.0846, 0.1500,
        0.1932])
[rfa agg] iter:  3, prev_obj_val: 59.92308807373047, obj_val: 61.47996139526367, abs dis: 1.5568733215332031
[rfa agg] iter:  3, weight: tensor([0.0333, 0.1845, 0.0072, 0.0593, 0.1555, 0.0386, 0.0946, 0.0840, 0.1530,
        0.1900])
[rfa agg] iter:  4, prev_obj_val: 61.47996139526367, obj_val: 71.84098052978516, abs dis: 10.361019134521484
[rfa agg] iter:  4, weight: tensor([0.0322, 0.1468, 0.0075, 0.0684, 0.1854, 0.0369, 0.1140, 0.0746, 0.1841,
        0.1501])
[rfa agg] iter:  5, prev_obj_val: 71.84098052978516, obj_val: 68.5929946899414, abs dis: 3.24798583984375
[rfa agg] iter:  5, weight: tensor([0.0345, 0.0894, 0.0112, 0.1651, 0.1542, 0.0384, 0.2050, 0.0613, 0.1503,
        0.0906])
[rfa agg] iter:  6, prev_obj_val: 68.5929946899414, obj_val: 75.30020904541016, abs dis: 6.70721435546875
[rfa agg] iter:  6, weight: tensor([0.0315, 0.0905, 0.0094, 0.1326, 0.1662, 0.0353, 0.2206, 0.0591, 0.1630,
        0.0918])
[rfa agg] iter:  7, prev_obj_val: 75.30020904541016, obj_val: 71.78359985351562, abs dis: 3.5166091918945312
[rfa agg] iter:  7, weight: tensor([0.0367, 0.0860, 0.0131, 0.2043, 0.1376, 0.0405, 0.1998, 0.0617, 0.1334,
        0.0870])
[rfa agg] iter:  8, prev_obj_val: 71.78359985351562, obj_val: 65.80274963378906, abs dis: 5.9808502197265625
[rfa agg] iter:  8, weight: tensor([0.0334, 0.0861, 0.0109, 0.1805, 0.1465, 0.0372, 0.2159, 0.0592, 0.1429,
        0.0872])
[rfa agg] iter:  9, prev_obj_val: 65.80274963378906, obj_val: 68.59410095214844, abs dis: 2.791351318359375
[rfa agg] iter:  9, weight: tensor([0.0306, 0.0995, 0.0084, 0.1025, 0.1865, 0.0346, 0.1908, 0.0611, 0.1849,
        0.1011])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.0365, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 9.3420, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.45770359039307 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0563, Accuracy: 271/776 (34.9227%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.7654, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 309/1645 (18.7842%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 580/1645 (35.2584%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8118, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0588, Accuracy: 286/1130 (25.3097%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 474/1130 (41.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.3420, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0616, Accuracy: 355/1956 (18.1493%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 657/1956 (33.5890%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.6871, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 225/888 (25.3378%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.5348, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0842, Accuracy: 8/440 (1.8182%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0500, Accuracy: 137/440 (31.1364%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0597, Accuracy: 327/1418 (23.0606%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 643/1418 (45.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5445, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0663, Accuracy: 176/1049 (16.7779%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0320, Accuracy: 496/1049 (47.2831%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8108, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 322/803 (40.0996%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2806, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0528, Accuracy: 342/1275 (26.8235%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 682/1275 (53.4902%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 11.3493, Accuracy: 97/10000 (0.9700%)
time spent on training: 140.59956073760986
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 13, 54, 6, 63, 49, 70, 51, 58, 9], weight: tensor([0.0682, 0.1446, 0.0993, 0.1719, 0.0780, 0.0387, 0.1246, 0.0922, 0.0706,
        0.1120])
[rfa agg] iter:  0, prev_obj_val: 55.259098052978516, obj_val: 59.314056396484375, abs dis: 4.054958343505859
[rfa agg] iter:  0, weight: tensor([0.0509, 0.0683, 0.2427, 0.0505, 0.0703, 0.0134, 0.0918, 0.1845, 0.0530,
        0.1747])
[rfa agg] iter:  1, prev_obj_val: 59.314056396484375, obj_val: 63.23544692993164, abs dis: 3.9213905334472656
[rfa agg] iter:  1, weight: tensor([0.0728, 0.0595, 0.1982, 0.0467, 0.1079, 0.0159, 0.0739, 0.2302, 0.0761,
        0.1188])
[rfa agg] iter:  2, prev_obj_val: 63.23544692993164, obj_val: 65.37811279296875, abs dis: 2.1426658630371094
[rfa agg] iter:  2, weight: tensor([0.1029, 0.0573, 0.1475, 0.0464, 0.1623, 0.0188, 0.0684, 0.1879, 0.1084,
        0.1001])
[rfa agg] iter:  3, prev_obj_val: 65.37811279296875, obj_val: 67.66291046142578, abs dis: 2.2847976684570312
[rfa agg] iter:  3, weight: tensor([0.1217, 0.0539, 0.1251, 0.0443, 0.2007, 0.0196, 0.0633, 0.1530, 0.1290,
        0.0893])
[rfa agg] iter:  4, prev_obj_val: 67.66291046142578, obj_val: 70.14041137695312, abs dis: 2.4775009155273438
[rfa agg] iter:  4, weight: tensor([0.1419, 0.0488, 0.1039, 0.0406, 0.2368, 0.0198, 0.0565, 0.1226, 0.1519,
        0.0773])
[rfa agg] iter:  5, prev_obj_val: 70.14041137695312, obj_val: 67.65611267089844, abs dis: 2.4842987060546875
[rfa agg] iter:  5, weight: tensor([0.1664, 0.0435, 0.0858, 0.0367, 0.2526, 0.0196, 0.0496, 0.0985, 0.1810,
        0.0662])
[rfa agg] iter:  6, prev_obj_val: 67.65611267089844, obj_val: 72.91702270507812, abs dis: 5.2609100341796875
[rfa agg] iter:  6, weight: tensor([0.1421, 0.0478, 0.1017, 0.0398, 0.2496, 0.0194, 0.0552, 0.1174, 0.1515,
        0.0755])
[rfa agg] iter:  7, prev_obj_val: 72.91702270507812, obj_val: 70.13774871826172, abs dis: 2.7792739868164062
[rfa agg] iter:  7, weight: tensor([0.1968, 0.0403, 0.0744, 0.0344, 0.2261, 0.0203, 0.0454, 0.0839, 0.2195,
        0.0591])
[rfa agg] iter:  8, prev_obj_val: 70.13774871826172, obj_val: 70.1323471069336, abs dis: 0.005401611328125
[rfa agg] iter:  8, weight: tensor([0.1706, 0.0430, 0.0847, 0.0362, 0.2498, 0.0194, 0.0490, 0.0961, 0.1859,
        0.0653])
[rfa agg] iter:  9, prev_obj_val: 70.1323471069336, obj_val: 67.65703582763672, abs dis: 2.475311279296875
[rfa agg] iter:  9, weight: tensor([0.1676, 0.0429, 0.0847, 0.0362, 0.2565, 0.0194, 0.0490, 0.0964, 0.1821,
        0.0652])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.3825, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 10.1569, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.1926393508911 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0674, Accuracy: 220/708 (31.0734%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0338, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0761, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0672, Accuracy: 239/690 (34.6377%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0328, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.4337, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0595, Accuracy: 368/1904 (19.3277%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0309, Accuracy: 710/1904 (37.2899%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.7607, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0537, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2087, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0864, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0505, Accuracy: 135/373 (36.1930%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 148/938 (15.7783%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 324/938 (34.5416%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9962, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 390/1742 (22.3881%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5903, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 183/953 (19.2025%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 282/953 (29.5908%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4974, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0563, Accuracy: 358/1949 (18.3684%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 605/1949 (31.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.3173, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0590, Accuracy: 160/861 (18.5830%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 427/861 (49.5935%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.3562, Accuracy: 93/10000 (0.9300%)
time spent on training: 138.2899260520935
[rfa agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 25, 46, 76, 98, 73, 93, 64, 21, 10], weight: tensor([0.0669, 0.0652, 0.1799, 0.0440, 0.0352, 0.0886, 0.1646, 0.0900, 0.1841,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 79.48738098144531, obj_val: 80.7398452758789, abs dis: 1.2524642944335938
[rfa agg] iter:  0, weight: tensor([0.0715, 0.0613, 0.1231, 0.0302, 0.0203, 0.1601, 0.1369, 0.1615, 0.1155,
        0.1195])
[rfa agg] iter:  1, prev_obj_val: 80.7398452758789, obj_val: 83.29182434082031, abs dis: 2.5519790649414062
[rfa agg] iter:  1, weight: tensor([0.0742, 0.0610, 0.0786, 0.0276, 0.0180, 0.2184, 0.0847, 0.2193, 0.0746,
        0.1436])
[rfa agg] iter:  2, prev_obj_val: 83.29182434082031, obj_val: 86.5322265625, abs dis: 3.2404022216796875
[rfa agg] iter:  2, weight: tensor([0.0689, 0.0527, 0.0401, 0.0207, 0.0128, 0.2735, 0.0422, 0.2731, 0.0385,
        0.1775])
[rfa agg] iter:  3, prev_obj_val: 86.5322265625, obj_val: 88.66779327392578, abs dis: 2.1355667114257812
[rfa agg] iter:  3, weight: tensor([0.0958, 0.0697, 0.0386, 0.0246, 0.0147, 0.2134, 0.0403, 0.2181, 0.0372,
        0.2476])
[rfa agg] iter:  4, prev_obj_val: 88.66779327392578, obj_val: 88.65554809570312, abs dis: 0.01224517822265625
[rfa agg] iter:  4, weight: tensor([0.1254, 0.0877, 0.0401, 0.0287, 0.0167, 0.1753, 0.0417, 0.1801, 0.0387,
        0.2656])
[rfa agg] iter:  5, prev_obj_val: 88.65554809570312, obj_val: 88.6553726196289, abs dis: 0.00017547607421875
[rfa agg] iter:  5, weight: tensor([0.1274, 0.0879, 0.0399, 0.0286, 0.0167, 0.1711, 0.0415, 0.1763, 0.0385,
        0.2720])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 11.8990, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 12.8261, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.45343399047852 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0563, Accuracy: 340/1949 (17.4448%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 592/1949 (30.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7486, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0900, Accuracy: 37/631 (5.8637%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0485, Accuracy: 206/631 (32.6466%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3919, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0716, Accuracy: 136/530 (25.6604%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0405, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7858, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0449, Accuracy: 408/1552 (26.2887%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 734/1552 (47.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.8869, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0591, Accuracy: 269/928 (28.9871%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 577/928 (62.1767%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3338, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0726, Accuracy: 130/773 (16.8176%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0337, Accuracy: 384/773 (49.6766%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.8499, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0472, Accuracy: 422/891 (47.3625%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0254, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7542, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0886, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0549, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4004, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0585, Accuracy: 226/813 (27.7983%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0199, Accuracy: 441/813 (54.2435%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.8240, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0621, Accuracy: 206/1513 (13.6153%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0375, Accuracy: 422/1513 (27.8916%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5368, Accuracy: 102/10000 (1.0200%)
time spent on training: 137.90701818466187
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 48, 18, 74, 1, 99, 7, 76, 53, 8], weight: tensor([0.1940, 0.0628, 0.0528, 0.1545, 0.0924, 0.0769, 0.0887, 0.0464, 0.0809,
        0.1506])
[rfa agg] iter:  0, prev_obj_val: 67.81988525390625, obj_val: 69.2033462524414, abs dis: 1.3834609985351562
[rfa agg] iter:  0, weight: tensor([0.0874, 0.0505, 0.0374, 0.1232, 0.1880, 0.1000, 0.1405, 0.0295, 0.1060,
        0.1375])
[rfa agg] iter:  1, prev_obj_val: 69.2033462524414, obj_val: 72.58140563964844, abs dis: 3.3780593872070312
[rfa agg] iter:  1, weight: tensor([0.0488, 0.0492, 0.0346, 0.0617, 0.2492, 0.1290, 0.1947, 0.0262, 0.1399,
        0.0667])
[rfa agg] iter:  2, prev_obj_val: 72.58140563964844, obj_val: 76.65303802490234, abs dis: 4.071632385253906
[rfa agg] iter:  2, weight: tensor([0.0375, 0.0570, 0.0378, 0.0451, 0.1524, 0.1856, 0.1964, 0.0276, 0.2126,
        0.0480])
[rfa agg] iter:  3, prev_obj_val: 76.65303802490234, obj_val: 76.63309478759766, abs dis: 0.0199432373046875
[rfa agg] iter:  3, weight: tensor([0.0368, 0.0788, 0.0491, 0.0431, 0.1097, 0.2064, 0.1526, 0.0345, 0.2433,
        0.0456])
[rfa agg] iter:  4, prev_obj_val: 76.63309478759766, obj_val: 76.63282775878906, abs dis: 0.00026702880859375
[rfa agg] iter:  4, weight: tensor([0.0363, 0.0784, 0.0487, 0.0426, 0.1069, 0.2098, 0.1476, 0.0342, 0.2505,
        0.0450])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 14.4927, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 15.9613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.082537651062 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0605, Accuracy: 207/636 (32.5472%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.0973, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0566, Accuracy: 309/1662 (18.5921%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 577/1662 (34.7172%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8386, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0608, Accuracy: 259/928 (27.9095%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 596/928 (64.2241%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5603, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0758, Accuracy: 272/1003 (27.1186%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0377, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6306, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0561, Accuracy: 337/1949 (17.2909%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0337, Accuracy: 604/1949 (30.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.9029, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0588, Accuracy: 238/776 (30.6701%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.7203, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 175/605 (28.9256%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9692, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0568, Accuracy: 309/901 (34.2952%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0353, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.6120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0665, Accuracy: 131/568 (23.0634%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 257/568 (45.2465%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5260, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0727, Accuracy: 193/774 (24.9354%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0412, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7461, Accuracy: 76/10000 (0.7600%)
time spent on training: 142.83759689331055
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 94, 1, 86, 21, 75, 2, 4, 62, 81], weight: tensor([0.0649, 0.1696, 0.0947, 0.1023, 0.1988, 0.0792, 0.0617, 0.0919, 0.0579,
        0.0790])
[rfa agg] iter:  0, prev_obj_val: 62.99812316894531, obj_val: 65.18534088134766, abs dis: 2.1872177124023438
[rfa agg] iter:  0, weight: tensor([0.0395, 0.0809, 0.1640, 0.2628, 0.0615, 0.0824, 0.0378, 0.1592, 0.0312,
        0.0807])
[rfa agg] iter:  1, prev_obj_val: 65.18534088134766, obj_val: 68.97100830078125, abs dis: 3.7856674194335938
[rfa agg] iter:  1, weight: tensor([0.0549, 0.0435, 0.1488, 0.1214, 0.0366, 0.1918, 0.0530, 0.1467, 0.0401,
        0.1633])
[rfa agg] iter:  2, prev_obj_val: 68.97100830078125, obj_val: 74.08116149902344, abs dis: 5.1101531982421875
[rfa agg] iter:  2, weight: tensor([0.0743, 0.0414, 0.1093, 0.0910, 0.0355, 0.2283, 0.0722, 0.1068, 0.0522,
        0.1890])
[rfa agg] iter:  3, prev_obj_val: 74.08116149902344, obj_val: 74.04829406738281, abs dis: 0.032867431640625
[rfa agg] iter:  3, weight: tensor([0.1200, 0.0445, 0.0953, 0.0834, 0.0389, 0.1700, 0.1189, 0.0928, 0.0808,
        0.1555])
[rfa agg] iter:  4, prev_obj_val: 74.04829406738281, obj_val: 76.8466567993164, abs dis: 2.7983627319335938
[rfa agg] iter:  4, weight: tensor([0.1245, 0.0444, 0.0949, 0.0830, 0.0388, 0.1655, 0.1235, 0.0923, 0.0816,
        0.1514])
[rfa agg] iter:  5, prev_obj_val: 76.8466567993164, obj_val: 74.0589370727539, abs dis: 2.7877197265625
[rfa agg] iter:  5, weight: tensor([0.1534, 0.0435, 0.0859, 0.0765, 0.0384, 0.1360, 0.1553, 0.0835, 0.0996,
        0.1278])
[rfa agg] iter:  6, prev_obj_val: 74.0589370727539, obj_val: 76.84428405761719, abs dis: 2.7853469848632812
[rfa agg] iter:  6, weight: tensor([0.1277, 0.0443, 0.0947, 0.0829, 0.0387, 0.1624, 0.1269, 0.0920, 0.0822,
        0.1480])
[rfa agg] iter:  7, prev_obj_val: 76.84428405761719, obj_val: 74.05921173095703, abs dis: 2.7850723266601562
[rfa agg] iter:  7, weight: tensor([0.1538, 0.0435, 0.0859, 0.0764, 0.0384, 0.1357, 0.1558, 0.0835, 0.0996,
        0.1275])
[rfa agg] iter:  8, prev_obj_val: 74.05921173095703, obj_val: 76.84426879882812, abs dis: 2.7850570678710938
[rfa agg] iter:  8, weight: tensor([0.1278, 0.0443, 0.0947, 0.0829, 0.0387, 0.1624, 0.1269, 0.0920, 0.0822,
        0.1480])
[rfa agg] iter:  9, prev_obj_val: 76.84426879882812, obj_val: 74.05921936035156, abs dis: 2.7850494384765625
[rfa agg] iter:  9, weight: tensor([0.1538, 0.0435, 0.0859, 0.0764, 0.0384, 0.1357, 0.1558, 0.0835, 0.0996,
        0.1275])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.4375, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 12.1054, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.42984700202942 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0701, Accuracy: 247/1190 (20.7563%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8015, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0729, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0499, Accuracy: 194/500 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6811, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0555, Accuracy: 317/1645 (19.2705%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 612/1645 (37.2036%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5531, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0782, Accuracy: 58/426 (13.6150%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0436, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3993, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 176/605 (29.0909%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8055, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0563, Accuracy: 187/861 (21.7189%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 444/861 (51.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.8922, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0794, Accuracy: 86/809 (10.6304%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0301, Accuracy: 315/809 (38.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.9342, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0623, Accuracy: 276/1418 (19.4640%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 597/1418 (42.1016%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6142, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0597, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0343, Accuracy: 356/1013 (35.1431%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.9945, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0614, Accuracy: 204/590 (34.5763%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.0090, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.49036931991577
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 82, 13, 67, 2, 10, 50, 70, 14, 69], weight: tensor([0.1314, 0.0552, 0.1816, 0.0470, 0.0668, 0.0951, 0.0893, 0.1566, 0.1118,
        0.0651])
[rfa agg] iter:  0, prev_obj_val: 53.819889068603516, obj_val: 56.04156494140625, abs dis: 2.2216758728027344
[rfa agg] iter:  0, weight: tensor([0.1050, 0.0317, 0.0596, 0.0233, 0.0543, 0.2205, 0.1697, 0.0693, 0.2134,
        0.0532])
[rfa agg] iter:  1, prev_obj_val: 56.04156494140625, obj_val: 59.545021057128906, abs dis: 3.5034561157226562
[rfa agg] iter:  1, weight: tensor([0.0811, 0.0346, 0.0510, 0.0248, 0.0635, 0.2377, 0.2443, 0.0578, 0.1425,
        0.0626])
[rfa agg] iter:  2, prev_obj_val: 59.545021057128906, obj_val: 63.9508171081543, abs dis: 4.405796051025391
[rfa agg] iter:  2, weight: tensor([0.0727, 0.0438, 0.0495, 0.0304, 0.0885, 0.1801, 0.2812, 0.0549, 0.1110,
        0.0879])
[rfa agg] iter:  3, prev_obj_val: 63.9508171081543, obj_val: 68.85089874267578, abs dis: 4.900081634521484
[rfa agg] iter:  3, weight: tensor([0.0699, 0.0607, 0.0509, 0.0402, 0.1416, 0.1372, 0.2040, 0.0553, 0.0974,
        0.1428])
[rfa agg] iter:  4, prev_obj_val: 68.85089874267578, obj_val: 66.29743194580078, abs dis: 2.553466796875
[rfa agg] iter:  4, weight: tensor([0.0579, 0.0761, 0.0444, 0.0468, 0.2097, 0.0965, 0.1258, 0.0475, 0.0755,
        0.2197])
[rfa agg] iter:  5, prev_obj_val: 66.29743194580078, obj_val: 68.80829620361328, abs dis: 2.5108642578125
[rfa agg] iter:  5, weight: tensor([0.0631, 0.0681, 0.0472, 0.0435, 0.1876, 0.1119, 0.1519, 0.0509, 0.0847,
        0.1911])
[rfa agg] iter:  6, prev_obj_val: 68.80829620361328, obj_val: 66.3003921508789, abs dis: 2.507904052734375
[rfa agg] iter:  6, weight: tensor([0.0563, 0.0748, 0.0433, 0.0459, 0.2176, 0.0935, 0.1213, 0.0463, 0.0734,
        0.2276])
[rfa agg] iter:  7, prev_obj_val: 66.3003921508789, obj_val: 68.8079833984375, abs dis: 2.5075912475585938
[rfa agg] iter:  7, weight: tensor([0.0629, 0.0680, 0.0472, 0.0434, 0.1883, 0.1116, 0.1514, 0.0508, 0.0845,
        0.1917])
[rfa agg] iter:  8, prev_obj_val: 68.8079833984375, obj_val: 66.30043029785156, abs dis: 2.5075531005859375
[rfa agg] iter:  8, weight: tensor([0.0563, 0.0748, 0.0432, 0.0459, 0.2178, 0.0935, 0.1212, 0.0463, 0.0734,
        0.2277])
[rfa agg] iter:  9, prev_obj_val: 66.30043029785156, obj_val: 68.80797576904297, abs dis: 2.5075454711914062
[rfa agg] iter:  9, weight: tensor([0.0629, 0.0680, 0.0472, 0.0434, 0.1883, 0.1116, 0.1514, 0.0508, 0.0845,
        0.1917])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.2100, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 12.9802, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.59191250801086 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0642, Accuracy: 313/1750 (17.8857%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 639/1750 (36.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3928, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0579, Accuracy: 265/1446 (18.3264%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 509/1446 (35.2006%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9612, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0547, Accuracy: 220/813 (27.0603%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 14.0262, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0606, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0329, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9065, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0610, Accuracy: 251/1154 (21.7504%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0321, Accuracy: 485/1154 (42.0277%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.5422, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0574, Accuracy: 320/1662 (19.2539%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0348, Accuracy: 533/1662 (32.0698%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.9982, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0867, Accuracy: 26/460 (5.6522%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.4064, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0604, Accuracy: 181/605 (29.9174%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0372, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.5476, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0785, Accuracy: 198/774 (25.5814%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0420, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1637, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0858, Accuracy: 43/631 (6.8146%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0471, Accuracy: 214/631 (33.9144%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8850, Accuracy: 75/10000 (0.7500%)
time spent on training: 148.77944540977478
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 26, 53, 87, 15, 94, 31, 2, 81, 48], weight: tensor([0.1678, 0.1387, 0.0780, 0.1085, 0.1107, 0.1594, 0.0441, 0.0580, 0.0742,
        0.0605])
[rfa agg] iter:  0, prev_obj_val: 57.82587432861328, obj_val: 63.43191909790039, abs dis: 5.606044769287109
[rfa agg] iter:  0, weight: tensor([0.0697, 0.1067, 0.0740, 0.3198, 0.1898, 0.0815, 0.0202, 0.0335, 0.0695,
        0.0352])
[rfa agg] iter:  1, prev_obj_val: 63.43191909790039, obj_val: 63.3641242980957, abs dis: 0.0677947998046875
[rfa agg] iter:  1, weight: tensor([0.0687, 0.0934, 0.1422, 0.2063, 0.1443, 0.0777, 0.0296, 0.0522, 0.1303,
        0.0552])
[rfa agg] iter:  2, prev_obj_val: 63.3641242980957, obj_val: 63.36396408081055, abs dis: 0.00016021728515625
[rfa agg] iter:  2, weight: tensor([0.0686, 0.0932, 0.1463, 0.2008, 0.1420, 0.0775, 0.0297, 0.0525, 0.1340,
        0.0554])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.9179, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 13.1820, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.57433438301086 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0892, Accuracy: 41/682 (6.0117%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0394, Accuracy: 264/682 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.2243, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0873, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0703, Accuracy: 40/186 (21.5054%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.4872, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0664, Accuracy: 151/938 (16.0981%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 339/938 (36.1407%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.5641, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0454, Accuracy: 449/1552 (28.9304%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 784/1552 (50.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 12.4582, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0858, Accuracy: 88/669 (13.1540%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0453, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4159, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0575, Accuracy: 292/1130 (25.8407%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0307, Accuracy: 430/1130 (38.0531%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.5591, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0585, Accuracy: 255/1372 (18.5860%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0324, Accuracy: 483/1372 (35.2041%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.2094, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1062, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0872, Accuracy: 34/197 (17.2589%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.4277, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0479, Accuracy: 392/891 (43.9955%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0245, Accuracy: 463/891 (51.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6767, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0743, Accuracy: 99/809 (12.2373%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0290, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.0960, Accuracy: 80/10000 (0.8000%)
time spent on training: 138.2917239665985
[rfa agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 56, 73, 74, 45, 54, 42, 79, 7, 50], weight: tensor([0.0809, 0.0221, 0.1113, 0.1842, 0.0794, 0.1341, 0.1628, 0.0234, 0.1057,
        0.0960])
[rfa agg] iter:  0, prev_obj_val: 47.924957275390625, obj_val: 50.227264404296875, abs dis: 2.30230712890625
[rfa agg] iter:  0, weight: tensor([0.0690, 0.0057, 0.2369, 0.0547, 0.0669, 0.1132, 0.0671, 0.0067, 0.2222,
        0.1576])
[rfa agg] iter:  1, prev_obj_val: 50.227264404296875, obj_val: 54.25198745727539, abs dis: 4.024723052978516
[rfa agg] iter:  1, weight: tensor([0.0851, 0.0057, 0.1722, 0.0465, 0.0820, 0.0841, 0.0553, 0.0068, 0.2395,
        0.2226])
[rfa agg] iter:  2, prev_obj_val: 54.25198745727539, obj_val: 59.46284866333008, abs dis: 5.2108612060546875
[rfa agg] iter:  2, weight: tensor([0.1308, 0.0067, 0.1252, 0.0460, 0.1247, 0.0746, 0.0532, 0.0080, 0.1758,
        0.2551])
[rfa agg] iter:  3, prev_obj_val: 59.46284866333008, obj_val: 59.39134979248047, abs dis: 0.07149887084960938
[rfa agg] iter:  3, weight: tensor([0.2151, 0.0078, 0.0999, 0.0455, 0.1974, 0.0679, 0.0515, 0.0096, 0.1272,
        0.1782])
[rfa agg] iter:  4, prev_obj_val: 59.39134979248047, obj_val: 56.70460510253906, abs dis: 2.6867446899414062
[rfa agg] iter:  4, weight: tensor([0.2326, 0.0075, 0.0957, 0.0437, 0.2105, 0.0654, 0.0495, 0.0092, 0.1209,
        0.1648])
[rfa agg] iter:  5, prev_obj_val: 56.70460510253906, obj_val: 56.686607360839844, abs dis: 0.01799774169921875
[rfa agg] iter:  5, weight: tensor([0.1876, 0.0072, 0.1090, 0.0455, 0.1744, 0.0707, 0.0520, 0.0088, 0.1423,
        0.2024])
[rfa agg] iter:  6, prev_obj_val: 56.686607360839844, obj_val: 56.686214447021484, abs dis: 0.000392913818359375
[rfa agg] iter:  6, weight: tensor([0.1814, 0.0072, 0.1099, 0.0457, 0.1692, 0.0710, 0.0523, 0.0088, 0.1442,
        0.2102])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.4403, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 14.0312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.21255660057068 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0548, Accuracy: 400/1574 (25.4130%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0259, Accuracy: 784/1574 (49.8094%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0207, Accuracy: 909/1574 (57.7510%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0201, Accuracy: 924/1574 (58.7039%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0196, Accuracy: 940/1574 (59.7205%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0199, Accuracy: 944/1574 (59.9746%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0190, Accuracy: 975/1574 (61.9441%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0185, Accuracy: 997/1574 (63.3418%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0182, Accuracy: 1004/1574 (63.7865%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0182, Accuracy: 989/1574 (62.8335%), train_poison_data_count: 500
Global model norm: 204.6369880422403.
Norm before scaling: 204.5827021799497. Distance: 1.31264563161258
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3587, Accuracy: 93/10000 (0.9300%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.2013, Accuracy: 9767/9950 (98.1608%)
Scaling by  100
Scaled Norm after poisoning: 238.14548796376553, distance: 131.2645676439381
Total norm for 1 adversaries is: 238.14548796376553. distance: 131.2645676439381
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 259/1190 (21.7647%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0338, Accuracy: 428/1190 (35.9664%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9636, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0710, Accuracy: 108/809 (13.3498%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.9580, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0651, Accuracy: 228/690 (33.0435%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5778, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 305/1645 (18.5410%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 586/1645 (35.6231%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.8087, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 271/599 (45.2421%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 12.6172, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0863, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 136/373 (36.4611%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9045, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0581, Accuracy: 275/1372 (20.0437%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0328, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.6460, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 269/1154 (23.3102%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.4440, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0567, Accuracy: 292/1130 (25.8407%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0299, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.9473, Accuracy: 54/10000 (0.5400%)
time spent on training: 266.32372641563416
[rfa agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.04668517463933181
[rfa agg] init. name: [17, 84, 50, 25, 13, 95, 98, 42, 15, 54], weight: tensor([0.1494, 0.1129, 0.0768, 0.0655, 0.1561, 0.0569, 0.0354, 0.1302, 0.1095,
        0.1073])
[rfa agg] iter:  0, prev_obj_val: 28455.37890625, obj_val: 19065.53515625, abs dis: 9389.84375
[rfa agg] iter:  0, weight: tensor([0.0299, 0.1289, 0.0873, 0.0744, 0.1788, 0.0646, 0.0401, 0.1488, 0.1250,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 19065.53515625, obj_val: 17139.857421875, abs dis: 1925.677734375
[rfa agg] iter:  1, weight: tensor([0.0053, 0.1323, 0.0885, 0.0751, 0.1864, 0.0650, 0.0400, 0.1538, 0.1283,
        0.1253])
[rfa agg] iter:  2, prev_obj_val: 17139.857421875, obj_val: 16798.53515625, abs dis: 341.322265625
[rfa agg] iter:  2, weight: tensor([0.0009, 0.1332, 0.0827, 0.0686, 0.2067, 0.0587, 0.0346, 0.1611, 0.1291,
        0.1245])
[rfa agg] iter:  3, prev_obj_val: 16798.53515625, obj_val: 16772.90625, abs dis: 25.62890625
[rfa agg] iter:  3, weight: tensor([9.4627e-05, 9.6873e-02, 4.0307e-02, 3.0331e-02, 4.5210e-01, 2.4855e-02,
        1.2610e-02, 1.6498e-01, 9.4191e-02, 8.3663e-02])
[rfa agg] iter:  4, prev_obj_val: 16772.90625, obj_val: 16773.056640625, abs dis: 0.150390625
[rfa agg] iter:  4, weight: tensor([5.3127e-05, 1.6544e-01, 4.1841e-02, 2.8720e-02, 1.3516e-01, 2.2683e-02,
        1.0322e-02, 2.9217e-01, 1.6794e-01, 1.3568e-01])
[rfa agg] iter:  5, prev_obj_val: 16773.056640625, obj_val: 16775.521484375, abs dis: 2.46484375
[rfa agg] iter:  5, weight: tensor([4.5781e-05, 2.1402e-01, 5.1604e-02, 3.2765e-02, 7.7377e-02, 2.5128e-02,
        1.0616e-02, 1.3302e-01, 2.1656e-01, 2.3886e-01])
[rfa agg] iter:  6, prev_obj_val: 16775.521484375, obj_val: 16779.27734375, abs dis: 3.755859375
[rfa agg] iter:  6, weight: tensor([4.8517e-05, 1.9291e-01, 6.5956e-02, 3.9835e-02, 7.2575e-02, 3.0018e-02,
        1.2187e-02, 1.1011e-01, 1.9158e-01, 2.8479e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.8552, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 12.8466, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.50782108306885 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0622, Accuracy: 281/807 (34.8203%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0339, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8128, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0555, Accuracy: 387/1715 (22.5656%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 748/1715 (43.6152%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.6656, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0766, Accuracy: 86/426 (20.1878%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0453, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7851, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0782, Accuracy: 78/631 (12.3613%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0449, Accuracy: 210/631 (33.2805%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7846, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 297/1030 (28.8350%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 600/1030 (58.2524%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.7432, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0565, Accuracy: 418/1988 (21.0262%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0371, Accuracy: 590/1988 (29.6781%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3617, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0882, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0546, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4288, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0640, Accuracy: 343/1956 (17.5358%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 596/1956 (30.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0092, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0554, Accuracy: 393/1953 (20.1229%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 760/1953 (38.9145%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3837, Accuracy: 114/10000 (1.1400%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0539, Accuracy: 328/1574 (20.8386%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 626/1574 (39.7713%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.2649, Accuracy: 83/10000 (0.8300%)
time spent on training: 175.4455530643463
[rfa agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.039205722939582334
[rfa agg] init. name: [20, 92, 67, 48, 91, 85, 76, 6, 83, 17], weight: tensor([0.0643, 0.1367, 0.0340, 0.0503, 0.0821, 0.1585, 0.0371, 0.1559, 0.1557,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 72.935302734375, obj_val: 69.15897369384766, abs dis: 3.7763290405273438
[rfa agg] iter:  0, weight: tensor([0.0449, 0.1860, 0.0146, 0.0269, 0.0935, 0.1092, 0.0171, 0.1200, 0.1204,
        0.2674])
[rfa agg] iter:  1, prev_obj_val: 69.15897369384766, obj_val: 67.42728424072266, abs dis: 1.731689453125
[rfa agg] iter:  1, weight: tensor([0.0346, 0.1947, 0.0117, 0.0212, 0.0688, 0.1028, 0.0136, 0.1147, 0.1150,
        0.3229])
[rfa agg] iter:  2, prev_obj_val: 67.42728424072266, obj_val: 70.97080993652344, abs dis: 3.5435256958007812
[rfa agg] iter:  2, weight: tensor([0.0300, 0.1969, 0.0103, 0.0185, 0.0582, 0.0983, 0.0120, 0.1106, 0.1110,
        0.3544])
[rfa agg] iter:  3, prev_obj_val: 70.97080993652344, obj_val: 67.43228149414062, abs dis: 3.5385284423828125
[rfa agg] iter:  3, weight: tensor([0.0388, 0.1871, 0.0129, 0.0235, 0.0787, 0.1040, 0.0150, 0.1153, 0.1156,
        0.3091])
[rfa agg] iter:  4, prev_obj_val: 67.43228149414062, obj_val: 70.97023010253906, abs dis: 3.5379486083984375
[rfa agg] iter:  4, weight: tensor([0.0301, 0.1973, 0.0103, 0.0186, 0.0584, 0.0987, 0.0120, 0.1110, 0.1114,
        0.3522])
[rfa agg] iter:  5, prev_obj_val: 70.97023010253906, obj_val: 67.43235778808594, abs dis: 3.537872314453125
[rfa agg] iter:  5, weight: tensor([0.0388, 0.1872, 0.0129, 0.0235, 0.0787, 0.1041, 0.0150, 0.1154, 0.1156,
        0.3088])
[rfa agg] iter:  6, prev_obj_val: 67.43235778808594, obj_val: 70.97020721435547, abs dis: 3.5378494262695312
[rfa agg] iter:  6, weight: tensor([0.0301, 0.1973, 0.0103, 0.0186, 0.0584, 0.0987, 0.0120, 0.1110, 0.1114,
        0.3522])
[rfa agg] iter:  7, prev_obj_val: 70.97020721435547, obj_val: 67.43235778808594, abs dis: 3.5378494262695312
[rfa agg] iter:  7, weight: tensor([0.0388, 0.1872, 0.0129, 0.0235, 0.0787, 0.1041, 0.0150, 0.1154, 0.1156,
        0.3088])
[rfa agg] iter:  8, prev_obj_val: 67.43235778808594, obj_val: 70.97020721435547, abs dis: 3.5378494262695312
[rfa agg] iter:  8, weight: tensor([0.0301, 0.1973, 0.0103, 0.0186, 0.0584, 0.0987, 0.0120, 0.1110, 0.1114,
        0.3522])
[rfa agg] iter:  9, prev_obj_val: 70.97020721435547, obj_val: 67.43235778808594, abs dis: 3.5378494262695312
[rfa agg] iter:  9, weight: tensor([0.0388, 0.1872, 0.0129, 0.0235, 0.0787, 0.1041, 0.0150, 0.1154, 0.1156,
        0.3088])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.5364, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 11.3324, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.8993990421295 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0649, Accuracy: 233/712 (32.7247%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0292, Accuracy: 432/712 (60.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.0531, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0556, Accuracy: 317/803 (39.4770%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0323, Accuracy: 422/803 (52.5529%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9606, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0513, Accuracy: 242/813 (29.7663%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 13.1147, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0604, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0329, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.0753, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0564, Accuracy: 262/599 (43.7396%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0316, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.5550, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0653, Accuracy: 127/568 (22.3592%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0399, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.1504, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0587, Accuracy: 393/1475 (26.6441%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1475 (42.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5410, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0538, Accuracy: 533/2227 (23.9335%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 898/2227 (40.3233%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.8813, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0598, Accuracy: 250/1154 (21.6638%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.7064, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 227/590 (38.4746%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0283, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.8469, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.2026882171631
[rfa agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 58, 53, 87, 95, 62, 65, 60, 57, 69], weight: tensor([0.0707, 0.0797, 0.0807, 0.1123, 0.0595, 0.0564, 0.1464, 0.2211, 0.1146,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 71.39247131347656, obj_val: 72.57199096679688, abs dis: 1.1795196533203125
[rfa agg] iter:  0, weight: tensor([0.0479, 0.0629, 0.0635, 0.2856, 0.0316, 0.0271, 0.1302, 0.0666, 0.2533,
        0.0312])
[rfa agg] iter:  1, prev_obj_val: 72.57199096679688, obj_val: 75.05254364013672, abs dis: 2.4805526733398438
[rfa agg] iter:  1, weight: tensor([0.0814, 0.1206, 0.1201, 0.2346, 0.0476, 0.0393, 0.0880, 0.0577, 0.1635,
        0.0472])
[rfa agg] iter:  2, prev_obj_val: 75.05254364013672, obj_val: 78.66734313964844, abs dis: 3.6147994995117188
[rfa agg] iter:  2, weight: tensor([0.1098, 0.1886, 0.1835, 0.1366, 0.0569, 0.0452, 0.0681, 0.0487, 0.1059,
        0.0565])
[rfa agg] iter:  3, prev_obj_val: 78.66734313964844, obj_val: 80.48533630371094, abs dis: 1.8179931640625
[rfa agg] iter:  3, weight: tensor([0.1378, 0.2520, 0.2321, 0.0729, 0.0605, 0.0454, 0.0440, 0.0338, 0.0609,
        0.0604])
[rfa agg] iter:  4, prev_obj_val: 80.48533630371094, obj_val: 85.28440856933594, abs dis: 4.799072265625
[rfa agg] iter:  4, weight: tensor([0.1610, 0.2373, 0.2215, 0.0647, 0.0687, 0.0500, 0.0411, 0.0322, 0.0549,
        0.0687])
[rfa agg] iter:  5, prev_obj_val: 85.28440856933594, obj_val: 80.50752258300781, abs dis: 4.776885986328125
[rfa agg] iter:  5, weight: tensor([0.1863, 0.1639, 0.1610, 0.0623, 0.1091, 0.0751, 0.0427, 0.0347, 0.0543,
        0.1107])
[rfa agg] iter:  6, prev_obj_val: 80.50752258300781, obj_val: 82.72834014892578, abs dis: 2.2208175659179688
[rfa agg] iter:  6, weight: tensor([0.1753, 0.2232, 0.2119, 0.0657, 0.0712, 0.0513, 0.0418, 0.0328, 0.0558,
        0.0711])
[rfa agg] iter:  7, prev_obj_val: 82.72834014892578, obj_val: 82.72250366210938, abs dis: 0.00583648681640625
[rfa agg] iter:  7, weight: tensor([0.1912, 0.1945, 0.1883, 0.0632, 0.0860, 0.0607, 0.0418, 0.0334, 0.0544,
        0.0866])
[rfa agg] iter:  8, prev_obj_val: 82.72250366210938, obj_val: 85.25960540771484, abs dis: 2.5371017456054688
[rfa agg] iter:  8, weight: tensor([0.1962, 0.1912, 0.1855, 0.0631, 0.0866, 0.0609, 0.0417, 0.0334, 0.0543,
        0.0871])
[rfa agg] iter:  9, prev_obj_val: 85.25960540771484, obj_val: 80.51033782958984, abs dis: 4.749267578125
[rfa agg] iter:  9, weight: tensor([0.1937, 0.1600, 0.1577, 0.0618, 0.1098, 0.0749, 0.0424, 0.0345, 0.0539,
        0.1115])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.0105, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 12.5002, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.0151093006134 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0815, Accuracy: 67/631 (10.6181%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0450, Accuracy: 217/631 (34.3899%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1674, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 634/1030 (61.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.9191, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0626, Accuracy: 241/1402 (17.1897%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 356/1402 (25.3923%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1112, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0659, Accuracy: 267/946 (28.2241%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 377/946 (39.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4195, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0655, Accuracy: 261/715 (36.5035%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0426, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7037, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0633, Accuracy: 320/1657 (19.3120%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0366, Accuracy: 515/1657 (31.0803%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.6255, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 573/1645 (34.8328%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.5808, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 310/896 (34.5982%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0355, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0652, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0777, Accuracy: 136/773 (17.5938%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0370, Accuracy: 370/773 (47.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.6553, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0544, Accuracy: 238/590 (40.3390%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.3304, Accuracy: 50/10000 (0.5000%)
time spent on training: 154.14542984962463
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 91, 66, 43, 23, 0, 13, 89, 99, 69], weight: tensor([0.0614, 0.1001, 0.1363, 0.0920, 0.0695, 0.1611, 0.1599, 0.0871, 0.0752,
        0.0574])
[rfa agg] iter:  0, prev_obj_val: 54.146827697753906, obj_val: 58.255714416503906, abs dis: 4.10888671875
[rfa agg] iter:  0, weight: tensor([0.0422, 0.1698, 0.0919, 0.2181, 0.0681, 0.0672, 0.0665, 0.1455, 0.0914,
        0.0394])
[rfa agg] iter:  1, prev_obj_val: 58.255714416503906, obj_val: 62.224918365478516, abs dis: 3.9692039489746094
[rfa agg] iter:  1, weight: tensor([0.0519, 0.0978, 0.0593, 0.1971, 0.0947, 0.0474, 0.0470, 0.2218, 0.1347,
        0.0483])
[rfa agg] iter:  2, prev_obj_val: 62.224918365478516, obj_val: 62.19427490234375, abs dis: 0.030643463134765625
[rfa agg] iter:  2, weight: tensor([0.0693, 0.0804, 0.0546, 0.1415, 0.1328, 0.0452, 0.0448, 0.1965, 0.1709,
        0.0641])
[rfa agg] iter:  3, prev_obj_val: 62.19427490234375, obj_val: 62.19355010986328, abs dis: 0.00072479248046875
[rfa agg] iter:  3, weight: tensor([0.0692, 0.0793, 0.0541, 0.1380, 0.1376, 0.0449, 0.0444, 0.1895, 0.1790,
        0.0640])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.9249, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 11.8663, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.95787286758423 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0551, Accuracy: 398/1440 (27.6389%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0291, Accuracy: 690/1440 (47.9167%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9786, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 57/460 (12.3913%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 182/460 (39.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5643, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0592, Accuracy: 311/1662 (18.7124%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 577/1662 (34.7172%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5976, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0636, Accuracy: 355/1657 (21.4243%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0363, Accuracy: 511/1657 (30.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3407, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0546, Accuracy: 526/2227 (23.6192%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 926/2227 (41.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5631, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0558, Accuracy: 347/1949 (17.8040%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 567/1949 (29.0918%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0955, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 10/373 (2.6810%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 144/373 (38.6059%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6010, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0776, Accuracy: 75/426 (17.6056%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0434, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2623, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.1014, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0705, Accuracy: 84/311 (27.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0000, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 54/486 (11.1111%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0395, Accuracy: 234/486 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.3902, Accuracy: 63/10000 (0.6300%)
time spent on training: 159.62569880485535
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 31, 94, 0, 60, 21, 98, 67, 96, 30], weight: tensor([0.1310, 0.0419, 0.1512, 0.1508, 0.2026, 0.1773, 0.0339, 0.0388, 0.0283,
        0.0442])
[rfa agg] iter:  0, prev_obj_val: 79.01124572753906, obj_val: 72.46685028076172, abs dis: 6.544395446777344
[rfa agg] iter:  0, weight: tensor([0.3292, 0.0174, 0.1989, 0.1966, 0.0901, 0.1125, 0.0123, 0.0150, 0.0096,
        0.0184])
[rfa agg] iter:  1, prev_obj_val: 72.46685028076172, obj_val: 72.45648193359375, abs dis: 0.01036834716796875
[rfa agg] iter:  1, weight: tensor([0.3440, 0.0119, 0.2183, 0.2110, 0.0765, 0.1001, 0.0085, 0.0104, 0.0067,
        0.0126])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 12.8717, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 14.0905, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.5928180217743 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0595, Accuracy: 269/1446 (18.6030%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0355, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9456, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0822, Accuracy: 94/669 (14.0508%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0428, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5494, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0570, Accuracy: 329/1036 (31.7568%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 669/1036 (64.5753%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 13.1594, Accuracy: 71/10000 (0.7100%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 404/1574 (25.6671%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 646/1574 (41.0419%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8998, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0709, Accuracy: 234/1190 (19.6639%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.5276, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 213/1513 (14.0780%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/1513 (28.9491%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2299, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0667, Accuracy: 201/677 (29.6898%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.7530, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0847, Accuracy: 46/682 (6.7449%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.4236, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0320, Accuracy: 423/803 (52.6775%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2531, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0832, Accuracy: 49/631 (7.7655%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0455, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9605, Accuracy: 72/10000 (0.7200%)
time spent on training: 168.53651785850525
[rfa agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[rfa agg] considering poison per batch poison_fraction: 0.04812396047353487
[rfa agg] init. name: [26, 45, 19, 17, 84, 8, 90, 80, 58, 48], weight: tensor([0.1415, 0.0655, 0.1014, 0.1540, 0.1164, 0.1480, 0.0662, 0.0667, 0.0786,
        0.0617])
[rfa agg] iter:  0, prev_obj_val: 52.9813232421875, obj_val: 55.07119369506836, abs dis: 2.0898704528808594
[rfa agg] iter:  0, weight: tensor([0.1010, 0.0551, 0.2478, 0.0862, 0.1583, 0.0920, 0.0565, 0.0567, 0.1015,
        0.0449])
[rfa agg] iter:  1, prev_obj_val: 55.07119369506836, obj_val: 57.71939468383789, abs dis: 2.6482009887695312
[rfa agg] iter:  1, weight: tensor([0.0893, 0.0661, 0.2257, 0.0780, 0.1337, 0.0824, 0.0683, 0.0685, 0.1348,
        0.0531])
[rfa agg] iter:  2, prev_obj_val: 57.71939468383789, obj_val: 62.46002197265625, abs dis: 4.740627288818359
[rfa agg] iter:  2, weight: tensor([0.0783, 0.0808, 0.1640, 0.0699, 0.1093, 0.0733, 0.0845, 0.0845, 0.1922,
        0.0632])
[rfa agg] iter:  3, prev_obj_val: 62.46002197265625, obj_val: 64.33281707763672, abs dis: 1.8727951049804688
[rfa agg] iter:  3, weight: tensor([0.0559, 0.1011, 0.0936, 0.0512, 0.0719, 0.0532, 0.1106, 0.1096, 0.2775,
        0.0755])
[rfa agg] iter:  4, prev_obj_val: 64.33281707763672, obj_val: 66.54176330566406, abs dis: 2.2089462280273438
[rfa agg] iter:  4, weight: tensor([0.0492, 0.1118, 0.0772, 0.0454, 0.0615, 0.0470, 0.1275, 0.1253, 0.2731,
        0.0819])
[rfa agg] iter:  5, prev_obj_val: 66.54176330566406, obj_val: 66.5282211303711, abs dis: 0.01354217529296875
[rfa agg] iter:  5, weight: tensor([0.0461, 0.1294, 0.0689, 0.0427, 0.0564, 0.0442, 0.1560, 0.1514, 0.2097,
        0.0953])
[rfa agg] iter:  6, prev_obj_val: 66.5282211303711, obj_val: 66.52806854248047, abs dis: 0.000152587890625
[rfa agg] iter:  6, weight: tensor([0.0459, 0.1318, 0.0685, 0.0426, 0.0562, 0.0440, 0.1593, 0.1540, 0.2020,
        0.0956])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 14.7644, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 18.8653, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.1927762031555 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.1026, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0551, Accuracy: 100/338 (29.5858%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8713, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1093, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0907, Accuracy: 36/197 (18.2741%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.9248, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0612, Accuracy: 207/590 (35.0847%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0281, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 12.0264, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1387, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1205, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1212, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0667, Accuracy: 258/1340 (19.2537%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0294, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.0982, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0644, Accuracy: 200/1071 (18.6741%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 472/1071 (44.0710%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.1227, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0940, Accuracy: 15/408 (3.6765%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0563, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5884, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0787, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 197/500 (39.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8992, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0818, Accuracy: 94/669 (14.0508%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7588, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0620, Accuracy: 290/1089 (26.6299%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 499/1089 (45.8219%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.2028, Accuracy: 81/10000 (0.8100%)
time spent on training: 133.70121479034424
[rfa agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 79, 69, 47, 77, 55, 36, 82, 45, 59], weight: tensor([0.0533, 0.0311, 0.0931, 0.0211, 0.2115, 0.1690, 0.0644, 0.0789, 0.1056,
        0.1719])
[rfa agg] iter:  0, prev_obj_val: 54.166969299316406, obj_val: 59.397613525390625, abs dis: 5.230644226074219
[rfa agg] iter:  0, weight: tensor([0.0392, 0.0163, 0.1955, 0.0096, 0.0946, 0.1258, 0.0577, 0.0895, 0.2687,
        0.1031])
[rfa agg] iter:  1, prev_obj_val: 59.397613525390625, obj_val: 61.35865783691406, abs dis: 1.9610443115234375
[rfa agg] iter:  1, weight: tensor([0.0499, 0.0183, 0.2690, 0.0103, 0.0686, 0.0827, 0.0819, 0.1451, 0.2031,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 61.35865783691406, obj_val: 63.609474182128906, abs dis: 2.2508163452148438
[rfa agg] iter:  2, weight: tensor([0.0574, 0.0200, 0.2443, 0.0110, 0.0659, 0.0778, 0.0995, 0.1910, 0.1656,
        0.0675])
[rfa agg] iter:  3, prev_obj_val: 63.609474182128906, obj_val: 66.06391143798828, abs dis: 2.454437255859375
[rfa agg] iter:  3, weight: tensor([0.0660, 0.0216, 0.1924, 0.0118, 0.0634, 0.0735, 0.1211, 0.2464, 0.1395,
        0.0643])
[rfa agg] iter:  4, prev_obj_val: 66.06391143798828, obj_val: 66.04032897949219, abs dis: 0.02358245849609375
[rfa agg] iter:  4, weight: tensor([0.0749, 0.0229, 0.1495, 0.0122, 0.0592, 0.0676, 0.1465, 0.2909, 0.1166,
        0.0597])
[rfa agg] iter:  5, prev_obj_val: 66.04032897949219, obj_val: 66.03889465332031, abs dis: 0.001434326171875
[rfa agg] iter:  5, weight: tensor([0.0739, 0.0224, 0.1424, 0.0120, 0.0572, 0.0653, 0.1473, 0.3098, 0.1120,
        0.0576])
[rfa agg] iter:  6, prev_obj_val: 66.03889465332031, obj_val: 63.5991325378418, abs dis: 2.4397621154785156
[rfa agg] iter:  6, weight: tensor([0.0733, 0.0222, 0.1406, 0.0119, 0.0567, 0.0647, 0.1465, 0.3164, 0.1107,
        0.0570])
[rfa agg] iter:  7, prev_obj_val: 63.5991325378418, obj_val: 66.05018615722656, abs dis: 2.4510536193847656
[rfa agg] iter:  7, weight: tensor([0.0650, 0.0210, 0.1742, 0.0114, 0.0603, 0.0699, 0.1222, 0.2847, 0.1300,
        0.0611])
[rfa agg] iter:  8, prev_obj_val: 66.05018615722656, obj_val: 66.0393295288086, abs dis: 0.01085662841796875
[rfa agg] iter:  8, weight: tensor([0.0740, 0.0226, 0.1459, 0.0121, 0.0581, 0.0663, 0.1454, 0.3030, 0.1141,
        0.0585])
[rfa agg] iter:  9, prev_obj_val: 66.0393295288086, obj_val: 63.59837341308594, abs dis: 2.4409561157226562
[rfa agg] iter:  9, weight: tensor([0.0736, 0.0223, 0.1414, 0.0119, 0.0569, 0.0649, 0.1467, 0.3138, 0.1112,
        0.0573])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 14.6220, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 19.4720, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.4289312362671 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0580, Accuracy: 275/1130 (24.3363%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 496/1130 (43.8938%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.4184, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0599, Accuracy: 220/712 (30.8989%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0284, Accuracy: 432/712 (60.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.2079, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0838, Accuracy: 12/440 (2.7273%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0496, Accuracy: 140/440 (31.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6894, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0684, Accuracy: 119/818 (14.5477%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 338/818 (41.3203%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.1184, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 309/1645 (18.7842%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 575/1645 (34.9544%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.8291, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.1010, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0559, Accuracy: 105/312 (33.6538%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6780, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0793, Accuracy: 51/631 (8.0824%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0445, Accuracy: 233/631 (36.9255%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7237, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0794, Accuracy: 39/486 (8.0247%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0429, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.8150, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 60/466 (12.8755%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0544, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9557, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0622, Accuracy: 212/1071 (19.7946%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 492/1071 (45.9384%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.1929, Accuracy: 78/10000 (0.7800%)
time spent on training: 143.08306503295898
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 11, 49, 71, 13, 24, 48, 30, 76, 55], weight: tensor([0.1465, 0.0923, 0.0571, 0.1061, 0.2133, 0.0405, 0.0818, 0.0630, 0.0604,
        0.1389])
[rfa agg] iter:  0, prev_obj_val: 55.21861267089844, obj_val: 59.689598083496094, abs dis: 4.470985412597656
[rfa agg] iter:  0, weight: tensor([0.1089, 0.1890, 0.0358, 0.2716, 0.0638, 0.0188, 0.0966, 0.0473, 0.0450,
        0.1234])
[rfa agg] iter:  1, prev_obj_val: 59.689598083496094, obj_val: 63.3944091796875, abs dis: 3.7048110961914062
[rfa agg] iter:  1, weight: tensor([0.0782, 0.2098, 0.0498, 0.1755, 0.0541, 0.0235, 0.1851, 0.0715, 0.0673,
        0.0851])
[rfa agg] iter:  2, prev_obj_val: 63.3944091796875, obj_val: 65.56015014648438, abs dis: 2.165740966796875
[rfa agg] iter:  2, weight: tensor([0.0684, 0.1471, 0.0634, 0.1238, 0.0505, 0.0273, 0.2584, 0.0978, 0.0903,
        0.0731])
[rfa agg] iter:  3, prev_obj_val: 65.56015014648438, obj_val: 67.99597930908203, abs dis: 2.4358291625976562
[rfa agg] iter:  3, weight: tensor([0.0640, 0.1211, 0.0736, 0.1067, 0.0486, 0.0297, 0.2613, 0.1190, 0.1081,
        0.0679])
[rfa agg] iter:  4, prev_obj_val: 67.99597930908203, obj_val: 65.56105041503906, abs dis: 2.4349288940429688
[rfa agg] iter:  4, weight: tensor([0.0618, 0.1064, 0.0886, 0.0965, 0.0482, 0.0332, 0.2164, 0.1505, 0.1333,
        0.0651])
[rfa agg] iter:  5, prev_obj_val: 65.56105041503906, obj_val: 67.98998260498047, abs dis: 2.4289321899414062
[rfa agg] iter:  5, weight: tensor([0.0640, 0.1192, 0.0757, 0.1059, 0.0487, 0.0302, 0.2494, 0.1255, 0.1136,
        0.0678])
[rfa agg] iter:  6, prev_obj_val: 67.98998260498047, obj_val: 65.56193542480469, abs dis: 2.4280471801757812
[rfa agg] iter:  6, weight: tensor([0.0617, 0.1063, 0.0888, 0.0964, 0.0481, 0.0333, 0.2144, 0.1517, 0.1343,
        0.0651])
[rfa agg] iter:  7, prev_obj_val: 65.56193542480469, obj_val: 67.9898452758789, abs dis: 2.4279098510742188
[rfa agg] iter:  7, weight: tensor([0.0640, 0.1192, 0.0757, 0.1060, 0.0487, 0.0302, 0.2489, 0.1256, 0.1138,
        0.0678])
[rfa agg] iter:  8, prev_obj_val: 67.9898452758789, obj_val: 65.56195068359375, abs dis: 2.4278945922851562
[rfa agg] iter:  8, weight: tensor([0.0617, 0.1063, 0.0888, 0.0964, 0.0481, 0.0333, 0.2143, 0.1517, 0.1343,
        0.0651])
[rfa agg] iter:  9, prev_obj_val: 65.56195068359375, obj_val: 67.9898452758789, abs dis: 2.4278945922851562
[rfa agg] iter:  9, weight: tensor([0.0640, 0.1192, 0.0757, 0.1060, 0.0487, 0.0302, 0.2489, 0.1256, 0.1138,
        0.0679])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 14.2766, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 18.6495, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.21996092796326 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0560, Accuracy: 337/803 (41.9676%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8373, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0599, Accuracy: 223/712 (31.3202%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 11.3548, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0658, Accuracy: 221/928 (23.8147%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 587/928 (63.2543%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.4317, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0645, Accuracy: 245/1402 (17.4750%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0398, Accuracy: 353/1402 (25.1783%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0353, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0775, Accuracy: 55/631 (8.7163%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0425, Accuracy: 238/631 (37.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4035, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0701, Accuracy: 115/818 (14.0587%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0318, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.9277, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0858, Accuracy: 42/515 (8.1553%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0563, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.2111, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.1019, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0567, Accuracy: 100/338 (29.5858%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8978, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0703, Accuracy: 213/719 (29.6245%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0376, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.4574, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0661, Accuracy: 327/1956 (16.7178%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 595/1956 (30.4192%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.5159, Accuracy: 106/10000 (1.0600%)
time spent on training: 150.84022092819214
[rfa agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 11, 1, 66, 48, 71, 33, 12, 41, 6], weight: tensor([0.0910, 0.0807, 0.1052, 0.1589, 0.0715, 0.0927, 0.0584, 0.0383, 0.0815,
        0.2217])
[rfa agg] iter:  0, prev_obj_val: 63.07449722290039, obj_val: 62.96498107910156, abs dis: 0.10951614379882812
[rfa agg] iter:  0, weight: tensor([0.1540, 0.0981, 0.2337, 0.0918, 0.0577, 0.1544, 0.0388, 0.0172, 0.0967,
        0.0577])
[rfa agg] iter:  1, prev_obj_val: 62.96498107910156, obj_val: 68.65023040771484, abs dis: 5.685249328613281
[rfa agg] iter:  1, weight: tensor([0.2025, 0.1188, 0.1534, 0.0590, 0.0616, 0.1973, 0.0386, 0.0158, 0.1123,
        0.0407])
[rfa agg] iter:  2, prev_obj_val: 68.65023040771484, obj_val: 71.04960632324219, abs dis: 2.3993759155273438
[rfa agg] iter:  2, weight: tensor([0.1552, 0.1658, 0.0887, 0.0495, 0.1196, 0.1522, 0.0620, 0.0213, 0.1481,
        0.0376])
[rfa agg] iter:  3, prev_obj_val: 71.04960632324219, obj_val: 71.04224395751953, abs dis: 0.00736236572265625
[rfa agg] iter:  3, weight: tensor([0.1346, 0.1591, 0.0822, 0.0495, 0.1594, 0.1314, 0.0754, 0.0244, 0.1457,
        0.0384])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 16.2414, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 16.9658, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.5953288078308 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0558, Accuracy: 233/712 (32.7247%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.3614, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0533, Accuracy: 559/2227 (25.1010%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 938/2227 (42.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8245, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0657, Accuracy: 255/946 (26.9556%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0374, Accuracy: 338/946 (35.7294%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5583, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0883, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0549, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8963, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0635, Accuracy: 227/1372 (16.5452%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0596, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 197/1049 (18.7798%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 527/1049 (50.2383%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.3179, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0862, Accuracy: 43/515 (8.3495%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0566, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9343, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0556, Accuracy: 277/1030 (26.8932%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 627/1030 (60.8738%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.1805, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0628, Accuracy: 318/1418 (22.4260%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 650/1418 (45.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5797, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0631, Accuracy: 151/861 (17.5377%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 457/861 (53.0778%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.3916, Accuracy: 93/10000 (0.9300%)
time spent on training: 165.42640376091003
[rfa agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 60, 43, 76, 42, 51, 33, 91, 70, 10], weight: tensor([0.0672, 0.2102, 0.0893, 0.0440, 0.1295, 0.0990, 0.0486, 0.0972, 0.1338,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 66.16864776611328, obj_val: 68.82087707519531, abs dis: 2.6522293090820312
[rfa agg] iter:  0, weight: tensor([0.0504, 0.0574, 0.1191, 0.0202, 0.1339, 0.2018, 0.0246, 0.1920, 0.1139,
        0.0867])
[rfa agg] iter:  1, prev_obj_val: 68.82087707519531, obj_val: 71.91790008544922, abs dis: 3.0970230102539062
[rfa agg] iter:  1, weight: tensor([0.0633, 0.0451, 0.1765, 0.0219, 0.0842, 0.1978, 0.0272, 0.1850, 0.0748,
        0.1242])
[rfa agg] iter:  2, prev_obj_val: 71.91790008544922, obj_val: 73.82904052734375, abs dis: 1.9111404418945312
[rfa agg] iter:  2, weight: tensor([0.0802, 0.0429, 0.2174, 0.0249, 0.0730, 0.1500, 0.0313, 0.1439, 0.0661,
        0.1703])
[rfa agg] iter:  3, prev_obj_val: 73.82904052734375, obj_val: 78.57598114013672, abs dis: 4.746940612792969
[rfa agg] iter:  3, weight: tensor([0.0921, 0.0416, 0.2238, 0.0265, 0.0680, 0.1272, 0.0336, 0.1233, 0.0620,
        0.2021])
[rfa agg] iter:  4, prev_obj_val: 78.57598114013672, obj_val: 81.28825378417969, abs dis: 2.7122726440429688
[rfa agg] iter:  4, weight: tensor([0.1344, 0.0426, 0.1840, 0.0330, 0.0649, 0.1074, 0.0427, 0.1047, 0.0600,
        0.2265])
[rfa agg] iter:  5, prev_obj_val: 81.28825378417969, obj_val: 81.28175354003906, abs dis: 0.006500244140625
[rfa agg] iter:  5, weight: tensor([0.1700, 0.0436, 0.1617, 0.0377, 0.0644, 0.1011, 0.0492, 0.0985, 0.0598,
        0.2141])
[rfa agg] iter:  6, prev_obj_val: 81.28175354003906, obj_val: 81.28165435791016, abs dis: 9.918212890625e-05
[rfa agg] iter:  6, weight: tensor([0.1750, 0.0434, 0.1601, 0.0376, 0.0642, 0.1008, 0.0492, 0.0981, 0.0596,
        0.2119])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 23.0514, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 26.3127, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.8968894481659 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0670, Accuracy: 141/735 (19.1837%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.8185, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0563, Accuracy: 314/803 (39.1034%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2168, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0600, Accuracy: 282/1662 (16.9675%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0344, Accuracy: 563/1662 (33.8748%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.1686, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 214/1049 (20.4004%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 537/1049 (51.1916%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.5530, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.1011, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0563, Accuracy: 118/312 (37.8205%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7348, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0669, Accuracy: 227/1340 (16.9403%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0286, Accuracy: 549/1340 (40.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.5125, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0635, Accuracy: 228/690 (33.0435%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0303, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.3170, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0592, Accuracy: 386/1904 (20.2731%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 676/1904 (35.5042%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0084, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0636, Accuracy: 305/1657 (18.4068%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0369, Accuracy: 465/1657 (28.0628%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4006, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0567, Accuracy: 372/1953 (19.0476%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 738/1953 (37.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3549, Accuracy: 115/10000 (1.1500%)
time spent on training: 175.70731949806213
[rfa agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 58, 94, 51, 24, 77, 25, 46, 0, 83], weight: tensor([0.0607, 0.0663, 0.1373, 0.0867, 0.0258, 0.1107, 0.0570, 0.1573, 0.1369,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 66.2104263305664, obj_val: 70.38871765136719, abs dis: 4.178291320800781
[rfa agg] iter:  0, weight: tensor([0.0387, 0.0476, 0.1456, 0.1098, 0.0092, 0.2805, 0.0329, 0.0990, 0.1448,
        0.0919])
[rfa agg] iter:  1, prev_obj_val: 70.38871765136719, obj_val: 68.79228210449219, abs dis: 1.596435546875
[rfa agg] iter:  1, weight: tensor([0.0477, 0.0600, 0.1206, 0.1535, 0.0105, 0.2758, 0.0398, 0.0886, 0.1200,
        0.0833])
[rfa agg] iter:  2, prev_obj_val: 68.79228210449219, obj_val: 68.78707885742188, abs dis: 0.0052032470703125
[rfa agg] iter:  2, weight: tensor([0.0434, 0.0542, 0.1246, 0.1361, 0.0098, 0.2981, 0.0364, 0.0895, 0.1239,
        0.0839])
[rfa agg] iter:  3, prev_obj_val: 68.78707885742188, obj_val: 68.78683471679688, abs dis: 0.000244140625
[rfa agg] iter:  3, weight: tensor([0.0432, 0.0538, 0.1238, 0.1339, 0.0098, 0.3039, 0.0362, 0.0890, 0.1232,
        0.0834])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 13.1326, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 14.0724, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.704895734787 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0616, Accuracy: 282/1340 (21.0448%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 568/1340 (42.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0078, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 84/781 (10.7554%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.3521, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0674, Accuracy: 212/1131 (18.7445%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 505/1131 (44.6508%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.8220, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0699, Accuracy: 214/719 (29.7636%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0337, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0732, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0555, Accuracy: 329/803 (40.9714%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0334, Accuracy: 432/803 (53.7983%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0901, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0639, Accuracy: 221/1241 (17.8082%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 387/1241 (31.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5699, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0853, Accuracy: 28/515 (5.4369%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0513, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6297, Accuracy: 58/10000 (0.5800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 374/1574 (23.7611%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 632/1574 (40.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0721, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0621, Accuracy: 231/1131 (20.4244%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0331, Accuracy: 387/1131 (34.2175%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.8119, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0621, Accuracy: 245/1372 (17.8571%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0331, Accuracy: 505/1372 (36.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0656, Accuracy: 74/10000 (0.7400%)
time spent on training: 178.88202214241028
[rfa agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.04637267841991138
[rfa agg] init. name: [77, 3, 38, 41, 58, 72, 33, 17, 87, 42], weight: tensor([0.1263, 0.0736, 0.1066, 0.0678, 0.0757, 0.1170, 0.0486, 0.1484, 0.1066,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 50.06031036376953, obj_val: 49.97719955444336, abs dis: 0.08311080932617188
[rfa agg] iter:  0, weight: tensor([0.0906, 0.1270, 0.1345, 0.0851, 0.1373, 0.1017, 0.0350, 0.0670, 0.1406,
        0.0813])
[rfa agg] iter:  1, prev_obj_val: 49.97719955444336, obj_val: 49.97713088989258, abs dis: 6.866455078125e-05
[rfa agg] iter:  1, weight: tensor([0.0892, 0.1296, 0.1347, 0.0851, 0.1397, 0.1005, 0.0347, 0.0660, 0.1406,
        0.0800])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 15.3711, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 18.6394, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.19817328453064 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0492, Accuracy: 340/891 (38.1594%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 442/891 (49.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.5541, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0663, Accuracy: 222/708 (31.3559%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 423/708 (59.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0504, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0611, Accuracy: 282/1446 (19.5021%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0366, Accuracy: 467/1446 (32.2960%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4642, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 317/803 (39.4770%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0352, Accuracy: 423/803 (52.6775%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2564, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0642, Accuracy: 263/946 (27.8013%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 368/946 (38.9006%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7770, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0850, Accuracy: 37/460 (8.0435%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0396, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.6561, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0600, Accuracy: 263/1030 (25.5340%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0290, Accuracy: 593/1030 (57.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.4783, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0635, Accuracy: 344/1475 (23.3220%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 629/1475 (42.6441%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2231, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0627, Accuracy: 286/1418 (20.1693%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0326, Accuracy: 585/1418 (41.2553%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7000, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0695, Accuracy: 124/818 (15.1589%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0326, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.0716, Accuracy: 58/10000 (0.5800%)
time spent on training: 166.56208395957947
[rfa agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 16, 26, 58, 43, 31, 91, 65, 70, 71], weight: tensor([0.0891, 0.0708, 0.1447, 0.0803, 0.0946, 0.0460, 0.1031, 0.1476, 0.1419,
        0.0818])
[rfa agg] iter:  0, prev_obj_val: 47.790958404541016, obj_val: 50.972904205322266, abs dis: 3.18194580078125
[rfa agg] iter:  0, weight: tensor([0.1480, 0.0689, 0.0717, 0.1037, 0.1997, 0.0228, 0.1510, 0.0648, 0.0700,
        0.0994])
[rfa agg] iter:  1, prev_obj_val: 50.972904205322266, obj_val: 52.77244567871094, abs dis: 1.7995414733886719
[rfa agg] iter:  1, weight: tensor([0.1831, 0.0891, 0.0526, 0.1505, 0.1779, 0.0245, 0.0955, 0.0484, 0.0514,
        0.1269])
[rfa agg] iter:  2, prev_obj_val: 52.77244567871094, obj_val: 57.70846939086914, abs dis: 4.936023712158203
[rfa agg] iter:  2, weight: tensor([0.1771, 0.1025, 0.0489, 0.1806, 0.1488, 0.0261, 0.0823, 0.0452, 0.0478,
        0.1406])
[rfa agg] iter:  3, prev_obj_val: 57.70846939086914, obj_val: 55.018192291259766, abs dis: 2.690277099609375
[rfa agg] iter:  3, weight: tensor([0.1437, 0.1424, 0.0477, 0.2005, 0.1150, 0.0333, 0.0727, 0.0444, 0.0466,
        0.1538])
[rfa agg] iter:  4, prev_obj_val: 55.018192291259766, obj_val: 57.68742370605469, abs dis: 2.669231414794922
[rfa agg] iter:  4, weight: tensor([0.1509, 0.1247, 0.0468, 0.2077, 0.1239, 0.0286, 0.0744, 0.0434, 0.0457,
        0.1537])
[rfa agg] iter:  5, prev_obj_val: 57.68742370605469, obj_val: 55.01924133300781, abs dis: 2.668182373046875
[rfa agg] iter:  5, weight: tensor([0.1392, 0.1450, 0.0472, 0.2052, 0.1130, 0.0330, 0.0717, 0.0439, 0.0461,
        0.1556])
[rfa agg] iter:  6, prev_obj_val: 55.01924133300781, obj_val: 55.01582336425781, abs dis: 0.00341796875
[rfa agg] iter:  6, weight: tensor([0.1500, 0.1249, 0.0468, 0.2088, 0.1237, 0.0286, 0.0743, 0.0434, 0.0457,
        0.1540])
[rfa agg] iter:  7, prev_obj_val: 55.01582336425781, obj_val: 57.68793487548828, abs dis: 2.6721115112304688
[rfa agg] iter:  7, weight: tensor([0.1517, 0.1227, 0.0468, 0.2090, 0.1244, 0.0286, 0.0744, 0.0434, 0.0457,
        0.1531])
[rfa agg] iter:  8, prev_obj_val: 57.68793487548828, obj_val: 55.01917266845703, abs dis: 2.66876220703125
[rfa agg] iter:  8, weight: tensor([0.1393, 0.1448, 0.0472, 0.2055, 0.1130, 0.0330, 0.0717, 0.0439, 0.0461,
        0.1554])
[rfa agg] iter:  9, prev_obj_val: 55.01917266845703, obj_val: 55.01582336425781, abs dis: 0.00334930419921875
[rfa agg] iter:  9, weight: tensor([0.1500, 0.1248, 0.0468, 0.2088, 0.1237, 0.0286, 0.0743, 0.0434, 0.0457,
        0.1539])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 16.4720, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 18.2664, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.441166639328 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0603, Accuracy: 271/1030 (26.3107%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 626/1030 (60.7767%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.7474, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0534, Accuracy: 342/1275 (26.8235%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 660/1275 (51.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 12.3293, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0986, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0537, Accuracy: 159/416 (38.2212%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.8860, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0735, Accuracy: 204/774 (26.3566%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0410, Accuracy: 325/774 (41.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6484, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0606, Accuracy: 261/1130 (23.0973%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 491/1130 (43.4513%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.2045, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0681, Accuracy: 205/928 (22.0905%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.6758, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 216/888 (24.3243%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 445/888 (50.1126%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.5741, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0561, Accuracy: 365/1953 (18.6892%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 781/1953 (39.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4437, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0660, Accuracy: 257/946 (27.1670%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 365/946 (38.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9075, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0706, Accuracy: 131/953 (13.7461%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4744, Accuracy: 74/10000 (0.7400%)
time spent on training: 168.2095808982849
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 9, 78, 81, 54, 1, 63, 83, 43, 64], weight: tensor([0.1001, 0.1239, 0.0404, 0.0752, 0.1098, 0.0902, 0.0863, 0.1897, 0.0919,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 50.960472106933594, obj_val: 54.48616027832031, abs dis: 3.5256881713867188
[rfa agg] iter:  0, weight: tensor([0.0990, 0.0719, 0.0152, 0.0878, 0.1001, 0.1147, 0.1294, 0.0370, 0.1736,
        0.1713])
[rfa agg] iter:  1, prev_obj_val: 54.48616027832031, obj_val: 60.099796295166016, abs dis: 5.613636016845703
[rfa agg] iter:  1, weight: tensor([0.0826, 0.0622, 0.0175, 0.1184, 0.0815, 0.1107, 0.1653, 0.0353, 0.1661,
        0.1604])
[rfa agg] iter:  2, prev_obj_val: 60.099796295166016, obj_val: 57.095359802246094, abs dis: 3.004436492919922
[rfa agg] iter:  2, weight: tensor([0.0793, 0.0631, 0.0234, 0.1641, 0.0780, 0.1072, 0.1709, 0.0390, 0.1389,
        0.1360])
[rfa agg] iter:  3, prev_obj_val: 57.095359802246094, obj_val: 60.08732604980469, abs dis: 2.9919662475585938
[rfa agg] iter:  3, weight: tensor([0.0792, 0.0615, 0.0199, 0.1509, 0.0781, 0.1075, 0.1756, 0.0365, 0.1476,
        0.1431])
[rfa agg] iter:  4, prev_obj_val: 60.08732604980469, obj_val: 57.096256256103516, abs dis: 2.991069793701172
[rfa agg] iter:  4, weight: tensor([0.0788, 0.0628, 0.0233, 0.1695, 0.0776, 0.1064, 0.1712, 0.0388, 0.1373,
        0.1343])
[rfa agg] iter:  5, prev_obj_val: 57.096256256103516, obj_val: 60.087181091308594, abs dis: 2.990924835205078
[rfa agg] iter:  5, weight: tensor([0.0792, 0.0615, 0.0199, 0.1517, 0.0780, 0.1073, 0.1755, 0.0365, 0.1474,
        0.1429])
[rfa agg] iter:  6, prev_obj_val: 60.087181091308594, obj_val: 57.096282958984375, abs dis: 2.9908981323242188
[rfa agg] iter:  6, weight: tensor([0.0788, 0.0628, 0.0233, 0.1696, 0.0776, 0.1064, 0.1711, 0.0388, 0.1373,
        0.1343])
[rfa agg] iter:  7, prev_obj_val: 57.096282958984375, obj_val: 60.08717346191406, abs dis: 2.9908905029296875
[rfa agg] iter:  7, weight: tensor([0.0791, 0.0615, 0.0199, 0.1518, 0.0780, 0.1073, 0.1754, 0.0365, 0.1474,
        0.1429])
[rfa agg] iter:  8, prev_obj_val: 60.08717346191406, obj_val: 57.09628677368164, abs dis: 2.990886688232422
[rfa agg] iter:  8, weight: tensor([0.0788, 0.0628, 0.0233, 0.1696, 0.0776, 0.1064, 0.1711, 0.0388, 0.1373,
        0.1343])
[rfa agg] iter:  9, prev_obj_val: 57.09628677368164, obj_val: 60.08717346191406, abs dis: 2.990886688232422
[rfa agg] iter:  9, weight: tensor([0.0791, 0.0615, 0.0199, 0.1518, 0.0780, 0.1073, 0.1754, 0.0365, 0.1474,
        0.1429])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 18.7703, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 20.4627, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 267.49277210235596 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0679, Accuracy: 242/1190 (20.3361%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 420/1190 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0890, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0967, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0541, Accuracy: 117/312 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9754, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 316/896 (35.2679%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1479, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0534, Accuracy: 351/1129 (31.0895%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 679/1129 (60.1417%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.4531, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0504, Accuracy: 389/1552 (25.0644%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 691/1552 (44.5232%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.2829, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0661, Accuracy: 317/1750 (18.1143%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0376, Accuracy: 624/1750 (35.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4971, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0610, Accuracy: 270/807 (33.4572%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0358, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2570, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0772, Accuracy: 88/809 (10.8776%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0292, Accuracy: 305/809 (37.7009%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.7169, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0604, Accuracy: 260/1154 (22.5303%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 438/1154 (37.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 11.2504, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 65/781 (8.3227%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.4588, Accuracy: 91/10000 (0.9100%)
time spent on training: 168.9994854927063
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 24, 89, 37, 74, 44, 20, 50, 15, 3], weight: tensor([0.1146, 0.0301, 0.0863, 0.1088, 0.1495, 0.1686, 0.0777, 0.0779, 0.1112,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 52.60444641113281, obj_val: 54.40913391113281, abs dis: 1.8046875
[rfa agg] iter:  0, weight: tensor([0.1495, 0.0107, 0.1094, 0.2107, 0.0803, 0.0668, 0.0787, 0.0795, 0.1380,
        0.0764])
[rfa agg] iter:  1, prev_obj_val: 54.40913391113281, obj_val: 58.70065689086914, abs dis: 4.291522979736328
[rfa agg] iter:  1, weight: tensor([0.1274, 0.0115, 0.1410, 0.1792, 0.0711, 0.0608, 0.0966, 0.0991, 0.1188,
        0.0946])
[rfa agg] iter:  2, prev_obj_val: 58.70065689086914, obj_val: 62.643619537353516, abs dis: 3.942962646484375
[rfa agg] iter:  2, weight: tensor([0.0884, 0.0120, 0.1950, 0.1109, 0.0562, 0.0496, 0.1324, 0.1398, 0.0841,
        0.1317])
[rfa agg] iter:  3, prev_obj_val: 62.643619537353516, obj_val: 62.60231018066406, abs dis: 0.041309356689453125
[rfa agg] iter:  3, weight: tensor([0.0669, 0.0119, 0.1940, 0.0796, 0.0461, 0.0414, 0.1596, 0.1740, 0.0644,
        0.1620])
[rfa agg] iter:  4, prev_obj_val: 62.60231018066406, obj_val: 62.60187530517578, abs dis: 0.00043487548828125
[rfa agg] iter:  4, weight: tensor([0.0648, 0.0116, 0.1924, 0.0770, 0.0450, 0.0404, 0.1628, 0.1781, 0.0625,
        0.1655])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 16.0057, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 17.5546, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 266.34036016464233 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0634, Accuracy: 249/1372 (18.1487%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0339, Accuracy: 510/1372 (37.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.0482, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0648, Accuracy: 232/1402 (16.5478%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0398, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.3147, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 282/1089 (25.8953%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0301, Accuracy: 460/1089 (42.2406%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.8742, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 44/460 (9.5652%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0403, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.8085, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0643, Accuracy: 335/1750 (19.1429%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 661/1750 (37.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6964, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0632, Accuracy: 352/1742 (20.2067%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0330, Accuracy: 672/1742 (38.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7220, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 195/1013 (19.2498%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 322/1013 (31.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3116, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 360/1129 (31.8866%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 694/1129 (61.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.7701, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0844, Accuracy: 42/515 (8.1553%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0605, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 11.4000, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0539, Accuracy: 361/1440 (25.0694%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0294, Accuracy: 681/1440 (47.2917%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.6759, Accuracy: 91/10000 (0.9100%)
time spent on training: 182.63688826560974
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 66, 59, 31, 44, 93, 14, 37, 33, 29], weight: tensor([0.1152, 0.1177, 0.0914, 0.0386, 0.1469, 0.1462, 0.0850, 0.0948, 0.0432,
        0.1209])
[rfa agg] iter:  0, prev_obj_val: 51.088287353515625, obj_val: 52.508506774902344, abs dis: 1.4202194213867188
[rfa agg] iter:  0, weight: tensor([0.1637, 0.1571, 0.1107, 0.0149, 0.0752, 0.0752, 0.0971, 0.1552, 0.0182,
        0.1328])
[rfa agg] iter:  1, prev_obj_val: 52.508506774902344, obj_val: 52.49887466430664, abs dis: 0.009632110595703125
[rfa agg] iter:  1, weight: tensor([0.1493, 0.1443, 0.1190, 0.0157, 0.0716, 0.0717, 0.1096, 0.1777, 0.0192,
        0.1219])
[rfa agg] iter:  2, prev_obj_val: 52.49887466430664, obj_val: 54.218963623046875, abs dis: 1.7200889587402344
[rfa agg] iter:  2, weight: tensor([0.1477, 0.1425, 0.1198, 0.0156, 0.0713, 0.0714, 0.1097, 0.1816, 0.0191,
        0.1211])
[rfa agg] iter:  3, prev_obj_val: 54.218963623046875, obj_val: 56.14314651489258, abs dis: 1.9241828918457031
[rfa agg] iter:  3, weight: tensor([0.1334, 0.1302, 0.1255, 0.0166, 0.0688, 0.0689, 0.1259, 0.1986, 0.0203,
        0.1118])
[rfa agg] iter:  4, prev_obj_val: 56.14314651489258, obj_val: 58.29452896118164, abs dis: 2.1513824462890625
[rfa agg] iter:  4, weight: tensor([0.1206, 0.1185, 0.1292, 0.0175, 0.0662, 0.0662, 0.1461, 0.2109, 0.0216,
        0.1032])
[rfa agg] iter:  5, prev_obj_val: 58.29452896118164, obj_val: 60.67393493652344, abs dis: 2.379405975341797
[rfa agg] iter:  5, weight: tensor([0.1106, 0.1093, 0.1302, 0.0187, 0.0641, 0.0641, 0.1718, 0.2116, 0.0231,
        0.0964])
[rfa agg] iter:  6, prev_obj_val: 60.67393493652344, obj_val: 58.29403305053711, abs dis: 2.379901885986328
[rfa agg] iter:  6, weight: tensor([0.1030, 0.1023, 0.1288, 0.0200, 0.0626, 0.0626, 0.2041, 0.2005, 0.0249,
        0.0911])
[rfa agg] iter:  7, prev_obj_val: 58.29403305053711, obj_val: 60.6722526550293, abs dis: 2.3782196044921875
[rfa agg] iter:  7, weight: tensor([0.1097, 0.1083, 0.1298, 0.0186, 0.0638, 0.0639, 0.1781, 0.2091, 0.0230,
        0.0958])
[rfa agg] iter:  8, prev_obj_val: 60.6722526550293, obj_val: 58.294288635253906, abs dis: 2.3779640197753906
[rfa agg] iter:  8, weight: tensor([0.1029, 0.1022, 0.1287, 0.0200, 0.0626, 0.0626, 0.2051, 0.1999, 0.0249,
        0.0910])
[rfa agg] iter:  9, prev_obj_val: 58.294288635253906, obj_val: 60.67222213745117, abs dis: 2.3779335021972656
[rfa agg] iter:  9, weight: tensor([0.1097, 0.1083, 0.1298, 0.0186, 0.0638, 0.0639, 0.1782, 0.2090, 0.0230,
        0.0958])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 17.9222, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 21.9636, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 276.5730435848236 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0587, Accuracy: 323/896 (36.0491%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 422/896 (47.0982%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3117, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0614, Accuracy: 265/1340 (19.7761%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0286, Accuracy: 551/1340 (41.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.2021, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0540, Accuracy: 401/1440 (27.8472%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0296, Accuracy: 682/1440 (47.3611%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.2748, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 221/776 (28.4794%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 404/776 (52.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.3485, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0596, Accuracy: 312/1662 (18.7726%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 588/1662 (35.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.8302, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0708, Accuracy: 69/781 (8.8348%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 252/781 (32.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.4126, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0656, Accuracy: 204/677 (30.1329%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 13.4447, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0661, Accuracy: 234/1013 (23.0997%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0299, Accuracy: 486/1013 (47.9763%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.9466, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0847, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 232/486 (47.7366%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.5636, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0611, Accuracy: 282/807 (34.9442%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0350, Accuracy: 436/807 (54.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0792, Accuracy: 77/10000 (0.7700%)
time spent on training: 169.2503743171692
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 77, 29, 75, 94, 3, 90, 39, 30, 20], weight: tensor([0.0907, 0.1357, 0.1458, 0.0786, 0.1683, 0.0791, 0.0685, 0.1026, 0.0492,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 50.269989013671875, obj_val: 55.920162200927734, abs dis: 5.650173187255859
[rfa agg] iter:  0, weight: tensor([0.1578, 0.0923, 0.0750, 0.1054, 0.0636, 0.1029, 0.0574, 0.2161, 0.0256,
        0.1038])
[rfa agg] iter:  1, prev_obj_val: 55.920162200927734, obj_val: 60.8250617980957, abs dis: 4.904899597167969
[rfa agg] iter:  1, weight: tensor([0.1627, 0.0557, 0.0485, 0.1656, 0.0437, 0.1536, 0.0887, 0.1035, 0.0313,
        0.1466])
[rfa agg] iter:  2, prev_obj_val: 60.8250617980957, obj_val: 60.80898666381836, abs dis: 0.01607513427734375
[rfa agg] iter:  2, weight: tensor([0.1300, 0.0539, 0.0479, 0.1620, 0.0439, 0.1543, 0.1320, 0.0865, 0.0411,
        0.1484])
[rfa agg] iter:  3, prev_obj_val: 60.80898666381836, obj_val: 58.09853744506836, abs dis: 2.71044921875
[rfa agg] iter:  3, weight: tensor([0.1271, 0.0536, 0.0476, 0.1607, 0.0437, 0.1549, 0.1367, 0.0857, 0.0411,
        0.1489])
[rfa agg] iter:  4, prev_obj_val: 58.09853744506836, obj_val: 58.09392547607422, abs dis: 0.004611968994140625
[rfa agg] iter:  4, weight: tensor([0.1370, 0.0528, 0.0465, 0.1709, 0.0423, 0.1631, 0.1096, 0.0891, 0.0348,
        0.1540])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 14.8716, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 18.1437, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.57302737236023 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0928, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0543, Accuracy: 117/373 (31.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.8448, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0592, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 517/1049 (49.2850%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.3498, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0640, Accuracy: 346/1742 (19.8622%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0330, Accuracy: 661/1742 (37.9449%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9395, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0683, Accuracy: 86/781 (11.0115%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 258/781 (33.0346%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.8359, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 182/1013 (17.9664%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 358/1013 (35.3406%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1818, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 42/460 (9.1304%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0389, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.9688, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0504, Accuracy: 245/888 (27.5901%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 454/888 (51.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.9222, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0647, Accuracy: 211/1154 (18.2842%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 491/1154 (42.5477%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.6543, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0905, Accuracy: 7/271 (2.5830%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0633, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.7381, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0879, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0700, Accuracy: 31/186 (16.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.4213, Accuracy: 40/10000 (0.4000%)
time spent on training: 154.39757919311523
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 51, 93, 3, 14, 31, 63, 57, 35, 56], weight: tensor([0.0471, 0.1325, 0.2200, 0.0986, 0.1280, 0.0581, 0.1122, 0.1458, 0.0342,
        0.0235])
[rfa agg] iter:  0, prev_obj_val: 57.041015625, obj_val: 60.78615188598633, abs dis: 3.745136260986328
[rfa agg] iter:  0, weight: tensor([0.0201, 0.1611, 0.0668, 0.1448, 0.2207, 0.0321, 0.2113, 0.1227, 0.0131,
        0.0073])
[rfa agg] iter:  1, prev_obj_val: 60.78615188598633, obj_val: 60.720428466796875, abs dis: 0.06572341918945312
[rfa agg] iter:  1, weight: tensor([0.0237, 0.1243, 0.0601, 0.2089, 0.1663, 0.0400, 0.2566, 0.0967, 0.0151,
        0.0082])
[rfa agg] iter:  2, prev_obj_val: 60.720428466796875, obj_val: 60.71916198730469, abs dis: 0.0012664794921875
[rfa agg] iter:  2, weight: tensor([0.0232, 0.1196, 0.0587, 0.2189, 0.1590, 0.0392, 0.2649, 0.0938, 0.0148,
        0.0080])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 16.7839, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 19.5952, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.93910908699036 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0664, Accuracy: 312/1581 (19.7343%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0357, Accuracy: 538/1581 (34.0291%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5487, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0878, Accuracy: 33/682 (4.8387%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 271/682 (39.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.9486, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0607, Accuracy: 270/1446 (18.6722%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0356, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1542, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0668, Accuracy: 206/928 (22.1983%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.5717, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0621, Accuracy: 350/1742 (20.0918%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0334, Accuracy: 628/1742 (36.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6520, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0651, Accuracy: 192/1071 (17.9272%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 509/1071 (47.5257%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.0896, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0589, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0340, Accuracy: 572/1645 (34.7720%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9425, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0929, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0537, Accuracy: 125/373 (33.5121%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9471, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1477, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1384, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.0749, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0677, Accuracy: 199/776 (25.6443%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 395/776 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.6442, Accuracy: 69/10000 (0.6900%)
time spent on training: 173.82167863845825
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 80, 26, 1, 93, 55, 13, 98, 61, 75], weight: tensor([0.1531, 0.0660, 0.1400, 0.0898, 0.1687, 0.1037, 0.1593, 0.0361, 0.0082,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 62.08682632446289, obj_val: 63.190895080566406, abs dis: 1.1040687561035156
[rfa agg] iter:  0, weight: tensor([0.1301, 0.0505, 0.1582, 0.1208, 0.1010, 0.2260, 0.1187, 0.0166, 0.0027,
        0.0754])
[rfa agg] iter:  1, prev_obj_val: 63.190895080566406, obj_val: 63.17576599121094, abs dis: 0.01512908935546875
[rfa agg] iter:  1, weight: tensor([0.1160, 0.0514, 0.1400, 0.1291, 0.0914, 0.2685, 0.1065, 0.0164, 0.0027,
        0.0780])
[rfa agg] iter:  2, prev_obj_val: 63.17576599121094, obj_val: 63.17521286010742, abs dis: 0.000553131103515625
[rfa agg] iter:  2, weight: tensor([0.1144, 0.0507, 0.1376, 0.1282, 0.0902, 0.2778, 0.1051, 0.0162, 0.0026,
        0.0770])
[rfa agg] iter:  3, prev_obj_val: 63.17521286010742, obj_val: 64.52757263183594, abs dis: 1.3523597717285156
[rfa agg] iter:  3, weight: tensor([0.1141, 0.0506, 0.1372, 0.1278, 0.0899, 0.2799, 0.1049, 0.0162, 0.0026,
        0.0768])
[rfa agg] iter:  4, prev_obj_val: 64.52757263183594, obj_val: 63.179527282714844, abs dis: 1.3480453491210938
[rfa agg] iter:  4, weight: tensor([0.1043, 0.0527, 0.1237, 0.1374, 0.0836, 0.3011, 0.0966, 0.0164, 0.0026,
        0.0816])
[rfa agg] iter:  5, prev_obj_val: 63.179527282714844, obj_val: 66.04927825927734, abs dis: 2.8697509765625
[rfa agg] iter:  5, weight: tensor([0.1131, 0.0502, 0.1357, 0.1275, 0.0892, 0.2854, 0.1040, 0.0161, 0.0026,
        0.0762])
[rfa agg] iter:  6, prev_obj_val: 66.04927825927734, obj_val: 66.03388977050781, abs dis: 0.01538848876953125
[rfa agg] iter:  6, weight: tensor([0.0967, 0.0557, 0.1130, 0.1490, 0.0786, 0.3095, 0.0900, 0.0168, 0.0027,
        0.0880])
[rfa agg] iter:  7, prev_obj_val: 66.03388977050781, obj_val: 66.0334701538086, abs dis: 0.00041961669921875
[rfa agg] iter:  7, weight: tensor([0.0952, 0.0550, 0.1110, 0.1494, 0.0775, 0.3170, 0.0887, 0.0166, 0.0026,
        0.0870])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 22.4033, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 28.2014, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.40190601348877 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0956, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0648, Accuracy: 85/311 (27.3312%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.1712, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0514, Accuracy: 252/813 (30.9963%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0207, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 13.0353, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0621, Accuracy: 255/1154 (22.0971%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.8619, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0469, Accuracy: 426/1552 (27.4485%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0229, Accuracy: 692/1552 (44.5876%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.5117, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0602, Accuracy: 244/599 (40.7346%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0319, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 14.2423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0579, Accuracy: 322/896 (35.9375%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0320, Accuracy: 475/896 (53.0134%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.2386, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0654, Accuracy: 218/1131 (19.2750%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 480/1131 (42.4403%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.7800, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0808, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0493, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8678, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0582, Accuracy: 246/712 (34.5506%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.0406, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 244/708 (34.4633%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0356, Accuracy: 423/708 (59.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.1258, Accuracy: 58/10000 (0.5800%)
time spent on training: 159.1272838115692
[rfa agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 53, 15, 74, 95, 89, 38, 49, 11, 16], weight: tensor([0.0374, 0.0978, 0.1388, 0.1866, 0.0720, 0.1077, 0.1360, 0.0529, 0.0856,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 49.49067687988281, obj_val: 53.7341194152832, abs dis: 4.243442535400391
[rfa agg] iter:  0, weight: tensor([0.0152, 0.1940, 0.0914, 0.0639, 0.0622, 0.1997, 0.1107, 0.0280, 0.1229,
        0.1120])
[rfa agg] iter:  1, prev_obj_val: 53.7341194152832, obj_val: 58.201961517333984, abs dis: 4.467842102050781
[rfa agg] iter:  1, weight: tensor([0.0174, 0.1983, 0.0644, 0.0502, 0.0926, 0.1426, 0.0744, 0.0349, 0.1772,
        0.1481])
[rfa agg] iter:  2, prev_obj_val: 58.201961517333984, obj_val: 58.18505096435547, abs dis: 0.016910552978515625
[rfa agg] iter:  2, weight: tensor([0.0219, 0.1575, 0.0634, 0.0517, 0.1349, 0.1197, 0.0718, 0.0467, 0.1790,
        0.1534])
[rfa agg] iter:  3, prev_obj_val: 58.18505096435547, obj_val: 58.18494415283203, abs dis: 0.0001068115234375
[rfa agg] iter:  3, weight: tensor([0.0219, 0.1549, 0.0631, 0.0515, 0.1390, 0.1184, 0.0714, 0.0469, 0.1788,
        0.1539])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 23.1052, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 27.7523, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.95262217521667 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0652, Accuracy: 317/1475 (21.4915%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0342, Accuracy: 633/1475 (42.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.4089, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0879, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0573, Accuracy: 179/466 (38.4120%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3247, Accuracy: 52/10000 (0.5200%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 353/1574 (22.4269%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 630/1574 (40.0254%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.2246, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0692, Accuracy: 141/818 (17.2372%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0327, Accuracy: 341/818 (41.6870%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.1018, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0792, Accuracy: 44/460 (9.5652%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 184/460 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5016, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 442/1552 (28.4794%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 711/1552 (45.8119%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.2254, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0612, Accuracy: 225/690 (32.6087%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5036, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0805, Accuracy: 39/500 (7.8000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0515, Accuracy: 196/500 (39.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.9810, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0624, Accuracy: 251/1130 (22.2124%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.2348, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0977, Accuracy: 2/338 (0.5917%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0526, Accuracy: 117/338 (34.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.2773, Accuracy: 52/10000 (0.5200%)
time spent on training: 176.0821831226349
[rfa agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[rfa agg] considering poison per batch poison_fraction: 0.054634566255692546
[rfa agg] init. name: [65, 76, 17, 71, 31, 74, 25, 82, 54, 12], weight: tensor([0.1638, 0.0518, 0.1748, 0.0909, 0.0511, 0.1724, 0.0766, 0.0555, 0.1255,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 68.80178833007812, obj_val: 69.9029541015625, abs dis: 1.101165771484375
[rfa agg] iter:  0, weight: tensor([0.1076, 0.0440, 0.1056, 0.2020, 0.0433, 0.1029, 0.1081, 0.0472, 0.2145,
        0.0247])
[rfa agg] iter:  1, prev_obj_val: 69.9029541015625, obj_val: 74.19298553466797, abs dis: 4.290031433105469
[rfa agg] iter:  1, weight: tensor([0.0978, 0.0454, 0.0966, 0.2407, 0.0447, 0.0941, 0.1178, 0.0488, 0.1890,
        0.0251])
[rfa agg] iter:  2, prev_obj_val: 74.19298553466797, obj_val: 79.86575317382812, abs dis: 5.672767639160156
[rfa agg] iter:  2, weight: tensor([0.0762, 0.0514, 0.0759, 0.3074, 0.0503, 0.0741, 0.1584, 0.0551, 0.1246,
        0.0267])
[rfa agg] iter:  3, prev_obj_val: 79.86575317382812, obj_val: 75.87510681152344, abs dis: 3.9906463623046875
[rfa agg] iter:  3, weight: tensor([0.0650, 0.0669, 0.0651, 0.2285, 0.0652, 0.0636, 0.2485, 0.0715, 0.0940,
        0.0317])
[rfa agg] iter:  4, prev_obj_val: 75.87510681152344, obj_val: 79.8374252319336, abs dis: 3.9623184204101562
[rfa agg] iter:  4, weight: tensor([0.0698, 0.0547, 0.0697, 0.2945, 0.0534, 0.0680, 0.1960, 0.0584, 0.1080,
        0.0275])
[rfa agg] iter:  5, prev_obj_val: 79.8374252319336, obj_val: 75.87850952148438, abs dis: 3.9589157104492188
[rfa agg] iter:  5, weight: tensor([0.0642, 0.0664, 0.0643, 0.2254, 0.0646, 0.0628, 0.2575, 0.0709, 0.0926,
        0.0314])
[rfa agg] iter:  6, prev_obj_val: 75.87850952148438, obj_val: 79.83684539794922, abs dis: 3.9583358764648438
[rfa agg] iter:  6, weight: tensor([0.0698, 0.0547, 0.0697, 0.2936, 0.0534, 0.0680, 0.1970, 0.0584, 0.1079,
        0.0275])
[rfa agg] iter:  7, prev_obj_val: 79.83684539794922, obj_val: 75.87863159179688, abs dis: 3.9582138061523438
[rfa agg] iter:  7, weight: tensor([0.0641, 0.0664, 0.0643, 0.2252, 0.0646, 0.0628, 0.2577, 0.0708, 0.0926,
        0.0314])
[rfa agg] iter:  8, prev_obj_val: 75.87863159179688, obj_val: 79.8368148803711, abs dis: 3.9581832885742188
[rfa agg] iter:  8, weight: tensor([0.0698, 0.0547, 0.0697, 0.2936, 0.0534, 0.0680, 0.1971, 0.0584, 0.1079,
        0.0275])
[rfa agg] iter:  9, prev_obj_val: 79.8368148803711, obj_val: 75.8786392211914, abs dis: 3.9581756591796875
[rfa agg] iter:  9, weight: tensor([0.0641, 0.0664, 0.0643, 0.2252, 0.0646, 0.0628, 0.2578, 0.0708, 0.0926,
        0.0314])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 14.5404, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 18.6689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.8646697998047 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0642, Accuracy: 254/719 (35.3268%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2083, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0588, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3936, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0791, Accuracy: 44/500 (8.8000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0515, Accuracy: 196/500 (39.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6922, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0684, Accuracy: 95/781 (12.1639%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 260/781 (33.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4534, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0599, Accuracy: 186/861 (21.6028%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0222, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.2819, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0621, Accuracy: 297/1036 (28.6680%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0272, Accuracy: 642/1036 (61.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 12.6468, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0698, Accuracy: 202/1241 (16.2772%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 359/1241 (28.9283%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.4606, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0571, Accuracy: 508/2227 (22.8110%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 945/2227 (42.4338%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6577, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0605, Accuracy: 242/599 (40.4007%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0355, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 14.2509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0662, Accuracy: 224/1131 (19.8055%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0322, Accuracy: 468/1131 (41.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8217, Accuracy: 91/10000 (0.9100%)
time spent on training: 175.2264688014984
[rfa agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 89, 82, 3, 10, 19, 72, 60, 95, 38], weight: tensor([0.0720, 0.0897, 0.0500, 0.0782, 0.0862, 0.1037, 0.1242, 0.2229, 0.0600,
        0.1132])
[rfa agg] iter:  0, prev_obj_val: 65.64896392822266, obj_val: 70.8282470703125, abs dis: 5.179283142089844
[rfa agg] iter:  0, weight: tensor([0.0579, 0.1057, 0.0236, 0.0769, 0.1050, 0.2069, 0.1472, 0.0535, 0.0359,
        0.1875])
[rfa agg] iter:  1, prev_obj_val: 70.8282470703125, obj_val: 72.50391387939453, abs dis: 1.6756668090820312
[rfa agg] iter:  1, weight: tensor([0.1082, 0.1642, 0.0331, 0.1569, 0.1791, 0.1019, 0.0712, 0.0399, 0.0576,
        0.0880])
[rfa agg] iter:  2, prev_obj_val: 72.50391387939453, obj_val: 77.49369049072266, abs dis: 4.989776611328125
[rfa agg] iter:  2, weight: tensor([0.1265, 0.1595, 0.0349, 0.1806, 0.1704, 0.0865, 0.0638, 0.0376, 0.0638,
        0.0763])
[rfa agg] iter:  3, prev_obj_val: 77.49369049072266, obj_val: 83.50809478759766, abs dis: 6.014404296875
[rfa agg] iter:  3, weight: tensor([0.1616, 0.1359, 0.0462, 0.1735, 0.1384, 0.0792, 0.0621, 0.0397, 0.0912,
        0.0721])
[rfa agg] iter:  4, prev_obj_val: 83.50809478759766, obj_val: 77.49018096923828, abs dis: 6.017913818359375
[rfa agg] iter:  4, weight: tensor([0.1664, 0.1182, 0.0651, 0.1432, 0.1171, 0.0762, 0.0627, 0.0430, 0.1370,
        0.0711])
[rfa agg] iter:  5, prev_obj_val: 77.49018096923828, obj_val: 80.3787841796875, abs dis: 2.8886032104492188
[rfa agg] iter:  5, weight: tensor([0.1710, 0.1337, 0.0466, 0.1672, 0.1346, 0.0787, 0.0619, 0.0396, 0.0949,
        0.0717])
[rfa agg] iter:  6, prev_obj_val: 80.3787841796875, obj_val: 77.47881317138672, abs dis: 2.8999710083007812
[rfa agg] iter:  6, weight: tensor([0.1744, 0.1253, 0.0546, 0.1562, 0.1250, 0.0770, 0.0621, 0.0411, 0.1131,
        0.0711])
[rfa agg] iter:  7, prev_obj_val: 77.47881317138672, obj_val: 80.37914276123047, abs dis: 2.90032958984375
[rfa agg] iter:  7, weight: tensor([0.1718, 0.1336, 0.0464, 0.1689, 0.1347, 0.0785, 0.0617, 0.0395, 0.0934,
        0.0715])
[rfa agg] iter:  8, prev_obj_val: 80.37914276123047, obj_val: 77.4787826538086, abs dis: 2.900360107421875
[rfa agg] iter:  8, weight: tensor([0.1745, 0.1252, 0.0546, 0.1564, 0.1250, 0.0770, 0.0621, 0.0411, 0.1130,
        0.0711])
[rfa agg] iter:  9, prev_obj_val: 77.4787826538086, obj_val: 80.379150390625, abs dis: 2.9003677368164062
[rfa agg] iter:  9, weight: tensor([0.1718, 0.1336, 0.0464, 0.1689, 0.1347, 0.0785, 0.0617, 0.0395, 0.0934,
        0.0715])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.8396, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3817, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.88081669807434 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 335/1574 (21.2834%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0295, Accuracy: 582/1574 (36.9759%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.4126, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0710, Accuracy: 182/928 (19.6121%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0260, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.1462, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0917, Accuracy: 20/486 (4.1152%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0449, Accuracy: 218/486 (44.8560%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.2895, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0667, Accuracy: 244/1573 (15.5118%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 521/1573 (33.1214%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2987, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0561, Accuracy: 370/1953 (18.9452%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0345, Accuracy: 717/1953 (36.7127%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5338, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0640, Accuracy: 237/1213 (19.5383%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0291, Accuracy: 530/1213 (43.6933%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.1557, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0729, Accuracy: 136/530 (25.6604%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0416, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.3393, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0701, Accuracy: 319/1163 (27.4291%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 440/1163 (37.8332%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8128, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0607, Accuracy: 172/861 (19.9768%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 453/861 (52.6132%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.2247, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0628, Accuracy: 287/1949 (14.7255%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0345, Accuracy: 558/1949 (28.6301%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8456, Accuracy: 90/10000 (0.9000%)
time spent on training: 206.2417311668396
[rfa agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.040218724448078495
[rfa agg] init. name: [17, 1, 30, 40, 83, 97, 18, 68, 10, 21], weight: tensor([0.1287, 0.0759, 0.0397, 0.1286, 0.1597, 0.0992, 0.0433, 0.0951, 0.0704,
        0.1594])
[rfa agg] iter:  0, prev_obj_val: 67.80369567871094, obj_val: 70.57084655761719, abs dis: 2.76715087890625
[rfa agg] iter:  0, weight: tensor([0.1198, 0.0805, 0.0190, 0.1202, 0.0758, 0.2039, 0.0225, 0.2165, 0.0667,
        0.0753])
[rfa agg] iter:  1, prev_obj_val: 70.57084655761719, obj_val: 70.55846405029297, abs dis: 0.01238250732421875
[rfa agg] iter:  1, weight: tensor([0.0997, 0.0928, 0.0199, 0.1004, 0.0672, 0.2208, 0.0239, 0.2327, 0.0760,
        0.0667])
[rfa agg] iter:  2, prev_obj_val: 70.55846405029297, obj_val: 72.39441680908203, abs dis: 1.8359527587890625
[rfa agg] iter:  2, weight: tensor([0.0986, 0.0926, 0.0198, 0.0994, 0.0667, 0.2249, 0.0237, 0.2327, 0.0756,
        0.0661])
[rfa agg] iter:  3, prev_obj_val: 72.39441680908203, obj_val: 70.56033325195312, abs dis: 1.8340835571289062
[rfa agg] iter:  3, weight: tensor([0.0951, 0.1045, 0.0213, 0.0957, 0.0661, 0.2182, 0.0257, 0.2224, 0.0854,
        0.0656])
[rfa agg] iter:  4, prev_obj_val: 70.56033325195312, obj_val: 72.39403533935547, abs dis: 1.8337020874023438
[rfa agg] iter:  4, weight: tensor([0.0986, 0.0932, 0.0198, 0.0994, 0.0668, 0.2264, 0.0238, 0.2298, 0.0759,
        0.0662])
[rfa agg] iter:  5, prev_obj_val: 72.39403533935547, obj_val: 70.56039428710938, abs dis: 1.8336410522460938
[rfa agg] iter:  5, weight: tensor([0.0951, 0.1045, 0.0213, 0.0958, 0.0661, 0.2188, 0.0257, 0.2217, 0.0854,
        0.0656])
[rfa agg] iter:  6, prev_obj_val: 70.56039428710938, obj_val: 72.3940200805664, abs dis: 1.8336257934570312
[rfa agg] iter:  6, weight: tensor([0.0986, 0.0932, 0.0198, 0.0994, 0.0668, 0.2266, 0.0238, 0.2296, 0.0759,
        0.0662])
[rfa agg] iter:  7, prev_obj_val: 72.3940200805664, obj_val: 70.5604019165039, abs dis: 1.8336181640625
[rfa agg] iter:  7, weight: tensor([0.0951, 0.1045, 0.0213, 0.0958, 0.0661, 0.2189, 0.0257, 0.2216, 0.0854,
        0.0656])
[rfa agg] iter:  8, prev_obj_val: 70.5604019165039, obj_val: 72.39402770996094, abs dis: 1.8336257934570312
[rfa agg] iter:  8, weight: tensor([0.0986, 0.0932, 0.0198, 0.0994, 0.0668, 0.2266, 0.0238, 0.2296, 0.0759,
        0.0662])
[rfa agg] iter:  9, prev_obj_val: 72.39402770996094, obj_val: 70.5604019165039, abs dis: 1.8336257934570312
[rfa agg] iter:  9, weight: tensor([0.0951, 0.1045, 0.0213, 0.0958, 0.0661, 0.2189, 0.0257, 0.2216, 0.0854,
        0.0656])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8389, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.1513, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.69304752349854 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0649, Accuracy: 231/1013 (22.8036%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 477/1013 (47.0879%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.1443, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0746, Accuracy: 51/631 (8.0824%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 236/631 (37.4010%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.7464, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0723, Accuracy: 195/774 (25.1938%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0404, Accuracy: 307/774 (39.6641%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4962, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 207/1049 (19.7331%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0325, Accuracy: 468/1049 (44.6139%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.4556, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0477, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 437/888 (49.2117%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.4583, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0539, Accuracy: 338/1628 (20.7617%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 676/1628 (41.5233%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.7496, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0565, Accuracy: 541/2227 (24.2928%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 939/2227 (42.1643%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.7453, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 345/891 (38.7205%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.3582, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0660, Accuracy: 303/1418 (21.3681%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0332, Accuracy: 597/1418 (42.1016%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6910, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0628, Accuracy: 255/719 (35.4659%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.8545, Accuracy: 64/10000 (0.6400%)
time spent on training: 188.42449688911438
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 48, 81, 51, 63, 5, 60, 7, 70, 41], weight: tensor([0.0901, 0.0561, 0.0689, 0.0933, 0.0790, 0.1449, 0.1982, 0.0793, 0.1262,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 70.04944610595703, obj_val: 71.86531066894531, abs dis: 1.8158645629882812
[rfa agg] iter:  0, weight: tensor([0.1603, 0.0371, 0.0665, 0.1857, 0.0929, 0.1062, 0.0684, 0.0911, 0.1388,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 71.86531066894531, obj_val: 75.94730377197266, abs dis: 4.081993103027344
[rfa agg] iter:  1, weight: tensor([0.2140, 0.0396, 0.0816, 0.1734, 0.1275, 0.0630, 0.0460, 0.1186, 0.0757,
        0.0605])
[rfa agg] iter:  2, prev_obj_val: 75.94730377197266, obj_val: 85.64900970458984, abs dis: 9.701705932617188
[rfa agg] iter:  2, weight: tensor([0.1674, 0.0483, 0.1096, 0.1173, 0.1780, 0.0521, 0.0404, 0.1502, 0.0597,
        0.0770])
[rfa agg] iter:  3, prev_obj_val: 85.64900970458984, obj_val: 85.58817291259766, abs dis: 0.0608367919921875
[rfa agg] iter:  3, weight: tensor([0.1071, 0.0830, 0.1497, 0.0853, 0.1641, 0.0493, 0.0407, 0.1450, 0.0542,
        0.1216])
[rfa agg] iter:  4, prev_obj_val: 85.58817291259766, obj_val: 82.70243072509766, abs dis: 2.8857421875
[rfa agg] iter:  4, weight: tensor([0.1039, 0.0834, 0.1564, 0.0833, 0.1605, 0.0485, 0.0401, 0.1427, 0.0534,
        0.1277])
[rfa agg] iter:  5, prev_obj_val: 82.70243072509766, obj_val: 82.69861602783203, abs dis: 0.003814697265625
[rfa agg] iter:  5, weight: tensor([0.1104, 0.0699, 0.1547, 0.0862, 0.1744, 0.0478, 0.0390, 0.1502, 0.0530,
        0.1144])
[rfa agg] iter:  6, prev_obj_val: 82.69861602783203, obj_val: 85.5912857055664, abs dis: 2.892669677734375
[rfa agg] iter:  6, weight: tensor([0.1107, 0.0696, 0.1537, 0.0862, 0.1763, 0.0478, 0.0389, 0.1513, 0.0530,
        0.1125])
[rfa agg] iter:  7, prev_obj_val: 85.5912857055664, obj_val: 80.11479187011719, abs dis: 5.476493835449219
[rfa agg] iter:  7, weight: tensor([0.1040, 0.0830, 0.1566, 0.0833, 0.1616, 0.0485, 0.0401, 0.1434, 0.0534,
        0.1260])
[rfa agg] iter:  8, prev_obj_val: 80.11479187011719, obj_val: 80.0990219116211, abs dis: 0.01576995849609375
[rfa agg] iter:  8, weight: tensor([0.1203, 0.0600, 0.1446, 0.0912, 0.1872, 0.0479, 0.0385, 0.1565, 0.0536,
        0.1003])
[rfa agg] iter:  9, prev_obj_val: 80.0990219116211, obj_val: 80.0987319946289, abs dis: 0.0002899169921875
[rfa agg] iter:  9, weight: tensor([0.1209, 0.0595, 0.1412, 0.0911, 0.1919, 0.0477, 0.0383, 0.1585, 0.0535,
        0.0973])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8316, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.2254, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 283.3309304714203 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0647, Accuracy: 250/901 (27.7469%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0348, Accuracy: 392/901 (43.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.2558, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0914, Accuracy: 3/186 (1.6129%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0733, Accuracy: 22/186 (11.8280%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3059, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0626, Accuracy: 278/1949 (14.2637%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 581/1949 (29.8102%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8182, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0866, Accuracy: 27/515 (5.2427%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0573, Accuracy: 147/515 (28.5437%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9903, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0551, Accuracy: 278/1089 (25.5280%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0307, Accuracy: 461/1089 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 14.9626, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0651, Accuracy: 251/719 (34.9096%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0339, Accuracy: 443/719 (61.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5939, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 240/712 (33.7079%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0288, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.2641, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0697, Accuracy: 141/818 (17.2372%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0321, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5433, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0698, Accuracy: 295/1956 (15.0818%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 579/1956 (29.6012%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7424, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0576, Accuracy: 369/1715 (21.5160%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 624/1715 (36.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7134, Accuracy: 83/10000 (0.8300%)
time spent on training: 184.3774824142456
[rfa agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 56, 21, 33, 59, 41, 11, 71, 6, 92], weight: tensor([0.0853, 0.0176, 0.1846, 0.0488, 0.1031, 0.0681, 0.0674, 0.0775, 0.1852,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 80.9372787475586, obj_val: 83.82439422607422, abs dis: 2.887115478515625
[rfa agg] iter:  0, weight: tensor([0.1328, 0.0082, 0.1261, 0.0364, 0.1757, 0.0697, 0.0700, 0.0922, 0.1270,
        0.1619])
[rfa agg] iter:  1, prev_obj_val: 83.82439422607422, obj_val: 85.85104370117188, abs dis: 2.0266494750976562
[rfa agg] iter:  1, weight: tensor([0.1755, 0.0083, 0.0976, 0.0399, 0.1814, 0.0826, 0.0831, 0.1147, 0.0982,
        0.1187])
[rfa agg] iter:  2, prev_obj_val: 85.85104370117188, obj_val: 85.83102416992188, abs dis: 0.02001953125
[rfa agg] iter:  2, weight: tensor([0.2058, 0.0082, 0.0847, 0.0415, 0.1610, 0.0909, 0.0915, 0.1309, 0.0851,
        0.1003])
[rfa agg] iter:  3, prev_obj_val: 85.83102416992188, obj_val: 85.83041381835938, abs dis: 0.0006103515625
[rfa agg] iter:  3, weight: tensor([0.2122, 0.0082, 0.0841, 0.0413, 0.1565, 0.0910, 0.0913, 0.1311, 0.0846,
        0.0996])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.8269, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.6920, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.09179162979126 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0582, Accuracy: 313/896 (34.9330%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0324, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3393, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0888, Accuracy: 36/515 (6.9903%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0567, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8981, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0573, Accuracy: 363/1953 (18.5868%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 706/1953 (36.1495%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.8475, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0555, Accuracy: 550/2227 (24.6969%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 943/2227 (42.3440%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.9982, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0658, Accuracy: 198/1154 (17.1577%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0284, Accuracy: 449/1154 (38.9081%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.6453, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 100/530 (18.8679%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 277/530 (52.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.9756, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0649, Accuracy: 249/719 (34.6314%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0357, Accuracy: 450/719 (62.5869%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.5584, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0652, Accuracy: 303/1657 (18.2861%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0379, Accuracy: 488/1657 (29.4508%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3708, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0759, Accuracy: 42/460 (9.1304%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 178/460 (38.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.2807, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0926, Accuracy: 14/486 (2.8807%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0451, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.2890, Accuracy: 52/10000 (0.5200%)
time spent on training: 185.84413313865662
[rfa agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 33, 83, 60, 57, 18, 41, 0, 31, 30], weight: tensor([0.0846, 0.0486, 0.1843, 0.2102, 0.1089, 0.0500, 0.0678, 0.1564, 0.0434,
        0.0459])
[rfa agg] iter:  0, prev_obj_val: 89.50215148925781, obj_val: 90.85023498535156, abs dis: 1.34808349609375
[rfa agg] iter:  0, weight: tensor([0.1046, 0.0344, 0.1307, 0.1099, 0.2685, 0.0357, 0.0651, 0.1927, 0.0285,
        0.0300])
[rfa agg] iter:  1, prev_obj_val: 90.85023498535156, obj_val: 92.92021942138672, abs dis: 2.0699844360351562
[rfa agg] iter:  1, weight: tensor([0.1138, 0.0350, 0.1115, 0.0957, 0.3229, 0.0363, 0.0681, 0.1577, 0.0287,
        0.0303])
[rfa agg] iter:  2, prev_obj_val: 92.92021942138672, obj_val: 94.12179565429688, abs dis: 1.2015762329101562
[rfa agg] iter:  2, weight: tensor([0.1340, 0.0381, 0.1022, 0.0894, 0.3178, 0.0396, 0.0771, 0.1378, 0.0311,
        0.0329])
[rfa agg] iter:  3, prev_obj_val: 94.12179565429688, obj_val: 94.11415100097656, abs dis: 0.0076446533203125
[rfa agg] iter:  3, weight: tensor([0.1509, 0.0408, 0.1000, 0.0881, 0.2932, 0.0424, 0.0844, 0.1320, 0.0332,
        0.0350])
[rfa agg] iter:  4, prev_obj_val: 94.11415100097656, obj_val: 95.39644622802734, abs dis: 1.2822952270507812
[rfa agg] iter:  4, weight: tensor([0.1534, 0.0411, 0.1006, 0.0886, 0.2871, 0.0427, 0.0852, 0.1327, 0.0334,
        0.0352])
[rfa agg] iter:  5, prev_obj_val: 95.39644622802734, obj_val: 96.73561096191406, abs dis: 1.3391647338867188
[rfa agg] iter:  5, weight: tensor([0.1719, 0.0438, 0.0979, 0.0869, 0.2613, 0.0455, 0.0930, 0.1269, 0.0354,
        0.0374])
[rfa agg] iter:  6, prev_obj_val: 96.73561096191406, obj_val: 99.61442565917969, abs dis: 2.878814697265625
[rfa agg] iter:  6, weight: tensor([0.1949, 0.0464, 0.0946, 0.0846, 0.2318, 0.0484, 0.1018, 0.1207, 0.0374,
        0.0395])
[rfa agg] iter:  7, prev_obj_val: 99.61442565917969, obj_val: 102.76824188232422, abs dis: 3.1538162231445312
[rfa agg] iter:  7, weight: tensor([0.2435, 0.0508, 0.0855, 0.0775, 0.1814, 0.0531, 0.1194, 0.1058, 0.0405,
        0.0427])
[rfa agg] iter:  8, prev_obj_val: 102.76824188232422, obj_val: 102.72533416748047, abs dis: 0.04290771484375
[rfa agg] iter:  8, weight: tensor([0.2945, 0.0539, 0.0739, 0.0678, 0.1375, 0.0567, 0.1392, 0.0891, 0.0426,
        0.0448])
[rfa agg] iter:  9, prev_obj_val: 102.72533416748047, obj_val: 106.41212463378906, abs dis: 3.6867904663085938
[rfa agg] iter:  9, weight: tensor([0.3141, 0.0525, 0.0717, 0.0658, 0.1310, 0.0552, 0.1382, 0.0864, 0.0415,
        0.0437])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8161, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.2614, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.57008171081543 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0659, Accuracy: 264/946 (27.9070%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1633, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0615, Accuracy: 235/1446 (16.2517%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0360, Accuracy: 484/1446 (33.4716%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1857, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1492, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1353, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7442, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 346/1574 (21.9822%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 563/1574 (35.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.5654, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0586, Accuracy: 363/1587 (22.8733%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0350, Accuracy: 593/1587 (37.3661%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4714, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 62/631 (9.8257%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.0848, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0631, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0290, Accuracy: 474/1013 (46.7917%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.8408, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0522, Accuracy: 340/891 (38.1594%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0276, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.5732, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0690, Accuracy: 221/1154 (19.1508%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0323, Accuracy: 424/1154 (36.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.5649, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0626, Accuracy: 295/1949 (15.1360%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0345, Accuracy: 595/1949 (30.5285%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.4217, Accuracy: 86/10000 (0.8600%)
time spent on training: 203.19387698173523
[rfa agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.043621408300815886
[rfa agg] init. name: [43, 26, 61, 17, 27, 48, 39, 7, 15, 21], weight: tensor([0.0839, 0.1282, 0.0075, 0.1396, 0.1407, 0.0560, 0.0898, 0.0790, 0.1023,
        0.1728])
[rfa agg] iter:  0, prev_obj_val: 60.06543731689453, obj_val: 62.41252899169922, abs dis: 2.3470916748046875
[rfa agg] iter:  0, weight: tensor([0.1037, 0.1491, 0.0023, 0.1187, 0.1213, 0.0336, 0.1345, 0.0788, 0.1805,
        0.0774])
[rfa agg] iter:  1, prev_obj_val: 62.41252899169922, obj_val: 63.87542724609375, abs dis: 1.4628982543945312
[rfa agg] iter:  1, weight: tensor([0.1253, 0.1233, 0.0023, 0.1005, 0.1022, 0.0363, 0.1677, 0.0908, 0.1824,
        0.0690])
[rfa agg] iter:  2, prev_obj_val: 63.87542724609375, obj_val: 63.86614990234375, abs dis: 0.00927734375
[rfa agg] iter:  2, weight: tensor([0.1404, 0.1113, 0.0023, 0.0925, 0.0940, 0.0378, 0.1903, 0.0982, 0.1679,
        0.0653])
[rfa agg] iter:  3, prev_obj_val: 63.86614990234375, obj_val: 63.86595916748047, abs dis: 0.00019073486328125
[rfa agg] iter:  3, weight: tensor([0.1416, 0.1107, 0.0023, 0.0921, 0.0936, 0.0377, 0.1939, 0.0983, 0.1648,
        0.0650])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8180, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3144, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.0953130722046 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0498, Accuracy: 384/1129 (34.0124%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 687/1129 (60.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.4378, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0699, Accuracy: 296/1163 (25.4514%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 423/1163 (36.3715%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2976, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0689, Accuracy: 205/1154 (17.7643%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0302, Accuracy: 412/1154 (35.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.0671, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0887, Accuracy: 80/603 (13.2670%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0520, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8031, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0611, Accuracy: 353/1904 (18.5399%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0328, Accuracy: 640/1904 (33.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3320, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0565, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0350, Accuracy: 686/1953 (35.1254%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.3991, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0496, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0274, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.5783, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0688, Accuracy: 287/1956 (14.6728%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0345, Accuracy: 592/1956 (30.2658%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1924, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0575, Accuracy: 377/1715 (21.9825%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 691/1715 (40.2915%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.9550, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 273/813 (33.5793%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0210, Accuracy: 454/813 (55.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.8636, Accuracy: 47/10000 (0.4700%)
time spent on training: 214.79408359527588
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 68, 15, 88, 46, 83, 7, 6, 92, 53], weight: tensor([0.0850, 0.0876, 0.0869, 0.0454, 0.1434, 0.1471, 0.0671, 0.1473, 0.1291,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 68.7074203491211, obj_val: 69.44804382324219, abs dis: 0.7406234741210938
[rfa agg] iter:  0, weight: tensor([0.1254, 0.1641, 0.1390, 0.0259, 0.1073, 0.0987, 0.0563, 0.0992, 0.1372,
        0.0468])
[rfa agg] iter:  1, prev_obj_val: 69.44804382324219, obj_val: 74.23577880859375, abs dis: 4.7877349853515625
[rfa agg] iter:  1, weight: tensor([0.1340, 0.1831, 0.1495, 0.0260, 0.0977, 0.0902, 0.0575, 0.0907, 0.1237,
        0.0476])
[rfa agg] iter:  2, prev_obj_val: 74.23577880859375, obj_val: 74.19341278076172, abs dis: 0.04236602783203125
[rfa agg] iter:  2, weight: tensor([0.1676, 0.2218, 0.1611, 0.0283, 0.0729, 0.0685, 0.0682, 0.0688, 0.0872,
        0.0557])
[rfa agg] iter:  3, prev_obj_val: 74.19341278076172, obj_val: 74.1929702758789, abs dis: 0.0004425048828125
[rfa agg] iter:  3, weight: tensor([0.1684, 0.2295, 0.1604, 0.0278, 0.0716, 0.0673, 0.0673, 0.0675, 0.0853,
        0.0549])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8230, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.1597, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.1167562007904 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0671, Accuracy: 200/1131 (17.6835%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0324, Accuracy: 394/1131 (34.8364%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.4751, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0947, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0529, Accuracy: 178/466 (38.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7704, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0680, Accuracy: 226/1154 (19.5841%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0314, Accuracy: 439/1154 (38.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.3152, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0626, Accuracy: 251/1130 (22.2124%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0316, Accuracy: 439/1130 (38.8496%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.2669, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.1025, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0556, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3686, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0999, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0538, Accuracy: 110/338 (32.5444%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4370, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0555, Accuracy: 540/2227 (24.2479%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 931/2227 (41.8051%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8217, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0604, Accuracy: 234/712 (32.8652%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 411/712 (57.7247%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.0942, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0625, Accuracy: 248/1446 (17.1508%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0362, Accuracy: 486/1446 (33.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.7200, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0655, Accuracy: 221/1213 (18.2193%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0304, Accuracy: 470/1213 (38.7469%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.9990, Accuracy: 85/10000 (0.8500%)
time spent on training: 187.14556765556335
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 76, 15, 54, 78, 12, 60, 11, 26, 97], weight: tensor([0.1105, 0.0455, 0.1128, 0.1104, 0.0407, 0.0330, 0.2176, 0.0696, 0.1413,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 67.96820831298828, obj_val: 70.25338745117188, abs dis: 2.2851791381835938
[rfa agg] iter:  0, weight: tensor([0.2087, 0.0194, 0.1279, 0.2119, 0.0157, 0.0117, 0.0553, 0.0475, 0.1094,
        0.1926])
[rfa agg] iter:  1, prev_obj_val: 70.25338745117188, obj_val: 72.14215850830078, abs dis: 1.8887710571289062
[rfa agg] iter:  1, weight: tensor([0.2183, 0.0220, 0.1215, 0.2251, 0.0176, 0.0130, 0.0534, 0.0570, 0.0962,
        0.1759])
[rfa agg] iter:  2, prev_obj_val: 72.14215850830078, obj_val: 74.2533187866211, abs dis: 2.1111602783203125
[rfa agg] iter:  2, weight: tensor([0.2128, 0.0249, 0.1223, 0.2189, 0.0198, 0.0145, 0.0558, 0.0669, 0.0963,
        0.1677])
[rfa agg] iter:  3, prev_obj_val: 74.2533187866211, obj_val: 72.14264678955078, abs dis: 2.1106719970703125
[rfa agg] iter:  3, weight: tensor([0.2030, 0.0285, 0.1239, 0.2075, 0.0225, 0.0164, 0.0587, 0.0795, 0.0976,
        0.1624])
[rfa agg] iter:  4, prev_obj_val: 72.14264678955078, obj_val: 74.25304412841797, abs dis: 2.1103973388671875
[rfa agg] iter:  4, weight: tensor([0.2122, 0.0250, 0.1230, 0.2180, 0.0199, 0.0146, 0.0560, 0.0675, 0.0966,
        0.1671])
[rfa agg] iter:  5, prev_obj_val: 74.25304412841797, obj_val: 72.14266204833984, abs dis: 2.110382080078125
[rfa agg] iter:  5, weight: tensor([0.2030, 0.0285, 0.1240, 0.2074, 0.0225, 0.0164, 0.0587, 0.0795, 0.0977,
        0.1623])
[rfa agg] iter:  6, prev_obj_val: 72.14266204833984, obj_val: 74.25303649902344, abs dis: 2.1103744506835938
[rfa agg] iter:  6, weight: tensor([0.2122, 0.0250, 0.1230, 0.2180, 0.0199, 0.0146, 0.0560, 0.0675, 0.0966,
        0.1671])
[rfa agg] iter:  7, prev_obj_val: 74.25303649902344, obj_val: 72.14266204833984, abs dis: 2.1103744506835938
[rfa agg] iter:  7, weight: tensor([0.2030, 0.0285, 0.1240, 0.2074, 0.0225, 0.0164, 0.0587, 0.0795, 0.0977,
        0.1623])
[rfa agg] iter:  8, prev_obj_val: 72.14266204833984, obj_val: 74.25303649902344, abs dis: 2.1103744506835938
[rfa agg] iter:  8, weight: tensor([0.2122, 0.0250, 0.1230, 0.2180, 0.0199, 0.0146, 0.0560, 0.0675, 0.0966,
        0.1671])
[rfa agg] iter:  9, prev_obj_val: 74.25303649902344, obj_val: 72.14266204833984, abs dis: 2.1103744506835938
[rfa agg] iter:  9, weight: tensor([0.2030, 0.0285, 0.1240, 0.2074, 0.0225, 0.0164, 0.0587, 0.0795, 0.0977,
        0.1623])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.9381, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 9.7150, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.71371507644653 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0650, Accuracy: 285/1573 (18.1182%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0366, Accuracy: 494/1573 (31.4050%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8151, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 437/1953 (22.3758%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 745/1953 (38.1464%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.4284, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0602, Accuracy: 363/1904 (19.0651%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0324, Accuracy: 636/1904 (33.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.5453, Accuracy: 95/10000 (0.9500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 321/1574 (20.3939%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0302, Accuracy: 532/1574 (33.7992%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.3524, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0893, Accuracy: 79/603 (13.1012%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0550, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9265, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0685, Accuracy: 145/818 (17.7262%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0343, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6828, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0676, Accuracy: 303/1750 (17.3143%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0387, Accuracy: 564/1750 (32.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.0593, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0768, Accuracy: 24/460 (5.2174%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0365, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.2869, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0554, Accuracy: 251/690 (36.3768%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.3461, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0676, Accuracy: 305/1956 (15.5930%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0348, Accuracy: 558/1956 (28.5276%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0042, Accuracy: 92/10000 (0.9200%)
time spent on training: 227.1719868183136
[rfa agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.037035991265717945
[rfa agg] init. name: [40, 83, 46, 17, 88, 71, 44, 31, 25, 6], weight: tensor([0.1184, 0.1471, 0.1434, 0.1185, 0.0454, 0.0616, 0.1318, 0.0346, 0.0520,
        0.1473])
[rfa agg] iter:  0, prev_obj_val: 70.31517791748047, obj_val: 65.94277954101562, abs dis: 4.372398376464844
[rfa agg] iter:  0, weight: tensor([0.2085, 0.1078, 0.1194, 0.2097, 0.0238, 0.0416, 0.1353, 0.0156, 0.0295,
        0.1088])
[rfa agg] iter:  1, prev_obj_val: 65.94277954101562, obj_val: 65.93275451660156, abs dis: 0.0100250244140625
[rfa agg] iter:  1, weight: tensor([0.2281, 0.1020, 0.1151, 0.2316, 0.0189, 0.0324, 0.1328, 0.0125, 0.0233,
        0.1034])
[rfa agg] iter:  2, prev_obj_val: 65.93275451660156, obj_val: 65.9326171875, abs dis: 0.0001373291015625
[rfa agg] iter:  2, weight: tensor([0.2302, 0.1010, 0.1140, 0.2342, 0.0188, 0.0322, 0.1315, 0.0124, 0.0231,
        0.1025])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 16.5067, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 15.4353, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.7705543041229 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0623, Accuracy: 267/1013 (26.3574%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0289, Accuracy: 438/1013 (43.2379%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.6723, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0653, Accuracy: 201/1071 (18.7675%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.7976, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0718, Accuracy: 95/781 (12.1639%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.9422, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0783, Accuracy: 25/460 (5.4348%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0346, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.8432, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0686, Accuracy: 125/938 (13.3262%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 358/938 (38.1663%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.2819, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0480, Accuracy: 450/1552 (28.9948%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 732/1552 (47.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.9443, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0620, Accuracy: 181/590 (30.6780%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.2471, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0638, Accuracy: 218/1131 (19.2750%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4435, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0622, Accuracy: 220/1513 (14.5406%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0377, Accuracy: 460/1513 (30.4032%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.0588, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0632, Accuracy: 330/1427 (23.1254%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0365, Accuracy: 543/1427 (38.0519%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.1527, Accuracy: 73/10000 (0.7300%)
time spent on training: 192.51171231269836
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 55, 3, 31, 73, 74, 69, 87, 8, 34], weight: tensor([0.0967, 0.1022, 0.0746, 0.0439, 0.0895, 0.1481, 0.0563, 0.1080, 0.1444,
        0.1362])
[rfa agg] iter:  0, prev_obj_val: 50.415504455566406, obj_val: 51.72465515136719, abs dis: 1.3091506958007812
[rfa agg] iter:  0, weight: tensor([0.1927, 0.1506, 0.0842, 0.0216, 0.1608, 0.0646, 0.0363, 0.1441, 0.0701,
        0.0750])
[rfa agg] iter:  1, prev_obj_val: 51.72465515136719, obj_val: 55.82926940917969, abs dis: 4.1046142578125
[rfa agg] iter:  1, weight: tensor([0.2062, 0.1435, 0.0925, 0.0223, 0.1772, 0.0593, 0.0380, 0.1290, 0.0641,
        0.0679])
[rfa agg] iter:  2, prev_obj_val: 55.82926940917969, obj_val: 58.254600524902344, abs dis: 2.4253311157226562
[rfa agg] iter:  2, weight: tensor([0.1785, 0.1259, 0.1282, 0.0273, 0.1944, 0.0582, 0.0486, 0.1114, 0.0623,
        0.0653])
[rfa agg] iter:  3, prev_obj_val: 58.254600524902344, obj_val: 58.24790954589844, abs dis: 0.00669097900390625
[rfa agg] iter:  3, weight: tensor([0.1595, 0.1179, 0.1552, 0.0307, 0.1907, 0.0582, 0.0560, 0.1048, 0.0621,
        0.0648])
[rfa agg] iter:  4, prev_obj_val: 58.24790954589844, obj_val: 60.90559387207031, abs dis: 2.657684326171875
[rfa agg] iter:  4, weight: tensor([0.1576, 0.1172, 0.1591, 0.0306, 0.1903, 0.0581, 0.0561, 0.1044, 0.0620,
        0.0646])
[rfa agg] iter:  5, prev_obj_val: 60.90559387207031, obj_val: 63.75204849243164, abs dis: 2.846454620361328
[rfa agg] iter:  5, weight: tensor([0.1447, 0.1113, 0.1838, 0.0346, 0.1759, 0.0584, 0.0651, 0.0998, 0.0620,
        0.0644])
[rfa agg] iter:  6, prev_obj_val: 63.75204849243164, obj_val: 63.746665954589844, abs dis: 0.005382537841796875
[rfa agg] iter:  6, weight: tensor([0.1330, 0.1057, 0.2060, 0.0392, 0.1595, 0.0586, 0.0763, 0.0956, 0.0620,
        0.0641])
[rfa agg] iter:  7, prev_obj_val: 63.746665954589844, obj_val: 63.7464714050293, abs dis: 0.000194549560546875
[rfa agg] iter:  7, weight: tensor([0.1318, 0.1050, 0.2118, 0.0391, 0.1573, 0.0583, 0.0763, 0.0950, 0.0617,
        0.0638])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 15.2148, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 16.0235, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.1940791606903 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0814, Accuracy: 34/515 (6.6019%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.2170, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0951, Accuracy: 29/486 (5.9671%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0460, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.3247, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0912, Accuracy: 74/603 (12.2720%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0543, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7238, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0650, Accuracy: 336/1427 (23.5459%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0370, Accuracy: 532/1427 (37.2810%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.9782, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0686, Accuracy: 133/938 (14.1791%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0350, Accuracy: 312/938 (33.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.0544, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0586, Accuracy: 268/1036 (25.8687%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0270, Accuracy: 629/1036 (60.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.0948, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0615, Accuracy: 275/1446 (19.0180%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0365, Accuracy: 483/1446 (33.4025%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1577, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0779, Accuracy: 171/715 (23.9161%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0437, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4252, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0692, Accuracy: 122/735 (16.5986%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 351/735 (47.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.1744, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0606, Accuracy: 359/1470 (24.4218%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0253, Accuracy: 789/1470 (53.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.5894, Accuracy: 93/10000 (0.9300%)
time spent on training: 183.79229593276978
[rfa agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 30, 88, 34, 73, 19, 26, 23, 32, 22], weight: tensor([0.0550, 0.0519, 0.0643, 0.1523, 0.1001, 0.1106, 0.1543, 0.0763, 0.0784,
        0.1569])
[rfa agg] iter:  0, prev_obj_val: 54.91897201538086, obj_val: 57.14959716796875, abs dis: 2.2306251525878906
[rfa agg] iter:  0, weight: tensor([0.0410, 0.0344, 0.0592, 0.0895, 0.2187, 0.1745, 0.0899, 0.0967, 0.1056,
        0.0906])
[rfa agg] iter:  1, prev_obj_val: 57.14959716796875, obj_val: 62.182315826416016, abs dis: 5.032718658447266
[rfa agg] iter:  1, weight: tensor([0.0462, 0.0385, 0.0704, 0.0778, 0.2173, 0.1421, 0.0783, 0.1177, 0.1328,
        0.0789])
[rfa agg] iter:  2, prev_obj_val: 62.182315826416016, obj_val: 60.26155471801758, abs dis: 1.9207611083984375
[rfa agg] iter:  2, weight: tensor([0.0588, 0.0485, 0.1003, 0.0663, 0.1485, 0.1034, 0.0669, 0.1535, 0.1863,
        0.0676])
[rfa agg] iter:  3, prev_obj_val: 60.26155471801758, obj_val: 64.1863784790039, abs dis: 3.924823760986328
[rfa agg] iter:  3, weight: tensor([0.0540, 0.0447, 0.0888, 0.0689, 0.1600, 0.1116, 0.0695, 0.1502, 0.1822,
        0.0701])
[rfa agg] iter:  4, prev_obj_val: 64.1863784790039, obj_val: 69.05377197265625, abs dis: 4.867393493652344
[rfa agg] iter:  4, weight: tensor([0.0635, 0.0523, 0.1149, 0.0618, 0.1254, 0.0921, 0.0624, 0.1612, 0.2034,
        0.0630])
[rfa agg] iter:  5, prev_obj_val: 69.05377197265625, obj_val: 66.48287963867188, abs dis: 2.570892333984375
[rfa agg] iter:  5, weight: tensor([0.0786, 0.0658, 0.1624, 0.0577, 0.1021, 0.0798, 0.0583, 0.1509, 0.1854,
        0.0589])
[rfa agg] iter:  6, prev_obj_val: 66.48287963867188, obj_val: 71.83997344970703, abs dis: 5.357093811035156
[rfa agg] iter:  6, weight: tensor([0.0708, 0.0584, 0.1406, 0.0587, 0.1096, 0.0839, 0.0593, 0.1580, 0.2008,
        0.0599])
[rfa agg] iter:  7, prev_obj_val: 71.83997344970703, obj_val: 71.81787109375, abs dis: 0.02210235595703125
[rfa agg] iter:  7, weight: tensor([0.0882, 0.0755, 0.1929, 0.0563, 0.0942, 0.0755, 0.0569, 0.1385, 0.1644,
        0.0575])
[rfa agg] iter:  8, prev_obj_val: 71.81787109375, obj_val: 69.04258728027344, abs dis: 2.7752838134765625
[rfa agg] iter:  8, weight: tensor([0.0890, 0.0758, 0.2037, 0.0557, 0.0930, 0.0745, 0.0562, 0.1354, 0.1598,
        0.0569])
[rfa agg] iter:  9, prev_obj_val: 69.04258728027344, obj_val: 66.4862060546875, abs dis: 2.5563812255859375
[rfa agg] iter:  9, weight: tensor([0.0799, 0.0664, 0.1749, 0.0571, 0.1004, 0.0787, 0.0576, 0.1470, 0.1797,
        0.0582])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8816, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.3686, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.6677496433258 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0697, Accuracy: 301/1163 (25.8813%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0392, Accuracy: 440/1163 (37.8332%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9783, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0861, Accuracy: 48/500 (9.6000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0512, Accuracy: 195/500 (39.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.2638, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0531, Accuracy: 341/1628 (20.9459%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0271, Accuracy: 768/1628 (47.1744%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.8344, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0591, Accuracy: 268/1013 (26.4561%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 485/1013 (47.8776%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.9887, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0724, Accuracy: 208/807 (25.7745%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0371, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.7838, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0575, Accuracy: 378/1470 (25.7143%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 799/1470 (54.3537%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.3504, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0943, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0645, Accuracy: 95/311 (30.5466%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3070, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0498, Accuracy: 403/1552 (25.9665%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 728/1552 (46.9072%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.0598, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0746, Accuracy: 156/636 (24.5283%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0360, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.3107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.1002, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0577, Accuracy: 84/373 (22.5201%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1314, Accuracy: 62/10000 (0.6200%)
time spent on training: 183.96016383171082
[rfa agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 82, 5, 39, 20, 22, 96, 74, 52, 98], weight: tensor([0.1230, 0.0529, 0.1722, 0.1072, 0.0854, 0.1555, 0.0329, 0.1642, 0.0673,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 63.829872131347656, obj_val: 64.85987854003906, abs dis: 1.0300064086914062
[rfa agg] iter:  0, weight: tensor([0.1955, 0.0336, 0.0980, 0.2474, 0.1134, 0.1206, 0.0153, 0.1017, 0.0543,
        0.0202])
[rfa agg] iter:  1, prev_obj_val: 64.85987854003906, obj_val: 66.30210876464844, abs dis: 1.442230224609375
[rfa agg] iter:  1, weight: tensor([0.1746, 0.0339, 0.0890, 0.2909, 0.1218, 0.1075, 0.0152, 0.0915, 0.0556,
        0.0201])
[rfa agg] iter:  2, prev_obj_val: 66.30210876464844, obj_val: 67.93706512451172, abs dis: 1.6349563598632812
[rfa agg] iter:  2, weight: tensor([0.1564, 0.0359, 0.0850, 0.3005, 0.1368, 0.1014, 0.0159, 0.0872, 0.0599,
        0.0211])
[rfa agg] iter:  3, prev_obj_val: 67.93706512451172, obj_val: 66.30108642578125, abs dis: 1.6359786987304688
[rfa agg] iter:  3, weight: tensor([0.1447, 0.0392, 0.0833, 0.2847, 0.1585, 0.0983, 0.0170, 0.0852, 0.0664,
        0.0227])
[rfa agg] iter:  4, prev_obj_val: 66.30108642578125, obj_val: 67.93623352050781, abs dis: 1.6351470947265625
[rfa agg] iter:  4, weight: tensor([0.1543, 0.0359, 0.0847, 0.3007, 0.1396, 0.1009, 0.0159, 0.0869, 0.0600,
        0.0211])
[rfa agg] iter:  5, prev_obj_val: 67.93623352050781, obj_val: 66.3011245727539, abs dis: 1.6351089477539062
[rfa agg] iter:  5, weight: tensor([0.1445, 0.0392, 0.0833, 0.2849, 0.1588, 0.0982, 0.0170, 0.0852, 0.0664,
        0.0227])
[rfa agg] iter:  6, prev_obj_val: 66.3011245727539, obj_val: 67.93623352050781, abs dis: 1.6351089477539062
[rfa agg] iter:  6, weight: tensor([0.1543, 0.0359, 0.0847, 0.3008, 0.1396, 0.1009, 0.0159, 0.0869, 0.0599,
        0.0211])
[rfa agg] iter:  7, prev_obj_val: 67.93623352050781, obj_val: 66.30113220214844, abs dis: 1.635101318359375
[rfa agg] iter:  7, weight: tensor([0.1445, 0.0392, 0.0833, 0.2849, 0.1588, 0.0982, 0.0170, 0.0852, 0.0664,
        0.0227])
[rfa agg] iter:  8, prev_obj_val: 66.30113220214844, obj_val: 67.93623352050781, abs dis: 1.635101318359375
[rfa agg] iter:  8, weight: tensor([0.1543, 0.0359, 0.0847, 0.3008, 0.1396, 0.1009, 0.0159, 0.0869, 0.0599,
        0.0211])
[rfa agg] iter:  9, prev_obj_val: 67.93623352050781, obj_val: 66.30113220214844, abs dis: 1.635101318359375
[rfa agg] iter:  9, weight: tensor([0.1445, 0.0392, 0.0833, 0.2849, 0.1588, 0.0982, 0.0170, 0.0852, 0.0664,
        0.0227])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8803, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.4804, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.60697197914124 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0742, Accuracy: 129/809 (15.9456%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0306, Accuracy: 278/809 (34.3634%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.2565, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0668, Accuracy: 216/1213 (17.8071%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0302, Accuracy: 515/1213 (42.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.5285, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0739, Accuracy: 153/636 (24.0566%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0370, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.8721, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0695, Accuracy: 134/938 (14.2857%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 310/938 (33.0490%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.6189, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0693, Accuracy: 225/719 (31.2935%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0364, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8683, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0570, Accuracy: 455/2227 (20.4311%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0305, Accuracy: 889/2227 (39.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.3414, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0603, Accuracy: 235/712 (33.0056%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.9435, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0559, Accuracy: 217/813 (26.6913%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 446/813 (54.8585%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.9891, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0603, Accuracy: 194/590 (32.8814%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.8576, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0610, Accuracy: 152/861 (17.6539%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 457/861 (53.0778%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.6472, Accuracy: 89/10000 (0.8900%)
time spent on training: 186.620423078537
[rfa agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [50, 97, 52, 73, 41, 60, 11, 53, 69, 10], weight: tensor([0.0850, 0.1274, 0.0668, 0.0986, 0.0755, 0.2340, 0.0748, 0.0854, 0.0620,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 68.8233413696289, obj_val: 74.98246002197266, abs dis: 6.15911865234375
[rfa agg] iter:  0, weight: tensor([0.1064, 0.1522, 0.0490, 0.1900, 0.0775, 0.0574, 0.0760, 0.1065, 0.0460,
        0.1390])
[rfa agg] iter:  1, prev_obj_val: 74.98246002197266, obj_val: 80.44161224365234, abs dis: 5.4591522216796875
[rfa agg] iter:  1, weight: tensor([0.1255, 0.0623, 0.0945, 0.0943, 0.1313, 0.0378, 0.1243, 0.1282, 0.0952,
        0.1067])
[rfa agg] iter:  2, prev_obj_val: 80.44161224365234, obj_val: 83.72127532958984, abs dis: 3.2796630859375
[rfa agg] iter:  2, weight: tensor([0.1089, 0.0592, 0.1279, 0.0810, 0.1243, 0.0390, 0.1212, 0.1115, 0.1357,
        0.0913])
[rfa agg] iter:  3, prev_obj_val: 83.72127532958984, obj_val: 80.42382049560547, abs dis: 3.297454833984375
[rfa agg] iter:  3, weight: tensor([0.1018, 0.0593, 0.1448, 0.0783, 0.1158, 0.0404, 0.1134, 0.1040, 0.1555,
        0.0868])
[rfa agg] iter:  4, prev_obj_val: 80.42382049560547, obj_val: 83.71881866455078, abs dis: 3.2949981689453125
[rfa agg] iter:  4, weight: tensor([0.1067, 0.0585, 0.1342, 0.0798, 0.1216, 0.0386, 0.1186, 0.1095, 0.1429,
        0.0897])
[rfa agg] iter:  5, prev_obj_val: 83.71881866455078, obj_val: 80.42408752441406, abs dis: 3.2947311401367188
[rfa agg] iter:  5, weight: tensor([0.1015, 0.0592, 0.1456, 0.0781, 0.1154, 0.0403, 0.1130, 0.1037, 0.1566,
        0.0866])
[rfa agg] iter:  6, prev_obj_val: 80.42408752441406, obj_val: 83.7187728881836, abs dis: 3.2946853637695312
[rfa agg] iter:  6, weight: tensor([0.1067, 0.0585, 0.1343, 0.0797, 0.1215, 0.0385, 0.1186, 0.1095, 0.1430,
        0.0896])
[rfa agg] iter:  7, prev_obj_val: 83.7187728881836, obj_val: 80.4240951538086, abs dis: 3.294677734375
[rfa agg] iter:  7, weight: tensor([0.1015, 0.0592, 0.1456, 0.0781, 0.1154, 0.0403, 0.1130, 0.1037, 0.1566,
        0.0866])
[rfa agg] iter:  8, prev_obj_val: 80.4240951538086, obj_val: 83.71876525878906, abs dis: 3.2946701049804688
[rfa agg] iter:  8, weight: tensor([0.1067, 0.0585, 0.1343, 0.0797, 0.1215, 0.0385, 0.1186, 0.1095, 0.1430,
        0.0896])
[rfa agg] iter:  9, prev_obj_val: 83.71876525878906, obj_val: 80.4240951538086, abs dis: 3.2946701049804688
[rfa agg] iter:  9, weight: tensor([0.1015, 0.0592, 0.1456, 0.0781, 0.1154, 0.0403, 0.1130, 0.1037, 0.1566,
        0.0866])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 27.2028, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 28.1456, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 282.9373104572296 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0567, Accuracy: 354/1953 (18.1260%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0349, Accuracy: 694/1953 (35.5351%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5633, Accuracy: 100/10000 (1.0000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 352/1574 (22.3634%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0298, Accuracy: 573/1574 (36.4041%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.5829, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0717, Accuracy: 132/809 (16.3164%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 269/809 (33.2509%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.8888, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.1104, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0624, Accuracy: 75/312 (24.0385%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5433, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0476, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 670/1129 (59.3446%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.7988, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0538, Accuracy: 312/1628 (19.1646%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 729/1628 (44.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.7858, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0610, Accuracy: 257/1130 (22.7434%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 491/1130 (43.4513%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.0623, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0727, Accuracy: 158/636 (24.8428%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0357, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.4600, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0571, Accuracy: 247/712 (34.6910%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 443/712 (62.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.3176, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0664, Accuracy: 291/1163 (25.0215%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0382, Accuracy: 456/1163 (39.2089%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2687, Accuracy: 61/10000 (0.6100%)
time spent on training: 213.48384857177734
[rfa agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.04452969400688032
[rfa agg] init. name: [83, 17, 50, 24, 37, 5, 54, 52, 11, 68], weight: tensor([0.1768, 0.1425, 0.0732, 0.0282, 0.1022, 0.1474, 0.1023, 0.0576, 0.0645,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 63.59394454956055, obj_val: 65.75050354003906, abs dis: 2.1565589904785156
[rfa agg] iter:  0, weight: tensor([0.0713, 0.1043, 0.0642, 0.0104, 0.1685, 0.0951, 0.2108, 0.0335, 0.0475,
        0.1944])
[rfa agg] iter:  1, prev_obj_val: 65.75050354003906, obj_val: 67.3378677368164, abs dis: 1.5873641967773438
[rfa agg] iter:  1, weight: tensor([0.0650, 0.0902, 0.0747, 0.0110, 0.1780, 0.0835, 0.2274, 0.0369, 0.0539,
        0.1794])
[rfa agg] iter:  2, prev_obj_val: 67.3378677368164, obj_val: 65.73970794677734, abs dis: 1.5981597900390625
[rfa agg] iter:  2, weight: tensor([0.0646, 0.0877, 0.0850, 0.0118, 0.1785, 0.0816, 0.2240, 0.0405, 0.0600,
        0.1663])
[rfa agg] iter:  3, prev_obj_val: 65.73970794677734, obj_val: 67.33684539794922, abs dis: 1.597137451171875
[rfa agg] iter:  3, weight: tensor([0.0646, 0.0896, 0.0749, 0.0110, 0.1807, 0.0829, 0.2328, 0.0368, 0.0538,
        0.1731])
[rfa agg] iter:  4, prev_obj_val: 67.33684539794922, obj_val: 65.73974609375, abs dis: 1.5970993041992188
[rfa agg] iter:  4, weight: tensor([0.0646, 0.0876, 0.0849, 0.0118, 0.1788, 0.0815, 0.2253, 0.0404, 0.0600,
        0.1652])
[rfa agg] iter:  5, prev_obj_val: 65.73974609375, obj_val: 67.33683013916016, abs dis: 1.5970840454101562
[rfa agg] iter:  5, weight: tensor([0.0646, 0.0895, 0.0749, 0.0110, 0.1807, 0.0829, 0.2331, 0.0368, 0.0538,
        0.1728])
[rfa agg] iter:  6, prev_obj_val: 67.33683013916016, obj_val: 65.73975372314453, abs dis: 1.597076416015625
[rfa agg] iter:  6, weight: tensor([0.0646, 0.0876, 0.0849, 0.0118, 0.1788, 0.0815, 0.2253, 0.0404, 0.0600,
        0.1651])
[rfa agg] iter:  7, prev_obj_val: 65.73975372314453, obj_val: 67.33683776855469, abs dis: 1.5970840454101562
[rfa agg] iter:  7, weight: tensor([0.0646, 0.0895, 0.0749, 0.0110, 0.1807, 0.0829, 0.2331, 0.0368, 0.0538,
        0.1728])
[rfa agg] iter:  8, prev_obj_val: 67.33683776855469, obj_val: 65.73975372314453, abs dis: 1.5970840454101562
[rfa agg] iter:  8, weight: tensor([0.0646, 0.0876, 0.0849, 0.0118, 0.1788, 0.0815, 0.2253, 0.0404, 0.0600,
        0.1651])
[rfa agg] iter:  9, prev_obj_val: 65.73975372314453, obj_val: 67.33683013916016, abs dis: 1.597076416015625
[rfa agg] iter:  9, weight: tensor([0.0646, 0.0895, 0.0749, 0.0110, 0.1807, 0.0829, 0.2331, 0.0368, 0.0538,
        0.1728])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 19.3766, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 17.7342, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.68543219566345 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0868, Accuracy: 33/500 (6.6000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0509, Accuracy: 190/500 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.5362, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0563, Accuracy: 311/1340 (23.2090%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 545/1340 (40.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.5095, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0774, Accuracy: 166/715 (23.2168%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0425, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6527, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0914, Accuracy: 42/682 (6.1584%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0424, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.8545, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0688, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 244/781 (31.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.4776, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0556, Accuracy: 368/1440 (25.5556%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0307, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.5280, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0602, Accuracy: 315/1715 (18.3673%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 657/1715 (38.3090%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1237, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0647, Accuracy: 135/735 (18.3673%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 13.0960, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0656, Accuracy: 299/1163 (25.7094%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0386, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5527, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0629, Accuracy: 282/1089 (25.8953%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0292, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.4457, Accuracy: 65/10000 (0.6500%)
time spent on training: 196.67006254196167
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 77, 23, 80, 3, 29, 92, 32, 68, 59], weight: tensor([0.0492, 0.1319, 0.0704, 0.0671, 0.0769, 0.1417, 0.1688, 0.0723, 0.1145,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 59.427249908447266, obj_val: 62.0517692565918, abs dis: 2.6245193481445312
[rfa agg] iter:  0, weight: tensor([0.0359, 0.1254, 0.0902, 0.0764, 0.1271, 0.1026, 0.0820, 0.1003, 0.1516,
        0.1085])
[rfa agg] iter:  1, prev_obj_val: 62.0517692565918, obj_val: 65.29350280761719, abs dis: 3.2417335510253906
[rfa agg] iter:  1, weight: tensor([0.0395, 0.1051, 0.1055, 0.0897, 0.1573, 0.0881, 0.0728, 0.1222, 0.1235,
        0.0964])
[rfa agg] iter:  2, prev_obj_val: 65.29350280761719, obj_val: 69.33584594726562, abs dis: 4.0423431396484375
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0863, 0.1193, 0.1058, 0.1809, 0.0743, 0.0632, 0.1486, 0.0976,
        0.0812])
[rfa agg] iter:  3, prev_obj_val: 69.33584594726562, obj_val: 69.3116683959961, abs dis: 0.02417755126953125
[rfa agg] iter:  3, weight: tensor([0.0477, 0.0723, 0.1293, 0.1289, 0.1774, 0.0636, 0.0555, 0.1771, 0.0794,
        0.0687])
[rfa agg] iter:  4, prev_obj_val: 69.3116683959961, obj_val: 74.45465850830078, abs dis: 5.1429901123046875
[rfa agg] iter:  4, weight: tensor([0.0472, 0.0712, 0.1296, 0.1308, 0.1758, 0.0626, 0.0546, 0.1829, 0.0779,
        0.0672])
[rfa agg] iter:  5, prev_obj_val: 74.45465850830078, obj_val: 74.44158935546875, abs dis: 0.01306915283203125
[rfa agg] iter:  5, weight: tensor([0.0584, 0.0655, 0.1323, 0.1635, 0.1487, 0.0587, 0.0523, 0.1880, 0.0702,
        0.0625])
[rfa agg] iter:  6, prev_obj_val: 74.44158935546875, obj_val: 74.44126892089844, abs dis: 0.0003204345703125
[rfa agg] iter:  6, weight: tensor([0.0582, 0.0649, 0.1321, 0.1694, 0.1447, 0.0582, 0.0518, 0.1894, 0.0695,
        0.0617])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 26.1405, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 24.3818, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.32616686820984 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0821, Accuracy: 93/530 (17.5472%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0417, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.9750, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 185/888 (20.8333%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.0979, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0468, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 708/1129 (62.7104%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.8863, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0667, Accuracy: 343/1742 (19.6900%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0339, Accuracy: 659/1742 (37.8301%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6077, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0588, Accuracy: 270/1130 (23.8938%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.4164, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0585, Accuracy: 334/896 (37.2768%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 427/896 (47.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3006, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0651, Accuracy: 208/1154 (18.0243%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 448/1154 (38.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.8733, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 306/803 (38.1071%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0374, Accuracy: 377/803 (46.9489%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3589, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0649, Accuracy: 312/1475 (21.1525%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0345, Accuracy: 591/1475 (40.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4384, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0609, Accuracy: 235/776 (30.2835%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0265, Accuracy: 434/776 (55.9278%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5984, Accuracy: 71/10000 (0.7100%)
time spent on training: 200.8879270553589
[rfa agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 63, 37, 93, 54, 89, 57, 58, 65, 75], weight: tensor([0.0504, 0.0844, 0.1073, 0.1655, 0.1074, 0.0851, 0.1097, 0.0763, 0.1402,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 54.82103729248047, obj_val: 61.45407485961914, abs dis: 6.633037567138672
[rfa agg] iter:  0, weight: tensor([0.0333, 0.1301, 0.1309, 0.0596, 0.1384, 0.1337, 0.0998, 0.1062, 0.0705,
        0.0975])
[rfa agg] iter:  1, prev_obj_val: 61.45407485961914, obj_val: 61.35955810546875, abs dis: 0.09451675415039062
[rfa agg] iter:  1, weight: tensor([0.0428, 0.1514, 0.0885, 0.0485, 0.0914, 0.1562, 0.0718, 0.1583, 0.0548,
        0.1363])
[rfa agg] iter:  2, prev_obj_val: 61.35955810546875, obj_val: 61.358543395996094, abs dis: 0.00101470947265625
[rfa agg] iter:  2, weight: tensor([0.0418, 0.1540, 0.0849, 0.0472, 0.0881, 0.1559, 0.0692, 0.1660, 0.0532,
        0.1397])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8095, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.0591, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.2165505886078 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0935, Accuracy: 17/466 (3.6481%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0557, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4038, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.1010, Accuracy: 2/338 (0.5917%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0561, Accuracy: 97/338 (28.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1394, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0933, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0765, Accuracy: 18/186 (9.6774%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7734, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0515, Accuracy: 225/888 (25.3378%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0278, Accuracy: 391/888 (44.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.0360, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1292, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1138, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0196, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0516, Accuracy: 428/1470 (29.1156%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 799/1470 (54.3537%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.6918, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0684, Accuracy: 269/1418 (18.9704%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0343, Accuracy: 508/1418 (35.8251%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.8942, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0649, Accuracy: 333/1427 (23.3357%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0370, Accuracy: 534/1427 (37.4212%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3224, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0712, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 180/460 (39.1304%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.5250, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0521, Accuracy: 410/1552 (26.4175%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 706/1552 (45.4897%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.9249, Accuracy: 73/10000 (0.7300%)
time spent on training: 180.8334481716156
[rfa agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 12, 56, 63, 47, 22, 70, 34, 31, 74], weight: tensor([0.0559, 0.0405, 0.0223, 0.1065, 0.0161, 0.1763, 0.1700, 0.1711, 0.0552,
        0.1861])
[rfa agg] iter:  0, prev_obj_val: 69.43002319335938, obj_val: 69.3648681640625, abs dis: 0.065155029296875
[rfa agg] iter:  0, weight: tensor([0.0445, 0.0262, 0.0109, 0.2123, 0.0078, 0.1727, 0.1662, 0.1695, 0.0441,
        0.1459])
[rfa agg] iter:  1, prev_obj_val: 69.3648681640625, obj_val: 67.68971252441406, abs dis: 1.6751556396484375
[rfa agg] iter:  1, weight: tensor([0.0440, 0.0259, 0.0107, 0.2208, 0.0077, 0.1711, 0.1647, 0.1677, 0.0435,
        0.1439])
[rfa agg] iter:  2, prev_obj_val: 67.68971252441406, obj_val: 66.06693267822266, abs dis: 1.6227798461914062
[rfa agg] iter:  2, weight: tensor([0.0412, 0.0245, 0.0103, 0.1964, 0.0074, 0.1800, 0.1732, 0.1766, 0.0407,
        0.1497])
[rfa agg] iter:  3, prev_obj_val: 66.06693267822266, obj_val: 66.06062316894531, abs dis: 0.00630950927734375
[rfa agg] iter:  3, weight: tensor([0.0384, 0.0230, 0.0097, 0.1716, 0.0070, 0.1894, 0.1818, 0.1860, 0.0380,
        0.1552])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8048, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.8262, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.91386318206787 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0614, Accuracy: 325/1587 (20.4789%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0348, Accuracy: 590/1587 (37.1771%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2456, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.1079, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0662, Accuracy: 128/408 (31.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3337, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 273/712 (38.3427%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 403/712 (56.6011%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.7780, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0645, Accuracy: 172/1013 (16.9793%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5848, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0559, Accuracy: 385/1953 (19.7133%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 763/1953 (39.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5509, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0566, Accuracy: 346/1440 (24.0278%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0302, Accuracy: 690/1440 (47.9167%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5380, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0636, Accuracy: 307/1475 (20.8136%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0348, Accuracy: 607/1475 (41.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5183, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0685, Accuracy: 196/1241 (15.7937%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0404, Accuracy: 378/1241 (30.4593%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8561, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0883, Accuracy: 26/682 (3.8123%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 253/682 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.7829, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0620, Accuracy: 171/861 (19.8606%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0235, Accuracy: 429/861 (49.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.8905, Accuracy: 89/10000 (0.8900%)
time spent on training: 213.31230688095093
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 36, 11, 14, 83, 29, 65, 72, 80, 10], weight: tensor([0.1396, 0.0359, 0.0626, 0.0891, 0.1717, 0.1266, 0.1297, 0.1091, 0.0600,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 62.899906158447266, obj_val: 65.60753631591797, abs dis: 2.707630157470703
[rfa agg] iter:  0, weight: tensor([0.1157, 0.0174, 0.0515, 0.1484, 0.0764, 0.1406, 0.1173, 0.2048, 0.0440,
        0.0838])
[rfa agg] iter:  1, prev_obj_val: 65.60753631591797, obj_val: 65.58628845214844, abs dis: 0.02124786376953125
[rfa agg] iter:  1, weight: tensor([0.1021, 0.0191, 0.0594, 0.1907, 0.0709, 0.1206, 0.1034, 0.1827, 0.0504,
        0.1008])
[rfa agg] iter:  2, prev_obj_val: 65.58628845214844, obj_val: 65.58595275878906, abs dis: 0.000335693359375
[rfa agg] iter:  2, weight: tensor([0.1015, 0.0190, 0.0592, 0.1973, 0.0705, 0.1196, 0.1026, 0.1792, 0.0502,
        0.1011])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 16.4496, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 10.3147, Accuracy: 6/9950 (0.0603%)
saving model
Done in 306.92431831359863 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0826, Accuracy: 101/603 (16.7496%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1071, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1556, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1455, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7422, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0665, Accuracy: 340/1742 (19.5178%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0349, Accuracy: 657/1742 (37.7153%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7286, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0798, Accuracy: 102/530 (19.2453%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0406, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.6432, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0882, Accuracy: 32/682 (4.6921%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0402, Accuracy: 278/682 (40.7625%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.2941, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0572, Accuracy: 344/1715 (20.0583%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0325, Accuracy: 650/1715 (37.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0142, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0771, Accuracy: 156/677 (23.0428%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0259, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 13.4132, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0696, Accuracy: 191/1241 (15.3908%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0401, Accuracy: 364/1241 (29.3312%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8381, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0673, Accuracy: 256/1956 (13.0879%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0356, Accuracy: 556/1956 (28.4254%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9875, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0670, Accuracy: 272/1418 (19.1819%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0331, Accuracy: 550/1418 (38.7870%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8882, Accuracy: 88/10000 (0.8800%)
time spent on training: 207.51742219924927
[rfa agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 61, 93, 18, 80, 92, 90, 72, 6, 70], weight: tensor([0.0566, 0.0080, 0.1636, 0.0498, 0.0640, 0.1610, 0.0636, 0.1165, 0.1837,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 71.48716735839844, obj_val: 72.5794677734375, abs dis: 1.0923004150390625
[rfa agg] iter:  0, weight: tensor([0.0329, 0.0025, 0.1276, 0.0264, 0.0410, 0.1374, 0.0408, 0.2762, 0.1045,
        0.2106])
[rfa agg] iter:  1, prev_obj_val: 72.5794677734375, obj_val: 77.74087524414062, abs dis: 5.161407470703125
[rfa agg] iter:  1, weight: tensor([0.0331, 0.0025, 0.1156, 0.0264, 0.0414, 0.1250, 0.0412, 0.3240, 0.0956,
        0.1952])
[rfa agg] iter:  2, prev_obj_val: 77.74087524414062, obj_val: 75.86398315429688, abs dis: 1.87689208984375
[rfa agg] iter:  2, weight: tensor([0.0432, 0.0030, 0.1114, 0.0340, 0.0549, 0.1193, 0.0548, 0.3147, 0.0956,
        0.1691])
[rfa agg] iter:  3, prev_obj_val: 75.86398315429688, obj_val: 74.12567901611328, abs dis: 1.7383041381835938
[rfa agg] iter:  3, weight: tensor([0.0390, 0.0028, 0.1107, 0.0308, 0.0492, 0.1186, 0.0491, 0.3339, 0.0940,
        0.1719])
[rfa agg] iter:  4, prev_obj_val: 74.12567901611328, obj_val: 75.86215209960938, abs dis: 1.7364730834960938
[rfa agg] iter:  4, weight: tensor([0.0350, 0.0026, 0.1101, 0.0278, 0.0440, 0.1184, 0.0438, 0.3496, 0.0923,
        0.1763])
[rfa agg] iter:  5, prev_obj_val: 75.86215209960938, obj_val: 74.12474822998047, abs dis: 1.7374038696289062
[rfa agg] iter:  5, weight: tensor([0.0385, 0.0028, 0.1095, 0.0304, 0.0486, 0.1174, 0.0484, 0.3413, 0.0929,
        0.1701])
[rfa agg] iter:  6, prev_obj_val: 74.12474822998047, obj_val: 74.12313842773438, abs dis: 0.00160980224609375
[rfa agg] iter:  6, weight: tensor([0.0349, 0.0026, 0.1097, 0.0277, 0.0438, 0.1180, 0.0437, 0.3521, 0.0920,
        0.1754])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7669, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.3181, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.7438020706177 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0671, Accuracy: 236/946 (24.9471%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0371, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2965, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0821, Accuracy: 29/500 (5.8000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0511, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.6156, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0640, Accuracy: 228/599 (38.0634%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0307, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 14.2555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0662, Accuracy: 189/1071 (17.6471%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0311, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.7314, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0543, Accuracy: 291/1628 (17.8747%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0274, Accuracy: 734/1628 (45.0860%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8149, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0711, Accuracy: 122/938 (13.0064%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 330/938 (35.1812%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.1578, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0529, Accuracy: 236/888 (26.5766%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 412/888 (46.3964%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.8424, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0681, Accuracy: 207/1131 (18.3024%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0323, Accuracy: 465/1131 (41.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1815, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0603, Accuracy: 301/1645 (18.2979%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0350, Accuracy: 567/1645 (34.4681%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1812, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0931, Accuracy: 12/466 (2.5751%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0531, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4732, Accuracy: 56/10000 (0.5600%)
time spent on training: 198.65437698364258
[rfa agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 82, 95, 55, 5, 73, 63, 38, 13, 76], weight: tensor([0.0964, 0.0510, 0.0610, 0.1092, 0.1659, 0.0956, 0.0905, 0.1153, 0.1677,
        0.0475])
[rfa agg] iter:  0, prev_obj_val: 57.4556884765625, obj_val: 62.384769439697266, abs dis: 4.929080963134766
[rfa agg] iter:  0, weight: tensor([0.1866, 0.0305, 0.0488, 0.1398, 0.0650, 0.1602, 0.1495, 0.1265, 0.0650,
        0.0282])
[rfa agg] iter:  1, prev_obj_val: 62.384769439697266, obj_val: 62.360965728759766, abs dis: 0.0238037109375
[rfa agg] iter:  1, weight: tensor([0.1782, 0.0398, 0.0679, 0.1157, 0.0604, 0.1570, 0.1820, 0.1021, 0.0603,
        0.0366])
[rfa agg] iter:  2, prev_obj_val: 62.360965728759766, obj_val: 62.36063003540039, abs dis: 0.000335693359375
[rfa agg] iter:  2, weight: tensor([0.1772, 0.0397, 0.0680, 0.1138, 0.0599, 0.1563, 0.1882, 0.1006, 0.0598,
        0.0365])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.7983, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.5025, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.47437739372253 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0678, Accuracy: 217/807 (26.8897%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0344, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5967, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0721, Accuracy: 196/715 (27.4126%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0450, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.4653, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0644, Accuracy: 267/803 (33.2503%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0363, Accuracy: 422/803 (52.5529%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8930, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0655, Accuracy: 234/946 (24.7357%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3200, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0824, Accuracy: 28/500 (5.6000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0506, Accuracy: 200/500 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.5986, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0655, Accuracy: 210/1513 (13.8797%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0397, Accuracy: 410/1513 (27.0985%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9167, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0642, Accuracy: 289/708 (40.8192%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 410/708 (57.9096%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0204, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0755, Accuracy: 254/1003 (25.3240%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 404/1003 (40.2792%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1734, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0682, Accuracy: 165/1049 (15.7293%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0332, Accuracy: 463/1049 (44.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.4534, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0701, Accuracy: 125/568 (22.0070%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0439, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3411, Accuracy: 52/10000 (0.5200%)
time spent on training: 186.81814408302307
[rfa agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 23, 58, 43, 82, 8, 16, 86, 51, 62], weight: tensor([0.0937, 0.0830, 0.0932, 0.1098, 0.0581, 0.1757, 0.0822, 0.1165, 0.1218,
        0.0660])
[rfa agg] iter:  0, prev_obj_val: 45.500732421875, obj_val: 51.54873275756836, abs dis: 6.048000335693359
[rfa agg] iter:  0, weight: tensor([0.1356, 0.1042, 0.1812, 0.1219, 0.0433, 0.0560, 0.1029, 0.1073, 0.0854,
        0.0622])
[rfa agg] iter:  1, prev_obj_val: 51.54873275756836, obj_val: 54.185935974121094, abs dis: 2.6372032165527344
[rfa agg] iter:  1, weight: tensor([0.1270, 0.1146, 0.1519, 0.1021, 0.0658, 0.0555, 0.1141, 0.0904, 0.0766,
        0.1021])
[rfa agg] iter:  2, prev_obj_val: 54.185935974121094, obj_val: 54.181095123291016, abs dis: 0.004840850830078125
[rfa agg] iter:  2, weight: tensor([0.1192, 0.1141, 0.1360, 0.0968, 0.0776, 0.0559, 0.1133, 0.0867, 0.0748,
        0.1257])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8277, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.6572, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.41208148002625 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0676, Accuracy: 230/807 (28.5006%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0344, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.9422, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0952, Accuracy: 11/486 (2.2634%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0470, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.4616, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0654, Accuracy: 227/946 (23.9958%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0374, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3116, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0862, Accuracy: 95/603 (15.7546%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0512, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 207/590 (35.0847%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.9402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1149, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.1001, Accuracy: 18/197 (9.1371%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4915, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0800, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.7447, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0653, Accuracy: 242/901 (26.8590%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 429/901 (47.6138%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.8576, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0683, Accuracy: 282/1163 (24.2476%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0394, Accuracy: 456/1163 (39.2089%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1763, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0518, Accuracy: 402/1552 (25.9021%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 711/1552 (45.8119%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.0079, Accuracy: 85/10000 (0.8500%)
time spent on training: 180.5548849105835
[rfa agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 30, 43, 88, 69, 79, 82, 4, 68, 74], weight: tensor([0.1042, 0.0628, 0.1221, 0.0779, 0.0762, 0.0254, 0.0646, 0.1163, 0.1502,
        0.2004])
[rfa agg] iter:  0, prev_obj_val: 53.19182205200195, obj_val: 57.65846252441406, abs dis: 4.466640472412109
[rfa agg] iter:  0, weight: tensor([0.1786, 0.0469, 0.2037, 0.0861, 0.0819, 0.0108, 0.0486, 0.1616, 0.1069,
        0.0749])
[rfa agg] iter:  1, prev_obj_val: 57.65846252441406, obj_val: 57.56488037109375, abs dis: 0.0935821533203125
[rfa agg] iter:  1, weight: tensor([0.1671, 0.0680, 0.1371, 0.1442, 0.1313, 0.0131, 0.0709, 0.1198, 0.0837,
        0.0648])
[rfa agg] iter:  2, prev_obj_val: 57.56488037109375, obj_val: 57.564247131347656, abs dis: 0.00063323974609375
[rfa agg] iter:  2, weight: tensor([0.1645, 0.0683, 0.1329, 0.1509, 0.1365, 0.0131, 0.0711, 0.1167, 0.0821,
        0.0639])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 14.5012, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 12.0403, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.6373813152313 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0665, Accuracy: 268/1956 (13.7014%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0355, Accuracy: 566/1956 (28.9366%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0371, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0709, Accuracy: 120/938 (12.7932%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.2081, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0635, Accuracy: 203/776 (26.1598%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0321, Accuracy: 393/776 (50.6443%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.1875, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0763, Accuracy: 127/773 (16.4295%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.5800, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0701, Accuracy: 213/1154 (18.4575%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0316, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.2919, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0672, Accuracy: 174/1513 (11.5003%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0397, Accuracy: 411/1513 (27.1646%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5987, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0591, Accuracy: 309/1036 (29.8263%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0268, Accuracy: 622/1036 (60.0386%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.1030, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0945, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0638, Accuracy: 87/311 (27.9743%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9925, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1472, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1295, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3238, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0658, Accuracy: 335/1475 (22.7119%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0355, Accuracy: 572/1475 (38.7797%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8120, Accuracy: 69/10000 (0.6900%)
time spent on training: 206.0802345275879
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 73, 75, 99, 15, 8, 19, 96, 47, 65], weight: tensor([0.1943, 0.0932, 0.0771, 0.0768, 0.1146, 0.1503, 0.1029, 0.0309, 0.0133,
        0.1465])
[rfa agg] iter:  0, prev_obj_val: 63.96091079711914, obj_val: 66.0892105102539, abs dis: 2.1282997131347656
[rfa agg] iter:  0, weight: tensor([0.0923, 0.1153, 0.0686, 0.0666, 0.1740, 0.1481, 0.1768, 0.0125, 0.0046,
        0.1412])
[rfa agg] iter:  1, prev_obj_val: 66.0892105102539, obj_val: 66.03453063964844, abs dis: 0.05467987060546875
[rfa agg] iter:  1, weight: tensor([0.0772, 0.1452, 0.0805, 0.0771, 0.1605, 0.1145, 0.2179, 0.0129, 0.0047,
        0.1094])
[rfa agg] iter:  2, prev_obj_val: 66.03453063964844, obj_val: 68.56330871582031, abs dis: 2.528778076171875
[rfa agg] iter:  2, weight: tensor([0.0760, 0.1466, 0.0798, 0.0764, 0.1563, 0.1122, 0.2286, 0.0128, 0.0046,
        0.1068])
[rfa agg] iter:  3, prev_obj_val: 68.56330871582031, obj_val: 68.5435791015625, abs dis: 0.0197296142578125
[rfa agg] iter:  3, weight: tensor([0.0696, 0.1765, 0.0927, 0.0874, 0.1365, 0.0979, 0.2275, 0.0135, 0.0048,
        0.0936])
[rfa agg] iter:  4, prev_obj_val: 68.5435791015625, obj_val: 68.54322814941406, abs dis: 0.0003509521484375
[rfa agg] iter:  4, weight: tensor([0.0691, 0.1810, 0.0925, 0.0874, 0.1336, 0.0971, 0.2284, 0.0134, 0.0048,
        0.0927])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8442, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.5545, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.6139175891876 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 62/631 (9.8257%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.9364, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0536, Accuracy: 299/1628 (18.3661%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 711/1628 (43.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.8325, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0701, Accuracy: 127/938 (13.5394%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 329/938 (35.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.2996, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 279/896 (31.1384%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 429/896 (47.8795%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4534, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0732, Accuracy: 184/774 (23.7726%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0416, Accuracy: 326/774 (42.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.9222, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0787, Accuracy: 174/715 (24.3357%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0430, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5181, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0673, Accuracy: 131/735 (17.8231%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 351/735 (47.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 13.1173, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0559, Accuracy: 315/1340 (23.5075%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 567/1340 (42.3134%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.9660, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0780, Accuracy: 96/530 (18.1132%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.7325, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0572, Accuracy: 389/1953 (19.9181%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0351, Accuracy: 733/1953 (37.5320%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1256, Accuracy: 97/10000 (0.9700%)
time spent on training: 208.02590560913086
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 5, 73, 89, 81, 23, 32, 77, 18, 83], weight: tensor([0.0622, 0.1606, 0.0925, 0.0884, 0.0763, 0.0705, 0.0725, 0.1321, 0.0523,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 69.04912567138672, obj_val: 71.84195709228516, abs dis: 2.7928314208984375
[rfa agg] iter:  0, weight: tensor([0.0546, 0.0866, 0.1932, 0.1601, 0.1040, 0.0783, 0.0857, 0.1274, 0.0392,
        0.0709])
[rfa agg] iter:  1, prev_obj_val: 71.84195709228516, obj_val: 73.22025299072266, abs dis: 1.3782958984375
[rfa agg] iter:  1, weight: tensor([0.0643, 0.0607, 0.1838, 0.1897, 0.1255, 0.0914, 0.1072, 0.0815, 0.0435,
        0.0523])
[rfa agg] iter:  2, prev_obj_val: 73.22025299072266, obj_val: 76.97057342529297, abs dis: 3.7503204345703125
[rfa agg] iter:  2, weight: tensor([0.0704, 0.0573, 0.1624, 0.1881, 0.1331, 0.0975, 0.1198, 0.0748, 0.0466,
        0.0499])
[rfa agg] iter:  3, prev_obj_val: 76.97057342529297, obj_val: 81.83222961425781, abs dis: 4.861656188964844
[rfa agg] iter:  3, weight: tensor([0.0900, 0.0542, 0.1302, 0.1603, 0.1371, 0.1104, 0.1444, 0.0684, 0.0569,
        0.0481])
[rfa agg] iter:  4, prev_obj_val: 81.83222961425781, obj_val: 81.81510162353516, abs dis: 0.01712799072265625
[rfa agg] iter:  4, weight: tensor([0.1210, 0.0530, 0.1084, 0.1307, 0.1271, 0.1175, 0.1567, 0.0646, 0.0732,
        0.0478])
[rfa agg] iter:  5, prev_obj_val: 81.81510162353516, obj_val: 81.81494140625, abs dis: 0.00016021728515625
[rfa agg] iter:  5, weight: tensor([0.1231, 0.0527, 0.1070, 0.1283, 0.1256, 0.1182, 0.1596, 0.0642, 0.0737,
        0.0475])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8903, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.2289, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.45939350128174 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0912, Accuracy: 19/486 (3.9095%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0456, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.6295, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0573, Accuracy: 297/708 (41.9492%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0395, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6784, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 232/888 (26.1261%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 432/888 (48.6486%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.1956, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0775, Accuracy: 140/677 (20.6795%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 470/677 (69.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.7648, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0822, Accuracy: 14/515 (2.7184%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0513, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9212, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0928, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0547, Accuracy: 92/373 (24.6649%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6639, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0664, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 245/781 (31.3700%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.8899, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0740, Accuracy: 98/568 (17.2535%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0445, Accuracy: 269/568 (47.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6872, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0669, Accuracy: 280/1949 (14.3663%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0353, Accuracy: 611/1949 (31.3494%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0744, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0560, Accuracy: 321/1036 (30.9846%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0265, Accuracy: 635/1036 (61.2934%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.4485, Accuracy: 79/10000 (0.7900%)
time spent on training: 188.05825281143188
[rfa agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 16, 63, 90, 33, 98, 3, 62, 21, 19], weight: tensor([0.0609, 0.0887, 0.1113, 0.0848, 0.0645, 0.0467, 0.0979, 0.0712, 0.2442,
        0.1298])
[rfa agg] iter:  0, prev_obj_val: 67.81201171875, obj_val: 69.58572387695312, abs dis: 1.773712158203125
[rfa agg] iter:  0, weight: tensor([0.0440, 0.1189, 0.1870, 0.1012, 0.0511, 0.0259, 0.1670, 0.0601, 0.0726,
        0.1723])
[rfa agg] iter:  1, prev_obj_val: 69.58572387695312, obj_val: 72.66557312011719, abs dis: 3.0798492431640625
[rfa agg] iter:  1, weight: tensor([0.0621, 0.1448, 0.1348, 0.1632, 0.0699, 0.0320, 0.1539, 0.0946, 0.0527,
        0.0921])
[rfa agg] iter:  2, prev_obj_val: 72.66557312011719, obj_val: 72.63430786132812, abs dis: 0.0312652587890625
[rfa agg] iter:  2, weight: tensor([0.0788, 0.1311, 0.1096, 0.1786, 0.0836, 0.0377, 0.1245, 0.1264, 0.0504,
        0.0793])
[rfa agg] iter:  3, prev_obj_val: 72.63430786132812, obj_val: 70.89701843261719, abs dis: 1.7372894287109375
[rfa agg] iter:  3, weight: tensor([0.0795, 0.1283, 0.1079, 0.1823, 0.0845, 0.0377, 0.1218, 0.1296, 0.0500,
        0.0785])
[rfa agg] iter:  4, prev_obj_val: 70.89701843261719, obj_val: 70.89049530029297, abs dis: 0.00652313232421875
[rfa agg] iter:  4, weight: tensor([0.0701, 0.1363, 0.1165, 0.1869, 0.0774, 0.0345, 0.1333, 0.1118, 0.0506,
        0.0828])
[rfa agg] iter:  5, prev_obj_val: 70.89049530029297, obj_val: 72.6405029296875, abs dis: 1.7500076293945312
[rfa agg] iter:  5, weight: tensor([0.0696, 0.1375, 0.1168, 0.1870, 0.0768, 0.0343, 0.1342, 0.1103, 0.0505,
        0.0828])
[rfa agg] iter:  6, prev_obj_val: 72.6405029296875, obj_val: 70.8960952758789, abs dis: 1.7444076538085938
[rfa agg] iter:  6, weight: tensor([0.0789, 0.1292, 0.1081, 0.1834, 0.0838, 0.0376, 0.1225, 0.1277, 0.0501,
        0.0786])
[rfa agg] iter:  7, prev_obj_val: 70.8960952758789, obj_val: 70.89048767089844, abs dis: 0.00560760498046875
[rfa agg] iter:  7, weight: tensor([0.0701, 0.1364, 0.1165, 0.1871, 0.0773, 0.0345, 0.1333, 0.1116, 0.0506,
        0.0828])
[rfa agg] iter:  8, prev_obj_val: 70.89048767089844, obj_val: 72.64051818847656, abs dis: 1.750030517578125
[rfa agg] iter:  8, weight: tensor([0.0696, 0.1376, 0.1168, 0.1870, 0.0768, 0.0343, 0.1342, 0.1103, 0.0505,
        0.0828])
[rfa agg] iter:  9, prev_obj_val: 72.64051818847656, obj_val: 70.8960952758789, abs dis: 1.7444229125976562
[rfa agg] iter:  9, weight: tensor([0.0789, 0.1292, 0.1081, 0.1835, 0.0838, 0.0376, 0.1225, 0.1277, 0.0501,
        0.0786])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8344, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.1485, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.0347535610199 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0607, Accuracy: 280/1446 (19.3638%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 472/1446 (32.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6481, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0776, Accuracy: 133/773 (17.2057%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 403/773 (52.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.7852, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0833, Accuracy: 24/515 (4.6602%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0534, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.9336, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0599, Accuracy: 229/599 (38.2304%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 14.3265, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0676, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 226/781 (28.9373%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.8494, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0753, Accuracy: 118/818 (14.4254%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0336, Accuracy: 338/818 (41.3203%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.8815, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0923, Accuracy: 30/682 (4.3988%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0426, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.1434, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0505, Accuracy: 288/712 (40.4494%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.5100, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0643, Accuracy: 246/803 (30.6351%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0363, Accuracy: 443/803 (55.1681%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4252, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0724, Accuracy: 218/1131 (19.2750%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0358, Accuracy: 348/1131 (30.7692%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4462, Accuracy: 67/10000 (0.6700%)
time spent on training: 191.4620909690857
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 99, 33, 95, 3, 71, 80, 11, 58, 87], weight: tensor([0.1751, 0.0936, 0.0623, 0.0725, 0.0946, 0.0990, 0.0826, 0.0862, 0.0972,
        0.1369])
[rfa agg] iter:  0, prev_obj_val: 41.94762420654297, obj_val: 49.15016555786133, abs dis: 7.202541351318359
[rfa agg] iter:  0, weight: tensor([0.0542, 0.1091, 0.0450, 0.0663, 0.1314, 0.1459, 0.1013, 0.1182, 0.1557,
        0.0726])
[rfa agg] iter:  1, prev_obj_val: 49.15016555786133, obj_val: 46.5771598815918, abs dis: 2.5730056762695312
[rfa agg] iter:  1, weight: tensor([0.0523, 0.0967, 0.0697, 0.1060, 0.1090, 0.1170, 0.1427, 0.1217, 0.1210,
        0.0639])
[rfa agg] iter:  2, prev_obj_val: 46.5771598815918, obj_val: 49.09819412231445, abs dis: 2.5210342407226562
[rfa agg] iter:  2, weight: tensor([0.0506, 0.0971, 0.0620, 0.0981, 0.1124, 0.1205, 0.1438, 0.1246, 0.1280,
        0.0629])
[rfa agg] iter:  3, prev_obj_val: 49.09819412231445, obj_val: 49.09482955932617, abs dis: 0.00336456298828125
[rfa agg] iter:  3, weight: tensor([0.0517, 0.0947, 0.0703, 0.1093, 0.1071, 0.1143, 0.1487, 0.1211, 0.1194,
        0.0632])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.8571, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 3.5106, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.44563484191895 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0678, Accuracy: 180/1513 (11.8969%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 404/1513 (26.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.7675, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0512, Accuracy: 317/1129 (28.0779%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 687/1129 (60.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6399, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0731, Accuracy: 136/773 (17.5938%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0412, Accuracy: 382/773 (49.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.4887, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0764, Accuracy: 76/568 (13.3803%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0445, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6764, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0859, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0529, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9049, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0674, Accuracy: 227/946 (23.9958%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0370, Accuracy: 380/946 (40.1691%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3469, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0664, Accuracy: 240/1657 (14.4840%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0372, Accuracy: 460/1657 (27.7610%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8546, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0594, Accuracy: 276/1030 (26.7961%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0297, Accuracy: 551/1030 (53.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.1198, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0585, Accuracy: 365/1715 (21.2828%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0338, Accuracy: 618/1715 (36.0350%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.5987, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0717, Accuracy: 159/636 (25.0000%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0361, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.7099, Accuracy: 52/10000 (0.5200%)
time spent on training: 212.8219690322876
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 37, 99, 62, 49, 43, 0, 91, 92, 52], weight: tensor([0.1454, 0.1085, 0.0743, 0.0546, 0.0423, 0.0909, 0.1592, 0.0990, 0.1648,
        0.0611])
[rfa agg] iter:  0, prev_obj_val: 66.63675689697266, obj_val: 69.28170013427734, abs dis: 2.6449432373046875
[rfa agg] iter:  0, weight: tensor([0.0989, 0.1708, 0.1009, 0.0432, 0.0262, 0.1912, 0.0883, 0.1427, 0.0837,
        0.0541])
[rfa agg] iter:  1, prev_obj_val: 69.28170013427734, obj_val: 69.25447082519531, abs dis: 0.02722930908203125
[rfa agg] iter:  1, weight: tensor([0.0855, 0.1488, 0.1174, 0.0479, 0.0281, 0.2283, 0.0775, 0.1317, 0.0738,
        0.0610])
[rfa agg] iter:  2, prev_obj_val: 69.25447082519531, obj_val: 69.25328063964844, abs dis: 0.001190185546875
[rfa agg] iter:  2, weight: tensor([0.0843, 0.1453, 0.1182, 0.0474, 0.0278, 0.2392, 0.0763, 0.1283, 0.0727,
        0.0604])
[rfa agg] iter:  3, prev_obj_val: 69.25328063964844, obj_val: 69.25320434570312, abs dis: 7.62939453125e-05
[rfa agg] iter:  3, weight: tensor([0.0840, 0.1446, 0.1181, 0.0473, 0.0277, 0.2422, 0.0761, 0.1274, 0.0725,
        0.0602])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.8768, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 3.4288, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.5078229904175 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0717, Accuracy: 222/1131 (19.6286%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0362, Accuracy: 363/1131 (32.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1580, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0690, Accuracy: 111/953 (11.6474%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 296/953 (31.0598%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9110, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0678, Accuracy: 146/938 (15.5650%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0347, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.9865, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0796, Accuracy: 216/1190 (18.1513%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0369, Accuracy: 422/1190 (35.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.6661, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0668, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0382, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.4214, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0588, Accuracy: 267/1130 (23.6283%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 471/1130 (41.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7447, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0855, Accuracy: 46/682 (6.7449%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0419, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.9983, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0546, Accuracy: 288/712 (40.4494%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.8815, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0698, Accuracy: 195/807 (24.1636%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0356, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9481, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0533, Accuracy: 227/888 (25.5631%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0272, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.3290, Accuracy: 71/10000 (0.7100%)
time spent on training: 200.41440534591675
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 64, 73, 84, 3, 54, 80, 11, 20, 63], weight: tensor([0.1228, 0.1035, 0.1018, 0.1292, 0.0848, 0.1227, 0.0740, 0.0773, 0.0876,
        0.0964])
[rfa agg] iter:  0, prev_obj_val: 37.208492279052734, obj_val: 41.52510452270508, abs dis: 4.316612243652344
[rfa agg] iter:  0, weight: tensor([0.0774, 0.1176, 0.1148, 0.0645, 0.1214, 0.0771, 0.0811, 0.0971, 0.1305,
        0.1185])
[rfa agg] iter:  1, prev_obj_val: 41.52510452270508, obj_val: 39.06462478637695, abs dis: 2.460479736328125
[rfa agg] iter:  1, weight: tensor([0.0711, 0.1040, 0.1022, 0.0605, 0.1251, 0.0709, 0.1028, 0.1147, 0.1366,
        0.1120])
[rfa agg] iter:  2, prev_obj_val: 39.06462478637695, obj_val: 39.0625114440918, abs dis: 0.00211334228515625
[rfa agg] iter:  2, weight: tensor([0.0721, 0.1082, 0.1068, 0.0604, 0.1262, 0.0719, 0.0920, 0.1088, 0.1389,
        0.1148])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.8414, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 3.2581, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 295.1966395378113 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0707, Accuracy: 232/901 (25.7492%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0363, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.1745, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0729, Accuracy: 142/818 (17.3594%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0349, Accuracy: 313/818 (38.2641%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.9072, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0530, Accuracy: 314/1275 (24.6275%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 681/1275 (53.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.4211, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0590, Accuracy: 262/1130 (23.1858%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 462/1130 (40.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8124, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0833, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 198/500 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0865, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0710, Accuracy: 179/1131 (15.8267%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0331, Accuracy: 468/1131 (41.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2615, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 294/708 (41.5254%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 421/708 (59.4633%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5010, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0719, Accuracy: 224/1131 (19.8055%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0346, Accuracy: 372/1131 (32.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4792, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0563, Accuracy: 313/1030 (30.3883%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0293, Accuracy: 581/1030 (56.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0854, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0671, Accuracy: 333/1427 (23.3357%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0368, Accuracy: 535/1427 (37.4912%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2070, Accuracy: 68/10000 (0.6800%)
time spent on training: 212.01375126838684
[rfa agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 71, 9, 54, 82, 38, 16, 87, 91, 34], weight: tensor([0.0896, 0.0814, 0.1269, 0.1124, 0.0497, 0.1125, 0.0704, 0.1125, 0.1025,
        0.1420])
[rfa agg] iter:  0, prev_obj_val: 44.303001403808594, obj_val: 49.64987564086914, abs dis: 5.346874237060547
[rfa agg] iter:  0, weight: tensor([0.1315, 0.1011, 0.1048, 0.1222, 0.0281, 0.1227, 0.0666, 0.1331, 0.1106,
        0.0793])
[rfa agg] iter:  1, prev_obj_val: 49.64987564086914, obj_val: 49.617523193359375, abs dis: 0.032352447509765625
[rfa agg] iter:  1, weight: tensor([0.1418, 0.1416, 0.0911, 0.1055, 0.0367, 0.1066, 0.0890, 0.1125, 0.1027,
        0.0724])
[rfa agg] iter:  2, prev_obj_val: 49.617523193359375, obj_val: 49.617103576660156, abs dis: 0.00041961669921875
[rfa agg] iter:  2, weight: tensor([0.1408, 0.1471, 0.0903, 0.1048, 0.0366, 0.1051, 0.0905, 0.1113, 0.1016,
        0.0719])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8856, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 3.1723, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 310.8879005908966 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0613, Accuracy: 455/2227 (20.4311%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 936/2227 (42.0296%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2060, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0636, Accuracy: 294/708 (41.5254%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3328, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0913, Accuracy: 5/373 (1.3405%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0534, Accuracy: 116/373 (31.0992%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.0567, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0867, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0494, Accuracy: 218/486 (44.8560%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.3299, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0882, Accuracy: 22/440 (5.0000%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0546, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8158, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0851, Accuracy: 81/603 (13.4328%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0505, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6355, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0687, Accuracy: 264/1418 (18.6178%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 524/1418 (36.9535%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5338, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0633, Accuracy: 240/1089 (22.0386%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0310, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6595, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0652, Accuracy: 345/1742 (19.8048%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0353, Accuracy: 655/1742 (37.6005%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8732, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0621, Accuracy: 334/1587 (21.0460%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0358, Accuracy: 516/1587 (32.5142%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5587, Accuracy: 61/10000 (0.6100%)
time spent on training: 220.71855568885803
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 16, 98, 30, 49, 88, 70, 59, 93, 27], weight: tensor([0.2087, 0.0663, 0.0349, 0.0455, 0.0412, 0.0565, 0.1329, 0.1020, 0.1632,
        0.1487])
[rfa agg] iter:  0, prev_obj_val: 85.19572448730469, obj_val: 86.20730590820312, abs dis: 1.0115814208984375
[rfa agg] iter:  0, weight: tensor([0.1117, 0.0578, 0.0187, 0.0284, 0.0238, 0.0417, 0.2229, 0.1203, 0.1588,
        0.2158])
[rfa agg] iter:  1, prev_obj_val: 86.20730590820312, obj_val: 86.20442962646484, abs dis: 0.00287628173828125
[rfa agg] iter:  1, weight: tensor([0.1083, 0.0612, 0.0194, 0.0297, 0.0248, 0.0439, 0.2285, 0.1258, 0.1515,
        0.2068])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8846, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 3.2180, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 314.19900131225586 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0634, Accuracy: 285/1657 (17.1998%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0375, Accuracy: 434/1657 (26.1919%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.0046, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0525, Accuracy: 236/888 (26.5766%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 452/888 (50.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 11.2325, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1481, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1316, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8017, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0603, Accuracy: 221/776 (28.4794%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.1999, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0670, Accuracy: 222/1213 (18.3017%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0303, Accuracy: 500/1213 (41.2201%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3885, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0924, Accuracy: 7/271 (2.5830%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0610, Accuracy: 89/271 (32.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4603, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0528, Accuracy: 265/690 (38.4058%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0255, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.1959, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0828, Accuracy: 81/603 (13.4328%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0503, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5296, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 99/530 (18.6792%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.7542, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0547, Accuracy: 321/1030 (31.1650%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0261, Accuracy: 590/1030 (57.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.9158, Accuracy: 99/10000 (0.9900%)
time spent on training: 188.62395310401917
[rfa agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 63, 47, 75, 97, 35, 25, 88, 18, 91], weight: tensor([0.2127, 0.1140, 0.0172, 0.0996, 0.1557, 0.0348, 0.0886, 0.0774, 0.0680,
        0.1322])
[rfa agg] iter:  0, prev_obj_val: 58.249107360839844, obj_val: 59.600284576416016, abs dis: 1.3511772155761719
[rfa agg] iter:  0, weight: tensor([0.0865, 0.1798, 0.0071, 0.1701, 0.1370, 0.0181, 0.1148, 0.0844, 0.0602,
        0.1419])
[rfa agg] iter:  1, prev_obj_val: 59.600284576416016, obj_val: 62.34425354003906, abs dis: 2.743968963623047
[rfa agg] iter:  1, weight: tensor([0.0747, 0.1796, 0.0071, 0.1877, 0.1115, 0.0187, 0.1380, 0.0992, 0.0668,
        0.1168])
[rfa agg] iter:  2, prev_obj_val: 62.34425354003906, obj_val: 64.08236694335938, abs dis: 1.7381134033203125
[rfa agg] iter:  2, weight: tensor([0.0687, 0.1559, 0.0076, 0.1768, 0.0963, 0.0206, 0.1707, 0.1248, 0.0789,
        0.0996])
[rfa agg] iter:  3, prev_obj_val: 64.08236694335938, obj_val: 64.07073974609375, abs dis: 0.011627197265625
[rfa agg] iter:  3, weight: tensor([0.0660, 0.1409, 0.0079, 0.1610, 0.0898, 0.0217, 0.1905, 0.1431, 0.0869,
        0.0923])
[rfa agg] iter:  4, prev_obj_val: 64.07073974609375, obj_val: 64.0704574584961, abs dis: 0.00028228759765625
[rfa agg] iter:  4, weight: tensor([0.0656, 0.1392, 0.0079, 0.1580, 0.0891, 0.0217, 0.1951, 0.1448, 0.0871,
        0.0915])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 25.8686, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 13.3823, Accuracy: 20/9950 (0.2010%)
saving model
Done in 285.8892421722412 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0595, Accuracy: 203/590 (34.4068%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 12.9120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0837, Accuracy: 19/515 (3.6893%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0548, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3194, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 177/1013 (17.4729%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 357/1013 (35.2419%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.3167, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0655, Accuracy: 194/599 (32.3873%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 14.7971, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0624, Accuracy: 309/1662 (18.5921%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0361, Accuracy: 515/1662 (30.9868%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.0556, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.1044, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0576, Accuracy: 90/312 (28.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0880, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0700, Accuracy: 159/636 (25.0000%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0345, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.5087, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0696, Accuracy: 336/1988 (16.9014%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0381, Accuracy: 566/1988 (28.4708%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9518, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0783, Accuracy: 83/530 (15.6604%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.9710, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0701, Accuracy: 167/1049 (15.9199%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0333, Accuracy: 474/1049 (45.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.6304, Accuracy: 96/10000 (0.9600%)
time spent on training: 201.04992961883545
[rfa agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 33, 14, 95, 94, 24, 52, 85, 18, 51], weight: tensor([0.0663, 0.0579, 0.1139, 0.0673, 0.1869, 0.0351, 0.0715, 0.2235, 0.0596,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 81.31937408447266, obj_val: 82.62760162353516, abs dis: 1.3082275390625
[rfa agg] iter:  0, weight: tensor([0.0592, 0.0449, 0.2260, 0.0596, 0.1475, 0.0191, 0.0623, 0.1056, 0.0471,
        0.2287])
[rfa agg] iter:  1, prev_obj_val: 82.62760162353516, obj_val: 84.50391387939453, abs dis: 1.876312255859375
[rfa agg] iter:  1, weight: tensor([0.0750, 0.0534, 0.2459, 0.0748, 0.1052, 0.0210, 0.0777, 0.0814, 0.0575,
        0.2080])
[rfa agg] iter:  2, prev_obj_val: 84.50391387939453, obj_val: 85.62155151367188, abs dis: 1.1176376342773438
[rfa agg] iter:  2, weight: tensor([0.0902, 0.0617, 0.2213, 0.0896, 0.0979, 0.0234, 0.0924, 0.0781, 0.0677,
        0.1777])
[rfa agg] iter:  3, prev_obj_val: 85.62155151367188, obj_val: 86.86121368408203, abs dis: 1.2396621704101562
[rfa agg] iter:  3, weight: tensor([0.1004, 0.0668, 0.2001, 0.0992, 0.0946, 0.0248, 0.1016, 0.0764, 0.0741,
        0.1621])
[rfa agg] iter:  4, prev_obj_val: 86.86121368408203, obj_val: 86.85179901123047, abs dis: 0.0094146728515625
[rfa agg] iter:  4, weight: tensor([0.1109, 0.0716, 0.1795, 0.1087, 0.0905, 0.0259, 0.1106, 0.0739, 0.0804,
        0.1480])
[rfa agg] iter:  5, prev_obj_val: 86.85179901123047, obj_val: 88.20928955078125, abs dis: 1.3574905395507812
[rfa agg] iter:  5, weight: tensor([0.1119, 0.0719, 0.1774, 0.1095, 0.0904, 0.0260, 0.1114, 0.0739, 0.0808,
        0.1470])
[rfa agg] iter:  6, prev_obj_val: 88.20928955078125, obj_val: 88.20144653320312, abs dis: 0.007843017578125
[rfa agg] iter:  6, weight: tensor([0.1220, 0.0760, 0.1598, 0.1183, 0.0857, 0.0269, 0.1194, 0.0708, 0.0868,
        0.1342])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 19.0226, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 11.9224, Accuracy: 5/9950 (0.0503%)
saving model
Done in 296.20326805114746 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0625, Accuracy: 280/896 (31.2500%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0346, Accuracy: 460/896 (51.3393%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4344, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0614, Accuracy: 343/1904 (18.0147%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0327, Accuracy: 661/1904 (34.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5267, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0784, Accuracy: 115/809 (14.2151%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0335, Accuracy: 282/809 (34.8578%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.2011, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0746, Accuracy: 133/677 (19.6455%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 13.7203, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0781, Accuracy: 249/1003 (24.8255%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0398, Accuracy: 367/1003 (36.5902%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1544, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0985, Accuracy: 9/466 (1.9313%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0550, Accuracy: 175/466 (37.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 143/938 (15.2452%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0352, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.1205, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0605, Accuracy: 485/2227 (21.7782%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0302, Accuracy: 935/2227 (41.9847%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1346, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0994, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0661, Accuracy: 69/311 (22.1865%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8621, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 214/776 (27.5773%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.0092, Accuracy: 64/10000 (0.6400%)
time spent on training: 215.2495982646942
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 46, 50, 90, 86, 76, 73, 60, 96, 75], weight: tensor([0.0895, 0.1903, 0.0808, 0.0677, 0.1002, 0.0466, 0.0937, 0.2225, 0.0311,
        0.0775])
[rfa agg] iter:  0, prev_obj_val: 88.3241958618164, obj_val: 87.33677673339844, abs dis: 0.9874191284179688
[rfa agg] iter:  0, weight: tensor([0.1256, 0.1330, 0.0976, 0.0641, 0.1790, 0.0324, 0.1496, 0.1081, 0.0169,
        0.0937])
[rfa agg] iter:  1, prev_obj_val: 87.33677673339844, obj_val: 88.80949401855469, abs dis: 1.47271728515625
[rfa agg] iter:  1, weight: tensor([0.1606, 0.0692, 0.1222, 0.0707, 0.1821, 0.0309, 0.1730, 0.0602, 0.0148,
        0.1163])
[rfa agg] iter:  2, prev_obj_val: 88.80949401855469, obj_val: 95.59915924072266, abs dis: 6.789665222167969
[rfa agg] iter:  2, weight: tensor([0.1706, 0.0598, 0.1415, 0.0784, 0.1539, 0.0322, 0.1630, 0.0529, 0.0150,
        0.1327])
[rfa agg] iter:  3, prev_obj_val: 95.59915924072266, obj_val: 93.39177703857422, abs dis: 2.2073822021484375
[rfa agg] iter:  3, weight: tensor([0.1536, 0.0541, 0.1697, 0.1180, 0.1109, 0.0433, 0.1258, 0.0491, 0.0184,
        0.1571])
[rfa agg] iter:  4, prev_obj_val: 93.39177703857422, obj_val: 93.39010620117188, abs dis: 0.00167083740234375
[rfa agg] iter:  4, weight: tensor([0.1567, 0.0536, 0.1737, 0.1063, 0.1145, 0.0391, 0.1306, 0.0484, 0.0170,
        0.1600])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9401, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.1691, Accuracy: 30/9950 (0.3015%)
saving model
Done in 314.2156939506531 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0630, Accuracy: 226/1089 (20.7530%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0316, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.1391, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0583, Accuracy: 323/1030 (31.3592%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0292, Accuracy: 504/1030 (48.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.9431, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0737, Accuracy: 95/530 (17.9245%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0401, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.4098, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0752, Accuracy: 176/715 (24.6154%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0455, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.4317, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0878, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0560, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.6529, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0664, Accuracy: 191/599 (31.8865%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0329, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 15.0854, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0597, Accuracy: 493/2227 (22.1374%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0306, Accuracy: 914/2227 (41.0418%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2741, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 300/896 (33.4821%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0344, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5414, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0571, Accuracy: 202/813 (24.8462%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0219, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.9636, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0607, Accuracy: 182/1013 (17.9664%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 346/1013 (34.1560%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.4701, Accuracy: 69/10000 (0.6900%)
time spent on training: 209.34122896194458
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 91, 18, 23, 49, 95, 60, 89, 53, 14], weight: tensor([0.1164, 0.1101, 0.0567, 0.0765, 0.0470, 0.0641, 0.2381, 0.0958, 0.0869,
        0.1083])
[rfa agg] iter:  0, prev_obj_val: 77.90624237060547, obj_val: 79.70809936523438, abs dis: 1.8018569946289062
[rfa agg] iter:  0, weight: tensor([0.1059, 0.1574, 0.0422, 0.0800, 0.0283, 0.0540, 0.0760, 0.1371, 0.1169,
        0.2022])
[rfa agg] iter:  1, prev_obj_val: 79.70809936523438, obj_val: 84.41381072998047, abs dis: 4.705711364746094
[rfa agg] iter:  1, weight: tensor([0.0788, 0.1107, 0.0553, 0.1063, 0.0346, 0.0747, 0.0575, 0.1610, 0.1692,
        0.1519])
[rfa agg] iter:  2, prev_obj_val: 84.41381072998047, obj_val: 84.37837982177734, abs dis: 0.035430908203125
[rfa agg] iter:  2, weight: tensor([0.0707, 0.0917, 0.0731, 0.1222, 0.0438, 0.1020, 0.0549, 0.1449, 0.1781,
        0.1185])
[rfa agg] iter:  3, prev_obj_val: 84.37837982177734, obj_val: 86.50533294677734, abs dis: 2.126953125
[rfa agg] iter:  3, weight: tensor([0.0698, 0.0903, 0.0738, 0.1242, 0.0438, 0.1038, 0.0545, 0.1424, 0.1807,
        0.1167])
[rfa agg] iter:  4, prev_obj_val: 86.50533294677734, obj_val: 86.50151824951172, abs dis: 0.003814697265625
[rfa agg] iter:  4, weight: tensor([0.0689, 0.0873, 0.0827, 0.1262, 0.0485, 0.1163, 0.0547, 0.1346, 0.1704,
        0.1104])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 22.1896, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 9.1308, Accuracy: 120/9950 (1.2060%)
saving model
Done in 303.9659502506256 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0652, Accuracy: 236/803 (29.3898%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0369, Accuracy: 392/803 (48.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4609, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0851, Accuracy: 15/500 (3.0000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0502, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.0736, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.1018, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0599, Accuracy: 122/408 (29.9020%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3429, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1290, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1008, Accuracy: 14/197 (7.1066%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2496, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0613, Accuracy: 465/2227 (20.8801%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0303, Accuracy: 935/2227 (41.9847%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.2202, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0686, Accuracy: 214/807 (26.5180%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0353, Accuracy: 394/807 (48.8228%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.7195, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0616, Accuracy: 371/1904 (19.4853%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0333, Accuracy: 646/1904 (33.9286%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4771, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0833, Accuracy: 48/682 (7.0381%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0397, Accuracy: 270/682 (39.5894%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6351, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.1123, Accuracy: 2/338 (0.5917%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0599, Accuracy: 81/338 (23.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6770, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0883, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0486, Accuracy: 227/486 (46.7078%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.3185, Accuracy: 59/10000 (0.5900%)
time spent on training: 198.23525762557983
[rfa agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 82, 36, 79, 60, 20, 46, 80, 12, 30], weight: tensor([0.0961, 0.0599, 0.0489, 0.0236, 0.2666, 0.0966, 0.2280, 0.0817, 0.0405,
        0.0582])
[rfa agg] iter:  0, prev_obj_val: 106.39875793457031, obj_val: 106.79866027832031, abs dis: 0.39990234375
[rfa agg] iter:  0, weight: tensor([0.1715, 0.0588, 0.0439, 0.0162, 0.1565, 0.1657, 0.1860, 0.1112, 0.0332,
        0.0571])
[rfa agg] iter:  1, prev_obj_val: 106.79866027832031, obj_val: 109.33716583251953, abs dis: 2.5385055541992188
[rfa agg] iter:  1, weight: tensor([0.2235, 0.0609, 0.0442, 0.0153, 0.1076, 0.2055, 0.1228, 0.1287, 0.0326,
        0.0590])
[rfa agg] iter:  2, prev_obj_val: 109.33716583251953, obj_val: 113.23387145996094, abs dis: 3.8967056274414062
[rfa agg] iter:  2, weight: tensor([0.2613, 0.0639, 0.0445, 0.0138, 0.0704, 0.2162, 0.0775, 0.1588, 0.0316,
        0.0619])
[rfa agg] iter:  3, prev_obj_val: 113.23387145996094, obj_val: 113.18898010253906, abs dis: 0.044891357421875
[rfa agg] iter:  3, weight: tensor([0.2151, 0.0806, 0.0542, 0.0153, 0.0632, 0.1830, 0.0683, 0.2052, 0.0370,
        0.0781])
[rfa agg] iter:  4, prev_obj_val: 113.18898010253906, obj_val: 113.1873550415039, abs dis: 0.00162506103515625
[rfa agg] iter:  4, weight: tensor([0.2075, 0.0810, 0.0543, 0.0152, 0.0627, 0.1771, 0.0678, 0.2186, 0.0370,
        0.0787])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 14.1379, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 7.0619, Accuracy: 90/9950 (0.9045%)
saving model
Done in 293.4442720413208 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0678, Accuracy: 209/1372 (15.2332%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0349, Accuracy: 463/1372 (33.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.5390, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0704, Accuracy: 130/953 (13.6411%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0401, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8524, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0683, Accuracy: 123/735 (16.7347%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0246, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.6615, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0765, Accuracy: 176/928 (18.9655%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0289, Accuracy: 530/928 (57.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.0953, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0901, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0591, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4197, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0996, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0825, Accuracy: 12/186 (6.4516%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5857, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0694, Accuracy: 316/1750 (18.0571%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0397, Accuracy: 600/1750 (34.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.2932, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0528, Accuracy: 391/1552 (25.1933%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 722/1552 (46.5206%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.2492, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0658, Accuracy: 354/1742 (20.3215%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0352, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1305, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0990, Accuracy: 5/416 (1.2019%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0557, Accuracy: 150/416 (36.0577%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6204, Accuracy: 68/10000 (0.6800%)
time spent on training: 218.3534939289093
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 64, 32, 1, 35, 56, 44, 74, 93, 78], weight: tensor([0.1385, 0.0962, 0.0742, 0.0937, 0.0274, 0.0188, 0.1767, 0.1567, 0.1759,
        0.0420])
[rfa agg] iter:  0, prev_obj_val: 73.10631561279297, obj_val: 72.95338439941406, abs dis: 0.15293121337890625
[rfa agg] iter:  0, weight: tensor([0.1919, 0.1627, 0.0799, 0.1408, 0.0142, 0.0083, 0.1181, 0.1404, 0.1179,
        0.0258])
[rfa agg] iter:  1, prev_obj_val: 72.95338439941406, obj_val: 72.9529037475586, abs dis: 0.00048065185546875
[rfa agg] iter:  1, weight: tensor([0.1950, 0.1669, 0.0790, 0.1430, 0.0140, 0.0081, 0.1154, 0.1377, 0.1155,
        0.0254])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.0339, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.1427, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.0438029766083 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0651, Accuracy: 225/1213 (18.5491%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0319, Accuracy: 478/1213 (39.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.3578, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0520, Accuracy: 265/690 (38.4058%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0265, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.2246, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0623, Accuracy: 192/813 (23.6162%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0223, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 13.8987, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0606, Accuracy: 496/2227 (22.2721%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 913/2227 (40.9969%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.2565, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0690, Accuracy: 158/1071 (14.7526%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0328, Accuracy: 455/1071 (42.4837%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.4836, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0738, Accuracy: 278/1581 (17.5838%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0377, Accuracy: 506/1581 (32.0051%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.0687, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0575, Accuracy: 281/1129 (24.8893%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0268, Accuracy: 645/1129 (57.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.2349, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0707, Accuracy: 262/1750 (14.9714%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0396, Accuracy: 579/1750 (33.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.1014, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0736, Accuracy: 195/928 (21.0129%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0273, Accuracy: 539/928 (58.0819%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.9264, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 180/1013 (17.7690%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 360/1013 (35.5380%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.4563, Accuracy: 70/10000 (0.7000%)
time spent on training: 250.90969467163086
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 25, 53, 60, 55, 28, 37, 44, 1, 14], weight: tensor([0.0977, 0.0556, 0.0655, 0.1794, 0.0863, 0.1273, 0.0909, 0.1410, 0.0747,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 70.58245086669922, obj_val: 73.2555923461914, abs dis: 2.6731414794921875
[rfa agg] iter:  0, weight: tensor([0.1757, 0.0376, 0.0561, 0.0683, 0.1221, 0.1174, 0.1440, 0.0929, 0.0779,
        0.1079])
[rfa agg] iter:  1, prev_obj_val: 73.2555923461914, obj_val: 78.08466339111328, abs dis: 4.829071044921875
[rfa agg] iter:  1, weight: tensor([0.1585, 0.0428, 0.0680, 0.0548, 0.1417, 0.0843, 0.1511, 0.0699, 0.0928,
        0.1361])
[rfa agg] iter:  2, prev_obj_val: 78.08466339111328, obj_val: 78.05079650878906, abs dis: 0.03386688232421875
[rfa agg] iter:  2, weight: tensor([0.1260, 0.0530, 0.0886, 0.0512, 0.1428, 0.0729, 0.1331, 0.0625, 0.1114,
        0.1584])
[rfa agg] iter:  3, prev_obj_val: 78.05079650878906, obj_val: 78.0500717163086, abs dis: 0.00072479248046875
[rfa agg] iter:  3, weight: tensor([0.1225, 0.0529, 0.0890, 0.0509, 0.1433, 0.0725, 0.1298, 0.0621, 0.1131,
        0.1638])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 17.1857, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 7.2825, Accuracy: 209/9950 (2.1005%)
saving model
Done in 343.49249362945557 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0845, Accuracy: 11/500 (2.2000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.8758, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0875, Accuracy: 52/605 (8.5950%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0453, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.4299, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0816, Accuracy: 204/1190 (17.1429%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0363, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.1382, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0722, Accuracy: 99/530 (18.6792%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.8060, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0646, Accuracy: 204/599 (34.0568%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 14.6202, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0620, Accuracy: 255/891 (28.6195%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 440/891 (49.3827%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.8533, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0751, Accuracy: 178/1131 (15.7383%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0350, Accuracy: 383/1131 (33.8638%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.6990, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0980, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0529, Accuracy: 143/416 (34.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5555, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0520, Accuracy: 442/1470 (30.0680%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0266, Accuracy: 777/1470 (52.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.1687, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0654, Accuracy: 229/1154 (19.8440%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 438/1154 (37.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 11.8566, Accuracy: 72/10000 (0.7200%)
time spent on training: 203.0113492012024
[rfa agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 2, 84, 18, 95, 7, 87, 78, 22, 57], weight: tensor([0.0589, 0.0713, 0.1402, 0.0625, 0.0706, 0.1050, 0.1333, 0.0490, 0.1732,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 58.31996154785156, obj_val: 62.809181213378906, abs dis: 4.489219665527344
[rfa agg] iter:  0, weight: tensor([0.0590, 0.0954, 0.1164, 0.0710, 0.0932, 0.2077, 0.1268, 0.0406, 0.0920,
        0.0980])
[rfa agg] iter:  1, prev_obj_val: 62.809181213378906, obj_val: 64.62181091308594, abs dis: 1.8126296997070312
[rfa agg] iter:  1, weight: tensor([0.0774, 0.1249, 0.0964, 0.0931, 0.1195, 0.1718, 0.1032, 0.0503, 0.0799,
        0.0835])
[rfa agg] iter:  2, prev_obj_val: 64.62181091308594, obj_val: 66.6566162109375, abs dis: 2.0348052978515625
[rfa agg] iter:  2, weight: tensor([0.0861, 0.1368, 0.0896, 0.1033, 0.1302, 0.1498, 0.0956, 0.0544, 0.0757,
        0.0783])
[rfa agg] iter:  3, prev_obj_val: 66.6566162109375, obj_val: 66.64910888671875, abs dis: 0.00750732421875
[rfa agg] iter:  3, weight: tensor([0.0956, 0.1443, 0.0839, 0.1129, 0.1366, 0.1328, 0.0891, 0.0588, 0.0720,
        0.0740])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0726, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6434, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.1444675922394 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0968, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0793, Accuracy: 15/186 (8.0645%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1485, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0865, Accuracy: 15/373 (4.0214%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0505, Accuracy: 139/373 (37.2654%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1631, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0631, Accuracy: 212/1089 (19.4674%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/1089 (44.9954%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9568, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0593, Accuracy: 297/1036 (28.6680%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0270, Accuracy: 625/1036 (60.3282%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.2085, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0671, Accuracy: 323/1427 (22.6349%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0360, Accuracy: 563/1427 (39.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.7886, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 377/1953 (19.3036%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0357, Accuracy: 696/1953 (35.6375%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.7247, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0841, Accuracy: 62/682 (9.0909%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0417, Accuracy: 248/682 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.8034, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0688, Accuracy: 218/946 (23.0444%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0382, Accuracy: 371/946 (39.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2442, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0690, Accuracy: 244/1573 (15.5118%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0380, Accuracy: 512/1573 (32.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6176, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0605, Accuracy: 265/803 (33.0012%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0362, Accuracy: 386/803 (48.0697%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3290, Accuracy: 58/10000 (0.5800%)
time spent on training: 224.56530928611755
[rfa agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 98, 59, 19, 34, 83, 80, 43, 40, 58], weight: tensor([0.0185, 0.0370, 0.1082, 0.1029, 0.1417, 0.1940, 0.0677, 0.0940, 0.1562,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 69.93463897705078, obj_val: 70.49668884277344, abs dis: 0.5620498657226562
[rfa agg] iter:  0, weight: tensor([0.0073, 0.0188, 0.1114, 0.1973, 0.1539, 0.0924, 0.0580, 0.1412, 0.1310,
        0.0886])
[rfa agg] iter:  1, prev_obj_val: 70.49668884277344, obj_val: 72.63716888427734, abs dis: 2.1404800415039062
[rfa agg] iter:  1, weight: tensor([0.0072, 0.0188, 0.1079, 0.2193, 0.1385, 0.0850, 0.0592, 0.1530, 0.1184,
        0.0928])
[rfa agg] iter:  2, prev_obj_val: 72.63716888427734, obj_val: 73.98204803466797, abs dis: 1.344879150390625
[rfa agg] iter:  2, weight: tensor([0.0075, 0.0198, 0.1022, 0.2200, 0.1181, 0.0776, 0.0662, 0.1777, 0.1035,
        0.1074])
[rfa agg] iter:  3, prev_obj_val: 73.98204803466797, obj_val: 73.97431182861328, abs dis: 0.0077362060546875
[rfa agg] iter:  3, weight: tensor([0.0077, 0.0205, 0.0985, 0.2088, 0.1097, 0.0744, 0.0708, 0.1944, 0.0973,
        0.1179])
[rfa agg] iter:  4, prev_obj_val: 73.97431182861328, obj_val: 75.53128814697266, abs dis: 1.556976318359375
[rfa agg] iter:  4, weight: tensor([0.0076, 0.0205, 0.0978, 0.2057, 0.1092, 0.0742, 0.0708, 0.1987, 0.0969,
        0.1187])
[rfa agg] iter:  5, prev_obj_val: 75.53128814697266, obj_val: 75.52487182617188, abs dis: 0.00641632080078125
[rfa agg] iter:  5, weight: tensor([0.0079, 0.0214, 0.0951, 0.1917, 0.1030, 0.0718, 0.0765, 0.2098, 0.0923,
        0.1305])
[rfa agg] iter:  6, prev_obj_val: 75.52487182617188, obj_val: 75.52458190917969, abs dis: 0.0002899169921875
[rfa agg] iter:  6, weight: tensor([0.0079, 0.0214, 0.0945, 0.1885, 0.1026, 0.0716, 0.0765, 0.2137, 0.0919,
        0.1316])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.7744, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 7.3142, Accuracy: 32/9950 (0.3216%)
saving model
Done in 322.82203817367554 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0807, Accuracy: 208/1190 (17.4790%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0365, Accuracy: 429/1190 (36.0504%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0662, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0730, Accuracy: 261/1581 (16.5085%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0383, Accuracy: 472/1581 (29.8545%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9784, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0569, Accuracy: 201/813 (24.7232%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0217, Accuracy: 450/813 (55.3506%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 13.6387, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0752, Accuracy: 272/1163 (23.3878%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0419, Accuracy: 397/1163 (34.1359%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5680, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0691, Accuracy: 307/1988 (15.4427%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0380, Accuracy: 553/1988 (27.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.8261, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0683, Accuracy: 277/1750 (15.8286%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0395, Accuracy: 573/1750 (32.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.3487, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0512, Accuracy: 268/690 (38.8406%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0245, Accuracy: 466/690 (67.5362%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.4293, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0628, Accuracy: 346/1904 (18.1723%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0343, Accuracy: 644/1904 (33.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6723, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0686, Accuracy: 127/735 (17.2789%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0238, Accuracy: 344/735 (46.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.8516, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.1007, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0828, Accuracy: 11/186 (5.9140%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5354, Accuracy: 68/10000 (0.6800%)
time spent on training: 250.22156310081482
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 28, 53, 68, 85, 44, 25, 46, 32, 56], weight: tensor([0.0992, 0.1318, 0.0677, 0.0969, 0.1657, 0.1458, 0.0575, 0.1587, 0.0613,
        0.0155])
[rfa agg] iter:  0, prev_obj_val: 74.06085968017578, obj_val: 74.88780212402344, abs dis: 0.8269424438476562
[rfa agg] iter:  0, weight: tensor([0.1651, 0.1643, 0.0563, 0.1826, 0.0969, 0.1312, 0.0388, 0.1137, 0.0455,
        0.0057])
[rfa agg] iter:  1, prev_obj_val: 74.88780212402344, obj_val: 77.42855072021484, abs dis: 2.5407485961914062
[rfa agg] iter:  1, weight: tensor([0.1804, 0.1524, 0.0576, 0.2045, 0.0892, 0.1199, 0.0393, 0.1046, 0.0464,
        0.0057])
[rfa agg] iter:  2, prev_obj_val: 77.42855072021484, obj_val: 78.92932891845703, abs dis: 1.5007781982421875
[rfa agg] iter:  2, weight: tensor([0.1950, 0.1311, 0.0639, 0.2295, 0.0815, 0.1057, 0.0426, 0.0941, 0.0508,
        0.0059])
[rfa agg] iter:  3, prev_obj_val: 78.92932891845703, obj_val: 78.92565155029297, abs dis: 0.0036773681640625
[rfa agg] iter:  3, weight: tensor([0.1999, 0.1215, 0.0678, 0.2397, 0.0781, 0.0996, 0.0445, 0.0895, 0.0535,
        0.0060])
[rfa agg] iter:  4, prev_obj_val: 78.92565155029297, obj_val: 78.92556762695312, abs dis: 8.392333984375e-05
[rfa agg] iter:  4, weight: tensor([0.2005, 0.1205, 0.0675, 0.2422, 0.0777, 0.0990, 0.0444, 0.0890, 0.0533,
        0.0059])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1377, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.0792, Accuracy: 0/9950 (0.0000%)
saving model
Done in 345.93855571746826 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1733, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1656, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9981, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0770, Accuracy: 173/774 (22.3514%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0390, Accuracy: 318/774 (41.0853%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.0601, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0556, Accuracy: 385/1953 (19.7133%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 701/1953 (35.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5904, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0715, Accuracy: 96/530 (18.1132%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0402, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.2151, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0837, Accuracy: 36/568 (6.3380%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0451, Accuracy: 267/568 (47.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0677, Accuracy: 179/1402 (12.7675%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0430, Accuracy: 326/1402 (23.2525%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4057, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0703, Accuracy: 289/1581 (18.2796%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0378, Accuracy: 469/1581 (29.6648%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8082, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0930, Accuracy: 13/408 (3.1863%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 142/408 (34.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3315, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0709, Accuracy: 333/1988 (16.7505%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0383, Accuracy: 549/1988 (27.6157%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6452, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0983, Accuracy: 7/416 (1.6827%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0522, Accuracy: 153/416 (36.7788%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7098, Accuracy: 65/10000 (0.6500%)
time spent on training: 222.9549469947815
[rfa agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 81, 83, 18, 62, 66, 28, 36, 85, 78], weight: tensor([0.0088, 0.0798, 0.2012, 0.0546, 0.0585, 0.1445, 0.1629, 0.0420, 0.2048,
        0.0429])
[rfa agg] iter:  0, prev_obj_val: 86.52820587158203, obj_val: 85.9596939086914, abs dis: 0.568511962890625
[rfa agg] iter:  0, weight: tensor([0.0033, 0.0703, 0.1457, 0.0342, 0.0369, 0.3109, 0.2246, 0.0228, 0.1282,
        0.0231])
[rfa agg] iter:  1, prev_obj_val: 85.9596939086914, obj_val: 87.1731185913086, abs dis: 1.2134246826171875
[rfa agg] iter:  1, weight: tensor([0.0031, 0.0656, 0.1339, 0.0316, 0.0341, 0.3549, 0.2182, 0.0211, 0.1161,
        0.0214])
[rfa agg] iter:  2, prev_obj_val: 87.1731185913086, obj_val: 87.17129516601562, abs dis: 0.00182342529296875
[rfa agg] iter:  2, weight: tensor([0.0032, 0.0708, 0.1312, 0.0336, 0.0364, 0.3572, 0.2080, 0.0223, 0.1146,
        0.0227])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 13.4307, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 10.4909, Accuracy: 1/9950 (0.0101%)
saving model
Done in 316.61680340766907 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0704, Accuracy: 232/1372 (16.9096%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0358, Accuracy: 462/1372 (33.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.4260, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1490, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1363, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5326, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0609, Accuracy: 274/1446 (18.9488%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0375, Accuracy: 451/1446 (31.1895%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2831, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0694, Accuracy: 219/901 (24.3063%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0399, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.1450, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0693, Accuracy: 286/1750 (16.3429%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0399, Accuracy: 592/1750 (33.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2253, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0660, Accuracy: 175/1402 (12.4822%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0425, Accuracy: 338/1402 (24.1084%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5361, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0631, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0371, Accuracy: 541/1662 (32.5511%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7767, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0522, Accuracy: 411/1470 (27.9592%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0259, Accuracy: 782/1470 (53.1973%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.2628, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0688, Accuracy: 174/1131 (15.3846%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.6143, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0749, Accuracy: 184/1154 (15.9445%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0325, Accuracy: 443/1154 (38.3882%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.6146, Accuracy: 66/10000 (0.6600%)
time spent on training: 259.51128697395325
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 47, 26, 4, 44, 66, 94, 22, 38, 15], weight: tensor([0.1104, 0.0108, 0.1164, 0.0725, 0.1409, 0.1129, 0.1338, 0.1183, 0.0910,
        0.0929])
[rfa agg] iter:  0, prev_obj_val: 52.66321563720703, obj_val: 56.908164978027344, abs dis: 4.2449493408203125
[rfa agg] iter:  0, weight: tensor([0.1344, 0.0032, 0.1239, 0.0657, 0.0809, 0.1524, 0.0941, 0.1274, 0.1187,
        0.0992])
[rfa agg] iter:  1, prev_obj_val: 56.908164978027344, obj_val: 52.57194519042969, abs dis: 4.336219787597656
[rfa agg] iter:  1, weight: tensor([0.1273, 0.0036, 0.1157, 0.0799, 0.0781, 0.1412, 0.0896, 0.1188, 0.1388,
        0.1070])
[rfa agg] iter:  2, prev_obj_val: 52.57194519042969, obj_val: 56.90574264526367, abs dis: 4.333797454833984
[rfa agg] iter:  2, weight: tensor([0.1352, 0.0032, 0.1223, 0.0653, 0.0793, 0.1542, 0.0923, 0.1258, 0.1226,
        0.0999])
[rfa agg] iter:  3, prev_obj_val: 56.90574264526367, obj_val: 50.76817321777344, abs dis: 6.137569427490234
[rfa agg] iter:  3, weight: tensor([0.1273, 0.0036, 0.1155, 0.0798, 0.0780, 0.1412, 0.0895, 0.1186, 0.1394,
        0.1070])
[rfa agg] iter:  4, prev_obj_val: 50.76817321777344, obj_val: 52.563758850097656, abs dis: 1.7955856323242188
[rfa agg] iter:  4, weight: tensor([0.1390, 0.0030, 0.1262, 0.0590, 0.0803, 0.1612, 0.0941, 0.1301, 0.1121,
        0.0949])
[rfa agg] iter:  5, prev_obj_val: 52.563758850097656, obj_val: 56.90831756591797, abs dis: 4.3445587158203125
[rfa agg] iter:  5, weight: tensor([0.1360, 0.0032, 0.1233, 0.0649, 0.0793, 0.1556, 0.0924, 0.1271, 0.1196,
        0.0987])
[rfa agg] iter:  6, prev_obj_val: 56.90831756591797, obj_val: 50.76767349243164, abs dis: 6.140644073486328
[rfa agg] iter:  6, weight: tensor([0.1274, 0.0036, 0.1156, 0.0799, 0.0780, 0.1413, 0.0896, 0.1187, 0.1389,
        0.1069])
[rfa agg] iter:  7, prev_obj_val: 50.76767349243164, obj_val: 52.56377410888672, abs dis: 1.7961006164550781
[rfa agg] iter:  7, weight: tensor([0.1390, 0.0030, 0.1263, 0.0590, 0.0803, 0.1613, 0.0941, 0.1301, 0.1120,
        0.0949])
[rfa agg] iter:  8, prev_obj_val: 52.56377410888672, obj_val: 56.90831756591797, abs dis: 4.34454345703125
[rfa agg] iter:  8, weight: tensor([0.1360, 0.0032, 0.1233, 0.0649, 0.0793, 0.1556, 0.0924, 0.1271, 0.1196,
        0.0987])
[rfa agg] iter:  9, prev_obj_val: 56.90831756591797, obj_val: 50.76767349243164, abs dis: 6.140644073486328
[rfa agg] iter:  9, weight: tensor([0.1274, 0.0036, 0.1156, 0.0799, 0.0780, 0.1413, 0.0896, 0.1187, 0.1389,
        0.1069])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 16.9444, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 11.5069, Accuracy: 3/9950 (0.0302%)
saving model
Done in 357.6615266799927 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.1181, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0685, Accuracy: 61/312 (19.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2048, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0685, Accuracy: 248/1573 (15.7661%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0383, Accuracy: 542/1573 (34.4565%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6275, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0679, Accuracy: 178/1131 (15.7383%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0333, Accuracy: 484/1131 (42.7940%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.7577, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0687, Accuracy: 186/1013 (18.3613%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0301, Accuracy: 444/1013 (43.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.4953, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0862, Accuracy: 13/515 (2.5243%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1548, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 204/776 (26.2887%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0324, Accuracy: 377/776 (48.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.6788, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0707, Accuracy: 269/1581 (17.0145%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0374, Accuracy: 475/1581 (30.0443%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.0929, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0706, Accuracy: 291/1418 (20.5219%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0359, Accuracy: 521/1418 (36.7419%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.1429, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0614, Accuracy: 261/891 (29.2929%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 434/891 (48.7093%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.6927, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0752, Accuracy: 128/636 (20.1258%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0332, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6680, Accuracy: 52/10000 (0.5200%)
time spent on training: 226.59045267105103
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 40, 38, 39, 33, 75, 28, 70, 7, 52], weight: tensor([0.0317, 0.1598, 0.1149, 0.1029, 0.0523, 0.0788, 0.1606, 0.1440, 0.0905,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 61.06159210205078, obj_val: 61.8645133972168, abs dis: 0.8029212951660156
[rfa agg] iter:  0, weight: tensor([0.0149, 0.1010, 0.1747, 0.1919, 0.0360, 0.0968, 0.1017, 0.1086, 0.1220,
        0.0522])
[rfa agg] iter:  1, prev_obj_val: 61.8645133972168, obj_val: 64.50167083740234, abs dis: 2.637157440185547
[rfa agg] iter:  1, weight: tensor([0.0151, 0.0929, 0.1691, 0.2060, 0.0369, 0.1033, 0.0936, 0.0995, 0.1294,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 64.50167083740234, obj_val: 63.06923294067383, abs dis: 1.4324378967285156
[rfa agg] iter:  2, weight: tensor([0.0166, 0.0856, 0.1470, 0.1992, 0.0419, 0.1230, 0.0862, 0.0907, 0.1468,
        0.0631])
[rfa agg] iter:  3, prev_obj_val: 63.06923294067383, obj_val: 66.12618255615234, abs dis: 3.0569496154785156
[rfa agg] iter:  3, weight: tensor([0.0158, 0.0886, 0.1545, 0.2050, 0.0392, 0.1142, 0.0892, 0.0942, 0.1411,
        0.0583])
[rfa agg] iter:  4, prev_obj_val: 66.12618255615234, obj_val: 64.48754119873047, abs dis: 1.638641357421875
[rfa agg] iter:  4, weight: tensor([0.0175, 0.0828, 0.1367, 0.1882, 0.0450, 0.1348, 0.0834, 0.0873, 0.1553,
        0.0689])
[rfa agg] iter:  5, prev_obj_val: 64.48754119873047, obj_val: 63.071590423583984, abs dis: 1.4159507751464844
[rfa agg] iter:  5, weight: tensor([0.0166, 0.0853, 0.1440, 0.1954, 0.0420, 0.1259, 0.0858, 0.0903, 0.1514,
        0.0633])
[rfa agg] iter:  6, prev_obj_val: 63.071590423583984, obj_val: 66.12555694580078, abs dis: 3.053966522216797
[rfa agg] iter:  6, weight: tensor([0.0158, 0.0886, 0.1542, 0.2042, 0.0392, 0.1144, 0.0892, 0.0942, 0.1419,
        0.0583])
[rfa agg] iter:  7, prev_obj_val: 66.12555694580078, obj_val: 64.48757934570312, abs dis: 1.6379776000976562
[rfa agg] iter:  7, weight: tensor([0.0175, 0.0828, 0.1367, 0.1880, 0.0450, 0.1349, 0.0834, 0.0873, 0.1555,
        0.0689])
[rfa agg] iter:  8, prev_obj_val: 64.48757934570312, obj_val: 63.07160186767578, abs dis: 1.4159774780273438
[rfa agg] iter:  8, weight: tensor([0.0166, 0.0853, 0.1440, 0.1954, 0.0420, 0.1259, 0.0858, 0.0903, 0.1514,
        0.0633])
[rfa agg] iter:  9, prev_obj_val: 63.07160186767578, obj_val: 66.12554931640625, abs dis: 3.0539474487304688
[rfa agg] iter:  9, weight: tensor([0.0158, 0.0886, 0.1542, 0.2041, 0.0392, 0.1144, 0.0892, 0.0942, 0.1419,
        0.0583])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.8436, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 8.5978, Accuracy: 10/9950 (0.1005%)
saving model
Done in 324.70650124549866 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0903, Accuracy: 10/271 (3.6900%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0631, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7876, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0847, Accuracy: 13/515 (2.5243%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0556, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1999, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0699, Accuracy: 289/1418 (20.3808%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0356, Accuracy: 527/1418 (37.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.8802, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 198/861 (22.9965%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0234, Accuracy: 417/861 (48.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.0313, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0775, Accuracy: 105/818 (12.8362%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0348, Accuracy: 337/818 (41.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.2088, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0677, Accuracy: 252/896 (28.1250%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.6293, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0848, Accuracy: 30/568 (5.2817%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0451, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.2413, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0817, Accuracy: 62/605 (10.2479%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0449, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.1332, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0934, Accuracy: 14/440 (3.1818%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0590, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8208, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0807, Accuracy: 147/715 (20.5594%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0501, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3175, Accuracy: 53/10000 (0.5300%)
time spent on training: 191.58450365066528
[rfa agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 33, 70, 10, 71, 89, 62, 2, 49, 23], weight: tensor([0.0381, 0.0725, 0.1995, 0.1211, 0.1151, 0.1261, 0.0799, 0.0851, 0.0619,
        0.1006])
[rfa agg] iter:  0, prev_obj_val: 51.43780517578125, obj_val: 53.9841194152832, abs dis: 2.546314239501953
[rfa agg] iter:  0, weight: tensor([0.0240, 0.0762, 0.0710, 0.1264, 0.1549, 0.1264, 0.1169, 0.1264, 0.0557,
        0.1221])
[rfa agg] iter:  1, prev_obj_val: 53.9841194152832, obj_val: 58.069942474365234, abs dis: 4.085823059082031
[rfa agg] iter:  1, weight: tensor([0.0274, 0.0835, 0.0650, 0.1096, 0.1319, 0.1106, 0.1493, 0.1433, 0.0665,
        0.1130])
[rfa agg] iter:  2, prev_obj_val: 58.069942474365234, obj_val: 60.53864669799805, abs dis: 2.4687042236328125
[rfa agg] iter:  2, weight: tensor([0.0328, 0.0909, 0.0630, 0.0967, 0.1122, 0.0983, 0.1790, 0.1421, 0.0835,
        0.1016])
[rfa agg] iter:  3, prev_obj_val: 60.53864669799805, obj_val: 60.53327560424805, abs dis: 0.00537109375
[rfa agg] iter:  3, weight: tensor([0.0365, 0.0940, 0.0627, 0.0921, 0.1050, 0.0940, 0.1876, 0.1357, 0.0956,
        0.0967])
[rfa agg] iter:  4, prev_obj_val: 60.53327560424805, obj_val: 60.53316879272461, abs dis: 0.0001068115234375
[rfa agg] iter:  4, weight: tensor([0.0366, 0.0942, 0.0625, 0.0916, 0.1043, 0.0934, 0.1902, 0.1345, 0.0967,
        0.0960])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.9474, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 8.6177, Accuracy: 6/9950 (0.0603%)
saving model
Done in 286.4236059188843 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0738, Accuracy: 164/677 (24.2245%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0254, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.7578, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0807, Accuracy: 100/603 (16.5837%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 292/603 (48.4245%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2717, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0604, Accuracy: 208/776 (26.8041%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0317, Accuracy: 386/776 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7470, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0668, Accuracy: 272/1657 (16.4152%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0384, Accuracy: 439/1657 (26.4937%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.2870, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0656, Accuracy: 227/1154 (19.6707%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0304, Accuracy: 453/1154 (39.2548%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.4262, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0737, Accuracy: 176/719 (24.4784%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0394, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7831, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0652, Accuracy: 374/1742 (21.4696%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0355, Accuracy: 640/1742 (36.7394%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.9181, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0607, Accuracy: 282/1645 (17.1429%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0361, Accuracy: 531/1645 (32.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3313, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0722, Accuracy: 282/1581 (17.8368%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0387, Accuracy: 500/1581 (31.6256%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.1700, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0625, Accuracy: 326/1440 (22.6389%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0307, Accuracy: 636/1440 (44.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.7946, Accuracy: 80/10000 (0.8000%)
time spent on training: 258.4904148578644
[rfa agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 75, 0, 57, 41, 93, 13, 28, 29], weight: tensor([0.0564, 0.0503, 0.0647, 0.1382, 0.0962, 0.0599, 0.1452, 0.1372, 0.1318,
        0.1201])
[rfa agg] iter:  0, prev_obj_val: 65.18209075927734, obj_val: 66.55491638183594, abs dis: 1.3728256225585938
[rfa agg] iter:  0, weight: tensor([0.0412, 0.0339, 0.0587, 0.1393, 0.1212, 0.0477, 0.1124, 0.1285, 0.1478,
        0.1692])
[rfa agg] iter:  1, prev_obj_val: 66.55491638183594, obj_val: 68.10588073730469, abs dis: 1.55096435546875
[rfa agg] iter:  1, weight: tensor([0.0442, 0.0362, 0.0637, 0.1338, 0.1289, 0.0513, 0.1087, 0.1242, 0.1423,
        0.1666])
[rfa agg] iter:  2, prev_obj_val: 68.10588073730469, obj_val: 68.1038818359375, abs dis: 0.0019989013671875
[rfa agg] iter:  2, weight: tensor([0.0479, 0.0391, 0.0697, 0.1293, 0.1341, 0.0557, 0.1064, 0.1209, 0.1371,
        0.1598])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.0907, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 9.8186, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.46696376800537 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0543, Accuracy: 391/1552 (25.1933%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0232, Accuracy: 712/1552 (45.8763%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 12.8667, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0644, Accuracy: 303/1956 (15.4908%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0358, Accuracy: 593/1956 (30.3170%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1374, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0647, Accuracy: 331/1427 (23.1955%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0366, Accuracy: 513/1427 (35.9495%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6623, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0785, Accuracy: 181/928 (19.5043%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0268, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.8743, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0597, Accuracy: 316/1715 (18.4257%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0349, Accuracy: 597/1715 (34.8105%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9671, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0660, Accuracy: 166/1013 (16.3870%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0374, Accuracy: 301/1013 (29.7137%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.4145, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0844, Accuracy: 96/669 (14.3498%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0459, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3553, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0666, Accuracy: 191/1402 (13.6234%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 336/1402 (23.9658%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6066, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0596, Accuracy: 270/1130 (23.8938%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/1130 (39.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.9962, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0668, Accuracy: 214/1241 (17.2442%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0419, Accuracy: 391/1241 (31.5068%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.7051, Accuracy: 55/10000 (0.5500%)
time spent on training: 274.6727135181427
[rfa agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [74, 6, 34, 1, 92, 14, 45, 66, 54, 72], weight: tensor([0.1191, 0.1501, 0.1095, 0.0712, 0.1316, 0.0777, 0.0513, 0.1076, 0.0867,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 57.929405212402344, obj_val: 60.00071716308594, abs dis: 2.0713119506835938
[rfa agg] iter:  0, weight: tensor([0.1046, 0.0725, 0.1427, 0.0567, 0.0911, 0.0761, 0.0278, 0.1602, 0.1131,
        0.1552])
[rfa agg] iter:  1, prev_obj_val: 60.00071716308594, obj_val: 65.14047241210938, abs dis: 5.1397552490234375
[rfa agg] iter:  1, weight: tensor([0.0931, 0.0664, 0.1274, 0.0635, 0.0815, 0.0891, 0.0306, 0.1457, 0.1352,
        0.1673])
[rfa agg] iter:  2, prev_obj_val: 65.14047241210938, obj_val: 65.09584045410156, abs dis: 0.0446319580078125
[rfa agg] iter:  2, weight: tensor([0.0832, 0.0628, 0.1067, 0.0803, 0.0747, 0.1190, 0.0379, 0.1211, 0.1627,
        0.1516])
[rfa agg] iter:  3, prev_obj_val: 65.09584045410156, obj_val: 67.22002410888672, abs dis: 2.1241836547851562
[rfa agg] iter:  3, weight: tensor([0.0823, 0.0623, 0.1052, 0.0813, 0.0739, 0.1218, 0.0378, 0.1191, 0.1681,
        0.1481])
[rfa agg] iter:  4, prev_obj_val: 67.22002410888672, obj_val: 69.53849792480469, abs dis: 2.3184738159179688
[rfa agg] iter:  4, weight: tensor([0.0800, 0.0615, 0.1003, 0.0880, 0.0723, 0.1338, 0.0410, 0.1130, 0.1704,
        0.1397])
[rfa agg] iter:  5, prev_obj_val: 69.53849792480469, obj_val: 69.53336334228516, abs dis: 0.00513458251953125
[rfa agg] iter:  5, weight: tensor([0.0779, 0.0609, 0.0959, 0.0957, 0.0709, 0.1472, 0.0447, 0.1075, 0.1681,
        0.1312])
[rfa agg] iter:  6, prev_obj_val: 69.53336334228516, obj_val: 69.53327178955078, abs dis: 9.1552734375e-05
[rfa agg] iter:  6, weight: tensor([0.0777, 0.0608, 0.0955, 0.0965, 0.0708, 0.1494, 0.0447, 0.1071, 0.1675,
        0.1300])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4937, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 9.8308, Accuracy: 3/9950 (0.0302%)
saving model
Done in 369.16697216033936 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0576, Accuracy: 213/813 (26.1993%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0216, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 13.4180, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0510, Accuracy: 431/1470 (29.3197%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0257, Accuracy: 791/1470 (53.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2599, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0611, Accuracy: 325/1662 (19.5548%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0364, Accuracy: 546/1662 (32.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8627, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0663, Accuracy: 210/1213 (17.3124%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0329, Accuracy: 508/1213 (41.8796%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.0493, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0619, Accuracy: 328/1587 (20.6679%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0373, Accuracy: 544/1587 (34.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7898, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0728, Accuracy: 157/1049 (14.9666%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0351, Accuracy: 460/1049 (43.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.0186, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1380, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1224, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8809, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0837, Accuracy: 126/715 (17.6224%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0467, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2524, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0714, Accuracy: 222/901 (24.6393%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0368, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.9999, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/605 (11.9008%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0419, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.9746, Accuracy: 60/10000 (0.6000%)
time spent on training: 236.62549352645874
[rfa agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 22, 94, 97, 27, 51, 47, 23, 4, 2], weight: tensor([0.0801, 0.1448, 0.1638, 0.1195, 0.1564, 0.1034, 0.0132, 0.0705, 0.0888,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 61.62571716308594, obj_val: 63.93456268310547, abs dis: 2.3088455200195312
[rfa agg] iter:  0, weight: tensor([0.0991, 0.1222, 0.1033, 0.1667, 0.1064, 0.1574, 0.0052, 0.0650, 0.1277,
        0.0470])
[rfa agg] iter:  1, prev_obj_val: 63.93456268310547, obj_val: 65.46845245361328, abs dis: 1.5338897705078125
[rfa agg] iter:  1, weight: tensor([0.1174, 0.1074, 0.0923, 0.1536, 0.0945, 0.1618, 0.0054, 0.0719, 0.1433,
        0.0523])
[rfa agg] iter:  2, prev_obj_val: 65.46845245361328, obj_val: 65.46269226074219, abs dis: 0.00576019287109375
[rfa agg] iter:  2, weight: tensor([0.1305, 0.1017, 0.0885, 0.1429, 0.0905, 0.1568, 0.0056, 0.0768, 0.1507,
        0.0561])
[rfa agg] iter:  3, prev_obj_val: 65.46269226074219, obj_val: 65.4626235961914, abs dis: 6.866455078125e-05
[rfa agg] iter:  3, weight: tensor([0.1317, 0.1013, 0.0883, 0.1418, 0.0903, 0.1557, 0.0056, 0.0770, 0.1521,
        0.0561])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.7181, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 11.5314, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.7336733341217 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0966, Accuracy: 10/416 (2.4038%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0528, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9538, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 69/781 (8.8348%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0398, Accuracy: 213/781 (27.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.8481, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0667, Accuracy: 273/1657 (16.4756%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0382, Accuracy: 480/1657 (28.9680%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9051, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0544, Accuracy: 301/1275 (23.6078%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0215, Accuracy: 636/1275 (49.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.7219, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0651, Accuracy: 247/1573 (15.7025%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0375, Accuracy: 532/1573 (33.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5319, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0766, Accuracy: 173/928 (18.6422%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0280, Accuracy: 540/928 (58.1897%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.2678, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0631, Accuracy: 218/1154 (18.8908%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0304, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.8961, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0563, Accuracy: 203/861 (23.5772%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 427/861 (49.5935%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.7116, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0702, Accuracy: 303/1581 (19.1651%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0384, Accuracy: 525/1581 (33.2068%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8401, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0991, Accuracy: 5/466 (1.0730%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0561, Accuracy: 171/466 (36.6953%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2530, Accuracy: 57/10000 (0.5700%)
time spent on training: 245.55650782585144
[rfa agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 3, 0, 9, 40, 1, 57, 10, 28, 76], weight: tensor([0.0389, 0.0730, 0.1550, 0.1192, 0.1471, 0.0868, 0.1079, 0.0805, 0.1479,
        0.0436])
[rfa agg] iter:  0, prev_obj_val: 63.70224380493164, obj_val: 66.28240203857422, abs dis: 2.580158233642578
[rfa agg] iter:  0, weight: tensor([0.0226, 0.0858, 0.1089, 0.1867, 0.1123, 0.1101, 0.1233, 0.1070, 0.1152,
        0.0281])
[rfa agg] iter:  1, prev_obj_val: 66.28240203857422, obj_val: 66.26458740234375, abs dis: 0.01781463623046875
[rfa agg] iter:  1, weight: tensor([0.0248, 0.1017, 0.0990, 0.1680, 0.1015, 0.1236, 0.1195, 0.1270, 0.1038,
        0.0312])
[rfa agg] iter:  2, prev_obj_val: 66.26458740234375, obj_val: 66.26446533203125, abs dis: 0.0001220703125
[rfa agg] iter:  2, weight: tensor([0.0247, 0.1025, 0.0986, 0.1661, 0.1009, 0.1249, 0.1189, 0.1290, 0.1032,
        0.0312])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.3271, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 11.0056, Accuracy: 2/9950 (0.0201%)
saving model
Done in 341.41600918769836 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0974, Accuracy: 5/466 (1.0730%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0566, Accuracy: 166/466 (35.6223%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0588, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0660, Accuracy: 202/1513 (13.3510%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0411, Accuracy: 394/1513 (26.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5302, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0712, Accuracy: 199/928 (21.4440%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0273, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.4781, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0608, Accuracy: 328/1440 (22.7778%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0310, Accuracy: 635/1440 (44.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.7478, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0704, Accuracy: 192/719 (26.7038%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0350, Accuracy: 468/719 (65.0904%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0119, Accuracy: 60/10000 (0.6000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0632, Accuracy: 278/1574 (17.6620%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0320, Accuracy: 557/1574 (35.3875%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.4598, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0614, Accuracy: 468/2227 (21.0148%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0306, Accuracy: 908/2227 (40.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.3037, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0770, Accuracy: 83/605 (13.7190%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0413, Accuracy: 320/605 (52.8926%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.2578, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0657, Accuracy: 155/1013 (15.3011%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 354/1013 (34.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6467, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0596, Accuracy: 299/1628 (18.3661%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0299, Accuracy: 688/1628 (42.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.2426, Accuracy: 109/10000 (1.0900%)
time spent on training: 276.906037569046
[rfa agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.040607198877239334
[rfa agg] init. name: [76, 8, 1, 29, 41, 17, 60, 2, 14, 5], weight: tensor([0.0385, 0.1249, 0.0766, 0.1189, 0.0594, 0.1299, 0.1839, 0.0499, 0.0836,
        0.1344])
[rfa agg] iter:  0, prev_obj_val: 77.22893524169922, obj_val: 78.48210144042969, abs dis: 1.2531661987304688
[rfa agg] iter:  0, weight: tensor([0.0236, 0.1579, 0.0882, 0.1648, 0.0520, 0.1424, 0.0836, 0.0362, 0.1237,
        0.1276])
[rfa agg] iter:  1, prev_obj_val: 78.48210144042969, obj_val: 78.47784423828125, abs dis: 0.0042572021484375
[rfa agg] iter:  1, weight: tensor([0.0247, 0.1516, 0.0947, 0.1598, 0.0554, 0.1349, 0.0808, 0.0382, 0.1376,
        0.1222])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.5299, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 9.3439, Accuracy: 10/9950 (0.1005%)
saving model
Done in 368.9871759414673 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0577, Accuracy: 326/1129 (28.8751%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0272, Accuracy: 662/1129 (58.6360%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.6961, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0960, Accuracy: 10/271 (3.6900%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0643, Accuracy: 84/271 (30.9963%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.1766, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0859, Accuracy: 10/500 (2.0000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 184/500 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.9164, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0709, Accuracy: 106/938 (11.3006%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0369, Accuracy: 301/938 (32.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.7237, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0572, Accuracy: 385/1953 (19.7133%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0354, Accuracy: 731/1953 (37.4296%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.9296, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0635, Accuracy: 241/891 (27.0483%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0286, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.4313, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0609, Accuracy: 310/1446 (21.4385%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0378, Accuracy: 441/1446 (30.4979%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3385, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0628, Accuracy: 266/1573 (16.9104%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0377, Accuracy: 513/1573 (32.6128%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5878, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 227/690 (32.8986%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.2929, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0570, Accuracy: 229/813 (28.1673%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0229, Accuracy: 427/813 (52.5215%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 13.5636, Accuracy: 53/10000 (0.5300%)
time spent on training: 240.49754548072815
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 35, 82, 73, 83, 7, 26, 40, 25, 53], weight: tensor([0.1106, 0.0266, 0.0490, 0.0919, 0.1914, 0.0873, 0.1417, 0.1542, 0.0676,
        0.0797])
[rfa agg] iter:  0, prev_obj_val: 71.68208312988281, obj_val: 74.38973236083984, abs dis: 2.7076492309570312
[rfa agg] iter:  0, weight: tensor([0.1794, 0.0135, 0.0335, 0.1561, 0.0853, 0.1231, 0.1289, 0.1146, 0.0640,
        0.1016])
[rfa agg] iter:  1, prev_obj_val: 74.38973236083984, obj_val: 75.72816467285156, abs dis: 1.3384323120117188
[rfa agg] iter:  1, weight: tensor([0.1566, 0.0142, 0.0368, 0.1836, 0.0719, 0.1457, 0.1019, 0.0919, 0.0734,
        0.1241])
[rfa agg] iter:  2, prev_obj_val: 75.72816467285156, obj_val: 75.72117614746094, abs dis: 0.006988525390625
[rfa agg] iter:  2, weight: tensor([0.1413, 0.0145, 0.0384, 0.1898, 0.0684, 0.1547, 0.0945, 0.0858, 0.0777,
        0.1349])
[rfa agg] iter:  3, prev_obj_val: 75.72117614746094, obj_val: 75.72108459472656, abs dis: 9.1552734375e-05
[rfa agg] iter:  3, weight: tensor([0.1394, 0.0145, 0.0383, 0.1909, 0.0681, 0.1559, 0.0941, 0.0854, 0.0776,
        0.1358])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.5526, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 7.6492, Accuracy: 47/9950 (0.4724%)
saving model
Done in 337.1052670478821 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 200/590 (33.8983%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0357, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 13.2071, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0622, Accuracy: 199/1071 (18.5808%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0324, Accuracy: 453/1071 (42.2969%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.5808, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1630, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1493, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0391, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0765, Accuracy: 127/603 (21.0614%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0480, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3239, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0856, Accuracy: 75/818 (9.1687%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0351, Accuracy: 349/818 (42.6650%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.5416, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0765, Accuracy: 196/1154 (16.9844%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0300, Accuracy: 479/1154 (41.5078%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.7703, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.1083, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0621, Accuracy: 69/312 (22.1154%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.9682, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0713, Accuracy: 155/735 (21.0884%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0246, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.4935, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0718, Accuracy: 245/1949 (12.5705%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0365, Accuracy: 564/1949 (28.9379%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2827, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0998, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0812, Accuracy: 9/186 (4.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1915, Accuracy: 55/10000 (0.5500%)
time spent on training: 203.77025270462036
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 55, 61, 88, 71, 15, 24, 32, 21, 56], weight: tensor([0.0786, 0.1427, 0.0113, 0.0804, 0.1090, 0.1538, 0.0416, 0.0980, 0.2598,
        0.0248])
[rfa agg] iter:  0, prev_obj_val: 75.70932006835938, obj_val: 76.63558959960938, abs dis: 0.92626953125
[rfa agg] iter:  0, weight: tensor([0.0774, 0.2324, 0.0046, 0.0810, 0.1729, 0.1599, 0.0230, 0.1357, 0.1018,
        0.0112])
[rfa agg] iter:  1, prev_obj_val: 76.63558959960938, obj_val: 78.44702911376953, abs dis: 1.8114395141601562
[rfa agg] iter:  1, weight: tensor([0.0889, 0.1896, 0.0046, 0.0941, 0.2074, 0.1284, 0.0240, 0.1668, 0.0848,
        0.0114])
[rfa agg] iter:  2, prev_obj_val: 78.44702911376953, obj_val: 78.40296936035156, abs dis: 0.04405975341796875
[rfa agg] iter:  2, weight: tensor([0.1004, 0.1505, 0.0047, 0.1080, 0.2211, 0.1082, 0.0252, 0.1941, 0.0762,
        0.0117])
[rfa agg] iter:  3, prev_obj_val: 78.40296936035156, obj_val: 79.68024444580078, abs dis: 1.2772750854492188
[rfa agg] iter:  3, weight: tensor([0.1003, 0.1459, 0.0046, 0.1081, 0.2244, 0.1057, 0.0249, 0.1993, 0.0751,
        0.0115])
[rfa agg] iter:  4, prev_obj_val: 79.68024444580078, obj_val: 79.6739273071289, abs dis: 0.006317138671875
[rfa agg] iter:  4, weight: tensor([0.1076, 0.1336, 0.0047, 0.1173, 0.2183, 0.0992, 0.0259, 0.2094, 0.0722,
        0.0118])
[rfa agg] iter:  5, prev_obj_val: 79.6739273071289, obj_val: 79.67378234863281, abs dis: 0.00014495849609375
[rfa agg] iter:  5, weight: tensor([0.1081, 0.1325, 0.0047, 0.1179, 0.2164, 0.0985, 0.0258, 0.2123, 0.0719,
        0.0118])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0298, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 6.5931, Accuracy: 106/9950 (1.0653%)
saving model
Done in 300.1574866771698 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0849, Accuracy: 144/715 (20.1399%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0441, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0155, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0780, Accuracy: 40/631 (6.3391%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0457, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.9337, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0647, Accuracy: 330/1427 (23.1254%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0364, Accuracy: 543/1427 (38.0519%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4570, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0655, Accuracy: 308/1475 (20.8814%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0347, Accuracy: 580/1475 (39.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8250, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.1082, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0612, Accuracy: 60/312 (19.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8138, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0863, Accuracy: 54/682 (7.9179%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0431, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.8616, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0571, Accuracy: 318/1129 (28.1665%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0272, Accuracy: 636/1129 (56.3330%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.1019, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1595, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1558, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8930, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0574, Accuracy: 300/1030 (29.1262%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0290, Accuracy: 569/1030 (55.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.5295, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0592, Accuracy: 260/1340 (19.4030%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0299, Accuracy: 544/1340 (40.5970%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.5641, Accuracy: 85/10000 (0.8500%)
time spent on training: 226.19681477546692
[rfa agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 48, 34, 65, 24, 80, 37, 61, 91, 77], weight: tensor([0.0810, 0.0715, 0.1617, 0.1671, 0.0354, 0.0773, 0.1279, 0.0096, 0.1167,
        0.1518])
[rfa agg] iter:  0, prev_obj_val: 62.65018081665039, obj_val: 61.2180061340332, abs dis: 1.4321746826171875
[rfa agg] iter:  0, weight: tensor([0.0898, 0.0743, 0.1262, 0.1104, 0.0201, 0.0931, 0.1780, 0.0040, 0.1583,
        0.1458])
[rfa agg] iter:  1, prev_obj_val: 61.2180061340332, obj_val: 63.96253204345703, abs dis: 2.744525909423828
[rfa agg] iter:  1, weight: tensor([0.0830, 0.0669, 0.1286, 0.1098, 0.0186, 0.0833, 0.1908, 0.0038, 0.1655,
        0.1497])
[rfa agg] iter:  2, prev_obj_val: 63.96253204345703, obj_val: 62.503700256347656, abs dis: 1.458831787109375
[rfa agg] iter:  2, weight: tensor([0.0950, 0.0798, 0.1198, 0.1045, 0.0209, 0.1006, 0.1764, 0.0041, 0.1609,
        0.1378])
[rfa agg] iter:  3, prev_obj_val: 62.503700256347656, obj_val: 61.21593475341797, abs dis: 1.2877655029296875
[rfa agg] iter:  3, weight: tensor([0.0898, 0.0732, 0.1239, 0.1070, 0.0198, 0.0921, 0.1828, 0.0040, 0.1643,
        0.1431])
[rfa agg] iter:  4, prev_obj_val: 61.21593475341797, obj_val: 63.96281814575195, abs dis: 2.7468833923339844
[rfa agg] iter:  4, weight: tensor([0.0829, 0.0667, 0.1284, 0.1095, 0.0186, 0.0832, 0.1913, 0.0038, 0.1664,
        0.1492])
[rfa agg] iter:  5, prev_obj_val: 63.96281814575195, obj_val: 62.50368118286133, abs dis: 1.459136962890625
[rfa agg] iter:  5, weight: tensor([0.0950, 0.0798, 0.1198, 0.1045, 0.0209, 0.1006, 0.1765, 0.0041, 0.1610,
        0.1377])
[rfa agg] iter:  6, prev_obj_val: 62.50368118286133, obj_val: 61.2159309387207, abs dis: 1.287750244140625
[rfa agg] iter:  6, weight: tensor([0.0898, 0.0732, 0.1239, 0.1070, 0.0198, 0.0921, 0.1828, 0.0040, 0.1643,
        0.1431])
[rfa agg] iter:  7, prev_obj_val: 61.2159309387207, obj_val: 63.96281814575195, abs dis: 2.74688720703125
[rfa agg] iter:  7, weight: tensor([0.0829, 0.0667, 0.1284, 0.1095, 0.0186, 0.0832, 0.1913, 0.0038, 0.1664,
        0.1492])
[rfa agg] iter:  8, prev_obj_val: 63.96281814575195, obj_val: 62.503684997558594, abs dis: 1.4591331481933594
[rfa agg] iter:  8, weight: tensor([0.0950, 0.0798, 0.1198, 0.1045, 0.0209, 0.1006, 0.1765, 0.0041, 0.1610,
        0.1377])
[rfa agg] iter:  9, prev_obj_val: 62.503684997558594, obj_val: 61.21593475341797, abs dis: 1.287750244140625
[rfa agg] iter:  9, weight: tensor([0.0898, 0.0732, 0.1239, 0.1070, 0.0198, 0.0921, 0.1828, 0.0040, 0.1643,
        0.1431])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.1901, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.7169, Accuracy: 274/9950 (2.7538%)
saving model
Done in 321.1718120574951 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0659, Accuracy: 352/1904 (18.4874%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0343, Accuracy: 621/1904 (32.6155%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4000, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0698, Accuracy: 109/953 (11.4376%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 320/953 (33.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.8324, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0760, Accuracy: 231/1190 (19.4118%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0367, Accuracy: 420/1190 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2148, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0818, Accuracy: 148/715 (20.6993%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0489, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.3871, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0704, Accuracy: 186/1131 (16.4456%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0343, Accuracy: 435/1131 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3564, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0754, Accuracy: 204/901 (22.6415%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0370, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.0830, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0668, Accuracy: 260/1657 (15.6910%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0382, Accuracy: 449/1657 (27.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3202, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0803, Accuracy: 125/636 (19.6541%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0366, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.1658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0772, Accuracy: 253/1003 (25.2243%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0417, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4753, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0618, Accuracy: 212/1154 (18.3709%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0278, Accuracy: 455/1154 (39.4281%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.8527, Accuracy: 67/10000 (0.6700%)
time spent on training: 263.09931206703186
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 64, 84, 23, 38, 4, 0, 52, 86, 57], weight: tensor([0.1693, 0.0848, 0.1058, 0.0636, 0.1006, 0.0801, 0.1474, 0.0566, 0.0892,
        0.1026])
[rfa agg] iter:  0, prev_obj_val: 62.94827651977539, obj_val: 65.68714904785156, abs dis: 2.738872528076172
[rfa agg] iter:  0, weight: tensor([0.0749, 0.1340, 0.1373, 0.0524, 0.1453, 0.0964, 0.0913, 0.0395, 0.1224,
        0.1067])
[rfa agg] iter:  1, prev_obj_val: 65.68714904785156, obj_val: 69.00591278076172, abs dis: 3.3187637329101562
[rfa agg] iter:  1, weight: tensor([0.0644, 0.1708, 0.1173, 0.0597, 0.1312, 0.1086, 0.0760, 0.0453, 0.1341,
        0.0927])
[rfa agg] iter:  2, prev_obj_val: 69.00591278076172, obj_val: 68.99156188964844, abs dis: 0.01435089111328125
[rfa agg] iter:  2, weight: tensor([0.0610, 0.1934, 0.1039, 0.0681, 0.1165, 0.1154, 0.0706, 0.0522, 0.1335,
        0.0855])
[rfa agg] iter:  3, prev_obj_val: 68.99156188964844, obj_val: 68.99130249023438, abs dis: 0.0002593994140625
[rfa agg] iter:  3, weight: tensor([0.0606, 0.1981, 0.1024, 0.0683, 0.1148, 0.1159, 0.0701, 0.0521, 0.1330,
        0.0847])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3036, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 7.0072, Accuracy: 105/9950 (1.0553%)
saving model
Done in 359.26710319519043 sec.
Saving all the graphs.
This run has a label: Jun.19_19.02.37. Visdom environment: tiny
