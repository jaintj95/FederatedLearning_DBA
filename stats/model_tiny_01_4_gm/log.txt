current path: saved_models/model_tiny_Jun.25_15.26.56
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 738/1953 (37.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1074, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 468/1988 (23.5412%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 678/1988 (34.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7312, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.4398, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6136, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 479/1130 (42.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5107, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 468/1071 (43.6975%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6522, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 598/1587 (37.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1090, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 446/1715 (26.0058%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 713/1715 (41.5743%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5942, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0312, Accuracy: 373/1154 (32.3224%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7747, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5516, Accuracy: 50/10000 (0.5000%)
time spent on training: 125.81070303916931
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 85, 64, 95, 54, 55, 27, 92, 15, 78], weight: tensor([0.1554, 0.1582, 0.0758, 0.0477, 0.0899, 0.0852, 0.1263, 0.1365, 0.0918,
        0.0331])
[rfa agg] iter:  0, prev_obj_val: 62.158382415771484, obj_val: 65.60226440429688, abs dis: 3.4438819885253906
[rfa agg] iter: 0, weight: tensor([0.0804, 0.0744, 0.0651, 0.0224, 0.1476, 0.1076, 0.1590, 0.1167, 0.2147,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 65.60226440429688, obj_val: 70.80715942382812, abs dis: 5.20489501953125
[rfa agg] iter: 1, weight: tensor([0.0426, 0.0401, 0.0614, 0.0174, 0.2162, 0.1274, 0.0686, 0.0560, 0.3613,
        0.0091])
[rfa agg] iter:  2, prev_obj_val: 70.80715942382812, obj_val: 73.12024688720703, abs dis: 2.3130874633789062
[rfa agg] iter: 2, weight: tensor([0.0365, 0.0346, 0.0914, 0.0200, 0.2782, 0.2550, 0.0529, 0.0454, 0.1762,
        0.0099])
[rfa agg] iter:  3, prev_obj_val: 73.12024688720703, obj_val: 75.82664489746094, abs dis: 2.7063980102539062
[rfa agg] iter: 3, weight: tensor([0.0348, 0.0331, 0.1108, 0.0212, 0.2221, 0.3448, 0.0491, 0.0427, 0.1311,
        0.0103])
[rfa agg] iter:  4, prev_obj_val: 75.82664489746094, obj_val: 75.822265625, abs dis: 0.0043792724609375
[rfa agg] iter: 4, weight: tensor([0.0366, 0.0349, 0.1535, 0.0249, 0.1785, 0.3478, 0.0504, 0.0443, 0.1173,
        0.0118])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3070, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3482, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.15617537498474 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 151/953 (15.8447%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0387, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5198, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1239, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1114, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3246, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 296/946 (31.2896%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2172, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0633, Accuracy: 298/715 (41.6783%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0403, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0786, Accuracy: 18/312 (5.7692%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4591, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0838, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.5117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0637, Accuracy: 307/1190 (25.7983%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3705, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0571, Accuracy: 389/1581 (24.6047%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 590/1581 (37.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9390, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0563, Accuracy: 386/1956 (19.7342%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 668/1956 (34.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1077, Accuracy: 118/10000 (1.1800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 635/1574 (40.3431%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1793, Accuracy: 88/10000 (0.8800%)
time spent on training: 163.16023874282837
[rfa agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.05053164166837888
[rfa agg] init. name: [64, 47, 43, 23, 24, 98, 84, 28, 6, 17], weight: tensor([0.0979, 0.0138, 0.0972, 0.0735, 0.0321, 0.0383, 0.1223, 0.1624, 0.2009,
        0.1617])
[rfa agg] iter:  0, prev_obj_val: 63.802921295166016, obj_val: 64.71223449707031, abs dis: 0.9093132019042969
[rfa agg] iter: 0, weight: tensor([0.1195, 0.0038, 0.1183, 0.0491, 0.0103, 0.0134, 0.3990, 0.1084, 0.0703,
        0.1079])
[rfa agg] iter:  1, prev_obj_val: 64.71223449707031, obj_val: 67.28034973144531, abs dis: 2.568115234375
[rfa agg] iter: 1, weight: tensor([0.1332, 0.0038, 0.1313, 0.0512, 0.0104, 0.0135, 0.3971, 0.0973, 0.0654,
        0.0968])
[rfa agg] iter:  2, prev_obj_val: 67.28034973144531, obj_val: 68.56997680664062, abs dis: 1.2896270751953125
[rfa agg] iter: 2, weight: tensor([0.2035, 0.0044, 0.1991, 0.0649, 0.0119, 0.0156, 0.2546, 0.0909, 0.0646,
        0.0904])
[rfa agg] iter:  3, prev_obj_val: 68.56997680664062, obj_val: 69.94708251953125, abs dis: 1.377105712890625
[rfa agg] iter: 3, weight: tensor([0.2487, 0.0042, 0.2428, 0.0676, 0.0117, 0.0153, 0.1912, 0.0802, 0.0585,
        0.0799])
[rfa agg] iter:  4, prev_obj_val: 69.94708251953125, obj_val: 71.44405364990234, abs dis: 1.4969711303710938
[rfa agg] iter: 4, weight: tensor([0.2978, 0.0038, 0.2885, 0.0656, 0.0106, 0.0139, 0.1399, 0.0657, 0.0490,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 71.44405364990234, obj_val: 73.2870864868164, abs dis: 1.8430328369140625
[rfa agg] iter: 5, weight: tensor([0.3522, 0.0031, 0.3348, 0.0587, 0.0087, 0.0115, 0.0955, 0.0491, 0.0374,
        0.0489])
[rfa agg] iter:  6, prev_obj_val: 73.2870864868164, obj_val: 81.63931274414062, abs dis: 8.352226257324219
[rfa agg] iter: 6, weight: tensor([0.3900, 0.0026, 0.3608, 0.0551, 0.0075, 0.0099, 0.0687, 0.0380, 0.0295,
        0.0379])
[rfa agg] iter:  7, prev_obj_val: 81.63931274414062, obj_val: 75.80504608154297, abs dis: 5.834266662597656
[rfa agg] iter: 7, weight: tensor([0.2614, 0.0054, 0.2566, 0.1773, 0.0159, 0.0215, 0.0926, 0.0602, 0.0491,
        0.0599])
[rfa agg] iter:  8, prev_obj_val: 75.80504608154297, obj_val: 75.77467346191406, abs dis: 0.03037261962890625
[rfa agg] iter: 8, weight: tensor([0.3480, 0.0034, 0.3402, 0.0823, 0.0098, 0.0131, 0.0769, 0.0453, 0.0358,
        0.0451])
[rfa agg] iter:  9, prev_obj_val: 75.77467346191406, obj_val: 75.77450561523438, abs dis: 0.0001678466796875
[rfa agg] iter: 9, weight: tensor([0.3562, 0.0033, 0.3449, 0.0782, 0.0094, 0.0126, 0.0740, 0.0436, 0.0344,
        0.0434])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3079, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.2940, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.1471297740936 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0623, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 396/776 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2178, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 372/803 (46.3263%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.2636, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0518, Accuracy: 358/891 (40.1796%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0250, Accuracy: 461/891 (51.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5168, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.3599, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 353/1662 (21.2395%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 598/1662 (35.9807%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7587, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0335, Accuracy: 608/1645 (36.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9954, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 134/781 (17.1575%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0371, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2015, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0593, Accuracy: 255/590 (43.2203%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0333, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0565, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8520, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0558, Accuracy: 219/861 (25.4355%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.8147, Accuracy: 51/10000 (0.5100%)
time spent on training: 140.28551387786865
[rfa agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 58, 7, 84, 94, 13, 3, 69, 93, 10], weight: tensor([0.0709, 0.0734, 0.0814, 0.1088, 0.1519, 0.1504, 0.0714, 0.0539, 0.1592,
        0.0787])
[rfa agg] iter:  0, prev_obj_val: 58.24983215332031, obj_val: 60.19190216064453, abs dis: 1.9420700073242188
[rfa agg] iter: 0, weight: tensor([0.0835, 0.0870, 0.1263, 0.2296, 0.0809, 0.0799, 0.0844, 0.0369, 0.0696,
        0.1218])
[rfa agg] iter:  1, prev_obj_val: 60.19190216064453, obj_val: 70.63628387451172, abs dis: 10.444381713867188
[rfa agg] iter: 1, weight: tensor([0.1037, 0.1093, 0.1883, 0.1167, 0.0559, 0.0553, 0.1060, 0.0377, 0.0493,
        0.1777])
[rfa agg] iter:  2, prev_obj_val: 70.63628387451172, obj_val: 70.56523132324219, abs dis: 0.07105255126953125
[rfa agg] iter: 2, weight: tensor([0.1794, 0.2126, 0.1228, 0.0412, 0.0280, 0.0276, 0.1952, 0.0515, 0.0255,
        0.1163])
[rfa agg] iter:  3, prev_obj_val: 70.56523132324219, obj_val: 74.22672271728516, abs dis: 3.6614913940429688
[rfa agg] iter: 3, weight: tensor([0.1895, 0.2214, 0.1155, 0.0392, 0.0267, 0.0264, 0.1982, 0.0493, 0.0244,
        0.1092])
[rfa agg] iter:  4, prev_obj_val: 74.22672271728516, obj_val: 74.22464752197266, abs dis: 0.0020751953125
[rfa agg] iter: 4, weight: tensor([0.1764, 0.1932, 0.1170, 0.0471, 0.0333, 0.0329, 0.1802, 0.0778, 0.0305,
        0.1115])
[rfa agg] iter:  5, prev_obj_val: 74.22464752197266, obj_val: 78.054443359375, abs dis: 3.8297958374023438
[rfa agg] iter: 5, weight: tensor([0.1760, 0.1921, 0.1175, 0.0473, 0.0333, 0.0330, 0.1799, 0.0783, 0.0306,
        0.1120])
[rfa agg] iter:  6, prev_obj_val: 78.054443359375, obj_val: 64.89094543457031, abs dis: 13.163497924804688
[rfa agg] iter: 6, weight: tensor([0.1578, 0.1680, 0.1160, 0.0533, 0.0388, 0.0384, 0.1602, 0.1207, 0.0358,
        0.1111])
[rfa agg] iter:  7, prev_obj_val: 64.89094543457031, obj_val: 70.57829284667969, abs dis: 5.687347412109375
[rfa agg] iter: 7, weight: tensor([0.1596, 0.1835, 0.1838, 0.0393, 0.0246, 0.0243, 0.1661, 0.0307, 0.0222,
        0.1657])
[rfa agg] iter:  8, prev_obj_val: 70.57829284667969, obj_val: 74.22635650634766, abs dis: 3.6480636596679688
[rfa agg] iter: 8, weight: tensor([0.1864, 0.2192, 0.1185, 0.0397, 0.0270, 0.0267, 0.1959, 0.0499, 0.0247,
        0.1119])
[rfa agg] iter:  9, prev_obj_val: 74.22635650634766, obj_val: 74.22463989257812, abs dis: 0.00171661376953125
[rfa agg] iter: 9, weight: tensor([0.1762, 0.1931, 0.1171, 0.0472, 0.0333, 0.0329, 0.1801, 0.0779, 0.0305,
        0.1116])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3290, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3394, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.81961464881897 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0594, Accuracy: 325/807 (40.2726%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0333, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0906, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0604, Accuracy: 191/953 (20.0420%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0372, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8537, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 34/460 (7.3913%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0362, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5184, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 259/776 (33.3763%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0301, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.1029, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0571, Accuracy: 381/1956 (19.4785%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0330, Accuracy: 613/1956 (31.3395%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.3363, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0678, Accuracy: 268/715 (37.4825%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2734, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0567, Accuracy: 339/1573 (21.5512%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 579/1573 (36.8086%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5912, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0619, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 456/1049 (43.4700%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7216, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0889, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0483, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7136, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 243/888 (27.3649%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 433/888 (48.7613%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.6185, Accuracy: 56/10000 (0.5600%)
time spent on training: 134.25863122940063
[rfa agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 64, 31, 75, 6, 23, 40, 51, 12, 63], weight: tensor([0.0848, 0.1002, 0.0483, 0.0816, 0.2056, 0.0751, 0.1653, 0.1102, 0.0355,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 59.7652473449707, obj_val: 60.308258056640625, abs dis: 0.5430107116699219
[rfa agg] iter: 0, weight: tensor([0.0794, 0.1913, 0.0191, 0.0772, 0.0479, 0.0554, 0.0654, 0.3341, 0.0114,
        0.1188])
[rfa agg] iter:  1, prev_obj_val: 60.308258056640625, obj_val: 67.1476058959961, abs dis: 6.839347839355469
[rfa agg] iter: 1, weight: tensor([0.1211, 0.2454, 0.0186, 0.1228, 0.0314, 0.0710, 0.0396, 0.1069, 0.0105,
        0.2328])
[rfa agg] iter:  2, prev_obj_val: 67.1476058959961, obj_val: 70.06263732910156, abs dis: 2.9150314331054688
[rfa agg] iter: 2, weight: tensor([0.2057, 0.0940, 0.0260, 0.2334, 0.0273, 0.1722, 0.0325, 0.0590, 0.0132,
        0.1366])
[rfa agg] iter:  3, prev_obj_val: 70.06263732910156, obj_val: 76.89798736572266, abs dis: 6.835350036621094
[rfa agg] iter: 3, weight: tensor([0.1835, 0.0881, 0.0327, 0.1919, 0.0299, 0.2441, 0.0351, 0.0598, 0.0161,
        0.1189])
[rfa agg] iter:  4, prev_obj_val: 76.89798736572266, obj_val: 73.37539672851562, abs dis: 3.5225906372070312
[rfa agg] iter: 4, weight: tensor([0.1541, 0.0958, 0.0610, 0.1524, 0.0404, 0.2339, 0.0463, 0.0713, 0.0272,
        0.1176])
[rfa agg] iter:  5, prev_obj_val: 73.37539672851562, obj_val: 70.04898834228516, abs dis: 3.3264083862304688
[rfa agg] iter: 5, weight: tensor([0.1610, 0.0903, 0.0440, 0.1621, 0.0344, 0.2677, 0.0399, 0.0645, 0.0207,
        0.1154])
[rfa agg] iter:  6, prev_obj_val: 70.04898834228516, obj_val: 76.89842224121094, abs dis: 6.849433898925781
[rfa agg] iter: 6, weight: tensor([0.1742, 0.0858, 0.0319, 0.1818, 0.0291, 0.2735, 0.0342, 0.0583, 0.0157,
        0.1155])
[rfa agg] iter:  7, prev_obj_val: 76.89842224121094, obj_val: 76.89543914794922, abs dis: 0.00298309326171875
[rfa agg] iter: 7, weight: tensor([0.1533, 0.0955, 0.0608, 0.1516, 0.0403, 0.2368, 0.0462, 0.0711, 0.0272,
        0.1172])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3709, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3979, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.5941083431244 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1192, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3786, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0805, Accuracy: 21/311 (6.7524%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0553, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0564, Accuracy: 325/1130 (28.7611%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 462/1130 (40.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2700, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 276/928 (29.7414%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 569/928 (61.3147%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9233, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0610, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 521/1049 (49.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8358, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0579, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 402/807 (49.8141%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0583, Accuracy: 420/1904 (22.0588%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 655/1904 (34.4013%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8179, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0554, Accuracy: 390/1715 (22.7405%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 684/1715 (39.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9703, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0594, Accuracy: 280/677 (41.3589%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1791, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0736, Accuracy: 90/500 (18.0000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.0162, Accuracy: 51/10000 (0.5100%)
time spent on training: 133.5387680530548
[rfa agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 96, 54, 1, 51, 20, 46, 92, 90, 82], weight: tensor([0.0093, 0.0342, 0.1241, 0.1019, 0.1152, 0.0886, 0.2091, 0.1883, 0.0743,
        0.0549])
[rfa agg] iter:  0, prev_obj_val: 62.39665603637695, obj_val: 64.45024871826172, abs dis: 2.0535926818847656
[rfa agg] iter: 0, weight: tensor([0.0019, 0.0085, 0.3406, 0.1194, 0.3001, 0.0611, 0.0525, 0.0621, 0.0358,
        0.0181])
[rfa agg] iter:  1, prev_obj_val: 64.45024871826172, obj_val: 67.12577819824219, abs dis: 2.6755294799804688
[rfa agg] iter: 1, weight: tensor([0.0022, 0.0102, 0.1903, 0.2419, 0.2841, 0.0944, 0.0493, 0.0565, 0.0485,
        0.0226])
[rfa agg] iter:  2, prev_obj_val: 67.12577819824219, obj_val: 70.89196014404297, abs dis: 3.7661819458007812
[rfa agg] iter: 2, weight: tensor([0.0022, 0.0106, 0.1238, 0.3918, 0.1669, 0.1300, 0.0438, 0.0492, 0.0572,
        0.0245])
[rfa agg] iter:  3, prev_obj_val: 70.89196014404297, obj_val: 75.35662841796875, abs dis: 4.464668273925781
[rfa agg] iter: 3, weight: tensor([0.0026, 0.0130, 0.1044, 0.2986, 0.1271, 0.2443, 0.0454, 0.0502, 0.0828,
        0.0315])
[rfa agg] iter:  4, prev_obj_val: 75.35662841796875, obj_val: 75.27162170410156, abs dis: 0.0850067138671875
[rfa agg] iter: 4, weight: tensor([0.0026, 0.0134, 0.0778, 0.1531, 0.0895, 0.4365, 0.0393, 0.0429, 0.1103,
        0.0346])
[rfa agg] iter:  5, prev_obj_val: 75.27162170410156, obj_val: 77.94917297363281, abs dis: 2.67755126953125
[rfa agg] iter: 5, weight: tensor([0.0022, 0.0114, 0.0662, 0.1267, 0.0761, 0.5227, 0.0335, 0.0366, 0.0951,
        0.0295])
[rfa agg] iter:  6, prev_obj_val: 77.94917297363281, obj_val: 77.94210815429688, abs dis: 0.0070648193359375
[rfa agg] iter: 6, weight: tensor([0.0027, 0.0143, 0.0711, 0.1226, 0.0801, 0.4490, 0.0383, 0.0416, 0.1418,
        0.0384])
[rfa agg] iter:  7, prev_obj_val: 77.94210815429688, obj_val: 77.9418716430664, abs dis: 0.00023651123046875
[rfa agg] iter: 7, weight: tensor([0.0028, 0.0147, 0.0727, 0.1254, 0.0819, 0.4345, 0.0392, 0.0425, 0.1470,
        0.0393])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4673, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.8645, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.6157410144806 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0616, Accuracy: 278/719 (38.6648%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0333, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2443, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0647, Accuracy: 278/1190 (23.3613%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 421/1190 (35.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7946, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0568, Accuracy: 406/1742 (23.3065%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 670/1742 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3327, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 345/1662 (20.7581%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 610/1662 (36.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1342, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0569, Accuracy: 272/1071 (25.3968%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 497/1071 (46.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3244, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0550, Accuracy: 459/1988 (23.0885%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 648/1988 (32.5956%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0480, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0585, Accuracy: 258/636 (40.5660%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0323, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6936, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0581, Accuracy: 191/735 (25.9864%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0217, Accuracy: 361/735 (49.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.4919, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 288/946 (30.4440%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.7087, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 285/599 (47.5793%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.2595, Accuracy: 50/10000 (0.5000%)
time spent on training: 142.51063299179077
[rfa agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 84, 93, 94, 55, 85, 52, 32, 43, 95], weight: tensor([0.0637, 0.1054, 0.1543, 0.1472, 0.0949, 0.1761, 0.0563, 0.0651, 0.0838,
        0.0531])
[rfa agg] iter:  0, prev_obj_val: 65.31260681152344, obj_val: 68.37759399414062, abs dis: 3.0649871826171875
[rfa agg] iter: 0, weight: tensor([0.0385, 0.3780, 0.0822, 0.1021, 0.1605, 0.0640, 0.0269, 0.0393, 0.0832,
        0.0254])
[rfa agg] iter:  1, prev_obj_val: 68.37759399414062, obj_val: 71.04409790039062, abs dis: 2.66650390625
[rfa agg] iter: 1, weight: tensor([0.0475, 0.1859, 0.0530, 0.0618, 0.3591, 0.0445, 0.0303, 0.0486, 0.1409,
        0.0286])
[rfa agg] iter:  2, prev_obj_val: 71.04409790039062, obj_val: 78.76416778564453, abs dis: 7.720069885253906
[rfa agg] iter: 2, weight: tensor([0.0600, 0.1285, 0.0497, 0.0569, 0.2975, 0.0426, 0.0360, 0.0618, 0.2330,
        0.0340])
[rfa agg] iter:  3, prev_obj_val: 78.76416778564453, obj_val: 78.71551513671875, abs dis: 0.04865264892578125
[rfa agg] iter: 3, weight: tensor([0.1226, 0.0882, 0.0471, 0.0524, 0.1311, 0.0419, 0.0585, 0.1285, 0.2741,
        0.0556])
[rfa agg] iter:  4, prev_obj_val: 78.71551513671875, obj_val: 78.7153549194336, abs dis: 0.00016021728515625
[rfa agg] iter: 4, weight: tensor([0.1228, 0.0866, 0.0463, 0.0516, 0.1268, 0.0412, 0.0577, 0.1279, 0.2841,
        0.0550])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5936, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.4423, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.95338702201843 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 310/1130 (27.4336%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 473/1130 (41.8584%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2559, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0511, Accuracy: 574/2227 (25.7746%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1038/2227 (46.6098%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1904, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0562, Accuracy: 178/735 (24.2177%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 354/735 (48.1633%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.6030, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0629, Accuracy: 275/715 (38.4615%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0419, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.0923, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 245/590 (41.5254%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.9819, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0576, Accuracy: 249/636 (39.1509%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7146, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0994, Accuracy: 8/197 (4.0609%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0826, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5168, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0554, Accuracy: 416/1953 (21.3006%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 769/1953 (39.3753%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8875, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0515, Accuracy: 335/1275 (26.2745%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 656/1275 (51.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.7084, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0614, Accuracy: 263/677 (38.8479%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 435/677 (64.2541%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3317, Accuracy: 59/10000 (0.5900%)
time spent on training: 138.0414125919342
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 60, 32, 23, 69, 52, 79, 83, 9, 90], weight: tensor([0.1115, 0.2197, 0.0725, 0.0705, 0.0582, 0.0628, 0.0194, 0.1927, 0.1258,
        0.0668])
[rfa agg] iter:  0, prev_obj_val: 81.51081848144531, obj_val: 84.7484130859375, abs dis: 3.2375946044921875
[rfa agg] iter: 0, weight: tensor([0.2128, 0.0622, 0.0383, 0.0373, 0.0247, 0.0266, 0.0051, 0.0742, 0.4871,
        0.0315])
[rfa agg] iter:  1, prev_obj_val: 84.7484130859375, obj_val: 87.15843200683594, abs dis: 2.4100189208984375
[rfa agg] iter: 1, weight: tensor([0.3879, 0.0599, 0.0698, 0.0679, 0.0405, 0.0436, 0.0073, 0.0674, 0.2016,
        0.0542])
[rfa agg] iter:  2, prev_obj_val: 87.15843200683594, obj_val: 88.46978759765625, abs dis: 1.3113555908203125
[rfa agg] iter: 2, weight: tensor([0.2984, 0.0651, 0.0998, 0.0966, 0.0542, 0.0583, 0.0090, 0.0722, 0.1719,
        0.0745])
[rfa agg] iter:  3, prev_obj_val: 88.46978759765625, obj_val: 91.15660095214844, abs dis: 2.6868133544921875
[rfa agg] iter: 3, weight: tensor([0.2497, 0.0656, 0.1175, 0.1137, 0.0611, 0.0658, 0.0097, 0.0723, 0.1590,
        0.0855])
[rfa agg] iter:  4, prev_obj_val: 91.15660095214844, obj_val: 91.1488037109375, abs dis: 0.0077972412109375
[rfa agg] iter: 4, weight: tensor([0.1758, 0.0605, 0.1555, 0.1499, 0.0720, 0.0774, 0.0103, 0.0658, 0.1271,
        0.1057])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6938, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 4.8692, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.8753523826599 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0599, Accuracy: 200/953 (20.9864%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 279/953 (29.2760%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.7914, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0645, Accuracy: 270/715 (37.7622%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0756, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0848, Accuracy: 12/338 (3.5503%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0602, Accuracy: 357/1657 (21.5450%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0358, Accuracy: 493/1657 (29.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0756, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 317/803 (39.4770%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0331, Accuracy: 424/803 (52.8020%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4880, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0597, Accuracy: 342/1581 (21.6319%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 558/1581 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.1153, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0768, Accuracy: 133/669 (19.8804%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0410, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2779, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 261/708 (36.8644%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0425, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.2763, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 285/712 (40.0281%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6078, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0706, Accuracy: 127/568 (22.3592%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0421, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5434, Accuracy: 54/10000 (0.5400%)
time spent on training: 132.6092610359192
[rfa agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 23, 12, 0, 58, 28, 45, 16, 11, 62], weight: tensor([0.1095, 0.0821, 0.0388, 0.1904, 0.0923, 0.1816, 0.0769, 0.0813, 0.0818,
        0.0653])
[rfa agg] iter:  0, prev_obj_val: 53.644691467285156, obj_val: 58.053646087646484, abs dis: 4.408954620361328
[rfa agg] iter: 0, weight: tensor([0.2408, 0.1081, 0.0142, 0.0467, 0.2091, 0.0485, 0.0724, 0.1106, 0.1115,
        0.0381])
[rfa agg] iter:  1, prev_obj_val: 58.053646087646484, obj_val: 67.1261978149414, abs dis: 9.072551727294922
[rfa agg] iter: 1, weight: tensor([0.0648, 0.1645, 0.0146, 0.0277, 0.1183, 0.0283, 0.1618, 0.1901, 0.1772,
        0.0527])
[rfa agg] iter:  2, prev_obj_val: 67.1261978149414, obj_val: 74.24060821533203, abs dis: 7.114410400390625
[rfa agg] iter: 2, weight: tensor([0.0691, 0.1214, 0.0298, 0.0381, 0.0955, 0.0387, 0.1957, 0.1236, 0.1224,
        0.1658])
[rfa agg] iter:  3, prev_obj_val: 74.24060821533203, obj_val: 67.13143920898438, abs dis: 7.109169006347656
[rfa agg] iter: 3, weight: tensor([0.0626, 0.0912, 0.0418, 0.0388, 0.0785, 0.0392, 0.1254, 0.0915, 0.0913,
        0.3396])
[rfa agg] iter:  4, prev_obj_val: 67.13143920898438, obj_val: 70.58463287353516, abs dis: 3.4531936645507812
[rfa agg] iter: 4, weight: tensor([0.0683, 0.1184, 0.0297, 0.0376, 0.0940, 0.0382, 0.1901, 0.1205, 0.1191,
        0.1840])
[rfa agg] iter:  5, prev_obj_val: 70.58463287353516, obj_val: 70.57598114013672, abs dis: 0.0086517333984375
[rfa agg] iter: 5, weight: tensor([0.0659, 0.1041, 0.0353, 0.0386, 0.0863, 0.0392, 0.1547, 0.1049, 0.1044,
        0.2667])
[rfa agg] iter:  6, prev_obj_val: 70.57598114013672, obj_val: 70.57576751708984, abs dis: 0.000213623046875
[rfa agg] iter: 6, weight: tensor([0.0648, 0.1021, 0.0348, 0.0380, 0.0847, 0.0385, 0.1505, 0.1029, 0.1024,
        0.2813])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9933, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3146, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.19365429878235 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 379/1129 (33.5695%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 739/1129 (65.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5100, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0676, Accuracy: 254/1190 (21.3445%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 439/1190 (36.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0872, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0509, Accuracy: 618/2227 (27.7503%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 992/2227 (44.5442%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.5986, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0833, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0447, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4195, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 386/1131 (34.1291%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1426, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0499, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3834, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0635, Accuracy: 189/1049 (18.0172%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 526/1049 (50.1430%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9384, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0872, Accuracy: 21/466 (4.5064%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.7027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0931, Accuracy: 22/408 (5.3922%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0582, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4564, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0533, Accuracy: 443/1715 (25.8309%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 701/1715 (40.8746%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0193, Accuracy: 87/10000 (0.8700%)
time spent on training: 137.91898703575134
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 84, 60, 12, 87, 98, 51, 76, 36, 92], weight: tensor([0.1126, 0.1187, 0.2221, 0.0337, 0.1128, 0.0372, 0.1046, 0.0465, 0.0407,
        0.1711])
[rfa agg] iter:  0, prev_obj_val: 68.51405334472656, obj_val: 70.29197692871094, abs dis: 1.777923583984375
[rfa agg] iter: 0, weight: tensor([0.2027, 0.2757, 0.0500, 0.0087, 0.2155, 0.0096, 0.1335, 0.0141, 0.0113,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 70.29197692871094, obj_val: 72.20596313476562, abs dis: 1.9139862060546875
[rfa agg] iter: 1, weight: tensor([0.2394, 0.1638, 0.0323, 0.0074, 0.2704, 0.0082, 0.2107, 0.0124, 0.0098,
        0.0456])
[rfa agg] iter:  2, prev_obj_val: 72.20596313476562, obj_val: 74.58792877197266, abs dis: 2.3819656372070312
[rfa agg] iter: 2, weight: tensor([0.2192, 0.1416, 0.0346, 0.0085, 0.2375, 0.0094, 0.2758, 0.0144, 0.0113,
        0.0477])
[rfa agg] iter:  3, prev_obj_val: 74.58792877197266, obj_val: 74.58071899414062, abs dis: 0.00720977783203125
[rfa agg] iter: 3, weight: tensor([0.1985, 0.1372, 0.0390, 0.0103, 0.2079, 0.0114, 0.3117, 0.0176, 0.0138,
        0.0526])
[rfa agg] iter:  4, prev_obj_val: 74.58071899414062, obj_val: 74.58025360107422, abs dis: 0.00046539306640625
[rfa agg] iter: 4, weight: tensor([0.1944, 0.1354, 0.0385, 0.0102, 0.2034, 0.0113, 0.3237, 0.0174, 0.0136,
        0.0521])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3156, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.9797, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.38934421539307 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0658, Accuracy: 128/818 (15.6479%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 357/818 (43.6430%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6500, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0604, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 326/1013 (32.1816%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4235, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0604, Accuracy: 241/1071 (22.5023%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0283, Accuracy: 517/1071 (48.2726%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.0284, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0633, Accuracy: 287/946 (30.3383%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 348/946 (36.7865%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7810, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0786, Accuracy: 103/603 (17.0813%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0482, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.8524, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0771, Accuracy: 59/486 (12.1399%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0390, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4219, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0753, Accuracy: 7/186 (3.7634%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0599, Accuracy: 86/186 (46.2366%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0879, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0603, Accuracy: 129/311 (41.4791%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0813, Accuracy: 15/373 (4.0214%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 148/373 (39.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5728, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0536, Accuracy: 353/1628 (21.6830%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 824/1628 (50.6143%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.1830, Accuracy: 134/10000 (1.3400%)
time spent on training: 125.53891491889954
[rfa agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 14, 55, 43, 88, 30, 56, 96, 98, 5], weight: tensor([0.1100, 0.1362, 0.1440, 0.1272, 0.0811, 0.0654, 0.0250, 0.0418, 0.0502,
        0.2190])
[rfa agg] iter:  0, prev_obj_val: 52.180809020996094, obj_val: 55.60919189453125, abs dis: 3.4283828735351562
[rfa agg] iter: 0, weight: tensor([0.3554, 0.1366, 0.1102, 0.1759, 0.0824, 0.0405, 0.0076, 0.0161, 0.0222,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 55.60919189453125, obj_val: 59.75294494628906, abs dis: 4.1437530517578125
[rfa agg] iter: 1, weight: tensor([0.3271, 0.1187, 0.1014, 0.1446, 0.1358, 0.0567, 0.0095, 0.0208, 0.0293,
        0.0560])
[rfa agg] iter:  2, prev_obj_val: 59.75294494628906, obj_val: 59.719947814941406, abs dis: 0.03299713134765625
[rfa agg] iter: 2, weight: tensor([0.2053, 0.1053, 0.0933, 0.1215, 0.2597, 0.0813, 0.0117, 0.0264, 0.0382,
        0.0574])
[rfa agg] iter:  3, prev_obj_val: 59.719947814941406, obj_val: 59.719810485839844, abs dis: 0.0001373291015625
[rfa agg] iter: 3, weight: tensor([0.1990, 0.1040, 0.0921, 0.1197, 0.2718, 0.0811, 0.0116, 0.0262, 0.0379,
        0.0567])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3090, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 7.5584, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.2933566570282 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0842, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0438, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7261, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0876, Accuracy: 20/416 (4.8077%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0475, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7946, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0472, Accuracy: 426/1440 (29.5833%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4651, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0519, Accuracy: 393/1628 (24.1400%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0249, Accuracy: 843/1628 (51.7813%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.5334, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0534, Accuracy: 435/1715 (25.3644%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 716/1715 (41.7493%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0809, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 281/712 (39.4663%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 392/712 (55.0562%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8602, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0596, Accuracy: 290/1131 (25.6410%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0327, Accuracy: 383/1131 (33.8638%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.2323, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0616, Accuracy: 172/861 (19.9768%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0225, Accuracy: 410/861 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.1165, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0565, Accuracy: 290/1446 (20.0553%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0355, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6276, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0595, Accuracy: 314/1645 (19.0881%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3827, Accuracy: 115/10000 (1.1500%)
time spent on training: 141.85024046897888
[rfa agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 78, 29, 5, 92, 11, 87, 10, 26, 13], weight: tensor([0.0276, 0.0368, 0.1274, 0.1440, 0.1517, 0.0630, 0.1000, 0.0762, 0.1279,
        0.1455])
[rfa agg] iter:  0, prev_obj_val: 55.465919494628906, obj_val: 61.5493049621582, abs dis: 6.083385467529297
[rfa agg] iter: 0, weight: tensor([0.0091, 0.0143, 0.1423, 0.0944, 0.0874, 0.0415, 0.3027, 0.0696, 0.1430,
        0.0956])
[rfa agg] iter:  1, prev_obj_val: 61.5493049621582, obj_val: 61.50615692138672, abs dis: 0.043148040771484375
[rfa agg] iter: 1, weight: tensor([0.0096, 0.0152, 0.0991, 0.0732, 0.0691, 0.0490, 0.4202, 0.0909, 0.0996,
        0.0742])
[rfa agg] iter:  2, prev_obj_val: 61.50615692138672, obj_val: 59.201141357421875, abs dis: 2.3050155639648438
[rfa agg] iter: 2, weight: tensor([0.0090, 0.0143, 0.0925, 0.0685, 0.0647, 0.0459, 0.4574, 0.0853, 0.0930,
        0.0695])
[rfa agg] iter:  3, prev_obj_val: 59.201141357421875, obj_val: 59.19178771972656, abs dis: 0.0093536376953125
[rfa agg] iter: 3, weight: tensor([0.0075, 0.0119, 0.0882, 0.0634, 0.0595, 0.0369, 0.5135, 0.0659, 0.0888,
        0.0644])
[rfa agg] iter:  4, prev_obj_val: 59.19178771972656, obj_val: 61.50804138183594, abs dis: 2.316253662109375
[rfa agg] iter: 4, weight: tensor([0.0071, 0.0113, 0.0835, 0.0601, 0.0564, 0.0349, 0.5394, 0.0623, 0.0841,
        0.0610])
[rfa agg] iter:  5, prev_obj_val: 61.50804138183594, obj_val: 61.503021240234375, abs dis: 0.0050201416015625
[rfa agg] iter: 5, weight: tensor([0.0084, 0.0133, 0.0862, 0.0640, 0.0604, 0.0428, 0.4938, 0.0793, 0.0868,
        0.0649])
[rfa agg] iter:  6, prev_obj_val: 61.503021240234375, obj_val: 57.20402145385742, abs dis: 4.298999786376953
[rfa agg] iter: 6, weight: tensor([0.0086, 0.0137, 0.0885, 0.0657, 0.0620, 0.0440, 0.4801, 0.0816, 0.0891,
        0.0666])
[rfa agg] iter:  7, prev_obj_val: 57.20402145385742, obj_val: 64.00205993652344, abs dis: 6.798038482666016
[rfa agg] iter: 7, weight: tensor([0.0078, 0.0122, 0.1038, 0.0721, 0.0672, 0.0365, 0.4596, 0.0631, 0.1046,
        0.0732])
[rfa agg] iter:  8, prev_obj_val: 64.00205993652344, obj_val: 63.990562438964844, abs dis: 0.01149749755859375
[rfa agg] iter: 8, weight: tensor([0.0107, 0.0172, 0.0978, 0.0744, 0.0707, 0.0575, 0.3861, 0.1119, 0.0983,
        0.0754])
[rfa agg] iter:  9, prev_obj_val: 63.990562438964844, obj_val: 63.99040222167969, abs dis: 0.00016021728515625
[rfa agg] iter: 9, weight: tensor([0.0108, 0.0174, 0.0991, 0.0755, 0.0716, 0.0585, 0.3764, 0.1144, 0.0997,
        0.0765])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4224, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 9.3839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.75119543075562 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0900, Accuracy: 11/408 (2.6961%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0536, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.0485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0812, Accuracy: 74/682 (10.8504%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0406, Accuracy: 250/682 (36.6569%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2531, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0573, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 670/1742 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4933, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0844, Accuracy: 36/460 (7.8261%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0406, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6490, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0855, Accuracy: 16/515 (3.1068%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4763, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0684, Accuracy: 307/1003 (30.6082%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0367, Accuracy: 383/1003 (38.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2722, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0666, Accuracy: 124/568 (21.8310%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0401, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.0003, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 150/373 (40.2145%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.8477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0559, Accuracy: 351/1949 (18.0092%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 610/1949 (31.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.6236, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0585, Accuracy: 337/1645 (20.4863%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 564/1645 (34.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3885, Accuracy: 111/10000 (1.1100%)
time spent on training: 138.33120155334473
[rfa agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 80, 93, 31, 33, 86, 62, 98, 21, 13], weight: tensor([0.0437, 0.0730, 0.1864, 0.0492, 0.0551, 0.1073, 0.0608, 0.0399, 0.2086,
        0.1760])
[rfa agg] iter:  0, prev_obj_val: 83.3979721069336, obj_val: 85.50210571289062, abs dis: 2.1041336059570312
[rfa agg] iter: 0, weight: tensor([0.0287, 0.0751, 0.1343, 0.0356, 0.0441, 0.3359, 0.0488, 0.0240, 0.1159,
        0.1576])
[rfa agg] iter:  1, prev_obj_val: 85.50210571289062, obj_val: 89.129150390625, abs dis: 3.627044677734375
[rfa agg] iter: 1, weight: tensor([0.0229, 0.0657, 0.0810, 0.0289, 0.0365, 0.5416, 0.0404, 0.0189, 0.0719,
        0.0922])
[rfa agg] iter:  2, prev_obj_val: 89.129150390625, obj_val: 90.67164611816406, abs dis: 1.5424957275390625
[rfa agg] iter: 2, weight: tensor([0.0285, 0.0934, 0.0755, 0.0367, 0.0475, 0.4900, 0.0529, 0.0231, 0.0686,
        0.0840])
[rfa agg] iter:  3, prev_obj_val: 90.67164611816406, obj_val: 92.22747802734375, abs dis: 1.5558319091796875
[rfa agg] iter: 3, weight: tensor([0.0346, 0.1211, 0.0829, 0.0451, 0.0589, 0.3963, 0.0657, 0.0279, 0.0759,
        0.0916])
[rfa agg] iter:  4, prev_obj_val: 92.22747802734375, obj_val: 93.80225372314453, abs dis: 1.5747756958007812
[rfa agg] iter: 4, weight: tensor([0.0396, 0.1500, 0.0854, 0.0521, 0.0691, 0.3228, 0.0771, 0.0316, 0.0786,
        0.0938])
[rfa agg] iter:  5, prev_obj_val: 93.80225372314453, obj_val: 97.01365661621094, abs dis: 3.2114028930664062
[rfa agg] iter: 5, weight: tensor([0.0433, 0.1811, 0.0838, 0.0577, 0.0778, 0.2659, 0.0869, 0.0342, 0.0777,
        0.0916])
[rfa agg] iter:  6, prev_obj_val: 97.01365661621094, obj_val: 96.99667358398438, abs dis: 0.0169830322265625
[rfa agg] iter: 6, weight: tensor([0.0471, 0.2602, 0.0725, 0.0648, 0.0909, 0.1794, 0.1023, 0.0363, 0.0680,
        0.0785])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.3692, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 8.1899, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.82881665229797 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0990, Accuracy: 11/271 (4.0590%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0647, Accuracy: 93/271 (34.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2304, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0583, Accuracy: 274/776 (35.3093%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3277, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0595, Accuracy: 294/1418 (20.7334%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 640/1418 (45.1340%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4525, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0594, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6749, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0607, Accuracy: 210/1071 (19.6078%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.4157, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0608, Accuracy: 327/1956 (16.7178%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 596/1956 (30.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5433, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0732, Accuracy: 212/708 (29.9435%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0332, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9095, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0746, Accuracy: 116/809 (14.3387%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0293, Accuracy: 317/809 (39.1842%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4853, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0579, Accuracy: 398/1904 (20.9034%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 717/1904 (37.6576%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0934, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0643, Accuracy: 278/715 (38.8811%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2550, Accuracy: 51/10000 (0.5100%)
time spent on training: 146.13085293769836
[rfa agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 75, 70, 14, 55, 6, 16, 50, 46, 23], weight: tensor([0.0255, 0.0729, 0.1333, 0.0952, 0.1006, 0.1838, 0.0665, 0.0760, 0.1789,
        0.0672])
[rfa agg] iter:  0, prev_obj_val: 67.543212890625, obj_val: 71.22808837890625, abs dis: 3.68487548828125
[rfa agg] iter: 0, weight: tensor([0.0097, 0.0682, 0.1472, 0.1815, 0.2596, 0.0763, 0.0526, 0.0710, 0.0808,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 71.22808837890625, obj_val: 76.30352020263672, abs dis: 5.075431823730469
[rfa agg] iter: 1, weight: tensor([0.0086, 0.0978, 0.0635, 0.3126, 0.1974, 0.0429, 0.0651, 0.1015, 0.0447,
        0.0658])
[rfa agg] iter:  2, prev_obj_val: 76.30352020263672, obj_val: 78.16575622558594, abs dis: 1.8622360229492188
[rfa agg] iter: 2, weight: tensor([0.0100, 0.1836, 0.0530, 0.1599, 0.1135, 0.0390, 0.1032, 0.1934, 0.0404,
        0.1040])
[rfa agg] iter:  3, prev_obj_val: 78.16575622558594, obj_val: 83.20608520507812, abs dis: 5.0403289794921875
[rfa agg] iter: 3, weight: tensor([0.0091, 0.2259, 0.0432, 0.1103, 0.0842, 0.0326, 0.1119, 0.2374, 0.0337,
        0.1116])
[rfa agg] iter:  4, prev_obj_val: 83.20608520507812, obj_val: 90.0552978515625, abs dis: 6.849212646484375
[rfa agg] iter: 4, weight: tensor([0.0094, 0.2166, 0.0360, 0.0745, 0.0614, 0.0283, 0.1609, 0.2274, 0.0292,
        0.1563])
[rfa agg] iter:  5, prev_obj_val: 90.0552978515625, obj_val: 80.46908569335938, abs dis: 9.586212158203125
[rfa agg] iter: 5, weight: tensor([0.0136, 0.1544, 0.0417, 0.0745, 0.0644, 0.0341, 0.2144, 0.1612, 0.0350,
        0.2067])
[rfa agg] iter:  6, prev_obj_val: 80.46908569335938, obj_val: 86.43759155273438, abs dis: 5.968505859375
[rfa agg] iter: 6, weight: tensor([0.0088, 0.2304, 0.0375, 0.0846, 0.0677, 0.0290, 0.1374, 0.2392, 0.0299,
        0.1355])
[rfa agg] iter:  7, prev_obj_val: 86.43759155273438, obj_val: 90.03795623779297, abs dis: 3.6003646850585938
[rfa agg] iter: 7, weight: tensor([0.0110, 0.1775, 0.0377, 0.0721, 0.0610, 0.0303, 0.2012, 0.1853, 0.0312,
        0.1927])
[rfa agg] iter:  8, prev_obj_val: 90.03795623779297, obj_val: 80.47441101074219, abs dis: 9.563545227050781
[rfa agg] iter: 8, weight: tensor([0.0134, 0.1507, 0.0412, 0.0736, 0.0637, 0.0337, 0.2197, 0.1571, 0.0346,
        0.2123])
[rfa agg] iter:  9, prev_obj_val: 80.47441101074219, obj_val: 86.43702697753906, abs dis: 5.962615966796875
[rfa agg] iter: 9, weight: tensor([0.0088, 0.2295, 0.0376, 0.0847, 0.0679, 0.0290, 0.1381, 0.2382, 0.0300,
        0.1362])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.6013, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 8.2107, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.60101771354675 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0580, Accuracy: 239/590 (40.5085%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.4147, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0622, Accuracy: 173/953 (18.1532%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4675, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0599, Accuracy: 350/1475 (23.7288%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 578/1475 (39.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8243, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1291, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1205, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2988, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0837, Accuracy: 32/515 (6.2136%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0541, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8882, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0595, Accuracy: 317/1418 (22.3554%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6290, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0739, Accuracy: 82/500 (16.4000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1391, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0505, Accuracy: 604/2227 (27.1217%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 973/2227 (43.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7642, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 407/1953 (20.8397%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 738/1953 (37.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3713, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0792, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2042, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.20578360557556
[rfa agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 64, 65, 61, 33, 70, 82, 60, 83, 98], weight: tensor([0.0585, 0.0945, 0.1462, 0.0084, 0.0510, 0.1405, 0.0496, 0.2207, 0.1936,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 80.09765625, obj_val: 79.86741638183594, abs dis: 0.2302398681640625
[rfa agg] iter: 0, weight: tensor([0.0275, 0.0776, 0.2644, 0.0023, 0.0221, 0.3763, 0.0198, 0.0883, 0.1089,
        0.0129])
[rfa agg] iter:  1, prev_obj_val: 79.86741638183594, obj_val: 79.86621856689453, abs dis: 0.00119781494140625
[rfa agg] iter: 1, weight: tensor([0.0261, 0.0734, 0.2613, 0.0022, 0.0209, 0.3983, 0.0188, 0.0837, 0.1030,
        0.0122])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.2919, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 8.3143, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.3658230304718 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0553, Accuracy: 257/590 (43.5593%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.2930, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0665, Accuracy: 125/568 (22.0070%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 260/568 (45.7746%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4229, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0569, Accuracy: 372/1953 (19.0476%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 757/1953 (38.7609%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2430, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0857, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0486, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9043, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0633, Accuracy: 253/690 (36.6667%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0307, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0058, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0662, Accuracy: 261/719 (36.3004%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0355, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9186, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0727, Accuracy: 110/530 (20.7547%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.1772, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0581, Accuracy: 360/1475 (24.4068%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 616/1475 (41.7627%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0298, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0639, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 426/1131 (37.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2788, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 323/1662 (19.4344%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 565/1662 (33.9952%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4564, Accuracy: 97/10000 (0.9700%)
time spent on training: 148.0644006729126
[rfa agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 62, 83, 78, 25, 41, 18, 65, 38, 94], weight: tensor([0.0606, 0.0584, 0.2006, 0.0427, 0.0709, 0.0739, 0.0544, 0.1515, 0.1162,
        0.1707])
[rfa agg] iter:  0, prev_obj_val: 72.94979095458984, obj_val: 77.24346923828125, abs dis: 4.293678283691406
[rfa agg] iter: 0, weight: tensor([0.0437, 0.0372, 0.0806, 0.0220, 0.0587, 0.0713, 0.0347, 0.1239, 0.4195,
        0.1084])
[rfa agg] iter:  1, prev_obj_val: 77.24346923828125, obj_val: 78.41793823242188, abs dis: 1.174468994140625
[rfa agg] iter: 1, weight: tensor([0.0684, 0.0560, 0.0815, 0.0313, 0.0965, 0.1242, 0.0521, 0.1111, 0.2766,
        0.1022])
[rfa agg] iter:  2, prev_obj_val: 78.41793823242188, obj_val: 78.41259765625, abs dis: 0.005340576171875
[rfa agg] iter: 2, weight: tensor([0.0761, 0.0614, 0.0798, 0.0336, 0.1098, 0.1460, 0.0571, 0.1061, 0.2316,
        0.0985])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.8739, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 6.9488, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.78184390068054 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 285/715 (39.8601%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4486, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0568, Accuracy: 342/1949 (17.5475%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0337, Accuracy: 590/1949 (30.2719%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6037, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 633/1418 (44.6403%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2057, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 359/1475 (24.3390%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 619/1475 (41.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0180, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1037, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0817, Accuracy: 52/197 (26.3959%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9483, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0519, Accuracy: 389/1628 (23.8943%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 824/1628 (50.6143%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.8214, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 209/888 (23.5360%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.6400, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0568, Accuracy: 254/599 (42.4040%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0305, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.5790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0591, Accuracy: 325/803 (40.4732%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.8810, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0560, Accuracy: 186/735 (25.3061%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0209, Accuracy: 377/735 (51.2925%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.4324, Accuracy: 53/10000 (0.5300%)
time spent on training: 157.6451277732849
[rfa agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 21, 70, 65, 79, 5, 63, 95, 58, 32], weight: tensor([0.0687, 0.1873, 0.1363, 0.1417, 0.0189, 0.1564, 0.0853, 0.0576, 0.0772,
        0.0706])
[rfa agg] iter:  0, prev_obj_val: 66.47111511230469, obj_val: 67.47845458984375, abs dis: 1.0073394775390625
[rfa agg] iter: 0, weight: tensor([0.0630, 0.1011, 0.2101, 0.1772, 0.0081, 0.1427, 0.1083, 0.0415, 0.0828,
        0.0651])
[rfa agg] iter:  1, prev_obj_val: 67.47845458984375, obj_val: 69.61779022216797, abs dis: 2.1393356323242188
[rfa agg] iter: 1, weight: tensor([0.0688, 0.0985, 0.1940, 0.1656, 0.0085, 0.1358, 0.1218, 0.0446, 0.0914,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 69.61779022216797, obj_val: 70.70145416259766, abs dis: 1.0836639404296875
[rfa agg] iter: 2, weight: tensor([0.0805, 0.0912, 0.1603, 0.1412, 0.0091, 0.1201, 0.1534, 0.0503, 0.1106,
        0.0834])
[rfa agg] iter:  3, prev_obj_val: 70.70145416259766, obj_val: 70.69947814941406, abs dis: 0.00197601318359375
[rfa agg] iter: 3, weight: tensor([0.0861, 0.0859, 0.1439, 0.1283, 0.0092, 0.1109, 0.1728, 0.0526, 0.1210,
        0.0893])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.0413, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 6.5316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 248.07711815834045 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0991, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0631, Accuracy: 87/271 (32.1033%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4169, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0582, Accuracy: 338/1581 (21.3789%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 553/1581 (34.9779%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2552, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0548, Accuracy: 375/1587 (23.6295%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 617/1587 (38.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8324, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0861, Accuracy: 55/682 (8.0645%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0404, Accuracy: 264/682 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7721, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0588, Accuracy: 291/1130 (25.7522%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0301, Accuracy: 442/1130 (39.1150%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.3164, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0641, Accuracy: 153/568 (26.9366%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0385, Accuracy: 260/568 (45.7746%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.3929, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0540, Accuracy: 170/735 (23.1293%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 375/735 (51.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 10.8374, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0548, Accuracy: 436/1470 (29.6599%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 782/1470 (53.1973%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.4985, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0584, Accuracy: 336/901 (37.2919%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.4558, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0519, Accuracy: 317/1372 (23.1050%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 539/1372 (39.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.6183, Accuracy: 83/10000 (0.8300%)
time spent on training: 157.70822501182556
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 28, 27, 80, 54, 62, 32, 22, 4, 42], weight: tensor([0.0263, 0.1535, 0.1541, 0.0662, 0.1097, 0.0552, 0.0714, 0.1428, 0.0875,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 57.210697174072266, obj_val: 60.94294738769531, abs dis: 3.732250213623047
[rfa agg] iter: 0, weight: tensor([0.0109, 0.0790, 0.0793, 0.0598, 0.2205, 0.0364, 0.0809, 0.0929, 0.2392,
        0.1010])
[rfa agg] iter:  1, prev_obj_val: 60.94294738769531, obj_val: 63.084808349609375, abs dis: 2.1418609619140625
[rfa agg] iter: 1, weight: tensor([0.0113, 0.0674, 0.0676, 0.0693, 0.1530, 0.0399, 0.0999, 0.0772, 0.3318,
        0.0825])
[rfa agg] iter:  2, prev_obj_val: 63.084808349609375, obj_val: 63.082340240478516, abs dis: 0.002468109130859375
[rfa agg] iter: 2, weight: tensor([0.0118, 0.0639, 0.0641, 0.0777, 0.1311, 0.0431, 0.1168, 0.0724, 0.3425,
        0.0766])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 11.2041, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 7.1476, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.24237775802612 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0508, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0898, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4446, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 175/605 (28.9256%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5488, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0659, Accuracy: 273/715 (38.1818%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3608, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0559, Accuracy: 299/928 (32.2198%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 583/928 (62.8233%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.9633, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0500, Accuracy: 388/891 (43.5466%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 420/891 (47.1380%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.6336, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0888, Accuracy: 13/416 (3.1250%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0477, Accuracy: 186/416 (44.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5304, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0764, Accuracy: 93/809 (11.4957%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0294, Accuracy: 312/809 (38.5661%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.9873, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0633, Accuracy: 222/1241 (17.8888%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0376, Accuracy: 390/1241 (31.4263%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2553, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0592, Accuracy: 325/1581 (20.5566%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0351, Accuracy: 545/1581 (34.4719%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.5019, Accuracy: 88/10000 (0.8800%)
time spent on training: 147.44667148590088
[rfa agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 89, 2, 23, 1, 7, 78, 50, 72, 28], weight: tensor([0.0545, 0.1048, 0.0708, 0.0836, 0.1086, 0.1042, 0.0487, 0.0946, 0.1452,
        0.1850])
[rfa agg] iter:  0, prev_obj_val: 44.33843231201172, obj_val: 47.80271911621094, abs dis: 3.4642868041992188
[rfa agg] iter: 0, weight: tensor([0.0280, 0.1603, 0.0584, 0.1469, 0.1141, 0.1667, 0.0209, 0.2098, 0.0542,
        0.0407])
[rfa agg] iter:  1, prev_obj_val: 47.80271911621094, obj_val: 52.85059356689453, abs dis: 5.047874450683594
[rfa agg] iter: 1, weight: tensor([0.0367, 0.1238, 0.0877, 0.2271, 0.0912, 0.1271, 0.0264, 0.1891, 0.0507,
        0.0400])
[rfa agg] iter:  2, prev_obj_val: 52.85059356689453, obj_val: 55.6682014465332, abs dis: 2.817607879638672
[rfa agg] iter: 2, weight: tensor([0.0560, 0.1065, 0.1625, 0.2054, 0.0847, 0.1080, 0.0383, 0.1411, 0.0535,
        0.0440])
[rfa agg] iter:  3, prev_obj_val: 55.6682014465332, obj_val: 55.6546630859375, abs dis: 0.013538360595703125
[rfa agg] iter: 3, weight: tensor([0.0685, 0.0972, 0.2279, 0.1654, 0.0795, 0.0981, 0.0450, 0.1214, 0.0528,
        0.0443])
[rfa agg] iter:  4, prev_obj_val: 55.6546630859375, obj_val: 55.65428161621094, abs dis: 0.0003814697265625
[rfa agg] iter: 4, weight: tensor([0.0680, 0.0957, 0.2413, 0.1609, 0.0783, 0.0964, 0.0445, 0.1192, 0.0520,
        0.0436])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 11.3845, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 7.1667, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.91115617752075 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0605, Accuracy: 365/1956 (18.6605%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 600/1956 (30.6748%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.3762, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0696, Accuracy: 304/1003 (30.3091%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0371, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7495, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0997, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0623, Accuracy: 88/271 (32.4723%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5252, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0656, Accuracy: 236/708 (33.3333%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6815, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0624, Accuracy: 270/896 (30.1339%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0351, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6688, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0559, Accuracy: 417/1715 (24.3149%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0314, Accuracy: 678/1715 (39.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4087, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0588, Accuracy: 312/807 (38.6617%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 396/807 (49.0706%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4145, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0549, Accuracy: 291/1089 (26.7218%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0358, Accuracy: 469/1089 (43.0670%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.8988, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0609, Accuracy: 176/861 (20.4413%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 420/861 (48.7805%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.9381, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0593, Accuracy: 194/1013 (19.1510%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 377/1013 (37.2162%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5302, Accuracy: 75/10000 (0.7500%)
time spent on training: 162.05041599273682
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 86, 35, 16, 89, 92, 20, 59, 10, 14], weight: tensor([0.1896, 0.0972, 0.0263, 0.0686, 0.0868, 0.1662, 0.0782, 0.1055, 0.0834,
        0.0982])
[rfa agg] iter:  0, prev_obj_val: 58.68841552734375, obj_val: 61.889434814453125, abs dis: 3.201019287109375
[rfa agg] iter: 0, weight: tensor([0.0564, 0.1870, 0.0083, 0.0490, 0.0940, 0.0693, 0.0676, 0.1885, 0.0902,
        0.1897])
[rfa agg] iter:  1, prev_obj_val: 61.889434814453125, obj_val: 65.92293548583984, abs dis: 4.033500671386719
[rfa agg] iter: 1, weight: tensor([0.0340, 0.1467, 0.0079, 0.0720, 0.1806, 0.0391, 0.1178, 0.0784, 0.1762,
        0.1472])
[rfa agg] iter:  2, prev_obj_val: 65.92293548583984, obj_val: 68.68535614013672, abs dis: 2.762420654296875
[rfa agg] iter: 2, weight: tensor([0.0308, 0.0987, 0.0085, 0.1007, 0.1977, 0.0347, 0.1772, 0.0599, 0.1923,
        0.0995])
[rfa agg] iter:  3, prev_obj_val: 68.68535614013672, obj_val: 75.35195922851562, abs dis: 6.666603088378906
[rfa agg] iter: 3, weight: tensor([0.0314, 0.0884, 0.0094, 0.1318, 0.1731, 0.0351, 0.2164, 0.0573, 0.1677,
        0.0893])
[rfa agg] iter:  4, prev_obj_val: 75.35195922851562, obj_val: 68.69474792480469, abs dis: 6.6572113037109375
[rfa agg] iter: 4, weight: tensor([0.0361, 0.0837, 0.0129, 0.2156, 0.1369, 0.0399, 0.1985, 0.0597, 0.1322,
        0.0845])
[rfa agg] iter:  5, prev_obj_val: 68.69474792480469, obj_val: 75.34796905517578, abs dis: 6.653221130371094
[rfa agg] iter: 5, weight: tensor([0.0313, 0.0878, 0.0094, 0.1416, 0.1658, 0.0350, 0.2211, 0.0572, 0.1620,
        0.0888])
[rfa agg] iter:  6, prev_obj_val: 75.34796905517578, obj_val: 68.69546508789062, abs dis: 6.652503967285156
[rfa agg] iter: 6, weight: tensor([0.0361, 0.0834, 0.0128, 0.2174, 0.1363, 0.0398, 0.1986, 0.0595, 0.1317,
        0.0843])
[rfa agg] iter:  7, prev_obj_val: 68.69546508789062, obj_val: 75.34790802001953, abs dis: 6.652442932128906
[rfa agg] iter: 7, weight: tensor([0.0313, 0.0878, 0.0094, 0.1418, 0.1657, 0.0350, 0.2211, 0.0572, 0.1619,
        0.0888])
[rfa agg] iter:  8, prev_obj_val: 75.34790802001953, obj_val: 68.69547271728516, abs dis: 6.652435302734375
[rfa agg] iter: 8, weight: tensor([0.0361, 0.0834, 0.0128, 0.2174, 0.1363, 0.0398, 0.1986, 0.0595, 0.1317,
        0.0843])
[rfa agg] iter:  9, prev_obj_val: 68.69547271728516, obj_val: 75.34791564941406, abs dis: 6.652442932128906
[rfa agg] iter: 9, weight: tensor([0.0313, 0.0878, 0.0094, 0.1418, 0.1657, 0.0350, 0.2211, 0.0572, 0.1619,
        0.0888])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.0303, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 9.4016, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.36237359046936 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0561, Accuracy: 264/776 (34.0206%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4165, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 296/1645 (17.9939%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 572/1645 (34.7720%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.9116, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0589, Accuracy: 287/1130 (25.3982%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 451/1130 (39.9115%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.8408, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0616, Accuracy: 336/1956 (17.1779%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 653/1956 (33.3845%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4493, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 220/888 (24.7748%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 437/888 (49.2117%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.6396, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0842, Accuracy: 12/440 (2.7273%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0498, Accuracy: 140/440 (31.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0593, Accuracy: 322/1418 (22.7080%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 662/1418 (46.6855%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.6621, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0659, Accuracy: 176/1049 (16.7779%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0323, Accuracy: 472/1049 (44.9952%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8965, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 319/803 (39.7260%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2578, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0534, Accuracy: 337/1275 (26.4314%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 677/1275 (53.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.9658, Accuracy: 108/10000 (1.0800%)
time spent on training: 170.8118076324463
[rfa agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 13, 54, 6, 63, 49, 70, 51, 58, 9], weight: tensor([0.0682, 0.1446, 0.0993, 0.1719, 0.0780, 0.0387, 0.1246, 0.0922, 0.0706,
        0.1120])
[rfa agg] iter:  0, prev_obj_val: 55.09228515625, obj_val: 59.21641159057617, abs dis: 4.124126434326172
[rfa agg] iter: 0, weight: tensor([0.0496, 0.0664, 0.2650, 0.0492, 0.0694, 0.0130, 0.0898, 0.1740, 0.0515,
        0.1720])
[rfa agg] iter:  1, prev_obj_val: 59.21641159057617, obj_val: 63.132537841796875, abs dis: 3.916126251220703
[rfa agg] iter: 1, weight: tensor([0.0726, 0.0591, 0.2086, 0.0465, 0.1089, 0.0158, 0.0737, 0.2218, 0.0750,
        0.1181])
[rfa agg] iter:  2, prev_obj_val: 63.132537841796875, obj_val: 67.5708999633789, abs dis: 4.438362121582031
[rfa agg] iter: 2, weight: tensor([0.1029, 0.0568, 0.1495, 0.0461, 0.1668, 0.0187, 0.0681, 0.1850, 0.1067,
        0.0993])
[rfa agg] iter:  3, prev_obj_val: 67.5708999633789, obj_val: 70.00761413574219, abs dis: 2.4367141723632812
[rfa agg] iter: 3, weight: tensor([0.1411, 0.0484, 0.1039, 0.0404, 0.2431, 0.0196, 0.0563, 0.1232, 0.1472,
        0.0768])
[rfa agg] iter:  4, prev_obj_val: 70.00761413574219, obj_val: 69.99555969238281, abs dis: 0.012054443359375
[rfa agg] iter: 4, weight: tensor([0.1645, 0.0422, 0.0833, 0.0356, 0.2739, 0.0190, 0.0483, 0.0957, 0.1734,
        0.0641])
[rfa agg] iter:  5, prev_obj_val: 69.99555969238281, obj_val: 69.9952392578125, abs dis: 0.0003204345703125
[rfa agg] iter: 5, weight: tensor([0.1637, 0.0413, 0.0815, 0.0349, 0.2837, 0.0187, 0.0474, 0.0931, 0.1730,
        0.0628])
[rfa agg] iter:  6, prev_obj_val: 69.9952392578125, obj_val: 67.52962493896484, abs dis: 2.4656143188476562
[rfa agg] iter: 6, weight: tensor([0.1629, 0.0412, 0.0811, 0.0347, 0.2867, 0.0186, 0.0472, 0.0927, 0.1723,
        0.0625])
[rfa agg] iter:  7, prev_obj_val: 67.52962493896484, obj_val: 72.79166412353516, abs dis: 5.2620391845703125
[rfa agg] iter: 7, weight: tensor([0.1388, 0.0462, 0.0982, 0.0385, 0.2735, 0.0187, 0.0537, 0.1138, 0.1456,
        0.0730])
[rfa agg] iter:  8, prev_obj_val: 72.79166412353516, obj_val: 70.00148010253906, abs dis: 2.7901840209960938
[rfa agg] iter: 8, weight: tensor([0.1965, 0.0392, 0.0724, 0.0334, 0.2457, 0.0197, 0.0444, 0.0817, 0.2095,
        0.0575])
[rfa agg] iter:  9, prev_obj_val: 70.00148010253906, obj_val: 69.9954605102539, abs dis: 0.00601959228515625
[rfa agg] iter: 9, weight: tensor([0.1674, 0.0414, 0.0815, 0.0349, 0.2755, 0.0187, 0.0475, 0.0930, 0.1774,
        0.0628])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.4145, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 10.2361, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.07313895225525 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0680, Accuracy: 224/708 (31.6384%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0340, Accuracy: 420/708 (59.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5363, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0672, Accuracy: 242/690 (35.0725%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0326, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3718, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0590, Accuracy: 403/1904 (21.1660%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0304, Accuracy: 736/1904 (38.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0670, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0862, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0535, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3475, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0866, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0506, Accuracy: 134/373 (35.9249%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1227, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0664, Accuracy: 141/938 (15.0320%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 340/938 (36.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.3875, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 356/1742 (20.4363%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 685/1742 (39.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5494, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 179/953 (18.7828%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 292/953 (30.6401%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7933, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0564, Accuracy: 355/1949 (18.2145%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 612/1949 (31.4007%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6081, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0591, Accuracy: 164/861 (19.0476%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 414/861 (48.0836%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.9222, Accuracy: 95/10000 (0.9500%)
time spent on training: 162.62970447540283
[rfa agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 25, 46, 76, 98, 73, 93, 64, 21, 10], weight: tensor([0.0669, 0.0652, 0.1799, 0.0440, 0.0352, 0.0886, 0.1646, 0.0900, 0.1841,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 79.56657409667969, obj_val: 80.8329086303711, abs dis: 1.2663345336914062
[rfa agg] iter: 0, weight: tensor([0.0713, 0.0612, 0.1230, 0.0302, 0.0203, 0.1606, 0.1369, 0.1617, 0.1154,
        0.1194])
[rfa agg] iter:  1, prev_obj_val: 80.8329086303711, obj_val: 83.4358901977539, abs dis: 2.6029815673828125
[rfa agg] iter: 1, weight: tensor([0.0740, 0.0609, 0.0787, 0.0277, 0.0180, 0.2200, 0.0849, 0.2183, 0.0747,
        0.1429])
[rfa agg] iter:  2, prev_obj_val: 83.4358901977539, obj_val: 88.89102172851562, abs dis: 5.455131530761719
[rfa agg] iter: 2, weight: tensor([0.0691, 0.0529, 0.0407, 0.0210, 0.0130, 0.2832, 0.0429, 0.2641, 0.0390,
        0.1741])
[rfa agg] iter:  3, prev_obj_val: 88.89102172851562, obj_val: 93.85108184814453, abs dis: 4.960060119628906
[rfa agg] iter: 3, weight: tensor([0.1241, 0.0882, 0.0417, 0.0297, 0.0174, 0.1899, 0.0434, 0.1860, 0.0402,
        0.2393])
[rfa agg] iter:  4, prev_obj_val: 93.85108184814453, obj_val: 91.24043273925781, abs dis: 2.6106491088867188
[rfa agg] iter: 4, weight: tensor([0.2024, 0.1414, 0.0436, 0.0398, 0.0220, 0.1384, 0.0450, 0.1385, 0.0422,
        0.1867])
[rfa agg] iter:  5, prev_obj_val: 91.24043273925781, obj_val: 93.8134536743164, abs dis: 2.5730209350585938
[rfa agg] iter: 5, weight: tensor([0.1781, 0.1153, 0.0429, 0.0347, 0.0197, 0.1548, 0.0445, 0.1553, 0.0415,
        0.2132])
[rfa agg] iter:  6, prev_obj_val: 93.8134536743164, obj_val: 88.88170623779297, abs dis: 4.9317474365234375
[rfa agg] iter: 6, weight: tensor([0.2143, 0.1427, 0.0431, 0.0394, 0.0218, 0.1353, 0.0444, 0.1359, 0.0417,
        0.1815])
[rfa agg] iter:  7, prev_obj_val: 88.88170623779297, obj_val: 88.83386993408203, abs dis: 0.0478363037109375
[rfa agg] iter: 7, weight: tensor([0.1376, 0.0919, 0.0420, 0.0301, 0.0176, 0.1777, 0.0437, 0.1774, 0.0405,
        0.2415])
[rfa agg] iter:  8, prev_obj_val: 88.83386993408203, obj_val: 88.83296203613281, abs dis: 0.00090789794921875
[rfa agg] iter: 8, weight: tensor([0.1285, 0.0886, 0.0412, 0.0295, 0.0172, 0.1795, 0.0428, 0.1770, 0.0397,
        0.2560])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 11.9323, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 12.9489, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.1559224128723 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0561, Accuracy: 349/1949 (17.9066%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0340, Accuracy: 584/1949 (29.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.0849, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0896, Accuracy: 39/631 (6.1807%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0481, Accuracy: 208/631 (32.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4189, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0716, Accuracy: 126/530 (23.7736%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0408, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5920, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0449, Accuracy: 423/1552 (27.2552%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 714/1552 (46.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.0330, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0594, Accuracy: 264/928 (28.4483%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.0708, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0721, Accuracy: 132/773 (17.0763%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 372/773 (48.1242%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.5811, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0472, Accuracy: 420/891 (47.1380%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7210, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0884, Accuracy: 42/466 (9.0129%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0548, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2605, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0586, Accuracy: 207/813 (25.4613%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 441/813 (54.2435%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 12.9126, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0620, Accuracy: 224/1513 (14.8050%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0374, Accuracy: 467/1513 (30.8658%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.3994, Accuracy: 111/10000 (1.1100%)
time spent on training: 157.70617961883545
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 48, 18, 74, 1, 99, 7, 76, 53, 8], weight: tensor([0.1940, 0.0628, 0.0528, 0.1545, 0.0924, 0.0769, 0.0887, 0.0464, 0.0809,
        0.1506])
[rfa agg] iter:  0, prev_obj_val: 67.77088165283203, obj_val: 68.52066040039062, abs dis: 0.7497787475585938
[rfa agg] iter: 0, weight: tensor([0.0872, 0.0504, 0.0374, 0.1226, 0.1853, 0.0991, 0.1452, 0.0295, 0.1059,
        0.1374])
[rfa agg] iter:  1, prev_obj_val: 68.52066040039062, obj_val: 72.43827056884766, abs dis: 3.9176101684570312
[rfa agg] iter: 1, weight: tensor([0.0543, 0.0486, 0.0346, 0.0698, 0.2488, 0.1161, 0.1979, 0.0265, 0.1275,
        0.0759])
[rfa agg] iter:  2, prev_obj_val: 72.43827056884766, obj_val: 74.24380493164062, abs dis: 1.8055343627929688
[rfa agg] iter: 2, weight: tensor([0.0367, 0.0561, 0.0373, 0.0441, 0.1491, 0.1684, 0.2227, 0.0271, 0.2115,
        0.0470])
[rfa agg] iter:  3, prev_obj_val: 74.24380493164062, obj_val: 76.52616119384766, abs dis: 2.2823562622070312
[rfa agg] iter: 3, weight: tensor([0.0349, 0.0630, 0.0409, 0.0414, 0.1176, 0.1894, 0.1877, 0.0291, 0.2519,
        0.0440])
[rfa agg] iter:  4, prev_obj_val: 76.52616119384766, obj_val: 76.5228042602539, abs dis: 0.00335693359375
[rfa agg] iter: 4, weight: tensor([0.0362, 0.0783, 0.0491, 0.0424, 0.1072, 0.1944, 0.1593, 0.0342, 0.2540,
        0.0449])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 14.5159, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 16.0546, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.47899746894836 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0607, Accuracy: 207/636 (32.5472%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.0798, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0563, Accuracy: 293/1662 (17.6294%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0344, Accuracy: 576/1662 (34.6570%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5834, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0607, Accuracy: 257/928 (27.6940%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.4807, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0759, Accuracy: 266/1003 (26.5204%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0377, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9772, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0561, Accuracy: 336/1949 (17.2396%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 566/1949 (29.0405%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.9288, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0582, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.8568, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 175/605 (28.9256%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5634, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0571, Accuracy: 309/901 (34.2952%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0359, Accuracy: 394/901 (43.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.5086, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0664, Accuracy: 134/568 (23.5915%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 259/568 (45.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4822, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0728, Accuracy: 193/774 (24.9354%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0411, Accuracy: 308/774 (39.7933%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6400, Accuracy: 61/10000 (0.6100%)
time spent on training: 186.87940526008606
[rfa agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 94, 1, 86, 21, 75, 2, 4, 62, 81], weight: tensor([0.0649, 0.1696, 0.0947, 0.1023, 0.1988, 0.0792, 0.0617, 0.0919, 0.0579,
        0.0790])
[rfa agg] iter:  0, prev_obj_val: 63.262123107910156, obj_val: 63.85359191894531, abs dis: 0.5914688110351562
[rfa agg] iter: 0, weight: tensor([0.0410, 0.0838, 0.1698, 0.2348, 0.0637, 0.0851, 0.0392, 0.1668, 0.0323,
        0.0835])
[rfa agg] iter:  1, prev_obj_val: 63.85359191894531, obj_val: 69.12222290039062, abs dis: 5.2686309814453125
[rfa agg] iter: 1, weight: tensor([0.0488, 0.0448, 0.1730, 0.1347, 0.0373, 0.1588, 0.0469, 0.1751, 0.0360,
        0.1446])
[rfa agg] iter:  2, prev_obj_val: 69.12222290039062, obj_val: 74.1612777709961, abs dis: 5.039054870605469
[rfa agg] iter: 2, weight: tensor([0.0756, 0.0422, 0.1117, 0.0907, 0.0362, 0.2179, 0.0743, 0.1104, 0.0529,
        0.1882])
[rfa agg] iter:  3, prev_obj_val: 74.1612777709961, obj_val: 74.13042449951172, abs dis: 0.030853271484375
[rfa agg] iter: 3, weight: tensor([0.1199, 0.0445, 0.0952, 0.0822, 0.0389, 0.1669, 0.1233, 0.0934, 0.0808,
        0.1549])
[rfa agg] iter:  4, prev_obj_val: 74.13042449951172, obj_val: 76.91106414794922, abs dis: 2.7806396484375
[rfa agg] iter: 4, weight: tensor([0.1244, 0.0443, 0.0946, 0.0819, 0.0387, 0.1630, 0.1275, 0.0927, 0.0815,
        0.1513])
[rfa agg] iter:  5, prev_obj_val: 76.91106414794922, obj_val: 74.1410903930664, abs dis: 2.7699737548828125
[rfa agg] iter: 5, weight: tensor([0.1525, 0.0433, 0.0852, 0.0752, 0.0382, 0.1339, 0.1623, 0.0833, 0.0989,
        0.1272])
[rfa agg] iter:  6, prev_obj_val: 74.1410903930664, obj_val: 76.90888214111328, abs dis: 2.767791748046875
[rfa agg] iter: 6, weight: tensor([0.1278, 0.0442, 0.0943, 0.0817, 0.0387, 0.1601, 0.1306, 0.0922, 0.0821,
        0.1483])
[rfa agg] iter:  7, prev_obj_val: 76.90888214111328, obj_val: 74.14132690429688, abs dis: 2.7675552368164062
[rfa agg] iter: 7, weight: tensor([0.1529, 0.0432, 0.0852, 0.0752, 0.0381, 0.1337, 0.1627, 0.0832, 0.0989,
        0.1269])
[rfa agg] iter:  8, prev_obj_val: 74.14132690429688, obj_val: 76.90885162353516, abs dis: 2.7675247192382812
[rfa agg] iter: 8, weight: tensor([0.1278, 0.0442, 0.0943, 0.0817, 0.0387, 0.1601, 0.1307, 0.0922, 0.0821,
        0.1482])
[rfa agg] iter:  9, prev_obj_val: 76.90885162353516, obj_val: 74.1413345336914, abs dis: 2.76751708984375
[rfa agg] iter: 9, weight: tensor([0.1530, 0.0432, 0.0852, 0.0752, 0.0381, 0.1337, 0.1627, 0.0832, 0.0989,
        0.1269])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.4290, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 12.1210, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.3074688911438 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0704, Accuracy: 239/1190 (20.0840%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5657, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0726, Accuracy: 88/500 (17.6000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 195/500 (39.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7650, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0557, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 587/1645 (35.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8983, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0779, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0442, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.4256, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 175/605 (28.9256%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8304, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 171/861 (19.8606%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.3058, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0788, Accuracy: 85/809 (10.5068%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0310, Accuracy: 298/809 (36.8356%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.9518, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0623, Accuracy: 278/1418 (19.6051%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 613/1418 (43.2299%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8045, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0597, Accuracy: 207/1013 (20.4344%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1583, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0613, Accuracy: 200/590 (33.8983%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.3061, Accuracy: 50/10000 (0.5000%)
time spent on training: 161.82430410385132
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 82, 13, 67, 2, 10, 50, 70, 14, 69], weight: tensor([0.1314, 0.0552, 0.1816, 0.0470, 0.0668, 0.0951, 0.0893, 0.1566, 0.1118,
        0.0651])
[rfa agg] iter:  0, prev_obj_val: 53.71222686767578, obj_val: 55.9559326171875, abs dis: 2.2437057495117188
[rfa agg] iter: 0, weight: tensor([0.1037, 0.0311, 0.0584, 0.0228, 0.0530, 0.2403, 0.1636, 0.0679, 0.2074,
        0.0518])
[rfa agg] iter:  1, prev_obj_val: 55.9559326171875, obj_val: 59.53321075439453, abs dis: 3.5772781372070312
[rfa agg] iter: 1, weight: tensor([0.0803, 0.0339, 0.0501, 0.0243, 0.0621, 0.2638, 0.2282, 0.0567, 0.1399,
        0.0608])
[rfa agg] iter:  2, prev_obj_val: 59.53321075439453, obj_val: 66.41068267822266, abs dis: 6.877471923828125
[rfa agg] iter: 2, weight: tensor([0.0739, 0.0441, 0.0501, 0.0306, 0.0888, 0.1920, 0.2660, 0.0555, 0.1122,
        0.0870])
[rfa agg] iter:  3, prev_obj_val: 66.41068267822266, obj_val: 66.33018493652344, abs dis: 0.08049774169921875
[rfa agg] iter: 3, weight: tensor([0.0669, 0.0695, 0.0498, 0.0446, 0.1718, 0.1222, 0.1635, 0.0537, 0.0895,
        0.1684])
[rfa agg] iter:  4, prev_obj_val: 66.33018493652344, obj_val: 66.3294448852539, abs dis: 0.00074005126953125
[rfa agg] iter: 4, weight: tensor([0.0652, 0.0692, 0.0486, 0.0442, 0.1818, 0.1178, 0.1550, 0.0523, 0.0872,
        0.1787])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.2720, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 13.0272, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.328262090683 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0641, Accuracy: 328/1750 (18.7429%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0370, Accuracy: 636/1750 (36.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0044, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0581, Accuracy: 296/1446 (20.4703%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 525/1446 (36.3071%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9561, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0546, Accuracy: 229/813 (28.1673%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0194, Accuracy: 467/813 (57.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 12.6458, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0610, Accuracy: 256/1131 (22.6348%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.0588, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0617, Accuracy: 248/1154 (21.4905%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0320, Accuracy: 464/1154 (40.2080%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.8319, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0573, Accuracy: 332/1662 (19.9759%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0343, Accuracy: 564/1662 (33.9350%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.6750, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0872, Accuracy: 22/460 (4.7826%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.7455, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0602, Accuracy: 169/605 (27.9339%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0369, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9555, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0785, Accuracy: 201/774 (25.9690%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0421, Accuracy: 295/774 (38.1137%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8626, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0862, Accuracy: 40/631 (6.3391%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0474, Accuracy: 210/631 (33.2805%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.2030, Accuracy: 69/10000 (0.6900%)
time spent on training: 169.79186487197876
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 26, 53, 87, 15, 94, 31, 2, 81, 48], weight: tensor([0.1678, 0.1387, 0.0780, 0.1085, 0.1107, 0.1594, 0.0441, 0.0580, 0.0742,
        0.0605])
[rfa agg] iter:  0, prev_obj_val: 57.95370101928711, obj_val: 63.49673843383789, abs dis: 5.543037414550781
[rfa agg] iter: 0, weight: tensor([0.0711, 0.1095, 0.0754, 0.3009, 0.1985, 0.0832, 0.0207, 0.0343, 0.0705,
        0.0359])
[rfa agg] iter:  1, prev_obj_val: 63.49673843383789, obj_val: 63.444236755371094, abs dis: 0.052501678466796875
[rfa agg] iter: 1, weight: tensor([0.0688, 0.0939, 0.1439, 0.2027, 0.1454, 0.0777, 0.0297, 0.0526, 0.1303,
        0.0552])
[rfa agg] iter:  2, prev_obj_val: 63.444236755371094, obj_val: 63.444149017333984, abs dis: 8.7738037109375e-05
[rfa agg] iter: 2, weight: tensor([0.0687, 0.0937, 0.1469, 0.1987, 0.1433, 0.0776, 0.0298, 0.0528, 0.1332,
        0.0554])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.8859, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 13.1662, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.8020462989807 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0892, Accuracy: 42/682 (6.1584%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0398, Accuracy: 250/682 (36.6569%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.5701, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0874, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0706, Accuracy: 34/186 (18.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.5060, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0662, Accuracy: 146/938 (15.5650%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.2352, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0452, Accuracy: 462/1552 (29.7680%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 736/1552 (47.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.3841, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0859, Accuracy: 87/669 (13.0045%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0448, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3507, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0570, Accuracy: 297/1130 (26.2832%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0304, Accuracy: 454/1130 (40.1770%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.4583, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0582, Accuracy: 266/1372 (19.3878%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0328, Accuracy: 490/1372 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9340, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1061, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 36/197 (18.2741%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7523, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0482, Accuracy: 379/891 (42.5365%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0246, Accuracy: 450/891 (50.5051%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9658, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0737, Accuracy: 90/809 (11.1248%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0291, Accuracy: 328/809 (40.5439%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.4669, Accuracy: 77/10000 (0.7700%)
time spent on training: 157.47048950195312
[rfa agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 56, 73, 74, 45, 54, 42, 79, 7, 50], weight: tensor([0.0809, 0.0221, 0.1113, 0.1842, 0.0794, 0.1341, 0.1628, 0.0234, 0.1057,
        0.0960])
[rfa agg] iter:  0, prev_obj_val: 48.09687423706055, obj_val: 52.312660217285156, abs dis: 4.215785980224609
[rfa agg] iter: 0, weight: tensor([0.0683, 0.0057, 0.2510, 0.0547, 0.0654, 0.1125, 0.0669, 0.0067, 0.2220,
        0.1468])
[rfa agg] iter:  1, prev_obj_val: 52.312660217285156, obj_val: 54.46076583862305, abs dis: 2.1481056213378906
[rfa agg] iter: 1, weight: tensor([0.1053, 0.0063, 0.1538, 0.0474, 0.0984, 0.0807, 0.0554, 0.0076, 0.2146,
        0.2304])
[rfa agg] iter:  2, prev_obj_val: 54.46076583862305, obj_val: 56.94947814941406, abs dis: 2.4887123107910156
[rfa agg] iter: 2, weight: tensor([0.1337, 0.0068, 0.1294, 0.0470, 0.1214, 0.0760, 0.0542, 0.0082, 0.1798,
        0.2435])
[rfa agg] iter:  3, prev_obj_val: 56.94947814941406, obj_val: 56.93387985229492, abs dis: 0.015598297119140625
[rfa agg] iter: 3, weight: tensor([0.1750, 0.0075, 0.1158, 0.0473, 0.1524, 0.0733, 0.0540, 0.0091, 0.1528,
        0.2127])
[rfa agg] iter:  4, prev_obj_val: 56.93387985229492, obj_val: 56.93354797363281, abs dis: 0.000331878662109375
[rfa agg] iter: 4, weight: tensor([0.1807, 0.0075, 0.1150, 0.0471, 0.1567, 0.0730, 0.0538, 0.0091, 0.1510,
        0.2062])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.4560, Accuracy: 34/10000 (0.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 14.0976, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.8301146030426 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0550, Accuracy: 380/1574 (24.1423%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0262, Accuracy: 778/1574 (49.4282%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0207, Accuracy: 927/1574 (58.8945%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0203, Accuracy: 935/1574 (59.4028%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0198, Accuracy: 954/1574 (60.6099%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0201, Accuracy: 957/1574 (60.8005%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0192, Accuracy: 990/1574 (62.8971%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0189, Accuracy: 988/1574 (62.7700%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0186, Accuracy: 991/1574 (62.9606%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0185, Accuracy: 986/1574 (62.6429%), train_poison_data_count: 500
Global model norm: 204.6369880422403.
Norm before scaling: 204.5827499143073. Distance: 1.3178383935162445
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3893, Accuracy: 96/10000 (0.9600%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.2175, Accuracy: 9767/9950 (98.1608%)
Scaling by  100
Scaled Norm after poisoning: 238.43337971538298, distance: 131.78383993779357
Total norm for 1 adversaries is: 238.43337971538298. distance: 131.78383993779357
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 259/1190 (21.7647%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0341, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2601, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0705, Accuracy: 97/809 (11.9901%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 346/809 (42.7689%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.2352, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0651, Accuracy: 229/690 (33.1884%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.6668, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 572/1645 (34.7720%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.8942, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0515, Accuracy: 275/599 (45.9098%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 12.2578, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0864, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 128/373 (34.3164%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9688, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0582, Accuracy: 271/1372 (19.7522%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0331, Accuracy: 473/1372 (34.4752%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7217, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 265/1154 (22.9636%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 502/1154 (43.5009%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.9198, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0567, Accuracy: 290/1130 (25.6637%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 464/1130 (41.0619%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.8601, Accuracy: 61/10000 (0.6100%)
time spent on training: 286.74673771858215
[rfa agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.04668517463933181
[rfa agg] init. name: [17, 84, 50, 25, 13, 95, 98, 42, 15, 54], weight: tensor([0.1494, 0.1129, 0.0768, 0.0655, 0.1561, 0.0569, 0.0354, 0.1302, 0.1095,
        0.1073])
[rfa agg] iter:  0, prev_obj_val: 28452.6171875, obj_val: 19063.677734375, abs dis: 9388.939453125
[rfa agg] iter: 0, weight: tensor([0.0299, 0.1289, 0.0873, 0.0744, 0.1788, 0.0646, 0.0401, 0.1488, 0.1250,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 19063.677734375, obj_val: 17138.1953125, abs dis: 1925.482421875
[rfa agg] iter: 1, weight: tensor([0.0053, 0.1323, 0.0885, 0.0751, 0.1864, 0.0650, 0.0400, 0.1538, 0.1283,
        0.1253])
[rfa agg] iter:  2, prev_obj_val: 17138.1953125, obj_val: 16796.931640625, abs dis: 341.263671875
[rfa agg] iter: 2, weight: tensor([0.0009, 0.1332, 0.0827, 0.0686, 0.2067, 0.0587, 0.0346, 0.1611, 0.1291,
        0.1245])
[rfa agg] iter:  3, prev_obj_val: 16796.931640625, obj_val: 16771.423828125, abs dis: 25.5078125
[rfa agg] iter: 3, weight: tensor([9.4364e-05, 9.6983e-02, 4.0188e-02, 3.0224e-02, 4.5447e-01, 2.4782e-02,
        1.2569e-02, 1.6375e-01, 9.3516e-02, 8.3421e-02])
[rfa agg] iter:  4, prev_obj_val: 16771.423828125, obj_val: 16770.6875, abs dis: 0.736328125
[rfa agg] iter: 4, weight: tensor([5.4065e-05, 1.7803e-01, 4.2585e-02, 2.9177e-02, 1.3744e-01, 2.3056e-02,
        1.0491e-02, 2.7791e-01, 1.6221e-01, 1.3904e-01])
[rfa agg] iter:  5, prev_obj_val: 16770.6875, obj_val: 16773.95703125, abs dis: 3.26953125
[rfa agg] iter: 5, weight: tensor([4.5363e-05, 2.3719e-01, 4.7248e-02, 3.0406e-02, 8.1674e-02, 2.3545e-02,
        1.0121e-02, 1.4757e-01, 2.0701e-01, 2.1519e-01])
[rfa agg] iter:  6, prev_obj_val: 16773.95703125, obj_val: 16779.81640625, abs dis: 5.859375
[rfa agg] iter: 6, weight: tensor([4.8688e-05, 2.0612e-01, 6.6199e-02, 3.9728e-02, 7.2829e-02, 3.0084e-02,
        1.2210e-02, 1.0977e-01, 1.8392e-01, 2.7909e-01])
[rfa agg] iter:  7, prev_obj_val: 16779.81640625, obj_val: 16777.6953125, abs dis: 2.12109375
[rfa agg] iter: 7, weight: tensor([6.2193e-05, 1.7043e-01, 1.2047e-01, 6.4780e-02, 7.9708e-02, 4.7436e-02,
        1.7802e-02, 1.0816e-01, 1.5900e-01, 2.3216e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 11.9197, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 12.9313, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.35468912124634 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0617, Accuracy: 290/807 (35.9356%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0335, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7748, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0551, Accuracy: 399/1715 (23.2653%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 709/1715 (41.3411%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2994, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0767, Accuracy: 83/426 (19.4836%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0450, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9698, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0783, Accuracy: 86/631 (13.6292%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0450, Accuracy: 209/631 (33.1220%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8227, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 294/1030 (28.5437%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 594/1030 (57.6699%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.0359, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0567, Accuracy: 401/1988 (20.1710%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0371, Accuracy: 608/1988 (30.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.8212, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0883, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0539, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4645, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0640, Accuracy: 326/1956 (16.6667%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0333, Accuracy: 588/1956 (30.0613%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.6912, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0553, Accuracy: 411/1953 (21.0445%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2329, Accuracy: 118/10000 (1.1800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0539, Accuracy: 336/1574 (21.3469%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 621/1574 (39.4536%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.8638, Accuracy: 97/10000 (0.9700%)
time spent on training: 189.27080988883972
[rfa agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.039205722939582334
[rfa agg] init. name: [20, 92, 67, 48, 91, 85, 76, 6, 83, 17], weight: tensor([0.0643, 0.1367, 0.0340, 0.0503, 0.0821, 0.1585, 0.0371, 0.1559, 0.1557,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 73.06739044189453, obj_val: 71.09565734863281, abs dis: 1.9717330932617188
[rfa agg] iter: 0, weight: tensor([0.0452, 0.1820, 0.0147, 0.0270, 0.0946, 0.1093, 0.0172, 0.1214, 0.1209,
        0.2677])
[rfa agg] iter:  1, prev_obj_val: 71.09565734863281, obj_val: 67.59447479248047, abs dis: 3.5011825561523438
[rfa agg] iter: 1, weight: tensor([0.0395, 0.1857, 0.0131, 0.0238, 0.0806, 0.1051, 0.0153, 0.1179, 0.1175,
        0.3017])
[rfa agg] iter:  2, prev_obj_val: 67.59447479248047, obj_val: 69.28865814208984, abs dis: 1.694183349609375
[rfa agg] iter: 2, weight: tensor([0.0304, 0.1921, 0.0104, 0.0187, 0.0591, 0.0987, 0.0121, 0.1128, 0.1123,
        0.3535])
[rfa agg] iter:  3, prev_obj_val: 69.28865814208984, obj_val: 67.58213806152344, abs dis: 1.7065200805664062
[rfa agg] iter: 3, weight: tensor([0.0342, 0.1865, 0.0115, 0.0209, 0.0679, 0.1006, 0.0134, 0.1138, 0.1133,
        0.3379])
[rfa agg] iter:  4, prev_obj_val: 67.58213806152344, obj_val: 69.28964233398438, abs dis: 1.7075042724609375
[rfa agg] iter: 4, weight: tensor([0.0300, 0.1897, 0.0103, 0.0185, 0.0583, 0.0975, 0.0120, 0.1114, 0.1109,
        0.3615])
[rfa agg] iter:  5, prev_obj_val: 69.28964233398438, obj_val: 67.58190155029297, abs dis: 1.7077407836914062
[rfa agg] iter: 5, weight: tensor([0.0341, 0.1859, 0.0115, 0.0208, 0.0678, 0.1004, 0.0134, 0.1136, 0.1131,
        0.3394])
[rfa agg] iter:  6, prev_obj_val: 67.58190155029297, obj_val: 69.28970336914062, abs dis: 1.7078018188476562
[rfa agg] iter: 6, weight: tensor([0.0300, 0.1895, 0.0103, 0.0185, 0.0583, 0.0975, 0.0120, 0.1113, 0.1108,
        0.3619])
[rfa agg] iter:  7, prev_obj_val: 69.28970336914062, obj_val: 67.58187866210938, abs dis: 1.70782470703125
[rfa agg] iter: 7, weight: tensor([0.0341, 0.1859, 0.0115, 0.0208, 0.0678, 0.1004, 0.0134, 0.1136, 0.1131,
        0.3395])
[rfa agg] iter:  8, prev_obj_val: 67.58187866210938, obj_val: 69.2896957397461, abs dis: 1.7078170776367188
[rfa agg] iter: 8, weight: tensor([0.0300, 0.1895, 0.0103, 0.0185, 0.0583, 0.0975, 0.0120, 0.1113, 0.1108,
        0.3619])
[rfa agg] iter:  9, prev_obj_val: 69.2896957397461, obj_val: 67.5818862915039, abs dis: 1.7078094482421875
[rfa agg] iter: 9, weight: tensor([0.0341, 0.1859, 0.0115, 0.0208, 0.0678, 0.1004, 0.0134, 0.1136, 0.1131,
        0.3395])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.5882, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 11.4796, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.7344753742218 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0647, Accuracy: 228/712 (32.0225%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.2863, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0556, Accuracy: 321/803 (39.9751%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0326, Accuracy: 425/803 (52.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9750, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0513, Accuracy: 236/813 (29.0283%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0199, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 13.1670, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0610, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0325, Accuracy: 409/1131 (36.1627%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.3289, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0563, Accuracy: 265/599 (44.2404%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0313, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 13.1690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0652, Accuracy: 132/568 (23.2394%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5838, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0589, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 599/1475 (40.6102%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2289, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0537, Accuracy: 542/2227 (24.3377%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 939/2227 (42.1643%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.7792, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0605, Accuracy: 245/1154 (21.2305%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0275, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.3110, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 229/590 (38.8136%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0284, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.3761, Accuracy: 50/10000 (0.5000%)
time spent on training: 165.46861791610718
[rfa agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 58, 53, 87, 95, 62, 65, 60, 57, 69], weight: tensor([0.0707, 0.0797, 0.0807, 0.1123, 0.0595, 0.0564, 0.1464, 0.2211, 0.1146,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 71.23563385009766, obj_val: 72.51289367675781, abs dis: 1.2772598266601562
[rfa agg] iter: 0, weight: tensor([0.0474, 0.0625, 0.0632, 0.2902, 0.0314, 0.0269, 0.1307, 0.0662, 0.2506,
        0.0310])
[rfa agg] iter:  1, prev_obj_val: 72.51289367675781, obj_val: 75.02526092529297, abs dis: 2.5123672485351562
[rfa agg] iter: 1, weight: tensor([0.0811, 0.1189, 0.1202, 0.2359, 0.0479, 0.0393, 0.0888, 0.0579, 0.1628,
        0.0472])
[rfa agg] iter:  2, prev_obj_val: 75.02526092529297, obj_val: 78.685791015625, abs dis: 3.6605300903320312
[rfa agg] iter: 2, weight: tensor([0.1094, 0.1829, 0.1852, 0.1378, 0.0576, 0.0456, 0.0690, 0.0492, 0.1063,
        0.0569])
[rfa agg] iter:  3, prev_obj_val: 78.685791015625, obj_val: 80.50444793701172, abs dis: 1.8186569213867188
[rfa agg] iter: 3, weight: tensor([0.1364, 0.2369, 0.2376, 0.0750, 0.0625, 0.0467, 0.0455, 0.0348, 0.0624,
        0.0623])
[rfa agg] iter:  4, prev_obj_val: 80.50444793701172, obj_val: 85.27802276611328, abs dis: 4.7735748291015625
[rfa agg] iter: 4, weight: tensor([0.1565, 0.2260, 0.2260, 0.0664, 0.0708, 0.0516, 0.0423, 0.0331, 0.0562,
        0.0710])
[rfa agg] iter:  5, prev_obj_val: 85.27802276611328, obj_val: 80.52375793457031, abs dis: 4.754264831542969
[rfa agg] iter: 5, weight: tensor([0.1777, 0.1617, 0.1627, 0.0631, 0.1113, 0.0765, 0.0434, 0.0352, 0.0549,
        0.1136])
[rfa agg] iter:  6, prev_obj_val: 80.52375793457031, obj_val: 85.2729721069336, abs dis: 4.749214172363281
[rfa agg] iter: 6, weight: tensor([0.1666, 0.2180, 0.2160, 0.0672, 0.0730, 0.0526, 0.0429, 0.0336, 0.0569,
        0.0731])
[rfa agg] iter:  7, prev_obj_val: 85.2729721069336, obj_val: 80.5241470336914, abs dis: 4.7488250732421875
[rfa agg] iter: 7, weight: tensor([0.1796, 0.1610, 0.1618, 0.0630, 0.1113, 0.0764, 0.0433, 0.0352, 0.0548,
        0.1135])
[rfa agg] iter:  8, prev_obj_val: 80.5241470336914, obj_val: 82.74022674560547, abs dis: 2.2160797119140625
[rfa agg] iter: 8, weight: tensor([0.1670, 0.2178, 0.2158, 0.0672, 0.0730, 0.0526, 0.0429, 0.0336, 0.0569,
        0.0731])
[rfa agg] iter:  9, prev_obj_val: 82.74022674560547, obj_val: 85.25923919677734, abs dis: 2.519012451171875
[rfa agg] iter: 9, weight: tensor([0.1812, 0.1911, 0.1913, 0.0645, 0.0882, 0.0623, 0.0428, 0.0341, 0.0554,
        0.0890])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1179, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 12.7611, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.6655385494232 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0814, Accuracy: 68/631 (10.7765%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0454, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3468, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 324/1030 (31.4563%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 614/1030 (59.6117%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.9645, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 244/1402 (17.4037%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 358/1402 (25.5350%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4683, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0660, Accuracy: 266/946 (28.1184%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 356/946 (37.6321%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5899, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0659, Accuracy: 253/715 (35.3846%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0424, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6540, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0634, Accuracy: 326/1657 (19.6741%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0362, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.7089, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 322/1645 (19.5745%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0338, Accuracy: 552/1645 (33.5562%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.9998, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 307/896 (34.2634%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0349, Accuracy: 450/896 (50.2232%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7922, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0780, Accuracy: 134/773 (17.3351%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0365, Accuracy: 364/773 (47.0893%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.7318, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 234/590 (39.6610%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.8704, Accuracy: 50/10000 (0.5000%)
time spent on training: 170.12318062782288
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 91, 66, 43, 23, 0, 13, 89, 99, 69], weight: tensor([0.0614, 0.1001, 0.1363, 0.0920, 0.0695, 0.1611, 0.1599, 0.0871, 0.0752,
        0.0574])
[rfa agg] iter:  0, prev_obj_val: 54.058719635009766, obj_val: 58.10529708862305, abs dis: 4.046577453613281
[rfa agg] iter: 0, weight: tensor([0.0419, 0.1748, 0.0909, 0.2144, 0.0678, 0.0667, 0.0661, 0.1466, 0.0916,
        0.0391])
[rfa agg] iter:  1, prev_obj_val: 58.10529708862305, obj_val: 59.88062286376953, abs dis: 1.7753257751464844
[rfa agg] iter: 1, weight: tensor([0.0509, 0.0976, 0.0579, 0.2001, 0.0963, 0.0466, 0.0461, 0.2209, 0.1362,
        0.0474])
[rfa agg] iter:  2, prev_obj_val: 59.88062286376953, obj_val: 62.05241012573242, abs dis: 2.1717872619628906
[rfa agg] iter: 2, weight: tensor([0.0569, 0.0844, 0.0541, 0.1645, 0.1138, 0.0443, 0.0438, 0.2265, 0.1588,
        0.0531])
[rfa agg] iter:  3, prev_obj_val: 62.05241012573242, obj_val: 62.042964935302734, abs dis: 0.0094451904296875
[rfa agg] iter: 3, weight: tensor([0.0670, 0.0786, 0.0528, 0.1388, 0.1398, 0.0439, 0.0435, 0.1968, 0.1763,
        0.0625])
[rfa agg] iter:  4, prev_obj_val: 62.042964935302734, obj_val: 62.04277038574219, abs dis: 0.000194549560546875
[rfa agg] iter: 4, weight: tensor([0.0670, 0.0783, 0.0527, 0.1373, 0.1429, 0.0438, 0.0434, 0.1917, 0.1801,
        0.0626])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.0893, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 12.1816, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.6414518356323 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0548, Accuracy: 395/1440 (27.4306%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0291, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.8302, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 58/460 (12.6087%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0382, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.8253, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0594, Accuracy: 304/1662 (18.2912%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 604/1662 (36.3418%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5865, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0637, Accuracy: 360/1657 (21.7260%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0368, Accuracy: 488/1657 (29.4508%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4088, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0549, Accuracy: 520/2227 (23.3498%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 958/2227 (43.0175%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.2302, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0561, Accuracy: 332/1949 (17.0344%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0344, Accuracy: 573/1949 (29.3997%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9664, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0456, Accuracy: 144/373 (38.6059%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.6873, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0773, Accuracy: 75/426 (17.6056%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0435, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2541, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.1012, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0703, Accuracy: 88/311 (28.2958%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.1220, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0779, Accuracy: 50/486 (10.2881%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0398, Accuracy: 237/486 (48.7654%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.9854, Accuracy: 62/10000 (0.6200%)
time spent on training: 180.7877175807953
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 31, 94, 0, 60, 21, 98, 67, 96, 30], weight: tensor([0.1310, 0.0419, 0.1512, 0.1508, 0.2026, 0.1773, 0.0339, 0.0388, 0.0283,
        0.0442])
[rfa agg] iter:  0, prev_obj_val: 78.57241821289062, obj_val: 73.86011505126953, abs dis: 4.712303161621094
[rfa agg] iter: 0, weight: tensor([0.3578, 0.0166, 0.1897, 0.1891, 0.0862, 0.1077, 0.0118, 0.0143, 0.0092,
        0.0176])
[rfa agg] iter:  1, prev_obj_val: 73.86011505126953, obj_val: 72.03695678710938, abs dis: 1.8231582641601562
[rfa agg] iter: 1, weight: tensor([0.4179, 0.0120, 0.1847, 0.1829, 0.0717, 0.0925, 0.0085, 0.0104, 0.0067,
        0.0127])
[rfa agg] iter:  2, prev_obj_val: 72.03695678710938, obj_val: 72.03353881835938, abs dis: 0.00341796875
[rfa agg] iter: 2, weight: tensor([0.4009, 0.0110, 0.1963, 0.1935, 0.0705, 0.0927, 0.0079, 0.0095, 0.0062,
        0.0116])
[rfa agg] iter:  3, prev_obj_val: 72.03353881835938, obj_val: 72.03307342529297, abs dis: 0.00046539306640625
[rfa agg] iter: 3, weight: tensor([0.3929, 0.0111, 0.1993, 0.1965, 0.0712, 0.0935, 0.0079, 0.0096, 0.0062,
        0.0117])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.0112, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 14.2774, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.9870095252991 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0596, Accuracy: 268/1446 (18.5339%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7434, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0825, Accuracy: 95/669 (14.2003%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0426, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8098, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0571, Accuracy: 328/1036 (31.6602%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 652/1036 (62.9344%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 13.4157, Accuracy: 67/10000 (0.6700%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 415/1574 (26.3659%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 641/1574 (40.7243%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.8523, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0709, Accuracy: 235/1190 (19.7479%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.6381, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 217/1513 (14.3424%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0375, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.3229, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0667, Accuracy: 201/677 (29.6898%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.0968, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0845, Accuracy: 40/682 (5.8651%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.2277, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0529, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/803 (53.1756%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8375, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0830, Accuracy: 49/631 (7.7655%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0453, Accuracy: 217/631 (34.3899%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0516, Accuracy: 72/10000 (0.7200%)
time spent on training: 191.2270634174347
[rfa agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[rfa agg] considering poison per batch poison_fraction: 0.04812396047353487
[rfa agg] init. name: [26, 45, 19, 17, 84, 8, 90, 80, 58, 48], weight: tensor([0.1415, 0.0655, 0.1014, 0.1540, 0.1164, 0.1480, 0.0662, 0.0667, 0.0786,
        0.0617])
[rfa agg] iter:  0, prev_obj_val: 52.92441940307617, obj_val: 56.31015396118164, abs dis: 3.3857345581054688
[rfa agg] iter: 0, weight: tensor([0.0995, 0.0550, 0.2572, 0.0849, 0.1561, 0.0913, 0.0556, 0.0563, 0.0997,
        0.0444])
[rfa agg] iter:  1, prev_obj_val: 56.31015396118164, obj_val: 60.69450759887695, abs dis: 4.3843536376953125
[rfa agg] iter: 1, weight: tensor([0.0839, 0.0748, 0.1991, 0.0741, 0.1221, 0.0784, 0.0753, 0.0767, 0.1576,
        0.0581])
[rfa agg] iter:  2, prev_obj_val: 60.69450759887695, obj_val: 64.29060363769531, abs dis: 3.5960960388183594
[rfa agg] iter: 2, weight: tensor([0.0631, 0.0978, 0.1147, 0.0573, 0.0836, 0.0599, 0.0987, 0.1013, 0.2522,
        0.0712])
[rfa agg] iter:  3, prev_obj_val: 64.29060363769531, obj_val: 68.91300201416016, abs dis: 4.622398376464844
[rfa agg] iter: 3, weight: tensor([0.0500, 0.1212, 0.0797, 0.0461, 0.0630, 0.0479, 0.1251, 0.1284, 0.2552,
        0.0834])
[rfa agg] iter:  4, prev_obj_val: 68.91300201416016, obj_val: 78.48538208007812, abs dis: 9.572380065917969
[rfa agg] iter: 4, weight: tensor([0.0419, 0.1592, 0.0607, 0.0391, 0.0506, 0.0404, 0.1707, 0.1767, 0.1502,
        0.1106])
[rfa agg] iter:  5, prev_obj_val: 78.48538208007812, obj_val: 78.4626693725586, abs dis: 0.02271270751953125
[rfa agg] iter: 5, weight: tensor([0.0406, 0.1557, 0.0530, 0.0385, 0.0469, 0.0395, 0.1630, 0.1697, 0.0926,
        0.2005])
[rfa agg] iter:  6, prev_obj_val: 78.4626693725586, obj_val: 78.46195983886719, abs dis: 0.00070953369140625
[rfa agg] iter: 6, weight: tensor([0.0398, 0.1536, 0.0518, 0.0377, 0.0459, 0.0387, 0.1588, 0.1665, 0.0900,
        0.2172])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 14.7550, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 18.8581, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.04929542541504 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.1023, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0547, Accuracy: 112/338 (33.1361%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1982, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1082, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0907, Accuracy: 36/197 (18.2741%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0783, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0612, Accuracy: 207/590 (35.0847%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0280, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.6174, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1375, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1204, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0481, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0663, Accuracy: 238/1340 (17.7612%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.6846, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0644, Accuracy: 181/1071 (16.9001%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0302, Accuracy: 476/1071 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.4535, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0939, Accuracy: 15/408 (3.6765%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0570, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6934, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0782, Accuracy: 59/500 (11.8000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 209/500 (41.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6148, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0819, Accuracy: 96/669 (14.3498%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8517, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0618, Accuracy: 269/1089 (24.7016%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0292, Accuracy: 448/1089 (41.1387%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 15.9089, Accuracy: 55/10000 (0.5500%)
time spent on training: 151.65228629112244
[rfa agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 79, 69, 47, 77, 55, 36, 82, 45, 59], weight: tensor([0.0533, 0.0311, 0.0931, 0.0211, 0.2115, 0.1690, 0.0644, 0.0789, 0.1056,
        0.1719])
[rfa agg] iter:  0, prev_obj_val: 56.055877685546875, obj_val: 57.60953140258789, abs dis: 1.5536537170410156
[rfa agg] iter: 0, weight: tensor([0.0413, 0.0172, 0.2028, 0.0101, 0.1004, 0.1335, 0.0609, 0.0942, 0.2409,
        0.0988])
[rfa agg] iter:  1, prev_obj_val: 57.60953140258789, obj_val: 60.7065544128418, abs dis: 3.0970230102539062
[rfa agg] iter: 1, weight: tensor([0.0405, 0.0159, 0.2771, 0.0092, 0.0739, 0.0937, 0.0628, 0.1040, 0.2517,
        0.0710])
[rfa agg] iter:  2, prev_obj_val: 60.7065544128418, obj_val: 60.67273712158203, abs dis: 0.033817291259765625
[rfa agg] iter: 2, weight: tensor([0.0486, 0.0177, 0.3001, 0.0100, 0.0660, 0.0797, 0.0807, 0.1461, 0.1883,
        0.0628])
[rfa agg] iter:  3, prev_obj_val: 60.67273712158203, obj_val: 62.68578338623047, abs dis: 2.0130462646484375
[rfa agg] iter: 3, weight: tensor([0.0484, 0.0176, 0.3093, 0.0099, 0.0649, 0.0783, 0.0809, 0.1492, 0.1799,
        0.0616])
[rfa agg] iter:  4, prev_obj_val: 62.68578338623047, obj_val: 62.66817092895508, abs dis: 0.017612457275390625
[rfa agg] iter: 4, weight: tensor([0.0569, 0.0197, 0.2555, 0.0110, 0.0653, 0.0773, 0.0994, 0.1934, 0.1595,
        0.0620])
[rfa agg] iter:  5, prev_obj_val: 62.66817092895508, obj_val: 64.87397766113281, abs dis: 2.2058067321777344
[rfa agg] iter: 5, weight: tensor([0.0575, 0.0199, 0.2464, 0.0110, 0.0652, 0.0772, 0.1009, 0.2021, 0.1581,
        0.0618])
[rfa agg] iter:  6, prev_obj_val: 64.87397766113281, obj_val: 64.85189056396484, abs dis: 0.02208709716796875
[rfa agg] iter: 6, weight: tensor([0.0656, 0.0215, 0.1942, 0.0117, 0.0629, 0.0732, 0.1214, 0.2532, 0.1365,
        0.0596])
[rfa agg] iter:  7, prev_obj_val: 64.85189056396484, obj_val: 67.27023315429688, abs dis: 2.4183425903320312
[rfa agg] iter: 7, weight: tensor([0.0654, 0.0212, 0.1860, 0.0116, 0.0617, 0.0718, 0.1221, 0.2689, 0.1329,
        0.0584])
[rfa agg] iter:  8, prev_obj_val: 67.27023315429688, obj_val: 69.96601867675781, abs dis: 2.6957855224609375
[rfa agg] iter: 8, weight: tensor([0.0739, 0.0225, 0.1483, 0.0121, 0.0582, 0.0667, 0.1461, 0.3036, 0.1136,
        0.0550])
[rfa agg] iter:  9, prev_obj_val: 69.96601867675781, obj_val: 67.25859069824219, abs dis: 2.707427978515625
[rfa agg] iter: 9, weight: tensor([0.0884, 0.0249, 0.1244, 0.0131, 0.0568, 0.0640, 0.1840, 0.2898, 0.1010,
        0.0535])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 14.2457, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 19.0392, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.18650269508362 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0581, Accuracy: 262/1130 (23.1858%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 482/1130 (42.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.9533, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0598, Accuracy: 224/712 (31.4607%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0285, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.1822, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0839, Accuracy: 6/440 (1.3636%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0499, Accuracy: 140/440 (31.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3379, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0688, Accuracy: 122/818 (14.9144%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.2463, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 311/1645 (18.9058%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 568/1645 (34.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7003, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.1004, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0556, Accuracy: 105/312 (33.6538%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6999, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0785, Accuracy: 57/631 (9.0333%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0438, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0920, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 43/486 (8.8477%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0431, Accuracy: 224/486 (46.0905%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.3339, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 61/466 (13.0901%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0552, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1891, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0628, Accuracy: 193/1071 (18.0205%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 494/1071 (46.1251%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.5614, Accuracy: 71/10000 (0.7100%)
time spent on training: 166.3479254245758
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 11, 49, 71, 13, 24, 48, 30, 76, 55], weight: tensor([0.1465, 0.0923, 0.0571, 0.1061, 0.2133, 0.0405, 0.0818, 0.0630, 0.0604,
        0.1389])
[rfa agg] iter:  0, prev_obj_val: 55.07597351074219, obj_val: 59.60249710083008, abs dis: 4.526523590087891
[rfa agg] iter: 0, weight: tensor([0.1061, 0.1965, 0.0353, 0.2716, 0.0631, 0.0185, 0.0961, 0.0467, 0.0446,
        0.1215])
[rfa agg] iter:  1, prev_obj_val: 59.60249710083008, obj_val: 63.27891159057617, abs dis: 3.6764144897460938
[rfa agg] iter: 1, weight: tensor([0.0772, 0.2147, 0.0496, 0.1738, 0.0540, 0.0233, 0.1842, 0.0711, 0.0676,
        0.0843])
[rfa agg] iter:  2, prev_obj_val: 63.27891159057617, obj_val: 65.41790771484375, abs dis: 2.138996124267578
[rfa agg] iter: 2, weight: tensor([0.0673, 0.1471, 0.0630, 0.1218, 0.0501, 0.0270, 0.2624, 0.0974, 0.0916,
        0.0722])
[rfa agg] iter:  3, prev_obj_val: 65.41790771484375, obj_val: 67.84495544433594, abs dis: 2.4270477294921875
[rfa agg] iter: 3, weight: tensor([0.0625, 0.1193, 0.0725, 0.1037, 0.0478, 0.0292, 0.2695, 0.1186, 0.1105,
        0.0665])
[rfa agg] iter:  4, prev_obj_val: 67.84495544433594, obj_val: 65.41680145263672, abs dis: 2.4281539916992188
[rfa agg] iter: 4, weight: tensor([0.0602, 0.1044, 0.0873, 0.0937, 0.0472, 0.0327, 0.2212, 0.1510, 0.1387,
        0.0637])
[rfa agg] iter:  5, prev_obj_val: 65.41680145263672, obj_val: 67.84059143066406, abs dis: 2.4237899780273438
[rfa agg] iter: 5, weight: tensor([0.0621, 0.1165, 0.0741, 0.1022, 0.0476, 0.0295, 0.2628, 0.1240, 0.1153,
        0.0660])
[rfa agg] iter:  6, prev_obj_val: 67.84059143066406, obj_val: 65.41734313964844, abs dis: 2.423248291015625
[rfa agg] iter: 6, weight: tensor([0.0601, 0.1041, 0.0874, 0.0935, 0.0472, 0.0327, 0.2202, 0.1518, 0.1394,
        0.0636])
[rfa agg] iter:  7, prev_obj_val: 65.41734313964844, obj_val: 67.84053039550781, abs dis: 2.423187255859375
[rfa agg] iter: 7, weight: tensor([0.0621, 0.1165, 0.0741, 0.1022, 0.0476, 0.0295, 0.2626, 0.1241, 0.1154,
        0.0660])
[rfa agg] iter:  8, prev_obj_val: 67.84053039550781, obj_val: 65.41734313964844, abs dis: 2.423187255859375
[rfa agg] iter: 8, weight: tensor([0.0601, 0.1041, 0.0874, 0.0935, 0.0472, 0.0327, 0.2202, 0.1518, 0.1394,
        0.0636])
[rfa agg] iter:  9, prev_obj_val: 65.41734313964844, obj_val: 67.84053039550781, abs dis: 2.423187255859375
[rfa agg] iter: 9, weight: tensor([0.0621, 0.1165, 0.0741, 0.1022, 0.0476, 0.0295, 0.2626, 0.1241, 0.1154,
        0.0660])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 13.8957, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 18.1085, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.5946180820465 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0565, Accuracy: 340/803 (42.3412%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8645, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0598, Accuracy: 220/712 (30.8989%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.8207, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0655, Accuracy: 226/928 (24.3534%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.3805, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0646, Accuracy: 247/1402 (17.6177%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 360/1402 (25.6776%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4167, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0765, Accuracy: 57/631 (9.0333%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0421, Accuracy: 243/631 (38.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7822, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0708, Accuracy: 115/818 (14.0587%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0320, Accuracy: 333/818 (40.7090%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.4686, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0861, Accuracy: 40/515 (7.7670%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0567, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.9541, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.1020, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0577, Accuracy: 101/338 (29.8817%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4207, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0706, Accuracy: 214/719 (29.7636%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0373, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.4759, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0664, Accuracy: 317/1956 (16.2065%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0343, Accuracy: 557/1956 (28.4765%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.9797, Accuracy: 94/10000 (0.9400%)
time spent on training: 173.8581268787384
[rfa agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 11, 1, 66, 48, 71, 33, 12, 41, 6], weight: tensor([0.0910, 0.0807, 0.1052, 0.1589, 0.0715, 0.0927, 0.0584, 0.0383, 0.0815,
        0.2217])
[rfa agg] iter:  0, prev_obj_val: 63.39200973510742, obj_val: 65.04713439941406, abs dis: 1.6551246643066406
[rfa agg] iter: 0, weight: tensor([0.1625, 0.0997, 0.2217, 0.0920, 0.0574, 0.1518, 0.0393, 0.0174, 0.0996,
        0.0585])
[rfa agg] iter:  1, prev_obj_val: 65.04713439941406, obj_val: 68.73648834228516, abs dis: 3.6893539428710938
[rfa agg] iter: 1, weight: tensor([0.2129, 0.1473, 0.1044, 0.0488, 0.0714, 0.1748, 0.0438, 0.0166, 0.1444,
        0.0357])
[rfa agg] iter:  2, prev_obj_val: 68.73648834228516, obj_val: 68.71109771728516, abs dis: 0.025390625
[rfa agg] iter: 2, weight: tensor([0.1597, 0.1715, 0.0848, 0.0477, 0.1069, 0.1459, 0.0606, 0.0208, 0.1654,
        0.0366])
[rfa agg] iter:  3, prev_obj_val: 68.71109771728516, obj_val: 66.57318115234375, abs dis: 2.1379165649414062
[rfa agg] iter: 3, weight: tensor([0.1554, 0.1743, 0.0837, 0.0474, 0.1092, 0.1431, 0.0609, 0.0207, 0.1689,
        0.0363])
[rfa agg] iter:  4, prev_obj_val: 66.57318115234375, obj_val: 68.71588897705078, abs dis: 2.1427078247070312
[rfa agg] iter: 4, weight: tensor([0.1793, 0.1730, 0.0872, 0.0463, 0.0864, 0.1577, 0.0501, 0.0179, 0.1672,
        0.0348])
[rfa agg] iter:  5, prev_obj_val: 68.71588897705078, obj_val: 66.57258605957031, abs dis: 2.1433029174804688
[rfa agg] iter: 5, weight: tensor([0.1565, 0.1746, 0.0838, 0.0474, 0.1076, 0.1439, 0.0605, 0.0207, 0.1685,
        0.0363])
[rfa agg] iter:  6, prev_obj_val: 66.57258605957031, obj_val: 68.71592712402344, abs dis: 2.143341064453125
[rfa agg] iter: 6, weight: tensor([0.1794, 0.1731, 0.0872, 0.0463, 0.0864, 0.1578, 0.0501, 0.0179, 0.1670,
        0.0348])
[rfa agg] iter:  7, prev_obj_val: 68.71592712402344, obj_val: 66.57258605957031, abs dis: 2.143341064453125
[rfa agg] iter: 7, weight: tensor([0.1565, 0.1746, 0.0838, 0.0474, 0.1076, 0.1439, 0.0605, 0.0207, 0.1685,
        0.0363])
[rfa agg] iter:  8, prev_obj_val: 66.57258605957031, obj_val: 68.71592712402344, abs dis: 2.143341064453125
[rfa agg] iter: 8, weight: tensor([0.1794, 0.1731, 0.0872, 0.0463, 0.0864, 0.1578, 0.0501, 0.0179, 0.1670,
        0.0348])
[rfa agg] iter:  9, prev_obj_val: 68.71592712402344, obj_val: 66.57258605957031, abs dis: 2.143341064453125
[rfa agg] iter: 9, weight: tensor([0.1565, 0.1746, 0.0838, 0.0474, 0.1076, 0.1439, 0.0605, 0.0207, 0.1685,
        0.0363])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 15.0802, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 15.9445, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.00602769851685 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0556, Accuracy: 236/712 (33.1461%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0297, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.7953, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0533, Accuracy: 560/2227 (25.1459%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 976/2227 (43.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7170, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0660, Accuracy: 253/946 (26.7442%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0375, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0400, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0877, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0545, Accuracy: 179/466 (38.4120%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9215, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0636, Accuracy: 233/1372 (16.9825%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0343, Accuracy: 444/1372 (32.3615%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0145, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 205/1049 (19.5424%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 491/1049 (46.8065%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.5261, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0862, Accuracy: 51/515 (9.9029%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0552, Accuracy: 145/515 (28.1553%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8171, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0554, Accuracy: 295/1030 (28.6408%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 597/1030 (57.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.0022, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0634, Accuracy: 304/1418 (21.4386%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 630/1418 (44.4288%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7731, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0637, Accuracy: 151/861 (17.5377%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 438/861 (50.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.2925, Accuracy: 86/10000 (0.8600%)
time spent on training: 189.32394814491272
[rfa agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 60, 43, 76, 42, 51, 33, 91, 70, 10], weight: tensor([0.0672, 0.2102, 0.0893, 0.0440, 0.1295, 0.0990, 0.0486, 0.0972, 0.1338,
        0.0813])
[rfa agg] iter:  0, prev_obj_val: 66.26712799072266, obj_val: 67.69788360595703, abs dis: 1.430755615234375
[rfa agg] iter: 0, weight: tensor([0.0505, 0.0580, 0.1222, 0.0204, 0.1366, 0.2005, 0.0248, 0.1834, 0.1152,
        0.0883])
[rfa agg] iter:  1, prev_obj_val: 67.69788360595703, obj_val: 70.25989532470703, abs dis: 2.56201171875
[rfa agg] iter: 1, weight: tensor([0.0570, 0.0463, 0.1632, 0.0208, 0.0916, 0.2141, 0.0256, 0.1916, 0.0802,
        0.1095])
[rfa agg] iter:  2, prev_obj_val: 70.25989532470703, obj_val: 71.91529083251953, abs dis: 1.6553955078125
[rfa agg] iter: 2, weight: tensor([0.0694, 0.0435, 0.2134, 0.0231, 0.0777, 0.1710, 0.0288, 0.1588, 0.0696,
        0.1446])
[rfa agg] iter:  3, prev_obj_val: 71.91529083251953, obj_val: 78.67997741699219, abs dis: 6.764686584472656
[rfa agg] iter: 3, weight: tensor([0.0776, 0.0420, 0.2373, 0.0245, 0.0719, 0.1442, 0.0307, 0.1370, 0.0649,
        0.1700])
[rfa agg] iter:  4, prev_obj_val: 78.67997741699219, obj_val: 78.63622283935547, abs dis: 0.04375457763671875
[rfa agg] iter: 4, weight: tensor([0.1284, 0.0433, 0.1904, 0.0337, 0.0663, 0.1101, 0.0433, 0.1066, 0.0612,
        0.2166])
[rfa agg] iter:  5, prev_obj_val: 78.63622283935547, obj_val: 81.37432861328125, abs dis: 2.7381057739257812
[rfa agg] iter: 5, weight: tensor([0.1317, 0.0427, 0.1820, 0.0333, 0.0653, 0.1078, 0.0429, 0.1040, 0.0602,
        0.2300])
[rfa agg] iter:  6, prev_obj_val: 81.37432861328125, obj_val: 81.36885833740234, abs dis: 0.00547027587890625
[rfa agg] iter: 6, weight: tensor([0.1610, 0.0441, 0.1634, 0.0383, 0.0654, 0.1027, 0.0498, 0.0994, 0.0606,
        0.2152])
[rfa agg] iter:  7, prev_obj_val: 81.36885833740234, obj_val: 84.2894058227539, abs dis: 2.9205474853515625
[rfa agg] iter: 7, weight: tensor([0.1653, 0.0440, 0.1618, 0.0383, 0.0653, 0.1026, 0.0499, 0.0991, 0.0605,
        0.2133])
[rfa agg] iter:  8, prev_obj_val: 84.2894058227539, obj_val: 78.65764617919922, abs dis: 5.6317596435546875
[rfa agg] iter: 8, weight: tensor([0.1965, 0.0453, 0.1470, 0.0441, 0.0653, 0.0981, 0.0581, 0.0951, 0.0608,
        0.1897])
[rfa agg] iter:  9, prev_obj_val: 78.65764617919922, obj_val: 81.37247467041016, abs dis: 2.7148284912109375
[rfa agg] iter: 9, weight: tensor([0.1387, 0.0428, 0.1775, 0.0335, 0.0655, 0.1080, 0.0433, 0.1037, 0.0604,
        0.2267])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 16.2718, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 17.7573, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.98699831962585 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0674, Accuracy: 129/735 (17.5510%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.5787, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 317/803 (39.4770%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 402/803 (50.0623%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9838, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0601, Accuracy: 305/1662 (18.3514%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0345, Accuracy: 557/1662 (33.5138%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.6886, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 513/1049 (48.9037%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.0653, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.1008, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0561, Accuracy: 116/312 (37.1795%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.9336, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0669, Accuracy: 241/1340 (17.9851%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0292, Accuracy: 528/1340 (39.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.2914, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0635, Accuracy: 224/690 (32.4638%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0300, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.1219, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0587, Accuracy: 404/1904 (21.2185%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 688/1904 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1751, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0636, Accuracy: 325/1657 (19.6138%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0367, Accuracy: 466/1657 (28.1231%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4148, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0569, Accuracy: 364/1953 (18.6380%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 745/1953 (38.1464%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1633, Accuracy: 110/10000 (1.1000%)
time spent on training: 205.25928473472595
[rfa agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 58, 94, 51, 24, 77, 25, 46, 0, 83], weight: tensor([0.0607, 0.0663, 0.1373, 0.0867, 0.0258, 0.1107, 0.0570, 0.1573, 0.1369,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 65.87371063232422, obj_val: 68.46598815917969, abs dis: 2.5922775268554688
[rfa agg] iter: 0, weight: tensor([0.0380, 0.0465, 0.1445, 0.1084, 0.0090, 0.2925, 0.0321, 0.0969, 0.1424,
        0.0897])
[rfa agg] iter:  1, prev_obj_val: 68.46598815917969, obj_val: 66.97559356689453, abs dis: 1.4903945922851562
[rfa agg] iter: 1, weight: tensor([0.0425, 0.0525, 0.1230, 0.1321, 0.0096, 0.3141, 0.0354, 0.0874, 0.1219,
        0.0815])
[rfa agg] iter:  2, prev_obj_val: 66.97559356689453, obj_val: 68.45907592773438, abs dis: 1.4834823608398438
[rfa agg] iter: 2, weight: tensor([0.0382, 0.0469, 0.1259, 0.1141, 0.0088, 0.3410, 0.0321, 0.0873, 0.1247,
        0.0810])
[rfa agg] iter:  3, prev_obj_val: 68.45907592773438, obj_val: 68.45613861083984, abs dis: 0.00293731689453125
[rfa agg] iter: 3, weight: tensor([0.0418, 0.0517, 0.1206, 0.1297, 0.0094, 0.3262, 0.0349, 0.0860, 0.1196,
        0.0802])
[rfa agg] iter:  4, prev_obj_val: 68.45613861083984, obj_val: 68.4560317993164, abs dis: 0.0001068115234375
[rfa agg] iter: 4, weight: tensor([0.0420, 0.0519, 0.1211, 0.1313, 0.0095, 0.3222, 0.0351, 0.0864, 0.1201,
        0.0805])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.6759, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 13.6852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.29717659950256 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0612, Accuracy: 269/1340 (20.0746%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 588/1340 (43.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9661, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0728, Accuracy: 87/781 (11.1396%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 263/781 (33.6748%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.3338, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0672, Accuracy: 207/1131 (18.3024%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 505/1131 (44.6508%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0896, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0705, Accuracy: 212/719 (29.4854%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0337, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9628, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0558, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 434/803 (54.0473%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0522, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0638, Accuracy: 212/1241 (17.0830%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 394/1241 (31.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6272, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0856, Accuracy: 34/515 (6.6019%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0511, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7568, Accuracy: 45/10000 (0.4500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 389/1574 (24.7141%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 642/1574 (40.7878%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0089, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0628, Accuracy: 235/1131 (20.7781%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0334, Accuracy: 382/1131 (33.7754%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.6141, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0621, Accuracy: 231/1372 (16.8367%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0339, Accuracy: 447/1372 (32.5802%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4857, Accuracy: 80/10000 (0.8000%)
time spent on training: 197.48543310165405
[rfa agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.04637267841991138
[rfa agg] init. name: [77, 3, 38, 41, 58, 72, 33, 17, 87, 42], weight: tensor([0.1263, 0.0736, 0.1066, 0.0678, 0.0757, 0.1170, 0.0486, 0.1484, 0.1066,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 50.22724151611328, obj_val: 50.144134521484375, abs dis: 0.08310699462890625
[rfa agg] iter: 0, weight: tensor([0.0910, 0.1273, 0.1339, 0.0874, 0.1357, 0.1004, 0.0349, 0.0663, 0.1427,
        0.0802])
[rfa agg] iter:  1, prev_obj_val: 50.144134521484375, obj_val: 52.235862731933594, abs dis: 2.0917282104492188
[rfa agg] iter: 1, weight: tensor([0.0899, 0.1297, 0.1333, 0.0872, 0.1385, 0.0991, 0.0346, 0.0654, 0.1433,
        0.0790])
[rfa agg] iter:  2, prev_obj_val: 52.235862731933594, obj_val: 52.22853088378906, abs dis: 0.00733184814453125
[rfa agg] iter: 2, weight: tensor([0.0830, 0.1500, 0.1183, 0.0979, 0.1625, 0.0903, 0.0370, 0.0619, 0.1254,
        0.0736])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 14.2271, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 17.0853, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.315908908844 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0491, Accuracy: 337/891 (37.8227%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 468/891 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.4862, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0669, Accuracy: 218/708 (30.7910%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4814, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0615, Accuracy: 270/1446 (18.6722%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 472/1446 (32.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8930, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0590, Accuracy: 312/803 (38.8543%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 419/803 (52.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3744, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0645, Accuracy: 265/946 (28.0127%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 380/946 (40.1691%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7597, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0848, Accuracy: 34/460 (7.3913%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0388, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.3478, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0604, Accuracy: 244/1030 (23.6893%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0289, Accuracy: 582/1030 (56.5049%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.4538, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0633, Accuracy: 337/1475 (22.8475%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 649/1475 (44.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1473, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0621, Accuracy: 309/1418 (21.7913%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 610/1418 (43.0183%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.5625, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0699, Accuracy: 115/818 (14.0587%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0322, Accuracy: 333/818 (40.7090%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.4430, Accuracy: 64/10000 (0.6400%)
time spent on training: 186.8743224143982
[rfa agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 16, 26, 58, 43, 31, 91, 65, 70, 71], weight: tensor([0.0891, 0.0708, 0.1447, 0.0803, 0.0946, 0.0460, 0.1031, 0.1476, 0.1419,
        0.0818])
[rfa agg] iter:  0, prev_obj_val: 47.87515640258789, obj_val: 52.921512603759766, abs dis: 5.046356201171875
[rfa agg] iter: 0, weight: tensor([0.1404, 0.0683, 0.0717, 0.1053, 0.2096, 0.0228, 0.1460, 0.0645, 0.0695,
        0.1019])
[rfa agg] iter:  1, prev_obj_val: 52.921512603759766, obj_val: 57.77212905883789, abs dis: 4.850616455078125
[rfa agg] iter: 1, weight: tensor([0.1635, 0.0979, 0.0502, 0.1765, 0.1562, 0.0265, 0.0845, 0.0461, 0.0487,
        0.1500])
[rfa agg] iter:  2, prev_obj_val: 57.77212905883789, obj_val: 55.074954986572266, abs dis: 2.697174072265625
[rfa agg] iter: 2, weight: tensor([0.1382, 0.1308, 0.0479, 0.2018, 0.1164, 0.0333, 0.0720, 0.0443, 0.0464,
        0.1689])
[rfa agg] iter:  3, prev_obj_val: 55.074954986572266, obj_val: 55.07255554199219, abs dis: 0.002399444580078125
[rfa agg] iter: 3, weight: tensor([0.1435, 0.1152, 0.0469, 0.2088, 0.1250, 0.0285, 0.0734, 0.0432, 0.0454,
        0.1703])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 15.8967, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 17.4861, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.552960395813 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0604, Accuracy: 260/1030 (25.2427%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 602/1030 (58.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.3992, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0533, Accuracy: 332/1275 (26.0392%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 658/1275 (51.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.5275, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0990, Accuracy: 0/416 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0538, Accuracy: 163/416 (39.1827%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2066, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0736, Accuracy: 193/774 (24.9354%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0407, Accuracy: 319/774 (41.2145%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1008, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0608, Accuracy: 252/1130 (22.3009%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 499/1130 (44.1593%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.3035, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0679, Accuracy: 209/928 (22.5216%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 578/928 (62.2845%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.2551, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 223/888 (25.1126%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 426/888 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.8390, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 349/1953 (17.8699%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3678, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0662, Accuracy: 260/946 (27.4841%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 361/946 (38.1607%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2621, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0702, Accuracy: 130/953 (13.6411%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6153, Accuracy: 74/10000 (0.7400%)
time spent on training: 195.22636318206787
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 9, 78, 81, 54, 1, 63, 83, 43, 64], weight: tensor([0.1001, 0.1239, 0.0404, 0.0752, 0.1098, 0.0902, 0.0863, 0.1897, 0.0919,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 51.227272033691406, obj_val: 60.305233001708984, abs dis: 9.077960968017578
[rfa agg] iter: 0, weight: tensor([0.1005, 0.0738, 0.0157, 0.0901, 0.1014, 0.1302, 0.1331, 0.0381, 0.1517,
        0.1654])
[rfa agg] iter:  1, prev_obj_val: 60.305233001708984, obj_val: 60.262245178222656, abs dis: 0.042987823486328125
[rfa agg] iter: 1, weight: tensor([0.0807, 0.0643, 0.0239, 0.1594, 0.0790, 0.1193, 0.1670, 0.0399, 0.1311,
        0.1354])
[rfa agg] iter:  2, prev_obj_val: 60.262245178222656, obj_val: 63.52753829956055, abs dis: 3.2652931213378906
[rfa agg] iter: 2, weight: tensor([0.0788, 0.0633, 0.0236, 0.1706, 0.0777, 0.1168, 0.1697, 0.0393, 0.1288,
        0.1315])
[rfa agg] iter:  3, prev_obj_val: 63.52753829956055, obj_val: 63.52618408203125, abs dis: 0.001354217529296875
[rfa agg] iter: 3, weight: tensor([0.0795, 0.0654, 0.0280, 0.1818, 0.0785, 0.1141, 0.1614, 0.0421, 0.1237,
        0.1257])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 17.4104, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 19.0474, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 294.0712113380432 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 243/1190 (20.4202%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 416/1190 (34.9580%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.9232, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0964, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0540, Accuracy: 111/312 (35.5769%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.6523, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 315/896 (35.1562%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0765, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0534, Accuracy: 348/1129 (30.8237%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 710/1129 (62.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.8206, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0503, Accuracy: 410/1552 (26.4175%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 705/1552 (45.4253%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.4515, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0656, Accuracy: 328/1750 (18.7429%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0373, Accuracy: 626/1750 (35.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8154, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0611, Accuracy: 261/807 (32.3420%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0352, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0837, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0764, Accuracy: 93/809 (11.4957%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 310/809 (38.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.5627, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0619, Accuracy: 262/1154 (22.7036%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.8907, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 63/781 (8.0666%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 259/781 (33.1626%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.9337, Accuracy: 77/10000 (0.7700%)
time spent on training: 195.52578926086426
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 24, 89, 37, 74, 44, 20, 50, 15, 3], weight: tensor([0.1146, 0.0301, 0.0863, 0.1088, 0.1495, 0.1686, 0.0777, 0.0779, 0.1112,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 52.5436897277832, obj_val: 54.36479187011719, abs dis: 1.8211021423339844
[rfa agg] iter: 0, weight: tensor([0.1524, 0.0107, 0.1083, 0.2071, 0.0800, 0.0668, 0.0781, 0.0807, 0.1404,
        0.0754])
[rfa agg] iter:  1, prev_obj_val: 54.36479187011719, obj_val: 58.696807861328125, abs dis: 4.3320159912109375
[rfa agg] iter: 1, weight: tensor([0.1300, 0.0115, 0.1399, 0.1756, 0.0710, 0.0609, 0.0959, 0.1011, 0.1208,
        0.0933])
[rfa agg] iter:  2, prev_obj_val: 58.696807861328125, obj_val: 62.690643310546875, abs dis: 3.99383544921875
[rfa agg] iter: 2, weight: tensor([0.0901, 0.0121, 0.1913, 0.1106, 0.0564, 0.0499, 0.1306, 0.1463, 0.0852,
        0.1274])
[rfa agg] iter:  3, prev_obj_val: 62.690643310546875, obj_val: 65.2695083618164, abs dis: 2.5788650512695312
[rfa agg] iter: 3, weight: tensor([0.0690, 0.0121, 0.1887, 0.0806, 0.0468, 0.0421, 0.1561, 0.1886, 0.0656,
        0.1505])
[rfa agg] iter:  4, prev_obj_val: 65.2695083618164, obj_val: 62.65799331665039, abs dis: 2.6115150451660156
[rfa agg] iter: 4, weight: tensor([0.0634, 0.0127, 0.1671, 0.0728, 0.0445, 0.0404, 0.1684, 0.2105, 0.0605,
        0.1597])
[rfa agg] iter:  5, prev_obj_val: 62.65799331665039, obj_val: 62.655494689941406, abs dis: 0.002498626708984375
[rfa agg] iter: 5, weight: tensor([0.0666, 0.0118, 0.1804, 0.0779, 0.0456, 0.0411, 0.1616, 0.1994, 0.0635,
        0.1521])
[rfa agg] iter:  6, prev_obj_val: 62.655494689941406, obj_val: 62.65541458129883, abs dis: 8.0108642578125e-05
[rfa agg] iter: 6, weight: tensor([0.0669, 0.0118, 0.1836, 0.0782, 0.0457, 0.0412, 0.1604, 0.1972, 0.0637,
        0.1514])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 15.2779, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 16.9555, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 291.06863594055176 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0635, Accuracy: 242/1372 (17.6385%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 475/1372 (34.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.5310, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0649, Accuracy: 219/1402 (15.6205%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0404, Accuracy: 345/1402 (24.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2361, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 295/1089 (27.0891%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0302, Accuracy: 467/1089 (42.8834%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3619, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0813, Accuracy: 43/460 (9.3478%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0412, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.1456, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0647, Accuracy: 326/1750 (18.6286%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0380, Accuracy: 620/1750 (35.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8463, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0630, Accuracy: 350/1742 (20.0918%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0329, Accuracy: 643/1742 (36.9116%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8832, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 187/1013 (18.4600%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8825, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 351/1129 (31.0895%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 706/1129 (62.5332%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.0288, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0834, Accuracy: 38/515 (7.3786%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0593, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.3245, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0540, Accuracy: 371/1440 (25.7639%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0296, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3581, Accuracy: 80/10000 (0.8000%)
time spent on training: 217.98652124404907
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 66, 59, 31, 44, 93, 14, 37, 33, 29], weight: tensor([0.1152, 0.1177, 0.0914, 0.0386, 0.1469, 0.1462, 0.0850, 0.0948, 0.0432,
        0.1209])
[rfa agg] iter:  0, prev_obj_val: 51.942237854003906, obj_val: 53.292869567871094, abs dis: 1.3506317138671875
[rfa agg] iter: 0, weight: tensor([0.1599, 0.1547, 0.1095, 0.0153, 0.0764, 0.0776, 0.0978, 0.1575, 0.0186,
        0.1327])
[rfa agg] iter:  1, prev_obj_val: 53.292869567871094, obj_val: 53.28464126586914, abs dis: 0.008228302001953125
[rfa agg] iter: 1, weight: tensor([0.1460, 0.1427, 0.1162, 0.0160, 0.0721, 0.0734, 0.1095, 0.1824, 0.0196,
        0.1220])
[rfa agg] iter:  2, prev_obj_val: 53.28464126586914, obj_val: 53.28449249267578, abs dis: 0.000148773193359375
[rfa agg] iter: 2, weight: tensor([0.1447, 0.1413, 0.1166, 0.0160, 0.0718, 0.0731, 0.1094, 0.1865, 0.0195,
        0.1212])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 17.7539, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 22.0191, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 316.10850644111633 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0586, Accuracy: 317/896 (35.3795%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1076, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0613, Accuracy: 249/1340 (18.5821%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.9848, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0542, Accuracy: 393/1440 (27.2917%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0291, Accuracy: 697/1440 (48.4028%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.2806, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 216/776 (27.8351%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.3562, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0600, Accuracy: 302/1662 (18.1709%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 593/1662 (35.6799%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0193, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0709, Accuracy: 68/781 (8.7068%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 248/781 (31.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.5742, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0659, Accuracy: 206/677 (30.4284%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 13.0194, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0662, Accuracy: 232/1013 (22.9023%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0302, Accuracy: 450/1013 (44.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.3466, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0848, Accuracy: 33/486 (6.7901%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 237/486 (48.7654%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.3198, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0610, Accuracy: 287/807 (35.5638%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0351, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2960, Accuracy: 71/10000 (0.7100%)
time spent on training: 192.51328444480896
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 77, 29, 75, 94, 3, 90, 39, 30, 20], weight: tensor([0.0907, 0.1357, 0.1458, 0.0786, 0.1683, 0.0791, 0.0685, 0.1026, 0.0492,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 50.760562896728516, obj_val: 54.42377853393555, abs dis: 3.6632156372070312
[rfa agg] iter: 0, weight: tensor([0.1508, 0.0954, 0.0784, 0.1044, 0.0654, 0.1059, 0.0599, 0.2078, 0.0265,
        0.1056])
[rfa agg] iter:  1, prev_obj_val: 54.42377853393555, obj_val: 64.16395568847656, abs dis: 9.740177154541016
[rfa agg] iter: 1, weight: tensor([0.1704, 0.0604, 0.0523, 0.1495, 0.0461, 0.1528, 0.0812, 0.1192, 0.0295,
        0.1386])
[rfa agg] iter:  2, prev_obj_val: 64.16395568847656, obj_val: 64.1151123046875, abs dis: 0.0488433837890625
[rfa agg] iter: 2, weight: tensor([0.1209, 0.0558, 0.0502, 0.1399, 0.0460, 0.1444, 0.1722, 0.0852, 0.0496,
        0.1358])
[rfa agg] iter:  3, prev_obj_val: 64.1151123046875, obj_val: 61.15243148803711, abs dis: 2.9626808166503906
[rfa agg] iter: 3, weight: tensor([0.1168, 0.0548, 0.0494, 0.1365, 0.0453, 0.1421, 0.1883, 0.0833, 0.0494,
        0.1342])
[rfa agg] iter:  4, prev_obj_val: 61.15243148803711, obj_val: 61.14619827270508, abs dis: 0.00623321533203125
[rfa agg] iter: 4, weight: tensor([0.1256, 0.0543, 0.0486, 0.1470, 0.0441, 0.1549, 0.1544, 0.0866, 0.0419,
        0.1426])
[rfa agg] iter:  5, prev_obj_val: 61.14619827270508, obj_val: 61.14612579345703, abs dis: 7.2479248046875e-05
[rfa agg] iter: 5, weight: tensor([0.1263, 0.0544, 0.0486, 0.1484, 0.0442, 0.1565, 0.1499, 0.0867, 0.0418,
        0.1433])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 14.3266, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 17.5616, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.8066692352295 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0933, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0539, Accuracy: 121/373 (32.4397%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1397, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0587, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.2777, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0637, Accuracy: 340/1742 (19.5178%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0331, Accuracy: 630/1742 (36.1653%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.2782, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0686, Accuracy: 80/781 (10.2433%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 232/781 (29.7055%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.0930, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0635, Accuracy: 164/1013 (16.1895%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 365/1013 (36.0316%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9581, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0823, Accuracy: 40/460 (8.6957%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0382, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.0908, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0505, Accuracy: 249/888 (28.0405%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 450/888 (50.6757%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.8789, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0646, Accuracy: 204/1154 (17.6776%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 479/1154 (41.5078%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.8783, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0908, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0625, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.4376, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0874, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0703, Accuracy: 29/186 (15.5914%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.3507, Accuracy: 51/10000 (0.5100%)
time spent on training: 174.3245460987091
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 51, 93, 3, 14, 31, 63, 57, 35, 56], weight: tensor([0.0471, 0.1325, 0.2200, 0.0986, 0.1280, 0.0581, 0.1122, 0.1458, 0.0342,
        0.0235])
[rfa agg] iter:  0, prev_obj_val: 57.346527099609375, obj_val: 60.981990814208984, abs dis: 3.6354637145996094
[rfa agg] iter: 0, weight: tensor([0.0203, 0.1655, 0.0674, 0.1432, 0.2158, 0.0323, 0.2148, 0.1203, 0.0132,
        0.0074])
[rfa agg] iter:  1, prev_obj_val: 60.981990814208984, obj_val: 60.909427642822266, abs dis: 0.07256317138671875
[rfa agg] iter: 1, weight: tensor([0.0235, 0.1248, 0.0597, 0.2072, 0.1634, 0.0395, 0.2647, 0.0940, 0.0150,
        0.0081])
[rfa agg] iter:  2, prev_obj_val: 60.909427642822266, obj_val: 62.88343811035156, abs dis: 1.9740104675292969
[rfa agg] iter: 2, weight: tensor([0.0230, 0.1194, 0.0580, 0.2171, 0.1555, 0.0385, 0.2751, 0.0909, 0.0146,
        0.0079])
[rfa agg] iter:  3, prev_obj_val: 62.88343811035156, obj_val: 62.87674331665039, abs dis: 0.006694793701171875
[rfa agg] iter: 3, weight: tensor([0.0257, 0.1145, 0.0591, 0.2409, 0.1450, 0.0440, 0.2566, 0.0893, 0.0162,
        0.0087])
[rfa agg] iter:  4, prev_obj_val: 62.87674331665039, obj_val: 62.876216888427734, abs dis: 0.00052642822265625
[rfa agg] iter: 4, weight: tensor([0.0256, 0.1139, 0.0589, 0.2489, 0.1438, 0.0440, 0.2511, 0.0890, 0.0162,
        0.0086])
[rfa agg] iter:  5, prev_obj_val: 62.876216888427734, obj_val: 65.13147735595703, abs dis: 2.255260467529297
[rfa agg] iter: 5, weight: tensor([0.0256, 0.1138, 0.0588, 0.2514, 0.1435, 0.0439, 0.2493, 0.0889, 0.0162,
        0.0086])
[rfa agg] iter:  6, prev_obj_val: 65.13147735595703, obj_val: 65.12810516357422, abs dis: 0.0033721923828125
[rfa agg] iter: 6, weight: tensor([0.0294, 0.1125, 0.0614, 0.2594, 0.1386, 0.0517, 0.2292, 0.0897, 0.0184,
        0.0097])
[rfa agg] iter:  7, prev_obj_val: 65.12810516357422, obj_val: 65.12799835205078, abs dis: 0.0001068115234375
[rfa agg] iter: 7, weight: tensor([0.0294, 0.1124, 0.0613, 0.2631, 0.1382, 0.0518, 0.2260, 0.0897, 0.0184,
        0.0097])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 16.8847, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 19.7905, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.3829245567322 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0662, Accuracy: 312/1581 (19.7343%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0362, Accuracy: 507/1581 (32.0683%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.7417, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0874, Accuracy: 36/682 (5.2786%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0412, Accuracy: 273/682 (40.0293%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.3411, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0605, Accuracy: 292/1446 (20.1936%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0358, Accuracy: 494/1446 (34.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6360, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0664, Accuracy: 203/928 (21.8750%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0251, Accuracy: 576/928 (62.0690%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.5278, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0621, Accuracy: 358/1742 (20.5511%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 642/1742 (36.8542%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9587, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0653, Accuracy: 189/1071 (17.6471%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0305, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.7649, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0590, Accuracy: 326/1645 (19.8176%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0343, Accuracy: 569/1645 (34.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.0723, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0926, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0532, Accuracy: 123/373 (32.9759%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.1601, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1461, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1367, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.7308, Accuracy: 34/10000 (0.3400%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0681, Accuracy: 199/776 (25.6443%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 366/776 (47.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.3393, Accuracy: 73/10000 (0.7300%)
time spent on training: 208.35033416748047
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 80, 26, 1, 93, 55, 13, 98, 61, 75], weight: tensor([0.1531, 0.0660, 0.1400, 0.0898, 0.1687, 0.1037, 0.1593, 0.0361, 0.0082,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 62.10253143310547, obj_val: 63.182132720947266, abs dis: 1.0796012878417969
[rfa agg] iter: 0, weight: tensor([0.1281, 0.0499, 0.1564, 0.1233, 0.0997, 0.2310, 0.1172, 0.0164, 0.0027,
        0.0752])
[rfa agg] iter:  1, prev_obj_val: 63.182132720947266, obj_val: 63.16577911376953, abs dis: 0.016353607177734375
[rfa agg] iter: 1, weight: tensor([0.1137, 0.0506, 0.1379, 0.1324, 0.0900, 0.2740, 0.1049, 0.0162, 0.0026,
        0.0777])
[rfa agg] iter:  2, prev_obj_val: 63.16577911376953, obj_val: 65.97901153564453, abs dis: 2.813232421875
[rfa agg] iter: 2, weight: tensor([0.1119, 0.0499, 0.1353, 0.1313, 0.0888, 0.2842, 0.1033, 0.0160, 0.0026,
        0.0767])
[rfa agg] iter:  3, prev_obj_val: 65.97901153564453, obj_val: 65.95787811279297, abs dis: 0.0211334228515625
[rfa agg] iter: 3, weight: tensor([0.0941, 0.0544, 0.1105, 0.1547, 0.0769, 0.3151, 0.0879, 0.0164, 0.0026,
        0.0874])
[rfa agg] iter:  4, prev_obj_val: 65.95787811279297, obj_val: 65.95690155029297, abs dis: 0.0009765625
[rfa agg] iter: 4, weight: tensor([0.0920, 0.0533, 0.1077, 0.1543, 0.0753, 0.3268, 0.0860, 0.0161, 0.0026,
        0.0858])
[rfa agg] iter:  5, prev_obj_val: 65.95690155029297, obj_val: 65.95679473876953, abs dis: 0.0001068115234375
[rfa agg] iter: 5, weight: tensor([0.0915, 0.0530, 0.1070, 0.1533, 0.0749, 0.3308, 0.0855, 0.0160, 0.0025,
        0.0852])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 47.9382, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 61.5206, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.9627592563629 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0951, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0648, Accuracy: 83/311 (26.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.7621, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0510, Accuracy: 261/813 (32.1033%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0206, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 13.3403, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0633, Accuracy: 254/1154 (22.0104%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0338, Accuracy: 416/1154 (36.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.8271, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0466, Accuracy: 428/1552 (27.5773%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0232, Accuracy: 674/1552 (43.4278%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 12.2402, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0607, Accuracy: 245/599 (40.9015%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0315, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 14.2906, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0586, Accuracy: 317/896 (35.3795%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0323, Accuracy: 460/896 (51.3393%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.3084, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0657, Accuracy: 226/1131 (19.9823%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0319, Accuracy: 473/1131 (41.8214%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.7192, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0805, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0500, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9323, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0580, Accuracy: 245/712 (34.4101%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.2520, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0648, Accuracy: 237/708 (33.4746%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0353, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0978, Accuracy: 71/10000 (0.7100%)
time spent on training: 189.19792532920837
[rfa agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 53, 15, 74, 95, 89, 38, 49, 11, 16], weight: tensor([0.0374, 0.0978, 0.1388, 0.1866, 0.0720, 0.1077, 0.1360, 0.0529, 0.0856,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 49.05864715576172, obj_val: 53.41545486450195, abs dis: 4.356807708740234
[rfa agg] iter: 0, weight: tensor([0.0148, 0.1890, 0.0910, 0.0627, 0.0613, 0.2160, 0.1090, 0.0272, 0.1163,
        0.1127])
[rfa agg] iter:  1, prev_obj_val: 53.41545486450195, obj_val: 57.923057556152344, abs dis: 4.507602691650391
[rfa agg] iter: 1, weight: tensor([0.0173, 0.1982, 0.0647, 0.0499, 0.0925, 0.1482, 0.0739, 0.0345, 0.1629,
        0.1580])
[rfa agg] iter:  2, prev_obj_val: 57.923057556152344, obj_val: 57.905372619628906, abs dis: 0.0176849365234375
[rfa agg] iter: 2, weight: tensor([0.0218, 0.1580, 0.0636, 0.0515, 0.1349, 0.1219, 0.0714, 0.0462, 0.1676,
        0.1631])
[rfa agg] iter:  3, prev_obj_val: 57.905372619628906, obj_val: 57.90525817871094, abs dis: 0.00011444091796875
[rfa agg] iter: 3, weight: tensor([0.0218, 0.1551, 0.0634, 0.0513, 0.1393, 0.1206, 0.0711, 0.0463, 0.1682,
        0.1630])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7834, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5237, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.54316568374634 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0650, Accuracy: 319/1475 (21.6271%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0335, Accuracy: 630/1475 (42.7119%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2785, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0879, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0578, Accuracy: 177/466 (37.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1415, Accuracy: 52/10000 (0.5200%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 357/1574 (22.6811%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 588/1574 (37.3571%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1139, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0692, Accuracy: 155/818 (18.9487%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0333, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.4679, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0783, Accuracy: 56/460 (12.1739%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5684, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 448/1552 (28.8660%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 722/1552 (46.5206%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.8289, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0613, Accuracy: 219/690 (31.7391%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8598, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0808, Accuracy: 31/500 (6.2000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0515, Accuracy: 196/500 (39.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8204, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0623, Accuracy: 242/1130 (21.4159%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/1130 (39.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5227, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0975, Accuracy: 3/338 (0.8876%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0516, Accuracy: 121/338 (35.7988%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.0432, Accuracy: 48/10000 (0.4800%)
time spent on training: 211.2784788608551
[rfa agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[rfa agg] considering poison per batch poison_fraction: 0.054634566255692546
[rfa agg] init. name: [65, 76, 17, 71, 31, 74, 25, 82, 54, 12], weight: tensor([0.1638, 0.0518, 0.1748, 0.0909, 0.0511, 0.1724, 0.0766, 0.0555, 0.1255,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 68.57695007324219, obj_val: 69.67311096191406, abs dis: 1.096160888671875
[rfa agg] iter: 0, weight: tensor([0.1063, 0.0436, 0.1046, 0.2069, 0.0428, 0.1022, 0.1072, 0.0467, 0.2153,
        0.0244])
[rfa agg] iter:  1, prev_obj_val: 69.67311096191406, obj_val: 73.957763671875, abs dis: 4.2846527099609375
[rfa agg] iter: 1, weight: tensor([0.0964, 0.0448, 0.0954, 0.2483, 0.0440, 0.0930, 0.1163, 0.0481, 0.1890,
        0.0247])
[rfa agg] iter:  2, prev_obj_val: 73.957763671875, obj_val: 77.57695007324219, abs dis: 3.6191864013671875
[rfa agg] iter: 2, weight: tensor([0.0740, 0.0500, 0.0738, 0.3252, 0.0489, 0.0721, 0.1543, 0.0536, 0.1221,
        0.0259])
[rfa agg] iter:  3, prev_obj_val: 77.57695007324219, obj_val: 77.55194091796875, abs dis: 0.0250091552734375
[rfa agg] iter: 3, weight: tensor([0.0661, 0.0589, 0.0662, 0.2826, 0.0574, 0.0647, 0.2125, 0.0632, 0.0996,
        0.0288])
[rfa agg] iter:  4, prev_obj_val: 77.55194091796875, obj_val: 77.5511474609375, abs dis: 0.00079345703125
[rfa agg] iter: 4, weight: tensor([0.0656, 0.0590, 0.0658, 0.2717, 0.0575, 0.0643, 0.2250, 0.0633, 0.0989,
        0.0288])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 14.2437, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 18.2139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.8057670593262 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0634, Accuracy: 257/719 (35.7441%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0357, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2050, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 327/896 (36.4955%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9119, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0797, Accuracy: 51/500 (10.2000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0518, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1053, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0679, Accuracy: 102/781 (13.0602%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 249/781 (31.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6791, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0600, Accuracy: 208/861 (24.1580%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 428/861 (49.7096%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.3423, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0621, Accuracy: 294/1036 (28.3784%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0265, Accuracy: 637/1036 (61.4865%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 13.4927, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0697, Accuracy: 201/1241 (16.1966%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0391, Accuracy: 358/1241 (28.8477%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.5464, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0571, Accuracy: 506/2227 (22.7211%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0300, Accuracy: 929/2227 (41.7153%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6418, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0607, Accuracy: 240/599 (40.0668%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0352, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 14.1138, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0667, Accuracy: 216/1131 (19.0981%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 449/1131 (39.6994%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.7563, Accuracy: 80/10000 (0.8000%)
time spent on training: 228.8428418636322
[rfa agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 89, 82, 3, 10, 19, 72, 60, 95, 38], weight: tensor([0.0720, 0.0897, 0.0500, 0.0782, 0.0862, 0.1037, 0.1242, 0.2229, 0.0600,
        0.1132])
[rfa agg] iter:  0, prev_obj_val: 65.93486022949219, obj_val: 71.15669250488281, abs dis: 5.221832275390625
[rfa agg] iter: 0, weight: tensor([0.0576, 0.1054, 0.0237, 0.0765, 0.1046, 0.2183, 0.1423, 0.0537, 0.0359,
        0.1820])
[rfa agg] iter:  1, prev_obj_val: 71.15669250488281, obj_val: 77.8062973022461, abs dis: 6.649604797363281
[rfa agg] iter: 1, weight: tensor([0.1085, 0.1694, 0.0338, 0.1469, 0.1748, 0.1060, 0.0720, 0.0408, 0.0587,
        0.0892])
[rfa agg] iter:  2, prev_obj_val: 77.8062973022461, obj_val: 83.75460052490234, abs dis: 5.94830322265625
[rfa agg] iter: 2, weight: tensor([0.1594, 0.1408, 0.0476, 0.1584, 0.1408, 0.0827, 0.0633, 0.0408, 0.0923,
        0.0738])
[rfa agg] iter:  3, prev_obj_val: 83.75460052490234, obj_val: 77.7813491821289, abs dis: 5.9732513427734375
[rfa agg] iter: 3, weight: tensor([0.1662, 0.1200, 0.0660, 0.1370, 0.1179, 0.0779, 0.0630, 0.0435, 0.1368,
        0.0716])
[rfa agg] iter:  4, prev_obj_val: 77.7813491821289, obj_val: 80.6470947265625, abs dis: 2.8657455444335938
[rfa agg] iter: 4, weight: tensor([0.1723, 0.1364, 0.0476, 0.1552, 0.1357, 0.0815, 0.0624, 0.0403, 0.0961,
        0.0725])
[rfa agg] iter:  5, prev_obj_val: 80.6470947265625, obj_val: 80.64414978027344, abs dis: 0.0029449462890625
[rfa agg] iter: 5, weight: tensor([0.1750, 0.1275, 0.0555, 0.1472, 0.1260, 0.0792, 0.0624, 0.0418, 0.1138,
        0.0717])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 18.8498, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 22.7337, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.58701634407043 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0522, Accuracy: 337/1574 (21.4104%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0288, Accuracy: 597/1574 (37.9288%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.4416, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0709, Accuracy: 193/928 (20.7974%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0259, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.8181, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0913, Accuracy: 18/486 (3.7037%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0449, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.0801, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0665, Accuracy: 235/1573 (14.9396%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0362, Accuracy: 522/1573 (33.1850%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5648, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0564, Accuracy: 367/1953 (18.7916%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 688/1953 (35.2279%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5686, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0636, Accuracy: 248/1213 (20.4452%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 546/1213 (45.0124%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.3343, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0723, Accuracy: 147/530 (27.7358%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0414, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.1302, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0709, Accuracy: 319/1163 (27.4291%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0387, Accuracy: 441/1163 (37.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8785, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0606, Accuracy: 186/861 (21.6028%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.4536, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0623, Accuracy: 293/1949 (15.0334%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0347, Accuracy: 559/1949 (28.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.0490, Accuracy: 74/10000 (0.7400%)
time spent on training: 248.069974899292
[rfa agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.040218724448078495
[rfa agg] init. name: [17, 1, 30, 40, 83, 97, 18, 68, 10, 21], weight: tensor([0.1287, 0.0759, 0.0397, 0.1286, 0.1597, 0.0992, 0.0433, 0.0951, 0.0704,
        0.1594])
[rfa agg] iter:  0, prev_obj_val: 67.61792755126953, obj_val: 72.22570037841797, abs dis: 4.6077728271484375
[rfa agg] iter: 0, weight: tensor([0.1197, 0.0799, 0.0188, 0.1181, 0.0751, 0.2299, 0.0223, 0.1964, 0.0655,
        0.0744])
[rfa agg] iter:  1, prev_obj_val: 72.22570037841797, obj_val: 70.35733032226562, abs dis: 1.8683700561523438
[rfa agg] iter: 1, weight: tensor([0.0954, 0.1019, 0.0212, 0.0946, 0.0657, 0.2423, 0.0255, 0.2048, 0.0836,
        0.0650])
[rfa agg] iter:  2, prev_obj_val: 70.35733032226562, obj_val: 70.35409545898438, abs dis: 0.00323486328125
[rfa agg] iter: 2, weight: tensor([0.0977, 0.0905, 0.0194, 0.0967, 0.0655, 0.2573, 0.0233, 0.2110, 0.0738,
        0.0648])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 27.1196, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 29.1954, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.5603528022766 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0647, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0293, Accuracy: 481/1013 (47.4827%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.7653, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0738, Accuracy: 49/631 (7.7655%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 234/631 (37.0840%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.7561, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0715, Accuracy: 200/774 (25.8398%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0396, Accuracy: 305/774 (39.4057%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3797, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 215/1049 (20.4957%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 495/1049 (47.1878%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.3932, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0480, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 449/888 (50.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.5105, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0538, Accuracy: 311/1628 (19.1032%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 700/1628 (42.9975%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.2164, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0565, Accuracy: 550/2227 (24.6969%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0305, Accuracy: 944/2227 (42.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1195, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 339/891 (38.0471%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 448/891 (50.2806%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.4445, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0652, Accuracy: 294/1418 (20.7334%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0334, Accuracy: 585/1418 (41.2553%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.5867, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0622, Accuracy: 251/719 (34.9096%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0351, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.0754, Accuracy: 64/10000 (0.6400%)
time spent on training: 229.26453161239624
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 48, 81, 51, 63, 5, 60, 7, 70, 41], weight: tensor([0.0901, 0.0561, 0.0689, 0.0933, 0.0790, 0.1449, 0.1982, 0.0793, 0.1262,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 70.72919464111328, obj_val: 72.42829132080078, abs dis: 1.6990966796875
[rfa agg] iter: 0, weight: tensor([0.1584, 0.0374, 0.0683, 0.1883, 0.0905, 0.1068, 0.0688, 0.0912, 0.1364,
        0.0538])
[rfa agg] iter:  1, prev_obj_val: 72.42829132080078, obj_val: 74.81059265136719, abs dis: 2.3823013305664062
[rfa agg] iter: 1, weight: tensor([0.2054, 0.0401, 0.0858, 0.1803, 0.1190, 0.0638, 0.0465, 0.1201, 0.0759,
        0.0629])
[rfa agg] iter:  2, prev_obj_val: 74.81059265136719, obj_val: 83.20806121826172, abs dis: 8.397468566894531
[rfa agg] iter: 2, weight: tensor([0.1858, 0.0450, 0.1049, 0.1388, 0.1438, 0.0556, 0.0423, 0.1458, 0.0640,
        0.0741])
[rfa agg] iter:  3, prev_obj_val: 83.20806121826172, obj_val: 80.5736083984375, abs dis: 2.6344528198242188
[rfa agg] iter: 3, weight: tensor([0.1140, 0.0692, 0.1558, 0.0914, 0.1536, 0.0489, 0.0398, 0.1559, 0.0540,
        0.1174])
[rfa agg] iter:  4, prev_obj_val: 80.5736083984375, obj_val: 80.57102966308594, abs dis: 0.0025787353515625
[rfa agg] iter: 4, weight: tensor([0.1188, 0.0600, 0.1541, 0.0944, 0.1615, 0.0484, 0.0388, 0.1643, 0.0539,
        0.1058])
[rfa agg] iter:  5, prev_obj_val: 80.57102966308594, obj_val: 83.13156127929688, abs dis: 2.5605316162109375
[rfa agg] iter: 5, weight: tensor([0.1188, 0.0598, 0.1530, 0.0944, 0.1628, 0.0484, 0.0387, 0.1658, 0.0538,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 83.13156127929688, obj_val: 80.57449340820312, abs dis: 2.55706787109375
[rfa agg] iter: 6, weight: tensor([0.1090, 0.0688, 0.1628, 0.0883, 0.1550, 0.0480, 0.0390, 0.1574, 0.0529,
        0.1187])
[rfa agg] iter:  7, prev_obj_val: 80.57449340820312, obj_val: 80.571044921875, abs dis: 0.003448486328125
[rfa agg] iter: 7, weight: tensor([0.1183, 0.0600, 0.1551, 0.0942, 0.1615, 0.0484, 0.0387, 0.1643, 0.0538,
        0.1057])
[rfa agg] iter:  8, prev_obj_val: 80.571044921875, obj_val: 83.13153076171875, abs dis: 2.56048583984375
[rfa agg] iter: 8, weight: tensor([0.1188, 0.0598, 0.1531, 0.0943, 0.1628, 0.0484, 0.0387, 0.1658, 0.0538,
        0.1045])
[rfa agg] iter:  9, prev_obj_val: 83.13153076171875, obj_val: 80.57450103759766, abs dis: 2.5570297241210938
[rfa agg] iter: 9, weight: tensor([0.1090, 0.0688, 0.1628, 0.0883, 0.1550, 0.0480, 0.0390, 0.1574, 0.0529,
        0.1187])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 34.7197, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 33.7572, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 325.5864293575287 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0648, Accuracy: 257/901 (28.5239%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0344, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.8269, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0915, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0733, Accuracy: 20/186 (10.7527%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3177, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0627, Accuracy: 270/1949 (13.8533%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0353, Accuracy: 562/1949 (28.8353%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.1493, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0858, Accuracy: 32/515 (6.2136%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0574, Accuracy: 146/515 (28.3495%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4376, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0555, Accuracy: 279/1089 (25.6198%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0301, Accuracy: 471/1089 (43.2507%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.7915, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0650, Accuracy: 259/719 (36.0223%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0345, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.2207, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 241/712 (33.8483%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0288, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.8257, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0696, Accuracy: 133/818 (16.2592%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0322, Accuracy: 340/818 (41.5648%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.4046, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0696, Accuracy: 304/1956 (15.5419%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 560/1956 (28.6299%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.9671, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0576, Accuracy: 353/1715 (20.5831%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0321, Accuracy: 618/1715 (36.0350%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.0573, Accuracy: 88/10000 (0.8800%)
time spent on training: 229.57990217208862
[rfa agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 56, 21, 33, 59, 41, 11, 71, 6, 92], weight: tensor([0.0853, 0.0176, 0.1846, 0.0488, 0.1031, 0.0681, 0.0674, 0.0775, 0.1852,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 81.04905700683594, obj_val: 83.97896575927734, abs dis: 2.9299087524414062
[rfa agg] iter: 0, weight: tensor([0.1282, 0.0082, 0.1262, 0.0365, 0.1794, 0.0694, 0.0700, 0.0921, 0.1274,
        0.1625])
[rfa agg] iter:  1, prev_obj_val: 83.97896575927734, obj_val: 86.04428100585938, abs dis: 2.0653152465820312
[rfa agg] iter: 1, weight: tensor([0.1655, 0.0084, 0.0981, 0.0402, 0.1879, 0.0822, 0.0837, 0.1153, 0.0990,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 86.04428100585938, obj_val: 86.02317810058594, abs dis: 0.0211029052734375
[rfa agg] iter: 2, weight: tensor([0.1906, 0.0084, 0.0858, 0.0422, 0.1679, 0.0908, 0.0932, 0.1327, 0.0865,
        0.1020])
[rfa agg] iter:  3, prev_obj_val: 86.02317810058594, obj_val: 87.23868560791016, abs dis: 1.2155075073242188
[rfa agg] iter: 3, weight: tensor([0.1963, 0.0083, 0.0853, 0.0420, 0.1633, 0.0910, 0.0932, 0.1333, 0.0860,
        0.1012])
[rfa agg] iter:  4, prev_obj_val: 87.23868560791016, obj_val: 88.57685089111328, abs dis: 1.338165283203125
[rfa agg] iter: 4, weight: tensor([0.2059, 0.0083, 0.0796, 0.0431, 0.1501, 0.0959, 0.0989, 0.1443, 0.0803,
        0.0936])
[rfa agg] iter:  5, prev_obj_val: 88.57685089111328, obj_val: 90.05839538574219, abs dis: 1.4815444946289062
[rfa agg] iter: 5, weight: tensor([0.2125, 0.0082, 0.0741, 0.0442, 0.1352, 0.1015, 0.1056, 0.1579, 0.0747,
        0.0862])
[rfa agg] iter:  6, prev_obj_val: 90.05839538574219, obj_val: 90.0517349243164, abs dis: 0.00666046142578125
[rfa agg] iter: 6, weight: tensor([0.2114, 0.0082, 0.0688, 0.0454, 0.1211, 0.1080, 0.1136, 0.1748, 0.0694,
        0.0794])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.8282, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.7185, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.2992889881134 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 314/896 (35.0446%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0926, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0884, Accuracy: 40/515 (7.7670%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0560, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6314, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0573, Accuracy: 344/1953 (17.6139%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 720/1953 (36.8664%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4604, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0555, Accuracy: 559/2227 (25.1010%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0299, Accuracy: 944/2227 (42.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.8682, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0655, Accuracy: 208/1154 (18.0243%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 13.6232, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0745, Accuracy: 100/530 (18.8679%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0413, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8493, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0640, Accuracy: 264/719 (36.7177%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0349, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4735, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0654, Accuracy: 296/1657 (17.8636%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0384, Accuracy: 484/1657 (29.2094%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.5744, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0769, Accuracy: 37/460 (8.0435%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0359, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.4725, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0927, Accuracy: 12/486 (2.4691%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0448, Accuracy: 220/486 (45.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.3774, Accuracy: 52/10000 (0.5200%)
time spent on training: 240.84961581230164
[rfa agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 33, 83, 60, 57, 18, 41, 0, 31, 30], weight: tensor([0.0846, 0.0486, 0.1843, 0.2102, 0.1089, 0.0500, 0.0678, 0.1564, 0.0434,
        0.0459])
[rfa agg] iter:  0, prev_obj_val: 89.47261810302734, obj_val: 90.80049896240234, abs dis: 1.327880859375
[rfa agg] iter: 0, weight: tensor([0.1077, 0.0346, 0.1320, 0.1111, 0.2604, 0.0359, 0.0657, 0.1936, 0.0286,
        0.0303])
[rfa agg] iter:  1, prev_obj_val: 90.80049896240234, obj_val: 94.03401947021484, abs dis: 3.2335205078125
[rfa agg] iter: 1, weight: tensor([0.1182, 0.0353, 0.1129, 0.0968, 0.3124, 0.0366, 0.0690, 0.1590, 0.0290,
        0.0307])
[rfa agg] iter:  2, prev_obj_val: 94.03401947021484, obj_val: 95.28215026855469, abs dis: 1.2481307983398438
[rfa agg] iter: 2, weight: tensor([0.1567, 0.0408, 0.1003, 0.0884, 0.2864, 0.0424, 0.0845, 0.1323, 0.0331,
        0.0351])
[rfa agg] iter:  3, prev_obj_val: 95.28215026855469, obj_val: 95.2729721069336, abs dis: 0.00917816162109375
[rfa agg] iter: 3, weight: tensor([0.1795, 0.0435, 0.0974, 0.0866, 0.2567, 0.0452, 0.0927, 0.1261, 0.0351,
        0.0373])
[rfa agg] iter:  4, prev_obj_val: 95.2729721069336, obj_val: 95.272705078125, abs dis: 0.00026702880859375
[rfa agg] iter: 4, weight: tensor([0.1824, 0.0437, 0.0978, 0.0868, 0.2513, 0.0455, 0.0934, 0.1265, 0.0353,
        0.0374])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8159, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.2708, Accuracy: 0/9950 (0.0000%)
saving model
Done in 333.6997346878052 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0656, Accuracy: 267/946 (28.2241%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0372, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0591, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0621, Accuracy: 253/1446 (17.4965%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0366, Accuracy: 455/1446 (31.4661%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0067, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1491, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1344, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 14.9056, Accuracy: 46/10000 (0.4600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 351/1574 (22.2999%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 608/1574 (38.6277%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.7145, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0586, Accuracy: 348/1587 (21.9282%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0353, Accuracy: 557/1587 (35.0977%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3465, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 46/631 (7.2900%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0399, Accuracy: 239/631 (37.8764%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6919, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0632, Accuracy: 235/1013 (23.1984%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0297, Accuracy: 444/1013 (43.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.9906, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0519, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0279, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.6221, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0690, Accuracy: 220/1154 (19.0641%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0318, Accuracy: 408/1154 (35.3553%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.6114, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0632, Accuracy: 308/1949 (15.8030%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 591/1949 (30.3232%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.0536, Accuracy: 89/10000 (0.8900%)
time spent on training: 251.27205181121826
[rfa agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.043621408300815886
[rfa agg] init. name: [43, 26, 61, 17, 27, 48, 39, 7, 15, 21], weight: tensor([0.0839, 0.1282, 0.0075, 0.1396, 0.1407, 0.0560, 0.0898, 0.0790, 0.1023,
        0.1728])
[rfa agg] iter:  0, prev_obj_val: 59.99556350708008, obj_val: 59.80973434448242, abs dis: 0.18582916259765625
[rfa agg] iter: 0, weight: tensor([0.1027, 0.1524, 0.0023, 0.1229, 0.1220, 0.0341, 0.1352, 0.0801, 0.1703,
        0.0781])
[rfa agg] iter:  1, prev_obj_val: 59.80973434448242, obj_val: 62.373390197753906, abs dis: 2.5636558532714844
[rfa agg] iter: 1, weight: tensor([0.1014, 0.1503, 0.0023, 0.1201, 0.1193, 0.0334, 0.1357, 0.0788, 0.1828,
        0.0760])
[rfa agg] iter:  2, prev_obj_val: 62.373390197753906, obj_val: 63.84150314331055, abs dis: 1.4681129455566406
[rfa agg] iter: 2, weight: tensor([0.1230, 0.1250, 0.0024, 0.1033, 0.1030, 0.0369, 0.1696, 0.0928, 0.1743,
        0.0697])
[rfa agg] iter:  3, prev_obj_val: 63.84150314331055, obj_val: 63.83329772949219, abs dis: 0.008205413818359375
[rfa agg] iter: 3, weight: tensor([0.1367, 0.1128, 0.0024, 0.0949, 0.0947, 0.0384, 0.1928, 0.1009, 0.1606,
        0.0659])
[rfa agg] iter:  4, prev_obj_val: 63.83329772949219, obj_val: 63.83317565917969, abs dis: 0.0001220703125
[rfa agg] iter: 4, weight: tensor([0.1375, 0.1121, 0.0024, 0.0945, 0.0943, 0.0383, 0.1962, 0.1010, 0.1581,
        0.0656])
[rfa agg] iter:  5, prev_obj_val: 63.83317565917969, obj_val: 65.46537780761719, abs dis: 1.6322021484375
[rfa agg] iter: 5, weight: tensor([0.1375, 0.1121, 0.0024, 0.0945, 0.0943, 0.0383, 0.1967, 0.1010, 0.1577,
        0.0656])
[rfa agg] iter:  6, prev_obj_val: 65.46537780761719, obj_val: 67.26154327392578, abs dis: 1.7961654663085938
[rfa agg] iter: 6, weight: tensor([0.1514, 0.1017, 0.0024, 0.0869, 0.0868, 0.0398, 0.2163, 0.1093, 0.1436,
        0.0619])
[rfa agg] iter:  7, prev_obj_val: 67.26154327392578, obj_val: 69.26266479492188, abs dis: 2.0011215209960938
[rfa agg] iter: 7, weight: tensor([0.1673, 0.0917, 0.0024, 0.0793, 0.0793, 0.0413, 0.2348, 0.1187, 0.1274,
        0.0579])
[rfa agg] iter:  8, prev_obj_val: 69.26266479492188, obj_val: 71.50774383544922, abs dis: 2.2450790405273438
[rfa agg] iter: 8, weight: tensor([0.1849, 0.0833, 0.0024, 0.0730, 0.0730, 0.0431, 0.2427, 0.1301, 0.1132,
        0.0544])
[rfa agg] iter:  9, prev_obj_val: 71.50774383544922, obj_val: 69.25951385498047, abs dis: 2.24822998046875
[rfa agg] iter: 9, weight: tensor([0.2035, 0.0773, 0.0024, 0.0685, 0.0686, 0.0461, 0.2336, 0.1453, 0.1027,
        0.0521])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8166, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3251, Accuracy: 0/9950 (0.0000%)
saving model
Done in 345.950288772583 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0505, Accuracy: 357/1129 (31.6209%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 671/1129 (59.4331%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.8723, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0701, Accuracy: 301/1163 (25.8813%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0397, Accuracy: 430/1163 (36.9733%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5440, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0695, Accuracy: 211/1154 (18.2842%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 407/1154 (35.2686%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.5967, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0882, Accuracy: 88/603 (14.5937%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0522, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4703, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0613, Accuracy: 350/1904 (18.3824%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0335, Accuracy: 612/1904 (32.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3711, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0559, Accuracy: 411/1953 (21.0445%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0351, Accuracy: 684/1953 (35.0230%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3653, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0491, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.5686, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0688, Accuracy: 297/1956 (15.1840%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0352, Accuracy: 582/1956 (29.7546%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.8588, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0576, Accuracy: 381/1715 (22.2157%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 632/1715 (36.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.0732, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0482, Accuracy: 282/813 (34.6863%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0211, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 13.1943, Accuracy: 59/10000 (0.5900%)
time spent on training: 284.3850140571594
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 68, 15, 88, 46, 83, 7, 6, 92, 53], weight: tensor([0.0850, 0.0876, 0.0869, 0.0454, 0.1434, 0.1471, 0.0671, 0.1473, 0.1291,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 68.5903091430664, obj_val: 69.28779602050781, abs dis: 0.6974868774414062
[rfa agg] iter: 0, weight: tensor([0.1277, 0.1680, 0.1391, 0.0257, 0.1067, 0.0984, 0.0557, 0.0990, 0.1336,
        0.0462])
[rfa agg] iter:  1, prev_obj_val: 69.28779602050781, obj_val: 72.52344512939453, abs dis: 3.2356491088867188
[rfa agg] iter: 1, weight: tensor([0.1382, 0.1878, 0.1490, 0.0257, 0.0964, 0.0893, 0.0565, 0.0899, 0.1206,
        0.0467])
[rfa agg] iter:  2, prev_obj_val: 72.52344512939453, obj_val: 73.93167877197266, abs dis: 1.408233642578125
[rfa agg] iter: 2, weight: tensor([0.1678, 0.2279, 0.1585, 0.0266, 0.0751, 0.0704, 0.0621, 0.0708, 0.0902,
        0.0506])
[rfa agg] iter:  3, prev_obj_val: 73.93167877197266, obj_val: 73.92798614501953, abs dis: 0.003692626953125
[rfa agg] iter: 3, weight: tensor([0.1809, 0.2377, 0.1558, 0.0269, 0.0692, 0.0651, 0.0647, 0.0654, 0.0819,
        0.0524])
[rfa agg] iter:  4, prev_obj_val: 73.92798614501953, obj_val: 73.92790222167969, abs dis: 8.392333984375e-05
[rfa agg] iter: 4, weight: tensor([0.1825, 0.2399, 0.1542, 0.0268, 0.0688, 0.0647, 0.0644, 0.0651, 0.0814,
        0.0521])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8197, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.1562, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.508003950119 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0669, Accuracy: 210/1131 (18.5676%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0331, Accuracy: 391/1131 (34.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.4359, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0944, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0529, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8208, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0689, Accuracy: 223/1154 (19.3241%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0314, Accuracy: 407/1154 (35.2686%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 14.0552, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0624, Accuracy: 247/1130 (21.8584%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0317, Accuracy: 440/1130 (38.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.6005, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.1023, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0556, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2451, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.1007, Accuracy: 4/338 (1.1834%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0543, Accuracy: 107/338 (31.6568%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.5700, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0551, Accuracy: 549/2227 (24.6520%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 965/2227 (43.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.7770, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0599, Accuracy: 240/712 (33.7079%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.4624, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0614, Accuracy: 277/1446 (19.1563%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0365, Accuracy: 476/1446 (32.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1864, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0649, Accuracy: 230/1213 (18.9613%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0296, Accuracy: 513/1213 (42.2918%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3597, Accuracy: 80/10000 (0.8000%)
time spent on training: 250.15132522583008
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 76, 15, 54, 78, 12, 60, 11, 26, 97], weight: tensor([0.1105, 0.0455, 0.1128, 0.1104, 0.0407, 0.0330, 0.2176, 0.0696, 0.1413,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 68.31356048583984, obj_val: 72.47759246826172, abs dis: 4.164031982421875
[rfa agg] iter: 0, weight: tensor([0.1944, 0.0198, 0.1289, 0.2127, 0.0160, 0.0119, 0.0564, 0.0485, 0.1121,
        0.1992])
[rfa agg] iter:  1, prev_obj_val: 72.47759246826172, obj_val: 72.46836853027344, abs dis: 0.00922393798828125
[rfa agg] iter: 1, weight: tensor([0.2016, 0.0255, 0.1255, 0.2102, 0.0203, 0.0149, 0.0572, 0.0686, 0.1000,
        0.1762])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 12.4609, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 10.2675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.79620599746704 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0648, Accuracy: 282/1573 (17.9275%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0372, Accuracy: 498/1573 (31.6592%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6645, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 412/1953 (21.0958%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 770/1953 (39.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3084, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0605, Accuracy: 358/1904 (18.8025%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0323, Accuracy: 652/1904 (34.2437%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3109, Accuracy: 100/10000 (1.0000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0524, Accuracy: 327/1574 (20.7751%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0297, Accuracy: 551/1574 (35.0064%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6227, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0884, Accuracy: 83/603 (13.7645%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0547, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6003, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0678, Accuracy: 146/818 (17.8484%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0339, Accuracy: 318/818 (38.8753%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6389, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0675, Accuracy: 308/1750 (17.6000%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0386, Accuracy: 580/1750 (33.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9244, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0768, Accuracy: 26/460 (5.6522%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.1412, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 255/690 (36.9565%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.3302, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0676, Accuracy: 309/1956 (15.7975%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0349, Accuracy: 579/1956 (29.6012%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.2672, Accuracy: 86/10000 (0.8600%)
time spent on training: 287.95762848854065
[rfa agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.037035991265717945
[rfa agg] init. name: [40, 83, 46, 17, 88, 71, 44, 31, 25, 6], weight: tensor([0.1184, 0.1471, 0.1434, 0.1185, 0.0454, 0.0616, 0.1318, 0.0346, 0.0520,
        0.1473])
[rfa agg] iter:  0, prev_obj_val: 69.83493041992188, obj_val: 65.41239166259766, abs dis: 4.422538757324219
[rfa agg] iter: 0, weight: tensor([0.2167, 0.1069, 0.1171, 0.2032, 0.0235, 0.0413, 0.1394, 0.0154, 0.0291,
        0.1074])
[rfa agg] iter:  1, prev_obj_val: 65.41239166259766, obj_val: 65.40425872802734, abs dis: 0.0081329345703125
[rfa agg] iter: 1, weight: tensor([0.2409, 0.1010, 0.1127, 0.2198, 0.0186, 0.0321, 0.1383, 0.0123, 0.0229,
        0.1014])
[rfa agg] iter:  2, prev_obj_val: 65.40425872802734, obj_val: 63.50239562988281, abs dis: 1.9018630981445312
[rfa agg] iter: 2, weight: tensor([0.2436, 0.1003, 0.1119, 0.2212, 0.0185, 0.0318, 0.1371, 0.0123, 0.0227,
        0.1006])
[rfa agg] iter:  3, prev_obj_val: 63.50239562988281, obj_val: 63.50177764892578, abs dis: 0.00061798095703125
[rfa agg] iter: 3, weight: tensor([0.2506, 0.0992, 0.1117, 0.2233, 0.0167, 0.0285, 0.1388, 0.0111, 0.0205,
        0.0996])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 14.2809, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 13.2977, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.58480405807495 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0612, Accuracy: 266/1013 (26.2586%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0288, Accuracy: 448/1013 (44.2251%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.3625, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0651, Accuracy: 191/1071 (17.8338%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0308, Accuracy: 469/1071 (43.7908%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.3905, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0716, Accuracy: 93/781 (11.9078%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0376, Accuracy: 249/781 (31.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.8647, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0781, Accuracy: 23/460 (5.0000%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1465, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0683, Accuracy: 128/938 (13.6461%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 343/938 (36.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.5974, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0480, Accuracy: 440/1552 (28.3505%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0225, Accuracy: 719/1552 (46.3273%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.1204, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0625, Accuracy: 185/590 (31.3559%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 13.1122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0634, Accuracy: 223/1131 (19.7171%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 402/1131 (35.5438%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4510, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0623, Accuracy: 223/1513 (14.7389%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0388, Accuracy: 420/1513 (27.7594%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8005, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0636, Accuracy: 334/1427 (23.4057%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 560/1427 (39.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.1549, Accuracy: 75/10000 (0.7500%)
time spent on training: 273.4215726852417
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 55, 3, 31, 73, 74, 69, 87, 8, 34], weight: tensor([0.0967, 0.1022, 0.0746, 0.0439, 0.0895, 0.1481, 0.0563, 0.1080, 0.1444,
        0.1362])
[rfa agg] iter:  0, prev_obj_val: 50.62666702270508, obj_val: 53.82291793823242, abs dis: 3.1962509155273438
[rfa agg] iter: 0, weight: tensor([0.1812, 0.1534, 0.0841, 0.0218, 0.1626, 0.0650, 0.0368, 0.1473, 0.0716,
        0.0761])
[rfa agg] iter:  1, prev_obj_val: 53.82291793823242, obj_val: 58.44010925292969, abs dis: 4.617191314697266
[rfa agg] iter: 1, weight: tensor([0.1811, 0.1361, 0.1076, 0.0247, 0.1944, 0.0586, 0.0433, 0.1228, 0.0640,
        0.0674])
[rfa agg] iter:  2, prev_obj_val: 58.44010925292969, obj_val: 58.42262268066406, abs dis: 0.017486572265625
[rfa agg] iter: 2, weight: tensor([0.1556, 0.1193, 0.1494, 0.0308, 0.1936, 0.0584, 0.0566, 0.1075, 0.0630,
        0.0658])
[rfa agg] iter:  3, prev_obj_val: 58.42262268066406, obj_val: 55.992828369140625, abs dis: 2.4297943115234375
[rfa agg] iter: 3, weight: tensor([0.1531, 0.1178, 0.1551, 0.0307, 0.1937, 0.0581, 0.0566, 0.1066, 0.0628,
        0.0655])
[rfa agg] iter:  4, prev_obj_val: 55.992828369140625, obj_val: 53.80976104736328, abs dis: 2.1830673217773438
[rfa agg] iter: 4, weight: tensor([0.1649, 0.1241, 0.1322, 0.0273, 0.2034, 0.0579, 0.0491, 0.1124, 0.0629,
        0.0659])
[rfa agg] iter:  5, prev_obj_val: 53.80976104736328, obj_val: 55.991207122802734, abs dis: 2.181446075439453
[rfa agg] iter: 5, weight: tensor([0.1779, 0.1320, 0.1098, 0.0245, 0.2043, 0.0581, 0.0431, 0.1201, 0.0634,
        0.0668])
[rfa agg] iter:  6, prev_obj_val: 55.991207122802734, obj_val: 53.80841064453125, abs dis: 2.1827964782714844
[rfa agg] iter: 6, weight: tensor([0.1672, 0.1251, 0.1275, 0.0273, 0.2046, 0.0579, 0.0489, 0.1128, 0.0628,
        0.0659])
[rfa agg] iter:  7, prev_obj_val: 53.80841064453125, obj_val: 55.99128341674805, abs dis: 2.182872772216797
[rfa agg] iter: 7, weight: tensor([0.1781, 0.1320, 0.1095, 0.0245, 0.2045, 0.0581, 0.0431, 0.1200, 0.0634,
        0.0668])
[rfa agg] iter:  8, prev_obj_val: 55.99128341674805, obj_val: 53.80840301513672, abs dis: 2.182880401611328
[rfa agg] iter: 8, weight: tensor([0.1672, 0.1251, 0.1275, 0.0273, 0.2047, 0.0579, 0.0489, 0.1128, 0.0628,
        0.0659])
[rfa agg] iter:  9, prev_obj_val: 53.80840301513672, obj_val: 55.99129104614258, abs dis: 2.1828880310058594
[rfa agg] iter: 9, weight: tensor([0.1781, 0.1320, 0.1095, 0.0245, 0.2045, 0.0581, 0.0431, 0.1200, 0.0634,
        0.0668])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 14.0746, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 14.3612, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.57476329803467 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0808, Accuracy: 38/515 (7.3786%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0523, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9658, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0945, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0462, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.4290, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0904, Accuracy: 70/603 (11.6086%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0541, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8058, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0650, Accuracy: 349/1427 (24.4569%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0371, Accuracy: 515/1427 (36.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7975, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0681, Accuracy: 133/938 (14.1791%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.1169, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0591, Accuracy: 283/1036 (27.3166%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0270, Accuracy: 632/1036 (61.0039%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.8421, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0620, Accuracy: 249/1446 (17.2199%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0360, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1397, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0778, Accuracy: 160/715 (22.3776%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0439, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4318, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0691, Accuracy: 126/735 (17.1429%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0216, Accuracy: 351/735 (47.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.8330, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0609, Accuracy: 351/1470 (23.8776%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0257, Accuracy: 786/1470 (53.4694%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.7723, Accuracy: 95/10000 (0.9500%)
time spent on training: 253.45514965057373
[rfa agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 30, 88, 34, 73, 19, 26, 23, 32, 22], weight: tensor([0.0550, 0.0519, 0.0643, 0.1523, 0.1001, 0.1106, 0.1543, 0.0763, 0.0784,
        0.1569])
[rfa agg] iter:  0, prev_obj_val: 54.892242431640625, obj_val: 57.09327697753906, abs dis: 2.2010345458984375
[rfa agg] iter: 0, weight: tensor([0.0405, 0.0343, 0.0585, 0.0886, 0.2306, 0.1677, 0.0893, 0.0964, 0.1047,
        0.0894])
[rfa agg] iter:  1, prev_obj_val: 57.09327697753906, obj_val: 62.15685272216797, abs dis: 5.063575744628906
[rfa agg] iter: 1, weight: tensor([0.0455, 0.0382, 0.0689, 0.0766, 0.2298, 0.1379, 0.0775, 0.1179, 0.1302,
        0.0775])
[rfa agg] iter:  2, prev_obj_val: 62.15685272216797, obj_val: 62.07776641845703, abs dis: 0.0790863037109375
[rfa agg] iter: 2, weight: tensor([0.0584, 0.0488, 0.0981, 0.0661, 0.1529, 0.1021, 0.0668, 0.1570, 0.1828,
        0.0671])
[rfa agg] iter:  3, prev_obj_val: 62.07776641845703, obj_val: 64.1588363647461, abs dis: 2.0810699462890625
[rfa agg] iter: 3, weight: tensor([0.0578, 0.0483, 0.0978, 0.0647, 0.1445, 0.0993, 0.0655, 0.1616, 0.1948,
        0.0656])
[rfa agg] iter:  4, prev_obj_val: 64.1588363647461, obj_val: 69.06639099121094, abs dis: 4.907554626464844
[rfa agg] iter: 4, weight: tensor([0.0629, 0.0527, 0.1116, 0.0614, 0.1267, 0.0906, 0.0622, 0.1655, 0.2040,
        0.0623])
[rfa agg] iter:  5, prev_obj_val: 69.06639099121094, obj_val: 66.48469543457031, abs dis: 2.581695556640625
[rfa agg] iter: 5, weight: tensor([0.0785, 0.0674, 0.1545, 0.0581, 0.1046, 0.0799, 0.0589, 0.1542, 0.1848,
        0.0591])
[rfa agg] iter:  6, prev_obj_val: 66.48469543457031, obj_val: 71.8626708984375, abs dis: 5.3779754638671875
[rfa agg] iter: 6, weight: tensor([0.0706, 0.0595, 0.1354, 0.0591, 0.1126, 0.0839, 0.0599, 0.1604, 0.1986,
        0.0600])
[rfa agg] iter:  7, prev_obj_val: 71.8626708984375, obj_val: 71.84123992919922, abs dis: 0.02143096923828125
[rfa agg] iter: 7, weight: tensor([0.0884, 0.0781, 0.1813, 0.0571, 0.0968, 0.0761, 0.0578, 0.1414, 0.1648,
        0.0581])
[rfa agg] iter:  8, prev_obj_val: 71.84123992919922, obj_val: 71.84072875976562, abs dis: 0.00051116943359375
[rfa agg] iter: 8, weight: tensor([0.0893, 0.0786, 0.1911, 0.0566, 0.0957, 0.0753, 0.0573, 0.1380, 0.1605,
        0.0576])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8765, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.3638, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.3761887550354 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0695, Accuracy: 305/1163 (26.2253%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0397, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5227, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0853, Accuracy: 51/500 (10.2000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0511, Accuracy: 208/500 (41.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.3478, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0531, Accuracy: 334/1628 (20.5160%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 757/1628 (46.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.8757, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0584, Accuracy: 277/1013 (27.3445%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 487/1013 (48.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.0764, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0723, Accuracy: 206/807 (25.5266%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0367, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.0996, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0576, Accuracy: 386/1470 (26.2585%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 791/1470 (53.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.9927, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0941, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0639, Accuracy: 97/311 (31.1897%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9336, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0497, Accuracy: 410/1552 (26.4175%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 713/1552 (45.9407%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.6503, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0738, Accuracy: 158/636 (24.8428%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0349, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.5372, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.1004, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0582, Accuracy: 76/373 (20.3753%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2067, Accuracy: 57/10000 (0.5700%)
time spent on training: 246.68482160568237
[rfa agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 82, 5, 39, 20, 22, 96, 74, 52, 98], weight: tensor([0.1230, 0.0529, 0.1722, 0.1072, 0.0854, 0.1555, 0.0329, 0.1642, 0.0673,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 63.93631362915039, obj_val: 64.96653747558594, abs dis: 1.0302238464355469
[rfa agg] iter: 0, weight: tensor([0.1784, 0.0341, 0.0993, 0.2565, 0.1146, 0.1230, 0.0155, 0.1037, 0.0546,
        0.0204])
[rfa agg] iter:  1, prev_obj_val: 64.96653747558594, obj_val: 64.94747924804688, abs dis: 0.0190582275390625
[rfa agg] iter: 1, weight: tensor([0.1612, 0.0342, 0.0898, 0.2987, 0.1218, 0.1098, 0.0154, 0.0932, 0.0554,
        0.0203])
[rfa agg] iter:  2, prev_obj_val: 64.94747924804688, obj_val: 66.39582824707031, abs dis: 1.4483489990234375
[rfa agg] iter: 2, weight: tensor([0.1564, 0.0336, 0.0882, 0.3130, 0.1202, 0.1076, 0.0151, 0.0914, 0.0545,
        0.0200])
[rfa agg] iter:  3, prev_obj_val: 66.39582824707031, obj_val: 68.02548217773438, abs dis: 1.6296539306640625
[rfa agg] iter: 3, weight: tensor([0.1449, 0.0361, 0.0852, 0.3115, 0.1352, 0.1027, 0.0159, 0.0881, 0.0592,
        0.0212])
[rfa agg] iter:  4, prev_obj_val: 68.02548217773438, obj_val: 66.39677429199219, abs dis: 1.6287078857421875
[rfa agg] iter: 4, weight: tensor([0.1365, 0.0395, 0.0839, 0.2911, 0.1569, 0.0999, 0.0171, 0.0865, 0.0658,
        0.0229])
[rfa agg] iter:  5, prev_obj_val: 66.39677429199219, obj_val: 68.02389526367188, abs dis: 1.6271209716796875
[rfa agg] iter: 5, weight: tensor([0.1440, 0.0363, 0.0855, 0.3071, 0.1389, 0.1029, 0.0160, 0.0884, 0.0597,
        0.0213])
[rfa agg] iter:  6, prev_obj_val: 68.02389526367188, obj_val: 66.39700317382812, abs dis: 1.62689208984375
[rfa agg] iter: 6, weight: tensor([0.1366, 0.0396, 0.0840, 0.2901, 0.1574, 0.1000, 0.0171, 0.0865, 0.0659,
        0.0229])
[rfa agg] iter:  7, prev_obj_val: 66.39700317382812, obj_val: 68.02384948730469, abs dis: 1.6268463134765625
[rfa agg] iter: 7, weight: tensor([0.1440, 0.0363, 0.0856, 0.3068, 0.1390, 0.1030, 0.0160, 0.0884, 0.0597,
        0.0213])
[rfa agg] iter:  8, prev_obj_val: 68.02384948730469, obj_val: 66.39701843261719, abs dis: 1.6268310546875
[rfa agg] iter: 8, weight: tensor([0.1366, 0.0396, 0.0840, 0.2900, 0.1575, 0.1000, 0.0171, 0.0865, 0.0659,
        0.0229])
[rfa agg] iter:  9, prev_obj_val: 66.39701843261719, obj_val: 68.02384948730469, abs dis: 1.6268310546875
[rfa agg] iter: 9, weight: tensor([0.1440, 0.0363, 0.0856, 0.3067, 0.1390, 0.1030, 0.0160, 0.0884, 0.0597,
        0.0213])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8744, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.4738, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.7878267765045 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0737, Accuracy: 124/809 (15.3276%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0298, Accuracy: 316/809 (39.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.7602, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0662, Accuracy: 236/1213 (19.4559%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0303, Accuracy: 515/1213 (42.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.4618, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0731, Accuracy: 157/636 (24.6855%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0365, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.3929, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0688, Accuracy: 135/938 (14.3923%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 328/938 (34.9680%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.6970, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0688, Accuracy: 218/719 (30.3199%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0359, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.7477, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0570, Accuracy: 476/2227 (21.3740%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0308, Accuracy: 887/2227 (39.8294%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.9879, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0604, Accuracy: 227/712 (31.8820%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.4796, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0557, Accuracy: 218/813 (26.8143%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0210, Accuracy: 438/813 (53.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 14.0240, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0607, Accuracy: 194/590 (32.8814%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 14.8110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0615, Accuracy: 169/861 (19.6283%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 467/861 (54.2393%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.5117, Accuracy: 92/10000 (0.9200%)
time spent on training: 236.84635996818542
[rfa agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [50, 97, 52, 73, 41, 60, 11, 53, 69, 10], weight: tensor([0.0850, 0.1274, 0.0668, 0.0986, 0.0755, 0.2340, 0.0748, 0.0854, 0.0620,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 69.06175994873047, obj_val: 75.21272277832031, abs dis: 6.150962829589844
[rfa agg] iter: 0, weight: tensor([0.1091, 0.1496, 0.0492, 0.1844, 0.0765, 0.0580, 0.0762, 0.1100, 0.0463,
        0.1408])
[rfa agg] iter:  1, prev_obj_val: 75.21272277832031, obj_val: 77.69832611083984, abs dis: 2.4856033325195312
[rfa agg] iter: 1, weight: tensor([0.1297, 0.0626, 0.0921, 0.0939, 0.1264, 0.0382, 0.1177, 0.1362, 0.0942,
        0.1090])
[rfa agg] iter:  2, prev_obj_val: 77.69832611083984, obj_val: 74.99703979492188, abs dis: 2.7012863159179688
[rfa agg] iter: 2, weight: tensor([0.1202, 0.0599, 0.1081, 0.0850, 0.1288, 0.0384, 0.1198, 0.1270, 0.1139,
        0.0990])
[rfa agg] iter:  3, prev_obj_val: 74.99703979492188, obj_val: 80.71703338623047, abs dis: 5.719993591308594
[rfa agg] iter: 3, weight: tensor([0.1277, 0.0600, 0.0945, 0.0884, 0.1313, 0.0371, 0.1215, 0.1376, 0.0972,
        0.1048])
[rfa agg] iter:  4, prev_obj_val: 80.71703338623047, obj_val: 80.7005615234375, abs dis: 0.01647186279296875
[rfa agg] iter: 4, weight: tensor([0.1123, 0.0601, 0.1226, 0.0821, 0.1236, 0.0398, 0.1161, 0.1175, 0.1320,
        0.0939])
[rfa agg] iter:  5, prev_obj_val: 80.7005615234375, obj_val: 80.70030975341797, abs dis: 0.00025177001953125
[rfa agg] iter: 5, weight: tensor([0.1107, 0.0598, 0.1261, 0.0816, 0.1217, 0.0396, 0.1153, 0.1161, 0.1362,
        0.0930])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 35.7841, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 37.6609, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 331.17232608795166 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0565, Accuracy: 364/1953 (18.6380%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0349, Accuracy: 718/1953 (36.7640%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5741, Accuracy: 96/10000 (0.9600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 354/1574 (22.4905%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 616/1574 (39.1360%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.2865, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0710, Accuracy: 135/809 (16.6873%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0304, Accuracy: 295/809 (36.4648%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.5989, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.1100, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0618, Accuracy: 85/312 (27.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2280, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0477, Accuracy: 356/1129 (31.5323%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 678/1129 (60.0531%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.6470, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0539, Accuracy: 292/1628 (17.9361%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0278, Accuracy: 699/1628 (42.9361%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.3021, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0612, Accuracy: 245/1130 (21.6814%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/1130 (43.3628%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.5113, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0719, Accuracy: 154/636 (24.2138%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0342, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.8528, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0572, Accuracy: 244/712 (34.2697%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.8612, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0664, Accuracy: 299/1163 (25.7094%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/1163 (37.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1527, Accuracy: 55/10000 (0.5500%)
time spent on training: 276.31303429603577
[rfa agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.04452969400688032
[rfa agg] init. name: [83, 17, 50, 24, 37, 5, 54, 52, 11, 68], weight: tensor([0.1768, 0.1425, 0.0732, 0.0282, 0.1022, 0.1474, 0.1023, 0.0576, 0.0645,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 62.40164566040039, obj_val: 66.2754135131836, abs dis: 3.873767852783203
[rfa agg] iter: 0, weight: tensor([0.0660, 0.0983, 0.0588, 0.0096, 0.1852, 0.0883, 0.2111, 0.0311, 0.0443,
        0.2072])
[rfa agg] iter:  1, prev_obj_val: 66.2754135131836, obj_val: 64.58324432373047, abs dis: 1.692169189453125
[rfa agg] iter: 1, weight: tensor([0.0608, 0.0838, 0.0780, 0.0111, 0.1958, 0.0770, 0.2244, 0.0383, 0.0569,
        0.1741])
[rfa agg] iter:  2, prev_obj_val: 64.58324432373047, obj_val: 68.16261291503906, abs dis: 3.5793685913085938
[rfa agg] iter: 2, weight: tensor([0.0596, 0.0841, 0.0679, 0.0101, 0.2018, 0.0768, 0.2368, 0.0342, 0.0500,
        0.1785])
[rfa agg] iter:  3, prev_obj_val: 68.16261291503906, obj_val: 70.22793579101562, abs dis: 2.0653228759765625
[rfa agg] iter: 3, weight: tensor([0.0616, 0.0830, 0.0904, 0.0121, 0.1922, 0.0768, 0.2161, 0.0429, 0.0649,
        0.1599])
[rfa agg] iter:  4, prev_obj_val: 70.22793579101562, obj_val: 70.22398376464844, abs dis: 0.0039520263671875
[rfa agg] iter: 4, weight: tensor([0.0630, 0.0831, 0.1069, 0.0133, 0.1824, 0.0773, 0.1992, 0.0487, 0.0752,
        0.1510])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 20.4282, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 18.4778, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.59835386276245 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0870, Accuracy: 27/500 (5.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0507, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.8659, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0563, Accuracy: 292/1340 (21.7910%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 555/1340 (41.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.4412, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0782, Accuracy: 160/715 (22.3776%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0430, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.5297, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0909, Accuracy: 43/682 (6.3050%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0427, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.2382, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0702, Accuracy: 97/781 (12.4200%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 248/781 (31.7542%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.2569, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0551, Accuracy: 373/1440 (25.9028%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0306, Accuracy: 642/1440 (44.5833%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.4944, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0607, Accuracy: 307/1715 (17.9009%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0323, Accuracy: 639/1715 (37.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.9758, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0652, Accuracy: 123/735 (16.7347%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 13.6262, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0658, Accuracy: 304/1163 (26.1393%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0384, Accuracy: 459/1163 (39.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5820, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0625, Accuracy: 276/1089 (25.3444%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0291, Accuracy: 452/1089 (41.5060%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.3824, Accuracy: 65/10000 (0.6500%)
time spent on training: 258.3828766345978
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 77, 23, 80, 3, 29, 92, 32, 68, 59], weight: tensor([0.0492, 0.1319, 0.0704, 0.0671, 0.0769, 0.1417, 0.1688, 0.0723, 0.1145,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 60.03351974487305, obj_val: 62.62534713745117, abs dis: 2.591827392578125
[rfa agg] iter: 0, weight: tensor([0.0364, 0.1256, 0.0904, 0.0763, 0.1328, 0.1034, 0.0826, 0.0959, 0.1556,
        0.1009])
[rfa agg] iter:  1, prev_obj_val: 62.62534713745117, obj_val: 65.85982513427734, abs dis: 3.234477996826172
[rfa agg] iter: 1, weight: tensor([0.0399, 0.1050, 0.1054, 0.0893, 0.1681, 0.0887, 0.0730, 0.1144, 0.1267,
        0.0896])
[rfa agg] iter:  2, prev_obj_val: 65.85982513427734, obj_val: 67.74612426757812, abs dis: 1.8862991333007812
[rfa agg] iter: 2, weight: tensor([0.0433, 0.0863, 0.1195, 0.1046, 0.1981, 0.0748, 0.0634, 0.1335, 0.1000,
        0.0764])
[rfa agg] iter:  3, prev_obj_val: 67.74612426757812, obj_val: 65.83204650878906, abs dis: 1.9140777587890625
[rfa agg] iter: 3, weight: tensor([0.0453, 0.0781, 0.1263, 0.1148, 0.2051, 0.0685, 0.0589, 0.1445, 0.0889,
        0.0696])
[rfa agg] iter:  4, prev_obj_val: 65.83204650878906, obj_val: 67.7428970336914, abs dis: 1.9108505249023438
[rfa agg] iter: 4, weight: tensor([0.0426, 0.0843, 0.1207, 0.1051, 0.2041, 0.0732, 0.0621, 0.1367, 0.0975,
        0.0736])
[rfa agg] iter:  5, prev_obj_val: 67.7428970336914, obj_val: 65.83228302001953, abs dis: 1.910614013671875
[rfa agg] iter: 5, weight: tensor([0.0452, 0.0779, 0.1262, 0.1146, 0.2063, 0.0683, 0.0587, 0.1448, 0.0886,
        0.0693])
[rfa agg] iter:  6, prev_obj_val: 65.83228302001953, obj_val: 67.74286651611328, abs dis: 1.91058349609375
[rfa agg] iter: 6, weight: tensor([0.0426, 0.0842, 0.1207, 0.1051, 0.2044, 0.0732, 0.0621, 0.1367, 0.0974,
        0.0735])
[rfa agg] iter:  7, prev_obj_val: 67.74286651611328, obj_val: 65.83228302001953, abs dis: 1.91058349609375
[rfa agg] iter: 7, weight: tensor([0.0451, 0.0779, 0.1262, 0.1146, 0.2064, 0.0683, 0.0587, 0.1448, 0.0886,
        0.0693])
[rfa agg] iter:  8, prev_obj_val: 65.83228302001953, obj_val: 67.74287414550781, abs dis: 1.9105911254882812
[rfa agg] iter: 8, weight: tensor([0.0426, 0.0842, 0.1207, 0.1051, 0.2044, 0.0732, 0.0621, 0.1367, 0.0974,
        0.0735])
[rfa agg] iter:  9, prev_obj_val: 67.74287414550781, obj_val: 65.83228302001953, abs dis: 1.9105911254882812
[rfa agg] iter: 9, weight: tensor([0.0451, 0.0779, 0.1262, 0.1146, 0.2064, 0.0683, 0.0587, 0.1448, 0.0886,
        0.0693])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 19.8029, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 18.3835, Accuracy: 0/9950 (0.0000%)
saving model
Done in 357.43797278404236 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0821, Accuracy: 95/530 (17.9245%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0417, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.8103, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 211/888 (23.7613%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.7269, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0474, Accuracy: 385/1129 (34.1010%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 693/1129 (61.3818%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.9087, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0665, Accuracy: 347/1742 (19.9196%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0345, Accuracy: 659/1742 (37.8301%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6185, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0591, Accuracy: 263/1130 (23.2743%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0302, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.3838, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 314/896 (35.0446%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5517, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0645, Accuracy: 211/1154 (18.2842%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0287, Accuracy: 445/1154 (38.5615%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 13.8833, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0595, Accuracy: 298/803 (37.1108%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0376, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2971, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0646, Accuracy: 288/1475 (19.5254%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0339, Accuracy: 604/1475 (40.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7603, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0609, Accuracy: 232/776 (29.8969%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0268, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.2535, Accuracy: 74/10000 (0.7400%)
time spent on training: 271.75082540512085
[rfa agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 63, 37, 93, 54, 89, 57, 58, 65, 75], weight: tensor([0.0504, 0.0844, 0.1073, 0.1655, 0.1074, 0.0851, 0.1097, 0.0763, 0.1402,
        0.0737])
[rfa agg] iter:  0, prev_obj_val: 55.02312469482422, obj_val: 61.62062072753906, abs dis: 6.597496032714844
[rfa agg] iter: 0, weight: tensor([0.0335, 0.1247, 0.1320, 0.0599, 0.1376, 0.1381, 0.0992, 0.1081, 0.0704,
        0.0965])
[rfa agg] iter:  1, prev_obj_val: 61.62062072753906, obj_val: 64.04534149169922, abs dis: 2.4247207641601562
[rfa agg] iter: 1, weight: tensor([0.0430, 0.1424, 0.0899, 0.0487, 0.0919, 0.1623, 0.0716, 0.1634, 0.0547,
        0.1322])
[rfa agg] iter:  2, prev_obj_val: 64.04534149169922, obj_val: 66.87385559082031, abs dis: 2.8285140991210938
[rfa agg] iter: 2, weight: tensor([0.0473, 0.1391, 0.0824, 0.0473, 0.0842, 0.1559, 0.0670, 0.1812, 0.0526,
        0.1431])
[rfa agg] iter:  3, prev_obj_val: 66.87385559082031, obj_val: 69.98904418945312, abs dis: 3.1151885986328125
[rfa agg] iter: 3, weight: tensor([0.0546, 0.1341, 0.0799, 0.0480, 0.0815, 0.1471, 0.0662, 0.1873, 0.0529,
        0.1484])
[rfa agg] iter:  4, prev_obj_val: 69.98904418945312, obj_val: 69.98804473876953, abs dis: 0.00099945068359375
[rfa agg] iter: 4, weight: tensor([0.0648, 0.1302, 0.0797, 0.0498, 0.0811, 0.1402, 0.0670, 0.1834, 0.0545,
        0.1494])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8040, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.0820, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.0245039463043 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0941, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0567, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7967, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.1003, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0567, Accuracy: 98/338 (28.9941%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.3505, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0935, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0757, Accuracy: 17/186 (9.1398%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0347, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0518, Accuracy: 216/888 (24.3243%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0274, Accuracy: 413/888 (46.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.4254, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1282, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1151, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5420, Accuracy: 37/10000 (0.3700%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0516, Accuracy: 441/1470 (30.0000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 797/1470 (54.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.8924, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0676, Accuracy: 275/1418 (19.3935%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0350, Accuracy: 513/1418 (36.1777%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.6920, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0649, Accuracy: 316/1427 (22.1444%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0370, Accuracy: 539/1427 (37.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2712, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0721, Accuracy: 62/460 (13.4783%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 178/460 (38.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.8213, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0522, Accuracy: 396/1552 (25.5155%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0231, Accuracy: 702/1552 (45.2320%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.3682, Accuracy: 72/10000 (0.7200%)
time spent on training: 223.93945288658142
[rfa agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 12, 56, 63, 47, 22, 70, 34, 31, 74], weight: tensor([0.0559, 0.0405, 0.0223, 0.1065, 0.0161, 0.1763, 0.1700, 0.1711, 0.0552,
        0.1861])
[rfa agg] iter:  0, prev_obj_val: 69.21540832519531, obj_val: 69.14895629882812, abs dis: 0.0664520263671875
[rfa agg] iter: 0, weight: tensor([0.0444, 0.0261, 0.0108, 0.2118, 0.0078, 0.1728, 0.1640, 0.1719, 0.0439,
        0.1466])
[rfa agg] iter:  1, prev_obj_val: 69.14895629882812, obj_val: 67.4590835571289, abs dis: 1.6898727416992188
[rfa agg] iter: 1, weight: tensor([0.0438, 0.0258, 0.0107, 0.2204, 0.0077, 0.1711, 0.1627, 0.1700, 0.0433,
        0.1445])
[rfa agg] iter:  2, prev_obj_val: 67.4590835571289, obj_val: 65.81970977783203, abs dis: 1.639373779296875
[rfa agg] iter: 2, weight: tensor([0.0410, 0.0244, 0.0102, 0.1959, 0.0073, 0.1800, 0.1708, 0.1794, 0.0406,
        0.1504])
[rfa agg] iter:  3, prev_obj_val: 65.81970977783203, obj_val: 65.81342315673828, abs dis: 0.00628662109375
[rfa agg] iter: 3, weight: tensor([0.0382, 0.0229, 0.0097, 0.1710, 0.0070, 0.1892, 0.1790, 0.1893, 0.0378,
        0.1561])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7979, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.8525, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.4595956802368 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0612, Accuracy: 340/1587 (21.4241%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0354, Accuracy: 564/1587 (35.5388%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.1814, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.1074, Accuracy: 1/408 (0.2451%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0655, Accuracy: 125/408 (30.6373%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3596, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0525, Accuracy: 274/712 (38.4831%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.8153, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0644, Accuracy: 171/1013 (16.8806%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.3827, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0561, Accuracy: 367/1953 (18.7916%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0345, Accuracy: 724/1953 (37.0712%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4295, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/1440 (23.9583%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0304, Accuracy: 675/1440 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.9473, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0636, Accuracy: 305/1475 (20.6780%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0350, Accuracy: 602/1475 (40.8136%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4390, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0686, Accuracy: 183/1241 (14.7462%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0400, Accuracy: 369/1241 (29.7341%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7370, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0886, Accuracy: 31/682 (4.5455%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0401, Accuracy: 271/682 (39.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.9066, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0620, Accuracy: 166/861 (19.2799%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0231, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.5885, Accuracy: 85/10000 (0.8500%)
time spent on training: 278.03937911987305
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 36, 11, 14, 83, 29, 65, 72, 80, 10], weight: tensor([0.1396, 0.0359, 0.0626, 0.0891, 0.1717, 0.1266, 0.1297, 0.1091, 0.0600,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 62.90597152709961, obj_val: 65.67378997802734, abs dis: 2.7678184509277344
[rfa agg] iter: 0, weight: tensor([0.1126, 0.0172, 0.0506, 0.1395, 0.0760, 0.1380, 0.1150, 0.2241, 0.0433,
        0.0836])
[rfa agg] iter:  1, prev_obj_val: 65.67378997802734, obj_val: 67.30243682861328, abs dis: 1.6286468505859375
[rfa agg] iter: 1, weight: tensor([0.1009, 0.0191, 0.0589, 0.1776, 0.0714, 0.1204, 0.1025, 0.1975, 0.0501,
        0.1016])
[rfa agg] iter:  2, prev_obj_val: 67.30243682861328, obj_val: 67.29476165771484, abs dis: 0.0076751708984375
[rfa agg] iter: 2, weight: tensor([0.0955, 0.0201, 0.0639, 0.2011, 0.0692, 0.1121, 0.0966, 0.1743, 0.0540,
        0.1132])
[rfa agg] iter:  3, prev_obj_val: 67.29476165771484, obj_val: 67.29460144042969, abs dis: 0.00016021728515625
[rfa agg] iter: 3, weight: tensor([0.0951, 0.0200, 0.0637, 0.2054, 0.0689, 0.1115, 0.0961, 0.1720, 0.0539,
        0.1133])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 15.2577, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 9.8064, Accuracy: 7/9950 (0.0704%)
saving model
Done in 374.6401698589325 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0823, Accuracy: 106/603 (17.5788%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0502, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.0200, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1549, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1426, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.6067, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0664, Accuracy: 337/1742 (19.3456%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0351, Accuracy: 652/1742 (37.4282%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9041, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0792, Accuracy: 96/530 (18.1132%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0409, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.4130, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0886, Accuracy: 39/682 (5.7185%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0401, Accuracy: 279/682 (40.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.9794, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0571, Accuracy: 348/1715 (20.2915%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0319, Accuracy: 698/1715 (40.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8024, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0769, Accuracy: 156/677 (23.0428%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0252, Accuracy: 461/677 (68.0945%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 12.9105, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0690, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0402, Accuracy: 380/1241 (30.6205%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7397, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0668, Accuracy: 281/1956 (14.3661%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0351, Accuracy: 546/1956 (27.9141%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0462, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0666, Accuracy: 286/1418 (20.1693%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0335, Accuracy: 539/1418 (38.0113%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.9427, Accuracy: 96/10000 (0.9600%)
time spent on training: 264.7134687900543
[rfa agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 61, 93, 18, 80, 92, 90, 72, 6, 70], weight: tensor([0.0566, 0.0080, 0.1636, 0.0498, 0.0640, 0.1610, 0.0636, 0.1165, 0.1837,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 71.65681457519531, obj_val: 74.3155746459961, abs dis: 2.6587600708007812
[rfa agg] iter: 0, weight: tensor([0.0337, 0.0026, 0.1269, 0.0270, 0.0418, 0.1403, 0.0417, 0.2683, 0.1074,
        0.2104])
[rfa agg] iter:  1, prev_obj_val: 74.3155746459961, obj_val: 72.73342895507812, abs dis: 1.5821456909179688
[rfa agg] iter: 1, weight: tensor([0.0369, 0.0027, 0.1134, 0.0293, 0.0462, 0.1247, 0.0462, 0.3154, 0.0981,
        0.1871])
[rfa agg] iter:  2, prev_obj_val: 72.73342895507812, obj_val: 74.28570556640625, abs dis: 1.552276611328125
[rfa agg] iter: 2, weight: tensor([0.0334, 0.0025, 0.1129, 0.0266, 0.0416, 0.1246, 0.0415, 0.3298, 0.0969,
        0.1902])
[rfa agg] iter:  3, prev_obj_val: 74.28570556640625, obj_val: 75.99853515625, abs dis: 1.71282958984375
[rfa agg] iter: 3, weight: tensor([0.0360, 0.0026, 0.1103, 0.0286, 0.0451, 0.1212, 0.0450, 0.3356, 0.0956,
        0.1801])
[rfa agg] iter:  4, prev_obj_val: 75.99853515625, obj_val: 74.28511047363281, abs dis: 1.7134246826171875
[rfa agg] iter: 4, weight: tensor([0.0395, 0.0028, 0.1097, 0.0312, 0.0498, 0.1198, 0.0497, 0.3290, 0.0960,
        0.1726])
[rfa agg] iter:  5, prev_obj_val: 74.28511047363281, obj_val: 75.9985122680664, abs dis: 1.7134017944335938
[rfa agg] iter: 5, weight: tensor([0.0360, 0.0026, 0.1102, 0.0285, 0.0451, 0.1208, 0.0450, 0.3379, 0.0955,
        0.1784])
[rfa agg] iter:  6, prev_obj_val: 75.9985122680664, obj_val: 74.28504943847656, abs dis: 1.7134628295898438
[rfa agg] iter: 6, weight: tensor([0.0395, 0.0028, 0.1096, 0.0312, 0.0497, 0.1197, 0.0496, 0.3297, 0.0959,
        0.1723])
[rfa agg] iter:  7, prev_obj_val: 74.28504943847656, obj_val: 75.99851989746094, abs dis: 1.713470458984375
[rfa agg] iter: 7, weight: tensor([0.0360, 0.0026, 0.1101, 0.0285, 0.0451, 0.1208, 0.0450, 0.3382, 0.0954,
        0.1783])
[rfa agg] iter:  8, prev_obj_val: 75.99851989746094, obj_val: 74.28504943847656, abs dis: 1.713470458984375
[rfa agg] iter: 8, weight: tensor([0.0395, 0.0028, 0.1096, 0.0312, 0.0497, 0.1197, 0.0496, 0.3298, 0.0959,
        0.1723])
[rfa agg] iter:  9, prev_obj_val: 74.28504943847656, obj_val: 75.99852752685547, abs dis: 1.7134780883789062
[rfa agg] iter: 9, weight: tensor([0.0360, 0.0026, 0.1101, 0.0285, 0.0451, 0.1208, 0.0450, 0.3382, 0.0954,
        0.1783])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7630, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.3550, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.44422674179077 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0671, Accuracy: 237/946 (25.0529%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 334/946 (35.3066%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1536, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0819, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0510, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1203, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0638, Accuracy: 227/599 (37.8965%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0309, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 14.1420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0656, Accuracy: 187/1071 (17.4603%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0312, Accuracy: 481/1071 (44.9113%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.6371, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0537, Accuracy: 310/1628 (19.0418%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 716/1628 (43.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.9847, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0707, Accuracy: 130/938 (13.8593%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8402, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 230/888 (25.9009%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 416/888 (46.8468%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.4673, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0682, Accuracy: 198/1131 (17.5066%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0320, Accuracy: 479/1131 (42.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.0322, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0607, Accuracy: 292/1645 (17.7508%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0352, Accuracy: 565/1645 (34.3465%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1165, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0931, Accuracy: 10/466 (2.1459%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0547, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4614, Accuracy: 55/10000 (0.5500%)
time spent on training: 268.6858868598938
[rfa agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 82, 95, 55, 5, 73, 63, 38, 13, 76], weight: tensor([0.0964, 0.0510, 0.0610, 0.1092, 0.1659, 0.0956, 0.0905, 0.1153, 0.1677,
        0.0475])
[rfa agg] iter:  0, prev_obj_val: 57.63076400756836, obj_val: 62.447940826416016, abs dis: 4.817176818847656
[rfa agg] iter: 0, weight: tensor([0.1875, 0.0302, 0.0474, 0.1381, 0.0635, 0.1604, 0.1612, 0.1195, 0.0643,
        0.0278])
[rfa agg] iter:  1, prev_obj_val: 62.447940826416016, obj_val: 62.424495697021484, abs dis: 0.02344512939453125
[rfa agg] iter: 1, weight: tensor([0.1788, 0.0388, 0.0641, 0.1136, 0.0582, 0.1549, 0.1994, 0.0976, 0.0589,
        0.0356])
[rfa agg] iter:  2, prev_obj_val: 62.424495697021484, obj_val: 64.762939453125, abs dis: 2.3384437561035156
[rfa agg] iter: 2, weight: tensor([0.1774, 0.0387, 0.0642, 0.1116, 0.0577, 0.1533, 0.2071, 0.0962, 0.0584,
        0.0354])
[rfa agg] iter:  3, prev_obj_val: 64.762939453125, obj_val: 64.76029205322266, abs dis: 0.00264739990234375
[rfa agg] iter: 3, weight: tensor([0.1661, 0.0445, 0.0752, 0.1087, 0.0592, 0.1474, 0.2033, 0.0949, 0.0599,
        0.0407])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.7956, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.5273, Accuracy: 0/9950 (0.0000%)
saving model
Done in 366.4968693256378 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0676, Accuracy: 212/807 (26.2701%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0341, Accuracy: 406/807 (50.3098%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3791, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0717, Accuracy: 188/715 (26.2937%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0455, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8330, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0643, Accuracy: 269/803 (33.4994%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0364, Accuracy: 420/803 (52.3039%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.9779, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0655, Accuracy: 236/946 (24.9471%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0377, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2856, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0818, Accuracy: 29/500 (5.8000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 197/500 (39.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0177, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0654, Accuracy: 192/1513 (12.6900%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0390, Accuracy: 443/1513 (29.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.6472, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 409/708 (57.7684%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.0722, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0750, Accuracy: 252/1003 (25.1246%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0370, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1726, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0680, Accuracy: 163/1049 (15.5386%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0332, Accuracy: 471/1049 (44.8999%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.5762, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0703, Accuracy: 123/568 (21.6549%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0439, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1328, Accuracy: 44/10000 (0.4400%)
time spent on training: 227.74047017097473
[rfa agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 23, 58, 43, 82, 8, 16, 86, 51, 62], weight: tensor([0.0937, 0.0830, 0.0932, 0.1098, 0.0581, 0.1757, 0.0822, 0.1165, 0.1218,
        0.0660])
[rfa agg] iter:  0, prev_obj_val: 45.44491958618164, obj_val: 51.50448989868164, abs dis: 6.0595703125
[rfa agg] iter: 0, weight: tensor([0.1456, 0.1069, 0.1789, 0.1207, 0.0435, 0.0557, 0.1003, 0.1007, 0.0869,
        0.0610])
[rfa agg] iter:  1, prev_obj_val: 51.50448989868164, obj_val: 54.14937973022461, abs dis: 2.6448898315429688
[rfa agg] iter: 1, weight: tensor([0.1326, 0.1188, 0.1499, 0.1010, 0.0667, 0.0553, 0.1122, 0.0874, 0.0777,
        0.0983])
[rfa agg] iter:  2, prev_obj_val: 54.14937973022461, obj_val: 54.144203186035156, abs dis: 0.005176544189453125
[rfa agg] iter: 2, weight: tensor([0.1231, 0.1180, 0.1351, 0.0961, 0.0793, 0.0559, 0.1120, 0.0846, 0.0759,
        0.1201])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8247, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.6785, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.1138331890106 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0677, Accuracy: 220/807 (27.2615%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0345, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6819, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0950, Accuracy: 11/486 (2.2634%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0463, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.5927, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0651, Accuracy: 228/946 (24.1015%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3933, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0854, Accuracy: 91/603 (15.0912%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0513, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9970, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0578, Accuracy: 207/590 (35.0847%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.8644, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1163, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.1002, Accuracy: 17/197 (8.6294%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.5295, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0792, Accuracy: 29/500 (5.8000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 197/500 (39.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1195, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0657, Accuracy: 244/901 (27.0810%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.6373, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0680, Accuracy: 280/1163 (24.0757%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0389, Accuracy: 433/1163 (37.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1550, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0516, Accuracy: 415/1552 (26.7397%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 729/1552 (46.9716%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.1795, Accuracy: 91/10000 (0.9100%)
time spent on training: 222.70369911193848
[rfa agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 30, 43, 88, 69, 79, 82, 4, 68, 74], weight: tensor([0.1042, 0.0628, 0.1221, 0.0779, 0.0762, 0.0254, 0.0646, 0.1163, 0.1502,
        0.2004])
[rfa agg] iter:  0, prev_obj_val: 53.17430877685547, obj_val: 59.378440856933594, abs dis: 6.204132080078125
[rfa agg] iter: 0, weight: tensor([0.1845, 0.0467, 0.1920, 0.0872, 0.0825, 0.0108, 0.0484, 0.1624, 0.1101,
        0.0754])
[rfa agg] iter:  1, prev_obj_val: 59.378440856933594, obj_val: 57.5311279296875, abs dis: 1.8473129272460938
[rfa agg] iter: 1, weight: tensor([0.1550, 0.0734, 0.1209, 0.1650, 0.1448, 0.0137, 0.0768, 0.1083, 0.0797,
        0.0624])
[rfa agg] iter:  2, prev_obj_val: 57.5311279296875, obj_val: 57.527191162109375, abs dis: 0.003936767578125
[rfa agg] iter: 2, weight: tensor([0.1678, 0.0672, 0.1296, 0.1552, 0.1374, 0.0130, 0.0698, 0.1136, 0.0829,
        0.0635])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 18.2795, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 16.9073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.8370940685272 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0664, Accuracy: 280/1956 (14.3149%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0360, Accuracy: 559/1956 (28.5787%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8339, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0704, Accuracy: 124/938 (13.2196%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0640, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 195/776 (25.1289%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0322, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.0303, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0758, Accuracy: 132/773 (17.0763%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.6760, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0708, Accuracy: 215/1154 (18.6308%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0323, Accuracy: 420/1154 (36.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.1247, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0669, Accuracy: 189/1513 (12.4917%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0391, Accuracy: 433/1513 (28.6186%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8363, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0593, Accuracy: 297/1036 (28.6680%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0267, Accuracy: 625/1036 (60.3282%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.4603, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0945, Accuracy: 2/311 (0.6431%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0629, Accuracy: 86/311 (27.6527%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1794, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1466, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1314, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3631, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0657, Accuracy: 345/1475 (23.3898%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0363, Accuracy: 538/1475 (36.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7883, Accuracy: 79/10000 (0.7900%)
time spent on training: 279.9764316082001
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 73, 75, 99, 15, 8, 19, 96, 47, 65], weight: tensor([0.1943, 0.0932, 0.0771, 0.0768, 0.1146, 0.1503, 0.1029, 0.0309, 0.0133,
        0.1465])
[rfa agg] iter:  0, prev_obj_val: 64.88799285888672, obj_val: 68.20745086669922, abs dis: 3.3194580078125
[rfa agg] iter: 0, weight: tensor([0.0942, 0.1157, 0.0692, 0.0671, 0.1775, 0.1523, 0.1683, 0.0127, 0.0047,
        0.1383])
[rfa agg] iter:  1, prev_obj_val: 68.20745086669922, obj_val: 71.07040405273438, abs dis: 2.8629531860351562
[rfa agg] iter: 1, weight: tensor([0.0762, 0.1599, 0.0870, 0.0827, 0.1564, 0.1106, 0.2054, 0.0138, 0.0049,
        0.1031])
[rfa agg] iter:  2, prev_obj_val: 71.07040405273438, obj_val: 71.03919982910156, abs dis: 0.0312042236328125
[rfa agg] iter: 2, weight: tensor([0.0694, 0.1970, 0.1009, 0.0945, 0.1323, 0.0955, 0.2010, 0.0145, 0.0051,
        0.0897])
[rfa agg] iter:  3, prev_obj_val: 71.03919982910156, obj_val: 71.0384750366211, abs dis: 0.00072479248046875
[rfa agg] iter: 3, weight: tensor([0.0686, 0.2049, 0.1008, 0.0944, 0.1286, 0.0942, 0.2006, 0.0144, 0.0051,
        0.0885])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8418, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.5760, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.6492078304291 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 63/631 (9.9842%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6821, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0534, Accuracy: 318/1628 (19.5332%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 698/1628 (42.8747%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.2408, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0699, Accuracy: 119/938 (12.6866%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 319/938 (34.0085%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.5470, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0627, Accuracy: 272/896 (30.3571%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3330, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0731, Accuracy: 181/774 (23.3850%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0400, Accuracy: 335/774 (43.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5787, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0781, Accuracy: 171/715 (23.9161%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0421, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5059, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0684, Accuracy: 117/735 (15.9184%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 348/735 (47.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 13.5321, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0560, Accuracy: 304/1340 (22.6866%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 557/1340 (41.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.8079, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0774, Accuracy: 93/530 (17.5472%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.4764, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0572, Accuracy: 373/1953 (19.0988%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 707/1953 (36.2007%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6158, Accuracy: 106/10000 (1.0600%)
time spent on training: 281.15120029449463
[rfa agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 5, 73, 89, 81, 23, 32, 77, 18, 83], weight: tensor([0.0622, 0.1606, 0.0925, 0.0884, 0.0763, 0.0705, 0.0725, 0.1321, 0.0523,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 69.30452728271484, obj_val: 72.16268157958984, abs dis: 2.858154296875
[rfa agg] iter: 0, weight: tensor([0.0555, 0.0881, 0.1788, 0.1593, 0.1086, 0.0788, 0.0868, 0.1319, 0.0398,
        0.0723])
[rfa agg] iter:  1, prev_obj_val: 72.16268157958984, obj_val: 73.52892303466797, abs dis: 1.366241455078125
[rfa agg] iter: 1, weight: tensor([0.0661, 0.0623, 0.1689, 0.1855, 0.1345, 0.0900, 0.1099, 0.0848, 0.0444,
        0.0537])
[rfa agg] iter:  2, prev_obj_val: 73.52892303466797, obj_val: 75.23274230957031, abs dis: 1.7038192749023438
[rfa agg] iter: 2, weight: tensor([0.0721, 0.0586, 0.1507, 0.1810, 0.1448, 0.0951, 0.1218, 0.0776, 0.0473,
        0.0511])
[rfa agg] iter:  3, prev_obj_val: 75.23274230957031, obj_val: 77.22750854492188, abs dis: 1.9947662353515625
[rfa agg] iter: 3, weight: tensor([0.0804, 0.0563, 0.1352, 0.1682, 0.1501, 0.1008, 0.1347, 0.0731, 0.0516,
        0.0496])
[rfa agg] iter:  4, prev_obj_val: 77.22750854492188, obj_val: 79.50849151611328, abs dis: 2.2809829711914062
[rfa agg] iter: 4, weight: tensor([0.0915, 0.0547, 0.1225, 0.1527, 0.1496, 0.1062, 0.1473, 0.0697, 0.0571,
        0.0487])
[rfa agg] iter:  5, prev_obj_val: 79.50849151611328, obj_val: 82.0648193359375, abs dis: 2.5563278198242188
[rfa agg] iter: 5, weight: tensor([0.1058, 0.0537, 0.1124, 0.1382, 0.1436, 0.1102, 0.1567, 0.0672, 0.0642,
        0.0482])
[rfa agg] iter:  6, prev_obj_val: 82.0648193359375, obj_val: 82.06031036376953, abs dis: 0.00450897216796875
[rfa agg] iter: 6, weight: tensor([0.1239, 0.0532, 0.1044, 0.1262, 0.1343, 0.1121, 0.1593, 0.0655, 0.0730,
        0.0481])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8888, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.2661, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.40140676498413 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0902, Accuracy: 22/486 (4.5267%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0457, Accuracy: 227/486 (46.7078%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.8775, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0569, Accuracy: 296/708 (41.8079%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0409, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.5720, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 213/888 (23.9865%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.5949, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0773, Accuracy: 145/677 (21.4180%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 472/677 (69.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.5409, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0824, Accuracy: 15/515 (2.9126%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0543, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.1605, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0929, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0547, Accuracy: 100/373 (26.8097%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8731, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0662, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 251/781 (32.1383%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3878, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0741, Accuracy: 94/568 (16.5493%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0447, Accuracy: 260/568 (45.7746%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8384, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0667, Accuracy: 261/1949 (13.3915%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 616/1949 (31.6060%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3588, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0566, Accuracy: 313/1036 (30.2124%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0267, Accuracy: 622/1036 (60.0386%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.1299, Accuracy: 78/10000 (0.7800%)
time spent on training: 240.60970425605774
[rfa agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 16, 63, 90, 33, 98, 3, 62, 21, 19], weight: tensor([0.0609, 0.0887, 0.1113, 0.0848, 0.0645, 0.0467, 0.0979, 0.0712, 0.2442,
        0.1298])
[rfa agg] iter:  0, prev_obj_val: 68.00233459472656, obj_val: 69.8141098022461, abs dis: 1.8117752075195312
[rfa agg] iter: 0, weight: tensor([0.0437, 0.1139, 0.1990, 0.1025, 0.0507, 0.0257, 0.1697, 0.0595, 0.0724,
        0.1630])
[rfa agg] iter:  1, prev_obj_val: 69.8141098022461, obj_val: 72.89478302001953, abs dis: 3.0806732177734375
[rfa agg] iter: 1, weight: tensor([0.0624, 0.1343, 0.1381, 0.1712, 0.0683, 0.0318, 0.1586, 0.0919, 0.0528,
        0.0905])
[rfa agg] iter:  2, prev_obj_val: 72.89478302001953, obj_val: 72.86072540283203, abs dis: 0.0340576171875
[rfa agg] iter: 2, weight: tensor([0.0796, 0.1229, 0.1115, 0.1897, 0.0814, 0.0375, 0.1270, 0.1212, 0.0506,
        0.0783])
[rfa agg] iter:  3, prev_obj_val: 72.86072540283203, obj_val: 72.86029815673828, abs dis: 0.00042724609375
[rfa agg] iter: 3, weight: tensor([0.0804, 0.1202, 0.1095, 0.1946, 0.0823, 0.0375, 0.1240, 0.1241, 0.0501,
        0.0774])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8324, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.1763, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.21569180488586 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0618, Accuracy: 270/1446 (18.6722%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0367, Accuracy: 465/1446 (32.1577%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3478, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0778, Accuracy: 140/773 (18.1113%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 411/773 (53.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.6916, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0843, Accuracy: 20/515 (3.8835%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5920, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0595, Accuracy: 225/599 (37.5626%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 14.1274, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0681, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0371, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.0132, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0746, Accuracy: 119/818 (14.5477%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.0112, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0925, Accuracy: 34/682 (4.9853%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0425, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.1031, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0506, Accuracy: 285/712 (40.0281%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.4274, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0650, Accuracy: 247/803 (30.7597%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0369, Accuracy: 436/803 (54.2964%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4875, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0725, Accuracy: 218/1131 (19.2750%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0355, Accuracy: 361/1131 (31.9187%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4731, Accuracy: 60/10000 (0.6000%)
time spent on training: 282.48268961906433
[rfa agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [26, 99, 33, 95, 3, 71, 80, 11, 58, 87], weight: tensor([0.1751, 0.0936, 0.0623, 0.0725, 0.0946, 0.0990, 0.0826, 0.0862, 0.0972,
        0.1369])
[rfa agg] iter:  0, prev_obj_val: 42.99075698852539, obj_val: 52.85528564453125, abs dis: 9.86452865600586
[rfa agg] iter: 0, weight: tensor([0.0578, 0.1056, 0.0468, 0.0693, 0.1403, 0.1330, 0.1093, 0.1129, 0.1465,
        0.0787])
[rfa agg] iter:  1, prev_obj_val: 52.85528564453125, obj_val: 52.7895393371582, abs dis: 0.06574630737304688
[rfa agg] iter: 1, weight: tensor([0.0560, 0.0932, 0.0779, 0.1134, 0.1090, 0.1084, 0.1451, 0.1155, 0.1133,
        0.0682])
[rfa agg] iter:  2, prev_obj_val: 52.7895393371582, obj_val: 52.78881072998047, abs dis: 0.000728607177734375
[rfa agg] iter: 2, weight: tensor([0.0555, 0.0916, 0.0803, 0.1192, 0.1064, 0.1059, 0.1483, 0.1141, 0.1112,
        0.0675])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.8527, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 3.5548, Accuracy: 0/9950 (0.0000%)
saving model
Done in 374.410080909729 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0676, Accuracy: 177/1513 (11.6986%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0397, Accuracy: 399/1513 (26.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.7830, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 328/1129 (29.0523%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 681/1129 (60.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6890, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0740, Accuracy: 120/773 (15.5239%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0411, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.2696, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0757, Accuracy: 82/568 (14.4366%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0448, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9427, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0855, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0526, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8328, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0676, Accuracy: 227/946 (23.9958%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3947, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0664, Accuracy: 247/1657 (14.9065%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0376, Accuracy: 447/1657 (26.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.1102, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0595, Accuracy: 302/1030 (29.3204%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0291, Accuracy: 562/1030 (54.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.0078, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0582, Accuracy: 342/1715 (19.9417%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0334, Accuracy: 615/1715 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.7149, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0717, Accuracy: 155/636 (24.3711%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0355, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.9545, Accuracy: 52/10000 (0.5200%)
time spent on training: 322.0123291015625
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 37, 99, 62, 49, 43, 0, 91, 92, 52], weight: tensor([0.1454, 0.1085, 0.0743, 0.0546, 0.0423, 0.0909, 0.1592, 0.0990, 0.1648,
        0.0611])
[rfa agg] iter:  0, prev_obj_val: 66.81877136230469, obj_val: 67.90000915527344, abs dis: 1.08123779296875
[rfa agg] iter: 0, weight: tensor([0.1000, 0.1690, 0.1001, 0.0436, 0.0263, 0.1785, 0.0889, 0.1552, 0.0837,
        0.0547])
[rfa agg] iter:  1, prev_obj_val: 67.90000915527344, obj_val: 67.89176940917969, abs dis: 0.00823974609375
[rfa agg] iter: 1, weight: tensor([0.0914, 0.1611, 0.1076, 0.0450, 0.0268, 0.2006, 0.0817, 0.1520, 0.0770,
        0.0569])
[rfa agg] iter:  2, prev_obj_val: 67.89176940917969, obj_val: 67.89147186279297, abs dis: 0.00029754638671875
[rfa agg] iter: 2, weight: tensor([0.0908, 0.1595, 0.1079, 0.0448, 0.0267, 0.2058, 0.0812, 0.1503, 0.0765,
        0.0567])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.8737, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 3.4578, Accuracy: 0/9950 (0.0000%)
saving model
Done in 412.37363481521606 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0721, Accuracy: 224/1131 (19.8055%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0361, Accuracy: 341/1131 (30.1503%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3961, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0694, Accuracy: 117/953 (12.2770%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 283/953 (29.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.0282, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0673, Accuracy: 134/938 (14.2857%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0344, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7928, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0792, Accuracy: 228/1190 (19.1597%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0367, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.2243, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0677, Accuracy: 118/781 (15.1088%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0380, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.4104, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0587, Accuracy: 278/1130 (24.6018%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0303, Accuracy: 483/1130 (42.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.1959, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0857, Accuracy: 39/682 (5.7185%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0420, Accuracy: 272/682 (39.8827%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.0985, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 273/712 (38.3427%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.6563, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0701, Accuracy: 200/807 (24.7831%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0358, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1114, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 226/888 (25.4505%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0274, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.2876, Accuracy: 64/10000 (0.6400%)
time spent on training: 307.83038425445557
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 64, 73, 84, 3, 54, 80, 11, 20, 63], weight: tensor([0.1228, 0.1035, 0.1018, 0.1292, 0.0848, 0.1227, 0.0740, 0.0773, 0.0876,
        0.0964])
[rfa agg] iter:  0, prev_obj_val: 37.49860382080078, obj_val: 41.77545166015625, abs dis: 4.276847839355469
[rfa agg] iter: 0, weight: tensor([0.0770, 0.1191, 0.1114, 0.0667, 0.1214, 0.0769, 0.0835, 0.0987, 0.1197,
        0.1257])
[rfa agg] iter:  1, prev_obj_val: 41.77545166015625, obj_val: 41.76066207885742, abs dis: 0.014789581298828125
[rfa agg] iter: 1, weight: tensor([0.0710, 0.1045, 0.0997, 0.0623, 0.1259, 0.0705, 0.1078, 0.1165, 0.1256,
        0.1163])
[rfa agg] iter:  2, prev_obj_val: 41.76066207885742, obj_val: 41.760498046875, abs dis: 0.000164031982421875
[rfa agg] iter: 2, weight: tensor([0.0707, 0.1034, 0.0987, 0.0619, 0.1259, 0.0700, 0.1099, 0.1189, 0.1258,
        0.1148])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.8384, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 3.2782, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 404.70200395584106 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0713, Accuracy: 236/901 (26.1931%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0347, Accuracy: 413/901 (45.8380%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6359, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0728, Accuracy: 156/818 (19.0709%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0351, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8249, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0524, Accuracy: 330/1275 (25.8824%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 698/1275 (54.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.4560, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0593, Accuracy: 261/1130 (23.0973%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0317, Accuracy: 448/1130 (39.6460%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0000, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0835, Accuracy: 17/500 (3.4000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0499, Accuracy: 196/500 (39.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0230, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0709, Accuracy: 179/1131 (15.8267%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0332, Accuracy: 475/1131 (41.9982%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.1817, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0616, Accuracy: 296/708 (41.8079%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0368, Accuracy: 409/708 (57.7684%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8498, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0720, Accuracy: 224/1131 (19.8055%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0349, Accuracy: 390/1131 (34.4828%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.3754, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0558, Accuracy: 330/1030 (32.0388%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0299, Accuracy: 587/1030 (56.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.1030, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0672, Accuracy: 338/1427 (23.6861%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0370, Accuracy: 545/1427 (38.1920%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4699, Accuracy: 65/10000 (0.6500%)
time spent on training: 304.117604970932
[rfa agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 71, 9, 54, 82, 38, 16, 87, 91, 34], weight: tensor([0.0896, 0.0814, 0.1269, 0.1124, 0.0497, 0.1125, 0.0704, 0.1125, 0.1025,
        0.1420])
[rfa agg] iter:  0, prev_obj_val: 43.85196304321289, obj_val: 47.23379135131836, abs dis: 3.3818283081054688
[rfa agg] iter: 0, weight: tensor([0.1267, 0.0982, 0.1057, 0.1274, 0.0278, 0.1151, 0.0645, 0.1407, 0.1160,
        0.0778])
[rfa agg] iter:  1, prev_obj_val: 47.23379135131836, obj_val: 49.32204818725586, abs dis: 2.0882568359375
[rfa agg] iter: 1, weight: tensor([0.1392, 0.1236, 0.0961, 0.1155, 0.0333, 0.1064, 0.0781, 0.1237, 0.1109,
        0.0732])
[rfa agg] iter:  2, prev_obj_val: 49.32204818725586, obj_val: 49.31544494628906, abs dis: 0.006603240966796875
[rfa agg] iter: 2, weight: tensor([0.1395, 0.1405, 0.0920, 0.1091, 0.0367, 0.1020, 0.0871, 0.1152, 0.1062,
        0.0717])
[rfa agg] iter:  3, prev_obj_val: 49.31544494628906, obj_val: 49.315345764160156, abs dis: 9.918212890625e-05
[rfa agg] iter: 3, weight: tensor([0.1390, 0.1432, 0.0916, 0.1086, 0.0367, 0.1016, 0.0878, 0.1144, 0.1055,
        0.0716])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8805, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 3.1846, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 398.1421673297882 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0614, Accuracy: 450/2227 (20.2066%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0307, Accuracy: 906/2227 (40.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6127, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0641, Accuracy: 295/708 (41.6667%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0286, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0911, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0529, Accuracy: 118/373 (31.6354%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7873, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0864, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0482, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.7199, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0880, Accuracy: 20/440 (4.5455%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0546, Accuracy: 140/440 (31.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9515, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0844, Accuracy: 86/603 (14.2620%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0508, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7869, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0686, Accuracy: 263/1418 (18.5472%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0345, Accuracy: 525/1418 (37.0240%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7938, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0639, Accuracy: 237/1089 (21.7631%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0314, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.9818, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0653, Accuracy: 341/1742 (19.5752%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0353, Accuracy: 645/1742 (37.0264%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.8699, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0625, Accuracy: 320/1587 (20.1638%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0353, Accuracy: 530/1587 (33.3963%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5207, Accuracy: 77/10000 (0.7700%)
time spent on training: 315.47694087028503
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 16, 98, 30, 49, 88, 70, 59, 93, 27], weight: tensor([0.2087, 0.0663, 0.0349, 0.0455, 0.0412, 0.0565, 0.1329, 0.1020, 0.1632,
        0.1487])
[rfa agg] iter:  0, prev_obj_val: 85.47953796386719, obj_val: 86.48179626464844, abs dis: 1.00225830078125
[rfa agg] iter: 0, weight: tensor([0.1108, 0.0578, 0.0187, 0.0284, 0.0237, 0.0416, 0.2319, 0.1176, 0.1585,
        0.2111])
[rfa agg] iter:  1, prev_obj_val: 86.48179626464844, obj_val: 86.47959899902344, abs dis: 0.002197265625
[rfa agg] iter: 1, weight: tensor([0.1073, 0.0611, 0.0194, 0.0297, 0.0247, 0.0438, 0.2355, 0.1231, 0.1521,
        0.2032])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8784, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 3.2450, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 413.50563049316406 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0634, Accuracy: 283/1657 (17.0791%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0368, Accuracy: 477/1657 (28.7870%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9514, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0526, Accuracy: 239/888 (26.9144%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0275, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 11.2261, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1508, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1309, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6912, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0606, Accuracy: 211/776 (27.1907%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 440/776 (56.7010%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.7441, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0667, Accuracy: 226/1213 (18.6315%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0307, Accuracy: 513/1213 (42.2918%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2940, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0922, Accuracy: 8/271 (2.9520%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0627, Accuracy: 93/271 (34.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2159, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0532, Accuracy: 267/690 (38.6957%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0261, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.0258, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0821, Accuracy: 87/603 (14.4279%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.1478, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 99/530 (18.6792%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2172, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0547, Accuracy: 314/1030 (30.4854%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0262, Accuracy: 575/1030 (55.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.8705, Accuracy: 105/10000 (1.0500%)
time spent on training: 237.24091863632202
[rfa agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 63, 47, 75, 97, 35, 25, 88, 18, 91], weight: tensor([0.2127, 0.1140, 0.0172, 0.0996, 0.1557, 0.0348, 0.0886, 0.0774, 0.0680,
        0.1322])
[rfa agg] iter:  0, prev_obj_val: 57.83551788330078, obj_val: 59.317710876464844, abs dis: 1.4821929931640625
[rfa agg] iter: 0, weight: tensor([0.0845, 0.2003, 0.0068, 0.1762, 0.1322, 0.0175, 0.1059, 0.0797, 0.0582,
        0.1386])
[rfa agg] iter:  1, prev_obj_val: 59.317710876464844, obj_val: 62.215572357177734, abs dis: 2.8978614807128906
[rfa agg] iter: 1, weight: tensor([0.0736, 0.1982, 0.0070, 0.1990, 0.1085, 0.0183, 0.1238, 0.0920, 0.0650,
        0.1147])
[rfa agg] iter:  2, prev_obj_val: 62.215572357177734, obj_val: 64.037109375, abs dis: 1.8215370178222656
[rfa agg] iter: 2, weight: tensor([0.0694, 0.1704, 0.0076, 0.1908, 0.0961, 0.0206, 0.1508, 0.1154, 0.0785,
        0.1002])
[rfa agg] iter:  3, prev_obj_val: 64.037109375, obj_val: 64.02613067626953, abs dis: 0.01097869873046875
[rfa agg] iter: 3, weight: tensor([0.0678, 0.1542, 0.0081, 0.1751, 0.0914, 0.0222, 0.1673, 0.1320, 0.0876,
        0.0945])
[rfa agg] iter:  4, prev_obj_val: 64.02613067626953, obj_val: 64.02588653564453, abs dis: 0.000244140625
[rfa agg] iter: 4, weight: tensor([0.0676, 0.1526, 0.0081, 0.1721, 0.0909, 0.0222, 0.1709, 0.1338, 0.0879,
        0.0939])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 42.1877, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 20.6500, Accuracy: 10/9950 (0.1005%)
saving model
Done in 336.3835709095001 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0605, Accuracy: 199/590 (33.7288%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0307, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 13.0429, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0845, Accuracy: 17/515 (3.3010%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0550, Accuracy: 135/515 (26.2136%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4259, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 176/1013 (17.3741%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 341/1013 (33.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.8084, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0653, Accuracy: 198/599 (33.0551%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0333, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 14.7297, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0622, Accuracy: 284/1662 (17.0878%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0363, Accuracy: 509/1662 (30.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.0779, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.1044, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0576, Accuracy: 89/312 (28.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1403, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0701, Accuracy: 162/636 (25.4717%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0348, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.9973, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0688, Accuracy: 332/1988 (16.7002%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0383, Accuracy: 570/1988 (28.6720%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8355, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0779, Accuracy: 88/530 (16.6038%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 284/530 (53.5849%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.4895, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0702, Accuracy: 165/1049 (15.7293%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0339, Accuracy: 446/1049 (42.5167%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.9866, Accuracy: 95/10000 (0.9500%)
time spent on training: 261.1435396671295
[rfa agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 33, 14, 95, 94, 24, 52, 85, 18, 51], weight: tensor([0.0663, 0.0579, 0.1139, 0.0673, 0.1869, 0.0351, 0.0715, 0.2235, 0.0596,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 82.23944091796875, obj_val: 83.3613510131836, abs dis: 1.1219100952148438
[rfa agg] iter: 0, weight: tensor([0.0600, 0.0450, 0.2406, 0.0607, 0.1485, 0.0194, 0.0633, 0.1058, 0.0479,
        0.2087])
[rfa agg] iter:  1, prev_obj_val: 83.3613510131836, obj_val: 85.16266632080078, abs dis: 1.8013153076171875
[rfa agg] iter: 1, weight: tensor([0.0756, 0.0530, 0.2630, 0.0757, 0.1055, 0.0212, 0.0791, 0.0809, 0.0585,
        0.1873])
[rfa agg] iter:  2, prev_obj_val: 85.16266632080078, obj_val: 87.48709869384766, abs dis: 2.324432373046875
[rfa agg] iter: 2, weight: tensor([0.0908, 0.0610, 0.2320, 0.0903, 0.0979, 0.0235, 0.0942, 0.0773, 0.0689,
        0.1642])
[rfa agg] iter:  3, prev_obj_val: 87.48709869384766, obj_val: 88.78870391845703, abs dis: 1.301605224609375
[rfa agg] iter: 3, weight: tensor([0.1102, 0.0700, 0.1872, 0.1085, 0.0904, 0.0259, 0.1121, 0.0732, 0.0815,
        0.1411])
[rfa agg] iter:  4, prev_obj_val: 88.78870391845703, obj_val: 88.77928161621094, abs dis: 0.00942230224609375
[rfa agg] iter: 4, weight: tensor([0.1219, 0.0743, 0.1641, 0.1190, 0.0854, 0.0269, 0.1216, 0.0700, 0.0884,
        0.1284])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 23.5352, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 15.5353, Accuracy: 1/9950 (0.0101%)
saving model
Done in 356.20305824279785 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0629, Accuracy: 282/896 (31.4732%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0351, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.6288, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0614, Accuracy: 349/1904 (18.3298%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0329, Accuracy: 660/1904 (34.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5892, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0781, Accuracy: 111/809 (13.7206%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0337, Accuracy: 280/809 (34.6106%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.8525, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0739, Accuracy: 143/677 (21.1226%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 13.3116, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0780, Accuracy: 250/1003 (24.9252%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0397, Accuracy: 393/1003 (39.1825%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3732, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0981, Accuracy: 12/466 (2.5751%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0552, Accuracy: 176/466 (37.7682%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2060, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 139/938 (14.8188%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0350, Accuracy: 329/938 (35.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.0450, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0606, Accuracy: 468/2227 (21.0148%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 927/2227 (41.6255%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.4039, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0990, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0658, Accuracy: 69/311 (22.1865%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2353, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 207/776 (26.6753%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.1279, Accuracy: 79/10000 (0.7900%)
time spent on training: 293.4176998138428
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 46, 50, 90, 86, 76, 73, 60, 96, 75], weight: tensor([0.0895, 0.1903, 0.0808, 0.0677, 0.1002, 0.0466, 0.0937, 0.2225, 0.0311,
        0.0775])
[rfa agg] iter:  0, prev_obj_val: 88.25799560546875, obj_val: 86.65735626220703, abs dis: 1.6006393432617188
[rfa agg] iter: 0, weight: tensor([0.1170, 0.1313, 0.0974, 0.0635, 0.1913, 0.0321, 0.1528, 0.1065, 0.0168,
        0.0913])
[rfa agg] iter:  1, prev_obj_val: 86.65735626220703, obj_val: 89.91130065917969, abs dis: 3.2539443969726562
[rfa agg] iter: 1, weight: tensor([0.1306, 0.0717, 0.1138, 0.0660, 0.2226, 0.0295, 0.1873, 0.0617, 0.0143,
        0.1024])
[rfa agg] iter:  2, prev_obj_val: 89.91130065917969, obj_val: 91.424560546875, abs dis: 1.5132598876953125
[rfa agg] iter: 2, weight: tensor([0.1425, 0.0566, 0.1540, 0.0863, 0.1590, 0.0339, 0.1736, 0.0503, 0.0153,
        0.1287])
[rfa agg] iter:  3, prev_obj_val: 91.424560546875, obj_val: 93.29012298583984, abs dis: 1.8655624389648438
[rfa agg] iter: 3, weight: tensor([0.1425, 0.0546, 0.1722, 0.0965, 0.1375, 0.0362, 0.1579, 0.0488, 0.0160,
        0.1378])
[rfa agg] iter:  4, prev_obj_val: 93.29012298583984, obj_val: 95.45824432373047, abs dis: 2.168121337890625
[rfa agg] iter: 4, weight: tensor([0.1384, 0.0535, 0.1831, 0.1094, 0.1245, 0.0394, 0.1433, 0.0482, 0.0170,
        0.1432])
[rfa agg] iter:  5, prev_obj_val: 95.45824432373047, obj_val: 97.90669250488281, abs dis: 2.4484481811523438
[rfa agg] iter: 5, weight: tensor([0.1328, 0.0533, 0.1856, 0.1258, 0.1154, 0.0436, 0.1316, 0.0483, 0.0183,
        0.1452])
[rfa agg] iter:  6, prev_obj_val: 97.90669250488281, obj_val: 95.45709228515625, abs dis: 2.4496002197265625
[rfa agg] iter: 6, weight: tensor([0.1272, 0.0537, 0.1796, 0.1458, 0.1089, 0.0491, 0.1230, 0.0490, 0.0200,
        0.1437])
[rfa agg] iter:  7, prev_obj_val: 95.45709228515625, obj_val: 97.90555572509766, abs dis: 2.4484634399414062
[rfa agg] iter: 7, weight: tensor([0.1307, 0.0531, 0.1858, 0.1296, 0.1147, 0.0438, 0.1301, 0.0482, 0.0183,
        0.1458])
[rfa agg] iter:  8, prev_obj_val: 97.90555572509766, obj_val: 95.45722961425781, abs dis: 2.4483261108398438
[rfa agg] iter: 8, weight: tensor([0.1269, 0.0536, 0.1797, 0.1463, 0.1088, 0.0491, 0.1228, 0.0489, 0.0200,
        0.1438])
[rfa agg] iter:  9, prev_obj_val: 95.45722961425781, obj_val: 97.90554809570312, abs dis: 2.4483184814453125
[rfa agg] iter: 9, weight: tensor([0.1306, 0.0531, 0.1858, 0.1296, 0.1147, 0.0438, 0.1301, 0.0482, 0.0183,
        0.1458])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9379, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.2004, Accuracy: 30/9950 (0.3015%)
saving model
Done in 391.35260033607483 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0633, Accuracy: 224/1089 (20.5693%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0306, Accuracy: 472/1089 (43.3425%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6377, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0581, Accuracy: 315/1030 (30.5825%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0288, Accuracy: 507/1030 (49.2233%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.9412, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0736, Accuracy: 90/530 (16.9811%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 279/530 (52.6415%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.4077, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0754, Accuracy: 176/715 (24.6154%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0449, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1317, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0881, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0554, Accuracy: 139/440 (31.5909%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.6258, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0663, Accuracy: 199/599 (33.2220%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0329, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 15.0445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0597, Accuracy: 481/2227 (21.5986%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0305, Accuracy: 867/2227 (38.9313%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2282, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 292/896 (32.5893%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0344, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0564, Accuracy: 201/813 (24.7232%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0220, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.5586, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0611, Accuracy: 190/1013 (18.7562%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 342/1013 (33.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.1829, Accuracy: 72/10000 (0.7200%)
time spent on training: 278.9129898548126
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 91, 18, 23, 49, 95, 60, 89, 53, 14], weight: tensor([0.1164, 0.1101, 0.0567, 0.0765, 0.0470, 0.0641, 0.2381, 0.0958, 0.0869,
        0.1083])
[rfa agg] iter:  0, prev_obj_val: 77.4582748413086, obj_val: 79.43599700927734, abs dis: 1.97772216796875
[rfa agg] iter: 0, weight: tensor([0.1111, 0.1580, 0.0415, 0.0796, 0.0280, 0.0534, 0.0753, 0.1427, 0.1084,
        0.2020])
[rfa agg] iter:  1, prev_obj_val: 79.43599700927734, obj_val: 86.38037872314453, abs dis: 6.9443817138671875
[rfa agg] iter: 1, weight: tensor([0.0827, 0.1135, 0.0551, 0.1078, 0.0350, 0.0745, 0.0579, 0.1713, 0.1488,
        0.1535])
[rfa agg] iter:  2, prev_obj_val: 86.38037872314453, obj_val: 84.193115234375, abs dis: 2.1872634887695312
[rfa agg] iter: 2, weight: tensor([0.0731, 0.0914, 0.0814, 0.1271, 0.0494, 0.1134, 0.0560, 0.1438, 0.1508,
        0.1136])
[rfa agg] iter:  3, prev_obj_val: 84.193115234375, obj_val: 82.30391693115234, abs dis: 1.8891983032226562
[rfa agg] iter: 3, weight: tensor([0.0733, 0.0931, 0.0744, 0.1279, 0.0448, 0.1052, 0.0554, 0.1498, 0.1582,
        0.1180])
[rfa agg] iter:  4, prev_obj_val: 82.30391693115234, obj_val: 84.1939926147461, abs dis: 1.89007568359375
[rfa agg] iter: 4, weight: tensor([0.0748, 0.0971, 0.0666, 0.1239, 0.0407, 0.0935, 0.0555, 0.1594, 0.1629,
        0.1256])
[rfa agg] iter:  5, prev_obj_val: 84.1939926147461, obj_val: 82.3031005859375, abs dis: 1.8908920288085938
[rfa agg] iter: 5, weight: tensor([0.0734, 0.0934, 0.0736, 0.1271, 0.0446, 0.1035, 0.0554, 0.1513, 0.1593,
        0.1183])
[rfa agg] iter:  6, prev_obj_val: 82.3031005859375, obj_val: 84.19404602050781, abs dis: 1.8909454345703125
[rfa agg] iter: 6, weight: tensor([0.0748, 0.0971, 0.0666, 0.1238, 0.0407, 0.0934, 0.0555, 0.1596, 0.1631,
        0.1256])
[rfa agg] iter:  7, prev_obj_val: 84.19404602050781, obj_val: 82.30308532714844, abs dis: 1.890960693359375
[rfa agg] iter: 7, weight: tensor([0.0734, 0.0934, 0.0736, 0.1271, 0.0446, 0.1035, 0.0554, 0.1513, 0.1593,
        0.1183])
[rfa agg] iter:  8, prev_obj_val: 82.30308532714844, obj_val: 84.19404602050781, abs dis: 1.890960693359375
[rfa agg] iter: 8, weight: tensor([0.0748, 0.0971, 0.0666, 0.1238, 0.0407, 0.0934, 0.0555, 0.1596, 0.1631,
        0.1256])
[rfa agg] iter:  9, prev_obj_val: 84.19404602050781, obj_val: 82.30309295654297, abs dis: 1.8909530639648438
[rfa agg] iter: 9, weight: tensor([0.0734, 0.0934, 0.0736, 0.1271, 0.0446, 0.1035, 0.0554, 0.1513, 0.1593,
        0.1183])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 29.7163, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 13.1240, Accuracy: 52/9950 (0.5226%)
saving model
Done in 376.62046480178833 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0651, Accuracy: 239/803 (29.7634%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0364, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5408, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0852, Accuracy: 9/500 (1.8000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0506, Accuracy: 202/500 (40.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.4349, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.1029, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0594, Accuracy: 123/408 (30.1471%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4491, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1305, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1021, Accuracy: 18/197 (9.1371%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8528, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0611, Accuracy: 460/2227 (20.6556%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0311, Accuracy: 882/2227 (39.6048%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.2488, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0684, Accuracy: 215/807 (26.6419%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0351, Accuracy: 400/807 (49.5663%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6723, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0610, Accuracy: 366/1904 (19.2227%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0331, Accuracy: 666/1904 (34.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4602, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0832, Accuracy: 52/682 (7.6246%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0400, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6074, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.1122, Accuracy: 4/338 (1.1834%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0597, Accuracy: 92/338 (27.2189%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5436, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0879, Accuracy: 35/486 (7.2016%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0494, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.2521, Accuracy: 56/10000 (0.5600%)
time spent on training: 285.8840253353119
[rfa agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 82, 36, 79, 60, 20, 46, 80, 12, 30], weight: tensor([0.0961, 0.0599, 0.0489, 0.0236, 0.2666, 0.0966, 0.2280, 0.0817, 0.0405,
        0.0582])
[rfa agg] iter:  0, prev_obj_val: 106.14114379882812, obj_val: 106.5142593383789, abs dis: 0.37311553955078125
[rfa agg] iter: 0, weight: tensor([0.1728, 0.0587, 0.0438, 0.0162, 0.1565, 0.1659, 0.1856, 0.1106, 0.0331,
        0.0567])
[rfa agg] iter:  1, prev_obj_val: 106.5142593383789, obj_val: 108.97826385498047, abs dis: 2.4640045166015625
[rfa agg] iter: 1, weight: tensor([0.2284, 0.0602, 0.0438, 0.0151, 0.1068, 0.2060, 0.1216, 0.1277, 0.0323,
        0.0580])
[rfa agg] iter:  2, prev_obj_val: 108.97826385498047, obj_val: 112.92221069335938, abs dis: 3.9439468383789062
[rfa agg] iter: 2, weight: tensor([0.2754, 0.0616, 0.0430, 0.0134, 0.0683, 0.2171, 0.0750, 0.1568, 0.0305,
        0.0590])
[rfa agg] iter:  3, prev_obj_val: 112.92221069335938, obj_val: 114.65003204345703, abs dis: 1.7278213500976562
[rfa agg] iter: 3, weight: tensor([0.2232, 0.0777, 0.0524, 0.0148, 0.0616, 0.1844, 0.0664, 0.2097, 0.0358,
        0.0739])
[rfa agg] iter:  4, prev_obj_val: 114.65003204345703, obj_val: 114.63398742675781, abs dis: 0.01604461669921875
[rfa agg] iter: 4, weight: tensor([0.1904, 0.0876, 0.0580, 0.0157, 0.0606, 0.1646, 0.0650, 0.2357, 0.0390,
        0.0833])
[rfa agg] iter:  5, prev_obj_val: 114.63398742675781, obj_val: 114.63336944580078, abs dis: 0.00061798095703125
[rfa agg] iter: 5, weight: tensor([0.1855, 0.0879, 0.0580, 0.0157, 0.0602, 0.1610, 0.0646, 0.2444, 0.0390,
        0.0838])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 14.4092, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 7.1583, Accuracy: 75/9950 (0.7538%)
saving model
Done in 386.4248876571655 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0676, Accuracy: 231/1372 (16.8367%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0347, Accuracy: 484/1372 (35.2770%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.3858, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0702, Accuracy: 113/953 (11.8573%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 285/953 (29.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.7263, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0696, Accuracy: 104/735 (14.1497%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0245, Accuracy: 337/735 (45.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 13.2653, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0762, Accuracy: 181/928 (19.5043%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0284, Accuracy: 543/928 (58.5129%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.1456, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0904, Accuracy: 9/271 (3.3210%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0604, Accuracy: 85/271 (31.3653%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3988, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0999, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0819, Accuracy: 9/186 (4.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5499, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0701, Accuracy: 285/1750 (16.2857%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0398, Accuracy: 585/1750 (33.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.2068, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0530, Accuracy: 379/1552 (24.4201%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 723/1552 (46.5851%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.3145, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0657, Accuracy: 336/1742 (19.2882%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0359, Accuracy: 666/1742 (38.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1700, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0993, Accuracy: 3/416 (0.7212%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0552, Accuracy: 144/416 (34.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.8832, Accuracy: 72/10000 (0.7200%)
time spent on training: 325.4978914260864
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 64, 32, 1, 35, 56, 44, 74, 93, 78], weight: tensor([0.1385, 0.0962, 0.0742, 0.0937, 0.0274, 0.0188, 0.1767, 0.1567, 0.1759,
        0.0420])
[rfa agg] iter:  0, prev_obj_val: 73.6439208984375, obj_val: 73.47505187988281, abs dis: 0.1688690185546875
[rfa agg] iter: 0, weight: tensor([0.1900, 0.1697, 0.0794, 0.1414, 0.0142, 0.0082, 0.1151, 0.1396, 0.1168,
        0.0258])
[rfa agg] iter:  1, prev_obj_val: 73.47505187988281, obj_val: 73.4745101928711, abs dis: 0.00054168701171875
[rfa agg] iter: 1, weight: tensor([0.1930, 0.1733, 0.0785, 0.1445, 0.0139, 0.0081, 0.1119, 0.1370, 0.1144,
        0.0253])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.0292, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.1695, Accuracy: 0/9950 (0.0000%)
saving model
Done in 420.22693848609924 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0646, Accuracy: 235/1213 (19.3735%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0311, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.3202, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0527, Accuracy: 264/690 (38.2609%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0267, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.5807, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0620, Accuracy: 181/813 (22.2632%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0219, Accuracy: 437/813 (53.7515%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 13.9418, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0604, Accuracy: 477/2227 (21.4189%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0307, Accuracy: 909/2227 (40.8172%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1360, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0686, Accuracy: 179/1071 (16.7134%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0323, Accuracy: 481/1071 (44.9113%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.7145, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0736, Accuracy: 275/1581 (17.3941%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0377, Accuracy: 478/1581 (30.2340%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.8610, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0573, Accuracy: 278/1129 (24.6236%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0266, Accuracy: 643/1129 (56.9531%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.9889, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0703, Accuracy: 264/1750 (15.0857%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0401, Accuracy: 582/1750 (33.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5034, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0739, Accuracy: 189/928 (20.3664%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0269, Accuracy: 534/928 (57.5431%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.6461, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 192/1013 (18.9536%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 349/1013 (34.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.4470, Accuracy: 79/10000 (0.7900%)
time spent on training: 370.33471298217773
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 25, 53, 60, 55, 28, 37, 44, 1, 14], weight: tensor([0.0977, 0.0556, 0.0655, 0.1794, 0.0863, 0.1273, 0.0909, 0.1410, 0.0747,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 69.60523223876953, obj_val: 72.19295501708984, abs dis: 2.5877227783203125
[rfa agg] iter: 0, weight: tensor([0.1560, 0.0370, 0.0560, 0.0675, 0.1327, 0.1202, 0.1526, 0.0907, 0.0796,
        0.1077])
[rfa agg] iter:  1, prev_obj_val: 72.19295501708984, obj_val: 76.97708129882812, abs dis: 4.784126281738281
[rfa agg] iter: 1, weight: tensor([0.1384, 0.0415, 0.0668, 0.0532, 0.1564, 0.0835, 0.1612, 0.0671, 0.0963,
        0.1355])
[rfa agg] iter:  2, prev_obj_val: 76.97708129882812, obj_val: 75.07231903076172, abs dis: 1.9047622680664062
[rfa agg] iter: 2, weight: tensor([0.1124, 0.0510, 0.0871, 0.0492, 0.1554, 0.0709, 0.1367, 0.0595, 0.1179,
        0.1599])
[rfa agg] iter:  3, prev_obj_val: 75.07231903076172, obj_val: 73.4742660522461, abs dis: 1.598052978515625
[rfa agg] iter: 3, weight: tensor([0.1158, 0.0468, 0.0787, 0.0495, 0.1616, 0.0731, 0.1411, 0.0606, 0.1125,
        0.1604])
[rfa agg] iter:  4, prev_obj_val: 73.4742660522461, obj_val: 79.10064697265625, abs dis: 5.626380920410156
[rfa agg] iter: 4, weight: tensor([0.1231, 0.0435, 0.0716, 0.0507, 0.1649, 0.0768, 0.1499, 0.0629, 0.1045,
        0.1521])
[rfa agg] iter:  5, prev_obj_val: 79.10064697265625, obj_val: 75.07914733886719, abs dis: 4.0214996337890625
[rfa agg] iter: 5, weight: tensor([0.1054, 0.0560, 0.0974, 0.0488, 0.1499, 0.0686, 0.1269, 0.0582, 0.1254,
        0.1636])
[rfa agg] iter:  6, prev_obj_val: 75.07914733886719, obj_val: 73.47492980957031, abs dis: 1.604217529296875
[rfa agg] iter: 6, weight: tensor([0.1153, 0.0468, 0.0790, 0.0495, 0.1611, 0.0731, 0.1398, 0.0606, 0.1133,
        0.1615])
[rfa agg] iter:  7, prev_obj_val: 73.47492980957031, obj_val: 79.1004638671875, abs dis: 5.6255340576171875
[rfa agg] iter: 7, weight: tensor([0.1230, 0.0435, 0.0716, 0.0507, 0.1648, 0.0768, 0.1497, 0.0629, 0.1046,
        0.1523])
[rfa agg] iter:  8, prev_obj_val: 79.1004638671875, obj_val: 75.07914733886719, abs dis: 4.0213165283203125
[rfa agg] iter: 8, weight: tensor([0.1054, 0.0560, 0.0974, 0.0488, 0.1499, 0.0686, 0.1268, 0.0582, 0.1254,
        0.1636])
[rfa agg] iter:  9, prev_obj_val: 75.07914733886719, obj_val: 73.47493743896484, abs dis: 1.6042098999023438
[rfa agg] iter: 9, weight: tensor([0.1153, 0.0468, 0.0790, 0.0495, 0.1611, 0.0731, 0.1398, 0.0606, 0.1133,
        0.1615])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 16.7628, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 7.2925, Accuracy: 204/9950 (2.0503%)
saving model
Done in 465.8510756492615 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0846, Accuracy: 16/500 (3.2000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 188/500 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.9296, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0882, Accuracy: 43/605 (7.1074%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0457, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.6321, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0818, Accuracy: 199/1190 (16.7227%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0363, Accuracy: 407/1190 (34.2017%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0638, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0723, Accuracy: 88/530 (16.6038%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0369, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.0855, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0649, Accuracy: 207/599 (34.5576%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0318, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 15.1182, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0622, Accuracy: 255/891 (28.6195%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 433/891 (48.5971%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.7748, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0755, Accuracy: 176/1131 (15.5615%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0359, Accuracy: 393/1131 (34.7480%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.5609, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0983, Accuracy: 1/416 (0.2404%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0526, Accuracy: 139/416 (33.4135%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6059, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0521, Accuracy: 424/1470 (28.8435%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 764/1470 (51.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.6818, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0653, Accuracy: 231/1154 (20.0173%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0274, Accuracy: 432/1154 (37.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 11.9536, Accuracy: 64/10000 (0.6400%)
time spent on training: 301.85063099861145
[rfa agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 2, 84, 18, 95, 7, 87, 78, 22, 57], weight: tensor([0.0589, 0.0713, 0.1402, 0.0625, 0.0706, 0.1050, 0.1333, 0.0490, 0.1732,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 58.11037063598633, obj_val: 62.67267990112305, abs dis: 4.562309265136719
[rfa agg] iter: 0, weight: tensor([0.0588, 0.0915, 0.1153, 0.0700, 0.0945, 0.2056, 0.1308, 0.0409, 0.0911,
        0.1017])
[rfa agg] iter:  1, prev_obj_val: 62.67267990112305, obj_val: 64.50577545166016, abs dis: 1.8330955505371094
[rfa agg] iter: 1, weight: tensor([0.0772, 0.1158, 0.0963, 0.0915, 0.1241, 0.1721, 0.1059, 0.0510, 0.0796,
        0.0865])
[rfa agg] iter:  2, prev_obj_val: 64.50577545166016, obj_val: 64.49382781982422, abs dis: 0.0119476318359375
[rfa agg] iter: 2, weight: tensor([0.0860, 0.1257, 0.0898, 0.1013, 0.1370, 0.1505, 0.0978, 0.0554, 0.0756,
        0.0810])
[rfa agg] iter:  3, prev_obj_val: 64.49382781982422, obj_val: 64.49369049072266, abs dis: 0.0001373291015625
[rfa agg] iter: 3, weight: tensor([0.0864, 0.1271, 0.0892, 0.1020, 0.1390, 0.1481, 0.0972, 0.0555, 0.0752,
        0.0804])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0652, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6710, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.9325301647186 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0967, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0789, Accuracy: 12/186 (6.4516%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.0185, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0869, Accuracy: 7/373 (1.8767%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0509, Accuracy: 134/373 (35.9249%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4403, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0631, Accuracy: 217/1089 (19.9265%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0332, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.7225, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0597, Accuracy: 312/1036 (30.1158%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0265, Accuracy: 640/1036 (61.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.3144, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0670, Accuracy: 314/1427 (22.0042%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0363, Accuracy: 535/1427 (37.4912%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5215, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0556, Accuracy: 380/1953 (19.4572%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0366, Accuracy: 687/1953 (35.1767%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5861, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0833, Accuracy: 53/682 (7.7713%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0421, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.6211, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0688, Accuracy: 214/946 (22.6216%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0378, Accuracy: 360/946 (38.0550%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4303, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0689, Accuracy: 259/1573 (16.4654%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0384, Accuracy: 505/1573 (32.1043%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.8487, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0604, Accuracy: 256/803 (31.8804%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0359, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4421, Accuracy: 62/10000 (0.6200%)
time spent on training: 352.89110350608826
[rfa agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 98, 59, 19, 34, 83, 80, 43, 40, 58], weight: tensor([0.0185, 0.0370, 0.1082, 0.1029, 0.1417, 0.1940, 0.0677, 0.0940, 0.1562,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 70.40612030029297, obj_val: 70.89458465576172, abs dis: 0.48846435546875
[rfa agg] iter: 0, weight: tensor([0.0073, 0.0188, 0.1144, 0.1986, 0.1523, 0.0924, 0.0576, 0.1432, 0.1251,
        0.0902])
[rfa agg] iter:  1, prev_obj_val: 70.89458465576172, obj_val: 72.94218444824219, abs dis: 2.0475997924804688
[rfa agg] iter: 1, weight: tensor([0.0072, 0.0187, 0.1101, 0.2222, 0.1364, 0.0844, 0.0587, 0.1556, 0.1125,
        0.0942])
[rfa agg] iter:  2, prev_obj_val: 72.94218444824219, obj_val: 75.78936004638672, abs dis: 2.8471755981445312
[rfa agg] iter: 2, weight: tensor([0.0074, 0.0196, 0.1033, 0.2229, 0.1159, 0.0766, 0.0652, 0.1816, 0.0985,
        0.1090])
[rfa agg] iter:  3, prev_obj_val: 75.78936004638672, obj_val: 75.76673126220703, abs dis: 0.0226287841796875
[rfa agg] iter: 3, weight: tensor([0.0078, 0.0211, 0.0964, 0.1974, 0.1014, 0.0710, 0.0751, 0.2096, 0.0885,
        0.1316])
[rfa agg] iter:  4, prev_obj_val: 75.76673126220703, obj_val: 75.76597595214844, abs dis: 0.00075531005859375
[rfa agg] iter: 4, weight: tensor([0.0078, 0.0210, 0.0950, 0.1926, 0.1005, 0.0704, 0.0749, 0.2173, 0.0876,
        0.1330])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.6538, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 7.4597, Accuracy: 23/9950 (0.2312%)
saving model
Done in 445.7994112968445 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0808, Accuracy: 211/1190 (17.7311%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0362, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0837, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0732, Accuracy: 264/1581 (16.6983%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0382, Accuracy: 475/1581 (30.0443%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.7746, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0564, Accuracy: 203/813 (24.9692%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0217, Accuracy: 465/813 (57.1956%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 13.6104, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0751, Accuracy: 270/1163 (23.2158%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0417, Accuracy: 377/1163 (32.4162%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6477, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0691, Accuracy: 318/1988 (15.9960%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0382, Accuracy: 554/1988 (27.8672%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6647, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0684, Accuracy: 286/1750 (16.3429%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0397, Accuracy: 581/1750 (33.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4305, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0518, Accuracy: 255/690 (36.9565%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0250, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.1568, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0627, Accuracy: 352/1904 (18.4874%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0342, Accuracy: 632/1904 (33.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6282, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0700, Accuracy: 115/735 (15.6463%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 348/735 (47.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.8827, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0998, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0818, Accuracy: 6/186 (3.2258%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4624, Accuracy: 66/10000 (0.6600%)
time spent on training: 403.30201840400696
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 28, 53, 68, 85, 44, 25, 46, 32, 56], weight: tensor([0.0992, 0.1318, 0.0677, 0.0969, 0.1657, 0.1458, 0.0575, 0.1587, 0.0613,
        0.0155])
[rfa agg] iter:  0, prev_obj_val: 73.85669708251953, obj_val: 74.82746887207031, abs dis: 0.9707717895507812
[rfa agg] iter: 0, weight: tensor([0.1493, 0.1758, 0.0567, 0.1791, 0.1002, 0.1310, 0.0391, 0.1167, 0.0464,
        0.0058])
[rfa agg] iter:  1, prev_obj_val: 74.82746887207031, obj_val: 74.8171615600586, abs dis: 0.01030731201171875
[rfa agg] iter: 1, weight: tensor([0.1603, 0.1633, 0.0588, 0.1995, 0.0938, 0.1213, 0.0402, 0.1091, 0.0478,
        0.0058])
[rfa agg] iter:  2, prev_obj_val: 74.8171615600586, obj_val: 76.07891845703125, abs dis: 1.2617568969726562
[rfa agg] iter: 2, weight: tensor([0.1616, 0.1614, 0.0585, 0.2030, 0.0933, 0.1203, 0.0400, 0.1085, 0.0477,
        0.0058])
[rfa agg] iter:  3, prev_obj_val: 76.07891845703125, obj_val: 76.07389831542969, abs dis: 0.0050201416015625
[rfa agg] iter: 3, weight: tensor([0.1671, 0.1502, 0.0619, 0.2157, 0.0896, 0.1139, 0.0418, 0.1035, 0.0502,
        0.0059])
[rfa agg] iter:  4, prev_obj_val: 76.07389831542969, obj_val: 76.07378387451172, abs dis: 0.00011444091796875
[rfa agg] iter: 4, weight: tensor([0.1676, 0.1488, 0.0618, 0.2186, 0.0893, 0.1133, 0.0417, 0.1030, 0.0500,
        0.0059])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1285, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.0965, Accuracy: 0/9950 (0.0000%)
saving model
Done in 492.59890365600586 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1734, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1628, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2562, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0753, Accuracy: 175/774 (22.6098%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0384, Accuracy: 320/774 (41.3437%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8732, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 382/1953 (19.5597%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0359, Accuracy: 684/1953 (35.0230%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6745, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0714, Accuracy: 98/530 (18.4906%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.4133, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0834, Accuracy: 37/568 (6.5141%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0442, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.4429, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0676, Accuracy: 182/1402 (12.9815%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0432, Accuracy: 319/1402 (22.7532%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4101, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0707, Accuracy: 292/1581 (18.4693%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0381, Accuracy: 479/1581 (30.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9457, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0918, Accuracy: 11/408 (2.6961%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0546, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5853, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0711, Accuracy: 320/1988 (16.0966%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0385, Accuracy: 534/1988 (26.8612%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.6732, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0985, Accuracy: 11/416 (2.6442%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0517, Accuracy: 150/416 (36.0577%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.3890, Accuracy: 62/10000 (0.6200%)
time spent on training: 364.8968024253845
[rfa agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 81, 83, 18, 62, 66, 28, 36, 85, 78], weight: tensor([0.0088, 0.0798, 0.2012, 0.0546, 0.0585, 0.1445, 0.1629, 0.0420, 0.2048,
        0.0429])
[rfa agg] iter:  0, prev_obj_val: 84.37141418457031, obj_val: 85.28053283691406, abs dis: 0.90911865234375
[rfa agg] iter: 0, weight: tensor([0.0032, 0.0687, 0.1417, 0.0330, 0.0356, 0.3155, 0.2265, 0.0220, 0.1313,
        0.0224])
[rfa agg] iter:  1, prev_obj_val: 85.28053283691406, obj_val: 85.2672119140625, abs dis: 0.0133209228515625
[rfa agg] iter: 1, weight: tensor([0.0032, 0.0706, 0.1318, 0.0336, 0.0363, 0.3446, 0.2121, 0.0223, 0.1229,
        0.0226])
[rfa agg] iter:  2, prev_obj_val: 85.2672119140625, obj_val: 85.26614379882812, abs dis: 0.001068115234375
[rfa agg] iter: 2, weight: tensor([0.0032, 0.0699, 0.1302, 0.0332, 0.0359, 0.3535, 0.2081, 0.0220, 0.1215,
        0.0224])
[rfa agg] iter:  3, prev_obj_val: 85.26614379882812, obj_val: 85.26605224609375, abs dis: 9.1552734375e-05
[rfa agg] iter: 3, weight: tensor([0.0032, 0.0697, 0.1297, 0.0331, 0.0358, 0.3562, 0.2069, 0.0220, 0.1211,
        0.0223])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 13.4438, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 10.6046, Accuracy: 0/9950 (0.0000%)
saving model
Done in 457.1194727420807 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0702, Accuracy: 241/1372 (17.5656%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0357, Accuracy: 453/1372 (33.0175%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.4424, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1481, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1394, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7757, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0609, Accuracy: 266/1446 (18.3956%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0365, Accuracy: 473/1446 (32.7109%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4141, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0687, Accuracy: 222/901 (24.6393%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0397, Accuracy: 408/901 (45.2830%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.7607, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0687, Accuracy: 301/1750 (17.2000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0397, Accuracy: 605/1750 (34.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2245, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0661, Accuracy: 185/1402 (13.1954%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0431, Accuracy: 321/1402 (22.8959%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4788, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0636, Accuracy: 308/1662 (18.5319%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0375, Accuracy: 489/1662 (29.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.3411, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0523, Accuracy: 419/1470 (28.5034%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0260, Accuracy: 775/1470 (52.7211%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8871, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0685, Accuracy: 190/1131 (16.7993%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 474/1131 (41.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.7382, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0759, Accuracy: 200/1154 (17.3310%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0331, Accuracy: 435/1154 (37.6950%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.7084, Accuracy: 69/10000 (0.6900%)
time spent on training: 374.56509613990784
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 47, 26, 4, 44, 66, 94, 22, 38, 15], weight: tensor([0.1104, 0.0108, 0.1164, 0.0725, 0.1409, 0.1129, 0.1338, 0.1183, 0.0910,
        0.0929])
[rfa agg] iter:  0, prev_obj_val: 52.657196044921875, obj_val: 50.77634048461914, abs dis: 1.8808555603027344
[rfa agg] iter: 0, weight: tensor([0.1399, 0.0032, 0.1320, 0.0680, 0.0814, 0.1395, 0.0941, 0.1199, 0.1188,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 50.77634048461914, obj_val: 54.60319519042969, abs dis: 3.826854705810547
[rfa agg] iter: 1, weight: tensor([0.1455, 0.0030, 0.1380, 0.0608, 0.0812, 0.1453, 0.0943, 0.1223, 0.1107,
        0.0989])
[rfa agg] iter:  2, prev_obj_val: 54.60319519042969, obj_val: 52.56483459472656, abs dis: 2.038360595703125
[rfa agg] iter: 2, weight: tensor([0.1360, 0.0034, 0.1267, 0.0746, 0.0791, 0.1366, 0.0907, 0.1160, 0.1289,
        0.1079])
[rfa agg] iter:  3, prev_obj_val: 52.56483459472656, obj_val: 50.77783203125, abs dis: 1.7870025634765625
[rfa agg] iter: 3, weight: tensor([0.1400, 0.0032, 0.1315, 0.0675, 0.0799, 0.1404, 0.0921, 0.1187, 0.1219,
        0.1047])
[rfa agg] iter:  4, prev_obj_val: 50.77783203125, obj_val: 54.602882385253906, abs dis: 3.8250503540039062
[rfa agg] iter: 4, weight: tensor([0.1454, 0.0030, 0.1379, 0.0608, 0.0811, 0.1453, 0.0942, 0.1222, 0.1110,
        0.0991])
[rfa agg] iter:  5, prev_obj_val: 54.602882385253906, obj_val: 52.564849853515625, abs dis: 2.0380325317382812
[rfa agg] iter: 5, weight: tensor([0.1360, 0.0034, 0.1267, 0.0746, 0.0791, 0.1366, 0.0907, 0.1160, 0.1290,
        0.1079])
[rfa agg] iter:  6, prev_obj_val: 52.564849853515625, obj_val: 50.77783966064453, abs dis: 1.7870101928710938
[rfa agg] iter: 6, weight: tensor([0.1400, 0.0032, 0.1315, 0.0675, 0.0799, 0.1404, 0.0921, 0.1187, 0.1219,
        0.1047])
[rfa agg] iter:  7, prev_obj_val: 50.77783966064453, obj_val: 54.60287857055664, abs dis: 3.8250389099121094
[rfa agg] iter: 7, weight: tensor([0.1454, 0.0030, 0.1379, 0.0608, 0.0811, 0.1453, 0.0942, 0.1222, 0.1110,
        0.0991])
[rfa agg] iter:  8, prev_obj_val: 54.60287857055664, obj_val: 52.564849853515625, abs dis: 2.0380287170410156
[rfa agg] iter: 8, weight: tensor([0.1360, 0.0034, 0.1267, 0.0746, 0.0791, 0.1366, 0.0907, 0.1160, 0.1290,
        0.1079])
[rfa agg] iter:  9, prev_obj_val: 52.564849853515625, obj_val: 50.77783966064453, abs dis: 1.7870101928710938
[rfa agg] iter: 9, weight: tensor([0.1400, 0.0032, 0.1315, 0.0675, 0.0799, 0.1404, 0.0921, 0.1187, 0.1219,
        0.1047])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 18.0585, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 12.3112, Accuracy: 1/9950 (0.0101%)
saving model
Done in 470.09504890441895 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.1187, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0685, Accuracy: 65/312 (20.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4647, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0684, Accuracy: 231/1573 (14.6853%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0384, Accuracy: 499/1573 (31.7228%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5534, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0677, Accuracy: 186/1131 (16.4456%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0329, Accuracy: 479/1131 (42.3519%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.8019, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0681, Accuracy: 179/1013 (17.6703%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0296, Accuracy: 456/1013 (45.0148%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6307, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0858, Accuracy: 21/515 (4.0777%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0535, Accuracy: 141/515 (27.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2661, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0617, Accuracy: 205/776 (26.4175%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0317, Accuracy: 389/776 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.9504, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0704, Accuracy: 288/1581 (18.2163%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0371, Accuracy: 498/1581 (31.4991%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.9266, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0710, Accuracy: 295/1418 (20.8039%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0356, Accuracy: 523/1418 (36.8829%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8790, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0611, Accuracy: 260/891 (29.1807%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.6334, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0758, Accuracy: 129/636 (20.2830%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.7860, Accuracy: 51/10000 (0.5100%)
time spent on training: 331.43192625045776
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 40, 38, 39, 33, 75, 28, 70, 7, 52], weight: tensor([0.0317, 0.1598, 0.1149, 0.1029, 0.0523, 0.0788, 0.1606, 0.1440, 0.0905,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 61.097354888916016, obj_val: 63.09825134277344, abs dis: 2.000896453857422
[rfa agg] iter: 0, weight: tensor([0.0150, 0.1018, 0.1759, 0.1832, 0.0358, 0.0932, 0.0998, 0.1111, 0.1324,
        0.0518])
[rfa agg] iter:  1, prev_obj_val: 63.09825134277344, obj_val: 64.49217224121094, abs dis: 1.3939208984375
[rfa agg] iter: 1, weight: tensor([0.0158, 0.0895, 0.1581, 0.1948, 0.0388, 0.1072, 0.0878, 0.0969, 0.1534,
        0.0577])
[rfa agg] iter:  2, prev_obj_val: 64.49217224121094, obj_val: 63.081146240234375, abs dis: 1.4110260009765625
[rfa agg] iter: 2, weight: tensor([0.0165, 0.0855, 0.1446, 0.1902, 0.0413, 0.1171, 0.0839, 0.0918, 0.1669,
        0.0622])
[rfa agg] iter:  3, prev_obj_val: 63.081146240234375, obj_val: 64.48921966552734, abs dis: 1.4080734252929688
[rfa agg] iter: 3, weight: tensor([0.0157, 0.0888, 0.1528, 0.1962, 0.0388, 0.1091, 0.0869, 0.0959, 0.1582,
        0.0576])
[rfa agg] iter:  4, prev_obj_val: 64.48921966552734, obj_val: 63.081451416015625, abs dis: 1.4077682495117188
[rfa agg] iter: 4, weight: tensor([0.0165, 0.0854, 0.1440, 0.1904, 0.0413, 0.1172, 0.0838, 0.0917, 0.1676,
        0.0621])
[rfa agg] iter:  5, prev_obj_val: 63.081451416015625, obj_val: 64.48918151855469, abs dis: 1.4077301025390625
[rfa agg] iter: 5, weight: tensor([0.0157, 0.0888, 0.1527, 0.1962, 0.0388, 0.1091, 0.0869, 0.0959, 0.1583,
        0.0576])
[rfa agg] iter:  6, prev_obj_val: 64.48918151855469, obj_val: 63.08145523071289, abs dis: 1.4077262878417969
[rfa agg] iter: 6, weight: tensor([0.0165, 0.0854, 0.1440, 0.1904, 0.0413, 0.1172, 0.0838, 0.0917, 0.1677,
        0.0621])
[rfa agg] iter:  7, prev_obj_val: 63.08145523071289, obj_val: 64.48918151855469, abs dis: 1.4077262878417969
[rfa agg] iter: 7, weight: tensor([0.0157, 0.0888, 0.1527, 0.1962, 0.0388, 0.1091, 0.0869, 0.0959, 0.1583,
        0.0576])
[rfa agg] iter:  8, prev_obj_val: 64.48918151855469, obj_val: 63.08145523071289, abs dis: 1.4077262878417969
[rfa agg] iter: 8, weight: tensor([0.0165, 0.0854, 0.1440, 0.1904, 0.0413, 0.1172, 0.0838, 0.0917, 0.1677,
        0.0621])
[rfa agg] iter:  9, prev_obj_val: 63.08145523071289, obj_val: 64.48918151855469, abs dis: 1.4077262878417969
[rfa agg] iter: 9, weight: tensor([0.0157, 0.0888, 0.1527, 0.1962, 0.0388, 0.1091, 0.0869, 0.0959, 0.1583,
        0.0576])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.9586, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 8.8178, Accuracy: 8/9950 (0.0804%)
saving model
Done in 427.6601507663727 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0897, Accuracy: 13/271 (4.7970%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0631, Accuracy: 92/271 (33.9483%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5270, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0845, Accuracy: 15/515 (2.9126%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0559, Accuracy: 145/515 (28.1553%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1872, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0696, Accuracy: 281/1418 (19.8166%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0351, Accuracy: 527/1418 (37.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.9542, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 200/861 (23.2288%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0236, Accuracy: 414/861 (48.0836%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.5361, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0771, Accuracy: 95/818 (11.6137%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0351, Accuracy: 317/818 (38.7531%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.4931, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0679, Accuracy: 247/896 (27.5670%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0355, Accuracy: 450/896 (50.2232%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5071, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0849, Accuracy: 32/568 (5.6338%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0454, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.3176, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0820, Accuracy: 68/605 (11.2397%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0444, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.5805, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0932, Accuracy: 16/440 (3.6364%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0583, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.6600, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0810, Accuracy: 143/715 (20.0000%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0492, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.8306, Accuracy: 54/10000 (0.5400%)
time spent on training: 295.2960250377655
[rfa agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 33, 70, 10, 71, 89, 62, 2, 49, 23], weight: tensor([0.0381, 0.0725, 0.1995, 0.1211, 0.1151, 0.1261, 0.0799, 0.0851, 0.0619,
        0.1006])
[rfa agg] iter:  0, prev_obj_val: 51.87491989135742, obj_val: 56.287662506103516, abs dis: 4.412742614746094
[rfa agg] iter: 0, weight: tensor([0.0244, 0.0749, 0.0718, 0.1266, 0.1528, 0.1315, 0.1142, 0.1245, 0.0573,
        0.1220])
[rfa agg] iter:  1, prev_obj_val: 56.287662506103516, obj_val: 58.414390563964844, abs dis: 2.126728057861328
[rfa agg] iter: 1, weight: tensor([0.0303, 0.0862, 0.0648, 0.1030, 0.1222, 0.1079, 0.1564, 0.1428, 0.0772,
        0.1092])
[rfa agg] iter:  2, prev_obj_val: 58.414390563964844, obj_val: 60.87918472290039, abs dis: 2.464794158935547
[rfa agg] iter: 2, weight: tensor([0.0332, 0.0898, 0.0634, 0.0961, 0.1116, 0.1002, 0.1737, 0.1414, 0.0881,
        0.1026])
[rfa agg] iter:  3, prev_obj_val: 60.87918472290039, obj_val: 60.87492752075195, abs dis: 0.0042572021484375
[rfa agg] iter: 3, weight: tensor([0.0369, 0.0924, 0.0633, 0.0922, 0.1054, 0.0960, 0.1793, 0.1356, 0.1007,
        0.0982])
[rfa agg] iter:  4, prev_obj_val: 60.87492752075195, obj_val: 60.87485885620117, abs dis: 6.866455078125e-05
[rfa agg] iter: 4, weight: tensor([0.0370, 0.0926, 0.0631, 0.0918, 0.1048, 0.0955, 0.1812, 0.1345, 0.1018,
        0.0977])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.1567, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 8.8143, Accuracy: 8/9950 (0.0804%)
saving model
Done in 390.24366307258606 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0728, Accuracy: 169/677 (24.9631%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.3874, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0805, Accuracy: 110/603 (18.2421%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0473, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1237, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0605, Accuracy: 210/776 (27.0619%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0315, Accuracy: 377/776 (48.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.2142, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0663, Accuracy: 294/1657 (17.7429%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/1657 (26.4333%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0637, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0638, Accuracy: 236/1154 (20.4506%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0308, Accuracy: 402/1154 (34.8354%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.0185, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0733, Accuracy: 181/719 (25.1739%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0393, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.8935, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0653, Accuracy: 369/1742 (21.1825%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0361, Accuracy: 626/1742 (35.9357%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.2125, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0608, Accuracy: 275/1645 (16.7173%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0367, Accuracy: 528/1645 (32.0973%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4552, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0718, Accuracy: 279/1581 (17.6471%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0382, Accuracy: 506/1581 (32.0051%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.7510, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0626, Accuracy: 312/1440 (21.6667%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0310, Accuracy: 613/1440 (42.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.6108, Accuracy: 90/10000 (0.9000%)
time spent on training: 425.09632301330566
[rfa agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 75, 0, 57, 41, 93, 13, 28, 29], weight: tensor([0.0564, 0.0503, 0.0647, 0.1382, 0.0962, 0.0599, 0.1452, 0.1372, 0.1318,
        0.1201])
[rfa agg] iter:  0, prev_obj_val: 64.65705871582031, obj_val: 66.06472778320312, abs dis: 1.4076690673828125
[rfa agg] iter: 0, weight: tensor([0.0408, 0.0331, 0.0565, 0.1336, 0.1204, 0.0466, 0.1101, 0.1320, 0.1509,
        0.1761])
[rfa agg] iter:  1, prev_obj_val: 66.06472778320312, obj_val: 69.37560272216797, abs dis: 3.3108749389648438
[rfa agg] iter: 1, weight: tensor([0.0439, 0.0354, 0.0610, 0.1288, 0.1288, 0.0500, 0.1065, 0.1274, 0.1447,
        0.1735])
[rfa agg] iter:  2, prev_obj_val: 69.37560272216797, obj_val: 67.66299438476562, abs dis: 1.7126083374023438
[rfa agg] iter: 2, weight: tensor([0.0517, 0.0414, 0.0729, 0.1217, 0.1375, 0.0590, 0.1028, 0.1205, 0.1342,
        0.1582])
[rfa agg] iter:  3, prev_obj_val: 67.66299438476562, obj_val: 67.66139221191406, abs dis: 0.0016021728515625
[rfa agg] iter: 3, weight: tensor([0.0477, 0.0383, 0.0670, 0.1249, 0.1360, 0.0545, 0.1046, 0.1237, 0.1389,
        0.1644])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.1892, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 9.9207, Accuracy: 1/9950 (0.0101%)
saving model
Done in 522.1473045349121 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0544, Accuracy: 381/1552 (24.5490%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 717/1552 (46.1985%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 12.3314, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0648, Accuracy: 311/1956 (15.8998%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0359, Accuracy: 608/1956 (31.0838%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0661, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0648, Accuracy: 328/1427 (22.9853%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0368, Accuracy: 521/1427 (36.5102%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3022, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0781, Accuracy: 182/928 (19.6121%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0269, Accuracy: 554/928 (59.6983%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.3985, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0597, Accuracy: 288/1715 (16.7930%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0348, Accuracy: 634/1715 (36.9679%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8920, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0656, Accuracy: 160/1013 (15.7947%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.6575, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0847, Accuracy: 85/669 (12.7055%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0464, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0527, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0667, Accuracy: 187/1402 (13.3381%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 332/1402 (23.6805%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9447, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0601, Accuracy: 269/1130 (23.8053%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0312, Accuracy: 443/1130 (39.2035%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4402, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0666, Accuracy: 201/1241 (16.1966%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0418, Accuracy: 386/1241 (31.1039%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8215, Accuracy: 66/10000 (0.6600%)
time spent on training: 417.76380228996277
[rfa agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [74, 6, 34, 1, 92, 14, 45, 66, 54, 72], weight: tensor([0.1191, 0.1501, 0.1095, 0.0712, 0.1316, 0.0777, 0.0513, 0.1076, 0.0867,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 57.56981658935547, obj_val: 61.28365707397461, abs dis: 3.7138404846191406
[rfa agg] iter: 0, weight: tensor([0.1063, 0.0736, 0.1316, 0.0563, 0.0959, 0.0773, 0.0280, 0.1528, 0.1088,
        0.1694])
[rfa agg] iter:  1, prev_obj_val: 61.28365707397461, obj_val: 61.255672454833984, abs dis: 0.027984619140625
[rfa agg] iter: 1, weight: tensor([0.0913, 0.0665, 0.1141, 0.0678, 0.0832, 0.0989, 0.0333, 0.1339, 0.1342,
        0.1767])
[rfa agg] iter:  2, prev_obj_val: 61.255672454833984, obj_val: 61.255455017089844, abs dis: 0.000217437744140625
[rfa agg] iter: 2, weight: tensor([0.0907, 0.0663, 0.1126, 0.0682, 0.0828, 0.1000, 0.0332, 0.1321, 0.1374,
        0.1767])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.5852, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 9.9969, Accuracy: 0/9950 (0.0000%)
saving model
Done in 509.6789164543152 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0577, Accuracy: 210/813 (25.8303%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0216, Accuracy: 454/813 (55.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 13.4794, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0509, Accuracy: 407/1470 (27.6871%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 795/1470 (54.0816%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.4978, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0614, Accuracy: 297/1662 (17.8700%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0370, Accuracy: 531/1662 (31.9495%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.9642, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0652, Accuracy: 221/1213 (18.2193%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0318, Accuracy: 532/1213 (43.8582%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.6112, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0623, Accuracy: 331/1587 (20.8570%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0367, Accuracy: 552/1587 (34.7826%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7224, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0737, Accuracy: 149/1049 (14.2040%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0348, Accuracy: 459/1049 (43.7560%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.6775, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1379, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1239, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7129, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0840, Accuracy: 127/715 (17.7622%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0471, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.9524, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0715, Accuracy: 223/901 (24.7503%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0376, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.7946, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0808, Accuracy: 76/605 (12.5620%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0420, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2856, Accuracy: 52/10000 (0.5200%)
time spent on training: 361.40687084198
[rfa agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 22, 94, 97, 27, 51, 47, 23, 4, 2], weight: tensor([0.0801, 0.1448, 0.1638, 0.1195, 0.1564, 0.1034, 0.0132, 0.0705, 0.0888,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 61.98026657104492, obj_val: 64.32840728759766, abs dis: 2.3481407165527344
[rfa agg] iter: 0, weight: tensor([0.1017, 0.1216, 0.1048, 0.1764, 0.1078, 0.1554, 0.0052, 0.0662, 0.1135,
        0.0473])
[rfa agg] iter:  1, prev_obj_val: 64.32840728759766, obj_val: 65.87576293945312, abs dis: 1.5473556518554688
[rfa agg] iter: 1, weight: tensor([0.1217, 0.1075, 0.0941, 0.1628, 0.0962, 0.1606, 0.0055, 0.0738, 0.1249,
        0.0529])
[rfa agg] iter:  2, prev_obj_val: 65.87576293945312, obj_val: 67.61766052246094, abs dis: 1.7418975830078125
[rfa agg] iter: 2, weight: tensor([0.1360, 0.1022, 0.0905, 0.1511, 0.0922, 0.1567, 0.0057, 0.0790, 0.1298,
        0.0569])
[rfa agg] iter:  3, prev_obj_val: 67.61766052246094, obj_val: 65.87440490722656, abs dis: 1.743255615234375
[rfa agg] iter: 3, weight: tensor([0.1520, 0.0978, 0.0873, 0.1405, 0.0888, 0.1495, 0.0059, 0.0844, 0.1324,
        0.0613])
[rfa agg] iter:  4, prev_obj_val: 65.87440490722656, obj_val: 67.61634826660156, abs dis: 1.741943359375
[rfa agg] iter: 4, weight: tensor([0.1387, 0.1017, 0.0903, 0.1492, 0.0919, 0.1551, 0.0057, 0.0794, 0.1310,
        0.0570])
[rfa agg] iter:  5, prev_obj_val: 67.61634826660156, obj_val: 65.87452697753906, abs dis: 1.7418212890625
[rfa agg] iter: 5, weight: tensor([0.1523, 0.0977, 0.0873, 0.1404, 0.0888, 0.1493, 0.0059, 0.0844, 0.1325,
        0.0613])
[rfa agg] iter:  6, prev_obj_val: 65.87452697753906, obj_val: 67.61634063720703, abs dis: 1.7418136596679688
[rfa agg] iter: 6, weight: tensor([0.1387, 0.1017, 0.0903, 0.1492, 0.0919, 0.1551, 0.0057, 0.0794, 0.1310,
        0.0570])
[rfa agg] iter:  7, prev_obj_val: 67.61634063720703, obj_val: 65.87452697753906, abs dis: 1.7418136596679688
[rfa agg] iter: 7, weight: tensor([0.1523, 0.0977, 0.0873, 0.1404, 0.0888, 0.1493, 0.0059, 0.0844, 0.1325,
        0.0613])
[rfa agg] iter:  8, prev_obj_val: 65.87452697753906, obj_val: 67.61634063720703, abs dis: 1.7418136596679688
[rfa agg] iter: 8, weight: tensor([0.1387, 0.1017, 0.0903, 0.1492, 0.0919, 0.1551, 0.0057, 0.0794, 0.1310,
        0.0570])
[rfa agg] iter:  9, prev_obj_val: 67.61634063720703, obj_val: 65.87452697753906, abs dis: 1.7418136596679688
[rfa agg] iter: 9, weight: tensor([0.1523, 0.0977, 0.0873, 0.1404, 0.0888, 0.1493, 0.0059, 0.0844, 0.1325,
        0.0613])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.8022, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 11.7241, Accuracy: 0/9950 (0.0000%)
saving model
Done in 460.2323651313782 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0961, Accuracy: 9/416 (2.1635%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0525, Accuracy: 163/416 (39.1827%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7609, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 63/781 (8.0666%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0394, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5766, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0671, Accuracy: 260/1657 (15.6910%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0387, Accuracy: 452/1657 (27.2782%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9568, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0547, Accuracy: 281/1275 (22.0392%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0218, Accuracy: 628/1275 (49.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.4312, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0651, Accuracy: 258/1573 (16.4018%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0380, Accuracy: 520/1573 (33.0579%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8121, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0771, Accuracy: 185/928 (19.9353%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0285, Accuracy: 542/928 (58.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.5429, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0621, Accuracy: 230/1154 (19.9307%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0300, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.2050, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 209/861 (24.2741%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.4304, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0701, Accuracy: 306/1581 (19.3548%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0377, Accuracy: 506/1581 (32.0051%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7918, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0993, Accuracy: 6/466 (1.2876%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0556, Accuracy: 172/466 (36.9099%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1945, Accuracy: 61/10000 (0.6100%)
time spent on training: 369.96673011779785
[rfa agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 3, 0, 9, 40, 1, 57, 10, 28, 76], weight: tensor([0.0389, 0.0730, 0.1550, 0.1192, 0.1471, 0.0868, 0.1079, 0.0805, 0.1479,
        0.0436])
[rfa agg] iter:  0, prev_obj_val: 63.853912353515625, obj_val: 64.96343994140625, abs dis: 1.109527587890625
[rfa agg] iter: 0, weight: tensor([0.0228, 0.0887, 0.1075, 0.1694, 0.1148, 0.1077, 0.1375, 0.1098, 0.1137,
        0.0282])
[rfa agg] iter:  1, prev_obj_val: 64.96343994140625, obj_val: 64.95897674560547, abs dis: 0.00446319580078125
[rfa agg] iter: 1, weight: tensor([0.0236, 0.0961, 0.1012, 0.1647, 0.1078, 0.1148, 0.1361, 0.1196, 0.1066,
        0.0295])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.2005, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 11.0842, Accuracy: 1/9950 (0.0101%)
saving model
Done in 461.80192589759827 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0975, Accuracy: 5/466 (1.0730%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0556, Accuracy: 173/466 (37.1245%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3212, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0658, Accuracy: 180/1513 (11.8969%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 415/1513 (27.4289%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.7085, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0718, Accuracy: 200/928 (21.5517%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0272, Accuracy: 552/928 (59.4828%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.0995, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0604, Accuracy: 340/1440 (23.6111%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0309, Accuracy: 615/1440 (42.7083%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.9369, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0696, Accuracy: 192/719 (26.7038%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0351, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.4112, Accuracy: 60/10000 (0.6000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0633, Accuracy: 255/1574 (16.2008%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0321, Accuracy: 555/1574 (35.2605%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6572, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0613, Accuracy: 477/2227 (21.4189%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0312, Accuracy: 905/2227 (40.6376%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1749, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0778, Accuracy: 79/605 (13.0579%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0422, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.3897, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0659, Accuracy: 154/1013 (15.2024%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 346/1013 (34.1560%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.4781, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0596, Accuracy: 298/1628 (18.3047%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0294, Accuracy: 709/1628 (43.5504%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.1939, Accuracy: 121/10000 (1.2100%)
time spent on training: 428.454048871994
[rfa agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.040607198877239334
[rfa agg] init. name: [76, 8, 1, 29, 41, 17, 60, 2, 14, 5], weight: tensor([0.0385, 0.1249, 0.0766, 0.1189, 0.0594, 0.1299, 0.1839, 0.0499, 0.0836,
        0.1344])
[rfa agg] iter:  0, prev_obj_val: 76.63208770751953, obj_val: 76.39708709716797, abs dis: 0.2350006103515625
[rfa agg] iter: 0, weight: tensor([0.0232, 0.1560, 0.0889, 0.1666, 0.0506, 0.1425, 0.0823, 0.0359, 0.1289,
        0.1250])
[rfa agg] iter:  1, prev_obj_val: 76.39708709716797, obj_val: 76.39680480957031, abs dis: 0.00028228759765625
[rfa agg] iter: 1, weight: tensor([0.0229, 0.1567, 0.0887, 0.1703, 0.0501, 0.1410, 0.0804, 0.0355, 0.1302,
        0.1241])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.7125, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 9.6738, Accuracy: 3/9950 (0.0302%)
saving model
Done in 523.9956452846527 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0578, Accuracy: 300/1129 (26.5722%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0284, Accuracy: 620/1129 (54.9159%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.6001, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0953, Accuracy: 13/271 (4.7970%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0629, Accuracy: 87/271 (32.1033%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3196, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0855, Accuracy: 15/500 (3.0000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.1172, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0709, Accuracy: 108/938 (11.5139%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0372, Accuracy: 320/938 (34.1151%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.6740, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0573, Accuracy: 377/1953 (19.3036%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0354, Accuracy: 732/1953 (37.4808%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7149, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0638, Accuracy: 241/891 (27.0483%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0289, Accuracy: 453/891 (50.8418%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.8050, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0611, Accuracy: 308/1446 (21.3001%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0377, Accuracy: 459/1446 (31.7427%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6808, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0621, Accuracy: 267/1573 (16.9739%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0373, Accuracy: 540/1573 (34.3293%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4226, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 224/690 (32.4638%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.9295, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0574, Accuracy: 220/813 (27.0603%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0231, Accuracy: 415/813 (51.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 13.6067, Accuracy: 51/10000 (0.5100%)
time spent on training: 376.5978410243988
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 35, 82, 73, 83, 7, 26, 40, 25, 53], weight: tensor([0.1106, 0.0266, 0.0490, 0.0919, 0.1914, 0.0873, 0.1417, 0.1542, 0.0676,
        0.0797])
[rfa agg] iter:  0, prev_obj_val: 70.3670654296875, obj_val: 71.84468841552734, abs dis: 1.4776229858398438
[rfa agg] iter: 0, weight: tensor([0.1961, 0.0128, 0.0318, 0.1551, 0.0813, 0.1270, 0.1257, 0.1088, 0.0604,
        0.1011])
[rfa agg] iter:  1, prev_obj_val: 71.84468841552734, obj_val: 74.3744888305664, abs dis: 2.5298004150390625
[rfa agg] iter: 1, weight: tensor([0.1796, 0.0130, 0.0331, 0.1785, 0.0709, 0.1487, 0.1042, 0.0917, 0.0649,
        0.1153])
[rfa agg] iter:  2, prev_obj_val: 74.3744888305664, obj_val: 75.9334716796875, abs dis: 1.5589828491210938
[rfa agg] iter: 2, weight: tensor([0.1452, 0.0136, 0.0359, 0.1900, 0.0643, 0.1719, 0.0898, 0.0805, 0.0723,
        0.1366])
[rfa agg] iter:  3, prev_obj_val: 75.9334716796875, obj_val: 79.82518768310547, abs dis: 3.8917160034179688
[rfa agg] iter: 3, weight: tensor([0.1288, 0.0140, 0.0376, 0.1878, 0.0613, 0.1833, 0.0836, 0.0756, 0.0768,
        0.1511])
[rfa agg] iter:  4, prev_obj_val: 79.82518768310547, obj_val: 79.80791473388672, abs dis: 0.01727294921875
[rfa agg] iter: 4, weight: tensor([0.1106, 0.0155, 0.0435, 0.1678, 0.0585, 0.1880, 0.0766, 0.0703, 0.0903,
        0.1788])
[rfa agg] iter:  5, prev_obj_val: 79.80791473388672, obj_val: 82.11476135253906, abs dis: 2.3068466186523438
[rfa agg] iter: 5, weight: tensor([0.1090, 0.0154, 0.0434, 0.1643, 0.0581, 0.1887, 0.0761, 0.0698, 0.0908,
        0.1843])
[rfa agg] iter:  6, prev_obj_val: 82.11476135253906, obj_val: 77.75750732421875, abs dis: 4.3572540283203125
[rfa agg] iter: 6, weight: tensor([0.1038, 0.0166, 0.0478, 0.1539, 0.0579, 0.1828, 0.0744, 0.0687, 0.0999,
        0.1942])
[rfa agg] iter:  7, prev_obj_val: 77.75750732421875, obj_val: 77.74520874023438, abs dis: 0.012298583984375
[rfa agg] iter: 7, weight: tensor([0.1156, 0.0146, 0.0402, 0.1721, 0.0591, 0.1895, 0.0788, 0.0719, 0.0839,
        0.1744])
[rfa agg] iter:  8, prev_obj_val: 77.74520874023438, obj_val: 77.74500274658203, abs dis: 0.00020599365234375
[rfa agg] iter: 8, weight: tensor([0.1165, 0.0146, 0.0400, 0.1752, 0.0591, 0.1905, 0.0789, 0.0719, 0.0829,
        0.1703])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.7247, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 7.8905, Accuracy: 40/9950 (0.4020%)
saving model
Done in 472.5075948238373 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0575, Accuracy: 200/590 (33.8983%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0362, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 13.1643, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0620, Accuracy: 189/1071 (17.6471%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0328, Accuracy: 457/1071 (42.6704%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.6881, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1631, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1497, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0874, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0763, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 291/603 (48.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3834, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0855, Accuracy: 80/818 (9.7800%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0351, Accuracy: 360/818 (44.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.3230, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0761, Accuracy: 185/1154 (16.0312%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0312, Accuracy: 470/1154 (40.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.5371, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.1079, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0616, Accuracy: 64/312 (20.5128%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.9527, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0721, Accuracy: 155/735 (21.0884%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0254, Accuracy: 336/735 (45.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.9153, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0721, Accuracy: 256/1949 (13.1349%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0373, Accuracy: 528/1949 (27.0908%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.1820, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0991, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0810, Accuracy: 8/186 (4.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2464, Accuracy: 51/10000 (0.5100%)
time spent on training: 297.85150814056396
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 55, 61, 88, 71, 15, 24, 32, 21, 56], weight: tensor([0.0786, 0.1427, 0.0113, 0.0804, 0.1090, 0.1538, 0.0416, 0.0980, 0.2598,
        0.0248])
[rfa agg] iter:  0, prev_obj_val: 77.08563232421875, obj_val: 77.73997497558594, abs dis: 0.6543426513671875
[rfa agg] iter: 0, weight: tensor([0.0800, 0.2181, 0.0048, 0.0849, 0.1706, 0.1661, 0.0240, 0.1345, 0.1052,
        0.0117])
[rfa agg] iter:  1, prev_obj_val: 77.73997497558594, obj_val: 80.740234375, abs dis: 3.0002593994140625
[rfa agg] iter: 1, weight: tensor([0.0917, 0.1839, 0.0048, 0.1000, 0.2005, 0.1311, 0.0248, 0.1650, 0.0864,
        0.0118])
[rfa agg] iter:  2, prev_obj_val: 80.740234375, obj_val: 82.1551742553711, abs dis: 1.4149398803710938
[rfa agg] iter: 2, weight: tensor([0.1112, 0.1376, 0.0049, 0.1268, 0.2052, 0.1038, 0.0270, 0.1964, 0.0746,
        0.0124])
[rfa agg] iter:  3, prev_obj_val: 82.1551742553711, obj_val: 82.14599609375, abs dis: 0.00917816162109375
[rfa agg] iter: 3, weight: tensor([0.1208, 0.1238, 0.0050, 0.1406, 0.1955, 0.0956, 0.0280, 0.2072, 0.0710,
        0.0126])
[rfa agg] iter:  4, prev_obj_val: 82.14599609375, obj_val: 80.67398071289062, abs dis: 1.472015380859375
[rfa agg] iter: 4, weight: tensor([0.1216, 0.1227, 0.0050, 0.1415, 0.1929, 0.0948, 0.0279, 0.2105, 0.0706,
        0.0126])
[rfa agg] iter:  5, prev_obj_val: 80.67398071289062, obj_val: 80.66899871826172, abs dis: 0.00498199462890625
[rfa agg] iter: 5, weight: tensor([0.1126, 0.1318, 0.0049, 0.1280, 0.2021, 0.1000, 0.0266, 0.2089, 0.0729,
        0.0122])
[rfa agg] iter:  6, prev_obj_val: 80.66899871826172, obj_val: 82.15093231201172, abs dis: 1.48193359375
[rfa agg] iter: 6, weight: tensor([0.1117, 0.1323, 0.0049, 0.1270, 0.2044, 0.1004, 0.0266, 0.2075, 0.0730,
        0.0122])
[rfa agg] iter:  7, prev_obj_val: 82.15093231201172, obj_val: 80.6730728149414, abs dis: 1.4778594970703125
[rfa agg] iter: 7, weight: tensor([0.1206, 0.1232, 0.0050, 0.1402, 0.1949, 0.0951, 0.0279, 0.2097, 0.0707,
        0.0126])
[rfa agg] iter:  8, prev_obj_val: 80.6730728149414, obj_val: 80.66897583007812, abs dis: 0.00409698486328125
[rfa agg] iter: 8, weight: tensor([0.1125, 0.1318, 0.0049, 0.1279, 0.2026, 0.1000, 0.0266, 0.2086, 0.0729,
        0.0122])
[rfa agg] iter:  9, prev_obj_val: 80.66897583007812, obj_val: 82.15096282958984, abs dis: 1.4819869995117188
[rfa agg] iter: 9, weight: tensor([0.1117, 0.1323, 0.0049, 0.1270, 0.2045, 0.1004, 0.0266, 0.2074, 0.0730,
        0.0122])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0117, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 6.6840, Accuracy: 96/9950 (0.9648%)
saving model
Done in 392.0161955356598 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0847, Accuracy: 147/715 (20.5594%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0434, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7903, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0776, Accuracy: 46/631 (7.2900%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0454, Accuracy: 213/631 (33.7559%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0465, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0649, Accuracy: 330/1427 (23.1254%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0366, Accuracy: 555/1427 (38.8928%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4832, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0650, Accuracy: 317/1475 (21.4915%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0347, Accuracy: 613/1475 (41.5593%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8844, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.1086, Accuracy: 2/312 (0.6410%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0614, Accuracy: 65/312 (20.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9955, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0854, Accuracy: 56/682 (8.2111%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0432, Accuracy: 236/682 (34.6041%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.8722, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0571, Accuracy: 303/1129 (26.8379%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0267, Accuracy: 651/1129 (57.6616%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.2431, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1605, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1540, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.9923, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0571, Accuracy: 303/1030 (29.4175%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0295, Accuracy: 589/1030 (57.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.4040, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0593, Accuracy: 271/1340 (20.2239%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0297, Accuracy: 548/1340 (40.8955%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.3970, Accuracy: 78/10000 (0.7800%)
time spent on training: 345.7843520641327
[rfa agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 48, 34, 65, 24, 80, 37, 61, 91, 77], weight: tensor([0.0810, 0.0715, 0.1617, 0.1671, 0.0354, 0.0773, 0.1279, 0.0096, 0.1167,
        0.1518])
[rfa agg] iter:  0, prev_obj_val: 63.320430755615234, obj_val: 63.17887496948242, abs dis: 0.1415557861328125
[rfa agg] iter: 0, weight: tensor([0.0927, 0.0750, 0.1267, 0.1102, 0.0203, 0.0922, 0.1903, 0.0041, 0.1364,
        0.1521])
[rfa agg] iter:  1, prev_obj_val: 63.17887496948242, obj_val: 61.89954376220703, abs dis: 1.2793312072753906
[rfa agg] iter: 1, weight: tensor([0.0933, 0.0742, 0.1243, 0.1071, 0.0200, 0.0917, 0.1973, 0.0040, 0.1374,
        0.1507])
[rfa agg] iter:  2, prev_obj_val: 61.89954376220703, obj_val: 63.181236267089844, abs dis: 1.2816925048828125
[rfa agg] iter: 2, weight: tensor([0.0863, 0.0676, 0.1283, 0.1092, 0.0188, 0.0832, 0.2080, 0.0038, 0.1374,
        0.1573])
[rfa agg] iter:  3, prev_obj_val: 63.181236267089844, obj_val: 61.89891815185547, abs dis: 1.282318115234375
[rfa agg] iter: 3, weight: tensor([0.0927, 0.0738, 0.1241, 0.1070, 0.0200, 0.0911, 0.1994, 0.0040, 0.1374,
        0.1505])
[rfa agg] iter:  4, prev_obj_val: 61.89891815185547, obj_val: 63.181304931640625, abs dis: 1.2823867797851562
[rfa agg] iter: 4, weight: tensor([0.0862, 0.0676, 0.1282, 0.1091, 0.0188, 0.0832, 0.2084, 0.0038, 0.1374,
        0.1573])
[rfa agg] iter:  5, prev_obj_val: 63.181304931640625, obj_val: 61.89891052246094, abs dis: 1.2823944091796875
[rfa agg] iter: 5, weight: tensor([0.0927, 0.0738, 0.1241, 0.1070, 0.0200, 0.0911, 0.1995, 0.0040, 0.1374,
        0.1505])
[rfa agg] iter:  6, prev_obj_val: 61.89891052246094, obj_val: 63.18129348754883, abs dis: 1.2823829650878906
[rfa agg] iter: 6, weight: tensor([0.0862, 0.0676, 0.1282, 0.1091, 0.0188, 0.0832, 0.2084, 0.0038, 0.1374,
        0.1573])
[rfa agg] iter:  7, prev_obj_val: 63.18129348754883, obj_val: 61.89891052246094, abs dis: 1.2823829650878906
[rfa agg] iter: 7, weight: tensor([0.0927, 0.0738, 0.1241, 0.1070, 0.0200, 0.0911, 0.1995, 0.0040, 0.1374,
        0.1505])
[rfa agg] iter:  8, prev_obj_val: 61.89891052246094, obj_val: 63.181297302246094, abs dis: 1.2823867797851562
[rfa agg] iter: 8, weight: tensor([0.0862, 0.0676, 0.1282, 0.1091, 0.0188, 0.0832, 0.2084, 0.0038, 0.1374,
        0.1573])
[rfa agg] iter:  9, prev_obj_val: 63.181297302246094, obj_val: 61.8989143371582, abs dis: 1.2823829650878906
[rfa agg] iter: 9, weight: tensor([0.0927, 0.0738, 0.1241, 0.1070, 0.0200, 0.0911, 0.1995, 0.0040, 0.1374,
        0.1505])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.1316, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.7065, Accuracy: 284/9950 (2.8543%)
saving model
Done in 443.5742063522339 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0661, Accuracy: 333/1904 (17.4895%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0341, Accuracy: 633/1904 (33.2458%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6802, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0698, Accuracy: 118/953 (12.3820%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 290/953 (30.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.7489, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0770, Accuracy: 229/1190 (19.2437%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0366, Accuracy: 431/1190 (36.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.9366, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0817, Accuracy: 139/715 (19.4406%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0491, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1428, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0702, Accuracy: 179/1131 (15.8267%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0342, Accuracy: 434/1131 (38.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2914, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0758, Accuracy: 207/901 (22.9745%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0378, Accuracy: 420/901 (46.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.0028, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0666, Accuracy: 281/1657 (16.9584%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0380, Accuracy: 499/1657 (30.1147%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1335, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0808, Accuracy: 122/636 (19.1824%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0368, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.2931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0776, Accuracy: 252/1003 (25.1246%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0411, Accuracy: 389/1003 (38.7836%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.9423, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0613, Accuracy: 219/1154 (18.9775%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0285, Accuracy: 461/1154 (39.9480%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.2973, Accuracy: 62/10000 (0.6200%)
time spent on training: 423.752956867218
[rfa agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 64, 84, 23, 38, 4, 0, 52, 86, 57], weight: tensor([0.1693, 0.0848, 0.1058, 0.0636, 0.1006, 0.0801, 0.1474, 0.0566, 0.0892,
        0.1026])
[rfa agg] iter:  0, prev_obj_val: 62.72510528564453, obj_val: 65.54383087158203, abs dis: 2.8187255859375
[rfa agg] iter: 0, weight: tensor([0.0740, 0.1234, 0.1367, 0.0520, 0.1462, 0.0978, 0.0907, 0.0390, 0.1287,
        0.1115])
[rfa agg] iter:  1, prev_obj_val: 65.54383087158203, obj_val: 71.01818084716797, abs dis: 5.4743499755859375
[rfa agg] iter: 1, weight: tensor([0.0644, 0.1539, 0.1176, 0.0597, 0.1334, 0.1124, 0.0765, 0.0451, 0.1391,
        0.0978])
[rfa agg] iter:  2, prev_obj_val: 71.01818084716797, obj_val: 68.89774322509766, abs dis: 2.1204376220703125
[rfa agg] iter: 2, weight: tensor([0.0612, 0.1751, 0.1011, 0.0737, 0.1145, 0.1225, 0.0706, 0.0572, 0.1361,
        0.0880])
[rfa agg] iter:  3, prev_obj_val: 68.89774322509766, obj_val: 68.89676666259766, abs dis: 0.0009765625
[rfa agg] iter: 3, weight: tensor([0.0611, 0.1784, 0.1030, 0.0687, 0.1173, 0.1211, 0.0711, 0.0520, 0.1384,
        0.0889])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3003, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 7.0873, Accuracy: 82/9950 (0.8241%)
saving model
Done in 514.9495401382446 sec.
Saving all the graphs.
This run has a label: Jun.25_15.26.56. Visdom environment: tiny
